[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451519028, "post_id": 34538943, "comment_id": 56820230, "body": "Will you always know what the sheet name is, before it&#39;s changed?  Also, see <a href=\"https://stackoverflow.com/questions/1939919/rename-worksheet-event-in-excel\">this SO question</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1451554865, "post_id": 34538943, "comment_id": 56830200, "body": "May be useful - you could use a formula to return the sheet names of a saved workbook.  You just need to reference a cell (any cell) on the sheet:  <code>=MID(CELL(&quot;filename&quot;,&#39;Sheet1&#39;!$A$1),FIND(&quot;]&quot;,CELL(&quot;filename&quot;&zwnj;&#8203;,&#39;Sheet1&#39;!$A$1))+1,L&zwnj;&#8203;EN(CELL(&quot;filename&quot;,&#39;&zwnj;&#8203;Sheet1&#39;!$A$1)))</code>"}, {"owner": {"reputation": 1, "user_id": 5732415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292a585452644b223658f38ef2d88b78?s=128&d=identicon&r=PG&f=1", "display_name": "wizard15", "link": "https://stackoverflow.com/users/5732415/wizard15"}, "edited": false, "score": 0, "creation_date": 1451928110, "post_id": 34538943, "comment_id": 56938105, "body": "No. I will not know the sheet name. This is a case of numbered tabs with a set of prefixes. For example, a sheet name may be ADJB-001 or AJB-004. however, it may be necessary to change ADJB-001 to AJB-001."}], "owner": {"reputation": 1, "user_id": 5732415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292a585452644b223658f38ef2d88b78?s=128&d=identicon&r=PG&f=1", "display_name": "wizard15", "link": "https://stackoverflow.com/users/5732415/wizard15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451535090, "creation_date": 1451518659, "last_edit_date": 1451535090, "question_id": 34538943, "link": "https://stackoverflow.com/questions/34538943/automatically-update-a-list-when-worksheet-names-change", "title": "Automatically update a list when worksheet names change", "body": "<p>I am trying to update a list in a spreadsheet with all of the worksheets that contain a certain set of characters. </p>\n\n<p>I have a button that I press to update the list, but I want to make this happen whenever a tab name is changed. I have seen a lot of comments about Worksheet_change(ByVal Target as String) and I am hoping to use something like this.</p>\n"}, {"tags": ["string", "excel", "vba", "variables", "for-loop"], "comments": [{"owner": {"reputation": 4469, "user_id": 2061451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sIGLI.gif?s=128&g=1", "display_name": "Jared Price", "link": "https://stackoverflow.com/users/2061451/jared-price"}, "edited": false, "score": 1, "creation_date": 1451515572, "post_id": 34538197, "comment_id": 56819099, "body": "What are you doing this in? Microsoft Excel?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1451519657, "creation_date": 1451519657, "answer_id": 34539070, "question_id": 34538197, "link": "https://stackoverflow.com/questions/34538197/use-a-for-to-move-from-cells/34539070#34539070", "title": "Use a For to move from cells", "body": "<p>This should work:</p>\n\n<pre><code>Sub SumasTbf()\nDim myRange As Range\nDim Suma As Long, lastRow As Long, i as Long\n\nFor i = 2 To 10 'This will loop from column B to J\n    With Worksheets(\"hoja2\")\n        lastRow = .Cells(1, i).End(xlDown).Row\n        Set myRange = .Range(.Cells(1, i), .Cells(lastRow, i))\n        Suma = WorksheetFunction.Sum(myRange)\n    End With\n\n    'Now, let's record the sum in A1, then A2, etc.\n    ' use i-1 since i starts at 2\n    Worksheets(\"hoja3\").Cells(i - 1, 1) = Suma\nNext i\nEnd Sub\n</code></pre>\n\n<p>Mainly, when wanting to iterate over ranges, you can use <code>Range(Cells([row #],[column #]),Cells([row #],[column #]))</code>.  Then just use a variable to loop (<code>i</code>).</p>\n\n<p>Also, I changed <code>seleccion</code>, since I assume that's also the way VBA uses an active selection.  I changed it to <code>myRange</code> so there's no potential confusion.</p>\n"}], "owner": {"reputation": 77, "user_id": 5732305, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/425be35c1cdfbcf472341be747dbbf5e?s=128&d=identicon&r=PG&f=1", "display_name": "tomzko", "link": "https://stackoverflow.com/users/5732305/tomzko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1451519657, "creation_date": 1451514261, "last_edit_date": 1451519264, "question_id": 34538197, "link": "https://stackoverflow.com/questions/34538197/use-a-for-to-move-from-cells", "title": "Use a For to move from cells", "body": "<p>i need in my Macro is: From a Worksheet (ex: W1) select a whole cell, and the result paste it in another worksheet (W2) cell (A1), then pick another column of W1 and sum it and paste it in A2 and so on. \nWhat i've wrote is:</p>\n\n<pre><code>Sub SumasTbf() \nDim Seleccion As Range \nDim Suma \n\n\nWorksheets(\"hoja2\").Activate \nSet Seleccion = Range(ActiveSheet.Range(\"B1\"), ActiveSheet.Range(\"B1\").End(xlDown)) \nSuma = WorksheetFunction.Sum(Seleccion) \nWorksheets(\"hoja3\").Range(\"F1\") = Suma\n</code></pre>\n\n<p>Now im thinking in using a FOR to move the range B1 to C1 but i dont know how to move the B to C, can you help me plz! in case of working with rows it would be \"B\"&amp; x ?? (another question)... waiting for an answer  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451517247, "post_id": 34538340, "comment_id": 56819653, "body": "sorry no luck. it runs but it doesnt change anything"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451517388, "post_id": 34538340, "comment_id": 56819709, "body": "I tested it with mock data, so I know it works. If it&#39;s not working for you, then the information we have doesn&#39;t match how your data is laid out.  Can you please provide some sample data so that we know what we&#39;re working with?"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451518504, "post_id": 34538340, "comment_id": 56820094, "body": "I could take some screenshots how do i send it your way?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451518625, "post_id": 34538340, "comment_id": 56820119, "body": "Upload the images to an image storage site (like flickr or imgur) and then get the links to your images and put them in your original question."}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451519295, "post_id": 34538340, "comment_id": 56820298, "body": "so basically I am trying to look through tab New column &quot;Jobnumber&quot; in tab AllJobs &quot;Jobnumber&quot;. If the Jobnumbers match I want to see if the reference column in alljobs either contains gtb or wdtc in which case I want to change the customer column on New tab"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451519987, "post_id": 34538340, "comment_id": 56820466, "body": "Unfortunately I don&#39;t have time to look at it now, I will have to look at it tomorrow."}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451522485, "post_id": 34538340, "comment_id": 56821119, "body": "No rush I won&#39;t be back until the 4th."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451574108, "post_id": 34538340, "comment_id": 56837975, "body": "@ichoi alright, based on the provided screenshot, it looks like you want to compare wsNew column B with wsAll column C.  That&#39;s the only match I can find between the two worksheets (Customer for both is Disney Orlando.  Job Number, AWB, and Master all do NOT match in the provided screenshots).  if that&#39;s the case, please see edited answer."}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1451929200, "post_id": 34538340, "comment_id": 56938786, "body": "Sorry the screenshots aren&#39;t very indicative of what I want. I just wanted you to see the format. I want to compare Column D in wsNew to Column A in wsALL. If these match I want to go to column G of wsNew and depending on whether it contains GTB or WDTC, I want to change Column B of wsNew to said Disney WDTC or DIsney DCL."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451939780, "post_id": 34538340, "comment_id": 56944367, "body": "@ichoi I have updated the answer based on your comment."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 3, "last_activity_date": 1451939765, "last_edit_date": 1451939765, "creation_date": 1451515120, "answer_id": 34538340, "question_id": 34537606, "link": "https://stackoverflow.com/questions/34537606/if-cell-value-in-worksheet3-matches-cell-value-in-worksheet2-and-specified-c/34538340#34538340", "title": "If cell value in worksheet(3) matches cell value in worksheet(2) AND specified cell in worksheet(2) contains given text replace with", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub changedisney()\n\n    Dim wb As Workbook\n    Dim wsAll As Worksheet\n    Dim wsNew As Worksheet\n    Dim DCell As Range\n    Dim rFound As Range\n\n    Set wb = ActiveWorkbook\n    Set wsAll = wb.Sheets(\"alljobs\")\n    Set wsNew = wb.Sheets(\"New\")\n\n    For Each DCell In wsNew.Range(\"D2\", wsNew.Cells(Rows.Count, \"D\").End(xlUp)).Cells\n        Set rFound = wsAll.Columns(\"A\").Find(DCell.Value, , xlValues, xlWhole)\n        If Not rFound Is Nothing Then\n            Select Case LCase(Left(wsAll.Cells(rFound.Row, \"G\").Text, 3))\n                Case \"wdt\": wsNew.Cells(DCell.Row, \"B\").Value = \"Disney WDTC\"\n                Case \"gtb\": wsNew.Cells(DCell.Row, \"B\").Value = \"Disney DCL\"\n            End Select\n        End If\n    Next DCell\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: Updated code based on comment from OP:</p>\n\n<blockquote>\n  <p>I want to compare Column D in wsNew to Column A in wsALL. If these\n  match I want to go to <strong>column G of wsNew</strong> and depending on whether\n  it contains GTB or WDTC, I want to change Column B of wsNew to said\n  Disney WDTC or DIsney DCL</p>\n</blockquote>\n\n<p>(In your comment, you state to look at column G of wsNew, but I think you meant to say column G of wsAll, which is what the updated code does.)</p>\n"}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 34538340, "answer_count": 1, "score": 0, "last_activity_date": 1451939765, "creation_date": 1451511381, "last_edit_date": 1451939441, "question_id": 34537606, "link": "https://stackoverflow.com/questions/34537606/if-cell-value-in-worksheet3-matches-cell-value-in-worksheet2-and-specified-c", "title": "If cell value in worksheet(3) matches cell value in worksheet(2) AND specified cell in worksheet(2) contains given text replace with", "body": "<p>If cell value in worksheet 3 matches cell value in worksheet 2 AND specified cell in worksheet 2 contains given text replace with...</p>\n\n<p>(EDIT - Additional explanation from comment): I want to compare Column D in Sheets(\"New\") to Column A in Sheets(\"alljobs\"). If these match I want to go to column G of Sheets(\"alljobs\") and depending on whether it contains GTB or WDTC, I want to change Column B of Sheets(\"New\") to say Disney WDTC or Disney DCL.</p>\n\n<p>Any idea why it runs but doesn't do anything?</p>\n\n<pre><code>Sub changedisney()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim wb As Workbook\nDim ws As Worksheet\nDim lookupvalue As Variant\n\nSet wb = ActiveWorkbook\nSet ws1 = wb.Sheets(\"April\")\nSet ws2 = wb.Sheets(\"alljobs\")\nSet ws3 = wb.Sheets(\"New\")\n\ny = ws3.Cells(ws3.Rows.Count, 2).End(xlUp).Row\n    For i = y To 2 Step -1\n        lookupvalue = ws3.Cells(i, 4)\n        For x = ws2.Cells(Rows.Count, 4).End(xlUp).Row To Step - 1\n            Set rng = ws2.Cells(x, 4)\n            If rng = lookupvalue And ws2.Cells(x, 7) Like \"wdtc*\" Then\n                ws3.Cells(x, 2) = \"Disney WDTC\"\n            End If\n        Next x\n    Next i\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451510724, "post_id": 34537396, "comment_id": 56817007, "body": "A quick note to start, you can <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">eliminate the use of <code>.Select</code></a> which is a really good idea/best practice.  You basically &quot;snug up&quot; the line ending with <code>.Select</code> and starting with <code>Selection.</code>  But, what about using <code>Dim fileStr as String ... fileStr = Application.GetOpenFilename()</code>?"}, {"owner": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451592547, "post_id": 34537396, "comment_id": 56844683, "body": "BruceWayne. Thanks for the tip and the link to get rid of the .Select"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "edited": false, "score": 0, "creation_date": 1451592461, "post_id": 34548702, "comment_id": 56844663, "body": "Justkrys,Thanks for the answer, It&#39;s very close. I have the dialog box opening to the correct directory(c:\\csv)  and the rest of my macro runs but I would like to get all of the .csv files from the subfiles in the directory also (c:\\csv\\120415\\...any other subfolders) As the code works now I only get .csv files from the directory I choose from the browser window."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "edited": false, "score": 0, "creation_date": 1451593050, "post_id": 34548702, "comment_id": 56844819, "body": "I added some code above that may help. Just set sourceFolder equal to the variable for the selected folder."}, {"owner": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "edited": false, "score": 0, "creation_date": 1452004157, "post_id": 34548702, "comment_id": 56973413, "body": "justkyrs, I couldn&#39;t make progress with the additional code, can you elaborate where I should insert the additional code and what to set the sourcefolder as? Thanks"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "edited": false, "score": 0, "creation_date": 1452016619, "post_id": 34548702, "comment_id": 56981881, "body": "Put the code for what you want done to the subfolders where I wrote &quot;Do stuff&quot;. As for what you put in source folder, that would be the path to the main folder you&#39;re getting the subfolders from. Then you have to figure out where to call the methods and how to use them together."}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1451592911, "last_edit_date": 1451592911, "creation_date": 1451577352, "answer_id": 34548702, "question_id": 34537396, "link": "https://stackoverflow.com/questions/34537396/importing-csv-files-in-all-the-subfolders-of-a-directory-with-a-pop-up-browser/34548702#34548702", "title": "importing.csv files in all the subfolders of a directory with a pop up browser", "body": "<pre><code>Sub lookInSubfolders()\nDim sourceFolder as Scripting.Folder\nDim subfolder as Folder\n  For Each subfolder in sourceFolder.SubFolders\n    'Do stuff\n  Next subfolder\nEnd Sub\n\nSub getFiles()\n    Dim xRow As Long\n    Dim xDirect$, xFname$, InitialFoldr$\n        'InitialFoldr$ = \"\\\\path to default directory if you have a main folder\"\n        'This part opens up the browser window:\n        With Application.FileDialog(msoFileDialogFolderPicker)\n            .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n            .Title = \"Please select a folder to list Files from\"\n            .InitialFileName = InitialFoldr$\n            .Show\n\n        'Optional for if there are no files in the directory\n            If .SelectedItems.Count &lt;&gt; 0 Then\n                xDirect$ = .SelectedItems(1) &amp; \"\\\"\n                xFname$ = Dir(xDirect$, 7)\n            If xFname$ = \"\" Then\n                 MsgBox (\"The folder is empty! Your work is done!\")\n                Exit Sub\n            End If\n\n        'Optional to list file names in column \"A\"\n            Do While xFname$ &lt;&gt; \"\"\n                ActiveCell.Offset(xRow) = xFname$\n                xRow = xRow + 1\n                xFname$ = Dir\n            Loop\n            End If\n        End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5732128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9df360e193df0523b8f7d264d67739?s=128&d=identicon&r=PG&f=1", "display_name": "MarkJ", "link": "https://stackoverflow.com/users/5732128/markj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 949, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451592911, "creation_date": 1451510359, "last_edit_date": 1451510687, "question_id": 34537396, "link": "https://stackoverflow.com/questions/34537396/importing-csv-files-in-all-the-subfolders-of-a-directory-with-a-pop-up-browser", "title": "importing.csv files in all the subfolders of a directory with a pop up browser", "body": "<p>I'm using the macro below to import and arrange the contents of all of the.csv files from a specific directory (C:\\csv) on an excel worksheet. I would like the macro to import all of the .csv files in the subdirectories also. If a browser window could open and let me select the path for all of the .csv files I want to import, that would be fantastic. Thank you in advance!</p>\n\n<pre><code>Dim wbCSV   As Workbook\nDim wsMstr  As Worksheet:   Set wsMstr = Sheet1\nDim fPath   As String:      fPath = \"C:\\csv\\\"    'path to CSV files\nDim fCSV    As String\n\nIf MsgBox(\"Clear the existing MasterCSV sheet before importing?\", vbYesNo, \"Clear?\") _\n    = vbYes Then wsMstr.UsedRange.Clear\n\nApplication.ScreenUpdating = False  'speed up macro\n\nfCSV = Dir(fPath &amp; \"*.csv\")         'start the CSV file listing\n\n    Do While Len(fCSV) &gt; 0\n      'open a CSV file\n        Set wbCSV = Workbooks.Open(fPath &amp; fCSV)\n      'insert col A and add filename\n        Columns(1).insert xlShiftToRight\n        Columns(1).insert xlShiftToRight\n        Columns(1).insert xlShiftToRight\n        Columns(1).insert xlShiftToRight\n        Range(\"E4\").Select\n        Selection.Copy\n        Range(\"a20:a87\").Select\n        ActiveSheet.Paste\n      'copy date to b column\n        Range(\"E3\").Select\n        Selection.Copy\n        Range(\"b20:b87\").Select\n        ActiveSheet.Paste\n      'copy sample to c column\n        Range(\"c20:c87\").Select\n        ActiveCell = \"sample\"\n        Range(\"c20\").Select\n        Selection.Copy\n        Range(\"c21:c87\").Select\n        ActiveSheet.Paste\n        'copy 1 to d column\n        Range(\"d20:d87\").Select\n        ActiveCell = \"1\"\n        Range(\"d20\").Select\n        Selection.Copy\n        Range(\"d21:d87\").Select\n        ActiveSheet.Paste\n        'delete header\n        Rows(\"1:20\").Select\n        Selection.Delete Shift:=xlUp\n        'delete un needed columns\n        Columns(\"H:H\").Select\n        Selection.Delete Shift:=xlToLeft\n        Columns(\"F:F\").Select\n        Selection.Delete Shift:=xlToLeft\n        'copy date into master sheet and close source file\n        ActiveSheet.UsedRange.Copy wsMstr.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        wbCSV.Close False\n      'ready next CSV\n        fCSV = Dir\n    Loop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "find", "format", "vba"], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 5079012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaafC.jpg?s=128&g=1", "display_name": "nfloria", "link": "https://stackoverflow.com/users/5079012/nfloria"}, "is_accepted": false, "score": 0, "last_activity_date": 1451703703, "creation_date": 1451703703, "answer_id": 34562180, "question_id": 34537236, "link": "https://stackoverflow.com/questions/34537236/excel-vba-how-to-find-the-same-number-in-different-formats-using-find/34562180#34562180", "title": "EXCEL VBA - How to find the same number, in different formats, using .FIND", "body": "<p>Change the following to LookIn:=xlFormulas per below.</p>\n\n<pre><code>Set cResult = .Find(What:=cSearch.Value, _\n                   After:=cResult, _\n                   LookIn:=xlValues, _\n\nSet cResult = .Find(What:=cSearch.Value, _\n                       After:=cResult, _\n                       LookIn:=xlFormulas, _\n</code></pre>\n\n<p>When I do that it works fine for me.</p>\n"}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451703703, "creation_date": 1451509530, "last_edit_date": 1531164843, "question_id": 34537236, "link": "https://stackoverflow.com/questions/34537236/excel-vba-how-to-find-the-same-number-in-different-formats-using-find", "title": "EXCEL VBA - How to find the same number, in different formats, using .FIND", "body": "<p>This code comes from another post I had help with...<br>\n1) <a href=\"https://stackoverflow.com/questions/30536810/execute-a-subroutine-when-a-user-enters-a-trigger-into-a-cell\">Original</a><br>\n2)  <a href=\"https://stackoverflow.com/questions/34424585/error-capture-while-using-find-is-not-identifing-error\">Second edit</a></p>\n\n<p>A new problem I've found is that .FIND does not find 9,100 when searching for 9100, due to different number formats, e.g. Number vs General. </p>\n\n<p>I tried a couple of things, that busted the code.  Seems simple, but I'm not finding an answer online.  </p>\n\n<p>1) How can I make it find the same number in a format?  </p>\n\n<p>Summary of what the code does:<br>\nWhen triggered by entering a \"y\" in col G, the code will retrieve the value on the same row in either col d or E.  Then it will search col K for the same value and if found, make that cell the active cell.  </p>\n\n<p>This is the basic working code.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rgG As Range\nDim rgK As Range\nDim cSearch As Range\nDim lLoop As Long\nDim cResult As Range\nDim rgXsct As Range\n\n'Find the last used rows in Cols G &amp; K\nDim lrowG As Long\nDim lrowK As Long\n\nlrowG = Columns(\"G:G\").Find(What:=\"*\", _\n             After:=Range(\"G1\"), _\n             LookAt:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=False).Row\n'Debug.Print lrowG\n\nlrowK = Columns(\"K:K\").Find(What:=\"*\", _\n             After:=Range(\"K1\"), _\n             LookAt:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=False).Row\n'Debug.Print lrowK\n\nSet rgG = Range(\"g5:g\" &amp; lrowG)\nSet rgK = Range(\"k6:k\" &amp; lrowK)\nSet rgXsct = Intersect(Target, rgG)  '\"Intersect\" will ensure the current cell lies on the correct column.\n\n'*********** IF CONDITIONS to run. ****************\n'1) Columns.count &amp; Row.count = 1 confirms only one cell selected (not a range of cells). -- I think\n'2) LCase(Target.Text) = \"y\" makes the Target lowcase and compares it.\n'3) Intersect makes sure the Target is in the relevant range.\n'4)\n\nIf Target.Columns.Count = 1 And Target.Rows.Count = 1 And _\n  LCase(Target.Text) = \"y\" And _\n  Not rgXsct Is Nothing Then\n\n    Application.ScreenUpdating = False\n    Set cSearch = Target.Offset(0, -3)            'Returns value in Col D\n    If cSearch = 0 Or cSearch = \"\" Then Set cSearch = Target.Offset(0,     -2)  'If nothing in D, check E.\n        If cSearch = 0 Or cSearch = \"\" Then GoTo end_search     'If nothing in E, end.\n'Debug.Print \"Target \"; Target\n'Debug.Print \"cSearch.value \"; cSearch.Value\n'This will loop through the column to search, to find the value identified above, and return its cell address.\n        With rgK\n            Set cResult = .Cells(1, 1)\n            'For lLoop = 1 To WorksheetFunction.CountIf(.Cells, cSearch.Value)\n            Set cResult = .Find(What:=cSearch.Value, _\n                   After:=cResult, _\n                   LookIn:=xlValues, _\n                   LookAt:=xlPart, _\n                   SearchOrder:=xlByRows, _\n                   SearchDirection:=xlNext, _\n                   MatchCase:=False)\n'Debug.Print \"cResult \" &amp; cResult\n            If Not cResult Is Nothing Then\n                MsgBox \"val: \" &amp; cSearch.Value &amp; \"   Matching Cell: \" &amp; cResult.Address\n'Use the cell address identified above to move the active cell to that address.\n                Cells(Range(cResult.Address).Row,    Range(cResult.Address).Column).Select     'Have to convert the address to row/column to use in Cell.Select.\n            Else\n                MsgBox (cSearch.Value &amp; \" not found.\")\n                GoTo end_search\n            End If\n            'Next lLoop\n        End With\nEnd If\nend_search:\n'Application.ScreenUpdating = True\n'End Sub\n</code></pre>\n\n<p>2) Can you tell me the value of that commented out <code>For</code> loop after the <code>with</code>?  It was suggested as a solution to make this overall code work, but it works without it.  </p>\n\n<p>3) How can I make this more concise? It seems complex.  For instance, why do I need a <code>with</code> statement, when <code>Columns(K:K).Find(...</code> without a <code>with</code> statement should work based on what I've read (but it does not in this module). </p>\n"}, {"tags": ["forms", "excel", "listbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5045396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2a27533c8359fddb378220322495fe?s=128&d=identicon&r=PG&f=1", "display_name": "taylorpa5", "link": "https://stackoverflow.com/users/5045396/taylorpa5"}, "is_accepted": false, "score": 1, "last_activity_date": 1451598540, "creation_date": 1451598540, "answer_id": 34551869, "question_id": 34537152, "link": "https://stackoverflow.com/questions/34537152/excel-vba-listbox-showing-previous-record-after-new-selection-is-made/34551869#34551869", "title": "Excel VBA Listbox showing previous record after new selection is made", "body": "<p>Solved.  Inserted the below code into the click event of the listbox prior to running all the procedure:</p>\n\n<pre><code>Application.Calculate\nIf Not Application.CalculationState = xlDone Then\n    DoEvents\nEnd If\n</code></pre>\n\n<p>Thank you to all who made the effort to view my post.</p>\n\n<p>Happy New year.</p>\n"}], "owner": {"reputation": 11, "user_id": 5045396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2a27533c8359fddb378220322495fe?s=128&d=identicon&r=PG&f=1", "display_name": "taylorpa5", "link": "https://stackoverflow.com/users/5045396/taylorpa5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451598540, "creation_date": 1451509131, "last_edit_date": 1531164843, "question_id": 34537152, "link": "https://stackoverflow.com/questions/34537152/excel-vba-listbox-showing-previous-record-after-new-selection-is-made", "title": "Excel VBA Listbox showing previous record after new selection is made", "body": "<p>So I have listbox1 on a user form.  When a user clicks an item in the list box I have the value of the list box selection populate cell C20 on a worksheet.</p>\n\n<pre><code>Private Sub frmListBox1_Click()\nWorksheets(\"CONTROLSRFDS\").Range(\"C20\").Value = frmListBox1.Value\n\nFor i = 1 To 53 ' Non Multipage Controls\n    Me.Controls(\"Label\" &amp; i).Caption = Worksheets(\"CONTROLSRFDS\").Range(\"RBSLabels\").Cells(i, 1).Value\n    Me.Controls(\"TextBox\" &amp; i).Value = Worksheets(\"CONTROLSRFDS\").Range(\"RBSOutput\").Cells(i, 1).Value\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Based on the selection now in cell C20, the worksheet will re-calculate over 30 ranges of data with formulas that are based on this one value in cell C20.\nThese 30 ranges of data are coded to transfer their new values onto the label captions that are contained on the user form.</p>\n\n<p>What's happening is that the form will initialize correctly, BUT once the list box is selected for a new selection, all the values on the user form show values that belong to the previous selection, however on the worksheet the formulas are calculating correctly, it's just that the new values are not populating the label captions on the user form with the right information.  I've beat  myself  up trying to figure this out by using change events and click events in the worksheet module and in the form itself with no success.  I can't get this solved. At each click the data displayed is showing the previous record.</p>\n\n<p>Code for the ListBox Change Event:</p>\n\n<pre><code>Private Sub frmListBox1_Change()\n\nIf Application.CalculationState = done Then\n\nWorksheets(\"CONTROLSRFDS\").Range(\"C20\").Value = frmListBox1.Value\n\nFor i = 1 To 53 ' Non Multipage Controls\nMe.Controls(\"Label\" &amp; i).Caption = Worksheets(\"CONTROLSRFDS\").Range(\"RBSLabels\").Cells(i, 1).Value\nMe.Controls(\"TextBox\" &amp; i).Value = Worksheets(\"CONTROLSRFDS\").Range(\"RBSOutput\").Cells(i, 1).Value\nNext i\n\nii = 1 'Antenna Labels\nFor i = 54 To 75\nMe.Controls(\"Label\" &amp; i).Caption = Worksheets(\"CONTROLSRFDS\").Range(\"AntennaLabels\").Cells(ii, 1).Value\n        ii = ii + 1\nNext i\nEnd If\nEnd sub\n</code></pre>\n\n<p>Can someone please help with this??  What am doing wrong? Is there a index property I'm not referencing?  Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "variables", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1451510073, "post_id": 34537011, "comment_id": 56816715, "body": "@PortlandRunner You are correct. I edited the answer to reflect that. Thanks."}, {"owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "edited": false, "score": 0, "creation_date": 1451517132, "post_id": 34537011, "comment_id": 56819610, "body": "Turned out, at least partially, to be a missing <code>End If</code>. I did add the Microsoft Word 15.0 Object Library (there was no option for 14.0), but now I&#39;m getting a similar error:  &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;  This time, it&#39;s on <code>Selection.MoveDown Count:=4</code>. I don&#39;t get it. Given that I&#39;ve added Word as an object and that I&#39;m using the <code>with</code> statements, this should work, even without the Word Library. But now that I&#39;ve added the library, it should work and doesn&#39;t. Any more ideas?"}, {"owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "edited": false, "score": 0, "creation_date": 1451518527, "post_id": 34537011, "comment_id": 56820099, "body": "I updated the original code so it has the missing <code>End If</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "reply_to_user": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "edited": false, "score": 1, "creation_date": 1451528125, "post_id": 34537011, "comment_id": 56822381, "body": "@Vince Earl - &quot;With Word_doc&quot; does not mean that every object within the With block is a member of Word_doc. It&#39;s partly a shorthand that lets you say (for example) &quot;.Content&quot; rather than spelling out &quot;Word_doc.Content&quot;. To get Word&#39;s Selection object you&#39;ll probably need to use &quot;Word_app.Selection&quot;,which means to use &quot;With&quot; you would use &quot;With Word_App&quot; and then &quot;.Selection&quot;"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 3, "last_activity_date": 1451510031, "last_edit_date": 1451510031, "creation_date": 1451508438, "answer_id": 34537011, "question_id": 34536920, "link": "https://stackoverflow.com/questions/34536920/compile-error-variable-not-defined-vba/34537011#34537011", "title": "compile error variable not defined VBA", "body": "<p><em>Excel</em> VBA doesn't know about predefined Word constants such as <code>wdCollapseStart</code>. According to <a href=\"https://msdn.microsoft.com/en-us/library/office/aa211923(v=office.11).aspx\" rel=\"nofollow\">this</a> <code>wdCollapseStart</code> is equal to <code>1</code>. One solution is to just directly use the numbers that such constants refer to (using the linked-to documentation). A second solution is to add a reference to <code>Microsoft Word 14.0 Object Library</code> (under <code>Tools/References</code> in the VBA editor) after which your code should work without modification.</p>\n"}], "owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451518451, "creation_date": 1451507958, "last_edit_date": 1531164843, "question_id": 34536920, "link": "https://stackoverflow.com/questions/34536920/compile-error-variable-not-defined-vba", "title": "compile error variable not defined VBA", "body": "<p>I've created a macro to move information from Excel into existing tables in a Word document. When I try to compile, I'm getting a \"Compile error: variable not defined\" error on <code>wdCollapseStart</code> within the statement <code>Selection.Collapse Direction:=wdCollapseStart</code>. I simplified to <code>Selection.Collapse</code>, but then I got the same error on the next line with <code>wdRow</code>. <code>wdCollapse</code> and <code>wdRow</code> are not variables, so I don't understand why I'm getting this error, especially when the exact same statement functions perfectly if I run it through the immediate window from Word. To clarify, I've written this macro for Excel, but the macro has to manipulate a Word document as well.</p>\n\n<p>Full code below (the offending statement is in the first <code>with</code> statement):</p>\n\n<pre><code>Option Explicit\nDim Word_App As Object\nDim Word_Doc As Object\n\nSub IDA_Creator()\n\nDim Starting_Sheet As Integer: Starting_Sheet = 4\nDim Ending_Sheet As Integer: Ending_Sheet = Worksheets.Count - 1\n\n'Activates first category worksheet\nWorksheets(Starting_Sheet).Activate\n\n'Get the name of the destination Word file\nDim IDA_Word As String\nIDA_Word = Application.GetOpenFilename(FileFilter:=\"Word Files (*.DOCX), *.DOCX\", Title:=\"Select File To Be Opened\")\n\n'Open Word\nSet Word_App = CreateObject(\"Word.Application\")\nWord_App.Visible = True\nSet Word_Doc = Word_App.Documents.Open(IDA_Word)\n\nDim i As Integer\n\nFor i = 1 To 3\n\n    Call TrimTable\n\n    Call Move_To_Table(Starting_Sheet, i)\n\n    Dim j As Integer\n\n    For j = Starting_Sheet To Ending_Sheet\n\n        Call Copy_To_Word(i)\n\n        'Prepares Word table for next Category (unless it's the last category\n        If ActiveSheet.Index &gt; Worksheets.Count - 1 Then\n\n            ActiveSheet.Next.Select\n\n            With Word_Doc\n\n                Selection.InsertRowsBelow (2)\n                Selection.Collapse Direction:=wdCollapseStart\n                Selection.EndOf Unit:=wdRow, Extend:=wdExtend\n                Selection.Cells.Merge\n                Selection.Collapse Direction:=wdCollapseStart\n\n            End With\n\n        End If\n\n    Next j\n\n    Worksheets(Starting_Sheet).Activate\n\nNext i\n\n'Save Word Document and Close Word\nWith Word_Doc\n\n    .Save\n\nEnd With\n\nWord_App.Quit\nSet Word_Doc = Nothing\nSet Word_App = Nothing\n\nEnd Sub\n\n'Trims the table to the first category and criterion\nFunction TrimTable()\n\nWith Word_Doc\n\n    With Word_App.Selection.Find\n\n        .Text = \"Table \" &amp; i\n        .Style = \"Caption\"\n        .Execute\n\n    End With\n\n    Selection.MoveDown Count:=4\n    Selection.EndOf Unit:=wdTable, Extend:=wdExtend\n    Selection.Rows.Delete\n\nEnd With\n\nEnd Function\n\n'Moves the cursor to the first cell of the next table, formats table with correct style\nFunction Move_To_Table(Starting_Sheet As Integer, i As Integer)\n\nSheets(Starting_Sheet).Activate\n\nWith Word_Doc\n\n    With Word_App.Selection.Find\n\n        .Text = \"Table \" &amp; i\n        .Style = \"Caption\"\n        .Execute\n\n    End With\n\n    'Ensures first row of table is in \"CellHeadingL\" style\n    Selection.MoveDown\n    Selection.EndOf Unit:=wdRow, Extend:=wdExtend\n    Selection.Style = \"CellHeadingL\"\n    Selection.Collapse Direction:=wdCollapseStart\n\n    'Clears boilerplate text\n    Selection.MoveDown\n    Selection.EndOf Unit:=wdTable, Extend:=wdExtend\n    Selection.Delete\n    Selection.Collapse Direction:=wdCollapseStart\n\nEnd With\n\nEnd Function\n\n'Copies criteria text from Excel to Word\nFunction Copy_To_Word(i As Integer)\n\n    'Copies category name from Excel\n    Selection.Copy\n\n    'Pastes category name into Word\n    With Word_Doc\n\n        Selection.EndOf Unit:=wdRow, Extend:=wdExtend\n        Selection.PasteSpecial DataType:=wdPasteText\n        Selection.Style = \"CellBodyL\"\n        Selection.Font.Bold = True\n        Selection.MoveDown\n\n    End With\n\n    'Determines number of subcategories and criteria\n    Range(ActiveCell, ActiveCell.End(xlDown)).Select\n    Dim Number_Criteria As Integer: Number_Criteria = Selection.Rows.Count - 2\n\n    'Adds correct number of rows to Word table, positions cursor at top row\n    With Word_Doc\n\n        Selection.InsertRowsBelow (Number_Criteria - 1)\n        Selection.Collapse Direction:=wdCollapseStart\n        Selection.MoveUp\n\n    End With\n\n    'Selects the first subcategory or criterion from Excel and copies to clipboard\n    Selection(1).Select\n    Selection.Offset(2, 0).Select\n\n    'Begins copying to Word\n    For i = 1 To Number_Criteria\n\n        Selection.Copy\n\n        'Checks whether there's a subcategory (merged) cell in Excel, formats Word table to match and pastes subcategory into Word\n        If ActiveCell.MergeCells = True Then\n\n            With Word_Doc\n\n                Selection.EndOf Unit:=wdRow, Extend:=wdExtend\n                Selection.Cells.Merge\n                Selection.PasteSpecial DataType:=wdPasteText\n                Selection.Style = \"CellBodyL\"\n                Selection.Font.Bold = True\n\n            End With\n\n        'Excel cell isn't a subcategory (merged) cell in Excel, paste criterion into Word\n        Else\n\n        With Word_Doc\n\n            Selection.PasteSpecial DataType:=wdPasteText\n            Selection.Style = \"CellBodyL\"\n\n        End With\n\n        End If\n\n        'Moves to next cell\n        Selection.Offset(1, 0).Select\n\n    Next i\n\n    'Puts cursor in position for next pass (Preferred or Optional criteria)\n    Selection.Offset(5, 0).Select\n\nEnd Function\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1451508256, "post_id": 34536757, "comment_id": 56815812, "body": "I&#39;m not sure I completely understand the requirement. Especially since some of the source / typetext examples look identical. Could you clarify some of that and also provide example pairs of what you do / do not want to find? I suspect you could use wildcards..."}, {"owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1451508533, "post_id": 34536757, "comment_id": 56815940, "body": "Sorry, I just changed that portion of code (and it&#39;s not working). I would Call AutoReplace(&quot;can&#39;t&quot;, &quot;cannot&quot;), but I would not want it to replace any word that is within quotation marks. It should not change the &quot;can&#39;t&quot; in the following: &quot;I can&#39;t write code well.&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1451509565, "post_id": 34536757, "comment_id": 56816473, "body": "I&#39;m currently on a mobile device, so can&#39;t do any testing or looking up of wildcard symbols... Are you familiar with Word&#39;s Find dialog box? Click &quot;More&quot;, acivate the wildcard checkbox then look at the list of Symbols. I&#39;m thinking of something along these lines, to start with: &quot;<i>can&#39;t</i>.&quot; If that works then something can probably be done, although I am concerned about identifying whether two sets of quotes are actually a pair and not end of one and beginning of another... Can you narrow the logic down a bit more?"}, {"owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1451517468, "post_id": 34536757, "comment_id": 56819738, "body": "@Cindy Open and close quotation marks are separate characters. If I&#39;m working on a paper, then I don&#39;t want to change anything that has been quoted from another source."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1451579166, "post_id": 34536757, "comment_id": 56840086, "body": "Then we need to know what the characters are - the ANSI character number. Select opening / closing quotes and run this from the Immediate Window in the VBA editor: ?ASC(Selection.Text)"}, {"owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452272206, "post_id": 34536757, "comment_id": 57110248, "body": "@ Cindy The ANSI codes are 147 and 148  for open and close quotation marks, respectively."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452928748, "post_id": 34536757, "comment_id": 57391123, "body": "Did my answer solve your problem? If yes you should click the &quot;checkmark&quot; to the left of my Answer to indicate that is the case."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "edited": false, "score": 0, "creation_date": 1499106019, "post_id": 34683384, "comment_id": 76761509, "body": "Thanks for this. I&#39;ve been working on it and testing a lot. It doesn&#39;t find instances of <code>sTerm</code> that come before the first open quote in a document or after the final close quote."}, {"owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "edited": false, "score": 0, "creation_date": 1499106661, "post_id": 34683384, "comment_id": 76761784, "body": "I have a chain of strings like this: <code>sTerm = &quot;can&#39;t&quot;</code>, <code>sReplacement = &quot;cannot&quot;</code>, <code>Call NewMacros.FindTermNotInQuotes</code>. It is safe to assume that all quotation marks occur in pairs (I can run a check before). Can I just check whether there is an open or close quote following <code>sTerm</code> to make or not make the change? Also, if there are no quotation marks nothing found after <code>sTerm</code>, then the word should be replaced."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1452276482, "creation_date": 1452276482, "answer_id": 34683384, "question_id": 34536757, "link": "https://stackoverflow.com/questions/34536757/how-to-exclude-content-found-within-quotation-marks/34683384#34683384", "title": "How to exclude content found within quotation marks", "body": "<p>Wildcard search can't handle this, unfortunately, so a code solution is required.</p>\n\n<p>The difficulty with this is determining when the search term is within quotes. And of course the search term could occur multiple times within a set of quotes. I tried to think of all permutations, including whether the term occurs at the beginning / end of the document, but I can't guarantee I caught them all...</p>\n\n<p>The trick to the approach I propose is to compare the <em>location</em> in the text of the found term, the previous opening quotes and, if those were found, whether the previous closing quotes follow or precede the opening quotes. If no opening quotes are found, the term is obviously not in quotes. If the closing quotes follow the opening quotes, the term is not in quotes. Otherwise, it's assumed the quotes are in pairs and the term is indeed within quotes.</p>\n\n<p>The coding could be more elegant (fewer nested levels), but I'm not being paid for it, so I leave that up to anyone who wants to use it...</p>\n\n<pre><code>Sub FindTermNotInQuotes()\n  Dim sTerm As String, sReplacement As String\n  Dim sOpenQuote As String, sCloseQuote As String\n  Dim rngSearch As word.Range, rngOpenQuote As word.Range\n  Dim rngTerm As word.Range, rngCloseQuote As word.Range\n  Dim bFound As Boolean, rngFound As word.Range\n\n  sTerm = \"can't\"\n  sReplacement = \"cannot\"\n  sOpenQuote = Chr(147)\n  sCloseQuote = Chr(148)\n  Set rngSearch = ActiveDocument.content\n  Set rngFound = ActiveDocument.Range(2)\n  Do\n    With rngSearch.Find\n      'Keep previous location so that we can check\n      'If searching the open quote is a previous one\n      rngFound.Collapse wdCollapseStart\n      .ClearFormatting\n      .Text = sTerm\n      .Forward = True\n      bFound = .Execute\n      If bFound Then\n        Set rngOpenQuote = rngSearch.Duplicate\n        rngOpenQuote.Start = ActiveDocument.content.Start\n        With rngOpenQuote.Find\n            .Text = sOpenQuote\n            .Forward = False\n            If .Execute Then\n                If rngOpenQuote.Start &lt; rngFound.Start Then\n                    'This quote is in front of the previous \"hit\"\n                    'So we need to check if there's a closing quote\n                    Set rngCloseQuote = rngSearch.Duplicate\n                    rngCloseQuote.Start = ActiveDocument.content.Start\n                    With rngCloseQuote.Find\n                        .Text = sCloseQuote\n                        .Forward = False\n                        If .Execute Then\n                            'It's not in a quote\n                            If rngCloseQuote.Start &gt; rngOpenQuote.Start Then\n                                'If close quote is before open quote\n                                'then the term is still within quotes\n                                rngSearch.Text = sReplacement\n                            End If\n                        End If\n                    End With\n                End If\n            End If\n        End With\n      End If\n      Set rngFound = rngSearch.Duplicate\n      rngSearch.Collapse wdCollapseEnd\n      rngSearch.End = ActiveDocument.content.End\n    End With\n  Loop While bFound\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5723684, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/48f8c0480bb22eb972736cf9f1f22cae?s=128&d=identicon&r=PG&f=1", "display_name": "Write Place", "link": "https://stackoverflow.com/users/5723684/write-place"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459758835, "creation_date": 1451507268, "last_edit_date": 1459758835, "question_id": 34536757, "link": "https://stackoverflow.com/questions/34536757/how-to-exclude-content-found-within-quotation-marks", "title": "How to exclude content found within quotation marks", "body": "<p>I have the following function, but I do not want it to replace anything within quotation marks when I call it:</p>\n\n<pre><code>Function AutoReplace(source As String, typeText As String)\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = Trim(source)\n        .Replacement.Text = typeText\n        .Forward = True\n        .Wrap = wdFindContinue\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451511982, "post_id": 34536725, "comment_id": 56817550, "body": "You could try the recordset.seek method.  This requires an index.  See here: <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff836416.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/EN-US/library/office/ff836416.aspx</a>.  Alternatively, you could use Do While as you mentioned....Do While rsCurve!MarkAsOfDate &lt;&gt; desiredValue rsCurve.MoveNext Loop then add another loop...Do While rsCurve!MarkAsOfDate = desiredValue....do stuff rsCurve.MoveNext Loop"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 3, "creation_date": 1451515186, "post_id": 34536725, "comment_id": 56818977, "body": "why not run the query filtered with the user-input date criteria?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1451517049, "post_id": 34536725, "comment_id": 56819579, "body": "^^ This. Open <code>rsCurve</code> with only the data you want, by using a WHERE clause."}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 1, "last_activity_date": 1451573549, "creation_date": 1451573549, "answer_id": 34548031, "question_id": 34536725, "link": "https://stackoverflow.com/questions/34536725/moving-a-specific-point-in-the-recordset-in-access/34548031#34548031", "title": "Moving a Specific Point in the Recordset in Access", "body": "<p>Try something like this:</p>\n\n<pre><code>Set rsCurve = db.OpenRecordset(\"SELECT * FROM MyTable WHERE MyDate &gt;= #\" &amp; txtUserInputDate.Value &amp; \"# ORDER BY MyDate ASC\")\n</code></pre>\n\n<p>You will have to change obvious info such as table name, textbox name and field names, but that's the general idea.</p>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451573549, "creation_date": 1451507103, "question_id": 34536725, "link": "https://stackoverflow.com/questions/34536725/moving-a-specific-point-in-the-recordset-in-access", "title": "Moving a Specific Point in the Recordset in Access", "body": "<p>I have a function written in Access VBA. The purpose of this function is to perform simple linear interpolation. It interpolates a \"ZeroRate\" value for a specified date, using the ZeroRates for the closest \"MaturityDates\" dates drawn from an inputted recordset. The function is as follows:</p>\n\n<pre><code>  Function CurveInterpolateRecordset(rsCurve As Recordset, InterpDate As \n    Date) as Double\n\n\n    Dim Q As Long\n\n    Dim x1 As Date, x2 As Date, y1 As Double, y2 As Double, x As Date\n\n    CurveInterpolateRecordset = Rnd()\n\n    If rsCurve.RecordCount &lt;&gt; 0 Then\n\n        Q = 1\n\n        rsCurve.MoveFirst\n\n        x1 = CDate(rsCurve.Fields(\"MaturityDate\"))\n\n        y1 = CDbl(rsCurve.Fields(\"ZeroRate\"))\n\n        If InterpDate = CDate(rsCurve.Fields(\"MaturityDate\")) Then CurveInterpolateRecordset = CDbl(rsCurve.Fields(\"ZeroRate\")): Exit Function\n\n\n        rsCurve.MoveNext\n\n        Do While (CDate(rsCurve.Fields(\"MaturityDate\")) &lt;= InterpDate)\n            If rsCurve.EOF Then CurveInterpolateRecordset = CDbl(rsCurve.Fields(\"ZeroRate\")): Exit Function\n\n            If InterpDate = CDate(rsCurve.Fields(\"MaturityDate\")) Then CurveInterpolateRecordset = CDbl(rsCurve.Fields(\"ZeroRate\")): Exit Function\n\n            If InterpDate &gt; CDate(rsCurve.Fields(\"MaturityDate\")) Then\n\n            x1 = CDate(rsCurve.Fields(\"MaturityDate\"))\n            y1 = CDbl(rsCurve.Fields(\"ZeroRate\"))\n\n            End If\n\n            rsCurve.MoveNext\n            If rsCurve.EOF Then CurveInterpolateRecordset = y1: Exit Function\n\n        Loop\n\n            x2 = CDate(rsCurve.Fields(\"MaturityDate\"))\n            y2 = CDbl(rsCurve.Fields(\"ZeroRate\"))\n\n            CurveInterpolateRecordset = y1 + (y2 - y1) * CDate((InterpDate - x1) / (x2 - x1))\n    End If\n\n\n\nEnd Function\n</code></pre>\n\n<p>Right now, the function begins at the beginning of the recordset defined by rsCurve.MoveFirst and moves through the recordset from there until the end of the recordset rsCurve.EOF. It interpolates over these values. However, I do not want it to always begin at the beginning of the recordset. </p>\n\n<p>Instead, I want it to begin at a specific point in the recordset. I have a column of dates in the recordset called \"MarkAsOfDate\". Instead of interpolating over the entire recordset, I want it to only interpolate where MarkAsofDate equals some user-inputted value. So for 7/31/2015, I want it to interpolate using the values from rows where the MarkAsofDate column is equal to 7/31/2015. How can I change the rsCurve.MoveFirst to accomplish this? I tried using Do While commands but without success. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451504587, "post_id": 34536117, "comment_id": 56813952, "body": "Okay.  Is there an issue with the code?"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451504715, "post_id": 34536117, "comment_id": 56813997, "body": "It runs, but it doesn&#39;t do anything"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1451505075, "post_id": 34536117, "comment_id": 56814161, "body": "One thing to try is change <code>ActiveWorkbook</code> to <code>ThisWorkbook</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451505081, "post_id": 34536117, "comment_id": 56814169, "body": "Check out how you&#39;re calling the loop - are you <i>sure</i> that <code>x</code> is going to be greater than 2?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1451505315, "post_id": 34536117, "comment_id": 56814289, "body": "You&#39;re checking to see if column D cells on sheet &quot;New&quot; match column A cells on sheet &quot;alljobs&quot; <i>in the same row</i>.  So it&#39;s not looking anything up, it&#39;s doing direct comparison row by row.  Is that supposed to be that way, or should it be looking up a match in &quot;alljobs&quot;?"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1451505361, "post_id": 34536117, "comment_id": 56814319, "body": "@tigeravatar no it&#39;s not supposed to do that. Thanks for catching"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451506266, "post_id": 34536117, "comment_id": 56814729, "body": "is &quot;gtb*&quot; the correct way to specify field containing gtb? For example would it pick up gtb12345"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451510486, "post_id": 34536117, "comment_id": 56816901, "body": "<code>ws2.Cells(i, 7) LIKE &quot;gtb*&quot;</code>"}, {"owner": {"reputation": 111, "user_id": 3577213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SyBNE.jpg?s=128&g=1", "display_name": "Michele", "link": "https://stackoverflow.com/users/3577213/michele"}, "edited": false, "score": 1, "creation_date": 1451522790, "post_id": 34536117, "comment_id": 56821194, "body": "An alternative can also be <code>LEFT(ws2.Cells(i, 7), 3) = &quot;gtb&quot;</code> and <code>LEFT(ws2.Cells(i, 7), 4) = &quot;wdtc&quot;</code>."}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451504515, "creation_date": 1451504515, "question_id": 34536117, "link": "https://stackoverflow.com/questions/34536117/if-cell-value-in-worksheet-3-matches-cell-value-in-worksheet-2-and-specified-cel", "title": "If cell value in worksheet 3 matches cell value in worksheet 2 AND specified cell in worksheet 2 contains given text replace with", "body": "<p>If cell value in worksheet 3 matches cell value in worksheet 2 AND specified cell in worksheet 2 contains given text replace with either Disney DCL or Disney WDTC.</p>\n\n<pre><code>Sub changedisney()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim wb As Workbook\nDim ws As Worksheet\n\n\nSet wb = ActiveWorkbook\nSet ws1 = wb.Sheets(\"April\")\nSet ws2 = wb.Sheets(\"alljobs\")\nSet ws3 = wb.Sheets(\"New\")\n\nx = ws3.Cells(ws3.Rows.Count, 2).End(xlUp).Row\n    For i = x To 2 Step -1\n        If ws3.Cells(i, 4) = ws2.Cells(i, 1) And ws2.Cells(i, 7) = \"gtb*\" Then\n            ws3.Cells(i, 2) = \"Disney DCL\"\n        End If\n        If ws3.Cells(i, 4) = ws2.Cells(i, 1) And ws2.Cells(i, 7) = \"wdtc*\" Then\n            ws3.Cells(i, 2) = \"Disney WDTC\"\n        End If\nNext i\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1451574117, "post_id": 34545258, "comment_id": 56837981, "body": "Thank you!. Worked perfectly. I was looking at this for too long. Simple fix, but it was a splinter."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 1, "last_activity_date": 1451558938, "creation_date": 1451558938, "answer_id": 34545258, "question_id": 34536003, "link": "https://stackoverflow.com/questions/34536003/checking-if-a-file-is-open-to-prevent-error-pt-2/34545258#34545258", "title": "Checking if a file is open to prevent error - Pt. 2", "body": "<p>change this:</p>\n\n<pre><code>Dim ANS As String\n\n    ANS = MsgBox(\"Is the November 2015 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\n    If ANS = vbNo Then\n        MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n        Exit Sub\n    Else\n        If ANS = vbYes Then\n            If IsWBOpen(\"Swivel - Master - November 2015.xlsm\") Then\n            End If\n            Else\n                MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n                Exit Sub\n        End If\n    End If\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>Dim ANS As Long\n\nANS = MsgBox(\"Is the November 2015 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\nIf ANS = vbNo Or IsWBOpen(\"Swivel - Master - November 2015\") = False Then\n    MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n    Exit Sub                   \nEnd If\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 34545258, "answer_count": 1, "score": 1, "last_activity_date": 1451558938, "creation_date": 1451503990, "last_edit_date": 1531164843, "question_id": 34536003, "link": "https://stackoverflow.com/questions/34536003/checking-if-a-file-is-open-to-prevent-error-pt-2", "title": "Checking if a file is open to prevent error - Pt. 2", "body": "<p>In reference to this post:\n<a href=\"https://stackoverflow.com/questions/34519858/checking-if-file-is-open-to-prevent-error\">Checking if File is open to prevent error</a>\nI have updated the code, but now I am receiving:</p>\n\n<p>Run-time error 9:\nSubscript out of range</p>\n\n<p>and the debugger highlights this line of the code (Full code is below, along with the Function for IsWBOpen):</p>\n\n<pre><code>With Workbooks(\"Swivel - Master - November 2015.xlsm\").Sheets(\"Swivel\")\n</code></pre>\n\n<p>The only thing I can think of is that the .Sheets(\"Swivel\") is the culprit, but I am not sure of this.</p>\n\n<p>Here is what I am trying to accomplish:</p>\n\n<p>If the user clicks No, then the sub ends with the MsgBox message stating this procedure will terminate.\nIf the user clicks yes and the workbook is <strong>not</strong> open, the user gets the same message as if they clicked on No <strong>and</strong> the sub ends.\nIf the user clicks Yes and the workbook is open, the sub continues.</p>\n\n<p>here is the Function:</p>\n\n<pre><code>Function IsWBOpen(WorkbookName As String) As Boolean\n' check if WorkbookName is already opened; WorkbookName is without path or extension!\n' comparison is case insensitive\n' 2015-12-30\n\n    Dim wb As Variant\n    Dim name As String, searchfor As String\n    Dim pos As Integer\n\n    searchfor = LCase(WorkbookName)\n    For Each wb In Workbooks\n        pos = InStrRev(wb.name, \".\")\n        If pos = 0 Then                           ' new wb, no extension\n            name = LCase(wb.name)\n        Else\n            name = LCase(Left(wb.name, pos - 1))  ' strip extension\n        End If\n        If name = searchfor Then\n            IsWBOpen = True\n            Exit Function\n        End If\n    Next wb\n    IsWBOpen = False\nEnd Function\n</code></pre>\n\n<p>Here is the main sub:</p>\n\n<pre><code>Sub Extract_Sort_1511_November()\n'\n'\nDim ANS As String\n\n    ANS = MsgBox(\"Is the November 2015 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\n    If ANS = vbNo Then\n        MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n        Exit Sub\n    Else\n        If ANS = vbYes Then\n            If IsWBOpen(\"Swivel - Master - November 2015.xlsm\") Then\n            End If\n            Else\n                MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n                Exit Sub\n        End If\n    End If\n\nApplication.ScreenUpdating = False\n\n    ' This line renames the worksheet to \"Extract\"\n    ' ActiveSheet.name = \"Extract\"\n\n    ' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Columns.AutoFit\n\n    ' This unhides any hidden rows\n    Cells.EntireRow.Hidden = False\n\nDim LR As Long\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"11\" Then\n            Rows(LR).EntireRow.Delete\n        End If\n    Next LR\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"D2:D2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"O2:O2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"J2:J2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"K2:K2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"L2:L2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:Z2000\")\n    .Apply\nEnd With\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\n\n    Dim LastRow As Integer, i As Integer, erow As Integer\n\n    LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If Cells(i, 2) = \"11\" Then\n\n            ' As opposed to selecting the cells, this will copy them directly\n            Range(Cells(i, 1), Cells(i, 26)).Copy\n\n            ' As opposed to \"Activating\" the workbook, and selecting the sheet, this will paste the cells directly\n            With Workbooks(\"Swivel - Master - November 2015.xlsm\").Sheets(\"Swivel\")\n                erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                .Cells(erow, 1).PasteSpecial xlPasteAll\n            End With\n            Application.CutCopyMode = False\n        End If\n    Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>findwindow and user1016274 have been very helpful in getting the code this far. All assistance on this error is appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451500295, "post_id": 34535040, "comment_id": 56811846, "body": "Turn on the macro recorder, and go through your steps.  When you&#39;re done, stop the recorder then step in to it to see the resulting code.  You can use <code>F8</code> to go line by line, and watch in Excel what the lines do.  That should get you going on your copy/pasting."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "edited": false, "score": 0, "creation_date": 1451876699, "post_id": 34535662, "comment_id": 56913655, "body": "First of all, thank you!  I used your code and it highlights this part and says syntax error   &quot;If ws.Name &lt;&gt; &quot;Busca&quot; &#39;check all sheets except Busca sheet&quot;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "edited": false, "score": 0, "creation_date": 1451913939, "post_id": 34535662, "comment_id": 56929337, "body": "Do you have <code>ws</code> dimensioned as a <code>Worksheet</code>? and are you sure you typed all the syntax correctly?"}, {"owner": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "edited": false, "score": 0, "creation_date": 1452190100, "post_id": 34535662, "comment_id": 57069758, "body": "I&#39;ve ctrl + c and ctrl +v on what you wrote"}, {"owner": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "edited": false, "score": 0, "creation_date": 1452280756, "post_id": 34535662, "comment_id": 57115175, "body": "Now the code works, but not the way it supposed to do.  For example, no matter what date i write on the A1 cell of sheet Busca, it always returns the same results."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "edited": false, "score": 0, "creation_date": 1452280968, "post_id": 34535662, "comment_id": 57115287, "body": "bear in mind that I gave you a <i>sketch of code</i> that will work. You will have to modify the exact methods to get your data moved as needed. There is no possible way for me to know <i>exactly</i> what you needed with the information you provided in your question."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1452190911, "last_edit_date": 1452190911, "creation_date": 1451502618, "answer_id": 34535662, "question_id": 34535040, "link": "https://stackoverflow.com/questions/34535040/vlookup-multiple-sheets-and-report-in-another-sheet/34535662#34535662", "title": "vlookup multiple sheets and report in another sheet", "body": "<p>Here is a sketch of code that will work, with the following assumptions.</p>\n\n<ol>\n<li>The <code>Date &gt; Value &gt; Name &gt; Bank &gt; City</code> data for each customer sheet is located starting in cell A2 (row 1 is headers)</li>\n<li>You place your date in in the <code>Busca</code> sheet into cell A1, and have the <code>Date &gt; Value &gt; Name &gt; Bank &gt; City</code> headers in row 2 of that sheet.</li>\n</ol>\n\n<p>You can modify these assumptions as needed.</p>\n\n<pre><code>Sub Pesquisa()\n\nDim wsB as Worksheet\nSet wsB = ThisWorkbook.Worksheets(\"Busca\")\n\nDim dDate as Date\ndDate = wsB.Range(\"A1\") 'assumes your desired date is in cell A1 of Busca sheet\n\nDim ws as Worksheet\nFor each ws in ThisWorkbook.Worksheets\n\n    If ws.Name &lt;&gt; \"Busca\" Then 'check all sheets except Busca sheet\n\n        ws.Range(\"A1:E1\").AutoFilter 1, dDate\n\n        If Not Intersect(ws.UsedRange,ws.UsedRange.Offset(1)).SpecialCells(xlCellTypeVisible) Is Nothing Then \n            Intersect(ws.UsedRange,ws.UsedRange.Offset(1)).SpecialCells(xlCellTypeVisible).Copy wsB.Range(\"A\" &amp; wsB.Rows.COunt).End(xlUp).Offset(1)\n        End If\n\n    End If\n\n    ws.AutoFilterMode = False\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5731678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fd70be82608806c7780072bd896e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Anauac", "link": "https://stackoverflow.com/users/5731678/anauac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452190911, "creation_date": 1451500024, "last_edit_date": 1451500232, "question_id": 34535040, "link": "https://stackoverflow.com/questions/34535040/vlookup-multiple-sheets-and-report-in-another-sheet", "title": "vlookup multiple sheets and report in another sheet", "body": "<p>I'm working with a workbook that have \"Scheduled Payments\" from many clients, one in each sheet.</p>\n\n<p>The sheets have this structure - Date - Value - Name - Bank - City</p>\n\n<p>What I need to do is, search for a DATE and copy all rows that have that date in another sheet called \"Busca\", searching across all sheets.</p>\n\n<p>I'm beginner and my sketch of code is this so far:</p>\n\n<pre><code>Sub Pesquisa()\n\nDim data As Variant 'declarando a vari\u00e1vel que vai receber a data a ser buscada\nDim linha As String 'declarando a vari\u00e1vel que vai receber o dado encontrado\n\nOn Error Resume Next\n\nWorksheets(\"Busca\").Range(\"relatorio\").ClearContents\n\ndata = B1\n\nEnd Sub\n</code></pre>\n\n<p>If someone can take a hand, I can upload the file too.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "copy", "paste"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1451499211, "post_id": 34534837, "comment_id": 56811376, "body": "you can&#39;t preced an argument with a <code>.</code> unless inside a <code>With</code> block.  So put <code>ws1.Rows(i).Copy Destination:=ws3.range(&quot;A2&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1451499321, "post_id": 34534837, "comment_id": 56811428, "body": "Also your line ` i = ws1.Cells(Rows.Count, 2).End(xlUp).Row` need to be ` z = ws1.Cells(Rows.Count, 2).End(xlUp).Row`"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1451499353, "post_id": 34534837, "comment_id": 56811437, "body": "You&#39;re missing a <code>Next i</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451499443, "post_id": 34534837, "comment_id": 56811481, "body": "(... and switch the whole thing to an <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a>)"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1451500421, "post_id": 34534837, "comment_id": 56811904, "body": "This only catches, copies and pastes one line. How do I change the destination change to roll with the for loop?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451500969, "post_id": 34534837, "comment_id": 56812157, "body": "Where do you want the copied data to go? To the equivalent line on <code>WS3</code> or the next available line in <code>ws3</code> if we paste starting in row 1?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1451501380, "post_id": 34534837, "comment_id": 56812360, "body": "<code>ws1.Rows(i).Copy Destination:=ws3.Range(&quot;A&quot; &amp; ws3.Rows.Count).End(xlUp).Offset (1)</code> will paste it in the next empty row."}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451501526, "post_id": 34534837, "comment_id": 56812442, "body": "@BruceWayne the next available line, but it looks like Scott&#39;s got it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451499572, "post_id": 34534901, "comment_id": 56811539, "body": "Since there is but a single (bad) destination, you might want to <code>Exit For</code> after meeting the first match or change the destination to a new location like the next empty row."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1451499399, "creation_date": 1451499399, "answer_id": 34534901, "question_id": 34534837, "link": "https://stackoverflow.com/questions/34534837/move-rows-to-another-sheet-if-meeting-criteria/34534901#34534901", "title": "Move rows to another sheet if meeting criteria", "body": "<p>Just need to do some \"housekeeping\" on the code:</p>\n\n<pre><code>Sub finddisneys()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim wb As Workbook\nDim ws As Worksheet\n\n\nSet wb = ActiveWorkbook\nSet ws1 = wb.Sheets(\"April\")\nSet ws2 = wb.Sheets(\"alljobs\")\nSet WS3 = wb.Sheets(\"New\")\n\n\ni = ws1.Cells(ws1.Rows.Count, 2).End(xlUp).row ' Added ws1 before \"Rows\" for clarity\nFor i = z To 2 Step -1\n    If ws1.Cells(i, 2) = \"Disney Orlando\" Then\n        ws1.Rows(i).copy Destination:=WS3.Range(\"A\") ' Added ws1, since you didn't have `With` anywhere.\n    End If\nNext i ' Need this to continue the loop\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Edit: Ah, I see Scott and Jeeped are all over it. </p>\n"}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451499399, "creation_date": 1451499091, "question_id": 34534837, "link": "https://stackoverflow.com/questions/34534837/move-rows-to-another-sheet-if-meeting-criteria", "title": "Move rows to another sheet if meeting criteria", "body": "<p>If the cells is equal to Disney Orlando I want to move to worksheet New or a completely new worksheet. As of now the .Rows is causing an error.</p>\n\n<pre><code>Sub finddisneys()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim wb As Workbook\nDim ws As Worksheet\n\n\nSet wb = ActiveWorkbook\nSet ws1 = wb.Sheets(\"April\")\nSet ws2 = wb.Sheets(\"alljobs\")\nSet ws3 = wb.Sheets(\"New\")\n\n\ni = ws1.Cells(Rows.Count, 2).End(xlUp).Row\nFor i = z To 2 Step -1\n    If ws1.Cells(i, 2) = \"Disney Orlando\" Then\n        .Rows(i).Copy Destination:=ws3.range(\"A\")\n    End If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1451508701, "post_id": 34535143, "comment_id": 56816031, "body": "It could be my general ignorance of windows, but I am unable to register this file. It does not even appear to be in my system 32 folder. Even though I copy it there from downloads. I&#39;m getting frustrated with something that should be very simple. I am using fusion on a mac, but I can&#39;t imagine that being the issue"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1451513391, "post_id": 34535143, "comment_id": 56818198, "body": "@DonDesrosiers To register the <b>mscomct2.ocx</b>, first open command prompt As Administrator, then enter <code>regsvr32 &#47;s &quot;C:\\Windows\\SysWOW64\\mscomct2.ocx&quot;</code> assuming that&#39;s the path you copied to."}, {"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1451514875, "post_id": 34535143, "comment_id": 56818862, "body": "ok.  thanks.  that worked.  But the core issue remains.  I don&#39;t see a calendar date picker among the activeX controls.  Assuming that you know what it is called, I will still need help setting this up.  Sigh."}], "tags": [], "owner": {"reputation": 314, "user_id": 5617714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9df3dcd04742d153e64412affe60b916?s=128&d=identicon&r=PG&f=1", "display_name": "Vishesh", "link": "https://stackoverflow.com/users/5617714/vishesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1451500401, "creation_date": 1451500401, "answer_id": 34535143, "question_id": 34534763, "link": "https://stackoverflow.com/questions/34534763/how-to-add-calendar-date-picker/34535143#34535143", "title": "How to add Calendar, Date-Picker?", "body": "<p>I have used mscomct2.ocx file to use a date picker in excel.\nYou need to register it and can then easily use the date picker</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1451518859, "post_id": 34538846, "comment_id": 56820188, "body": "This is exactly what I need, however the correct controls do not appear in my controls list.  There is a button that offers the option to &quot;Register Custom&quot;.  When I navigate to the file, an error message indicates  &quot;Cannot Register this control&quot;.  Now what?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1451522017, "post_id": 34538846, "comment_id": 56821003, "body": "@DonDesrosiers What version of mscomct2.ocx you got? Mine is 6.1.98.16"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 5, "last_activity_date": 1451518053, "creation_date": 1451518053, "answer_id": 34538846, "question_id": 34534763, "link": "https://stackoverflow.com/questions/34534763/how-to-add-calendar-date-picker/34538846#34538846", "title": "How to add Calendar, Date-Picker?", "body": "<p>Once you have registered the <strong>mscomct2.ocx</strong> control (<strong>YOU WILL NEED TO REGISTER THIS FILE ON ALL COMPUTERS THAT WILL USE THIS WORKBOOK!</strong>), you can either add one of below controls in the Worksheet or in a UserForm:</p>\n\n<ul>\n<li>Date and Time Picker (<strong>DTPicker</strong>), left/top of screenshots</li>\n<li><strong>MonthView</strong>, right/bottom of screenshots</li>\n</ul>\n\n<hr>\n\n<p><strong>WORKSHEET (ActiveX)</strong></p>\n\n<ol>\n<li>In Developer tab, Controls group, click Insert, then bottom right\nbutton for More Controls.<br> <a href=\"https://i.stack.imgur.com/FcOjM.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/FcOjM.png\" alt=\"Step1\"></a></li>\n<li>Scroll down and select <strong>Microsoft Date and Time Picker Control 6.0 (SP6)</strong>  or <strong>Microsoft MonthView Control 6.0 (SP6)</strong> then click OK.<br><a href=\"https://i.stack.imgur.com/lNxq4.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/lNxq4.png\" alt=\"Step2a\"></a> | <a href=\"https://i.stack.imgur.com/t7IHq.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/t7IHq.png\" alt=\"Step2b\"></a></li>\n<li>When you are out of Design Mode, clicking on the DTPicker control is like this, while the MonthView takes more space:<br><a href=\"https://i.stack.imgur.com/r9e5a.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/r9e5a.png\" alt=\"Step3a\"></a> | <a href=\"https://i.stack.imgur.com/iL0bx.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/iL0bx.png\" alt=\"Step3b\"></a></li>\n</ol>\n\n<hr>\n\n<p><strong>UserForm</strong></p>\n\n<ol>\n<li>In the Toolbox for the UserForm selected, right click on empty space of the Controls tab, click Additional Controls<br><a href=\"https://i.stack.imgur.com/ljDiE.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ljDiE.png\" alt=\"form step 1\"></a></li>\n<li>Scroll down and tick <strong>Microsoft Date and Time Picker Control 6.0 (SP6)</strong> or <strong>Microsoft MonthView Control 6.0 (SP6)</strong>:<br><a href=\"https://i.stack.imgur.com/qj7L1.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/qj7L1.png\" alt=\"form step 2a\"></a> | <a href=\"https://i.stack.imgur.com/12BFy.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/12BFy.png\" alt=\"form step 2b\"></a></li>\n<li>Now the controls are in your Controls tab to add on UserForms<br><a href=\"https://i.stack.imgur.com/OszHR.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OszHR.png\" alt=\"form step 3\"></a></li>\n<li>Default size of the controls on UserForm:<br><a href=\"https://i.stack.imgur.com/BDkDZ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/BDkDZ.png\" alt=\"form step 4\"></a></li>\n</ol>\n\n<p><hr>\nIn either way, you will need to implement the actions when you click on these controls.</p>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "edited": false, "score": 0, "creation_date": 1533070159, "post_id": 42674629, "comment_id": 90209189, "body": "I love what you&#39;re doing in this code and that you&#39;re using Chip Pierson code.  I&#39;m surprised it isn&#39;t rated higher but I guess no one realized what you&#39;re doing."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "edited": false, "score": 0, "creation_date": 1535035769, "post_id": 42674629, "comment_id": 90926674, "body": "Chip Pierson is definitely a genius and has helped me tremendously with Date and date math.  Chip has a wonderful section on holidays and other work week functions.  Though I used some of his code here (and gave him credit), most of this code is my code geared toward portability of a hand made date picker.  At my work there are some stations that don&#39;t have all the references that my station has and the common EXCEL date picker will  just not work if a station doesn&#39;t have that GUID on it.  This one seems to work fine, knock on wood."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "edited": false, "score": 0, "creation_date": 1535036282, "post_id": 42674629, "comment_id": 90926987, "body": "Also, if you remove the line &quot;ThisWorkbook.VBProject.VBComponents.Remove myForm&quot; then the form will not be removed.  Then you can use the form as any other type form with .show command."}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "edited": false, "score": 0, "creation_date": 1535127713, "post_id": 42674629, "comment_id": 90967144, "body": "Yep I saw that.  I used your code as a base and integrated it into a vacation tracking tool just to show case the power of VBA.  It&#39;s sad but it feels like corporate America is moving away from VBA which I love.  I&#39;m now getting heavy push to use R which really isn&#39;t any better and doesn&#39;t have nearly as robust error handling."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "edited": false, "score": 0, "creation_date": 1535557630, "post_id": 42674629, "comment_id": 91113210, "body": "My own problem is portability. Which is why I built this on-the-fly calendar userform that is universal. Everyone in my  company has MS Office.  Either different versions or some have the necessary references and others don&#39;t.  Those who don&#39;t have the references get nothing but errors, ergo deeming VBA a bunch of crap.  (And my ability as a programmer too.)  So that&#39;s why MS is leaning away from it I guess.  But that&#39;s the fault of the Excel system, not us.  Their error system should alert the user that a reference is missing and how to get it or make references portable in a separate module."}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1594799320, "post_id": 42674629, "comment_id": 111249363, "body": "This is beautiful! This should be the top and the correct answer."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 2, "last_activity_date": 1598540193, "last_edit_date": 1598540193, "creation_date": 1488984948, "answer_id": 42674629, "question_id": 34534763, "link": "https://stackoverflow.com/questions/34534763/how-to-add-calendar-date-picker/42674629#42674629", "title": "How to add Calendar, Date-Picker?", "body": "<p>Some users may not have the ability to use your DatePicker if their Excel is not formatted correctly.  I developed code that will create a dateGetter userform, get the user's date selection as a Global variable, and then delete the form.  It should be compatible with most systems, though I haven't tested it on others than my own.  Give it a shot.  If it works for you, give me a shout out....</p>\n<p>August 2020:\nFixed a glitch - when selecting the original date that opened with the form the returning date was &quot;00:00:00 AM&quot; - I fixed that below to return the date showing in the label2 caption.</p>\n<p>Also - MSForms reference is necessary for the dateGetter() subroutine to work properly or you get an error message when the forms objects are declared.  I've added another subroutine that can add that reference through VBA code, or in the VBA Editor goto &quot;Tools --&gt; References&quot; and select the MSForms refwerence.  You must do this before attempting to run the dateGetter macro.</p>\n<pre><code>Public absDate As Date ' This Public Variable is necessary to pass selected date\n\nSub setGUIDReferences()\n'   NOTE:  The dateGetter() sub will not work until the MSForms Reference is added to this workbook project\n'   You can add the MSForms reference by running this sub first\n'   Or go to Tools --&gt; References and select the MSForms reference there\n'   included below are several other common references you can use for other projects just uncomment them to add\n'   *************************************************************************************************************\n\n    On Error Resume Next\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{000204EF-0000-0000-C000-000000000046}&quot;, 0, 0    '       Visual Basic For Applications\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{00020813-0000-0000-C000-000000000046}&quot;, 0, 0    '       Microsoft Excel 16.0 Object Library\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{00020430-0000-0000-C000-000000000046}&quot;, 0, 0    '       OLE Automation\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}&quot;, 0, 0    '       Microsoft Office 16.0 Object Library\n    ThisWorkbook.VBProject.References.AddFromGuid &quot;{0D452EE1-E08F-101A-852E-02608C4D0BB4}&quot;, 0, 0    '       Microsoft Forms 2.0 Object Library\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{3050F1C5-98B5-11CF-BB82-00AA00BDCE0B}&quot;, 0, 0    '       Microsoft HTML Object Library\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}&quot;, 0, 0    '       Microsoft Internet Controls\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{420B2830-E718-11CF-893D-00A0C9054228}&quot;, 0, 0    '       Microsoft Scripting Runtime\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}&quot;, 0, 0    '       Microsoft Windows Common Controls-2 6.0 (SP6)\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{4AFFC9A0-5F99-101B-AF4E-00AA003F0F07}&quot;, 0, 0    '       Microsoft Access 16.0 Object Library\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{0002E157-0000-0000-C000-000000000046}&quot;, 0, 0    '       Microsoft Visual Basic for Applications Extensibility 5.3\n    'ThisWorkbook.VBProject.References.AddFromGuid &quot;{F5078F18-C551-11D3-89B9-0000F81FE221}&quot;, 0, 0    '       Microsoft MSXML2 for XML Scraping\n    On Error GoTo 0\nEnd Sub\n\nSub dateGetter()\n'   This creates dategetter userform for those without access to date picker\n'   Bug Fixed: Aug 2020, Selecting Original Date was resulting in 12:00:00 AM\n\n'*********\n'   Note: MSForms Reference in Tools menu must be added to workbook first before this calendar script will work\n'   You can add several commonly used references by running the &quot;setGUIDReferences()&quot; subroutine above.\n'   Or go to Tools --&gt; References and select the MSForms reference there\n'*********\n\nDim myForm As Object, calendarForm As Object, newLabel As MSForms.Label, newSpinner As MSForms.SpinButton\nDim NewFrame As MSForms.Frame\nDim NewButton As MSForms.CommandButton, newButton2 As MSForms.CommandButton\nDim NewListBox As MSForms.ListBox\nDim smallDayArray\nDim xDiff As Long\nDim smallTextArray\nDim startDate As Date\nDim endDate As Date\n    \n    Set myForm = ThisWorkbook.VBProject.VBComponents.Add(3)\n    \n    'Create the User Form\n    With myForm\n        .Properties(&quot;Caption&quot;) = &quot;Select Date Range&quot;\n        .Properties(&quot;Width&quot;) = 247.5\n        .Properties(&quot;Height&quot;) = 350\n    End With\n    \n    'create button\n    Set NewButton = myForm.designer.Controls.Add(&quot;Forms.commandbutton.1&quot;)\n    With NewButton\n        .Name = &quot;CommandButton1&quot;\n        .Top = 288\n        .Left = 138\n        .Width = 42\n        .Height = 24\n        .Font.Size = 10\n        .Font.Name = &quot;Tahoma&quot;\n        .Caption = &quot;Cancel&quot;\n    End With\n    \n    'create button\n    Set NewButton = myForm.designer.Controls.Add(&quot;Forms.commandbutton.1&quot;)\n    With NewButton\n        .Name = &quot;CommandButton2&quot;\n        .Top = 288\n        .Left = 186\n        .Width = 42\n        .Height = 24\n        .Font.Size = 10\n        .Font.Name = &quot;Tahoma&quot;\n        .Caption = &quot;Select&quot;\n    End With\n    \n    \n    'create frame\n    Set NewFrame = myForm.designer.Controls.Add(&quot;Forms.frame.1&quot;)\n    With NewFrame\n        .Name = &quot;Frame1&quot;\n        .Top = 54\n        .Left = 24\n        .Width = 192\n        .Height = 180\n        .Font.Size = 9\n        .Font.Name = &quot;Tahoma&quot;\n    End With\n    \n    'Create label1\n    Set newLabel = myForm.designer.Controls.Add(&quot;Forms.Label.1&quot;)\n    With newLabel\n        .Name = &quot;Label1&quot;\n        .Top = 30\n        .Left = 30\n        .Width = 102\n        .Height = 18\n        .Font.Size = 12\n        .Font.Name = &quot;Tahoma&quot;\n        .ForeColor = RGB(128, 0, 0)\n        .BackColor = RGB(256, 256, 256)\n        .Caption = &quot;November 2017&quot;\n    End With\n    \n    'Create label2\n    Set newLabel = myForm.designer.Controls.Add(&quot;Forms.Label.1&quot;)\n    With newLabel\n        .Name = &quot;Label2&quot;\n        .Top = 258\n        .Left = 36\n        .Width = 174\n        .Height = 18\n        .Font.Size = 12\n        .Font.Name = &quot;Tahoma&quot;\n        .ForeColor = RGB(0, 0, 0)\n        .Caption = &quot;01/01/2017&quot;\n    End With\n    \n    \n    'Create SpinButton1\n    Set newSpinner = myForm.designer.Controls.Add(&quot;Forms.spinbutton.1&quot;)\n    With newSpinner\n        .Name = &quot;SpinButton1&quot;\n        .Top = 24\n        .Left = 144\n        .Width = 12.75\n        .Height = 25\n    End With\n    \n    'Create Calendar Header Labels\n    smallDayArray = Array(&quot;S&quot;, &quot;M&quot;, &quot;T&quot;, &quot;W&quot;, &quot;T&quot;, &quot;F&quot;, &quot;S&quot;)\n    smallTextArray = Array(&quot;day1&quot;, &quot;day2&quot;, &quot;day3&quot;, &quot;day4&quot;, &quot;day5&quot;, &quot;day6&quot;, &quot;day7&quot;)\n    xDiff = 18\n    For i = LBound(smallDayArray) To UBound(smallDayArray)\n        Set lbl = NewFrame.Controls.Add(&quot;Forms.Label.1&quot;)\n        With lbl\n            .Name = smallTextArray(i)\n            .Top = 6\n            .Left = xDiff\n            .Width = 12\n            .Height = 18\n            .Font.Size = 11\n            .Font.Name = &quot;Tahoma&quot;\n            .Caption = smallDayArray(i)\n        End With\n        xDiff = xDiff + 24\n    Next i\n    \n    'Create Calendar boxes labels\n    arrCounter = 1\n    For j = 1 To 6\n        xDiff = 12\n        For k = 1 To 7\n            Set lbl = NewFrame.Controls.Add(&quot;Forms.Label.1&quot;)\n            With lbl\n                .Name = &quot;lb_&quot; &amp; arrCounter\n                Select Case j\n                    Case 1\n                        .Top = 24\n                    Case 2\n                        .Top = 48\n                    Case 3\n                        .Top = 72\n                    Case 4\n                        .Top = 96\n                    Case 5\n                        .Top = 120\n                    Case 6\n                        .Top = 144\n                End Select\n                .Left = xDiff\n                .Width = 18\n                .Height = 18\n                .Font.Size = 11\n                .Font.Name = &quot;Tahoma&quot;\n                .Caption = &quot; &quot; &amp; arrCounter\n                .ForeColor = RGB(128, 0, 0)\n                .BackColor = RGB(256, 256, 256)\n            End With\n            arrCounter = arrCounter + 1\n            xDiff = xDiff + 24\n        Next k\n    Next j\n    ''add code for form module\n    myForm.codemodule.insertlines 1, &quot;Private Sub CommandButton1_Click()&quot;\n    myForm.codemodule.insertlines 2, &quot;absDate = 0&quot;\n    myForm.codemodule.insertlines 3, &quot;Unload Me&quot;\n    myForm.codemodule.insertlines 4, &quot;End Sub&quot;\n    myForm.codemodule.insertlines 5, &quot;&quot;\n    myForm.codemodule.insertlines 6, &quot;Private Sub SpinButton1_SpinDown()&quot;\n    myForm.codemodule.insertlines 7, &quot;Dim newDate1 As Date&quot;\n    myForm.codemodule.insertlines 8, &quot;    newDate1 = DateValue(Left(Label1.Caption, Len(Label1.Caption) - 5) &amp; &quot; &amp; Chr(34) &amp; &quot; 1, &quot; &amp; Chr(34) &amp; &quot; &amp; Right(Label1.Caption, 4))&quot;\n    myForm.codemodule.insertlines 9, &quot;    newDate1 = DateAdd(&quot; &amp; Chr(34) &amp; &quot;m&quot; &amp; Chr(34) &amp; &quot;, -1, newDate1)&quot;\n    myForm.codemodule.insertlines 10, &quot;    Label1.Caption = MonthName(Month(newDate1)) &amp; &quot; &amp; Chr(34) &amp; &quot; &quot; &amp; Chr(34) &amp; &quot; &amp; Year(newDate1)&quot;\n    myForm.codemodule.insertlines 11, &quot;    Call clearBoxes&quot;\n    myForm.codemodule.insertlines 12, &quot;   Run fillCal(newDate1)&quot;\n    myForm.codemodule.insertlines 13, &quot;End Sub&quot;\n    myForm.codemodule.insertlines 14, &quot;Private Sub SpinButton1_SpinUp()&quot;\n    myForm.codemodule.insertlines 15, &quot;Dim newDate1 As Date&quot;\n    myForm.codemodule.insertlines 16, &quot;    newDate1 = DateValue(Left(Label1.Caption, Len(Label1.Caption) - 5) &amp; &quot; &amp; Chr(34) &amp; &quot; 1, &quot; &amp; Chr(34) &amp; &quot; &amp; Right(Label1.Caption, 4))&quot;\n    myForm.codemodule.insertlines 17, &quot;    newDate1 = DateAdd(&quot; &amp; Chr(34) &amp; &quot;m&quot; &amp; Chr(34) &amp; &quot;, 1, newDate1)&quot;\n    myForm.codemodule.insertlines 18, &quot;    Label1.Caption = MonthName(Month(newDate1)) &amp; &quot; &amp; Chr(34) &amp; &quot; &quot; &amp; Chr(34) &amp; &quot; &amp; Year(newDate1)&quot;\n    myForm.codemodule.insertlines 19, &quot;    Call clearBoxes&quot;\n    myForm.codemodule.insertlines 20, &quot;    Run fillCal(newDate1)&quot;\n    myForm.codemodule.insertlines 21, &quot;End Sub&quot;\n    myForm.codemodule.insertlines 22, &quot;Function dhDaysInMonth2(Optional dtmDate As Date = 0) As Integer&quot;\n    myForm.codemodule.insertlines 23, &quot;    ' Return the number of days in the specified month.  Written by Chip Pierson&quot;\n    myForm.codemodule.insertlines 24, &quot;    If dtmDate = 0 Then&quot;\n    myForm.codemodule.insertlines 25, &quot;        ' Did the caller pass in a date? If not, use&quot;\n    myForm.codemodule.insertlines 26, &quot;        ' the current date.&quot;\n    myForm.codemodule.insertlines 27, &quot;        dtmDate = Date&quot;\n    myForm.codemodule.insertlines 28, &quot;    End If&quot;\n    myForm.codemodule.insertlines 29, &quot;    dhDaysInMonth2 = DateSerial(Year(dtmDate), _ &quot;\n    myForm.codemodule.insertlines 30, &quot;     Month(dtmDate) + 1, 1) - _ &quot;\n    myForm.codemodule.insertlines 31, &quot;     DateSerial(Year(dtmDate), Month(dtmDate), 1)&quot;\n    myForm.codemodule.insertlines 32, &quot;End Function&quot;\n    myForm.codemodule.insertlines 33, &quot;Public Sub UserForm_Activate()&quot;\n    myForm.codemodule.insertlines 34, &quot;Dim currentDate As Date&quot;\n    myForm.codemodule.insertlines 35, &quot;&quot;\n    myForm.codemodule.insertlines 36, &quot; For i = 1 To 42&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 37, &quot;     txt = txt &amp; &quot; &amp; Chr(34) &amp; &quot;Private Sub lb_&quot; &amp; Chr(34) &amp; &quot; &amp; i &amp; &quot; &amp; Chr(34) &amp; &quot;_Click()&quot; &amp; Chr(34) &amp; &quot; &amp; vbNewLine&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 38, &quot;     txt = txt &amp; &quot; &amp; Chr(34) &amp; &quot;Dim newDate As Date&quot; &amp; Chr(34) &amp; &quot; &amp; vbNewLine&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 39, &quot; txt = txt &amp; &quot; &amp; Chr(34) &amp; &quot;newDate = DateValue(Mid(Label1.Caption, 1, Len(Label1.Caption) - 5) &amp;&quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp;   &quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot; &amp; lb_&quot; &amp; &quot; &amp; i &amp; &quot; &amp; Chr(34) &amp; &quot;.Caption &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Right(Label1.Caption, 4))&quot; &amp; Chr(34) &amp; &quot; &amp; vbNewLine&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 40, &quot;     txt = txt &amp; &quot; &amp; Chr(34) &amp; &quot;Label2.Caption = &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot;Date:  &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; Chr(34) &amp; &quot; &amp; newDate&quot; &amp; Chr(34) &amp; &quot; &amp; vbNewLine&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 41, &quot;txt = txt &amp; &quot; &amp; Chr(34) &amp; &quot;End Sub&quot; &amp; Chr(34) &amp; &quot; &amp; vbNewLine&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 42, &quot;Next i&quot; &amp; vbNewLine\n    myForm.codemodule.insertlines 43, &quot;&quot;\n    myForm.codemodule.insertlines 44, &quot;Label2.Caption =  Chr(34) &amp;  Chr(34) &quot;\n    myForm.codemodule.insertlines 45, &quot;currentDate = DateValue(Month(Date) &amp; &quot; &amp; Chr(34) &amp; &quot; 1&quot; &amp; Chr(34) &amp; &quot; &amp; &quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot; &amp; Year(Date))&quot;\n    myForm.codemodule.insertlines 46, &quot;Run fillCal(currentDate)&quot;\n    myForm.codemodule.insertlines 47, &quot;End Sub&quot;\n    myForm.codemodule.insertlines 48, &quot;Function fillCal(startDate As Date)&quot;\n    myForm.codemodule.insertlines 49, &quot;Dim currentDayOfMonth As Integer, i As Integer&quot;\n    myForm.codemodule.insertlines 50, &quot;currentDayOfMonth = Day(Date)&quot;\n    myForm.codemodule.insertlines 51, &quot;Dim startCal As Date, currentMonth as Integer&quot;\n    myForm.codemodule.insertlines 52, &quot;Dim labelArray, sumVar3 As Long&quot;\n    myForm.codemodule.insertlines 53, &quot;    Label2.Caption = &quot; &amp; Chr(34) &amp; &quot;&quot; &amp; Chr(34)\n    myForm.codemodule.insertlines 54, &quot;    labelArray = Array(&quot; &amp; Chr(34) &amp; &quot;lb_1&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_2&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_3&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_4&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_5&quot; _\n                                                                &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_6&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_7&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_8&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_9&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) _\n                                                                &amp; &quot;lb_10&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_11&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_12&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_13&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_14&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_15&quot; &amp; Chr(34) &amp; &quot;,  _&quot;\n    myForm.codemodule.insertlines 55, &quot;                      &quot; &amp; Chr(34) &amp; &quot;lb_16&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_17&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_18&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_19&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_20&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_21&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_22&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_23&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_24&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_25&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_26&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_27&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_28&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_29&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_30&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_31&quot; &amp; Chr(34) &amp; &quot;, _&quot;\n    myForm.codemodule.insertlines 56, &quot;                      &quot; &amp; Chr(34) &amp; &quot;lb_32&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_33&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_34&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_35&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_36&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_37&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_38&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_39&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_40&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_41&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_42&quot; &amp; Chr(34) &amp; &quot;)&quot;\n    myForm.codemodule.insertlines 57, &quot;    Label1 = MonthName(Month(startDate)) &amp; &quot; &amp; Chr(34) &amp; &quot; &quot; &amp; Chr(34) &amp; &quot; &amp; Year(startDate)&quot;\n    myForm.codemodule.insertlines 58, &quot;    sumVar3 = Weekday(startDate) - 1&quot;\n    myForm.codemodule.insertlines 59, &quot;    &quot;\n    myForm.codemodule.insertlines 60, &quot;    For i = LBound(labelArray) To UBound(labelArray)&quot;\n    myForm.codemodule.insertlines 61, &quot;            Me.Controls(labelArray(i)).Caption = &quot; &amp; Chr(34) &amp; &quot;&quot; &amp; Chr(34) &amp; &quot;&quot;\n    myForm.codemodule.insertlines 62, &quot;    Next i&quot;\n    myForm.codemodule.insertlines 63, &quot;    &quot;\n    myForm.codemodule.insertlines 64, &quot;     For i = 1 To dhDaysInMonth2(startDate)&quot;\n    myForm.codemodule.insertlines 65, &quot;         Me.Controls(labelArray(sumVar3)).Caption = i&quot;\n    myForm.codemodule.insertlines 66, &quot;         If currentDayOfMonth = i And month(Date) = Month(StartDate)  And Year(Date) = Year(StartDate) Then&quot;\n    myForm.codemodule.insertlines 67, &quot;             Me.Controls(labelArray(sumVar3)).BackColor = RGB(256, 0, 0)&quot;\n    myForm.codemodule.insertlines 68, &quot;             Me.Controls(labelArray(sumVar3)).ForeColor = RGB(256, 256, 256)&quot;\n    myForm.codemodule.insertlines 69, &quot;             Label2.Caption = &quot; &amp; Chr(34) &amp; &quot;Date:  &quot; &amp; Chr(34) &amp; &quot; &amp; DateValue(Month(startDate) &amp; &quot; &amp; Chr(34) &amp; &quot;/&quot; &amp; Chr(34) &amp; &quot; &amp; i &amp; &quot; &amp; Chr(34) &amp; &quot;/&quot; &amp; Chr(34) &amp; &quot; &amp; Year(startDate))&quot;\n    myForm.codemodule.insertlines 70, &quot;        End If&quot;\n    myForm.codemodule.insertlines 71, &quot;        sumVar3 = sumVar3 + 1&quot;\n    myForm.codemodule.insertlines 72, &quot;     Next i&quot;\n    myForm.codemodule.insertlines 73, &quot;    &quot;\n    myForm.codemodule.insertlines 74, &quot;End Function&quot;\n    myForm.codemodule.insertlines 75, &quot;Private Sub CommandButton2_Click()&quot;\n    myForm.codemodule.insertlines 76, &quot;    absDate = Replace(Me.Label2.Caption, &quot; &amp; Chr(34) &amp; &quot;Date:  &quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;):Unload Me&quot;\n    myForm.codemodule.insertlines 77, &quot;End Sub&quot;\n    myForm.codemodule.insertlines 78, &quot;Private Sub clearBoxes()&quot;\n    myForm.codemodule.insertlines 79, &quot;Dim labelArray&quot;\n    myForm.codemodule.insertlines 80, &quot;     Label2.Caption = &quot; &amp; Chr(34) &amp; &quot;&quot; &amp; Chr(34)\n    myForm.codemodule.insertlines 81, &quot;    labelArray = Array(&quot; &amp; Chr(34) &amp; &quot;lb_1&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_2&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_3&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_4&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_5&quot; _\n                                                                &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_6&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_7&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_8&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_9&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) _\n                                                                &amp; &quot;lb_10&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_11&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_12&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_13&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_14&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_15&quot; &amp; Chr(34) &amp; &quot;,  _&quot;\n    myForm.codemodule.insertlines 82, &quot;                      &quot; &amp; Chr(34) &amp; &quot;lb_16&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_17&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_18&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_19&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_20&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_21&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_22&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_23&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_24&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_25&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_26&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_27&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_28&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_29&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_30&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_31&quot; &amp; Chr(34) &amp; &quot;, _&quot;\n    myForm.codemodule.insertlines 83, &quot;                      &quot; &amp; Chr(34) &amp; &quot;lb_32&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_33&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_34&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_35&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_36&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; _\n                                                                Chr(34) &amp; &quot;lb_37&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_38&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_39&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_40&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_41&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;lb_42&quot; &amp; Chr(34) &amp; &quot;)&quot;\n    myForm.codemodule.insertlines 84, &quot;      For i = lbound(labelArray) to ubound(labelArray)&quot;\n    myForm.codemodule.insertlines 85, &quot;         Me.Controls(labelArray(i)).BackColor = RGB(256, 256, 256)&quot;\n    myForm.codemodule.insertlines 86, &quot;         Me.Controls(labelArray(i)).ForeColor = RGB(0, 0, 0)&quot;\n    myForm.codemodule.insertlines 87, &quot;      next i&quot;\n    myForm.codemodule.insertlines 88, &quot;End Sub&quot;\n    '   add click controls for date label boxes\n    Dim myCounter As Long\n    myCounter = 89\n        For i = 1 To 42\n            myForm.codemodule.insertlines myCounter, &quot;Private Sub lb_&quot; &amp; i &amp; &quot;_Click()&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;Dim newDate As Date&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;Call clearBoxes&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;absDate = DateValue(Left(Label1.Caption, Len(Label1.Caption) - 5) &amp; &quot; &amp; Chr(34) &amp; Chr(32) &amp; Chr(34) &amp; &quot; &amp; lb_&quot; &amp; i &amp; &quot;.Caption &amp; &quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Chr(38) &amp; &quot; Right(Label1.Caption, 4))&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;Label2.Caption = &quot; &amp; Chr(34) &amp; &quot;Date:  &quot; &amp; Chr(34) &amp; &quot; &amp; absDate&quot; &amp; vbNewLine\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;lb_&quot; &amp; i &amp; &quot;.backcolor = rgb(256,0,0)&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;lb_&quot; &amp; i &amp; &quot;.forecolor = rgb(256,256,256)&quot;\n            myCounter = myCounter + 1\n            myForm.codemodule.insertlines myCounter, &quot;End Sub&quot; &amp; vbNewLine\n            myCounter = myCounter + 1\n    Next i\n    'Add and show new userform\n    absDate = Format(Date, &quot;mm/dd/yyyy&quot;)\n    Set calendarForm = VBA.UserForms.Add(myForm.Name)\n    calendarForm.Show\n    \n    \n    If absDate &lt;&gt; 0 Then\n    '   Here is where you put your code to to use the selected date\n    '   whhich is in the global variabole &quot;absDate&quot;\n        startDate = absDate\n        Debug.Print &quot;Your First Date is &quot; &amp; startDate\n    Else\n        Beep\n        MsgBox &quot;You did not select a date&quot;\n        GoTo endItAll\n    End If\n    \n    \n     \nendItAll:\n    '   Uncomment the following line if you want to delete the form after using it\n    ThisWorkbook.VBProject.VBComponents.Remove myForm\nEnd Sub\nFunction dhDaysInMonth(Optional dtmDate As Date = 0) As Integer\n    ' Return the number of days in the specified month.  Written by Chip Pierson\n    If dtmDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\n    End If\n    dhDaysInMonth2 = DateSerial(Year(dtmDate), _\n     Month(dtmDate) + 1, 1) - _\n     DateSerial(Year(dtmDate), Month(dtmDate), 1)\nEnd Function\n</code></pre>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "is_accepted": false, "score": 0, "last_activity_date": 1512665247, "creation_date": 1512665247, "answer_id": 47699870, "question_id": 34534763, "link": "https://stackoverflow.com/questions/34534763/how-to-add-calendar-date-picker/47699870#47699870", "title": "How to add Calendar, Date-Picker?", "body": "<p>Using DTPicker (Date Picker) element in VBA Excel Module makes your work unsharable. That happened to me many times. I usually share my works with mates and they weren't able to proceed whenever they have been encountered with DTPicker missing library problems.</p>\n\n<p>Installing Microsoft Common Control 2 SP6 and then Register its service is not an everyone's cup of tea. So, Instead of using DTPicker element, I have developed my own Date Picker which is more convenient, easy and applicable. </p>\n\n<p>here's the link to the Form File.\n<a href=\"https://www.dropbox.com/s/bwxtkw03kytcv8v/Form%20Files.rar?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/bwxtkw03kytcv8v/Form%20Files.rar?dl=0</a></p>\n\n<p>Steps to use this Form</p>\n\n<ol>\n<li>Import it</li>\n<li>Now, in your USERFORM, in Date area (textbox), execute my form file with double-click event. </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/J2iY1.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}], "owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31975, "favorite_count": 1, "accepted_answer_id": 34538846, "answer_count": 4, "score": 2, "last_activity_date": 1598540193, "creation_date": 1451498737, "last_edit_date": 1584482457, "question_id": 34534763, "link": "https://stackoverflow.com/questions/34534763/how-to-add-calendar-date-picker", "title": "How to add Calendar, Date-Picker?", "body": "<p>I need to add a Calendar Date Picker in Excel 2013.</p>\n\n<p>I found that the MonthView and the DT Picker are no longer in the ActiveX menu and the links for a CAB file that supposedly contains these does not work. There are instruction documents, but they rely on a control that doesn't exist.</p>\n\n<p>I have an Excel Addin that does what I want, but I want to do this with VBA rather than install the Addin on every machine that will use this.</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1451499730, "post_id": 34534727, "comment_id": 56811605, "body": "not sure of the scope of <code>ObjA</code>, so just a thought: what happens if you try <code>IE.document.getElementById(&quot;ElementID&quot;).Click</code>?"}, {"owner": {"reputation": 21, "user_id": 5731615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99a50b17aefb72d4d68412f941b3921?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5731615/steve"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451500451, "post_id": 34534727, "comment_id": 56811916, "body": "Oh wow! That was too easy. Thank you! I had defined ObjA as an Object based on previous experience but when I removed that reference it worked."}], "owner": {"reputation": 21, "user_id": 5731615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99a50b17aefb72d4d68412f941b3921?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5731615/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 754, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1451499816, "creation_date": 1451498586, "last_edit_date": 1531164843, "question_id": 34534727, "link": "https://stackoverflow.com/questions/34534727/calling-javascript-function-with-arguments-in-html-document-using-vba", "title": "Calling Javascript Function with Arguments in HTML document using VBA", "body": "<p>I tried searching through the forums to find the answer to this question but I can't seem to get down a solution that works. I have a website I'm trying to access and the only way that I can navigate through it is by clicking through it and waiting for the next page to load. However, I've run one section I can't seem to activate. Below is the HTML code that I've located via Inspect Element for the button that I need to select to follow to the next page.</p>\n\n<pre><code>&lt;a class=\"tabLinkMenu\" id=\"ElementID\";\" \nonclick=\"selectOneItem('LinktoNextPage');fnLink('argument1','argument2','argument3');\" \nhref=\"javascript:void(0);\"&gt;Inner Text&lt;/a&gt;`\n</code></pre>\n\n<p>To access this piece of the code, I'm using the following VBA code which generates the HTML above when I debug.print.</p>\n\n<pre><code>Set ObjA = IE.document.getElementById(\"ElementID\")\n</code></pre>\n\n<p>I've tried running \"ObjA.Click\" in VBA to go to follow the link but nothing happens. I believe this has to do with the \"fnLink\" located within the code but I can't seem to locate that function in the JavaScript sections nor were my attempts to call it effective. </p>\n\n<p>I tried calling the function in VBA using these methods with no avail.</p>\n\n<ol>\n<li><p>this</p>\n\n<pre><code>IE.navigate (\"javascript:fnLink('argument 1','argument 2','argument 3');\")\n</code></pre></li>\n<li><p>and this</p>\n\n<pre><code>IE.document.parentWindow.execScript \"javascript:fnLink('argument 1','argument 2','argument 3');\"\n</code></pre></li>\n</ol>\n\n<p>This is a secure site so I can't provide the entire HTML code.</p>\n\n<p>I appreciate any advice you may have.</p>\n\n<p>Thanks!</p>\n\n<p>S</p>\n"}, {"tags": ["javascript", "excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451497122, "post_id": 34534329, "comment_id": 56810305, "body": "<a href=\"http://stackoverflow.com/questions/25098263/how-to-use-findwindow-to-find-a-visible-or-invisible-window-with-a-partial-name\">this</a> may help"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1451497191, "post_id": 34534329, "comment_id": 56810340, "body": "@ScottHoltzman Many thanks! :)"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451498696, "post_id": 34534329, "comment_id": 56811140, "body": "@ScottHoltzman Thank you, I&#39;ve just confirmed that that did the trick! If you&#39;d like to repost this as an answer I&#39;d be happy to accept it. :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451499015, "post_id": 34534329, "comment_id": 56811295, "body": "it&#39;s all good. Providing a link isn&#39;t much of an answer (even though it served you very well here :)). Glad you got it sorted out :)"}], "owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1362, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451763759, "creation_date": 1451496964, "last_edit_date": 1531164843, "question_id": 34534329, "link": "https://stackoverflow.com/questions/34534329/how-to-use-vba-to-close-or-reference-a-pdf-window-that-has-been-opened-as-par", "title": "How to use VBA to close (or reference) a .pdf window that has been opened as part of an Excel process?", "body": "<p>I have a .pdf document with Javascript which I need to load via an Excel userform, but I am having a problem with a superfluous blank .pdf window that I cannot seem to reference in VBA so that I can close it programmatically.</p>\n\n<p>To begin with, the .pdf file in question is such that clicking on a link within the document will execute the following JS:</p>\n\n<pre><code>var nameString = \"1234-A\";\nvar myDoc = app.newDoc()\nmyDoc.saveAs(\"/C/Users/user/TEST/\" + nameString + \".pdf\");\nmyDoc.closeDoc();\n</code></pre>\n\n<p>As you can see, all this does is creates a new document (which automatically opens in a new window), saves it in a particular place with a particular name, and then closes the resulting window. This all works exactly as intended when I open the .pdf document with Acrobat.</p>\n\n<p>I'm running into a small problem when I load this .pdf via an Excel userform, as I need to do as part of my larger project. In this case, the basic function of the JS still performs as expected (creates a new blank .pdf, and saves it in the proper location and with the proper name).</p>\n\n<p>The problem arises with the final step. Where the acrobat-opened instances of this file close the entire window corresponding to the \"myDoc\" file, in the Excel-opened version, I am only able to close the file within the larger window.</p>\n\n<p>In other words, the difference in behavior of the <code>myDoc.closeDoc();</code> command as follows:</p>\n\n<p>In acrobat, this command performs as if the user had clicked the larger red X in the main control box of the window where \"myDoc\" is opened.</p>\n\n<p>In an excel userform, the same command seems to act as if the user had clicked, not the large red x in the control box, but just the smaller black x just below the control box. That is, it closes the document while leaving the window open.</p>\n\n<p>This wouldnt be a problem if I could just somehow manage to close the empty window using VBA...unfortunately, I don't know how I should refer to this empty window.</p>\n\n<p><strong>My question is, how would I refer to this window in Excel VBA, so that I might be able to close it programmatically?</strong> </p>\n\n<p>The window itself looks exactly as an adobe window would, but it shows up in the task bar as an open Excel window. The task manager shows an \"application\" for both adobe acrobat and excel, but also indicates that there is no adobe acrobat process running...the Adobe application is shown as belonging to the EXCEL.EXE process.</p>\n\n<p>VBA doesn't seem to recognize the empty .pdf window as any sort of Excel object. But I also don't seem to be able to simply close all instances of Adobe Acrobat, because strictly speaking there are no adobe acrobat processes running.</p>\n\n<p>Hopefully I'm just missing an easy piece of syntax here, but obviously I'm not sure about that. Can anybody point me in the right direction?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451497326, "post_id": 34534193, "comment_id": 56810407, "body": "What drives the creation of the linked table?  Is that done with Excel VBA code?  Or is that an entirely manual operation?"}, {"owner": {"reputation": 11, "user_id": 5731510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d18992448d117c096921331ccc3e7d7?s=128&d=identicon&r=PG&f=1", "display_name": "D. Zippel", "link": "https://stackoverflow.com/users/5731510/d-zippel"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451509411, "post_id": 34534193, "comment_id": 56816368, "body": "It is entirely a manual process.  The user goes to the original software (IBM&#39;s WebSphere Service Registry and Repository), opens a BIRT report and exports it to what BIRT calls Excel (really an XML file).  The user then opens the XML file in Excel 2010 and saves it as an Excel 2010 file.  There are some field formatting changes that the user has to do - text to number - as well."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451510955, "post_id": 34534193, "comment_id": 56817117, "body": "Is the XML file&#39;s date/time attribute a reasonable substitute for the linked table&#39;s creation date?  Or perhaps the same attribute for the Excel file itself?"}, {"owner": {"reputation": 11, "user_id": 5731510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d18992448d117c096921331ccc3e7d7?s=128&d=identicon&r=PG&f=1", "display_name": "D. Zippel", "link": "https://stackoverflow.com/users/5731510/d-zippel"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451512130, "post_id": 34534193, "comment_id": 56817621, "body": "The XML file&#39;s date/time attribute is the important thing.  It should be the same as the Excel table, since I expect the user will do the BIRT to Excel conversion on the same day.  However, what upper management will want to know is how &quot;fresh&quot; the information in the report is, which is the date of the XML file."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451512363, "post_id": 34534193, "comment_id": 56817736, "body": "Then does VBA like this give you what you want?  <code>MsgBox FileDateTime(&quot;C:\\SomeFolder\\YourFile.XML&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 5731510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d18992448d117c096921331ccc3e7d7?s=128&d=identicon&r=PG&f=1", "display_name": "D. Zippel", "link": "https://stackoverflow.com/users/5731510/d-zippel"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451513733, "post_id": 34534193, "comment_id": 56818350, "body": "Would I put code like that in the VBA for the report? For a textbox?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1451519531, "post_id": 34534193, "comment_id": 56820363, "body": "Do note MS Access can also <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823157.aspx\" rel=\"nofollow noreferrer\">import XML</a> directly and even into multiple tables depending on structure."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1457114414, "post_id": 34534193, "comment_id": 59275283, "body": "I agree with @Parfait, you can use importing to XML. you tube has few videos to demonstrate. IT is very easy to implement"}], "owner": {"reputation": 11, "user_id": 5731510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d18992448d117c096921331ccc3e7d7?s=128&d=identicon&r=PG&f=1", "display_name": "D. Zippel", "link": "https://stackoverflow.com/users/5731510/d-zippel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451580338, "creation_date": 1451496473, "last_edit_date": 1451580338, "question_id": 34534193, "link": "https://stackoverflow.com/questions/34534193/need-to-add-the-date-of-a-linked-table-to-an-access-report", "title": "Need to add the date of a linked table to an Access report", "body": "<p>I have created an Access database that takes information from linked Excel tables to create queries, reports, etc.  The Excel tables are created by extracting data from another program via BIRT, saving the XML tables BIRT creates and then converting them to Excel.  We can't just import the files as XML because Access 2010 splits the information into several (unusable) tables.My users will be doing this frequently, once each week or more often, in order to keep the information in the reports \"fresh\".</p>\n\n<p>How can I put the date the linked table was created into a report?  Can it even be done at all?</p>\n\n<p>I have looked on the Web and through various other sites, but no one seems to address this question.  I have considered making a table where the user would be required to put in the date the tables were created and using that information in the reports, but I am afraid of user resentment, which is already pretty high at the thought of having to extract data via BIRT in the first place.  The only reason we are doing this at all is because BIRT reports are \"ugly\" and hard for upper management to read, which is a compelling business use case.</p>\n\n<p>Ideas, please?</p>\n"}, {"tags": ["vba", "excel", "tabs"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451495582, "post_id": 34533929, "comment_id": 56809474, "body": "<code>Sheets(&quot;cell.value&quot;).Range(&quot;A1:L500&quot;).Copy</code> try removing the <code>&quot;&quot;</code> from <code>&quot;cell.value&quot;</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451496118, "post_id": 34533929, "comment_id": 56809758, "body": "also do you really want to loop through <i>every cell</i> in column B - <code>For Each Cell In ws.Columns(&quot;B&quot;).Cells</code>? You will be literally looping through <i>every</i> row, even blank ones - which will most likely cause your code to error."}, {"owner": {"reputation": 3, "user_id": 5726666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fa85097ebb880cfd614074a75dbdae?s=128&d=identicon&r=PG&f=1", "display_name": "D Martin", "link": "https://stackoverflow.com/users/5726666/d-martin"}, "edited": false, "score": 0, "creation_date": 1451496147, "post_id": 34533929, "comment_id": 56809780, "body": "Comes back with a runtime &quot;Subscript out of range&quot; error with and without the quotation marks"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1451496216, "post_id": 34533929, "comment_id": 56809824, "body": "Yea I would do <code>For Each Cell In ws.Columns(&quot;B&quot;).usedrange</code> as @ScottHoltzman suggests."}, {"owner": {"reputation": 3, "user_id": 5726666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fa85097ebb880cfd614074a75dbdae?s=128&d=identicon&r=PG&f=1", "display_name": "D Martin", "link": "https://stackoverflow.com/users/5726666/d-martin"}, "edited": false, "score": 0, "creation_date": 1451496426, "post_id": 34533929, "comment_id": 56809935, "body": "I would like it to finish at the first blank, as all the relevant tabs will have an entry in column B. Is there a condition I can add to the end of <code>For Each Cell In ws.Columns(&quot;B&quot;).Cells</code> (for example I have <code>SpecialCells(xlCellTypeVisible)</code> in another macro I made which uses the autofilter)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1451496610, "post_id": 34533929, "comment_id": 56810025, "body": "try <code>cell.Value2</code> (with no quotes) ... and <code>For Each Cell in ws.Range(ws.Range(&quot;B1&quot;),ws.Range(&quot;B1&quot;).End(xlDown))</code> - which assumes the sheet names start in B1 and are contiguous rows until the end. This will also allow you to add more sheet names in the future and not affect the code."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451496663, "post_id": 34533929, "comment_id": 56810049, "body": "My fault. <code>.usedrange</code> is not a valid method for column XD"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1451504903, "creation_date": 1451504903, "answer_id": 34536218, "question_id": 34533929, "link": "https://stackoverflow.com/questions/34533929/looping-a-copy-to-new-workbook-function-across-multiple-tabs-based-on-tab-names/34536218#34536218", "title": "Looping a copy to new workbook function across multiple tabs based on tab names in cell values", "body": "<p>Something like this should work for you. Note the following:</p>\n\n<ul>\n<li>Code assumes that on sheet \"email\" it has a header row which is row 1 and the actual data starts on row 2.</li>\n<li>It checks to see if the B column cell is a valid worksheet name in the workbook</li>\n</ul>\n\n<p>I have verified that this code works properly and as intended based on your original post:</p>\n\n<pre><code>Sub Datacopy()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsTemp As Worksheet\n    Dim rSheetNames As Range\n    Dim rSheet As Range\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"email\")\n\n    Set rSheetNames = wsData.Range(\"B2\", wsData.Cells(Rows.Count, \"B\").End(xlUp))\n    If rSheetNames.Row &lt; 2 Then Exit Sub    'No data\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    For Each rSheet In rSheetNames\n        If Not Evaluate(\"ISERROR('\" &amp; rSheet.Text &amp; \"'!A1)\") Then\n            Set wsTemp = Sheets.Add\n            Sheets(rSheet.Text).Range(\"A1:L500\").Copy\n            wsTemp.Range(\"A1\").PasteSpecial xlPasteAllUsingSourceTheme\n            wsTemp.Range(\"A1\").PasteSpecial xlPasteComments\n            wsTemp.Move\n            ActiveWorkbook.SaveAs rSheet.Offset(, 3).Text\n            ActiveWorkbook.Close False\n        End If\n    Next rSheet\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\n\n    MsgBox \"Finished making files!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5726666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19fa85097ebb880cfd614074a75dbdae?s=128&d=identicon&r=PG&f=1", "display_name": "D Martin", "link": "https://stackoverflow.com/users/5726666/d-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 34536218, "answer_count": 1, "score": 0, "last_activity_date": 1451545118, "creation_date": 1451495325, "last_edit_date": 1451545118, "question_id": 34533929, "link": "https://stackoverflow.com/questions/34533929/looping-a-copy-to-new-workbook-function-across-multiple-tabs-based-on-tab-names", "title": "Looping a copy to new workbook function across multiple tabs based on tab names in cell values", "body": "<p>I want to copy data from each tab in a spreadsheet and save it as new workbooks. The original workbook has many tabs (approx 50) and one of these tabs set up for the macro to run data from, as there may be new tabs added in the future. The macro data tab contains the file location for each new workbook, the name of the tab and also some information used by another macro to e-mail these newly created workbooks to relevant parties.</p>\n\n<p>The issue is getting the macro to recognize the tab names for finding the range to copy, as the tab names are listed in a cell. I am unsure if it is possible to use this list, or whether I add a sheet at the end to loop through all the sheets from a specified start location until that one with an if.</p>\n\n<pre><code>Sub Datacopy()\n\n    Dim ws As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n    End With\n\n    Application.DisplayAlerts = False\n\n    Set ws = Sheets(\"email\")\n\n    For Each Cell In ws.Columns(\"B\").Cells\n\n        Dim file1 As String\n\n        file1 = Cell.Offset(0, 3).Text\n\n            Sheets(\"cell.value\").Range(\"A1:L500\").Copy\n            Workbooks.Add.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial (xlPasteAllUsingSourceTheme)\n            Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial (xlPasteComments)\n            ActiveWorkbook.SaveAs Filename:=file1\n            ActiveWorkbook.Close\n\n    Next Cell\n\n    Application.DisplayAlerts = True\n\n    With Application\n        .ScreenUpdating = True\n    End With\n\n    MsgBox (\"Finished making files!\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c++", "excel", "vba"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1451495509, "post_id": 34533897, "comment_id": 56809431, "body": "Shouldn&#39;t <code>Dim obj As T</code> be <code>Dim i As T</code> ?"}, {"owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1451497988, "post_id": 34533897, "comment_id": 56810750, "body": "Yes! Sorry, I edited, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "is_accepted": true, "score": 0, "last_activity_date": 1452161913, "creation_date": 1452161913, "answer_id": 34652572, "question_id": 34533897, "link": "https://stackoverflow.com/questions/34533897/crash-on-udt-with-string-and-another-udt-between-vba-and-c/34652572#34652572", "title": "Crash on UDT with string and another UDT between VBA and C++", "body": "<p>I don't know why the memory is corrupted but I found a workaround. \nWe don't need to change anything in C++. On VBA, the aim is to pass the address of the User Defined Type ByVal like this:</p>\n\n<pre><code>Call Cpp_D2(VarPtr(i))\n</code></pre>\n\n<p>And, it's important to change the declaration of the C++ function like this:</p>\n\n<pre><code>Private Declare PtrSafe Function Cpp_D2 Lib \"MyDLL.dll\" (ByVal i As Long) As Long\n</code></pre>\n\n<p>Now, it's work when I have the both declaration in C++ and VBA of the User Defined Type without MIDL.</p>\n"}], "owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 34652572, "answer_count": 1, "score": 0, "last_activity_date": 1452161913, "creation_date": 1451495220, "last_edit_date": 1451497973, "question_id": 34533897, "link": "https://stackoverflow.com/questions/34533897/crash-on-udt-with-string-and-another-udt-between-vba-and-c", "title": "Crash on UDT with string and another UDT between VBA and C++", "body": "<p>I have a problem between the VBA and the C++.\nWhen I want to redim my X array, it's crash with my release dll. \nIf I compile in debug, it's work sometimes but when I look my X array, I have an error \"application-defined or object-defined error\".</p>\n\n<p>If I don't redim the X array or if I remove the s string, it's work well.</p>\n\n<p>VBA:</p>\n\n<pre><code>Private Declare PtrSafe Function Cpp_D2 Lib \"MyDLL.dll\" (i As T) As Long\n\nPrivate Type XData\n    X() As Double\n    Count As Long\nEnd Type\n\nPrivate Type T\n    s As String\n    data_T As XData\nEnd Type\n\nSub Test()\n    Dim i As T\n    ReDim i.data_T.X(5)\n    i.s = \"ok\"\n    Call Cpp_D2(i)\nEnd Sub\n</code></pre>\n\n<p>C++:</p>\n\n<pre><code>__declspec(align(4)) typedef struct XData\n{\n    LPSAFEARRAY X;\n    int Count;\n}   XData;\n\n__declspec(align(4)) typedef struct T\n{\n    BSTR s;\n    XData X;\n} T;\n\n__declspec(dllexport) int __stdcall  Cpp_D2(T *p)\n{\n    double *x = NULL;\n    HRESULT hr = SafeArrayAccessData(p-&gt;X.X, reinterpret_cast&lt;void**&gt;(&amp;x));\n    SafeArrayUnaccessData(p-&gt;X.X);\n    return 0;\n}\n</code></pre>\n\n<p>I use an 32 bit version of Excel and Visual Studio 2010 to compile the c++ dll.</p>\n\n<p>On Mac, I have one message before the crash: \"Internal error (Error 51)\" The information on the official documentation about this error is:</p>\n\n<p>\"An internal malfunction has occurred in Visual Basic. Unless this call was generated by the Error statement or Raise method, contact Microsoft Product Support Services to report the conditions under which the message appeared.\"</p>\n\n<p>I used this example to do the job: <a href=\"https://support.microsoft.com/en-us/kb/171583\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/171583</a> and this example works fine.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1451503054, "post_id": 34533839, "comment_id": 56813189, "body": "StackOverflow doesnt encourage entire code written without some attempt, or starting point. Look into class modules. You could create a class called surface, and one called section. Surfaces then contain sections, and they can in turn contain &#39;run&#39; properties."}, {"owner": {"reputation": 27, "user_id": 5729203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae13d8494824387fd495bf3c496460?s=128&d=identicon&r=PG&f=1", "display_name": "K. Sante", "link": "https://stackoverflow.com/users/5729203/k-sante"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1451573640, "post_id": 34533839, "comment_id": 56837819, "body": "Please, MacroMarc, this is there code I have this far to parse the data posted above into hierarchical order of surface, section, run. It is not working and if you guide me to achieve my purpose I will be glad. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 0, "last_activity_date": 1452301204, "creation_date": 1452301204, "answer_id": 34688544, "question_id": 34533839, "link": "https://stackoverflow.com/questions/34533839/excel-vba-organise-data-into-struct-in-a-hierachical-way/34688544#34688544", "title": "Excel VBA - organise data into struct in a hierachical way", "body": "<p>Hey I don't know if you still need this but, you could do this just as easily with a type since your objects aren't really doing anything apart from storing data.</p>\n\n<p>Just an example of how it could work:</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nPublic Type RUN_Type\n  Values() As Double\nEnd Type\n\nPublic Type SECTION_Type\n  Runs() As RUN_Type\nEnd Type\n\nPublic Type SURFACE_Type\n Sections() As SECTION_Type\nEnd Type\n\nSub actual2()\n  Const surface = \"SURFACE\"\n  Const section = \"SECTION\"\n  Const run = \"RUN\"\n\n  Dim DATA() As Variant, surfaces() As SURFACE_Type\n  Dim counter As Long, counter_surf  As Long, counter_sect As Long, counter_run As Long, counter_num As Long\n\n  counter = 1\n  DATA = Range(Cells(1, 1), Cells(86, 1)).Value\n\n  Do While DATA(counter, 1) = surface\n        incr counter_surf\n        ReDim Preserve surfaces(counter_surf)\n        incr counter\n        If counter &gt; UBound(DATA) Then\n              endRead surfaces\n              Exit Sub\n        End If\n        Do While DATA(counter, 1) = section\n              incr counter_sect\n              ReDim Preserve surfaces(counter_surf).Sections(counter_sect)\n              incr counter\n              If counter &gt; UBound(DATA) Then\n                    endRead surfaces\n                    Exit Sub\n              End If\n              Do While DATA(counter, 1) = run\n                    incr counter_run\n                    ReDim Preserve surfaces(counter_surf).Sections(counter_sect).Runs(counter_run)\n                    incr counter\n                    If counter &gt; UBound(DATA) Then\n                                endRead surfaces\n                          Exit Sub\n                    End If\n                    Do While IsNumeric(DATA(counter, 1))\n                          incr counter_num\n                          ReDim Preserve surfaces(counter_surf).Sections(counter_sect).Runs(counter_run).Values(counter_num)\n                          surfaces(counter_surf).Sections(counter_sect).Runs(counter_run).Values(counter_num) = DATA(counter, 1)\n                          incr counter\n                          If counter &gt; UBound(DATA) Then\n                                endRead surfaces\n                                Exit Sub\n                          End If\n                    Loop\n                    counter_num = 0\n              Loop\n              counter_run = 0\n        Loop\n        counter_sect = 0\n  Loop\nEnd Sub\n\nPublic Sub endRead(surfaces() As SURFACE_Type)\n\n  Const surface = \"SURFACE\"\n  Const section = \"SECTION\"\n  Const run = \"RUN\"\n\n  Dim ws As Worksheet\n  Dim counter As Long, i As Long, j As Long, k As Long, l As Long\n\n  Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n  counter = 1\n\n  For i = LBound(surfaces) To UBound(surfaces)\n        ws.Cells(counter, 2).Value = surface\n        incr counter\n        For j = LBound(surfaces(i).Sections) To UBound(surfaces(i).Sections)\n              ws.Cells(counter, 3).Value = section\n              incr counter\n              For k = LBound(surfaces(i).Sections(j).Runs) To UBound(surfaces(i).Sections(j).Runs)\n                    ws.Cells(counter, 4).Value = run\n                    incr counter\n                    For l = LBound(surfaces(i).Sections(j).Runs(k).Values) To UBound(surfaces(i).Sections(j).Runs(k).Values)\n                          ws.Cells(counter, 5).Value = surfaces(i).Sections(j).Runs(k).Values(l)\n                          incr counter\n                    Next l\n              Next k\n        Next j\n  Next i\n\nEnd Sub\n\n Public Function incr(lng As Long)\n    lng = lng + 1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5729203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae13d8494824387fd495bf3c496460?s=128&d=identicon&r=PG&f=1", "display_name": "K. Sante", "link": "https://stackoverflow.com/users/5729203/k-sante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 34688544, "answer_count": 1, "score": 0, "last_activity_date": 1452301204, "creation_date": 1451495048, "last_edit_date": 1451575061, "question_id": 34533839, "link": "https://stackoverflow.com/questions/34533839/excel-vba-organise-data-into-struct-in-a-hierachical-way", "title": "Excel VBA - organise data into struct in a hierachical way", "body": "<p>I have this csv file which I want to organize into a struct. I am measuring some surfaces and under every surface there are sections and under every section there are a number of runs. I want to write a structure code such that each surface with have all the section and runs under it extracted. the structure should look like this. surface(I).section(k).run(m). this is how the data looks like: </p>\n\n<pre><code>SURFACE\nSECTION\nRUN\n-0.07764007\n0.07762\n42\n0.07801\n-0.07747896\n0.07744\n-0.07753022\n0.07759\n-0.07729586\n0.07747\n-0.07753753\n0.07741\n-0.07742768\nRUN\n-0.077435\n0.07747\n-0.07757416\n0.07726\n-0.07761077\n0.07756\n-0.07750092\n-57\n-0.07712009\n0.07771\n-0.07769133\n0.07769\n-0.07713472\n0.07733\n-0.07726657\n0.0774\n-0.07731783\n0.07743\n-0.07754486\n0.07752\n-0.07755219\n0.07745\n-0.07723726\nSECTION\nRUN\n-0.07785247\n0.07765\n-0.07742036\n-0.0776\n-0.07742036\n0.07747\n-0.07729586\n0.07741\n-0.07744966\n0.07724\n-0.07753753\n0.0773\n-0.07747896\n0.07759\n-0.07746429\n0.07771\nSURFACE\nSECTION\nRUN\n-0.07753753\n0.07786\n-0.07729586\n0.07743\n-0.07762542\n0.07763\n-0.07723726\n0.07735\n-0.077955\n-71\n-0.07681249\n0.07727\n-0.0775229\n0.07733\n-0.07747896\n0.07738\n-0.07714205\n0.07746\n-0.07737642\n0.07744\n-0.07761809\n0.07727\n-0.07755951\n0.07754\n-0.07792571\n\nOption Explicit\nPublic Type RUN_Type\nRUN_STRUCT() As Variant\nEnd Type\n\nPublic Type SECTION_Type\nSECTION_STRUCT() As RUN_Type\nEnd Type\n\nSub actual2()\n\n\n\nDim surface As String, Section As String, run As String\nDim DATA() As Variant, counter_surf  As Long, counter_sect As Long\nDim counter_run As Long\nDim SURFACE_STRUCT() As SECTION_Type, n As Long, m As Long\nDim counter As Integer\nDim Endoffileflag As Boolean, errorflag As Boolean\n\n\n\nsurface = \"SURFACE\"\nSection = \"SECTION\"\nrun = \"RUN\"\ncounter = 0\ncounter_surf = 0\ncounter_sect = 0\ncounter_run = 0\nEndoffileflag = False\nerrorflag = False\n\n\n\n Do While counter &lt;= UBound(DATA) And Endoffileflag = False\n If Endoffileflag = False Then\n errorflag = True\n End If\n Do While DATA(counter) = surface And Endofflileflag = False\n\n    ReDim Preserve SURFACE_STRUCT(counter_surf)\n    If counter &lt; UBound(DATA) Then\n    errorflag = True\n    End If\n\n        Do While DATA(counter) = Section And Endofflileflag = False\n            ReDim Preserve SECTION_STRUCT(counter_sect)\n            If counter &lt; UBound(DATA) Then\n            errorflag = True\n            End If\n\n            Do While DATA(counter) = run And Endofflileflag = False\n            ReDim Preserve RUN_STRUCT(counter_run)\n            If counter &lt; UBound(DATA) And IsNumeric(DATA(counter)) Then\n            errorflag = True\n            SURFACE_STRUCT(counter_surf).SECTION_STRUCT(counter_sect).,\n            RUN_STRUCT(counter_run) = (DATA(counter))\n            End If\n            counter_run = counter_run + 1\n\n        Loop\n            counter_sect = counter_sect + 1\n        Loop\n    counter_surf = counter_surf + 1\n Loop\n\ncounter = counter + 1\nLoop\n\nClose #2\nEnd Sub\nThank you.\n</code></pre>\n"}, {"tags": ["excel", "parsing", "selenium", "automation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1451494955, "post_id": 34533687, "comment_id": 56809122, "body": "thank you for your reply. My appologies, I forgot to mention that I use FireFoxDriver and not Internet Explorer"}, {"owner": {"reputation": 1, "user_id": 3326226, "user_type": "registered", "profile_image": "https://graph.facebook.com/719245804/picture?type=large", "display_name": "Gray Hogan", "link": "https://stackoverflow.com/users/3326226/gray-hogan"}, "reply_to_user": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 1, "creation_date": 1451495118, "post_id": 34533687, "comment_id": 56809218, "body": "This is also probably helpful to you:    <a href=\"http://stackoverflow.com/questions/18106588/how-to-disable-cookies-using-webdriver-for-chrome-and-firefox-java\" title=\"how to disable cookies using webdriver for chrome and firefox java\">stackoverflow.com/questions/18106588/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 3326226, "user_type": "registered", "profile_image": "https://graph.facebook.com/719245804/picture?type=large", "display_name": "Gray Hogan", "link": "https://stackoverflow.com/users/3326226/gray-hogan"}, "is_accepted": false, "score": 0, "last_activity_date": 1451494462, "creation_date": 1451494462, "answer_id": 34533687, "question_id": 34533589, "link": "https://stackoverflow.com/questions/34533589/stop-windows-security-pop-up-mesage-with-seleniumbasic/34533687#34533687", "title": "Stop Windows Security pop-up Mesage with SeleniumBasic", "body": "<p>Cookie settings are client dependent.  Bypassing these would be flagged as malware by most antivirus programs, as you are explicitly going around the end users settings. I won't get into the ethics of that action- If you're just talking about turning off those notices for your computer, specifically, you could just follow this guide:\n<a href=\"https://support.microsoft.com/en-us/kb/196955\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/196955</a></p>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "is_accepted": true, "score": 0, "last_activity_date": 1451553580, "last_edit_date": 1451553580, "creation_date": 1451552187, "answer_id": 34543757, "question_id": 34533589, "link": "https://stackoverflow.com/questions/34533589/stop-windows-security-pop-up-mesage-with-seleniumbasic/34543757#34543757", "title": "Stop Windows Security pop-up Mesage with SeleniumBasic", "body": "<p>Got it! Selenium never opened my default profile but opened another instance which had the \"default\" FireFox configuration. So by selecting an already configured browser which accepts coockies automatically the problem will be solved.</p>\n\n<p><strong>NOTE!</strong> that if you have an instance of the browser opened, Selenium won't open a new one. It will only work if you close all opened browser instances of the selected profile.</p>\n\n<pre><code>Dim driver As New Selenium.FirefoxDriver\ndriver.SetProfile \"Selenium\"  'Firefox only. Profile created by running \"..\\firefox.exe -p\"\ndriver.Get \"http://www.google.com\"\n...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim driver As New Selenium.FirefoxDriver\ndriver.SetProfile \"C:\\MyProfil\"   'For Chrome and Firefox only\ndriver.Get \"http://www.google.com\"\n...\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 34543757, "answer_count": 2, "score": 1, "last_activity_date": 1451553580, "creation_date": 1451494069, "last_edit_date": 1592644375, "question_id": 34533589, "link": "https://stackoverflow.com/questions/34533589/stop-windows-security-pop-up-mesage-with-seleniumbasic", "title": "Stop Windows Security pop-up Mesage with SeleniumBasic", "body": "<p>I am looping through a list of local <code>.HTM</code> webpages using SeleniumBasic version 2.0.6.0. in Excel 2013 VBA. I want to parse the website for information.</p>\n<p><strong>EDIT</strong>: I use Selenium with <strong>FireFox</strong> v44.0b1</p>\n<p>Sometimes, not always, a pop-up like this appears and the code stops and waits for &quot;user input&quot;:</p>\n<p><a href=\"https://i.stack.imgur.com/gQO4W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gQO4W.png\" alt=\"enter image description here\" /></a></p>\n<p>Is there a way to automate VBA or Selenium (or somehow the browser) so that it will click &quot;Yes&quot; every time thi pop-up appears?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451491951, "post_id": 34532997, "comment_id": 56807464, "body": "Didn&#39;t we address this already? Your code explicitly prompts for a file name. If you don&#39;t want that just use <code>strFile</code> in the code that exports the worksheet to PDF and remove the <code>GetSaveAsFilename</code> part."}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451492141, "post_id": 34532997, "comment_id": 56807563, "body": "Hi @Rory We did, I added in the loop through part relating to the DV List which works fine and also the Folder function. I couldnt get my head around bypassing the prompt as it loops through each value, and felt i didnt explain it very well."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451492309, "post_id": 34532997, "comment_id": 56807645, "body": "That was my fault - I just realised it would still prompt for the folder on each pass. I&#39;ve posted an answer here with code to just export the PDF."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1451545253, "post_id": 34532997, "comment_id": 56826767, "body": "well asked question."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1451545235, "last_edit_date": 1451545235, "creation_date": 1451492260, "answer_id": 34533113, "question_id": 34532997, "link": "https://stackoverflow.com/questions/34532997/enabling-save-as-automatically-through-vba-without-clicking-save-on-prompt/34533113#34533113", "title": "Enabling Save as automatically through vba (Without clicking save on prompt)", "body": "<p>To avoid prompting:</p>\n\n<pre><code>Sub PDFActiveSheet()\nDim ws As Worksheet\nDim strPath As String\nDim myFile As Variant\nDim strFile As String\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\n'enter name and select folder for file\n' start in current workbook folder\nstrFile = Cells.Range(\"B1\") &amp; \" Period \" &amp; Cells.Range(\"J1\")\n\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile &amp; \".PDF\"\n\n    ws.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=strFile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False, _\n    From:=1, _\n    To:=2\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4424, "favorite_count": 0, "accepted_answer_id": 34533113, "answer_count": 1, "score": 2, "last_activity_date": 1451545235, "creation_date": 1451491780, "last_edit_date": 1451492162, "question_id": 34532997, "link": "https://stackoverflow.com/questions/34532997/enabling-save-as-automatically-through-vba-without-clicking-save-on-prompt", "title": "Enabling Save as automatically through vba (Without clicking save on prompt)", "body": "<p><a href=\"https://i.stack.imgur.com/zGbHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zGbHG.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I get excel to automatically select save through VBA without manually clicking it. E.g-  I have Code which selects each value on a Data Validation list and gets me to the stage below, although I have to click save each time.</p>\n\n<p>I have tried adding in:</p>\n\n<pre><code>  Application.EnableEvents = True\n</code></pre>\n\n<p>But it still only takes me to the stage on the image.</p>\n\n<pre><code>    Sub PDFActiveSheet()\n    Dim ws As Worksheet\n    Dim strPath As String\n    Dim myFile As Variant\n    Dim strFile As String\n    On Error GoTo errHandler\n\n    Set ws = ActiveSheet\n\n    'enter name and select folder for file\n    ' start in current workbook folder\n    strFile = Cells.Range(\"B1\") &amp; \" Period \" &amp; Cells.Range(\"J1\")\n\n    strFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\n    myFile = Application.GetSaveAsFilename _\n         (InitialFileName:=strFile, _\n            FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n            Title:=\"Select Folder and FileName to save\")\n\n    If myFile &lt;&gt; \"False\" Then\n        ws.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=myFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False, _\n        From:=1, _\n        To:=2  \n   End If   \n    exitHandler:\n        Exit Sub\n    errHandler:\n        MsgBox \"Could not create PDF file\"\n        Resume exitHandler\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1451491770, "post_id": 34532985, "comment_id": 56807364, "body": "What is the value of <code>Sheet10Name</code>?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451491791, "post_id": 34532985, "comment_id": 56807378, "body": "<code>Sheets(Sheet10Name)</code> did you mean <code>Sheets(10)</code>?"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451491917, "post_id": 34532985, "comment_id": 56807439, "body": "@findwindow -- why would he mean that instead of what he said?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1451491945, "post_id": 34532985, "comment_id": 56807459, "body": "@roryap <code>try and copy and paste b4 form sheet 10 to sheet 6</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 10190, "user_id": 5236226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ffj4X.jpg?s=128&g=1", "display_name": "Caleb Kleveter", "link": "https://stackoverflow.com/users/5236226/caleb-kleveter"}, "edited": false, "score": 0, "creation_date": 1451492143, "post_id": 34532985, "comment_id": 56807565, "body": "@caleb kleveter if you&#39;re going to edit, please correct the typo XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 10190, "user_id": 5236226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ffj4X.jpg?s=128&g=1", "display_name": "Caleb Kleveter", "link": "https://stackoverflow.com/users/5236226/caleb-kleveter"}, "edited": false, "score": 0, "creation_date": 1451492258, "post_id": 34532985, "comment_id": 56807623, "body": "@CalebKleveter <code>form sheet 10 to sheet 6</code> Edit: I would consider editing <code>B4</code> as well."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451492365, "post_id": 34532985, "comment_id": 56807674, "body": "Rude to edit someone else? Edit: I guess not exactly polite to critique another&#39;s edit XD"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451492651, "post_id": 34532985, "comment_id": 56807828, "body": "@findwindow -- What does this &quot;XD&quot; mean that you keep typing?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1451492838, "post_id": 34532985, "comment_id": 56807936, "body": "@roryap emoticon ^_^;"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1451493213, "post_id": 34532985, "comment_id": 56808147, "body": "Have you tried to &quot;record macro&quot; while doing it manually and checked the difference afterwards?"}], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1451493953, "post_id": 34533360, "comment_id": 56808577, "body": "(SheetX.Name) fixed that issue, but now it wont insert the now() timestamp. I may make another question for this unless you have some advice on that?  also Range(&quot;B&quot; &amp; (ActiveCell.Row)).Select worked but when you stated the pastSheet in front of it it errored out."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1451494050, "post_id": 34533360, "comment_id": 56808627, "body": "@DougCoats - I have a feeling that it&#39;s due to the <code>ActiveCell</code> part, not the <code>now()</code> part.  What cell do you want to put the <code>Now()</code> info in? Let&#39;s instead use something like <code>Cells(1,1).Value = Now()</code>, but we need to determine which cell you want the active cell to be."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1451494175, "post_id": 34533360, "comment_id": 56808693, "body": "i guess i am still a new. I thought &quot;pasteSheet.Range(&quot;B&quot; &amp; (ActiveCell.Row)).Select&quot; was making the active row of column b the active cell? or does it need to be pasteSheet.Range(&quot;B&quot; &amp; (ActiveCell.Row)).Value= Now()   ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1451494733, "post_id": 34533360, "comment_id": 56809003, "body": "@DougCoats - Check out <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this thread</a> on how to avoid using <code>.Select</code>, which is best practice for VBA.  It looks like you&#39;re starting to see how to do that...and you&#39;re correct (and I just overlooked that part) that <code>.select</code> makes it active.  So yes, try using <code>pasteSheet.Range(&quot;B&quot; &amp; (ActiveCell.Row)).Value= Now() </code>.  However, I&#39;d like to remove all <code>.Select</code> -  so it looks like the cell you want with <code>Now()</code> is going to be the last row of your pasted range, plus one row, correct?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1451495196, "post_id": 34533360, "comment_id": 56809258, "body": "Correct. Though this did work, when I try activating this multiple times the timestamp doesnt go into the active row, and only goes in b3 (weird) and replaces the timestamp each time. I have a feeling I need to redo that whole line to include an offset reasoning"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1451495565, "post_id": 34533360, "comment_id": 56809459, "body": "@DougCoats - Yes! If you can add some logic that determines the cell, do that.  It&#39;s tricky when you use <code>.Select</code> and <code>ActiveCell</code> (<code>Active</code> anything really).  I&#39;ll tweak the code in a minute."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1451493225, "creation_date": 1451493225, "answer_id": 34533360, "question_id": 34532985, "link": "https://stackoverflow.com/questions/34532985/subscript-out-of-range-error-excel-copy-paste/34533360#34533360", "title": "Subscript out of Range Error Excel Copy/Paste", "body": "<p>I think it's the way you're using (perhaps misusing) the <code>Sheets()</code> part.  Try this:</p>\n\n<pre><code>Sub t()\nApplication.ScreenUpdating = False\n Dim copySheet As Worksheet\n Dim pasteSheet As Worksheet\n\n Set copySheet = ThisWorkbook.Sheets(Sheet10.Name)\n Set pasteSheet = ThisWorkbook.Sheets(Sheet6.Name)\n\n copySheet.Range(\"B4\").Copy\n pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n pasteSheet.Range(\"B\" &amp; (ActiveCell.Row)).Select\n ActiveCell.Value = Now()\n Application.CutCopyMode = False\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Also note that I explicitly gave the sheet in your <code>Rows.Count</code> and <code>Range(\"B\" &amp; Activecell...)</code> parts, which should help too.  Without that, you'd likely get some errors as you switch worksheets.</p>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 0, "accepted_answer_id": 34533360, "answer_count": 1, "score": 0, "last_activity_date": 1451495588, "creation_date": 1451491725, "last_edit_date": 1451495588, "question_id": 34532985, "link": "https://stackoverflow.com/questions/34532985/subscript-out-of-range-error-excel-copy-paste", "title": "Subscript out of Range Error Excel Copy/Paste", "body": "<p>I am using the below code to try to copy and paste B4 from sheet 10 to sheet 6 and then in column b of sheet 6 enter a time stamp.</p>\n\n<p>However, I am getting the <code>subscript out of range</code> error on the line of code where the * is.</p>\n\n<pre><code> Application.ScreenUpdating = False\n Dim copySheet As Worksheet\n Dim pasteSheet As Worksheet\n\n Set copySheet = ThisWorkbook.Sheets(Sheet10Name)   ****\n Set pasteSheet = ThisWorkbook.Sheets(Sheet6Name)\n\n copySheet.Range(\"B4\").Copy\n pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n Range(\"B\" &amp; (ActiveCell.Row)).Select\n ActiveCell.Value = Now()\n Application.CutCopyMode = False\n Application.ScreenUpdating = True\n</code></pre>\n\n<p>Now apparently I am not getting the now() to insert the time stamp in column b of sheet6. </p>\n\n<p>Correct end result</p>\n\n<pre><code> Application.ScreenUpdating = False\n Dim copySheet As Worksheet\n Dim pasteSheet As Worksheet\n\n Set copySheet = ThisWorkbook.Sheets(Sheet10.Name)\n Set pasteSheet = ThisWorkbook.Sheets(Sheet6.Name)\n\n copySheet.Range(\"B4\").Copy\n pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(0, 1).Value = Now()\n Application.CutCopyMode = False\n Application.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451491337, "post_id": 34532802, "comment_id": 56807116, "body": "Where do you get the <code>Type Mismatch</code> error?"}, {"owner": {"reputation": 67, "user_id": 5731274, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156476365950637/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/5731274/james"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451492338, "post_id": 34532802, "comment_id": 56807659, "body": "how to i figure out where? it just says Type Mismatch"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451492415, "post_id": 34532802, "comment_id": 56807708, "body": "There should be a Debug button and when you press that it will highlight the line."}, {"owner": {"reputation": 67, "user_id": 5731274, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156476365950637/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/5731274/james"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451493038, "post_id": 34532802, "comment_id": 56808045, "body": "dont see it on visual basic. I tried everything in the debug tab"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451493461, "post_id": 34532802, "comment_id": 56808295, "body": "No - when the error occurs, there should be a debug button on the message box that comes up?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1451493496, "post_id": 34532802, "comment_id": 56808315, "body": "Change lastRow to integer then try"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1451493883, "creation_date": 1451493883, "answer_id": 34533531, "question_id": 34532802, "link": "https://stackoverflow.com/questions/34532802/type-mismatch-in-nested-loops-with-worksheetfunction/34533531#34533531", "title": "Type Mismatch in nested loops with WorksheetFunction", "body": "<p>Let's do some math.</p>\n\n<pre><code>For a_counter = 2001 To 2015\n</code></pre>\n\n<p><strong>a_counter</strong> will sequence through 15 values; e.g. 2001 \u25ba 2015 inclusive.</p>\n\n<pre><code>Sheet2.Range(\"A2:N42\")\n</code></pre>\n\n<p>Total of 14 columns; e.g. column A \u25ba column N inclusive.</p>\n\n<pre><code>j = a_counter\n..., (j - 2000 + 2), ...\n</code></pre>\n\n<p>You are asking for returns from 15 different columns from 3 \u25ba 17.</p>\n\n<p>However A:N has 14 columns so you will error out (Type mismatch) when <strong>a_counter</strong> = 2013 because there is no 15<sup>th</sup> column.</p>\n"}], "owner": {"reputation": 67, "user_id": 5731274, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156476365950637/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/5731274/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 34533531, "answer_count": 1, "score": 2, "last_activity_date": 1451496186, "creation_date": 1451491040, "last_edit_date": 1451496186, "question_id": 34532802, "link": "https://stackoverflow.com/questions/34532802/type-mismatch-in-nested-loops-with-worksheetfunction", "title": "Type Mismatch in nested loops with WorksheetFunction", "body": "<pre><code>Sub checkMe()\nDim lastRow As Long\nDim cell As Range\n\n\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each cell In Range(\"B1:B\" &amp; lastRow) 'dynamically go through each row in the range \n        For a_counter = 2001 To 2015 ' for each row, cycle through each year until 2015 \n        j = a_counter\n        b = cell.offset(0, 6).Value 'value for vlookup\n        a = Application.VLookup(b, Sheet2.Range(\"A2:N42\"), (j - 2000 + 2), False) ' look up each value in offset(0,6) in another sheet \n        If cell.Value = \"DUB\" And cell.offset(0, 1).Value &lt;= \"2001\" And cell.offset(0, 2).Value = \"OSLR\" Then cell.offset(0, j + 12 - 2000).Value = cell.offset(0, 7).Value * a 'only apply when the conditions are met \n\n\n        Next a_counter\n\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The order should be changed up a bit so the conditions are before the inside loop to help speed but otherwise I think this should work. The value of the cell.offset(0,6) is the value I need to look up for each row for the vlookups. This code works if I put in a value where 'b' is, however I need the value to look up to change with each row. Currently it just works for the 1st row and stops. Right now I get a mismatch error. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1451489937, "post_id": 34532480, "comment_id": 56806290, "body": "When deleting rows, loop backwards."}, {"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1451489960, "post_id": 34532480, "comment_id": 56806306, "body": "So Step -1 would fix that?"}, {"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451490126, "post_id": 34532480, "comment_id": 56806410, "body": "Perfect @findwindow - happy new year to you :)"}], "owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451489870, "creation_date": 1451489870, "last_edit_date": 1531164843, "question_id": 34532480, "link": "https://stackoverflow.com/questions/34532480/if-a-value-exceeds-x-delete-entire-row", "title": "If a value exceeds x, delete entire row", "body": "<p>I can't quite figure out why my code isnt doing exactly as I planned but I fear it is something entirely obvious. It works, to an extent - but often leaves rows despite them meeting the criteria for the delete row command.</p>\n\n<pre><code>Dim LastRowA As Long\nDim i As Long\nDim cleanserows As Integer\n\nLastRowA = Cells(Rows.Count, 11).End(xlUp).Row\ncleanserows = TextBox1.Value\n\nFor i = 2 To LastRowA\nIf Date - Cells(i, 11).Value &gt; cleanserows Then Rows(i).EntireRow.Delete\nNext i\n</code></pre>\n\n<p>For some reason I have to run the macro multiple times for it to delete all of the rows - the first time it leaves two, the second time it leaves 1 and then it finally clears them - what have I done to cause this?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["xml", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5731055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcee26c9fe18bf2ce71f8bc4f646fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "dlatil", "link": "https://stackoverflow.com/users/5731055/dlatil"}, "edited": false, "score": 0, "creation_date": 1451502392, "post_id": 34532983, "comment_id": 56812888, "body": "Thanks for the quick reply! So,  would I leave out the xmlDoc.Load (&quot;C:\\Temp\\savetest.xml&quot;) reference if I wanted it to it so scan the current xml attachment and not just the one located in the temp folder?"}, {"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "reply_to_user": {"reputation": 23, "user_id": 5731055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcee26c9fe18bf2ce71f8bc4f646fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "dlatil", "link": "https://stackoverflow.com/users/5731055/dlatil"}, "edited": false, "score": 0, "creation_date": 1451512347, "post_id": 34532983, "comment_id": 56817725, "body": "Sorry, I missed the part where you said you wanted to get the Serial Number out of the attached XML file. I think the easiest way to do this would be to save a temporary copy of attachment somewhere, and then refer to this copy in your <code>xmlDoc.Load</code>. Once that is done you would delete this copy, and save the actual file with the properly formatted name. I&#39;ve edited the answer with an example for doing this."}, {"owner": {"reputation": 23, "user_id": 5731055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcee26c9fe18bf2ce71f8bc4f646fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "dlatil", "link": "https://stackoverflow.com/users/5731055/dlatil"}, "edited": false, "score": 0, "creation_date": 1451571481, "post_id": 34532983, "comment_id": 56836961, "body": "That worked!  I only had to add a few references and all is well.  I added: tempfolder = &quot;c:\\temp\\&quot; at the top, and: objAtt.SaveAsFile tempfolder &amp; &quot;\\&quot; &amp; objAtt.DisplayName under save xml to temp location."}], "tags": [], "owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "is_accepted": true, "score": 0, "last_activity_date": 1451512802, "last_edit_date": 1495542185, "creation_date": 1451491721, "answer_id": 34532983, "question_id": 34532319, "link": "https://stackoverflow.com/questions/34532319/how-to-save-an-xml-attachment-using-element-name-as-file-name-in-vba/34532983#34532983", "title": "How to save an xml attachment using element name as file name in VBA", "body": "<p>You essentially have everything that you need already, and could actually literally combine your code into a single routine with some minor changes.</p>\n\n<p>In your <code>GetSN</code> routine, you are currently displaying the Serial Number in a Message Box <code>MsgBox nodeXML(i).Text</code>.</p>\n\n<p>Instead of doing this, you should assign it to a variable to easily refer to it later eg.</p>\n\n<p><code>serialNumber = nodeXML(i).Text</code></p>\n\n<p>Now in 'saveXMLtoDisk' simply include this when you save the file.</p>\n\n<p><code>objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName &amp; \" \" &amp; serialNumber &amp; \" \" &amp; dateFormat &amp; \".xml\"</code></p>\n\n<p>In the simplest terms, place the contents of <code>GetSN</code> at the top of your existing <code>saveXMLtoDisk</code> routine and make the above changes.</p>\n\n<p><em>Edited in response to <a href=\"https://stackoverflow.com/questions/34532319/how-to-save-an-xml-attachment-using-element-name-as-file-name-in-vba/34532983#comment56812888_34532983\">comment</a> about extracting the Serial Number from the attached XML file.</em></p>\n\n<p>I think the easiest way to do this would be to save a temporary copy of the attached XML file somewhere on the PC, and then refer to that when you call <code>xmlDoc.Load</code>. Once you've captured the Serial Number you can then delete this temporary copy and save the permanent copy with the properly formatted name. I've copied a full code example below (comments in-line with the code where I've changed your original code).</p>\n\n<pre><code>Public Sub saveXMLtoDisk(itm As Outlook.MailItem)\n    Dim objAtt As Outlook.Attachment\n    Dim dateFormat As String\n    Dim saveFolder As String\n    saveFolder = \"C:\\temp\\xml folder\\\" \n    dateFormat = Format(Now, \"mm-dd-yyyy H-mm-ss\")\n\n     For Each objAtt In itm.Attachments\n        If InStr(objAtt.DisplayName, \".xml\") Then\n\n            ' Save the XML to a temporary location\n            Dim tempXML As String: tempXML = \"C:\\temp\\attachment.xml\"\n            Dim serialNumber As String\n\n            ' Start of GetSN Code\n            Set xmlDoc = CreateObject(\"Microsoft.XMLDOM\")\n            xmlDoc.SetProperty \"SelectionLanguage\", \"XPath\"\n            xmlDoc.async = False\n            ' Open the temporary copy of the XML attachment that has been saved.\n            xmlDoc.Load (tempXML)\n\n            Set nodeXML = xmlDoc.getElementsByTagName(\"SerialNumber\")\n            For i = 0 To nodeXML.Length - 1\n                serialNumber = nodeXML(i).Text\n            Next\n\n            Set nodeXML = Nothing\n            Set xmlDoc = Nothing\n            ' End of GetSN Code\n\n            objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName &amp; \" \" &amp; serialNumber &amp; \" \" &amp; dateFormat &amp; \".xml\"\n\n            ' Remove the temporary copy of the XML attachment\n            Kill tempXML\n\n        End If\n\n        Set objAtt = Nothing\n        Pause 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5731055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcee26c9fe18bf2ce71f8bc4f646fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "dlatil", "link": "https://stackoverflow.com/users/5731055/dlatil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 34532983, "answer_count": 1, "score": 2, "last_activity_date": 1451512802, "creation_date": 1451489215, "last_edit_date": 1451489655, "question_id": 34532319, "link": "https://stackoverflow.com/questions/34532319/how-to-save-an-xml-attachment-using-element-name-as-file-name-in-vba", "title": "How to save an xml attachment using element name as file name in VBA", "body": "<p>I currently have two modules which work as required in VBA created from bits and pieces I found using Google.  </p>\n\n<p>I would like to combine them into one process that Outlook can handle as a rule.  </p>\n\n<p>The first module saves an XML email attachment with a date extension from outlook and is activated by outlook rules.  </p>\n\n<p>The second uses <code>getElementsByTagName</code> to display the serial number from a file located on my hard drive in a msgbox.  </p>\n\n<p>Is there a way to combine these two into one automated process which saves the XML attachment from the email and renames it with the serial number element tag name from the xml attachment?  </p>\n\n<p>The code for each is listed below.  </p>\n\n<p>Module 1:</p>\n\n<pre><code>Public Sub saveXMLtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim dateFormat\nDim saveFolder As String\nsaveFolder = \"C:\\temp\\xml folder\\\"\ndateFormat = Format(Now, \"mm-dd-yyyy H-mm-ss\")\n\n For Each objAtt In itm.Attachments\n    If InStr(objAtt.DisplayName, \".xml\") Then\n     objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName &amp; dateFormat &amp; \".xml\"\n\n      End If\n      Set objAtt = Nothing\n      Pause 1\n      Next\nEnd Sub\n</code></pre>\n\n<p>Module 2:</p>\n\n<pre><code>Sub GetSN()\n\nSet xmlDoc = CreateObject(\"Microsoft.XMLDOM\")\nxmlDoc.SetProperty \"SelectionLanguage\", \"XPath\"\nxmlDoc.async = False\nxmlDoc.Load (\"C:\\Temp\\savetest.xml\")\n\nSet nodeXML = xmlDoc.getElementsByTagName(\"SerialNumber\")\nFor i = 0 To nodeXML.Length - 1\nMsgBox nodeXML(i).Text\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary", "autofilter"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451489784, "post_id": 34532282, "comment_id": 56806217, "body": "Can&#39;t be anything but a range I&#39;m afraid."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451489871, "post_id": 34532282, "comment_id": 56806262, "body": "Create a variant array of wildcard matches and then use the array of full values with the standard <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a>. I&#39;ve done this with a dictionary object to use its unique index property."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451490230, "post_id": 34532282, "comment_id": 56806468, "body": "Won&#39;t this become a custom filter and fail due to &gt;2?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451491728, "post_id": 34532282, "comment_id": 56807339, "body": "@Chris - see my generic solution below."}], "answers": [{"comments": [{"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451491961, "post_id": 34532975, "comment_id": 56807470, "body": "Interesting, will give it a go. Thanks very much. Next step is passing the array of values to VBA from PowerShell!"}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451492307, "post_id": 34532975, "comment_id": 56807644, "body": "Just tried to run this and get type mismatch on .AutoFilter Field:=colNum, Criteria1:=dVALs.keys, Operator:=xlFilterValues"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451492392, "post_id": 34532975, "comment_id": 56807691, "body": "This may have something to do with your version of Excel and its SP. Try <code>Criteria1:=(dVALs.keys)</code>. I honestly did not make the image up."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451492586, "post_id": 34532975, "comment_id": 56807801, "body": "I wouldn&#39;t dare suggest you did! It&#39;s likely me making some mistake. I&#39;ve added the brackets but get the same error. I&#39;m using Excel 2013 if it helps"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451492750, "post_id": 34532975, "comment_id": 56807889, "body": "Could you try <a href=\"https://dl.dropboxusercontent.com/u/100009401/AutoFilter_Multi_Wildcards_Sample.xlsb\" rel=\"nofollow noreferrer\">this sample workbook</a>? It is a small XLSB."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451494597, "post_id": 34532975, "comment_id": 56808922, "body": "If the dictionary is empty, you will receive that error. See my error control addition above."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451897633, "post_id": 34532975, "comment_id": 56919990, "body": "Apologies for the slow reply, thank you very much for the further help. Will give it a test this morning."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451898362, "post_id": 34532975, "comment_id": 56920281, "body": "I now get no error but nothing happens, I&#39;ve tried updating the cases to my actual values to be filtered on, including and not including wildcard. I remember you mentioning the Like keyword but don&#39;t see it used anywhere, is this intended? I&#39;m unable to use your test spreadsheet as dropbox is not available on this network. I run all my macros from a personal XLSB, is this sufficient? The autofilter is removed so I know the macro is being run."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451899941, "post_id": 34532975, "comment_id": 56921091, "body": "I can confirm the issue now is the dictionary is empty, wasn&#39;t sure where to see the debug output so I added a MsgBox and it appears."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451901725, "post_id": 34532975, "comment_id": 56922103, "body": "Ignore the above - got it working. Absolutely a case of user not being clear of requirements! Once I properly went through your code I realized it was selecting on 1 letter of the value (from the A,B,C example). My actual scenario needs to filter on the first 3, so I updated the &quot;Select Case&quot; line and it works perfectly. Thank you so much for your time and effort."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451904350, "post_id": 34532975, "comment_id": 56923622, "body": "Glad you got that working. It&#39;s a powerful tool in just a handful of code lines."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1451905393, "post_id": 34532975, "comment_id": 56924212, "body": "Absolutely, I&#39;ve put in a &quot;sub&quot; select to try on lengths of 2 as well which works! I want to extend it now to take an array of values, but I&#39;ll give that a go and create a separate question in the future if I get stuck. Thanks again"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 1, "creation_date": 1451905628, "post_id": 34532975, "comment_id": 56924321, "body": "btw, <code>Debug.Print</code> reports to the VBE&#39;s <b>Immediate</b> window. Tap Ctrl+G to reveal it (alternately View \u25ba Immediate Window)."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1452000097, "post_id": 34532975, "comment_id": 56970468, "body": "is there a way to specifically exclude a wildcard? For example I want to include &quot;A*&quot; and &quot;B*&quot;, but exclude &quot;BB*&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1452001452, "post_id": 34532975, "comment_id": 56971362, "body": "After meeting the B requirement, you could easily add a line like <code>If Not Left(vVALs(v, 1), 2) = &quot;BB&quot; Then dVALs.Add Key:=...</code>. If there were many of these, it might make sense to assign <code>vVALs(v, 1)</code> to a string variable just above the <code>Select Case</code> ands use the string var in all subsequent conditions."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1452002819, "post_id": 34532975, "comment_id": 56972353, "body": "Hmm ok, I need to make it a bit more flexible. This has so many comments now and I&#39;ve altered the macro so it might be better to make a new question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1452003275, "post_id": 34532975, "comment_id": 56972693, "body": "Drop one more note here when you do and I&#39;ll try to have a look."}, {"owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "edited": false, "score": 0, "creation_date": 1452005163, "post_id": 34532975, "comment_id": 56974169, "body": "New question here <a href=\"http://stackoverflow.com/questions/34614417/can-autofilter-take-both-inclusive-and-non-inclusive-wildcards-from-dictionary-k\" title=\"can autofilter take both inclusive and non inclusive wildcards from dictionary k\">stackoverflow.com/questions/34614417/&hellip;</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1451494593, "last_edit_date": 1592644375, "creation_date": 1451491699, "answer_id": 34532975, "question_id": 34532282, "link": "https://stackoverflow.com/questions/34532282/can-advanced-filter-criteria-be-in-the-vba-rather-than-a-range/34532975#34532975", "title": "Can Advanced Filter criteria be in the VBA rather than a range?", "body": "<p>To filter on multiple wildcards, create a variant array of wildcard matches and then use the array of full values with the standard AutoFilter method. You can minimize the array by putting a dictionary object to use with its unique index property.</p>\n<p>Consider the following sample data.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/pPquj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPquj.png\" alt=\"autofilter_multi_wilcard\" /></a></p>\n<p>Run this code.</p>\n<pre><code>Sub multiWildcards()\n    Dim v As Long, vVALs As Variant, dVALs As Object\n    Dim colNum As Long\n\n    Set dVALs = CreateObject(&quot;Scripting.Dictionary&quot;)\n    dVALs.comparemode = vbTextCompare\n    colNum = 2 'column B\n\n    With Worksheets(1)\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            vVALs = .Columns(colNum).Cells.Value2\n            For v = LBound(vVALs, 1) To UBound(vVALs, 1)\n                If Not dVALs.exists(vVALs(v, 1)) Then\n                    Select Case UCase(Left(vVALs(v, 1), 1))\n                        Case &quot;A&quot;, &quot;B&quot;, &quot;C&quot;\n                            dVALs.Add Key:=vVALs(v, 1), Item:=vVALs(v, 1)\n                        Case Else\n                            'do nothing\n                    End Select\n                End If\n            Next v\n\n            If CBool(dVALs.Count) Then\n                'populated the dictionary; now use the keys\n                .AutoFilter Field:=colNum, Criteria1:=dVALs.keys, Operator:=xlFilterValues\n            Else\n                Debug.Print &quot;Nothing to filter on; dictionary is empty&quot;\n            End If\n\n            '.CurrentRegion is now filtered on A*, B*, C* in column B\n            'do something with it\n        End With\n    End With\n\n    dVALs.RemoveAll: Set dVALs = Nothing\nEnd Sub\n</code></pre>\n<p>Results should be:</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/CCLOQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CCLOQ.png\" alt=\"autofilter_multi_wilcard_results\" /></a></p>\n<p>These results can be duplicated with many other wildcard scenarios. The <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">Select Case statement</a> is ideal as it supports the <strong>Like</strong> keyword for building your collection of matches. By starting with a value dump into a regular variant array, cycling through even large rows of data can be done quickly.</p>\n"}], "owner": {"reputation": 194, "user_id": 1949145, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ac976d0e0ee54cd87847b11d6623412?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1949145/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4291, "favorite_count": 0, "accepted_answer_id": 34532975, "answer_count": 1, "score": 4, "last_activity_date": 1452967658, "creation_date": 1451489084, "last_edit_date": 1452967658, "question_id": 34532282, "link": "https://stackoverflow.com/questions/34532282/can-advanced-filter-criteria-be-in-the-vba-rather-than-a-range", "title": "Can Advanced Filter criteria be in the VBA rather than a range?", "body": "<p>After trying in vain to set more than 2 criteria in a normal AutoFilter fashion via VBA, I have come to learn that it must be done via advanced filter.</p>\n\n<p>offending example:</p>\n\n<pre><code>Worksheets(1).Range(\"A1\").AutoFilter Field:=ColNum, Criteria1:=\"A*\", Operator:=xlOr, Criteria2:=\"B*\", Operator:=xlOr, Criteria3:=\"C*\"\n</code></pre>\n\n<p>I am hoping to pass the criteria through to a function (rather than a macro) from a PowerShell script. I have it all working fine and as expected for 1 criteria, but now I'd like 3. </p>\n\n<p>I suppose I could instead write a macro to insert a new sheet, write in the criteria then filter on that new range but I'd rather check the preferred way first.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 0, "creation_date": 1451489396, "post_id": 34532151, "comment_id": 56806022, "body": "Is <code>MaxOfMarkasOfDate</code> a column in <code>VolatilityOuput</code> ?"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "reply_to_user": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 0, "creation_date": 1451489741, "post_id": 34532151, "comment_id": 56806195, "body": "however if possible I&#39;d like it to select the max value specifically in the strSQL string, rather than in a Make Table Query as I&#39;ve done already"}, {"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 2, "creation_date": 1451489744, "post_id": 34532151, "comment_id": 56806197, "body": "Then you just need to list them in order which you want the data to be sorted. <code>ORDER BY MaxofMarkasOfDate, MaturityDate</code>. See <a href=\"https://support.office.com/en-us/article/ORDER-BY-Clause-E8EA47F7-5388-460A-BEC8-DCC81792D762\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> . If you select max value from entire input, what is the reason to sort based on that value? It wouldn&#39;t change the order."}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451489069, "creation_date": 1451488605, "last_edit_date": 1451489069, "question_id": 34532151, "link": "https://stackoverflow.com/questions/34532151/using-strsql-to-order-by-multiple-columns-in-access", "title": "Using strSQL to order by Multiple Columns in Access", "body": "<p>I have a simple strSQL string in Access VBA:</p>\n\n<pre><code>Sub SampleReadCurve()\n\n    Dim rs As Recordset\n    Dim iRow As Long, iField As Long\n    Dim strSQL As String\n    Dim CurveID As Long\n    Dim MarkRunID As Long\n\n\n\nCurveID = 15\n\n   strSQL = \"SELECT * FROM VolatilityOutput WHERE CurveID=\" &amp; CurveID &amp; _\n         \" ORDER BY MaturityDate\"\n\n\nDebug.Print strSQL\n\nSet rs = CurrentDb.OpenRecordset(strSQL, Type:=dbOpenDynaset, Options:=dbSeeChanges)\n\nDim MarkAsofDate as Date\n</code></pre>\n\n<p>Now I have two problems. I used a Make Table query to generate the table <code>VolatilityOutput</code>. One of the fields is called <code>MarkAsofDate</code>. I set the query to select the max value for this field. The relevant field in the table is thus \"<code>MaxOfMarkasOfDate</code>\", taking the maximum value in this column.  </p>\n\n<p>I want to order by this <code>MaxOfMarkasofDate</code> column in addition to the <code>MaturityDate</code> column. So I need to change my strSQL string to order by <code>MaturityDate</code> AND <code>MaxOfMarkasofDate</code>. What is the correct syntax to accomplish this? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1451486470, "post_id": 34531580, "comment_id": 56804521, "body": "<code>For i = lBound(slds) to Lbound(slds) + 3</code>  Then use slds(i) to refer to the item."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451486541, "post_id": 34531580, "comment_id": 56804562, "body": "<code>For i = 0 to 3: msgbox slds(i): next i</code> for example."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1451545320, "post_id": 34531580, "comment_id": 56826797, "body": "or just redim the array to your chosen length."}], "answers": [{"tags": [], "owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "is_accepted": false, "score": 2, "last_activity_date": 1451486518, "last_edit_date": 1495542673, "creation_date": 1451486518, "answer_id": 34531615, "question_id": 34531580, "link": "https://stackoverflow.com/questions/34531580/do-a-for-loop-with-just-some-array-elements/34531615#34531615", "title": "Do a for loop with just some array elements", "body": "<p>Assuming a typical zero-based array in VBA:</p>\n\n<pre><code>For i = 0 To 3\n    'do stuff\n    Debug.Print slds(i)\nNext\n</code></pre>\n\n<p>Here you are indicating you want index 0 to 3, or the first 4 elements.</p>\n\n<p>If you can't be certain of zero-based, you'd use<br>\n<code>For i = lBound(slds) to Lbound(slds) + 3</code>as mentioned by <a href=\"https://stackoverflow.com/questions/34531580/do-a-for-loop-with-just-some-array-elements/34531615#comment56804521_34531580\">Scott Craner</a></p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 2, "last_activity_date": 1451545613, "creation_date": 1451545613, "answer_id": 34542578, "question_id": 34531580, "link": "https://stackoverflow.com/questions/34531580/do-a-for-loop-with-just-some-array-elements/34542578#34542578", "title": "Do a for loop with just some array elements", "body": "<p>Or you could just <code>Redim</code> the array to capture the first <em>x</em> values.</p>\n\n<p>For loop retained in case you still want to loop.</p>\n\n<pre><code>Sub a()\nDim slds\nDim lngCnt As Long\nslds = Array(3, 15, 27, 39, 51, 87, 74, 89, 11, 45, 57, 24)\nReDim Preserve slds(1 To 3)\nFor lngCnt = 1 To UBound(slds)\n    Debug.Print slds(lngCnt)\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451545613, "creation_date": 1451486356, "last_edit_date": 1531161705, "question_id": 34531580, "link": "https://stackoverflow.com/questions/34531580/do-a-for-loop-with-just-some-array-elements", "title": "Do a for loop with just some array elements", "body": "<p>I guess this is a easy one but I can't figure it out.</p>\n\n<p>I have an array with multiple items, as it follows:</p>\n\n<pre><code>slds = Array(3, 15, 27, 39, 51, 87, 74, 89, 11, 45, 57, 24)\n</code></pre>\n\n<p>I want to do a <code>For</code> loop using just some items the array, defined by the position, for example, the first 4 elements, but I don't know the correct syntax for it. Something like </p>\n\n<pre><code>For slds(0) to slds(3) 'do some...\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5730556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba15167717051dfe39ef5aaa361abcc1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam B", "link": "https://stackoverflow.com/users/5730556/sam-b"}, "edited": false, "score": 0, "creation_date": 1451491536, "post_id": 34532288, "comment_id": 56807231, "body": "Thanks @newjenn it looks like you&#39;re on the right lines as to what I&#39;m after with the olParentFolder, but it&#39;s not outputting as I need it. For example each category in Outlook is who worked it and outputs to Excel with totals per category. To give something similar to below?\t                                                                      Steve\t6 John\t       1 Phil\t       1 Stu\t       1"}, {"owner": {"reputation": 23, "user_id": 5730556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba15167717051dfe39ef5aaa361abcc1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam B", "link": "https://stackoverflow.com/users/5730556/sam-b"}, "edited": false, "score": 0, "creation_date": 1451493078, "post_id": 34532288, "comment_id": 56808069, "body": "Thanks, but I still think we&#39;re on two different tracks here... I&#39;m talking about categories as in the colour categories within Excel, I don&#39;t quite understand what you are getting at with folderA &amp; folderB?"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1451490799, "last_edit_date": 1451490799, "creation_date": 1451489106, "answer_id": 34532288, "question_id": 34531271, "link": "https://stackoverflow.com/questions/34531271/outlook-vba-pickfolder-command-to-include-subfolders/34532288#34532288", "title": "Outlook VBA Pickfolder command to include subfolders", "body": "<pre><code>Sub Folder_Picker()\n\n    'Needs reference to MS Outlook Object Library\n\n    Dim olApp As Outlook.Application\n    Dim olNs As Outlook.Namespace\n    Dim olParentFolder As Outlook.MAPIFolder\n    Dim olFolderA As Outlook.MAPIFolder\n    Dim olFolderB As Outlook.MAPIFolder\n\n    Set olApp = New Outlook.Application\n    Set olNs = olApp.GetNamespace(\"MAPI\")\nDim Folder_name(100, 100) As String\n\nDim folder_count(100, 100) As String\n     i = 1\n     j = 1\n\nSet olParentFolder = olNs.Session.PickFolder()\n\n    For Each olFolderA In olParentFolder.Folders\n        'Debug.Print olFolderA.folderPath, olFolderA.Items.Count, olFolderA.Folders.Count\n\n         Folder_name(i, j) = olFolderA.folderPath\n        folder_count(i, j) = olFolderA.Folders.Count\n\n         j = j + 1\n        For Each olFolderB In olFolderA.Folders\n           ' Debug.Print olFolderB.folderPath, olFolderB.Items.Count\n\n        Folder_name(i, j) = olFolderA.folderPath\n        folder_count(i, j) = olFolderA.Folders.Count\n\n         j = j + 1\n\n        Next\n        j = 1\n        i = i + 1\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1451507819, "creation_date": 1451507819, "answer_id": 34536888, "question_id": 34531271, "link": "https://stackoverflow.com/questions/34531271/outlook-vba-pickfolder-command-to-include-subfolders/34536888#34536888", "title": "Outlook VBA Pickfolder command to include subfolders", "body": "<p>The PickFolder dialog cannot be customized to support checked treelist items (<a href=\"http://www.dimastr.com/redemption/home.htm\" rel=\"nofollow\">Redemption</a> has this feature though).</p>\n\n<p>Also, if you want to process all subfolders from any given folder, you need to do so recursively to ensure you get children of children all the way down the folder levels, like so:</p>\n\n<pre><code>Sub ProcessFolderCaller()\n     Dim objInbox As Folder\n\n     Set objInbox = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n     ProcessFolder objInbox\nEnd Sub\n\nSub ProcessFolder(objFolder As Folder)\n     Dim intX As Integer\n     Dim objSubFolders As Folders\n\n     Debug.Print \"Processing folder '\" &amp; objFolder.Name &amp; \"'...\"\n\n     Set objSubFolders = objFolder.Folders\n\n     For intX = 1 To objSubFolders.Count\n         Dim objSubjFolderA As Folder\n         Set objSubjFolderA = objSubFolders.Item(intX)\n         ProcessFolder objSubjFolderA\n     Next\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5730556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba15167717051dfe39ef5aaa361abcc1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam B", "link": "https://stackoverflow.com/users/5730556/sam-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2885, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451507819, "creation_date": 1451485045, "question_id": 34531271, "link": "https://stackoverflow.com/questions/34531271/outlook-vba-pickfolder-command-to-include-subfolders", "title": "Outlook VBA Pickfolder command to include subfolders", "body": "<p>I'm currently using the following code to bring back a count of how many e-mails are in each category in Outlook (code is in Excel). However it doesn't take into account any subfolders. Could you help me change the pickfolder to also select any subfolders?</p>\n\n<pre><code>Sub test()\nDim oDict As Scripting.Dictionary\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim olFolder As Outlook.MAPIFolder\n\nDim olItem As Object\nDim arrData() As Variant\nDim CategoryCnt As Integer\nDim c As Long\n\nOn Error Resume Next\n\nSet oDict = New Scripting.Dictionary\n\nSet olApp = New Outlook.Application\n\nSet olNs = olApp.GetNamespace(\"MAPI\")\n\nSet olFolder = olNs.Session.PickFolder()\n\n'Set olFolder = olNS.GetDefaultFolder(olFolderInbox)\n\nCategoryCnt = olNs.Categories.Count\n\n\n\nReDim arrData(1 To 2, 1 To CategoryCnt)\n\nc = 0\nFor Each olItem In olFolder.Items\n    If Not oDict.Exists(olItem.Categories) Then\n        c = c + 1\n        arrData(1, c) = olItem.Categories\n        arrData(2, c) = 1\n        oDict.Add olItem.Categories, c\n    Else\n        arrData(2, oDict.Item(olItem.Categories)) = arrData(2, oDict.Item(olItem.Categories)) + 1\n    End If\nNext olItem\n\nReDim Preserve arrData(1 To 2, 1 To c)\n\nRange(\"A2\").Resize(UBound(arrData, 2), UBound(arrData, 1)).Value = Application.Transpose(arrData)\n\nMsgBox (\"Done\")\n\nEnd Sub\n</code></pre>\n\n<p>Cheers,</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1451484862, "post_id": 34531060, "comment_id": 56803665, "body": "Why the [mysql], [excel] and [excel-vba] tags? Do you want to do this in Access or Excel or MySQL?"}, {"owner": {"reputation": 119, "user_id": 5078957, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-AbV-WEjEZOY/AAAAAAAAAAI/AAAAAAAAASU/CKQC0VauqMs/photo.jpg?sz=128", "display_name": "Rishav Tripathi", "link": "https://stackoverflow.com/users/5078957/rishav-tripathi"}, "edited": false, "score": 0, "creation_date": 1451486033, "post_id": 34531060, "comment_id": 56804267, "body": "I am working on Access and DB is in Access and i want result in Excel"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1451486981, "creation_date": 1451486981, "answer_id": 34531737, "question_id": 34531060, "link": "https://stackoverflow.com/questions/34531060/get-column-name-from-table-in-vba-access/34531737#34531737", "title": "Get column name from table in vba access", "body": "<p>If your current code works (while I wouldn't have written it that way) and if your <code>db</code> is a <code>DAO.Database</code>, you can add:  </p>\n\n<pre><code>    for each f in db.tabledefs(tbl.name).fields\n        debug.print f.name\n    next f\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 5078957, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-AbV-WEjEZOY/AAAAAAAAAAI/AAAAAAAAASU/CKQC0VauqMs/photo.jpg?sz=128", "display_name": "Rishav Tripathi", "link": "https://stackoverflow.com/users/5078957/rishav-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2087, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594642962, "creation_date": 1451484208, "last_edit_date": 1594642962, "question_id": 34531060, "link": "https://stackoverflow.com/questions/34531060/get-column-name-from-table-in-vba-access", "title": "Get column name from table in vba access", "body": "<p>I have written a code for getting the name of the tables present in my access db.\nBelow is the code: </p>\n\n<pre><code>Private Sub Commande49_Click()\n    Dim tbl As AccessObject, db As Object\n    Dim strMsg As String\n    Dim strOut As String\n    Set db = Application.CurrentData\n    For Each tbl In db.AllTables\n    If Not Left(tbl.Name, 4) = \"MSys\" Then\n    Msgbox tbl.Name\n    End If\n    Next tbl\nEnd Sub\n</code></pre>\n\n<p>I want to know how can I retrieve the columns names of each table and display table names and column names in an excel sheet.\nKndly help me on this issue.</p>\n"}, {"tags": ["vba", "excel", "ms-word", "userform"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 2, "creation_date": 1451485879, "post_id": 34530941, "comment_id": 56804196, "body": "There are other ways but that is probably the easiest.  I would add that you will want to trim the values.  trim(TextBox.Value).  Without that a space in one of the textboxes would slip through. Also, look into the difference between TextBox1.Value and TextBox1.Text"}, {"owner": {"reputation": 339, "user_id": 5626469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZonuZ.jpg?s=128&g=1", "display_name": "gazzz0x2z", "link": "https://stackoverflow.com/users/5626469/gazzz0x2z"}, "edited": false, "score": 2, "creation_date": 1451485984, "post_id": 34530941, "comment_id": 56804246, "body": "Yeah, Trim at all costs - unless &quot; &quot; is a valid value in your case(probably not, but I don&#39;t know your area)."}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1451486101, "last_edit_date": 1495541285, "creation_date": 1451486101, "answer_id": 34531519, "question_id": 34530941, "link": "https://stackoverflow.com/questions/34530941/close-userform-if-all-data-captured/34531519#34531519", "title": "Close UserForm if All Data Captured", "body": "<p>You can use the below code</p>\n\n<pre><code> Private Sub CommandButton1_Click()\n\n        If Trim(TextBox1.Value &amp; vbNullString) = vbNullString And _\n            Trim(TextBox2.Value &amp; vbNullString) = vbNullString And _\n               Trim(TextBox3.Value &amp; vbNullString) = vbNullString Then\n\n            Me.Hide\n        Else\n            MsgBox \"Please Complete All Fields!\"\n        End If\n\n    End Sub\n</code></pre>\n\n<p>I got the answer from this question\n<a href=\"https://stackoverflow.com/questions/11863431/vba-to-verify-if-text-exists-in-a-textbox-then-check-if-date-is-in-the-correct\">VBA to verify if text exists in a textbox, then check if date is in the correct format</a></p>\n"}, {"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1451486792, "post_id": 34531649, "comment_id": 56804695, "body": "Thanks, that&#39;s what I currently have in my <code>UserForm</code> and want to possible reduce it. Instead of using <code>True</code> i just assign the value 1 and then use <code>If SomeValue = 3 Then ....</code>"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1451491040, "post_id": 34531649, "comment_id": 56806954, "body": "@Jean-PierreOosthuizen I hate to be a naysayer here, but this solution has a couple problems.  First, it uses the <code>Change</code> event and <code>.Text</code>, which means the event code is triggered much more than necessary and isn&#39;t looking at the actual saved value of a textbox. This, combined with there being no reset of Boolean flags, means a user can type a single character, decide to backspace it, leave the textbox empty without ever assigning a saved value, but will have set the boolean flag to be true. I also think this code is unnecessarily complex (Sorry Matt :( I do have respect for your 4K rep!)"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1451491261, "post_id": 34531649, "comment_id": 56807081, "body": "I appreciate that @P57. Thanks for your input into the question. And your explanation for value vs text is highly benificial. Your answer is valid and worthy"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1451486648, "creation_date": 1451486648, "answer_id": 34531649, "question_id": 34530941, "link": "https://stackoverflow.com/questions/34530941/close-userform-if-all-data-captured/34531649#34531649", "title": "Close UserForm if All Data Captured", "body": "<p>As I said in my comment, that is an ok way to do it. But i'll post this just so you have an example of another way.  This would allow you to evaluate what is going into the text boxes as they are set.</p>\n\n<pre><code>Option Explicit\n\nDim bBox1Value As Boolean\nDim bBox2Value As Boolean\nDim bBox3Value As Boolean\n\nPrivate Sub TextBox1_Change()\n    If Trim(TextBox1.Text) &lt;&gt; \"\" Then\n        bBox1Value = True\n    End If\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n    If Trim(TextBox2.Text) &lt;&gt; \"\" Then\n        bBox2Value = True\n    End If\nEnd Sub\n\nPrivate Sub TextBox3_Change()\n    If Trim(TextBox3.Text) &lt;&gt; \"\" Then\n        bBox3Value = True\n    End If\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\n    If bBox1Value = True And bBox2Value = True And bBox3Value = True Then\n        Me.Hide\n    Else\n        MsgBox \"Please Complete All Fields!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1451486705, "creation_date": 1451486705, "answer_id": 34531666, "question_id": 34530941, "link": "https://stackoverflow.com/questions/34530941/close-userform-if-all-data-captured/34531666#34531666", "title": "Close UserForm if All Data Captured", "body": "<p>You can use a loop:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Dim n as long\n   For n = 1 to 3\n    If Len(Trim(Me.Controls(\"TextBox\" &amp; n).Value)) = 0 Then\n        MsgBox \"Please Complete All Fields!\"\n        Exit Sub\n    End If\n   Next n\n   Me.Hide\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 2, "last_activity_date": 1451494248, "last_edit_date": 1451494248, "creation_date": 1451490240, "answer_id": 34532588, "question_id": 34530941, "link": "https://stackoverflow.com/questions/34530941/close-userform-if-all-data-captured/34532588#34532588", "title": "Close UserForm if All Data Captured", "body": "<h2>Direct User Before Errors Are Made</h2>\n\n<p>Preferable to informing a user after an invalid action has been made is to prevent the user from performing that invalid action in the first place<a href=\"https://www.nngroup.com/articles/user-mistakes/\" rel=\"nofollow noreferrer\">[1]</a>. One way to do this is to use the <code>Textbox_AfterUpdate</code> event to call a shared validation routine that controls the <code>Enabled</code> property of your OK button, and also controls the display of a status label. The result is a more informative interface that only allows valid actions, thereby limiting the nuisance of msgbox popups. Here's some example code and screenshots.</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n    RunValidation\nEnd Sub\nPrivate Sub TextBox2_AfterUpdate()\n    RunValidation\nEnd Sub\nPrivate Sub TextBox3_AfterUpdate()\n    RunValidation\nEnd Sub\nPrivate Sub RunValidation()\n    If Len(TextBox1.Value) = 0 Or Len(TextBox2.Value) = 0 Or Len(TextBox3.Value) = 0 Then\n        CommandButton1.Enabled = False\n        Label1.Visible = True\n    Else\n        CommandButton1.Enabled = True\n        Label1.Visible = False\n    End If\nEnd Sub\nPrivate Sub CommandButton1_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dVmtk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dVmtk.png\" alt=\"enter image description here\"></a></p>\n\n<h2>The <code>If</code> Statement</h2>\n\n<p>As far as the <code>If</code> statement is concerned, there are a ton of ways that can be done, but I think anything other than directly evaluating <code>TextBox.Value</code> leads to unnecessary plumbing and code complexity, so I think it's hard to argue for anything other than the <code>If</code> statement in the OP. That being said, this particular <code>If</code> statement can be slightly condensed by capitalizing on its numeric nature, which allows for</p>\n\n<pre><code>Len(TextBox1.Value) = 0 Or Len(TextBox2.Value) = 0 Or Len(TextBox3.Value) = 0\n</code></pre>\n\n<p>to be replaced with</p>\n\n<pre><code>Len(TextBox1.Value) * Len(TextBox2.Value) * Len(TextBox3.Value) = 0 \n</code></pre>\n\n<p>Although that doesn't gain you much and is arguably less readable code, it does allow for a condensed one liner, especially if the textboxes are renamed...</p>\n\n<pre><code>If Len(TB1.Value) * Len(TB2.Value) * Len(TB3.Value) = 0 Then  \n</code></pre>\n\n<h2>.Value vs .Text</h2>\n\n<p>Lastly, in this case, I think <code>.Value</code> should be used instead of <code>.Text</code>. <code>.Text</code> is more suited for validating a textbox entry while its being typed, but in this case, you're looking to validate a textbox's saved data, which is what you get from <code>.Value</code>.</p>\n\n<h2>More User feedback - Colorization</h2>\n\n<p>I almost forgot, I wanted to include this example of how to include even more user feedback. There is a balance between providing useful feedback and overwhelming with too much. This is especially true if the overall form is complicated, or if the intended user has preferences, but color indication for key fields is usually beneficial. A lot of applications may present the form without color at first and then colorize it if the user is having trouble. </p>\n\n<pre><code>Private InvalidColor\nPrivate ValidColor\nPrivate Sub UserForm_Initialize()\n    InvalidColor = RGB(255, 180, 180)\n    ValidColor = RGB(180, 255, 180)\n    TextBox1.BackColor = InvalidColor\n    TextBox2.BackColor = InvalidColor\n    TextBox3.BackColor = InvalidColor\nEnd Sub\nPrivate Sub TextBox1_AfterUpdate()\n    RunValidation Me.ActiveControl\nEnd Sub\nPrivate Sub TextBox2_AfterUpdate()\n    RunValidation Me.ActiveControl\nEnd Sub\nPrivate Sub TextBox3_AfterUpdate()\n    RunValidation Me.ActiveControl\nEnd Sub\nPrivate Sub RunValidation(ByRef tb As MSForms.TextBox)\n    If Len(tb.Value) &gt; 0 Then\n        tb.BackColor = ValidColor\n    Else\n        tb.BackColor = InvalidColor\n    End If\n\n    If Len(TextBox1.Value) * Len(TextBox2.Value) * Len(TextBox3.Value) = 0 Then\n        CommandButton1.Enabled = False\n        Label1.Visible = True\n    Else\n        CommandButton1.Enabled = True\n        Label1.Visible = False\n    End If\nEnd Sub\nPrivate Sub CommandButton1_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/euG54.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/euG54.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 34532588, "answer_count": 4, "score": 2, "last_activity_date": 1451494248, "creation_date": 1451483726, "last_edit_date": 1531164843, "question_id": 34530941, "link": "https://stackoverflow.com/questions/34530941/close-userform-if-all-data-captured", "title": "Close UserForm if All Data Captured", "body": "<p>Say you have a<code>UserForm</code> with <code>TextBox1</code>, <code>TextBox3</code>, <code>TextBox3</code> and an <code>OK</code> Button.</p>\n\n<p>To only allow the <code>UserForm</code> to close if all three <code>TextBox</code> have data I would use the following script assigned to the <code>OK</code> Button:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    If Len(TextBox1.Value) &gt;= 1 And _\n        Len(TextBox2.Value) &gt;= 1 And _\n            Len(TextBox3.Value) &gt;= 1 Then\n\n        Me.Hide\n    Else\n        MsgBox \"Please Complete All Fields!\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Is there another way to do this besides an <code>If</code> statement?</p>\n"}, {"tags": ["json", "excel", "yql", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1451486391, "post_id": 34529733, "comment_id": 56804475, "body": "It&#39;s literally right in front of you in the error message - <code>syntax error</code> because it was expecting <code>statement_ql</code> at line 1 but it got <code>&#47;</code> instead..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1451489538, "post_id": 34529733, "comment_id": 56806087, "body": "Thanks @MacroMan but if the URL is returning valid JSON, passed through the variable Resource, how can there be a syntax error?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1451590095, "post_id": 34529733, "comment_id": 56843965, "body": "Do you need to run this on a Mac?  If not then switch into a Microsoft library, use the Microsoft Xml Parser."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1451661489, "post_id": 34529733, "comment_id": 56857636, "body": "I don&#39;t. But it must run on several PCs. Any suggestions about libraries?"}], "owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1451479107, "creation_date": 1451479107, "last_edit_date": 1531161705, "question_id": 34529733, "link": "https://stackoverflow.com/questions/34529733/scrape-stock-price-using-vba-web-in-excel", "title": "Scrape stock price using VBA-Web in Excel", "body": "<p>I found <a href=\"https://github.com/VBA-tools/VBA-Web\" rel=\"nofollow\">VBA-Web library</a> which looks very interesting for a project I'm developing for my company.\nBasically, I just need to scrape stock quotes from Yahoo Finance.\nFor example, for IBM, I can get JSON with the URL: </p>\n\n<pre><code>https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20%3D%20%22IBM%22&amp;format=json&amp;diagnostics=true&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&amp;callback=\n</code></pre>\n\n<p>I tried a first simple example but I'm stuck on an error. </p>\n\n<p>This is the code:</p>\n\n<pre><code>Function GetQuote(Query As String) As String\n    ' Create a WebClient for executing requests\n    ' and set a base url that all requests will be appended to\n    Dim QuotesClient As New WebClient\n    QuotesClient.BaseUrl = \"https://query.yahooapis.com/v1/public/yql?q=\"\n\n    ' Use GetJSON helper to execute simple request and work with response\n    Dim Resource As String\n    Dim Response As WebResponse\n\n    Resource = \"select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20%3D%20%22\" &amp; _\n        Query &amp; _\n        \"%22&amp;format=json&amp;diagnostics=true&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&amp;callback=\"\n    Set Response = QuotesClient.GetJson(Resource)\n\n    ProcessQuotes Response\nEnd Function\n\nPublic Sub ProcessQuotes(Response As WebResponse)\n\n    If Response.StatusCode = WebStatusCode.Ok Then\n        Dim Route As Dictionary\n        Set Route = Response.Data(\"query\")(1)(\"results\")(1)(\"quote\")(1)\n\n        Debug.Print \"O pre\u00e7o \u00e9 \" &amp; Route(\"Ask\")(\"text\")\n    Else\n        Debug.Print \"Error: \" &amp; Response.Content\n    End If\nEnd Sub\n</code></pre>\n\n<p>This is giving me: </p>\n\n<pre><code>Error: {\"error\":{\"lang\":\"en-US\",\"diagnostics\":null,\"description\":\"Query syntax error(s) [line 1:0 expecting statement_ql got '/']\"}}\n</code></pre>\n\n<p>But what am I doing wrong in this code, thank you so much for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451479169, "post_id": 34529571, "comment_id": 56800556, "body": "How is the DV list set up? A literal comma delimited string, or using a Range?"}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451479669, "post_id": 34529571, "comment_id": 56800834, "body": "Its set up as a range"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481170, "post_id": 34529933, "comment_id": 56801665, "body": "It works ok, it generates the save as box which just needs to hit enter to save (Not a problem).  Although once I run it, it doesnt stop until i have gone through each value in the DV list, is there a way to stop it if the Red Cross is clicked/Cancel?  And also could there be a way to press OK automatically as it goes through each one as it would do it at a more programming speed than human speed of clicking ok 102 times?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481463, "post_id": 34529933, "comment_id": 56801827, "body": "@MatthewBond If you don&#39;t want to prompt for the file name you could just remove that part - do you still want the original code for a one off PDF run?"}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481713, "post_id": 34529933, "comment_id": 56801948, "body": "It prompts the save, the file name changes with the value in B1 (as in original code) so when i run the code it used to prompt me for each one to save which is what it still does now.    so using what you&#39;ve given me it runs through each one, but on a one by one basis of pressing save each time, how could that be avoided so the code automatically runs through each one (as it does now) but saves it instead of prompting?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481769, "post_id": 34529933, "comment_id": 56801985, "body": "@MatthewBond My question is do you still want to be prompted for the save if you run the original macro as a one off?"}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481893, "post_id": 34529933, "comment_id": 56802049, "body": "oh i see, if possible id like it to just save all from the one prompt"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451481974, "post_id": 34529933, "comment_id": 56802096, "body": "But the prompt changes based on B1 so that couldn&#39;t work. Do you just want to choose a <b>folder</b>, rather than a file name?"}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451482034, "post_id": 34529933, "comment_id": 56802136, "body": "If you could that would be great and il give it a go"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451482634, "post_id": 34529933, "comment_id": 56802459, "body": "OK I&#39;ve posted a revised version of the full code you need."}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451483253, "post_id": 34529933, "comment_id": 56802790, "body": "Thank you, your help is much appreciated"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1451482615, "last_edit_date": 1451482615, "creation_date": 1451479988, "answer_id": 34529933, "question_id": 34529571, "link": "https://stackoverflow.com/questions/34529571/loop-through-data-validation-list-and-carry-out-print-macro/34529933#34529933", "title": "loop through data validation list and carry out print macro", "body": "<p>You can use something like this:</p>\n\n<pre><code>Sub Loop_Through_List()\n\n    Dim cell                  As Excel.Range\n    Dim rgDV                  As Excel.Range\n    Dim DV_Cell               As Excel.Range\n\n    Set DV_Cell = Range(\"B1\")\n\n    Set rgDV = Application.Range(Mid$(DV_Cell.Validation.Formula1, 2))\n    For Each cell In rgDV.Cells\n        DV_Cell.Value = cell.Value\n        Call PDFActiveSheet\n    Next\nEnd Sub\n</code></pre>\n\n<p>Edit: revised code based on comments below:</p>\n\n<pre><code>Sub Loop_Through_List()\n\n    Dim cell                  As Excel.Range\n    Dim rgDV                  As Excel.Range\n    Dim DV_Cell               As Excel.Range\n\n    Set DV_Cell = Range(\"B1\")\n\n    Set rgDV = Application.Range(Mid$(DV_Cell.Validation.Formula1, 2))\n    For Each cell In rgDV.Cells\n        DV_Cell.Value = cell.Value\n        Call PDFActiveSheet\n    Next\nEnd Sub\nSub PDFActiveSheet()\n    Dim ws                    As Worksheet\n    Dim myFile                As Variant\n    Dim strFile               As String\n    Dim sFolder               As String\n    On Error GoTo errHandler\n\n    Set ws = ActiveSheet\n\n    'enter name and select folder for file\n    ' start in current workbook folder\n    strFile = ws.Range(\"B1\").Value &amp; \" Period \" &amp; ws.Range(\"J1\").Value\n\n    sFolder = GetFolder()\n    If sFolder = \"\" Then\n        MsgBox \"No folder selected. Code will terminate.\"\n        Exit Sub\n    End If\n    myFile = sFolder &amp; \"\\\" &amp; strFile\n\n    ws.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=myFile, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False, _\n            From:=1, _\n            To:=2\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n\nFunction GetFolder() As String\n    Dim dlg                   As FileDialog\n    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)\n    dlg.InitialFileName = ThisWorkbook.Path &amp; \"\\\"\n    dlg.Title = \"Select folder to save PDFs\"\n    If dlg.Show = -1 Then\n        GetFolder = dlg.SelectedItems(1)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4293, "favorite_count": 0, "protected_date": 1605629340, "accepted_answer_id": 34529933, "answer_count": 1, "score": 1, "last_activity_date": 1605626433, "creation_date": 1451478456, "last_edit_date": 1531161705, "question_id": 34529571, "link": "https://stackoverflow.com/questions/34529571/loop-through-data-validation-list-and-carry-out-print-macro", "title": "loop through data validation list and carry out print macro", "body": "<p>I have a Data validation list which contains Names of Employees each month i manually go through each one and press a print button with the following macro.</p>\n\n<pre><code>Sub PDFActiveSheet()\nDim ws As Worksheet\nDim strPath As String\nDim myFile As Variant\nDim strFile As String\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\n'enter name and select folder for file\n' start in current workbook folder\nstrFile = Cells.Range(\"B1\") &amp; \" Period \" &amp; Cells.Range(\"J1\")\n\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\nmyFile = Application.GetSaveAsFilename _\n    (InitialFileName:=strFile, _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Folder and FileName to save\")\n\nIf myFile &lt;&gt; \"False\" Then\n    ws.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=myFile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False, _\n    From:=1, _\n    To:=2\n\n\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n</code></pre>\n\n<p>This Prints the sheet out to the pathway where the workbook is saved.</p>\n\n<p>My Data Validation List is in Cell 'B1' Is there a way i can use VBA to loop through the list and print these for me? I Have not been able to really get going doing a draft as using a data validation list in vba is completely new to me.</p>\n\n<pre><code>Sub Loop_Through_List()\n\nDim Name As Variant\n'Dim List As ListBox?\n\nFor Each Name in List\n  Call PDFActiveSheet\nNext\n</code></pre>\n"}, {"tags": ["vba", "sharepoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5730274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c50732c993e9ebe1858c5da45e20b5e?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/5730274/swati"}, "edited": false, "score": 0, "creation_date": 1451716088, "post_id": 34537081, "comment_id": 56870138, "body": "Hi There, Thank you for your response. Could you please help me with the sharepoint link as to which sharepoint link shall I use? I have to create a small tool which fetches data and insert data to an excel sheet placed in sharepoint. But, I am not sure which sharepoint link shall I use?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "is_accepted": false, "score": 0, "last_activity_date": 1451508805, "creation_date": 1451508805, "answer_id": 34537081, "question_id": 34528425, "link": "https://stackoverflow.com/questions/34528425/fetching-data-from-excel-sheet-placed-sharepoint-and-updating-data-in-the-same-e/34537081#34537081", "title": "Fetching data from excel sheet placed sharepoint and updating data in the same excel sheet using VBA", "body": "<p>Something like this should get you going.</p>\n\n<pre><code>Sub UpdateSpecificCells()\n\n'If nobody has the file checked out\nIf Workbooks.CanCheckOut(\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\") = True Then\nApplication.DisplayAlerts = False\n\n'Open the file on the SharePoint server\nWorkbooks.Open Filename:=\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\", UpdateLinks:=xlUpdateLinksNever\n\n\nActiveSheet.Cells(2, 7).Value = 100\nActiveSheet.Cells(3, 7).Value = 200\nActiveSheet.Cells(4, 7).Value = 300\n\n\n'Close the workbook\nWorkbooks(\"ExcelList.xlsb\").Save\nWorkbooks(\"ExcelList.xlsb\").Close\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5730274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c50732c993e9ebe1858c5da45e20b5e?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/5730274/swati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451508805, "creation_date": 1451474091, "question_id": 34528425, "link": "https://stackoverflow.com/questions/34528425/fetching-data-from-excel-sheet-placed-sharepoint-and-updating-data-in-the-same-e", "title": "Fetching data from excel sheet placed sharepoint and updating data in the same excel sheet using VBA", "body": "<p>I have gone through the topics -  Import Sharepoint 2010 list data from Excel table using VBA discussed in this site. Could someone please help me with the below URL as to where can I find them? I have been given the Data Management mini project to fetch and insert the data in excel sheet placed sharepoint but not sure where acn I find sharepoint link.</p>\n\n<p>I have one more requirement of inserting data to the excelsheet placed in sharepoint. Kindly help me with this requirement.</p>\n\n<p>Thank you in advance:)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451471377, "post_id": 34527605, "comment_id": 56796553, "body": "Works perfectly, Thank you."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451471505, "post_id": 34527605, "comment_id": 56796618, "body": "BTW you can just use <code>ActiveSheet.Cells.ClearComments</code> instead of looping."}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1451471889, "post_id": 34527605, "comment_id": 56796797, "body": "Have removed the loop and like you suggested used &#39;ActiveSheet.Cells.ClearComments&#39; instead"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1451471102, "creation_date": 1451471102, "answer_id": 34527605, "question_id": 34527485, "link": "https://stackoverflow.com/questions/34527485/adding-a-comment-to-cell-by-vba-based-on-cell-value-then-remove-it-on-value-chan/34527605#34527605", "title": "Adding a comment to cell by VBA based on cell value then remove it on value change", "body": "<p>You need to clear any existing comment first:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Set Period = Range(\"J1\")\n    Set Target = Range(\"F47\")\n\n    If Period.Value = 8 Then\n        If Not Target.Comment Is Nothing Then Target.Comment.Delete\n        Target.AddComment \"If balance is meant to be negative but = 0\"\n\n    Else: Call Comment_Delete\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You'd probably be better off using a <code>Worksheet_Change</code> event and monitoring J1 - unless that contains a formula.</p>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 34527605, "answer_count": 1, "score": 0, "last_activity_date": 1451471102, "creation_date": 1451470659, "question_id": 34527485, "link": "https://stackoverflow.com/questions/34527485/adding-a-comment-to-cell-by-vba-based-on-cell-value-then-remove-it-on-value-chan", "title": "Adding a comment to cell by VBA based on cell value then remove it on value change", "body": "<p>I share a workbook with multiple colleagues at work and am trying to add a comment to a cell (F47) in a certain period (Period is selected as a list of numbers) in cell J1. </p>\n\n<p>If the Period = 8 i want to add the comment.\nAnd if the Period doesn't = 8 I want to remove/hide the comment.</p>\n\n<pre><code>Sub Comment_Delete()\n\n Dim C As Comment\n\n Worksheets(\"Statement\").Activate\n\n For Each C In ActiveSheet.Comments\n  C.Delete\n Next\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n Set Period = Range(\"J1\")\n Set Target = Range(\"F47\")\n\n If Period.Value = 8 Then\n     Target.AddComment (\"If balance is meant to be negative but = 0, the debtor was invoiced in P8 and balance was paid off, see data sheet P* Bal Paid\")\n\n Else: Call Comment_Delete\n End If\n\n End Sub\n</code></pre>\n\n<p>I get a Runtime 1004 Error if i select off of (J1) with the message \"Application-Defined or Object-defined error\" Which Highlights the code below</p>\n\n<pre><code>Target.AddComment (\"If balance is meant to be negative but = 0, the debtor was invoiced in P8 and balance was paid off, see data sheet P* Bal Paid\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "edited": false, "score": 0, "creation_date": 1451470757, "post_id": 34527426, "comment_id": 56796233, "body": "Are you sure that there&#39;s no code ? have you checked the worksheet objects if they might contain code ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451470761, "post_id": 34527426, "comment_id": 56796236, "body": "You can&#39;t. If you can view the project but can&#39;t see any VBA code (did you check all modules including <code>ThisWorkbook</code> and the worksheets?) then there isn&#39;t any. What format is the file?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1451473140, "post_id": 34527426, "comment_id": 56797403, "body": "Which is? Feel free to answer your question."}, {"owner": {"reputation": 89, "user_id": 3589211, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/a1e0ad618af13b7964e98116c4b45374?s=128&d=identicon&r=PG&f=1", "display_name": "user3589211", "link": "https://stackoverflow.com/users/3589211/user3589211"}, "edited": false, "score": 1, "creation_date": 1451473600, "post_id": 34527426, "comment_id": 56797612, "body": "Now I have found the reason: there is no vba-code and the functionality is reached by using the &quot;formulas&quot; -&gt; &quot;name manager&quot;."}], "owner": {"reputation": 89, "user_id": 3589211, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/a1e0ad618af13b7964e98116c4b45374?s=128&d=identicon&r=PG&f=1", "display_name": "user3589211", "link": "https://stackoverflow.com/users/3589211/user3589211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451470487, "creation_date": 1451470487, "last_edit_date": 1531164843, "question_id": 34527426, "link": "https://stackoverflow.com/questions/34527426/hide-vba-code-without-password-request", "title": "hide vba-code without password request", "body": "<p>I'm using a downloaded excel workbook (solve a quadratic equation and draw the curve), and I can't see any vba-code. If opening the VBA-editor (Alt+F11) there is no code to see, but there is also no querying a password for the vba-code.<br/>\nMy question:<br/>\nHow to achieve such a behavior (hide the vba-code without a password request)?</p>\n\n<p>Regards Wicki</p>\n"}, {"tags": ["xml", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451482801, "post_id": 34526905, "comment_id": 56802554, "body": "You could create a query with just the fields you need, and export that query. Much simpler."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451493291, "post_id": 34526905, "comment_id": 56808206, "body": "@iDevlop - That would create a &quot;flat&quot; denormalized XML file which is not what the user wants."}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "edited": false, "score": 0, "creation_date": 1451472504, "post_id": 34527603, "comment_id": 56797091, "body": "That&#39;s the dilemma, I want to keep it to have the relationship created, but want to get rid of it because it is duplicated information...Is it possible to filter the information in VBA after xml is created?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "edited": false, "score": 0, "creation_date": 1451473036, "post_id": 34527603, "comment_id": 56797354, "body": "Well, you and I can see it, but the XML file (as is) only knows <i>about</i> the relation, not <i>how</i> (which field). This, in addition to the HTML-style tagging, causes XML files to bloat. But I guess you have to supply the XML file for another process out of your control. If not, you could use another format like Json or even CSV."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1451471101, "creation_date": 1451471101, "answer_id": 34527603, "question_id": 34526905, "link": "https://stackoverflow.com/questions/34526905/omit-foreign-key-values-from-child-elements-when-exporting-from-access-to-xml/34527603#34527603", "title": "Omit foreign key values from child elements when exporting from Access to XML", "body": "<p>I can't see how you could. After all, CRID is a field of table RELEASE:</p>\n\n<pre><code>&lt;RELEASE&gt;\n    &lt;ID&gt;1&lt;/ID&gt;\n    &lt;CRID&gt;1&lt;/CRID&gt;\n    &lt;Name&gt;R2016&lt;/Name&gt;\n&lt;/RELEASE&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "edited": false, "score": 0, "creation_date": 1451562602, "post_id": 34530578, "comment_id": 56833635, "body": "I used a XSLT to generate the final result. Thanks a lot!"}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 3, "last_activity_date": 1451493537, "last_edit_date": 1451493537, "creation_date": 1451482407, "answer_id": 34530578, "question_id": 34526905, "link": "https://stackoverflow.com/questions/34526905/omit-foreign-key-values-from-child-elements-when-exporting-from-access-to-xml/34530578#34530578", "title": "Omit foreign key values from child elements when exporting from Access to XML", "body": "<p>If you need to tweak the XML output after using <code>Application.ExportXML</code> you could do the initial export to a temporary XML file and then use an .xslt file like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;\n    &lt;xsl:output indent=\"yes\"/&gt;\n    &lt;xsl:strip-space elements=\"*\"/&gt;\n\n    &lt;xsl:template match=\"@*|node()\"&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:template match=\"RELEASE/CRID\"&gt;\n        &lt;!-- omit by doing nothing --&gt;\n    &lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>and a VBA routine like this</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPublic Sub ApplyXmlTransform(sourceFile, stylesheetFile, resultFile)\n    ' ref: http://archive.oreilly.com/pub/post/transforming_xml_in_microsoft.html\n    '\n    ' project reference required: Microsoft XML, v4.0\n\n    Dim source As New MSXML2.DOMDocument30\n    Dim stylesheet As New MSXML2.DOMDocument30\n    Dim result As New MSXML2.DOMDocument30\n\n    ' Load data.\n    source.async = False\n    source.Load sourceFile  ' source .xml file\n\n    ' Load style sheet.\n    stylesheet.async = False\n    stylesheet.Load stylesheetFile  ' .xslt file\n\n    If (source.parseError.errorCode &lt;&gt; 0) Then\n        MsgBox (\"Error loading source document: \" &amp; source.parseError.reason)\n    Else\n        If (stylesheet.parseError.errorCode &lt;&gt; 0) Then\n            MsgBox (\"Error loading stylesheet document: \" &amp; stylesheet.parseError.reason)\n        Else\n            ' Do the transform.\n            source.transformNodeToObject stylesheet, result\n            result.Save resultFile  ' resulting .xml file\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>to remove <code>&lt;CRID&gt;</code> from the <code>&lt;RELEASE&gt;</code> element.</p>\n"}], "owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 34530578, "answer_count": 2, "score": 1, "last_activity_date": 1451495386, "creation_date": 1451468698, "last_edit_date": 1451495386, "question_id": 34526905, "link": "https://stackoverflow.com/questions/34526905/omit-foreign-key-values-from-child-elements-when-exporting-from-access-to-xml", "title": "Omit foreign key values from child elements when exporting from Access to XML", "body": "<p>I have two tables CR and RELEASE with relationship from CR (ID) to RELEASE (CRID) one to many.</p>\n\n<p>CR (design):</p>\n\n<pre><code>ID: key, unique\nDescription: text\n</code></pre>\n\n<p>RELEASE (design):</p>\n\n<pre><code>ID: key, unique\nCRID: number, not unique\nName: text\n</code></pre>\n\n<p>With the following VBA code, I am managed to export the tables to XML.</p>\n\n<pre><code>Set objOrderInfo = Application.CreateAdditionalData\nobjOrderInfo.Add (\"RELEASE\")\nApplication.ExportXML ObjectType:=acExportTable, DataSource:=\"CR\", _\n                      DataTarget:=pFileNAme, _\n                      AdditionalData:=objOrderInfo\n</code></pre>\n\n<p>The exported XML is something like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;dataroot xmlns:od=\"urn:schemas-microsoft-com:officedata\" generated=\"2015-12-09T09:34:28\"&gt;\n&lt;CR&gt;\n    **&lt;ID&gt;1&lt;/ID&gt;**\n    &lt;Description&gt;Test&lt;/Description&gt;\n    &lt;RELEASE&gt;\n        &lt;ID&gt;1&lt;/ID&gt;\n        **&lt;CRID&gt;1&lt;/CRID&gt;**\n        &lt;Name&gt;R2016&lt;/Name&gt;\n    &lt;/RELEASE&gt;\n    &lt;RELEASE&gt;\n        &lt;ID&gt;2&lt;/ID&gt;\n        **&lt;CRID&gt;1&lt;/CRID&gt;**\n        &lt;Name&gt;R2017&lt;/Name&gt;\n    &lt;/RELEASE&gt;\n&lt;/CR&gt;\n</code></pre>\n\n<p>Note that CRID showed several times in the XML which is practically redundant. How to remove the CRID elements from RELEASE element in XML? Thanks,</p>\n"}, {"tags": ["database", "ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1451471202, "post_id": 34526806, "comment_id": 56796478, "body": "Please have in mind that SO is a code helping forum, not an application writing forum."}, {"owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1451472335, "post_id": 34526806, "comment_id": 56797007, "body": "hey , i am not actually developing an application its just a form inside Ms-Access i just want to find a code/way, that will enable the form to be submitted whenever enter is pressed."}], "answers": [{"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451487867, "post_id": 34531470, "comment_id": 56805261, "body": "That would trigger the event whenever <code>Enter</code> is pressed in the form. Not ideal I think."}], "tags": [], "owner": {"reputation": 1, "user_id": 3754390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b71779f6cee8638aac9ff0891074d5d?s=128&d=identicon&r=PG&f=1", "display_name": "jwill", "link": "https://stackoverflow.com/users/3754390/jwill"}, "is_accepted": false, "score": 0, "last_activity_date": 1451487186, "last_edit_date": 1451487186, "creation_date": 1451485905, "answer_id": 34531470, "question_id": 34526806, "link": "https://stackoverflow.com/questions/34526806/microsoft-access-press-enter-to-add-record/34531470#34531470", "title": "Microsoft Access Press Enter to add record", "body": "<p>If this is all you're going to use this form for and I'm assuming this is an unbound form, in the form's keypress event, you can do:</p>\n\n<pre><code>Private sub Form_keypress(keyascii as integer)\n\nIf keyascii = 13 then\n   'Run your SQL that inserts data into      'table\nEnd if\n\nEnd Sub\n</code></pre>\n\n<p>Under your events tab, don't forget to set Key Preview property to \"yes\", if you don't, the solution above won't work.</p>\n"}, {"comments": [{"owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "edited": false, "score": 0, "creation_date": 1451624939, "post_id": 34531906, "comment_id": 56850183, "body": "Happy new year btw, it gave me an error-- the expression On Change you entered as the event property setting produced the following error: Overflow. * The expression may not result in the name of a macro, the name of a user-defined function, or [Event Procedure]. * There may have been an error evaluating the function, event, or macro."}, {"owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "edited": false, "score": 0, "creation_date": 1451625992, "post_id": 34531906, "comment_id": 56850337, "body": "That was a referencing problem googled it and solved it and after that your code worked like a charm."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 2, "last_activity_date": 1451487698, "creation_date": 1451487698, "answer_id": 34531906, "question_id": 34526806, "link": "https://stackoverflow.com/questions/34526806/microsoft-access-press-enter-to-add-record/34531906#34531906", "title": "Microsoft Access Press Enter to add record", "body": "<p>Since your scanner makes an <code>Enter</code>, you could try something like :  </p>\n\n<pre><code>Private Sub OrderId_AfterUpdate()\n    Me.Dirty = False                  'save record\n    DoCmd.GoToRecord , , acNewRec     'goto new record\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 4101357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/711e556fb0305dc24b7c926a8da69a13?s=128&d=identicon&r=PG&f=1", "display_name": "Angad Arora", "link": "https://stackoverflow.com/users/4101357/angad-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 34531906, "answer_count": 2, "score": 0, "last_activity_date": 1451487698, "creation_date": 1451468342, "question_id": 34526806, "link": "https://stackoverflow.com/questions/34526806/microsoft-access-press-enter-to-add-record", "title": "Microsoft Access Press Enter to add record", "body": "<p>I have a Form with Two Fields</p>\n\n<ol>\n<li>Seller - (A Drop Down list which needs to be selected manually)</li>\n<li>Order ID - Order ids which i would be using a barcode scanner to add.</li>\n</ol>\n\n<p>Since i need to select the seller once and add alot of order ids i set the \"Tab Stop\" to \"No\" for the seller field so that it wont tab there again and again.</p>\n\n<p>Now what i just want is that, since i have already selected the Seller, when i scan a barcode, the data should be entered in the database, and be ready for the next entry to be added with the same Seller Selected (unchanged) and the Order Id field selected for me to scan the barcode again.</p>\n\n<p>PS: Barcode Working - It enters the Text String in any field selected and the barcode itself presses enter after. So if i can set a way that after pressing enter the data is added to the table that would also be helpful.</p>\n"}, {"tags": ["vba", "excel", "connection"], "comments": [{"owner": {"reputation": 19, "user_id": 1579901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfe625e22a3c98acebd1f6d5999ffe0a?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/1579901/dennis"}, "edited": false, "score": 0, "creation_date": 1451891755, "post_id": 34526735, "comment_id": 56917624, "body": "Hi all. Can nobody help here? really look forward to get this resolved. Alternative Solutions are welcome as well. Many Thanks,Dennis"}, {"owner": {"reputation": 19, "user_id": 1579901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfe625e22a3c98acebd1f6d5999ffe0a?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/1579901/dennis"}, "edited": false, "score": 0, "creation_date": 1453390553, "post_id": 34526735, "comment_id": 57589132, "body": "Nobody? It is still relevant!"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4052312, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vbQSB_u01DA/AAAAAAAAAAI/AAAAAAAAADw/mwzAFhgvtmw/photo.jpg?sz=128", "display_name": "Peter Lorei", "link": "https://stackoverflow.com/users/4052312/peter-lorei"}, "is_accepted": false, "score": 1, "last_activity_date": 1492702833, "creation_date": 1492702833, "answer_id": 43524113, "question_id": 34526735, "link": "https://stackoverflow.com/questions/34526735/excel-vba-close-all-open-workbook-connections-to-external-excel-files/43524113#43524113", "title": "EXCEL VBA close all open Workbook connections to external Excel Files", "body": "<p>This sub will remove all connections from the active workbook:</p>\n\n<pre><code>Sub RemoveConnections()\n    Dim conn As Long\n    With ActiveWorkbook\n        For conn = .Connections.Count To 1 Step -1\n            .Connections(conn).Delete\n        Next conn\n    End With\nEnd Sub\n</code></pre>\n\n<p>Just import the data and close the connection when done.</p>\n\n<p>If you meant close ALL the connections across all workbooks at once you could modify RemoveConnections to take a workbook parameter (instead of operating on ActiveWorkbook) and then iterate through the Workbooks collection (<em>untested</em>):</p>\n\n<pre><code>Dim wb As Workbook\n\nFor Each wb In Workbooks\n    wb.AcceptAllChanges\n    Call RemoveConnections(wb)\nNext wb\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 1579901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfe625e22a3c98acebd1f6d5999ffe0a?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/1579901/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3855, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492702833, "creation_date": 1451468057, "last_edit_date": 1451482887, "question_id": 34526735, "link": "https://stackoverflow.com/questions/34526735/excel-vba-close-all-open-workbook-connections-to-external-excel-files", "title": "EXCEL VBA close all open Workbook connections to external Excel Files", "body": "<p>I do have an issue with Excel and Data connections and hope to find a solution.\nSituation: I have an Excel Report with 2 external Data connection\u2019s which feed into pivot tables. The Data Connections are linked to other Excel files containing the Raw Data for the Pivot Tables (Basically just one big Table) and have been setup using the Excel build in function via Data / Connections. Now every time I want to refresh the connections Excel is running out of Memory stopping with an error message.</p>\n\n<p>If I refresh just one pivot Table, save and close the file and then refresh the other pivot table it works but isn\u2019t very handy to use.\nWhat I noticed is, that once the Data has been read into the pivot table, the connection to the Raw Data File is still open which is the reason of the big memory consumption \u2026..I assume. If I delete the connection excel is releasing a loooooooot of memory which brings me to the guess that if I CLOSE the connection after the data has been updated excel will free up memory.</p>\n\n<p>So my question would be:  how can I close any open workbook connections in VBA at once ?\nNote: I think I\u2019m quite good at VBA but I\u2019m not a professional </p>\n\n<p>Many Thanks in advance\nCheers, Dennis</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1451469637, "post_id": 34526132, "comment_id": 56795570, "body": "One major step is to avoid <code>Select</code>, <code>Active*</code> etc.  <a href=\"http://stackoverflow.com/q/10714251/445425\">see this</a>"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 2, "creation_date": 1451478626, "post_id": 34526132, "comment_id": 56800228, "body": "If your code runs this might be better asked at the <a href=\"https://codereview.stackexchange.com/\">code review</a> stack exchange site."}, {"owner": {"reputation": 2051, "user_id": 3626537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1499840559/picture?type=large", "display_name": "Phrancis", "link": "https://stackoverflow.com/users/3626537/phrancis"}, "edited": false, "score": 0, "creation_date": 1451478806, "post_id": 34526132, "comment_id": 56800332, "body": "This could be a good fit for Code Review, however if you posted there you would want to write a title and explanation about what your code <i>does</i> rather than that you would like to improve it."}, {"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "edited": false, "score": 0, "creation_date": 1451489309, "post_id": 34526132, "comment_id": 56805982, "body": "Thank you all, I will do that in future - very much appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1451490238, "post_id": 34529034, "comment_id": 56806473, "body": "Excellent advice -- perhaps some of it could be added to the tag info"}], "tags": [], "owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "is_accepted": false, "score": 4, "last_activity_date": 1451476927, "last_edit_date": 1525816098, "creation_date": 1451476219, "answer_id": 34529034, "question_id": 34526132, "link": "https://stackoverflow.com/questions/34526132/efficiency-through-functions-i-am-lost/34529034#34529034", "title": "Efficiency through functions, I am lost", "body": "<p>I would consider the following:</p>\n\n<ul>\n<li><strong>Macro description</strong>: The comments below the subroutine header should be concise and explain what the macro does, if it is not clear from its name. Your subroutine searches columns. You might want to include what is searched, i.e., \"searches a predefined set of strings, selects [...] and copies from [...] to [...]. I would avoid details such as \"this seemed to be the easiest method\".</li>\n<li><strong>Notation / Variable names</strong>: It is good practice to give consistent names to your variables. In <code>VBA</code> CamelCase is commonplace. Also, prepending the object type in the variable name is very common, i.e., <code>strDoN as String</code>. If you do so though, make sure you do it <em>everywhere</em> (so <code>filepath</code> should be <code>strFilePath</code>). See <a href=\"https://msdn.microsoft.com/en-us/library/aa240858(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here</a> for the naming conventions.</li>\n<li><strong>Type declaration</strong>: Place all <code>Dim</code> statements at the beginning of the subroutine.</li>\n<li><strong>Events</strong>: Be careful with enabling and disabling events. If you disable events they won't be re-enabled automatically, so in case of an error (exception) there should be additional actions that re-enable the events. See <a href=\"https://stackoverflow.com/questions/1038006/good-patterns-for-vba-error-handling\">this post</a> for details on error handling.</li>\n<li>As Chris Neilsen mentioned in the comments, avoid using <code>Select</code> and  <code>Activate</code>.</li>\n<li><strong>Proper <code>Dim</code>-ing</strong>: When you do <code>Dim NumCols, i as Integer</code> you actually do <code>Dim NumCols as Variant, i as Integer</code>. If you want both of them to be integers, use <code>Dim Numcols as Integer, i as Integer</code>. Also, prefer <code>Long</code> to <code>Integer</code>.</li>\n<li><strong>Explicit Declarations</strong>: Put <code>Option Explicit</code> on top of your modules/worksheets. This means that every variable that is used should have been declared first (with a <code>Dim</code> statement). This is useful to avoid bugs from typos, and to have all your variables defined in a single place. Some of your variables, such as <code>RowLast</code> are not defined explicitly now, and they are of <code>Variant</code> type, while their type could had been more specific.</li>\n<li><strong>Avoid hardcoding</strong>: It is good practice to not refer explicitly to whatever the user can change in a worksheet. Example: <code>Sheets(\"New Appeals\").Activate</code> will work if the sheet name is <code>New Appeals</code>, but if the user changes the name, it will break. <a href=\"https://stackoverflow.com/questions/27169070/identifying-a-worksheet-other-than-by-its-name/27169154#27169154\">Use the sheet's ID instead</a>. Similarly, in your code you assign string variables to hardcoded strings (<code>\"Date of Notification\"</code>, etc). It is safer if you design an area in your sheet from where you can pull this data every time.</li>\n<li><strong>Dealing with lots of <code>Case</code>s</strong>: the best solution is to use a <code>Dictionary</code> object. It is more elegant, and the code is less cluttered. An example is <a href=\"https://stackoverflow.com/questions/18311320/excel-vba-using-select-case-but-now-need-an-array/18311783#18311783\">here</a>.</li>\n<li><strong>Copying and Pasting</strong>: Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837760.aspx\" rel=\"nofollow noreferrer\">Range.Copy</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\">Range.PasteSpecial</a> Methods instead of the <code>Selection</code> ones. also, it is not always necessary to Activate a sheet in order to copy/paste there. The <code>Range</code> object can do useful stuff (searching, specialcells, etc.). <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Check it out</a>.</li>\n<li><strong>Fully qualify Ranges</strong>: When you copy-paste data from different sheets/files, always use the full name of your <code>Range/Cells</code> objects, to avoid bugs. Relevant SO post <a href=\"https://stackoverflow.com/questions/17733541/why-does-range-work-but-not-cells\">here</a>.</li>\n<li><strong>Dealing with Large Ranges</strong>: Passing data between <code>Excel</code> and <code>VBA</code> can be time-consuming when the numbers get bigger. A good practice is to pass the excel data to a <code>Variant</code> Array, do whatever processing and then dump them back to excel. <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">This</a> is a good read.</li>\n<li><strong>Use of <code>With</code> blocks</strong>: When you refer to an object's properties/methods multiple times, it enhances readability. Example <a href=\"http://www.homeandlearn.org/with_end_with.html\" rel=\"nofollow noreferrer\">here</a>.</li>\n</ul>\n\n<p>I hope this helps. This is by not means an exhaustive list, but it might be useful to start with. Happy coding!</p>\n"}], "owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1451476927, "creation_date": 1451465844, "last_edit_date": 1531164843, "question_id": 34526132, "link": "https://stackoverflow.com/questions/34526132/efficiency-through-functions-i-am-lost", "title": "Efficiency through functions, I am lost", "body": "<p>I struggle with VBA - I tend to write as though I am the Macro Recorder and as a result write really ugly macros and end up making things far more complicated than needs be.</p>\n\n<p>Can you possibly have a look and help identify some efficiencies? I want to learn to write good code, but need to compare and contrast and its hard from looking at other peoples examples.</p>\n\n<pre><code>Sub ColumnSearch()\n'Filepath variables - the filename changes daily but always contains the name notifications, this seemed to be the easiest method\n\nDim filepath As String\nfilepath = ActiveWorkbook.Path + \"\\\"\nApplication.ScreenUpdating = False\nDim file As String\nDim fullfilepath As String\nfile = Dir$(filepath &amp; \"*Notifications*\" &amp; \".*\")\nfullfilepath = filepath &amp; file\nApplication.EnableEvents = False\nWorkbooks.Open (fullfilepath)\nWindows(file).Activate\nApplication.EnableEvents = True\n\n\n'variables set as string and range respetively\n\nDim strDoN As String, strOffice As String, strARN As String, strPIN As String, strAN As String, strAT As String, strSoS As String\nDim rngDoN As Range, rngOffice As Range, rngARN As Range, rngPIN As Range, rngAN As Range, rngAT As Range, rngSoS As Range\nDim rng2DoN As Range, rng2Office As Range, rng2ARN As Range, rng2PIN As Range, rng2AN As Range, rng2AT As Range, rng2SoS As Range\n\nDim myRange As Range\nDim NumCols, i As Integer\n\n'str variables set as the text in row 1 (title cells)\nstrDoN = \"Date of Notification\"\nstrOffice = \"Office Centre\"\nstrARN = \"Appeal Reference Number\"\nstrPIN = \"PIN\"\nstrAN = \"Appellant Name\"\nstrAT = \"Appeal Type\"\nstrSoS = \"SoS Decision Date\"\n\nSheets(\"New Appeals\").Activate\n\n'For loop to find the address of the strings above\n\nFor i = 1 To 11\n    Select Case Cells(1, i).Value\n        Case strDoN\n            Set rngDoN = Cells(1, i)   '\n        Case strOffice\n            Set rngOffice = Cells(1, i)\n        Case strARN\n            Set rngARN = Cells(1, i)\n        Case strPIN\n            Set rngPIN = Cells(1, i)\n        Case strAN\n            Set rngAN = Cells(1, i)\n        Case strAT\n            Set rngAT = Cells(1, i)\n        Case strSoS\n            Set rngSoS = Cells(1, i)\n        Case Else\n            'no match - do nothing\n    End Select\nNext i\n\n'Identify the count of cells to be copied from one sheet to the other\nRowLast = Cells(Rows.Count, rngOffice.Column).End(xlUp).Row\nCells(RowLast - 1, rngOffice.Column).Select\nRange(Selection, Selection.End(xlUp)).Offset(1, 0).Copy\n\n'activate the other workbook, run the same search for loop but with rng2 being set (rng and rng2 can be different as there are sometimes extra columns that are not required\nWorkbooks(\"Book2.xlsm\").Activate\nSheets(\"New Appeals\").Select\n\n\n\nFor i = 1 To 11\n    Select Case Cells(1, i).Value\n        Case strDoN\n            Set rng2DoN = Cells(1, i)   '&lt;~~ set the range object to this cell\n        Case strOffice\n            Set rng2Office = Cells(1, i)\n        Case strARN\n            Set rng2ARN = Cells(1, i)\n        Case strPIN\n            Set rng2PIN = Cells(1, i)\n        Case strAN\n            Set rng2AN = Cells(1, i)\n        Case strAT\n            Set rng2AT = Cells(1, i)\n        Case strSoS\n            Set rng2SoS = Cells(1, i)\n        Case Else\n            'no match - do nothing\n    End Select\nNext i\n\nDim RowLast2 As Long\n\n'find the last cell that was updated (every day the list will grow, it has to be pasted at the bottom of the last update)\n\nRowLast2 = Cells(Rows.Count, rng2Office.Column).End(xlUp).Row\nCells(RowLast2, rng2Office.Column).Offset(1, 0).Select\nSelection.PasteSpecial\n\nWorkbooks(file).Activate\nSheets(\"New Appeals\").Select\n\n'start from scratch again but with the next variable etc\n\nRowLast = Cells(Rows.Count, rngARN.Column).End(xlUp).Row\nCells(RowLast - 1, rngARN.Column).Select\nRange(Selection, Selection.End(xlUp)).Offset(1, 0).Copy\nWorkbooks(\"Book2.xlsm\").Activate\nSheets(\"New Appeals\").Select\n\nRowLast2 = Cells(Rows.Count, rng2ARN.Column).End(xlUp).Row\nCells(RowLast2, rng2ARN.Column).Offset(1, 0).Select\nSelection.PasteSpecial\n\nWorkbooks(file).Activate\nSheets(\"New Appeals\").Select\n\n\nEnd Sub\n</code></pre>\n\n<p>If this is inapropriate let me know and I'll delete it if needed!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1451464771, "post_id": 34525605, "comment_id": 56792947, "body": "does <code>Set wks = ActiveWorkbook.ActiveSheet</code> work properly ?"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451465906, "post_id": 34525605, "comment_id": 56793559, "body": "Hi @iDevlop, yes it does, the code can function well in newwb.xlsx. THe only issue is the path name."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1451469780, "post_id": 34525605, "comment_id": 56795645, "body": "Then try <code>wks.Parent.FullName</code> ?"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451532235, "post_id": 34525605, "comment_id": 56823199, "body": "It works! But I cannot open the file after it is being saved. (Refer to my edit in the original question) Thanks!!"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1451548994, "post_id": 34525605, "comment_id": 56828030, "body": "Use <code>sFileName</code> instead of recalculating the name!! That&#39;s what variables are for."}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1451803722, "post_id": 34525605, "comment_id": 56892866, "body": "I have found the way to do it in <a href=\"http://stackoverflow.com/questions/20917355/how-do-you-run-a-exe-with-parameters-using-vbas-shell\" title=\"how do you run a exe with parameters using vbas shell\">stackoverflow.com/questions/20917355/&hellip;</a> . Thank you so much for your help!!"}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1451466872, "post_id": 34526201, "comment_id": 56794030, "body": "Hi. <code>Application.ActiveWorkbook.FullName</code> works and it returns the path of the XLA file. However, I am not looking for this path. Instead, I am looking for the path of the newwb.xlsx file."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 1, "creation_date": 1451502227, "post_id": 34526201, "comment_id": 56812810, "body": "It returns the path of the active workbook for me when used from an XLA addin. Are you sure that you are calling the code from within the addin file and have correctly saved it as an XLA or XLAM?"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1451522624, "post_id": 34526201, "comment_id": 56821153, "body": "Hi, yes the code managed to return the correct path with I use <code>Application.ActiveWorkbook.Path</code> at this line:      <code>sFilename = Application.ActiveWorkbook.Path &amp; &quot;\\newwb.csv&quot;</code>  However, it does not run at the line below, with the error saying that the system is not able to find the file.      <code>MyTextFile = Shell(&quot;C:\\Windows\\notepad.exe Application.ActiveWorkbook.Path &amp; &#47;S &#47;K  &quot;&quot;\\newwb.csv&quot;&quot;&quot;, vbNormalFocus)</code>"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 1, "creation_date": 1451561357, "post_id": 34526201, "comment_id": 56833097, "body": "try something like MyTextFile = Shell(&quot;C:\\Windows\\notepad.exe &quot; &amp;  Application.ActiveWorkbook.Path &amp; &quot; /S /K &quot;&quot;\\newwb.csv&quot;&quot;&quot;, vbNormalFocus)"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1451803678, "post_id": 34526201, "comment_id": 56892859, "body": "I have found the way to go about doing it from <a href=\"http://stackoverflow.com/questions/20917355/how-do-you-run-a-exe-with-parameters-using-vbas-shell\" title=\"how do you run a exe with parameters using vbas shell\">stackoverflow.com/questions/20917355/&hellip;</a>. Thank you so much for your help!!"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1451466119, "creation_date": 1451466119, "answer_id": 34526201, "question_id": 34525605, "link": "https://stackoverflow.com/questions/34525605/path-of-separate-workbook/34526201#34526201", "title": "Path of separate workbook", "body": "<p>ActiveWorknook.Fullname works correctly for me when used from an XLA.\nNote that your code</p>\n\n<pre><code>sFilename = Application.ActiveWorkbook.FullName &amp; \"\\newwb.csv\"\n</code></pre>\n\n<p>does not use just the path to the active workbook but the path and name of the active workbook appended with \\newwb.csv</p>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "is_accepted": true, "score": 0, "last_activity_date": 1460681277, "last_edit_date": 1495539920, "creation_date": 1451804049, "answer_id": 34574111, "question_id": 34525605, "link": "https://stackoverflow.com/questions/34525605/path-of-separate-workbook/34574111#34574111", "title": "Path of separate workbook", "body": "<p>I have found the way to run the code smoothly, in courtesy of <a href=\"https://stackoverflow.com/questions/20917355/how-do-you-run-a-exe-with-parameters-using-vbas-shell\">How do you run a .exe with parameters using vba&#39;s shell()?</a> . Hope this will help anyone in need, and I would like to appreciate my gratitude to those who have tried to help. Thanks!! </p>\n\n<p>Final Code:</p>\n\n<pre><code>Option Explicit\nSub CreateCSV()\n\n'Declare the data type of the variables\nDim wks As Worksheet\nDim lastCol As Integer\nDim lastRow As Long\nDim iCol As Integer\nDim iRow As Long\nDim sFilename As String\nDim cellValue As String\nDim MyTextFile\nDim strProgramName As String\n\n'Set wks to the current active worksheet\nSet wks = ActiveWorkbook.ActiveSheet\n\n'Set the location of the csv file to a variable\nsFilename = Application.ActiveWorkbook.Path &amp; \"\\testing.csv\"\n\n'Within the current active worksheet, identify the last interested row and column of data\n'Any values such as 'a', '1' or '%' are considered as values. Spaces (Spacebars) are not considered as values.\nWith wks\n    With .Cells(1, 1).CurrentRegion\n        lastCol = .Columns.Count\n        lastRow = .Rows.Count\n    End With\n\n    'Delete extra rows with blank spaces\n    For iRow = 1 To lastRow\n        For iCol = 1 To lastCol\n            cellValue = wks.Cells(iRow, iCol)\n        Next iCol\n\n        If Trim(cellValue) = \"\" Then\n            wks.Cells(iRow, iCol).EntireRow.Clear\n            wks.Cells(iRow, iCol).EntireColumn.Clear\n        End If\n    Next iRow\n\n   'Delete extra rows and columns with formats\n    .Cells(lastRow + 1, 1).Resize(Rows.Count - lastRow, 1).EntireRow.Clear\n    .Cells(1, lastCol + 1).Resize(1, Columns.Count - lastCol).EntireColumn.Clear\n    .UsedRange.Select\nEnd With\n\n'Save as .CSV file in the specific location stated earlier\n'If there are errors in the code when Users presses 'No' for the conversion, set wks to nothing and end the process\nOn Error GoTo err_handler\nwks.SaveAs Filename:=sFilename, FileFormat:=xlCSV\n\n'System to/not display alerts to notify Users that they are replacing an existing file.\nApplication.DisplayAlerts = True\n\n'Notify users that the .CSV file has been saved\nMsgBox sFilename &amp; \" saved\"\n\n'Opens the CSV file in a specifc location in Notepad\nstrProgramName = \"C:\\Windows\\notepad.exe\"\nMyTextFile = Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; sFilename &amp; \"\"\"\", vbNormalFocus)\n\nerr_handler:\n'Set Wks to its default value\nSet wks = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 34574111, "answer_count": 2, "score": 0, "last_activity_date": 1460681277, "creation_date": 1451463738, "last_edit_date": 1451584498, "question_id": 34525605, "link": "https://stackoverflow.com/questions/34525605/path-of-separate-workbook", "title": "Path of separate workbook", "body": "<p>I wrote a macro as an AddIn so that it is available in any of the workbooks I open. This macro will automatically save an Excel file as a CSV file. When I open a new workbook (newwb.xlsx) and apply this AddIn, I want my code to automatically find the path where I saved this newwb.xlsx and save it in the same location.</p>\n\n<p>I found online that <code>Application.ActiveWorkbook.Path</code> can be used to locate path itself and  <code>Application.ActiveWorkbook.FullName</code> for the path with the workbook name. However, it only returns the path name of the AddIn file and not the path name of newwb.xlsx. </p>\n\n<p>How do I get the file path of the new workbook file?</p>\n\n<p>Here is my code: </p>\n\n<pre><code>'Declare the data type of the variables\nDim wks As Worksheet\nDim lastCol As Integer\nDim lastRow As Long\nDim iCol As Integer\nDim iRow As Long\nDim sFilename As String\nDim cellValue As String\nDim MyTextFile\n\n'Set wks to the current active worksheet\nSet wks = ActiveWorkbook.ActiveSheet\n\n'Set the location of the csv file to a variable\nsFilename = Application.ActiveWorkbook.FullName &amp; \"\\newwb.csv\"\n\n'Within the current active worksheet, identify the last interested row and column of data\n'Any values such as 'a', '1' or '%' are considered as values. Spaces (Spacebars) are not considered as values.\nWith wks\n    With .Cells(1, 1).CurrentRegion\n        lastCol = .Columns.Count\n        lastRow = .Rows.Count\n    End With\n\n    'Delete extra rows with blank spaces\n    For iRow = 1 To lastRow\n        For iCol = 1 To lastCol\n            cellValue = wks.Cells(iRow, iCol)\n        Next iCol\n\n        If Trim(cellValue) = \"\" Then\n            wks.Cells(iRow, iCol).EntireRow.Clear\n            wks.Cells(iRow, iCol).EntireColumn.Clear\n        End If\n    Next iRow\n\n   'Delete extra rows and columns with formats\n    .Cells(lastRow + 1, 1).Resize(Rows.Count - lastRow, 1).EntireRow.Clear\n    .Cells(1, lastCol + 1).Resize(1, Columns.Count - lastCol).EntireColumn.Clear\n    .UsedRange.Select\nEnd With\n\n'Save as .CSV file in the specific location stated earlier\n'If there are errors in the code when Users presses 'No' for the conversion, set wks to nothing and end the process\nOn Error GoTo err_handler\nwks.SaveAs Filename:=sFilename, FileFormat:=xlCSV\n\n'System to/not display alerts to notify Users that they are replacing an existing file.\nApplication.DisplayAlerts = True\n\n'Notify users that the .CSV file has been saved\nMsgBox sFilename &amp; \" saved\"\n\n'Opens the CSV file in a specifc location in Notepad\nMyTextFile = Shell(\"C:\\Windows\\notepad.exe ActiveWorkbook.Path &amp; /S /K  \"\"\\newwb.csv\"\"\", vbNormalFocus)\n\n\nerr_handler:\n'Set Wks to its default value\nSet wks = Nothing\n\nEnd Sub\n</code></pre>\n\n<h2>Edit:</h2>\n\n<p><code>Application.ActiveWorkbook.Path</code> works at the line: </p>\n\n<pre><code>sFilename = Application.ActiveWorkbook.Path &amp; \"\\newwb.csv\"\n</code></pre>\n\n<p>but there is an error saying that the system cannot find the path in this line:</p>\n\n<pre><code>MyTextFile = Shell(\"C:\\Windows\\notepad.exe Application.ActiveWorkbook.Path &amp; /S /K  \"\"\\newwb.csv\"\"\", vbNormalFocus)\n</code></pre>\n"}, {"tags": ["arrays", "vba", "loops", "compare", "range"], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": true, "score": 0, "last_activity_date": 1451471028, "creation_date": 1451471028, "answer_id": 34527582, "question_id": 34525298, "link": "https://stackoverflow.com/questions/34525298/how-to-compare-multiple-rows-between-two-different-worksheets-in-excel-2010/34527582#34527582", "title": "How to compare multiple rows between two different worksheets in excel 2010?", "body": "<p>try the following code.</p>\n\n<pre><code>Option Explicit\n\n    Sub Test()\n\n    Dim thisyearlstr As Integer\n\n    Dim Lastyearlstr As Integer\n\n    Dim Resultlstr As Integer\n\n    Dim thisyearbday As String\n\n    Dim Lastyearbday As String\n\n    Dim thisyearg1 As String\n\n    Dim thisyearg2 As String\n\n    Dim thisyearg3 As String\n\n    Dim lastyearg1 As String\n\n    Dim lastyearg2 As String\n\n    Dim lastyearg3 As String\n\n    Dim i As Integer\n\n    Dim lookup As String\n\n    Dim grade1 As Integer\n\n    Dim grade2 As Integer\n\n    Dim grade3 As Integer\n\n    ThisWorkbook.Sheets(\"Result\").Activate\n    Cells.Select\n\n    Selection.Delete Shift:=xlUp\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"A1\").Value = \"Name\"\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"B1\").Value = \"Birthday\"\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"C1\").Value = \"Grade 1\"\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"D1\").Value = \"Grade 2\"\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"E1\").Value = \"Grade 3\"\n\n    Resultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row + 1\n\n    thisyearlstr = ThisWorkbook.Sheets(\"This year\").Range(\"A60000\").End(xlUp).Row\n\n    Lastyearlstr = ThisWorkbook.Sheets(\"Last year\").Range(\"A60000\").End(xlUp).Row\n\n    ThisWorkbook.Sheets(\"This year\").Range(\"A2:A\" &amp; thisyearlstr).Copy\n\n    ThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; Resultlstr).PasteSpecial\n\n    Resultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row\n\n    For i = 2 To Resultlstr\n\n    lookup = ThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; i).Value\n\n     thisyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:B\"), 2, 0)\n\n    Lastyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:B\"), 2, 0)\n\n\n    thisyearg1 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:C\"), 3, 0)\n\n\n     thisyearg2 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:D\"), 4, 0)\n\n     thisyearg3 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:E\"), 5, 0)\n\n    lastyearg1 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:C\"), 3, 0)\n\n\n     lastyearg2 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:D\"), 4, 0)\n\n     lastyearg3 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:E\"), 5, 0)\n\n         ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Value = thisyearbday\n        ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Value = thisyearg1\n       ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Value = thisyearg2\n       ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Value = thisyearg3\n\n       If thisyearbday = Lastyearbday Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(217, 217, 217)\n       Else\n       ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(204, 192, 218)\n       End If\n       grade1 = Comparegrade(thisyearg1, lastyearg1)\n       If grade1 = 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(217, 217, 217)\n       ElseIf grade1 &lt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(230, 184, 183)\n       ElseIf grade1 &gt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(216, 228, 188)\n       End If\n\n\n      grade2 = Comparegrade(thisyearg2, lastyearg2)\n       If grade2 = 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(217, 217, 217)\n       ElseIf grade2 &lt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(230, 184, 183)\n       ElseIf grade2 &gt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(216, 228, 188)\n       End If\n       grade3 = Comparegrade(thisyearg3, lastyearg3)\n       If grade3 = 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(217, 217, 217)\n       ElseIf grade3 &lt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(230, 184, 183)\n       ElseIf grade3 &gt; 0 Then\n       ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(216, 228, 188)\n       End If\n\n    Next\n\n\n    End Sub\n\n    Function Comparegrade(grade1, grade2)\n\n    If UCase(grade1) = \"A\" Then\n    grade1 = 4\n\n\n    ElseIf UCase(grade1) = \"B\" Then\n    grade1 = 3\n\n\n    ElseIf UCase(grade1) = \"C\" Then\n    grade1 = 2\n\n\n\n    ElseIf UCase(grade1) = \"D\" Then\n    grade1 = 1\n\n    End If\n\n    If UCase(grade2) = \"A\" Then\n    grade2 = 4\n\n\n    ElseIf UCase(grade2) = \"B\" Then\n    grade2 = 3\n\n\n    ElseIf UCase(grade2) = \"C\" Then\n    grade2 = 2\n\n    ElseIf UCase(grade2) = \"D\" Then\n    grade2 = 1\n\n    End If\n\n    Comparegrade = grade1 - grade2\n    End Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": false, "score": 0, "last_activity_date": 1451532804, "creation_date": 1451532804, "answer_id": 34540655, "question_id": 34525298, "link": "https://stackoverflow.com/questions/34525298/how-to-compare-multiple-rows-between-two-different-worksheets-in-excel-2010/34540655#34540655", "title": "How to compare multiple rows between two different worksheets in excel 2010?", "body": "<p>Try The following code.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\nDim thisyearlstr As Integer\n\nDim Lastyearlstr As Integer\n\nDim Resultlstr As Integer\n\n\nDim thisyearbday As String\n\nDim Lastyearbday As String\n\nDim thisyrAday As String\n\nDim lastyrAday As String\n\nDim thisyrRday As String\n\nDim lastyrRday As String\n\n\nDim thisyearg As String\n\nDim lastyearg As String\n\n\nDim i As Integer\n\nDim lookup As String ' name under check\n\nDim grade1 As Integer\n\nDim grade2 As Integer\n\n\nThisWorkbook.Sheets(\"Result\").Activate\nCells.Select\n\nSelection.Delete Shift:=xlUp\n\n' Writing labels to first row\nThisWorkbook.Sheets(\"Result\").Range(\"A1\").Value = \"Name\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"B1\").Value = \"Birthday\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"C1\").Value = \"AppDay\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"D1\").Value = \"RankDay\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"E1\").Value = \"Grade 1\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"F1\").Value = \"Grade 2\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"G1\").Value = \"Grade 3\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"H1\").Value = \"Grade 4\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"I1\").Value = \"Grade 5\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"J1\").Value = \"Grade 6\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"K1\").Value = \"Grade 7\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"L1\").Value = \"Grade 8\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"M1\").Value = \"Grade 9\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"N1\").Value = \"Grade 10\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"O1\").Value = \"Grade 11\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"P1\").Value = \"Grade 12\"\n\nResultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row + 1\n\nthisyearlstr = ThisWorkbook.Sheets(\"This year\").Range(\"A60000\").End(xlUp).Row\n\nLastyearlstr = ThisWorkbook.Sheets(\"Last year\").Range(\"A60000\").End(xlUp).Row\n\n' Copy all names in \"This year\" to \"Result\" Worksheet\nThisWorkbook.Sheets(\"This year\").Range(\"A2:A\" &amp; thisyearlstr).Copy\n\nThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; Resultlstr).PasteSpecial\n\nResultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row\n\nFor i = 2 To Resultlstr\n\nlookup = ThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; i).Value ' lookup = name under check\n\nthisyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:B\"), 2, 0) ' store B-day of the name under check\n\nthisyrAday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:C\"), 3, 0)\n\nthisyrRday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:D\"), 4, 0)\n\nLastyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:B\"), 2, 0)\n\nlastyrAday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:C\"), 3, 0)\n\nlastyrRday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:D\"), 4, 0)\n\nThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Value = thisyearbday ' writing stored data to \"Result\" worksheet\nThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Value = thisyrAday\nThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Value = thisyrRday\n\n\n\n\n' Determine if b-day entries in two worksheets are the same\n   If thisyearbday = Lastyearbday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n   If thisyrAday = lastyrAday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n   If thisyrRday = lastyrRday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n\n    For j = 5 To 16\n    grade = \"\"\nthisyearg = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:P\"), j, 0)\n\nlastyearg = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:P\"), j, 0)\nThisWorkbook.Sheets(\"Result\").Cells(i, j).Value = thisyearg\n\ngrade = Comparegrade(thisyearg, lastyearg)\n\n  If grade = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Cells(i, j).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade1 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Cells(i, j).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade1 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Cells(i, j).Interior.Color = RGB(216, 228, 188)\nEnd If\n\nNext      \n\nNext\n\n\nEnd Sub\n\nFunction Comparegrade(grade1, grade2)\n\nIf UCase(grade1) = \"A\" Then\ngrade1 = 4\nElseIf UCase(grade1) = \"B\" Then\ngrade1 = 3\nElseIf UCase(grade1) = \"C\" Then\ngrade1 = 2\nElseIf UCase(grade1) = \"D\" Then\ngrade1 = 1\nEnd If\n\nIf UCase(grade2) = \"A\" Then\ngrade2 = 4\nElseIf UCase(grade2) = \"B\" Then\ngrade2 = 3\nElseIf UCase(grade2) = \"C\" Then\ngrade2 = 2\nElseIf UCase(grade2) = \"D\" Then\ngrade2 = 1\nEnd If\n\nComparegrade = grade1 - grade2\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5729655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd26c0e567e6883f89e22e47e7c60233?s=128&d=identicon&r=PG&f=1", "display_name": "bh14029", "link": "https://stackoverflow.com/users/5729655/bh14029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 34527582, "answer_count": 2, "score": -2, "last_activity_date": 1451532804, "creation_date": 1451462150, "last_edit_date": 1451531503, "question_id": 34525298, "link": "https://stackoverflow.com/questions/34525298/how-to-compare-multiple-rows-between-two-different-worksheets-in-excel-2010", "title": "How to compare multiple rows between two different worksheets in excel 2010?", "body": "<p>Worksheet 1 (This year):</p>\n\n<pre><code>Name       Birthday     Grade 1 Grade 2 Grade 3  \n\nAAA        dd/mm/yyyy      B       A      B\nBBB        dd1/mm/yyyy     A       B      C\nCCC        dd/mm/yyyy      B       C      D\nDDD        dd/mm/yyyy      C       D      C\n</code></pre>\n\n<p>Worksheet 2 (Last year):</p>\n\n<pre><code>Name       Birthday     Grade 1 Grade 2 Grade 3   \n\nBBB        dd/mm/yyyy      B       B      B\nAAA        dd/mm/yyyy      A       A      A\nDDD        dd/mm/yyyy      D       D      D\nCCC        dd/mm/yyyy      C       C      C\n</code></pre>\n\n<p>I need to check the marks and birthday of all students and compare those information of both years. \n(Birthday of the student will not be changed, but I need to verify if the birthday record is consistent or not)</p>\n\n<p>I hope I can get the results like below, How do i achieve this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/CCH28.png\" alt=\"enter image description here\"></p>\n\n<p>-------------------------------------------------- Updated on 31 Dec -------------------------------------------------------</p>\n\n<p>Thanks for the code from \"RAJA THEVAR\", the two worksheets can be compared.</p>\n\n<p>Actually three (3) date entries and twelve (12) grade entries will be compared.</p>\n\n<p>I modified the code and found it becomes a bit lengthy. I hope it can be simplified by using some loops, array, etc.</p>\n\n<p>Is there a way to do that?</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub Test()\n\nDim thisyearlstr As Integer\n\nDim Lastyearlstr As Integer\n\nDim Resultlstr As Integer\n\n\nDim thisyearbday As String\n\nDim Lastyearbday As String\n\nDim thisyrAday As String\n\nDim lastyrAday As String\n\nDim thisyrRday As String\n\nDim lastyrRday As String\n\n\nDim thisyearg1 As String\n\nDim thisyearg2 As String\n\nDim thisyearg3 As String\n\nDim thisyearg4 As String\n\nDim thisyearg5 As String\n\nDim thisyearg6 As String\n\nDim thisyearg7 As String\n\nDim thisyearg8 As String\n\nDim thisyearg9 As String\n\nDim thisyearg10 As String\n\nDim thisyearg11 As String\n\nDim thisyearg12 As String\n\n\nDim lastyearg1 As String\n\nDim lastyearg2 As String\n\nDim lastyearg3 As String\n\nDim lastyearg4 As String\n\nDim lastyearg5 As String\n\nDim lastyearg6 As String\n\nDim lastyearg7 As String\n\nDim lastyearg8 As String\n\nDim lastyearg9 As String\n\nDim lastyearg10 As String\n\nDim lastyearg11 As String\n\nDim lastyearg12 As String\n\nDim i As Integer\n\nDim lookup As String ' name under check\n\nDim grade1 As Integer\n\nDim grade2 As Integer\n\nDim grade3 As Integer\n\nDim grade4 As Integer\n\nDim grade5 As Integer\n\nDim grade6 As Integer\n\nDim grade7 As Integer\n\nDim grade8 As Integer\n\nDim grade9 As Integer\n\nDim grade10 As Integer\n\nDim grade11 As Integer\n\nDim grade12 As Integer\n\nThisWorkbook.Sheets(\"Result\").Activate\nCells.Select\n\nSelection.Delete Shift:=xlUp\n\n' Writing labels to first row\nThisWorkbook.Sheets(\"Result\").Range(\"A1\").Value = \"Name\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"B1\").Value = \"Birthday\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"C1\").Value = \"AppDay\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"D1\").Value = \"RankDay\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"E1\").Value = \"Grade 1\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"F1\").Value = \"Grade 2\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"G1\").Value = \"Grade 3\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"H1\").Value = \"Grade 4\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"I1\").Value = \"Grade 5\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"J1\").Value = \"Grade 6\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"K1\").Value = \"Grade 7\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"L1\").Value = \"Grade 8\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"M1\").Value = \"Grade 9\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"N1\").Value = \"Grade 10\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"O1\").Value = \"Grade 11\"\n\nThisWorkbook.Sheets(\"Result\").Range(\"P1\").Value = \"Grade 12\"\n\nResultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row + 1\n\nthisyearlstr = ThisWorkbook.Sheets(\"This year\").Range(\"A60000\").End(xlUp).Row\n\nLastyearlstr = ThisWorkbook.Sheets(\"Last year\").Range(\"A60000\").End(xlUp).Row\n\n' Copy all names in \"This year\" to \"Result\" Worksheet\nThisWorkbook.Sheets(\"This year\").Range(\"A2:A\" &amp; thisyearlstr).Copy\n\nThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; Resultlstr).PasteSpecial\n\nResultlstr = ThisWorkbook.Sheets(\"Result\").Range(\"A60000\").End(xlUp).Row\n\nFor i = 2 To Resultlstr\n\nlookup = ThisWorkbook.Sheets(\"Result\").Range(\"A\" &amp; i).Value ' lookup = name under check\n\nthisyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:B\"), 2, 0) ' store B-day of the name under check\n\nthisyrAday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:C\"), 3, 0)\n\nthisyrRday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:D\"), 4, 0)\n\nLastyearbday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:B\"), 2, 0)\n\nlastyrAday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:C\"), 3, 0)\n\nlastyrRday = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"last year\").Range(\"A:D\"), 4, 0)\n\n\nthisyearg1 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:E\"), 5, 0)\n\nthisyearg2 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:F\"), 6, 0)\n\nthisyearg3 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:G\"), 7, 0)\n\nthisyearg4 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:H\"), 8, 0)\n\nthisyearg5 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:I\"), 9, 0)\n\nthisyearg6 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:J\"), 10, 0)\n\nthisyearg7 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:K\"), 11, 0)\n\nthisyearg8 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:L\"), 12, 0)\n\nthisyearg9 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:M\"), 13, 0)\n\nthisyearg10 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:N\"), 14, 0)\n\nthisyearg11 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:O\"), 15, 0)\n\nthisyearg12 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"This year\").Range(\"A:P\"), 16, 0)\n\n\nlastyearg1 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:E\"), 5, 0)\n\nlastyearg2 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:F\"), 6, 0)\n\nlastyearg3 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:G\"), 7, 0)\n\nlastyearg4 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:H\"), 8, 0)\n\nlastyearg5 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:I\"), 9, 0)\n\nlastyearg6 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:J\"), 10, 0)\n\nlastyearg7 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:K\"), 11, 0)\n\nlastyearg8 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:L\"), 12, 0)\n\nlastyearg9 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:M\"), 13, 0)\n\nlastyearg10 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:N\"), 14, 0)\n\nlastyearg11 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:O\"), 15, 0)\n\nlastyearg12 = WorksheetFunction.VLookup(lookup, ThisWorkbook.Sheets(\"Last year\").Range(\"A:P\"), 16, 0)\n\n\nThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Value = thisyearbday ' writing stored data to \"Result\" worksheet\nThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Value = thisyrAday\nThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Value = thisyrRday\nThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Value = thisyearg1\nThisWorkbook.Sheets(\"Result\").Range(\"F\" &amp; i).Value = thisyearg2\nThisWorkbook.Sheets(\"Result\").Range(\"G\" &amp; i).Value = thisyearg3\nThisWorkbook.Sheets(\"Result\").Range(\"H\" &amp; i).Value = thisyearg4\nThisWorkbook.Sheets(\"Result\").Range(\"I\" &amp; i).Value = thisyearg5\nThisWorkbook.Sheets(\"Result\").Range(\"J\" &amp; i).Value = thisyearg6\nThisWorkbook.Sheets(\"Result\").Range(\"K\" &amp; i).Value = thisyearg7\nThisWorkbook.Sheets(\"Result\").Range(\"L\" &amp; i).Value = thisyearg8\nThisWorkbook.Sheets(\"Result\").Range(\"M\" &amp; i).Value = thisyearg9\nThisWorkbook.Sheets(\"Result\").Range(\"N\" &amp; i).Value = thisyearg10\nThisWorkbook.Sheets(\"Result\").Range(\"O\" &amp; i).Value = thisyearg11\nThisWorkbook.Sheets(\"Result\").Range(\"P\" &amp; i).Value = thisyearg12\n\n' Determine if b-day entries in two worksheets are the same\n   If thisyearbday = Lastyearbday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"B\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n   If thisyrAday = lastyrAday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"C\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n   If thisyrRday = lastyrRday Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   Else\n   ThisWorkbook.Sheets(\"Result\").Range(\"D\" &amp; i).Interior.Color = RGB(204, 192, 218)\n   End If\n\n   grade1 = Comparegrade(thisyearg1, lastyearg1)\n   If grade1 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade1 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade1 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"E\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n\n   grade2 = Comparegrade(thisyearg2, lastyearg2)\n   If grade2 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"F\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade2 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"F\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade2 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"F\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade3 = Comparegrade(thisyearg3, lastyearg3)\n   If grade3 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"G\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade3 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"G\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade3 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"G\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade4 = Comparegrade(thisyearg4, lastyearg4)\n   If grade4 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"H\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade4 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"H\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade4 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"H\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade5 = Comparegrade(thisyearg5, lastyearg5)\n   If grade5 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"I\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade5 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"I\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade5 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"I\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade6 = Comparegrade(thisyearg6, lastyearg6)\n   If grade6 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"J\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade6 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"J\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade6 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"J\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade7 = Comparegrade(thisyearg7, lastyearg7)\n   If grade7 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"K\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade7 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"K\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade7 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"K\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade8 = Comparegrade(thisyearg8, lastyearg8)\n   If grade8 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"L\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade8 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"L\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade8 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"L\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade9 = Comparegrade(thisyearg9, lastyearg9)\n   If grade9 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"M\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade9 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"M\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade9 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"M\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade10 = Comparegrade(thisyearg10, lastyearg10)\n   If grade10 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"N\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade10 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"N\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade10 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"N\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade11 = Comparegrade(thisyearg11, lastyearg11)\n   If grade11 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"O\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade11 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"O\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade11 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"O\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\n   grade12 = Comparegrade(thisyearg12, lastyearg12)\n   If grade12 = 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"P\" &amp; i).Interior.Color = RGB(217, 217, 217)\n   ElseIf grade12 &lt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"P\" &amp; i).Interior.Color = RGB(230, 184, 183)\n   ElseIf grade12 &gt; 0 Then\n   ThisWorkbook.Sheets(\"Result\").Range(\"P\" &amp; i).Interior.Color = RGB(216, 228, 188)\n   End If\n\nNext\n\n\nEnd Sub\n\nFunction Comparegrade(grade1, grade2)\n\nIf UCase(grade1) = \"A\" Then\ngrade1 = 4\nElseIf UCase(grade1) = \"B\" Then\ngrade1 = 3\nElseIf UCase(grade1) = \"C\" Then\ngrade1 = 2\nElseIf UCase(grade1) = \"D\" Then\ngrade1 = 1\nEnd If\n\nIf UCase(grade2) = \"A\" Then\ngrade2 = 4\nElseIf UCase(grade2) = \"B\" Then\ngrade2 = 3\nElseIf UCase(grade2) = \"C\" Then\ngrade2 = 2\nElseIf UCase(grade2) = \"D\" Then\ngrade2 = 1\nEnd If\n\nComparegrade = grade1 - grade2\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1451467493, "post_id": 34525424, "comment_id": 56794380, "body": "Rory thanks, maybe you can answer this <a href=\"http://stackoverflow.com/questions/34518872/excel-2013-format-comment-tab-size-press-reset-button-with-vba?noredirect=1#comment56779121_34518872\" title=\"excel 2013 format comment tab size press reset button with vba\">stackoverflow.com/questions/34518872/&hellip;</a> ?  or this <a href=\"http://stackoverflow.com/questions/34519945/excel-2013-vba-get-picture-in-comment-height\" title=\"excel 2013 vba get picture in comment height\">stackoverflow.com/questions/34519945/&hellip;</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1451468164, "post_id": 34525424, "comment_id": 56794750, "body": "Per Help: &quot;You can specify msoTrue for this argument only if the specified shape is a picture or an OLE object.&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1451468306, "post_id": 34525424, "comment_id": 56794842, "body": "But you aren&#39;t scaling the picture, you&#39;re scaling the comment. The picture is merely a background fill and not accessible as a separate object."}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1451468466, "post_id": 34525424, "comment_id": 56794925, "body": "So not possible to get embed picture default sizes? How this size restoring when by reset button?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1451468518, "post_id": 34525424, "comment_id": 56794960, "body": "Not everything in Excel is exposed to VBA unfortunately."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1451462786, "creation_date": 1451462786, "answer_id": 34525424, "question_id": 34524805, "link": "https://stackoverflow.com/questions/34524805/resize-commentbox-picture-size-in-vba-excel-2013/34525424#34525424", "title": "Resize commentbox picture size in VBa excel 2013", "body": "<p>You can use the <code>Comment</code> directly:</p>\n\n<pre><code>With Range(\"C1\")\n    .AddComment Text:=\"Blabla\"\n    With .Comment.Shape\n        .ScaleHeight 2.3, msoFalse, msoScaleFromTopLeft\n        .ScaleWidth 23.1, msoFalse, msoScaleFromTopLeft\n    End With\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 5729831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9bed1710a50a949ee3270dafa2203f?s=128&d=identicon&r=PG&f=1", "display_name": "Paidjo", "link": "https://stackoverflow.com/users/5729831/paidjo"}, "is_accepted": false, "score": 1, "last_activity_date": 1451463931, "creation_date": 1451463931, "answer_id": 34525661, "question_id": 34524805, "link": "https://stackoverflow.com/questions/34524805/resize-commentbox-picture-size-in-vba-excel-2013/34525661#34525661", "title": "Resize commentbox picture size in VBa excel 2013", "body": "<p>Same with Rory.\nI add clearcomments first before add comment to avoid an error if a comment already exist.</p>\n\n<pre><code>Sub AddCommentAndResize()\n\nWith Range(\"C1\")\n    .ClearComments\n    .AddComment Text:=\"Blabla\"\n    With .Comment.Shape\n        .ScaleHeight 2.3, msoFalse, msoScaleFromTopLeft\n        .ScaleWidth 23.1, msoFalse, msoScaleFromTopLeft\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 34525424, "answer_count": 2, "score": 1, "last_activity_date": 1451463931, "creation_date": 1451459999, "last_edit_date": 1531161705, "question_id": 34524805, "link": "https://stackoverflow.com/questions/34524805/resize-commentbox-picture-size-in-vba-excel-2013", "title": "Resize commentbox picture size in VBa excel 2013", "body": "<p>When I record a macro I get </p>\n\n<pre><code>Range(\"C1\").Select \nRange(\"C1\").AddComment \nRange(\"C1\").Comment.Text Text:=\"Blabla\" \nSelection.ShapeRange.ScaleHeight 2.3, msoFalse, msoScaleFromTopLeft\nSelection.ShapeRange.ScaleWidth 23.1, msoFalse, msoScaleFromTopLeft\n</code></pre>\n\n<p>Running this code results in : </p>\n\n<blockquote>\n  <p>Runtime error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Anyone any idea?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451455090, "post_id": 34523312, "comment_id": 56789063, "body": "Why is <code>Cancel</code> an integer when you end up setting it to true (1)? What&#39;s <code>Cancel</code> doing?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "edited": false, "score": 0, "creation_date": 1451539776, "post_id": 34524639, "comment_id": 56824965, "body": "Thanks for the info, that fixed the problem. 1 - I actually had a bit of error handling that I just deleted out of the bottom of the sub, which is why I had the err.number. I just didn&#39;t think it was applicable for this part. I should have gotten rid of that first if though since I got rid of the bottom stuff. The exit subs were in there for the same reason. 2 - I&#39;ve always done MSG as string, funny that I&#39;ve been doing it wrong for so long... 3 - I definitely typed it from memory: won&#39;t be doing that again... Anyhow, thanks for the very concise and detailed answer! Got my upvote :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "edited": false, "score": 0, "creation_date": 1451540913, "post_id": 34524639, "comment_id": 56825305, "body": "@JaredBurton Thanks for the checkmark! If you have working VBA code that you&#39;d like peer reviewed, I&#39;d love to see some of it on <a href=\"https://codereview.stackexchange.com\">Code Review</a> =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1451459536, "last_edit_date": 1451459536, "creation_date": 1451459215, "answer_id": 34524639, "question_id": 34523312, "link": "https://stackoverflow.com/questions/34523312/excel-vba-userform-queryclose-cancel-not-working/34524639#34524639", "title": "Excel VBA Userform QueryClose: Cancel not working", "body": "<p>Couple of things:</p>\n\n<ul>\n<li><p>You're not shutting off error handling, so the <code>Err.Number = 0</code> check has no effect; if there's a runtime error, execution jumps straight out of the procedure anyway.</p></li>\n<li><p><code>MSG</code> should be a <code>vbMsgBoxResult</code>, not a <code>String</code>. Your code only works because of implicit type conversions from the underlying <code>Integer</code> value to the <code>String</code> type you're forcing it into.</p></li>\n<li><p>Unless you didn't post your entire code, <code>Exit Sub</code> is redundant in both branches.</p></li>\n<li><p>The problem can be reproduced with simpler code:</p>\n\n<pre><code>Private Sub Userform_queryclose(CloseMode As Integer, Cancel As Integer)\n    Cancel = True\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>The problem is that you made up that signature or somehow typed it up from memory. This is the signature for the <code>QueryClose</code> handler:</p>\n\n<blockquote>\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n</code></pre>\n</blockquote>\n\n<p><strong>Notice the ordering of parameters</strong>.</p>\n\n<p>You'll get the expected behavior by setting your <code>CloseMode</code> to <code>True</code> instead of <code>Cancel</code>... but a better fix would be to put the parameters in the correct order.</p>\n\n<p>Event handlers don't really care about parameter names: it's about types and order. Since both parameters are <code>Integer</code>, it's down to ordering: the first <code>Integer</code> parameter is interpreted as the <code>Cancel</code> parameter, and the second is the <code>CloseMode</code> - the form / COM doesn't care how you called them, it's going to read the <code>Cancel</code> value from the first parameter anyway.</p>\n\n<p>You can avoid this problem in the future, by selecting the event from the dropdowns at the top of the code pane:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3F2rS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3F2rS.png\" alt=\"first select the UserForm interface/event provider from the left dropdown\"></a></p>\n\n<p>Make sure the left-hand dropdown says \"UserForm\", and then select \"QueryClose\" from the right-hand dropdown:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s9gDH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s9gDH.png\" alt=\"then select QueryClose event in the right dropdown\"></a></p>\n\n<p>If there's no handler for it, the VBE will create one <em>properly formed</em> for you.</p>\n"}], "owner": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3600, "favorite_count": 0, "accepted_answer_id": 34524639, "answer_count": 1, "score": 1, "last_activity_date": 1451459536, "creation_date": 1451452495, "question_id": 34523312, "link": "https://stackoverflow.com/questions/34523312/excel-vba-userform-queryclose-cancel-not-working", "title": "Excel VBA Userform QueryClose: Cancel not working", "body": "<p>I've written the code below so that it will check if a process has been completed or not before closing the form. This userform is used as a scoresheet that will make <code>range(\"A6\")</code> green to signify a pass, or <code>range(\"B6\")</code> red to signify a fail as the final step of the sub, before unloading the form. </p>\n\n<p>From what I've checked online so far, it should be working. While debugging, the macro gets all the way to where it says Cancel = True, reads over the line, but the form closes anyway.</p>\n\n<p>Why isn't the cancel registering even when it reads over the line?</p>\n\n<pre><code>Private Sub Userform_queryclose(CloseMode As Integer, Cancel As Integer)\nDim wbScoreCard As Workbook\nDim wsScoreCard As Worksheet\nDim MSG As String\nSet wbScoreCard = Workbooks(NameBox.Value)\nSet wsScoreCard = wbScoreCard.Worksheets(Format(Date, \"MM.dd.yy\") &amp; \" \" &amp; CallType.Caption)\nIf Err.Number = 0 Then\n    If wsScoreCard.Range(\"A6\").Interior.Color &lt;&gt; vbGreen Then\n        If wsScoreCard.Range(\"B6\").Interior.Color &lt;&gt; vbRed Then\n            Beep\n            MSG = MsgBox(\"This scorecard is not complete! If you close it now, this scorecard will not be saved. Continue?\", vbYesNo, \"Warning - Scorecard Incomplete\")\n            If MSG = vbYes Then\n                wbScoreCard.Close savechanges:=False\n                Exit Sub\n            Else\n                Cancel = True\n                Exit Sub\n            End If\n        End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451445324, "post_id": 34522342, "comment_id": 56786375, "body": "I&#39;m a little concerned with your use of the <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow noreferrer\">IFERROR function</a>. Please see above for possible alternative."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451508501, "post_id": 34522342, "comment_id": 56815923, "body": "ya its not working, wondering what you think, and thanks again for your help. Before i added your - &amp; &quot; &quot; - if it didnt find a match it worked, but gave a zero value, if it found the cbocolor in my range it gave the vlookup answer. Now when i added your edit, if it finds an asnwer to the vlookup it does not give a zero value (GREAT) but if it does not find something in the range to vlookup then i get an error. So it is as if the two methods (mine vs yours) are the exact opposite"}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451508881, "post_id": 34522342, "comment_id": 56816097, "body": "also, not sure if i am allowed to say this on this site...i dont really know how it works, but can i hire people on this site (like yourself) to assist me in larger problems?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451509531, "post_id": 34522342, "comment_id": 56816444, "body": "\u2460 What is the address (i.e. <b>RefersTo</b>) of the <code>Worksheets(&quot;CONTACTS&quot;).Range(&quot;allcontacts&quot;)</code> range? I need to fully reproduce the situation so I can test all three possibles (match, match but return blank, no match). \u2461 There is a new beta program at <a href=\"http://stackoverflow.com/jobs\">stackoverflow.com/jobs</a> but I have yet to submit a Cv for it (will soon), You can try there for very competent help or reach me at the address displayed on my <a href=\"http://answers.microsoft.com/en-us/profile/a05bdd23-6c19-4f50-9b4a-3c6ae7d72590\" rel=\"nofollow noreferrer\">Microsoft Answers Community</a> profile page."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451787785, "post_id": 34522342, "comment_id": 56890412, "body": "so sorry i took a while (holidays) next comment has the code"}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451787912, "post_id": 34522342, "comment_id": 56890434, "body": "If cbocolor.Value &lt;&gt; &quot;&quot; Then TextBox1.Value = WorksheetFunction.IfError(Application.VLookup(cbocolor.Value&zwnj;&#8203;, Worksheets(&quot;CONTACTS&quot;).Range(&quot;allcontacts&quot;), 2, False), &quot;&quot;)"}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451788086, "post_id": 34522342, "comment_id": 56890473, "body": "so a person enters their name in cbocolor, then the click into textbox1, where they would enter their phone number, but i have the system do a vlookup to see if the phone number exsists already. if it does it should pop up, if the name entered in cbocolor does not exist (new contact) then when they click into textbox1 i just want it blank, whereas as  i explained, my code enters a zero if the person exists BUT has no telephone number yet. Is that as clear as i hope it sounds :) thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1451445288, "last_edit_date": 1451445288, "creation_date": 1451444518, "answer_id": 34522342, "question_id": 34522322, "link": "https://stackoverflow.com/questions/34522322/zero-value-where-there-shouldnt-be/34522342#34522342", "title": "zero value where there shouldn&#39;t be", "body": "<p>The <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow\">VLOOKUP function</a> is attemptng to return an empty cell which results in a <strong>0</strong> (i.e. <em>zero</em>) being displayed. Append a zero-length string (e.g. <code>\"\"</code>) to avoid this.</p>\n\n<pre><code>TextBox1.value = WorksheetFunction.IfError(Application.VLookup(cbocolor.value, _\n   Worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False)&amp;\"\", \"Enter New Info\")\n</code></pre>\n\n<p>I don't believe you can use <code>WorksheetFunction.IfError</code> in that fashion. If you run into trouble consider,</p>\n\n<pre><code>if IsError(application.Match(cbocolor.value, Worksheets(\"CONTACTS\").Range(\"allcontacts\").Columns(1), 0)) Then\n    TextBox1.value = \"Enter New Info\"\nelse\n    TextBox1.value = Application.VLookup(cbocolor.value, Worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False) &amp; \"\"\nend if\n</code></pre>\n\n<p>Error handling is different within VBA and the <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow\">IFERROR function</a> does not catch an error thrown from a worksheet no-match the way that a worksheet formula does.</p>\n"}], "owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 34522342, "answer_count": 1, "score": 2, "last_activity_date": 1451445288, "creation_date": 1451444338, "question_id": 34522322, "link": "https://stackoverflow.com/questions/34522322/zero-value-where-there-shouldnt-be", "title": "zero value where there shouldn&#39;t be", "body": "<p>i am racking my brain to figure out the simplest thing. With the code below, i am getting zero values.\nWhen a user fills in something in a combobox called \"cbocolor\" and then switches to the next textbox my system does a vlookup.\nIf the entry in \"cbocolor\" exists on my contact page, but column 2 has nothing, i want it to just come back with nothing (\"\") as my answer....but it always comes back zero.\nPlease, andy help would be appreciated</p>\n\n<pre><code>Private Sub TextBox1_Enter()\nIf cbocolor.value &lt;&gt; \"\" Then\n\n    TextBox1.value = WorksheetFunction.IfError(Application.VLookup(cbocolor.value, _\n       Worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False), \"Enter New Info\")\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "edited": false, "score": 0, "creation_date": 1451528324, "post_id": 34525618, "comment_id": 56822428, "body": "Thanks for the comment. Is there no workaround for this one? Or it this how things really work (sorry VBA newbie here). I&#39;m just afraid that if an incoming email comes in at the exact time, will the macro be able to extract both emails at the same time, or will it be one after the other? Or worse, the other email will not be extracted? For the second question, I managed to create an outlook rule wherein once a message comes in, it will run the script. Thanks for the suggestion-however which do you think would be better? To create the ItemAdd event or just create the rule?"}], "tags": [], "owner": {"reputation": 53, "user_id": 2754037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ccb45e41413bdff6e3626229fce7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/2754037/rob"}, "is_accepted": false, "score": 0, "last_activity_date": 1451463785, "creation_date": 1451463785, "answer_id": 34525618, "question_id": 34522132, "link": "https://stackoverflow.com/questions/34522132/update-current-file/34525618#34525618", "title": "Update current file", "body": "<p>Do you close the SR Historyv2 workbook after you run the script or do you want to keep it open the entire time? If you keep it open and run the script again it will open the workbook a second time and that will be read only. For the second question i would suggest you look into the ItemAdd event in Outlook. This will only work if Outlook is open. <a href=\"https://msdn.microsoft.com/en-us/library/office/aa171270(v=office.11).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/aa171270(v=office.11).aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "edited": false, "score": 0, "creation_date": 1451985262, "post_id": 34542069, "comment_id": 56960915, "body": "thanks for this one. I saw this code online and got bits and pieces of some of the code. However, I did not use this to run the script via rule. Appreciate the assistance.."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "edited": false, "score": 0, "creation_date": 1451989769, "post_id": 34542069, "comment_id": 56963952, "body": "@Wilson update xlPath workbook to yours- look at the comment in the code"}, {"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "edited": false, "score": 0, "creation_date": 1452048213, "post_id": 34542069, "comment_id": 56995340, "body": "i tried copying your code and tried running it and works like a charm! Thanks for this one. However, the Excel filename was closed BUT the Excel application was left open. The reason why I want the Excel filename to be left open is another incoming email will reference to this filename and see if it existing or not. If it is existing then it will show something -value, string etc. Is this possible or I really need to close the Excel file and have it opened again for the matching of the other incoming email? Thanks again for the assistance."}, {"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "edited": false, "score": 0, "creation_date": 1452223890, "post_id": 34542069, "comment_id": 57083770, "body": "noted this one and appreciate the assistance. Thank you"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1451549791, "last_edit_date": 1451549791, "creation_date": 1451542903, "answer_id": 34542069, "question_id": 34522132, "link": "https://stackoverflow.com/questions/34522132/update-current-file/34542069#34542069", "title": "Update current file", "body": "<p>Try the following and if you would like to run Outlook Rule, let me know I will update the answer</p>\n\n<pre><code>Option Explicit\nSub Excel()\n    Dim xlApp As Object 'Excel App\n    Dim xlWB As Object 'WorkBook\n    Dim xlSheet As Object\n    Dim rngCount As Long\n    Dim xlStarted As Boolean\n    Dim xlPath As String\n    Dim olExplorer As Explorer\n    Dim olSelection As Selection\n    Dim olItem As Outlook.MailItem\n    Dim olMsg As Object\n    Dim xlColA, xlColB, xlColC, xlColD As String\n\n    '// Path of the Workbook - update only -&gt; \"\\Folder Name\\Folder Name\\Book1.xlsx\"\n    xlPath = Environ(\"USERPROFILE\") &amp; _\n        \"\\Documents\\Temp\\Book1.xlsx\"\n\n    '// Set up Excel Application\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n\n    If Err &lt;&gt; 0 Then\n        Application.StatusBar = \"Please wait while Excel source is opened ... \"\n            Set xlApp = CreateObject(\"Excel.Application\")\n        xlStarted = True\n    End If\n\n    On Error GoTo 0\n    '// Open the workbook to input the data\n    Set xlWB = xlApp.Workbooks.Open(xlPath)\n    Set xlSheet = xlWB.Sheets(\"Sheet1\") ' or use (1) or (Sheet Name)\n\n    '// Record msg        \n    On Error Resume Next\n    '// Find the next empty line of the worksheet\n    rngCount = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(-4162).Row\n\n\n    '// Get the values from Outlook\n    Set olExplorer = Application.ActiveExplorer\n\n    '// Select Outlook msg\n    Set olSelection = olExplorer.Selection\n    For Each olMsg In olSelection\n        Set olItem = olMsg\n        '// Info to collect\n        xlColA = olItem.ReceivedTime\n        xlColB = olItem.SenderName\n        xlColC = olItem.SenderEmailAddress\n        xlColD = olItem.To\n\n        '// Write it to Excel sheet\n        xlSheet.Range(\"A\" &amp; rngCount) = xlColA\n        xlSheet.Range(\"B\" &amp; rngCount) = xlColB\n        xlSheet.Range(\"C\" &amp; rngCount) = xlColC\n        xlSheet.Range(\"D\" &amp; rngCount) = xlColD\n\n        '// Go to Next row\n        rngCount = rngCount + 1\n    Next\n\n    '// Save &amp; Close Excel.Application\n    xlWB.Close 1\n    If xlStarted Then\n        xlApp.Quit\n    End If\n\n    '// Clean up\n    Set olItem = Nothing\n    Set olMsg = Nothing\n    Set olExplorer = Nothing\n    Set xlApp = Nothing\n    Set xlWB = Nothing\n    Set xlSheet = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1452223846, "creation_date": 1452223846, "answer_id": 34669028, "question_id": 34522132, "link": "https://stackoverflow.com/questions/34522132/update-current-file/34669028#34669028", "title": "Update current file", "body": "<p>I got this code working properly</p>\n\n<pre><code>Set myXLApp = GetObject(, \"Excel.Application\")\n'specify the History File\nWith myXLApp\n.Workbooks(\"SR Historyv2.xlsx\").Activate\nEnd With\n</code></pre>\n\n<p>It keeps the file to open and lets the other macro access it without being read-only.</p>\n"}], "owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 34542069, "answer_count": 3, "score": 0, "last_activity_date": 1593517754, "creation_date": 1451442480, "last_edit_date": 1593517754, "question_id": 34522132, "link": "https://stackoverflow.com/questions/34522132/update-current-file", "title": "Update current file", "body": "<p>I'm creating code wherein Outlook will extract all emails to an existing Excel file.</p>\n\n<p>The code works and extracts all emails from a selected folder. However, when I try to use the same code on a separate folder, let's say Sent Items, it doesn't extract the data and opens a Read only version of the Excel file. </p>\n\n<p>I plan to leave Outlook and Excel Open.</p>\n\n<p>How can I work with any Outlook folder and still update the Excel file?</p>\n\n<pre><code>Private Sub Application_NewMailv7()\n\nDim objNS As NameSpace\nDim objFolder As MAPIFolder\nDim currentExplorer As Explorer\nDim Selection As Selection\nDim obj As Object\n\nDim objOL As Outlook.Application\nDim objItems As Outlook.Items\n\nDim myItem As MailItem\n\nDim myXLApp As Excel.Application\nDim myXLWB As Excel.Workbook\nDim StrBody As String\nDim TotalRows As Long, i As Long\n\nSet objOL = Outlook.Application\nSet objFolder = objOL.ActiveExplorer.CurrentFolder\nSet objItems = objFolder.Items\n\nSet myXLApp = New Excel.Application\nmyXLApp.Visible = True\nSet myXLWB = myXLApp.Workbooks.Open(\"C:\\Users\\username\\Desktop\\Folder Name\\SR Historyv2.xlsx\")\n\nSet excWks = myXLWB.Worksheets(\"Sheet1\")\n\nTotalRows = Sheets(1).Range(\"A65536\").End(xlUp).Row\ni = TotalRows + 1\n\nFor Each obj In objItems\n\n    If obj.Class = olMail Then\n        'Add a row for each field in the message you want to export\n        excWks.Cells(i, 1) = Format(obj.ReceivedTime, \"mm/dd/yyyy\")\n        excWks.Cells(i, 2) = obj.SenderEmailAddress\n        excWks.Cells(i, 3) = obj.Subject\n\n        i = i + 1\n\n        'myXLWB.Save\n\n    End If   \nNext\n\nSet obj = Nothing\nSet objItems = Nothing\nSet objFolder = Nothing\nSet objOL = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "drop-down-menu"], "comments": [{"owner": {"reputation": 448, "user_id": 4040096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2183110b97c8cf6bca6140493a4a79a?s=128&d=identicon&r=PG&f=1", "display_name": "Registered User", "link": "https://stackoverflow.com/users/4040096/registered-user"}, "edited": false, "score": 0, "creation_date": 1451441574, "post_id": 34521982, "comment_id": 56785523, "body": "Indent your code correctly. Edit your post and select all code segments and do <code>ctrl-k</code>. or <code>cmd-k</code> for mac."}, {"owner": {"reputation": 11, "user_id": 5729020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b99bfa5da150b125eb42136beeaf04e?s=128&d=identicon&r=PG&f=1", "display_name": "Wade Skywalker", "link": "https://stackoverflow.com/users/5729020/wade-skywalker"}, "reply_to_user": {"reputation": 448, "user_id": 4040096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2183110b97c8cf6bca6140493a4a79a?s=128&d=identicon&r=PG&f=1", "display_name": "Registered User", "link": "https://stackoverflow.com/users/4040096/registered-user"}, "edited": false, "score": 0, "creation_date": 1451442724, "post_id": 34521982, "comment_id": 56785834, "body": "does it look better?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5729020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b99bfa5da150b125eb42136beeaf04e?s=128&d=identicon&r=PG&f=1", "display_name": "Wade Skywalker", "link": "https://stackoverflow.com/users/5729020/wade-skywalker"}, "edited": false, "score": 0, "creation_date": 1451962132, "post_id": 34551561, "comment_id": 56952535, "body": "it worked perfectly. Thank you so much. would you mind explaining to me what does .Validation.Formula1 do? is that a buildin function or a variable? if a variable, what does it refer to? if a function, what does it call?"}, {"owner": {"reputation": 11, "user_id": 5729020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b99bfa5da150b125eb42136beeaf04e?s=128&d=identicon&r=PG&f=1", "display_name": "Wade Skywalker", "link": "https://stackoverflow.com/users/5729020/wade-skywalker"}, "edited": false, "score": 0, "creation_date": 1451962635, "post_id": 34551561, "comment_id": 56952646, "body": "actually, after a closer look at the result, the code doesn&#39;t really go through the list and pick up corresponding rows. Instead, it find a value in the list, and copy same rows for multiple times. could you please advice?"}, {"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "reply_to_user": {"reputation": 11, "user_id": 5729020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b99bfa5da150b125eb42136beeaf04e?s=128&d=identicon&r=PG&f=1", "display_name": "Wade Skywalker", "link": "https://stackoverflow.com/users/5729020/wade-skywalker"}, "edited": false, "score": 0, "creation_date": 1452090581, "post_id": 34551561, "comment_id": 57016059, "body": "What is the range that you are trying to copy?"}], "tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 0, "last_activity_date": 1451595739, "creation_date": 1451595739, "answer_id": 34551561, "question_id": 34521982, "link": "https://stackoverflow.com/questions/34521982/vba-iterate-drop-down-list/34551561#34551561", "title": "VBA iterate drop down list", "body": "<p>I did some experimenting with the code you posted, and it seems you were pretty close.  I discovered that the step where you were getting <code>inputRange</code> was including an equals sign (=), which then caused the Evaluate function to fail.</p>\n\n<p>Here is the code I used:</p>\n\n<pre><code> Sub iterate_dropdown()\n\n    Dim inputRange As Range\n    Dim c As Range\n    Dim Current As Range\n    Dim strRange As String\n    Dim strRange2 As String\n    strRange = Worksheets(\"Credit Research Journal\").Range(\"J1\").Validation.Formula1\n    strRange2 = Replace(strRange, \"=\", \"\")  'Get rid of the equals sign\n    Set inputRange = Evaluate(strRange2)\n    For Each c In inputRange\n        Workbooks(\"sample.xlsm\").Worksheets(\"Credit Research Journal\").Range(\"J1\").Value = c.Value\n        Workbooks(\"sample.xlsm\").Sheets(\"Credit Research Journal\").Activate\n        Workbooks(\"sample.xlsm\").RefreshAll\n        FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n        Cells(8, 1).Resize(FinalRow - 7, 10).Copy\n        Workbooks(\"Book2.xlsm\").Sheets(\"Sheet3\").Activate\n        NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Set Current = Cells(NextRow, 1)\n        Current.PasteSpecial xlPasteValues\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>I used two string variables <code>strRange</code> and <code>strRange2</code> so that you can easily step through with the debugger and see what is happening.</p>\n\n<p>Also I am assuming that your dropdown list is being populated by values that are references to other cells.</p>\n"}], "owner": {"reputation": 11, "user_id": 5729020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b99bfa5da150b125eb42136beeaf04e?s=128&d=identicon&r=PG&f=1", "display_name": "Wade Skywalker", "link": "https://stackoverflow.com/users/5729020/wade-skywalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1609, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451595739, "creation_date": 1451441256, "last_edit_date": 1451459295, "question_id": 34521982, "link": "https://stackoverflow.com/questions/34521982/vba-iterate-drop-down-list", "title": "VBA iterate drop down list", "body": "<p>I have a spread sheet with J1 being a drop down list. Content in row 8-14 would change based on what you choose in J1. I need to iterate through all values in the drop down list and copy all the corresponding rows to a new workbook. the copy paste part is working, but I am having problem iterating through the drop down list. particularly, I need some help to define Formula1. I am using excel 2010. Here is my code. Thanks in advance</p>\n\n<pre><code>Sub iterate_dropdown()\n    Dim inputRange As Range\n    Dim c As Range\n    Dim Current As Range\n\n    Set inputRange = Evaluate(Workbooks(\"sample.xlsm\").Worksheets(\"Credit Research Journal\").Range(\"J1\").Validation.Formula1)\n    For Each c In inputRange\n        Workbooks(\"sample.xlsm\").Worksheets(\"Credit Research Journal\").Range(\"J1\").Value = c.Value\n        Workbooks(\"sample.xlsm\").Sheets(\"Credit Research Journal\").Activate\n        Workbooks(\"sample.xlsm\").RefreshAll\n        FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n        Cells(8, 1).Resize(FinalRow - 7, 10).Copy\n        Workbooks(\"Book2.xlsm\").Sheets(\"Sheet3\").Activate\n        NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Set Current = Cells(NextRow, 1)\n        Current.PasteSpecial xlPasteValues\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 1, "creation_date": 1451432819, "post_id": 34520902, "comment_id": 56783349, "body": "Which ever you use Access won&#39;t scale well with more than four or five users in my experience - you&#39;re better off using SQL server"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1451439525, "post_id": 34520902, "comment_id": 56785024, "body": "@JeremyThompson In my experience, MS Access can work with much more than 5 users, 15-20 even 50+ given read/write access. One should always <a href=\"https://support.office.com/en-us/article/Split-an-Access-database-3015ad18-a3a1-4e9c-a7f3-51b1d73498cc\" rel=\"nofollow noreferrer\">split Access applications</a> (frontend app and backend db) on a LAN network. To recommend an enterprise solution like MSSQL just for 5 users is not truly utilizing the power of Access. The Jet/ACE engine is designed to hold 255 <a href=\"http://stackoverflow.com/questions/1672077/setting-up-an-ms-access-db-for-multi-user-access\">concurrent users</a>."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1451440665, "post_id": 34520902, "comment_id": 56785277, "body": "Use Sql Express.. 255 concurrent Access DB users, yeah you can do it but the performance and reliability will suck. I&#39;ve got an very popular application with thousands of customers and if you don&#39;t want tech support calls don&#39;t exceed 5 or so users!"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 1, "creation_date": 1451441137, "post_id": 34520902, "comment_id": 56785380, "body": "just use connections directly from Excel, you can add your own sql with parameters from the sheet, all you need is a connection string to the database -- no need for VBA"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5641993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/51a8bbefc4c2a350a3e1cf41d91b54bc?s=128&d=identicon&r=PG&f=1", "display_name": "Sofistikat", "link": "https://stackoverflow.com/users/5641993/sofistikat"}, "edited": false, "score": 0, "creation_date": 1451434590, "post_id": 34520940, "comment_id": 56783835, "body": "Jeremy Thompson, I wish! But luckily, there are only about 6 users, so Access should be able to handle it.  Thanks for your input @Mitch VanDuyn. That&#39;s how I&#39;ve got it set up at the moment, but the question&#39;s been nagging me in the back of my head, and since this is the first time I&#39;ve developed something that combines both Excel &amp; Access, I figured it&#39;s probably better to be safe than sorry and ask people who might know!"}], "tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1451432931, "creation_date": 1451432931, "answer_id": 34520940, "question_id": 34520902, "link": "https://stackoverflow.com/questions/34520902/excel-as-frontend-to-access-best-way-to-run-queries/34520940#34520940", "title": "Excel as frontend to Access - best way to run queries", "body": "<p>I would say it does not matter too much.  However I found it easier in the long run to create the views (queries) in access.  It was just much easier to test and maintain.</p>\n"}], "owner": {"reputation": 101, "user_id": 5641993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/51a8bbefc4c2a350a3e1cf41d91b54bc?s=128&d=identicon&r=PG&f=1", "display_name": "Sofistikat", "link": "https://stackoverflow.com/users/5641993/sofistikat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451508392, "creation_date": 1451432712, "question_id": 34520902, "link": "https://stackoverflow.com/questions/34520902/excel-as-frontend-to-access-best-way-to-run-queries", "title": "Excel as frontend to Access - best way to run queries", "body": "<p>When using Excel as a front end and Access as a back end, is it better to import data from queries already created in Access, or to query tables directly from Excel using VBA for better performance and/or avoiding concurrency issues, for multi users?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451433533, "post_id": 34520592, "comment_id": 56783547, "body": "What is wrong with the formula?  What happens?  Also, if you are not looking for a VBA solution, I&#39;d remove the excel-vba tag.  If you are looking for a VBA solution, I&#39;d follow the advice of PKatona."}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 1, "user_id": 5728711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8736c5fcf5eb3b0c24dc7dbfbde4978a?s=128&d=identicon&r=PG&f=1", "display_name": "toto", "link": "https://stackoverflow.com/users/5728711/toto"}, "edited": false, "score": 0, "creation_date": 1451493467, "post_id": 34520972, "comment_id": 56808300, "body": "Well it sounds like you want someone to write you code for you, which is not the intent of this website. The expectation here is that you have written some code and need further guidance.  I tell you what, I&#39;ll start you out. I&#39;ll check throughout the day. You show me your progress and I will help you along further.  1. On the Person excel workbook, click the &quot;View&quot; tab and then click the icon to the far right &quot;Macros&quot;. 2. Type in &quot;ProcessBadges&quot; for the Macro name, and then click &quot;Create&quot;.  Let me know when you&#39;ve done that. I&#39;ll check back later."}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": 0, "last_activity_date": 1451433189, "creation_date": 1451433189, "answer_id": 34520972, "question_id": 34520592, "link": "https://stackoverflow.com/questions/34520592/merge-multiple-excel-to-single-worksheet-with-options/34520972#34520972", "title": "Merge multiple excel to single worksheet with options", "body": "<p>This will require a lot of research on your part. You'll need to:</p>\n\n<ol>\n<li>create a VBA Macro</li>\n<li>define variables and create a loop to look at your main sheet.</li>\n<li>create a sheet name based on the code.</li>\n<li>check if the sheet already exists, if not, create it.</li>\n<li>copy the values from the first sheet to the \"code\" sheet.</li>\n<li>once all values are processed, go through each sheet, loop through your values and calculate your periods.</li>\n</ol>\n\n<p>This is not a trivial amount of code. Do research on these 6 items and write the code. When you have that, display it and we can give you more direction.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5728711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8736c5fcf5eb3b0c24dc7dbfbde4978a?s=128&d=identicon&r=PG&f=1", "display_name": "toto", "link": "https://stackoverflow.com/users/5728711/toto"}, "edited": false, "score": 0, "creation_date": 1451462632, "post_id": 34521498, "comment_id": 56792009, "body": "It give me this error even I do a lot of modifications <code>we found a problem with this formula try clicking insert function </code>, maybe I enter something wrong, can you please try your example in real file please to be sure that works fine?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 5728711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8736c5fcf5eb3b0c24dc7dbfbde4978a?s=128&d=identicon&r=PG&f=1", "display_name": "toto", "link": "https://stackoverflow.com/users/5728711/toto"}, "edited": false, "score": 0, "creation_date": 1451485598, "post_id": 34521498, "comment_id": 56804047, "body": "I did put it in a real file, hence the picture.  It works for me.  I did not photo shop the picture nor did I just put the numbers in.  the picture above is of my real file."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1451437263, "creation_date": 1451437263, "answer_id": 34521498, "question_id": 34520592, "link": "https://stackoverflow.com/questions/34520592/merge-multiple-excel-to-single-worksheet-with-options/34521498#34521498", "title": "Merge multiple excel to single worksheet with options", "body": "<p>To populate the dates, in A2 put:</p>\n\n<pre><code>=IFERROR(INDEX(Sheet1!$B$2:$B$14,MATCH(SMALL(IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,Sheet1!$B$2:$B$14),ROW()-1),IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,Sheet1!$B$2:$B$14),0)),\"\")\n</code></pre>\n\n<p>To populate the period put this in B2:</p>\n\n<pre><code>=IFERROR(TEXT(INDEX(Sheet1!$D$2:$D$14,MATCH(SMALL(IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,IF(Sheet1!$B$2:$B$14=A2,Sheet1!$C$2:$C$14)),COUNTIF($A$1:$A2,A2)),IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,IF(Sheet1!$B$2:$B$14=A2,Sheet1!$C$2:$C$14)),0))-INDEX(Sheet1!$C$2:$C$14,MATCH(SMALL(IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,IF(Sheet1!$B$2:$B$14=A2,Sheet1!$C$2:$C$14)),COUNTIF($A$1:$A2,A2)),IF(--MID(MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),2,999) = Sheet1!$A$2:$A$14,IF(Sheet1!$B$2:$B$14=A2,Sheet1!$C$2:$C$14)),0)),\"[m]\"),\"\")\n</code></pre>\n\n<p>Both are array formulas and need to be confirmed with Ctrl-Shift-Enter.  Then Copy both down to desired rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8yFSO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8yFSO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5728711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8736c5fcf5eb3b0c24dc7dbfbde4978a?s=128&d=identicon&r=PG&f=1", "display_name": "toto", "link": "https://stackoverflow.com/users/5728711/toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451437263, "creation_date": 1451430932, "last_edit_date": 1451431439, "question_id": 34520592, "link": "https://stackoverflow.com/questions/34520592/merge-multiple-excel-to-single-worksheet-with-options", "title": "Merge multiple excel to single worksheet with options", "body": "<p>I have 2  sheets in one excel file, the first one is :</p>\n\n<p><strong>Sheet: Person</strong></p>\n\n<pre><code>Code    date        start   end\n2301    12/08/1993  08:02   08:17\n4221    12/08/1993  09:04   09:25\n2312    12/08/1993  10:02   10:28\n1284    19/09/1994  11:02   11:21\n2312    19/09/1994  15:57   16:20\n1284    23/06/1995  17:12   17:35\n2312    22/06/1996  13:14   13:32\n4221    22/06/1996  15:53   16:13\n4221    05/05/1999  08:06   08:22\n2418    05/05/1999  08:10   08:33\n2301    05/05/1999  09:12   09:37\n2301    05/05/1999  09:28   10:28\n2301    05/05/1999  13:28   13:38\n</code></pre>\n\n<p>Is a list of person of a company and anyone of them is identified by badge [row <code>Code</code>], what I hope is to Merge data by <code>code</code> to a costume sheet of a person, for example, for the person who have a number of badge 2301 he have his own sheet called B2301, so based on the first sheet \"Person\" I hope import data of a person like that grouped by <code>code</code> number of this person :</p>\n\n<p><strong>sheet B2301</strong></p>\n\n<pre><code> date       Period(min)\n 12/08/1987 12\n ....       ...\n</code></pre>\n\n<p>So Period will be calculated from <code>start</code> and <code>end</code> rows.</p>\n\n<p>I tried by using this formula but it's not working for me : </p>\n\n<p><code>=IFERROR(INDEX(Sheet1!A$2:A$14,SMALL(IF(Sheet1!$A$2:$A$14=INT(RIGHT(CELL(\"filename\",A1),LEN(CELL(\"filename\",A1))-FIND(\"]\",CELL(\"filename\",A1)))),ROW(Sheet1!A$2:A$14)-ROW(Sheet1!A$2)+1),ROWS(Sheet1!A$2:A2))),\"\")</code></p>\n\n<p>Any Idea?</p>\n"}, {"tags": ["sql", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 1311166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdec0cd19ba043af4462abe0d7a66bb1?s=128&d=identicon&r=PG", "display_name": "mphilipp17", "link": "https://stackoverflow.com/users/1311166/mphilipp17"}, "is_accepted": false, "score": 0, "last_activity_date": 1451430738, "creation_date": 1451430738, "answer_id": 34520560, "question_id": 34520318, "link": "https://stackoverflow.com/questions/34520318/passing-parameter-from-values-to-query/34520560#34520560", "title": "Passing Parameter from values to Query", "body": "<p>Here's a little console app and method to create your WHERE clause.  You don't need to worry about the EMP3 in the resulting where clause because any value is acceptable.  </p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var dict = new Dictionary&lt;string, string&gt;()\n        {\n            { \"EMP1\", \"Smith, John\" },\n            { \"EMP2\", \"Jones, Mark\" },\n            { \"EMP3\", \"\" }          //This could be null and it would still work\n\n        };\n\n        Console.WriteLine(CreateWhereClause(dict));\n        Console.ReadKey();\n    }\n\n    public static string CreateWhereClause(Dictionary&lt;string, string&gt; keyValues)\n    {\n        var result = \"WHERE \";\n\n        //Ignore blank values using lamda\n        foreach (var kvPair in keyValues.Where(kvp =&gt; !String.IsNullOrWhiteSpace(kvp.Value)))\n        {\n            //If we've already added a clause, add an AND\n            if (result.Length &gt; 6)\n                result += \" AND \";\n\n            result += String.Format(@\"tblIRS.[{0}] = '{1}'\", kvPair.Key, kvPair.Value);\n        }\n        return result;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4880625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0208edd52cd38c5411192f91f7d361d6?s=128&d=identicon&r=PG&f=1", "display_name": "atomedic", "link": "https://stackoverflow.com/users/4880625/atomedic"}, "edited": false, "score": 0, "creation_date": 1451441234, "post_id": 34520837, "comment_id": 56785409, "body": "Thank you OpiesDad, this seems to have gotten me on the right track. I do get a syntax error when I run the code. Specifically run time 3075. I have tried setting then to =TRUE, = &quot;TRUE&quot;, =&#39;&quot;&quot;&#39;. Any advise? I am using: DoCmd.OpenReport &quot;repSUPIR&quot;, acViewPreview, , strSQL to open the report. Thank you again."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451493141, "post_id": 34520837, "comment_id": 56808102, "body": "I&#39;d check the final SQL string and then try to run that outside of VBA to see if there are any errors.  That error is generally a SQL syntax error.  You definitely want = &quot;TRUE&quot;.....as I stated this will make the where clause &quot;WHERE x AND y AND z....&quot;   If you put in =TRUE, it might actually work (if VBA automatically converts the Boolean to a string), but it&#39;s not good practive.  If you put in =&quot;&quot; then your where clause will look something like, &quot;WHERE x AND AND z&quot; and this will definitely not work."}, {"owner": {"reputation": 25, "user_id": 4880625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0208edd52cd38c5411192f91f7d361d6?s=128&d=identicon&r=PG&f=1", "display_name": "atomedic", "link": "https://stackoverflow.com/users/4880625/atomedic"}, "edited": false, "score": 0, "creation_date": 1451509075, "post_id": 34520837, "comment_id": 56816200, "body": "I neglected to add: CurrentDb.QueryDefs(&quot;qryAUTO&quot;).SQL = strSQL. Works wonderfully now. Thanks again!"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1451510218, "last_edit_date": 1451510218, "creation_date": 1451432337, "answer_id": 34520837, "question_id": 34520318, "link": "https://stackoverflow.com/questions/34520318/passing-parameter-from-values-to-query/34520837#34520837", "title": "Passing Parameter from values to Query", "body": "<p>One easy way to accomplish this is to make a different variable for each portion of the where clause:</p>\n\n<pre><code>Dim strWhereEmp1 As String\nDim strWhereEmp2 As String\nDim strWhereEmp3 As String\nDim strFilter As String\n\nIf IsNull(Me.EMP1) Then /*Or use If Nz(Me.Emp1, \"\") = \"\" if you wish*/\n     strWhereEmp1 = \"TRUE\"\nElse\n     strWhereEmp1 = \"tblIRS.[EMP1] = '\" &amp; Me.Emp1 &amp; \"'\"\nEnd If\nIf IsNull(Me.EMP2) Then\n     strWhereEmp2 = \"TRUE\"\nElse\n     strWhereEmp2 = \"tblIRS.[EMP2] = '\" &amp; Me.Emp2 &amp; \"'\"\nEnd If\nIf IsNull(Me.EMP3) Then \n     strWhereEmp3 = \"TRUE\"\nElse\n     strWhereEmp3 = \"tblIRS.[EMP3] = '\" &amp; Me.Emp3 &amp; \"'\"\nEnd If\nstrFilter = strWhereEmp1 \" AND \" &amp; strWhereEmp2 &amp; _\n                         \" AND \" &amp; strWhereEMp3 \n\nstrSQL = \"SELECT * FROM tblIRS \" &amp; _\n         \"WHERE \" &amp; strFilter\n</code></pre>\n\n<p>You can do this for any number of filters.  It will just tack on \" AND TRUE\" to the where clause if the value from the form is null.</p>\n\n<p>I removed your condition to only create the SQL if Me.Emp1 is not empty, but it can be put back as desired.</p>\n"}], "owner": {"reputation": 25, "user_id": 4880625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0208edd52cd38c5411192f91f7d361d6?s=128&d=identicon&r=PG&f=1", "display_name": "atomedic", "link": "https://stackoverflow.com/users/4880625/atomedic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 34520837, "answer_count": 2, "score": 2, "last_activity_date": 1451510218, "creation_date": 1451429295, "question_id": 34520318, "link": "https://stackoverflow.com/questions/34520318/passing-parameter-from-values-to-query", "title": "Passing Parameter from values to Query", "body": "<p>I have built a unbound form with multiple Combo Boxes with the intention of passing the parameters received to an SQL query. My SQL works when all fields contain a value, but when one is null the entire query fails. I have set my where clause for each field to its respective<code>(tblIRS.[Field]=Forms!frmSUPIR![Field] OR Forms!frmSUPIR![Field] IS NULL OR tblIRS.[Field] IS NULL) AND (...</code> </p>\n\n<p>I have also tried to pass the values from the unbound from through variables and then construct the SQL in VBA as well to no avail. Each field has its on line similar to below:    </p>\n\n<pre><code>Dim strFilter As String\nDim strSQL As String \n    If Nz(Me.EMP1, \"\") &lt;&gt; \"\" Then\n    strFilter = strFilter &amp; \"tblIRS.[EMP1] = '\" &amp; PQ(Me.txtEMP1) &amp; \"' And \" ... \n    strSQL = \"SELECT * FROM tblIRS \" &amp; _\n             \"WHERE\" &amp; strFilter\n End If\n</code></pre>\n\n<p>The above includes a function to replace PQ.</p>\n\n<p>I have found numerous resources handling the above but none that include how to handle null table values and/or form entries.</p>\n\n<p>My goal is to have the user narrow their search by using as few combo boxes as possible. The form will ideally accept null values in the combo box to be treated as null and not show all records with a null table value for that field.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>Forms!frmSUPIR![EMP1] = [Smith, John] </li>\n<li>Forms!frmSUPIR![EMP2] = [Jones, Mark]</li>\n<li>Forms!frmSUPIR![EMP3] = Null</li>\n</ul>\n\n<p>I desire to have the query return all instances where EMP1 = Smith, John <strong>AND</strong> EMP2 = Jones, Mark <strong>AND</strong> <em>ANY</em> value for EMP3. What is the best way to go about this?</p>\n\n<p>Hope I was clear enough and thank you in advance,</p>\n\n<p>JS</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1451429650, "post_id": 34519886, "comment_id": 56782207, "body": "Hi and welcome. What is the problem with the code you found on the net? It doesn&#39;t look difficult to customize it to your case. Give it a shot, and when you find a specific problem, we will be happy to help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451434004, "post_id": 34519886, "comment_id": 56783674, "body": "<a href=\"https://support.office.com/en-us/article/SUMIFS-function-9DD6179E-CCED-41DD-AC38-08FDF5B929E5\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1451436206, "post_id": 34519886, "comment_id": 56784251, "body": "What&#39;s wrong with a pivot table?"}, {"owner": {"reputation": 1, "user_id": 2573761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e0ec04bddcb732c1794e73c10c791?s=128&d=identicon&r=PG", "display_name": "SQLGuy", "link": "https://stackoverflow.com/users/2573761/sqlguy"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1451500844, "post_id": 34519886, "comment_id": 56812091, "body": "@vacip pivot tables is an option but I don&#39;t need data to be manipulated in rows and columns.  Data representation is linear with rows."}, {"owner": {"reputation": 1, "user_id": 2573761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e0ec04bddcb732c1794e73c10c791?s=128&d=identicon&r=PG", "display_name": "SQLGuy", "link": "https://stackoverflow.com/users/2573761/sqlguy"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1451500855, "post_id": 34519886, "comment_id": 56812095, "body": "@A.S.H Thanks for the warm welcome, yes I am new to posting and VBA Macro.  I&#39;ll have a look in customizing the code.  I&#39;ll let you know if I run into any snags.  All the user should need to do is push a button and everything gets calculated.  Thanks again :)"}, {"owner": {"reputation": 1, "user_id": 2573761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e0ec04bddcb732c1794e73c10c791?s=128&d=identicon&r=PG", "display_name": "SQLGuy", "link": "https://stackoverflow.com/users/2573761/sqlguy"}, "edited": false, "score": 0, "creation_date": 1451501635, "post_id": 34519886, "comment_id": 56812492, "body": "@Jeeped SUMIFS looks good but I am still trying to wrap my mind around this iteration.  I could try and put this in the macro not sure how this can be done if the data is dynamic."}], "owner": {"reputation": 1, "user_id": 2573761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e0ec04bddcb732c1794e73c10c791?s=128&d=identicon&r=PG", "display_name": "SQLGuy", "link": "https://stackoverflow.com/users/2573761/sqlguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2339, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1451427067, "creation_date": 1451427067, "last_edit_date": 1495542683, "question_id": 34519886, "link": "https://stackoverflow.com/questions/34519886/excel-vba-subtotal-more-than-one-group-without-using-built-in-subtotal-functio", "title": "Excel VBA - Subtotal more than one group without using built in subtotal function", "body": "<p>I want to have a sub total for more than one group in Excel VBA <strong>without</strong> using the built in function. i.e : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838166.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838166.aspx</a>.  The collapsing levels are not required.  The user just needs to see the data with the sum of the Sub total and totals and due to this there should not be any formulas on the spreadsheet that use the \"=SUBTOTAL\" string function: <a href=\"https://stackoverflow.com/questions/22823470/subtotal-more-than-254-rows\">SUBTOTAL more than 254 rows</a></p>\n\n<p>There should be a sum grouping of Type 1 and Type 2.  There is no need for a grand total.  </p>\n\n<p><strong>Example:</strong></p>\n\n<p>The content of the data is to conceptualize the grouping.  The production data will have several other categories in Type 1 groups as stated in this example for the vertebrates and invertebrates. </p>\n\n<pre><code>Type 1      |   Type 2      | Type 3        | Count |No.Tagged  |\n____________|_______________|_______________|_______|___________|\nVertebrate  |   Primate     |   Gorilla     |   2   |   1       |       \nVertebrate  |   Primate     |   Monkey      |   5   |   2       |\nVertebrate  |   Primate     |   Ape         |   1   |   1       |           \nVertebrate  |   Reptile     |   Snake       |   1   |   1       |\nVertebrate  |   Reptile     |   Crocodile   |   2   |   1       |                           \nVertebrate  |   Rodents     |   squirrel    |   2   |   1       |\nVertebrate  |   Rodents     |   Mice        |   3   |   3       |\nInvertebrate|   Arachnids   |   Scorpion    |   2   |   1       |\nInvertebrate|   Arachnids   |   Spider      |   5   |   3       |\nInvertebrate|   Crustacean  |   Crabs       |   2   |   2       |               \nInvertebrate|   Crustacean  |   Shrimp      |   2   |   1       |\nInvertebrate|   Crustacean  |   Barnacle    |   3   |   2       |\nInvertebrate|   Mollusks    |   Octopus     |   3   |   2       |\nInvertebrate|   Mollusks    |   Ammonites   |   5   |   2       |\n</code></pre>\n\n<p>This data should look like this with the subtotals and total:</p>\n\n<pre><code>Type 1      |   Type 2      | Type 3        | Count |No. Tagged |\n_________________________________________________________________\nVertebrate  |   Primate     |   Gorilla     |   2   |   1       |\nVertebrate  |   Primate     |   Monkey      |   5   |   2       |\nVertebrate  |   Primate     |   Ape         |   1   |   1       |\n-----------------------------------------------------------------                           \n                        Sub Total Primate   |   8   |   4       |\n-----------------------------------------------------------------                           \nVertebrate  |   Reptile     |   Snake       |   1   |   1       |\nVertebrate  |   Reptile     |   Crocodile   |   2   |   1       |\n-----------------------------------------------------------------                           \n                        Sub Total Reptile   |   3   |   2       |\n-----------------------------------------------------------------                                                       \nVertebrate  |   Rodents     |   squirrel    |   2   |   1       |\nVertebrate  |   Rodents     |   Mice        |   3   |   3       |\n-----------------------------------------------------------------                                                       \n                        Sub Total Rodents   |   5   |   4       |\n                            Total Vertebrate|   16  |   10      |\n_________________________________________________________________                                                       \nInvertebrate|   Arachnids   |   Scorpion    |   2   |   1       |\nInvertebrate|   Arachnids   |   Spider      |   5   |   3       |\n-----------------------------------------------------------------                                                   \n                        Sub Total Arachnids |   7   |   4       |\n-----------------------------------------------------------------                           \nInvertebrate|   Crustacean  |   Crabs       |   2   |   2       |           \nInvertebrate|   Crustacean  |   Shrimp      |   2   |   1       |\nInvertebrate|   Crustacean  |   Barnacle    |   3   |   2       |\n-----------------------------------------------------------------                           \n                    Sub Total Crustacean    |   7   |   5       |\n-----------------------------------------------------------------                                                   \nInvertebrate|   Mollusks    |   Octopus     |   3   |   2       |\nInvertebrate|   Mollusks    |   Ammonites   |   5   |   2       |\n-----------------------------------------------------------------                                                   \n                        Sub Total Mollusks  |   8   |   4       |\n                        Total Invertebrate  |   22  |   13      |\n_________________________________________________________________   \n</code></pre>\n\n<p>I have tried to do this programmatically only in Excel VBA but I have not been successful with this code from the net:</p>\n\n<pre><code> Dim Rng As Range\n    Dim Rw As Long\n    Dim i As Long\n     'Sort Data\n    Rw = Cells(Rows.Count, 3).End(xlUp).Row\n    Set Rng = Range(Cells(1, 3), Cells(Rw, 3)).Resize(, 4)\n    ActiveSheet.Sort.SortFields.Clear\n    ActiveSheet.Sort.SortFields.Add Key:=Range(\"C1\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending\n    With ActiveSheet.Sort\n        .SetRange Rng\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n     'Insert spacing\n    For i = Rw To 3 Step -1\n        If Cells(i, 3) &lt;&gt; Cells(i - 1, 3) Then\n            Cells(i, 3).Resize(2).EntireRow.Insert\n        End If\n    Next\n     'Add Grand total\n    Rw = Cells(Rows.Count, 3).End(xlUp).Row\n    Cells(Rw + 3, 1) = \"Grand Total\"\n    Cells(Rw + 3, 7) = Application.Sum(Range(Cells(Rw, 7), Cells(2, 7)))\n     'Add Sub Totals\n    Do\n        Cells(Rw + 1, 1) = Cells(Rw, 3) &amp; \" Total\"\n        If Cells(Rw - 1, 7) = \"\" Then\n             'Single items\n            Cells(Rw + 1, 7) = Cells(Rw, 7)\n            Rw = Cells(Rw, 3).End(xlUp).Row\n        Else\n             'Multiple items\n            Cells(Rw + 1, 7) = Application.Sum(Range(Cells(Rw, 7), Cells(Rw, 7).End(xlUp)))\n            Rw = Cells(Rw, 3).End(xlUp).End(xlUp).Row\n        End If\n    Loop Until Rw = 1\n</code></pre>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451427490, "post_id": 34519858, "comment_id": 56781304, "body": "Hmm your if test above should work. Why leave it to user though? Open it via code."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451427741, "post_id": 34519858, "comment_id": 56781409, "body": "All of that does work if the file is actually open. I get the error when the file is not open and the user clicks yes. Then when the macro continues and tries to copy data to the file, that is when I get the error. I have also done research on how to check out and open a file from SharePoint, but I cannot get it to work for me. I am thinking this has to do with internal security, but have not verified that yet. So that is why I am going the MsgBox route."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1451427912, "post_id": 34519858, "comment_id": 56781505, "body": "Ah sharepoint. Run a loop like <code>for each bk in application.workbooks | if bk.name = Swivel - Master - December 2015.xlsm then flag=&quot;open&quot; else flag=&quot;not open&quot;</code> then later do a test on <code>flag</code> and do <code>exit sub</code> if flag=not open. Makes sense? Edit: <code>bk.name</code> might give whole path so check accordingly."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451428089, "post_id": 34519858, "comment_id": 56781590, "body": "Yes, that makes sense. Thanks findwindow. I will try this and let you know if it does all that I need it to."}], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451488262, "post_id": 34529834, "comment_id": 56805448, "body": "So I am clear in understanding (still fairly new to VBA and learning rapidly thanks to SO), I do not name the workbook in the function, just in the If statement? If that is true, then I can use that If statement in other similar subs where the workbook name is slightly different (like &#39;Swivel - Master - November 2015&#39;)? So here is a silly question, does a function need to be in it&#39;s own module?"}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1451490589, "post_id": 34529834, "comment_id": 56806697, "body": "Your first assumption is 100% correct, by using a parameter to that function you can use it universally. Second, well, the function needs to be in a module but not necessarily in it&#39;s own. If you put it into a module in your PERSONL.XLS you could use it from any workbook."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451492232, "post_id": 34529834, "comment_id": 56807607, "body": "Small glitch (I am sure it is user error (user=me)). I edited the original question above to show the IF statement I am using with the function you provided. I made no change to the function statement. But when I run the code, I get the following error if the workbook is not open and the user clicks Yes: Run-time error &#39;5&#39;:  Invalid procedure call or argument. And the debugger points to this line in the function: name = LCase(Left(wb.name, InStrRev(wb.name, &quot;.&quot;) - 1))  &#39; strip extension. What am I doing wrong?"}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451493246, "post_id": 34529834, "comment_id": 56808167, "body": "Sorry, my fault. If a workbook has never been saved it&#39;s name will not include an extension, hence no dot. I&#39;ve included an additional test in my post."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451494653, "post_id": 34529834, "comment_id": 56808951, "body": "Ok. Changed the function according to your edit. Now I am getting a <b>Run-time error &#39;9&#39;: Subscript out of range</b> for &#39;With Workbooks(&quot;Swivel - Master - November 2015.xlsm&quot;).Sheets(&quot;Swivel&quot;)&#39; Keep in mind that I am clicking Yes, but the workbook is NOT open. The desired result should be the MsgBox stating that this procedure will now terminate, the same as if the user clicks No. So, I believe your function and If statements are working fine, but mine seem to be the issue. I also think I have been looking at this too long. %}"}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451496359, "post_id": 34529834, "comment_id": 56809898, "body": "That&#39;s expected behavior if the WB is not open at that time, the subscript being &quot;Swivel - ...&quot;. I&#39;d write <code>ElseIf not IsWBOpen then exit sub</code> to catch a false positive user input."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1451498700, "post_id": 34529834, "comment_id": 56811142, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/99327/discussion-between-iron-man-and-user1016274\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": true, "score": 1, "last_activity_date": 1451493166, "last_edit_date": 1451493166, "creation_date": 1451479580, "answer_id": 34529834, "question_id": 34519858, "link": "https://stackoverflow.com/questions/34519858/checking-if-file-is-open-to-prevent-error/34529834#34529834", "title": "Checking if File is open to prevent error", "body": "<p>Use this function to check if the desired workbook is open:  </p>\n\n<pre><code>Function IsWBOpen(WorkbookName As String) As Boolean\n' check if WorkbookName is already opened; WorkbookName is without path or extension!\n' comparison is case insensitive\n' 2015-12-30\n\n    Dim wb As Variant\n    Dim name As String, searchfor As String\n    Dim pos as Integer\n\n    searchfor = LCase(WorkbookName)\n    For Each wb In Workbooks\n        pos = InStrRev(wb.name, \".\")\n        If pos = 0 Then                           ' new wb, no extension\n            name = LCase(wb.name)\n        Else\n            name = LCase(Left(wb.name, pos - 1))  ' strip extension\n        End If\n        If name = searchfor Then\n            IsWBOpen = True\n            Exit Function\n        End If\n    Next wb\n    IsWBOpen = False\nEnd Function\n</code></pre>\n\n<p>It looks through the list of (opened) workbooks and compares the name to it's argument. The extension is stripped off, there is no path prepended and the comparison is case-insensitive.<br>\nUsage:<br>\n<code>If IsWbOpen(\"Swivel - Master - December 2015\") then\n'... proceed\nElse\n    Exit Sub\nEnd If</code></p>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 34529834, "answer_count": 1, "score": 0, "last_activity_date": 1451493166, "creation_date": 1451426956, "last_edit_date": 1531164843, "question_id": 34519858, "link": "https://stackoverflow.com/questions/34519858/checking-if-file-is-open-to-prevent-error", "title": "Checking if File is open to prevent error", "body": "<p>I have looked and could not find an answer to this specifically. The below code prompts the user as to whether or not a specific file is open. If the user clicks no, the sub ends. If they click yes, the sub continues. I have tested this with the file open and all works great. But then I forgot to open the file and clicked yes when prompted and received the following error:</p>\n\n<p>Run-time error '9':</p>\n\n<p>Subscript out of range</p>\n\n<p>For this line in the code:</p>\n\n<p>With Workbooks(\"Swivel - Master - December 2015.xlsm\").Sheets(\"Swivel\")</p>\n\n<p>I understand why I am getting the error, but how do I check if the \"yes\" answer from the user is true to prevent this error?</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>Sub Extract_Sort_1512_December()\n'\n'\n    Dim ANS As String\n    ANS = MsgBox(\"Is the December 2015 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\n    If ANS = vbNo Then\n        MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n        Exit Sub\n    End If\n\nApplication.ScreenUpdating = False\n\n    ' This line renames the worksheet to \"Extract\"\n    ActiveSheet.Name = \"Extract\"\n\n    ' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Columns.AutoFit\n\n    ' This unhides any hidden rows\n    Cells.EntireRow.Hidden = False\n\nDim LR As Long\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"12\" Then\n            Rows(LR).EntireRow.Delete\n        End If\n    Next LR\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"D2:D2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"O2:O2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"J2:J2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"K2:K2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"L2:L2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:Z2000\")\n    .Apply\nEnd With\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\n\n    Dim LastRow As Integer, i As Integer, erow As Integer\n\n    LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If Cells(i, 2) = \"12\" Then\n\n            ' As opposed to selecting the cells, this will copy them directly\n            Range(Cells(i, 1), Cells(i, 26)).Copy\n\n            ' As opposed to \"Activating\" the workbook, and selecting the sheet, this will paste the cells directly\n            With Workbooks(\"Swivel - Master - December 2015.xlsm\").Sheets(\"Swivel\")\n                erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                .Cells(erow, 1).PasteSpecial xlPasteAll\n            End With\n            Application.CutCopyMode = False\n        End If\n    Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I have worked through many errors in this code over the last two days and am a little fried, so any help is appreciated.</p>\n\n<p>Here is my updated IF statement to check the status of the workbook required to proceed:</p>\n\n<pre><code>Dim ANS As String\n\n    ANS = MsgBox(\"Is the November 2015 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\n    If ANS = vbNo Then\n        MsgBox \"This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n        Exit Sub\n        ElseIf IsWBOpen(\"Swivel - Master - November 2015\") Then\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "tabs"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1451423798, "post_id": 34519182, "comment_id": 56779580, "body": "To get started with VBA, I&#39;d do this:  Turn on the macro recorder.  Click a sheet name, do a find for &quot;Fish Burger Deluxe&quot;.  When it finds a cell, then delete that cell, and find again. Then, click the next sheet, repeat.  After two repetitions, take a look at the created macro and see if you can figure out how you can tweak it to loop through the multiple names, etc. Then post here with any questions!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1451428490, "post_id": 34519182, "comment_id": 56781753, "body": "you want to delete the cell&#39;s content, or delete the entire row?"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1451436032, "post_id": 34519182, "comment_id": 56784209, "body": "Thank you BruceWayne, playing around with Macros and trying to break it down into individual actions, will report back soon with specific questions!  A.S.H.- Either would be fine really, whichever is easier. In the tabs there are only 2 columns of data."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1451494977, "post_id": 34519182, "comment_id": 56809136, "body": "@sikorloa Neither is difficult, but the code will be different depending on what you want to do.  Also, what do you want to happen after you delete the cell or row?  If you delete a row, all the rows below will move up; if you delete a cell, only the cells in that column will move up.  Also note the difference between <code>Delete</code> and <code>Clear</code>"}], "owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451423625, "creation_date": 1451423625, "last_edit_date": 1495540324, "question_id": 34519182, "link": "https://stackoverflow.com/questions/34519182/delete-duplicate-cells-in-excel-across-tabs", "title": "Delete duplicate cells in excel across tabs", "body": "<p><strong>For a keyword that appears across different tabs in Excel, what is the simplest way to delete the duplicate keywords in other tabs?</strong></p>\n\n<p>In below example, keyword \"Fish Burger Deluxe\" appears in tabs Tomato, Hamburger, Fish, Protein and Burger King - What should I do to delete the value \"Fish Burger Deluxe\" from Hamburger, Fish, Protein, and Burger King?</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/16445060/vba-script-to-compare-2-sheets-and-delete-duplicated-cells-big-search-range\">this</a> script however not sure if it applies to my exact situation.</p>\n\n<p>I am familiar with excel formulas, but am a macro and VBA noob... I am confident I could learn however don't know where to start for this situation.</p>\n\n<p>Any help or suggestions would be greatly appreciated.</p>\n\n<p>Link to picture of example:\n<a href=\"https://i.stack.imgur.com/zhZhk.jpg\" rel=\"nofollow noreferrer\">Example of duplicate keyword across tabs</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451421743, "post_id": 34518747, "comment_id": 56778708, "body": "<code>spent a few days</code> If true, may I suggest you hire someone XD"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451422265, "post_id": 34518747, "comment_id": 56778938, "body": "In those few days, I hope you&#39;ve found <i>some</i> code you can try, or at least an idea. If so, please post that code!"}, {"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451422586, "post_id": 34518747, "comment_id": 56779086, "body": "@findwindow the problem is that im very beginner about VBA Excel, Im sorry about that!"}, {"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451422697, "post_id": 34518747, "comment_id": 56779125, "body": "@BruceWayne Thank you, yes that&#39;s true but what I find is just to import an excel file not opened to a current worksheet, my issue is how to jointed data and named sheet by the name of data such as I explained above?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451422871, "post_id": 34518747, "comment_id": 56779202, "body": "Sigh. What you want to do is not difficult XD If you have nothing to show after few days, no amount of guidance is going to help you short of giving you turnkey code."}, {"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451424258, "post_id": 34518747, "comment_id": 56779802, "body": "@findwindow if it&#39;s not good for you &quot;few days&quot; so give us a solution if it&#39;s very easy for you?!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451424390, "post_id": 34518747, "comment_id": 56779863, "body": "SO isn&#39;t a coding service hence my suggestion for you to hire someone. Batman has a heart of gold though."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451424524, "post_id": 34518747, "comment_id": 56779920, "body": "What @findwindow means is that, if you&#39;ve been working on this for a few days, please let us know what you have tried and what has/has not worked.  We&#39;re here to <i>help</i>, not necessarily <i>do for</i> you.  When we can see some effort on your part, it helps narrow down where your problems may lie (in the code).  You held back code that you used, which would have saved time and effort on our part trying to think of what you <i>could</i> be doing.  Please read over <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> for further info."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "edited": false, "score": 0, "creation_date": 1451424122, "post_id": 34519045, "comment_id": 56779732, "body": "I don&#39;t understand very well Bruce, you can see my edit above please I guess your solution is possible after I import data to unique file and then joined them by data in sheets(data)?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "edited": false, "score": 0, "creation_date": 1451424406, "post_id": 34519045, "comment_id": 56779870, "body": "@Yassou - Oh! That changes things quite a bit.  Next time, please include code in your post.  But the above formulas should work, just have to get them on to each sheet."}, {"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "edited": false, "score": 0, "creation_date": 1451424736, "post_id": 34519045, "comment_id": 56780000, "body": "Thank you, but I need some help because I did not get your formula can you change it by reall value following my file above please?"}, {"owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "edited": false, "score": 0, "creation_date": 1451426673, "post_id": 34519045, "comment_id": 56780960, "body": "they are some way to run this formula using vba code?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1451422907, "creation_date": 1451422907, "answer_id": 34519045, "question_id": 34518747, "link": "https://stackoverflow.com/questions/34518747/extract-data-from-excel-file-joined-by-type-of-data-in-sheets/34519045#34519045", "title": "Extract data from Excel file joined by type of data in sheets", "body": "<p>No need for VBA, you can use a formula.</p>\n\n<p>I assume that each of your sheets (\"2301\",\"4221\", etc.) is called JUST that.  Also, I'm assuming you have a header row on each one.</p>\n\n<p>In your non-main worksheet, enter this formula (as an array, with <kbd>CTRL+SHIFT+ENTER</kbd> and drag over/down:\n<code>=IFERROR(INDEX(Sheet1!A$2:A$14,SMALL(IF(Sheet1!$A$2:$A$14=INT(RIGHT(CELL(\"filename\",A1),LEN(CELL(\"filename\",A1))-FIND(\"]\",CELL(\"filename\",A1)))),ROW(Sheet1!A$2:A$14)-ROW(Sheet1!A$2)+1),ROWS(Sheet1!A$2:A2))),\"\")</code></p>\n\n<p>You'll probably need to adjust the ranges, but that should do the trick.  If you have any troubles, let me know!</p>\n\n<p>Now, you can use that formula on any sheet. It'll look in the main sheet (in my example, <code>Sheet1</code>, for a match, then return the equivalent info.  </p>\n\n<p>Where you will probably want VB help though, is adding this formula to each sheet. Let me know if you need help doing so.</p>\n\n<p>Edit: A note though, this requires that you have saved the workbook somewhere.  The formula part that returns the sheet name doesn't work unless the workbook is saved.</p>\n"}], "owner": {"reputation": 1, "user_id": 5723014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce850bac079957aab5f8aeb5c17b802?s=128&d=identicon&r=PG&f=1", "display_name": "Yassou", "link": "https://stackoverflow.com/users/5723014/yassou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1451424021, "creation_date": 1451421665, "last_edit_date": 1451424021, "question_id": 34518747, "link": "https://stackoverflow.com/questions/34518747/extract-data-from-excel-file-joined-by-type-of-data-in-sheets", "title": "Extract data from Excel file joined by type of data in sheets", "body": "<p>I have an excel file : </p>\n\n<p><strong>Excel.xls</strong></p>\n\n<pre><code>Code    date        start   end\n2301    12/08/1993  08:02   08:17\n4221    12/08/1993  09:04   09:25\n2312    12/08/1993  10:02   10:28\n1284    19/09/1994  11:02   11:21\n2312    19/09/1994  15:57   16:20\n1284    23/06/1995  17:12   17:35\n2312    22/06/1996  13:14   13:32\n4221    22/06/1996  15:53   16:13\n4221    05/05/1999  08:06   08:22\n2418    05/05/1999  08:10   08:33\n2301    05/05/1999  09:12   09:37\n2301    05/05/1999  09:28   10:28\n2301    05/05/1999  13:28   13:38\n</code></pre>\n\n<p><strong>Problem :</strong></p>\n\n<p>The issue is to extract data from excel file to another jointed by<code>Code</code> row?</p>\n\n<p><strong>Desired solution:</strong> </p>\n\n<p>Importing data from excel file to another or a workbook, jointed by number of row <code>Code</code> into sheets with the name of data concerned, for example in sheet <code>2301</code> I can have only data of person who this code in the excel file :</p>\n\n<p><strong>Sheet2301</strong></p>\n\n<pre><code>Code    date        start   end\n2301    05/05/1999  09:12   09:37\n2301    05/05/1999  09:28   10:28\n2301    05/05/1999  13:28   13:38\n....      ......     ....    ....\n</code></pre>\n\n<p>Im a beginner in VBA so I spent a few days to find a solution so solution.</p>\n\n<p>EDIT :</p>\n\n<p>In fact I have different csv files and I import them to a unique worksheet using this VBA code : </p>\n\n<pre><code>Option Explicit\n\nSub ImportCSV()\n\nDim strSourcePath As String\nDim strDestPath As String\nDim strFile As String\nDim strData As String\nDim x As Variant\nDim Cnt As Long\nDim r As Long\nDim c As Long\n\nApplication.ScreenUpdating = False\n\n'Change the path to the source folder accordingly\nstrSourcePath = \"path to csv files\\\"\n\nIf Right(strSourcePath, 1) &lt;&gt; \"\\\" Then strSourcePath = strSourcePath &amp; \"\\\"\n\n'Change the path to the destination folder accordingly\nstrDestPath = \"path to csv files\\\"\n\nIf Right(strDestPath, 1) &lt;&gt; \"\\\" Then strDestPath = strDestPath &amp; \"\\\"\n\nstrFile = Dir(strSourcePath &amp; \"*.csv\")\n\nDo While Len(strFile) &gt; 0\n    Cnt = Cnt + 1\n    If Cnt = 1 Then\n        r = 1\n    Else\n        r = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    End If\n    Open strSourcePath &amp; strFile For Input As #1\n        If Cnt &gt; 1 Then\n            Line Input #1, strData\n        End If\n        Do Until EOF(1)\n            Line Input #1, strData\n            x = Split(strData, \",\")\n            For c = 0 To UBound(x)\n                Cells(r, c + 1).Value = Trim(x(c))\n            Next c\n            r = r + 1\n        Loop\n    Close #1\n    Name strSourcePath &amp; strFile As strDestPath &amp; strFile\n    strFile = Dir\nLoop\n\nApplication.ScreenUpdating = True\n\nIf Cnt = 0 Then _\n    MsgBox \"No CSV files were found...\", vbExclamation\n\nEnd Sub\n</code></pre>\n\n<p>and the code works very fine so I have to joined this by data in different current sheets (as I explained before)?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451423663, "post_id": 34518743, "comment_id": 56779530, "body": "You may have some issues with this idea.  For instance, if your mapping table has (xcode, ycode, mapping) values of (1,1, &quot;MAP1&quot;) and (1,2, &quot;MAP2&quot;) and you have a record in the mainTable that contains xcode 1, but Column1 is NOT 000 or 001, then the mainTable would be updated with EITHER &quot;MAP1&quot; or &quot;MAP2&quot;, and I&#39;m not sure which one.  You might want to make sure these tables are defined appropriately."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451423741, "post_id": 34518743, "comment_id": 56779560, "body": "You <i>could</i> do it in 1 query, but as zedfoxus suggests, it&#39;d be a lot better and more intuitive in 2."}], "answers": [{"tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 1, "last_activity_date": 1451423247, "creation_date": 1451423247, "answer_id": 34519111, "question_id": 34518743, "link": "https://stackoverflow.com/questions/34518743/ms-access-sql-query-with-condtional-statement/34519111#34519111", "title": "MS Access SQL Query with condtional statement", "body": "<p>You will need two queries and that's a good thing: one query gets you the results that you would get with <code>if</code> and the other query gives you the results that you would get with <code>else</code>.</p>\n\n<p>Query1: </p>\n\n<pre><code>update maintable m inner join maptable map on m.xcode = map.xcode and m.ycode = map.ycode\nset m.column2 = map.mapping\nwhere m.column1  = \"000\" or m.column1 = \"001\"\n</code></pre>\n\n<p>Query2: </p>\n\n<pre><code>update maintable m inner join maptable map on m.xcode = map.xcode\nset m.column2 = map.mapping\nwhere NOT (m.column1  = \"000\" or m.column1 = \"001\")\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 988322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d4aadf79097dd198c6e04c1d675124ce?s=128&d=identicon&r=PG", "display_name": "John Lee", "link": "https://stackoverflow.com/users/988322/john-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 34519111, "answer_count": 1, "score": 0, "last_activity_date": 1451423247, "creation_date": 1451421645, "last_edit_date": 1451422413, "question_id": 34518743, "link": "https://stackoverflow.com/questions/34518743/ms-access-sql-query-with-condtional-statement", "title": "MS Access SQL Query with condtional statement", "body": "<p>I am trying to update a table using values from a mapping table. I think its an UPDATE and SELECT statement but I cant figure out how to handle conditions. This is in VBA Access.</p>\n\n<p>I have two tables with following fields:</p>\n\n<pre><code>mainTable: [column1],[column2],[xcode],[ycode]\nmapTable: [xcode],[ycode],[mapping]\n</code></pre>\n\n<p>I need to do a mapping from mapTable but it has the following condition</p>\n\n<pre><code>If mainTable.[column1] = \"000\" or mainTable.[column1] = \"001\" Then\n  mainTable.[column2] = mapTable.[mapping]\n  WHERE mapTable.[xcode] = mainTable.[xcode] \n  AND mapTable.[ycode] = mainTable.[ycode]\nElse\n  mainTable.[column2] = mapTable.[mapping]\n  WHERE mapTable.[xcode] = mainTable.[xcode] \nEnd If\n</code></pre>\n\n<p>Is there a way to capture this in a single SQL query?</p>\n"}, {"tags": ["php", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1451459375, "post_id": 34518578, "comment_id": 56790729, "body": "Use <code>Documents.Open(URLGoesHere)</code>"}, {"owner": {"reputation": 107, "user_id": 3080631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2e71fff0b96208e537f8b1551e8?s=128&d=identicon&r=PG&f=1", "display_name": "fgs", "link": "https://stackoverflow.com/users/3080631/fgs"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1451490496, "post_id": 34518578, "comment_id": 56806647, "body": "Thanks! This worked."}], "owner": {"reputation": 107, "user_id": 3080631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2e71fff0b96208e537f8b1551e8?s=128&d=identicon&r=PG&f=1", "display_name": "fgs", "link": "https://stackoverflow.com/users/3080631/fgs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451420945, "creation_date": 1451420945, "question_id": 34518578, "link": "https://stackoverflow.com/questions/34518578/open-generated-word-file-from-php-using-vba", "title": "Open generated Word file from php using VBA", "body": "<p>I use PHPWORD class to generate a Word file in php. Currently this works by sending the parameters through GET. For example> <a href=\"http://example.com/doc.php?title=test\" rel=\"nofollow\">http://example.com/doc.php?title=test</a>. Then a result.docx file is generated.</p>\n\n<p>I already have a UserForm in Word that asks for the parameters. I want to be able to send those parameters to php and open the generated document.</p>\n\n<p>Currently I have tried to use the FollowHyperlink method, but the main issue is that it opens a browser window instead of opening the document.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "sorting", "split"], "comments": [{"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1451421244, "post_id": 34518454, "comment_id": 56778493, "body": "Any reason that you can&#39;t use a pivot table?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1451421447, "post_id": 34518454, "comment_id": 56778584, "body": "@cronos2546 - how will you get <code>UK+US</code> to show up in the pivot table value box? Although, I agree using the row / column structure and page filtering for teams with a pivot table could be a great place to start."}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1451493269, "post_id": 34518454, "comment_id": 56808187, "body": "@ScottHoltzman you wouldn&#39;t be able to accomplish that particular cell value without a new calculated column (which could be VBA powered), however, it seemed that a pivot table could fill many of the design objectives that the OP requested."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451431625, "post_id": 34520177, "comment_id": 56782956, "body": "fwiw, I think the reported data was intended to be across columns (e.g. Team2 to the right of Team1)."}, {"owner": {"reputation": 33, "user_id": 5728146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4adec891fb5f8e74faa7771c9318d1c?s=128&d=identicon&r=PG&f=1", "display_name": "Shikha", "link": "https://stackoverflow.com/users/5728146/shikha"}, "edited": false, "score": 0, "creation_date": 1451477281, "post_id": 34520177, "comment_id": 56799530, "body": "@tigeravatar : Thanks for your quick reply, although i am facing a problem with &quot;Msg Box&quot;? i don&#39;t want any msg box but as soon as i am removing text written for MsgBox , i am getting error."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1451487602, "post_id": 34520177, "comment_id": 56805122, "body": "Oh, the message boxes were for me testing and debugging the code and I forgot to take them out when I posted the solution.  I&#39;ll edit the post to remove them."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1451487661, "last_edit_date": 1451487661, "creation_date": 1451428493, "answer_id": 34520177, "question_id": 34518454, "link": "https://stackoverflow.com/questions/34518454/excel-vba-splitting-sorting-data-into-report-table/34520177#34520177", "title": "Excel VBA - Splitting/Sorting data into report table", "body": "<p>Something like this should work for you.  You'll need to update the sheetnames for <code>wsData</code> (the sheet your original data is on), <code>wsDest</code> (the sheet you want to output the results to), and <code>rTeams</code> (the range of cells that contains the original data).</p>\n\n<pre><code>Sub tgr()\n\n    Dim cTeams As Collection\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rFound As Range\n    Dim rTeams As Range\n    Dim TeamCell As Range\n    Dim aTeamData() As Variant\n    Dim vTeam As Variant\n    Dim sFirst As String\n    Dim sUnqTeams As String\n    Dim sTeam As String\n    Dim lQuarter As Long\n    Dim lNameIndex As Long\n    Dim i As Long\n\n    Set cTeams = New Collection\n    Set wsData = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set wsDest = ActiveWorkbook.Sheets(\"Sheet2\")\n    Set rTeams = wsData.Range(\"A2\", wsData.Cells(Rows.Count, \"A\").End(xlUp))\n\n    For Each TeamCell In rTeams.Cells\n        sTeam = CStr(TeamCell.Value)\n        If InStr(1, \"|\" &amp; sUnqTeams &amp; \"|\", \"|\" &amp; sTeam &amp; \"|\", vbTextCompare) = 0 Then\n            sUnqTeams = sUnqTeams &amp; \"|\" &amp; sTeam\n            ReDim aTeamData(1 To WorksheetFunction.CountIf(rTeams, sTeam) + 1, 1 To 5)\n            aTeamData(1, 1) = sTeam\n            aTeamData(1, 2) = \"Q1\"\n            aTeamData(1, 3) = \"Q2\"\n            aTeamData(1, 4) = \"Q3\"\n            aTeamData(1, 5) = \"Q4\"\n\n            Set rFound = rTeams.Find(sTeam, rTeams.Cells(rTeams.Cells.Count), xlValues, xlWhole)\n            If Not rFound Is Nothing Then\n                sFirst = rFound.Address\n                Do\n                    For i = 2 To UBound(aTeamData, 1)\n                        If Len(aTeamData(i, 1)) = 0 Then\n                            aTeamData(i, 1) = rFound.Offset(, 1).Value\n                            lNameIndex = i\n                            Exit For\n                        ElseIf aTeamData(i, 1) = rFound.Offset(, 1).Value Then\n                            lNameIndex = i\n                            Exit For\n                        End If\n                    Next i\n                    lQuarter = Right(rFound.Offset(, 3).Value, 1) + 1\n                    If Len(aTeamData(lNameIndex, lQuarter)) = 0 Then\n                        aTeamData(lNameIndex, lQuarter) = rFound.Offset(, 2).Value\n                    Else\n                        aTeamData(lNameIndex, lQuarter) = aTeamData(lNameIndex, lQuarter) &amp; \"+\" &amp; rFound.Offset(, 2).Value\n                    End If\n                    Set rFound = rTeams.FindNext(rFound)\n                Loop While rFound.Address &lt;&gt; sFirst\n                cTeams.Add aTeamData, sTeam\n            End If\n        End If\n    Next TeamCell\n\n    wsDest.Range(\"A1\").Resize(, UBound(aTeamData, 2)).EntireColumn.Clear\n    For Each vTeam In cTeams\n        wsDest.Cells(Rows.Count, \"A\").End(xlUp).Offset(2).Resize(UBound(vTeam, 1), UBound(vTeam, 2)).Value = vTeam\n    Next vTeam\n    wsDest.Range(\"1:2\").EntireRow.Delete xlShiftUp\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5728146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4adec891fb5f8e74faa7771c9318d1c?s=128&d=identicon&r=PG&f=1", "display_name": "Shikha", "link": "https://stackoverflow.com/users/5728146/shikha"}, "edited": false, "score": 0, "creation_date": 1451476842, "post_id": 34520992, "comment_id": 56799311, "body": "First of all, Thank you so much :). I don&#39;t know SQL programming so still trying to figure out your code but its working. But if i am using this code and have team names &quot;team 10&quot;/ &quot;team 11 &quot;, in output they are coming in between &quot;team 1&quot; &amp; &quot;team 2&quot;. How do i rectify that situation?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 33, "user_id": 5728146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4adec891fb5f8e74faa7771c9318d1c?s=128&d=identicon&r=PG&f=1", "display_name": "Shikha", "link": "https://stackoverflow.com/users/5728146/shikha"}, "edited": false, "score": 0, "creation_date": 1451782592, "post_id": 34520992, "comment_id": 56889559, "body": "@Shikha Teams just put in order sorted as strings. Why not to use team names like <code>team01</code>, <code>team02</code>, ... , <code>team11</code>?"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 2, "last_activity_date": 1451433286, "creation_date": 1451433286, "answer_id": 34520992, "question_id": 34518454, "link": "https://stackoverflow.com/questions/34518454/excel-vba-splitting-sorting-data-into-report-table/34520992#34520992", "title": "Excel VBA - Splitting/Sorting data into report table", "body": "<p>Here's the example how to prepare the report using some SQL processing and loops:</p>\n\n<pre><code>Option Explicit\n\nSub CreateReport()\n\n    Dim objConnection As Object\n    Dim lngPosition As Long\n    Dim strTeamName As Variant\n    Dim objRecordSet As Object\n    Dim arrData() As String\n    Dim arrEmployees As Variant\n    Dim lngEmployee As Long\n    Dim lngQuarter As Long\n    Dim arrPlaces As Variant\n\n    ' open ADODB connection to this workbook\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    objConnection.Open _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"User ID=Admin;\" &amp; _\n        \"Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';\" &amp; _\n        \"Mode=Read;\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;\"\";\"\n    ' prepare target worksheet for output\n    Sheets(\"Sheet2\").Cells.Delete\n    lngPosition = 1\n    ' get names of teams\n    Set objRecordSet = objConnection.Execute( _\n        \"SELECT DISTINCT [Team Name] FROM [Sheet1$];\")\n    ' process each team\n    For Each strTeamName In objRecordSet.GetRows\n        ' get names of particular team employees\n        Set objRecordSet = objConnection.Execute( _\n            \"SELECT DISTINCT [Traveller's Name] FROM [Sheet1$] WHERE \" &amp; _\n            \"[Team Name] = '\" &amp; strTeamName &amp; \"';\")\n        arrEmployees = objRecordSet.GetRows\n        ' prepare resulting array\n        ReDim arrData(UBound(arrEmployees, 2) + 1, 4)\n        arrData(0, 0) = strTeamName\n        arrData(0, 1) = \"Q1\"\n        arrData(0, 2) = \"Q2\"\n        arrData(0, 3) = \"Q3\"\n        arrData(0, 4) = \"Q4\"\n        ' process each employee of the team\n        For lngEmployee = 0 To UBound(arrEmployees, 2)\n            arrData(lngEmployee + 1, 0) = arrEmployees(0, lngEmployee)\n            ' process each quarter for the employee of the team\n            For lngQuarter = 1 To 4\n                ' get all visited places of the employee of the team for the quarter\n                Set objRecordSet = objConnection.Execute( _\n                    \"SELECT DISTINCT [Country/Place] FROM [Sheet1$] WHERE \" &amp; _\n                    \"[Team Name] = '\" &amp; strTeamName &amp; \"' AND \" &amp; _\n                    \"[Traveller's Name] = '\" &amp; arrEmployees(0, lngEmployee) &amp; \"' AND \" &amp; _\n                    \"[Quarter] = 'Q\" &amp; lngQuarter &amp; \"';\")\n                If Not objRecordSet.EOF Then\n                    ' if there are any places then join them and write to array\n                    arrPlaces = objRecordSet.GetRows\n                    arrPlaces = Application.Index(arrPlaces, , 0) ' make 1d from 2d array\n                    arrData(lngEmployee + 1, lngQuarter) = Join(arrPlaces, \"+\")\n                End If\n            Next\n        Next\n        ' put populated array for the team to the sheet\n        Output Sheets(\"Sheet2\"), 1, lngPosition, arrData\n        lngPosition = lngPosition + 6 ' shift to the right\n    Next\n\nEnd Sub\n\nSub Output(objSheet As Worksheet, lngTop As Long, lngLeft As Long, arrCells As Variant)\n    With objSheet\n        .Select\n        .Range(.Cells(lngTop, lngLeft), .Cells(UBound(arrCells, 1) + lngTop, UBound(arrCells, 2) + lngLeft)).Value = arrCells\n    End With\nEnd Sub\n</code></pre>\n\n<p>I populated the source worksheet <code>Sheet1</code> with values as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oymzX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oymzX.png\" alt=\"source worksheet\"></a></p>\n\n<p>Then the resulting report looks like as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DYd7N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DYd7N.png\" alt=\"report\"></a></p>\n\n<p>Note that you can get source data from any other workbook, just replace <code>ThisWorkbook.FullName</code> with actual path. Any changes made to the source workbook must be saved before the macro launched, since the connection should be done to the file, containing actual data. It works on 64-bit version Excel 2010 for me. To make it compatible with <code>.xls</code> and Excel 2003 (where the provider <code>ACE.OLEDB.12.0</code> isn't installed) you have to replace <code>Provider=Microsoft.ACE.OLEDB.12.0;</code> with <code>Provider=Microsoft.Jet.OLEDB.4.0;</code>, and also in extended properties <code>Excel 12.0 Macro;</code> / <code>Excel 12.0;</code> with <code>Excel 8.0;</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1451433758, "creation_date": 1451433758, "answer_id": 34521055, "question_id": 34518454, "link": "https://stackoverflow.com/questions/34518454/excel-vba-splitting-sorting-data-into-report-table/34521055#34521055", "title": "Excel VBA - Splitting/Sorting data into report table", "body": "<p>One more array based solution.</p>\n\n<pre><code>Sub reportTeam()\n    Dim o As Long, n As Long, r As Long, t As Long\n    Dim vTEAM As Variant, vTEAMs As Variant, vNAMEs As Variant\n    Dim wsREP As Worksheet\n\n    Set wsREP = Worksheets(\"Sheet2\")\n    ReDim vTEAMs(1 To 1)\n\n    With Worksheets(\"MasterSheet\")\n        With .Cells(1, 1).CurrentRegion\n            .Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                        Key2:=.Columns(4), Order2:=xlAscending, _\n                        Key3:=.Columns(2), Order3:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                vTEAMs = .Cells.Value2\n                n = 0\n                ReDim vNAMEs(1 To 2, 1 To 1)\n                For t = LBound(vTEAMs, 1) To UBound(vTEAMs, 1)\n                    n = n + 1\n                    If t = UBound(vTEAMs, 1) Then\n                        vNAMEs(1, UBound(vNAMEs, 2)) = n\n                        vNAMEs(2, UBound(vNAMEs, 2)) = vTEAMs(t, 1)\n                    ElseIf vTEAMs(t, 1) &lt;&gt; vTEAMs(t + 1, 1) Then\n                        vNAMEs(1, UBound(vNAMEs, 2)) = n\n                        vNAMEs(2, UBound(vNAMEs, 2)) = vTEAMs(t, 1)\n                        ReDim Preserve vNAMEs(1 To 2, 1 To UBound(vNAMEs, 2) + 1)\n                        n = 0\n                    End If\n                Next t\n            End With\n        End With\n    End With\n\n    t = 1\n    With wsREP\n        .UsedRange.ClearContents\n        For n = LBound(vNAMEs, 2) To UBound(vNAMEs, 2)\n            ReDim vTEAM(1 To vNAMEs(1, n) + 1, 1 To 5)\n            r = 1\n            vTEAM(r, 1) = vNAMEs(2, n)\n            vTEAM(r, 2) = \"Q1\": vTEAM(r, 3) = \"Q2\": vTEAM(r, 4) = \"Q3\": vTEAM(r, 5) = \"Q4\"\n            r = r + 1\n            vTEAM(r, 1) = vTEAMs(t, 2)\n            vTEAM(r, Right(vTEAMs(t, 4), 1) + 1) = vTEAMs(t, 3)\n            r = r + 1\n\n            For t = Application.Match(vNAMEs(2, n), Application.Index(vTEAMs, 0, 1), 0) + 1 To _\n                    Application.Match(vNAMEs(2, n), Application.Index(vTEAMs, 0, 1))\n                If vTEAMs(t, 2) = vTEAMs(t - 1, 2) And vTEAMs(t, 4) = vTEAMs(t - 1, 4) Then\n                    vTEAM(r - 1, Right(vTEAMs(t, 4), 1) + 1) = _\n                      vTEAM(r - 1, Right(vTEAMs(t, 4), 1) + 1) &amp; Chr(43) &amp; vTEAMs(t, 3)\n                Else\n                    vTEAM(r, 1) = vTEAMs(t, 2)\n                    vTEAM(r, Right(vTEAMs(t, 4), 1) + 1) = vTEAMs(t, 3)\n                    r = r + 1\n                End If\n            Next t\n\n            With .Cells(1, Columns.Count).End(xlToLeft)\n                With .Resize(UBound(vTEAM, 1), UBound(vTEAM, 2)).Offset(0, Abs(.Column &gt; 1) * 2)\n                    .Cells = vTEAM\n                End With\n            End With\n\n        Next n\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>I gathered from your code that the original data was on a worksheet named <strong>MasterSheet</strong> but I could find no reference to the report worksheet. I used <strong>Sheet2</strong> for the reporting.</p>\n"}], "owner": {"reputation": 33, "user_id": 5728146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4adec891fb5f8e74faa7771c9318d1c?s=128&d=identicon&r=PG&f=1", "display_name": "Shikha", "link": "https://stackoverflow.com/users/5728146/shikha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 34521055, "answer_count": 3, "score": 3, "last_activity_date": 1451487661, "creation_date": 1451420458, "last_edit_date": 1451420702, "question_id": 34518454, "link": "https://stackoverflow.com/questions/34518454/excel-vba-splitting-sorting-data-into-report-table", "title": "Excel VBA - Splitting/Sorting data into report table", "body": "<p>I am trying to sort my raw data into report format. for example my raw data looks like figure below:</p>\n\n<blockquote>\n  <p>Team names, Employee names, country they have traveled, Quarter of the\n  year</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/nSBJt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nSBJt.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want my data to be split/sort in given format like row contains name of employees in team1 (let's say we have 6 employees in team1) and column contains all 4 quarters, and solution looks like a matrix (6x4) where country name is filled in cells. \nAlso if employee has visited US &amp; UK in same quarter, his cell shows both the names of country in same cell. </p>\n\n<p>Figure 2 is the solution I am looking for:\n<a href=\"https://i.stack.imgur.com/8LpXJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8LpXJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Please help me, I tried writing this VBA code and successfully sorted employees names in team, BUT i have no idea how do i fill the cells w.r.t. Quarters?</p>\n\n<pre><code>Sub JMP()\nDim team1 As String\nDim team2 As String\nDim team3 As String\nDim team 4 As String\n\nDim Q1 As String\nDim Q2 As String\nDim Q3 As String\nDim Q4 As String\n\nDim finalrow As Integer\nDim i As Integer\n\nteam1 = Sheets(\"MasterSheet\").Range(\"I1\").Value\nteam2 = Sheets(\"MasterSheet\").Range(\"O1\").Value\nteam3 = Sheets(\"MasterSheet\").Range(\"U1\").Value\n\nQ1 = Sheets(\"MasterSheet\").Range(\"J1\").Value\nQ2 = Sheets(\"MasterSheet\").Range(\"K1\").Value\nQ3 = Sheets(\"MasterSheet\").Range(\"L1\").Value\nQ4 = Sheets(\"MasterSheet\").Range(\"M1\").Value\n\nfinalrow = Sheets(\"MasterSheet\").Range(\"B200\").End(xlUp).Row\ni = 0\nFor i = 1 To 100\n     If Cells(i, 2) = team1 And Cells(i, 5) = Q1 Then\n            Range(Cells(i, 3), Cells(i, 4)).Copy\n            Range(\"I100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValuesAndNumberFormats\n    'ElseIf Cells(i, 2) = team 1 And Cells(i, 5) = Q3 Then\n            'Range(Cells(i, 3), Cells(i, 4)).Copy\n            'Range(\"I100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValuesAndNumberFormats\n    'ElseIf Cells(i, 2) = Russia And Cells(i, 5) = Q4 Then\n            'Range(Cells(i, 3), Cells(i, 4)).Copy\n            'Range(\"I100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValuesAndNumberFormats\n\n    End If\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "collections"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1451419399, "post_id": 34518155, "comment_id": 56777603, "body": "Please annotate or otherwise disclose what code line the error is being produced on. No one can actually run your code without many things that were omitted but we might have a chance at determining what the problem is if you tell us where it occurs."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451420125, "post_id": 34518155, "comment_id": 56777974, "body": "It may be that they array SplitData doesn&#39;t have anything in position 2 for the line and file that are breaking."}, {"owner": {"reputation": 47, "user_id": 3224991, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/8be5247af52ccd70e8e3c27ff923bbf5?s=128&d=identicon&r=PG&f=1", "display_name": "jlynn303", "link": "https://stackoverflow.com/users/3224991/jlynn303"}, "edited": false, "score": 0, "creation_date": 1451481440, "post_id": 34518155, "comment_id": 56801815, "body": "@Jeeped, the line of code on which the error occurs is &#39;strSN.Add SplitData(0)&#39;.  If I comment out this line, the error jumps to the next line &#39;strFF.Add SplitData(2)&#39;."}, {"owner": {"reputation": 47, "user_id": 3224991, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/8be5247af52ccd70e8e3c27ff923bbf5?s=128&d=identicon&r=PG&f=1", "display_name": "jlynn303", "link": "https://stackoverflow.com/users/3224991/jlynn303"}, "edited": false, "score": 0, "creation_date": 1451928379, "post_id": 34518155, "comment_id": 56938261, "body": "Hi, please see my comment above regarding which line is giving me the error..  I could really use some help determining why after so many files the code stops working when there isn&#39;t anything inherently wrong with the files from which I&#39;m trying to read data.  Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 3224991, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/8be5247af52ccd70e8e3c27ff923bbf5?s=128&d=identicon&r=PG&f=1", "display_name": "jlynn303", "link": "https://stackoverflow.com/users/3224991/jlynn303"}, "is_accepted": false, "score": 0, "last_activity_date": 1452026516, "creation_date": 1452026516, "answer_id": 34620857, "question_id": 34518155, "link": "https://stackoverflow.com/questions/34518155/vba-subscript-out-of-range-error-appearing-after-collection-contains-so-many-ele/34620857#34620857", "title": "VBA Subscript out of Range Error appearing after Collection contains so many elements", "body": "<p>I figured out that the SplitData array wasn't getting emptied and was consequently reaching its size limit, causing the Subscript Out of Range Error.  I added the code line 'Erase SplitData()' after the code line 'Do Until .AtEndOfStream' and this emptied the SplitData array each time to prevent the accumulation of unnecessary data.</p>\n"}], "owner": {"reputation": 47, "user_id": 3224991, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/8be5247af52ccd70e8e3c27ff923bbf5?s=128&d=identicon&r=PG&f=1", "display_name": "jlynn303", "link": "https://stackoverflow.com/users/3224991/jlynn303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1452026516, "creation_date": 1451419119, "question_id": 34518155, "link": "https://stackoverflow.com/questions/34518155/vba-subscript-out-of-range-error-appearing-after-collection-contains-so-many-ele", "title": "VBA Subscript out of Range Error appearing after Collection contains so many elements", "body": "<p>I'm really struggling to find what's generating the 'Subscript Out Of Range' error in my code below.  What I'm trying to do with said code is to read data from text files having a time stamp within 90 days of the current date.  To collect this data, I'm reading each file line by line, storing that data into a split array, then populating two collections with specific rows of the split array.  This code works fine with another application of it that I'm using to retrieve data only from a specific job set. The code in the aforementioned application appears to be working fine until I reach one particular file which doesn't differ in any way (formatting, content, or otherwise) from previous files that were successfully read.  It seems to me that I'm reaching the size limit of each collection but I'm not sure.  Below is my code:</p>\n\n<pre><code>Private Sub Analyze_90Day_Data_Click()\n    Application.ScreenUpdating = False\n    Data_Selection_21075A.Hide\n    'Declare Variables\n    Dim FFFile As String\n    Dim SplitData() As String\n    Dim DateIter As Long\n    Dim CurrentDate As Date\n    Dim FileDate As Date\n    Dim colSN As String\n    Dim colSet As String\n    Dim KPCDate As Date\n    Dim CMMArray() As Variant\n    'Remove old data from 21075A KPC\n    LastRow = Sheets(\"21075A KPC\").Range(\"G65536\").End(xlUp).Row\n    For SheetRow = 12 To LastRow\n        Sheets(\"21075A KPC\").Range(\"G\" &amp; SheetRow &amp; \":H\" &amp; SheetRow).ClearContents\n    Next SheetRow\n    'Populate 21075A KPC with new data\n    CurrentDate = Date\n    KPCDate = DateAdd(\"d\", -90, CurrentDate)\n    CMMArray = Array(\"Inspcmm1\", \"Inspcmm2\")\n    For CMM = LBound(CMMArray) To UBound(CMMArray)\n        With New Scripting.FileSystemObject\n            CMMFolder = \"\\\\\" &amp; CMMArray(CMM) &amp; \"\\cmm\\21075A\\OP290\"\n            On Error GoTo ResumeIter\n            Set CMMFold = .GetFolder(CMMFolder)\n            For Each SetFolder In CMMFold.SubFolders\n                FFFile = SetFolder &amp; \"\\21075A-030-FINALFLOWTOT \" &amp;     SetFolder.Name &amp; \".txt\"\n                MsgBox SetFolder.Name\n                FileDate = FileDateTime(FFFile)\n                If FileDate &gt;= KPCDate Then\n                    LineIter = 0\n                    With .OpenTextFile(FFFile, ForReading)\n                        Do Until .AtEndOfStream\n                            LineIter = LineIter + 1\n                            LineData = .ReadLine\n                            SplitData = Split(LineData)\n                            'Extracting Serial Number\n                            strSN.Add SplitData(0)\n                            'Extracting Final Flow Value\n                            strFF.Add SplitData(2)\n                        Loop\n                        .Close\n                    End With\n                End If\n            Next SetFolder\n        End With\nResumeIter:\n    Next CMM\n    If strSN.Count = 0 Then\n        MsgBox \"Neither Brown &amp; Sharpe is online.\"\n        Exit Sub\n    Else\n        SheetRow = 12\n        For SNIter = 1 To strSN.Count Step 1\n            With Sheets(\"21075A KPC\")\n                .Range(\"G\" &amp; SheetRow).Value = strSN.Item(SNIter)\n                .Range(\"H\" &amp; SheetRow).Value = strFF.Item(SNIter)\n            End With\n            SheetRow = SheetRow + 1\n        Next SNIter\n        LastRow = Sheets(\"21075A KPC\").Range(\"G65536\").End(xlUp).Row\n        With Sheets(\"21075A KPC\")\n            'Calculate &amp; Populate Means\n            .Range(\"H5\") = WorksheetFunction.Average(.Range(\"H12:H\" &amp; LastRow))\n            'Calculate &amp; Populate Standard Deviations\n            .Range(\"H6\") = WorksheetFunction.StDev(.Range(\"H12:H\" &amp; LastRow))\n            'Populate 90-Day Reporting Period\n            .Range(\"F3\") = KPCDate\n            .Range(\"F4\") = CurrentDate\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>All variables not declared in the above procedure have already been publicly declared.  Thanks for looking into this.  Please let me know if you need anything else from me.</p>\n"}, {"tags": ["excel", "vba", "resize", "userform", "multipage"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1451477665, "creation_date": 1451477665, "answer_id": 34529363, "question_id": 34518043, "link": "https://stackoverflow.com/questions/34518043/vba-userform-dynamic-resize-event-with-multipages/34529363#34529363", "title": "VBA UserForm Dynamic Resize Event with Multipages", "body": "<p>Here is the solution- it was literally as simple as I thought</p>\n\n<pre><code> Private Sub MultiPage1_Change()\n\n If MultiPage1.Value = 0 Then\n     ToolBoxForm.Height = 560.25\n     ToolBoxForm.Width = 652.5\n End If\n\n 'lather, rinse, repeat for each page\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 0, "accepted_answer_id": 34529363, "answer_count": 1, "score": 1, "last_activity_date": 1451477665, "creation_date": 1451418548, "question_id": 34518043, "link": "https://stackoverflow.com/questions/34518043/vba-userform-dynamic-resize-event-with-multipages", "title": "VBA UserForm Dynamic Resize Event with Multipages", "body": "<p>Good Morning! </p>\n\n<p>I started off by reading this :</p>\n\n<p><a href=\"http://www.andypope.info/vba/resizeform.htm\" rel=\"nofollow\">http://www.andypope.info/vba/resizeform.htm</a></p>\n\n<p>And while this was very informative, I was wondering if someone one would be able to point me in the right direction to help being able to solve my inquiry. I want to dynamically set height &amp; width values of a userform depending on what multipage selected (presumably by click event). Would it be something like this?</p>\n\n<pre><code> Sub pageX_click\n\n height.value = 23\n width.value = 50\n\n End Sub\n</code></pre>\n\n<p>I assume it might be more complicated than that, but if someone would be willing to point me in the right direction I can tinker till i find the correct solution. </p>\n\n<p>Other question- due to the differing sizes, would I need to statically set which pages is opened each time? That way i dont get random size issues/errors?</p>\n"}, {"tags": ["excel", "vba", "input"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451418313, "post_id": 34517960, "comment_id": 56777067, "body": "<code>Range(rng).Offset(1,1</code> just do <code>rng.Offset(1,1)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1451418736, "post_id": 34517960, "comment_id": 56777279, "body": "Though what @findwindow said is correct syntax, A UDF will not change the value of a different cell than the caller, (without some funky sidestepping).  To learn about offset change the line to <code>getstd = rng.offset(1,1).value</code> it will return the value one row down and one column over from the specified range."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418840, "post_id": 34517960, "comment_id": 56777315, "body": "Always listen to Scott over me."}, {"owner": {"reputation": 11, "user_id": 5728253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39acdb275ff5645521abbade776476f?s=128&d=identicon&r=PG&f=1", "display_name": "michaelhfwu", "link": "https://stackoverflow.com/users/5728253/michaelhfwu"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418936, "post_id": 34517960, "comment_id": 56777369, "body": "@findwindow Just tried. Still gives me a #Value error. In cell W23, I type <code>=getstd(X12)</code>, and I expect it to go put &quot;hello world&quot; in cell Y13, but it doesn&#39;t..."}, {"owner": {"reputation": 11, "user_id": 5728253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39acdb275ff5645521abbade776476f?s=128&d=identicon&r=PG&f=1", "display_name": "michaelhfwu", "link": "https://stackoverflow.com/users/5728253/michaelhfwu"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1451418991, "post_id": 34517960, "comment_id": 56777404, "body": "@ScottCraner thank you, yeah that makes sense."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451423906, "post_id": 34517960, "comment_id": 56779621, "body": "<a href=\"http://stackoverflow.com/a/24222666/2165759\">This answer</a> may be helpful."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1451431268, "creation_date": 1451431268, "answer_id": 34520649, "question_id": 34517960, "link": "https://stackoverflow.com/questions/34517960/excel-vba-use-range-as-input/34520649#34520649", "title": "Excel VBA use range as input", "body": "<p>You can group (<code>Union</code>) the cells into one multi-area range and use the builtin <code>stdev</code> function:</p>\n\n<pre><code>Function getstd(ByVal target As Range)\n    Dim r As Range\n    For i = 0 To 6 Step 2\n        For j = 0 To 4 Step 2\n            If r Is Nothing Then Set r = target.Offset(i, j) Else Set r = Union(r, target.Offset(i, j))\n        Next\n    Next\n    getstd = Application.StDev(r)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1451561862, "last_edit_date": 1451561862, "creation_date": 1451560234, "answer_id": 34545576, "question_id": 34517960, "link": "https://stackoverflow.com/questions/34517960/excel-vba-use-range-as-input/34545576#34545576", "title": "Excel VBA use range as input", "body": "<p>Another way to do it:</p>\n\n<pre><code>Public Function STD_DEV() As Variant\n\n    Dim rDataSet As Range\n    Dim rCell As Range\n    Dim aValues(1 To 8) As Double\n    Dim x As Long\n\n    Application.Volatile\n\n    With Application.ThisCell\n        'Check we're not trying to reference off the sheet.\n        If .Row &gt; 1 And .Column &gt; 1 And _\n            .Row &lt; Rows.Count And .Column &lt; Columns.Count Then\n\n            'Get a reference to all cells around target cell.\n            'This includes the target cell in its reference.\n            Set rDataSet = .Offset(-1, -1).Resize(3, 3)\n\n            'Step through each cell in the range and add\n            'value to an array.\n            x = 1\n            For Each rCell In rDataSet\n                If rCell.Address &lt;&gt; .Address Then\n                    aValues(x) = rCell.Value\n                    x = x + 1\n                End If\n            Next rCell\n\n            'Calculate the Standard Deviation.\n            STD_DEV = WorksheetFunction.StDev(aValues)\n\n        Else\n\n            STD_DEV = CVErr(xlErrRef)\n\n        End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>Note the <code>WITH</code> keyword - anything between <code>WITH</code> and <code>END WITH</code> that starts with a <code>.</code> refers to <code>Application.ThisCell</code>.  So <code>.Row</code> is the same as saying <code>Application.ThisCell.Row</code> </p>\n\n<p>Edit: Have updated the function to return a <code>#REF!</code> error if it tries to reference off the sheet.</p>\n"}], "owner": {"reputation": 11, "user_id": 5728253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39acdb275ff5645521abbade776476f?s=128&d=identicon&r=PG&f=1", "display_name": "michaelhfwu", "link": "https://stackoverflow.com/users/5728253/michaelhfwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1024, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451561862, "creation_date": 1451418224, "question_id": 34517960, "link": "https://stackoverflow.com/questions/34517960/excel-vba-use-range-as-input", "title": "Excel VBA use range as input", "body": "<p>I'm in the process of learning Excel VBA, and am trying to create a simple function.</p>\n\n<p>The idea is that I would use a cell as an input, and the function would get tell you the standard deviation of 12 values placed around that cell.</p>\n\n<p>So if I type getstd(A1), it would get me the standard deviation of A1, A3, A5, A7, C1, C3, C5, C7, and E1, E3, E5 and E7.</p>\n\n<p>If I type getstd(X23), it would get the std of 12 other values placed at the same offsets around X23.</p>\n\n<p>My biggest problem right now is figuring out how to use a cell as an imput.</p>\n\n<p>For example, when experimenting with offsetting :</p>\n\n<pre><code>Function getstd(rng as Range)\n\n     Range(rng).Offset(1,1) = \"hello world\"\n\nEnd Function\n</code></pre>\n\n<p>It always gives me a #Value error.</p>\n\n<p>I feel that if I can get that to work, then creating my function should be easy.</p>\n\n<p>Thank you!</p>\n\n<p>Michael</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451420667, "post_id": 34518478, "comment_id": 56778219, "body": "The count will sometimes work if you do .MoveLast to get to the end of the recordset and then use .MoveFirst to get back to the beginning."}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "edited": false, "score": 0, "creation_date": 1451421043, "post_id": 34518478, "comment_id": 56778397, "body": "The unreliability of the <code>recordcount</code> property is what had me hesitant to use that.  I remember reading that you have to <code>MoveLast</code> and <code>MoveFirst</code> in order to get an accurate result.  However, it seems to be working without that requirement when I use the adOpenStatic cursortype.  Is there any reason to be worried about this going forward though?"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1451421147, "post_id": 34518478, "comment_id": 56778441, "body": "if you&#39;re explicitly setting the cursor type and it works, you should be fine."}], "tags": [], "owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "is_accepted": false, "score": 3, "last_activity_date": 1451420540, "creation_date": 1451420540, "answer_id": 34518478, "question_id": 34517898, "link": "https://stackoverflow.com/questions/34517898/how-can-i-fill-an-array-with-a-recordset-of-an-unkown-size/34518478#34518478", "title": "How can I fill an array with a recordset of an unkown size?", "body": "<p>If the RecordSet will return a Count, use it with a ReDim, as your last edit states.  </p>\n\n<p>Sometimes Count always return zero, I think it depends on the type of cursor created with the RecordSet.  </p>\n\n<p>A work around is to create a second SQL statement, with the same Where clause,  that returns a count.  </p>\n\n<p>(<code>select count(*) ...</code>)  </p>\n\n<p>Run it first to set the ReDim...</p>\n"}, {"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1451420579, "creation_date": 1451420579, "answer_id": 34518488, "question_id": 34517898, "link": "https://stackoverflow.com/questions/34517898/how-can-i-fill-an-array-with-a-recordset-of-an-unkown-size/34518488#34518488", "title": "How can I fill an array with a recordset of an unkown size?", "body": "<p>This question belongs in Code Review as it's working.  However, one way to do it is thus:  </p>\n\n<pre><code>If Not marginRec.EOF Then\n        ReDim termarray(0)\n        termarray(0) = marginrec.Fields(\"term\")\n        marginRec.MoveNext\nEnd If\nDo Until marginRec.EOF\n    Ut = UBound(termarray)\n    ReDim Preserve termarray(Ut+1)\n    termarray(Ut + 1) = marginrec.Fields(\"term\")\n    marginRec.MoveNext\nLoop\n</code></pre>\n\n<p>Although as you mentioned in your edit, the BEST way would be to dimension it once as redimensioning the array every time takes a lot of time for no real purpose.</p>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1451422156, "creation_date": 1451422156, "answer_id": 34518882, "question_id": 34517898, "link": "https://stackoverflow.com/questions/34517898/how-can-i-fill-an-array-with-a-recordset-of-an-unkown-size/34518882#34518882", "title": "How can I fill an array with a recordset of an unkown size?", "body": "<p>Here is an example of how to populate an array with values of a recordset field:</p>\n\n<pre><code>Option Explicit\n\nSub RecordsetToArray()\n\n    Dim strConnection As String\n    Dim strQuery As String\n    Dim objConnection As Object\n    Dim objRecordSet As Object\n    Dim arrField\n    Dim lngUBound As Long\n    Dim arrData() As String\n    Dim i As Long\n\n    ' connect to this workbook\n    strConnection = _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"User ID=Admin;\" &amp; _\n        \"Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';\" &amp; _\n        \"Mode=Read;\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;\"\";\"\n    ' select all data from sheet1\n    strQuery = _\n        \"SELECT * FROM [Sheet1$];\"\n    ' connect and query\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    objConnection.Open strConnection\n    Set objRecordSet = objConnection.Execute(strQuery)\n    ' convert selected field of the recordset to 2-dimensional array\n    arrField = objRecordSet.GetRows(, , \"ContactName\")\n    objConnection.Close\n    ' get max index of the second dimension\n    lngUBound = UBound(arrField, 2)\n    ' set number of elements of target 1-dimensional array\n    ReDim arrData(lngUBound)\n    ' copy the values from 2d array to target array\n    For i = 0 To lngUBound\n        arrData(i) = arrField(0, i)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><code>Sheet1</code> content, which is the sourse for that test query, is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ArLtO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ArLtO.png\" alt=\"Source1.xlsx\"></a></p>\n\n<p>And the resulting <code>arrData</code> array contains the values from <code>'ContactName'</code> field:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8hjFN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8hjFN.png\" alt=\"arrData content\"></a></p>\n\n<p>It works for me on Excel 2010 64 bit. As you can see, it's necessary to make <code>ReDim</code> only once, and number of elements can be computed by max index of 2-dimensional array, retrieved with <a href=\"https://msdn.microsoft.com/ru-ru/library/ms675120(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>GetRows</code> method</a>.</p>\n"}], "owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2311, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1451422156, "creation_date": 1451417951, "question_id": 34517898, "link": "https://stackoverflow.com/questions/34517898/how-can-i-fill-an-array-with-a-recordset-of-an-unkown-size", "title": "How can I fill an array with a recordset of an unkown size?", "body": "<p>This is what I have right now.  I feel like this can't be the most efficient way, but I'm not sure how to do it without using the function to check if the array is empty for the first element.</p>\n\n<pre><code>marginrec.Open querystr, margincon\n\nDo Until marginrec.EOF\n\n    If Not IsNull(marginrec.Fields(\"term\")) Then\n        If Isarrempty(termarray) Then\n            ReDim termarray(0)\n            termarray(0) = marginrec.Fields(\"term\")\n        Else\n            Ut = UBound(termarray)\n\n            ReDim Preserve termarray(Ut + 1)\n\n            termarray(Ut + 1) = marginrec.Fields(\"term\")\n        End If\n    End If\n\n    marginrec.movenext\nLoop\n</code></pre>\n\n<p>-</p>\n\n<pre><code>Function Isarrempty(ByVal moagg As Variant) As Boolean\n\nDim b As Integer\n\nOn Error Resume Next\n\nb = LBound(moagg)\n\nIf Err.Number &lt;&gt; 0 Then\n    Isarrempty = True\nElse\n    Isarrempty = False\nEnd If\n\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>Edit: I suppose I could count the records of the recordset too and then use one redim statement for that</p>\n"}, {"tags": ["excel", "vba", "date", "sas"], "comments": [{"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 1, "creation_date": 1451419737, "post_id": 34517837, "comment_id": 56777791, "body": "Not sure if the code is expecting a SAS date or Excel date. If the code is supposed to be a SAS variable, you would use &quot;31Oct2015&quot;d as the date format."}, {"owner": {"reputation": 139, "user_id": 2543400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b72e5be06d727b6c8e6a98aa9198305?s=128&d=identicon&r=PG", "display_name": "Dusan Cankovic", "link": "https://stackoverflow.com/users/2543400/dusan-cankovic"}, "reply_to_user": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1451429150, "post_id": 34517837, "comment_id": 56782002, "body": "I&#39;ve tried &#39;31Oct2015&#39;d, which caused an error. I will try tomorrow, when I get to work, double quotes instead of single."}, {"owner": {"reputation": 12195, "user_id": 2734437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bd4e812424e1841ab39b4e2d869517?s=128&d=identicon&r=PG&f=1", "display_name": "DomPazz", "link": "https://stackoverflow.com/users/2734437/dompazz"}, "edited": false, "score": 0, "creation_date": 1451484022, "post_id": 34517837, "comment_id": 56803199, "body": "You can also try converting the date to the number of days from 1/1/1960.    31OCT2015 converts to 20392."}, {"owner": {"reputation": 139, "user_id": 2543400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b72e5be06d727b6c8e6a98aa9198305?s=128&d=identicon&r=PG", "display_name": "Dusan Cankovic", "link": "https://stackoverflow.com/users/2543400/dusan-cankovic"}, "reply_to_user": {"reputation": 12195, "user_id": 2734437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bd4e812424e1841ab39b4e2d869517?s=128&d=identicon&r=PG&f=1", "display_name": "DomPazz", "link": "https://stackoverflow.com/users/2734437/dompazz"}, "edited": false, "score": 0, "creation_date": 1454617323, "post_id": 34517837, "comment_id": 58136891, "body": "@DomPazz, you were right, double quotes are needed. Its not working if you filter it with single quotes, but with double it works. Write that down as answer so I can accept it."}, {"owner": {"reputation": 12195, "user_id": 2734437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bd4e812424e1841ab39b4e2d869517?s=128&d=identicon&r=PG&f=1", "display_name": "DomPazz", "link": "https://stackoverflow.com/users/2734437/dompazz"}, "reply_to_user": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1454679629, "post_id": 34517837, "comment_id": 58165509, "body": "@Reeza had the better answer.  I will let her write the answer and take the credit."}, {"owner": {"reputation": 139, "user_id": 2543400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b72e5be06d727b6c8e6a98aa9198305?s=128&d=identicon&r=PG", "display_name": "Dusan Cankovic", "link": "https://stackoverflow.com/users/2543400/dusan-cankovic"}, "reply_to_user": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1457631877, "post_id": 34517837, "comment_id": 59505428, "body": "@Reeza, Please put your comment as answer. Sorry for late reply :)"}], "owner": {"reputation": 139, "user_id": 2543400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b72e5be06d727b6c8e6a98aa9198305?s=128&d=identicon&r=PG", "display_name": "Dusan Cankovic", "link": "https://stackoverflow.com/users/2543400/dusan-cankovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451417728, "creation_date": 1451417728, "question_id": 34517837, "link": "https://stackoverflow.com/questions/34517837/how-to-filter-date-column-in-sasdataview-object-in-vba-sas-excel-add-in-for-exc", "title": "How to filter date column in SASDataView object in VBA (SAS Excel Add in for Excel 2007)", "body": "<p>I have a UserForm with a button. I want to apply filter to Date_ID field the sheet in workbook that contains a link to SAS dataset on button click. </p>\n\n<p>Format of Date_ID field in SAS dataset is ddmmyy10.\nIn Excel sheet that contains a link to SAS dataset it is displayed as \"31.10.2015\"</p>\n\n<p>Part of UserForm code with declarations:</p>\n\n<pre><code>Public excelSASAddIn As SASExcelAddIn \nPublic datafeed As SASDataView\n\nPrivate Sub UserForm_Initialize() \n\n    Set excelSASAddIn = Application.COMAddIns.Item(\"SAS.ExcelAddIn\").Object \n    Set datafeed = excelSASAddIn.GetDataView(\"SASApp_REPORTS_DATAFEED\") \n\nEnd Sub\n</code></pre>\n\n<p>Button click code:</p>\n\n<pre><code>Private Sub createReportButton_Click()\n    datafeed.Filter = \"Date_ID = 31/10/2015\"\n    datafeed.Refresh\nEnd Sub\n</code></pre>\n\n<p>So, if I hardcode the date I do not get an error but SASDataView object on sheet is filtered to 0 rows, which clearly should not be the case. Also tried hardcoding 10/31/2015</p>\n\n<p>I've tried using something DatePSerial:</p>\n\n<pre><code>Dim dateText As String \n\ndateText = Format(DateSerial(2015, 10, 31), \"dd/MM/yyyy\") \ntopsFlops.Filter = \"Date_ID = \" &amp; dateText\n</code></pre>\n\n<p>but this causes an error because of my regional settings. dateText is \"31.10.2015\" instead of 31/10/2015</p>\n\n<p>I have also tried something like this:</p>\n\n<pre><code>topsFlops.Filter = \"Date_ID &gt;= 31/10/2015 and Date_ID &lt; 01/11/2015\"\n</code></pre>\n\n<p>but this also filters to 0 rows...</p>\n\n<p>I've looked at Help for SASExcel Add-in but there is no example of how to filter date fields, only text fields...</p>\n\n<p>Thanks in advance! Cheers! :)</p>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451417906, "post_id": 34517834, "comment_id": 56776862, "body": "Just use a regular <code>If</code> statement to determine it, I don&#39;t see why you&#39;d need <code>DatedIf</code>."}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 1, "creation_date": 1451418310, "post_id": 34517834, "comment_id": 56777065, "body": "Instead of referring to <code>E:E</code>, select just one cell in the same row to apply it to and make it refer to the same specific row in that column, <code>E1</code> for example. As long as you get rid of any <code>$</code>s that Excel automatically applies, then it will still be a relative reference and you can extend the range it applies to in the &quot;Manage Rules&quot; menu after you have gotten it working for one cell."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1451418414, "post_id": 34517834, "comment_id": 56777115, "body": "I will assume you have titles in the first row.  So in E2 put the following conditional formula: <code>=TODAY() - E2&lt;30</code> then use the formatting desired.  In the applies to fiels put the <code>E:E</code>"}, {"owner": {"reputation": 1878, "user_id": 1551974, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a77c93cd8e78c08b0d08cb81234dcb77?s=128&d=identicon&r=PG", "display_name": "Silve2611", "link": "https://stackoverflow.com/users/1551974/silve2611"}, "edited": false, "score": 0, "creation_date": 1451418614, "post_id": 34517834, "comment_id": 56777213, "body": "It is working but only for Field E2. Not for the other fields."}, {"owner": {"reputation": 1878, "user_id": 1551974, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a77c93cd8e78c08b0d08cb81234dcb77?s=128&d=identicon&r=PG", "display_name": "Silve2611", "link": "https://stackoverflow.com/users/1551974/silve2611"}, "edited": false, "score": 0, "creation_date": 1451419026, "post_id": 34517834, "comment_id": 56777421, "body": "It is not working. It is just always Coloring E2 and E1 I only want the cells to be colored where the dates are in range of 30 days"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1451419089, "post_id": 34517834, "comment_id": 56777447, "body": "Which column contains the values you want colored in?"}, {"owner": {"reputation": 1878, "user_id": 1551974, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a77c93cd8e78c08b0d08cb81234dcb77?s=128&d=identicon&r=PG", "display_name": "Silve2611", "link": "https://stackoverflow.com/users/1551974/silve2611"}, "edited": false, "score": 0, "creation_date": 1451419187, "post_id": 34517834, "comment_id": 56777500, "body": "The Column E contains all Date values. For each Date value entered a check with today should be performed and colored if one of the described rules matches."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1451419725, "creation_date": 1451419725, "answer_id": 34518278, "question_id": 34517834, "link": "https://stackoverflow.com/questions/34517834/conditional-formatting-of-dates-in-excel/34518278#34518278", "title": "Conditional Formatting of Dates in Excel", "body": "<p><a href=\"https://i.stack.imgur.com/qVfSl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qVfSl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I used the following formulas:</p>\n\n<pre><code>=DATEDIF(TODAY(),E2,\"d\")&lt;30\n=DATEDIF(TODAY(),E2,\"d\")&lt;60\n=DATEDIF(TODAY(),E2,\"d\")&lt;90\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1878, "user_id": 1551974, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a77c93cd8e78c08b0d08cb81234dcb77?s=128&d=identicon&r=PG", "display_name": "Silve2611", "link": "https://stackoverflow.com/users/1551974/silve2611"}, "edited": false, "score": 0, "creation_date": 1451420860, "post_id": 34518291, "comment_id": 56778307, "body": "Thx that was exactly what i was searching for. Great explanation!"}], "tags": [], "owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "is_accepted": true, "score": 1, "last_activity_date": 1451419767, "creation_date": 1451419767, "answer_id": 34518291, "question_id": 34517834, "link": "https://stackoverflow.com/questions/34517834/conditional-formatting-of-dates-in-excel/34518291#34518291", "title": "Conditional Formatting of Dates in Excel", "body": "<p>Ok, Excel does some wacky stuff that it thinks is helpful when you're trying to apply conditional formatting to a range (it's usually more of a hindrance than help).</p>\n\n<p>Follow these steps:</p>\n\n<ol>\n<li>Select the first cell with a date value in it, I'm assuming <code>E2</code>.</li>\n<li>Click on Conditional Formatting -> New Rule.</li>\n<li>Select \"Use a formula to determine which cells to format\".</li>\n<li>Paste in the formula <code>=DATEDIF(TODAY(),E2,\"d\")&lt;30</code> and select whatever formatting options you want. Click <code>OK</code>.</li>\n<li>Go back into conditional formatting by clicking on \"Manage Rules\".</li>\n<li>In the Applies to field, change it to <code>=E2:E200</code>, or whatever the last row of the range is. Alternatively you can use a <code>named range</code> if you want to set up something a little more dynamic.</li>\n</ol>\n\n<p>That rule now applies to the whole range.</p>\n"}], "owner": {"reputation": 1878, "user_id": 1551974, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a77c93cd8e78c08b0d08cb81234dcb77?s=128&d=identicon&r=PG", "display_name": "Silve2611", "link": "https://stackoverflow.com/users/1551974/silve2611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1953, "favorite_count": 0, "accepted_answer_id": 34518291, "answer_count": 2, "score": 0, "last_activity_date": 1451419767, "creation_date": 1451417708, "question_id": 34517834, "link": "https://stackoverflow.com/questions/34517834/conditional-formatting-of-dates-in-excel", "title": "Conditional Formatting of Dates in Excel", "body": "<p>I am trying to make conditional formatting for Dates in Excel. \nThe cells should change the color depeding on when the Date is due. \nIf it is due in less than 30 days it should be red. \nIf it is due in less than 60 days it should be yellow.\nIf it is due in less than 90 days it should be green. </p>\n\n<p>If have following Formula <code>=DATEDIF(TODAY();E:E;\"d\")&lt;30</code>as a conditional formatting rule for the start. \nThe strange part is that it works if I have it in a cell. It returns the value true for the values in \"E\" that are due in less than 30 days. However I cannot apply this rule in conditional formatting. It does not give me an error. It simply does nothing...</p>\n\n<p>Can this be solved with conditional formatting or should I write a VBA script? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417507, "post_id": 34517756, "comment_id": 56776701, "body": "Have you tried without <code>fileformat</code>?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417662, "post_id": 34517756, "comment_id": 56776759, "body": "Yes, i tryed <code>.SaveAs strSaveName, 51</code> and error the same"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417781, "post_id": 34517756, "comment_id": 56776802, "body": "lol I meant without that argument at all. Just <code>.SaveAs strSaveName</code>"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418043, "post_id": 34517756, "comment_id": 56776928, "body": "Yes, everething the same error"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418143, "post_id": 34517756, "comment_id": 56776982, "body": "Hmm you must have some data that is ancient or not compatible XD"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418513, "post_id": 34517756, "comment_id": 56777170, "body": "So how to determine this data?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418639, "post_id": 34517756, "comment_id": 56777226, "body": "Good question. I don&#39;t know :/ At least we know <code>.vml</code> is bad."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4429041"}, "is_accepted": true, "score": 1, "last_activity_date": 1451423096, "last_edit_date": 1451423096, "creation_date": 1451420791, "answer_id": 34518536, "question_id": 34517756, "link": "https://stackoverflow.com/questions/34517756/excel-2013-removed-part-xl-drawings-vmldrawing1-vml/34518536#34518536", "title": "Excel 2013 Removed Part: /xl/drawings/vmlDrawing1.vml", "body": "<p>try run this code on your original file</p>\n\n<pre><code>Dim objcomment As Comment\n\n    For Each objcomment In ActiveSheet.Comments\n        With objcomment.shape\n            .top = objcomment.Parent.top\n            .Visible = False\n        End With\n    Next\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2205, "favorite_count": 0, "accepted_answer_id": 34518536, "answer_count": 1, "score": 0, "last_activity_date": 1451423096, "creation_date": 1451417427, "question_id": 34517756, "link": "https://stackoverflow.com/questions/34517756/excel-2013-removed-part-xl-drawings-vmldrawing1-vml", "title": "Excel 2013 Removed Part: /xl/drawings/vmlDrawing1.vml", "body": "<p>After i do this things in Excel 2013</p>\n\n<pre><code>strSaveName = ThisWork.Path &amp; \"\\\" &amp; strExt &amp; \".xlsx\"\n.SaveAs strSaveName, FileFormat:=51\n</code></pre>\n\n<p>Excel gives the following error when opening this xlsx file:\n\"Excel found unreadable content in 'newFile.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.\"</p>\n\n<p>Once I click Yes, I receive the following notice:\n\"Excel was able to open the file by repairing or removing the unreadable content. Removed Part: /xl/drawings/vmlDrawing1.vml part.  (Drawing shape)\"</p>\n\n<p>Also all coments being deleted.</p>\n\n<p>if i save in another format</p>\n\n<pre><code>strSaveName = ThisWork.Path &amp; \"\\\" &amp; strExt &amp; \".xls\"\n.SaveAs strSaveName, FileFormat:=56\n</code></pre>\n\n<p>everithing goes ok instead warning about not supported formulas in excel 2003</p>\n\n<p>How to fix that and save file as xlsx ?</p>\n"}, {"tags": ["vba", "excel", "range", "union"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451415158, "post_id": 34517172, "comment_id": 56775493, "body": "Tangent but why would you set a variable to a syntax word immediately following it XD Edit: so change your for loop to use row and column."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451415539, "post_id": 34517172, "comment_id": 56775676, "body": "Do <i>not</i> use <code>Address</code> as a variable type, as that&#39;s a special &quot;word&quot; in VBA.  Instead do like, <code>myAddress</code> or <code>Adrs</code> or something."}, {"owner": {"reputation": 87, "user_id": 2870775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea491116be841c18bd91407a834f9?s=128&d=identicon&r=PG&f=1", "display_name": "jumpOnCommand", "link": "https://stackoverflow.com/users/2870775/jumponcommand"}, "edited": false, "score": 0, "creation_date": 1451415804, "post_id": 34517172, "comment_id": 56775809, "body": "Point taken RE Address. But what&#39;s this loop to use row and column you mention?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451416001, "post_id": 34517172, "comment_id": 56775920, "body": "If you want it to loop a certain way, code it to loop it exactly that way. Lot more work but if you want it that badly... Edit: you know, with r=1 c=1 then r=r+1 etc"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451416267, "post_id": 34517468, "comment_id": 56776061, "body": "Oooo much smarter than my idea^^"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451417347, "post_id": 34517468, "comment_id": 56776613, "body": "I&#39;m unclear on how this answers the primary (to my mind) point of the original question; to wit: How do I loop through A1, C1, D1, E1, A2, C2, D2, E2, A3?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1451417395, "post_id": 34517468, "comment_id": 56776637, "body": "@Chris I&#39;m trying to use your solution to go by row, but I can&#39;t seem to get it to print out correctly.  Is it working on your side?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417635, "post_id": 34517468, "comment_id": 56776750, "body": "<code>For each Rw in Col.Rows</code> typo I think XD Why doesn&#39;t this work @Jeeped? Edit: oh duh. Wrong way. Row first then column XD"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1451417748, "post_id": 34517468, "comment_id": 56776787, "body": "Ahh.. so sorry. Of course, the original range union was not contiguous, in that it covers more than one area. My solution is a quick &amp; easy one for a contiguous range area. I should have paid more attention to the actual addresses being set up! My solutions works in that it reads horizontally <i>per area</i> - however in the meantime Jeeped below has a solution which handles multiple areas."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417923, "post_id": 34517468, "comment_id": 56776872, "body": "@findwindow - The OP&#39;s union was <b>1</b> range but <b>2</b> areas."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418066, "post_id": 34517468, "comment_id": 56776944, "body": "@Jeeped right. So it would stop at edge of one area?? That seems wrong given that loop is for range....?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1451418463, "post_id": 34517468, "comment_id": 56777142, "body": "@findwindow - Currently the above code is only returning the <code>Rw.Address</code>. Wait for any correction made."}, {"owner": {"reputation": 87, "user_id": 2870775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea491116be841c18bd91407a834f9?s=128&d=identicon&r=PG&f=1", "display_name": "jumpOnCommand", "link": "https://stackoverflow.com/users/2870775/jumponcommand"}, "edited": false, "score": 0, "creation_date": 1451419466, "post_id": 34517468, "comment_id": 56777638, "body": "Thanks for the suggestions. Whilst Jeeped might have the correct answer, I found it to be over complicated for my skill set. I ended up dumbing it down with 2 lines of code:    If Not myAddress.Column = 4 And Not myAddress.Column = 5"}], "tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 2, "last_activity_date": 1451416212, "creation_date": 1451416212, "answer_id": 34517468, "question_id": 34517172, "link": "https://stackoverflow.com/questions/34517172/vba-read-union-range-horizontally/34517468#34517468", "title": "VBA read union range horizontally", "body": "<p>A union of ranges doesn't care in which order the cells are added - whether it's by row or by column. So your original loop to unify the ranges is fine.</p>\n\n<p>If you're concerned about the order in which you read the data, simply read by row or by column accordingly, with an inner and an outer loop. So for example, after you build the range, do as follows:</p>\n\n<pre><code>Dim Col as Variant, Rw as Variant\nFor Each Col in rng.Columns\n    For each Rw in Col.Rows\n        Debug.Print Rw.Address\n    Next Rw\nNext Col\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 5, "last_activity_date": 1451417134, "creation_date": 1451417134, "answer_id": 34517680, "question_id": 34517172, "link": "https://stackoverflow.com/questions/34517172/vba-read-union-range-horizontally/34517680#34517680", "title": "VBA read union range horizontally", "body": "<p>You have to deal with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"noreferrer\">Range.Areas</a> within the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"noreferrer\">Range object</a> created with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"noreferrer\">Union method</a>.</p>\n\n<pre><code>Sub laterally()\n    Dim r As Long, c As Long, a As Long\n    Dim mnRW As Long, mxRW As Long, mnCL As Long, mxCL As Long\n    Dim rng As Range\n\n    With Worksheets(\"Sheet1\")   '&lt;~~ ALWAYS set the worksheet!\n        Set rng = Union(.Range(\"A1:A3\"), .Range(\"C1:E2\"))\n        Debug.Print rng.Address(0, 0)\n        mnRW = Rows.Count: mxRW = 0\n        mnCL = Columns.Count: mxCL = 0\n        With rng\n            For a = 1 To .Areas.Count\n                With .Areas(a)\n                    mnRW = Application.Min(mnRW, .Rows(1).Row)\n                    mxRW = Application.Max(mxRW, .Rows(.Rows.Count).Row)\n                    mnCL = Application.Min(mnCL, .Columns(1).Column)\n                    mxCL = Application.Max(mxCL, .Columns(.Columns.Count).Column)\n                End With\n            Next a\n            For r = mnRW To mxRW\n                For c = mnCL To mxCL\n                    If Not Intersect(.Cells, .Parent.Cells(r, c)) Is Nothing Then _\n                        Debug.Print .Parent.Cells(r, c).Address(0, 0)\n                Next c\n            Next r\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>After collecting the extents of the unioned range, each possible cell is looped through and the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195772(v=office.11).aspx\" rel=\"noreferrer\">Intersect method</a> is used to determine whether it belongs in the union or not.</p>\n"}, {"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1451431699, "creation_date": 1451431699, "answer_id": 34520732, "question_id": 34517172, "link": "https://stackoverflow.com/questions/34517172/vba-read-union-range-horizontally/34520732#34520732", "title": "VBA read union range horizontally", "body": "<p>Just thought this might be an interesting addition to Chris' solution?\n(I changed the range slightly to highlight some of the advantages)</p>\n\n<pre><code>Dim Rng As Range, Col As Variant, Rw As Variant\n\nSet Rng = Application.Union(Range(\"A3:A5\"), Range(\"C2:E4\"))\nFor Each Rw In ActiveSheet.UsedRange.Rows\n    For Each Col In Rw.Columns\n        If Not Intersect(Col, Rng) Is Nothing Then Debug.Print Intersect(Col, Rng).Address\n    Next Col\nNext Rw\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 2870775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea491116be841c18bd91407a834f9?s=128&d=identicon&r=PG&f=1", "display_name": "jumpOnCommand", "link": "https://stackoverflow.com/users/2870775/jumponcommand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1451431699, "creation_date": 1451415060, "question_id": 34517172, "link": "https://stackoverflow.com/questions/34517172/vba-read-union-range-horizontally", "title": "VBA read union range horizontally", "body": "<p>I'm trying to combine the values in a range of cells. I created a range as follows:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Application.Union(Range(\"A1:A3\"), Range(\"C1:E2\"))\nFor Each Address In rng\nDebug.Print Address.Address\nNext\n</code></pre>\n\n<p>I want to read the cells in horizontal order: A1,C1,D1,E1,A2,C2... etc.\nBut instead they're being read A1,A2,A3,C1,C2,.. etc</p>\n\n<p>How can I read them horizontally?\nThanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451413720, "post_id": 34516826, "comment_id": 56774722, "body": "You&#39;ve been here long enough to know you have to show effort."}, {"owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451414106, "post_id": 34516826, "comment_id": 56774934, "body": "sorry about that, I really did figure out the answer just after I submitted the question"}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "is_accepted": false, "score": 0, "last_activity_date": 1451414263, "creation_date": 1451414263, "answer_id": 34516997, "question_id": 34516826, "link": "https://stackoverflow.com/questions/34516826/find-sample-points-on-a-path-defined-by-two-points/34516997#34516997", "title": "Find sample points on a path defined by two points", "body": "<p>1- Calculate distance between the two points\n2- Calculate bearing between the two points\n3- Divide the distance by the number of samples needed\n4- Find each new destination (sample) point by incrementing the distance calculated in step 3</p>\n\n<p>All functions are here</p>\n\n<p><a href=\"http://www.movable-type.co.uk/scripts/latlong.html\" rel=\"nofollow\">http://www.movable-type.co.uk/scripts/latlong.html</a></p>\n"}], "owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1451414263, "creation_date": 1451413649, "question_id": 34516826, "link": "https://stackoverflow.com/questions/34516826/find-sample-points-on-a-path-defined-by-two-points", "title": "Find sample points on a path defined by two points", "body": "<p>I have a path defined by two points (lat, long), I want to make a list of points on this path and between two points.</p>\n\n<p>For example, if the two defining points are 100 meters far, I want a list of the points between them each 1 meter away from the other.</p>\n"}, {"tags": ["vba", "scripting.dictionary"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451418114, "post_id": 34516778, "comment_id": 56776967, "body": "You have got two different variables <code>riskDict</code> and <code>riskGroupDict</code>, is that right? It&#39;s not clear since you didn&#39;t share the whole code."}, {"owner": {"reputation": 1163, "user_id": 1922531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e769863339f1549a63fc5cb37637676?s=128&d=identicon&r=PG&f=1", "display_name": "lukehawk", "link": "https://stackoverflow.com/users/1922531/lukehawk"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451418231, "post_id": 34516778, "comment_id": 56777021, "body": "Youre right, but i simply grabbed the wrong chunk of code. I fixed my question, but thanks for the heads up!"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451418450, "post_id": 34516778, "comment_id": 56777135, "body": "Could you please post the whole <code>For Each</code> loop code. Note that just referencing to an item of a dictionary adds new element if it isn&#39;t present, without invoking <code>Add</code> method."}, {"owner": {"reputation": 1163, "user_id": 1922531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e769863339f1549a63fc5cb37637676?s=128&d=identicon&r=PG&f=1", "display_name": "lukehawk", "link": "https://stackoverflow.com/users/1922531/lukehawk"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451418683, "post_id": 34516778, "comment_id": 56777251, "body": "I can, but i do not feel like it has anything to do with the problem. The problem happens BEFORE the loop ever starts. It will be alittle bit before i can get back to my desk."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1451423884, "post_id": 34516778, "comment_id": 56779617, "body": "Is <code>riskDict</code> a global variable?"}], "answers": [{"tags": [], "owner": {"reputation": 1291, "user_id": 339789, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/05f9b75e471ad188fe9f103a3faffdf0?s=128&d=identicon&r=PG", "display_name": "Nightforce2", "link": "https://stackoverflow.com/users/339789/nightforce2"}, "is_accepted": false, "score": 0, "last_activity_date": 1492111307, "creation_date": 1492111307, "answer_id": 43400168, "question_id": 34516778, "link": "https://stackoverflow.com/questions/34516778/vba-extra-key-item-pairs-in-scripting-dictionary/43400168#43400168", "title": "VBA Extra key/item pairs in scripting.dictionary", "body": "<p>Make riskDict private or clear your array before using it. Hard to tell what your doing with it since there is critical elements missing.</p>\n\n<pre><code>Dim riskDict As New Scripting.Dictionary\n</code></pre>\n"}], "owner": {"reputation": 1163, "user_id": 1922531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e769863339f1549a63fc5cb37637676?s=128&d=identicon&r=PG&f=1", "display_name": "lukehawk", "link": "https://stackoverflow.com/users/1922531/lukehawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492111307, "creation_date": 1451413452, "last_edit_date": 1451418197, "question_id": 34516778, "link": "https://stackoverflow.com/questions/34516778/vba-extra-key-item-pairs-in-scripting-dictionary", "title": "VBA Extra key/item pairs in scripting.dictionary", "body": "<p>This code was working for several days, looping through a dictionary just fine. The loop started breaking, and I have extra keys in the dictionary and I have no idea where they came from. </p>\n\n<p>I am creating a scripting.dictionary with the following:</p>\n\n<pre><code>Dim riskDict As New Scripting.Dictionary\n</code></pre>\n\n<p>After which, the object is empty, as seen in the watch:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EjwbI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EjwbI.png\" alt=\"enter image description here\"></a></p>\n\n<p>I then add my first key/item pair:</p>\n\n<pre><code>riskDict.Add \"Weight\", Array(\"WP\", 0)\n</code></pre>\n\n<p>And after running this one line of code, I now have this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gY8ZH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gY8ZH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where did these two extra keys (Item 2 and 3) come from?! This is a problem, since later in my code I use:</p>\n\n<pre><code>For Each key In riskDict\n    temp = riskDict(key)\n    ...\nNext key\n</code></pre>\n\n<p>And this loop breaks, since it starts referring to keys which are empty. This does not seem to have been happening until just now, and the code has been running fine for a few days. (I changed some things elsewhere in the code, but completely unrelated to this.)</p>\n\n<p>Let me know if I am doing anything ridiculous, or missing something obvious, and thanks!</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451413436, "post_id": 34516594, "comment_id": 56774572, "body": "<code>If InStr(olMail.Subject, &quot;n&quot;) &lt;&gt; 0 Then</code> try without the <code>&quot;&quot;</code> around n?"}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451417688, "post_id": 34516594, "comment_id": 56776770, "body": "@findwindow Tried that...   Set Fldr = olNs.GetDefaultFolder(&quot;Test1&quot; as OlDefaultFolders) is giving error"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451418944, "post_id": 34516594, "comment_id": 56777374, "body": "I am not too familiar with outlook methods XD I presume you have <code>test1</code> as a folder?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451420353, "post_id": 34516594, "comment_id": 56778082, "body": "Drop the <code>as OlDefaultFolders</code> so it&#39;s just <code>Set Fldr = olNs.GetDefaultFolder(&quot;Test1&quot;)</code> assuming you have such folder. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866724.aspx\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451480509, "post_id": 34516594, "comment_id": 56801301, "body": "@findwindow ....Thanks for your responses... Tried this as well but its not working... now its saying &#39;Type mismatch&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1452619861, "post_id": 34522942, "comment_id": 57246040, "body": "Hi Eric Legault, sorry for the delayed response. Could you please elaborate as to how I can implement in this program.... Thanks,"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1452622543, "post_id": 34522942, "comment_id": 57247727, "body": "Can you be more specific? Did you review the article in the link I provided?  Which mechanism makes sense for your solution? Do you have any questions about any of the specific approaches?"}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1453220328, "post_id": 34522942, "comment_id": 57501474, "body": "Hi Eric, I am not well versed in this. But still wanted to work on this. However, when I visited the link you gave, i felt confusing. Hence requesting you to help on this."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1453224949, "post_id": 34522942, "comment_id": 57504449, "body": "Is the problem mainly trying to get a reference to the items in the &quot;Test1&quot; folder?  If so, you can&#39;t use GetDefaultFolder - that only works with the default folders.  If &quot;Test1&quot; is under the Inbox, then go ahead and use GetDefaultFolder to get the Inbox folder as a myInboxFolder variable (Folder object), then call Set myTestFolder = myInboxFolder.Folders(&quot;Test&quot;).  If the &quot;Test1&quot; folder is under a folder at the root, then get the root folder from myInboxFolder.Parent, then &quot;walk&quot; the Folders collection until you get the folder you need.  Does this help?"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1451450036, "creation_date": 1451450036, "answer_id": 34522942, "question_id": 34516594, "link": "https://stackoverflow.com/questions/34516594/unable-to-search-for-mails-based-on-subject/34522942#34522942", "title": "Unable to search for Mails based on subject", "body": "<p>You cannot use GetDefaultFolder for anything but, well - the default folders (Inbox, Contacts, Calendar, etc.).  To get a specific folder you need know the folder's EntryID and use NameSpace.GetFolderFromID or \"walk\" through Folders collections from a specific root Folder object (e.g. myInboxFolderObject.Folders(\"MyInboxSubFolder\").</p>\n\n<p>Also see \"<a href=\"https://msdn.microsoft.com/EN-US/library/ff869362.aspx\" rel=\"nofollow\">Enumerating, Searching, and Filtering Items in a Folder</a>\".</p>\n"}], "owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451450036, "creation_date": 1451412750, "question_id": 34516594, "link": "https://stackoverflow.com/questions/34516594/unable-to-search-for-mails-based-on-subject", "title": "Unable to search for Mails based on subject", "body": "<p>I am trying to search for mails in Outlook based on the list mentioned in a column in the Excel sheet. Below is the code in VBA which I have written. But its not working. Please help:</p>\n\n<pre><code>    Sub Test()\n\nDim olApp As Outlook.Application\nDim olNs As Namespace\nDim Fldr As MAPIFolder\nDim olMail As Variant\nDim i As Integer\nDim rng As Range\nDim n As Variant\n\n\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(\"Test1\" as OlDefaultFolders)\n'Set rng = [D3:D10]\nn = Cells(4, 4).Value\n'For Each n In rng\n'i = Int(n)\n\n'Cells(i, 10).Text = Cells(i, 4).Text\nFor Each olMail In Fldr.Items\nIf InStr(olMail.Subject, \"n\") &lt;&gt; 0 Then\nCells(3, 4).Offset(0, 1).Value = \"Y\"\nElse\nCells(3, 4).Offset(0, 1).Value = \"N\"\nEnd If\n\n\nNext olMail\n\n'Next n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1451425470, "post_id": 34517692, "comment_id": 56780346, "body": "When I ran this code, it gave me run time error: &quot;specified value is out of range&quot; and highlighted the <code>If strTitle &lt;&gt; shp.TextFrame.TextRange.Text Then</code> line. Any ideas what that could be?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1451425557, "post_id": 34517692, "comment_id": 56780387, "body": "Perhaps shp.TextFrame.TextRange is empty?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1451425725, "post_id": 34517692, "comment_id": 56780489, "body": "Or the TextFrame itself is empty?  I&#39;d try examining the Shape to see where the problem is."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1451417189, "creation_date": 1451417189, "answer_id": 34517692, "question_id": 34516533, "link": "https://stackoverflow.com/questions/34516533/add-period-to-entire-ppt-besides-titles-using-vba/34517692#34517692", "title": "Add period to entire PPT besides Titles using VBA", "body": "<p>The easiest way I found to do this is:</p>\n\n<pre><code>Sub AddPeriod()\n\n    Dim sld As Slide\n    Dim shp As Shape\n    Dim strTitle As String\n\n    For Each sld In ActivePresentation.Slides\n        If sld.Shapes.HasTitle = True Then 'check if there is a title\n            strTitle = sld.Shapes.Title.TextFrame.TextRange.Text\n        Else\n            strTitle = \"\"\n        End If\n        For Each shp In sld.Shapes\n            'add periods only if text of shape is not equal to title text.\n            If strTitle &lt;&gt; shp.TextFrame.TextRange.Text Then\n                 shp.TextFrame.TextRange.AddPeriods\n            End If\n        Next shp\n    Next sld\n\nEnd Sub\n</code></pre>\n\n<p>This will check the text of the title vs. the text of your shape.  If they are the same, it will not add the periods.  Perhaps there is some sort of indicator on the shape that states whether the shape is the title, but I couldn't find it.  You need to check to make sure the slide has a title, otherwise getting the string from the text of the title shape will cause an error.</p>\n"}], "owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 34517692, "answer_count": 1, "score": 1, "last_activity_date": 1451417189, "creation_date": 1451412472, "question_id": 34516533, "link": "https://stackoverflow.com/questions/34516533/add-period-to-entire-ppt-besides-titles-using-vba", "title": "Add period to entire PPT besides Titles using VBA", "body": "<p>Is there a way to add periods to the whole PowerPoint presentation excluding the titles of each slide? </p>\n\n<p>I currently am using the below code which puts a period after everything: </p>\n\n<pre><code>Sub AddPeriod()\n\nDim sld As Slide\nDim shp As Shape\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n        shp.TextFrame.TextRange.AddPeriods\n    Next shp\nNext sld\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451412684, "post_id": 34516486, "comment_id": 56774215, "body": "I fail to see where <code>UNIT</code> is assigned a value before being compared to the returned value from the VLookup."}, {"owner": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "edited": false, "score": 0, "creation_date": 1451412865, "post_id": 34516486, "comment_id": 56774312, "body": "Im just comparing the unit for now excluding the value"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1451413227, "post_id": 34516486, "comment_id": 56774479, "body": "I&#39;ll try to be clearer; UNIT is nothing and cannot be compared to the result of a formula."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1451578722, "post_id": 34516486, "comment_id": 56839896, "body": "Accept answers then ask a new question. <a href=\"http://meta.stackexchange.com/questions/92107/is-stack-overflow-a-forum\" title=\"is stack overflow a forum\">meta.stackexchange.com/questions/92107/&hellip;</a>  &quot;Stack Overflow is not a forum. Forums are largely discussion-based and tend to follow less strict rules about what posts can be like.  On Stack Overflow (and Stack Exchange in general), we require every new thread to be started with a question and every response to that question to be an attempt at answering it.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "edited": false, "score": 0, "creation_date": 1451500887, "post_id": 34516931, "comment_id": 56812114, "body": "Thank You. I slightly modified the code as mentioned below as the vlookup didnt work as the attrID and UNIT didn&#39;t increment. It works now. Need help for the updated scenario"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1451414000, "creation_date": 1451414000, "answer_id": 34516931, "question_id": 34516486, "link": "https://stackoverflow.com/questions/34516486/vlookup-in-excel-vba-not-working/34516931#34516931", "title": "VLookup in Excel vba not working", "body": "<p>When cycling through the I and J loops, you need to set <strong>UNIT</strong> to something before you can compare it to the results passed back from the worksheet <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow\">VLOOKUP function</a>.</p>\n\n<pre><code>Sub UnitCheck()\n    Dim AttrIDrange As Range, AttrIDcell As Range\n    Dim attrID\n    Dim Lookup_Range As Range\n    Dim I As Long, J As Long\n    Dim UNIT As Variant\n    Dim bCHECK_P1\n\n    With Worksheets(\"Sheet4\")\n        bCHECK_P1 = False\n        Set Lookup_Range = .Range(\"A2:B4\")\n        Set AttrIDrange = .Range(\"E1:G1\")\n\n        For Each AttrIDcell In AttrIDrange  '.Range(\"E1:G1\")\n            attrID = AttrIDcell.Value\n\n            For I = 2 To 3\n                UNIT = AttrIDcell.Offset(I - 1, 0).Value  '&lt;~~ set UNIT here!\n                For J = 5 To 7\n                    .Cells(I, J).Font.Color = xlAutomatic\n                    If Application.WorksheetFunction.VLookup(attrID, Lookup_Range, 2, False) = UNIT Then\n                        .Cells(I, J).Font.Color = vbGreen\n                    Else\n                         .Cells(I, J).Font.Color = vbRed\n                    End If\n                Next\n            Next\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "edited": false, "score": 0, "creation_date": 1451500948, "post_id": 34517605, "comment_id": 56812145, "body": "Thank you. Need help for the updated scenario. [Img 2][2]  [2]: <a href=\"http://i.stack.imgur.com/2Icc1.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/2Icc1.png</a>"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "edited": false, "score": 0, "creation_date": 1451505790, "post_id": 34517605, "comment_id": 56814517, "body": "@Renee Ok, I updated my answer per the new scenario 2."}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 0, "last_activity_date": 1451506015, "last_edit_date": 1451506015, "creation_date": 1451416775, "answer_id": 34517605, "question_id": 34516486, "link": "https://stackoverflow.com/questions/34516486/vlookup-in-excel-vba-not-working/34517605#34517605", "title": "VLookup in Excel vba not working", "body": "<p>Here's something that I think does what the OP is asking. Also, this replaces the triple <code>For/next</code> and VLookUp with a dictionary which is hopefully more amenable.</p>\n\n<p>In regard to the OP, I see two fundamental problems, UNIT is never assigned, but also, it sounds like the <code>=</code> operator isn't correct... instead, it sounds like a lookup value must be confirmed present in a comma separated string. The code below uses <code>InStr</code> to check if the lookup value is present.</p>\n\n<pre><code>Sub UnitCheck()\nApplication.ScreenUpdating = False\n\nDim UNIT As String\nDim R, c, AttrID   As Integer\nDim ProdRange, ProdCell As Range\nSet ProdRange = Range(\"E2:G4\")\n\n'Assign LookUp values to array\nDim LookUpArray(), ProdAttrIDArray() As Variant\nLookUpArray = Range(\"A2:B4\").Value2\n\n'Create dictionary from Lookup values\nSet D = CreateObject(\"Scripting.Dictionary\")\nFor R = 1 To UBound(LookUpArray)\n    D.Add LookUpArray(R, 1), LookUpArray(R, 2)\nNext\n\n'Loop through product table\nFor Each ProdCell In ProdRange\n    'Get attribute ID from row 1 of corresponding column\n    AttrID = Cells(1, ProdCell.Column).Value2\n    If D(AttrID) &lt;&gt; Empty Then\n        'If AttrID found in LookUp Dictionary then get UNIT from it\n        UNIT = D(AttrID)\n        'If UNIT found in product cell then color cell green, else red\n        If (InStr(1, ProdCell.Value2, UNIT) &gt; 0) Then\n            ProdCell.Interior.Color = vbGreen\n        Else\n            ProdCell.Interior.Color = vbRed\n        End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The result is this </p>\n\n<p><a href=\"https://i.stack.imgur.com/Oww85.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Oww85.png\" alt=\"enter image description here\"></a></p>\n\n<h2>New Scenario</h2>\n\n<p>Ok, I think this will cover your new scenario. Notice that I also added <code>Trim()</code> and <code>VBTextCompare</code> so that spaces are ignored and the comparison is case-insensitive. I'm not sure if you want that behavior or not. Also, notice that the order of units does not matter. For example, \"IN,   km\" matches \"KM, IN\" because the spaces are ignored, capitalization is ignored, and the order is ignored. </p>\n\n<pre><code>Sub UnitCheck()\n    Application.ScreenUpdating = False\n\n    Dim UNIT, PUnits() As String\n    Dim r, c, AttrID, i, n As Integer\n    Dim ProdRange, ProdCell As Range\n    Set ProdRange = Range(\"E2:G3\")\n\n    'Assign LookUp values to array\n    Dim LookUpArray(), ProdAttrIDArray() As Variant\n    LookUpArray = Range(\"A2:B4\").Value2\n\n    'Create dictionary from Lookup values\n    Set D = CreateObject(\"Scripting.Dictionary\")\n    For r = 1 To UBound(LookUpArray)\n        D.Add LookUpArray(r, 1), LookUpArray(r, 2)\n    Next\n\n    'Loop through product table\n    For Each ProdCell In ProdRange\n        'Get attribute ID from row 1 of correspdniong column\n        AttrID = Cells(1, ProdCell.Column).Value2\n        If D(AttrID) &lt;&gt; Empty Then\n            'If AttrID found in LoopUp Dictionary then get UNIT from it\n            UNIT = D(AttrID)\n            PUnits = Split(ProdCell.Value2, \",\")\n            'reset counter\n            n = 0\n            'Count the number of product units found in the lookup value\n            For i = 0 To UBound(PUnits)\n                If InStr(1, Trim(UNIT), Trim(PUnits(i)), vbTextCompare) &gt; 0 Then\n                    n = n + 1\n                End If\n            Next\n            'prevent division by zero\n            If i = 0 Then i = 1\n            'select action based on percent matched\n            Select Case n / i\n                Case Is &gt;= 1\n                    ProdCell.Interior.Color = vbGreen\n                Case Is &gt; 0\n                     ProdCell.Interior.Color = vbYellow\n                Case Else\n                    ProdCell.Interior.Color = vbRed\n            End Select\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9vWSd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9vWSd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 67, "user_id": 2757053, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5e829807ed142a215886755876ce319d?s=128&d=identicon&r=PG&f=1", "display_name": "Renee", "link": "https://stackoverflow.com/users/2757053/renee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 34517605, "answer_count": 2, "score": 0, "last_activity_date": 1451506015, "creation_date": 1451412290, "last_edit_date": 1451501482, "question_id": 34516486, "link": "https://stackoverflow.com/questions/34516486/vlookup-in-excel-vba-not-working", "title": "VLookup in Excel vba not working", "body": "<p><a href=\"http://i.stack.imgur.com/8RX03.png\" rel=\"nofollow\">Excel File Format</a></p>\n\n<p>I have master data table with attribute ID which is unique and unit.\nI have another table where I add the product values associated with the attributes.</p>\n\n<p>If the units match based on the attribute ID, then the cells are highlighted in green else red.</p>\n\n<p>To achieve the above, I have written some basic code, but it doesn't seem to work. The vlookup works normally but using vba it just exits.  Please see image for example and code below. Column a and b contains attribute master data and column d to g contain product attribute values. </p>\n\n<p>Eg. For product p1, value 'IN' is valid for attribute 'A1' but 'm' is not valid.\nAlso, there can be multiple units separated by comma for each attribute. Need help to solve issue.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub UnitCheck()\n\n\nDim AttrIDrange As range, AttrIDcell As range\nDim attrID\nDim Lookup_Range As range\nDim I, J As Variant\nDim UNIT As Variant\nSet Lookup_Range = range(\"A2:B4\")\n\nSet AttrIDrange = range(\"E1:G1\")\n\n\nFor Each AttrIDcell In AttrIDrange\nattrID = AttrIDcell.Value\n\n\nFor I = 2 To 3\nFor J = 5 To 7\n\nIf Application.WorksheetFunction.VLookup(attrID, Lookup_Range, 2, False) = UNIT Then\n    Worksheets(\"Sheet4\").Cells(I, J).Font.Color = vbGreen\n\n    Else\n     Worksheets(\"Sheet4\").Cells(I, J).Font.Color = vbRed\n    End If\nNext\nNext\nNext\n\nEnd Sub\n</code></pre>\n\n<p><strong>New Scenario:</strong>\nIf there are multiple units defined for any attribute, then even if only 1 of the unit is present in the product value, it should be highlighed in green. If 1 is correct and rest are incorrect then since it is partially correct, it should be highlighted in red or even yellow. Please see image. Need help for this scenario.</p>\n\n<p><a href=\"http://i.stack.imgur.com/8RX03.png\" rel=\"nofollow\">Scenario 2 Image</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451412705, "post_id": 34516441, "comment_id": 56774228, "body": "You can set dynamic range for copying. Look up how to find last row. Edit: clever may be using some combination of index/match/max."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 5570224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da36adbad820ad8ebd2d051908afd135?s=128&d=identicon&r=PG&f=1", "display_name": "Will F", "link": "https://stackoverflow.com/users/5570224/will-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1451416891, "last_edit_date": 1451416891, "creation_date": 1451416500, "answer_id": 34517552, "question_id": 34516441, "link": "https://stackoverflow.com/questions/34516441/vba-extract-top-x-entries-from-each-category/34517552#34517552", "title": "VBA: Extract Top &#39;x&#39; Entries from each category", "body": "<p>Something like this should work:</p>\n\n<pre><code>Sub TopValues()\n\nDim sht As Worksheet\nDim StartCell As Range\n\nSet sht = Worksheets(\"Sheet1\")\nSet StartCell = Range(\"A1\")\n\nSet SrcRange = StartCell.CurrentRegion\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"Data\"\nFor i = 1 To 3\n    SrcRange.Sort Key1:=Worksheets(\"Sheet1\").Range(\"A1\").Offset(0, i - 1), Order1:=xlAscending, Header:=xlYes\n    sht.Rows(\"2:3\").EntireRow.Copy\n    Worksheets(\"Data\").Activate\n    ActiveSheet.Range(\"A\" &amp; 2 * i).PasteSpecial\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>The <code>Rows(\"2:3\")</code> and <code>Range(\"A\" &amp; 2 * i)</code> reflect your x value, which you said was 2 in this example. So the vba copies rows <code>2:3</code> and pastes them in row <code>2*i</code> in the new sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 545, "user_id": 5153314, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/415756f4f855b1714664a19d2e748a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Will T-E", "link": "https://stackoverflow.com/users/5153314/will-t-e"}, "edited": false, "score": 0, "creation_date": 1451482870, "post_id": 34517990, "comment_id": 56802582, "body": "I hadn&#39;t considered it was possible without VBA, and your Excel code absolutely works. I am trying to dissect and understand it, however, so I can apply and adjust it to my real problem. I do not understand how code like like this works <code>=MATCH(0,INDEX(COUNTIF($B$3:$B3,Sheet1!$B$2:$B$15),),0)</code> - particularly, how does an Index function work without a row number? I have googled it without luck. Many many thanks for your incredible response."}, {"owner": {"reputation": 545, "user_id": 5153314, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/415756f4f855b1714664a19d2e748a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Will T-E", "link": "https://stackoverflow.com/users/5153314/will-t-e"}, "edited": false, "score": 0, "creation_date": 1451483182, "post_id": 34517990, "comment_id": 56802755, "body": "The VBA works great too, I am going to try and dissect that as well."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 545, "user_id": 5153314, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/415756f4f855b1714664a19d2e748a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Will T-E", "link": "https://stackoverflow.com/users/5153314/will-t-e"}, "edited": false, "score": 0, "creation_date": 1451487994, "post_id": 34517990, "comment_id": 56805320, "body": "Index without a row number returns an array of values.  In that particular case, it returns an array of countif results with each argument being the count of values in <code>$B$3:$B3</code> (that range will extend as the formula is copied down) and it is looking for all items from <code>Sheet1!$B$2:$B$15</code>, and then the Match is looking at that countif array and specifically matching 0&#39;s.  It is a way of ensuring only unique values get placed in the list to avoid duplicates."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1451418360, "creation_date": 1451418360, "answer_id": 34517990, "question_id": 34516441, "link": "https://stackoverflow.com/questions/34516441/vba-extract-top-x-entries-from-each-category/34517990#34517990", "title": "VBA: Extract Top &#39;x&#39; Entries from each category", "body": "<p>Does this have to be VBA? It can be done with formulas.</p>\n\n<p>Based on your provided sample data, you could setup Sheet2 like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CTesP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CTesP.jpg\" alt=\"tigeravatar example for Will T-E\"></a></p>\n\n<p>In cell A4 and copied down is this formula:</p>\n\n<pre><code>=IF($C4=\"\",\"\",INDEX(Sheet1!$A$2:$A$15,MATCH(1,INDEX((Sheet1!$B$2:$B$15=$B4)*(Sheet1!$C$2:$C$15=$C4)*(COUNTIFS($A$3:$A3,Sheet1!$A$2:$A$15,$B$3:$B3,$B4)=0),),0)))\n</code></pre>\n\n<p>In cell B4 and copied down is this formula:</p>\n\n<pre><code>=IF(($B$1&gt;0)*COUNT($B$1),IF(OR($B3=\"Group\",COUNTIF($B$3:$B3,$B3)=$B$1),IFERROR(INDEX(Sheet1!$B$2:$B$15,MATCH(0,INDEX(COUNTIF($B$3:$B3,Sheet1!$B$2:$B$15),),0)),\"\"),$B3),\"\")\n</code></pre>\n\n<p>In cell C4 and copied down is this formula:</p>\n\n<pre><code>=IF(OR($B4=\"\",COUNTIF(Sheet1!$B$2:$B$15,$B4)&lt;COUNTIF($B$4:$B4,$B4)),\"\",LARGE(INDEX(Sheet1!$C$2:$C$15*(Sheet1!$B$2:$B$15=$B4),),COUNTIF($B$4:$B4,$B4)))\n</code></pre>\n\n<p>Note that you can copy those formulas down quite a ways, and it will only show desired results.  Extra rows will simply be blank.  You can also change the number in cell B1 to be whatever the number of top entries to be, so you could see top 5 per category, or top 3, etc.</p>\n\n<p>However, if it absolutely must be VBA, then something like this should work for you.  It's not simple, but it is very efficient and flexible.  All you would need to do is update <code>lNumTopEntries</code>, your sheetnames, and where your data is located for the <code>Set rngData</code> line:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rngData As Range\n    Dim rngFound As Range\n    Dim rngUnqGroups As Range\n    Dim GroupCell As Range\n    Dim lCalc As XlCalculation\n    Dim aResults() As Variant\n    Dim aOriginal As Variant\n    Dim lNumTopEntries As Long\n    Dim i As Long, j As Long, k As Long\n\n    'Change to grab the top X number of entries per category'\n    lNumTopEntries = 2\n\n    Set wsData = ActiveWorkbook.Sheets(\"Sheet1\")    'This is where your data is'\n    Set wsDest = ActiveWorkbook.Sheets(\"Sheet2\")    'This is where you want to output it'\n\n    Set rngData = wsData.Range(\"A1\", wsData.Cells(Rows.Count, \"C\").End(xlUp))\n    aOriginal = rngData.Value   'Store original values so you can set them back later'\n\n    'Turn off calculation, events, and screenupdating'\n    'This allows code to run faster and prevents \"screen flickering\"'\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    'If there are any problems with the code, make sure the calculation, events, and screenupdating get turned back on'\n    On Error GoTo CleanExit\n\n    With rngData\n        .Sort .Resize(, 1).Offset(, 1), xlAscending, .Resize(, 1).Offset(, 2), , xlDescending, Header:=xlYes\n    End With\n\n    With rngData.Resize(, 1).Offset(, 1)\n        .AdvancedFilter xlFilterInPlace, , , True\n        Set rngUnqGroups = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        .Parent.ShowAllData 'Remove the filter\n\n        ReDim aResults(1 To rngUnqGroups.Cells.Count * lNumTopEntries, 1 To 3)\n        i = 0\n\n        For Each GroupCell In rngUnqGroups\n            Set rngFound = .Find(GroupCell.Value, .Cells(.Cells.Count))\n            k = 0\n            If Not rngFound Is Nothing Then\n                For j = i + 1 To i + lNumTopEntries\n                    If rngFound.Offset(j - i - 1).Value = GroupCell.Value Then\n                        k = k + 1\n                        aResults(j, 1) = rngFound.Offset(j - i - 1, -1).Value\n                        aResults(j, 2) = rngFound.Offset(j - i - 1).Value\n                        aResults(j, 3) = rngFound.Offset(j - i - 1, 1).Value\n                    End If\n                Next j\n                i = i + k\n            End If\n        Next GroupCell\n    End With\n\n    'Output results'\n    wsDest.Range(\"A2\").Resize(UBound(aResults, 1), UBound(aResults, 2)).Value = aResults\n\nCleanExit:\n    'Turn calculation, events, and screenupdating back on'\n    With Application\n        .Calculation = lCalc\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    If Err.Number &lt;&gt; 0 Then\n        'There was an error, show the error'\n        MsgBox Err.Description, , \"Error: \" &amp; Err.Number\n        Err.Clear\n    End If\n\n    'Put data back the way it was\n    rngData.Value = aOriginal\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 5153314, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/415756f4f855b1714664a19d2e748a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Will T-E", "link": "https://stackoverflow.com/users/5153314/will-t-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7239, "favorite_count": 0, "accepted_answer_id": 34517990, "answer_count": 2, "score": 2, "last_activity_date": 1527146563, "creation_date": 1451412089, "question_id": 34516441, "link": "https://stackoverflow.com/questions/34516441/vba-extract-top-x-entries-from-each-category", "title": "VBA: Extract Top &#39;x&#39; Entries from each category", "body": "<p>By way of simplified example, say you have the following dataset: </p>\n\n<pre><code> A      B     C\nName  Group Amount\nDave    A     2\nMike    B     3\nAdam    C     4\nCharlie A     2\nEdward  B     5\nFiona   B     5\nGeorgie A     4\nHarry   C     1\nMary    A     0\nDelia   A     0\nVictor  B     1\nDennis  B     0\nErica   A     4\nWill    B     4\n</code></pre>\n\n<p>I'm trying to extract the highest 'x' entries (let's say 2 in this example) from each group. </p>\n\n<p>For example, the highest two entries in Group A are Georgie and Erica with 4. I also then want the highest two entries for Group B and C. </p>\n\n<p>I want the VBA code to extract these rows and paste them on another worksheet for subsequent analysis. </p>\n\n<p>I have tried code like this so far: </p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n    (\"C1\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nActiveSheet.Range(\"$A$1:$C$15\").AutoFilter Field:=2, Criteria1:=\"A\"\nRange(\"A5:C6\").Select\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\nSheets(\"Sheet1\").Select\nActiveSheet.Range(\"$A$1:$C$15\").AutoFilter Field:=2, Criteria1:=\"B\"\nRange(\"A2:C3\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"E2\").Select\nActiveSheet.Paste\nSheets(\"Sheet1\").Select\nActiveSheet.Range(\"$A$1:$C$15\").AutoFilter Field:=2, Criteria1:=\"C\"\nRange(\"A4:C11\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"I2\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>In short, I'm just sorting the values from Largest to Smallest, and then filtering for each group, and extracting the top two values. The code is not resilient, however, as the copy part depends on the names being in a particular order, which will change when I get new data. </p>\n\n<p>Is there a cleverer, cleaner way of doing this?</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1451411868, "post_id": 34516136, "comment_id": 56773842, "body": "Awesome. Thank you much for assisting with this. This achieved the results I was expecting."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452017862, "post_id": 34516136, "comment_id": 56982566, "body": "Happy new Year. I noticed one issue but have not been able to get back to send a comment. If I put the date in cell AD (I did change the code to reflect this cell), it does as intended and changes the text color in the entire row. However, if I delete the cells contents, it does not revert back to black text. Should I change the Else to &#39;r.Font.ColorIndex = 1&#39;?"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452017959, "post_id": 34516136, "comment_id": 56982617, "body": "Ok. I should have just done it and asked first. That is what was needed. Happy New Year anyway...lol"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1453307168, "post_id": 34516136, "comment_id": 57546632, "body": "How can I add a second Worksheet_Change sub into the same workbook?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1453312627, "post_id": 34516136, "comment_id": 57550333, "body": "You can&#39;t. It&#39;s a built in event. You can add code to the event."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 3, "last_activity_date": 1451410886, "creation_date": 1451410886, "answer_id": 34516136, "question_id": 34515772, "link": "https://stackoverflow.com/questions/34515772/auto-format-of-completed-row/34516136#34516136", "title": "Auto Format of completed row", "body": "<p>Is this what you want?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim r As Range\nSet r = Target.EntireRow\n\nIf Target.row = 1 Then Exit Sub 'don't change header color\n\nIf r.Cells(1, \"D\").Value &lt;&gt; \"\" Then 'change \"D\" to applicable column\n    r.Font.Color = RGB(0, 176, 80)\nElse\n    r.Font.ColorIndex = xlNone\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 34516136, "answer_count": 1, "score": 2, "last_activity_date": 1451410886, "creation_date": 1451409465, "last_edit_date": 1531164843, "question_id": 34515772, "link": "https://stackoverflow.com/questions/34515772/auto-format-of-completed-row", "title": "Auto Format of completed row", "body": "<p>This code should change all the text in a row to green if there is a value entered into column AD. However, this is not occurring automatically. <em>I should add that when the macro is run manually, the \"completed\" rows text does change to the correct color.</em> This code snippet was added into the Microsoft Excel Objects Sheet1. Another thing that occurs is the header row text gets colored when the macro is manually run. How do I stop the header row text from getting colored and have this macro run automatically?</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    RowComplete\nEnd Sub\n\nSub RowComplete()\n    Dim row As Range\n    For Each row In ActiveSheet.UsedRange.Rows\n        If row.Cells(1, \"AD\").Value &gt; 0 Then\n            row.Font.Color = RGB(0, 176, 80)\n        Else\n            row.Font.ColorIndex = xlNone\n        End If\n    Next row\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "fuzzy-comparison", "vba"], "comments": [{"owner": {"reputation": 380, "user_id": 4119010, "user_type": "registered", "profile_image": "https://graph.facebook.com/597021875/picture?type=large", "display_name": "Arin Taylor", "link": "https://stackoverflow.com/users/4119010/arin-taylor"}, "edited": false, "score": 0, "creation_date": 1451409533, "post_id": 34515729, "comment_id": 56772666, "body": "<code>Set F = Range(&quot;B:B&quot;).Find(SN)</code>"}, {"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "reply_to_user": {"reputation": 380, "user_id": 4119010, "user_type": "registered", "profile_image": "https://graph.facebook.com/597021875/picture?type=large", "display_name": "Arin Taylor", "link": "https://stackoverflow.com/users/4119010/arin-taylor"}, "edited": false, "score": 0, "creation_date": 1451409820, "post_id": 34515729, "comment_id": 56772811, "body": "I tried that and I am sure it is part of the solution by itself  alters what is matched"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451409558, "creation_date": 1451409352, "last_edit_date": 1531164843, "question_id": 34515729, "link": "https://stackoverflow.com/questions/34515729/alter-matching-code-to-run-on-different-shaped-data-then-originally-written-for", "title": "Alter Matching code to run on different shaped data then originally written for", "body": "<p>I do not recall where I found this code so I cannot give a proper attribution to its author but it <code>fuzzy matches</code> two columns of strings</p>\n\n<p>I want to alter the code so that the <code>LookWith</code> column is in coluwn <code>B</code> not column <code>E</code> I have tried for sometime to do this but cannot get this to work without breaking the code  </p>\n\n<p>Thanks</p>\n\n<p>The Original shape of the data the code is written for\n<a href=\"https://i.stack.imgur.com/suSkP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/suSkP.png\" alt=\"Original shape of data\"></a></p>\n\n<pre><code>Sub FuzzyMatch()\nDim F As Range, n As Long, c As Long, k As Long 'Taisir\nDim FN As String, SN As String, Z, s As Long, r As Long\n\nFor r = 2 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSN = Replace(Cells(r, 1), \",\", \"\"): Z = Split(SN): SN = Z(0)\nSet F = Range(\"E:E\").Find(SN)\nIf Not F Is Nothing Then\n  s = F.Row: FN = Cells(s, 5): c = 1\n  For n = 1 To UBound(Z): SN = Z(n)\n   If Len(SN) &lt; 3 Then GoTo GetNextn\n     Set F = Rows(s).Find(SN)\n      If Not F Is Nothing Then\n       c = c + 1\n         If c &gt;= UBound(Z) - 1 Then\n           If Cells(s, 6) &lt;&gt; \"\" Then k = k + 1 Else k = 6\n             Cells(s, k).Resize(1, 2).Value = Cells(r, 1).Resize(1, 2).Value: End If\n         GoTo GetNext: End If\nGetNextn: Next n: End If\nGetNext: Next r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451411006, "post_id": 34515675, "comment_id": 56773435, "body": "The problem you are having is that the Range(x,y) function creates a Range object where the beginning cell is x and the end cell is y.  You can&#39;t have a disjoint range in this way.  I&#39;m not really in the mood right now to figure out the whole thing for you, but I&#39;m guessing you are trying to use these ranges as the series the chart is based on.  I&#39;d use the whole range, &quot;A48:G59&quot; and then set the series in VBA as desired.  If you have a hard time figuring out how to get the series right, record a macro while creating the desired chart and then modify that code."}], "owner": {"reputation": 11, "user_id": 5727735, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153856174436591/picture?type=large", "display_name": "\u05de\u05d5\u05dc\u05d9 \u05e8\u05d5\u05d1\u05d9\u05e0\u05d6\u05d5\u05df", "link": "https://stackoverflow.com/users/5727735/%d7%9e%d7%95%d7%9c%d7%99-%d7%a8%d7%95%d7%91%d7%99%d7%a0%d7%96%d7%95%d7%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1485419636, "creation_date": 1451409079, "last_edit_date": 1485419636, "question_id": 34515675, "link": "https://stackoverflow.com/questions/34515675/how-to-add-variable-to-chart-with-2-ranges-vba", "title": "How to add variable to chart with 2 ranges vba", "body": "<p>I am tring to make that my chart will take data from 2 ranges that made the my chart, the ranges are for example: E48:G59 and A48:G59.</p>\n\n<p>I switch the rows numbers to variables because I need to add to the chart every time another row so that is relevant part of the code: </p>\n\n<pre><code>Let CopyrangeCH1a = \"E\" &amp; G &amp; \":\" &amp; \"G\" &amp; I\nLet CopyrangeCH1b = \"A\" &amp; G &amp; \":\" &amp; \"A\" &amp; I\n\nActiveSheet.ChartObjects(\"chart 2\").Activate\n    ActiveChart.SetSourceData Source:=Range(CopyrangeCH1b, CopyrangeCH1a)\n</code></pre>\n\n<p>I and G are the variables for the rows.</p>\n\n<p>The problem is that when I excute it my chart take in the range of the variable CopyrangeCH1a B48:G59 insted of E48:G59.</p>\n\n<p>Althogh that the code is right and the variables show E48:G59...\n(it take the first column after the column that in the secound range)</p>\n\n<p>When I do just 1 range of them in the range with the variable it perfect</p>\n\n<p>Why it do not work o.k with 2 ranges and I can fix it?</p>\n"}, {"tags": ["vba", "if-statement", "conditional", "weekday"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451409186, "post_id": 34515662, "comment_id": 56772461, "body": "Range(&quot;A&quot; &amp; i) checks the value of the cell and not the formula.  Try Range(&quot;A&quot; &amp; i).Formula = &quot;=Weekday&quot;"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451409382, "post_id": 34515662, "comment_id": 56772583, "body": "Thanks for your help Sorceri. I did try that but still getting just AK value."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451409507, "post_id": 34515662, "comment_id": 56772650, "body": "You need to use Left(Range(&quot;A&quot; &amp; i).Formula, 8)  otherwise the formula will be =Weekday(some date value or cell reference)"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451409857, "post_id": 34515662, "comment_id": 56772831, "body": "I think I see what you are saying, what does the 8 do? ie. Formula,8)"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451409949, "post_id": 34515662, "comment_id": 56772876, "body": "=Weekday is 8 characters long"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451410259, "post_id": 34515662, "comment_id": 56773036, "body": "got it, thanks, unfortunately, it&#39;s still giving me just the AK value."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451410640, "post_id": 34515662, "comment_id": 56773234, "body": "when you are checking for weekday formula or are you checking for the formula or the actual day of the week?"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451415704, "post_id": 34515662, "comment_id": 56775753, "body": "What I intend is to check the date (A2) etc. if it&#39;s a weekday, it would copy the value from AL2 to AT2. If it&#39;s a weekend, it would transfer the value from AK2 to AT2. Hope that&#39;s clearer. I added a screenshot if that helps."}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1451419546, "post_id": 34515662, "comment_id": 56777681, "body": "Thanks for your help @Sorceri"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451409621, "post_id": 34515756, "comment_id": 56772714, "body": "Thanks for your help TPhe, I&#39;m getting a Compile error: Wrong number of arguments or invalid assignment"}, {"owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "reply_to_user": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451410094, "post_id": 34515756, "comment_id": 56772948, "body": "Perhaps try this instead: If  Weekday(Range(&quot;A&quot; &amp; i).value) &lt; 7 and Weekday(Range(&quot;A&quot; &amp; i).value) &gt; 1 Then"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451410221, "post_id": 34515756, "comment_id": 56773015, "body": "Unfortunately I&#39;m still getting the compile error, the word Weekday is highlighted in the debugger."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451410918, "post_id": 34515756, "comment_id": 56773394, "body": "@monk - post the entire line where you get the debug error and let us know what the error is. TPhe&#39;s answer is spot-on. I suspect it some other syntax related stuff."}, {"owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "reply_to_user": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451410965, "post_id": 34515756, "comment_id": 56773414, "body": "Oh, apparently that compile error is due to the fact that you named your sub &quot;Weekday&quot; - which is the same as the function name. You should change the name of your sub to something else. @monk"}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451415214, "post_id": 34515756, "comment_id": 56775513, "body": "Ha, that sounds like the type of mistake I would do. Thanks."}, {"owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "edited": false, "score": 0, "creation_date": 1451415925, "post_id": 34515756, "comment_id": 56775879, "body": "Awesome, that worked. I am getting a Run-time error &#39;13&#39;: type mismatch AFTER the values are copied. other than that it works great! Thanks."}, {"owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "edited": false, "score": 0, "creation_date": 1451416016, "post_id": 34515756, "comment_id": 56775931, "body": "Great, glad to hear it. You may wish to post a separate question about the run-time error message you are receiving."}], "tags": [], "owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "is_accepted": true, "score": 0, "last_activity_date": 1451409430, "creation_date": 1451409430, "answer_id": 34515756, "question_id": 34515662, "link": "https://stackoverflow.com/questions/34515662/vba-conditional-if-statement-using-weekday/34515756#34515756", "title": "VBA Conditional IF statement using WEEKDAY", "body": "<p>The VBA formula for returning the day of the week is slightly different than the worksheet formula. Try</p>\n\n<pre><code>If  Weekday(Range(\"A\" &amp; i).value, vbMonday) &lt; 6 Then\n</code></pre>\n\n<p><a href=\"http://www.techonthenet.com/excel/formulas/weekday.php\" rel=\"nofollow\">Further information on this function and it's arguments.</a></p>\n"}], "owner": {"reputation": 9, "user_id": 5556154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXxGB.jpg?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/5556154/monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 0, "accepted_answer_id": 34515756, "answer_count": 1, "score": 0, "last_activity_date": 1528979234, "creation_date": 1451409026, "last_edit_date": 1592644375, "question_id": 34515662, "link": "https://stackoverflow.com/questions/34515662/vba-conditional-if-statement-using-weekday", "title": "VBA Conditional IF statement using WEEKDAY", "body": "<h3>Screenshot of Excel Columns</h3>\n<p><img src=\"https://i.stack.imgur.com/SGgpR.jpg\" alt=\"Screenshot of Excel Columns\" /></p>\n<p>I am trying to write a conditional IF statement based on the day of the week.</p>\n<ul>\n<li><p>Column A has the date.</p>\n</li>\n<li><p>Column AK has a weekend value.</p>\n</li>\n<li><p>Column AL has a weekday value.</p>\n</li>\n</ul>\n<p>I need the correct value (depending on day of week) to flow into column AT. The code I came up with isn't working. All that's showing up in AT is the AK value. I'm pretty new to VBA, I'm definitely missing something. Thanks in advance for any help.</p>\n<pre><code>Sub Weekday()\n\nFor i = 2 To Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row\n\nIf Range(&quot;A&quot; &amp; i) = &quot;=Weekday&quot; Then 'This line of code doesn't work\n     \nRange(&quot;AT&quot; &amp; i).Value = Range(&quot;AL&quot; &amp; i).Value 'This line of code works\n                                    \nElse\nRange(&quot;AT&quot; &amp; i).Value = Range(&quot;AK&quot; &amp; i).Value 'This line of code works\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n<p>UPDATE: the AK and AL values are both decimals, like 506.468 or 348.286</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1451407976, "post_id": 34515401, "comment_id": 56771711, "body": "<code>Else: ipointIPCMP = connectIPCMP And k &gt; 1</code> did you mean <code>elseif</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451408101, "post_id": 34515401, "comment_id": 56771785, "body": "Change <code>Else:</code> to <code>ElseIf</code> and add <code>Then</code> to the end of the line."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451408108, "post_id": 34515401, "comment_id": 56771788, "body": "You just need <code>ElseIf</code>.  Using only <code>Else</code> means that when the <code>If</code> statement isn&#39;t next, no matter what, run what&#39;s after <code>Else</code>.  Using <code>ElseIf</code> will: When the <code>If</code> statement isn&#39;t met, look to the condition in <code>ElseIf</code> to see if that&#39;s met..if not, it will continue (in your case, to <code>End If</code>)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1451409353, "post_id": 34515401, "comment_id": 56772573, "body": "What are you trying to do with <code>addrow = ...</code>  The activate does not work with the <code>=</code>.  Are you trying to set a range, or is addrow an array?"}, {"owner": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451409461, "post_id": 34515401, "comment_id": 56772629, "body": "I want to select a range (a row) and then add a row below that row."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1451410328, "post_id": 34515401, "comment_id": 56773074, "body": "The subscript out of range error is because you misspelled the sheet name.....With Worksheets(&quot;rtf&quot;) should be With Worksheets(&quot;rft&quot;) after the End With line."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451408963, "post_id": 34515479, "comment_id": 56772337, "body": "I changed the with statement now to your suggestion but it still gives me the same error there,     With Worksheets(&quot;rtf&quot;)                                   addrow = Range(.Cells(3 + i, 1), .Cells(3 + i, 8)).Activate                                   End With"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451409443, "post_id": 34515479, "comment_id": 56772620, "body": "You cannot use the <code>=</code> and <code>.Activate</code> like that. <code>Range</code> should be <code>.Range</code>. Please see <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a>."}, {"owner": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451409995, "post_id": 34515479, "comment_id": 56772894, "body": "Thank you for your help! I adjusted the code accordingly but still get the same exact error. I have troubles understanding what should be included within the with statement. Can I include the activate statement in the with statement?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451410120, "post_id": 34515479, "comment_id": 56772960, "body": "The short answer is Yes. The  long answer is Why would you want to? Relying on ActiveCell, Select, etc is unreliable at best and error-prone at worst."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451410365, "post_id": 34515479, "comment_id": 56773094, "body": "btw, did you know that you are using <code>&quot;rft&quot;</code> in one place and <code>&quot;rtf&quot;</code> in another? Perhaps that is generating the confusion."}, {"owner": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "edited": false, "score": 0, "creation_date": 1451410878, "post_id": 34515479, "comment_id": 56773372, "body": "Good catch!  That changed the type of error. Now I get &quot;Activate method of range class failed&quot; error. (I should be able to figure this one out) You&#39;re definitely right that relying on this activate-thing is very error-prone. Thanks alot!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1451410751, "last_edit_date": 1495541750, "creation_date": 1451408262, "answer_id": 34515479, "question_id": 34515401, "link": "https://stackoverflow.com/questions/34515401/vba-subscript-out-of-range-error/34515479#34515479", "title": "VBA: Subscript out of range error", "body": "<ol>\n<li>Change <code>Else:</code> to <code>ElseIf</code> and add <code>Then</code> to the end of the line.</li>\n<li><p>Reference the range properly.</p>\n\n<pre><code>With Worksheets(\"rtf\")\n     .Range(.Cells(3 + i, 1), .Cells(3 + i, 8)).Activate\n     ActiveCell.Offset(1).EntireRow.Insert\nEnd with\n</code></pre></li>\n</ol>\n\n<p>Note <code>.Cells</code> and not <code>Cells</code>. See <a href=\"https://stackoverflow.com/questions/27763089/count-the-number-of-rows-in-another-sheet/27763394#27763394\">this</a>.</p>\n\n<p><strong>Better Approach</strong></p>\n\n<pre><code>    For i = 1 To n\n        connectIPCMP = iPCMP(i)\n        With Worksheets(\"rtf\")   '&lt;~~CHECK THIS WORKSHEET NAME!!!!!\n            For j = 1 To m\n                ipIPCMP = Worksheets(\"ip\").Cells(j + 1, 2)\n                If ipIPCMP = connectIPCMP And k = 1 Then\n                    supplierList = Sheets(\"ip\").Cells(j, 3)\n                    .Cells(3 + j, 4) = List\n                    k = k + 1\n                ElseIf ipointIPCMP = connectIPCMP And k &gt; 1 Then\n                    .Cells(3 + i, 1).Offset(1).EntireRow.Insert  '&lt;~~only need a single cell if you are going to insert an entire row\n                    .Cells(3 + j, 4) = supplierList\n                    k = k + 1\n                End If\n            Next j\n        End With\n    Next i\n</code></pre>\n\n<p>The code sample you provided only tells half of the story but the above is the best I can offer without seeing the full story.</p>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 163, "user_id": 5431522, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-qTrjcMpEeX0/AAAAAAAAAAI/AAAAAAAAAEc/SsJeCmHZFgU/photo.jpg?sz=128", "display_name": "Jolien .A", "link": "https://stackoverflow.com/users/5431522/jolien-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451410751, "creation_date": 1451407899, "last_edit_date": 1451409847, "question_id": 34515401, "link": "https://stackoverflow.com/questions/34515401/vba-subscript-out-of-range-error", "title": "VBA: Subscript out of range error", "body": "<p>I'm still pretty new with VBA, and keep getting the subscript out of range error. I am trying to write code that reads data from one excel tab (\"ip\") and writes some of that data to another tab (\"rtf\"). When the ip tab has duplicate values for the variable ipIPCMP then I want to add a new row below the active row in my second tab rtf. The error occurs at the else part of the conditional statement. Thank you.</p>\n\n<p>UPDATE: changed else to elseif and changed the with statement. Still get subscript out of range. </p>\n\n<pre><code>For i = 1 To n   \n\nconnectIPCMP = iPCMP(i)\n\n    For j = 1 To m\n\n    ipIPCMP = Sheets(\"ip\").Cells(j + 1, 2)\n\n        If ipIPCMP = connectIPCMP And k = 1 Then\n\n            supplierList = Sheets(\"ip\").Cells(j, 3)\n\n            Sheets(\"rft\").Cells(3 + j, 4) = list\n            k = k + 1\n\n         ElseIf ipointIPCMP = connectIPCMP And k &gt; 1 Then\n\n             With Worksheets(\"rtf\")\n\n                .Range(.Cells(3 + i, 1), .Cells(3 + i, 8)).Activate\n                .ActiveCell.Offset(1).EntireRow.Insert\n\n             End With\n\n            Sheets(\"rft\").Cells(3 + j, 4) = supplierList\n\n            k = k + 1\n\n        End If\n    Next\n</code></pre>\n\n<p>Next</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451407539, "post_id": 34515267, "comment_id": 56771464, "body": "So there is only data coming in; no formulas being copied  into the original? What about worksheet names... do they match?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1451407547, "post_id": 34515267, "comment_id": 56771475, "body": "Don&#39;t link the formulas to sheets in the master book. Link it to each of the 24 books so when you run your macro, master sheet gets updated. Edit: to clarify, your macro won&#39;t need the copy line. Just need to open/close."}, {"owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451410287, "post_id": 34515267, "comment_id": 56773055, "body": "Findwindow - So linking to the individual sheets sounds like a better idea. I will do that. However, you said I wont need the copy line. What would I use instead to open all the other sheets into the main sheet? The manager wants to be able to select each sheet at the bottom of his main workbook."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451414789, "post_id": 34516265, "comment_id": 56775311, "body": "I like that idea. I tried that code. however, I keep getting the error 1004 &quot;all merged cells need to be the same size. Which is weird because all 24 sheets were copied directly from the main sheet."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451415895, "post_id": 34516265, "comment_id": 56775865, "body": "So you have merged cells in the sheets? Umm, that may be requires to change the copy method. Would you try as edited? (We will copy the range as is, together with its merged cells)"}, {"owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451423870, "post_id": 34516265, "comment_id": 56779610, "body": "I tried the new code and it works great! Thanks! Solved my issue."}, {"owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451441277, "post_id": 34516265, "comment_id": 56785424, "body": "One more quick question. On this part:  &#39;code&#39;     Path = &quot;C:\\Users\\dt\\Desktop\\dt kte\\&quot;     Filename = Dir(Path &amp; &quot;*.xls&quot;) &#39;code&#39;  Is there a way I can change that to open all the files in a folder named &quot;FPT Project Sales Trackers&quot; that is housed in the same folder as the main workbook?   I tried the ActiveDirectory.Path one but it wasn&#39;t working."}, {"owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "edited": false, "score": 0, "creation_date": 1451442141, "post_id": 34516265, "comment_id": 56785699, "body": "I figured it out. Everything works now. Problem solved"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1451415950, "last_edit_date": 1451415950, "creation_date": 1451411416, "answer_id": 34516265, "question_id": 34515267, "link": "https://stackoverflow.com/questions/34515267/automatically-update-excel-sheets-from-multiple-work-books/34516265#34516265", "title": "Automatically Update Excel Sheets From Multiple Work Books", "body": "<blockquote>\n  <p>The problem I am having is I need the data from the 24 sheets to\n  overwrite the data in the 24 sheets in the main work book</p>\n</blockquote>\n\n<p>Well, in this case, why not just copy/paste the values, without removing and copying entire sheets. I suppose that each source sheet has a corresponding sheet with the same name in the Master workbook:</p>\n\n<pre><code>Sub GetSheets()\n    Path = \"C:\\Users\\dt\\Desktop\\dt kte\\\"\n    Filename = Dir(Path &amp; \"*.xls\")\n    Do While Filename &lt;&gt; \"\"\n       Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n       For Each src In ActiveWorkbook.Sheets\n           Set dest = ThisWorkbook.Sheets(src.name)\n           dest.UsedRange.ClearContents\n           src.UsedRange.Copy dest.Range(src.UsedRange.Address)\n       Next src\n       Workbooks(Filename).Close\n       Filename = Dir()\n  Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5534346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153682979977103/picture?type=large", "display_name": "Zachary Zaras", "link": "https://stackoverflow.com/users/5534346/zachary-zaras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452018012, "creation_date": 1451407345, "last_edit_date": 1452018012, "question_id": 34515267, "link": "https://stackoverflow.com/questions/34515267/automatically-update-excel-sheets-from-multiple-work-books", "title": "Automatically Update Excel Sheets From Multiple Work Books", "body": "<p>I have a workbook with two main sheets with values based off 24 other sheets. </p>\n\n<p>24 employees will send their sheets weekly with new data. The main workbook should combine them into the main file. Formatting and everything.</p>\n\n<p>I have used this code:</p>\n\n<pre><code>Sub GetSheets()\nPath = \"C:\\Users\\dt\\Desktop\\dt kte\\\"\nFilename = Dir(Path &amp; \"*.xls\")\n  Do While Filename &lt;&gt; \"\"\n  Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n     For Each Sheet In ActiveWorkbook.Sheets\n     Sheet.Copy After:=ThisWorkbook.Sheets(1)\n  Next Sheet\n     Workbooks(Filename).Close\n     Filename = Dir()\n  Loop\nEnd Sub\n</code></pre>\n\n<p>It works to combine them. The problem is I need the data from the 24 sheets to overwrite the data in the 24 sheets in the main workbook. If I delete the 24 sheets from the main workbook, it kills the formulas on the main sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1451417045, "post_id": 34515034, "comment_id": 56776492, "body": "You say that the VBA runs but &quot;nothing happens&quot;. Well, what exactly does happen? Do you get an error message? Do any of the .xlsx files actually open in the background? Or does literally nothing happen, as if the program skips through the code to the end?"}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1451424909, "post_id": 34515034, "comment_id": 56780095, "body": "So it looks like it does run and trys to save a <code>txt</code> file in the new directory but it is blank.  Also, it looks like each sheet in the <code>.xlsx</code> is being copied not just the specific one.  Thank you :)."}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451406392, "creation_date": 1451406392, "last_edit_date": 1531164843, "question_id": 34515034, "link": "https://stackoverflow.com/questions/34515034/convert-specific-workbook-in-directory-from-xlsx-to-txt-using-excel-2010-vba", "title": "convert specific workbook in directory from xlsx to txt using excel 2010 vba", "body": "<p>I am trying to convert all ~200 <code>xlsx</code> files <code>txt</code> using the below <code>vba</code>.  In each <code>.xlsx</code> file there is a worksheet with \"analysis\" in the name that I am trying to copy to <code>Const Filepath</code>  So in that directory there will be 200 <code>txt</code> files all from the \"analysis\" sheet in the <code>.xlsx</code> files. The <code>vba</code> runs but nothing happens and I need some expert help getting this to work.  Thank you :).</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim fName As String, fPath As String, wb As Workbook\n\nConst Filepath  As String = \"C:\\Users\\cmccabe\\Desktop\\folder\"\n\nfPath = \"C:\\Users\\cmccabe\\Desktop\\epilepsy\\\"\nfName = Dir(fPath &amp; \"*analysis*.xlsx\")\nDo While fName &lt;&gt; \"\"\n    Set wb = Workbooks.Open(fPath &amp; fName)\n    wb.SaveAs Left(fName, Len(fName) - 5) &amp; \".txt\", FileFormat:=xlText\n    fName = Dir\n    Filename = Filepath &amp; \"\\\" &amp; Left(oFile, InStrRev(oFile, \".\")) &amp; \"txt\"\n\n                Open Filename For Output Access Write As #1\n                Print #1, Text\n                Close #1\n Loop\n End Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1451407400, "post_id": 34515000, "comment_id": 56771373, "body": "There may be more than one issue involved here, but check out this one first.  Good Access syntax: <code>INSERT INTO Movie(movie_id) VALUES (27);</code> Bad Access syntax: <code>INSERT INTO Movie(movie_id) VALUES (movie_id=27);</code>  After you get that issue sorted, consider a parameter query."}, {"owner": {"reputation": 1319, "user_id": 5530076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1sBPY.jpg?s=128&g=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/5530076/bram"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1451408120, "post_id": 34515000, "comment_id": 56771797, "body": "Cheers, that fixed it!"}], "answers": [{"comments": [{"owner": {"reputation": 1319, "user_id": 5530076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1sBPY.jpg?s=128&g=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/5530076/bram"}, "edited": false, "score": 0, "creation_date": 1451410262, "post_id": 34515877, "comment_id": 56773038, "body": "I upvoted his answer, don&#39;t know how to mark his answer as question (yet). Thanks for bringing that point to my attention. I&#39;ll try to fix that, hadn&#39;t thought about that! Thanks!"}], "tags": [], "owner": {"reputation": 48, "user_id": 3353517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606294905/picture?type=large", "display_name": "DaveSimmons", "link": "https://stackoverflow.com/users/3353517/davesimmons"}, "is_accepted": true, "score": 2, "last_activity_date": 1451411041, "last_edit_date": 1495540745, "creation_date": 1451409906, "answer_id": 34515877, "question_id": 34515000, "link": "https://stackoverflow.com/questions/34515000/insert-into-execute-vba/34515877#34515877", "title": "INSERT INTO Execute VBA", "body": "<p>@Hansup 's comment explains the issue: don't include the field names in the <code>VALUES</code> clause of an Access <code>INSERT</code>.</p>\n\n<p>Also, something I learned on Stack Overflow that I like to share is that if you're going to have a query in your code, you should use parameterized queries to help prevent someone from accidentally messing up your databases or some kid from trying to see if he can drop your tables by inserting commands in text fields.  Here's a Stack Overflow link on it <a href=\"https://stackoverflow.com/questions/33179048/sql-injection-with-parameterized-queries-in-asp-net\">Parameterized Queries</a> .  </p>\n\n<p>And here is a brief example using a few of your fields:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim strInsert\nstrInsert = \"INSERT INTO Movie(movie_id, title, duration)\" &amp; vbCrLf &amp; _\n    \"VALUES(pMovie_id, pTitle, pDuration)\"\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(vbNullString, strInsert)\nqdf.Parameters(\"pMovie_id\").Value = Me.TxtMovId.Value\nqdf.Parameters(\"pTitle\").Value = Me.TxtTitle.Value\nqdf.Parameters(\"pDuration\").Value = Me.TxtDur.Value\nqdf.Execute dbFailOnError\n</code></pre>\n"}], "owner": {"reputation": 1319, "user_id": 5530076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1sBPY.jpg?s=128&g=1", "display_name": "Bram", "link": "https://stackoverflow.com/users/5530076/bram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1620, "favorite_count": 0, "accepted_answer_id": 34515877, "answer_count": 1, "score": 1, "last_activity_date": 1451411628, "creation_date": 1451406254, "last_edit_date": 1451411628, "question_id": 34515000, "link": "https://stackoverflow.com/questions/34515000/insert-into-execute-vba", "title": "INSERT INTO Execute VBA", "body": "<p>I want this SQL statement to execute. But with the <code>CurrentDb.Execute</code> I get error 3061 (Too few parameters. Expected 9). The values given in the variables are legit. </p>\n\n<p>This is my table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7cJee.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7cJee.png\" alt=\"The table\"></a></p>\n\n<p>This is my Access form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LAdds.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LAdds.png\" alt=\"The MS Access Form\"></a></p>\n\n<p>And here is my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>updStr = \"INSERT INTO Movie(movie_id, title, duration, description, publication_year, cover_image, previous_part, price, URL)\" &amp; _\n            \" VALUES(movie_id = \" &amp; Me.TxtMovId &amp; \", title = '\" &amp; Me.TxtTitle &amp; \"',\" &amp; _\n            \" duration = \" &amp; Me.TxtDur &amp; \", description = '\" &amp; Me.TxtDescr &amp; \"',\" &amp; _\n            \" publication_year = \" &amp; Me.TxtPubl &amp; \", cover_image = \" &amp; Me.TxtImage &amp; \",\" &amp; _\n            \" previous_part = \" &amp; Me.TxtPrev &amp; \", price = \" &amp; Me.TxtPrice &amp; \", URL = '\" &amp; Me.TxtUrl &amp; \"')\"\n\nCurrentDb.Execute (updStr)\n</code></pre>\n\n<p>The <code>DoCmd.RunSQL</code> does execute the string, but it has no effect, that's the reason for using <code>CurrentDb.Execute</code>.</p>\n"}, {"tags": ["vba", "excel", "ms-access", "hyperlink"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1451406810, "post_id": 34514991, "comment_id": 56771032, "body": "Check out the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838843.aspx\" rel=\"nofollow noreferrer\">Follow Hyperlink</a> worksheet event, that should be able to pre-empt the opening of the browser.  Do you know enough VBA to get going from there? If you try something and can&#39;t get it, please post the code and we can tweak/try to fix!"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1451408912, "post_id": 34514991, "comment_id": 56772309, "body": "@BruceWayne Thank you yet again for your help here. I suppose that the available events in Excel are a little opaque to me. I have a little bit of experience working with Access, where all available events are always spelled out in the properties tab. Based on your answer, I am starting to see that it&#39;s worthwhile to explicitly research what events are available in various settings in Excel. Again, thank you!"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1451408939, "post_id": 34514991, "comment_id": 56772328, "body": "(As a small bit of meta...I hope that this question is not too similar to the longer one I asked a few days ago that you also helped with! Although the more I think about, this probably is a duplicate, although I hope that this one is a better-formed and clearer question)"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 1, "creation_date": 1451408283, "post_id": 34515144, "comment_id": 56771894, "body": "(1 of 2) Thank you very much for this. I feel like this is definitely the right approach, but I&#39;m having two issues getting all the way there. First of all, following your advice, I&#39;ve placed the following code behind Sheet1: <code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink) MsgBox Target.Address End Sub</code>  The first thing I&#39;m noticing is that it seems like this event will only fire if I enter a hyperlink within a regular cell on sheet1. Clicking a link within the .pdf/userform has no effect (it opens neither the msgbox nor the link/browser). <b>continued</b>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 1, "creation_date": 1451408444, "post_id": 34515144, "comment_id": 56772004, "body": "To confirm: This is s PDF opened by an embedded IE browser in a UserForm...? If it is, you may have to isolate either IE&#39;s messager queue or the window system message pump rather than an Excel event macro."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 1, "creation_date": 1451408490, "post_id": 34515144, "comment_id": 56772047, "body": "(2 of 2) I&#39;m not sure that this has anything to do with the code itself, though. I get the same (non)-behavior in the userform if I comment all of that code out. It also doesnt seem to matter whether or not I add similar code behind the userform itself instead of the sheet. ---------------- The second thing I am noticing is that, even if I add and then click a link in a regular cell, the message box does display as expected, but the same link will then nonetheless open in a browser afterwards. I don&#39;t seem to be successfully avoiding the browser navigation. Adding an <code>End</code> statement is no help"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451408548, "post_id": 34515144, "comment_id": 56772084, "body": "I&#39;m currently using the .pdf viewer control. Might I have better results with a browser control instead? (It sounds like the answer is yes) :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 1, "creation_date": 1451408644, "post_id": 34515144, "comment_id": 56772152, "body": "I would have to set up a test environment to answer that definitively but you can control anything if you are capturing the right message queue and message type."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451409714, "post_id": 34515144, "comment_id": 56772761, "body": "Switching the control type from .pdf viewer to WebBrowser does indeed make the embedded links clickable once again. But I&#39;m not catching the FollowHyperlink event from that userform at the moment (clicking the link just opens the target in the userform webbrowser control, as normal). I&#39;m trying to place similar code behind the userform and the webbrowser control at the moment to see if that gets it. I do just now notice your comment about the IE messenger queue/windows message system pump, which I will move onto next. :)"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451417285, "post_id": 34515144, "comment_id": 56776584, "body": "Interacting with the message queue via VBA seems to be an especially daunting task, from what I&#39;ve been able to discover over the last few hours. I&#39;ve activated MSMQ, but I&#39;m feeling quite lost about how I ought to proceed from here. So far the only code examples I&#39;ve found online pertain to VB6, and its not clear to me if/how they might work in VBA. With apologies for the <i>painfully vague</i> question....do you have any pointers that might help me get started? :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 1, "creation_date": 1451417819, "post_id": 34515144, "comment_id": 56776823, "body": "I&#39;ve been thinking about this off-and-on over the couple hours and capturing the hyperlink event in the Internet.Explorer object may be a better method. However, you have to remember that what you are trying to do is completely contradictory to <b>by-design</b> behavior and HTML/browsers are somewhat specifically designed to <b>NOT</b> let anything redirect a hyperlink &#39;click&#39;. With that said, I&#39;ll keep thinking about it; are you in a specific hurry?"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451417905, "post_id": 34515144, "comment_id": 56776860, "body": "Another meta-type question, I&#39;m afraid....it seems to me that perhaps the thing to do here would be to ask you to edit your answer to include an explicit reference to pursuing a message queue type solution for passing parameters between .pdf and excel in the way I am hoping to do. I should then accept that answer as the solution to my original question, and then pose a new question thread concerning the particulars of how to implement a message queue type of solution here. Would that be in keeping with the intended rules of the road here on SO?"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451418258, "post_id": 34515144, "comment_id": 56777035, "body": "Not in a major hurry, thank you. (Once again, I very much appreciate the thought and help!) And that is a good point about about attempting to co-opt the intended behavior of links; I am only trying to leverage links because I haven&#39;t had success finding any other structure or object that appears capable of passing the kind of information between .pdf and excel that I am hoping to facilitate. Perhaps hyperlinks are not the best object to accomplish this, but I haven&#39;t had any luck finding a workable alternative so far."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451420276, "post_id": 34515144, "comment_id": 56778041, "body": "(1 of 2) This is a little off the wall, but maybe there&#39;s some hope here. At heart, what I&#39;m trying to do is be able to pass information from each of many clickable objects in a .pdf file, and have some information associated with each of those clickable objects programmatically-available to a sub in Excel using VBA. I&#39;ve been trying to accomplish this using modified hyperlinks, in part because I haven&#39;t been able to get JavaScript running in my .pdf file to work with any objects in Excel. <b>continued</b>"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451420478, "post_id": 34515144, "comment_id": 56778136, "body": "(2 of 2) Instead, Im pretty sure I could write <i>different</i> JS in .pdf that would, say, save a blank 1-page .pdf document to a particular subfolder, and <i>name</i> that dummy file the same text string that I had previously been hoping to pass via a modified hyperlink. As long as its possible for Excel/VBA to have access to an event that fires whenever a file is added to that folder, then I could grab the text string in Excel simply by referring to the name of the new dummy file. I&#39;m not sure if <b>this</b> is possible either, though. A quick google search suggests &quot;WMI events&quot; might work.Not sure yet."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451487177, "post_id": 34515144, "comment_id": 56804884, "body": "(1 of 2) Tentatively, this seems to work. It&#39;s not pretty, but it seems to work. And it turned out to be even simpler than using WMI events. Since I have complete control over the contents of the dummy folder and dummy files I&#39;m setting up to handle this information transfer, I don&#39;t need to develop a robust method of testing whether or not there have been changes to the dummy folder--I can use very simple, everyday VBA code to test whether or not the folder is empty. That way, I set up an empty subfolder initially...my JS in the .pdf file will save a dummy doc into that folder <b>continued</b>"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451487442, "post_id": 34515144, "comment_id": 56805038, "body": "(2 of 2) into that folder whenever a link is clicked, and the name of that dummy file will be the text string that I need to pass to Excel. I have a simple sub in Excel that continually tests whether that folder is empty (by looping every X seconds to test whether the Dir() function for that subfolder &amp; &quot;<i>.</i>&quot; is a ZLS). If that procedure ever finds a file in the designated subfolder, it captures the filename string,deletes the dummy file, and then executes the business end of my code. Again, kind of clumsy but it seems like this is going to work. I&#39;m sure there are better ways of doing this."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1451487520, "post_id": 34515144, "comment_id": 56805089, "body": "Thanks again for your help, @jeeped and @brucewayne!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1451406864, "creation_date": 1451406864, "answer_id": 34515144, "question_id": 34514991, "link": "https://stackoverflow.com/questions/34514991/is-it-possible-to-programmatically-supersede-the-native-hyperlink-following-beha/34515144#34515144", "title": "Is it possible to programmatically supersede the native hyperlink-following behavior in Excel?", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838843.aspx\" rel=\"nofollow\">Worksheet_FollowHyperlink</a> event macro to override default hyperlink behavior..</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    MsgBox \"1234\"\nEnd Sub\n</code></pre>\n\n<p>Alternately, for a workbook-wide approach, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838573.aspx\" rel=\"nofollow\">Workbook_SheetFollowHyperlink</a> is available.</p>\n\n<pre><code>Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n    if Sh.Name = \"Sheet1\" Then _\n        MsgBox \"1234\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 34515144, "answer_count": 1, "score": 1, "last_activity_date": 1451406864, "creation_date": 1451406228, "question_id": 34514991, "link": "https://stackoverflow.com/questions/34514991/is-it-possible-to-programmatically-supersede-the-native-hyperlink-following-beha", "title": "Is it possible to programmatically supersede the native hyperlink-following behavior in Excel?", "body": "<p>Is it possible to supersede the built in way in which Excel follows hyperlinks once they are clicked?</p>\n\n<p>Specifically, I have a .pdf document that contains hyperlinks, which I open in an Excel userform. When a user clicks any of the links in that document, I'd like to programmatically abort the usual behavior of attempting to open the target of that link in a new browser window.</p>\n\n<p>Instead, I'd like to perform some text string manipulations on the URL target of each of those links, and use the result to drive some other VBA code.</p>\n\n<hr>\n\n<p>For example, say the .pdf file has a hyperlink whose target is \"<a href=\"http://www.website.com/1234\" rel=\"nofollow\">http://www.website.com/1234</a>\".  When this link is clicked, I'd like the end result to be an Excel/VBA command of <code>msgbox \"1234\"</code> with no attempt made to actually open the URL in a browser.</p>\n\n<hr>\n\n<p>Is such a thing possible in Excel?</p>\n\n<p>If not, is it possible to do the same thing in Access?</p>\n"}, {"tags": ["arrays", "vba", "scripting.dictionary"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1451408570, "post_id": 34514250, "comment_id": 56772100, "body": "You cannot access the elements of an array while it&#39;s stored in a dictionary.  You need to pull it out into a temporary variable to modify it, then put it back"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1451407934, "post_id": 34515286, "comment_id": 56771685, "body": "Looks fine, but you could also think of using <code>Collection</code> objects, which are polymorphic by nature and more easily expandable than arrays."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1451424567, "post_id": 34515286, "comment_id": 56779946, "body": "Store sub dictionaries in your dictionary. So you would have got a dictionary of dictionaries."}], "tags": [], "owner": {"reputation": 1163, "user_id": 1922531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e769863339f1549a63fc5cb37637676?s=128&d=identicon&r=PG&f=1", "display_name": "lukehawk", "link": "https://stackoverflow.com/users/1922531/lukehawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1451407430, "creation_date": 1451407430, "answer_id": 34515286, "question_id": 34514250, "link": "https://stackoverflow.com/questions/34514250/vba-rewriting-array-in-scripting-dictionary/34515286#34515286", "title": "VBA Rewriting Array in scripting.dictionary", "body": "<p>I found a workaround. I initialize the items with only two elements, then redim and add the third as I send the SOAP requests and get the results. I initialize as follows:</p>\n\n<pre><code>Dim riskDict As New Scripting.Dictionary\nriskDict.Add \"Weight\", Array(\"WP\", 0)\n</code></pre>\n\n<p>And for my loop:</p>\n\n<pre><code>For Each key In riskDict\n  temp = riskDict(key)\n  ReDim Preserve temp(UBound(temp) + 1)\n  temp(UBound(temp)) = getTheRisk(myDate.Value, myPort.Value, riskDict(key)(0))\n  riskDict(key) = temp\nNext key\n</code></pre>\n\n<p>This is less than ideal, since the redim preserve. (And it just doesn't seem very elegant.) However, this dict is only about 8-10 items long, so it should not cause too much of a performance hit. </p>\n\n<p>If you have any better solutions, please feel free to comment or post them. </p>\n\n<p>Thanks all!</p>\n"}], "owner": {"reputation": 1163, "user_id": 1922531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e769863339f1549a63fc5cb37637676?s=128&d=identicon&r=PG&f=1", "display_name": "lukehawk", "link": "https://stackoverflow.com/users/1922531/lukehawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 645, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451407430, "creation_date": 1451403639, "question_id": 34514250, "link": "https://stackoverflow.com/questions/34514250/vba-rewriting-array-in-scripting-dictionary", "title": "VBA Rewriting Array in scripting.dictionary", "body": "<p>I am trying to create a dictionary, with each key being a name I created, and each item an array of three objects: a string, an integer, and an array of what will be the results from a SOAP request. </p>\n\n<p>I initialize the array like this:</p>\n\n<pre><code>Dim riskDict As New Scripting.Dictionary\nriskDict.Add \"Weight\", Array(\"WP\", 0, Array())\n</code></pre>\n\n<p>And I have a function, 'getTheRisk', which returns an X by 4 array (Its a SOAP request. I do not know how many results will come back, but it will be four values returned for each result.) </p>\n\n<p>I would like to then store that result into the third element of the item in my dictionary, attempted like this:</p>\n\n<pre><code>For i = 0 To riskDict.count - 1\n  riskDict.Items(i)(2) = getTheRisk(myDate.Value, myPort.Value, riskDict.Items(i)(0))\nNext i\n</code></pre>\n\n<p>This compiles and runs just fine, but after assigning the array, it shows up as empty in the dictionary:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cPAFS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cPAFS.png\" alt=\"enter image description here\"></a></p>\n\n<p>The getTheRisk function returns something like the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OkeQO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OkeQO.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I set the array in the dict to be the results of the SOAP request?</p>\n"}, {"tags": [".net", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451403876, "post_id": 34514214, "comment_id": 56769308, "body": "On which line does the error actually occur?"}, {"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451403993, "post_id": 34514214, "comment_id": 56769363, "body": "So the error comes up on the screen. Click &#39;debug&#39; and it highlights the line <b>wbb.Close</b>. I will add- Following this script ending after the error. A box prompts me to close the spreadsheet i was attempting to close. So it does seem to be getting somewhere?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451404126, "post_id": 34514214, "comment_id": 56769448, "body": "Is there any code in the <code>Workbook_Open</code> event of the workbook that causes the problem?"}, {"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451404711, "post_id": 34514214, "comment_id": 56769792, "body": "the workbooks.open(file) section seems to work perfectly. Is this what you are referring to? Thank you for your advice."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451404831, "post_id": 34514214, "comment_id": 56769869, "body": "No, I mean is there code in the workbook you are opening (I note they are all macro files) that runs automatically when you open it? Try adding: <code>Application.EnableEvents = False</code> before the <code>Workbooks.Open</code> line and  <code>Application.EnableEvents = True</code> immediately after opening it."}, {"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405032, "post_id": 34514214, "comment_id": 56769996, "body": "There is code there. I thought you had cracked it after reading your logic - it made sense. Unfortunately editing the code to show this    Application.EnableEvents = False                     Set wbb = Workbooks.Open(file)                     Application.EnableEvents = True still leads to the same error on wbb.close :/"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405206, "post_id": 34514214, "comment_id": 56770107, "body": "Does this code fail on all your workbooks or just some of them? (there isn&#39;t actually anything wrong with the code itself)"}, {"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405346, "post_id": 34514214, "comment_id": 56770203, "body": "RORY YOU ARE A G. <b>thank you!</b> I simply left application.enableevents as false until after the wbb was closed. and then avctivated. This works!! Is this simply due to some code within the other workbooks running?"}, {"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405378, "post_id": 34514214, "comment_id": 56770225, "body": "Also is this safe to leave application.enableEvents as false for a longer period than you originally suggested?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405516, "post_id": 34514214, "comment_id": 56770288, "body": "Maybe someone could post an answer....? (@Rory)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451405577, "post_id": 34514214, "comment_id": 56770326, "body": "Unless you want event code to run, it is safe to disable it for longer as long as you <b>ensure</b> it is turned back on again. You could also simply skip selecting sheets - it appears that that may be running code that causes your code to fail."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "edited": false, "score": 1, "creation_date": 1451405893, "post_id": 34514833, "comment_id": 56770506, "body": "Thank you for this, this has shown me the correct way to format my code. However, the application enable events flag was to be set for solution"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "edited": false, "score": 0, "creation_date": 1451406028, "post_id": 34514833, "comment_id": 56770585, "body": "@dazedAndConfused - Gotta love it when it&#39;s some tertiary code doing it, and not your own :P.  Glad you got it figured out!  But yes, I suggest really looking at the above and seeing how I <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">removed <code>.Select</code> so you can work directly with your data</a>, and also explicitly tell each <code>Range</code> what sheet it&#39;s to be from (same would go for using <code>.Cells()</code>, <code>.Rows()</code>, etc.)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1451405643, "creation_date": 1451405643, "answer_id": 34514833, "question_id": 34514214, "link": "https://stackoverflow.com/questions/34514214/vba-workbook-close-function-cannot-make-this-work-within-required-location/34514833#34514833", "title": "VBA Workbook.close function: Cannot make this work within required location", "body": "<p>This may not solve the issue, but I think part of the problem is the multiple workbooks, without explicit references in your <code>Range</code>.  It's worth pointing out, and is too long for a comment.</p>\n\n<p>Try using the below:</p>\n\n<pre><code>Sub filesTest(folder, dex)\nDim wb      As String\nDim wbb     As Workbook\nDim dat, dat2, dat3, dat4\n\nwb = \"xyz.xlsm\"\nFor Each file In folder.Files\n    If file.Name Like \"*.xlsm\" Then\n        If InStr(file.Name, \"~$\") = 0 Then\n            'sendFile (file.Name)\n            Set wbb = Workbooks.Open(file)\n            With wbb\n                dat = .Worksheets(\"Sheet 1\").Range(\"F11\")\n                dat2 = .Worksheets(\"Sheet 2\").Range(\"C54\")\n                dat3 = .Worksheets(\"Sheet 2\").Range(\"D54\")\n                dat4 = .Worksheets(\"Sheet 2\").Range(\"E54\")\n                .Close\n            End With\n\n            With Workbooks(wb)\n                .Range(\"B\" &amp; dex) = dat\n                .Range(\"C\" &amp; dex) = dat2\n                .Range(\"D\" &amp; dex) = dat3\n                .Range(\"E\" &amp; dex) = dat4\n            End With\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>What I did was used <code>With</code> to help explicitly state where the ranges being used are.  That might help, but if not, let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1451405721, "creation_date": 1451405721, "answer_id": 34514853, "question_id": 34514214, "link": "https://stackoverflow.com/questions/34514214/vba-workbook-close-function-cannot-make-this-work-within-required-location/34514853#34514853", "title": "VBA Workbook.close function: Cannot make this work within required location", "body": "<p>It appears you have event code running in the open event and/or sheet activate events, so you can disable that using <code>EnableEvents</code>. There's also a lot of unnecessary selecting:</p>\n\n<pre><code>Sub filesTest(folder, dex)\nDim wb As String\nDim wbb As Workbook\nDim dat\nDim dat2\nDim dat3\nDim dat4\n\nOn Error Goto clean_up\nwb = \"xyz.xlsm\"\n    Application.Enableevents = False\n    For Each file In folder.Files\n        If file.Name Like \"*.xlsm\" Then\n            If InStr(file.Name, \"~$\") = 0 Then\n            'sendFile (file.Name)\n                Set wbb = Workbooks.Open(file)\n\n               dat = wbb.Worksheets(\"Sheet 1\").Range(\"F11\").Value\n               With wbb.Worksheets(\"Sheet 2\")\n                  dat2 = .Range(\"C54\").Value\n                  dat3 = .Range(\"D54\").Value\n                  dat4 = .Range(\"E54\").Value\n               End With\n               wbb.Close\n            Workbooks(wb).Activate\n            Range(\"B\" &amp; dex) = dat\n            Range(\"C\" &amp; dex) = dat2\n            Range(\"D\" &amp; dex) = dat3\n            Range(\"E\" &amp; dex) = dat4\n            End If\n        End If\n    Next\n\nclean_up:\n    Application.Enableevents = True\nEnd Sub  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "is_accepted": false, "score": 1, "last_activity_date": 1451405815, "creation_date": 1451405815, "answer_id": 34514880, "question_id": 34514214, "link": "https://stackoverflow.com/questions/34514214/vba-workbook-close-function-cannot-make-this-work-within-required-location/34514880#34514880", "title": "VBA Workbook.close function: Cannot make this work within required location", "body": "<p>This is the solution:</p>\n\n<pre><code>Sub filesTest(folder, dex)\nDim wb As String\nDim wbb As Workbook\nDim dat\nDim dat2\nDim dat3\nDim dat4\n\nwb = \"xyz.xlsm\"\n    For Each file In folder.Files\n        If file.Name Like \"*.xlsm\" Then\n            If InStr(file.Name, \"~$\") = 0 Then\n        'sendFile (file.Name)\napplication.enableevents = false\n                Set wbb = Workbooks.Open(file)\n                Worksheets(\"Sheet 1\").Select\n               dat = Range(\"F11\")\n                Worksheets(\"Sheet 2\").Select\n                dat2 = Range(\"C54\")\n                dat3 = Range(\"D54\")\n                dat4 = Range(\"E54\")\n               wbb.Close\napplication.enableevents = true\n             Workbooks(wb).Activate\n            Range(\"B\" &amp; dex) = dat\n            Range(\"C\" &amp; dex) = dat2\n            Range(\"D\" &amp; dex) = dat3\n            Range(\"E\" &amp; dex) = dat4\n            End If\n        End If\n    Next\nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4759688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba726d23bb0efb00aa06b7c6f388023?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/4759688/dazedandconfused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1451405815, "creation_date": 1451403512, "question_id": 34514214, "link": "https://stackoverflow.com/questions/34514214/vba-workbook-close-function-cannot-make-this-work-within-required-location", "title": "VBA Workbook.close function: Cannot make this work within required location", "body": "<p>I have this code: </p>\n\n<pre><code>Sub test()\n    Dim wb As String\n    Dim wbb As Workbook\n    wb =     \"C:\\xyz.xlsx\"\n    Set wbb = Workbooks.Open(wb)\n    MsgBox (\"testing\")\n    wbb.Close\nEnd Sub\n</code></pre>\n\n<p>The above does the job just <strong>fine</strong>.\nWorkbook closes <strong>as expected</strong></p>\n\n<p>This code however, <strong>does not</strong> seem to work. But to me it looks <strong>identical</strong> in relation to the workbooks.close function. Can someone please advise why this throws the error \"Run-time error '1004': <strong>Application-defined or object-defined error</strong>\" </p>\n\n<pre><code>Sub filesTest(folder, dex)\nDim wb As String\nDim wbb As Workbook\nDim dat\nDim dat2\nDim dat3\nDim dat4\n\nwb = \"xyz.xlsm\"\n    For Each file In folder.Files\n        If file.Name Like \"*.xlsm\" Then\n            If InStr(file.Name, \"~$\") = 0 Then\n            'sendFile (file.Name)\n                Set wbb = Workbooks.Open(file)\n                Worksheets(\"Sheet 1\").Select\n               dat = Range(\"F11\")\n                Worksheets(\"Sheet 2\").Select\n                dat2 = Range(\"C54\")\n                dat3 = Range(\"D54\")\n                dat4 = Range(\"E54\")\n               wbb.Close\n            Workbooks(wb).Activate\n            Range(\"B\" &amp; dex) = dat\n            Range(\"C\" &amp; dex) = dat2\n            Range(\"D\" &amp; dex) = dat3\n            Range(\"E\" &amp; dex) = dat4\n            End If\n        End If\n    Next\nEnd Sub  \n</code></pre>\n\n<p>I have attempted to move the location of the wbb.close but this does not seem to help at all.</p>\n\n<p>I have also attempted to use an alternative \"Activeworkbook.close false\" and variations on this with exactly the same error message appearing.</p>\n\n<p>I have also confirmed Set wbb = Workbooks.Open(<strong>file</strong>) &lt;-- that the file variable has the same format as the code in the test block</p>\n\n<p>Any help would be much appreciated,</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451401414, "post_id": 34513615, "comment_id": 56767991, "body": "A <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">Select Case statement</a> would be a better fit."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1451401798, "post_id": 34513615, "comment_id": 56768169, "body": "Are you trying to write the actual cell addresses in undefined ranges? Or are you trying to define those ranges to those addresses? If the latter, use the keyword <code>Set</code> in order to define an object variable (such as a range)."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1451401880, "post_id": 34513615, "comment_id": 56768209, "body": "Also, your variable declaration lines are incorrect.  Take a look here at the section <code>Pay Attention To Variables Declared With One Dim Statement</code> <a href=\"http://www.cpearson.com/excel/declaringvariables.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/declaringvariables.aspx</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1451402011, "post_id": 34513615, "comment_id": 56768284, "body": "It works till the last because that is the only one that is declared as a range.  The others are all declared as variants.  And you need to set ranges <code>Set rngSoS = Cells(1, i)</code> no address.  If you want to declare all as ranges then use <code>Dim rngDoN as range, rngARN as range,...</code> and use the set on all."}, {"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1451402554, "post_id": 34513615, "comment_id": 56768612, "body": "@tigeravatar thank you very much, I absolutely was not aware of that (I am selftaught in VBA and have picked up some bad habits it would seem!). Also thank you Scott for clarifying :)"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "edited": false, "score": 0, "creation_date": 1451402224, "post_id": 34513839, "comment_id": 56768422, "body": "That makes perfect sense actually, I didn&#39;t think that what I was returning wasn&#39;t neccessarily a range. Ahh I&#39;m new here and enter posted this rather than giving me a line break!  What I am doing is identifying which columns exist before I attempt to copy any data across, previously in my rather crude solution I simply copied Range(Ax:Kx) and pasted from one sheet to another.  So my plan now is to only copy data across if the columns exist on both sheets and this was the way I was going about doing that (and finding the correct Address to paste the values to)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1451402018, "creation_date": 1451402018, "answer_id": 34513839, "question_id": 34513615, "link": "https://stackoverflow.com/questions/34513615/run-time-error-91-on-a-loop-cant-see-any-reason-for-it/34513839#34513839", "title": "Run time error 91 on a loop - can&#39;t see any reason for it", "body": "<p>You are trying to stuff a string address (text) into an unassigned <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a>. </p>\n\n<pre><code>Dim strDoN, strOffice As String, strARN As String, strPIN As String\nDim strAN As String, strAT As String, strSoS As String\nDim rngDoN As Range, rngOffice As Range, rngARN As Range\nDim rngPIN As Range, rngAN As Range, rngAT As Range, rngSoS As Range\n\nFor i = 1 To 7\n    Select Case Cells(1, i).Value\n        Case strDoN\n            Set rngDoN = Cells(1, i)   '&lt;~~ set the range object to this cell\n        Case strOffice\n            Set rngOffice = Cells(1, i)\n        Case strARN\n            Set rngARN = Cells(1, i)\n        Case strPIN\n            Set rngPIN = Cells(1, i)\n        Case strAN\n            Set rngAN = Cells(1, i)\n        Case strAT\n            Set rngAT = Cells(1, i)\n        Case strSoS\n            Set rngSoS = Cells(1, i)\n        Case Else\n            'no match - do nothing\n    End Select\nNext i\n\nMsgBox rngDoN.Address(0, 0) &amp; Chr(9) &amp; rngOffice.Address(0, 0) &amp; Chr(9) &amp; _\n       rngARN.Address(0, 0) &amp; Chr(9) &amp; rngPIN.Address(0, 0) &amp; Chr(9) &amp; _\n       rngAN.Address(0, 0) &amp; Chr(9) &amp; rngAT.Address(0, 0) &amp; Chr(9) &amp; _\n       rngSoS.Address(0, 0)\n</code></pre>\n\n<p>Your narrative is a little short on what you actually want to accomplish. I've set the range objects to the matching cells and returned their addresses to the message box.</p>\n\n<p>The <code>rngSoS</code> was failing because it is the only one actually declared as a range-type variable.</p>\n"}], "owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451402018, "creation_date": 1451401227, "question_id": 34513615, "link": "https://stackoverflow.com/questions/34513615/run-time-error-91-on-a-loop-cant-see-any-reason-for-it", "title": "Run time error 91 on a loop - can&#39;t see any reason for it", "body": "<p>This is probably something quite obvious, but I have done quite a bit of googling to no avail.</p>\n\n<p>First of all I am more than happy if you have a more succinct way of doing this, I am always keen to learn - this is the best way I could think of to achieve the task.</p>\n\n<p>Basically, once the columns are found I will be transferring data from another sheet that will go at the end of Range(xlDown) and offset by 1 etc.</p>\n\n<p>But at the moment, if i run this as For 1 to 6 it works fine, if I run for 1 to 7 it gives the error but everything is defined in the same way. strSoS is defined, but rngSoS always shows as 'Nothing' even though the other cells work fine?</p>\n\n<p>Columns 1 to 7 have the 7 titles (as stated) in the list of String declarations, the reason it is done this way is that the sheet data will be coming from may have extra columns that wont be required.</p>\n\n<p>Hope you can help solve my issue!</p>\n\n<pre><code>Sub ColumnSearch()\n\nDim strDoN, strOffice, strARN, strPIN, strAN, strAT, strSoS As String\nDim rngDoN, rngOffice, rngARN, rngPIN, rngAN, rngAT, rngSoS As Range\n\nDim myRange As Range\nDim NumCols, i As Integer\n\nstrDoN = \"Date of Notification\"\nstrOffice = \"Office Centre\"\nstrARN = \"Appeal Reference Number\"\nstrPIN = \"PIN\"\nstrAN = \"Appellant Name\"\nstrAT = \"Appeal Type\"\nstrSoS = \"SoS Decision Date\"\n\n\n\nFor i = 1 To 7\n    If Cells(1, i).Value = strDoN Then\n        rngDoN = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strOffice Then\n        rngOffice = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strARN Then\n        rngARN = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strPIN Then\n        rngPIN = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strAN Then\n        rngAN = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strAT Then\n        rngAT = Cells(1, i).Address(False, False)\n    ElseIf Cells(1, i).Value = strSoS Then\n        rngSoS = Cells(1, i).Address(False, False)\n\n    End If\n\nNext i\n\nMsgBox rngDoN &amp; rngOffice &amp; rngARN &amp; rngPIN &amp; rngAN &amp; rngAT &amp; rngSoS\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1451406421, "creation_date": 1451406421, "answer_id": 34515039, "question_id": 34513398, "link": "https://stackoverflow.com/questions/34513398/finding-a-string-embedded-with-several-strings-in-a-single-cell/34515039#34515039", "title": "Finding a string embedded with several strings in a single cell", "body": "<p>Perhaps you would like a function like the below:</p>\n\n<pre><code>Function FoundEMail(groupArray As Variant, emailArray As Variant) As Boolean\n\n    Dim PersonInGroup As Variant, PersonInEMail As Variant, PersonFound As Boolean\n\n    For Each PersonInGroup In groupArray\n        PersonFound = False\n        For Each PersonInEMail In emailArray\n            PersonFound = StrConv(Trim(PersonInGroup), vbUpperCase) = StrConv(Trim(PersonInEMail), vbUpperCase)\n            If PersonFound Then Exit For\n        Next PersonInEMail\n        If Not PersonFound Then Exit Function\n    Next PersonInGroup\n    FoundEMail = True\n\nEnd Function\n</code></pre>\n\n<p>So instead of <code>If firmName = emailMaster.Cells(emrow_num, 1) Then</code> you might have something like <code>If FoundEMail(Split(firmName,\";\"),Split(emailMaster.Cells(emrow_num, 1),\";\")) Then</code></p>\n"}, {"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1451477680, "post_id": 34518710, "comment_id": 56799738, "body": "Thank you for your extensive response.  To clarify, one individual will never require multiple email addresses.  If the firm does not require separate receipts sent to different employees than they receive it in a batch, which is a simple solution of storing the email addresses in standard form separated by semi colons in a single cell.  It&#39;s when multiple employees are connected to one email address that is the problem.  The program is looping through a report by firm for the day and sending receipts to specified customers.  There are really only two levels of classification."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1451478543, "post_id": 34518710, "comment_id": 56800196, "body": "My data storing the email addresses is actually arranged very similar to your example above that you have setup.  I think I am struggling with the logic of checking if the receipt is connected with any of the employees for that one email address. Perhaps I can group them in descending rows rather than increasing columns.  And use a small loop to run through the employees associated with that email address."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1451489270, "post_id": 34518710, "comment_id": 56805959, "body": "@StormsEdge. &quot;The program is looping through a report by firm for the day and sending receipts to specified customers.&quot; I am confused. I thought firm and customer were different names for the same thing. Are you sending a separate email to every contact? Are you sending one email to multiple recipients? Are you aware the property <code>Recipients</code> is a collection?  You add recipients one at a time; you do not need to know in advance how many there are."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1451490637, "post_id": 34518710, "comment_id": 56806722, "body": "Yes, firm and customer are different names for the same thing in 99% of the cases.  In the 1% of cases the firm name is merely an umbrella that groups together other groups that act under that umbrella name.  So Company ABC is the &quot;umbrella&quot; company and then grouped under that umbrella is Company Z, Company x, and Company Y.  Employees sam, mike, and frank work for Company Z, employees jimmy, jack, and james work for company x and bill, bob, and alex work for company Y.  Each of those company&#39;s have a separate email address."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1451490747, "post_id": 34518710, "comment_id": 56806787, "body": "The way that I solved the issue was similar to what you recommended.  I added a conditional that found the individual employees email and if it was the same as the other one (since each company under the umbrella really only has only one email for receipts) than it added their receipts to the email.  It&#39;s working.  Not super eloquent, but I can refactor after it&#39;s fully developed.  Thank you for your help and assistance I apologize that it&#39;s been a bit hard for me to explain my problem.  It&#39;s a bit complex without being able to demonstrate."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 1, "last_activity_date": 1451421454, "creation_date": 1451421454, "answer_id": 34518710, "question_id": 34513398, "link": "https://stackoverflow.com/questions/34513398/finding-a-string-embedded-with-several-strings-in-a-single-cell/34518710#34518710", "title": "Finding a string embedded with several strings in a single cell", "body": "<p>In my view you are mixing three tasks:</p>\n\n<ol>\n<li>modelling your data</li>\n<li>determining a convenient method of holding that data in Excel</li>\n<li>determining a convenient method of holding that data in VBA variables</li>\n</ol>\n\n<p>You need to tackle these tasks in sequence but be willing to revert to a previous task if you encounter problems attempting the current task..</p>\n\n<p>Below is a data model which I have deduced from your question.  This model does not conform to any standard modelling notation but, if you are not a data modeller, I think you will find this notation easier to understand.</p>\n\n<p>You need to send emails to all your customers.  I have shown three example customers.  At Customer1 there is only one person you send emails to who has there own email address.  At Customer2, there are three people to whom you send emails who each have their own email address.  Customer3 is more complicated.  Person13 has their own address but the other contacts share addresses.  For example, EmailAddr5 is shared by Person5, Person6 and Person7.</p>\n\n<pre><code>Customer1\u2500\u2500\u2500\u2500EmailAddr1\u2500\u2500\u2500\u2500Person1\n\nCustomer2\u2500\u252c\u2500\u2500EmailAddr2\u2500\u2500\u2500\u2500Person2\n          \u251c\u2500\u2500EmailAddr3\u2500\u2500\u2500\u2500Person3\n          \u2514\u2500\u2500EmailAddr4\u2500\u2500\u2500\u2500Person4\n\nCustomer3\u2500\u252c\u2500\u2500EmailAddr5\u2500\u252c\u2500\u2500Person5\n          \u2502             \u251c\u2500\u2500Person6\n          \u2502             \u2514\u2500\u2500Person7\n          \u251c\u2500\u2500EmailAddr6\u2500\u252c\u2500\u2500Person8\n          \u2502             \u251c\u2500\u2500Person9\n          \u2502             \u251c\u2500\u2500Person10\n          \u2502             \u251c\u2500\u2500Person11\n          \u2502             \u2514\u2500\u2500Person12\n          \u2514\u2500\u2500EmailAddr7\u2500\u2500\u2500\u2500Person13\n</code></pre>\n\n<p>Is this a correct representation of your data?  I would summarise this as:</p>\n\n<ul>\n<li>There are 1 or many PERSONs per EMAILADDR</li>\n<li>There are 1 or many EMAILADDRs per CUSTOMER</li>\n</ul>\n\n<p>If you are not familiar with modelling data, this may be confusing at first but I believe that with a little study it will become clear.</p>\n\n<p>The question you need to answer is: \u201cIs this a complete description of my data?\u201d  Only when you are convinced there are no special cases not covered by this model can you proceed to Task 2.</p>\n\n<p>Unless your final model is much more complicated than mine, I do not believe you will need two or more worksheets to hold this data.  So, task 2 is to map your data model onto an Excel worksheet.</p>\n\n<p>During task2, the person to consider is the user who will create and maintain this data.  For example, I would have thought holding multiple people in a single cell would be awkward to maintain.  How does this data arrive?  Does Acme Supplies tell you to contact John Smith whose email address is Sales@AcmeSuppliers.Com or do they tell you use Sales@AcmeSuppliers.Com to contact any of: Angela Brown, Cherry White and John Smith?  If data arrives as \u201cname \u2013 address\u201d, the model above may be correct but inconvenient.  Would this be a convenient arrangement of the data for the user to maintain?</p>\n\n<pre><code>Acme Supplies  |  Brown, Angela  |  Sales@AcmeSuppliers.Com\nAcme Supplies  |  Chester, Neal  |  Admin@AcmeSuppliers.Com\nAcme Supplies  |  Smith, John    |  Sales@AcmeSuppliers.Com\nAcme Supplies  |  White, Cherry  |  Sales@AcmeSuppliers.Com\n</code></pre>\n\n<p>With this arrangement, there is a row per person per company.</p>\n\n<p>If you really think your data model is correct, how about:</p>\n\n<pre><code>Acme Supplies|Admin@AcmeSuppliers.Com|Chester, Neal|Sales@AcmeSuppliers.Com|Brown, Angela|Smith, John|White, Cherry|\n</code></pre>\n\n<p>where I am using vertical lines to represent cell boundaries. </p>\n\n<p>What I done is take:</p>\n\n<pre><code>Customer3\u2500\u252c\u2500\u2500EmailAddr5\u2500\u252c\u2500\u2500Person5\n          \u2502             \u251c\u2500\u2500Person6\n          \u2502             \u2514\u2500\u2500Person7\n          \u251c\u2500\u2500EmailAddr6\u2500\u252c\u2500\u2500Person8\n          \u2502             \u251c\u2500\u2500Person9\n          \u2502             \u251c\u2500\u2500Person10\n          \u2502             \u251c\u2500\u2500Person11\n          \u2502             \u2514\u2500\u2500Person12\n          \u2514\u2500\u2500EmailAddr7\u2500\u2500\u2500\u2500Person13\n</code></pre>\n\n<p>and arrange it as:</p>\n\n<pre><code>Customer3|EmailAddr5|Person5|Person6|Person7|EmailAddr6|Person8|Person9| and so on\n</code></pre>\n\n<p>This could work because every address contains the symbol \u201c@\u201d while no name contains this symbol.</p>\n\n<p>As you develop the mapping from the data model to Excel, you may need to revise the data model.  Your original model may be technically correct but implementation in Excel may be inconvenient.  Provided your revised model can handle any combination of company, address and name you can envisage and providing that revised model maps cleanly to Excel you will be all right.</p>\n\n<p>Lastly, task 3 is to map the Excel worksheet to VBA variables.  This depends on how you need to process the data.  For example, you might have a list like:</p>\n\n<pre><code>CompanyA, PersonZ\nCompanyB, PersonY\nCompanyB, PersonX\n    :        :\n</code></pre>\n\n<p>With this it might be easier to leave the data in the worksheet and have code like this:</p>\n\n<pre><code>For each line of list\n  Search for Person\n  If not found\n    Report \u201cNo such person\u201d\n  Else\n    Record row on which first Person found \n    Do While True\n      If Person belongs to Company Then\n        Generate email\n        Exit Do\n      End If\n      Search for next Person\n      If row for Person is the row for the first Person Then\n        Report \u201cNo such person\u201d\n        Exit Do\n      End If\n     Loop\n  End If\nNext\n</code></pre>\n\n<p>I think the above is as much as I can offer because there is too much uncertainty about your requirement.  This may be enough for you to solve your own problem.  If not, you need update your question clarify your requirement.</p>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 34518710, "answer_count": 2, "score": 0, "last_activity_date": 1451421454, "creation_date": 1451400435, "last_edit_date": 1451406105, "question_id": 34513398, "link": "https://stackoverflow.com/questions/34513398/finding-a-string-embedded-with-several-strings-in-a-single-cell", "title": "Finding a string embedded with several strings in a single cell", "body": "<p>Working on a large macro to automate an end of day email process that involves sending emails to different customers.  Everything is working fairly well except in the several instances that some firms have different emails for different employees.  It would be simple if these employees were the only ones that would be sent to that email, but that is of course not the case.  </p>\n\n<p>I'm struggling to find a solution to finding the names and referencing the email.  But referencing multiple names without knowing how many names it could be ahead of time (meaning in the future a firm could have 10 employees with the same email confirmation and some may have as little as 1 (for those that require separate emails per employee)).  Would I use an array for this and test against the array?  I would also need to store the employee names in order to ensure duplicates aren't created. See Text example and code below:</p>\n\n<p>The names are stored in a sheet named emailMaster in this format say starting in cell(1,3) (Joe GoodGuy; James Johanson; Jimmy TheHat (All encapsulated in one cell)) and the email they correspond to is found at .Offset(0,1). To clarify, these gentlemen may work for the firm \"CodersUnited\", but their may be another group from the firm \"CodersUnited\", who require a different email address for their end of day receipts and they could be in cell(1,5) (Jimmy John; Franky TwoToes; Jimmy Hendrix) and their corresponding email found in .Offset(0,1).</p>\n\n<pre><code>Row   ____________________C____________________  __D___  ___________________E____________________  __F__\n 1    Joe GoodGuy; James Johanson; Jimmy TheHat  Emails  Jimmy John; Frank TwoToes; Jimmy Hendrix  Email\n</code></pre>\n\n<p>The solution below only works if their is one name corresponding to one email.  There needs to be multiple names corresponding to one email.</p>\n\n<pre><code>'Gets firm name\n            If firmName = emailMaster.Cells(emrow_num, 1) Then\n                continue = False\n                cFirm = firmName\n                iFirm = emailMaster.Cells(emrow_num, 2)\n\n                If IsEmpty(emailMaster.Cells(emrow_num, 4)) = True Then\n                    firmEmail = emailMaster.Cells(emrow_num, 3)\n\n                'Tests for separate employee emails \n                ElseIf emailMaster.Cells(emrow_num, 4) = \"Yes\" Then\n                    empSeparate = True\n\n                    'Captures separate emp email\n                    Set empTestFinder = emailMaster.Rows(emrow_num).Find(empName)\n                    empFinder = empTestFinder.Address\n                    firmEmail = emailMaster.Range(empFinder).Offset(0, 1)\n\n                    Else\n                        MsgBox (\"Firm designated as different emails for employees.  Either change designation of firm or add employee.  Contact dev for more assistance.\")\n                        Exit Sub\n                    End If\n                End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5385652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1938fe0b173009d4dc041dc0b4bfc8c0?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Brazil", "link": "https://stackoverflow.com/users/5385652/andy-brazil"}, "is_accepted": false, "score": 0, "last_activity_date": 1451406192, "creation_date": 1451406192, "answer_id": 34514979, "question_id": 34512742, "link": "https://stackoverflow.com/questions/34512742/export-table-names-and-column-names-of-each-table-in-one-excel-sheet-using-vba-a/34514979#34514979", "title": "Export table names and column names of each table in one excel sheet using vba access", "body": "<p>This should get you started</p>\n\n<pre><code>Sub AllTables()\nDim xl As New excel.Application\nDim wb As excel.workbook\nDim ws As excel.worksheet\nSet wb = xl.workbooks.Add\nSet ws = wb.worksheets.Add\nDim r As range\nDim x As Integer\nSet r = ws.range(\"a1\")\nDim dbs As Database\nSet dbs = Application.CurrentDb\nDim td As TableDef\nDim f As Field\nFor Each td In dbs.TableDefs\n    If Left(td.Name, 4) &lt;&gt; \"MSys\" Then\n         r = td.Name\n         x = 2\n         For Each f In td.Fields\n             r.offset(0, x) = f.Name\n             x = x + 1\n         Next f\n         Set r = r.offset(1, 0)\n   End If\nNext td\n\nEnd Sub\n</code></pre>\n\n<p>This requires you to set a reference to excel in the access vba editor (using Tools,References...)</p>\n"}], "owner": {"reputation": 119, "user_id": 5078957, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-AbV-WEjEZOY/AAAAAAAAAAI/AAAAAAAAASU/CKQC0VauqMs/photo.jpg?sz=128", "display_name": "Rishav Tripathi", "link": "https://stackoverflow.com/users/5078957/rishav-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451406192, "creation_date": 1451398032, "question_id": 34512742, "link": "https://stackoverflow.com/questions/34512742/export-table-names-and-column-names-of-each-table-in-one-excel-sheet-using-vba-a", "title": "Export table names and column names of each table in one excel sheet using vba access", "body": "<p>I am trying to write a code for exporting all the name of the tables and their columns from database into one excel sheet. </p>\n\n<p>The code done till now is exporting all the tables with their complete information into excel sheets (each table generates one excel sheet but i don'want like this).\nBelow is the code :</p>\n\n<pre><code>Private Sub Commande49_Click()\nOn Error GoTo Err_Commande49_Click\n Dim strOut As String\n  Dim tbl As AccessObject\n  Dim f As Boolean\n  With Application.FileDialog(4) ' msoFileDialogFolderPicker\n    .Title = \"Please select the target folder\"\n    If .Show Then\n      strOut = .SelectedItems(1)\n      If Not Right(strOut, 1) = \"\\\" Then\n        strOut = strOut &amp; \"\\\"\n      End If\n    Else\n      MsgBox \"You didn't select a target folder.\", vbExclamation\n      Exit Sub\n    End If\n  End With\n  f = (MsgBox(\"Do you want to export all tables to Excel (No = CSV)?\", _\n    vbQuestion + vbYesNo) = vbYes)\n  For Each tbl In CurrentData.AllTables\n    If Not tbl.Name Like \"MSys*\" And Not tbl.Name Like \"~\" Then\n      If f Then\n        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, _\n          tbl.Name, strOut &amp; tbl.Name &amp; \".xlsx\", True\n      Else\n        DoCmd.TransferText acExportDelim, , _\n          tbl.Name, strOut &amp; tbl.Name &amp; \".csv\", True\n      End If\n    End If\n  Next tbl\nExit_Commande49_Click:\n    Exit Sub\n</code></pre>\n\n<p>Can anyone please help me with this issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1451397372, "post_id": 34512464, "comment_id": 56765794, "body": "Do you have abbreviations like Houston =&gt; H, Texas =&gt; TX stored somewhere?"}, {"owner": {"reputation": 45, "user_id": 5099545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cb7529eae3039c368fe8dd06b0a5f400?s=128&d=identicon&r=PG&f=1", "display_name": "huSh", "link": "https://stackoverflow.com/users/5099545/hush"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1451398312, "post_id": 34512464, "comment_id": 56766302, "body": "I do not.  It does come from a list of only 22 possibilities.  I used cities and states because it&#39;s easier to explain that.  I guess I would need a bunch of if statements to go through all of the options?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1451398795, "post_id": 34512464, "comment_id": 56766540, "body": "Well -- if you store your abbreviations as tables in Excel then your 4th column could be constructed using the built-in Excel functions <code>VLOOKUP</code> and <code>CONCATENATE</code> with no VBA at all. Also -- does your second column make sense in all cases? Not every country has states"}, {"owner": {"reputation": 45, "user_id": 5099545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cb7529eae3039c368fe8dd06b0a5f400?s=128&d=identicon&r=PG&f=1", "display_name": "huSh", "link": "https://stackoverflow.com/users/5099545/hush"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1451398901, "post_id": 34512464, "comment_id": 56766593, "body": "I guess that was a bad example.  Given the actual case I need this for, everything will make sense.  If I wanted to use VBA, would you have any suggestions?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1451399375, "post_id": 34512464, "comment_id": 56766879, "body": "you will not get much VBA help if you do not show any of your own coding efforts to get what you want to get done. If you show your efforts, it will become much more clear what you want to do. Right now, it seems as if Excel formulas would suffice, and its always best to use Excel&#39;s built-in functions before using VBA."}, {"owner": {"reputation": 45, "user_id": 5099545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cb7529eae3039c368fe8dd06b0a5f400?s=128&d=identicon&r=PG&f=1", "display_name": "huSh", "link": "https://stackoverflow.com/users/5099545/hush"}, "edited": false, "score": 0, "creation_date": 1451399491, "post_id": 34512464, "comment_id": 56766940, "body": "I don&#39;t have any written code for this.  I don&#39;t know VBA very well so I don&#39;t know where this would start.  Once I know what the right approach is then I will most likely not have a problem with the coding.  I&#39;ll try using the built-in features and see if that works."}, {"owner": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 0, "creation_date": 1451399626, "post_id": 34512464, "comment_id": 56767000, "body": "You better start with the tutorials found in the tag-wiki:<a href=\"http://stackoverflow.com/tags/vba/info\">stackoverflow.com/tags/vba/info</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5099545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cb7529eae3039c368fe8dd06b0a5f400?s=128&d=identicon&r=PG&f=1", "display_name": "huSh", "link": "https://stackoverflow.com/users/5099545/hush"}, "edited": false, "score": 0, "creation_date": 1451403611, "post_id": 34513915, "comment_id": 56769172, "body": "This is perfect, you nailed it! Thank you so much.  I was looking for some direction, but you&#39;ve done way more than I could have asked.  Thank you again."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1451402293, "creation_date": 1451402293, "answer_id": 34513915, "question_id": 34512464, "link": "https://stackoverflow.com/questions/34512464/how-to-loop-through-excel-columns-and-print-string-in-new-column/34513915#34513915", "title": "How to loop through excel columns and print string in new column", "body": "<p>To get you started, here is a VBA solution. It uses a public <code>Dictionary</code> object. These really come from VBScript but can be used in VBA in a couple of ways, including by <code>CreateObject</code>. The dictionary is initialized just once, the first time the corresponding <code>Abbreviate</code> function is called. This function takes a range, and for each cell in the range sees if there is a corresponding dictionary key. If so -- the corresponding value is concatenated onto the growing string, if not -- the value itself is. I am making keys upper case so as to make everything case-insensitive:</p>\n\n<pre><code>Public Abbreviations As Variant\nPublic Initialized As Boolean\n\nSub Initialize()\n    Dim A As Variant, i As Long, n As Long\n    'modify the following:\n    A = Array(\"Houston\", \"H\", \"Dallas\", \"D\", \"Cleveland\", \"C\", _\n              \"Toronto\", \"T\", \"Texas\", \"TX\", \"Ohio\", \"OH\", _\n              \"Ontario\", \"ON\", \"Canada\", \"CAN\")\n    n = UBound(A) - 1\n    Set Abbreviations = CreateObject(\"Scripting.Dictionary\")\n    For i = 0 To n Step 2\n        Abbreviations.Add UCase(A(i)), A(i + 1)\n    Next i\n    Initialized = True\nEnd Sub\n\nFunction Abbreviate(R As Range) As String\n    Dim i As Long, s As String\n    Dim cell As Range\n\n    If Not Initialized Then Initialize\n    For Each cell In R.Cells\n        If Abbreviations.exists(UCase(cell)) Then\n            s = s &amp; Abbreviations(UCase(cell))\n        Else\n            s = s &amp; UCase(cell)\n        End If\n    Next cell\n    Abbreviate = s\nEnd Function\n</code></pre>\n\n<p>A screenshot of how it works:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aPJb2.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aPJb2.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 5099545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cb7529eae3039c368fe8dd06b0a5f400?s=128&d=identicon&r=PG&f=1", "display_name": "huSh", "link": "https://stackoverflow.com/users/5099545/hush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "accepted_answer_id": 34513915, "answer_count": 1, "score": 0, "last_activity_date": 1451402293, "creation_date": 1451397056, "last_edit_date": 1531164843, "question_id": 34512464, "link": "https://stackoverflow.com/questions/34512464/how-to-loop-through-excel-columns-and-print-string-in-new-column", "title": "How to loop through excel columns and print string in new column", "body": "<p>My title might not be clear so I'll try to explain it with an example.</p>\n\n<p>Let's say I have an excel sheet with one column for city names and another column for state names and a third column for country names.  I want to loop through the columns and in a 4th column print what was found in the other 3 columns.  So let's say column one is \"Houston\", column two is \"Texas\", and column three is \"USA\", how would I print to the fourth column \"HTXUSA\"?  I have almost no experience in VB in Excel so I'm hoping someone will be able to help.</p>\n\n<p>I searched for similar topics but couldn't find anything that was helpful.  A couple threads helped a little bit, but I still don't have this figured out.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451584839, "post_id": 34512307, "comment_id": 56842258, "body": "Once you&#39;ve added the values to the table(s) do the new entries show up if you click on the Navigation Pane and hit [F5]? Do they appear if you close and re-open the database?"}, {"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451585450, "post_id": 34512307, "comment_id": 56842450, "body": "Thanks, unfortunately no they don&#39;t, either by pressing F5 or by closing and opening the database."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451592961, "post_id": 34512307, "comment_id": 56844795, "body": "Are you only adding the linked tables when you first open the front-end, or is it something that can it happen any time after?"}, {"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451593483, "post_id": 34512307, "comment_id": 56844953, "body": "I&#39;m using a form to select the destination database. When I select the destination database, I drop the previous linked tables then re-create the linked tables. I only have a normal path to the database like &quot;C:\\path\\to\\database.accdb&quot;. Then I make a query to find the IDs of the new linked tables and I insert a new row to the SysNavPaneGroupToObjects table, having object ID the ID of the linked table, and group id the id of the group I&#39;ve already added. Since it&#39;s working sometimes, and my 6 tables split to two diffrent groups, I believe this is somewhat correct."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451935507, "post_id": 34512307, "comment_id": 56942140, "body": "<i>&quot;Sometimes it works, but most of the times I only see empty groups.&quot;</i> - Further to Wayne&#39;s code comment in his <a href=\"http://stackoverflow.com/a/27389179/2144390\">answer to the other question</a> where he says &quot;This [MSysNavPaneObjectIDs] table gets rebuilt at the whim of Access&quot; ... Could you try running the code (that updates the MSysNavPane* tables) from another application, e.g., another Access database, a VBScript, or whatever, <i>while the database being updated is <b>not</b> open in MSACCESS.EXE</i> to see if the results are more consistent?"}, {"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1451939553, "post_id": 34512307, "comment_id": 56944240, "body": "I will give it a try tomorrow. I tested the 2 answers in this question but they don&#39;t work. So now I&#39;m thinking it might not have to do with refreshing the navigation pane, but maybe there is a pattern in the MSysNavPane* tables that &quot;blocks&quot; it from updating properly. I will try to manually drag and drop some tables and see if I can recognize it and replicate the correct behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "edited": false, "score": 0, "creation_date": 1451590308, "post_id": 34550180, "comment_id": 56844012, "body": "Thanks, I will have to try that on Monday, since I don&#39;t have ms-access at home. I will let you know if it works"}, {"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "edited": false, "score": 0, "creation_date": 1452204597, "post_id": 34550180, "comment_id": 57077919, "body": "I did try your suggestion but it didn&#39;t make any difference, so I think there is a conflict between ms-access updating the tables and my code updating the tables at the same time. I will update the question or provide an answer when I finally resolve this. Thanks for your time anyway."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 4, "last_activity_date": 1451585670, "creation_date": 1451585670, "answer_id": 34550180, "question_id": 34512307, "link": "https://stackoverflow.com/questions/34512307/how-to-refresh-navigation-pane-using-vba/34550180#34550180", "title": "How to refresh navigation pane using VBA", "body": "<p>Try the following <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221557%28v=office.11%29.aspx\" rel=\"nofollow\">method</a>:</p>\n\n<pre><code>Application.RefreshDatabaseWindow\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>CurrentDb.TableDefs.Refresh\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "edited": false, "score": 0, "creation_date": 1452204619, "post_id": 34565280, "comment_id": 57077934, "body": "I did try your suggestion but it didn&#39;t make any difference, so I think there is a conflict between ms-access updating the tables and my code updating the tables at the same time. I will update the question or provide an answer when I finally resolve this. Thanks for your time anyway."}], "tags": [], "owner": {"reputation": 716, "user_id": 2895831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/611c415418ec891cfd415dfa76ce336d?s=128&d=identicon&r=PG", "display_name": "Alex Hedley", "link": "https://stackoverflow.com/users/2895831/alex-hedley"}, "is_accepted": false, "score": 1, "last_activity_date": 1451733589, "creation_date": 1451733589, "answer_id": 34565280, "question_id": 34512307, "link": "https://stackoverflow.com/questions/34512307/how-to-refresh-navigation-pane-using-vba/34565280#34565280", "title": "How to refresh navigation pane using VBA", "body": "<p>There was a bug in access where you had to refresh the nav pane for them to show up or even close and re-open.</p>\n\n<p>Another option is to hide then show but that's probably just refreshing it like the other suggestion</p>\n\n<hr>\n\n<p><strong>Hide</strong></p>\n\n<pre><code>DoCmd.RunCommand acCmdWindowHide\n</code></pre>\n\n<p><strong>Show</strong></p>\n\n<pre><code>DoCmd.SelectObject acTable, , True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "edited": false, "score": 0, "creation_date": 1452204276, "post_id": 34657749, "comment_id": 57077783, "body": "Unfortunately I didn&#39;t have time to thoroughly test any of these suggestions this week, and I just realized I have to award the bounty to someone soon. It was a bad choice to start this question between holidays :) So I will award the bounty to this answer, because I have a feeling it is not a refreshing issue after all, and I will edit / update the question as soon as I understand what is causing this problem. Thanks for your suggestions Gord."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1452204881, "last_edit_date": 1495542197, "creation_date": 1452177257, "answer_id": 34657749, "question_id": 34512307, "link": "https://stackoverflow.com/questions/34512307/how-to-refresh-navigation-pane-using-vba/34657749#34657749", "title": "How to refresh navigation pane using VBA", "body": "<p>If the changes written to the <code>MSysNav*</code> tables do not always appear in the Navigation Pane itself, even after closing and re-opening the database, then this is not really a \"refresh\" issue. Something else might be interfering with the updates to those tables, rendering your changes ineffective.</p>\n\n<p>In an <a href=\"https://stackoverflow.com/a/27389179/2144390\">answer to a related question</a> Wayne G. Dunn suggests that \"This [MSysNavPaneObjectIDs] table gets rebuilt at the whim of Access\", which could conceivably conflict with updates to that table from an application's VBA code. If that is true and MSACCESS.EXE expects (effectively) exclusive access to the <code>MSysNav*</code> system tables while it has a database open, then a workaround would be to ensure that the database being modified is <em>not</em> open in MSACCESS.EXE when the <code>MSysNav*</code> modifications are being applied.</p>\n\n<p>One way to do that would be to use VBA code in the \"main\" database to </p>\n\n<ol>\n<li>write the pertinent details to a temporary text file</li>\n<li>launch a separate process that will perform the updates, and then immediately</li>\n<li>close the \"main\" database using <code>Application.Quit</code>.</li>\n</ol>\n\n<p>The separate process could be running code in another Access database, a VBScript, or whatever you prefer. It would </p>\n\n<ol>\n<li>read the pertinent details from the temporary text file,</li>\n<li>update the <code>MSysNav*</code> tables in the main database while MSACCESS.EXE does not have it open,</li>\n<li>delete the temporary text file,</li>\n<li>re-launch MSACCESS.EXE with the main database, and then</li>\n<li>terminate itself.</li>\n</ol>\n\n<p>The \"pertinent details\" to be shared between the two processes would depend on the implementation details of this approach, but would likely include</p>\n\n<ul>\n<li>the full path to the \"main\" database (so the separate process can find it),</li>\n<li>the full path to the relevant copy of MSACCESS.EXE (so the separate process can re-load the main database when it is finished), and</li>\n<li>the item(s) to be added or updated in the <code>MSysNav*</code> tables of the main database.</li>\n</ul>\n"}], "owner": {"reputation": 400, "user_id": 1951487, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/956fe752648e2e610913f7cf99b98207?s=128&d=identicon&r=PG", "display_name": "George Sofianos", "link": "https://stackoverflow.com/users/1951487/george-sofianos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4227, "favorite_count": 3, "answer_count": 3, "score": 2, "last_activity_date": 1452204881, "creation_date": 1451396472, "last_edit_date": 1495540232, "question_id": 34512307, "link": "https://stackoverflow.com/questions/34512307/how-to-refresh-navigation-pane-using-vba", "title": "How to refresh navigation pane using VBA", "body": "<p>I have a front end database, and I dynamically add some linked tables to the back end database. Next, I'm reading their IDs from the hidden system tables in order to add them to the navigation pane, in some custom groups I have created. </p>\n\n<p>While I believe I'm using the correct tables / values, I can't find any way to refresh the navigation pane after I'm finished with the inserts in MSysNavPaneGroupToObjects table.</p>\n\n<p>The only information for something close to what I'm trying to achieve can be found here: <a href=\"https://stackoverflow.com/questions/27366038/change-navigation-pane-group-in-access-through-vba\">Change Navigation pane group in access through vba</a></p>\n\n<p>But in my case, all values are being created successfully (I think), but I can't see the entries in the navigation pane. Sometimes it works, but most of the times I only see empty groups.</p>\n\n<p>I wonder if anyone has solve something similar or there is a documentation/forum I can find more information. Thanks </p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451396265, "post_id": 34512169, "comment_id": 56765230, "body": "Perhaps <code>element.Value = &quot;search-alias=stripbooks&quot;</code>"}, {"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "edited": false, "score": 0, "creation_date": 1451396574, "post_id": 34512169, "comment_id": 56765406, "body": "Hi, no unfortunatelly it also does nothing. (also no error is returned)"}, {"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "edited": false, "score": 0, "creation_date": 1451399461, "post_id": 34512169, "comment_id": 56766920, "body": "ok, now is saw - IT is working, it just was not refreshed in the screen. Sorry for that, and thanks a lot Jeeped!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451399547, "post_id": 34512169, "comment_id": 56766963, "body": "I was just composing a reply to state the same."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1451399525, "creation_date": 1451399525, "answer_id": 34513125, "question_id": 34512169, "link": "https://stackoverflow.com/questions/34512169/change-amazon-combobox-via-vba/34513125#34513125", "title": "Change Amazon ComboBox via VBA", "body": "<p>Changing the value of the <strong>&lt;select&gt;</strong> element is a small matter. Whether it is critically important to also update the screen to reflect the change is another matter.</p>\n\n<pre><code>'try to get dropdown box/ I think it is working fine,\nSet element = IE.Document.getElementByID(\"searchDropdownBox\")   '.Item(0) &lt;~~ do not need this on the end\n\n'try to change a value of dropdown box/ It does nothing\nelement.selectedIndex = 4  'set to Arts, Crafts and Sewing\nelement.Value = \"search-alias=stripbooks\"   'set to Books\n</code></pre>\n\n<p>If you step through your code with F8 you can first set the <strong>searchDropdownBox</strong> select element to <em>Arts, Crafts and Sewing</em> and confirm this by returning to the visible IE window and clicking the select dropdown. Tap F8 once more and you can similarly confirm that the selection is set to <em>Books</em>.</p>\n"}], "owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "accepted_answer_id": 34513125, "answer_count": 1, "score": 2, "last_activity_date": 1451399525, "creation_date": 1451396007, "question_id": 34512169, "link": "https://stackoverflow.com/questions/34512169/change-amazon-combobox-via-vba", "title": "Change Amazon ComboBox via VBA", "body": "<p>I try to write a VBA macro which automatize my work in Internet Explorer. My goal is to catch already opened Amazon webpage, and make a value of dropdown menu for \"Books\".\nCurrently I am able to catch running Amazon website, but I do not know how to change a value of dropdown menu. </p>\n\n<pre><code>Sub amazonCheck()\n\nDim element As Object\nDim i As Integer\n\n\n'get opened Amazon session\nDim shellWins As ShellWindows\nDim IE As InternetExplorer\n\nSet shellWins = New ShellWindows\ni = shellWins.Count\n\nOn Error Resume Next\nFor i = 0 To i\n    If shellWins.Item(i).Parent = \"Internet Explorer\" Then\n        Debug.Print shellWins.Item(i).Document.URL\n        shellWins.Item(i).Visible = True\n\n        If shellWins.Item(i).Document.URL = \"http://www.amazon.com/\" Then\n            Set IE = shellWins.Item(i)\n            Exit For\n        End If\n    End If\nNext i\nOn Error GoTo 0\n\n\n'try to get dropdown box/ I think it is working fine,\nSet element = IE.Document.getElementByID(\"searchDropdownBox\").Item(0)\n\n'try to change a value of dropdown box/ It does nothing\nelement.Value = \"Books\"\nEnd Sub\n</code></pre>\n\n<p>Here you can see an example of Amazon HTML code (I do not know HTML it is possible, that I'm searching in wrong part of code)</p>\n\n<pre><code>&lt;select class=\"nav-search-dropdown searchSelect\" data-nav-digest=\"zOQ511tmF9BlHuHLk7aFmmjL+iA\" data-nav-selected=\"0\" id=\"searchDropdownBox\" name=\"url\" tabindex=\"18\" title=\"Search in\"&gt;\n&lt;option selected=\"selected\" value=\"search-alias=aps\"&gt;All Departments&lt;/option&gt;\n&lt;option value=\"search-alias=instant-video\"&gt;Amazon Video&lt;/option&gt;\n&lt;option value=\"search-alias=appliances\"&gt;Appliances&lt;/option&gt;\n&lt;option value=\"search-alias=mobile-apps\"&gt;Apps &amp;amp; Games&lt;/option&gt;\n&lt;option value=\"search-alias=arts-crafts\"&gt;Arts, Crafts &amp;amp; Sewing&lt;/option&gt;\n&lt;option value=\"search-alias=automotive\"&gt;Automotive&lt;/option&gt;\n&lt;option value=\"search-alias=baby-products\"&gt;Baby&lt;/option&gt;\n&lt;option value=\"search-alias=beauty\"&gt;Beauty&lt;/option&gt;\n&lt;option value=\"search-alias=stripbooks\"&gt;Books&lt;/option&gt;\n&lt;option value=\"search-alias=popular\"&gt;CDs &amp;amp; Vinyl&lt;/option&gt;\n.\n.\n.\n&lt;/select&gt;\n</code></pre>\n\n<p>I do not know HTML, it migh be very easy or impossible to do.\nDo you have any tips?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "save-as"], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1451981444, "post_id": 34512727, "comment_id": 56959013, "body": "The thing is that I have to save it on an online drive and not a local one."}, {"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1451982363, "post_id": 34512727, "comment_id": 56959475, "body": "Also I get the error &quot;This action cannot be completed because the application() is not responding. Choose to switch To to activate and correct the problem&quot;. When I click on the &quot;Switch&quot; button, I get the box where I can save it where I want, which is not the thing I want."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1451983309, "post_id": 34512727, "comment_id": 56959921, "body": "It seems as there is no way around specifying the full path. Thus, you have to obtain that path before calling <code>.SaveAs</code>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1451397969, "creation_date": 1451397969, "answer_id": 34512727, "question_id": 34511073, "link": "https://stackoverflow.com/questions/34511073/access-saveas-function-with-database-data/34512727#34512727", "title": "Access SaveAs function with database data", "body": "<p>You probably will have to specify the drive as well:</p>\n\n<pre><code>.SaveAs \"D:\\CAN'T SHOW THIS\\\" &amp; rst![GnrSerie] &amp; \"\\\" &amp; rst![Gnr] &amp; \"\\\" &amp; rst![GnrSerie] &amp; \"-\" &amp; rst![Gnr], wdFormatDocument\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642966, "creation_date": 1451392094, "last_edit_date": 1594642966, "question_id": 34511073, "link": "https://stackoverflow.com/questions/34511073/access-saveas-function-with-database-data", "title": "Access SaveAs function with database data", "body": "<p>I'm trying to save a template on a specific place. For example, if a product have the GnrSerie = 1000, it should go to that folder, and then the if the Gnr = E2000, it should go to that folder and then name the file GnrSerie + \"-\" + Gnr.</p>\n\n<p>I use the following code to save the file:</p>\n\n<pre><code>  .SaveAs \"CAN'T SHOW THIS\\\" &amp; rst![GnrSerie] &amp; \"\\\" &amp; rst![Gnr] &amp; \"\\\" &amp; rst![GnrSerie] &amp; \"-\" &amp; rst![Gnr], wdFormatDocument\n</code></pre>\n\n<p>Further more, I am connected to the databases/tables where GnrSerie and Gnr is placed</p>\n\n<pre><code>Dim rst As DAO.Recordset\nDim sql As String\nDim db As Database\n\nSet db = CurrentDb\n\nsql = \"SELECT * FROM Projektdata WHERE Sagsnr Like '*\" &amp; Forms!Sag_Form!SagNr &amp; \"*'\"\nSet rst = db.OpenRecordset(sql, dbOpenDynaset)\n</code></pre>\n\n<p>When I run it, it just pops up and ask me where I want to save the file.</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451392323, "post_id": 34511043, "comment_id": 56762976, "body": "Maybe <code>If LCase(myValue1) = &quot;c&quot; Then</code> (more universal solution coming soon below)."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "edited": false, "score": 0, "creation_date": 1451454891, "post_id": 34511183, "comment_id": 56788993, "body": "Thanks ! Putting the &quot; &quot; around the letter worked out ."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 1, "last_activity_date": 1451392483, "creation_date": 1451392483, "answer_id": 34511183, "question_id": 34511043, "link": "https://stackoverflow.com/questions/34511043/vba-customized-filtering-via-keyword-over-wide-column-range/34511183#34511183", "title": "VBA customized filtering via Keyword over wide column-range", "body": "<p>Not sure this is the only problem, but</p>\n\n<pre><code>If myValue1 = c Then\n</code></pre>\n\n<p>c is considered to be an undeclared variable, hence c=\"\", so this line actually means:</p>\n\n<pre><code>If myValue1 = \"\" Then\n</code></pre>\n\n<p>This applies to all your elseif statements too.</p>\n\n<p>Just use quotation marks:</p>\n\n<pre><code>If myValue1 = \"c\" Then\n</code></pre>\n\n<p>Remember that by default, VBA is case sensitive in string comparison. So you will either have to add:</p>\n\n<pre><code>Option Compare Text\n</code></pre>\n\n<p>on the top of your module, above your first Sub, or you can use this format:</p>\n\n<pre><code>If UCase(myValue1) = \"C\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1451392693, "creation_date": 1451392693, "answer_id": 34511249, "question_id": 34511043, "link": "https://stackoverflow.com/questions/34511043/vba-customized-filtering-via-keyword-over-wide-column-range/34511249#34511249", "title": "VBA customized filtering via Keyword over wide column-range", "body": "<p>Here is a more universal solution to filtering an unknown column for an unknown text string.</p>\n\n<pre><code>Dim myValue1 As String, myValue2 As String, myColumn As Long\n\nmyValue1 = InputBox(\"Enter desired Column\")\nmyValue2 = InputBox(\"Enter Keyword in selected column\")\n\nIf IsNumeric(myValue1) Then\n    myColumn = Range(\"R1C\" &amp; myValue1).Column\nElse\n    myColumn = Range(myValue1 &amp; 1).Column\nEnd If\n\nWith Worksheets(\"pump\")\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With .Columns(myColumn)\n        .AutoFilter Field:=1, Criteria1:=myValue2\n    End With\nEnd With\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>The user can input either the numerical column index or the column alphabetic label and the code will determine the correct column to filter on.</p>\n"}], "owner": {"reputation": 91, "user_id": 5698354, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/678a144d4cd9ad35fd51b05b273f80a7?s=128&d=identicon&r=PG&f=1", "display_name": "user36510", "link": "https://stackoverflow.com/users/5698354/user36510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 34511183, "answer_count": 2, "score": 0, "last_activity_date": 1451458244, "creation_date": 1451392005, "last_edit_date": 1451458244, "question_id": 34511043, "link": "https://stackoverflow.com/questions/34511043/vba-customized-filtering-via-keyword-over-wide-column-range", "title": "VBA customized filtering via Keyword over wide column-range", "body": "<p>I am trying to program a filtering option over a wide range of Excel-Columns. I tried to do it via Inputboxes and If/Then-sequence like bellow but for some reason it runs through to the final Else-statement \"does not exist\". It seems it isn't recognizing my input.</p>\n\n<pre><code>  Sub MultipleColumnsFilter()\n\n  Range(\"N:N,U:U\").ClearContents\n\n  Application.ScreenUpdating = False\n\n  Dim myValue1 As String\n  Dim myValue2 As String\n\n\n  myValue1 = InputBox(\"Enter desired Column\")\n  myValue2 = InputBox(\"Enter Keyword in selected column\")\n\n\nIf myValue1 = c Then\n\nWith Worksheets(\"pump\").Range(\"C:C\")\n    .AutoFilter\n     '** Use temporary column 1\n    .AutoFilter Field:=1, Criteria1:=myValue2\nEnd With\nApplication.ScreenUpdating = True\n\nElseIf myValue1 = d Then\n\n With Worksheets(\"pump\").Range(\"D:D\")\n    .AutoFilter\n     '** Use temporary column 1\n    .AutoFilter Field:=1, Criteria1:=myValue2\nEnd With\nApplication.ScreenUpdating = True\n\nElseIf myValue1 = E Then\n With Worksheets(\"pump\").Range(\"E:E\")\n    .AutoFilter\n     '** Use temporary column 1\n    .AutoFilter Field:=1, Criteria1:=myValue2\nEnd With\nApplication.ScreenUpdating = True\n\n\nElseIf myValue1 = I Then\n With Worksheets(\"pump\").Range(\"I:I\")\n    .AutoFilter\n     '** Use temporary column 1\n    .AutoFilter Field:=1, Criteria1:=myValue2\nEnd With\nApplication.ScreenUpdating = True\n\nElse\n\nMsgBox (\" does not exist \")\n\nEnd If\n</code></pre>\n\n<p>Ofcourse it would be even better to let go of the If-else structure and go over some kind of Range function including multiple columns for the desired filtering-area, but when I tried it, it didn't work either.\nAny clues ?</p>\n\n<p>Edit: Furthermore I would like to expand the functionality and use the same structure for filtering items OUT, depending on some keyords (myValue2).\nHow could this work? I changed the filtering part as follows</p>\n\n<pre><code> .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;myValue2\"\n</code></pre>\n\n<p>but this does not seem to work, it just runs through the script without error but also without any effect on the cells.\nAny ideas ?</p>\n"}, {"tags": ["vba", "outlook", "active-directory"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2754037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ccb45e41413bdff6e3626229fce7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/2754037/rob"}, "edited": false, "score": 0, "creation_date": 1451461097, "post_id": 34522962, "comment_id": 56791429, "body": "Hello Eric, Thank you for your response. Maybe I don&#39;t get your anwser, but when I search the same User with Active Directory and check his memberships in the tab &quot;member of&quot; i see among his share&#39;s and applications (Security type groups) the distribution lists(Distribution type groups). So my thougt is that I should be able to retrieve the memberships from AD. If not I&#39;ll try to get it with your suggestion. But i&#39;m hoping to understand why I see the groups with AD and not when I do it with VBA."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 53, "user_id": 2754037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ccb45e41413bdff6e3626229fce7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/2754037/rob"}, "edited": false, "score": 0, "creation_date": 1451501893, "post_id": 34522962, "comment_id": 56812630, "body": "Ah, sorry I misunderstood. I believe you&#39;ll need to use LDAP, but I can&#39;t recall what COM objects are available to do that or whether it is possible with WSH. One .NET approach is discussed here: <a href=\"http://stackoverflow.com/questions/3195617/list-of-users-in-specific-active-directory-distribution-group\" title=\"list of users in specific active directory distribution group\">stackoverflow.com/questions/3195617/&hellip;</a>"}, {"owner": {"reputation": 53, "user_id": 2754037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ccb45e41413bdff6e3626229fce7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/2754037/rob"}, "edited": false, "score": 0, "creation_date": 1451983837, "post_id": 34522962, "comment_id": 56960187, "body": "Tried it with LDAP and now i get all the items that i want. Although it solved my problem i&#39;m still curious why i cannot get it with WinNT. Does someone know why WinNT doesn&#39;t give me all the groups and/or what the difference is between WINNT and LDAP?"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 1, "last_activity_date": 1451450188, "creation_date": 1451450188, "answer_id": 34522962, "question_id": 34510615, "link": "https://stackoverflow.com/questions/34510615/outlook-retrieve-distribution-type-groups-from-a-ad-user/34522962#34522962", "title": "Outlook: Retrieve distribution type groups from a AD user", "body": "<p>WScript.Network has nothing to do with Distribution Groups in Exchange, so that won't be of much help.  You need to use the Outlook Object Model - see \"<a href=\"https://msdn.microsoft.com/EN-US/library/ff860656.aspx\" rel=\"nofollow\">Access Exchange User or Distribution List Information from the Address Book</a>\".</p>\n"}], "owner": {"reputation": 53, "user_id": 2754037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ccb45e41413bdff6e3626229fce7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/2754037/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593518708, "creation_date": 1451390452, "last_edit_date": 1593518708, "question_id": 34510615, "link": "https://stackoverflow.com/questions/34510615/outlook-retrieve-distribution-type-groups-from-a-ad-user", "title": "Outlook: Retrieve distribution type groups from a AD user", "body": "<p>In Outlook I created a UserForm which gets a User from the domain and display his lastlogon, expiredate, group memberships, etc. But for the group memberships it only displays Security type groups, not distribution type groups of the selected User. </p>\n\n<p>I'm trying to get both (Security and distribution groups) but can't figure out how to do this. Not even with the help of my big friend Google. \nI'm guessing Objuser.Groups is the problem, but .memberOf or .Members does not seems to work.<br>\nWhat am i doing wrong?  </p>\n\n<p>snapshot of the code: </p>\n\n<pre><code>Sub FindUser(Username As String)\nDim objGroup As Object\nDim Objuser As IADsUser\n\n  Set WSHnet = CreateObject(\"WScript.Network\")\n  UserDomain = WSHnet.UserDomain\n\n  Set Objuser = GetObject(\"WinNT://\" &amp; UserDomain &amp; \"/\" &amp; Username &amp; \",user\")  \n\n  For Each objGroup In Objuser.Groups\n  '!!at this part I only get the Security type groups, not the distribution groups!!\n\n    'Do things with the objGroup\n  Next\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1451397902, "post_id": 34512016, "comment_id": 56766080, "body": "The best way to say &quot;Nevermind&quot; is to delete the question."}], "tags": [], "owner": {"reputation": 39, "user_id": 1670865, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/28899ac2222d1c813c396ecead75c04b?s=128&d=identicon&r=PG", "display_name": "Wtr", "link": "https://stackoverflow.com/users/1670865/wtr"}, "is_accepted": false, "score": 0, "last_activity_date": 1451395355, "creation_date": 1451395355, "answer_id": 34512016, "question_id": 34510283, "link": "https://stackoverflow.com/questions/34510283/vba-public-function-returns-0-when-random-cell-value-is-entered/34512016#34512016", "title": "VBA public function returns 0 when random cell value is entered", "body": "<p>There's an Activesheet after countif! </p>\n\n<p>Nevermind folks!</p>\n"}], "owner": {"reputation": 39, "user_id": 1670865, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/28899ac2222d1c813c396ecead75c04b?s=128&d=identicon&r=PG", "display_name": "Wtr", "link": "https://stackoverflow.com/users/1670865/wtr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451395355, "creation_date": 1451389300, "question_id": 34510283, "link": "https://stackoverflow.com/questions/34510283/vba-public-function-returns-0-when-random-cell-value-is-entered", "title": "VBA public function returns 0 when random cell value is entered", "body": "<p>I'm using a public function to look up the last value in a range on a different worksheet.</p>\n\n<p>The worksheet name consists of the target and batch (based on cell value entered by user)</p>\n\n<pre><code> Public Function STlastvalue(target, batch, rng)\n Application.Volatile\n\n STlastvalue = Worksheets(target &amp; \" \" &amp; batch).Range(\"J\" &amp; WorksheetFunction.CountIf(ActiveSheet.Range(rng.Address), \"&lt;&gt;\" &amp; \"*\")).Value\n End Function\n</code></pre>\n\n<p>the function works fine but when i change a random cell value in the sheet the function is used in, the function returns 0. When i change a random cell value in the targeted sheet the right value is returned.</p>\n\n<p>What causes this and is it fixable?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451388176, "post_id": 34509814, "comment_id": 56760939, "body": "For starters, it should be <code>Set rFound = ...</code>."}, {"owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1451388409, "post_id": 34509814, "comment_id": 56761038, "body": "I deleted the Set, when I posted my question... as I mentioned, it works good with strings. the problam is when there is only numbers, not strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1451388480, "post_id": 34509814, "comment_id": 56761078, "body": "Perhaps, but if you are going to post code and then ask <i>Why doesn&#39;t this code work?</i> then you should be posting the actual code."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1451388587, "post_id": 34509814, "comment_id": 56761135, "body": "Are both values exactly the same or just formatted to look the same?  One might be 123.01 formatted to 0 decimal places, the other may not.  Not sure if I&#39;m talking rubbish here - is searching for &quot;123&quot; (text string) different than searching for 123 (numeric)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1451388676, "post_id": 34509814, "comment_id": 56761187, "body": "@DarrenBartrup-Cook - Good point on the actual value sought; you can find <b>123</b> by looking for <b>&quot;123&quot;</b>."}, {"owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1451389040, "post_id": 34509814, "comment_id": 56761367, "body": "ok Jeeped I understand. now, the problam is, that I can&#39;t know what is the type of the cell in the search files. I got a source file, some of it&#39;s cells contains strings and some numbers, and if the user wants to look by a cell with just a number value - then it doesn&#39;t work. the variable strSearch - is actually contains: .Cells(i, 1).Value - something like that - a cell value."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1451391684, "post_id": 34509814, "comment_id": 56762600, "body": "As of my experiences one can not use <code>Range.Find</code> properly without knowing the format of the searched value. For example with <code>LookIn:=xlValues, LookAt:=xlWhole</code> <code>123</code> will not be found if the cell value is <code>123</code> formatted as <code>123.00</code>. Then only <code>123.00</code> will be found. So <code>LookIn:=xlValues</code> means &quot;how the value looks in the cell&quot;. With <code>LookIn:=xlFormulas, LookAt:=xlWhole</code> <code>123</code> will be found if the cells value is <code>123</code>, even if formatted. So <code>LookIn:=xlFormulas</code> takes the cell&#39;s content <code>123</code> like the formula <code>=123</code>. But of course then it will not find <code>123</code> if the cell contains <code>=1230&#47;10</code>."}, {"owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1451392092, "post_id": 34509814, "comment_id": 56762844, "body": "@Axel Richter thank you - it is part of the problam! is there a wat to do something like: LookIn:=xlFormulas or LookIn:=xlValues ?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1451393929, "post_id": 34509814, "comment_id": 56763816, "body": "Do not use <code>.Find</code>. Loop over all cells (or better over the data array) and find the matching value with <code>If cellContent = searchedValue Then ... EndIf</code>."}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": false, "score": -1, "last_activity_date": 1451396188, "last_edit_date": 1451396188, "creation_date": 1451391171, "answer_id": 34510829, "question_id": 34509814, "link": "https://stackoverflow.com/questions/34509814/vba-find-numbers-or-strings-in-another-workbook/34510829#34510829", "title": "vba - find numbers or strings in another workbook", "body": "<p>Try the below Code. But i think this will be slower if the data is huge.</p>\n\n<pre><code>strSearch = \"123\" 'the number to look for\n  Set wks = ThisWorkbook.Sheets(\"Sheet1\")\n    For Each cell In wks.UsedRange\n\n    srcstr = cell.Value\n\n\n    If InStr(1, srcstr, strSearch, vbTextCompare) &gt; 0 Then\n\n        cell.Activate\n        Exit Sub\n    End If\n\n\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 1, "last_activity_date": 1451397465, "creation_date": 1451397465, "answer_id": 34512567, "question_id": 34509814, "link": "https://stackoverflow.com/questions/34509814/vba-find-numbers-or-strings-in-another-workbook/34512567#34512567", "title": "vba - find numbers or strings in another workbook", "body": "<p>as already mentioned in comments below OP post, <code>find</code> method is not applicable for searching of the values through the formula result (=123/10), so for such purposes you shall use looping through the range as in example below:</p>\n\n<pre><code>Sub test()\n    Dim cl As Range, s$\n    s = \"123\"\n    For Each cl In ActiveSheet.UsedRange\n        If cl.Value = s Then Debug.Print cl.Address(0, 0)\n    Next cl\nEnd Sub\n</code></pre>\n\n<p>test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WzNXO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WzNXO.png\" alt=\"enter image description here\"></a></p>\n\n<p>also, if you need to find cell which is contains searching string then you can use something like this:</p>\n\n<pre><code>Option Compare Text\nSub test2()\n    Dim cl As Range, s$\n    s = \"S\"\n    For Each cl In ActiveSheet.UsedRange\n        If cl.Value Like \"*\" &amp; s &amp; \"*\" Then Debug.Print cl.Address(0, 0)\n    Next cl\nEnd Sub\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Sub test3()\n    Dim cl As Range, s$\n    s = \"123\"\n    For Each cl In ActiveSheet.UsedRange\n        If InStr(1, cl.Value, s, vbTextCompare) &gt; 0 Then Debug.Print cl.Address(0, 0)\n    Next cl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 34512567, "answer_count": 2, "score": 0, "last_activity_date": 1451397465, "creation_date": 1451387626, "question_id": 34509814, "link": "https://stackoverflow.com/questions/34509814/vba-find-numbers-or-strings-in-another-workbook", "title": "vba - find numbers or strings in another workbook", "body": "<p>I am trying to look for same values in two different workbooks.\nwhen the cells contains strings, it works fine, but when I am trying to look just numbers, even though there is a matching cell with the same numbers, it doesn't work.</p>\n\n<p>any ideas?</p>\n\n<pre><code>strSearch = \"123\" 'the number to look for\nrFound = wks.UsedRange.Find(strSearch, LookIn:=xlValues, lookat:=xlWhole, MatchCase:=False)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1451386831, "post_id": 34509420, "comment_id": 56760283, "body": "Which loop is producing the unexpected behavior? What does the WHILE condition evaluate to for that loop?"}, {"owner": {"reputation": 35, "user_id": 3249771, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000157916495/picture?type=large", "display_name": "Cubed", "link": "https://stackoverflow.com/users/3249771/cubed"}, "reply_to_user": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1451389869, "post_id": 34509420, "comment_id": 56761771, "body": "It would be the last loop thats behaving in that way. Im not sure what you meant by the second question. However, I have a feeling that what Jason answered is the reason its behaving that way."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3249771, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000157916495/picture?type=large", "display_name": "Cubed", "link": "https://stackoverflow.com/users/3249771/cubed"}, "edited": false, "score": 0, "creation_date": 1451389733, "post_id": 34509621, "comment_id": 56761702, "body": "Would it be work if I use a different rowCounts for each While/Wend? Not at a laptop to test this."}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 35, "user_id": 3249771, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000157916495/picture?type=large", "display_name": "Cubed", "link": "https://stackoverflow.com/users/3249771/cubed"}, "edited": false, "score": 0, "creation_date": 1451390030, "post_id": 34509621, "comment_id": 56761850, "body": "Yes, either reset your rowCount or use a separate ones."}], "tags": [], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "is_accepted": true, "score": 1, "last_activity_date": 1451386887, "creation_date": 1451386887, "answer_id": 34509621, "question_id": 34509420, "link": "https://stackoverflow.com/questions/34509420/excel-vba-code-does-not-fully-work-unless-certain-parts-removed/34509621#34509621", "title": "Excel VBA code does not fully work unless certain parts removed", "body": "<p>Only the first While/wend will ever be executed. If you have 5 rows, for instance, your second one will start at rowCount 6. You need to reset your counter in between each While/Wend.</p>\n"}], "owner": {"reputation": 35, "user_id": 3249771, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000157916495/picture?type=large", "display_name": "Cubed", "link": "https://stackoverflow.com/users/3249771/cubed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 34509621, "answer_count": 1, "score": 0, "last_activity_date": 1451386887, "creation_date": 1451386161, "question_id": 34509420, "link": "https://stackoverflow.com/questions/34509420/excel-vba-code-does-not-fully-work-unless-certain-parts-removed", "title": "Excel VBA code does not fully work unless certain parts removed", "body": "<p>My issue is when I wrote all the codes, one of it will not work. It does not give an error, but there will be no email generated from the GenerateEmail sub. However, if I remove one of the While Wend code, the others work (I tested them one by one). In short, one of it will not work if all of the While Wend codes are there. I am not sure what is happening. Any help is appreciated. I have tried find similar situations but no success.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub CaseCreation()\nDim subjectTitleEABS As String\nDim subjectTitleCCC As String\nDim subjectTitleRR As String\nDim subjectTitleTERM As String\nDim rowCount As String\nrowCount = 2\n\nWhile Sheets(\"Extended Abs\").Range(\"B\" &amp; CStr(rowCount)).Value &lt;&gt; \"\"\nIf Sheets(\"Extended Abs\").Range(\"A\" &amp; CStr(rowCount)).Value = \"\" Then\nsubjectTitleEABS = Sheets(\"Extended Abs\").Range(\"K\" &amp; CStr(rowCount)).Value\nCall GenerateEmail(subjectTitleEABS)\nEnd If\nrowCount = rowCount + 1\nWend\n\nWhile Sheets(\"Contractual Conditions Change\").Range(\"B\" &amp; CStr(rowCount)).Value &lt;&gt; \"\"\nIf Sheets(\"Contractual Conditions Change\").Range(\"A\" &amp; CStr(rowCount)).Value = \"\" Then\nsubjectTitleCCC = Sheets(\"Contractual Conditions Change\").Range(\"L\" &amp; CStr(rowCount)).Value\nCall GenerateEmail(subjectTitleCCC)\nEnd If\nrowCount = rowCount + 1\nWend\n\nWhile Sheets(\"Resource Requests\").Range(\"B\" &amp; CStr(rowCount)).Value &lt;&gt; \"\"\nIf Sheets(\"Resource Requests\").Range(\"A\" &amp; CStr(rowCount)).Value = \"\" Then\nsubjectTitleRR = Sheets(\"Resource Requests\").Range(\"M\" &amp; CStr(rowCount)).Value\nCall GenerateEmail(subjectTitleRR)\nEnd If\nrowCount = rowCount + 1\nWend\n\nWhile Sheets(\"Terminations\").Range(\"B\" &amp; CStr(rowCount)).Value &lt;&gt; \"\"\nIf Sheets(\"Terminations\").Range(\"A\" &amp; CStr(rowCount)).Value = \"\" Then\nsubjectTitleTERM = Sheets(\"Terminations\").Range(\"K\" &amp; CStr(rowCount)).Value\nCall GenerateEmail(subjectTitleTERM)\nEnd If\nrowCount = rowCount + 1\nWend\n</code></pre>\n"}, {"tags": ["vba", "excel", "refresh", "pivot-table"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451390800, "post_id": 34509313, "comment_id": 56762173, "body": "Can you refresh them all manually?"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451392499, "post_id": 34509313, "comment_id": 56763052, "body": "Hi Rory, yes I can refresh each of this table manually."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451393114, "post_id": 34509313, "comment_id": 56763391, "body": "So if you use Refresh All, you don&#39;t get an error?"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451394438, "post_id": 34509313, "comment_id": 56764128, "body": "Once I go one by one and refresh then it works. Is that want you mean?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451394484, "post_id": 34509313, "comment_id": 56764155, "body": "No, I mean if you press the Refresh All button on the data tab, do you get an error?"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451394936, "post_id": 34509313, "comment_id": 56764443, "body": "Sorry just got your point, once I click Refresh all it works. Also when I use simple macro <code>ActiveWorkbook.RefreshAll</code> also works."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451396182, "post_id": 34509313, "comment_id": 56765190, "body": "What does <code>Msgbox ActiveSheet.PivotTables(1).SourceData</code> return?"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451397480, "post_id": 34509313, "comment_id": 56765856, "body": "For  Pivot table &quot;1&quot; it returns &#39;Data Dump&#39;!$A:$N for all other &#39;Data Dump&#39;!C1:C14"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451397743, "post_id": 34509313, "comment_id": 56765995, "body": "But when I go to Change Data Source each table has the same A:N"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451398064, "post_id": 34509313, "comment_id": 56766169, "body": "That is strange as SourceData should return a reference in R1C1 notation, not A1. Can you run: <code>ActiveSheet.PivotTables(1).SourceData = &#39;Data Dump&#39;!C1:C14</code> and then refresh the pivot table without error?"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451399388, "post_id": 34509313, "comment_id": 56766888, "body": "It not allows to use that, I added quotation marks and checked by MsgBox and source was still the same."}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451399676, "post_id": 34509313, "comment_id": 56767025, "body": "I just checked the Excel Options -&gt;Formulas and R1C1 reference style was switched of, so I turn it on and macro works!!! Thanks for your help Rory!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "edited": false, "score": 0, "creation_date": 1451392621, "post_id": 34510966, "comment_id": 56763123, "body": "Hi Raja Thevar, thanks for your reply, I used your code and after that i run my macro and got the same error. Source is the same for each table on this sheet so is fine for sure. As I mentioned above I am able to refresh this table manually. The moment when i get this error is on this part of code    PL.RefreshTable"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "edited": false, "score": 0, "creation_date": 1451393216, "post_id": 34510966, "comment_id": 56763438, "body": "Yes, I am able to refresh it manually. Also if I would ask about this particular table in macro and will refresh then it it works."}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "edited": false, "score": 0, "creation_date": 1451395563, "post_id": 34510966, "comment_id": 56764836, "body": "Tried this before and now and it come back with same error. Looks like it don&#39;t want to refresh PivotTable(&quot;1&quot;), because when I code <code>Sub Refresh_Incidents()  Worksheets(&quot;Incidents Pivots&quot;).Activate  Dim A  A = Array(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17&quot;, &quot;18&quot;, &quot;19&quot;, &quot;20&quot;)  For i = 0 To 19  ActiveSheet.PivotTables(A(i)).RefreshTable  Next i  End Sub</code> then it give the same error. But when I change <code>For i=1 ...</code> then it works. Any ideas what might be wrong with this table?"}, {"owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "reply_to_user": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "edited": false, "score": 0, "creation_date": 1451396880, "post_id": 34510966, "comment_id": 56765550, "body": "Instead of using array you can directly use for loop with i =1 to 20"}, {"owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "edited": false, "score": 0, "creation_date": 1451397045, "post_id": 34510966, "comment_id": 56765648, "body": "I can but tables are not in index order so it is easier to track them by name."}], "tags": [], "owner": {"reputation": 403, "user_id": 4503999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/spuOu.png?s=128&g=1", "display_name": "RAJA THEVAR", "link": "https://stackoverflow.com/users/4503999/raja-thevar"}, "is_accepted": false, "score": 0, "last_activity_date": 1451391653, "creation_date": 1451391653, "answer_id": 34510966, "question_id": 34509313, "link": "https://stackoverflow.com/questions/34509313/run-time-error-1004-for-refresh-pivot-table/34510966#34510966", "title": "Run-time error 1004 for Refresh Pivot Table", "body": "<p>Have you checked the pivot table datasource. also some time this kind of issues happen due to pivot cache. call the below code before refreshing the pivots.</p>\n\n<pre><code>Sub PivotCacheClear()\n\u00a0\u00a0\u00a0\u00a0Dim pc As PivotCache\n\u00a0\u00a0\u00a0\u00a0Dim ws As Worksheet\n\u00a0\u00a0\u00a0\u00a0With ActiveWorkbook\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0For Each pc In .PivotCaches\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0pc.MissingItemsLimit = xlMissingItemsNone\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Next pc\n\u00a0\u00a0\u00a0\u00a0End With\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "is_accepted": false, "score": 2, "last_activity_date": 1451399899, "creation_date": 1451399899, "answer_id": 34513255, "question_id": 34509313, "link": "https://stackoverflow.com/questions/34509313/run-time-error-1004-for-refresh-pivot-table/34513255#34513255", "title": "Run-time error 1004 for Refresh Pivot Table", "body": "<p>As Rory suggested there was something wrong with source data for one table, it used A1 instead of R1C1 notation. I changed it in Excel Option->Formulas->R1C1 reference style and now macro works.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5724507, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9Tfz-XlfC6c/AAAAAAAAAAI/AAAAAAAAAAA/YpFtpRB2jGE/photo.jpg?sz=128", "display_name": "Pahoran Alanis", "link": "https://stackoverflow.com/users/5724507/pahoran-alanis"}, "is_accepted": false, "score": 0, "last_activity_date": 1451400736, "creation_date": 1451400736, "answer_id": 34513474, "question_id": 34509313, "link": "https://stackoverflow.com/questions/34509313/run-time-error-1004-for-refresh-pivot-table/34513474#34513474", "title": "Run-time error 1004 for Refresh Pivot Table", "body": "<p>I have a code that auto adjust the data from a Pivot Table and then refresh the Pivot Table, may be it can halp you:</p>\n\n<pre><code>Sub AdjustPivotDataRange(ByVal SheetName As String)\n\nDim Data_sht As Worksheet\nDim Pivot_sht As Worksheet\nDim StartPoint As Range\nDim DataRange As Range\nDim PivotName As String\nDim NewRange As String\n\n  Sheets(\"All 2014 to Current Date\").Visible = True\n'Set Variables Equal to Data Sheet and Pivot Sheet\n  Set Data_sht = Worksheets(\"All 2014 to Current Date\")\n  Set Pivot_sht = Worksheets(SheetName)\n\n'Enter in Pivot Table Name\n  PivotName = \"PivotTable1\"\n\n'Dynamically Retrieve Range Address of Data\n  Set StartPoint = Data_sht.Range(\"A6\")\n  LastRow = Data_sht.Cells(Rows.Count, 1).End(xlUp).Row\n  LastColumn = Data_sht.Cells(LastRow, Columns.Count).End(xlToLeft).Column\n  Data_sht.Activate\n  Set DataRange = Data_sht.Range(StartPoint, Cells(LastRow, LastColumn))\n\n  NewRange = Data_sht.Name &amp; \"!\" &amp; _\n    DataRange.Address(ReferenceStyle:=xlR1C1)\n\n'Make sure every column in data set has a heading and is not blank (error prevention)\n  If WorksheetFunction.CountBlank(DataRange.Rows(1)) &gt; 0 Then\n    MsgBox \"One of your data columns has a blank heading.\" &amp; vbNewLine _\n      &amp; \"Please fix and re-run!.\", vbCritical, \"Column Heading Missing!\"\n    Exit Sub\n  End If\n\n'Change Pivot Table Data Source Range Address\n  Pivot_sht.PivotTables(PivotName).ChangePivotCache _\n    ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=NewRange)\n\n'Ensure Pivot Table is Refreshed\n  Pivot_sht.PivotTables(PivotName).RefreshTable\n  Sheets(\"Rolling 12-mo.\").Select\n  Sheets(\"All 2014 to Current Date\").Visible = False\n'Complete Message\n  'MsgBox PivotName &amp; \"'s data source range has been successfully updated!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7001843, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/aaa2f35e5a0881642644eb7f3f08a0e4?s=128&d=identicon&r=PG", "display_name": "user7001843", "link": "https://stackoverflow.com/users/7001843/user7001843"}, "is_accepted": false, "score": 0, "last_activity_date": 1594921443, "last_edit_date": 1594921443, "creation_date": 1476196913, "answer_id": 39979920, "question_id": 34509313, "link": "https://stackoverflow.com/questions/34509313/run-time-error-1004-for-refresh-pivot-table/39979920#39979920", "title": "Run-time error 1004 for Refresh Pivot Table", "body": "<p><code>connection property</code>=&gt;<code>usage</code>=&gt;<code>enable background refresh</code>, please make sure, that it has not been selected.</p>\n"}], "owner": {"reputation": 31, "user_id": 5722985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89a69335dad1e138a050cb1484cc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Paulina Leniartek", "link": "https://stackoverflow.com/users/5722985/paulina-leniartek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18036, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1594921443, "creation_date": 1451385746, "last_edit_date": 1451419190, "question_id": 34509313, "link": "https://stackoverflow.com/questions/34509313/run-time-error-1004-for-refresh-pivot-table", "title": "Run-time error 1004 for Refresh Pivot Table", "body": "<p>I created macro which would refresh all pivot tables in a worksheet. The same code works on one sheet however doesn't on the other. I tried to run it in debug mode and it works fine for first few tables and crush on one in the middle with error:</p>\n\n<blockquote>\n  <p>Run-time error '1004': RefreshTable method of PivotTable class\n  failed.</p>\n</blockquote>\n\n<p>There are 20 Pivot Tables in this sheet, but on the one where it works are 26. Your help would be much appreciated. </p>\n\n<pre><code>Sub Refresh_Pivots2()\n\nDim PL As PivotTable\n\nWorksheets(\"Incidents Pivots\").Activate\n\n    For Each PL In ActiveSheet.PivotTables\n\n    PL.RefreshTable\n\n    Next PL\n\nEnd Sub\n</code></pre>\n\n<p>I just tried another code</p>\n\n<pre><code>Sub Refresh_Incidents()\n\nWorksheets(\"Incidents Pivots\").Activate\n\nDim A\n\nA = Array(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"20\")\n\nFor i = 0 To 19\n\nActiveSheet.PivotTables(A(i)).RefreshTable\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>if I start from i=0 it gives an error but when switch it to i=1 it works. Any ideas what is wrong with this table. I am able to refresh it manually.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451387356, "post_id": 34508444, "comment_id": 56760552, "body": "Why aren&#39;t you using <code>myRange.FormatConditions.Add</code> instead of applying to the whole sheet and then modifying to <code>myRange</code>?"}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451413773, "post_id": 34508444, "comment_id": 56774743, "body": "I had started this code a while ago before learning the difference between selection and range, I plan on changing it to the way you mentioned but left it as is for now to avoid adding any extra mistakes. (granted its a pretty straightforward change, I&#39;ll update if I have time before work)"}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451463234, "post_id": 34508444, "comment_id": 56792261, "body": "I updated it to the new code using myRange for everything instead of Selection but that had no affect on the error I&#39;m getting. Also since changing this I have noticed that the FormatConditions(1).Interior section won&#39;t change it for my VBA created conditional formatting but changes it for any other conditional formatting already on the sheet, I assume again that this is an issue with the index somehow."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451463324, "post_id": 34508444, "comment_id": 56792295, "body": "Can you post a workbook somewhere that demonstrates the issue so we don&#39;t have to try and repro it ourselves?"}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451465151, "post_id": 34508444, "comment_id": 56793130, "body": "added it to the bottom of my main post. clicking the left button will create my conditional format, then clicking the right will successfully delete it from sheet 1, however it will result in an error on sheet 2 due to it already having conditional formats on it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451465606, "post_id": 34508444, "comment_id": 56793370, "body": "I don&#39;t get an error with that workbook. Which version of Excel are you using?"}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451465788, "post_id": 34508444, "comment_id": 56793490, "body": "2007 and 2010, I use 2010 at home and 2007 at work and it happens on both. although I haven&#39;t tested the updated code (using myRange instead of selection) using excel 2007 yet. If you click the left button it creates a conditional format on all sheets and then clicking the right successfully deletes it on each sheet for you? (note- it needs to work in 2007 as this is intended for work)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451467020, "post_id": 34508444, "comment_id": 56794105, "body": "Yes, it works fine for me on 2010. I&#39;d suspect the issue is with 2007 which was frankly buggy as hell."}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451468262, "post_id": 34508444, "comment_id": 56794806, "body": "Hmm, but I&#39;m currently testing it on 2010. damn excel can be frustrating sometimes. Maybe something is screwed up in my excel settings? or an alternative method of deleting just the one conditional format that might also work in 2007? (though again it works in neither for me)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451468340, "post_id": 34508444, "comment_id": 56794864, "body": "Which build of 2010?"}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1451469913, "post_id": 34508444, "comment_id": 56795734, "body": "Version 14.0.4734.1000, it looks like there&#39;s newer builds, though that won&#39;t help with the 2007 version sadly."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451470574, "post_id": 34508444, "comment_id": 56796134, "body": "Yep, my build is newer than that, which may explain it. Unfortunately I can&#39;t suggest a solution to something I can&#39;t reproduce - especially if it&#39;s a bug since the code clearly <i>should</i> work."}, {"owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1451495199, "post_id": 34508444, "comment_id": 56809260, "body": "well at least now I know it&#39;s not a problem with my code. hopefully someone can suggest an alternative that might work in 2007 but I doubt it."}], "owner": {"reputation": 33, "user_id": 5429871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e63c895211be6375b119efe8eb69fe0?s=128&d=identicon&r=PG&f=1", "display_name": "FF7Squirrelman", "link": "https://stackoverflow.com/users/5429871/ff7squirrelman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 639, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451465095, "creation_date": 1451382391, "last_edit_date": 1451465095, "question_id": 34508444, "link": "https://stackoverflow.com/questions/34508444/excel-error-1004-when-trying-range-conditionalformat1-delete", "title": "Excel: error 1004 when trying range.conditionalformat(1).delete?", "body": "<p>I have the following code, I recently discovered that I get runtime error 1004- user defined or object defined error if I have conditional formatting that doesn't match the range exactly.</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n        If Not (ws.Name = \"Instructions (protected)\" Or ws.Name = \"ReplacementMacro (protected)\" Or ws.Name = \"Line Pay Finder (protected)\" Or ws.Name = \"Line Inserter (protected)\" Or ws.Name = \"Symbol Inserter (protected)\" Or ws.Name = \"Configuration Data (protected)\") And ws.ProtectContents = False Then\n        ws.Activate\n\n        Dim myRange As Range\n        Set myRange = Range(\"A1:GJH5000\")\n\n        myRange.FormatConditions(1).Delete\n    End If\nNext ws\n</code></pre>\n\n<p>before the above code is run the following is run to create a conditional format and set it's priority to 1.</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\nIf Not (ws.Name = \"Instructions (protected)\" Or ws.Name = \"ReplacementMacro (protected)\" Or ws.Name = \"Line Pay Finder (protected)\" Or ws.Name = \"Line Inserter (protected)\" Or ws.Name = \"Symbol Inserter (protected)\" Or ws.Name = \"Configuration Data (protected)\") And ws.ProtectContents = False Then\n    ws.Activate\n\n    Dim myRange As Range\n    Set myRange = Range(\"A1:GJH5000\")\n\n    Range(\"A1\").Activate\n    myRange.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=AND(viewBoxEnabled=TRUE, OR(CELL(\"\"col\"\")- viewBoxLeft &gt;CELL(\"\"col\"\",A1), CELL(\"\"col\"\")+ viewBoxRight&lt;CELL(\"\"col\"\",A1), CELL(\"\"row\"\")- viewBoxAbove &gt;CELL(\"\"row\"\",A1), CELL(\"\"row\"\")+ viewBoxBelow &lt;CELL(\"\"row\"\",A1)))\"\n    myRange.FormatConditions(Selection.FormatConditions.count).SetFirstPriority\n\n    With myRange.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent1\n        .TintAndShade = 0\n    End With\n\n    myRange.FormatConditions(1).StopIfTrue = False\nEnd If\n</code></pre>\n\n<p>Next ws</p>\n\n<p>If I create an additional conditional format after running the code that creates a conditional format through vba it works fine , but if I created any before running it and the range isn't A1:GJH5000 then I get error 1004. It seems to be an issue with the index of my vba created formatting changing so that it isn't 1. My understanding was that <code>Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority</code> should be setting the newly created condition to index 1 only, however it seems to be setting them all instead. The odd thing though is that if I have my vba created conditional format and another user defined one that has the exact same range then the delete works as intended so that makes me think the priority is set correctly, so what could be causing the user defined error and is there a work around?</p>\n\n<p><a href=\"https://www.transferbigfiles.com/4f3da8ed-251e-462a-86e1-28b4dd7762e4/kkBph5ABl6gJ-DLudV_HpA2\" rel=\"nofollow\">Example Workbook</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1451381799, "creation_date": 1451381799, "answer_id": 34508313, "question_id": 34508229, "link": "https://stackoverflow.com/questions/34508229/excel-vba-issue-with-sheet-selection/34508313#34508313", "title": "Excel VBA - issue with sheet selection", "body": "<p>You don't need to select or activate - just qualify your <code>Range</code> and <code>Cells</code> calls with the worksheet object:</p>\n\n<pre><code>Sub calendar_fill()\n    Dim i                     As Long\n    Dim x                     As Long\n    Dim y                     As Long\n    Dim z                     As Long\n    Dim dummy                 As Long\n    Dim sh                    As Worksheet\n    Dim shCal                 As Worksheet\n\n    Set sh = ThisWorkbook.Sheets(\"DATABASE\")\n    Set shCal = ThisWorkbook.Sheets(\"CALENDAR\")\n\n    i = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n\n\n    For j = 1 To i - 2\n\n        x = sh.Cells(2 + j, \"S\").Value\n        y = sh.Cells(2 + j, \"T\").Value\n        z = sh.Cells(2 + j, \"U\").Value\n\n        With shCal\n            dummy = .Cells(1, 1).Value\n\n            'annoucement\n            .Range(.Cells(j + 5, x + 3), .Cells(j + 5, y - 1 + 3)).Interior.Color = 6750207\n\n            'open\n            .Range(.Cells(j + 5, y + 3), .Cells(j + 5, z + 3)).Interior.Color = 5296274\n        End With\n\n\n    Next j\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 5685736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1048322038560967/picture?type=large", "display_name": "Pav El", "link": "https://stackoverflow.com/users/5685736/pav-el"}, "is_accepted": false, "score": 0, "last_activity_date": 1451382133, "creation_date": 1451382133, "answer_id": 34508387, "question_id": 34508229, "link": "https://stackoverflow.com/questions/34508229/excel-vba-issue-with-sheet-selection/34508387#34508387", "title": "Excel VBA - issue with sheet selection", "body": "<p>try </p>\n\n<blockquote>\n  <p>sh.Range(Cells(j + 5, x + 3), Cells(j + 5, y - 1 + 3)).Interior.Color\n  = 6750207</p>\n</blockquote>\n\n<p>I think there is no need to activete your sheet or ranges, since your sheet is already set.</p>\n"}], "owner": {"reputation": 31, "user_id": 5726306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KJPE0R9xBMg/AAAAAAAAAAI/AAAAAAAAAC0/q8mI2LbB7v4/photo.jpg?sz=128", "display_name": "Tomislav Paj", "link": "https://stackoverflow.com/users/5726306/tomislav-paj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 34508313, "answer_count": 2, "score": 0, "last_activity_date": 1451382133, "creation_date": 1451381511, "question_id": 34508229, "link": "https://stackoverflow.com/questions/34508229/excel-vba-issue-with-sheet-selection", "title": "Excel VBA - issue with sheet selection", "body": "<p>Below you can find my code. It is really basic, but so is the problem :)\nSo, I need to color cells in sheet CALENDAR based on values in sheet DATABASE (x,y,z).</p>\n\n<p>But, this code color correct cells, but in sheet DATABASE instead of CALENDAR.\nAs you can see, I tried to activate and select sheet CALENDAR in and out of for loop, but it still doesn't work.</p>\n\n<p>Pls, HELP!</p>\n\n<p>Thans in advance\"!</p>\n\n<pre><code>Sub calendar_fill()\n\nWorksheets(\"DATABASE\").Activate\nSet sh = ThisWorkbook.Sheets(\"DATABASE\")\nDim i As Long\nDim x As Long\nDim y As Long\nDim z As Long\nDim dummy As Long\n\ni = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n\nSheets(\"CALENDAR\").Select\nWorksheets(\"CALENDAR\").Activate\n\nFor j = 1 To i - 2\n\n    x = Worksheets(\"DATABASE\").Cells(2 + j, \"S\").Value\n    y = Worksheets(\"DATABASE\").Cells(2 + j, \"T\").Value\n    z = Worksheets(\"DATABASE\").Cells(2 + j, \"U\").Value\n\n    dummy = Worksheets(\"CALENDAR\").Cells(1, 1).Value\n    Sheets(\"CALENDAR\").Select\n    Worksheets(\"CALENDAR\").Activate\n\n    'annoucement\n    Range(Cells(j + 5, x + 3), Cells(j + 5, y - 1 + 3)).Interior.Color = 6750207\n\n    'open\n    Range(Cells(j + 5, y + 3), Cells(j + 5, z + 3)).Interior.Color = 5296274\n\n\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "adodb", "vba"], "comments": [{"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 2, "creation_date": 1451380440, "post_id": 34507911, "comment_id": 56757056, "body": "Show your code that call SP"}, {"owner": {"reputation": 110410, "user_id": 135566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqelJ.png?s=128&g=1", "display_name": "Devart", "link": "https://stackoverflow.com/users/135566/devart"}, "edited": false, "score": 1, "creation_date": 1451380696, "post_id": 34507911, "comment_id": 56757178, "body": "I suppose that you have parameter with <code>CHAR</code> datatype"}, {"owner": {"reputation": 53, "user_id": 3218814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48a05c10bbed22049e4a0b4213f02f?s=128&d=identicon&r=PG&f=1", "display_name": "jennous", "link": "https://stackoverflow.com/users/3218814/jennous"}, "edited": false, "score": 0, "creation_date": 1451381135, "post_id": 34507911, "comment_id": 56757392, "body": "no using varchar(200) for desc"}, {"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 1, "creation_date": 1451383198, "post_id": 34507911, "comment_id": 56758446, "body": "@jennous Not helpful, no need to be here if it not solve the problem. SO should stay as clean as possible."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3218814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48a05c10bbed22049e4a0b4213f02f?s=128&d=identicon&r=PG&f=1", "display_name": "jennous", "link": "https://stackoverflow.com/users/3218814/jennous"}, "edited": false, "score": 1, "creation_date": 1451381337, "post_id": 34507980, "comment_id": 56757510, "body": "already using LTRIM and RTRIM in procedure , we have fully tested the stored procedure, the issues seem to be on the vba end"}], "tags": [], "owner": {"reputation": 8649, "user_id": 4609360, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0b546a69fc3f60ed987a444b8e2ac63a?s=128&d=identicon&r=PG", "display_name": "Stanislovas Kala\u0161nikovas", "link": "https://stackoverflow.com/users/4609360/stanislovas-kala%c5%a1nikovas"}, "is_accepted": false, "score": 0, "last_activity_date": 1451381526, "last_edit_date": 1495542682, "creation_date": 1451380631, "answer_id": 34507980, "question_id": 34507911, "link": "https://stackoverflow.com/questions/34507911/unexpected-white-space-after-sql-server-stored-procedure/34507980#34507980", "title": "Unexpected white space after SQL Server stored procedure", "body": "<p>Hard to answer when we not see code of your procedure, but I can suggest you to use <a href=\"https://msdn.microsoft.com/en-us/library/ms177827.aspx\" rel=\"nofollow noreferrer\">LTRIM</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ms178660.aspx\" rel=\"nofollow noreferrer\">RTRIM</a> to remove leading/trailing blanks.</p>\n\n<p>In following: <code>LTRIM(RTRIM( /* character_xpression */ ))</code></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>If It's not SQL issue, try to check for related posts:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9578397/remove-leading-or-trailing-spaces-in-an-entire-column-of-data\">Remove leading or trailing spaces in an entire column of data</a> </p>\n\n<p><a href=\"https://stackoverflow.com/questions/12652952/delete-blanks-from-start-and-end-of-a-string-in-vba\">Delete blanks from start and end of a string in vba</a></p>\n\n<p><a href=\"http://www.excelitems.com/2009/03/remove-extra-spaces-from-cell-value.html\" rel=\"nofollow noreferrer\">http://www.excelitems.com/2009/03/remove-extra-spaces-from-cell-value.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 3218814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48a05c10bbed22049e4a0b4213f02f?s=128&d=identicon&r=PG&f=1", "display_name": "jennous", "link": "https://stackoverflow.com/users/3218814/jennous"}, "is_accepted": true, "score": 0, "last_activity_date": 1451386125, "creation_date": 1451386125, "answer_id": 34509413, "question_id": 34507911, "link": "https://stackoverflow.com/questions/34507911/unexpected-white-space-after-sql-server-stored-procedure/34509413#34509413", "title": "Unexpected white space after SQL Server stored procedure", "body": "<p>issues resolved, set the parameter length to the length of the variable passed. </p>\n\n<p>Dim lendesc As Integer</p>\n\n<pre><code>lendesc = Len(desc) + 1\n\nDim prmDescritpion As ADODB.Parameter\ncmdProd.Parameters.Append cmdProd.CreateParameter(\"Descritpion\", adBSTR,adParamInput, lendesc, desc)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3218814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b48a05c10bbed22049e4a0b4213f02f?s=128&d=identicon&r=PG&f=1", "display_name": "jennous", "link": "https://stackoverflow.com/users/3218814/jennous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 34509413, "answer_count": 2, "score": 0, "last_activity_date": 1451386125, "creation_date": 1451380334, "last_edit_date": 1531161705, "question_id": 34507911, "link": "https://stackoverflow.com/questions/34507911/unexpected-white-space-after-sql-server-stored-procedure", "title": "Unexpected white space after SQL Server stored procedure", "body": "<p>Seem to be getting unexpected white space when calling the stored procedure from VBA in Excel using ADODB object. The issue does not occur when running the procedure from SQL Server Management Studio.</p>\n\n<pre><code>exec usp_testloginalert '2015-11-29 00:00:00','2015-11-30 00:00:00',N'screen'                                                           \n</code></pre>\n\n<p>UPDATE </p>\n\n<p>Code from vba</p>\n\n<pre><code>Function querylogs(ByVal todate As Date, ByVal fromdate As Date, ByVal desc As String)\nDim cn As ADODB.Connection\nDim cmdProd As ADODB.command\nDim prs As New ADODB.Recordset\n\nsQuery = \"usp_testloginalert\"\nSet cn = New ADODB.Connection\nWith cn\n    .Provider = \"SQLOLEDB\"\n    sConnection = \"dbconn\"\n    .ConnectionString = sConnection\n    .ConnectionTimeout = 1000\n    .CommandTimeout = 1000\nEnd With\ncn.Open sConnection\n\nSet cmdProd = New ADODB.command\nWith cmdProd\n    .ActiveConnection = cn\n    .CommandType = adCmdStoredProc\n    .CommandText = \"usp_testloginalert\"\n    .CommandTimeout = 1000\nEnd With\nDim prmFromDate As ADODB.Parameter\nSet prmFromDate = cmdProd.CreateParameter(\"@FromDate\", adDBDate,adParamInput)\nprmFromDate.Value = fromdate\ncmdProd.Parameters.Append prmFromDate\n\nDim prmToDate As ADODB.Parameter\nSet prmToDate = cmdProd.CreateParameter(\"@ToDate\", adDBDate, adParamInput)\nprmToDate.Value = todate\ncmdProd.Parameters.Append prmToDate\n\nDim prmDescritpion As ADODB.Parameter\ncmdProd.Parameters.Append cmdProd.CreateParameter(\"Descritpion\",adBSTR,adParamInput, 100, desc)\n\nSet prs = New Recordset\nprs.CursorLocation = adUseClient\nprs.Open cmdProd.Execute\n\nApplication.EnableCancelKey = True\ncn.Close\n\nSet querylogs = prs\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "excel", "vsto", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "edited": false, "score": 1, "creation_date": 1451410079, "post_id": 34509902, "comment_id": 56772937, "body": "I agree with your approach, however its not clear how to deal with change value event. I would rather avoid the usage of sheet_change event, Thx"}, {"owner": {"reputation": 10553, "user_id": 1164966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jSq0M.jpg?s=128&g=1", "display_name": "Benoit Blanchon", "link": "https://stackoverflow.com/users/1164966/benoit-blanchon"}, "edited": false, "score": 0, "creation_date": 1483708097, "post_id": 34509902, "comment_id": 70218260, "body": "The comma is not always the right separator. You should use <code>System.Globalization.CultureInfo.CurrentCulture.TextInfo.Lis&zwnj;&#8203;tSeparator</code> instead."}], "tags": [], "owner": {"reputation": 387, "user_id": 4682151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7831b59a6482d073523d1dd2a89b5c33?s=128&d=identicon&r=PG&f=1", "display_name": "Technovation", "link": "https://stackoverflow.com/users/4682151/technovation"}, "is_accepted": false, "score": 2, "last_activity_date": 1451387966, "creation_date": 1451387966, "answer_id": 34509902, "question_id": 34506769, "link": "https://stackoverflow.com/questions/34506769/vsto-excel-dropdown-event/34509902#34509902", "title": "VSTO Excel.DropDown event", "body": "<p>you can use Excel's data validation technique in this way:</p>\n\n<pre><code>var activeSheet = (Worksheet) Globals.ThisAddIn.Application.ActiveSheet;\n            int lastUsedCell = activeSheet.UsedRange.Rows.Count;\n//in this example we dynamicly add drop down list to second colomn\n            string columnName = \"B\" + lastUsedCell;\n//the range is from second colomn of first row to last row          \n      Range range = activeSheet.Range[\"B1\", columnName];\n   var list=new List&lt;string&gt;();\n                    list.Add(\"a\");\n                    list.Add(\"b\");\n                    string items= string.Join(\",\",\n                        list);\n                    range.Validation.Add(XlDVType.xlValidateList, Type.Missing,\n                        XlFormatConditionOperator.xlBetween, items);\n                    InsertingTypeNotificationLable.Visible = true;\n                    SendButton.Enabled = true;\n</code></pre>\n\n<p>also you can have dynamicly populated drop down list at run time, for example whenever user click a button in your task pane </p>\n"}], "owner": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451387966, "creation_date": 1451375310, "last_edit_date": 1531161705, "question_id": 34506769, "link": "https://stackoverflow.com/questions/34506769/vsto-excel-dropdown-event", "title": "VSTO Excel.DropDown event", "body": "<p>I am adding dynamically an Excel.DropDown within a ActiveSheet cell using C# VSTO. Is there a way to handle a change selection event without embedding a macro to workbook? Alternatively I would be interested to use Excel's data validation technique (cell.Validation), where presumably I would need to work with SheetChange event. Not sure which one is more efficient? \nThe code I am using is bellow</p>\n\n<pre><code>var currentSheet = Application.Sheets[strDestSheetName];\nvar inv = Application.Sheets[strSrcSheetName];\nvar items = inv.Range[strSrcRange];\nvar list_items = new List&lt;string&gt;();\n\nforeach (Excel.Range cell in items)\n{\n    list_items.Add(cell.Value2.ToString());\n}\n\nRange xlsRange;\nxlsRange = currentSheet.Range[strDestCell];\n\nExcel.DropDowns xlDropDowns;\nExcel.DropDown xlDropDown;\nxlDropDowns = ((Excel.DropDowns)(currentSheet.DropDowns(Missing.Value)));\nxlDropDown = xlDropDowns.Add((double)xlsRange.Left, (double)xlsRange.Top, (double)xlsRange.Width, (double)xlsRange.Height, true);\n\n//Add item into drop down list\nfor (int i = 0; i &lt; list_items.Count; i++)\n{\n    xlDropDown.AddItem(list_items[i], i + 1);\n}\nxlDropDown.OnAction = \"SomeMacroCode\";\n</code></pre>\n"}]