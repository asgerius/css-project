[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526515541, "post_id": 50381497, "comment_id": 87779182, "body": "You are trying to copy B6:Q8, 2 cells each Row from B to Q, that&#39;s a lot of cells. And you are trying to paste all of this on 2 Cells in one Row, B10:B10. You can only copy a range and paste it on a same sized range."}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526515775, "post_id": 50381497, "comment_id": 87779243, "body": "My bad, the B10:B10 is an artifact from testing. It should only read B10. It worked perfectly fine as it was like that earlier, so it&#39;s not an issue to do with range sizes (I am almost certain of it)"}, {"owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1526515820, "post_id": 50381497, "comment_id": 87779256, "body": "Code works for me when it is in a module. Do you have a specific reason for the userform?"}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1526515947, "post_id": 50381497, "comment_id": 87779284, "body": "This is part of a larger function that will be populating data and so on, so a user interface is mandatory. I just tried putting the function into a module and unfortunately it does not work"}, {"owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1526516755, "post_id": 50381497, "comment_id": 87779467, "body": "Try it in a &quot;clean&quot; environment. This works for me so if it doesn&#39;t work for you the problem is probably with the range itself?<a href=\"https://drive.google.com/file/d/199ZX9O10NgbAqSXmcuU-2PipaYoKRtaK/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/199ZX9O10NgbAqSXmcuU-2PipaYoK&zwnj;&#8203;RtaK/&hellip;</a>"}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1526517076, "post_id": 50381497, "comment_id": 87779514, "body": "That&#39;s bizarre. I&#39;ve shifted my code around slightly to post here, and it seems that by putting the function into a separate function seems to break it, I will edit my code to show you what I mean"}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1526517244, "post_id": 50381497, "comment_id": 87779541, "body": "Seems that the actual issue is the fact that I am deleting all of the rows prior to copying, though I need to clear the entire area prior to copying to ensure that it is all clear of any old data"}, {"owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1526524770, "post_id": 50381497, "comment_id": 87780871, "body": "You could just use Range.clear instead of delete so you won&#39;t have to reset the range."}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1526525008, "post_id": 50381497, "comment_id": 87780924, "body": "I was under the impression that clear only removed the values, when I also needed to remove formatting. This works well, thank you"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "is_accepted": true, "score": 0, "last_activity_date": 1526519603, "creation_date": 1526519603, "answer_id": 50381971, "question_id": 50381497, "link": "https://stackoverflow.com/questions/50381497/vba-copy-paste-from-ranges-failing/50381971#50381971", "title": "VBA Copy/Paste from ranges failing", "body": "<pre><code>Private Sub btn_AddOpening_Click()\n    TemplateWS.Range(\"10:12\").Delete\n\n    Set TemplatePopulate = TemplateWS.Range(\"B10\")\n    ' Needed to reset range\n\n    copyRange TemplateArea, TemplatePopulate\nEnd Sub\n</code></pre>\n\n<p>Since the range was deleted, it needed to be reset prior to the copy</p>\n"}], "owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 50381971, "answer_count": 1, "score": 0, "last_activity_date": 1526519603, "creation_date": 1526514929, "last_edit_date": 1526517180, "question_id": 50381497, "link": "https://stackoverflow.com/questions/50381497/vba-copy-paste-from-ranges-failing", "title": "VBA Copy/Paste from ranges failing", "body": "<p>I am trying to copy a range of cells and paste them into a new position of the worksheet I am working on. This is the code I have</p>\n\n<pre><code>Dim TemplateArea As Range\nDim TemplateOpening As Range\nDim TemplatePopulate As Range\n\nDim TemplateWS As Worksheet\n\nPrivate Sub UserForm_Initialize()\n    Set TemplateWS = ActiveWorkbook.Worksheets(\"Template\")\n\n    Set TemplateArea = TemplateWS.Range(\"B6:Q8\")\n    Set TemplateOpening = TemplateWS.Range(\"R2:V4\")\n    Set TemplatePopulate = TemplateWS.Range(\"B10\")\n\n    copyRange TemplateArea, TemplatePopulate\nEnd Sub\n\nPrivate Sub btn_AddOpening_Click()\n    TemplateWS.Range(\"10:12\").Delete\n\n    copyRange TemplateArea, TemplatePopulate\nEnd Sub\n\nFunction copyRange(fromRange, toRange As Range)\n    fromRange.Copy _\n        Destination:=toRange\n    ' ^ This is the line it fails at with error code 1004\nEnd Function\n</code></pre>\n\n<p>The error code it gives me on the listed line is Run-time error '1004', \"Copy method of Range class failed\".</p>\n\n<p>That line of code comes from the Microsoft documentation, and was working earlier during testing. I have tried every other way of copy/pasting, nothing is working.</p>\n\n<p>EDIT:\nIt seems the error is in the fact that I am deleting the range it will be copying to prior to the copy. I need to clear the range before copying to it, since there will be bad data through out the entire set of rows, so it must all be removed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1526515956, "post_id": 50381175, "comment_id": 87779286, "body": "The code works, so <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> is the place to improve it. Although in this case, when code comes mostly from macro recorder, I would consider reading on how to avoid select statements. Also declaring as Integer is a bad practice, always use Long instead."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526533764, "post_id": 50381175, "comment_id": 87782931, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoiding .Select</a>"}, {"owner": {"reputation": 11, "user_id": 9803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38763d68429c21688cbbed973e504ba?s=128&d=identicon&r=PG&f=1", "display_name": "sanmarino", "link": "https://stackoverflow.com/users/9803062/sanmarino"}, "edited": false, "score": 0, "creation_date": 1526567938, "post_id": 50381175, "comment_id": 87804173, "body": "Thanks for sharing the forum where I should post these types of questions in the future Ryszard. And thanks for the link to the avoiding .select thread QHarr."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38763d68429c21688cbbed973e504ba?s=128&d=identicon&r=PG&f=1", "display_name": "sanmarino", "link": "https://stackoverflow.com/users/9803062/sanmarino"}, "edited": false, "score": 0, "creation_date": 1526567660, "post_id": 50381519, "comment_id": 87803994, "body": "Thanks for the help Roemer. Can you explain what is going on with these two lines:     Application.ScreenUpdating = False                               Application.Calculation = xlCalculationManual"}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "reply_to_user": {"reputation": 11, "user_id": 9803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38763d68429c21688cbbed973e504ba?s=128&d=identicon&r=PG&f=1", "display_name": "sanmarino", "link": "https://stackoverflow.com/users/9803062/sanmarino"}, "edited": false, "score": 0, "creation_date": 1526635930, "post_id": 50381519, "comment_id": 87831654, "body": "I can, but that is not what this forum is for, and I may get reprimanded if I do. That is where Google is for namely. :D  BTW The commands are pretty self-explanitory. They literally do what they say what they do."}], "tags": [], "owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "is_accepted": false, "score": 0, "last_activity_date": 1526515092, "creation_date": 1526515092, "answer_id": 50381519, "question_id": 50381175, "link": "https://stackoverflow.com/questions/50381175/how-can-i-simplify-using-active-cell-copy-paste-to-transfer-data-between-she/50381519#50381519", "title": "How can I simplify using active cell / copy / paste to transfer data between sheet?", "body": "<pre><code>Sub batchorder()\n\n\n    Dim Row As Long\n    Dim i As Long\n\n    ' These two lines speed up evrything ENORMOUSLY. \n    ' But you need the lines at the end too\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Row = Sheet2.UsedRange.Rows.Count  ' Row is nr of last row in sheet\n\n    While Application.CountA(Sheet2.Rows(Row)) = 0 And Row &gt; 1\n        Row = Row - 1 ' skip empty rows at the end if present\n    Wend\n\n    For i = 1 To Sheet1.UsedRange.Rows.Count\n        If Sheet1.Cells(i, 1).Value &lt;&gt; \"\" Then\n            Sheet2.Cells(Row, 1).FormulaLocal = Sheet1.Cells(i, 2).FormulaLocal\n            Sheet2.Cells(Row, 2).FormulaLocal = Sheet1.Cells(i + 1, 2).FormulaLocal\n            Sheet2.Cells(Row, 3).FormulaLocal = Sheet1.Cells(i + 2, 2).FormulaLocal\n            Sheet2.Cells(Row, 4).FormulaLocal = Sheet1.Cells(i + 3, 2).FormulaLocal\n            i = i + 3\n            Row = Row + 1\n        End If\n    Next\n\n    ' Restore Excel to human state.\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38763d68429c21688cbbed973e504ba?s=128&d=identicon&r=PG&f=1", "display_name": "sanmarino", "link": "https://stackoverflow.com/users/9803062/sanmarino"}, "edited": false, "score": 0, "creation_date": 1526574633, "post_id": 50381542, "comment_id": 87808542, "body": "Mikael, This response was great. Thank you for commenting, it made it a lot easier to follow along. I tested the code and worked exactly the same. Thanks."}], "tags": [], "owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "is_accepted": false, "score": 0, "last_activity_date": 1526515282, "creation_date": 1526515282, "answer_id": 50381542, "question_id": 50381175, "link": "https://stackoverflow.com/questions/50381175/how-can-i-simplify-using-active-cell-copy-paste-to-transfer-data-between-she/50381542#50381542", "title": "How can I simplify using active cell / copy / paste to transfer data between sheet?", "body": "<p>You should basically never use the select statement, it gets everything really messy quickly. Here's a basic combiner of mine. Just added the If statement to check whether the cell and in this case row is empty. </p>\n\n<p>This should work but more importantly try to understand what it does to learn. I gave it some comments.</p>\n\n<pre><code>Sub batchorder()\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\n' Just habits, but doing this here means that I won't have to write anything else than ws1 and ws2 in the future\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\n\nDim lastrowWs1 As Long\nDim j As Long\n' first row after ws2 headers\nj = 2\n\n\n' With statement to make the code nicer also \".something\" now means ws1.something\nWith ws1\n\n' Bob Ulmas method -- just a personal preference to find the last row.\nlastrowWs1 = .Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\nFor i = 1 To lastrowWs1\n    ' Check if the cell is not empty\n    If Not .Cells(i, 1) = vbNullString Then\n        'Basically range.value = other_range.value\n        ws2.Range(ws2.Cells(j, 1), ws2.Cells(j, 4)).Value = WorksheetFunction.Transpose(.Range(.Cells(i, 2), .Cells(i + 3, 2)).Value)\n        ' step 3 forward as the amount of rows per record was 4\n        i = i + 3\n        ' go to next row for worksheet 2\n        j = j + 1\n    End If\nNext i\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38763d68429c21688cbbed973e504ba?s=128&d=identicon&r=PG&f=1", "display_name": "sanmarino", "link": "https://stackoverflow.com/users/9803062/sanmarino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1526515282, "creation_date": 1526512270, "question_id": 50381175, "link": "https://stackoverflow.com/questions/50381175/how-can-i-simplify-using-active-cell-copy-paste-to-transfer-data-between-she", "title": "How can I simplify using active cell / copy / paste to transfer data between sheet?", "body": "<p>I am trying to transfer the data from sheet one to sheet two and combined the information on the second sheet. The code I have listed below works, but it seems very inefficient. I am trying to improve by VBA abilities and would love to here ways to shrink my code down, make it more efficient, and still achieve the same goal. Thanks for any help you can provide.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PhNdh.png\" rel=\"nofollow noreferrer\">Sheet 1</a>\n<a href=\"https://i.stack.imgur.com/36vSJ.png\" rel=\"nofollow noreferrer\">Sheet 2</a></p>\n\n<pre><code>Sub batchorder()\nDim Pname As String\nDim Lplace As String\nDim numsld As Long\nDim rating As Integer\nDim lastrow As Long\nDim i As Long\nDim openc As Long\n\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A1\").Select\n\nFor i = 1 To lastrow\n    If Cells(i, 1).Value &lt;&gt; \"\" Then\n        'Copy name to sheet 2\n        Cells(i, 1).Select\n        ActiveCell.Offset(0, 1).Select\n        Selection.Copy\n        Sheets(\"Sheet2\").Select\n        Range(\"A1\").Select\n        'Find the next open cell to paste to\n        Selection.End(xlDown).Select\n        Selection.End(xlDown).Select\n        Selection.End(xlUp).Select\n        ActiveCell.Offset(1, 0).Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n            'Copy place to sheet 2\n             ActiveCell.Offset(1, 0).Select\n             Selection.Copy\n             Sheets(\"Sheet2\").Select\n             Range(\"B1\").Select\n            'Find the next open cell to paste to\n            Selection.End(xlDown).Select\n            Selection.End(xlDown).Select\n            Selection.End(xlUp).Select\n            ActiveCell.Offset(1, 0).Select\n            ActiveSheet.Paste\n            Sheets(\"Sheet1\").Select\n                'Copy sold to sheet 2\n                 ActiveCell.Offset(1, 0).Select\n                 Selection.Copy\n                 Sheets(\"Sheet2\").Select\n                 Range(\"C1\").Select\n                'Find the next open cell to paste to\n                Selection.End(xlDown).Select\n                Selection.End(xlDown).Select\n                Selection.End(xlUp).Select\n                ActiveCell.Offset(1, 0).Select\n                ActiveSheet.Paste\n                Sheets(\"Sheet1\").Select\n                    'Copy rating to sheet 2\n                     ActiveCell.Offset(1, 0).Select\n                     Selection.Copy\n                     Sheets(\"Sheet2\").Select\n                     Range(\"D1\").Select\n                    'Find the next open cell to paste to\n                    Selection.End(xlDown).Select\n                    Selection.End(xlDown).Select\n                    Selection.End(xlUp).Select\n                    ActiveCell.Offset(1, 0).Select\n                    ActiveSheet.Paste\n                    Sheets(\"Sheet1\").Select\n    Sheets(\"Sheet1\").Select\n    i = i + 3\n    Else\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1526511774, "post_id": 50381052, "comment_id": 87778337, "body": "supplement the range references with parent worksheet references."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1526512181, "post_id": 50381052, "comment_id": 87778447, "body": "while I applaud the integration of your dynamic named ranges, why aren&#39;t you applying the same logic to a true and full vba solution?"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526512258, "post_id": 50381052, "comment_id": 87778470, "body": "ThisWorkbook.Names(1).Name ThisWorkbook.Names(1).Value You can loop ThisWorkbook.Names to get all your named ranges."}, {"owner": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "edited": false, "score": 0, "creation_date": 1526577865, "post_id": 50381052, "comment_id": 87810185, "body": "@Jeeped I&#39;m still a novice as far as this is concerned. Most of that work is a combination of macro recording, trial and error, google searches, and help from others. What do you mean by a full vba solution?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "edited": false, "score": 0, "creation_date": 1526577717, "post_id": 50381219, "comment_id": 87810122, "body": "Hi! Thank you for the input! I gave that a shot. At first I got a compile error stating that &quot;Name&quot; needed to be defined. I defined &quot;Name&quot; as a variant and the macro ran. Unfortunately, when I check the y-values in the graph it is blank (that&#39;s a first). Any ideas what I missed?"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "edited": false, "score": 0, "creation_date": 1526580288, "post_id": 50381219, "comment_id": 87811431, "body": "I have edited my answer with something i just tested."}, {"owner": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "edited": false, "score": 0, "creation_date": 1526583734, "post_id": 50381219, "comment_id": 87813324, "body": "I just tried again with the same result. It&#39;s has to be an issue with the rest of my code. I&#39;ll send my code over in case I missed something. Thank you again! I&#39;m on day three of trying to figure this out..."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1526580081, "last_edit_date": 1526580081, "creation_date": 1526512580, "answer_id": 50381219, "question_id": 50381052, "link": "https://stackoverflow.com/questions/50381052/using-named-ranges-with-embedded-formulas-for-excel-chart-data/50381219#50381219", "title": "Using named ranges with embedded formulas for excel chart data", "body": "<p>Try this:</p>\n\n<pre><code>Sub testing()\n    Dim freqRange As String\n    Dim datesRange As String\n    Dim Name As Variant\n    For Each Name In ThisWorkbook.Names\n        If Name.Name = \"chart_Frequency\" Then\n            freqRange = Name.Value\n        ElseIf Name.Name = \"chart_Dates\" Then\n            datesRange = Name.Value\n        End If\n    Next Name\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(1).Name = \"=Sheet1!$B$1\"\n    ActiveChart.FullSeriesCollection(1).Values = datesRange\n    ActiveChart.FullSeriesCollection(1).XValues = freqRange\nEnd Sub\n</code></pre>\n\n<p>My chart didnt have any series so it adds a new series and it updates the Name, Values and XValues with no issues.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "is_accepted": false, "score": 0, "last_activity_date": 1526584030, "creation_date": 1526584030, "answer_id": 50398866, "question_id": 50381052, "link": "https://stackoverflow.com/questions/50381052/using-named-ranges-with-embedded-formulas-for-excel-chart-data/50398866#50398866", "title": "Using named ranges with embedded formulas for excel chart data", "body": "<p>Here is the code I have right now. After it runs when I check the y-values and horizontal values on the graph itself and they are both blank.</p>\n\n<pre><code>'Create chart\nDim rng As Range\nDim cht As ChartObject\n\n'Data range for the chart\nSet rng = ActiveSheet.Range(\"$E$7:$F$501\")\n\n'Designates which cell to place the top left corner of the graph in\nActiveSheet.Range(\"N5\").Select\n\n'Create a chart\nSet cht = ActiveSheet.ChartObjects.Add( _\nLeft:=ActiveCell.Left, _\nWidth:=360, _\nTop:=ActiveCell.Top, _\nHeight:=216)\n\n'Give chart some data\n'I was using the line below to set the range but comment blocked it out and entered the suggested code\n'  cht.Chart.SetSourceData Source:=rng\nDim freqRange As String\nDim datesRange As String\nDim Name As Variant\nFor Each Name In ThisWorkbook.Names\n    If Name.Name = \"chart_Frequency\" Then\n        freqRange = Name.Value\n    ElseIf Name.Name = \"chart_Dates\" Then\n        datesRange = Name.Value\n    End If\nNext Name\nActiveSheet.ChartObjects(\"Chart 1\").Activate\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(1).Name = \"=Home!$A$5\"\nActiveChart.FullSeriesCollection(1).Values = datesRange\nActiveChart.FullSeriesCollection(1).XValues = freqRange\n\n'Determine the chart type\ncht.Chart.ChartType = xlLineMarkersStacked\n\n'Remove Major Gridlines\ncht.Chart.Axes(xlValue).MajorGridlines.Delete\n\n'Sets the legend to the bottom of the graph\ncht.Chart.SetElement (msoElementLegendBottom)\ncht.Name = \"Frequency_Chart\"\n\n'Add title and reference A5 for name\nActiveSheet.ChartObjects(\"Frequency_Chart\").Activate\nActiveChart.SetElement (msoElementChartTitleAboveChart)\nApplication.CutCopyMode = False\nSelection.Caption = \"=Home!R5C1\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9422135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156378733864560/picture?type=large", "display_name": "Jonathan Bryant", "link": "https://stackoverflow.com/users/9422135/jonathan-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1526584030, "creation_date": 1526511338, "last_edit_date": 1526511722, "question_id": 50381052, "link": "https://stackoverflow.com/questions/50381052/using-named-ranges-with-embedded-formulas-for-excel-chart-data", "title": "Using named ranges with embedded formulas for excel chart data", "body": "<p>I have two drop-down menus that list a range of dates. One date identifies the beginning of the range and the other the end. I also created two named ranges as follows:</p>\n\n<pre><code>chart_Dates=INDEX(Dates,MATCH(Home!$A$7,Dates,0)):INDEX(Dates,MATCH(Home!$A$9,Dates,0))\nchart_Frequency=INDEX(Frequency,MATCH(Home!$A$7,Dates,0)):INDEX(Frequency,MATCH(Home!$A$9,Dates,0))\n</code></pre>\n\n<p><code>Dates</code>, and <code>Frequency</code> from those formulas are named ranges with set boundaries. If I manually enter the y-values as \"Home!chart_Frequency\" and the horizontal values as <code>Home!chart_Dates</code> the macro works just fine. I can adjust the start and end dates using the drop-down menus and the graph updates accordingly. </p>\n\n<p>However, the macro recorder doesn't translate those action into code. I've attempted the following code without success (there is no error generated but the graph only references the first cell in my range). </p>\n\n<pre><code>ActiveChart.SeriesCollection(1).Values = Range(\"chart_Frequency\")\nActiveChart.SeriesCollection(1).XValues = Range(\"chart_Dates\")\n</code></pre>\n\n<p>How do I get the code to replicate what I can do manually? Any advice is greatly appreciated!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1526511419, "post_id": 50381043, "comment_id": 87778241, "body": "You will need to define exacly what you mean by &quot;symbol&quot;.  Anything which is not a digit or character?  What about punctuation?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1526511457, "post_id": 50381043, "comment_id": 87778250, "body": "Are we considering English or are we considering other languages?"}, {"owner": {"reputation": 45, "user_id": 9669423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ahmed Enzea", "link": "https://stackoverflow.com/users/9669423/ahmed-enzea"}, "edited": false, "score": 0, "creation_date": 1526511476, "post_id": 50381043, "comment_id": 87778255, "body": "Anything that is not alpha numeric so anything but [a-Z][0-9]"}, {"owner": {"reputation": 45, "user_id": 9669423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ahmed Enzea", "link": "https://stackoverflow.com/users/9669423/ahmed-enzea"}, "edited": false, "score": 0, "creation_date": 1526511501, "post_id": 50381043, "comment_id": 87778263, "body": "English is that only language"}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "edited": false, "score": 0, "creation_date": 1526511992, "post_id": 50381043, "comment_id": 87778386, "body": "<code>(^[^A-Za-z0-9].*|.*[^A-Za-z0-9]$)</code> is a regex that does that. Mind you: spaces and newlines are also special charcters."}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "edited": false, "score": 0, "creation_date": 1526512112, "post_id": 50381043, "comment_id": 87778423, "body": "Or <code>^([^A-Za-z0-9].*|.*[^A-Za-z0-9])$</code>"}], "answers": [{"tags": [], "owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "is_accepted": true, "score": 1, "last_activity_date": 1526512382, "creation_date": 1526512382, "answer_id": 50381185, "question_id": 50381043, "link": "https://stackoverflow.com/questions/50381043/vba-starts-with-or-ends-with-a-special-character/50381185#50381185", "title": "VBA starts with or ends with a special character", "body": "<pre><code>Function test(x)\n    Dim rg As Variant\n    Set rg = CreateObject(\"VBScript.RegExp\")\n\n    rg.Pattern = \"^([^A-Za-z0-9].*|.*[^A-Za-z0-9])$\"\n\n    test = rg.test(x)\nEnd Function\n\nSub hoi()\n    Debug.Print test(\"#Testing\")\n    Debug.Print test(\"Testing\\\")\n    Debug.Print test(\"#Testing)\")\n    Debug.Print test(\"Tes#ting~\")\n    Debug.Print test(\"Tes#ting\")\n    Debug.Print test(\"Testing\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9182"}, "is_accepted": false, "score": 0, "last_activity_date": 1526512496, "creation_date": 1526512496, "answer_id": 50381206, "question_id": 50381043, "link": "https://stackoverflow.com/questions/50381043/vba-starts-with-or-ends-with-a-special-character/50381206#50381206", "title": "VBA starts with or ends with a special character", "body": "<p>If you don\u2019t need to change your definition of special characters for different languages or other reasons then you can simply checking the first and last character against a list of valid characters would work.</p>\n\n<pre><code>Public Function testString(text As String)        \n    testString = isCharAlphaNumeric(Left(text, 1)) Or isCharAlphaNumeric(Right(text, 1))    \nEnd Function\n\nPublic Function isCharAlphaNumeric(char)\n    Const valid As String = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n    isCharAlphaNumeric = InStr(valid, char) = 0\nEnd Function\n\nPublic Sub test()    \n    Debug.Print testString(\"#Testing\")   '  Returns: true\n    Debug.Print testString(\"Testing\\\")   '  Returns: true\n    Debug.Print testString(\"#Testing)\")  '  Returns: true\n    Debug.Print testString(\"Tes#ting~\")  '  Returns: true\n    Debug.Print testString(\"Tes#ting\")   '  Returns: false\n    Debug.Print testString(\"Testing\")    '  Returns: false    \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1526522774, "last_edit_date": 1526522774, "creation_date": 1526521935, "answer_id": 50382236, "question_id": 50381043, "link": "https://stackoverflow.com/questions/50381043/vba-starts-with-or-ends-with-a-special-character/50382236#50382236", "title": "VBA starts with or ends with a special character", "body": "<p>To check if string does not start and end with alphanumeric characters using the VB <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/like-operator\" rel=\"nofollow noreferrer\"><code>Like</code> operator</a>:</p>\n\n<pre><code>If Not \"#Testing\" Like \"[0-9A-Za-z]*[0-9A-Za-z]\" Then MsgBox True\n</code></pre>\n\n<p>If the string might be less than 2 characters:</p>\n\n<pre><code>If string Like \"[!0-9A-Za-z]*\" Or string Like \"*[!0-9A-Za-z]\" Then MsgBox True\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9669423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ahmed Enzea", "link": "https://stackoverflow.com/users/9669423/ahmed-enzea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 50381185, "answer_count": 3, "score": 0, "last_activity_date": 1526563981, "creation_date": 1526511268, "last_edit_date": 1526563981, "question_id": 50381043, "link": "https://stackoverflow.com/questions/50381043/vba-starts-with-or-ends-with-a-special-character", "title": "VBA starts with or ends with a special character", "body": "<p>I want to see if a string starts with or ends with a special character</p>\n\n<pre><code>testString(\"#Testing\")     Returns: true\ntestString(\"Testing\\\")     Returns: true\ntestString(\"#Testing)\")    Returns: true\ntestString(\"Tes#ting~\")    Returns: true\ntestString(\"Tes#ting\")     Returns: false\ntestString(\"Testing\")      Returns: false\n</code></pre>\n\n<p>The idea is to use a regular expression</p>\n\n<pre><code>Dim rg As Variant\nSet rg = CreateObject(\"VBScript.RegExp\")\n\nrg.Pattern = \"\"\n\nreturnFunc = rg.test(paramString)\n</code></pre>\n\n<p>However, I am not sure how to create a regular expression to check symbols.</p>\n\n<p>All alternative solutions are welcome</p>\n\n<p>So if it starts or ends with anything other than [a-Z][0-9]</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526509725, "post_id": 50380761, "comment_id": 87777761, "body": "yup use <code>worksheets().evaluate(&quot;String&quot;)</code> you can load the operands into an array and refer to the array with the value in A1."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1526526779, "post_id": 50380761, "comment_id": 87781245, "body": "you can also use evaluate in a named formula and bypass VBA...but your work book will need to be saved as an XLSM since EVALUATE is an old VBA builtin function...or something to that effect."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1526511230, "creation_date": 1526511230, "answer_id": 50381038, "question_id": 50380761, "link": "https://stackoverflow.com/questions/50380761/excel-4-0-macro-evaluate/50381038#50381038", "title": "excel 4.0 macro evaluate", "body": "<pre><code>Function Eval(eq, op)\n    Eval = Application.Evaluate(\"=\" &amp; Replace(eq, \"(operation)\", Mid(\"*/+-\", op, 1)))\nEnd Function\n</code></pre>\n\n<p>If your equation contains cell references then be sure to use the <code>Worksheet.Evaluate</code> form, scoped to the correct worksheet...</p>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526556243, "creation_date": 1526556243, "answer_id": 50390223, "question_id": 50380761, "link": "https://stackoverflow.com/questions/50380761/excel-4-0-macro-evaluate/50390223#50390223", "title": "excel 4.0 macro evaluate", "body": "<p>Another approach, using select case:</p>\n\n<pre><code>Function Calc(eq As Integer, op As Double) As Double\n    Select Case eq\n        Case 1: Calc = op * op\n        Case 2: Calc = op / op\n        Case 3: Calc = op + op\n        Case 4: Calc = op - op\n        Case Else: Calc = 0\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7742695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f305906eb76c6bfda84e238537c8a0?s=128&d=identicon&r=PG&f=1", "display_name": "Marc P", "link": "https://stackoverflow.com/users/7742695/marc-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526626782, "creation_date": 1526509445, "last_edit_date": 1526626782, "question_id": 50380761, "link": "https://stackoverflow.com/questions/50380761/excel-4-0-macro-evaluate", "title": "excel 4.0 macro evaluate", "body": "<p>I am trying to evaluate an equation in Excel where the operation is determined by the value of a cell. For example, let's say I have an equation in <code>A2</code> that says <code>100 (operation) 100</code>. I want that cell to be evaluated such that <code>if A1 = 1, then 100*100, if 2 then 100/100, if 3 then 100+100, if 4 then 100-100</code>. I was able to come up with a solution using <code>VLOOKUP</code> to determine the operation, concatenate to combine the numbers with the operation, and Excel 4.0 macro function EVALUATE in a named range to evaluate the text string as a number. </p>\n\n<p>Now, I'd like to do the same thing in VBA (I still have the operation lookup chart, ie <code>1 = *</code>, <code>2 = /</code>, etc. in Excel sheet). Is there any way to do this without if/then/else statements?</p>\n"}, {"tags": ["vba", "ms-access", "report", "ms-office"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1526508433, "post_id": 50380465, "comment_id": 87777351, "body": "This is not a site where users write code for you from scratch. Show some coding efforts on your side. Besides statements in the post are so general, that they make us guess what&#39;s really needed."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1526512051, "creation_date": 1526512051, "answer_id": 50381152, "question_id": 50380465, "link": "https://stackoverflow.com/questions/50380465/copying-report-fields-in-ms-access-report-vba/50381152#50381152", "title": "Copying report fields in ms access report vba", "body": "<p>To convert an Access 2007 form to a report, follow these steps:</p>\n\n<pre><code>Open the database containing the form.\nClick the name of the form in the Navigation pane.\nClick the Microsoft Office button.\nPoint to Save As and then click Save Object As.\nClick in the Save \"Form_Name\" To text box and enter a name for your report.\nClick the drop-down arrow in the As text box and select Report from the list, then click OK.\n</code></pre>\n\n<p>No VBA required.</p>\n"}], "owner": {"reputation": 11, "user_id": 9802853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sheida Badvipour", "link": "https://stackoverflow.com/users/9802853/sheida-badvipour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1526512590, "creation_date": 1526507710, "last_edit_date": 1526512590, "question_id": 50380465, "link": "https://stackoverflow.com/questions/50380465/copying-report-fields-in-ms-access-report-vba", "title": "Copying report fields in ms access report vba", "body": "<p>I want to create button that copies fields in a report which comes from a form but I cant figure how to write the VBA behind button in VBA . I am sure its pretty simple but cant figure it out. I appreciate if you can help me.</p>\n"}, {"tags": ["vba", "excel", "copy-paste", "paste"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1526508249, "last_edit_date": 1526508249, "creation_date": 1526506949, "answer_id": 50380328, "question_id": 50380267, "link": "https://stackoverflow.com/questions/50380267/how-to-add-pastevalues-to-pastedestination-vba-code/50380328#50380328", "title": "How To Add PasteValues To PasteDestination VBA Code?", "body": "<p>If you only want the values then skip the clipboard and assign the values directly:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 4).Value = FISH Then\n    erow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"Sheet2\").Cells(erow + 1, 1).Value = Worksheets(\"Sheet1\").Cells(i, 3).Value\nEnd If\n</code></pre>\n\n<hr>\n\n<p>If you are determined to use the clipboard then:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 4).Value = FISH Then\n    Worksheets(\"Sheet1\").Cells(i, 3).Copy\n    erow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"Sheet2\").Cells(erow + 1, 1).PasteSpecial xlPasteValues\nEnd If\n</code></pre>\n\n<p>But this will be slower, especially in a loop.</p>\n"}], "owner": {"reputation": 19, "user_id": 9784150, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215851517030158/picture?type=large", "display_name": "Prezza", "link": "https://stackoverflow.com/users/9784150/prezza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50380328, "answer_count": 1, "score": 0, "last_activity_date": 1526508249, "creation_date": 1526506609, "question_id": 50380267, "link": "https://stackoverflow.com/questions/50380267/how-to-add-pastevalues-to-pastedestination-vba-code", "title": "How To Add PasteValues To PasteDestination VBA Code?", "body": "<p>I want to add a line of code to copy only the values of column C with no formatting.</p>\n\n<p>Part of my code currently looks like this:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Cells(i, 4).Value = FISH Then\n    Worksheets(\"Sheet1\").Cells(i, 3).Copy\n    erow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 1)\n</code></pre>\n\n<p>I found a simple PasteValues method online which states the following:</p>\n\n<pre><code>Range(\"A1:A3\").Copy\nRange(\"B1:B3\").pastespecial xlPasteValues\n</code></pre>\n\n<p>However what I actually want is to add the PasteValues into my existing code.</p>\n\n<p>Does anyone know how I could achieve this?</p>\n"}, {"tags": ["vba", "if-statement", "listbox", "userform", "select-case"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9357285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6pncW3kv-xk/AAAAAAAAAAI/AAAAAAAAACs/5HNqxED2u2Y/photo.jpg?sz=128", "display_name": "SSG", "link": "https://stackoverflow.com/users/9357285/ssg"}, "edited": false, "score": 0, "creation_date": 1526569276, "post_id": 50381197, "comment_id": 87805128, "body": "Yes, this worked! Thanks so much. I will keep the If Statement in mind as an option."}], "tags": [], "owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "is_accepted": false, "score": 0, "last_activity_date": 1526512459, "creation_date": 1526512459, "answer_id": 50381197, "question_id": 50380260, "link": "https://stackoverflow.com/questions/50380260/generate-options-for-3rd-listbox-based-on-2nd-listbox-selection/50381197#50381197", "title": "Generate options for 3rd ListBox based on 2nd ListBox selection", "body": "<p>It's got something to do with the Case statement. Don't know exactly what because I don't use it that often but if you have multiple conditions you are usually better of with If. Also consider changing the click events to change events. Using this code should work. </p>\n\n<pre><code>Option Explicit\nPublic ClassX As Integer\nPublic LanguageX As Integer\n\n\n\nPrivate Sub UserForm_Initialize()\n\nWith lstClassName\n        .AddItem \"Cooking\"\n        .AddItem \"Art\"\n        .AddItem \"Music\"\nEnd With\n\n\nEnd Sub\n\n\nPrivate Sub lstClassName_Click()\n\nClassX = lstClassName.ListIndex\n\nSelect Case ClassX\n    Case Is = 0 'Cooking Class\n        lstLanguage.Clear\n        lstLanguage.AddItem \"English\"\n        lstLanguage.AddItem \"Spanish\"\n\n    Case Is = 1 'Art Class\n        lstLanguage.Clear\n        lstLanguage.AddItem \"English\"\n        lstLanguage.AddItem \"French\"\n\n    Case Is = 2 'Music Class\n        lstLanguage.Clear\n        lstLanguage.AddItem \"English\"\n        lstLanguage.AddItem \"Spanish\"\n        lstLanguage.AddItem \"French\"\nEnd Select\n\nlstDay.Clear\n\n\nEnd Sub\n\nPrivate Sub lstLanguage_Click()\n\nLanguageX = lstLanguage.ListIndex\n\nIf ClassX = 0 And LanguageX = 0 Then 'Cooking Class in English\n        lstDay.Clear\n        lstDay.AddItem \"Monday\"\n        lstDay.AddItem \"Wednesday\"\n    ElseIf ClassX = 0 And LanguageX = 1 Then 'Cooking Class in Spanish\n        lstDay.Clear\n        lstDay.AddItem \"Monday\"\n        lstDay.AddItem \"Thursday\"\n    ElseIf ClassX = 1 And LanguageX = 0 Then 'Art Class in English\n        lstDay.Clear\n        lstDay.AddItem \"Tuesday\"\n        lstDay.AddItem \"Friday\"\n    ElseIf ClassX = 1 And LanguageX = 1 Then 'Art Class in French\n        lstDay.Clear\n        lstDay.AddItem \"Wednesday\"\n        lstDay.AddItem \"Thursday\"\n    ElseIf ClassX = 2 And LanguageX = 0 Then 'Music Class in English\n        lstDay.Clear\n        lstDay.AddItem \"Monday\"\n        lstDay.AddItem \"Friday\"\n    ElseIf ClassX = 2 And LanguageX = 1 Then 'Music Class in Spanish\n        lstDay.Clear\n        lstDay.AddItem \"Tuesday\"\n        lstDay.AddItem \"Wednesday\"\n    ElseIf ClassX = 2 And LanguageX = 2 Then 'Music Class in French\n        lstDay.Clear\n        lstDay.AddItem \"Thursday\"\n        lstDay.AddItem \"Friday\"\nEnd If\n\n\nEnd Sub\n\n\n\nPrivate Sub CommandButton1_Click()\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9357285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6pncW3kv-xk/AAAAAAAAAAI/AAAAAAAAACs/5HNqxED2u2Y/photo.jpg?sz=128", "display_name": "SSG", "link": "https://stackoverflow.com/users/9357285/ssg"}, "edited": false, "score": 0, "creation_date": 1526568004, "post_id": 50381328, "comment_id": 87804223, "body": "Yes, changing Select Case LanguageX to Select Case True fixed the issue.  Many thanks!"}, {"owner": {"reputation": 13, "user_id": 9357285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6pncW3kv-xk/AAAAAAAAAAI/AAAAAAAAACs/5HNqxED2u2Y/photo.jpg?sz=128", "display_name": "SSG", "link": "https://stackoverflow.com/users/9357285/ssg"}, "edited": false, "score": 0, "creation_date": 1526568581, "post_id": 50381328, "comment_id": 87804673, "body": "Also thanks for the creative alternative you posted.  As a beginner I appreciate being shown examples like that."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1526597093, "last_edit_date": 1526597093, "creation_date": 1526513422, "answer_id": 50381328, "question_id": 50380260, "link": "https://stackoverflow.com/questions/50380260/generate-options-for-3rd-listbox-based-on-2nd-listbox-selection/50381328#50381328", "title": "Generate options for 3rd ListBox based on 2nd ListBox selection", "body": "<p>A creative alternative for the <strong><code>lstLanguage_Click()</code></strong> here. Since you only have 2 variables, you can convert them into a decimal value for easier coding. <code>ClassX</code> will be the integer part and <code>LanguageX</code> will be the decimal part.</p>\n\n<pre><code>Private Sub lstLanguage_Click()\n    Dim uCode As Double\n    LanguageX = lstLanguage.ListIndex\n    uCode = CDbl(ClassX) + CDbl(LanguageX) / 10\n    lstDay.Clear ' This is done for any one clicked\n    Select Case uCode\n        Case 0# ' (ClassX = 0 And LanguageX = 0) 'Cooking Class in English\n            lstDay.AddItem \"Monday\"\n            lstDay.AddItem \"Wednesday\"\n        Case 0.1 ' (ClassX = 0 And LanguageX = 1) 'Cooking Class in Spanish\n            lstDay.AddItem \"Monday\"\n            lstDay.AddItem \"Thursday\"\n        Case 1#  ' (ClassX = 1 And LanguageX = 0) 'Art Class in English\n            lstDay.AddItem \"Tuesday\"\n            lstDay.AddItem \"Friday\"\n        Case 1.1 ' (ClassX = 1 And LanguageX = 1) 'Art Class in French\n            lstDay.AddItem \"Wednesday\"\n            lstDay.AddItem \"Thursday\"\n        Case 2#  ' (ClassX = 2 And LanguageX = 0) 'Music Class in English\n            lstDay.AddItem \"Monday\"\n            lstDay.AddItem \"Friday\"\n        Case 2.1 ' (ClassX = 2 And LanguageX = 1) 'Music Class in Spanish\n            lstDay.AddItem \"Tuesday\"\n            lstDay.AddItem \"Wednesday\"\n        Case 2.2 ' (ClassX = 2 And LanguageX = 2) 'Music Class in French\n            lstDay.AddItem \"Thursday\"\n            lstDay.AddItem \"Friday\"\n    End Select\nEnd Sub\n</code></pre>\n\n<p>If you prefer stick to the way you are using, the fix is simple.<br>\nChange <code>Select Case LanguageX</code> to <code>Select Case True</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 6565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hiWts.jpg?s=128&g=1", "display_name": "kadrleyn", "link": "https://stackoverflow.com/users/6565786/kadrleyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1611093669, "creation_date": 1611093669, "answer_id": 65800151, "question_id": 50380260, "link": "https://stackoverflow.com/questions/50380260/generate-options-for-3rd-listbox-based-on-2nd-listbox-selection/65800151#65800151", "title": "Generate options for 3rd ListBox based on 2nd ListBox selection", "body": "<p>You can provide faster solutions by using the Dictionary object.\nYou can provide faster solutions by using the Dictionary object.\nFirst, dynamic field names are created for the columns. 3 listboxes are added to the userform, codes are added for the dependent listboxes .</p>\n<p>Source codes and sample workbook <a href=\"https://eksi30.com/excel-dependent-list-boxes/\" rel=\"nofollow noreferrer\">here</a></p>\n<p><a href=\"https://i.stack.imgur.com/BYtLH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BYtLH.gif\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 13, "user_id": 9357285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6pncW3kv-xk/AAAAAAAAAAI/AAAAAAAAACs/5HNqxED2u2Y/photo.jpg?sz=128", "display_name": "SSG", "link": "https://stackoverflow.com/users/9357285/ssg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 50381328, "answer_count": 3, "score": 0, "last_activity_date": 1611975342, "creation_date": 1526506582, "last_edit_date": 1611975342, "question_id": 50380260, "link": "https://stackoverflow.com/questions/50380260/generate-options-for-3rd-listbox-based-on-2nd-listbox-selection", "title": "Generate options for 3rd ListBox based on 2nd ListBox selection", "body": "<p>I wrote a simple version of a userform to pinpoint my issue.</p>\n<p>The selection of ListBox1 <strong><code>lstClassName</code></strong> determines the options for ListBox2 <strong><code>lstClassName</code></strong> (working).</p>\n<p>The selection for ListBox2 is supposed to determine the options for ListBox3 <strong><code>lstLanguage</code></strong> (not working).</p>\n<p>The answers to similar questions involve more than I need this userform to do.</p>\n<p>I uploaded the file to Google Drive. You can see how the form is intended to work. <a href=\"https://drive.google.com/open?id=1DahhTby8JM7jeMR3ZlhJggzo3mEY8wqU\" rel=\"nofollow noreferrer\">Link To Excel File</a></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic ClassX As Integer\nPublic LanguageX As Integer\n\nPrivate Sub UserForm_Initialize()\n    With lstClassName\n        .AddItem &quot;Cooking&quot;\n        .AddItem &quot;Art&quot;\n        .AddItem &quot;Music&quot;\n    End With\nEnd Sub\n    \n    \nPrivate Sub lstClassName_Click()\n    ClassX = lstClassName.ListIndex\n    Select Case ClassX\n    Case Is = 0 'Cooking Class\n        lstLanguage.Clear\n        lstLanguage.AddItem &quot;English&quot;\n        lstLanguage.AddItem &quot;Spanish&quot;\n     Case Is = 1 'Art Class\n        lstLanguage.Clear\n        lstLanguage.AddItem &quot;English&quot;\n        lstLanguage.AddItem &quot;French&quot;\n    Case Is = 2 'Music Class\n        lstLanguage.Clear\n        lstLanguage.AddItem &quot;English&quot;\n        lstLanguage.AddItem &quot;Spanish&quot;\n        lstLanguage.AddItem &quot;French&quot;\n    End Select\nEnd Sub\n    \nPrivate Sub lstLanguage_Click()\n    LanguageX = lstLanguage.ListIndex\n    Select Case LanguageX\n    Case (ClassX = 0 And LanguageX = 0) 'Cooking Class in English\n        lstDay.Clear\n        lstDay.AddItem &quot;Monday&quot;\n        lstDay.AddItem &quot;Wednesday&quot;\n    Case (ClassX = 0 And LanguageX = 1) 'Cooking Class in Spanish\n        lstDay.Clear\n        lstDay.AddItem &quot;Monday&quot;\n        lstDay.AddItem &quot;Thursday&quot;\n    Case (ClassX = 1 And LanguageX = 0) 'Art Class in English\n        lstDay.Clear\n        lstDay.AddItem &quot;Tuesday&quot;\n        lstDay.AddItem &quot;Friday&quot;\n    Case (ClassX = 1 And LanguageX = 1) 'Art Class in French\n        lstDay.Clear\n        lstDay.AddItem &quot;Wednesday&quot;\n        lstDay.AddItem &quot;Thursday&quot;\n    Case (ClassX = 2 And LanguageX = 0) 'Music Class in English\n        lstDay.Clear\n        lstDay.AddItem &quot;Monday&quot;\n        lstDay.AddItem &quot;Friday&quot;\n    Case (ClassX = 2 And LanguageX = 1) 'Music Class in Spanish\n        lstDay.Clear\n        lstDay.AddItem &quot;Tuesday&quot;\n        lstDay.AddItem &quot;Wednesday&quot;\n    Case (ClassX = 2 And LanguageX = 2) 'Music Class in French\n        lstDay.Clear\n        lstDay.AddItem &quot;Thursday&quot;\n        lstDay.AddItem &quot;Friday&quot;\n    End Select\nEnd Sub\n    \nPrivate Sub CommandButton1_Click()\n    'This would then be the button to add data to a part of the spreadsheet\nEnd Sub\n</code></pre>\n<p>Note: I didn't bother finishing the code for the CommandButton or what to do with the data from this userform.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526509532, "post_id": 50380033, "comment_id": 87777701, "body": "You said &quot;all sheets&quot; but your code has no attempt to loop all sheets. And some variables that are being used are not referenced on the code. More code is needed. Your &quot;problem&quot; is very simple with a simple For Loop to get all sheets, get the last used row and apply the border. I strongly recommend to spend some time learning the basics of VBA for Excel, which will teach you how to loop Sheets and the answer to your problem will be clear."}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526511008, "post_id": 50380033, "comment_id": 87778115, "body": "Read &quot;tried modifying&quot; , I hadn&#39;t included the code that I worked on. It&#39;s included now. I was able to resolve the issue.   P.S - Please ask for missing info instead of down voting a question ;)"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526511508, "post_id": 50380033, "comment_id": 87778265, "body": "Nice edit and I am glad you found an answer. You seem to be mistaken. Read your first post before the edit and you will understand that without the missing data added later, it feels like you are requesting for someone to write the whole solution for you. Therefore the initial downvote."}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526511699, "post_id": 50380033, "comment_id": 87778317, "body": "Yeah, sorry. I realize that my question didn&#39;t include my effort."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526534350, "post_id": 50380033, "comment_id": 87783145, "body": "Posting your answer to the problem would also be of potential use to others with similar problems i.e. not as an edit to the question. In 2 days you can then accept it as answer."}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "edited": false, "score": 0, "creation_date": 1526573522, "post_id": 50380033, "comment_id": 87807899, "body": "I didn&#39;t know that I can my own question. I just added my answer. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "is_accepted": false, "score": 0, "last_activity_date": 1526573493, "creation_date": 1526573493, "answer_id": 50396085, "question_id": 50380033, "link": "https://stackoverflow.com/questions/50380033/dynamic-borders-in-a-excel-workbook/50396085#50396085", "title": "Dynamic borders in a Excel Workbook", "body": "<p>Resolved by using the below code: </p>\n\n<p>Sub AllWorksheetBorders()</p>\n\n<pre><code>Application.ScreenUpdating = False    'Prevents screen refreshing\nDim lngLstCol As Long, lngLstRow As Long, ws As Worksheet\nDim rngCell As Range, r As Long, c As Long\n\nFor Each ws In ActiveWorkbook.Worksheets\n    lngLstRow = ws.UsedRange.Rows.Count\n    lngLstCol = ws.UsedRange.Columns.Count\n\n    For Each rngCell In ws.Range(\"A21:A\" &amp; lngLstRow)\n        If rngCell.Value &lt;&gt; \"\" Then\n            r = rngCell.Row\n            c = rngCell.Column\n\n            With ws.Range(ws.Cells(r, c), ws.Cells(r, lngLstCol)).Borders\n                .LineStyle = xlContinuous    'Setting style of border line\n                .Weight = xlThin    'Setting weight of border line\n                .ColorIndex = xlAutomatic    'Setting colour of border line\n            End With\n        End If\n    Next\nNext\n\nApplication.ScreenUpdating = True    'Enables screen refreshing\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1526573493, "creation_date": 1526505540, "last_edit_date": 1531164843, "question_id": 50380033, "link": "https://stackoverflow.com/questions/50380033/dynamic-borders-in-a-excel-workbook", "title": "Dynamic borders in a Excel Workbook", "body": "<p>I have 50 sheets in the workbook. The table header range is A:Z. The data range differs from sheet to sheet. I got VBA code which puts a border on the non-empty cells but some fields are blank in the data. Can somebody help with the script? </p>\n\n<p>Below is the code that I tried modifying to apply to all sheets, in vain:</p>\n\n<pre><code>Sub testborder()\n\n    Dim rRng As Range\n\n    Set rRng = Sheet1.Range(\"A14:K14\" &amp; endrow)\n\n    'Clear existing\n    rRng.Borders.LineStyle = xlNone\n\n    'Apply new borders\n    rRng.BorderAround xlContinuous\n    rRng.Borders(xlInsideHorizontal).LineStyle = xlContinuous\n    rRng.Borders(xlInsideVertical).LineStyle = xlContinuous\nEnd Sub\n</code></pre>\n\n<p>Resolved by using the below code:</p>\n\n<pre><code>Sub AllWorksheetBorders()\n\n    Application.ScreenUpdating = False    'Prevents screen refreshing\n    Dim lngLstCol As Long, lngLstRow As Long, ws As Worksheet\n    Dim rngCell As Range, r As Long, c As Long\n\n    For Each ws In ActiveWorkbook.Worksheets\n        lngLstRow = ws.UsedRange.Rows.Count\n        lngLstCol = ws.UsedRange.Columns.Count\n\n        For Each rngCell In ws.Range(\"A21:A\" &amp; lngLstRow)\n            If rngCell.Value &lt;&gt; \"\" Then\n                r = rngCell.Row\n                c = rngCell.Column\n\n                With ws.Range(ws.Cells(r, c), ws.Cells(r, lngLstCol)).Borders\n                    .LineStyle = xlContinuous    'Setting style of border line\n                    .Weight = xlThin    'Setting weight of border line\n                    .ColorIndex = xlAutomatic    'Setting colour of border line\n                End With\n            End If\n        Next\n    Next\n\n    Application.ScreenUpdating = True    'Enables screen refreshing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1526509420, "post_id": 50380072, "comment_id": 87777669, "body": "Bruce, re: v2 - formula is being put into K1 to count number of occurrences of negative numbers in column J, and if that number is greater than none, then color the tab red.  I can&#39;t tell without trying in Excel and am not near Excel now, but will try the code tomorrow.  Hopefully, what you mean is that v2 will be able to evaluate the condition without actually pasting a formula into K1."}, {"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1526560572, "post_id": 50380072, "comment_id": 87798758, "body": "Bruce, v2 did not work at all and no errors. First version worked a treat - Thank You for your solution.  Can you also make the red tabs group upfront and tabs remained not colored to group at the end? @BruceWayne"}, {"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1526564934, "post_id": 50380072, "comment_id": 87801995, "body": "Found below code which works to group tabs by color:                       &#39;Sub GroupSheetsByColor()  Dim lCount As Long, lCounted As Long  Dim lShtLast As Long    lShtLast = Sheets.Count            For lCount = 1 To lShtLast              For lCounted = lCount To lShtLast                  If Sheets(lCounted).Tab.ColorIndex = Sheets(lCount).Tab.ColorIndex Then                      Sheets(lCounted).Move Before:=Sheets(lCount)                  End If              Next lCounted          Next lCount       End Sub&#39;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1526566785, "post_id": 50380072, "comment_id": 87803291, "body": "@Alex - These should be new questions if you haven&#39;t figured out how to do it."}, {"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1526572569, "post_id": 50380072, "comment_id": 87807366, "body": "code I pasted just above does work to group tabs by color, figured may be useful for somebody as well.  Thanks again!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1526505770, "creation_date": 1526505770, "answer_id": 50380072, "question_id": 50379974, "link": "https://stackoverflow.com/questions/50379974/coloring-excel-tabs-based-on-cell-value-on-each-sheet/50380072#50380072", "title": "Coloring Excel Tabs based on cell value on each sheet", "body": "<p>Always make sure you're referencing the intended sheet. Having simply <code>Range(A1)</code> will refer to the active sheet.  You need to do <code>Sheets(\"MySheet\").Range(A1)</code>.  Note it's also best practice to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code>/<code>.Activate</code></a></p>\n\n<pre><code>Sub IfJNegRedTab()\nDim sht     As Worksheet\n\nFor Each sht In ActiveWorkbook.Worksheets\n    With sht\n        .Range(\"K1\").FormulaR1C1 = \"=COUNTIF(C[-1],\"\"&lt;0\"\")\"\n        If .Range(\"K1\").Value &gt; 0 Then\n            With .Tab\n                .Color = 255\n                .TintAndShade = 0\n            End With\n        End If\n    End With\nNext sht\nEnd Sub\n</code></pre>\n\n<p>Also the formula in <code>K1</code> just being used to check the column to the left's value can be removed:</p>\n\n<pre><code>Sub IfJNegRedTab_v2()\nDim sht     As Worksheet\n\nFor Each sht In ActiveWorkbook.Worksheets\n    With sht\n        If .Range(\"K1\").Offset(0, -1).Value &lt; 0 Then\n            With .Tab\n                .Color = 255\n                .TintAndShade = 0\n            End With\n        End If\n    End With\nNext sht\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 50380072, "answer_count": 1, "score": 1, "last_activity_date": 1526505770, "creation_date": 1526505229, "question_id": 50379974, "link": "https://stackoverflow.com/questions/50379974/coloring-excel-tabs-based-on-cell-value-on-each-sheet", "title": "Coloring Excel Tabs based on cell value on each sheet", "body": "<p>Trying to have VBA loop through sheets and color tab red if K1 on each sheet is > 0.  What I have so far fails to loop through sheets, just colors active sheet:</p>\n\n<pre><code>    Sub IfJNegRedTab()\n'\n'\n'\nDim sht As Worksheet\n\nFor Each sht In ActiveWorkbook.Worksheets\n\nRange(\"K1\").Select\nActiveCell.FormulaR1C1 = \"=COUNTIF(C[-1],\"\"&lt;0\"\")\"\n\nIf Range(\"K1\").Value &gt; 0 Then\nWith ActiveWorkbook.ActiveSheet.Tab\n        .Color = 255\n        .TintAndShade = 0\nEnd With\nEnd If\nNext sht\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1526507048, "post_id": 50380309, "comment_id": 87776876, "body": "Perfect! Thanks."}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1526506896, "creation_date": 1526506896, "answer_id": 50380309, "question_id": 50379971, "link": "https://stackoverflow.com/questions/50379971/add-row-to-table-named-range-with-specific-values/50380309#50380309", "title": "Add row to table/named range with specific values?", "body": "<pre><code>Dim Your_Table As ListObject\nDim New_Row As ListRow\n\nSet Your_Table =ActiveSheet.ListObjects(\"tableName\")\nSet New_Row = Your_Table.ListRows.Add\n\nNew_Row.Range(1) = foo\n</code></pre>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 50380309, "answer_count": 1, "score": 1, "last_activity_date": 1526506896, "creation_date": 1526505211, "last_edit_date": 1531164843, "question_id": 50379971, "link": "https://stackoverflow.com/questions/50379971/add-row-to-table-named-range-with-specific-values", "title": "Add row to table/named range with specific values?", "body": "<p>I'm simply trying to add a new row to a table and specify certain values.  Right now, I am adding the row using the following code:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"tableName\").ListRows.Add\n</code></pre>\n\n<p>This works, but now how would I make the first column have the value <code>foo</code>?</p>\n\n<p><code>ListRows.Add()</code> only supports one parameter, an index at which it will add the row.  Is there another function I can use?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1526504786, "post_id": 50379741, "comment_id": 87776011, "body": "This answer should point you in the direction ... <a href=\"https://stackoverflow.com/a/50366447/4961700\">stackoverflow.com/a/50366447/4961700</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1526506990, "post_id": 50379741, "comment_id": 87776853, "body": "@SolarMike I don&#39;t think that answer is helpful for this question."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1526507031, "post_id": 50379741, "comment_id": 87776867, "body": "A couple options here: checking that the original condition logic is met; using a helper column; or checking the <code>DisplayFormat.Interior.Color</code> of the cell."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1526510554, "post_id": 50379741, "comment_id": 87777980, "body": "Another option: Use an <code>AutoFilter</code> with <code>Operator:=xlFilterCellColor</code> (for the column) to move all rows at once"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526512225, "post_id": 50379741, "comment_id": 87778457, "body": "If you please don&#39;t mind attaching a vba for this action, i would appreciate your time."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1526588840, "post_id": 50379741, "comment_id": 87815907, "body": "Have you done any work toward this yourself yet?"}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1526529091, "post_id": 50382853, "comment_id": 87781734, "body": "Please reread the question again, he wants only the column for the current month to be checked for cell color, not all cells in the data range, Hard coding the column will not work because the last column will change every month.  Also, your Insert will flip the rows, so the last row will be on the first row. Paste and last row +1 for sheet2 would probably be the best choice. You might want to edit your answer."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1526566327, "post_id": 50382853, "comment_id": 87802946, "body": "@GMalc you are absolutely right, fixed based on your input (for some reason I found your descript much clearer than OP). Edited to improve answer. TY"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526587551, "post_id": 50382853, "comment_id": 87815274, "body": "Thanks for your time and code but, i was able to do the same using a find pop up box and even using your code but as i mentioned in my question that when this color is applied in the background using conditional formatting then its not identifying the red cells/color.               This is only working when, i manually fill the color in each cell. So, i would appreciate if you can please edit the code according to this requirement. Everything is working as i needed except it&#39;s not identifying the color if applied through conditional format and even i need headers when copying to sheet2. TY"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526588454, "post_id": 50382853, "comment_id": 87815721, "body": "Even, i have edited my table where the operators are in separate column. What i am doing here is, i am creating a Name Manager (Comparetotarget) using below formula &quot;evaluate(concatenate(sheet1!D2,Sheet1!$C2,Sheet1!$D2)) which evaluates the values in cells as &quot;10 &gt;= 5&quot;, which is applied to all the cells from D2:F7. Then applying the conditional format on top of this cells using &quot;if(not(comparetotarget),if(ABS((D2-$C2/$C2)&gt;5%,&quot;True&quot;))&quot; then cells change to red, if &lt;=5% then yellow and if equal to &quot;comparetotarget&quot; then green. So, when this colors are applied, this vba not identifying the colors"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1526588746, "post_id": 50382853, "comment_id": 87815860, "body": "I switched the check color statement to, Cells(rowNum, lastColumn).DisplayFormat.Interior.Color = vbRed. make sure that you set the conditional coloring to vb red, same color as in my photo. this should work. let me know."}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526600278, "post_id": 50382853, "comment_id": 87819475, "body": "Now, its working fine but it&#39;s not copying the header to &quot;Sheet2&quot; and even the formatting is changed when copied. So, if you can please add this vba to copy even the &quot;header&quot; and finally after everything copied, apply the same format from &quot;sheet1&quot; to &quot;sheet2&quot;. So, the coloring and conditional formats should looks same. I would also appreciate, if you can please add few comments to your code, so i can understand what each line/part is doing, so i can do some adjustments, if required in future. TY @learnAsWeGo"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1526653055, "post_id": 50382853, "comment_id": 87842255, "body": "added a bit more hopefully enough for an upvote and correct answer, take care rockstar"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526941482, "post_id": 50382853, "comment_id": 87928265, "body": "Hi @learnAsWeGo, Thank you for the detail explanation and yes everything is correct. Except, as we are using rowCounter to avoid pasting over the data just pasted which is working good but it is moving down the headers row below all the cells because the insert option is doing this every time its pasting in A1:F1 cells. I tried to change things but not working around. So, is there any way we can lock the header row once copied and move all the remaining data from cells below it or even we can paste the header in the last. Its also not applying Cond. Format from previous sheet to this sheet. TY"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1526942155, "post_id": 50382853, "comment_id": 87928435, "body": "yea change  wsTwo.Range(&quot;A1:F1&quot;).Insert to  wsTwo.Range(&quot;A2:F2&quot;).Insert see edit  also please accept as answer ty"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526948035, "post_id": 50382853, "comment_id": 87929701, "body": "Thank you so much @learnAsWeGo for your help, i really appreciate your time. Yes, its working now."}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1526948396, "post_id": 50382853, "comment_id": 87929781, "body": "I was also trying to clear cells based on specific range, i declared the range as &quot;dim rn as range&quot; on top and in the clear cells line, i tried to add this but giving me an error &quot; wstwo.rn(&quot;A2&quot;, selection.end(x1ToRight), selection.End(x1Down)).ClearContents &quot; but its not understand, i think i am doing something wrong here. I was trying to clear based on selecting one cell like &quot;A2&quot; and then ctrl+shift+right to select right most column with data and then down using down instead of right. So, it will select only those specific range to clear contents of it. Can you help, if you don&#39;t mind."}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1527103681, "post_id": 50382853, "comment_id": 88004902, "body": "Hi @learnAsWeGo, can i use the copy paste option instead of insert in my code when red cell is identified, because when i am using a copy/paste using source formatting, its pasting on top of one another. So, is there any way i can make them copy same as usual like insert, because as we are going from bottom to top acc to your VBA. so, i want the row to be in same manner while pasting. I would appreciate, if you or anyone can help, thanks."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1527103988, "post_id": 50382853, "comment_id": 88005041, "body": "Yes you can, but you need to set up a counter to keep track of the row number that you are pasting in in sheet2, otherwise you will paste over itself over and over"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1527105682, "post_id": 50382853, "comment_id": 88005881, "body": "as for stretching the range of your copy paste, you have to find a way to replace the F in ws.Range(&quot;A1:F1&quot;) and wsTwo.Range(&quot;A1:F1&quot;) with the value in lastColumn...problem is lastColumn is an int. you have to link number with corresponding alphabetical column value...dictionary may be the way to go. goodluck @rockstar"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1527108948, "post_id": 50382853, "comment_id": 88007499, "body": "So, how do i set up a counter to keep track of the row number that i am pasting in sheet2, so it doesn&#39;t paste over and over.  I am trying to use this option for pasting which uses source formatting and values. &quot;wsTwo.Range(&quot;A2:I2&quot;).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone, SkipBlanks:=False, Transpose:=False&quot; and &quot;wsTwo.Range(&quot;A2:I2&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False&quot;. Which is working fine but just need to paste one after another instead of one over another, instead of using this &quot;wsTwo.Range(&quot;A2:I2&quot;).Insert&quot;"}, {"owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "edited": false, "score": 0, "creation_date": 1527196728, "post_id": 50382853, "comment_id": 88049212, "body": "Hi @learnAsWeGo, can you help on the counter issue, i just discussed above, i tried different ways but same error pasting one over another. TY"}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 1, "last_activity_date": 1526942127, "last_edit_date": 1526942127, "creation_date": 1526527199, "answer_id": 50382853, "question_id": 50379741, "link": "https://stackoverflow.com/questions/50379741/copy-paste-entire-row-if-the-cell-has-red-green-yellow-color-in-excel/50382853#50382853", "title": "Copy paste entire row if the cell has red/green/Yellow color in excel", "body": "<p>INPUT (IN WORKSHEET1):</p>\n\n<p><img src=\"https://i.stack.imgur.com/4NpcW.png\" alt=\"MyImage\"></p>\n\n<p>OUTPUT (IN WORKSHEET2):</p>\n\n<p><img src=\"https://i.stack.imgur.com/oBHO0.png\" alt=\"MyImage\"></p>\n\n<pre><code>    Sub newnew()\n</code></pre>\n\n<blockquote>\n  <p>declaring the worksheets, Sheet2 and Sheet3 should be changed to match your sheet names</p>\n</blockquote>\n\n<pre><code>    Dim ws As Worksheet\n        Set ws = Sheets(\"Sheet2\")\n\n    Dim wsTwo As Worksheet\n       Set wsTwo = Sheets(\"Sheet3\")\n</code></pre>\n\n<blockquote>\n  <p>clearing out previous data in wsTwo</p>\n</blockquote>\n\n<pre><code>    wsTwo.Cells.Clear\n</code></pre>\n\n<blockquote>\n  <p>finding the last row and column for ws with data inside</p>\n</blockquote>\n\n<pre><code>    Dim lastRow As Integer\n        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    Dim lastColumn As Integer\n        lastColumn = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<blockquote>\n  <p>we are setting up the header here</p>\n</blockquote>\n\n<pre><code>    ws.Range(\"A1:F1\").Copy\n    wsTwo.Range(\"A1:F1\").PasteSpecial xlPasteAll\n    Application.CutCopyMode = False\n</code></pre>\n\n<blockquote>\n  <p>beginning our loop from the last row and moving upwards till we hit row 2. We are checking if rowNum and lastColumn display format interior color is red. If it is we are taking that range, copying it, then pasting it in wsTwo. Note that we have that rowCounter which we set before entering the for loop. we will use that as a placeholder, incrementing every time that we paste in ws two, so that we don't paste over data we just pasted.</p>\n</blockquote>\n\n<pre><code>     Dim rowCounterWsTwo As Integer\n         rowCounterWsTwo = 2\n\n    For rowNum = lastRow To 2 Step -1\n            If Cells(rowNum, lastColumn).DisplayFormat.Interior.Color = vbRed = vbRed Then\n                ws.Range(Cells(rowNum, 1), Cells(rowNum, lastColumn)).Copy\n                wsTwo.Range(\"A2:F2\").Insert\n                Application.CutCopyMode = False\n                rowCounterWsTwo = rowCounterWsTwo + 1\n            End If\n    Next rowNum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9465349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601ac4365874c03f83f8e918a5218acd?s=128&d=identicon&r=PG&f=1", "display_name": "rockstar", "link": "https://stackoverflow.com/users/9465349/rockstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3241, "favorite_count": 0, "accepted_answer_id": 50382853, "answer_count": 1, "score": 0, "last_activity_date": 1526942127, "creation_date": 1526504136, "last_edit_date": 1526588825, "question_id": 50379741, "link": "https://stackoverflow.com/questions/50379741/copy-paste-entire-row-if-the-cell-has-red-green-yellow-color-in-excel", "title": "Copy paste entire row if the cell has red/green/Yellow color in excel", "body": "<p>I have a table with values based on monthly based and product in 1st column as shown below (Say \"sheet1\"). This table has conditional formatting applied to highlight cell colors red/yellow/green based on target. So, I want to take only specific month(current month- May) column and want VBA to check, if any cell in that column is Red, select that entire row and copy past it into another sheet for example \"Sheet2\" with headers.</p>\n\n<pre><code>Product   =  Target   Feb Mar Apr May\nWood     &gt;=    5      10  10  10  10\nwood     &gt;=    5      28  28  28  28\nTree     &gt;=   12      30  45  60  68\nplastic  &gt;=   45      50  50  50  50\ntree     &gt;=   50      50  50  50  50\niron     &gt;=   100     64  75  75  80\n</code></pre>\n\n<p>The values will change monthly and even sometimes target, so the coloring can be totally green/yellow/red sometimes. So, I want to automate this process using VBA, to go and check on \"Sheet1\" every month and pull any rows which has red cell highlighted for that month. OR even a button function could also help, so I can assign this macro to a button, this action should be done by clicking the button. Even it should also clear all rows from earlier month in Sheet2, which might have highlighted in last month but not in this month.</p>\n\n<p>I tried, different ways to do this, its not recognizing the cell color. When I use the random/regular cell out of table and fill with red color and use find(ctrl+f) popup box to highlight using color format, it is working but its not taking the cells which has conditional formatting in a table. So, I don't know if there is a way to identify all the cells in the table which is highlighted in red using VBA.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526506006, "post_id": 50380104, "comment_id": 87776484, "body": "Thank you very much.  Is there any reading that tells us when to use parentheses and when not to?"}, {"owner": {"reputation": 96, "user_id": 7768666, "user_type": "registered", "profile_image": "https://graph.facebook.com/3529176673094/picture?type=large", "display_name": "Brian K. Burge", "link": "https://stackoverflow.com/users/7768666/brian-k-burge"}, "reply_to_user": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526506138, "post_id": 50380104, "comment_id": 87776533, "body": "Generally in VBA you use parens when it is a function (I.E. it returns a value) for Subroutines (I.E. execute some code but don&#39;t return anything) you just pass the parameters in without any.  There are a lot of little gotcha&#39;s in VB like that :)"}, {"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526506550, "post_id": 50380104, "comment_id": 87776691, "body": "Also, my main() sub didn&#39;t work as I had expected.  I was trying to add two different ranges (1-10 and 21-30) to the collection.  However, it ended up assigning the 21-30 twice.  I guess I&#39;ll have to create a new object before adding it to collection.  What is the best way to do it in my case?  Thanks again!"}], "tags": [], "owner": {"reputation": 96, "user_id": 7768666, "user_type": "registered", "profile_image": "https://graph.facebook.com/3529176673094/picture?type=large", "display_name": "Brian K. Burge", "link": "https://stackoverflow.com/users/7768666/brian-k-burge"}, "is_accepted": true, "score": 2, "last_activity_date": 1526505909, "creation_date": 1526505909, "answer_id": 50380104, "question_id": 50379722, "link": "https://stackoverflow.com/questions/50379722/user-defined-class-object-doesnt-support-this-property-or-method/50380104#50380104", "title": "User Defined Class - Object doesn&#39;t support this property or method", "body": "<p>try </p>\n\n<pre><code>rs.Add r '&lt;--take out parentheses.\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 50380104, "answer_count": 1, "score": 0, "last_activity_date": 1526505909, "creation_date": 1526504021, "last_edit_date": 1531164843, "question_id": 50379722, "link": "https://stackoverflow.com/questions/50379722/user-defined-class-object-doesnt-support-this-property-or-method", "title": "User Defined Class - Object doesn&#39;t support this property or method", "body": "<p>I'm learning user defined classes by building two:\n- Class cRange has low and high properties.\n- Class cRanges is a collection of cRange.  I defined Add and Remove method for it.</p>\n\n<p>I couldn't figure out what's wrong with the code below:</p>\n\n<p>Main program:</p>\n\n<pre><code>Sub main()\n\nDim r As New cRange\nDim rs As New cRanges\n\nr.Low = \"1\"\nr.High = \"10\"\nrs.Add (r)\n\nr.Low = \"21\"\nr.High = \"30\"\nrs.Add (r) '&lt;-- Object doesn't support this property or method\n\nDebug.Print (rs.Contains(\"5\"))\nDebug.Print (rs.Contains(\"15\"))\nDebug.Print (rs.Contains(\"25\"))\n\nEnd Sub\n</code></pre>\n\n<p>cRange class module:</p>\n\n<pre><code>' CLASS MODULE - cRange\n' Member variables\nPrivate m_Low As String\nPrivate m_High As String\n\n\n' Properties\nProperty Get Low() As String\n    Low = m_Low\nEnd Property\n\nProperty Get High() As String\n    High = m_High\nEnd Property\n\nProperty Let Low(s As String)\n    m_Low = s\nEnd Property\n\nProperty Let High(s As String)\n    m_High = s\nEnd Property\n\n' Methods\nPublic Function Contains(s As String) As Boolean\n\nIf Val(s) &gt;= Val(m_Low) And Val(s) &lt;= Val(m_High) Then\n    Contains = True\nElse\n    Contains = False\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>cRanges class module:</p>\n\n<pre><code>' CLASS MODULE - cRanges\n' Member variables\nPrivate m_Ranges As New Collection\n\n\n' Methods\nPublic Sub Add(r As cRange)\n    m_Ranges.Add (r)\nEnd Sub\n\nPublic Sub Remove(r As cRange)\n    m_Ranges.Remove (r)\nEnd Sub\n\n\nPublic Function Contains(s As String) As Boolean\n\nFor Each r In m_Ranges\n    If r.Contains(s) Then\n        Contains = True\n        Exit Function\n    End If\nNext\n\nContains = False\nEnd Function\n</code></pre>\n\n<p>Thank you......................................................................................................................................................................................................................................................</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1526503889, "post_id": 50379656, "comment_id": 87775601, "body": "<code>Worksheet_calculate</code> does not have <code>ByVal Target As Range</code>  and you cannot just add it expecting it to work."}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526504058, "post_id": 50379656, "comment_id": 87775675, "body": "@ScottCraner <code>Worksheet_Change</code> didn&#39;t do anything either"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1526504118, "post_id": 50379656, "comment_id": 87775698, "body": "Worksheet change does not capture changes due to formulas.  You will need to save the values in another location then compare the values after calc, if different then save the new values in the other location and run the sub"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1526504282, "post_id": 50379656, "comment_id": 87775777, "body": "So the question is, &quot;Are these cells being changed by formula or by manual input directly in the cells?&quot;"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526504291, "post_id": 50379656, "comment_id": 87775782, "body": "@ScottCraner Thanks. I changed to back to <code>Worksheet_Calculate</code> and simply called the macro and it works."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "is_accepted": false, "score": 0, "last_activity_date": 1526504440, "creation_date": 1526504440, "answer_id": 50379812, "question_id": 50379656, "link": "https://stackoverflow.com/questions/50379656/change-event-not-calling-macro-excel-vba/50379812#50379812", "title": "Change event not calling macro Excel Vba", "body": "<p>I simply used <code>worksheet_calculate</code> and called the function when anything changes on the worksheet.<br>\nAll the macro it is calling does is set the axes, so I don't mind if it runs repeatedly.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n        Call SetAxes\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526506119, "creation_date": 1526506119, "answer_id": 50380152, "question_id": 50379656, "link": "https://stackoverflow.com/questions/50379656/change-event-not-calling-macro-excel-vba/50380152#50380152", "title": "Change event not calling macro Excel Vba", "body": "<p>as a workaround, you could add a function:</p>\n\n<pre><code>Function FakeChange() As Integer\nSetAxes\nFakeChange = 0\nEnd Function\n</code></pre>\n\n<p>and add behind your formulas in \"$H$5:$H$32\" +Fakechange()\nlike: ='your formula'+ FakeChange()</p>\n\n<p>This function will be triggered when the results of your formulas are changed</p>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 1, "last_activity_date": 1526511175, "creation_date": 1526511175, "answer_id": 50381032, "question_id": 50379656, "link": "https://stackoverflow.com/questions/50379656/change-event-not-calling-macro-excel-vba/50381032#50381032", "title": "Change event not calling macro Excel Vba", "body": "<p><code>Target.Address = \"$H$5:$H$32\"</code> will only be True if that entire range changes at once.</p>\n\n<p>To trap changes to one or more cells within that range, use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-intersect-method-excel\" rel=\"nofollow noreferrer\">Application.Intersect</a> like this:</p>\n\n<pre><code>If Not Application.Intersect(Target, Range(\"$H$5:$H$32\")) Is Nothing Then\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 50381032, "answer_count": 3, "score": 0, "last_activity_date": 1526511175, "creation_date": 1526503775, "last_edit_date": 1531164843, "question_id": 50379656, "link": "https://stackoverflow.com/questions/50379656/change-event-not-calling-macro-excel-vba", "title": "Change event not calling macro Excel Vba", "body": "<p>I have a range of values in a column which I am targeting.<br>\nOnce any of the values in that range changes, it is supposed to call a macro.\nThe macro I am calling works but my change event is not getting recognized. Is there something wrong with my code?</p>\n\n<p>My change even macro is located on the sheet where the change event is happening:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$H$5:$H$32\" Then\n        Call SetAxes\n    End If\nEnd Sub\n</code></pre>\n\n<p>Do I need to be more specific with the range address?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1526502630, "post_id": 50379402, "comment_id": 87775086, "body": "please read: <a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/245115/&hellip;</a>"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1526505736, "post_id": 50379402, "comment_id": 87776381, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/170070/what-are-the-differences-between-using-the-new-keyword-and-calling-createobject\">What are the differences between using the New keyword and calling CreateObject in Excel VBA?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 3, "last_activity_date": 1526502584, "creation_date": 1526502584, "answer_id": 50379428, "question_id": 50379402, "link": "https://stackoverflow.com/questions/50379402/excel-vba-difference-between-createobject-and-new-internet-explorer/50379428#50379428", "title": "Excel VBA - Difference Between CreateObject and New Internet Explorer", "body": "<p>The first one is late binding, and the second one is early binding. Early binding also requires a reference in the project whereas late binding does not.</p>\n"}], "owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 50379428, "answer_count": 1, "score": 0, "last_activity_date": 1526502584, "creation_date": 1526502486, "question_id": 50379402, "link": "https://stackoverflow.com/questions/50379402/excel-vba-difference-between-createobject-and-new-internet-explorer", "title": "Excel VBA - Difference Between CreateObject and New Internet Explorer", "body": "<p>Can someone please explain to me if there is a difference between </p>\n\n<pre><code>Set objIE = CreateObject(\"internetexplorer.application\")\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Set objIE = New InternetExplorer\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 1966207, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Gfx87.jpg?s=128&g=1", "display_name": "arunpandiyarajhen", "link": "https://stackoverflow.com/users/1966207/arunpandiyarajhen"}, "edited": false, "score": 1, "creation_date": 1526591441, "post_id": 50379363, "comment_id": 87816974, "body": "Thanks a lot for the code.  I don&#39;t know why <b>objWorksheet2.Range(&quot;C1&quot;).PasteSpecial xlValues</b> is not working for me. but objWorksheet2.Range(&quot;C1&quot;).PasteSpecial -4163 works.  Any idea?   Thanks a lot."}, {"owner": {"reputation": 252, "user_id": 5571079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81bcd85d899171668d140768f2c7f84a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam H", "link": "https://stackoverflow.com/users/5571079/sam-h"}, "edited": false, "score": 0, "creation_date": 1526639327, "post_id": 50379363, "comment_id": 87833725, "body": "This is because <code>xlValues</code> would normally be defined as a constant at the beginning of the VBS file - it is missing from this snippet."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1526502304, "creation_date": 1526502304, "answer_id": 50379363, "question_id": 50379205, "link": "https://stackoverflow.com/questions/50379205/how-to-copy-specific-column-values-from-one-excel-file-to-another/50379363#50379363", "title": "How to Copy specific column values from one excel file to another?", "body": "<p>Try this. You should get in the habit of declaring your variables (as well as formatting your code).</p>\n\n<pre><code>Sub x()\n\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\n\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\A.xls\")\nSet objWorkbook2 = objExcel.Workbooks.Open(\"C:\\C.xls\")\n\nSet objWorksheet = objWorkbook.Worksheets(1)\n\nSet objRange = objWorksheet.Range(\"A:Q\").EntireColumn\nobjRange.Copy 'not sure what this does\n\nSet objWorksheet2 = objWorkbook2.Worksheets(1)\n\nobjWorksheet.Range(\"A:B\").Copy objWorksheet2.Range(\"A1\")\n\nobjWorksheet.Columns(\"Q\").EntireColumn.Copy\nobjWorksheet2.Range(\"C1\").PasteSpecial xlValues\n\nobjWorkbook2.Save\nobjWorkbook2.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 1966207, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Gfx87.jpg?s=128&g=1", "display_name": "arunpandiyarajhen", "link": "https://stackoverflow.com/users/1966207/arunpandiyarajhen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526524845, "creation_date": 1526501569, "last_edit_date": 1531161705, "question_id": 50379205, "link": "https://stackoverflow.com/questions/50379205/how-to-copy-specific-column-values-from-one-excel-file-to-another", "title": "How to Copy specific column values from one excel file to another?", "body": "<p>I'm trying to copy specific column values from one excel file to the other.  This is what I've tried.</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\A.xls\")\nSet objWorkbook2 = objExcel.Workbooks.Open(\"C:\\C.xls\")\n\nSet objWorksheet = objWorkbook.Worksheets(1)\nobjWorksheet.Activate\n\nSet objRange = objWorksheet.Range(\"A:Q\").EntireColumn\nobjRange.Copy\n\nSet objWorksheet2 = objWorkbook2.Worksheets(1)\nobjWorksheet.Activate\n\nobjWorksheet.Range(\"A:B\").EntireColumn.Copy objWorksheet2.Paste\nobjWorksheet2.Range (\"A1\")\n\nobjWorksheet.Columns(\"Q\").EntireColumn.Copy objWorksheet2.Paste\nobjWorksheet2.Range (\"C1\")\n\nobjWorkbook2.Save \nobjWorkbook2.Close\n</code></pre>\n\n<p>My doubt is, the column Q contains formula.  So, when column is copied, only formula is copied but not the values.  <strong>Please help to copy the values in the cell but not the formula.</strong></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1526501094, "post_id": 50379087, "comment_id": 87774371, "body": "You will want to step backwards when deleting rows."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526501302, "post_id": 50379087, "comment_id": 87774476, "body": "What is <code>YearA</code>?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526501358, "post_id": 50379087, "comment_id": 87774495, "body": "What you&#39;re trying to do is better accomplished by autofilter."}, {"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526501404, "post_id": 50379087, "comment_id": 87774505, "body": "@JohnyL Sorry Year A is the current year I determine in another part of script I will edit it to 2018 to not confuse."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526501619, "post_id": 50379087, "comment_id": 87774614, "body": "OK. Then, what is <code>Data</code>? Programmatic sheet name?"}, {"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526501688, "post_id": 50379087, "comment_id": 87774645, "body": "@JohnyL yes Data is another sheet I am referencing in the woorkbook"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526502440, "post_id": 50379087, "comment_id": 87775002, "body": "Also that&#39;s going to take a long time with 600k rows. Perhaps try autofilter or arrays."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1526502635, "post_id": 50379087, "comment_id": 87775089, "body": "<code>Integer</code> is stored across 16 bits. One of these bits controls the sign, so the maximum positive value is <code>2^15-1</code>, or 32,767. Anything greater than that needs to be a <code>Long</code>, stored on 32 bits, with a max value of <code>2^31-1</code>."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526502837, "post_id": 50379087, "comment_id": 87775165, "body": "I will add code to perform row removal much faster as a 2nd option in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "edited": false, "score": 0, "creation_date": 1526567975, "post_id": 50379235, "comment_id": 87804204, "body": "I am having an issue with comparing the dates as their format is different one is formatted as 27-JAN-18 and the other is 2017-12-31. Is there a way to convert these dates."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "edited": false, "score": 0, "creation_date": 1526572379, "post_id": 50379235, "comment_id": 87807226, "body": "You can put a break point near date comparison and see how format of compared dates looks like by hovering over. Normally in VBA everything what is date is comparable, because it represents <code>Long</code> value. Problem can arise when VBA does not recognize cell contents as date, but <code>String</code>. In such case depending on actual <code>String</code>, dedicated code should be written to convert it to <code>Date</code>."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 3, "last_activity_date": 1526503521, "last_edit_date": 1526503521, "creation_date": 1526501677, "answer_id": 50379235, "question_id": 50379087, "link": "https://stackoverflow.com/questions/50379087/for-loop-using-dates-compile-error-syntax-error/50379235#50379235", "title": "For loop using dates Compile Error: Syntax Error", "body": "<p>Yuo need to step backwards as @braX stated. Also specified number exceeds <code>Integer</code> variable type capacity. In VBA it is a good practice for ingeter values to always declare variable as <code>Long</code>.</p>\n\n<p>Range \"Data\" is nowhere set. I replaced it with reference to active worksheet.\nVariable YearA is also not specified. I assigned value of 2018 to it. Date function is incorrectly used, you meant to use DateSerial.</p>\n\n<p>Always put <code>Option Explicit</code> on top of the code to catch errors. There were really many here.</p>\n\n<pre><code>Option Explicit\n\nSub removeWrongYear()\n\n    Dim i As Long, yearA as Long\n\n    yearA = 2018\n\n    With ActiveSheet\n        For i = 635475 to 2 Step -1\n            If .Cells(i,20).Value &gt; DateSerial(yearA,12,31) Then .Rows(i).EntireRow.Delete       \n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Here is a fast version, based on arrays, with all rows deleted at once:</p>\n\n<pre><code>Option Explicit\nOption Base 1 'row and column index will match array index\n\nSub removeWrongYear()\n\n    Dim i As Long, yearA As Long, rowsCnt As Long\n    Dim rowsToDelete As Range\n    Dim vData As Variant\n\n    yearA = 2018\n\n    With ActiveSheet\n\n        '1st to 635475 row, 20th column\n        vData = Range(.Cells(1, 20), .Cells(635475, 20))\n\n        For i = UBound(vData) To 2 Step -1\n            If vData(i, 1) &gt; DateSerial(yearA, 12, 31) Then\n                rowsCnt = rowsCnt + 1\n\n                If rowsCnt &gt; 1 Then\n                    Set rowsToDelete = Union(rowsToDelete, .Rows(i))\n                ElseIf rowsCnt = 1 Then\n                    Set rowsToDelete = .Rows(i)\n                End If\n\n            End If\n        Next i\n\n    End With\n\n    If rowsCnt &gt; 0 Then\n        Application.ScreenUpdating = False\n        rowsToDelete.EntireRow.Delete\n        Application.ScreenUpdating = True\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 50379235, "answer_count": 1, "score": 1, "last_activity_date": 1526503521, "creation_date": 1526501052, "last_edit_date": 1526501418, "question_id": 50379087, "link": "https://stackoverflow.com/questions/50379087/for-loop-using-dates-compile-error-syntax-error", "title": "For loop using dates Compile Error: Syntax Error", "body": "<p>I am trying to run a script that will skim through all rows for a certain column. Then it will compare the dates in these columns with a set date. If the dates is larger than it deletes the row. The error I'm getting is called Compile Error: Syntax Error.</p>\n\n<pre><code>Sub removewrongyear()\nDim i As Integer\n\nFor i = 2 To 635475\n If Data.Cells(i,20).Value &gt; DATE(2018,12,31) Then\nRows(i).EntireRow.Delete\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "sum"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526500448, "post_id": 50378892, "comment_id": 87774071, "body": "Are you trying to get the value into a variable?  are you trying to insert the formula in a cell with vba?  there are many question that would be answered if you showed what you tried."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1526500702, "post_id": 50378892, "comment_id": 87774182, "body": "You mean... like <code>yourVariable = 5 + Range(&quot;A5&quot;).Value</code> ?  Or like <code>Range(&quot;A2&quot;).Value = 5 + Range(&quot;A5&quot;).Value</code>... what are you asking here? There is not much correlation between Excel formulas and VBA so the question is sort of nonsensical a bit."}, {"owner": {"reputation": 542, "user_id": 3676361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9170c7d6cc08c4127b6486ae5e932bb?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Lewis", "link": "https://stackoverflow.com/users/3676361/sam-lewis"}, "edited": false, "score": 0, "creation_date": 1526500704, "post_id": 50378892, "comment_id": 87774183, "body": "Trying to insert formula in a cell with vba"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1526500750, "post_id": 50378892, "comment_id": 87774205, "body": "Set a formula for a cell in VBA: <code>Range(&quot;A2&quot;).Formula = &quot;=Sum(5,A1)&quot;</code>"}, {"owner": {"reputation": 542, "user_id": 3676361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9170c7d6cc08c4127b6486ae5e932bb?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Lewis", "link": "https://stackoverflow.com/users/3676361/sam-lewis"}, "edited": false, "score": 0, "creation_date": 1526500851, "post_id": 50378892, "comment_id": 87774248, "body": "JNevill, thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1526670016, "last_edit_date": 1526670016, "creation_date": 1526500730, "answer_id": 50379019, "question_id": 50378892, "link": "https://stackoverflow.com/questions/50378892/sum-function-in-vba-number-and-string/50379019#50379019", "title": "Sum function in VBA (number and string)", "body": "<p>In VBA:</p>\n\n<pre><code>Sub dural()\n    MsgBox Application.WorksheetFunction.Sum(5, Range(\"A1\").Value)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ALOnj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ALOnj.png\" alt=\"enter image description here\"></a></p>\n\n<p>or as JNevill points out:</p>\n\n<pre><code>Sub dural2()\n    MsgBox Evaluate(\"SUM(5,A1)\")\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here are some alternatives:</p>\n\n<pre><code>Sub poiuyt()\n    MsgBox Application.WorksheetFunction.Sum(5, [A1])\n    MsgBox 5 + [A1]\nEnd Sub\n</code></pre>\n\n<p>To put a formula in a cell, say cell <strong>B9</strong>, use:</p>\n\n<pre><code>Sub PutFormulaInCell()\n    Range(\"B9\").Formula = \"=SUM(5,A1)\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 542, "user_id": 3676361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9170c7d6cc08c4127b6486ae5e932bb?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Lewis", "link": "https://stackoverflow.com/users/3676361/sam-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "accepted_answer_id": 50379019, "answer_count": 1, "score": 1, "last_activity_date": 1526670016, "creation_date": 1526500243, "question_id": 50378892, "link": "https://stackoverflow.com/questions/50378892/sum-function-in-vba-number-and-string", "title": "Sum function in VBA (number and string)", "body": "<p>Have a problem with summing cells in vba using =sum(number, string) function.</p>\n\n<p>Here is an example, that is working in regular excel: <strong>sum(5, A1)</strong> </p>\n\n<p>But it doesn't work via VBA formula - asking for a number instead of a string. Is there a way to use <strong>=sum(5, A1)</strong> in VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2276, "user_id": 4925121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3TTcs.jpg?s=128&g=1", "display_name": "d219", "link": "https://stackoverflow.com/users/4925121/d219"}, "edited": false, "score": 0, "creation_date": 1526499424, "post_id": 50378702, "comment_id": 87773614, "body": "Please post your code as text not as a screenshot, cheers."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1526500247, "post_id": 50378702, "comment_id": 87773982, "body": "When you paste your code here AS TEXT highlight it and then click the little <code>{}</code> button (or indent each line with four spaces) to have it formatted as code. Please don&#39;t post pictures of code. And definitely don&#39;t take a picture of your monitor displaying your code and post that."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1526503793, "post_id": 50378702, "comment_id": 87775568, "body": "Moving the active cell is rather slow. You can directly access cells in a worksheet via the <code>Cells</code> collection (e.g. <code>ActiveSheet.Cells(I, 1).Value</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526508355, "creation_date": 1526508355, "answer_id": 50380568, "question_id": 50378702, "link": "https://stackoverflow.com/questions/50378702/the-code-needs-to-shift-through-2000-rows-to-see-if-any-cell-in-the-range-has-y/50380568#50380568", "title": "The code needs to shift through 2000 rows to see if any cell in the range has \u201cY\u201d and if it does to write \u201cY\u201d in the first column", "body": "<p>Does this work for you:</p>\n\n<pre><code>Sub test()\nDim myArray As Variant, i As Long, myRange As Range\nWith Sheets(\"Sheet2\") 'name of your sheet\nSet myRange = .Range(\"BD5:CI2000\")\n    With Application\n    myArray = myRange\n    For i = LBound(myArray) To UBound(myArray)\n    If InStr(1, Join(.Transpose(.Transpose(.Index(myArray, i, 0)))), \"Y\", vbTextCompare) &gt; 0 Then myArray(i, 1) = \"Y\"\n    Next i\n    myRange.Resize(, 1) = .Index(myArray, 0, 1)\nEnd With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9802235, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0aZLSSlbbVs/AAAAAAAAAAI/AAAAAAAAEQY/GXhgUdokWQs/photo.jpg?sz=128", "display_name": "mohit mishra", "link": "https://stackoverflow.com/users/9802235/mohit-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1526508355, "creation_date": 1526499355, "last_edit_date": 1531161705, "question_id": 50378702, "link": "https://stackoverflow.com/questions/50378702/the-code-needs-to-shift-through-2000-rows-to-see-if-any-cell-in-the-range-has-y", "title": "The code needs to shift through 2000 rows to see if any cell in the range has \u201cY\u201d and if it does to write \u201cY\u201d in the first column", "body": "<p>The code needs to shift through 2000 rows to see if any cell in the range has  \"Y\" and if it does to write \"Y\" in the first column</p>\n\n<p>This is the code that I have done that works, but very repetitive for 2000 rows:</p>\n\n<pre><code>Range(\"BD5\").Select\n\nSet rng = Range(\"BD5:CI5\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\nEnd If\n\n'add loop to last cell 2000 times or 1250 times'\n\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSet rng = Range(\"BD6:CI6\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\nEnd If\n\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSet rng = Range(\"BD7:CI7\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\nEnd If\n\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSet rng = Range(\"BD8:CI8\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\nEnd If\n\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSet rng = Range(\"BD9:CI9\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\n...\n</code></pre>\n\n<p>This is the code I tried to do with looping but did not work because I cannot figure out how to loop the range to look at only one row at a time and then move to the next</p>\n\n<pre><code>Range(\"BC5\").Select\n\nDim rng As Range\nDim cell As Range\n\nSet rng = Range(\"BD5:CI5\")\n\nIf Not rng Is Nothing Then\n  For Each cell In rng.Cells\n    If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n  Next cell\nEnd If\n\nFor I = 1 To 100\n  ActiveCell.Offset(1, 0).Range(\"A1\").Select\n  Set Range = rng.Offset(1, 0) 'need to edit this so that the range will go through all rows in the document'\n\n  If Not rng Is Nothing Then\n    For Each cell In rng.Cells\n      If cell.Value = \"Y\" Then ActiveCell.FormulaR1C1 = \"Y\"\n    Next cell\n  End If\nNext I\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "edited": false, "score": 0, "creation_date": 1526503583, "post_id": 50378685, "comment_id": 87775489, "body": "Hi Kenny, I saw your <a href=\"https://stackoverflow.com/questions/50066796/creating-multiple-workbooks-from-one-workbook-vba\">first question</a>, so I&#39;m wondering if you can clarify what you&#39;re trying to do? Generally, when you&#39;re copying from one sheet to another, the order is something like this: 1) Open the source sheet 2) Open the destination sheet (where you&#39;re copying to) 3) Use a Loop to copy information from one sheet to the other 4) Save the destination sheet and optionally close it. Are you just interested in copying from one sheet to the other, or are you trying to do something with each line?"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "edited": false, "score": 0, "creation_date": 1526503679, "post_id": 50378685, "comment_id": 87775534, "body": "thanks for your interest. for the line &quot;Rows(&quot;5:5&quot;).Select&quot; I would like the loop function to move down to the next row. I am taking the info from each line to create a new workbook which then the Save As function will have the values for the save."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "edited": false, "score": 0, "creation_date": 1526504131, "post_id": 50378685, "comment_id": 87775706, "body": "thanks for your interest. for the line &quot;Rows(&quot;5:5&quot;).Select&quot; I would like the loop function to move down to the next row. I am taking the info from each line to create a new workbook which then the Save As function will have the values for the save. After the SaveAs finishes i need it to repeat for the next line. I hope I am explaining this correctly. (I am new to this site, obviously, and ran out of time on the previous comment)"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526568008, "post_id": 50380337, "comment_id": 87804231, "body": "I appreciate your feedback, and I do like the organization."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526568703, "post_id": 50380337, "comment_id": 87804761, "body": "I have a question about the     &quot;Set wkbDest = Workbooks.Open(scWkbDest1Name)&quot; as the error compiler states the workbook is not there when it is. On another note what does the &quot;sc&quot; represent in your though process for all the Constants?"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526573569, "post_id": 50380337, "comment_id": 87807936, "body": "Solved my previous comment by changing &quot;Set wkbDest = Workbooks.Open(scWkbDest1Name)&quot; to &quot;Set wkbDest = Workbooks.Open(scWkbDest1Path &amp; scWkbDest1Name)&quot;  &amp; &quot;Set wksDest = wkbSource.Sheets(&quot;LISTS&quot;)&quot; to &quot;Set wksDest = wkbDest.Sheets(&quot;LISTS&quot;)&quot; now I have the 1st wkbk filled out &amp; saved correct."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526573618, "post_id": 50380337, "comment_id": 87807973, "body": "Next Q, which was my original question on this thread was the Loop function. I see &quot;SourceRow = 5&quot; which seams correct but on the Loop the Error Compiler states a problem on &quot;wksSource.Rows(SourceRow).Copy Destination:=wksDest.Rows(DestRow)&quot;. I notice one of the last lines states &quot;SourceRow = SourceRow + 1&quot; but as the code loops around again source is then reprogramed to &quot;SourceRow = 5&quot;. Is this the problem? I read about the &quot;i&quot; variable, I haven&#39;t used this before &amp; not sure how to implement this."}, {"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "reply_to_user": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526575971, "post_id": 50380337, "comment_id": 87809281, "body": "Ah, I always forget that VBA treats Rows differently than Excel does. Use <code>wksSource.Rows(SourceRow).Cells.Copy</code>. I&#39;m not sure but you may need to use <code>.Cells</code> after <code>wksDest.Rows(DestRow)</code> also.  For <code>SourceRow = 5</code>, the code will only loop back up to the <code>Do While</code> line, so it shouldn&#39;t be resetting it to 5. If you step through the code using F8, the 2nd time thru the loop, if you hover over <code>SourceRow</code> in the <i>Copy</i> line, it should show a value of <code>6</code>."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526580253, "post_id": 50380337, "comment_id": 87811408, "body": "I see &#39;SourceRow = 5&#39; does show a value of 6 on the 2nd Loop when I hover over using F8.. But still as I come down to &#39;wksSource.Rows(SourceRow).Cells.Copy Destination:=wksDest.Rows(DestRow)&#39; I am still compiling an &quot;Run time Error 91&quot;, even if I use &#39;wksSource.Rows(SourceRow).Cells.Copy Destination:=wksDest.Rows(DestRow).Cells&#39;"}, {"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "reply_to_user": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526596258, "post_id": 50380337, "comment_id": 87818553, "body": "I posted updated code in the answer. Don&#39;t have time now, but later will add some explanation and discoveries."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526647359, "post_id": 50380337, "comment_id": 87838522, "body": "Thanks for the update. I figured out why I was running into the error 91 situation and solved like you edited your answer by moving the     set wkbdest    and.     Set wksdest     below the    Do While line. I then ran into the special/unaccepted characters for the save which I manually (advanced searched) found and replaced. Thanks for showing me how to write such code."}, {"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "reply_to_user": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526657438, "post_id": 50380337, "comment_id": 87845133, "body": "Glad you got it figured out. I did clean up the code a little bit more (especially replacing chars in file names and testing for a folder before creating it) and added some commentary about folder and file names. I do have to say, you pick this up quick for someone just starting with VBA!"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1526915952, "post_id": 50380337, "comment_id": 87916774, "body": "Thankyou for all the help. I posted another question i could use your help on  <a href=\"https://stackoverflow.com/questions/50450915/how-can-i-only-copy-visible-cells-from-a-table-using-this-vba\" title=\"how can i only copy visible cells from a table using this vba\">stackoverflow.com/questions/50450915/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "is_accepted": true, "score": 2, "last_activity_date": 1526657232, "last_edit_date": 1526657232, "creation_date": 1526506985, "answer_id": 50380337, "question_id": 50378685, "link": "https://stackoverflow.com/questions/50378685/how-to-move-down-1-row-for-every-loop-until-cell-empty/50380337#50380337", "title": "how to move down 1 row for every loop until cell empty", "body": "<p>I see you're new to VBA, and there are some concepts you're picking up pretty quickly. Recording macros in Excel is a great way to find out how you could do something in Excel. However, there are some drawbacks to the way Excel does it also. Here are a few concepts that will help:</p>\n\n<ol>\n<li><p><strong>Don't</strong> use <em>Selection</em>, <em>ActiveCell</em>, <em>ActiveSheet</em>, <em>Select</em>, <em>Activate</em>, etc. unless you absolutely have to. I know that's what the Macro Recorder in Excel does, but if you don't do it exactly right, it can cause errors, especially when you start working with multiple workbooks! </p>\n\n<p>Much better to assign an <em>object</em>, and use that object to do what you want to do. In the code below, I assigned the <em>Workbooks</em> and <em>worksheets</em> to objects and used those to get stuff done. <em>Ranges</em> are also common objects to use.</p></li>\n<li><p>Related to that, make sure to always <strong>fully qualify your objects</strong>. For example, you can write code like this: <code>Var1 = Cells(1, 1).Value</code> but it will get the value from cell A1 in the <em>Active Worksheet</em>, not necesarily the worksheet or workbook you intended. Much better to write it this way: <code>Var1 = wksSource.Cells(1, 1).Value</code>  I did specify a sheet name \"Sheet1\" for your source workbook - <strong>change it</strong> to the actual name of the sheet you're copying <em>from</em>.</p></li>\n<li><p>I assigned the most common strings to <strong>Constants</strong> at the top. There's a balance between assigning every string to a constant and using only in-line strings (for example, some might assign the sheet names like \"LISTS\" to a constant), but if they're only used once and in a prominent place, I don't worry about assigning a constant for it. But especially when the value is used multiple places, a constant makes it easier for when you want to re-use the code for a similar task. I also put a constant in there for the Source Path, although that's not required if the workbook is already open.</p></li>\n<li><p>I also declared all the variables at the top - some languages and programmers do it differently, but I like to be able to see what's being used at the beginning.</p></li>\n<li><p>Notice the <strong>While</strong> specifier on your <em>Do ... Loop</em>. This will only loop while there is a value in the first column of the current row.</p></li>\n</ol>\n\n<p>Here's how I would write the code for your task:</p>\n\n<pre><code>Sub Macro3()\n\n    Dim SourceRow As Long\n    Dim DestRow As Long\n    Dim Path As String\n    Dim FileName1 As String\n    Dim FileName2 As String\n    Dim FullFileName As String\n\n    Dim wkbSource As Workbook\n    Dim wksSource As Worksheet\n    Dim wkbDest As Workbook\n    Dim wksDest As Worksheet\n    Dim wksDest2 As Worksheet\n\n    Const scWkbSourcePath As String = \"D:\\folder1\\folder2\\Projects\\\"        ' For example\n    Const scWkbSourceName As String = \"theFILE2.working.xlsm\"\n    Const scWkbDest1Path As String = \"D:\\folder1\\folder2\\Projects\\The_FILES\\New_folder\\\"\n    Const scWkbDest1Name As String = \"OVERVIEW TEMPLATE_macro edition_current_.xlsm\"\n    Const scWkbDest2Path As String = \"D:\\folder1\\folder2\\Projects\\The_FILES\\theFILES\\\"\n\n    Set wkbSource = Workbooks(scWkbSourceName)\n    Set wksSource = wkbSource.Sheets(\"Sheet1\")      ' Replace Sheet1 with the sheet name\n    SourceRow = 5\n    DestRow = 4\n\nDo While wksSource.Cells(SourceRow, 1).Value &lt;&gt; \"\"\n    ' Open the template workbook\n    Set wkbDest = Workbooks.Open(scWkbSourcePath &amp; scWkbDest1Name)\n    Set wksDest = wkbDest.Sheets(\"LISTS\")\n\n''COPY A ROW\n    wksSource.Rows(SourceRow).Copy Destination:=wksDest.Rows(DestRow)\n    Application.CutCopyMode = False\n    With wksDest.Rows(DestRow).Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n    wkbDest.Activate\n    Set wksDest2 = wkbDest.Sheets(\"PLANT OVERVIEW\")\n\n''SAVE AS\n    FileName1 = Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace( _\n        Replace(wksDest2.Range(\"N1\").Value _\n        , \".\", \"_\") _\n        , \"/\", \"_\") _\n        , \"\\\", \"_\") _\n        , \"?\", \"_\") _\n        , \"|\", \"_\") _\n        , \"&lt;\", \"_\") _\n        , \"&gt;\", \"_\") _\n        , \":\", \"_\") _\n        , \"*\", \"_\") _\n        , \"\"\"\", \"_\")\n    FileName2 = wksDest2.Range(\"A1\").Value\n\n    Path = scWkbDest2Path &amp; FileName1 &amp; \"\\\"\n    If Len(Dir(Path, vbDirectory)) = 0 Then\n        MkDir Path\n    End If\n    FullFileName = Path &amp; FileName2 &amp; \".xlsx\"\n    wkbDest.SaveAs Filename:=FullFileName, FileFormat:=xlOpenXMLWorkbook\n    wkbDest.Close\n\n    ' Best practice to set objects to Nothing before re-using an object variable\n    Set wksDest = Nothing\n    Set wksDest2 = Nothing\n    Set wkbDest = Nothing\n\n    ' Move down 1 row for source sheet\n    SourceRow = SourceRow + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<h3>Edit</h3>\n\n<p>Some notes and things I learned regarding Folder and File name characters:</p>\n\n<ul>\n<li>Although parentheses <em>can</em> be used in filenames, I wasn't able to get your original filename to save - but removing the parentheses solved the problem. </li>\n<li>Since you're creating file and folder names from (potentially dirty) data, you should clean up (remove or replace with <strong>_</strong>) the characters that can't be used in those names: <strong>\\</strong> <strong>/</strong> <strong>|</strong> <strong>?</strong> <strong>&lt;</strong> <strong>></strong> <strong>:</strong> <strong>*</strong> <strong>\"</strong></li>\n<li>I found this on a Microsoft page for <a href=\"https://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx\" rel=\"nofollow noreferrer\">Naming Files, Paths, and Namespaces</a>: </li>\n</ul>\n\n<blockquote>\n  <p>Do not end a file or directory name with a space or a period.</p>\n</blockquote>\n\n<ul>\n<li><p>Although it is allowed inside a file name, a full stop (<strong>.</strong>) cannot be the last char of a folder name, which is generally where you find it in a text string. Besides, it can be confusing and occasionally cause problems <em>within</em> a file name, so I'd recommend replacing them all.</p>\n\n<ul>\n<li>The Trim() function can be used to remove spaces <em>at the end of a folder name</em>. Be aware that within the string, it also changes multiple spaces in a row to a single space.</li>\n</ul></li>\n<li><p>Especially since you're creating folders from data, you need to make sure the folder exists before saving a file to it. <strong>MkDir</strong> is the command for this.</p></li>\n<li>If your template workbook isn't open when you start, you may need to specify the path as well in the Open() statement.</li>\n</ul>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4220, "favorite_count": 0, "accepted_answer_id": 50380337, "answer_count": 1, "score": 1, "last_activity_date": 1526657232, "creation_date": 1526499275, "last_edit_date": 1531164843, "question_id": 50378685, "link": "https://stackoverflow.com/questions/50378685/how-to-move-down-1-row-for-every-loop-until-cell-empty", "title": "how to move down 1 row for every loop until cell empty", "body": "<p>How do I move down 1 row for every loop until cell empty in column A?</p>\n\n<p>I need to start on Row 5 copy to another workbook then loop to the next row (Row6) until contents are empty. </p>\n\n<p>Here is my code</p>\n\n<pre><code>    Sub Macro3()\n'''\nDo\n\n''GRAB A ROW\n    Windows(\"theFILE2.working.xlsm\").Activate\n    Rows(\"5:5\").Select\n    Selection.Copy\n    Workbooks.Open \"D:\\folder1\\folder2\\Projects\\The FILES\\New folder\\OVERVIEW TEMPLATE(macro edition)(current).xlsm\"\n    Windows(\"OVERVIEW TEMPLATE(macro edition)(current).xlsm\").Activate\n    Sheets(\"LISTS\").Select\n    Rows(\"4:4\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Windows(\"OVERVIEW TEMPLATE(macro edition)(current).xlsm\").Activate\n    Sheets(\"PLANT OVERVIEW\").Select\n\n''SAVE AS\n    Dim Path As String\n    Dim FileName1 As String\n    Dim FileName2 As String\n\n\n    FileName1 = Range(\"N1\").Value\n    FileName2 = Range(\"A1\").Value\n\n    Path = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\"\n\n    ActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n\n    ActiveWorkbook.Close\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Thankyou in advanced!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1526503888, "post_id": 50378620, "comment_id": 87775599, "body": "From a quick look it doesn&#39;t seem possible. Why do you want to store it in the <code>Variables</code> collection? Maybe share your code to give us an idea of what you want to do."}, {"owner": {"reputation": 25, "user_id": 9801561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83817d1de1cf8a1e97d3cf2d0a203730?s=128&d=identicon&r=PG", "display_name": "zimileih", "link": "https://stackoverflow.com/users/9801561/zimileih"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1526504264, "post_id": 50378620, "comment_id": 87775773, "body": "@BigBen I am trying to make a macro that uses the same variable for each document when multiple documents are open and holds different values. An example would be if I wanted to store maybe like the top ten words in a document in an array with multiple documents open. Each need their own unique items stored in the same variable. Currently, my program is just using the same values regardless of the current active document. I am unsure how to differentiate the documents."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1526504615, "post_id": 50378620, "comment_id": 87775936, "body": "Please share the code you&#39;ve tried, along with the specific error you&#39;re getting."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1526576643, "post_id": 50378620, "comment_id": 87809614, "body": "&lt;&lt;Currently, my program is just using the same values regardless of the current active document. I am unsure how to differentiate the documents.&gt;&gt; Possible approaches include using an array of a user-defined data <code>Type</code> objects, or defining a Class whose objects are held in an array or a Collection."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1526576187, "creation_date": 1526576187, "answer_id": 50396813, "question_id": 50378620, "link": "https://stackoverflow.com/questions/50378620/storing-an-array-as-an-activedocument-variable/50396813#50396813", "title": "Storing an array as an ActiveDocument Variable", "body": "<p>A Document <code>Variable</code> can store only a string. A Document <code>Variable</code> is not a variable in the programming sense of the term. It's a storage space in the document structure - thus, it can only store a string of characters.</p>\n\n<p>You could store the information as a character-delimited string in the document <code>Variable</code>. The Split and Join functions can turn such a string into an array or, respectively, turn an array into such a string. So conversion back-and-forth would be relatively simple.</p>\n"}], "owner": {"reputation": 25, "user_id": 9801561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83817d1de1cf8a1e97d3cf2d0a203730?s=128&d=identicon&r=PG", "display_name": "zimileih", "link": "https://stackoverflow.com/users/9801561/zimileih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 50396813, "answer_count": 1, "score": -1, "last_activity_date": 1526576187, "creation_date": 1526498966, "last_edit_date": 1526499361, "question_id": 50378620, "link": "https://stackoverflow.com/questions/50378620/storing-an-array-as-an-activedocument-variable", "title": "Storing an array as an ActiveDocument Variable", "body": "<p>I am currently making a macro for MS Office Word 2007. The macro requires use of variables that I want to store in the ActiveDocument.Variables list. I want to store and use arrays from this list, but I am encountering problems. Is there a way to store arrays as an active document variable?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "class", "properties", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1526498366, "post_id": 50378441, "comment_id": 87773092, "body": "Please share the class code, at least the relevant part showing declarations and definitions."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1526526407, "post_id": 50378441, "comment_id": 87781176, "body": "I added the codes, I noticed I had a typo in my declaration of variables, Maybe that&#39;s the issue. I will inform."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1526526974, "post_id": 50378441, "comment_id": 87781294, "body": "Yep,................  That was a TYPO in my declaration. I added S instead of $ as of String variable type!!!  You can mention that So I will accept that as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1526651410, "post_id": 50412781, "comment_id": 87841195, "body": "Yes, thanks I already got that, you can see my comment in above post."}], "tags": [], "owner": {"reputation": 38, "user_id": 9811989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca223ff4334a1c738fb07adf06fe693?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Reza", "link": "https://stackoverflow.com/users/9811989/ali-reza"}, "is_accepted": true, "score": 2, "last_activity_date": 1526651225, "creation_date": 1526651225, "answer_id": 50412781, "question_id": 50378441, "link": "https://stackoverflow.com/questions/50378441/vba-class-module-get-property-from-an-object-inside-the-class/50412781#50412781", "title": "VBA class module: get property from an object inside the class", "body": "<p>I think you have a Typo on the second line: \nI think and as per my test, you can refer to the me.property, property itself without the prefix, and also by the class variable you specified. You also can try them as well. </p>\n\n<pre><code>Public WithEvents img1 As MSForms.Image\nPrivate Acn$ ' As String if you meant!\nDim rng1 As Range, rng2 As Range, rng3 As Range\n\n' Property Definitions\n\nPublic Property Get Aircraft() As String\n    Aircraft = Acn\nEnd Property\nPublic Property Let Aircraft(Value As String)\n    Acn = Value\nEnd Property\n\n' Events Procedures\n\nPrivate Sub img1_Click()  ' Showing Progress Form\n    With ThisWorkbook.Sheets(\"Performance\")\n        Set rng1 = .Range(\"ProgCrit\")\n        Set rng2 = .Range(\"Progress\")\n        Set rng3 = .Range(\"op_log\")\n    End With\n    frmprogress.LAc = Me.Aircraft \n    rng1.Cells(2, 1) = Me.Aircraft \n    rng3.AdvancedFilter xlFilterCopy, rng1, rng2\n    oprecord.Calculate\n    frmprogress.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 1, "accepted_answer_id": 50412781, "answer_count": 1, "score": 1, "last_activity_date": 1526651225, "creation_date": 1526498132, "last_edit_date": 1531164843, "question_id": 50378441, "link": "https://stackoverflow.com/questions/50378441/vba-class-module-get-property-from-an-object-inside-the-class", "title": "VBA class module: get property from an object inside the class", "body": "<p>I have a class module containing some properties and control elements. How can I get property value of those controls in class level events? I tried </p>\n\n<pre><code>me.property \n</code></pre>\n\n<p>or  </p>\n\n<pre><code>control.parent.property \n</code></pre>\n\n<p>but not worked. I think there should be a way to address properties of each instance of the class module inside the module, is't it? </p>\n\n<p>My Class Module: Cworker</p>\n\n<pre><code>Public WithEvents img1 As MSForms.Image\nPrivate AcnS\nDim rng1 As Range, rng2 As Range, rng3 As Range\n\n' Property Definitions\n\nPublic Property Get Aircraft() As String\n    Aircraft = Acn\nEnd Property\nPublic Property Let Aircraft(Value As String)\n    Acn = Value\nEnd Property\n\n' Events Procedures\n\nPrivate Sub img1_Click()  ' Showing Progress Form\n    With ThisWorkbook.Sheets(\"Performance\")\n        Set rng1 = .Range(\"ProgCrit\")\n        Set rng2 = .Range(\"Progress\")\n        Set rng3 = .Range(\"op_log\")\n    End With\n    frmprogress.LAc = Me.Aircraft \n    rng1.Cells(2, 1) = Me.Aircraft \n    rng3.AdvancedFilter xlFilterCopy, rng1, rng2\n    oprecord.Calculate\n    frmprogress.Show\nEnd Sub\n</code></pre>\n\n<p>Tahnks, \nM</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526498503, "post_id": 50378171, "comment_id": 87773160, "body": "simple variable declaration error. see answer. I doubt it just stopped working - probably a copy/paste error???"}], "answers": [{"comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1526497985, "post_id": 50378307, "comment_id": 87772923, "body": "I was actually surprised that VBE allows to <code>Dim</code> anything as <code>Workbooks</code>. <code>VarType(wb)</code> returns 9 -&gt; Object in both cases. I see that it can be done with collection of any specific objects."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 5, "creation_date": 1526498421, "post_id": 50378307, "comment_id": 87773123, "body": "@RyszardJ\u0119draszyk <code>Workbooks</code> is a class. How surprising is it that you can put that type in a <code>Dim</code> statement&#39;s <code>As</code> clause?"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1526497609, "creation_date": 1526497609, "answer_id": 50378307, "question_id": 50378171, "link": "https://stackoverflow.com/questions/50378171/excel-vba-type-mismatch-while-opening-workbook/50378307#50378307", "title": "Excel VBA: Type mismatch while opening workbook?", "body": "<p>Variable defined incorrectly</p>\n\n<p>Change </p>\n\n<pre><code>Dim wb As Workbooks\n</code></pre>\n\n<p>To singular</p>\n\n<pre><code>Dim wb As Workbook\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "closed_date": 1526866805, "answer_count": 1, "score": 2, "last_activity_date": 1594634783, "creation_date": 1526497031, "last_edit_date": 1594634783, "question_id": 50378171, "link": "https://stackoverflow.com/questions/50378171/excel-vba-type-mismatch-while-opening-workbook", "closed_reason": "Not suitable for this site", "title": "Excel VBA: Type mismatch while opening workbook?", "body": "<p>I don't it sounds stupid but it was working before.  And I don't know why it suddenly stopped working.  I tried to exit <strong>Excel</strong> and re-run the code.  Same problem regardless what <strong>workbook</strong> I tried to open.  The code is as below:</p>\n\n<pre><code>Sub Check()\n\nDim myFile As Variant\nDim wb As Workbooks\n\nmyFile = Application.GetOpenFilename(Title:=\"Please Choose the Info File\")\n\nIf myFile = False Then\n    End\nEnd If\n\nSet wb = Workbooks.Open(myFile) '&lt;-- Getting \"Run-time error '13': Type mismatch\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1526496810, "post_id": 50378052, "comment_id": 87772354, "body": "Use: <code>Dim arr</code>   <code>arr = dict(&quot;a&quot;): arr(0) = 5</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526497419, "post_id": 50378052, "comment_id": 87772652, "body": "Also: <code>For Each item In arr</code>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526497558, "post_id": 50378052, "comment_id": 87772715, "body": "@JohnyL That doesn&#39;t really help. I need to get to the array via the dictionary."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526497601, "post_id": 50378052, "comment_id": 87772732, "body": "<code>arr = dict(&quot;a&quot;)</code> isn&#39;t array <i>via</i> dictionary?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526497778, "post_id": 50378052, "comment_id": 87772832, "body": "@JohnyL This is an MVCE. The actual code should iterates over all the keys in the dictionary, extract the final array values for each key, and do something with those values. I can&#39;t really store each array in a separate variable..."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1526498375, "post_id": 50378052, "comment_id": 87773097, "body": "@ZevSpitz If I understand your question correctly  I think you&#39;re trying to find some equivalence to &quot;C&quot; and referencing variables by their memory location - ie by setting the value of one variable it will automatically set the value of another one that you&#39;ve deemed to be equal. In short, that&#39;s not possible in VBA - at least as simply as you&#39;re trying to do."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526499523, "post_id": 50378052, "comment_id": 87773672, "body": "@dbmitch It seems a nested dictionary works just fine (see my updated answer). Nested arrays also work fine (per <a href=\"https://stackoverflow.com/a/50378332/111794\">this answer</a>). Why is it that an array within a dictionary has the problem?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526499982, "post_id": 50378052, "comment_id": 87773881, "body": "Your setting the value of the dictionary. You&#39;re NOT setting the <code>value</code> of the array item. You cannot set the dictionary item to a <code>reference to the array</code> - you can set an array value then set the dictionary to the array item - but that is using the <code>value</code> not the <code>reference</code>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526553559, "post_id": 50378052, "comment_id": 87794181, "body": "@dbmitch I&#39;m still not following. There appears to be some difference between <code>Dim arr As Variant: arr = Array(1): arr(0) = 5</code> which works, and <code>Dim dict As New Dictionary: dict(0) = Array(1): dict(0)(0) = 5</code> which doesn&#39;t work. What is the precise difference between the two?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526553946, "post_id": 50378052, "comment_id": 87794412, "body": "@dbmitch In other words, what is happening differently when the array is stored in the variable, vs when the array is stored as a dictionary entry?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526565796, "post_id": 50378052, "comment_id": 87802618, "body": "There is no difference - you are not storing the array in either case - you are assigning the contents of that array. In the second case you are just changing the contents of the dictionary again - it doesn&#39;t work in reverse."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526589281, "post_id": 50378052, "comment_id": 87816079, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/171272/discussion-between-zev-spitz-and-dbmitch\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526589450, "post_id": 50378052, "comment_id": 87816142, "body": "I&#39;m not sure why?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526589512, "post_id": 50378052, "comment_id": 87816169, "body": "@dbmitch Because I am still not following, and if you could take the time to try to elaborate, I would greatly appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1526497715, "creation_date": 1526497715, "answer_id": 50378332, "question_id": 50378052, "link": "https://stackoverflow.com/questions/50378052/modifying-array-within-dictionary-is-ignored/50378332#50378332", "title": "Modifying array within Dictionary is ignored", "body": "<p>Here is working example with dictionary:</p>\n\n<pre><code>Sub Test()\n\n    Dim dict As New Scripting.Dictionary, item As Variant\n    dict(\"a\") = Array(1)\n    Dim arr\n    arr = dict(\"a\")\n    arr(0) = 5\n    dict(\"a\") = arr\n    For Each item In dict(\"a\")\n        Debug.Print item\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>And also take a look at nested arrays:</p>\n\n<pre><code>Sub TestArrays()\n\n    Dim a() As Variant, item As Variant\n    a = Array(\"\")\n    a(0) = Array(1)\n    a(0)(0) = 5\n    For Each item In a(0)\n        Debug.Print item\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1526509572, "post_id": 50378957, "comment_id": 87777720, "body": "Comments are intended to be temporary. I suggest you include useful information in your answer itself."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1526509648, "post_id": 50378957, "comment_id": 87777736, "body": "Also, a far simpler example would be to assign an array to two variables, change an element in one variable, and show that the elements in the other variable haven&#39;t changed."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1526512203, "post_id": 50378957, "comment_id": 87778450, "body": "I think the point was made using your example and @omegastripes example. It does sound like you got the drift though."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1526512117, "last_edit_date": 1526512117, "creation_date": 1526500486, "answer_id": 50378957, "question_id": 50378052, "link": "https://stackoverflow.com/questions/50378052/modifying-array-within-dictionary-is-ignored/50378957#50378957", "title": "Modifying array within Dictionary is ignored", "body": "<p>Just to clarify your questions with an example expanding on @omegastripes answer and my comments on referencing variables in VBA</p>\n\n<blockquote>\n  <p><strong>COMMENTS:</strong> You're setting the value of the dictionary. You're NOT setting the value of the array item. You cannot set the dictionary\n  item to a reference to the array - you can set an array value then set\n  the dictionary to the array item - but that is using the value not the\n  reference</p>\n</blockquote>\n\n<p>Here's an example to show that VBA does not store a reference to the variable when you assign it to another variable</p>\n\n<pre><code>Sub Test()\n\n    Dim dict As Object, item As Variant\n\n    Dim arr\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    dict(\"a\") = Array(1)\n\n    arr = dict(\"a\")\n    arr(0) = 5\n    dict(\"a\") = arr\n    For Each item In dict(\"a\")\n        Debug.Print item\n        ' Prints 5\n    Next\n\n    ' Change array contents\n    arr(0) = 10\n    For Each item In dict(\"a\")\n        Debug.Print item\n        ' Still Prints 5\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Results in Immediate Window will be:</p>\n\n<pre><code>5\n5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1526553788, "creation_date": 1526553788, "answer_id": 50389484, "question_id": 50378052, "link": "https://stackoverflow.com/questions/50378052/modifying-array-within-dictionary-is-ignored/50389484#50389484", "title": "Modifying array within Dictionary is ignored", "body": "<p>I can use nested dictionaries instead of an array within a dictionary:</p>\n\n<pre><code>Dim dict As New Scripting.Dictionary, item As Variant\nSet dict(\"a\") = New Dictionary\ndict(\"a\")(0) = 5\nFor Each key In dict(\"a\")\n    Debug.Print dict(\"a\")(key)\nNext\n</code></pre>\n"}], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526565317, "creation_date": 1526496478, "last_edit_date": 1526565317, "question_id": 50378052, "link": "https://stackoverflow.com/questions/50378052/modifying-array-within-dictionary-is-ignored", "title": "Modifying array within Dictionary is ignored", "body": "<p>The following code:</p>\n\n<pre><code>Dim arr As Variant, item As Variant\narr = Array(1)\narr(0) = 5\nFor Each item In arr\n    Debug.Print item\nNext\n</code></pre>\n\n<p>prints <code>5</code>; it seems to successfully modify the contents of the array.</p>\n\n<p>However, if I create a <code>Dictionary</code>, and place an array at one of the dictionary keys:</p>\n\n<pre><code>Dim dict As New Scripting.Dictionary, item As Variant\ndict(\"a\") = Array(1)\ndict(\"a\")(0) = 5\nFor Each item In dict(\"a\")\n    Debug.Print item\nNext\n</code></pre>\n\n<p>the array is read-only; the edit is ignored, and the code prints <code>1</code> -- the original value.</p>\n\n<p><strong>Why can I modify the elements of an array referenced through a variable, but not those of an array referenced through a call to Dictionary.Item; and how can I resolve this?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1526496581, "post_id": 50377812, "comment_id": 87772244, "body": "I don&#39;t think you meant to include the <code>.Row</code> in <code>.Row.PasteSpecial</code> when you paste H16 to the pasteSheet."}, {"owner": {"reputation": 1, "user_id": 9801994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1U5NxJriro/AAAAAAAAAAI/AAAAAAAAAKw/KELCmuBNoGY/photo.jpg?sz=128", "display_name": "Gilbert Maserati", "link": "https://stackoverflow.com/users/9801994/gilbert-maserati"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1526497696, "post_id": 50377812, "comment_id": 87772779, "body": "Yeah, I was experimenting and that did not help. lol"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9801994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1U5NxJriro/AAAAAAAAAAI/AAAAAAAAAKw/KELCmuBNoGY/photo.jpg?sz=128", "display_name": "Gilbert Maserati", "link": "https://stackoverflow.com/users/9801994/gilbert-maserati"}, "edited": false, "score": 0, "creation_date": 1526576453, "post_id": 50378425, "comment_id": 87809536, "body": "Thank you. I like your coding and I think it will work once I wrap my head around the rows part."}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "reply_to_user": {"reputation": 1, "user_id": 9801994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1U5NxJriro/AAAAAAAAAAI/AAAAAAAAAKw/KELCmuBNoGY/photo.jpg?sz=128", "display_name": "Gilbert Maserati", "link": "https://stackoverflow.com/users/9801994/gilbert-maserati"}, "edited": false, "score": 0, "creation_date": 1526582719, "post_id": 50378425, "comment_id": 87812749, "body": "You need to make your db table into a table object if you haven&#39;t already done so. To do so, select any of the cells in the table and type CTRL + L. This will turn it from normal spreadsheet to a table."}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "reply_to_user": {"reputation": 1, "user_id": 9801994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1U5NxJriro/AAAAAAAAAAI/AAAAAAAAAKw/KELCmuBNoGY/photo.jpg?sz=128", "display_name": "Gilbert Maserati", "link": "https://stackoverflow.com/users/9801994/gilbert-maserati"}, "edited": false, "score": 0, "creation_date": 1526582900, "post_id": 50378425, "comment_id": 87812857, "body": "When you do <code>tbl.ListRows.Add</code>, it adds a row to the end of the table and stores the row as a variable <code>row</code>."}], "tags": [], "owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "is_accepted": false, "score": 0, "last_activity_date": 1526501098, "last_edit_date": 1526501098, "creation_date": 1526498072, "answer_id": 50378425, "question_id": 50377812, "link": "https://stackoverflow.com/questions/50377812/copy-cell-values-and-pasting-to-another-worksheet-in-a-list-table/50378425#50378425", "title": "Copy cell values and pasting to another worksheet in a list/table", "body": "<p>I feel like your code is more complicated than it needs to be. I have created some new code for you that is a lot easier. You will need to put in the actual values but I think I made it simple enough to follow.</p>\n\n<pre><code>Sub logInformation()\n    'GET VALUES\n    Dim fName As String\n    Dim lName As String\n    Dim age As String\n    Dim gender As String\n\n    fName = Sheet1.Range(\"B2\")\n    lName = Sheet1.Range(\"C2\")\n    age = Sheet1.Range(\"B3\")\n    gender = Sheet1.Range(\"B4\")\n\n    'INSERT VALUES\n    Dim tbl As ListObject\n    Set tbl = Sheet2.ListObjects(\"Table1\")\n\n    Dim row As ListRow\n    Set row = tbl.ListRows.Add\n    With row\n        .Range(1) = fName\n        .Range(2) = lName\n        .Range(3) = age\n        .Range(4) = gender\n    End With\n\n    'CLEAR FORM\n    Sheet1.Range(\"B2\").Clear\n    Sheet1.Range(\"C2\").Clear\n    Sheet1.Range(\"B3\").Clear\n    Sheet1.Range(\"B4\").Clear\nEnd Sub\n</code></pre>\n\n<p>-- OR --</p>\n\n<p>You could also loop it and make it a lot easier</p>\n\n<pre><code>Sub logInformation()\n    Dim tbl As ListObject\n    Set tbl = Sheet2.ListObjects(\"Table1\")\n\n    Dim row As ListRow\n    Set row = tbl.ListRows.Add\n\n    Dim arr As Variant\n    arr = Array(\"C2\", \"D2\", \"C3\", \"C4\", \"C5\", \"C6\", \"C7\", \"C8\", \"E8\", \"C11\", \"C12\", \"C13\", \"C14\", \"C15\", \"C16\", \"H16\")\n\n    For i = LBound(arr) To UBound(arr)\n        row.Range(i + 1) = Sheet1.Range(arr(i)).value\n        Sheet1.Range(arr(i)).Clear\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1526498118, "creation_date": 1526498118, "answer_id": 50378438, "question_id": 50377812, "link": "https://stackoverflow.com/questions/50377812/copy-cell-values-and-pasting-to-another-worksheet-in-a-list-table/50378438#50378438", "title": "Copy cell values and pasting to another worksheet in a list/table", "body": "<p>A general suggestion would be to set the output range. It's a little unclear which column is \"J\" in your code above. It looks like your paste for that \"H16\" copy command is referencing <strong>Row.PasteSpecial</strong> which is likely the cause of your error:</p>\n\n<pre><code>copySheet.Range(\"H16\").Copy\npasteSheet.Cells(Rows.Count, 10).End(xlUp).Offset(1, 0).Row.PasteSpecial\n</code></pre>\n\n<p>I've looped the copying/pasting in your code above. This may be a little easier to manipulate and debug. </p>\n\n<pre><code>dim copyRngs as Variant, copyRng as Range, outRng as Range\ncopyRngs = Array(\"C2:D2\",\"C3\",\"C4\",\"C5\",\"C6\",\"C7\",\"C8\",\"E8\",\"C11:C16\",\"H16\")\nset outRng = pasteSheet.Range(\"A1\")\nFor i = lbound(copyRngs) to ubound(copyRngs)\n    application.screenupdating = False\n    Set copyRng = copySheet.Range(copyRngs(i))\n    copyRng.Copy\n    outRng.Resize(copyRng.Cells.Count).Offset(copyRng.Row,End(xlUp)).PasteSpecial xlPasteValues\n    copyRng.ClearContents\n    application.screenupdating = True\n    application.cutcopymode = false\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9801994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1U5NxJriro/AAAAAAAAAAI/AAAAAAAAAKw/KELCmuBNoGY/photo.jpg?sz=128", "display_name": "Gilbert Maserati", "link": "https://stackoverflow.com/users/9801994/gilbert-maserati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526501098, "creation_date": 1526495472, "last_edit_date": 1526495649, "question_id": 50377812, "link": "https://stackoverflow.com/questions/50377812/copy-cell-values-and-pasting-to-another-worksheet-in-a-list-table", "title": "Copy cell values and pasting to another worksheet in a list/table", "body": "<p>I am new to Excel VBA and was recently tasked with creating a macro that copys from one worksheet containing drop-down lists and formulas to another \"output\" sheet that keeps these in a nice list(table) for reference. </p>\n\n<p>My code was designed to do a simple copy from sheet1 and pastevalue to sheet2 and set up to search for the last cell containing data in a row and then offset it to paste below into an empty cell. This works for most of what I am trying to do but I am running into an issue where one part of the code is not pasting properly in row \"J\".</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub TestCopyToDB()\n\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"PIT Training Request Form\")\nSet pasteSheet = Worksheets(\"Output\")\n\n\ncopySheet.Range(\"C2:D2\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\ncopySheet.Range(\"C3\").Copy\npasteSheet.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\ncopySheet.Range(\"C4\").Copy\npasteSheet.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\ncopySheet.Range(\"C5\").Copy\npasteSheet.Cells(Rows.Count, 4).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\ncopySheet.Range(\"C6\").Copy\npasteSheet.Cells(Rows.Count, 5).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\ncopySheet.Range(\"C7\").Copy\npasteSheet.Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\ncopySheet.Range(\"C8\").Copy\npasteSheet.Cells(Rows.Count, 7).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\ncopySheet.Range(\"E8\").Copy\npasteSheet.Cells(Rows.Count, 8).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\ncopySheet.Range(\"C11:D11\").Copy\npasteSheet.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\ncopySheet.Range(\"H16\").Copy\npasteSheet.Cells(Rows.Count, 10).End(xlUp).Offset(1, 0).Row.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=xlCopy, Transpose:=False\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\n\n\n\nSheets(\"PIT Training Request Form\").Range(\"C3\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C4\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C5\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C6\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C7\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C8\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"C11:D11\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"E8\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"D9\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"D10\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"D14\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"D15\").ClearContents\nSheets(\"PIT Training Request Form\").Range(\"D16\").ClearContents\n\n   End With\nSheets(\"PIT Training Request Form\").Select\nMsgBox \"Submission Complete.\", vbInformation\n\nEnd Sub\n</code></pre>\n\n<p>The last copy and paste line from H16 will paste but it is not finding the empty cells below and is overwriting information above it. I am not sure why. </p>\n\n<p>Any and all help is appreciated. </p>\n\n<p>Thank you,</p>\n"}, {"tags": ["excel", "siebel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1536, "user_id": 2145381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0330794bf663cce3e4f00cf96036950?s=128&d=identicon&r=PG", "display_name": "Ranjith R", "link": "https://stackoverflow.com/users/2145381/ranjith-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1526522677, "creation_date": 1526522677, "answer_id": 50382324, "question_id": 50377787, "link": "https://stackoverflow.com/questions/50377787/siebel-compile-using-vba-macros/50382324#50382324", "title": "siebel compile using vba macros?", "body": "<p>I can help you with this.</p>\n\n<p><strong>NO.</strong></p>\n\n<p>You can double check with Oracle support.</p>\n"}, {"tags": [], "owner": {"reputation": 6256, "user_id": 6152737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33da1278c7af36224a140b18695ade6d?s=128&d=identicon&r=PG&f=1", "display_name": "A. Kootstra", "link": "https://stackoverflow.com/users/6152737/a-kootstra"}, "is_accepted": false, "score": 0, "last_activity_date": 1530302479, "creation_date": 1530302479, "answer_id": 51108657, "question_id": 50377787, "link": "https://stackoverflow.com/questions/50377787/siebel-compile-using-vba-macros/51108657#51108657", "title": "siebel compile using vba macros?", "body": "<p>As @Ranjith already mentioned, there is no supported API to compile an SRF. This applies to both the VBA COM and the Java Bean.</p>\n\n<p>Even if you managed to find an undocumented way of compiling the SRF using VBA, it would be unsupported by Oracle. Any issue you have afterwards they will request you reproduce your issue with a standard compile. So, I'd also recommend not investing in this route. </p>\n\n<p>For arguments sake I'll assume that there is a supported way for a moment. Even then I'd argue that Excel is the worst way to automate a compile and deployment of a SRF. It's a client application, it can't - or is difficult - to run on a command line and doesn't interface with proper Continuous Integration tools like Jenkins, Travis CI, Bamboo and <a href=\"https://xebialabs.com/periodic-table-of-devops-tools/\" rel=\"nofollow noreferrer\">the lot</a>. </p>\n\n<p>Building a CI/CD pipeline for Siebel from scratch is complex. Take your time to research the matter. Have a look at the commercial party support and if you do want to develop your own, find a good DevOps engineer and couple him with a strong Siebel Engineer with deployment experience. </p>\n"}, {"tags": [], "owner": {"reputation": 227, "user_id": 6583249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GGML7xlVzaU/AAAAAAAAAAI/AAAAAAAAACM/2Nu3OjL8WEc/photo.jpg?sz=128", "display_name": "reartnew", "link": "https://stackoverflow.com/users/6583249/reartnew"}, "is_accepted": false, "score": 0, "last_activity_date": 1543149484, "creation_date": 1543149484, "answer_id": 53467517, "question_id": 50377787, "link": "https://stackoverflow.com/questions/50377787/siebel-compile-using-vba-macros/53467517#53467517", "title": "siebel compile using vba macros?", "body": "<p>As all previous commentators mentioned, this is a challenge, but still possible.\nMatter the fact you can use scripting on the <strong>Siebel Tools Object Compiler</strong> service, which is triggered via <strong>siebdev.exe</strong> batch compile call. Messing around <em>RepositoryName</em> input parameter can give you the way to pass Excel file name into the service.\nIncremental compilation could be performed, following these complex steps on the PreInvokeMethod hook:</p>\n\n<ul>\n<li>Open a transaction, using <strong>EAI Transaction Service</strong> (may require some ddl libraries from the Windows Siebel Server distribution)</li>\n<li>Create a new project (e.g. \"__my_incremental_compilation__\")</li>\n<li>Find the desired repository objects and move them to your project</li>\n<li>Pass project name to the <strong>ProjectsList</strong> parameter of the service's Inputs property set</li>\n<li>Continue service call (wait for the end of the compilation)</li>\n<li>Rollback the transaction</li>\n</ul>\n\n<p>This worked well for me, when I got stuck with the same question.</p>\n\n<p>Hope it helps you!</p>\n"}], "owner": {"reputation": 13, "user_id": 9801979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8c757cdbfacb2605243612eea268cd?s=128&d=identicon&r=PG&f=1", "display_name": "alok kumar", "link": "https://stackoverflow.com/users/9801979/alok-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1543149484, "creation_date": 1526495364, "last_edit_date": 1531164843, "question_id": 50377787, "link": "https://stackoverflow.com/questions/50377787/siebel-compile-using-vba-macros", "title": "siebel compile using vba macros?", "body": "<p>We got one assignment to compile selected siebel objects using VBA macros.\nWhen i say selected it means list of objects will be available in one excel sheet.</p>\n\n<p>is it possible to compile automatically in VBA?</p>\n\n<p>any help will be appreciated. Thanks in advance.</p>\n"}, {"tags": ["html", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 9285327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51763097dc105f9bb48ca08e2e0a26cd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobayashi", "link": "https://stackoverflow.com/users/9285327/kobayashi"}, "edited": false, "score": 0, "creation_date": 1526496335, "post_id": 50377870, "comment_id": 87772129, "body": "It solved that problem! I really spelled wrong. Now it seems to be running, I can see Excel open and close very quickly, but when I open the file, it&#39;s blank."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1526495740, "creation_date": 1526495740, "answer_id": 50377870, "question_id": 50377762, "link": "https://stackoverflow.com/questions/50377762/automatically-export-html-table-from-outlook-to-excel-w-vba/50377870#50377870", "title": "Automatically export HTML Table from Outlook to Excel w/ VBA", "body": "<p>Change that line to this instead</p>\n\n<pre><code>For i = 0 To olEleColl(0).Rows.Length - 1\n</code></pre>\n\n<p>(You spelled <code>Length</code> wrong)</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 9285327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51763097dc105f9bb48ca08e2e0a26cd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobayashi", "link": "https://stackoverflow.com/users/9285327/kobayashi"}, "is_accepted": true, "score": 0, "last_activity_date": 1526677931, "last_edit_date": 1526677931, "creation_date": 1526506100, "answer_id": 50380149, "question_id": 50377762, "link": "https://stackoverflow.com/questions/50377762/automatically-export-html-table-from-outlook-to-excel-w-vba/50380149#50380149", "title": "Automatically export HTML Table from Outlook to Excel w/ VBA", "body": "<p>I've found out that it wasn't working because the first table found didn't have any text in <strong>innerText</strong>, so I tested a macro that gets all the tables and it worked!</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Public Sub SalvaExcel(item As Outlook.MailItem)\n\n'This macro writes an Outlook email's tables to an Excel workbook\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nDim olFolder As Outlook.Folder\nDim olItems As Outlook.Items\nDim olNameSpace As Outlook.NameSpace\n\nDim olHTML As MSHTML.HTMLDocument: Set olHTML = New MSHTML.HTMLDocument\nDim olEleColl As MSHTML.IHTMLElementCollection\n\nDim xlApp As Excel.Application\nDim ExcelWkBk As Excel.Workbook\n\n\nDim FileName As String\nDim eRow As Long\nDim i As Long\nDim j As Long\nDim t\nDim posicao As String\n\n\n'set email to be saved\n'Set olApp = Outlook.Application\n'Set olNameSpace = Application.GetNamespace(\"MAPI\")\n'Set olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\n'Set olItems = olFolder.Items\n'olItems.Sort (\"[ReceivedTime]\")\n\n'the most recent one\n'Set olMail = olItems(olItems.Count)\n\n\n'save Outlook email's html body (tables)\nWith olHTML\n    .Body.innerHTML = item.HtmlBody\n    Set olEleColl = .getElementsByTagName(\"table\")\nEnd With\n\n\n'set excel file to be opened\nFileName = \"C:\\Users\\rafael.kobayashi\\Desktop\\projeto_licitacoes\\Palavras-Chave.xlsm\"\n\n'create an Excel instance\nSet xlApp = Application.CreateObject(\"Excel.Application\")\n\n'in this instance\nWith xlApp\n\n    .Visible = True     'if True, this slows down the macro, but helps during debugging\n    .ScreenUpdating = False     'if False, this reduces flash and increases speed\n\n    'open workbook\n    Set ExcelWkBk = xlApp.Workbooks.Open(FileName)\n\n    'in this workbook\n    With ExcelWkBk\n\n        'in [email] worksheet\n        With .Worksheets(\"email\")\n\n            'which row to start\n            eRow = 1\n            posicao = \"A\" &amp; eRow\n\n\n            'write each table in excel\n            For Each t In olEleColl\n\n                For i = 0 To t.Rows.Length - 1\n                    For j = 0 To t.Rows(i).Cells.Length - 1\n\n                        'ignore any problems with merged cells etc\n                        On Error Resume Next\n                        .Range(posicao).Offset(i, j).Value = t.Rows(i).Cells(j).innerText\n                        On Error GoTo 0\n\n                    Next j\n                Next i\n                'define from which row the next table will be written\n                eRow = eRow + t.Rows.Length + 1\n                posicao = \"A\" &amp; eRow\n            Next t\n\n\n\n        End With\n\n        'close Workbook and save changes\n        .Close SaveChanges:=True\n\n    End With\n\n    'quit excel\n    .Quit\n\nEnd With\n\nSet xlApp = Nothing\nSet ExcelWkBk = Nothing\n'Set olMail = Nothing\nSet olHTML = Nothing\nSet olEleColl = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>It exports all the tables from the last received email in the Outlook Inbox to an Excel file. It skips 1 row between one table and the next. Since it gets the most recent email and it runs from Outlook, it's useful to use in a New Rule, so it will be automatic, according to a defined criteria. I hope it helps other people!</p>\n\n<p>edit: in order to run this macro in an Outlook Rule, it's necessary to give the following argument to the Sub, otherwise the macro won't be shown in the list of macros to be chosen for the Rule:</p>\n\n<pre><code>Public Sub SalvaExcel(item As Outlook.MailItem)\n</code></pre>\n\n<p>I have updated the code in this answer.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 7682577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98944827184eb73d2922ef5d69f1139?s=128&d=identicon&r=PG&f=1", "display_name": "Gagan", "link": "https://stackoverflow.com/users/7682577/gagan"}, "is_accepted": false, "score": -1, "last_activity_date": 1606483087, "creation_date": 1606483087, "answer_id": 65038047, "question_id": 50377762, "link": "https://stackoverflow.com/questions/50377762/automatically-export-html-table-from-outlook-to-excel-w-vba/65038047#65038047", "title": "Automatically export HTML Table from Outlook to Excel w/ VBA", "body": "<p>Thanks for sharing the code.</p>\n<p>Have rectified your code to make it finally work ;)</p>\n<pre><code>Public Sub SalvaExcel()\n'Public Sub SalvaExcel(item As Outlook.MailItem)\n'This macro writes an Outlook email's tables to an Excel workbook\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nDim olFoldersDefault As Outlook.Folders\nDim olFolder As Outlook.Folder\nDim olItems As Outlook.Items\nDim olNameSpace As Outlook.NameSpace\n\nDim olHTML As MSHTML.HTMLDocument: Set olHTML = New MSHTML.HTMLDocument\nDim olEleColl As MSHTML.IHTMLElementCollection\n\nDim xlApp As Excel.Application\nDim ExcelWkBk As Excel.Workbook\n\nDim FileName As String\nDim eRow As Long\nDim i As Long\nDim j As Long\nDim t\nDim posicao As String\n\n\n'set email to be saved\n'Set olApp = Outlook.Application\n'Set olNameSpace = Application.GetNamespace(&quot;MAPI&quot;)\n'Set olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\n'Set olItems = olFolder.Items\n'olItems.Sort (&quot;[ReceivedTime]&quot;)\n\n'Set olApp = Outlook.Application\nSet olNameSpace = Application.GetNamespace(&quot;MAPI&quot;)\nSet newFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\nSet olFolder = newFolder.Folders(&quot;Projects&quot;).Folders(&quot;Management&quot;).Folders(&quot;Notifications&quot;)\n\nSet olItems = olFolder.Items\nolItems.Sort (&quot;[ReceivedTime]&quot;)\n\n'the most recent one\nSet olMail = olItems(olItems.Count)\n\n'MsgBox olMail\n'MsgBox olMail.HTMLBody\n\n'save Outlook email's html body (tables)\nWith olHTML\n    .Body.innerHTML = olMail.HTMLBody\n    Set olEleColl = .getElementsByTagName(&quot;table&quot;)\nEnd With\n\n\n'set excel file to be opened\nFileName = &quot;D:\\OutlookEmails.xlsm&quot;\n\n'create an Excel instance\nSet xlApp = Application.CreateObject(&quot;Excel.Application&quot;)\n\n'in this instance\nWith xlApp\n\n    .Visible = True     'if True, this slows down the macro, but helps during debugging\n    .ScreenUpdating = False     'if False, this reduces flash and increases speed\n\n    'open workbook\n    Set ExcelWkBk = xlApp.Workbooks.Open(FileName)\n\n    'in this workbook\n    With ExcelWkBk\n\n        'in [email] worksheet\n        With .Worksheets(&quot;emails&quot;)\n\n            'which row to start\n            eRow = 1\n            posicao = &quot;A&quot; &amp; eRow\n\n\n            'write each table in excel\n            For Each t In olEleColl\n\n                For i = 0 To t.Rows.Length - 1\n                    For j = 0 To t.Rows(i).Cells.Length - 1\n\n                        'ignore any problems with merged cells etc\n                        On Error Resume Next\n                        .Range(posicao).Offset(i, j).Value = t.Rows(i).Cells(j).innerText\n                        On Error GoTo 0\n\n                    Next j\n                Next i\n                'define from which row the next table will be written\n                eRow = eRow + t.Rows.Length + 1\n                posicao = &quot;A&quot; &amp; eRow\n            Next t\n\n\n\n        End With\n\n        'close Workbook and save changes\n        .Close SaveChanges:=True\n\n    End With\n\n    'quit excel\n    .Quit\n\nEnd With\n\nSet xlApp = Nothing\nSet ExcelWkBk = Nothing\n'Set olMail = Nothing\nSet olHTML = Nothing\nSet olEleColl = Nothing\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9285327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51763097dc105f9bb48ca08e2e0a26cd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobayashi", "link": "https://stackoverflow.com/users/9285327/kobayashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4346, "favorite_count": 1, "accepted_answer_id": 50380149, "answer_count": 3, "score": 0, "last_activity_date": 1606483087, "creation_date": 1526495256, "last_edit_date": 1526505683, "question_id": 50377762, "link": "https://stackoverflow.com/questions/50377762/automatically-export-html-table-from-outlook-to-excel-w-vba", "title": "Automatically export HTML Table from Outlook to Excel w/ VBA", "body": "<p>I'd like to export an email that contains many tables in HTML format.\nEach table is something like this:</p>\n\n<pre><code>&lt;table class=\"MsoNormalTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"width:100.0%;background:green\"&gt;...&lt;/table&gt;\n</code></pre>\n\n<p>I've added a New Rule in Outlook, so everytime I receive an email with 'specific word' in the Subject, the macro runs and saves all the tables from this email to a .xlsm file. The rule itself seems to work fine, but i'm having issues to make the macro work.</p>\n\n<p>I've found many topics about exporting data from Outlook to Excel and I managed to copy email's TextBody using split (in rows), but it only worked with text, not with tables.</p>\n\n<p>So I started searching the web for topics about exporting Tables, and I did find one. Although, it talks about importing Tables from Outlook using Excel VBA, not exactly what i'm trying to do. I tried to edit this code in order to work when running from Outlook, but it didn't work.</p>\n\n<p>References:<br>\n<a href=\"https://i.stack.imgur.com/eFGn0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eFGn0.jpg\" alt=\"references\"></a> </p>\n\n<p>Here's the code:</p>\n\n<pre><code>Option Explicit\nPublic Sub SalvaExcel()\n\n'This macro writes an Outlook email's body to an Excel workbook\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nDim olFolder As Outlook.Folder\nDim olItems As Outlook.Items\nDim olNameSpace As Outlook.NameSpace\n\nDim olHTML As MSHTML.HTMLDocument: Set olHTML = New MSHTML.HTMLDocument\nDim olEleColl As MSHTML.IHTMLElementCollection\n\nDim xlApp As Excel.Application\nDim ExcelWkBk As Excel.Workbook\n\n\nDim FileName As String\n'Dim TextBody As String\n'Dim iArr() As String\nDim eRow As Integer\nDim xlUp As Integer\nDim i As Long\nDim j As Long\nxlUp = -4162\n\n'set email to be saved\nSet olApp = Outlook.Application\nSet olNameSpace = Application.GetNamespace(\"MAPI\")\nSet olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\nSet olItems = olFolder.Items\n'olItems.Sort (\"[ReceivedTime]\")\nSet olMail = olItems(olItems.Count)\n\n'save Outlook email's html body (tables)\nWith olHTML\n    .Body.innerHTML = olMail.HtmlBody\n    Set olEleColl = .getElementsByTagName(\"table\")\nEnd With\n\n\n\n'set excel file to be opened\nFileName = \"C:\\Users\\rafael.kobayashi\\Desktop\\projeto_licitacoes\\Palavras-Chave.xlsm\"\n\n'create an Excel instance\nSet xlApp = Application.CreateObject(\"Excel.Application\")\n\n'in this instance\nWith xlApp\n\n    .Visible = True     'this slows down the macro, but helps during debugging\n    .ScreenUpdating = False     'reduces flash and increases speed\n\n    'open workbook\n    Set ExcelWkBk = xlApp.Workbooks.Open(FileName)\n\n    'in this workbook\n    With ExcelWkBk\n\n        'in [email] worksheet\n        With .Worksheets(\"email\")\n\n            'find first empty row\n            'eRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n\n            'write table in excel\n            Debug.Print olEleColl(0)\n            For i = 0 To olEleColl(0).Rows.Length - 1 \n                For j = 0 To olEleColl(0).Rows(i).Cells.Length - 1\n\n                    .Range(\"A1\").Offset(i, j).Value = olEleColl(0).Rows(i).Cells(j).innerText\n\n                Next j\n            Next i\n\n\n            'resize columns (DO NOT)\n            '.Columns(\"B:C\").AutoFit\n\n        End With\n\n        'close Workbook and save changes\n        .Close SaveChanges:=True\n\n    End With\n\n    'quit excel\n    .Quit\n\nEnd With\n\nSet xlApp = Nothing\nSet ExcelWkBk = Nothing\nSet olMail = Nothing\nSet olHTML = Nothing\nSet olEleColl = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: There was a typo in the code, now it seems to be running, I can see that Excel opens then closes very quickly when I run the macro. However, when I open the workbook, the sheet where the tables were supposed to be is blank :(  </p>\n\n<p>EDIT2: I have tested the macro in an mail item where i inserted a random table and it worked, but it won't work with the tables in the mail that i showed.</p>\n\n<p>EDIT3: I've found out that it wasn't working because the first table found didn't have any text in <strong>innerText</strong>, so I tested a macro that gets all the tables and it worked!</p>\n"}, {"tags": ["vba", "excel", "web-scraping", "timeout", "internet-explorer-11"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1526496744, "post_id": 50377756, "comment_id": 87772322, "body": "Btw, It is required to add <code>Microsoft Internet Controls</code> and <code>Microsoft HTML Object Library</code> to the reference library before executing the above script."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1526498235, "post_id": 50378198, "comment_id": 87773035, "body": "Thanks Mistella for your epic solution. It is just perfect. Plus 1 in advance. One simple thing to know: <code>Dim dTime as what??</code> Gonna accept it soon. Thanks again."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1526498416, "post_id": 50378198, "comment_id": 87773120, "body": "I&#39;ve edited to include. It&#39;s possible there&#39;s a better option than <code>Double</code>, but that&#39;s what I&#39;ve always seen it as, in other code samples."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1526498665, "post_id": 50378198, "comment_id": 87773247, "body": "Solution accepted. I wish I could hit the upvote button several times."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1526499703, "post_id": 50378198, "comment_id": 87773753, "body": "@Topto caveat: don&#39;t run this code in the minute before midnight in your system&#39;s set time zone; <code>Timer - dTime</code> will start going negative in that edge case, since the <code>Timer</code> functions returns the number of seconds since midnight. FWIW <code>Timer</code> is <code>VBA.DateTime.Timer</code>, and returns a <code>Single</code>. Other code samples&#39; authors didn&#39;t bother looking up the function in the object browser ;-)"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1526501302, "post_id": 50378198, "comment_id": 87774475, "body": "@MathieuGuindon Thanks, I edited my answer to make <code>dTime</code> a single. Learn something new everyday :)"}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 3, "last_activity_date": 1526501251, "last_edit_date": 1526501251, "creation_date": 1526497135, "answer_id": 50378198, "question_id": 50377756, "link": "https://stackoverflow.com/questions/50377756/unable-to-set-timeout-option-within-my-scraper-to-save-it-from-infinite-looping/50378198#50378198", "title": "Unable to set timeout option within my scraper to save it from infinite looping", "body": "<p>Try replacing:</p>\n\n<pre><code>    With HTML\n        Do     ''Wish to set timeout options within this loop to save it from infinite looping\n            Set post = .getElementById(\"thesearchbox\")\n            DoEvents\n        Loop While post Is Nothing\n\n        post.innerText = \"Udemy\"\n\n        .getElementById(\"thesearchbutton\").Click\n    End With\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Dim dTime as Single ' as pointed out by @Mathieu Guindon in comments\n'____________________________\n\ndTime = Timer\n\nWith HTML\n    Do     ''Wish to set timeout options within this loop to save it from infinite looping\n        Set post = .getElementById(\"thesearchbox\")\n        If Timer - dTime &gt; 60 Then Exit Do ' 60: num of seconds, equal 1 min\n        DoEvents\n    Loop While post Is Nothing\n\n    post.innerText = \"Udemy\"\n\n    .getElementById(\"thesearchbutton\").Click\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 1, "accepted_answer_id": 50378198, "answer_count": 1, "score": 2, "last_activity_date": 1526501251, "creation_date": 1526495242, "last_edit_date": 1526496225, "question_id": 50377756, "link": "https://stackoverflow.com/questions/50377756/unable-to-set-timeout-option-within-my-scraper-to-save-it-from-infinite-looping", "title": "Unable to set timeout option within my scraper to save it from infinite looping", "body": "<p>I've written a script in vba using IE to initiate a search in a webpage in it's searchbox to populate the result according to the search by hitting the search button. The webpage loads it's <code>searchbox</code> few seconds later it is made to open. However, my below script can handle this barrier and perform the search in the right way.</p>\n\n<p>Now, I've got a slightly different question which is: suppose I've defined a wrong <code>ID</code> name or There is no such <code>ID</code> in that webpage then the way I've written my script will loop forever. This is certainly a serious issue.</p>\n\n<p>How can I modify my script putting some <code>timeout</code> option within the loop so that the scraper will wait sometime for the element to appear and if the element is not present within that time then it will break out of the loop and quit the browser. Thanks in advance.</p>\n\n<p>Here is my script:</p>\n\n<pre><code>Sub GetItems()\n    Dim HTML As HTMLDocument, post As Object\n\n    With New InternetExplorer\n        .Visible = True\n        .navigate \"https://torrentz2.eu/\"\n        While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n        Set HTML = .Document\n\n        With HTML\n            Do     ''Wish to set timeout options within this loop to save it from infinite looping\n                Set post = .getElementById(\"thesearchbox\")\n                DoEvents\n            Loop While post Is Nothing\n\n            post.innerText = \"Udemy\"\n\n            .getElementById(\"thesearchbutton\").Click\n        End With\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526498814, "post_id": 50377588, "comment_id": 87773331, "body": "Good idea including the source data. What does your successful copy look like for the first branch code? You want one workbook for each unique branch code?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526501028, "post_id": 50377588, "comment_id": 87774340, "body": "As I asked &quot;What does your successful copy look like for the first branch code&quot; You can probably create the code to open the template, correct? And you already know how to use SaveAs correct?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526512454, "post_id": 50377588, "comment_id": 87778514, "body": "You show your source data. Show an image of your output workbook and what it should look like. Reading code that kind of does what you want it too isn&#39;t helpful for us envisioning what you actually want it to look like - and edit your question - don&#39;t add pertinent stuff to comments"}, {"owner": {"reputation": 1, "user_id": 9801897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sfbind2", "link": "https://stackoverflow.com/users/9801897/sfbind2"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526564249, "post_id": 50377588, "comment_id": 87801513, "body": "OK sorry, I am obviously a rookie to posting things here...I have edited my question and hopefully that helps address the issues. Thanks!"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526565448, "post_id": 50377588, "comment_id": 87802368, "body": "That helps - now where&#39;s the code  to open the template . In place of <code>Sheets.Add.Name = Left(a(p, 1), 25)</code> use the Open template and SaveAs code - then PasteSpecial - I only see copy in your original code not paste"}, {"owner": {"reputation": 1, "user_id": 9801897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sfbind2", "link": "https://stackoverflow.com/users/9801897/sfbind2"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1526566150, "post_id": 50377588, "comment_id": 87802825, "body": "So that&#39;s why I am struggling with this...I haven&#39;t used this method before, but the person who I originally got this from is using &quot;resize&quot; as a paste function. Because this is written in such a foreign way to me (my code is simplistic and clunky), I am struggling to edit it for my needs."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526567783, "post_id": 50377588, "comment_id": 87804071, "body": "Okay - I don&#39;t know if I can look at it today but thanks for updating the question. Someone else might help in the meantime"}], "owner": {"reputation": 1, "user_id": 9801897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sfbind2", "link": "https://stackoverflow.com/users/9801897/sfbind2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526566341, "creation_date": 1526494612, "last_edit_date": 1531164843, "question_id": 50377588, "link": "https://stackoverflow.com/questions/50377588/use-macro-to-copypaste-based-on-changes-in-values-to-new-workbook", "title": "Use Macro to copy&amp;paste based on changes in values to new workbook", "body": "<p>So first here is what my source data looks like:\n<a href=\"https://i.stack.imgur.com/6lqGZ.png\" rel=\"nofollow noreferrer\">SampleData</a> </p>\n\n<p>Final output:\n<a href=\"https://i.stack.imgur.com/wn7do.png\" rel=\"nofollow noreferrer\">Output for \"AAM, PCM\"</a></p>\n\n<p>For each branch code in column A, I want to copy and past those cells (not entire row) into another workbook and then save that workbook as the branch code name. <strong>This code below works perfectly for copying and pasting into new sheets within the same workbook but I can't seem to modify it to suit my needs. They use \"resize\" as a pasting method, which I am unfamiliar with</strong></p>\n\n<pre><code>Sub columntosheets()\n\nConst sname As String = \"Sheet1\" 'change to whatever starting sheet\nConst s As String = \"A\" 'change to whatever criterion column\n\nDim d As Object, a, cc&amp;\nDim p&amp;, i&amp;, rws&amp;, cls&amp;\nSet d = CreateObject(\"scripting.dictionary\")\nWith Sheets(sname)\n    rws = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n    cls = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n    cc = .Columns(s).Column\nEnd With\nFor Each sh In Worksheets\n    d(sh.Name) = 1\nNext sh\n\nApplication.ScreenUpdating = False\nWith Sheets.Add(after:=Sheets(sname))\nSheets(sname).Cells(1).Resize(rws, cls).Copy .Cells(1)\n.Cells(1).Resize(rws, cls).Sort .Cells(cc), 2, Header:=xlYes\na = .Cells(cc).Resize(rws + 1, 1)\np = 2\nFor i = 2 To rws + 1\n    If a(i, 1) &lt;&gt; a(p, 1) Then\n        If d(a(p, 1)) &lt;&gt; 1 Then\n            Sheets.Add.Name = Left(a(p, 1), 25)\n            .Cells(1).Resize(, cls).Copy Cells(1)\n            .Cells(p, 1).Resize(i - p, cls).Copy Cells(2, 1)\n        End If\n        p = i\n    End If\nNext i\nApplication.DisplayAlerts = False\n    .Delete\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd With\nSheets(sname).Activate\n\nEnd Sub\n</code></pre>\n\n<p>I have tried a few other methods and can't seem to get anything to work. Any help would be appreciated!</p>\n\n<p>Previous Code I have used to generate workbooks using a list of branch names and the SaveAs function</p>\n\n<pre><code>For Each cell In MyRange \n    cell.Copy ws1.Range(\"I2\").PasteSpecial ActiveWorkbook.SaveAs \n    Filename:=\"C:\\Users\\34389\\Documents\\test\" &amp; Range(\"I2\").Value \nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9648115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58cd7194f719ff8b0c9700cb9866a2b2?s=128&d=identicon&r=PG&f=1", "display_name": "John de Haan", "link": "https://stackoverflow.com/users/9648115/john-de-haan"}, "is_accepted": true, "score": 0, "last_activity_date": 1526496263, "creation_date": 1526496263, "answer_id": 50378011, "question_id": 50377410, "link": "https://stackoverflow.com/questions/50377410/copy-cells-which-contain-data-from-tick-boxes-and-drop-downs/50378011#50378011", "title": "Copy Cells Which Contain Data From Tick Boxes and Drop Downs", "body": "<p>My first answer on Stack Overflow. I'm sure there's a more efficient way to do it, but this seems to work at least.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim lastrow As Long, erow As Long\n    'to check the last filled row on sheet named one\n    lastrow = Worksheets(\"one\").Cells(Rows.Count, 2).End(xlUp).Row\n    For i = 2 To lastrow\n    If Worksheets(\"one\").Cells(i, 4).Value = True Then\n        Worksheets(\"one\").Cells(i, 2).Copy\n        erow = Worksheets(\"two\").Cells(Rows.Count, 1).End(xlUp).Row\n        Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 1)\n        Worksheets(\"one\").Cells(i, 5).Copy\n        Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 2)\n    ElseIf Worksheets(\"one\").Cells(i, 3).Value &gt;= 1 And Worksheets(\"one\").Cells(i, 3).Value &lt;= 6 Then\n        Worksheets(\"one\").Cells(i, 2).Copy\n        erow = Worksheets(\"two\").Cells(Rows.Count, 1).End(xlUp).Row\n        Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 1)\n        Worksheets(\"one\").Cells(i, 5).Copy\n        Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 2)\n    End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9784150, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215851517030158/picture?type=large", "display_name": "Prezza", "link": "https://stackoverflow.com/users/9784150/prezza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50378011, "answer_count": 1, "score": 0, "last_activity_date": 1526496263, "creation_date": 1526493910, "last_edit_date": 1526495058, "question_id": 50377410, "link": "https://stackoverflow.com/questions/50377410/copy-cells-which-contain-data-from-tick-boxes-and-drop-downs", "title": "Copy Cells Which Contain Data From Tick Boxes and Drop Downs", "body": "<p>I have a spreadsheet with working VBA to copy certain cells to another worksheet when a condition is met.</p>\n\n<p>Currently I have tick boxes (in column C) which are linked to a cell to the right of it (column D) so when the cell reads TRUE the code copies the name and the cost associated with it. I also have a reset button which empties any checked tick boxes and therefore changes all the cells in column D (please see attached image) to FALSE.</p>\n\n<p><img src=\"https://i.stack.imgur.com/lmWe8.png\" alt=\"Spreadsheet\"></p>\n\n<p>The problem is this; I have added some additional names which requires the user to state the number associated with it so the tick box in these instances have been replaced with a drop down with options from 0 to 6, however the reset button still causes the cell next to the drop downs to read as FALSE.</p>\n\n<p>My question therefore is, how do I amend the code (please see below) to copy the name and the cost where the tick boxes state TRUE (in column D) and the drop downs state a number other than 0 (in column C)?</p>\n\n<pre><code>[Private Sub CommandButton1_Click()\nDim lastrow As Long, erow As Long\n'to check the last filled row on sheet named one\nlastrow = Worksheets(\"one\").Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 2 To lastrow\nIf Worksheets(\"one\").Cells(i, 4).Value = \"TRUE\" Then\n    Worksheets(\"one\").Cells(i, 2).Copy\n    erow = Worksheets(\"two\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 1)\n    Worksheets(\"one\").Cells(i, 5).Copy\n    Worksheets(\"one\").Paste Destination:=Worksheets(\"two\").Cells(erow + 1, 2)\nEnd If\nNext i\nEnd Sub][1]\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1526494386, "post_id": 50377513, "comment_id": 87771210, "body": "In the recorder&#39;s defense, it uses <code>Select</code> and <code>Activate</code> specifically because it&#39;s <i>recording</i> user actions, because that&#39;s its very nature =)"}, {"owner": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "edited": false, "score": 0, "creation_date": 1526499050, "post_id": 50377513, "comment_id": 87773441, "body": "Scott, Many thanks for helping me. I have copied and pasted exactly what you have put (replacing my If to End If statement above) and when I run it I get  Run-time error &#39;9&#39; Subscript out of range I&#39;m not sure what that means?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "edited": false, "score": 0, "creation_date": 1526499327, "post_id": 50377513, "comment_id": 87773568, "body": "On which line?  @Dar"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "edited": false, "score": 0, "creation_date": 1526499363, "post_id": 50377513, "comment_id": 87773583, "body": "@Dar make sure the sheet names are spelled correctly, I may have a typo there."}, {"owner": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "edited": false, "score": 0, "creation_date": 1526501821, "post_id": 50377513, "comment_id": 87774695, "body": "Sorry to bother but is there a way to make &quot;for i = 4 to the last row with data in (BUILDING) column D&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "edited": false, "score": 0, "creation_date": 1526503755, "post_id": 50377513, "comment_id": 87775559, "body": "That is a new question but before you ask check out this question and answers: <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\" title=\"error in finding last used cell in vba\">stackoverflow.com/questions/11169445/&hellip;</a> .  Try using that to find the last row and if you get stuck come back and ask a new question. @Dar"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1526494323, "creation_date": 1526494323, "answer_id": 50377513, "question_id": 50377390, "link": "https://stackoverflow.com/questions/50377390/vba-excel-loop-novice-user/50377513#50377513", "title": "VBA Excel Loop - novice user", "body": "<ol>\n<li><p>The recorder is a great tool to learn how to write specific things in vba.  It is bad in that it uses <code>Select</code> and <code>Activate</code> which are slow.</p></li>\n<li><p>When only values are wanted just assign the value directly.</p></li>\n<li><p>You loop with <code>For</code>, <code>For Each</code>, <code>Do</code>, ... there are others google can teach you.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>Dim i as Long\nfor i = 4 to 104\n    IF worksheets(\"CALCULATOR\").Cells(i,\"B\").Value = \"\" then _\n        worksheets(\"CALCULATOR\").Cells(i,\"B\").Value = Worksheets(\"BUILDING\").cells(i,\"D\").value\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 238, "user_id": 9757930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEVLxGzjnsE/AAAAAAAAAAI/AAAAAAAADnU/vRuIvzLpAJU/photo.jpg?sz=128", "display_name": "mer_curius", "link": "https://stackoverflow.com/users/9757930/mer-curius"}, "is_accepted": false, "score": 0, "last_activity_date": 1526496133, "creation_date": 1526496133, "answer_id": 50377970, "question_id": 50377390, "link": "https://stackoverflow.com/questions/50377390/vba-excel-loop-novice-user/50377970#50377970", "title": "VBA Excel Loop - novice user", "body": "<p>To build on Scott's answer, you could set a \"range object\" to a cell in your target worksheet, and offset the position of the pasted cell one click each time you loop.  That gives you a little more flexibility:</p>\n\n<pre><code>dim i as long, r as range\n\nset r = worksheets(\"CALCULATOR\").range(\"B1\")\n\nfor i = 0 to 99\n    if worksheets(\"BUILDING\").cells(i + 4, \"B\") &lt;&gt; \"\" then\n        r.offset(i, 0) = worksheets(\"BUILDING\").cells(i + 4, \"D\")\n    end if\n\nnext i\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9801858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b75ea11560b99d1114deb449146d4a?s=128&d=identicon&r=PG&f=1", "display_name": "Dar", "link": "https://stackoverflow.com/users/9801858/dar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50377513, "answer_count": 2, "score": 1, "last_activity_date": 1526496133, "creation_date": 1526493839, "last_edit_date": 1526493856, "question_id": 50377390, "link": "https://stackoverflow.com/questions/50377390/vba-excel-loop-novice-user", "title": "VBA Excel Loop - novice user", "body": "<p>I am a novice at VBA but I am hoping an expert can help me with what I am trying to do.</p>\n\n<p>Essentially using Record Macro and my basic grasp of VBA I have created the below; what I am trying to do is change the B4,D4 to B5,D5 B6,D6 etc... for 100 loops.</p>\n\n<p>I am completely stuck and was hoping that someone could point me in the right direction.</p>\n\n<p>Many many thanks.</p>\n\n<p>Dar</p>\n\n<pre><code>If Sheets(\"BUILDING\").Range(\"B4\").Value = \"\" Then\n\nElse\n\nSheets(\"CALCULATOR\").Select\n\nRange(\"B1\").ClearContents\n\nSheets(\"BUILDING\").Select\n\nRange(\"D4\").Select\n\nSelection.Copy\n\nSheets(\"CALCULATOR\").Select\n\nRange(\"B1\").Select\n\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nApplication.Run \"Test1\"\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 2, "creation_date": 1526493486, "post_id": 50377165, "comment_id": 87770742, "body": "This is Excel all over the place, not Access, right?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1526496219, "post_id": 50377165, "comment_id": 87772070, "body": "@ThomasG definitely. Edited."}, {"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1526560129, "post_id": 50377165, "comment_id": 87798460, "body": "No, it&#39;s Access writing an Excel file"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1526560243, "post_id": 50378463, "comment_id": 87798539, "body": "Yes, &#39;A1:B1&#39; are merged and &#39;D1:L1&#39;.  I changed the range to &#39;&quot;A3:A&quot;&amp;LastColumn&#39;, but this also fails in the same manner."}], "tags": [], "owner": {"reputation": 238, "user_id": 9757930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEVLxGzjnsE/AAAAAAAAAAI/AAAAAAAADnU/vRuIvzLpAJU/photo.jpg?sz=128", "display_name": "mer_curius", "link": "https://stackoverflow.com/users/9757930/mer-curius"}, "is_accepted": true, "score": 1, "last_activity_date": 1526498221, "creation_date": 1526498221, "answer_id": 50378463, "question_id": 50377165, "link": "https://stackoverflow.com/questions/50377165/setting-formatconditions-doesnt-work-with-certain-ranges/50378463#50378463", "title": "Setting formatconditions doesn&#39;t work with certain ranges?", "body": "<p>Is there a merged cell range in A:D?</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1526574671, "creation_date": 1526574671, "answer_id": 50396406, "question_id": 50377165, "link": "https://stackoverflow.com/questions/50377165/setting-formatconditions-doesnt-work-with-certain-ranges/50396406#50396406", "title": "Setting formatconditions doesn&#39;t work with certain ranges?", "body": "<p>I believe @mer_curius hit on the issue - merged cells.</p>\n\n<p>So, as a work around, since I only want A:A to have the coloring and I need to set the condition to A:E, I follow that rule with setting a rule with the same criteria and no-fill B:E.</p>\n\n<p>The code that works looks like this:</p>\n\n<pre><code>        i = 1\n        StrSearchCriteria = \"=($W1=\" &amp; Chr(34) &amp; \"ETF\" &amp; Chr(34) &amp; \")\"\n        strRange = \"A:E\"\n        With .Range(strRange).FormatConditions\n            .Add Type:=2, Formula1:=StrSearchCriteria\n            With .Item(i)\n                .SetFirstPriority\n                With .Interior\n                    .PatternColorIndex = xlAutomatic\n                    .Color = RGB(225, 225, 0)\n                End With\n                .StopIfTrue = False\n            End With\n        End With\n        i = i + 1\n        StrSearchCriteria = \"=($W1=\" &amp; Chr(34) &amp; \"ETF\" &amp; Chr(34) &amp; \")\"\n        strRange = \"B:E\"\n        With .Range(strRange).FormatConditions\n            .Add Type:=2, Formula1:=StrSearchCriteria\n            With .Item(i)\n                .SetFirstPriority\n                With .Interior\n                    .Pattern = xlNone\n                End With\n                .StopIfTrue = False\n            End With\n        End With\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50378463, "answer_count": 2, "score": 1, "last_activity_date": 1526574671, "creation_date": 1526492929, "last_edit_date": 1526496203, "question_id": 50377165, "link": "https://stackoverflow.com/questions/50377165/setting-formatconditions-doesnt-work-with-certain-ranges", "title": "Setting formatconditions doesn&#39;t work with certain ranges?", "body": "<p>I have the following code:</p>\n\n<pre><code>        i = i + 1\n        StrSearchCriteria = \"=($W1=\" &amp; Chr(34) &amp; \"ETF\" &amp; Chr(34) &amp; \")\"\n        With .Range(\"A:A\").FormatConditions\n            .Add Type:=2, Formula1:=StrSearchCriteria\n            With .Item(i)\n                .SetFirstPriority\n                With .Interior\n                    .PatternColorIndex = xlAutomatic\n                    .Color = RGB(225, 225, 0)\n                End With\n                .StopIfTrue = False\n            End With\n        End With\n</code></pre>\n\n<p>This does not set the format conditions.  The rule is there and the range, criteria are correct, but the format conditions are \"No Format Set\".</p>\n\n<p>HOWEVER.... if I change</p>\n\n<pre><code>With .Range(\"A:A\").FormatConditions\n</code></pre>\n\n<p>to</p>\n\n<pre><code>With .Range(\"E:E\").FormatConditions\n</code></pre>\n\n<p>It works...  </p>\n\n<p>\"B:B\", \"C:C\", \"D:D\" all fail with the same issue.</p>\n\n<p>Using \"E:E\" (and I also tried \"F:F\" which worked), I can then open the workbook and manually change the range to \"A:A\", \"B:B\", \"C:C\" or \"D:D\" and it works.</p>\n\n<p>I then tried \"A:E\", which also worked.  It appears that if I use any part of column E through W (last column) it works, but if I don't include anything from E and following it fails.</p>\n\n<p>Totally confused here.  Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526492612, "post_id": 50376744, "comment_id": 87770303, "body": "When the dialog to select the files is open, have you tried sorting the files by Creation Date before you select them?"}, {"owner": {"reputation": 21, "user_id": 9801562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2929f40798755ac11841e7db5de49d?s=128&d=identicon&r=PG&f=1", "display_name": "Strategist", "link": "https://stackoverflow.com/users/9801562/strategist"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526498803, "post_id": 50376744, "comment_id": 87773327, "body": "Didn&#39;t realize that would work, but it does... that is a great temporary solution, and I will make sure to include that into my instructions for the department. I would still prefer something that forces the sort if possible, to prevent user error, but I can work with this as an immediate solution!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1526503042, "post_id": 50376744, "comment_id": 87775244, "body": "If you want the latest of the creation or last modified date, you can use the VBA <code>FileDateTime</code> function.  If you want only the creation date, you can use the <code>FileSystemObject</code> to obtain that. Then it&#39;s a matter of sorting, and looping through the sorted list of names instead of the list in the <code>.SelectedItems</code> property."}, {"owner": {"reputation": 221, "user_id": 9986139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GfJY.jpg?s=128&g=1", "display_name": "Louie Lee", "link": "https://stackoverflow.com/users/9986139/louie-lee"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1597980679, "post_id": 50376744, "comment_id": 112315056, "body": "@RonRosenfeld Thanks for mentioning that! The FileDateTime  works nicely for me"}], "owner": {"reputation": 21, "user_id": 9801562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2929f40798755ac11841e7db5de49d?s=128&d=identicon&r=PG&f=1", "display_name": "Strategist", "link": "https://stackoverflow.com/users/9801562/strategist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1526492381, "creation_date": 1526491367, "last_edit_date": 1526492381, "question_id": 50376744, "link": "https://stackoverflow.com/questions/50376744/reorder-selection-of-files", "title": "Reorder selection of files", "body": "<p>I have created an Excel Macro at work to be used for assembling consolidated reports in Excel. The macro allows you to select a number of files, it then goes through those files and renames the first tab in each file (which with the way it is used is the only tab) to match the file name (so you can rename the files without having to open all and rename tabs), and then merges all these tabs into your current workbook, creating a large consolidated report.</p>\n\n<p>However, I am running into the problem that the macro defaults to do this to the selected files in the alphabetical order of the file names, which then requires us to sort the tabs after we have run the macro.</p>\n\n<p>What I am looking for is an adjustment to the macro that will sort the files by creation date&amp;time, oldest to newest, because the order the files are created generally matches the desired result in our final reports.</p>\n\n<p>I figure I will need to make a separate for i = 1 to etc loop that re-orders the selected files, store the new order, and use that order for the current loop, but I am not sure how to do that. I did to some searches, but while I found some similar items, anything similar seems to use a folder selection rather than individual file selection, and there were other differences I couldn't quite translate to my macro either. Here is the current macro:</p>\n\n<pre><code>Sub Reports()\nDim numberOfFilesChosen, i As Integer, Workbookname As String, tempFileDialog As FileDialog, mainWorkbook, sourceWorkbook As Workbook\nDim tempWorkSheet As Worksheet\nSet mainWorkbook = Application.ActiveWorkbook\nSet tempFileDialog = Application.FileDialog(msoFileDialogFilePicker)\ntempFileDialog.AllowMultiSelect = True\nnumberOfFilesChosen = tempFileDialog.Show\nApplication.ScreenUpdating = False\nFor i = 1 To tempFileDialog.SelectedItems.Count\nWorkbooks.Open tempFileDialog.SelectedItems(i)\n    Set sourceWorkbook = ActiveWorkbook\n        With sourceWorkbook\n        Workbookname = Left(.Name, InStr(.Name, \".\") - 1)\n        .Sheets(1).Name = Workbookname\n        End With\n    For Each tempWorkSheet In sourceWorkbook.Worksheets\n    tempWorkSheet.Copy after:=mainWorkbook.Sheets(mainWorkbook.Worksheets.Count)\n    Next tempWorkSheet\n    sourceWorkbook.Close savechanges:=False\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I hope you can help me, thank you!</p>\n"}, {"tags": ["excel", "vba", "vbe"], "comments": [{"owner": {"reputation": 936, "user_id": 1369298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae2157a2435a7a61038828ef8c1f4836?s=128&d=identicon&r=PG", "display_name": "st_stefanov", "link": "https://stackoverflow.com/users/1369298/st-stefanov"}, "edited": false, "score": 0, "creation_date": 1526491580, "post_id": 50376726, "comment_id": 87769750, "body": "There should be an object after the &quot;With&quot; keyword, that is what will be used inside the With - End With scope. The idea of &quot;With&quot; is to shorten the code by declaring the object once."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1526491655, "post_id": 50376726, "comment_id": 87769791, "body": "I&#39;ve seen this before, also on a recent purchased computer.  Close everything, reboot, let Office finish installing, then try again. You can expedite the process by going to <code>Start</code> &gt; <code>Add&#47;Remove Programs</code>, <b>right-click</b> Microsoft Office in the list of programs, and choose &quot;<code>Repair</code>&quot;.  Once it&#39;s fully complete, reboot again."}, {"owner": {"reputation": 11, "user_id": 9801680, "user_type": "registered", "profile_image": "https://graph.facebook.com/520036498393434/picture?type=large", "display_name": "David Lee", "link": "https://stackoverflow.com/users/9801680/david-lee"}, "edited": false, "score": 1, "creation_date": 1526492667, "post_id": 50376726, "comment_id": 87770332, "body": "Thank you, st_stefanov and ashleedawg! The repair worked! Thank you for saving me from so much stress :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1526494170, "post_id": 50376726, "comment_id": 87771101, "body": "@ashleedawg if you have a chance, post that as an answer - looks like something that can be helpful to others =)"}], "owner": {"reputation": 11, "user_id": 9801680, "user_type": "registered", "profile_image": "https://graph.facebook.com/520036498393434/picture?type=large", "display_name": "David Lee", "link": "https://stackoverflow.com/users/9801680/david-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1611576827, "creation_date": 1526491277, "last_edit_date": 1611576827, "question_id": 50376726, "link": "https://stackoverflow.com/questions/50376726/recorder-not-recording-properly", "title": "Recorder not recording properly", "body": "<p>I've been trying to record a macro in Excel 2016 on my new computer.</p>\n<p>After I finish recording, I try it out and get a syntax error.</p>\n<p>I looked at the code, and see:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Cells.ErrorString\n    With .\n        . = xlSolid\n        . = xlAutomatic\n        .Order = xlThemeColorDark1\n        .Symbol = 0\n        . = 0\n    End With\n    With\n        . = xlGeneral\n        . = xlCenter\n        . = FALSE\n        . = 0\n        . = FALSE\n        . = 0\n        . = FALSE\n        . = xlContext\n        . = FALSE\n    End With\n    .SourceName = 11.44\n    .SortItems = 21.6\nEnd Sub\n</code></pre>\n<p>It looks like there should be something before or after the (.) on each line.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526492051, "post_id": 50376791, "comment_id": 87769993, "body": "Ah yes, that worked. But now the value returned is a zero instead of the actual output? How do i return the final answer into the cell when called?"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526492071, "post_id": 50376791, "comment_id": 87770009, "body": "Thanks so much for answering btw!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526492294, "post_id": 50376791, "comment_id": 87770156, "body": "If you&#39;re expecting to return a string then specify the return type on your function.  See my second suggestion for something which has some error checking, though you may want to change how it handles single words (just return that one word, or nothing?)"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526492338, "post_id": 50376791, "comment_id": 87770178, "body": "What&#39;s the purpose of <code>GetName = &quot;&quot;</code>?"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526492559, "post_id": 50376791, "comment_id": 87770272, "body": "@TimWilliams Thanks that makes sense, I will try that approach."}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526492642, "post_id": 50376791, "comment_id": 87770324, "body": "@JohnyL the function is supposed to return a string which includes all the words from the source except the last one. e.g. with source &quot;I am fine&quot; GetName should return &quot;I am&quot;"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526493755, "post_id": 50376791, "comment_id": 87770881, "body": "@TimWilliams If I may bother again: I used the second version of your code (thank you!) but the excel gives me a #VALUE! error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1526494034, "post_id": 50376791, "comment_id": 87771049, "body": "In all cases, or just with some specific inputs?  That exact code works fine for me."}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526494320, "post_id": 50376791, "comment_id": 87771182, "body": "In all cases apparently. Even when i add in string manually or input a cell. I copy pasted the code so it should work just fine"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1526494406, "post_id": 50376791, "comment_id": 87771217, "body": "Try calling the function from a sub:  E.g. - <code>Sub tester(): Debug.Print GetName(&quot;a b&quot;): End Sub</code>  That will let you debug any errors in your code"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526494688, "post_id": 50376791, "comment_id": 87771372, "body": "I just did and it says runtime error, Type mismatch at the following line:"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526494700, "post_id": 50376791, "comment_id": 87771376, "body": "arr = VBA.Split(v, &quot; &quot;)"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526494728, "post_id": 50376791, "comment_id": 87771389, "body": "@Mrizwan This is unnecessary line"}, {"owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "edited": false, "score": 0, "creation_date": 1526494909, "post_id": 50376791, "comment_id": 87771480, "body": "isnt it used to create the array in the first place though?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526495171, "post_id": 50376791, "comment_id": 87771606, "body": "@JohnyL - why do you think it&#39;s unnecessary?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526495391, "post_id": 50376791, "comment_id": 87771712, "body": "as written (i.e. without the declared return type), all it does is make the <code>GetName</code> identifier a <code>Variant&#47;String</code>. With the declared return type it&#39;s superfluous, since a <code>String</code> is initialized to an empty string anyway. I think that&#39;s what @JohnyL meant to point out."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1526495547, "post_id": 50376791, "comment_id": 87771786, "body": "That said I&#39;d use the <code>&amp;</code> string concatenation operator instead of <code>+</code> here, but the <code>join</code> approach is much more solid anyway."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1526496445, "post_id": 50376791, "comment_id": 87772177, "body": "@MathieuGuindon Yes, this is what I ment. Without <code>GetName = &quot;&quot;</code>, if the <code>If</code> loop wouldn&#39;t be run, the <code>GetName</code> would be <code>Empty</code>, but any string manipulation would convert it to zero-length string."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1526492201, "last_edit_date": 1526492201, "creation_date": 1526491513, "answer_id": 50376791, "question_id": 50376684, "link": "https://stackoverflow.com/questions/50376684/getting-all-the-words-except-the-last-one-from-a-string/50376791#50376791", "title": "Getting all the words except the last one from a string", "body": "<p>You are including the entire array in the output - you need to stop before the last element...</p>\n\n<p>Also your code as posted doesn't return any value</p>\n\n<pre><code>Function GetName(Source As String)\n    Dim arr() As String 'declares a dynamic array\n    arr = VBA.Split(Source, \" \") 'an array of words split by space from the Source string is built\n    'Ubound function gets the last position of items in the array\n    GetName = \"\"\n\n    For i = LBound(arr) To UBound(arr) - 1 '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        GetName = GetName + \" \" + arr(i)\n    Next i\n\nEnd Function\n</code></pre>\n\n<p>Alternative approach:</p>\n\n<pre><code>Function GetName(Source As String) As String\n    Dim arr, v\n    v = Trim(Source)\n    If Len(v) &gt; 0 Then\n        arr = VBA.Split(v, \" \")\n        If UBound(arr) - LBound(arr) &gt; 0 Then\n            ReDim Preserve arr(LBound(arr) To UBound(arr) - 1) '&lt;&lt; remove last element\n            GetName = Join(arr, \" \")\n        Else\n            GetName = v\n        End If\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9801672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbe879b65596e18599066d38529232?s=128&d=identicon&r=PG&f=1", "display_name": "Mrizwan", "link": "https://stackoverflow.com/users/9801672/mrizwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526492201, "creation_date": 1526491128, "last_edit_date": 1526491574, "question_id": 50376684, "link": "https://stackoverflow.com/questions/50376684/getting-all-the-words-except-the-last-one-from-a-string", "title": "Getting all the words except the last one from a string", "body": "<p>I am trying to get all the words except the last one from a name specified in an excel cell. For some reason my simple VBA code will not run; it just gives me back the original name as is. Could someone please help explain why?</p>\n\n<pre><code>Function GetName(Source As String)\n    Dim arr() As String 'declares a dynamic array\n    arr = VBA.Split(Source, \" \") 'an array of words split by space from the Source string is built\n    'Ubound function gets the last position of items in the array\n    Name = \"\"\n\n    For i = LBound(arr) To UBound(arr)\n        Name = Name + \" \" + arr(i)\n    Next i\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "edited": false, "score": 2, "creation_date": 1526491159, "post_id": 50376652, "comment_id": 87769535, "body": "please post the query you are using to help. likely you should have a filter (<code>WHERE</code>) to only take the most recent photo"}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "edited": false, "score": 0, "creation_date": 1526491406, "post_id": 50376652, "comment_id": 87769665, "body": "@serakfalcon see added photo."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1526493218, "post_id": 50376652, "comment_id": 87770594, "body": "Why keep multiple photos? Why not replace the photo? Try a TOP 1 subquery. Review <a href=\"http://allenbrowne.com/subquery-01.html#TopN\" rel=\"nofollow noreferrer\">allenbrowne.com/subquery-01.html#TopN</a>"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1526493230, "post_id": 50376652, "comment_id": 87770600, "body": "Its hard to figure out your data and query with the Design Mode image you posted. We are mostly talking SQL here. So, in the Query designer, hit the <code>SQL View</code> button top left, copy the SQL code and paste it in your question."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1526494485, "post_id": 50376652, "comment_id": 87771260, "body": "How do you identify which of the two <code>PHOTO</code> records is the newer one?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1526497559, "post_id": 50376652, "comment_id": 87772717, "body": "If you are keeping multiple photos in 1 attachment field, this is a multi-value type field. Requires query to expand the multiple values to individual records. Suggest you read up on use of multi-value field in query. Simplest solution is to not save multiple photos, replace photo."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1526497815, "post_id": 50376652, "comment_id": 87772850, "body": "Saving objects in table can quickly use up Access 2GB size limit. Maybe your images are small enough files this may never happen, but you should be aware of possibility. Another approach is to save images in folder and link to those files with Image control&#39;s ControlSource property.  Review <a href=\"https://stackoverflow.com/questions/50207997/access-form-abc-picture-xyz-jpg-makes-listbox-textboxes-blink-once/50269085#50269085\" title=\"access form abc picture xyz jpg makes listbox textboxes blink once\">stackoverflow.com/questions/50207997/&hellip;</a>"}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1526498577, "post_id": 50376652, "comment_id": 87773191, "body": "@ThomasG Discovering that there is an <code>SQL View</code> just changed my life for the better."}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1526498757, "post_id": 50376652, "comment_id": 87773300, "body": "@SunKnight0 My question exactly. If the answer to that question is, &quot;you can&#39;t&quot; then I guess my above question is moot. I was assuming that access perhaps kept track of which attachment was added when."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1526499114, "post_id": 50376652, "comment_id": 87773470, "body": "You  don&#39;t have some sort of auto-increment or  <i>creation_date</i> field in <code>tblPassHolders</code> ? How can we then pickup the last one ?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1526499254, "post_id": 50376652, "comment_id": 87773528, "body": "@ShemSeger The answer to your question is &quot;it can if designed properly&quot;. If your photo table has an <code>auto-increment primary key ID field</code> as most table should always have unless there is a compelling reason not to, then your answer is there, just grab the record with the higher ID."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1526500340, "post_id": 50376652, "comment_id": 87774029, "body": "@SunKnight0, but there isn&#39;t a Photo table, it&#39;s an attachment field with multiple embedded images. See my previous comments. And now I see the query is expanding the PHOTO field to multiple records. So name the photos with a sequential identifier, and selecting the TOP 1 with the FileName property may be possible."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1526500724, "post_id": 50376652, "comment_id": 87774192, "body": "@June7 right, never used this as I generally try to keep the option to migrate to a better back end open. looking into it, you are right, the filename is the only possible criteria so unless it is a date based one or there is some trusted naming consistency, there is no way."}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1526509566, "post_id": 50376652, "comment_id": 87777716, "body": "@ThomasG There is, but that doesn&#39;t help with knowing which attachment in the attachment field in <code>tblPassHolders</code> came first."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526518783, "post_id": 50376652, "comment_id": 87779807, "body": "This is a great question and I was interested in the internal structure of attachments to see if the sorting could be tweaked. Unfortunately it looks like your stuck with the &quot;sort by filename&quot;. Do all your uploaded files come from one folder or from everywhere? There might be a way of cleaning up files based on the dates - otherwise I think you should implement an &quot;Attachment Clear&quot; routine when a new file is uploaded - good example of clearing <code>child recordsets</code> at <a href=\"https://stackoverflow.com/questions/26691174/display-attachment-for-specific-record-microsoft-access\" title=\"display attachment for specific record microsoft access\">stackoverflow.com/questions/26691174/&hellip;</a>"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1526519046, "post_id": 50376652, "comment_id": 87779847, "body": "Going forward you could always modify the upload code to change the current filename to something like &quot;000000-latestpic&quot;. That will bring it to the top of the list and subsequent adds will ask you if you want to replace that file"}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526526430, "post_id": 50376652, "comment_id": 87781182, "body": "@dbmitch That&#39;s clever. Don&#39;t suppose you care to compose an answer demonstrating what modifications to the upload code would look like? And what the query would look like? It would make a very up-votable answer, and sounds like the best option thus far."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526528600, "post_id": 50376652, "comment_id": 87781623, "body": "How do you add your new photos now? In a form that edits the record - or do you just double click the table&#39;s field. It&#39;s easier if I have starting form and click event to work with. Otherwise I could create a subset of the form just for editing an existing record to add a new photo."}, {"owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526567923, "post_id": 50376652, "comment_id": 87804164, "body": "@dbmitch Ya, I&#39;ve just been using the native file selector in the form; double clicking the field, but adding a button is no problem."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526569729, "post_id": 50376652, "comment_id": 87805403, "body": "Okay - give it a try - see answer below"}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1526574780, "last_edit_date": 1526574780, "creation_date": 1526534456, "answer_id": 50383825, "question_id": 50376652, "link": "https://stackoverflow.com/questions/50376652/view-only-most-recently-added-attachment-in-access-report/50383825#50383825", "title": "View only most recently added attachment in Access report", "body": "<p>Here is an example of what I was suggesting you could do instead of finding the most recently added attachment.</p>\n\n<p>As discussed it's impossible unless you implement some kind of naming convention that pops your latest file to the top, because Microsoft shows the attachment field in order of filename.</p>\n\n<p>Here's an example that you can use a button to control inserting the attachments.\nIt's based on the <a href=\"https://stackoverflow.com/a/26693078/2419128\">Stack Overflow example</a></p>\n\n<p>Once you finish testing you can add <code>Cancel=True</code> to the <code>Photo_DblClick</code> event to completely control your Photo Attachments field</p>\n\n<pre><code>Private Sub cmdAddNewPhoto_Click()\n\n    Dim rsPhotos        As DAO.Recordset2\n    Dim rsParent        As DAO.Recordset2\n\n    Dim strImagePath    As String\n\n    If MsgBox(\"Add New Photo?\", vbQuestion + vbOKCancel, \"Add Photo?\") = vbOK Then\n\n        ' Get New Photo\n        ' Note that you need to add a reference to Microsoft Office ##.0 Object Library\n        ' using Tools | References... from the VBA interface for the file picker to work\n        With Application.FileDialog(msoFileDialogFilePicker)\n            ' Prevent multiple selections\n            .AllowMultiSelect = False\n            ' Set the caption of the dialog box\n            .Title = \"Please select a photo\"\n            ' Add filters for common image formats\n            .Filters.Clear\n            .Filters.Add \"JPG Files (JPG)\", \"*.JPG\"\n            .Filters.Add \"JPEG Files (JPEG)\", \"*.JPEG\"\n            .Filters.Add \"PNG Files\", \"*.PNG\"\n            .Filters.Add \"Bitmap Files\", \"*.BMP\"\n\n            If .Show = True Then ' File selected\n                strImagePath = .SelectedItems.item(1)\n            End If\n        End With\n\n        If strImagePath &lt;&gt; \"\" Then\n\n            ' First clear all old photos if desired\n            If Photo.AttachmentCount &gt; 0 Then\n                If MsgBox(\"Clear Previous Photo(s)?\", vbQuestion + vbOKCancel, \"Remove All Photos?\") = vbOK Then\n                    ' Clear previous attachments\n                    ' (we only want one attachment at a time)\n                    Set rsPhotos = Me.Recordset.Fields(\"Photo\").Value\n                    With rsPhotos\n                        Do While Not .EOF\n                            .Delete\n                            .MoveNext\n                        Loop\n                        .Close\n                    End With\n                    ' Clear last displayed photo\n                    Photo.Requery\n                End If\n            End If\n\n            ' Put parent record in edit mode\n            Set rsParent = CurrentDb.OpenRecordset(Me.RecordSource, dbOpenDynaset)\n            With rsParent\n                ' Get Cureent Matching Record using Primary Key\n                .FindFirst \"BarCode = \" &amp; Me!barcode\n                .Edit\n                DoEvents\n            End With\n\n            ' Next Add the attachment selected by the user\n            Set rsPhotos = rsParent.Fields(\"Photo\").Value\n            With rsPhotos\n                .AddNew\n                .Fields(\"FileData\").LoadFromFile strImagePath\n                If Photo.AttachmentCount &gt; 0 Then\n                    ' Rename so it pops up to first file - and keep extension\n                    .Fields(\"Filename\").Value = \"00000LatestPic\" &amp; Mid$(strImagePath, InStrRev(strImagePath, \".\"))\n                End If\n                .Update\n                .Close\n            End With\n\n            ' Update the parent record\n            With rsParent\n                .Update\n                .Close\n            End With\n\n            Set rsPhotos = Nothing\n            Set rsParent = Nothing\n\n            ' Refresh Photo Display\n            Photo.Requery\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 50383825, "answer_count": 1, "score": 1, "last_activity_date": 1526574780, "creation_date": 1526491029, "last_edit_date": 1526534514, "question_id": 50376652, "link": "https://stackoverflow.com/questions/50376652/view-only-most-recently-added-attachment-in-access-report", "title": "View only most recently added attachment in Access report", "body": "<p>I'm using an access database as a member management application for our swimming pool. I use a report to print out all of the season passes that have a picture ID. The report uses a query to only print passes for patrons who have had their photo taken. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Z1V0m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z1V0m.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>SELECT tblPassHolders.[PASS HOLDER NAME], tblPassHolders.PHOTO.FileData, tblPassHolders.BARCODE, tblPassHolders.[FAMILY PASS], tblFamilyPass.Expires\nFROM tblFamilyPass INNER JOIN tblPassHolders ON tblFamilyPass.ID = tblPassHolders.FamilyID\nWHERE (((tblPassHolders.PHOTO.FileData) Is Not Null) AND ((tblFamilyPass.Expires)&gt;Now()) AND ((tblPassHolders.Printed)=False));\n</code></pre>\n\n<p>This is year two of using the application, and the problem I'm having is when people re-take their pictures for their pass, then my report prints out a pass for <em>each</em> photo attachment attached to their record. </p>\n\n<p>I'm very amateur with Access still and I'm struggling to figure out how to edit my report/query so that the report will only print <strong>one</strong> pass for each patron using the most recent photo attached to their record. One solution is to simply delete the old photos so there's only ever one attachment, but I'd like to figure out how to make it work even if there are multiple attachments. I've been playing around with <code>DLast()</code> but I'm pretty sure I'm doing it wrong.  </p>\n\n<p>How do I make a query that will only show the most recently added attachment?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1526492888, "creation_date": 1526492888, "answer_id": 50377149, "question_id": 50376648, "link": "https://stackoverflow.com/questions/50376648/set-checkbox-background-transparent/50377149#50377149", "title": "Set checkbox background transparent", "body": "<pre><code>cb.Interior.ColorIndex = xlNone\n</code></pre>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 50377149, "answer_count": 1, "score": 1, "last_activity_date": 1526492888, "creation_date": 1526491021, "question_id": 50376648, "link": "https://stackoverflow.com/questions/50376648/set-checkbox-background-transparent", "title": "Set checkbox background transparent", "body": "<p>I can't for the life of me find how to set a form control checkbox background to transparent</p>\n\n<pre><code>Dim cb As CheckBox\n\nFor Each cb In ActiveSheet.CheckBoxes\n    cb.Value = -4146\n    cb.Interior.Color = ???\nNext cb\n</code></pre>\n\n<p>To be clear I'm talking about a Forms checkbox on a worksheet, not on a form and not an ActiveX checkbox (Developer menu > Insert > Form Controls).</p>\n\n<p>I recorded a macro and got this but I'm wondering if there's a way to do it via the Checkbox object rather than use the Shape object. Even a link to the MSDN Dev page for a Form Controls checkbox would help as I can't find it!</p>\n\n<pre><code>ActiveSheet.Shapes(\"cb1_1\").Fill.Visible = msoFalse\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526491087, "post_id": 50376536, "comment_id": 87769505, "body": "You don&#39;t have a <code>Inc</code> method defined for your <code>cOutside</code> class - are you assuming it&#39;s going to pull from <code>cInside</code>? You have <code>Init</code> defined for both."}, {"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526491218, "post_id": 50376536, "comment_id": 87769564, "body": "@dbmitch, how shall I fix this problem?  If I have multiple layer of nested class, do I have to define the same method in each layer?  Or is there a better way to do it?"}], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526491697, "post_id": 50376711, "comment_id": 87769813, "body": "Thank you for your help.  As a newbie, I was wondering how Excel VBA object works.  For example, a workbook object contains worksheets objects, which contain range objects.  Then I was able to do something like wb.ws.rng.values.  Does that mean the &quot;values&quot; property has to be defined in each class?  Thank you!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526491947, "post_id": 50376711, "comment_id": 87769944, "body": "<code>wb.ws.rng</code> wouldn&#39;t be legal. Assuming <code>wb</code> is a <code>Workbook</code> instance, then <code>wb.Worksheets(1).Range(&quot;A1&quot;).Value</code> would be more like it - anyway no, the dot (<code>.</code>) denotes a <i>member call</i>, which means the member being invoked needs to be defined in the <i>type</i> (that&#39;s the class) of the expression that comes before the dot. In the case of <code>Range(&quot;A1&quot;).Value</code>, <code>Value</code> is a member of the <code>Range</code> class, and <code>Range</code> is (confusingly, perhaps) a member of the <code>Worksheet</code> class that returns an instance of the <code>Range</code> class. Find the classes in the object browser (F2) for everything you need to know =)"}, {"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526493198, "post_id": 50376711, "comment_id": 87770584, "body": "@Mathiew, I edited the code and got a different error &quot;object variable or with block variable not set&quot;.  Can yo please take a look?  Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526493276, "post_id": 50376711, "comment_id": 87770629, "body": "You missed the <code>Set</code> keyword, which is required when assigning object references."}, {"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526493426, "post_id": 50376711, "comment_id": 87770716, "body": "Edited the code again.  Now we&#39;re moving one step forward.  But get the error on the next line of code.  :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526493550, "post_id": 50376711, "comment_id": 87770775, "body": "Compare yout getter to mine"}, {"owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "edited": false, "score": 0, "creation_date": 1526493751, "post_id": 50376711, "comment_id": 87770877, "body": "Finally got it.  Much appreciate it!  Mathiew"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1526491215, "creation_date": 1526491215, "answer_id": 50376711, "question_id": 50376536, "link": "https://stackoverflow.com/questions/50376536/vba-nested-class/50376711#50376711", "title": "VBA - Nested Class", "body": "<p><code>n.Num1</code> returns an <code>Integer</code>, which isn't an instance of <code>cInside</code>, and therefore doesn't have an <code>Inc</code> member, which makes it an <em>invalid qualifier</em> for the compiler to complain about ;-)</p>\n\n<p>Your <code>cOutside</code> class needs to expose it somehow:</p>\n\n<pre><code>Property Get ComposedObject1() As cInside\n    Set ComposedObject1 = m_Num1\nEnd Property\n</code></pre>\n\n<p>Then the calling code could do this:</p>\n\n<pre><code>n.ComposedObject1.Inc\n</code></pre>\n\n<p>I called that \"composed\", because what you're doing isn't \"nesting\", but \"composition\". VBA doesn't supported nested classes, which would be a class module defined inside another class module, like so:</p>\n\n<pre><code>Class Outside\n    '... members...\n\n    Class Inside\n        '...members...\n    End Class\nEnd Class\n</code></pre>\n\n<p>VB.NET can do that, but in VBA 1 class module can only define 1 class.</p>\n"}], "owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 50376711, "answer_count": 1, "score": 2, "last_activity_date": 1594634803, "creation_date": 1526490569, "last_edit_date": 1594634803, "question_id": 50376536, "link": "https://stackoverflow.com/questions/50376536/vba-nested-class", "title": "VBA - Nested Class", "body": "<p>[Edited the code]\nSorry for newbie question.  I was trying to test nested classes in VBA for Excel but got error message.  Can anyone help me understand why?  Thank you!</p>\n\n<p>Inside class:</p>\n\n<pre><code>' CLASS MODULE - cInside\n' Member variables\nPrivate m_Value As Integer\n\n' Properties\nProperty Get Value() As Integer\n    Value = m_Value\nEnd Property\n\nProperty Let Value(i As Integer)\n    m_Value = i\nEnd Property\n\n' Methods\nSub init()\n    m_Value = 0\nEnd Sub\n\nSub Inc()\n    m_Value = m_Value + 1\nEnd Sub\n</code></pre>\n\n<p>Outside class:</p>\n\n<pre><code>' CLASS MODULE - cOutside\n' Member variables\nPrivate m_Num1 As New cInside\nPrivate m_Num2 As New cInside\n\n' Properties\nProperty Get Num1() As cInside\n    Num1 = m_Num1.Value\nEnd Property\n\nProperty Get Num2() As cInside\n    Num2 = m_Num2.Value\nEnd Property\n\nProperty Set Num1(i As cInside)\n    Set m_Num1 = i\nEnd Property\n\nProperty Set Num2(i As cInside)\n    Set m_Num2 = i\nEnd Property\n</code></pre>\n\n<p>Main program:</p>\n\n<pre><code>Sub Main()\n\nDim o As New cOutside\nDim i As New cInside\n\ni.Value = 9\ni.Inc\nDebug.Print i.Value '&lt;-- this works\n\nSet o.Num1 = i\no.Num1.Inc  '&lt;-- object variable or with block variable not set\nDebug.Print (o.Num1.Value)\n\nEnd Sub\n</code></pre>\n\n<p>Thank you again!</p>\n"}, {"tags": ["excel", "vba", "focus", "userform", "setfocus"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1526490479, "post_id": 50376430, "comment_id": 87769183, "body": "I&#39;m pretty sure you can&#39;t set focus to a label. Labels are not meant to be interactive.  Try using a <b>Text Box</b> instead."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1526491703, "post_id": 50376430, "comment_id": 87769819, "body": "FWIW <code>SkuCodeBox</code> would be <b>INFINITELY</b> clearer than <code>T4</code> or <code>T3</code> or <code>L1</code> for a name. Use meaningful names, thank yourself later."}, {"owner": {"reputation": 3, "user_id": 8250267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Q4wYPGqwW4/AAAAAAAAAAI/AAAAAAAAAGI/9JijH9AhCx8/photo.jpg?sz=128", "display_name": "Hector Nunez", "link": "https://stackoverflow.com/users/8250267/hector-nunez"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1526496808, "post_id": 50376430, "comment_id": 87772353, "body": "@ashleedawg My bad, i&#39;m trying to set the focus on TextBox, not a Label."}, {"owner": {"reputation": 3, "user_id": 8250267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Q4wYPGqwW4/AAAAAAAAAAI/AAAAAAAAAGI/9JijH9AhCx8/photo.jpg?sz=128", "display_name": "Hector Nunez", "link": "https://stackoverflow.com/users/8250267/hector-nunez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1526496822, "post_id": 50376430, "comment_id": 87772362, "body": "@MathieuGuindon edited."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1526623077, "post_id": 50376430, "comment_id": 87824610, "body": "With <code>txtSKU</code> (the big textbox where you suppose to scan many items?), is the <code>MultiLine</code> property set to <code>True</code> and <code>EnterKeyBehavior</code> set to <code>True</code>? Most scanners inserts a tab/enter on each successful scan"}, {"owner": {"reputation": 3, "user_id": 8250267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Q4wYPGqwW4/AAAAAAAAAAI/AAAAAAAAAGI/9JijH9AhCx8/photo.jpg?sz=128", "display_name": "Hector Nunez", "link": "https://stackoverflow.com/users/8250267/hector-nunez"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1527006937, "post_id": 50376430, "comment_id": 87958752, "body": "@PatricK. Thank you for your answer. I&#39;ve made the changes you pointed with great success, but still one issue remains. It now focuses back on txtSKU textlabel, but, even when i&#39;m telling the application to set txtSKU.value = &quot;&quot; after scanning, it still keeps on txtSKU a couple characters from the previous SKU scanned.   Is this because of multiline property? But if i set it to false, it doesn&#39;t focuses back."}], "answers": [{"comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 3, "user_id": 8250267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Q4wYPGqwW4/AAAAAAAAAAI/AAAAAAAAAGI/9JijH9AhCx8/photo.jpg?sz=128", "display_name": "Hector Nunez", "link": "https://stackoverflow.com/users/8250267/hector-nunez"}, "edited": false, "score": 0, "creation_date": 1529454701, "post_id": 50478217, "comment_id": 88875445, "body": "@HectorNunez please do mark this as answer to close this post."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1527035383, "creation_date": 1527035383, "answer_id": 50478217, "question_id": 50376430, "link": "https://stackoverflow.com/questions/50376430/textbox-setfocus-not-working-on-vba-form-excel/50478217#50478217", "title": "TextBox SetFocus not working on VBA Form Excel", "body": "<p>Assuming the barcode scanner automatically appends an <kbd>Enter</kbd> on each successfull scan, you just need to trap that Enter at KeyDown event and replace with KeyCode 0.</p>\n\n<p>Try comment your <code>txtSKU_Change</code> Sub and append below to test:</p>\n\n<pre><code>Private Sub txtSKU_Change()\n    Dim sValue As String\n    With Me.txtSKU\n        sValue = WorksheetFunction.Trim(.Value)\n        If Len(sValue) = 13 Then\n            With Me.L1\n                .AddItem Me.txtBulto.Value\n                .List(.ListCount - 1, 1) = sValue\n                .List(.ListCount - 1, 2) = Me.txtAuditor2.Value\n            End With\n            .Value = vbNullString\n        End If\n    End With\nEnd Sub\n\nPrivate Sub txtSKU_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = 13 Then KeyCode = 0 ' Rejects Enter Key\nEnd Sub\n</code></pre>\n\n<p></p>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1572678140, "post_id": 58668668, "comment_id": 103640198, "body": "Welcome to SO! When you reply to a question with code, try to explain it a little bit."}], "tags": [], "owner": {"reputation": 1, "user_id": 12311153, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e1ae889a353c5dbafaa3ed9b1b4f0f7a?s=128&d=identicon&r=PG", "display_name": "Vinit J", "link": "https://stackoverflow.com/users/12311153/vinit-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1572674943, "last_edit_date": 1572674943, "creation_date": 1572674750, "answer_id": 58668668, "question_id": 50376430, "link": "https://stackoverflow.com/questions/50376430/textbox-setfocus-not-working-on-vba-form-excel/58668668#58668668", "title": "TextBox SetFocus not working on VBA Form Excel", "body": "<p>Please use code similar to this:</p>\n\n<pre><code>Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, _\n            ByVal X As Single, ByVal Y As Single)\n\n   If UserForm1.ActiveControl.Name = \"List1\" Then\n   UserForm1.TextBox1.SetFocus\n   End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8250267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Q4wYPGqwW4/AAAAAAAAAAI/AAAAAAAAAGI/9JijH9AhCx8/photo.jpg?sz=128", "display_name": "Hector Nunez", "link": "https://stackoverflow.com/users/8250267/hector-nunez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4169, "favorite_count": 0, "accepted_answer_id": 50478217, "answer_count": 2, "score": 0, "last_activity_date": 1580283504, "creation_date": 1526490144, "last_edit_date": 1580283504, "question_id": 50376430, "link": "https://stackoverflow.com/questions/50376430/textbox-setfocus-not-working-on-vba-form-excel", "title": "TextBox SetFocus not working on VBA Form Excel", "body": "<p>I have simple form which i am planning to use on audit the sorting station at my work. Its pretty simple and looks like this:</p>\n\n<p>.</p>\n\n<p>The Problem: I'm using a handheld scanner (Symbol LI4278) to scan bar codes of every SKU contained in a certain bulk. The procedure is simple:</p>\n\n<ol>\n<li>Scan the bulk Code (Label: Etiqueta de Bulto)</li>\n<li>Then, the focus drops on SKU text Label</li>\n<li>Scan every SKU Barcode</li>\n<li>Send information to an access data base.</li>\n</ol>\n\n<p>My problem lies in that after i scan a SKU Barcode, focus does not return to text label (T4) in order to keep scanning (SKU TEXT LABEL = T4), unless i hit TAB once. I need this to be automatic, and setfocus property is not working.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private Sub txtSKU_Change()\n\n            Application.EnableEvents = False\n            txtBulto.Locked = True\n\n            If Len(Me.txtSKU.Value) = 13 Then\n\n                Me.L1.ColumnCount = 3\n                Me.L1.AddItem Me.txtBulto.Value\n                Me.L1.List(L1.ListCount - 1, 1) = Me.txtSKU.Value\n                Me.L1.List(L1.ListCount - 1, 2) = Me.txtAuditor2.Value\n                End If\n\n              txtSKU.SetFocus  \n            Application.EnableEvents = True\n     End Sub\n</code></pre>\n\n<p>I would really appreciate your help on this. I need this application to work perfect for operation purposes and reduce mistakes.</p>\n\n<p>Regards</p>\n\n<p><a href=\"https://i.stack.imgur.com/ESbdp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ESbdp.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1526490306, "post_id": 50376387, "comment_id": 87769090, "body": "Why do you have <code>LastRow</code> and never use it?"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1526493749, "post_id": 50376510, "comment_id": 87770874, "body": "Would changing <code>ElseIf</code> to <code>Else</code> make a difference in speed? Even this specific instance aside, say there&#39;s 100,000 rows to check.  Does <code>Else</code> provide better &#39;speed&#39; than <code>ElseIf</code>?  Perhaps because <code>ElseIf</code> has the compiler thinking there may be more conditions in that block, whereas <code>Else</code> signals the end of the <code>If</code> statement?"}, {"owner": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526497001, "post_id": 50376510, "comment_id": 87772451, "body": "Thank you Mark PM! Making those two changes significantly increased the speed of the macro.  That was perfect!"}, {"owner": {"reputation": 2839, "user_id": 470096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88080fb2ed07fc23209593063e224ed?s=128&d=identicon&r=PG", "display_name": "Mark PM", "link": "https://stackoverflow.com/users/470096/mark-pm"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1526555661, "post_id": 50376510, "comment_id": 87795489, "body": "@BruceWayne It will speed it up (very, very slightly) as there is no extra if so less checks! The main speed improvement will come from screen updating..."}], "tags": [], "owner": {"reputation": 2839, "user_id": 470096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88080fb2ed07fc23209593063e224ed?s=128&d=identicon&r=PG", "display_name": "Mark PM", "link": "https://stackoverflow.com/users/470096/mark-pm"}, "is_accepted": false, "score": 0, "last_activity_date": 1526490438, "creation_date": 1526490438, "answer_id": 50376510, "question_id": 50376387, "link": "https://stackoverflow.com/questions/50376387/hide-rows-based-on-content-speed/50376510#50376510", "title": "Hide Rows based on content - Speed", "body": "<p>You should turn off screen updating when it is running, also remove the ElseIf and make it Else:</p>\n\n<pre><code>Dim LastRow As Long, c As Range\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nLastRow = Cells(Cells.Rows.Count, \"C\").End(xlUp).Row\nOn Error Resume Next\n\n\n\n  For Each c In Range(\"B1:B812\")\n      If c.Value = \"\" Then\n      c.EntireRow.Hidden = True\n      Else\n      c.EntireRow.Hidden = False\n      End If\n    Next\n\nOn Error GoTo 0\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>This will run faster</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 3, "last_activity_date": 1526493674, "last_edit_date": 1526493674, "creation_date": 1526490453, "answer_id": 50376512, "question_id": 50376387, "link": "https://stackoverflow.com/questions/50376387/hide-rows-based-on-content-speed/50376512#50376512", "title": "Hide Rows based on content - Speed", "body": "<p>You could alternatively use <code>SpecialCells()</code></p>\n\n<pre><code>Sub hide_empty_rows()\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim rng As Range\nSet rng = Range(\"B12:B812\")\nrng.SpecialCells(xlCellTypeBlanks).EntireRow.Hidden = True\nrng.SpecialCells(xlCellTypeConstants).EntireRow.Hidden = False\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>The <code>Application.[]</code> parts will help speed it up a little more.  You shouldn't really be crashing Excel with just 800 rows, so I'm assuming you have some formulas/etc that updates each time a cell gets updated.  The <code>SpecialCells()</code> should speed it up alone, but the three <code>Application.[]</code> parts are generally helpful too.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526655656, "post_id": 50381458, "comment_id": 87844060, "body": "Thank you, that was even faster! basically instantaneous! However, that does introduce a new problem, which is that If I want to manually unhide a row, it&#39;s seemingly not allowing me to do so. I can still manually hide rows, I just can&#39;t seem to then unhide them, if I need to."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526672140, "post_id": 50381458, "comment_id": 87851861, "body": "@ChrisM - Thanks for the feedback! Yes, while the <code>AutoFilter</code> is in effect you can&#39;t unhide rows manually. I made a change where is still using the benefits of <code>AutoFilter</code>, it captures the rows to be hidden, removes the <code>AutoFilter</code>, and at the end hides all rows to be hidden. It&#39;s a bit slower if you have to work with more than 100K rows"}, {"owner": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526678833, "post_id": 50381458, "comment_id": 87854378, "body": "That worked, although now there is another unintended consequence that I am unsure how it&#39;s related. On another sheet in the same file, I have macros that update automatically when cells change, using:  Private Sub Worksheet_Change(ByVal Target As Range)  The auto change works fine when I first open the file, but as soon as I hit the macro button to execute your code above, it stops.  If I save, close the file, and reopen, I can get the auto change to work again.  Any thoughts there? You&#39;ve been a huge help and I appreciate all your time."}, {"owner": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526679242, "post_id": 50381458, "comment_id": 87854493, "body": "I think I got it.  I needed to add Application.EnableEvents = True at the end of your code!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526716912, "post_id": 50381458, "comment_id": 87861031, "body": "@ChrisM - Nice work ! However, my code doesn&#39;t turn off events (<code>Application.EnableEvents = False</code>). It only toggles <code>ScreenUpdating</code> Off and On. You <i>could</i> fix the issue by adding <code>Application.EnableEvents = True</code> to this code, but the problem should be fixed at the root: find which code turn OFF <code>Application.EnableEvents</code>, and place <code>Application.EnableEvents = True</code> at the end of that specific procedure, otherwise you spread unrelated logic to different parts of the code that do not do their own &quot;cleanup&quot;"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "edited": false, "score": 0, "creation_date": 1526717194, "post_id": 50381458, "comment_id": 87861108, "body": "( @ChrisM - a quick check: it looks like the answer for &#39;Mark PM&#39; turns off <code>Application.EnableEvents = False</code>, but it doesn&#39;t get back on  to <code>Application.EnableEvents = False</code> )"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1526676061, "last_edit_date": 1526676061, "creation_date": 1526514581, "answer_id": 50381458, "question_id": 50376387, "link": "https://stackoverflow.com/questions/50376387/hide-rows-based-on-content-speed/50381458#50381458", "title": "Hide Rows based on content - Speed", "body": "<p>Another option - using <code>AutoFilter</code> <code>+</code> <code>Rows.Hidden</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub HideEmptyRowsInColB()\n    Const FIRST_ROW = 12\n    Const FILTER_COL = \"B\"\n\n    Dim ws As Worksheet, lr As Long, hide As Range, filterCol As Range, vis As Boolean\n\n    Set ws = Sheet3     'Or: Set ws = ThisWorkbook.Worksheets(\"Sheet3\")\n    lr = ws.Cells(ws.Rows.Count, FILTER_COL).End(xlUp).Row\n\n    Set filterCol = ws.Range(ws.Cells(FIRST_ROW, FILTER_COL), ws.Cells(lr, FILTER_COL))\n\n    Application.ScreenUpdating = False\n        ShowAllRows ws\n        If lr &gt; FIRST_ROW Then\n\n            filterCol.AutoFilter Field:=1, Criteria1:=\"=\"\n                Set hide = filterCol.SpecialCells(xlCellTypeVisible)\n                vis = hide.Cells.Count = 1 And Len(hide.Cells(1)) = 0   'Count visible\n                Set hide = IIf(vis, Nothing, hide.EntireRow)\n            filterCol.AutoFilter\n\n            If Not hide Is Nothing Then\n                hide.Hidden = True\n                hide.Rows(1).Hidden = (Len(hide.Cells(1)) &gt; 0)\n            End If\n        End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub ShowAll()\n    ShowAllRows Sheet3\nEnd Sub\n\nPrivate Sub ShowAllRows(ByRef ws As Worksheet)\n    If ws.AutoFilterMode Then ws.UsedRange.AutoFilter\n    ws.Rows.Hidden = False\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<hr>\n\n<p><strong><code>Performance</code></strong></p>\n\n<pre><code>AutoFilter + Rows.Hidden (Current version):\n\n - Total Rows:   100,001, Hidden:  49,995 - Time:   2.199 sec\n - Total Rows:   200,001, Hidden:  99,995 - Time:   8.551 sec\n - Total Rows:   300,001, Hidden: 149,995 - Time:  19.016 sec\n - Total Rows:   400,001, Hidden: 199,995 - Time:  43.594 sec\n - Total Rows:   500,001; Hidden: 249,995 - Time:  61.387 sec\n - Total Rows: 1,048,573, Hidden: 524,276 - Time: 233.301 sec (almost 4 min)\n\nAutoFilter (Previous version):\n\n - Total Rows:   500,001; Hidden: 249,995 - Time:   0.211 sec\n - Total Rows: 1,048,563; Hidden: 262,144 - Time:   0.469 sec\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9801564, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris M", "link": "https://stackoverflow.com/users/9801564/chris-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1526676061, "creation_date": 1526489988, "last_edit_date": 1526493512, "question_id": 50376387, "link": "https://stackoverflow.com/questions/50376387/hide-rows-based-on-content-speed", "title": "Hide Rows based on content - Speed", "body": "<p>I am extremely new to coding VBA macros for excel and have mostly googled what I want to accomplish in excel and adapting others VBA code specifically to my needs.  One of my macros hides rows based on the contents of a cell.  I am finding that it takes too long to run and can make some older computers lock up.  Does anyone have any suggestions on making this run quicker with fewer resources? Below is the code that I am using: </p>\n\n<pre><code>Sub Hiderow()\nDim LastRow As Long, c As Range \nApplication.EnableEvents = False\nLastRow = Cells(Cells.Rows.Count, \"C\").End(xlUp).Row    \nOn Error Resume Next \n\nFor Each c In Range(\"B12:B812\") \n    If c.Value = \"\" Then  \n        c.EntireRow.Hidden = True    \n    ElseIf c.Value &lt;&gt; \"\" Then    \n        c.EntireRow.Hidden = False    \n    End If    \nNext\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526491022, "post_id": 50376322, "comment_id": 87769469, "body": "What is &quot;From Cells&quot;? Named range? Literal? Where this &quot;From Cells&quot; is in code?"}, {"owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526545241, "post_id": 50376322, "comment_id": 87788713, "body": "I just updated my post with a picture, refering to &quot;Label Options -&gt; Value From Cells&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526545870, "post_id": 50376322, "comment_id": 87789111, "body": "I don&#39;t know whether this will be appropriate for you, but you can create charts which can be independent of sheet&#39;s data. You can copy and paste such charts any place you want - the data will go with it. As for you chart, you need qualify your range with sheet reference."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "edited": false, "score": 0, "creation_date": 1526892236, "post_id": 50426318, "comment_id": 87903638, "body": "I really was hooping that I could do a Find &amp; Replace of a chart field. Thanks Jon. I like very much your web site and I have learned a lot."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 1, "last_activity_date": 1528308661, "last_edit_date": 1528308661, "creation_date": 1526739932, "answer_id": 50426318, "question_id": 50376322, "link": "https://stackoverflow.com/questions/50376322/replace-value-from-cells-in-chart-data-labels-using-vba/50426318#50426318", "title": "Replace &quot;Value From Cells&quot; in chart data labels using VBA", "body": "<p>I don't think this is exactly what you want. Your code loops through all series of all charts and apparently wants to use the same range for labels. This will do it:</p>\n\n<pre><code>Sub xtDataLabels_FromCells()\n    Dim oChart As ChartObject\n    Dim OldString As String, NewString As String\n    Dim mySrs As Variant\n\n    OldString = \"'[Daily Report]SP'!$P$11:$P$20\" ' irrelevant\n    NewString = \"SP!$P$11:$P$20\"\n\n    For Each oChart In ActiveSheet.ChartObjects\n        For Each mySrs In oChart.Chart.SeriesCollection\n            ' From a recorded macro\n            mySrs.DataLabels.Format.TextFrame2.TextRange. _\n                InsertChartField msoChartFieldRange, \"=\" &amp; NewString, 0\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>If you want to do a Find &amp; Replace of the existing chart field, I'm afraid you're out of luck. You can use VBA to <em>set</em> the chart field using <code>InsertChartField</code>, but you can't use VBA to <em>read</em> what is in an existing chart field.</p>\n\n<p>Just another shortcoming of the VBA Object Model for Excel charts.</p>\n"}], "owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2218, "favorite_count": 0, "accepted_answer_id": 50426318, "answer_count": 1, "score": -1, "last_activity_date": 1528308661, "creation_date": 1526489784, "last_edit_date": 1526545654, "question_id": 50376322, "link": "https://stackoverflow.com/questions/50376322/replace-value-from-cells-in-chart-data-labels-using-vba", "title": "Replace &quot;Value From Cells&quot; in chart data labels using VBA", "body": "<p>I have copied  several charts from a workbook to another and I managed to change the data series with vba.</p>\n\n<p>Some of the data labels of these charts, get data \"<strong>From Cells</strong>\" but this range is still referencing the the first workbook and I need to change it to reference the new sheet in the new workbook.</p>\n\n<p>I am being able to get the formula that references the \"From Cells\".</p>\n\n<p>This is the code that I have</p>\n\n<pre><code>Sub xtDataLabels_FromCells()\n    Dim oChart As ChartObject\n    Dim OldString As String, NewString As String\n    Dim mySrs As Variant\n\n    OldString = \"'[Daily Report]SP'!$P$11:$P$20\"\n    NewString = \"SP!$P$11:$P$20\"\n\n    For Each oChart In ActiveSheet.ChartObjects\n        For Each mySrs In oChart.Chart.SeriesCollection\n            ' From a recorded macro\n            'ActiveChart.SeriesCollection(7).DataLabels.Format.TextFrame2.TextRange. _\n                InsertChartField msoChartFieldRange, \"=SP!$P$11:$P$20\", 0\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>\"Value From Cells\"</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/513Co.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/513Co.png\" alt=\"enter image description here\"></a></p>\n\n<p>Regards,\nElio Fernandes</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 1, "creation_date": 1526490899, "post_id": 50376036, "comment_id": 87769400, "body": "A &quot;For loop&quot; is what you are looking for. For i = 1 to 500. <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/for-next-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 9801478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b00da35cd018d9cc08da341e9b264d?s=128&d=identicon&r=PG&f=1", "display_name": "John Quamme", "link": "https://stackoverflow.com/users/9801478/john-quamme"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526491297, "post_id": 50376036, "comment_id": 87769608, "body": "Thank you I will give it a try."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9801478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b00da35cd018d9cc08da341e9b264d?s=128&d=identicon&r=PG&f=1", "display_name": "John Quamme", "link": "https://stackoverflow.com/users/9801478/john-quamme"}, "edited": false, "score": 0, "creation_date": 1526493622, "post_id": 50376964, "comment_id": 87770813, "body": "How do I replace the i with numerical sequence"}, {"owner": {"reputation": 31, "user_id": 9801478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b00da35cd018d9cc08da341e9b264d?s=128&d=identicon&r=PG&f=1", "display_name": "John Quamme", "link": "https://stackoverflow.com/users/9801478/john-quamme"}, "edited": false, "score": 0, "creation_date": 1526494139, "post_id": 50376964, "comment_id": 87771084, "body": "I figured out where the issue was.  That sample got me started.  Thank you so much!"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 31, "user_id": 9801478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b00da35cd018d9cc08da341e9b264d?s=128&d=identicon&r=PG&f=1", "display_name": "John Quamme", "link": "https://stackoverflow.com/users/9801478/john-quamme"}, "edited": false, "score": 0, "creation_date": 1526494663, "post_id": 50376964, "comment_id": 87771363, "body": "Glad it helped."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1526494630, "last_edit_date": 1526494630, "creation_date": 1526492120, "answer_id": 50376964, "question_id": 50376036, "link": "https://stackoverflow.com/questions/50376036/how-do-i-automatically-change-a-part-of-my-data-in-my-excel-formula/50376964#50376964", "title": "How do I automatically change a part of my data in my excel formula", "body": "<p>The following example will write Number 1,2,3,4... on Cells A1 to A500</p>\n\n<p>Edit: On Cells B1 to B500 this will add the following formula =5*i, it will multiply 5 times the number generated by the loop (1 to 500).</p>\n\n<pre><code>Sub TestLoop()\n    Dim i As Long\n    Dim formulaText As String\n    For i = 1 To 500\n        formulaText = \"=5*\" &amp; i &amp; \"&amp;\" &amp; \"\"\" Is The product of 5 * \" &amp; i &amp; \"\"\"\"\n        Range(\"A\" &amp; i).Value = \"Number: \" &amp; i\n        Range(\"B\" &amp; i).Formula = formulaText\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9801478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b00da35cd018d9cc08da341e9b264d?s=128&d=identicon&r=PG&f=1", "display_name": "John Quamme", "link": "https://stackoverflow.com/users/9801478/john-quamme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1526494630, "creation_date": 1526488815, "last_edit_date": 1531164843, "question_id": 50376036, "link": "https://stackoverflow.com/questions/50376036/how-do-i-automatically-change-a-part-of-my-data-in-my-excel-formula", "title": "How do I automatically change a part of my data in my excel formula", "body": "<p>Here is my formula:</p>\n\n<p>=RSLINX|AIR_TESTER_DATA!'AIR_TESTER_EXCEL_CHASSIS_STRing[14,i],L1,C1'</p>\n\n<p>The i needs to go from 1 to 500 in 500 rows. same column.  I have a search and replace function that works excellent for the 14.  I just am not sure how to sequentially change the i from 1 to 500?  Help is appreciated thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526489532, "post_id": 50375876, "comment_id": 87768654, "body": "Are all the completed rows sequential, e.g. 5-10 ?"}], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1526489553, "creation_date": 1526489553, "answer_id": 50376259, "question_id": 50375876, "link": "https://stackoverflow.com/questions/50375876/automatically-copy-rows-that-contain-text-in-a-specific-column-when-pasting-to-a/50376259#50376259", "title": "automatically copy rows that contain text in a specific column when pasting to another workbook", "body": "<p>I took a For Loop approach to look at values in Column A and skip empty ones. There are many ways to go about this, this is just one.</p>\n\n<pre><code>Sub Export_Data()\n    Dim owb As Workbook\n    Dim sh As Worksheet\n    Dim sRange as Range\n    Dim i as Long\n\n    Set sh = Sheet1\n    Set owb = Workbooks.Open(\"my_destination_workbook\")\n\n    For i = 5 to 25 Step + 1 'from 5 to 25 because you are checking A5:K25\n        'If \"A &amp; i\" has a value, copy A to Z and paste it at the end on the new workbook\n        If sh.Range(\"A\" &amp; i).Value &lt;&gt; 0 Then\n            sh.Range(\"A\" &amp; i &amp; \":K\" &amp; i).Copy\n            owb.Sheets(\"Sheet1\").Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next\n    owb.Close True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 9710560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c841c4d5b8930670aa209ec67439bf5b?s=128&d=identicon&r=PG&f=1", "display_name": "N. Benedict", "link": "https://stackoverflow.com/users/9710560/n-benedict"}, "is_accepted": false, "score": -1, "last_activity_date": 1526499861, "creation_date": 1526499861, "answer_id": 50378821, "question_id": 50375876, "link": "https://stackoverflow.com/questions/50375876/automatically-copy-rows-that-contain-text-in-a-specific-column-when-pasting-to-a/50378821#50378821", "title": "automatically copy rows that contain text in a specific column when pasting to another workbook", "body": "<p>Thanks Ricardo A</p>\n\n<p>Your code worked to loop through everything, but unfortunately it was still picking up the blank rows. I made a slight alteration and changed</p>\n\n<pre><code>If sh.Range(\"A\" &amp; i).Value &lt;&gt; 0 Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If sh.Range(\"A\" &amp; i).Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>And now it only copies the rows that have a value entered into column I.\nSo the following code now works to copy all rows with a value in column I, and then open a new workbook and paste the copied rows into the next empty row.</p>\n\n<pre><code>Sub Export_Data()\nDim owb As Workbook\nDim sh As Worksheet\n\nSet sh = Sheet1\nSet owb = Workbooks.Open(\"my_destination_workbook\")\n\nFor i = 5 To 25 Step 1\n    If sh.Range(\"A\" &amp; i).Value &lt;&gt; \"\" Then\n        sh.Range(\"A\" &amp; i &amp; \":K\" &amp; i).Copy\n        owb.Sheets(\"Sheet1\").Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    End If\nNext\n\nowb.Close True\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 7, "user_id": 9710560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c841c4d5b8930670aa209ec67439bf5b?s=128&d=identicon&r=PG&f=1", "display_name": "N. Benedict", "link": "https://stackoverflow.com/users/9710560/n-benedict"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1526499861, "creation_date": 1526488205, "last_edit_date": 1531161705, "question_id": 50375876, "link": "https://stackoverflow.com/questions/50375876/automatically-copy-rows-that-contain-text-in-a-specific-column-when-pasting-to-a", "title": "automatically copy rows that contain text in a specific column when pasting to another workbook", "body": "<p>I'm trying to write a macro to copy data from a form, then open a separate workbook and paste the data into the next empty row. The user has 21 rows of information they can fill out, but the number of rows actually filled out will vary from day to day.</p>\n\n<p>The following code works with the exception that, when pasted into the destination workbook, the blank cells are treated as if they contain data. So I end up with several blank rows in between each data dump.</p>\n\n<p>How can I alter this code to copy all rows in the range of row 5 - row 25 that contain text in column \"I\" but ignore any rows that are blank in column \"I\"?</p>\n\n<pre><code>Sub Export_Data()\nDim owb As Workbook\nDim sh As Worksheet\n\nSet sh = Sheet1\nsh.Range(\"A5:K25\").Copy\nSet owb = Workbooks.Open(\"my_destination_workbook\")\n\nowb.Sheets(\"Sheet1\").Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nowb.Close True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "variables", "path"], "comments": [{"owner": {"reputation": 1225, "user_id": 4847565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeD30.jpg?s=128&g=1", "display_name": "Bhanu Pratap", "link": "https://stackoverflow.com/users/4847565/bhanu-pratap"}, "edited": false, "score": 0, "creation_date": 1526487418, "post_id": 50375590, "comment_id": 87767555, "body": "do you want to add path value into cell and then file should be saved on that path or any thing else ?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1526487577, "post_id": 50375590, "comment_id": 87767654, "body": "If you are finding the filenames are not working, maybe you are just missing <code>.value</code> . <code>FileName1 = Range(&quot;B6&quot;).value</code>___you also missing quotes around the path name."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1526487671, "post_id": 50375590, "comment_id": 87767713, "body": "Move the <code>FileName1= ...</code> lines at the start, then change to <code>Path = &quot;D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\&quot; &amp; FileName1 &amp; &quot;\\&quot;</code> <code>ActiveWorkbook.SaveAs Filename:= Path &amp; FileName2 &amp; &quot;.xlsm&quot;, FileFormat:=xlOpenXMLWorkbookMacroEnabled</code> and it should work."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1526487840, "creation_date": 1526487840, "answer_id": 50375771, "question_id": 50375590, "link": "https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path/50375771#50375771", "title": "how to write a vba with a variable within the path", "body": "<p>The code runs line by line, you need to have the correct line first.</p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nFileName1 = Range(\"B6\").Value\nFileName2 = Range(\"A1\")\n Path = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 3, "last_activity_date": 1526489196, "last_edit_date": 1526489196, "creation_date": 1526487875, "answer_id": 50375778, "question_id": 50375590, "link": "https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path/50375778#50375778", "title": "how to write a vba with a variable within the path", "body": "<p>You dropped some ampersand signs, also you must assign the value of the variables before you use them:</p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nFileName1 = Range(\"B6\").Value\nFileName2 = Range(\"A1\").Value\n\nPath = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\"\n\nActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 1, "last_activity_date": 1526487891, "creation_date": 1526487891, "answer_id": 50375781, "question_id": 50375590, "link": "https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path/50375781#50375781", "title": "how to write a vba with a variable within the path", "body": "<p>This line is wrong:\n    Path = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\"FileName1\"\\</p>\n\n<p>... because it contains 3 \" marks. I'm not sure what your actual path is supposed to be, because path names within the operating system won't include \" characters anyway. However in a VBA string assignment, the string must be enclosed between only two \" characters:</p>\n\n<p>\"like this\"</p>\n\n<p>If you need to include the \" character literally within a string, then you must double up the quote. So for example to assign a string to a variable which reads 'This string contains a \" character', you would need to write:</p>\n\n<pre><code>Str = \"This string contains a \"\" character\"\n</code></pre>\n\n<p>Notice the doubling.</p>\n\n<p>Check your strings, and try again.</p>\n"}, {"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 6, "last_activity_date": 1526489407, "creation_date": 1526489407, "answer_id": 50376209, "question_id": 50375590, "link": "https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path/50376209#50376209", "title": "how to write a vba with a variable within the path", "body": "<p><strong>Answer to stated question</strong></p>\n\n<pre><code>Path = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\" \n</code></pre>\n\n<p>Also see <em><strong>additional feedback</strong></em> and <em><strong>corrected code</strong></em> for other feedback.</p>\n\n<hr>\n\n<p><strong>Long Explanation to Answer</strong></p>\n\n<p>When you have assign values to a string variable, the most commen way of doing so, is like this:</p>\n\n<pre><code>string = \"This is my string value.\"\n</code></pre>\n\n<p>However, you may often see in code with a fairly long string, syntax such as in the following code, to allow all the text to fit on the development screen without scrolling:</p>\n\n<pre><code>string = \"This is my really, really, really long string value. I am making this \" _\n    &amp; \"as long as I can, while also having something to write.\"\n</code></pre>\n\n<p>If you eliminated the <code>_</code>, and moved everything to one line, it would read like so:</p>\n\n<pre><code>string = \"This is my really, really, really long string value. I am making this \" &amp; \"as long as I can, while also having something to write.\"\n</code></pre>\n\n<p>Note that any string being assigned to a variable can be broken up in such a manner:</p>\n\n<pre><code>string = \"This is\" &amp; \" my \" &amp; \"string value.\"\n\n' Returns the same result as:\nstring = \"This is my string value.\"\n</code></pre>\n\n<p>Furthermore, if I have a string variable, <code>str_val = \" my \"</code>, I could then use substitution to write the above sample as:</p>\n\n<pre><code>string = \"This is\" &amp; str_val &amp; \"string value.\"\n</code></pre>\n\n<hr>\n\n<p><strong>Additional feedback</strong></p>\n\n<p>Currently, the order of your code (see <em><strong>original code</strong></em> below) is:</p>\n\n<ol>\n<li>Define variables</li>\n<li>Assign value to path</li>\n<li>Assign value to FileName1</li>\n<li>Assign value to FileName2</li>\n<li>Save File</li>\n</ol>\n\n<p>Unfortunately, this following this order means that at step 2), the value of <code>FileName1</code> is a null string, <code>\"\"</code>, as it hasn't been assigned a value yet.</p>\n\n<p>Therfore, the order you should be following is:</p>\n\n<ol>\n<li>Define variables</li>\n<li>Assign value to FileName1</li>\n<li>Assign value to FileName2</li>\n<li>Assign value to path</li>\n<li>Save File</li>\n</ol>\n\n<hr>\n\n<p><strong>Additional variables in string</strong></p>\n\n<p>There was an answer temporarily posted by @Davesexcel (then changed) which assumed that the <code>folder1</code> and <code>folder2</code> in your string were also variables. I attached <em><strong>alternative code</strong></em> for if that really is the case.</p>\n\n<hr>\n\n<p><strong>Original Code</strong></p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nPath = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\"FileName1\"\\\n\nFileName1 = Range(\"B6\")\nFileName2 = Range(\"A1\")\n\nActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n\n<hr>\n\n<p><strong>Corrected Code</strong></p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nFileName1 = Range(\"B6\")\nFileName2 = Range(\"A1\")\n\nPath = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\"    \n\nActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n\n<hr>\n\n<p><strong>Alternative Code</strong></p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nFileName1 = Range(\"B6\")\nFileName2 = Range(\"A1\")\n\nPath = \"D:\\\" &amp; folder1 &amp; \"\\\" &amp; folder2 &amp; \"\\Projects\\The FILES\\theFILES\\\" &amp; FileName1 &amp; \"\\\"    \n\nActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25208, "favorite_count": 0, "accepted_answer_id": 50376209, "answer_count": 4, "score": 3, "last_activity_date": 1526489407, "creation_date": 1526487147, "last_edit_date": 1526487485, "question_id": 50375590, "link": "https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path", "title": "how to write a vba with a variable within the path", "body": "<p>This is my second post on this site and an I am relatively new to VBA.</p>\n\n<p>My today question is,</p>\n\n<p>How can I add a cell value to the Path String to designate the folder where I would like the workbook to be saved. </p>\n\n<pre><code>Dim Path As String\nDim FileName1 As String\nDim FileName2 As String\n\nPath = \"D:\\folder1\\folder2\\Projects\\The FILES\\theFILES\\\"FileName1\"\\\n\nFileName1 = Range(\"B6\")\nFileName2 = Range(\"A1\")\n\nActiveWorkbook.SaveAs Filename:=Path &amp; FileName2 &amp; \".xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9687030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c300e21471c0e6db919a4d3974e8aba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9687030/john"}, "edited": false, "score": 0, "creation_date": 1526568944, "post_id": 50378063, "comment_id": 87804930, "body": "Thanks GMalc.  I added to the bottom of my question under May 18, 2018 as I can&#39;t enter too many characters in a reply.  Still not doing quite what we want it to do."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1526496529, "creation_date": 1526496529, "answer_id": 50378063, "question_id": 50375293, "link": "https://stackoverflow.com/questions/50375293/excel-conditional-formatting-row-background-skip-cells-with-existing-manual-for/50378063#50378063", "title": "Excel Conditional Formatting row background, skip cells with existing manual formatting", "body": "<p>Add an IF statement using <code>Not aCell</code>, you may have to change <code>vbMagenta</code> to the correct color.</p>\n\n<pre><code>For Each aCell In mySel\n    If Not aCell.Interior.Color = vbMagenta Then 'add this line\n         With aCell    \n           .Font.FontStyle = .DisplayFormat.Font.FontStyle\n           .Interior.Color = .DisplayFormat.Interior.Color\n           .Font.Strikethrough = .DisplayFormat.Font.Strikethrough\n           .Interior.Pattern = .DisplayFormat.Interior.Pattern\n         End With\n    End If  'add this line\nNext aCell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9687030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c300e21471c0e6db919a4d3974e8aba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9687030/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 470, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526568811, "creation_date": 1526486127, "last_edit_date": 1531161705, "question_id": 50375293, "link": "https://stackoverflow.com/questions/50375293/excel-conditional-formatting-row-background-skip-cells-with-existing-manual-for", "title": "Excel Conditional Formatting row background, skip cells with existing manual formatting", "body": "<p>I am looking to see if anyone has been able to apply conditional formatting to a row but skip cells that already have a background color.</p>\n\n<p>I have a spreadsheet that pulls data from an SQL database using Get &amp; Transform into tab 1.  </p>\n\n<p>That data is then merged with existing data from the Worksheet tab based on a common value.  I get both sets of data in the same column order &amp; then through a macro flag any where the new data has changed from the old (Worksheet) data by changing the background color to Purple.  I also make the font bold.</p>\n\n<p>This is done to visually flag that this cell value has changed since their last refresh of the data &amp; stand out.  This is done via conditional formatting where the new data &lt;> old data ( D2 &lt;> CQ2 then make bold purple). \nThis is coppied to a 3rd tab and then a marco step then runs through and sets the values to the displayed values.</p>\n\n<pre><code>For Each aCell In mySel\n         With aCell\n           .Font.FontStyle = .DisplayFormat.Font.FontStyle\n           .Interior.Color = .DisplayFormat.Interior.Color\n           .Font.Strikethrough = .DisplayFormat.Font.Strikethrough\n           .Interior.Pattern = .DisplayFormat.Interior.Pattern\n         End With\n     Next aCell\n</code></pre>\n\n<p>The existing worksheet data is then deleted &amp; replaced by the new data.  That all works just fine.</p>\n\n<p>On the Worksheet tab there is a cell where the user can enter a number &amp; through conditional formatting the entire row is changed to match the color set to that #. (IE 1 = Green, 2 = Yellow, 3 = Red, ...)</p>\n\n<p>So what happens if the row already has one of these settings (it does get copied over during the refresh process) is the entire row is now Green, Red, Yellow, ./.. but what was formatted as Purple has now been replaced by the row level conditional formatting.</p>\n\n<p>What we want to happen is to leave any individual cells formatted as purple and the rest of the row can be the selected color.</p>\n\n<p>Simply setting a row level indicator or flag that something has changed would not be sufficient as the data spans columns A - BV.</p>\n\n<p>For example here is code for if the color code choice is 1:</p>\n\n<pre><code>Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"A2:BV99999\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$BS2 = 1\"\n    Selection.FormatConditions       (Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0.399914548173467\n    End With\n</code></pre>\n\n<p>So basically I am looking to apply the above to all cells in the row range except for those that already have a background color set.</p>\n\n<p>It would be preferable to do this in the conditional formatting statement so if there is already a purple cell with no row level formatting, if the users then sets this that purple cell stays purple while the others change to the selected color.</p>\n\n<p>Is this even possible?</p>\n\n<h2>(guess I could maybe look cell by cell if it is bold &amp; remove conditional formatting &amp; re-format as Purple but that is slow for A3..BV1000 as an example)</h2>\n\n<p>May 17, 2018\nI simplified things a bit.  Where I need to apply what GMalc is suggesting is in the code for the row conditional formatting.\nI have tried:</p>\n\n<pre><code>Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"A2:BV99999\").Select\n   ' Range(\"BZ2\").Activate\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$BS2 = 6\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    If Not Selection.Interior.Color = 153164535 Then 'have also tried vbLavender\n    With Selection.FormatConditions(1).Interior\n      '  .PatternColorIndex = 0\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = -0.249946592608417\n      '  .PatternTintAndShade = 0\n    End With\n    End If\n</code></pre>\n\n<p>The entire row is still formatted as light grey.  If I delete the 6 in column BS the Lavender background appears.  I have tried changing the IF NOT to just IF and still formats entire row even if there is no coloring in the cell.</p>\n\n<p>So this is really where I need to make the magic happen, color all cells in the row to the desired color unless it is Lavender then don't change that cells background color.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": false, "score": 0, "last_activity_date": 1526486236, "creation_date": 1526486236, "answer_id": 50375326, "question_id": 50375241, "link": "https://stackoverflow.com/questions/50375241/assigning-a-value-from-an-ms-access-table-to-a-variable/50375326#50375326", "title": "Assigning a Value from an MS Access Table to a Variable", "body": "<p>There are probably dozens of options for what you're asking. Without knowing more about the structure of your data, this is one possibility:</p>\n\n<pre><code>VarOutPut = DLookup(\"StCurr\", \"CurrentSt\")\n</code></pre>\n\n<p>This assumes there is only one value / row in your table.</p>\n\n<p>Otherwise, you will need another method.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 7768666, "user_type": "registered", "profile_image": "https://graph.facebook.com/3529176673094/picture?type=large", "display_name": "Brian K. Burge", "link": "https://stackoverflow.com/users/7768666/brian-k-burge"}, "is_accepted": false, "score": 0, "last_activity_date": 1526486353, "creation_date": 1526486353, "answer_id": 50375351, "question_id": 50375241, "link": "https://stackoverflow.com/questions/50375241/assigning-a-value-from-an-ms-access-table-to-a-variable/50375351#50375351", "title": "Assigning a Value from an MS Access Table to a Variable", "body": "<p>CurrentSt has to have a reference to a specific table.   you can lookup values using the DLookup function </p>\n\n<pre><code>varoutput=DLookup(\"StCurr\",\"CurrentSt\",[Any criteria]) as [Type]\n</code></pre>\n\n<p>it would really be helpful to see all of your code.</p>\n"}], "owner": {"reputation": 21, "user_id": 9801199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e5845c6db13ca874fe3112ff4dbe58?s=128&d=identicon&r=PG&f=1", "display_name": "vfreeman", "link": "https://stackoverflow.com/users/9801199/vfreeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 982, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1594634824, "creation_date": 1526485944, "last_edit_date": 1594634824, "question_id": 50375241, "link": "https://stackoverflow.com/questions/50375241/assigning-a-value-from-an-ms-access-table-to-a-variable", "title": "Assigning a Value from an MS Access Table to a Variable", "body": "<p>I'm attempting something that I believe should be very simple but it does not work.  I've got a repeater macro in MS Access that I want to use to output a set of data to a series of files.  I'm pulling the current record from my Table CurrentSt, field StCurr.  There is only 1 record in this table</p>\n\n<p>In order to include StCurr in the name of the output, I'm doing the following:</p>\n\n<pre><code> Dim VarOutPut As String\n VarOutPut = CurrentSt.StCurr\n</code></pre>\n\n<p>I'm then calling VarOutPut in my export command.  This works when I set VarOutPut to a fixed number (e.g. VarOutPut = \"1000\") but when I try to call the value from the CurrentSt table I get an \"Object Required\" error.</p>\n\n<p>Any guidance would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1526485379, "post_id": 50375044, "comment_id": 87766375, "body": "<code>iserror</code> may be of assistance"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1526485782, "post_id": 50375044, "comment_id": 87766622, "body": "Seems to me this is an XY problem. You&#39;re jumping through hoops to solve Y (the #VALUE/___ issue) caused by not handling the X (TRIM) situation correctly. Are the <i>words</i> in the cell separated by <code>&#47;</code>? If so, then instead of jumping directly to calling TRIM, use InStr first to see if the separator exists, and do one thing if it does and something else if it does not. That removes #VALUE from being an issue at all."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1526487047, "post_id": 50375044, "comment_id": 87767382, "body": "Why do <code>REPT(&quot; &quot;,255)</code> if you&#39;re going to <code>TRIM</code> the result anyway?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1526487888, "post_id": 50375044, "comment_id": 87767827, "body": "Ultimately, if you are looking to get a particular word separated by some delimiter character it&#39;s much more efficient in vba to just do something like <code>myWord = Split(Range(&quot;A1&quot;), &quot;&#47;&quot;)(0)</code> That (0) tells it to return the first word, the second word would be <code>(1)</code>. This way you don&#39;t have to rely on really ugly formulas and all the processing that comes with it. Perhaps if you could share some sample data and your desired results we could help with a rewrite that isn&#39;t so cumbersome."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1526488793, "last_edit_date": 1526488793, "creation_date": 1526487658, "answer_id": 50375714, "question_id": 50375044, "link": "https://stackoverflow.com/questions/50375044/why-is-my-if-statement-returning-value/50375714#50375714", "title": "Why is my If statement returning #VALUE?", "body": "<h3>Formula</h3>\n\n<p>Not sure why you need to treat a series of underscores as a blank value when <code>vbNullString</code> or <code>\"\"</code> would normally do a much cleaner job; assuming we're stuck with these underscores, I'd start by eliminating them with <code>SUBSTITUTE(&lt;range&gt;,\"_\",\"\")</code>, and work off that - if the cell only contained underscores, the result of that function would be an empty string.</p>\n\n<p>So a predicate like <code>LEN(SUBSTITUTE(&lt;range&gt;,\"_\",\"\"))=0</code> would tell us if we're looking at a <code>&lt;range&gt;</code> that needs to be considered as empty.</p>\n\n<p>Therefore <code>IF(LEN(SUBSTITUTE(&lt;range&gt;,\"_\",\"\"))=0, &lt;value if empty&gt;, &lt;value if not empty&gt;)</code> would be a \"skeleton\" formula to build on IMO, unless I'm missing something (which is rather likely).</p>\n\n<hr>\n\n<h3>#VALUE!</h3>\n\n<p>A <code>#VALUE!</code> cell error isn't a string that says <code>\"#VALUE!\"</code> - it's an <em>error</em>, of type <code>Error</code>, and these can't be compared to a <code>String</code> literal (or anything for that matter).</p>\n\n<p>So this statement is guaranteed to throw a <em>type mismatch</em> error if the cell actually contains an error:</p>\n\n<pre><code>If Cells(i + 2, 10) = \"#VALUE!\" Then\n</code></pre>\n\n<p>Which means you must have <code>On Error Resume Next</code> at the top of that snippet, which means your code is effectively ignoring run-time errors and happily running along in an error state - that's quite likely why the statements execute unconditionally.</p>\n\n<p>Proof:</p>\n\n<pre><code>Sub test()\n    On Error Resume Next\n    If 12 / 0 &gt; 1 And False Then ' throws error 11 \"division by zero\"\n        Debug.Print \"And False was ignored!\" 'runs unconditionally\n    End If\nEnd Sub\n</code></pre>\n\n<p>Remove <code>On Error Resume Next</code>, it's not helping.</p>\n\n<p>What you want is to verify whether the cell contains an error - use the <code>IsError</code> function for that:</p>\n\n<pre><code>If IsError(Cells(i + 2, 10)) Then\n</code></pre>\n\n<p>If you need to check <em>specifically</em> for <code>#VALUE!</code> error, you can do it like this:</p>\n\n<pre><code>If Cells(i + 2, 10).Value = CVErr(xlErrValue) Then\n</code></pre>\n\n<p>However that's kind of moot, because the <code>#VALUE!</code> error comes from the formula you've put in - use the <code>IFERROR</code> Excel function in your formula to provide a value in case of error:</p>\n\n<pre><code>=IFERROR(&lt;formula&gt;, &lt;value to return formula results in an error&gt;)\n</code></pre>\n\n<p>You could have your fallback value right there.</p>\n\n<hr>\n\n<p>That said <code>String(n, \"_\")</code> would give you a string with <code>n</code> underscores. That would probably be much easier to debug than dealing with a string literal that <em>literally</em> has the <code>n</code> underscores in it. Much easier to do <code>String(80,\"_\")</code> than actually count the underscores and risk accidentally having 79 or 81.</p>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526504934, "creation_date": 1526504934, "answer_id": 50379915, "question_id": 50375044, "link": "https://stackoverflow.com/questions/50375044/why-is-my-if-statement-returning-value/50379915#50379915", "title": "Why is my If statement returning #VALUE?", "body": "<p>Instead of putting a formula in a cell by VBA, I would do this formula-work in your procedure itself.</p>\n\n<pre><code>With Cells(i + 2, 10)\n    If InStr(.Offset(, 10).Value, \"/\") &gt; 0 Then\n       wrds = Split(Split(.Offset(, 10), \"/\")(0), \" \")\n       .Value = wrds(UBound(wrds))\n    Else\n      .Value = .Offset(, 10).Value 'or \"\"\n    End If\nEnd With  \n</code></pre>\n\n<p>I assume these underscores are already eliminated</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526504934, "creation_date": 1526485269, "last_edit_date": 1531164843, "question_id": 50375044, "link": "https://stackoverflow.com/questions/50375044/why-is-my-if-statement-returning-value", "title": "Why is my If statement returning #VALUE?", "body": "<p>I have a portion of code that trims a word from a cell that may contain multiple words. It then places this single word into another cell. Sometimes the cell which contains multiple words contains only one word, so when it trims, I get #VALUE! returned in the cell. </p>\n\n<p>I will get the same returned value if it tried to trim a blank space which in this case is \"_______________\". It evaluates the cell looking for #VALUE!, and if it exists, checks the cell containing multiple words to see if the reason is because it is blank \"________________\" or is a single word. </p>\n\n<p>I have used this code below to accomplish this but it is now ignoring the AND portion of the code and immediately performs the action if the cell reads #VALUE! regardless of the second condition. </p>\n\n<p>Does anyone know what may cause this?</p>\n\n<pre><code>'Trims the full name\n    Cells(i + 2, 10).FormulaR1C1 = _\n        \"=TRIM(RIGHT(SUBSTITUTE(REPLACE(RC[10],FIND(\"\"/\"\",RC[10])-0,LEN(RC[10]),\"\"\"\"),\"\" \"\",REPT(\"\" \"\",255)),255))\"\n\n    'Replaces Error with a blank ***Sometimes there are no defect 2 defects which causes this error\nIf Cells(i + 2, 10) = \"#VALUE!\" And Cells(i + 2, 20) = \"________________________________________________________________________________\" Then\nCells(i + 2, 10) = \"\"\nElse\nEnd If\n\n'Replaces Error with a blank ***Sometimes there are no defect 3 which causes this error\nIf Cells(i + 2, 10) = \"#VALUE!\" Then\nCells(i + 2, 10) = Cells(i + 2, 20)\nElse\nEnd If \n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "automation"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1526485966, "creation_date": 1526485966, "answer_id": 50375246, "question_id": 50374878, "link": "https://stackoverflow.com/questions/50374878/have-excel-auto-populate-column-headings-in-blank-rows-vba/50375246#50375246", "title": "Have Excel Auto Populate Column Headings in Blank Rows (VBA?)", "body": "<p>Something like this is what you're looking for:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rHeaders As Range\n    Dim rDest As Range\n    Dim ACell As Range\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rHeaders = ws.Range(\"A1:F1\")\n\n    For Each ACell In ws.Range(\"A1\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp)).Cells\n        If Len(Trim(ACell.Value)) = 0 Then\n            If Not rDest Is Nothing Then\n                Set rDest = Union(rDest, ACell)\n            Else\n                Set rDest = ACell\n            End If\n        End If\n    Next ACell\n\n    If Not rDest Is Nothing Then rHeaders.Copy rDest\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526491288, "post_id": 50375261, "comment_id": 87769603, "body": "Please, expand your images with <code>![MyImage](IMAGE_URL)</code>? Learn as you go! :)"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526492090, "post_id": 50375261, "comment_id": 87770019, "body": "done but maybe I need to be more judicious with images then, I don&#39;t want to force people to scroll past a ton of photos. tyvm for information though Johnny"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526492208, "post_id": 50375261, "comment_id": 87770109, "body": "Don&#39;t worry - this is <i>much</i> informative than opening three tabs :)"}, {"owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 0, "creation_date": 1526663674, "post_id": 50375261, "comment_id": 87848185, "body": "@learnAsWeGo this is really great, thanks so much. Is there any way to have this run automatically, or is a keyboard shortcut the only way? Ideally what I&#39;d like to have happen is that as soon as someone entered the program on row 10, the headings would automatically populate across row 9 (or whichever row it happened to be)."}, {"owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "edited": false, "score": 1, "creation_date": 1526670384, "post_id": 50375261, "comment_id": 87851199, "body": "@learnAsWeGo I actually did a little more research and figured out a worksheet change event that runs your program whenever data is entered in a cell in column A. Thank you for your help and thorough explanation, it was immensely helpful."}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 0, "last_activity_date": 1526492057, "last_edit_date": 1526492057, "creation_date": 1526486024, "answer_id": 50375261, "question_id": 50374878, "link": "https://stackoverflow.com/questions/50374878/have-excel-auto-populate-column-headings-in-blank-rows-vba/50375261#50375261", "title": "Have Excel Auto Populate Column Headings in Blank Rows (VBA?)", "body": "<p>This code should work:</p>\n\n<p>see before: </p>\n\n<p><img src=\"https://i.stack.imgur.com/Apxli.png\" alt=\"MyImage\"></p>\n\n<p>and after: </p>\n\n<p><img src=\"https://i.stack.imgur.com/LSUQU.png\" alt=\"MyImage\"></p>\n\n<pre><code>Sub addHeaders()\n\nDim ws As Worksheet\n    Set ws = Sheets(\"Sheet3\")\n\nDim lastRow As Integer\n    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nDim header As Range\n    Set header = ws.Range(\"A1:F1\")\n\nFor rowNum = 2 To lastRow\n    If ws.Cells(rowNum, 1) = \"\" Then\n        If ws.Cells(rowNum + 1, 1) &lt;&gt; \"\" Then\n             ws.Range(\"A\" &amp; rowNum &amp; \":F\" &amp; rowNum) = header.Value\n         End If\n     End If\nNext rowNum\nEnd Sub\n</code></pre>\n\n<p>Since you said you are new to vba here is quick quick intro to how to run a program:</p>\n\n<ol>\n<li><p><img src=\"https://i.stack.imgur.com/hoMrI.png\" alt=\"MyImage\"></p></li>\n<li><p><img src=\"https://i.stack.imgur.com/U73js.png\" alt=\"MyImage\"></p></li>\n<li><p><img src=\"https://i.stack.imgur.com/NKOtV.png\" alt=\"MyImage\"></p></li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 8126609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ad4ef393302e7fa763db3fa8c27430?s=128&d=identicon&r=PG&f=1", "display_name": "SeedySea", "link": "https://stackoverflow.com/users/8126609/seedysea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50375261, "answer_count": 2, "score": 1, "last_activity_date": 1526492057, "creation_date": 1526484746, "question_id": 50374878, "link": "https://stackoverflow.com/questions/50374878/have-excel-auto-populate-column-headings-in-blank-rows-vba", "title": "Have Excel Auto Populate Column Headings in Blank Rows (VBA?)", "body": "<p>I have a spreadsheet that looks something like this:</p>\n\n<pre><code>             A       B       C       D       E       F       \n    1     Program  Year    Cycle   Date    Panel  Mtg Rep\n    2       AAA    2019      1     5/21     ABA     Tom\n    3       AAA    2019      1     5/23     ABB     Erin\n    4\n    5       BBB    2019      2     6/4      BAB     Jim\n    6\n    7       CCC    2019      3     7/16     CAB     Tom\n    8       CCC    2019      4     8/27     CBB     Kate\n    9\n    10\n</code></pre>\n\n<p>What I'm trying to have it do is, every time a row is skipped, that blank row will automatically be populated with the column headings. So in the example table above, rows 4 and 6 would contain the column headings, while row 9 would remain blank until information was entered on row 10. I've done every possible search I can think of, and haven't found anything that seems applicable. I'm not very familiar with VBA, so I came up with the following series of formulas:</p>\n\n<pre><code>A3) =IF(AND($A2&lt;&gt;\"\",$A4&lt;&gt;\"\",$A2&lt;&gt;$A$1),$A$1,\"\")\nB3) =IF(A3=A$1,B$1,\"\")\nC3) =IF(B3=B$1,C$1,\"\")\nD3) =IF(C3=C$1,D$1,\"\")\nE3) =IF(D3=D$1,E$1,\"\")\nF3) =IF(E3=E$1,F$1,\"\")\n</code></pre>\n\n<p>These formulas are then extended to the rest of the sheet. This does what I want it to do, but it also fills 8,000+ cells with formulas, including circular references. Which, aside from having to deal with being alerted to the circular references, they also affect other aspects of my sheet, such as conditional formatting, identifying duplicate entries, etc. </p>\n\n<p>As I stated, I'm not really very familiar with VBA, so I don't even know if this is doable using VBA. But if there is some way to achieve the same result without formulas, or at least without circular references, that is what I'm looking for. Thanks so much for any assistance. </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "edited": false, "score": 0, "creation_date": 1526484747, "post_id": 50374800, "comment_id": 87765982, "body": "I think you are looking for the INDIRECT function"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9801028, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AGOHpkP5vmc/AAAAAAAAAAI/AAAAAAAAABg/My05biojmHU/photo.jpg?sz=128", "display_name": "HiTechObsessed", "link": "https://stackoverflow.com/users/9801028/hitechobsessed"}, "edited": false, "score": 0, "creation_date": 1526486421, "post_id": 50375047, "comment_id": 87767025, "body": "Yes, that works perfectly, thank you!  I found the indirect function when searching but apparently can&#39;t read documentation correctly and couldn&#39;t get it to work, so I assumed it was the wrong formula and not human error lol  Thanks again."}], "tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": true, "score": 0, "last_activity_date": 1526485282, "creation_date": 1526485282, "answer_id": 50375047, "question_id": 50374800, "link": "https://stackoverflow.com/questions/50374800/how-to-reference-a-cell-in-excel-using-a-user-input-number/50375047#50375047", "title": "How to reference a Cell in Excel using a User-Input Number", "body": "<p>I put current level in cell <code>E1</code> and desired level in <code>E2</code> The following formula will pull the values out of the Experience Needed column and subtract them. Is that what you are looking for?</p>\n\n<pre><code>=INDIRECT(\"B\"&amp;E2+1)-INDIRECT(\"B\"&amp;E1+1)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9801028, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AGOHpkP5vmc/AAAAAAAAAAI/AAAAAAAAABg/My05biojmHU/photo.jpg?sz=128", "display_name": "HiTechObsessed", "link": "https://stackoverflow.com/users/9801028/hitechobsessed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 50375047, "answer_count": 1, "score": 0, "last_activity_date": 1526485282, "creation_date": 1526484424, "last_edit_date": 1531161705, "question_id": 50374800, "link": "https://stackoverflow.com/questions/50374800/how-to-reference-a-cell-in-excel-using-a-user-input-number", "title": "How to reference a Cell in Excel using a User-Input Number", "body": "<p>I'm an intermediate Excel user, so you can assume I know the basics. I've got a table for a game that contains the level, and the experience required to get to that level from level 1. Basically I have the below:</p>\n\n<p>Col A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Col B<br>\nLevel &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Experience Needed<br>\n1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>\n2. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10<br>\n3. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;58<br>\n4. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;160<br>\n5. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;329<br>\n...<br>\n79. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;551,002<br>\n80. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;568,832</p>\n\n<p>I was trying to make a simple UI in the cells themselves where you can just input your current level, input the level you want to get to, and have a formula calculate (essentially just the exp. required for the level you want minus the experience required to get to the current level)</p>\n\n<p>I've searched and cannot find anything that will help me here. I'm sure there's a way (and probably a stupidly easy one) to do what I'm trying to do, but I am at a loss. </p>\n\n<p>What I pictured in my head was something that just took the number input and put that to the cell reference (eg. input 44 and it would then reference B44)</p>\n\n<p>I was hoping for something in-cell, but if it needs to be code in VisualBasic I can get over it (just not really comfortable programming!)</p>\n\n<p>Thanks in advance for the help!</p>\n\n<p>Edit: Can either be in Excel or Google Sheets, not sure if either is easier/harder than the other.</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1526484516, "post_id": 50374705, "comment_id": 87765816, "body": "Instead of Openrecordset try OpenQuery. If that doesnt work, you can open the query in Edit mode, look at the SQL view and build/use the SQL instead on VBA Excel."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526484608, "post_id": 50374705, "comment_id": 87765889, "body": "Does Query2 create the table &quot;TableName&quot;?  Maybe that is the logic why odd&#39;s fail?"}, {"owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526484704, "post_id": 50374705, "comment_id": 87765949, "body": "Yes Query2 does create &quot;TableName&quot; but I am not sure thats a problem because I am deleting the table first if it exists?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1526484811, "post_id": 50374705, "comment_id": 87766014, "body": "What line gives you the error?"}, {"owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526484912, "post_id": 50374705, "comment_id": 87766086, "body": "I get the error on line &#39;CurrentDb.Openrecordset (&quot;QUERY1&quot;)&#39;"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1526485121, "post_id": 50374705, "comment_id": 87766205, "body": "Generally speaking, recordsets are not opened in that manner. <code>Set rs1 = CurrentDb.OpenRecordset(&quot;Query1&quot;)</code> after <code>Dim rs1 As Recordset</code> (or something similiar to that)... also, it should be noted that opening a recordset without any action doesn&#39;t really do anything."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526485223, "post_id": 50374705, "comment_id": 87766269, "body": "where do you define currentdb?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526545239, "post_id": 50376592, "comment_id": 87788711, "body": "Hi Parfait, I think I need to open the Access Gui and run the queries because the 2nd query creates a table in access so I then want to close access so the file is now saved with the new table in it or can I do this without opening Access? Also I tried removing the &#39;on error resume next&#39; line and added in your loop for finding if the table exists. This does work but frustratingly I get the same problem where I run the code for a 2nd time and getting the same runtime error :("}, {"owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526545673, "post_id": 50376592, "comment_id": 87788982, "body": "I should mention the 2nd time I run the code it errors at db.Visible = True"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526567781, "post_id": 50376592, "comment_id": 87804069, "body": "<code>CREATE TABLE</code>...<code>SELECT * INTO</code> are SQL - DDL commands so you do not need the GUI .exe. MS Access is a unique software being both a backend and frontend. Only when working with frontend application items like forms/reports/macros/modules do you need the GUI."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "edited": false, "score": 0, "creation_date": 1526567865, "post_id": 50376592, "comment_id": 87804132, "body": "See edit using proper error handling as advised, never use <code>On Error Resume Next</code>. Then, check the pop-up error message to properly see the issue to be handled."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1526567771, "last_edit_date": 1526567771, "creation_date": 1526490815, "answer_id": 50376592, "question_id": 50374705, "link": "https://stackoverflow.com/questions/50374705/run-access-queries-from-excel-vba/50376592#50376592", "title": "Run Access Queries from Excel VBA", "body": "<p>Likely the every two click error is due to opening the table that was just deleted where every other time it exists. Consider iterating through MS Access's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820997.aspx\" rel=\"nofollow noreferrer\">TableDefs</a> collection to conditionally delete the object if it exists. Then, re-order your action query to run before <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow noreferrer\">OpenRecordset</a> call. </p>\n\n<pre><code>Public Sub RunQueries()\nOn Error Goto ErrHandle:\n    ' DAO REQUIRES REFERENCE TO Microsoft Office X.X Access Database Engine Object Library\n    Dim tbl As DAO.TableDef     \n    Dim rs As DAO.Recordset\n    Dim db As New Access.Application\n\n    db.Visible = False                   ' KEEP DATABASE RUNNING IN BACKGROUND\n\n    For Each tbl in db.CurrentDb.TableDefs\n        If tbl.Name = \"TableName\" Then\n            db.DoCmd.DeleteObject acTable, \"TableName\"\n        End If\n    Next tbl\n\n    ' ASSUMED AN ACTION QUERY\n    db.CurrentDb.Execute \"QUERY2\", dbFailOnError\n\n    ' ASSUMED A SELECT QUERY BUT CALL BELOW IS REDUNDANT AS IT IS NEVER USED\n    Set rs = db.CurrentDb.OpenRecordset(\"QUERY1\")   \n\nExitHandle:\n    ' FREE RESOURCES\n    Set rst = Nothing: Set conn = Nothing\n    db.CloseCurrentDatabase\n    db.Quit\n    Set db = Nothing\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    Resume ExitHandle\nEnd Sub\n</code></pre>\n\n<p>Aside - Avoid ever using <code>On Error Resume Next</code> in VBA. Always proactively anticipate and handle exceptions.</p>\n\n<hr>\n\n<p>Alternatively, instead of using the make-table command <code>SELECT * INTO</code> and then having to worry about deleting the table programmatically, simple create your table <strong>once</strong> and then use <code>DELETE</code> and <code>INSERT</code> which can be run each time. Of course this assumes the table's structure (fields/types) remain the same.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>DELETE FROM myTable;\n\nINSERT INTO myTable (Col1, Col2, Col3) \nSELECT Col1, Col2, Col3 FROM myOtherTable;\n\nSELECT * FROM myTable;\n</code></pre>\n\n<hr>\n\n<p>Finally, there is no reason to even use the MS Access object library to open/close the .GUI just to run queries. Since Access is a database, connect to it like any other backend (i.e., SQLite, Postgres, Oracle) and run your queries from there. Below is an ODBC connection example which the driver can easily be swapped for drivers of other RBDMS's. </p>\n\n<pre><code>Dim conn As Object, rst As Object\n\nSet conn = CreateObject(\"ADODB.Connection\")\nSet rst = CreateObject(\"ADODB.Recordset\")\n\n' OPEN CONNECTION\nconn.Open \"DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};\" _\n            &amp; \"DBQ=C:\\Path\\To\\Access\\DB.accdb;\"\n\n' RUN ACTION QUERIES\nconn.Execute \"DELETE FROM myTable\"\nconn.Execute \"INSERT INTO myTable (Col1, Col2, Col3)\" _\n               &amp; \" SELECT Col1, Col2, Col3 FROM myOtherTable\"\n\n' OPEN RECORDSET\nrst.Open \"SELECT * FROM myQuery\", conn\n\n' OUTPUT TO WORKSHEET\nWorksheets(\"DATA\").Range(\"A1\").CopyFromRecordset rst\nrst.Close\n</code></pre>\n\n<p>In fact, the above approach does not even require MS Access GUI .exe installed! Also, be sure to save the <code>SELECT</code> query (even one inside <code>INSERT</code>) inside Access and not run as a VBA SQL string since the Access engine will save the best execution plan for stored queries.</p>\n"}, {"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1526568170, "post_id": 50390839, "comment_id": 87804351, "body": "Usually, posted solutions will never be exactly as you need. OPs will often need to make adjustments. The only real difference here is using the OLEDB Provider instead of ODBC Driver. Finally, in this code you do not ever use <i>rst</i>, so remove its <code>set</code> and <code>.Open</code> lines and just run the action queries."}], "tags": [], "owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "is_accepted": false, "score": 0, "last_activity_date": 1526558125, "creation_date": 1526558125, "answer_id": 50390839, "question_id": 50374705, "link": "https://stackoverflow.com/questions/50374705/run-access-queries-from-excel-vba/50390839#50390839", "title": "Run Access Queries from Excel VBA", "body": "<p>I managed to get it to work with Parfait's method. Here is what I have got.</p>\n\n<pre><code>Sub QueryAccess1()\n\nDim conn As Object, rst As Object\nDim path As String\n\n\nSet conn = CreateObject(\"ADODB.Connection\")\nSet rst = CreateObject(\"ADODB.Recordset\")\n\npath = Sheets(\"SheetName\").Range(\"A1\")\n\n'OPEN CONNECTION\nconn.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; path\n\n'DELETES TABLE CONTENTS\nconn.Execute \"DELETE FROM [Table1]\"\n\n'RUN UNION QUERY AND INSERT INTO TABLE\nrst.Open \"SELECT * FROM [Query1]\", conn\nconn.Execute \"INSERT INTO [Table1]  select * from [QUERY1] \"\n\nSet rst = Nothing: Set conn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9800983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68c9cab68107e1b7c6132cea19da9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Hunderfert", "link": "https://stackoverflow.com/users/9800983/hunderfert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4398, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1526567771, "creation_date": 1526484138, "last_edit_date": 1531164843, "question_id": 50374705, "link": "https://stackoverflow.com/questions/50374705/run-access-queries-from-excel-vba", "title": "Run Access Queries from Excel VBA", "body": "<p>I am trying to write a macro in excel vba that simply opens an access database and runs 2 queries in access. It seems to work and run the queries every 2 clicks of the macro button. What I mean is I click it, it works, the 2nd click I get a 'runtime error 462' on the second click, the third click it works, the fourth click I get the error again and so on. I can't seem to figure out why this is. Here is the code below.</p>\n\n<pre><code>Sub QueryAccess1()\n\nDim db As Access.Application\nSet db = New Access.Application\n'set variables\n\ndb.Visible = True\n\ndb.OpenCurrentDatabase (\"DatabaseFileName\")\n'open database\n\n'--------------------------------------------------------------\nOn Error Resume Next\n\ndb.DoCmd.DeleteObject acTable, \"TableName\"\n'if the table does not exist it skips this line\n'--------------------------------------------------------------\n\nOn Error GoTo 0\n'sets the error back to normal\n\n'--------------------------------------------------------------\nCurrentDb.Openrecordset (\"QUERY1\")\nCurrentDb.Execute (\"QUERY2\")\n'Calls the queries\n'--------------------------------------------------------------\n\n'--------------------------------------------------------------\ndb.CloseCurrentDatabase\ndb.Quit\n'Closes Access\n'--------------------------------------------------------------\n\nSet db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>When I get the error I am getting it on the line </p>\n\n<pre><code>CurrentDb.Openrecordset (\"QUERY1\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9204737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab51102b9336a5764ea0c846bf968fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil \u015awi\u0119ch", "link": "https://stackoverflow.com/users/9204737/kamil-%c5%9awi%c4%99ch"}, "edited": false, "score": 1, "creation_date": 1526484582, "post_id": 50374680, "comment_id": 87765866, "body": "Thanks for resolving the second problem. I have to learn to read :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 9204737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab51102b9336a5764ea0c846bf968fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil \u015awi\u0119ch", "link": "https://stackoverflow.com/users/9204737/kamil-%c5%9awi%c4%99ch"}, "edited": false, "score": 0, "creation_date": 1526484880, "post_id": 50374680, "comment_id": 87766065, "body": "@Kamil\u015awi\u0119ch - You are welcome. What about the first one?"}, {"owner": {"reputation": 25, "user_id": 9204737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab51102b9336a5764ea0c846bf968fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil \u015awi\u0119ch", "link": "https://stackoverflow.com/users/9204737/kamil-%c5%9awi%c4%99ch"}, "edited": false, "score": 1, "creation_date": 1526485465, "post_id": 50374680, "comment_id": 87766425, "body": "I have used solution from comment. Now your comment fully resolves my posted problems ^^"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1526484484, "last_edit_date": 1526484484, "creation_date": 1526484097, "answer_id": 50374680, "question_id": 50374617, "link": "https://stackoverflow.com/questions/50374617/unable-to-run-macro-from-application-onkey/50374680#50374680", "title": "Unable to run macro from Application.Onkey", "body": "<p>To make your code running, move <code>Sub Test1</code> and <code>abc</code> to a module. </p>\n\n<p>Then if you have 2 <kbd>Enter</kbd> keys on your keyboard, press the one on the numeric keypad (the smaller one) and your code should work. To use the big one, use <code>~</code> like this:</p>\n\n<pre><code>Sub Test1()\n    Application.OnKey \"{ENTER}\", \"abc\"  'The small one\n    Application.OnKey \"~\", \"abc\"        'The huge one\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-onkey-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Application.OnKey MSDN</a></p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 9204737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab51102b9336a5764ea0c846bf968fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil \u015awi\u0119ch", "link": "https://stackoverflow.com/users/9204737/kamil-%c5%9awi%c4%99ch"}, "edited": false, "score": 0, "creation_date": 1526484669, "post_id": 50374697, "comment_id": 87765933, "body": "Thanks for resolving main problem. I have also tried to put the whole code in Module but with the same result."}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1526484128, "creation_date": 1526484128, "answer_id": 50374697, "question_id": 50374617, "link": "https://stackoverflow.com/questions/50374617/unable-to-run-macro-from-application-onkey/50374697#50374697", "title": "Unable to run macro from Application.Onkey", "body": "<p>I assume your macro <code>abc()</code> is in \"Ten_skoroszyt\" (\"ThisWorkbook\") module, it should be transfered to separate (new) module.</p>\n"}], "owner": {"reputation": 25, "user_id": 9204737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab51102b9336a5764ea0c846bf968fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil \u015awi\u0119ch", "link": "https://stackoverflow.com/users/9204737/kamil-%c5%9awi%c4%99ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 50374680, "answer_count": 2, "score": 1, "last_activity_date": 1526484484, "creation_date": 1526483929, "question_id": 50374617, "link": "https://stackoverflow.com/questions/50374617/unable-to-run-macro-from-application-onkey", "title": "Unable to run macro from Application.Onkey", "body": "<p>I am unable to run macro from Application.Onkey option. The following message is displayed upon pressing TAB key: \"Cannot run the macro \"C:\\...\\Desktop\\test.xlsm!abc'. The macro may not be available in this workbook or all macros may be disabled.\"</p>\n\n<p>However, upon pressing Enter key, selection goes 1 row below (as it always does) instead of running the same macro.</p>\n\n<p>I have enabled all macros from Trust Settings and checked \"Trust access to the VBA project object model\". The file have been saved with xlsm extension.\nAll of the following macros are in thisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Test1\nEnd Sub\n\nSub Test1()\n    Application.OnKey \"{TAB}\", \"abc\"\n    Application.OnKey \"{ENTER}\", \"abc\"\nEnd Sub\n\nSub abc()\n    MsgBox \"TAB\"\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me with this one?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1526483630, "post_id": 50374395, "comment_id": 87765203, "body": "\u2460 Do you get any errors? If so which and where? \u2461 Why did you comment out all your <code>Dim</code> it would be a good idea to use them."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1526484235, "post_id": 50374395, "comment_id": 87765629, "body": "I would put a code break onto the <code>xRg.Cells(I).EntireRow.Cut</code> portion to see if you&#39;re actually getting to the suspect spot.  Sometimes there are trailing blanks or wotnot."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1526484483, "post_id": 50374395, "comment_id": 87765795, "body": "Also with xRg you are selecting a column and then later you are using <code>xRg.Row</code>.  This is a confusing way to just add 1 since any column.row will always return 1."}], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": true, "score": 0, "last_activity_date": 1526484608, "creation_date": 1526484608, "answer_id": 50374840, "question_id": 50374395, "link": "https://stackoverflow.com/questions/50374395/simple-cut-and-paste-will-not-work/50374840#50374840", "title": "Simple cut and paste will not work", "body": "<p>Your problem is that you are trying to insert the rows into the last row of the sheet +1.  This is out of bounds.</p>\n\n<p>Instead of this:</p>\n\n<pre><code>Set xRg = Range(\"d:d\")\nxEndRow = xRg.Rows.Count + xRg.Row\n</code></pre>\n\n<p>Do this:</p>\n\n<pre><code>Set xRg = Range(\"d:d\")\nxEndRow = Range(\"d1\").End(xlDown).Row + 1\n</code></pre>\n\n<p>This way your just looking at populated cells instead of all possible cells.</p>\n\n<p><strong>Note</strong>\nI prefer using something like <code>xEndRow = Cells(Rows.Count, 1).End(xlUp).Row</code> because finding the last row from the top can sometimes be incorrect if the dataset isn't complete.  You may need to play with different approaches to determine what's best for your situation. </p>\n"}, {"comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1526485703, "post_id": 50375097, "comment_id": 87766569, "body": "Hey great answer that is exactly the same as mine <b>thumbs up bro</b>"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1526486158, "post_id": 50375097, "comment_id": 87766877, "body": "No problem. He is still using the last row of the sheet in the for loop by just applying your fix."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1526485418, "creation_date": 1526485418, "answer_id": 50375097, "question_id": 50374395, "link": "https://stackoverflow.com/questions/50374395/simple-cut-and-paste-will-not-work/50375097#50375097", "title": "Simple cut and paste will not work", "body": "<p>If i read this correctly, you want to find the value 1050 on Column D, if it is found you want this row Cut and Inserted at the end of the list.</p>\n\n<pre><code>Sub MurrayTest()\n    Dim xRg As Range\n    Dim xEndRow As Long\n    Dim i As Long\n\n    Set xRg = Range(\"D:D\")\n    xEndRow = Cells(Rows.Count, 4).End(Excel.xlUp).Row + xRg.Row\n\n    Application.ScreenUpdating = False\n    For i = xEndRow To 1 Step -1\n        If xRg.Cells(i) = \"1050\" Then\n           xRg.Cells(i).EntireRow.Cut\n           Rows(xEndRow).Insert Shift:=xlDown\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 50374840, "answer_count": 2, "score": 0, "last_activity_date": 1526485418, "creation_date": 1526483277, "last_edit_date": 1531164843, "question_id": 50374395, "link": "https://stackoverflow.com/questions/50374395/simple-cut-and-paste-will-not-work", "title": "Simple cut and paste will not work", "body": "<p>I have a simple macro that refuses to work.  It gets to the cut portion and surrounds the information with marching ants; and then...nothing. </p>\n\n<p>What I am trying to accomplish is to find a value (1050) in column D. Whenever I find it, I want to move the entire row of data to the bottom of the sheet.  </p>\n\n<p>The worksheet consists of thousands of lines of information and the number of rows changes every month. The columns are constant.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>Sub MurrayTest()\n    'Dim xRg As Range\n    'Dim xTxt As String\n    'Dim xCell As Range\n    'Dim xEndRow As Long\n    'Dim I As Long\n\n    On Error Resume Next\n\n    If ActiveWindow.RangeSelection.Count &gt; 1 Then\n      xTxt = ActiveWindow.RangeSelection.AddressLocal\n    Else\n      xTxt = ActiveSheet.UsedRange.AddressLocal\n    End If\n\n    Set xRg = Range(\"d:d\")\n    xEndRow = xRg.Rows.Count + xRg.Row\n\n    Application.ScreenUpdating = False\n\n    For I = xRg.Rows.Count To 1 Step -1\n        If xRg.Cells(I) = \"1050\" Then\n           xRg.Cells(I).EntireRow.Cut\n           Rows(xEndRow).Insert Shift:=xlDown\n        End If\n    Next\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Any assistance would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1526482350, "post_id": 50373943, "comment_id": 87764302, "body": "no need for the &quot; and it will be <code>set cht=</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1526482400, "post_id": 50373943, "comment_id": 87764342, "body": "Is <code>CopyPasteChartFull</code> a UDF? If so, where is the code for it?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1526482640, "post_id": 50373943, "comment_id": 87764510, "body": "If it was declared as <code>Dim cht As Chart</code> it should be something like <code>Set cht = ThisWorkbook.Worksheets(sH).ChartObjects(NameRange).Chart</code>"}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1526482800, "post_id": 50373943, "comment_id": 87764630, "body": "@dwirony CopyPasteChartFull is a function (its quite long so didnt want to post) where cht is declared as a chart"}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "edited": false, "score": 0, "creation_date": 1526482950, "post_id": 50373943, "comment_id": 87764744, "body": "@PEH that solution seems to give me a Run-time error &#39;9&#39;: subscript out of range at my set cht ="}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1526483086, "post_id": 50373943, "comment_id": 87764830, "body": "@TisButaScratch that means that either the sheet or the chartobject does not exist. Debug your code and check the values in <code>sH</code> and <code>NameRange</code> by going through step by step using F8."}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "edited": false, "score": 1, "creation_date": 1526483180, "post_id": 50373943, "comment_id": 87764898, "body": "Just got it working! it was because i was actually passing &quot;Forecast&quot; and not Forecast, hence it couldnt find the sheet. Thankyou everyone for your help"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1526491864, "post_id": 50373943, "comment_id": 87769906, "body": "What&#39;s the point of <code>Case &quot;chart&quot;, &quot;Chart&quot;</code>? Write <code>Option Compare Text</code> at the declaration section (the top of the module) - and you can just write <code>Case &quot;chart&quot;</code>."}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526548129, "post_id": 50373943, "comment_id": 87790586, "body": "@JohnyL thanks for the knowledge nugget, I didnt know you could do that!"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526550088, "post_id": 50373943, "comment_id": 87791957, "body": "You&#39;re welcome! :)"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527085779, "post_id": 50373943, "comment_id": 87994834, "body": "@JohnyL Alternatively, use <code>Select Case LCase$(ImageType)</code>."}], "owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526482518, "creation_date": 1526481927, "last_edit_date": 1531164843, "question_id": 50373943, "link": "https://stackoverflow.com/questions/50373943/vba-excel-combine-string-and-turn-into-chart-object", "title": "VBA Excel combine string and turn into chart object", "body": "<p>I am trying to build a function that cycles through a row of data, assign each cell to a variable before using these variables in a function to copy paste a graph or range. </p>\n\n<p>The issue I'm having is building the the Chart path as a combination of string variables, I can create the chart path as a string from my wb,sheet and chartName string variables, but I'm struggling to then make this into a chart object.</p>\n\n<p>Running the below code with <code>Dim cht as Chart</code> I get the error (1)</p>\n\n<blockquote>\n  <p>\"Run-time error '91': Object variable or with black variable not set\"</p>\n</blockquote>\n\n<p>when I Dim <code>cht as String</code> I get the error (2)</p>\n\n<blockquote>\n  <p>\"Compile error: ByRef argument type mismatch\"</p>\n</blockquote>\n\n<p>this is my code - I have commented error position</p>\n\n<pre><code>Sub RollingCode()\n\n    Dim height As Double\n    Dim weight As Double\n    Dim gender As String\n    Dim newWeight As Double\n    Dim ImageType As String\n    Dim wB As String\n    Dim sH As String\n    Dim NameRange As String\n    Dim Sld As Integer\n    Dim DataTyp As Integer\n    Dim TopPos As Integer\n    Dim LeftPos As Integer\n    Dim WidthPos As Integer\n    Dim HeightPos As Integer\n    Dim rng As Range\n    Dim cht As String 'WHEN CHART ERROR 1, WHEN STRING ERROR 2\n\n    'Open powerpoint\n    'Call Module2.OpenPowerpoint\n\n\n    Dim lastRow As Integer\n    lastRow = ThisWorkbook.Sheets(\"Graphs\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To lastRow\n\n        ImageType = Range(\"A\" &amp; i).Value\n        wB = Range(\"B\" &amp; i).Value\n        sH = Range(\"C\" &amp; i).Value\n        NameRange = Range(\"D\" &amp; i).Value\n        Sld = Range(\"E\" &amp; i).Value\n        DataTyp = Range(\"F\" &amp; i).Value\n        TopPos = Range(\"G\" &amp; i).Value\n        LeftPos = Range(\"H\" &amp; i).Value\n        WidthPos = Range(\"I\" &amp; i).Value\n        HeightPos = Range(\"J\" &amp; i).Value\n\n        If wB = \"Active\" Then\n            Select Case ImageType\n\n                   Case \"chart\", \"Chart\"\n\n                        cht = \"ThisWorkbook.Worksheets(\" &amp; sH &amp; \").ChartObjects(\" &amp; NameRange &amp; \").Chart\" 'ERROR 1 HERE\n\n                        'MsgBox cht\n                        CopyPasteChartFull Sld, cht, LeftPos, TopPos, WidthPos, HeightPos 'ERROR 2 HERE\n\n                   Case \"Range\", \"range\"\n                        MsgBox \"Range\"\n                   Case Else\n                        MsgBox \"Incorrect\"\n                   End Select\n\n        Else\n            Select Case ImageType\n\n             'Irrelevant code here\n\n            End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>To summarise, how can I turn a string to a chart object, where wb = active, sh = \"Forecast\", and NameRange = \"Chart 1\"</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "object", "button", "arguments"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526481600, "post_id": 50373671, "comment_id": 87763714, "body": "<code>public sub somesub(ws as excel.worksheet, objCommandButton as CommandButton)</code> call like so <code>somesub(activesheet,activesheet.shapes(&quot;commandbutton1&quot;)</code> along these lines, <code>application.caller</code> may assist you also, no need for the calling button argument"}, {"owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526482664, "post_id": 50373671, "comment_id": 87764524, "body": "Tried your call, please see editted post, came up with an error. What you wrote would work if I was calling the sub within another sub, but I am trying to call the sub from a command button by assigning the Sub as the macro for the button"}, {"owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526483047, "post_id": 50373671, "comment_id": 87764799, "body": "Solved my own need for this feature using Nathan_Sav&#39;s suggestion to use <code>Application.Caller</code> within the sub that is called by the button, and using <code>activesheet</code> within that same sub. However my question has not been answered on how to pass these as arguments to a macro called by a button on a sheet."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1526483092, "post_id": 50373671, "comment_id": 87764837, "body": "What is your logic then?  What ever the sub is, when called Activesheet will be the active sheet, no need to pass either.....  Just assign MyMacro and then activesheet will be the one you want.."}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "is_accepted": true, "score": 0, "last_activity_date": 1526483978, "creation_date": 1526483978, "answer_id": 50374637, "question_id": 50373671, "link": "https://stackoverflow.com/questions/50373671/pass-worksheet-and-button-object-from-command-button/50374637#50374637", "title": "Pass worksheet and button object from Command Button", "body": "<p>From Nathan_Sav 's commment on my question:</p>\n\n<p>There is no need for ActiveSheet and the CommandButton to be sent as arguments.</p>\n\n<p><code>ActiveSheet</code> can be obtained just by using <code>ActiveSheet</code> within the called sub, since the button that calls the sub must be on the ActiveSheet in order to be pressed.</p>\n\n<p><code>Button</code> (the button that called the sub) can be obtained using <code>Application.Caller</code></p>\n"}], "owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 50374637, "answer_count": 1, "score": 0, "last_activity_date": 1526483978, "creation_date": 1526481163, "last_edit_date": 1526482325, "question_id": 50373671, "link": "https://stackoverflow.com/questions/50373671/pass-worksheet-and-button-object-from-command-button", "title": "Pass worksheet and button object from Command Button", "body": "<p>Is there a way to pass the ActiveSheet object and an object as arguments to a sub that is called by a Command Button on a worksheet?</p>\n\n<p>I know you can pass arguments to a macro from a command button from the following:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29858176/how-to-call-a-macro-from-a-button-and-pass-arguments\">How to call a macro from a button and pass arguments</a></p>\n\n<p>However how would you send the following arguments to a sub when Button_1 is clicked? (without using a commandButton_click event)</p>\n\n<p>argument 1: ws as worksheet (the worksheet that contains the button that was pressed)\nargument 2: button as object (the button that was pressed)</p>\n\n<p>I've tried the following in the \"Assign Macro\" input box for the button.</p>\n\n<p>'SubToBeCalledByButton(ActiveSheet, this)'</p>\n\n<hr>\n\n<p>Tried /u/Nathan_Sav suggestion to put call like: 'SubToBeCalledByButton(activesheet, activesheet.shapes(\"Button Name\"))' but got the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EWFw9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EWFw9.png\" alt=\"error\"></a></p>\n\n<p>Here is input I used in assign macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wQaUp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wQaUp.png\" alt=\"Assign Macro\"></a></p>\n\n<p>Here is the sub being called by the button:</p>\n\n<pre><code>Public Sub DetailButton(ws As Excel.Worksheet, but As Object)\n\n    Debug.Print \"ws:\" &amp; vbTab &amp; ws.Name\n    Debug.Print \"but:\" &amp; vbTab &amp; but.Name\n    Debug.Print \"cal:\" &amp; vbTab &amp; Application.Caller\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions", "conditional-formatting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1526482916, "post_id": 50373641, "comment_id": 87764720, "body": "What error do you get when you take out the <code>On Error Resume Next</code>?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1526484831, "post_id": 50373641, "comment_id": 87766034, "body": "There is limitation on what an UDF can do: See <a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/170787/&hellip;</a> In particular <code>[...] such a function cannot do any of the following:     Insert, delete, or format cells on the spreadsheet.</code>"}, {"owner": {"reputation": 1, "user_id": 9726619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q5J6JtxVa6A/AAAAAAAAAAI/AAAAAAAAACc/HkjcW5i0Fao/photo.jpg?sz=128", "display_name": "Justin Lata", "link": "https://stackoverflow.com/users/9726619/justin-lata"}, "edited": false, "score": 0, "creation_date": 1526487838, "post_id": 50373641, "comment_id": 87767799, "body": "It doesn&#39;t give an error in like a prompt popping up and giving an error code, it just evaluates the cell to &quot;#VALUE!&quot;   So a subroutine can apply conditional formatting, but a udf can&#39;t call a subroutine that applies conditional formatting?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1526488225, "post_id": 50373641, "comment_id": 87768005, "body": "@VincentG  You could add that as an answer."}, {"owner": {"reputation": 1, "user_id": 9726619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q5J6JtxVa6A/AAAAAAAAAAI/AAAAAAAAACc/HkjcW5i0Fao/photo.jpg?sz=128", "display_name": "Justin Lata", "link": "https://stackoverflow.com/users/9726619/justin-lata"}, "edited": false, "score": 0, "creation_date": 1526489689, "post_id": 50373641, "comment_id": 87768743, "body": "So I tried adding the call to &quot;threecf&quot; to a userform I have to prompt the user to select which method they are using and that gave the same thing of applying conditional formatting but no actual format to the conditions. But then I copied the code from the &quot;threecf&quot; sub and placed it in the userform and it applies only the font color and not the interior. So that is helpful. Both of those tests required  &quot;on error resume next&quot; but don&#39;t prompt me as to where the error specifically arises"}], "owner": {"reputation": 1, "user_id": 9726619, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q5J6JtxVa6A/AAAAAAAAAAI/AAAAAAAAACc/HkjcW5i0Fao/photo.jpg?sz=128", "display_name": "Justin Lata", "link": "https://stackoverflow.com/users/9726619/justin-lata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526481070, "creation_date": 1526481070, "question_id": 50373641, "link": "https://stackoverflow.com/questions/50373641/trouble-applying-conditional-formatting-via-udf", "title": "Trouble applying conditional formatting via udf", "body": "<p>So I'm working on a udf that I will eventually make into an addin to help process data and it would be preferred if cells could be highlighted to draw the user's attention to any problems.</p>\n\n<p>The udf is as follows:</p>\n\n<pre><code>Function AnalyzeData()\nDim Headers() As Variant\nDim Row1 As Variant\n\nHeaders = Array(Row1, Row2, Row3, Row4, Row5)\n\nRow1 = Array(\"Final Curve\", \"\", \"Cr\", \"Fe\", \"Ni\", \"Cu\", \"Zn\", \"As\", \"Ag\", \"Cd\", \"Sn\", \"Pb\")\n\nRow2 = Array(\"Level\", \"Nominal\", 100, 100, 100, 100, 100, 100, 100, 100, 100, 100)\ncol1 = Array(\"Level\", \"Cal 1\", \"Cal 2\", \"Cal 3\", \"Cal 4\", \"Cal 5\", \"Cal 6\", \"Cal 7\", \"Cal 8\", \"Cal 9\", \"Cal 10\", \"\", \"\", \"Level\", \"Cal 1\", \"Cal 2\", \"Cal 3\", \"Cal 4\", \"Cal 5\", \"Cal 6\", \"Cal 7\", \"Cal 8\", \"Cal 9\", \"Cal 10\", \"\", \"\")\ncol2 = Array(\"\", \"Nominal\", \"0.1\", \"0.2\", \"0.5\", \"1.0\", \"2.5\", \"5.0\", \"10\", \"20\", \"30\", \"50\", \"\", \"\", \"Nominal\", \"0.1\", \"0.2\", \"0.5\", \"1.0\", \"2.5\", \"5.0\", \"10\", \"20\", \"30\", \"50\", \"\", \"\")\n\nDim Location() As Variant\n\nSelect Case TypeName(Application.Caller)\n    Case \"Range\"\n        Location = Array(Application.Caller.Row, Application.Caller.Column)\n        If Location(0) = 1 And Location(1) = 1 Then\n            BuildArrays\n            MethodCheck\n            On Error Resume Next\n            threecf\n\n            AnalyzeData = Row1(0)\n        Else\n            Select Case Location(1)\n\n                Case 1 - 2\n                    Case 1\n                        AnalyzeData = col1(Location(0) - 2)\n                    Case 2\n                        AnalyzeData = col2(Location(0) - 1)\n                Case Else\n\n                    Select Case Location(0)\n\n                        Case 1, 14\n                            AnalyzeData = SelectedAnalytes(Location(1) - 3)\n                        Case 2, 15\n                            AnalyzeData = Row2(Location(1) - 1)\n                        Case 3 To 12\n                            AnalyzeData = Round(STDArray(Location(0) - 2,Location(1) - 3), 3)\n                        Case 13, 26\n                            AnalyzeData = \"\"\n                        Case 16 To 25\n                            If CalValues(Location(1) - 3, Location(0) - 15) = \"\" Then\n                                AnalyzeData = \"N/A\"\n                            ElseIf Round(STDArray(Location(0) - 15, Location(1) - 3) / CalValues(Location(1) - 3, Location(0) - 15) * 100, 0) &lt;= 100 + Acceptance And Round(STDArray(Location(0) - 15, Location(1) - 3) / CalValues(Location(1) - 3, Location(0) - 15) * 100, 0) &gt;= 100 - Acceptance Then\n                            AnalyzeData = Round(STDArray(Location(0) - 15, Location(1) - 3) / CalValues(Location(1) - 3, Location(0) - 15) * 100, 0) &amp; \"%\"\n                            Else\n                                AnalyzeData = \"Fail acceptance\"\n                            End If\n\n                        End Select\n                End Select\n        End If\n\n    Case \"String\"\n        AnalyzeData = Application.Caller\n    Case \"Error\"\n        AnalyzeData = \"Error\"\n    Case Else\n        AnalyzeData = \"unknown\"\nEnd Select\n\nEnd Function\n</code></pre>\n\n<p>And the \"threecfs\" sub is </p>\n\n<pre><code>Public Sub threecf()\nDim rg As Range\nDim cond1 As FormatCondition, cond2 As FormatCondition, cond3 As FormatCondition\nSet rg = Range(\"C2\", Range(\"C2\").End(xlDown))\n\n'clear any existing conditional formatting\nrg.FormatConditions.Delete\n\n'define the rule for each conditional format\nSet cond1 = rg.FormatConditions.Add(xlCellValue, xlGreater, \"=1\")\nSet cond2 = rg.FormatConditions.Add(xlCellValue, xlLess, \"=$a$1\")\nSet cond3 = rg.FormatConditions.Add(xlCellValue, xlEqual, \"=$a$1\")\n\n'define the format applied for each conditional format\nWith cond1\n.Interior.Color = vbGreen\n.Font.Color = vbWhite\nEnd With\n\nWith cond2\n.Interior.Color = vbRed\n.Font.Color = vbWhite\nEnd With\n\nWith cond3\n.Interior.Color = vbYellow\n.Font.Color = vbRed\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Which I found by looking for help with this online. \nSo without the lines </p>\n\n<pre><code>            On Error Resume Next\n            threecf\n</code></pre>\n\n<p>My function works and analyzes the data appropriately, but when the \"threecf\" sub is called by cell A1 it errors doesn't proceed without \"on error resume next\" and the conditional formatting is not applied at all.</p>\n\n<p>If the range in \"threecf\" is changed to</p>\n\n<pre><code>rg=cells(1,1)\n</code></pre>\n\n<p>then the function still requires \"on error resume next\", but conditional formatting is applied but not correctly. It adds the conditions but with no formatting for each condition.</p>\n\n<p>If I run \"threecfs\" via F5 then it works correctly.</p>\n\n<p>Is my understanding of applying conditional formatting via udf's incorrect in that this cannot be done? </p>\n\n<p>Ideally, my udf will calculate recovery percentages for values from my data and the conditional formatting would be applied to highlight values that have issues, but does this need to be done by each cell instead of the starting cell applying it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526482859, "post_id": 50373278, "comment_id": 87764672, "body": "When it doesn&#39;t work, what happens?  Do you get an error?  Does it timeout?"}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526484341, "post_id": 50373278, "comment_id": 87765706, "body": "It just runs without producing the files and fires no error."}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526484770, "post_id": 50373278, "comment_id": 87765998, "body": "But sometimes it causes an Error: &quot;Automation Error: Old Format or Invalid Type Library&quot;"}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526485176, "post_id": 50373278, "comment_id": 87766240, "body": "You&#39;ve got a debug line.  Does that print anything when it doesn&#39;t download the file?"}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526485774, "post_id": 50373278, "comment_id": 87766619, "body": "No, if it doesn&#39;t download anything it prints nothing. If I execute the script multiple times with F5 then it fires the above mentioned Automation Error."}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526485843, "post_id": 50373278, "comment_id": 87766669, "body": "So that means one of two things: 1) it&#39;s not hitting that line, or 2) the link might be null, which kills the entire line.  You could try using Nz to isolate which one it is."}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526486340, "post_id": 50373278, "comment_id": 87766981, "body": "hmm,but when I go throuh the script with F8 it hits every line. So the links do exist."}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526486888, "post_id": 50373278, "comment_id": 87767297, "body": "Sometimes, debugging introduces changes that don&#39;t mimic production.  It could be a load time issue; your best bet is to make that Debug line work, and put one right before the If line, as well.  That&#39;ll let you know what it&#39;s hitting."}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1526492890, "post_id": 50373278, "comment_id": 87770441, "body": "I will try it out tomorrow, may be I will find something. Thanks for your quick replies fbueckert."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "edited": false, "score": 0, "creation_date": 1526511280, "post_id": 50379125, "comment_id": 87778197, "body": "Thanks for your remark ryguy72. Unfortunately, the url changes daily so I think I have to navigate through the website to find the correct link among all existing links."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "edited": false, "score": 0, "creation_date": 1526511778, "post_id": 50379125, "comment_id": 87778338, "body": "Is the target file based on a date, or is there some kind of data pattern that you can exploit?  There must be something that indicates where you need to go.  Pass that into the strURL as a parameter and concatenate it inyou your string using the &#39;&amp;&#39; character."}, {"owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "edited": false, "score": 0, "creation_date": 1526543247, "post_id": 50379125, "comment_id": 87787611, "body": "yes it depends on the date but there is no regular pattern on how the date changes."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1526501211, "creation_date": 1526501211, "answer_id": 50379125, "question_id": 50373278, "link": "https://stackoverflow.com/questions/50373278/vba-download-csv-from-website/50379125#50379125", "title": "VBA Download CSV from Website", "body": "<p>I think you can simplify your code a lot!</p>\n\n<pre><code>Sub OpenCSV()\nstrURL = \"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv\"\nApplication.Workbooks.Open (strURL)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9098697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41666c6b4802fbbe41d0fae371c728ee?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp_PK", "link": "https://stackoverflow.com/users/9098697/philipp-pk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526501211, "creation_date": 1526479966, "last_edit_date": 1531164843, "question_id": 50373278, "link": "https://stackoverflow.com/questions/50373278/vba-download-csv-from-website", "title": "VBA Download CSV from Website", "body": "<p>I am struggling with a VBA script which I have written. It is being called 4 times to download 4 different csv files from a Website. If I execute the script step by step by pressing F8 it works fine. However, when I am running the whole script it doesn't download all files. Sometimes it downloads one or two files and sometimes None- it's kind of unpredictable!? Has anybody an idea what wrong with the code of the Sub DownloadIshares()?</p>\n\n<p>Many thanks in advance</p>\n\n<pre><code>Sub Test()\nDownloadIshares \"EUN5\"\nDownloadIshares \"IBCS\"\nDownloadIshares \"LQDH\"\nDownloadIshares \"SDIG\"\nEnd Sub\n\nSub DownloadIshares(inETFName As String)\n\nDim o_IE As InternetExplorer\nDim FSO As FileSystemObject\nDim o_TextStream As TextStream\nDim HTMLDoc As HTMLDocument\nDim urlETF As String\nDim links As IHTMLElementCollection\nDim link As HTMLAnchorElement\nDim WB_tmp As Workbook\nDim MainPath As String, MainUrl_1 As String, MainUrl_2 As String, UrlETF_No As String\nDim SearchForLink As String\n\nMainPath = \"U:\\Entwicklung\\Instrumentenabgleich_ETF\\\"\nMainUrl_1 = \"https://www.ishares.com/de/professionelle-anleger/de/site-entry?siteEntryAction=ACCEPT&amp;targetUrl\" _\n    &amp; \"=%2Fde%2Fprofessionelle-anleger%2Fde%2Fprodukte%2F\"\nMainUrl_2 = \"%2F%3FsiteEntryPassthrough%3Dtrue%26refer\" _\n    &amp; \"rer%3DtickerSearch%26locale%3Dde_DE%26userType%3Dinstitutional\"\n\nSelect Case inETFName\n    Case \"EUN5\"\n        UrlETF_No = \"251726\"\n        SearchForLink = \"_Datenblatt_GroMiKV_IE00BF11F565.csv\"\n    Case \"LQDH\"\n        UrlETF_No = \"257320\"\n        SearchForLink = \"_Datenblatt_GroMiKV_IE00BCLWRB83.csv\"\n    Case \"IBCS\"\n        UrlETF_No = \"251565\"\n        SearchForLink = \"_Datenblatt_GroMiKV_IE0032523478.csv\"\n    Case \"SDIG\"\n        UrlETF_No = \"258126\"\n        SearchForLink = \"_Datenblatt_GroMiKV_IE00BYXYYP94.csv\"\nEnd Select\n\nurlETF = MainUrl_1 &amp; UrlETF_No &amp; MainUrl_2\nSet FSO = New FileSystemObject\nSet o_IE = New InternetExplorer\no_IE.Visible = True\n'o_IE.Visible = False\n\no_IE.Navigate urlETF\nDo While o_IE.Busy Or o_IE.readyState &lt;&gt; 4\n    DoEvents\nLoop\n\nSet HTMLDoc = o_IE.Document\nSet links = HTMLDoc.getElementsByTagName(\"A\")\nFor Each link In links\n    'If InStr(link.href, \"_Datenblatt_GroMiKV_IE00BCLWRB83.csv\") Then\n    If InStr(link.href, SearchForLink) &gt; 0 Then\n        Debug.Print \"Text: \" &amp; link.innerText &amp; vbCr &amp; \"URL: \" &amp; link.href\n        'Set o_TextStream = FSO.OpenTextFile(link.href)\n        Set WB_tmp = Workbooks.Open(link.href)\n        WB_tmp.SaveAs MainPath &amp; inETFName, xlCSV\n        Application.DisplayAlerts = False\n        WB_tmp.Close\n        Application.DisplayAlerts = True\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1526479528, "post_id": 50372958, "comment_id": 87762111, "body": "Replace <code>Application.SendKeys(&quot;%{ENTER}&quot;)</code> by <code>vbLf</code>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1526479558, "creation_date": 1526479558, "answer_id": 50373101, "question_id": 50372958, "link": "https://stackoverflow.com/questions/50372958/adding-value-or-text-from-textbox-to-cell-without-overwriting-and-in-a-new-l/50373101#50373101", "title": "Adding .value (or .text) from textbox to cell without overwriting AND in a new line", "body": "<p>To add a line break in a cell add <code>Chr(10)</code> or <code>vbLf</code> like:</p>\n\n<pre><code>ActiveCell.Offset(0, 23).Text = ActiveCell.Offset(0, 23) &amp; Chr(10) &amp; \"whatever the textbox contains\"\n</code></pre>\n"}], "owner": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 50373101, "answer_count": 1, "score": 0, "last_activity_date": 1526479558, "creation_date": 1526479226, "last_edit_date": 1531164843, "question_id": 50372958, "link": "https://stackoverflow.com/questions/50372958/adding-value-or-text-from-textbox-to-cell-without-overwriting-and-in-a-new-l", "title": "Adding .value (or .text) from textbox to cell without overwriting AND in a new line", "body": "<p>This sends data from the form textbox to the appropriate cell without overwriting the cell contents: </p>\n\n<pre><code> ActiveCell.Offset(0, 23).Text = ActiveCell.Offset(0, 23) &amp; \"whatever the textbox contains\"\n</code></pre>\n\n<p>The problem I'm having is that this just concatenates the new and the old data and I need each new entry to be separated in a new line. I've tried this: </p>\n\n<pre><code>ActiveCell.Offset(0, 23).Value = ActiveCell.Offset(0, 23).Value &amp; _\n    Application.SendKeys(\"%{ENTER}\") &amp; MASCACIncomingRef.Value\n</code></pre>\n\n<p>but on compiling I'm missing something to make the sendkey work. I couldn't find any posts with a solution... </p>\n\n<p>I need to ensure each entry is in a new line within the cell because I'm using the contents of that cell to show in another part of the form as a kind of table (don't ask), so I need each new value added to the cell to be on below or on top of the last value already in the cell. Could anyone help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526479455, "post_id": 50372853, "comment_id": 87762047, "body": "<code>c1.Value &amp; &quot;*&quot;</code> turns it into a text string and countif will not find a match of a text string with a number.  Load both ranges into memory array and  loop the arrays and compare.  That way you can turn both into text strings and compare using <code>Like</code>"}, {"owner": {"reputation": 1, "user_id": 9800503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dab6c205fcd5b670668f725a72bfcef?s=128&d=identicon&r=PG&f=1", "display_name": "Ian DJ", "link": "https://stackoverflow.com/users/9800503/ian-dj"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1526539573, "post_id": 50372853, "comment_id": 87785580, "body": "Hi Scott. Thank you for the great explenation. I am not great at vba. Will it be possible for you to explain to me how to load the ranges into memory array and loop through to only be left with the values that do not match?"}], "owner": {"reputation": 1, "user_id": 9800503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dab6c205fcd5b670668f725a72bfcef?s=128&d=identicon&r=PG&f=1", "display_name": "Ian DJ", "link": "https://stackoverflow.com/users/9800503/ian-dj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 886, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526484752, "creation_date": 1526478919, "last_edit_date": 1526484752, "question_id": 50372853, "link": "https://stackoverflow.com/questions/50372853/vba-code-to-compare-two-ranges", "title": "vba code to compare two ranges", "body": "<p>I have two ranges that I compare to find the values that does not compare. These values need to be pasted in new cells. The code I have works perfect but for some reason it will not work if the cell values are numbers only. </p>\n\n<p>Please see below.</p>\n\n<pre><code>Sub RangeCompare2()\n\nDim Rg1 As Range, Rg2 As Range, c1 As Range, rgPaste2 As Range\nDim lngRowOffset3 As Long\n\nOn Error Resume Next\n\nlngRowOffset3 = 0\nSet Rg1 = Worksheets(\"Bridget Madumo\").Range(\"AQ40:AQ70\")\nSet Rg2 = Worksheets(\"Bridget Madumo\").Range(\"C69:C122\")\nSet rgPaste2 = Worksheets(\"BM CS\").Range(\"C102\")\nSet rgPaste2 = rgPaste2.Cells(1, 1)\n\nOn Error GoTo 0\n\nFor Each c1 In Rg1.Cells\n\n    If Application.WorksheetFunction.CountIf(Rg2, c1.Value &amp; \"*\") = 0 Then\n\n    rgPaste2.Offset(lngRowOffset3).Value = c1.Value\n    rgPaste2.Offset(lngRowOffset3, 1).Value = c1.Offset(, 1).Value\n    rgPaste2.Offset(lngRowOffset3, 2).Value = c1.Offset(, 2).Value\n    rgPaste2.Offset(lngRowOffset3, 3).Value = c1.Offset(, 3).Value\n    lngRowOffset3 = lngRowOffset3 + 1\n    End If\n\nNext c1\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1526479242, "post_id": 50372851, "comment_id": 87761884, "body": "Why are you only working on ActiveSheet?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9800568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jarrod Kronebusch", "link": "https://stackoverflow.com/users/9800568/jarrod-kronebusch"}, "edited": false, "score": 0, "creation_date": 1526481265, "post_id": 50373546, "comment_id": 87763470, "body": "Thanks Bruce! That seemed to do the trick. Appreciate the help!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1526480755, "creation_date": 1526480755, "answer_id": 50373546, "question_id": 50372851, "link": "https://stackoverflow.com/questions/50372851/exporting-excel-tabs-to-separate-pdf-file-skip-1st-3-tabs/50373546#50373546", "title": "Exporting Excel Tabs to Separate PDF File - Skip 1st 3 Tabs", "body": "<p>Assuming the sheets you want to skip are indexes 1, 2, and 3, you can use a <code>For</code> loop to skip those, and start on worksheet 4:</p>\n\n<pre><code>Sub exportToPDF()\nDim ws As Worksheet\nDim i As Long\nDim nm As String\n\nFor i = 4 To ThisWorkbook.Worksheets.Count\n    With ThisWorkbook.Worksheets(i)\n        nm = .Name\n        .ExportAsFixedFormat Type:=xlTypePDF, _\n                                    Filename:=\"File Location\" &amp; nm &amp; \".pdf\", _\n                                    Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                                    IgnorePrintAreas:=False, OpenAfterPublish:=False\n    End With\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9800568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jarrod Kronebusch", "link": "https://stackoverflow.com/users/9800568/jarrod-kronebusch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 50373546, "answer_count": 1, "score": 1, "last_activity_date": 1526480755, "creation_date": 1526478913, "question_id": 50372851, "link": "https://stackoverflow.com/questions/50372851/exporting-excel-tabs-to-separate-pdf-file-skip-1st-3-tabs", "title": "Exporting Excel Tabs to Separate PDF File - Skip 1st 3 Tabs", "body": "<p>New to VBA coding in Excel, and trying to figure out how to revise my current code (see below). It creates a PDF for each of my tabs, but I simply want it to ignore the 1st 3 tabs where I have my work and only create PDFs starting with the 4th tab. I'm sure it's any easy addition to define the scope, but can't pinpoint exactly how to code it.</p>\n\n<pre><code>Sub ExportToPDFs()\n' PDF Export Macro\n' Change C:\\Exports\\ to your folder path where you need the files saved\n' Save Each Worksheet to a separate PDF file.\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nws.Select\nnm = ws.Name\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\nFilename:=\"File Location\" &amp; nm &amp; \".pdf\", _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, _\nIgnorePrintAreas:=False, OpenAfterPublish:=False\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Appreciate any help that you all can give.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1526486016, "post_id": 50372637, "comment_id": 87766778, "body": "Why?  If an email has an Html body, the user will never see the text body.  \u201cchange quotes to single quotes\u201d.  What sort of quotes do you want to change to single quotes?  Do your emails use LF or CR LF for newline?  Would <code>Replace(Outlook.MeetingItem.Body, vbCr &amp; vbLf, &quot;\\n&quot;)</code> meet your requirement?  You need to add a lot more information about your requirement before anyone can offer some detailed advice."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1526502964, "creation_date": 1526502964, "answer_id": 50379512, "question_id": 50372637, "link": "https://stackoverflow.com/questions/50372637/formatting-text-in-vba/50379512#50379512", "title": "Formatting text in vba", "body": "<p>My answer to this question might help: <a href=\"https://stackoverflow.com/a/12146315/973283\">How to copy Outlook mail message into excel using VBA or Macros</a>.  The main macro outputs selected properties of every email in Inbox to an Excel workbook so you can see what an email looks like to a VBA macro.</p>\n\n<p>Even if I checked and found every email in my Inbox used CR LF as new line, I would not trust it. Some email packages will use LF and some will use CR LF as newline.  Unless I found documentation that stated Outlook edited all text bodies so they had consistent newlines, I would not expect consistency.  I would allow for newline being CR, LF or CR LF just to be safe.</p>\n\n<p>Does this code do what you want:</p>\n\n<pre><code>Dim  JsonBody As String\n\nJsonBody = Replace(MeetingItem.Body, \"\"\"\", \"'\")\nJsonBody = Replace(JsonBody,vbCR &amp; vbLF, \"\\n\")\nJsonBody = Replace(JsonBody,vbCR, \"\\n\")\nJsonBody = Replace(JsonBody,vbLF, \"\\n\")\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 7986808, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9c7c2b8e8a67a276bbc476d48a102b?s=128&d=identicon&r=PG&f=1", "display_name": "khashashin", "link": "https://stackoverflow.com/users/7986808/khashashin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 50379512, "answer_count": 1, "score": 0, "last_activity_date": 1592993543, "creation_date": 1526478324, "last_edit_date": 1592993543, "question_id": 50372637, "link": "https://stackoverflow.com/questions/50372637/formatting-text-in-vba", "title": "Formatting text in vba", "body": "<p>How to fromat text in vba. I have to format <code>Outlook.MeetingItem.Body</code> to plain text. This object contains text with quotes and new lines, I wont to handle somehow this text. </p>\n\n<p>For example write something like<br>\nsudocode:</p>\n\n<p><code>if meetingitem contains quotes or newlines change quotes to single quotes and new lines to symbol(\\n)</code></p>\n\n<p>At the moment my <code>MeetingItem.Body</code> looks like (Example):</p>\n\n<blockquote>\n  <p>Hi every one<br>\n  If you looking for \"Dance\", \"Bus\" or \"Car\"<br>\n  go this way:  </p>\n  \n  <p>otherwise go:</p>\n</blockquote>\n\n<p>I will replase newlines after <strong>\"one\"</strong>, <strong>\"Car\"</strong>, <strong>\"way\"</strong>, <strong>\"emptyline\"</strong>, <strong>\"go\"</strong> - with <code>\\n</code> and double quotes with single quotes. And I don't know what my email using LF or CR LF(how to check that?).</p>\n\n<p>Why? I will put this String after in to my JSON, maybe there is better way to do that but I've found only that. I can't put string with double quotes and new lines in to JSON.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1526476629, "post_id": 50371980, "comment_id": 87759811, "body": "Please, <a href=\"https://stackoverflow.com/posts/50371980/edit\">edit</a> your post and format your code."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1526476765, "post_id": 50371980, "comment_id": 87759917, "body": "You need a <code>.</code> in between activeworkbook and worksheets???  Which select is erroring?  You are not using <code>with</code> properly either"}, {"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526476991, "post_id": 50371980, "comment_id": 87760098, "body": "I am getting the error &quot;Application defined or object defined error&quot; at the line: Range(&quot;F3&quot;).End(xlDown).Offset(1, 0).Value = Cell.Value + 14"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1526477000, "post_id": 50371980, "comment_id": 87760106, "body": "Which line is throwing the error? Your title suggests it&#39;s your <code>If Not IsEmpty(Cell) Then</code> line but you state you think it&#39;s a line further down in your code. Which one is highlighted when you hit &quot;Debug&quot; upon receiving the error."}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 9386485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0916b8319fdc74badc020ad2de9837c?s=128&d=identicon&r=PG&f=1", "display_name": "Xemuth", "link": "https://stackoverflow.com/users/9386485/xemuth"}, "is_accepted": false, "score": 0, "last_activity_date": 1526476996, "creation_date": 1526476996, "answer_id": 50372158, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty/50372158#50372158", "title": "Getting an error on If not isempty", "body": "<p>\"With ActiveWorkbook Worksheets(\"All Current Projects\").Select\"</p>\n\n<p>try <code>ActiveWorkbook.sheets(\"All Current Projects\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526478646, "post_id": 50372230, "comment_id": 87761359, "body": "I am still getting the same error at the line &quot;Worksheets(&quot;Create Appointments&quot;).Range(&quot;F3&quot;).End(xlDown).Offset(1, 0).Value = Cell.Value + 14&quot;"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526479087, "post_id": 50372230, "comment_id": 87761734, "body": "Put a breakpoint on that line by placing the cursor on the line and hitting F9. Then run your code. Each iteration it will stop there and you will have to F5 to make it run the line and continue on. Keep an eye on your Locals pane (View&gt;&gt;Locals if it&#39;s not open already). Open up &quot;Cell&quot; and look at the &quot;Value&quot; to see what it is. Either xlDown is ending up at row 1000000 and can&#39;t offset down one more row or <code>cell.value</code> doesn&#39;t contain a number and so it can&#39;t add &quot;14&quot; to it. (That&#39;s my guess anyway)."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526479152, "post_id": 50372230, "comment_id": 87761806, "body": "You might have luck switching to <code>Worksheets(&quot;Create Appointments&quot;).Range(&quot;F99999&quot;).End(xlUp).Value = Cell.value + 14</code>"}, {"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526480808, "post_id": 50372230, "comment_id": 87763137, "body": "I did not know about F9 and Local window, so thank you for pointing me in that direction. Its very helpful."}, {"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526480838, "post_id": 50372230, "comment_id": 87763161, "body": "Same as I commented above: I am getting an error only when the line says &quot;.End(xlDown)&quot; I am able to get it to work in a way by using &quot;.End(xlUp)&quot;"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1526477226, "creation_date": 1526477226, "answer_id": 50372230, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty/50372230#50372230", "title": "Getting an error on If not isempty", "body": "<p>First things first. Stop using <code>.Select</code>. <code>.Select</code> is something humans do. Your code doesn't need to \"Select\" a cell. A quick rewrite:</p>\n\n<p>This may or may not solve your problem since it's unclear what is throwing that error:</p>\n\n<pre><code>Sub PopulateList()\n    Dim Cell As Range\n\n    Worksheets(\"Create Appointments\").Range(\"A4:J100\").ClearContents\n\n    For Each Cell In Worksheets(\"All Current Projects\").Range(\"L4:L80\").Cells\n        If Not IsEmpty(Cell.Value) Then\n                'Only move values that occurred after today\n                If Cell.Value &gt;= Now() Then\n                    'Once Values are found, move them to CreateAppointments sheet\n                    Worksheets(\"Create Appointments\").Range(\"F3\").End(xlDown).Offset(1).Value = Cell.Value + 14 \n                End If\n        End If\n    Next Cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526478542, "post_id": 50372232, "comment_id": 87761266, "body": "I am still getting the same error at the line &quot;Worksheets(&quot;Create Appointments&quot;).Range(&quot;F3&quot;).End(xlDown).Offset(1, 0).Value = Cell.Value + 14&quot; DO I need to take a look at my permissions or references?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1526478838, "post_id": 50372232, "comment_id": 87761530, "body": "Is &quot;F3&quot; empty? If &quot;F3&quot; is empty, going down will get you to the last row, and you won&#39;t be able to offset it."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1526479082, "post_id": 50372232, "comment_id": 87761731, "body": "@VincentG That&#39;s a good point, for that reason I often use Range(&quot;F&quot; &amp; Rows.Count).End(xlUp).Offset(1,0), maybe try that"}, {"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526479511, "post_id": 50372232, "comment_id": 87762098, "body": "&quot;F3&quot; is the header row. It&#39;s a not Table, but just a cell that labels the data that will go beneath it.  I am now getting, &quot;Run Time Error 13, Type Mismatch&quot; although I have not changed a thing"}, {"owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "edited": false, "score": 0, "creation_date": 1526480731, "post_id": 50372232, "comment_id": 87763085, "body": "So I am getting an error only when the line says &quot;.End(xlDown)&quot; I am able to get it to work in a way by using &quot;.End(xlUp)&quot;"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1526477231, "creation_date": 1526477231, "answer_id": 50372232, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty/50372232#50372232", "title": "Getting an error on If not isempty", "body": "<p>I cleaned up your code a little bit and took out the IsEmpty:</p>\n\n<pre><code>Sub PopulateList()\n\nActiveWorkbook.Worksheets(\"Create Appointments\").Range(\"A4:J100\").Clear\n\n'Two Week Follow Up\n'Column L has Install Dates\n\nDim Cell As Range\nFor Each Cell In Range(\"L4:L80\")\n    If Cell.Value &lt;&gt; 0 Then\n        'Only move values that occurred after today\n        If Cell.Value &gt;= Now() Then\n            'Once Values are found, move them to CreateAppointments sheet\n            Worksheets(\"Create Appointments\").Range(\"F3\").End(xlDown).Offset(1, 0).Value = Cell.Value + 14\n        End If\n    End If\nNext Cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1526487290, "creation_date": 1526487290, "answer_id": 50375629, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty/50375629#50375629", "title": "Getting an error on If not isempty", "body": "<p>The xlDown is not finding the next empty space correctly, is better to find it with xlUp.</p>\n\n<p>Note: This code assumes that after clearing A4:J100 there is no more data on Column F after F3</p>\n\n<p>Edit: I changed the range on my testing, changed the range to reflect yours.</p>\n\n<pre><code>Sub PopulateList()\n    ActiveWorkbook.Worksheets(\"Create Appointments\").Range(\"A4:J100\").Clear\n    'Two Week Follow Up\n    'Column L has Install Dates\n    Dim Cell As Range\n    For Each Cell In Worksheets(\"All Current Projects\").Range(\"L4:L80\")\n        If Cell.Value &lt;&gt; 0 Then\n            'Only move values that occurred after today\n            If Cell.Value &gt;= Now() Then\n                'Once Values are found, move them to CreateAppointments sheet\n                'This assumes that after clearing Range A4:J100 there is no more data under F3\n                Worksheets(\"Create Appointments\").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Value = Cell.Value + 14\n            End If\n        End If\n    Next Cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526562835, "creation_date": 1526562835, "answer_id": 50392394, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty/50392394#50392394", "title": "Getting an error on If not isempty", "body": "<p>I can replicate your error, when the very last cell of column F is filled.\nAlso Ricardo A mentioned above:\n\"Note: This code assumes that after clearing A4:J100 there is no more data on Column F after F3\"</p>\n\n<p>You could check with:</p>\n\n<pre><code>Debug.Print Worksheets(\"Sheet1\").Range(\"F3\").End(xlDown).Address\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4487670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54fac2456c40b11b13c11ed6d54536?s=128&d=identicon&r=PG&f=1", "display_name": "PetroAg13", "link": "https://stackoverflow.com/users/4487670/petroag13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 50372232, "answer_count": 5, "score": 0, "last_activity_date": 1526562835, "creation_date": 1526476521, "last_edit_date": 1526476772, "question_id": 50371980, "link": "https://stackoverflow.com/questions/50371980/getting-an-error-on-if-not-isempty", "title": "Getting an error on If not isempty", "body": "<p>I am trying to sort through a data column on one sheet and skip past the empty cells and copy the non empty cells and paste them into another sheet. I had this code working, and just recently I started getting error 1004. I believe that \".select\" is causing the error. I am not well versed in objects, but that may be the way to go?</p>\n\n<p>Does anyone know of a better way to go about doing it?</p>\n\n<pre><code>Sub PopulateList()\n\nWith ActiveWorkbook\nWorksheets(\"Create Appointments\").Select\n[A4:J100].Clear\nEnd With\n\n'Two Week Follow Up\n    With ActiveWorkbook\n    Worksheets(\"All Current Projects\").Select\n    'Column L has Install Dates\n    [L4].Select\n    End With\n\nDim Cell As Range\nFor Each Cell In Range(\"L4:L80\").Cells\nIf Not IsEmpty(Cell) Then\n        'Only move values that occurred after today\n        If Cell.Value &gt;= Now() Then\n            'Once Values are found, move them to CreateAppointments sheet\n            Worksheets(\"Create Appointments\").Select\n                Range(\"F3\").End(xlDown).Offset(1, 0).Value = Cell.Value + 14 \n        End If\nEnd If\nNext Cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sharepoint", "sharepoint-2013", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9800135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbb58b437404c3526b42426c945c6ab?s=128&d=identicon&r=PG&f=1", "display_name": "HeyItsChazm", "link": "https://stackoverflow.com/users/9800135/heyitschazm"}, "edited": false, "score": 0, "creation_date": 1526539866, "post_id": 50379451, "comment_id": 87785740, "body": "Thank you for your suggestion, unfortunately the issue I am having is that Workbooks.CanCheckOut(docCheckOut) will always equal False. I assume this is because VBA can&#39;t access the properties and so the command returns null, which defaults to False."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1526502656, "creation_date": 1526502656, "answer_id": 50379451, "question_id": 50371747, "link": "https://stackoverflow.com/questions/50371747/sharepoint-and-excel-vba-integration-failure/50379451#50379451", "title": "Sharepoint and Excel VBA integration failure", "body": "<p>I can't test this because I don't have SharePoint installed, but this looks about right...</p>\n\n<pre><code>Sub test()\nDim docCheckOut As String\ndocCheckOut = \"Filepath&amp;name\"\nCall UseCheckOut(docCheckOut)\nEnd Sub\n\nSub UseCheckOut(docCheckOut As String)\n\n    ' Determine if workbook can be checked out.\n    If Workbooks.CanCheckOut(docCheckOut) = True Then\n        Workbooks.CheckOut docCheckOut\n    Else\n        MsgBox \"Unable to check out this document at this time.\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9800135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbb58b437404c3526b42426c945c6ab?s=128&d=identicon&r=PG&f=1", "display_name": "HeyItsChazm", "link": "https://stackoverflow.com/users/9800135/heyitschazm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526502656, "creation_date": 1526475853, "question_id": 50371747, "link": "https://stackoverflow.com/questions/50371747/sharepoint-and-excel-vba-integration-failure", "title": "Sharepoint and Excel VBA integration failure", "body": "<p>I have encountered a problem when trying to retrieve file properties from SharePoint through VBA in Excel. (I can't post the workbook, but the below code should suffice).</p>\n\n<p>The code in question:</p>\n\n<pre><code>Private Sub CheckCheckOutStatus()\n\n    Debug.Print Application.Workbooks.CanCheckOut(\"http://sp.mySharepointDomain.co.uk/myFolderPath/myFile.xlsb\")\n\nEnd Sub\n</code></pre>\n\n<p>The issue is that on my clients PC this statement always returns false regardless of whether the file is checked out or not (They are able to check out the file manually, so it isn't a file permissions issue). </p>\n\n<p>Upon further investigation, it seems to be that my specific computer is able to get the correct value from this code and none other can. It's also worth mentioning that my client and all the PC's/Users I have tested this with are all on the same shared network and so we should all have the same packages installed.</p>\n\n<p>Through process of elimination we have deduced that it is related to my specific computer (and it doesn't matter who logs into it, its the PC itself) that is able to use this method correctly.</p>\n\n<p>My question is to all the experts out there:</p>\n\n<p><strong><em>Are there any client side or local packages/installations/permissions that could enable or disable programmatic access to the properties in SharePoint?</em></strong></p>\n\n<p>Thank you for taking the time to read this, and thanks in advance to any suggestions you might have!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1526475651, "post_id": 50371477, "comment_id": 87759094, "body": "Adding the original code you used to create it will help people here understand what you did and how to get the coordinates you want, it is very difficult to help when we don&#39;t know how you did it..."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1526476313, "post_id": 50371477, "comment_id": 87759591, "body": "Is the shape consistent or is it geometrically fluid?  If it&#39;s consistent, we can help.  If its not though, it&#39;s not really suitable to use VBA as there are just too many formula variations.<a href=\"https://en.wikipedia.org/wiki/Centroid\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Centroid</a>"}, {"owner": {"reputation": 1, "user_id": 9715783, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213448999194100/picture?type=large", "display_name": "Roushdy", "link": "https://stackoverflow.com/users/9715783/roushdy"}, "edited": false, "score": 0, "creation_date": 1526476980, "post_id": 50371477, "comment_id": 87760087, "body": "I appreciate your responses thank you , I took a screenshot of the code as I couldn&#39;t write it properly here &gt;&gt; <a href=\"http://www.mediafire.com/file/o2541cp44x49uwc/inquiry.jpg\" rel=\"nofollow noreferrer\">mediafire.com/file/o2541cp44x49uwc/inquiry.jpg</a> you can view it not necessary to download it ... I&#39;m just collecting the needed to begin coding my program with the least info. missing .... Thanks and sorry to bother you"}, {"owner": {"reputation": 1, "user_id": 9715783, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213448999194100/picture?type=large", "display_name": "Roushdy", "link": "https://stackoverflow.com/users/9715783/roushdy"}, "edited": false, "score": 0, "creation_date": 1526476999, "post_id": 50371477, "comment_id": 87760105, "body": "the shape is a simple 2D polyline , not necessary to be a rectangle or triangle they are easy I meant complex shapes"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1526477165, "post_id": 50371477, "comment_id": 87760240, "body": "@Roushdy Please always add the code to your original question (<a href=\"https://stackoverflow.com/posts/50371477/edit\">edit</a>) <b>as text</b> formatted as text block. Otherwise people here cannot modify it and post an answer (see <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">an image of your code is not helpful</a>)."}, {"owner": {"reputation": 1, "user_id": 9715783, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213448999194100/picture?type=large", "display_name": "Roushdy", "link": "https://stackoverflow.com/users/9715783/roushdy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1526477816, "post_id": 50371477, "comment_id": 87760715, "body": "@P\u1d07\u029c I made it , sorry I&#39;m new to this website I didn&#39;t know how to do so"}], "owner": {"reputation": 1, "user_id": 9715783, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213448999194100/picture?type=large", "display_name": "Roushdy", "link": "https://stackoverflow.com/users/9715783/roushdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526478036, "creation_date": 1526475125, "last_edit_date": 1531164843, "question_id": 50371477, "link": "https://stackoverflow.com/questions/50371477/i-need-vba-code-to-locate-the-coordinates-of-centroid-of-a-shape", "title": "I need vba code to locate the coordinates of centroid of a shape", "body": "<p>As mentioned in the title. I drew a polyline in CAD using excel VBA I need to locate the coordinates of the polyline's centroid I don't know the proper code.</p>\n\n<pre><code>Sub Drawline()       \n    Dim point(0 To 7) As Double \n\n    Dim myapp As Object \n    Dim AcadDwg As AcadDocument \n    Dim B As Double \n\n    On Error GoTo ERRORHANDLER \n    Set myapp = GetObject(, \"autocad.application\") \n\nERRORHANDLER: \n    If Err.Description &lt;&gt; \"\" Then\n        Err.Clear\n        Set myapp = CreateObject(\"Autocad.Application\") \n    End If\n\n    myapp.Visible = True \n    Set AcadDwg = myapp.ActiveDocument \n\n    'Now Excel VBA = CAD VBA with same coding \n    Dim line As AcadLWPolyline \n    point(0) = 0: point(1) = 0 \n    point(2) = 1: point(3) = 1 \n    point(4) = 2: point(5) = 0 \n    point(6) = 0: point(7) = 0 \n    Set line = AcadDwg.ModelSpace.AddLightWeightPolyline(point)\n\n    Dim t As AcadLayer \n    Set t = AcadDwg.Layers.Add(\"pline\")\n    line.ConstantWidth = 0.1 \n    B = line.Area \n    MsgBox B      \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526541327, "post_id": 50372372, "comment_id": 87786510, "body": "Thank you for your explanation."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1526477611, "creation_date": 1526477611, "answer_id": 50372372, "question_id": 50370919, "link": "https://stackoverflow.com/questions/50370919/selection-of-multiple-columns-with-endxldown-endxlup-row/50372372#50372372", "title": "selection of multiple columns with end(xlDown).End(xlUp).Row", "body": "<p>End(xldown) has the same effect as pressing control and the down arrow (and End(xlright) is control and right arrow. If you try those key presses in a cell you will see it jumps to the next intersection of filled and empty cells (or the edge of the spreadsheet if there's no filled cells in the way)</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526540956, "post_id": 50372444, "comment_id": 87786296, "body": "Hi, PEH Thank you for your answer. Now I&#39;m using the following code that works now: maxRow = ws.Range(Cells(StartRow, 1).Address, Cells(StartRow, 3).Address).End(xlUp).Row Now I figure out why End(xlDown) didn&#39;t work, because I&#39;ve inserted rows which overflow the limit of excel, right? But now I have another question, how could the following code work? Because my startRow is always 6 but End(XlUp) is row 1, right?  Thank you for your help. Best Regards. Kai"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526541190, "post_id": 50372444, "comment_id": 87786420, "body": "@user4858867 Yes, therefore I suggest to use the <code>xlUp</code> method like in my answer to find the last used row."}, {"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526541237, "post_id": 50372444, "comment_id": 87786451, "body": "Hi, PEH Thank you for your answer. Now I&#39;m using the following code that works now: maxRow = ws.Range(Cells(StartRow, 1).Address, Cells(StartRow, 3).Address).End(xlUp).Row Now I figure out why End(xlDown) didn&#39;t work, because I&#39;ve inserted rows which overflow the limit of excel, right? But now I have another question, how could the following code work? Because my startRow is always 6 but End(XlUp) is row 1, right? Thank you for your help. Best Regards. Kai"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526541464, "post_id": 50372444, "comment_id": 87786596, "body": "Well just test if <code>maxRow &lt; startRow</code> like <code>If maxRow &lt; startRow Then maxRow = startRow</code> to make sure <code>maxRow</code> is at least 6. \u2022 If your question is answered please mark it as solution."}, {"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526542017, "post_id": 50372444, "comment_id": 87786910, "body": "I&#39;ve wrote this and tested it  If maxRow1 &lt; StartRow Then MsgBox (True)"}, {"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526542051, "post_id": 50372444, "comment_id": 87786924, "body": "The result is alway true but I still don&#39;t understnad why does it work."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526542800, "post_id": 50372444, "comment_id": 87787372, "body": "\u2460 You use <code>maxRow1</code> instead of <code>maxRow</code>? why? \u2461 Please be more specific, a message box does not fix your issue. Do exactly what I wrote in my comment."}, {"owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "edited": false, "score": 0, "creation_date": 1526558294, "post_id": 50372444, "comment_id": 87797246, "body": "Hello PEH, your code works. Thanks again. I find out that I can just use following code to get exact the last row which inludes value. maxRow = ws.Range(Cells(StartRow, 1).Address, Cells(StartRow, 3).Address).End(xlUp).End(xlDown).Row"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1526477808, "creation_date": 1526477808, "answer_id": 50372444, "question_id": 50370919, "link": "https://stackoverflow.com/questions/50370919/selection-of-multiple-columns-with-endxldown-endxlup-row/50372444#50372444", "title": "selection of multiple columns with end(xlDown).End(xlUp).Row", "body": "<p>First of all <code>End(xlDown)</code> and <code>End(xlUp)</code> is nothing more than \u2026</p>\n\n<ul>\n<li><code>End(xlDown)</code> = Pressing <kbd>Ctrl</kbd> + <kbd>Arrow down</kbd> </li>\n<li><code>End(xlUp)</code> = Pressing <kbd>Ctrl</kbd> + <kbd>Arrow up</kbd> </li>\n</ul>\n\n<p>you can test this manually by selecting a range/cell and press the combination to see the effect on your actual worksheet.</p>\n\n<p>The overflow error just comes because if you eg. select cell A1 in an empty worksheet and do <code>.End(xlDown)</code> it selects the very last cell of the worksheet. And if you now insert something it fails because the maximum rows of Excel are exceeded.</p>\n\n<p>To find the last used row of a column it's better to use <code>End(xlUp)</code> instead of <code>End(xlDown)</code> eg:</p>\n\n<pre><code>LastUsedRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'finds the last used row in column A\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4858867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199e5a58435d32fb92cd469b957db2e2?s=128&d=identicon&r=PG", "display_name": "Kai-Chun Lin", "link": "https://stackoverflow.com/users/4858867/kai-chun-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2078, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526477808, "creation_date": 1526473558, "last_edit_date": 1531164843, "question_id": 50370919, "link": "https://stackoverflow.com/questions/50370919/selection-of-multiple-columns-with-endxldown-endxlup-row", "title": "selection of multiple columns with end(xlDown).End(xlUp).Row", "body": "<p>I'm doing debug for a VBA template.\nThe Macro let users choose a excel file to import, then it will check each columns whether they correpond the requirements.\nWhen I try to import a file, I alway get error \"oveeflow\" with the following line:</p>\n\n<pre><code>'maxRow = ws.Range(Cells(StartRow, AdditionalInfoColumns.OtherInfo).Address).End(xlDown).Row\n</code></pre>\n\n<p>My colleague tells me that I just need to add end(xlDown).End(xlup) like this:</p>\n\n<pre><code>maxRow = ws.Range(Cells(StartRow, AdditionalInfoColumns.OtherInfo).Address).End(xlDown).End(xlDown).End(xlUp).Row\n</code></pre>\n\n<p>And it does work! I don't know why. So I try to do it in a simpler way as following:  </p>\n\n<pre><code>maxRow = ws.Range(Cells(StartRow, 1).Address, Cells(StartRow, 3).Address).End(xlDown).End(xlUp).Row\n</code></pre>\n\n<p>It works as well.\nCan someone please explain why does it work? Thank you for your answer.\nPS: The value of xlDown and xlUp are -4121 and -4162.</p>\n\n<p>Best Regards\nKai </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1526474472, "post_id": 50370884, "comment_id": 87758246, "body": "Do you want <code>A6</code> to go to <code>A6</code> or <code>A1</code> in the other sheet??"}, {"owner": {"reputation": 15, "user_id": 5920784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71be890da266a394e8314a93e26d235?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo84", "link": "https://stackoverflow.com/users/5920784/pablo84"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1526474848, "post_id": 50370884, "comment_id": 87758492, "body": "The entire column of A1 on sheet x to A6 down of a sheety, if that makes sense.  When I say the entire column I mean all cells that have contents which can vary from 900 rows to 20000 rows."}, {"owner": {"reputation": 15, "user_id": 5920784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71be890da266a394e8314a93e26d235?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo84", "link": "https://stackoverflow.com/users/5920784/pablo84"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1526475502, "post_id": 50370884, "comment_id": 87758978, "body": "<code>Sub Testy3()  Sheets(&quot;sheet2&quot;).Range(&quot;A7:A16&quot;).Value = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:A10&quot;).Value  End Sub</code> @Gary&#39;s Student  This one works for the specified range but I&#39;m after something that references the whole column upto the last cell containing data."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5920784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71be890da266a394e8314a93e26d235?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo84", "link": "https://stackoverflow.com/users/5920784/pablo84"}, "edited": false, "score": 0, "creation_date": 1526478003, "post_id": 50372086, "comment_id": 87760849, "body": "That does the trick, I am a bit dim though, how would I use one variable N for the four columns in question ( I have had to duplicate the code four times created O,P,Q variables."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 15, "user_id": 5920784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71be890da266a394e8314a93e26d235?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo84", "link": "https://stackoverflow.com/users/5920784/pablo84"}, "edited": false, "score": 0, "creation_date": 1526478341, "post_id": 50372086, "comment_id": 87761111, "body": "@Pablo84  If all the columns in <code>Sheet1</code> end on the same row, then you don&#39;t need separate variables"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1526476800, "creation_date": 1526476800, "answer_id": 50372086, "question_id": 50370884, "link": "https://stackoverflow.com/questions/50370884/column-referencing-in-vba-using-sheet-range-value/50372086#50372086", "title": "Column referencing in VBA using sheet().Range().Value", "body": "<p>Tell me if something like this:</p>\n\n<pre><code>Sub Testy3()\n    Dim N As Long\n    N = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    Sheets(\"Sheet1\").Range(\"A1:A\" &amp; N).Copy Sheets(\"Sheet2\").Range(\"A6\")\nEnd Sub\n</code></pre>\n\n<p>works for you.</p>\n\n<p>If all the columns in <code>Sheet1</code> have the same number of rows, then you don't need to re-calculate <strong>N</strong> for each column.</p>\n"}], "owner": {"reputation": 15, "user_id": 5920784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71be890da266a394e8314a93e26d235?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo84", "link": "https://stackoverflow.com/users/5920784/pablo84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 50372086, "answer_count": 1, "score": 0, "last_activity_date": 1526476800, "creation_date": 1526473455, "last_edit_date": 1531164843, "question_id": 50370884, "link": "https://stackoverflow.com/questions/50370884/column-referencing-in-vba-using-sheet-range-value", "title": "Column referencing in VBA using sheet().Range().Value", "body": "<p>I'm trying to avoid copy and paste in order to dramatically speed up a Macro (previously taking two minutes to run).  I am trying to reference four entire columns in Sheetx(A,B,J,L) and have them display in sheety(A6,B6,C6,D6).</p>\n\n<p>I have tried a number of variations of</p>\n\n<p>Sheets(\"Sheety\").Range(\"A6:A,B6:B,C6:C, D6:D\").Value = Sheets(\"Sheetx\").Range(\"A:A, B:B, J:J, L:L\").Value</p>\n\n<p>Also, for sheets(\"sheety\") I tend towards Active.Sheet or Sheets(B) as I have used the index number for the sheet ie </p>\n\n<p>For B = 31\n31 being the index number for the real sheet.</p>\n\n<p>I have been searching for answers for the last hour.  Can anyone help? </p>\n"}, {"tags": ["c++", "multithreading", "vba", "com", "sta"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1526476755, "post_id": 50370819, "comment_id": 87759910, "body": "Couldn&#39;t use this instead <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384240(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>?"}, {"owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1526477064, "post_id": 50370819, "comment_id": 87760164, "body": "As I said, I want to use WinINet. I know I could use WinHTTP, and I have already successfully make it work to retrieve the proxy info. Let&#39;s assume WinHTTP does not exist :)"}], "answers": [{"tags": [], "owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "is_accepted": false, "score": 0, "last_activity_date": 1526548739, "creation_date": 1526548739, "answer_id": 50387751, "question_id": 50370819, "link": "https://stackoverflow.com/questions/50370819/how-to-call-internetgetproxyinfo-from-a-non-single-threaded-apartment-thread-f/50387751#50387751", "title": "How to call InternetGetProxyInfo from a non &quot;Single-Threaded Apartment&quot; thread from Excel VBA using Win32 APIs", "body": "<p>Never mind, it is solved:</p>\n\n<pre><code>Private Const INFINITE = &amp;HFFFFFFFF\nPrivate Declare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\nPrivate Declare Function CreateThread _\n    Lib \"kernel32\" ( _\n        ByVal lpThreadAttributes As Long, _\n        ByVal dwStackSize As Long, _\n        ByVal lpStartAddress As Long, _\n        ByVal lpParameter As Long, _\n        ByVal dwCreationFlags As Long, _\n        ByRef lpThreadld As Long) _\nAs Long\nPrivate Declare Function GetCurrentThreadId Lib \"kernel32\" () As Long\nPrivate Declare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\n\nPrivate Declare Function GetLastError Lib \"kernel32.dll\" () As Long\nPrivate Declare Function GetExitCodeThread Lib \"kernel32\" (ByVal hThread As Long, ByRef dwExitCode As Long) As Long\n\nPrivate Declare Function VirtualAlloc Lib \"kernel32.dll\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long\nPrivate Declare Function VirtualFree Lib \"kernel32.dll\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal dwFreeType As Long) As Long\n\nPrivate Const MEM_COMMIT As Long = &amp;H1000&amp;\nPrivate Const MEM_RESERVE As Long = &amp;H2000&amp;\nPrivate Const MEM_RELEASE As Long = &amp;H8000&amp;\nPrivate Const MEM_EXECUTE_READWRITE As Long = &amp;H40&amp;\n\nPrivate Declare PtrSafe Function MultiByteToWideChar _\n    Lib \"kernel32.dll\" _\n    ( _\n        ByVal CodePage As Long, _\n        ByVal dwFlags As Long, _\n        ByVal lpMultiByteStr As Long, _\n        ByVal cbMultiByte As Long, _\n        ByVal lpWideCharStr As Long, _\n        ByVal cchWideChar As Long) _\nAs Long\n\n'################################################################################################################################\n\nPrivate Declare Function InternetInitializeAutoProxyDll_String _\n    Lib \"JSProxy.dll\" _\n    Alias \"InternetInitializeAutoProxyDll\" _\n    ( _\n        ByVal dwVersion As Long, _\n        ByVal lpszDownloadedTempFile As String, _\n        ByVal lpszMime As Long, _\n        ByVal lpAutoProxyCallbacks As Long, _\n        ByVal lpAutoProxyScriptBuffer As Long) _\nAs Boolean\n\nPrivate Declare Function InternetGetProxyInfo_Long _\n    Lib \"JSProxy.dll\" _\n    Alias \"InternetGetProxyInfo\" _\n    ( _\n        ByVal lpszUrl As Long, _\n        ByVal dwUrlLength As Long, _\n        ByVal lpszUrlHostName As Long, _\n        ByVal dwUrlHostNameLength As Long, _\n        ByVal lplpszProxyHostName As Long, _\n        ByVal lpdwProxyHostNameLength As Long) _\nAs Boolean\n\n'################################################################################################################################\n\nPublic g_ptrProxyHostName As Long 'thread-shared variable allocated/stored in process global memory\nPublic g_strProxyHostName As String 'idem\nPublic g_lngProxyHostNameLength As Long 'idem\nPublic g_MainThreadId As Long\n\nPublic WinINet_InternetGetProxyInfo_ThreadProc_Error As Long\n\nPublic globalVar1 As Long\nPublic globalVar2 As Long\n\n'################################################################################################################################\n\nFunction WinINet_InternetGetProxyInfo_ThreadProc() As Long\n\n    Dim bResult As Boolean\n\n    'Dim strProxyHostName As String 'useless, see below\n    'strProxyHostName = Space(1024)\n    Dim lpszProxyHostName As Long\n    Dim lplpszProxyHostName As Long\n\n    lpszProxyHostName = StrPtr(strProxyHostName)\n    lplpszProxyHostName = VarPtr(lpszProxyHostName)\n\n    Dim dwProxyHostNameLength As Long\n    Dim lpdwProxyHostNameLength As Long\n\n    dwProxyHostNameLength = LenB(strProxyHostName)\n    lpdwProxyHostNameLength = VarPtr(dwProxyHostNameLength)\n\n    Dim strUrlW         As String\n    Dim strHostNameW    As String\n\n    Dim strUrlA         As String\n    Dim strHostNameA    As String\n\n    strUrlW = \"https://www.google.fr/\"\n    strHostNameW = \"www.google.fr\"\n\n    strUrlA = StrConv(strUrlW, vbFromUnicode)\n    strHostNameA = StrConv(strHostNameW, vbFromUnicode)\n\n    Dim szUrlA()        As Byte\n    Dim szHostNameA()   As Byte\n\n    szUrlA = StrConv(strUrlW, vbFromUnicode)\n    szHostNameA = StrConv(strHostNameW, vbFromUnicode)\n\n    ReDim Preserve szUrlA(UBound(szUrlA) + 1)\n    ReDim Preserve szHostNameA(UBound(szHostNameA) + 1)\n\n    bResult = InternetInitializeAutoProxyDll_String(0, \"D:\\Users\\SC5071\\Desktop\\proxy.pac\", 0, 0, 0)\n\n    'check state before\n    'globalVar1 = lpszProxyHostName\n    'globalVar1 = lplpszProxyHostName\n    'globalVar1 = dwProxyHostNameLength\n    'globalVar1 = lpdwProxyHostNameLength\n\n    bResult = InternetGetProxyInfo_Long(VarPtr(szUrlA(0)), Len(\"https://www.google.fr/\") + 1, _\n                                        VarPtr(szHostNameA(0)), Len(\"www.google.fr\") + 1, _\n                                        lplpszProxyHostName, lpdwProxyHostNameLength)\n\n    m_ThreadProcId = GetCurrentThreadId()\n\n    If m_ThreadProcId = g_MainThreadId Then 'otherwise Excel crahes when using Debug.Print from another thread than the STA thread\n        Debug.Print \"bResult = \"; bResult\n        Debug.Print \"Err.LastDllError = \"; Err.LastDllError\n        Debug.Print \"GetLastError() = \"; GetLastError()\n    End If\n\n    'check state after\n    'globalVar2 = lpszProxyHostName\n    'globalVar2 = lplpszProxyHostName\n    'globalVar2 = dwProxyHostNameLength\n    'globalVar2 = lpdwProxyHostNameLength\n\n    '~~&gt; checking the state of the variable passed to InternetGetProxyInfo before and after the call reveals that\n    '    InternetGetProxyInfo_Long actually allocates a buffer holding the computed string and returns the new pointer to it in\n    '    lpszProxyHostName, and its length in dwProxyHostNameLength; lplpszProxyHostName and lpdwProxyHostNameLength are unchanged.\n    '    that is why strProxyHostName contains only blank spaces (200020002000...) after the call, it is simply unchanged.\n\n    WinINet_InternetGetProxyInfo_ThreadProc = bResult\n    'WinINet_InternetGetProxyInfo_ThreadProc = Err.LastDllError\n\n    WinINet_InternetGetProxyInfo_ThreadProc_Error = Err.LastDllError\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    g_ptrProxyHostName = lpszProxyHostName\n    g_lngProxyHostNameLength = dwProxyHostNameLength\n\n    Dim strWideCharStr As String\n    Dim cRequiredBuffer As Long\n    cRequiredBuffer = MultiByteToWideChar(CP_ACP, MB_PRECOMPOSED, g_ptrProxyHostName, -1, StrPtr(strWideCharStr), 0)\n    cchWideChar = cRequiredBuffer - 1\n    strWideCharStr = Space(cchWideChar)\n    Dim lngResult As Long\n    lngResult = MultiByteToWideChar(CP_ACP, MB_PRECOMPOSED, g_ptrProxyHostName, -1, StrPtr(strWideCharStr), cchWideChar)\n\n    g_strProxyHostName = strWideCharStr\n\nEnd Function\n\nSub Main()\n\n    g_MainThreadId = GetCurrentThreadId()\n\n    Dim hThread As Long\n    hThread = CreateThread(0, 0, AddressOf WinINet_InternetGetProxyInfo_ThreadProc, 0, 0, 0)\n    Call WaitForSingleObject(hThread, INFINITE)\n    Dim dwExitCode As Long\n    b = GetExitCodeThread(hThread, dwExitCode)\n    CloseHandle hThread\n\n    If dwExitCode = 1 And WinINet_InternetGetProxyInfo_ThreadProc_Error = 0 Then\n        'Debug.Print globalVar1\n        'Debug.Print globalVar2\n\n        Debug.Print \"PAC file result for URL is:\"\n        Debug.Print g_strProxyHostName\n        Debug.Print \"THE END\"\n    Else\n        Debug.Print dwExitCode\n        Debug.Print WinINet_InternetGetProxyInfo_ThreadProc_Error\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>In this end, the problem was that InternetGetProxyInfo allocates its own buffer (which should be freed later on, as many WinINet functions returning Strings), so my \"foolish\" attempt was not that foolish!!! It was in fact working!</p>\n\n<p>I forgot to mention in my question, that I made an ASM code because CallWindowProc does not allow to call a function pointer that expects more than 4 parameters. Anyway, it was useless, the problem came from elsewhere, <code>Declare</code> statements for Win32 APIs are correctly doing the Dynamic Linking required to call the WinINet/JSProxy function.</p>\n\n<p>As you can see, it is pretty easy to create another thread from the main Excel STA thread, but if I get it right about the COM Threading Model, one must avoid using objects that have been created in that main thread, it is very likely it will cause Excel to crash.</p>\n"}], "owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526548739, "creation_date": 1526473281, "question_id": 50370819, "link": "https://stackoverflow.com/questions/50370819/how-to-call-internetgetproxyinfo-from-a-non-single-threaded-apartment-thread-f", "title": "How to call InternetGetProxyInfo from a non &quot;Single-Threaded Apartment&quot; thread from Excel VBA using Win32 APIs", "body": "<p>I am working on an Excel VBA program, and at some point, I need the proxy to be used when accessing a specific url, proxy that is computed from the .pac file provided by my company. For that, I intend to use WinINet (I know I could also use WinHTTP more easily, and even how to make it work)</p>\n\n<p>I know I am missing some cleaning in my examples (InternetDeInitializeAutoProxyDll, etc.), but for now, I am just trying to successfully retrieve the proxy info.</p>\n\n<p><strong>Step 1 - C++</strong></p>\n\n<p>I found this, which gave me a sample to start with:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20774236/what-initialization-should-be-made-prior-to-calling-internetgetproxyinfo\">What initialization should be made prior to calling InternetGetProxyInfo()?</a></p>\n\n<p>The accepted answer gives 2 ways. But I think that :</p>\n\n<ul>\n<li>the first one is wrong, it does not allow to retrieve the auto proxy from a pac file.</li>\n<li>the second one, is partially wrong too, since there is no need for providing any helper functions, some are provided by default and used internally.</li>\n</ul>\n\n<p>Anyway, the following C++ example allows me to retrieve the string containing the proxies to be used for a specific url:</p>\n\n<pre><code>char *str = 0;\nDWORD len = 0;\n\npfnInternetInitializeAutoProxyDll pIIAPD;\npfnInternetGetProxyInfo pIGPI;\n\nHMODULE hModJS;\n\nhModJS = LoadLibrary(TEXT(\"jsproxy.dll\"));\npIIAPD = (pfnInternetInitializeAutoProxyDll)GetProcAddress(hModJS, \"InternetInitializeAutoProxyDll\");\npIGPI = (pfnInternetGetProxyInfo)GetProcAddress(hModJS, \"InternetGetProxyInfo\");\n\nBOOL b;\nDWORD dw;\n\nb = pIIAPD(0, \"D:\\\\Users\\\\SC5071\\\\Desktop\\\\proxy.pac\", 0, 0, 0);\ndw = GetLastError();\n\nb = pIGPI(\"https://www.google.fr/\", sizeof(URL) - 1, \"www.google.fr\", sizeof(HOST) - 1, &amp;str, &amp;len);\ndw = GetLastError();\n\nreturn 0;\n</code></pre>\n\n<p>Works fine, <code>str</code> contains something like:</p>\n\n<blockquote>\n  <p>PROXY 123.123.55.55:10455; PROXY 123.123.56.56:10455; DIRECT</p>\n</blockquote>\n\n<p><strong>Step 2 - VBA</strong></p>\n\n<p>Moving from C++ to Excel VBA using <code>Declare</code> statements for the Win32 API functions <code>InternetInitializeAutoProxyDll</code> and <code>InternetGetProxyInfo</code>.</p>\n\n<p><em>[I am not posting the code here for now]</em></p>\n\n<p><code>InternetGetProxyInfo</code> fails with error code <code>ERROR_CAN_NOT_COMPLETE (1003L)</code></p>\n\n<p><strong>Step 3 - ASM</strong></p>\n\n<p>At first I thought this might be related to how Excel VBA loads and calls DLL functions, since MSDN for <code>InternetGetProxyInfo</code> states that:</p>\n\n<blockquote>\n  <p>This function can only be called by dynamically linking to \"JSProxy.dll\". </p>\n</blockquote>\n\n<p>So I made my own x86 assembly code to make the call (__stdcall convention):</p>\n\n<pre><code>Private Declare Function GetModuleHandleW Lib \"kernel32.dll\" (ByVal moduleName As String) As Long\nPrivate Declare Function GetModuleHandleA Lib \"kernel32.dll\" (ByVal moduleName As String) As Long\nPrivate Declare Function LoadLibraryExW Lib \"kernel32.dll\" (ByVal lpFileName As String, ByVal hFile As Long, ByVal dwFlags As Integer) As Long\nPrivate Declare Function LoadLibraryExA Lib \"kernel32.dll\" (ByVal lpFileName As String, ByVal hFile As Long, ByVal dwFlags As Integer) As Long\nPrivate Declare Function LoadLibraryW Lib \"kernel32.dll\" (ByVal lpFileName As Long) As Long\nPrivate Declare Function LoadLibraryA Lib \"kernel32.dll\" (ByVal lpFileName As Long) As Long\nPrivate Declare Function FreeLibrary Lib \"kernel32.dll\" (ByVal hModule As Long) As Integer\nPrivate Declare Function VirtualAlloc Lib \"kernel32.dll\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long\nPrivate Declare Function VirtualFree Lib \"kernel32.dll\" (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal dwFreeType As Long) As Long\nPrivate Declare Function GetProcAddress Lib \"kernel32.dll\" (ByVal hModule As Long, ByVal lpProcName As Long) As Long\nPrivate Declare Function GetProcAddress_String Lib \"kernel32.dll\" Alias \"GetProcAddress\" (ByVal hModule As Long, ByVal ProcName As String) As Long\nPrivate Declare Function CallWindowProc Lib \"user32.dll\" Alias \"CallWindowProcW\" (ByVal lpPrevWndFunc As Long, ByVal hWnd As Long, ByVal Msg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\nPrivate Declare Sub RtlMoveMemory Lib \"kernel32.dll\" (ByVal Destination As Long, ByVal Source As Long, ByVal Length As Integer)\nPrivate Declare Function GetLastError Lib \"kernel32.dll\" () As Long\n\nPrivate Const MEM_COMMIT As Long = &amp;H1000&amp;\nPrivate Const MEM_RESERVE As Long = &amp;H2000&amp;\nPrivate Const MEM_RELEASE As Long = &amp;H8000&amp;\nPrivate Const MEM_EXECUTE_READWRITE As Long = &amp;H40&amp;\n\nDim FunctionAddress As Long\nDim MemAddressOffset As Long\n\nPrivate Sub AddByte(ByVal Data As Byte)\n    RtlMoveMemory MemAddressOffset, VarPtr(Data), 1\n    MemAddressOffset = CLng(MemAddressOffset) + 1\nEnd Sub\n\nPrivate Sub AddBytes(Data() As Byte)\n    RtlMoveMemory MemAddressOffset, VarPtr(Data(0)), UBound(Data) + 1\n    MemAddressOffset = CLng(MemAddressOffset) + UBound(Data) + 1\nEnd Sub\n\nSub Main()\n\n    Dim b As Long\n\n    Dim MemAddress As Long\n\n    Dim LstrBytes1() As Byte\n    LstrBytes1 = \"jsproxy.dll\"\n    ReDim Preserve LstrBytes1(UBound(LstrBytes1) + 2)\n    hLib = LoadLibraryW(VarPtr(LstrBytes1(0)))\n    Dim NstrBytes1() As Byte\n    NstrBytes1 = StrConv(\"InternetInitializeAutoProxyDll\", vbFromUnicode)\n    ReDim Preserve NstrBytes1(UBound(NstrBytes1) + 1)\n    FunctionAddress = GetProcAddress(hLib, VarPtr(NstrBytes1(0)))\n    If FunctionAddress = 0 Then Stop\n\n    MemAddress = VirtualAlloc(0&amp;, 256, MEM_COMMIT Or MEM_RESERVE, MEM_EXECUTE_READWRITE)\n    MemAddressOffset = MemAddress\n\n    Dim strTemp1 As String\n    strTemp1 = \"D:\\Users\\SC5071\\Desktop\\proxy.pac\"\n    Dim bytTemp1() As Byte\n    bytTemp1 = StrConv(strTemp1, vbFromUnicode)\n    ReDim Preserve bytTemp1(UBound(bytTemp1) + 1)\n\n    AddByte &amp;H55                                                'push        ebp\n    AddByte &amp;H8B: AddByte &amp;HEC                                  'mov         ebp,esp\n    AddByte &amp;H83: AddByte &amp;HEC: AddByte &amp;H18                    'sub         esp,18h\n\n    AddByte &amp;H6A: AddByte &amp;H0                                   'push        0\n    AddByte &amp;H6A: AddByte &amp;H0                                   'push        0\n    AddByte &amp;H6A: AddByte &amp;H0                                   'push        0\n    AddByte &amp;H68: AddBytes LongToByteArray(VarPtr(bytTemp1(0))) 'push        DWORD PTR\n    AddByte &amp;H6A: AddByte &amp;H0                                   'push        0\n\n    AddByte &amp;HE8                                                'call        InternetInitializeAutoProxyDll\n    AddBytes LongToByteArray(CLng(FunctionAddress) - (CLng(MemAddressOffset) + 4))\n\n    AddByte &amp;H89: AddByte &amp;H45: AddByte &amp;HFC                    'mov         dword ptr [ebp-4],eax\n    AddByte &amp;H8B: AddByte &amp;H45: AddByte &amp;HFC                    'mov         eax,dword ptr [ebp-4]\n\n    AddByte &amp;HC9                                                'leave\n    AddByte &amp;HC3                                                'ret\n\n    l = CallWindowProc(MemAddress, 0, 0, 0, 0)\n    Debug.Print GetLastError()\n\n    b = VirtualFree(MemAddress, 0, MEM_RELEASE)\n    Debug.Print Err.LastDllError\n\n    If l = 0 Then Exit Sub\n\n'--------------------------------------------------------------------------------------------------------------------------------\n\n    FunctionAddress = 0\n    Dim NstrBytes2() As Byte\n    NstrBytes2 = StrConv(\"InternetGetProxyInfo\", vbFromUnicode)\n    ReDim Preserve NstrBytes2(UBound(NstrBytes2) + 1)\n    FunctionAddress = GetProcAddress(hLib, VarPtr(NstrBytes2(0)))\n    If FunctionAddress = 0 Then Stop\n\n    MemAddress = VirtualAlloc(0&amp;, 256, MEM_COMMIT Or MEM_RESERVE, MEM_EXECUTE_READWRITE)\n    MemAddressOffset = MemAddress\n\n    strUrlW$ = \"https://www.google.fr/\"\n    strHostNameW$ = \"www.google.fr\"\n\n    Dim szUrlA()        As Byte\n    Dim szHostNameA()   As Byte\n\n    szUrlA = StrConv(strUrlW, vbFromUnicode)\n    szHostNameA = StrConv(strHostNameW, vbFromUnicode)\n\n    ReDim Preserve szUrlA(UBound(szUrlA) + 1)\n    ReDim Preserve szHostNameA(UBound(szHostNameA) + 1)\n\n    len1&amp; = Len(\"https://www.google.fr/\") + 1\n    len2&amp; = Len(\"www.google.fr\") + 1\n\n    Dim strProxyHostName() As Byte\n    ReDim strProxyHostName(2048 - 1)\n\n    Dim lpszProxyHostName As Long\n    Dim lplpszProxyHostName As Long\n\n    lpszProxyHostName = VarPtr(strProxyHostName(0))\n    lplpszProxyHostName = VarPtr(lpszProxyHostName)\n\n    Dim dwProxyHostNameLength As Long\n    Dim lpdwProxyHostNameLength As Long\n\n    dwProxyHostNameLength = UBound(strProxyHostName)\n    lpdwProxyHostNameLength = VarPtr(dwProxyHostNameLength)\n\n    AddByte &amp;H55                                                    'push        ebp\n    AddByte &amp;H8B: AddByte &amp;HEC                                      'mov         ebp,esp\n    AddByte &amp;H83: AddByte &amp;HEC: AddByte &amp;H1C                        'sub         esp,1ch\n\n    AddByte &amp;H68: AddBytes LongToByteArray(lpdwProxyHostNameLength) 'push        DWORD PTR\n    AddByte &amp;H68: AddBytes LongToByteArray(lplpszProxyHostName)     'push        DWORD PTR PTR\n    AddByte &amp;H68: AddBytes LongToByteArray(len2)                    'push        DWORD\n    AddByte &amp;H68: AddBytes LongToByteArray(VarPtr(szHostNameA(0)))  'push        DWORD PTR\n    AddByte &amp;H68: AddBytes LongToByteArray(len1)                    'push        DWORD\n    AddByte &amp;H68: AddBytes LongToByteArray(VarPtr(szUrlA(0)))       'push        DWORD PTR\n\n    AddByte &amp;HE8                                                    'call        InternetGetProxyInfo\n    AddBytes LongToByteArray(CLng(FunctionAddress) - (CLng(MemAddressOffset) + 4))\n\n    AddByte &amp;H89: AddByte &amp;H45: AddByte &amp;HFC                        'mov         dword ptr [ebp-4],eax\n    AddByte &amp;H8B: AddByte &amp;H45: AddByte &amp;HFC                        'mov         eax,dword ptr [ebp-4]\n\n    AddByte &amp;HC9                                                    'leave\n    AddByte &amp;HC3                                                    'ret\n\n    l = CallWindowProc(MemAddress, 0, 0, 0, 0)\n    Debug.Print GetLastError()\n\n    Debug.Print Mem_ReadHex(MemAddress, CLng(MemAddressOffset) - CLng(MemAddress))\n\n    b = VirtualFree(MemAddress, 0, MEM_RELEASE)\n    Debug.Print Err.LastDllError\n\n    If l = 0 Then Exit Sub\n\n    Debug.Print strProxyHostName\n\nEnd Sub\n</code></pre>\n\n<p>A bit heavy, but it works without crashing Excel (as does any \"CallAPIByName\" code in VB I could find over the internet), but still getting <code>ERROR_CAN_NOT_COMPLETE 1003L</code>.</p>\n\n<p><strong>Step 4 - The problem</strong></p>\n\n<p>1/ Then, I discovered that if one calls <code>InternetGetProxyInfo</code> from a \"Single-Thread Apartment\" thread, it will apparently inevitably fail with <code>ERROR_CAN_NOT_COMPLETE</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7847371/wininet-internetgetproxyinfo-error-1003-error-can-not-complete\">WinINet InternetGetProxyInfo : error 1003 ERROR_CAN_NOT_COMPLETE</a></p>\n\n<p>2/ I have also come to understand that Excel's process is actually single-threaded, and more precisely lives in a Single-Threaded Apartment (meaning COM has been initialized with <code>OleInitialize</code>/<code>CoInitialize</code>)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5721564/multi-threading-in-vba\">Multi-threading in VBA</a></p>\n\n<p>3/ Another source below explains that:</p>\n\n<blockquote>\n  <p>\"JSProxy uses COM and it can not work properly in case other appartement COM initialization is performed on the same thread.\"</p>\n</blockquote>\n\n<p><a href=\"http://microsoft.public.win32.programmer.networks.narkive.com/RMOcV126/internetgetproxyinfo-fails-with-error-can-not-complete-result\" rel=\"nofollow noreferrer\">http://microsoft.public.win32.programmer.networks.narkive.com/RMOcV126/internetgetproxyinfo-fails-with-error-can-not-complete-result</a></p>\n\n<p>So, here is my last foolish attempt:</p>\n\n<pre><code>hThread = CreateThread(0, 0, MemAddress, 0, 0, 0)\nCall WaitForSingleObject(hThread, INFINITE)\nDim lpExitCode As Long\nb = GetExitCodeThread(hThread, lpExitCode)\nCloseHandle hThread\n</code></pre>\n\n<p>Obviously it still does not return the string with proxy info.</p>\n\n<p>In my C++ example above, I noticed that indeed, adding the following gives the same behavior than in Excel:</p>\n\n<pre><code>HRESULT o = OleInitialize(NULL); // S_OK  = 0x0\n// after that, InternetGetProxyInfo fails with 1003L\n</code></pre>\n\n<p>I am not really familiar with OLE/COM/Threading concepts, and I fail to see how to easily go further. In light of everything I've said here, I guess I could sum up my question to :</p>\n\n<p><strong>How to call InternetGetProxyInfo from a non-\"Single-Threaded Apartment\" thread from Excel VBA using Win32 APIs ?</strong></p>\n\n<p>Windows 10 64-bit + Excel 2016 32-bit</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 3, "creation_date": 1526473068, "post_id": 50370698, "comment_id": 87757321, "body": "Post the macro as copyable text and not as an image. Do you expect someone to type it back in to debug it?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1526475912, "post_id": 50370698, "comment_id": 87759301, "body": "Please read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1526476056, "post_id": 50370698, "comment_id": 87759414, "body": "Please learn identing your code, or use <a href=\"http://www.oaltd.co.uk/indenter/\" rel=\"nofollow noreferrer\">oaltd.co.uk/indenter</a> !!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5887570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391ad84196f10bb47c845635765fc02?s=128&d=identicon&r=PG&f=1", "display_name": "Eelco", "link": "https://stackoverflow.com/users/5887570/eelco"}, "edited": false, "score": 0, "creation_date": 1526550783, "post_id": 50372102, "comment_id": 87792464, "body": "Unfortunately the -10 trick does not work. It will then give an error on the line below this one."}, {"owner": {"reputation": 1, "user_id": 5887570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391ad84196f10bb47c845635765fc02?s=128&d=identicon&r=PG&f=1", "display_name": "Eelco", "link": "https://stackoverflow.com/users/5887570/eelco"}, "edited": false, "score": 0, "creation_date": 1526550838, "post_id": 50372102, "comment_id": 87792495, "body": "Good to mention is that when we run the macro on an English server, it goes fine. The 10 lines are added when we run the macro on a Japanese server. Anyone any clue?"}, {"owner": {"reputation": 1, "user_id": 5887570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391ad84196f10bb47c845635765fc02?s=128&d=identicon&r=PG&f=1", "display_name": "Eelco", "link": "https://stackoverflow.com/users/5887570/eelco"}, "edited": false, "score": 0, "creation_date": 1526550870, "post_id": 50372102, "comment_id": 87792517, "body": "It is not very clear to me what to adjust in regards to &#39;avoid using Select in Excel VBA&#39;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 5887570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391ad84196f10bb47c845635765fc02?s=128&d=identicon&r=PG&f=1", "display_name": "Eelco", "link": "https://stackoverflow.com/users/5887570/eelco"}, "edited": false, "score": 0, "creation_date": 1526551068, "post_id": 50372102, "comment_id": 87792662, "body": "@Eelco - read the <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">question and the answers here</a>. Then start looking into your code for words like <code>Select</code> and <code>Activate</code>  and try to rewrite the code, until these words are no more there."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1526476846, "creation_date": 1526476846, "answer_id": 50372102, "question_id": 50370698, "link": "https://stackoverflow.com/questions/50370698/excel-macro-adds-additional-10-lines/50372102#50372102", "title": "Excel Macro adds additional 10 lines", "body": "<p>It is really a good idea to <a href=\"https://stackoverflow.com/questions/1025844/what-is-refactoring-and-what-is-only-modifying-code\">refactor (rewrite)</a> the whole code, following the ideas here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n\n<p>However, for a very quick &amp; ugly, very dirty solution, change this line:</p>\n\n<pre><code>Lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row - 10\n</code></pre>\n\n<p>It will remove the last 10 rows, which are obviously not needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 5887570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391ad84196f10bb47c845635765fc02?s=128&d=identicon&r=PG&f=1", "display_name": "Eelco", "link": "https://stackoverflow.com/users/5887570/eelco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1526476846, "creation_date": 1526472941, "last_edit_date": 1526475827, "question_id": 50370698, "link": "https://stackoverflow.com/questions/50370698/excel-macro-adds-additional-10-lines", "title": "Excel Macro adds additional 10 lines", "body": "<p>I created a macro which basically does what I want. However, for some reason it always adds 10 additional empty lines in the CSV (shown as commas). When the end user offers the CSV to the external portal, this always creates 10 empty records. What should be removed or adjusted in the macro to avoid this?</p>\n\n<pre><code>Sub simpleXlsMerger()\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n'change folder path of excel files here\nSet dirObj = mergeObj.Getfolder(\"\\\\chr-fss001\\DataJapan\\Sagawa\\Sagawa_CSV\\\")\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\n'change \"A2\" with cell reference of start point for every files here\n'for example \"B3:IV\" to merge all files start from columns B and rows 3\n'If you're files using more than IV column, change it to the latest column\n'Also change \"A\" column on \"A65536\" to the same column as start point\nRange(\"A1:DZ1\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\nThisWorkbook.Worksheets(1).Activate\n\n'Do not change the following column. It's not the same column as above\nRange(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\nApplication.CutCopyMode = False\nbookList.Close\n\nNext\n\nColumns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5,     1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n    )), TrailingMinusNumbers:=True\nActiveSheet.Shapes.Range(Array(\"Button 1\")).Select\nRows(\"1:1\").Select\nSelection.Delete Shift:=xlUp\nRange(\"A1\").Select\nRange(\"I1\").Select\nSheets(\"Sheet1\").Select\nColumns(\"I:L\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Blad1\").Select\nColumns(\"I:I\").Select\nSelection.Insert Shift:=xlToRight\nRange(\"A1\").Select\nDim Lastrow As Long\nLastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\nCells(Lastrow, \"A\").Select\nActiveCell.Offset(1).Select\nActiveCell.EntireRow.Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\nRange(\"A1\").Select\nChDir \"J:\\Sagawa\\DailyPortalFile\"\nActiveWorkbook.SaveAs Filename:= _\n    \"J:\\Sagawa\\DailyPortalFile\\\" &amp; Format(Now, \"yyyy-mm-dd hh mm\") &amp; \"       Sagawa\", FileFormat:=xlCSV, _\n    CreateBackup:=False\n\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0jAir.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0jAir.jpg\" alt=\"CSV outcome with 10 lines as commas\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1526475909, "post_id": 50370479, "comment_id": 87759298, "body": "Won\u2019t Active.Workbook.Save True. save the changes?"}, {"owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1526477191, "post_id": 50370479, "comment_id": 87760257, "body": "@SolarMike I added that but still the same error message, I&#39;d also rather not save every time the sheet is activated."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1526479209, "creation_date": 1526479209, "answer_id": 50372953, "question_id": 50370479, "link": "https://stackoverflow.com/questions/50370479/excel-accept-changes/50372953#50372953", "title": "Excel Accept Changes", "body": "<p>You don't need the 2 commas when you specify a parameter by its name. </p>\n\n<p>And <code>Where:=</code> is looking for an address. So something like \u2026</p>\n\n<pre><code>ActiveWorkbook.AcceptAllChanges Where:=ActiveSheet.Cells.Address(External:=true) \n</code></pre>\n\n<p>might work. Or \u2026</p>\n\n<pre><code>ActiveWorkbook.AcceptAllChanges Where:=\"'\" &amp; ActiveSheet.Name &amp; \"'!\" &amp; ActiveSheet.Cells.Address\n</code></pre>\n"}], "owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1526479209, "creation_date": 1526472331, "last_edit_date": 1531161705, "question_id": 50370479, "link": "https://stackoverflow.com/questions/50370479/excel-accept-changes", "title": "Excel Accept Changes", "body": "<p>On sheet I have the following VBA code;</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    If ActiveWorkbook.MultiUserEditing Then\n\n        ActiveWorkbook.AcceptAllChanges , , Where:=ActiveSheet\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>However, when I select the sheet I get the following error message;</p>\n\n<blockquote>\n  <p>Method 'AcceptAllChanges' of object '_Workbook' failed</p>\n</blockquote>\n\n<p>What is wrong with my code? How do I get it to work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 1, "creation_date": 1526471611, "post_id": 50370223, "comment_id": 87756224, "body": "Multi-threading in VBA? LOL!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1526472624, "post_id": 50370223, "comment_id": 87757000, "body": "@rory.ap The idea is not so much to multithread the vba as to pass some of the  workload to another application/language."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1526484244, "post_id": 50370223, "comment_id": 87765637, "body": "Just a thought, but would it be possible to read the pointer of the picture, then read the bytes from there?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1526498292, "post_id": 50370223, "comment_id": 87773057, "body": "@RyanWildry Yes, it is.  I added more details to my post.  Thank you for you comments."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1526653611, "post_id": 50370223, "comment_id": 87842657, "body": "Thank you for sharing your code, it could be handy one day.  I am going to look into this further but I&#39;m not sure you&#39;re going to be able to speed it up without starting over with in different direction, but I&#39;m curious, <b>how often are you running this that qualifies &lt; 1/100th of a second per image as &quot;too slow&quot;?</b>    Not sure if you&#39;re aware, images are stored on the clipboard as a bitmaps (no Base64 involved there), which are pretty much the &quot;least efficient&quot; method there is.  Base64 isn&#39;t far off (which is why images take more space after conversion to Base64.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1526695327, "post_id": 50370223, "comment_id": 87857458, "body": "I could just do a first-time preload and everything would run smooth but I wanted to see if I could cut the time down.  The problem is that there are roughly 23000 valid Face ideas with only 8800ish icons of which only 4676 are unique.  For the first thousand or so t runs smooth but they have several 100+ clumps (even a 4000+ clump) of blank icons that slow things down.  I made a PowerShell script that can extract the base64 data but I won&#39;t run properly from Excel.  I was thnking about having it load the pictures in the background."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1526695951, "post_id": 50370223, "comment_id": 87857556, "body": "The end game is to make this: <a href=\"https://codereview.stackexchange.com/questions/194521/office-commandbarbutton-icon-browser-in-the-vbeditor\">Office CommandBarButton Icon Browser in the VBEditor</a>  into a complete menu Editor.  Extracting the base64 data will allow me to write HTML to a Web Browser control.  I want to be able to drag and drag copy items between list and repositioning them by dragging them."}], "owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1526498204, "creation_date": 1526471556, "last_edit_date": 1531164843, "question_id": 50370223, "link": "https://stackoverflow.com/questions/50370223/encode-base64-data-from-clipboard-image", "title": "Encode Base64 data from Clipboard Image", "body": "<p>I can get the Base64 data from a <code>CommandBarButton.Picture</code> by copying it to the Windows Clipboard and saving it to file.  </p>\n\n<p>Unfortunately, this process is too slow.  It takes about 45 seconds to process the 4676 unique images.  Is there a way to get the Base64 data directly from an image in the Windows Clipboard?</p>\n\n<p>Alternately, is there a way to Multithread the process?  I am working on running a PowerShell script that will process the clipboard but would rather do it directly from the VBA.</p>\n\n<pre><code>Option Explicit\n'Referrence: Stephen Bullen: http://www.oaltd.co.uk\n'Open the clipboard to read\nPrivate Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\n'Get a pointer to the bitmap/metafile\nPrivate Declare Function GetClipboardData Lib \"user32\" (ByVal wFormat As Integer) As Long\n'Close the clipboard\nPrivate Declare Function CloseClipboard Lib \"user32\" () As Long\n'Convert the handle into an OLE IPicture interface.\nPrivate Declare Function OleCreatePictureIndirect Lib \"olepro32.dll\" (PicDesc As uPicDesc, RefIID As GUID, ByVal fPictureOwnsHandle As Long, IPic As IPicture) As Long\n'Declare a UDT to store a GUID for the IPicture OLE Interface\nPrivate Type GUID: Data1 As Long: Data2 As Integer: Data3 As Integer: Data4(0 To 7) As Byte: End Type\n'Declare a UDT to store the bitmap information\nPrivate Type uPicDesc: Size As Long: Type As Long: hPic As Long: hPal As Long: End Type\nPrivate Declare Function GetObject Lib \"gdi32\" Alias \"GetObjectA\" (ByVal hObject As Long, ByVal nCount As Long, lpObject As Any) As Long\nPrivate Declare Function GetBitmapBits Lib \"gdi32\" (ByVal hBitmap As Long, ByVal dwCount As Long, lpBits As Any) As Long\n\nPrivate Type Bitmap\n    bmType As Long\n    bmWidth As Long\n    bmHeight As Long\n    bmWidthBytes As Long\n    bmPlanes As Integer\n    bmBitsPixel As Integer\n    bmBits As Long\nEnd Type\n\nPublic Sub SavePictureFromClipBoard(ImagePath As String)\n\n    Dim IPic As IPicture\n\n    OpenClipboard 0&amp;\n\n    OleCreatePictureIndirect getuPicInfo, getIID_IDispatch, True, IPic\n\n    SavePicture IPic, ImagePath\n\n    CloseClipboard\n\n    Set IPic = Nothing\n\nEnd Sub\n\nPrivate Function getIID_IDispatch() As GUID\n    Dim IID_IDispatch As GUID\n    With IID_IDispatch\n        .Data1 = &amp;H7BF80980\n        .Data2 = &amp;HBF32\n        .Data3 = &amp;H101A:\n        .Data4(0) = &amp;H8B\n        .Data4(1) = &amp;HBB\n        .Data4(2) = &amp;H0\n        .Data4(3) = &amp;HAA\n        .Data4(4) = &amp;H0\n        .Data4(5) = &amp;H30\n        .Data4(6) = &amp;HC\n        .Data4(7) = &amp;HAB\n    End With\n    getIID_IDispatch = IID_IDispatch\nEnd Function\n\nPrivate Function getuPicInfo() As uPicDesc\n    Const PICTYPE_BITMAP = 1\n    Dim uPicInfo As uPicDesc\n\n    ' Fill uPicInfo with necessary parts.\n    With uPicInfo\n        .Size = Len(uPicInfo)                         ' Length of structure.\n        .Type = PICTYPE_BITMAP                        ' Type of Picture\n        .hPic = GetClipboardData(xlBitmap)            ' Handle to image.\n        .hPal = xlBitmap                              ' Handle to palette (if bitmap).\n    End With\n    getuPicInfo = uPicInfo\nEnd Function\n\nPublic Function getADODBStream(ImagePath As String) As Byte()\n    Const adTypeBinary = 1\n    With CreateObject(\"ADODB.Stream\")\n        .Type = adTypeBinary\n        .Open\n        .LoadFromFile (ImagePath)\n        getADODBStream = .Read()\n    End With\nEnd Function\n\nPublic Function getBase64FromImageFile(ImagePath As String) As String\n    With CreateObject(\"MSXml2.DOMDocument\")\n        With .createElement(\"Base64Data\")\n            .DataType = \"bin.base64\"\n            .nodeTypedValue = getADODBStream(ImagePath)\n            getBase64FromImageFile = .Text\n        End With\n    End With\nEnd Function\n\nPublic Function getBase64FromByteArray(Bytes() As Byte) As String\n    With CreateObject(\"MSXml2.DOMDocument\")\n        With .createElement(\"Base64Data\")\n            .DataType = \"bin.base64\"\n            .nodeTypedValue = Bytes\n            getBase64FromByteArray = .Text\n        End With\n    End With\nEnd Function\n\nPublic Function getBytes(Picture1 As IPictureDisp) As Byte()\n    Dim PicBits() As Byte, PicInfo As Bitmap\n\n    GetObject Picture1, Len(PicInfo), PicInfo\n\n    ReDim PicBits((PicInfo.bmWidth * PicInfo.bmHeight * 3) - 1) As Byte\n\n    GetBitmapBits Picture1, UBound(PicBits), PicBits(0)\n\n    getBytes = PicBits()\nEnd Function\n</code></pre>\n\n<h2>Addendum</h2>\n\n<p>I am able to read the Byte() from the both the CommandBarButton and the ClipBoard Image. The problem I have i that the Bitmap has a Picture Byte(0 to 767) and a Mask Byte(0 to 767) that combine to form a complete Image.  Note:  the Mask is sort of background Image that determines the pixel intensity of the Picture. The SavePicture function seems to merge the two parts.  The ADODB.Stream saved file returns a Byte(0 to 821).</p>\n\n<p>When copied to the ClipBoard, the Byte() arrays both the ClipBoard IPicture and CommandBarButton Picture are identical.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/UqD2W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UqD2W.png\" alt=\"Bitmap Images\"></a></p>\n\n<p>The three Images above are the CommandBarButton Picture, CommandBarButton Mask, and the Clipboard Image saved to file and then loaded into Image controls.</p>\n\n<p>I am perplexed on how the two Byte() are combined and how the colors are derived from them.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1526471409, "creation_date": 1526471409, "answer_id": 50370184, "question_id": 50369661, "link": "https://stackoverflow.com/questions/50369661/address-of-a-range-in-excel/50370184#50370184", "title": "Address of a range in Excel", "body": "<p>Consider:</p>\n\n<pre><code>Sub adres()\n    Dim r As Range, s As String, rr As Range\n    Set r = Selection.Cells.SpecialCells(xlCellTypeVisible)\n    s = \"\"\n\n    For Each rr In r\n        s = s &amp; \",\" &amp; rr.Address(0, 0)\n    Next rr\n\n    s = Mid(s, 2)\n    MsgBox s\nEnd Sub\n</code></pre>\n\n<p>You can use <code>Areas</code> if you want to \"condense\" the string a little.</p>\n"}], "owner": {"reputation": 1, "user_id": 9799728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Newton", "link": "https://stackoverflow.com/users/9799728/newton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526473449, "creation_date": 1526469926, "last_edit_date": 1526473449, "question_id": 50369661, "link": "https://stackoverflow.com/questions/50369661/address-of-a-range-in-excel", "title": "Address of a range in Excel", "body": "<p>I use the following code to copy a selection's address to a variable (only visible cells), but only a maximum of 255 characters are copied to it. If address is longer than 255 characters it is limited. It is suppossed that string variables can be 63000 characters long, isn't it? How can I solve this? Thank you very much in advance.</p>\n\n<p>The code:</p>\n\n<pre><code>Sel=Selection.SpecialCells(xlCellTypeVisible).Address(False, False)\n</code></pre>\n\n<p>Variable content:</p>\n\n<pre><code>C6:C10,C12:C13,C15:C27,C29:C31,C33:C54,C56:C64,C66,C68:C71,C73:C81,C83:C84,C86:C87,C89:C101,C103:C122,C124:C132,C135:C155,C158:C162,C164:C166,C168:C187,C189:C192,C194:C199,C201:C212,C214,C216:C233,C235:C251,C253:C262,C264:C267,C269:C270,C272:C292,C294\n</code></pre>\n\n<p>(251 characters)</p>\n\n<p>What it should looks like (for example):</p>\n\n<pre><code>C6:C10,C12:C13,C15:C27,C29:C31,C33:C54,C56:C64,C66,C68:C71,C73:C81,C83:C84,C86:C87,C89:C101,C103:C122,C124:C132,C135:C155,C158:C162,C164:C166,C168:C187,C189:C192,C194:C199,C201:C212,C214,C216:C233,C235:C251,C253:C262,C264:C267,C269:C270,C272:C292,C294:C296,C299:C316\n</code></pre>\n\n<p>(266 characters)</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1526479392, "post_id": 50369434, "comment_id": 87761997, "body": "Are you saying you get an exception but you don&#39;t see what it is even with &quot;&#39;On Error Resume Next&quot; commented out?"}, {"owner": {"reputation": 21, "user_id": 9799636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6kLs9Z-Ac8s/AAAAAAAAAAI/AAAAAAAAAvU/qw9Xdpss7Vw/photo.jpg?sz=128", "display_name": "Daston1984", "link": "https://stackoverflow.com/users/9799636/daston1984"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1526482405, "post_id": 50369434, "comment_id": 87764346, "body": "That&#39;s correct even with the &quot;On Error Resume Next&quot; removed it jumps straight to End Sub. It fails to send the email and keeps the current workbook open.   It then goes back to the original Sub and continues to loop to the next lot of data."}, {"owner": {"reputation": 21, "user_id": 9799636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6kLs9Z-Ac8s/AAAAAAAAAAI/AAAAAAAAAvU/qw9Xdpss7Vw/photo.jpg?sz=128", "display_name": "Daston1984", "link": "https://stackoverflow.com/users/9799636/daston1984"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1526640907, "post_id": 50369434, "comment_id": 87834636, "body": "Quick update, I have come to another spreadsheet we use that has the same email code in excel.   With &quot;On Error Goto 0&quot; inserted before the &quot;With EmailItem&quot; I do get an error when trying to .Send.   I receive  the good old Run Time 287 Application Defined or object defined error.   Could this be due to different trust centre settings in outlook or tighter security? I have noticed that our ICT guys have locked our trust centre settings to high security when it used to be low."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1598032310, "post_id": 50369434, "comment_id": 112336167, "body": "If <code>.Send</code> is disabled you may risk bypassing security with SendKeys. <a href=\"https://stackoverflow.com/a/48105643/1571407\">stackoverflow.com/a/48105643/1571407</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1526661029, "creation_date": 1526661029, "answer_id": 50415696, "question_id": 50369434, "link": "https://stackoverflow.com/questions/50369434/mailitem-send-in-vba-not-functioning-since-office-365-upgrade/50415696#50415696", "title": "MailItem.Send in VBA not functioning since Office 365 upgrade", "body": "<p>This describes how, in certain situations, you may \"make the object model fully functional\".</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/VBA/Outlook-VBA/articles/namespace-logon-method-outlook\" rel=\"nofollow noreferrer\">NameSpace.Logon Method (Outlook)</a></p>\n\n<blockquote>\n  <p>\"first, instantiate the Outlook Application object, then reference a default folder such as the Inbox. This has the side effect of initializing MAPI to use the default profile and to make the object model fully functional.\"</p>\n</blockquote>\n\n<pre><code>Sub InitializeMAPI ()\n\n    ' Start Outlook.\n    Dim olApp As Outlook.Application\n    Set olApp = CreateObject(\"Outlook.Application\")\n\n    ' Get a session object. \n    Dim olNs As Outlook.NameSpace\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n\n    ' Create an instance of the Inbox folder. \n    ' If Outlook is not already running, this has the side\n    ' effect of initializing MAPI.\n    Dim mailFolder As Outlook.Folder\n    Set mailFolder = olNs.GetDefaultFolder(olFolderInbox)\n\n    ' Continue to use the object model to automate Outlook.\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3266371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41353f8ff63c40000f00bebcbc7b676a?s=128&d=identicon&r=PG&f=1", "display_name": "JPB", "link": "https://stackoverflow.com/users/3266371/jpb"}, "is_accepted": false, "score": 0, "last_activity_date": 1598026561, "last_edit_date": 1598026561, "creation_date": 1564135023, "answer_id": 57217606, "question_id": 50369434, "link": "https://stackoverflow.com/questions/50369434/mailitem-send-in-vba-not-functioning-since-office-365-upgrade/57217606#57217606", "title": "MailItem.Send in VBA not functioning since Office 365 upgrade", "body": "<p>For security purposes, the HTMLBody, HTMLEditor, Body and WordEditor properties all are subject to address-information security prompts because the body of a message often contains the sender's or other people's e-mail addresses.</p>\n<p>HKCU\\Software\\Policies\\Microsoft\\office\\16.0\\outlook\\security\\</p>\n<p>promptoomaddressbookaccess\npromptoomaddressinformationaccess</p>\n<p><a href=\"https://support.microsoft.com/en-za/help/926512/information-for-administrators-about-e-mail-security-settings-in-outlo\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-za/help/926512/information-for-administrators-about-e-mail-security-settings-in-outlo</a></p>\n<p>The most probable cause is Outlook Security.</p>\n<p>You can find the security configurations in HKCU\\Software\\Policies\\Microsoft\\office\\16.0\\outlook\\security<br />\n(change 16.0 to your office version)</p>\n<p>Change promptoomsend to 2 (or ask your system administrator), restart Outlook and try again.</p>\n<p>More info <a href=\"https://support.microsoft.com/en-za/help/926512/information-for-administrators-about-e-mail-security-settings-in-outlo\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-za/help/926512/information-for-administrators-about-e-mail-security-settings-in-outlo</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9799636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6kLs9Z-Ac8s/AAAAAAAAAAI/AAAAAAAAAvU/qw9Xdpss7Vw/photo.jpg?sz=128", "display_name": "Daston1984", "link": "https://stackoverflow.com/users/9799636/daston1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2881, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1598026561, "creation_date": 1526469311, "last_edit_date": 1526482442, "question_id": 50369434, "link": "https://stackoverflow.com/questions/50369434/mailitem-send-in-vba-not-functioning-since-office-365-upgrade", "title": "MailItem.Send in VBA not functioning since Office 365 upgrade", "body": "<p>We send out a lot of spreadsheets around the organisation, in order to automate this as much as possible we wrote some code to send this automatically and allow us to still put body text in. </p>\n\n<p>This particular Script picks information up from our Finance System (SAP) dumps it into Excel and emails it to the user, it loops through a number times downloading and emailing different data each time. </p>\n\n<p>This works fine on our old windows 7 (Office 2010) machines but some of us have been given new Windows 10 (Office 365) machines to pilot. </p>\n\n<p>The code runs without any error messages but when it gets to .Send it jumps straight to End Sub and does not send the email. </p>\n\n<p>I have tried EmailItem.Display and you can see the email being populated and then just stays visible on the desktop as it loops through the rest of the emails. </p>\n\n<p>Any ideas on how to get round this? I could use the application.send function but I like to have the ability to add custom text into the email body. </p>\n\n<p>Thanks :)</p>\n\n<pre><code>Sub EmailData()\n\nDim OL As Object\nDim EmailItem As Object\nDim y As Long\nDim TempChar As String\nDim Bodytext As String\nDim Flds As Variant\nDim EmailText As Range\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\n'Email Download to nursery\n\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.Createitem(OLMailItem)\n\n\n'Check File Name is correct\nFilename = Range(\"A1\") &amp; \".xls\"\nFor y = 1 To Len(Filename)\n    TempChar = Mid(Filename, y, 1)\n    Select Case TempChar\n    Case Is = \"/\", \"\\\", \"*\", \"?\", \"\"\"\", \"&lt;\", \"&gt;\", \"|\"\n    Case Else\n        SaveName = SaveName &amp; TempChar\n    End Select\nNext y\nActiveSheet.Cells.Copy\nWorkbooks.Add\nSelection.PasteSpecial Paste:=xlValues\nSelection.PasteSpecial Paste:=xlFormats\nWith ActiveWindow\n    .DisplayGridlines = False\n    .DisplayZeros = False\nEnd With\nRange(\"A1:S38\").Select\nSelection.Locked = True\nSelection.FormulaHidden = False\nSet EmailText = ActiveSheet.Range(\"AB1:AB5\").SpecialCells(xlCellTypeVisible)\n\nActiveSheet.Protect (\"keepsafe\")\nActiveWorkbook.SaveAs Networkpath &amp; \"\\\" &amp; SaveName, , \"\", , True\nActiveWorkbook.ChangeFileAccess xlReadOnly\n\n\n EmailItem.display\n\n'On Error Resume Next\nWith EmailItem\n.To = \"Daston@blahblah.uk\"\n'.To = Range(\"AA1\")\n.CC = \"\"\n.BCC = \"\"\n.Subject = Filename\n.HTMLBody = RangetoHTML(EmailText)\n.Attachments.Add ActiveWorkbook.FullName\n\n.send\nEnd With\n\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\nKill Networkpath &amp; \"\\\" &amp; SaveName\nActiveWorkbook.Close False\n\n\nSet OL = Nothing\nSet EmailItem = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1526476279, "post_id": 50369187, "comment_id": 87759567, "body": "It almost sounds like it should be easy, but I don&#39;t know what <i>I split it via delimiter and then want to offset each split part into the row</i> means.  In your comments on answers below you give <code>130091 1000091</code> as examples, but I don&#39;t know what the original string is or how you got to those figures - offsetting by a split I guess.  Your code is splitting by a <code>Q</code> delimiter, but those figures don&#39;t contain a <code>Q</code>.... I&#39;m confused!  How do you define <code>rng</code>?  Is the code a sub or function? ....."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470214, "post_id": 50369455, "comment_id": 87755258, "body": "Hello, with this code it is not outputting anything in Column H, Changed to, Worksheets(&quot;Calendar&quot;).Range(&quot;H&quot; &amp; rng.Row).Value = WordsList(i) but still only outputs in first row and doesnt go into second for second value"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470316, "post_id": 50369455, "comment_id": 87755331, "body": "@AshleyDavies I&#39;ve now updated my answer, I believe it should now work for you."}, {"owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470540, "post_id": 50369455, "comment_id": 87755504, "body": "@Ashley Davies You should also look into how for each loops work. They automatically attribute the content of wordlist(o) to element. They do not however increment an iteration counter (you must do that by writing n=n+1 inside the loop). In your case, a for next loop is perhaps the best option."}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470596, "post_id": 50369455, "comment_id": 87755546, "body": "@Xabier I have used that code, we are getting somewhere, but now it is outputting them directly down, like this, 130091 100091 91930 99115 99805"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470633, "post_id": 50369455, "comment_id": 87755573, "body": "I would want it, 130091 1000091"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526470648, "post_id": 50369455, "comment_id": 87755584, "body": "and so on down and down, different values and amount of collections each time"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526474342, "post_id": 50369455, "comment_id": 87758160, "body": "Unfortunetely does still not do what i want, It is now putting the values in the same column but with the two in the same cell, I need seperate cells for each value and then to the next line"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1526474507, "post_id": 50369455, "comment_id": 87758266, "body": "All I want, is for each value in wordlist to go in seperate cells on the right and then next row = new wordlist so same again and so on so on"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 1, "creation_date": 1526475394, "post_id": 50369455, "comment_id": 87758892, "body": "@AshleyDavies I think I understood now, first value in column H, second value in Column I, then next row and the same... Please see my updated code once more..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1526475354, "last_edit_date": 1526475354, "creation_date": 1526469345, "answer_id": 50369455, "question_id": 50369187, "link": "https://stackoverflow.com/questions/50369187/looping-through-wordslist-cannot-offset-data-per-collection/50369455#50369455", "title": "Looping Through WordsList Cannot Offset Data per Collection", "body": "<p>I believe the following will do what you expect, it will get all the values in WordsList and enter each value into a new row on Column H:</p>\n\n<pre><code>Dim undelimitedstring As String\n\nundelimitedstring = AlphaNumericOnly(Rng.Value)\n\nWordsList = Split(undelimitedstring, \"Q\")\n\nresult = \"\"\n\nFor i = 1 To UBound(WordsList)\n    NextFreeRow= Worksheets(\"Calendar\").Cells(Worksheets(\"Calendar\").Rows.Count, \"H\").End(xlUp).Row + 1\n    Worksheets(\"Calendar\").Range(\"H\" &amp; NextFreeRow).Value = WordsList(i)\nNext i\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>The amended code below will add two values from WordList to a row in adjacent cells and then move to the next row and add the next two values, and so on:</p>\n\n<pre><code>Dim undelimitedstring As String\n\nundelimitedstring = AlphaNumericOnly(Rng.Value)\n\nWordsList = Split(undelimitedstring, \"Q\")\n\nresult = \"\"\nNextFreeRow = Worksheets(\"Calendar\").Cells(Worksheets(\"Calendar\").Rows.Count, \"H\").End(xlUp).Row + 1\nCounter = 0\nFor i = 1 To UBound(WordsList)\n    Counter = Counter + 1\n    Worksheets(\"Calendar\").Range(\"H\" &amp; NextFreeRow).Value = WordsList(i)\n    If Counter = 2 Then\n    Worksheets(\"Calendar\").Range(\"I\" &amp; NextFreeRow).Value = WordsList(i)\n        NextFreeRow = NextFreeRow + 1\n        Counter = 0\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1526478251, "creation_date": 1526478251, "answer_id": 50372607, "question_id": 50369187, "link": "https://stackoverflow.com/questions/50369187/looping-through-wordslist-cannot-offset-data-per-collection/50372607#50372607", "title": "Looping Through WordsList Cannot Offset Data per Collection", "body": "<p>Bit of a guess here on what you mean by  </p>\n\n<blockquote>\n  <p>I split it via delimiter and then want to offset each split part into\n  the row</p>\n</blockquote>\n\n<p>This code will take a string like <strong>123 456 Q 654 321 987 Q 789 012</strong> and split it to three rows:</p>\n\n<ul>\n<li>123 456  </li>\n<li>654 321 987  </li>\n<li>789 012  </li>\n</ul>\n\n<p><strong>To use:</strong><br>\nIf A1 contains <strong>123 456 Q 654 321 987 Q 789 012</strong> then highlight <code>C1:C3</code> and enter <code>=SplitString(A1)</code> as an array formula.  </p>\n\n<pre><code>Public Function SplitString(Target As Range, Optional Delim As String = \"Q\") As Variant\n\n    SplitString = Application.WorksheetFunction.Transpose(Split(Target, Delim))\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If you want it as a procedure rather than a function use:  </p>\n\n<pre><code>Sub Test()\n\n    SplitString_2 Sheet1.Range(\"A1\"), Sheet1.Range(\"D1\")\n\nEnd Sub\n\nPublic Sub SplitString_2(Target As Range, Destination As Range, Optional Delim As String = \"Q\")\n\n    Dim vSplit As Variant\n    Dim lElements As Long\n\n    vSplit = Split(Target, Delim)\n    lElements = UBound(vSplit) + 1 'Assumes LBound = 0\n\n    Destination.Resize(lElements) = Application.WorksheetFunction.Transpose(vSplit)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 50369455, "answer_count": 2, "score": -1, "last_activity_date": 1526478251, "creation_date": 1526468587, "last_edit_date": 1531164843, "question_id": 50369187, "link": "https://stackoverflow.com/questions/50369187/looping-through-wordslist-cannot-offset-data-per-collection", "title": "Looping Through WordsList Cannot Offset Data per Collection", "body": "<p>A bit of a dumb question probably an easy answer! </p>\n\n<p>I am trying to loop through data, I split it via delimiter and then want to offset each split part into the row, and move onto the next row / data, </p>\n\n<p>Here is my code: </p>\n\n<pre><code>Dim undelimitedstring As String\n\n    undelimitedstring = AlphaNumericOnly(rng.Value)\n\n    WordsList = Split(undelimitedstring, \"Q\")\n\n    result = \"\"\n    Count = UBound(WordsList)\n\n    For i = 1 To Count\n\n        Dim ios As Integer\n        ios = 0\n        Worksheets(\"Calendar\").Range(\"H\" &amp; rng.Row).Activate\n        MsgBox (WordsList(i))\n\n        For Each element In WordsList\n            Dim n As Integer\n            Dim o As Integer\n            n = 0\n            o = 1\n            ActiveCell.Offset(0, n).Value = WordsList(o)\n        Next element\n\n    ios = ios + 1\n    Next i\n</code></pre>\n\n<p>If someone can help that would be fab! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 518, "user_id": 8676647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UIJYh.png?s=128&g=1", "display_name": "ifo20", "link": "https://stackoverflow.com/users/8676647/ifo20"}, "is_accepted": false, "score": 2, "last_activity_date": 1526469010, "creation_date": 1526469010, "answer_id": 50369321, "question_id": 50369153, "link": "https://stackoverflow.com/questions/50369153/how-get-the-word-after-last-slash-in-a-multi-lined-cell-using-excel-vba/50369321#50369321", "title": "how get the word after last slash in a multi lined cell using excel vba", "body": "<p>The lines within a multiline cell are separated by CHAR(10)\nYou probably want to split based on that then for each line, you want the INSTRREV function - <a href=\"https://www.techonthenet.com/excel/formulas/instrrev.php\" rel=\"nofollow noreferrer\">see examples here</a></p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1526469796, "creation_date": 1526469796, "answer_id": 50369606, "question_id": 50369153, "link": "https://stackoverflow.com/questions/50369153/how-get-the-word-after-last-slash-in-a-multi-lined-cell-using-excel-vba/50369606#50369606", "title": "how get the word after last slash in a multi lined cell using excel vba", "body": "<p>I believe the following code will do what you expect it to:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set you worksheet\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on column A\n\nFor i = 1 To LastRow 'loop from row 1 to last\n    ValueList = Split(ws.Cells(i, 1).Value, vbLf) 'split next line values into array\n    For x = LBound(ValueList) To UBound(ValueList) 'loop through array\n        pos = InStrRev(ValueList(x), \"/\") 'get the position of the last /\n        ValueList(x) = Right(ValueList(x), Len(ValueList(x)) - pos) 'remove everything before the last /\n        ws.Cells(i, 2).Value = ws.Cells(i, 2).Value &amp; vbLf &amp; ValueList(x) 'pass the newly created values into Column B\n    Next x\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9665007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766f6ee2f47a4cd1eefd6891fb18575?s=128&d=identicon&r=PG&f=1", "display_name": "User1995", "link": "https://stackoverflow.com/users/9665007/user1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50369606, "answer_count": 2, "score": 1, "last_activity_date": 1526469796, "creation_date": 1526468505, "last_edit_date": 1531164843, "question_id": 50369153, "link": "https://stackoverflow.com/questions/50369153/how-get-the-word-after-last-slash-in-a-multi-lined-cell-using-excel-vba", "title": "how get the word after last slash in a multi lined cell using excel vba", "body": "<p>I have a lot data in the mulitlined cell.I want the word after last slash in each line in a mutilined cell.I used this code  Worksheets(\"Sheet1\").Columns(\"A\").Replace What:=\"*/\", Replacement:=\"\", SearchOrder:=xlByColumns, MatchCase:=True\nBut it didn't worked.I want the format in the below image.Please help me out.\n<img src=\"https://i.stack.imgur.com/8GI8S.png\" alt=\"word after last slash in a multilined cell\"></p>\n\n<p>P.S.I am a beginner in excel vba </p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "edited": false, "score": 0, "creation_date": 1526562014, "post_id": 50369497, "comment_id": 87799811, "body": "Thanks for your reply, I&#39;ve just downloaded and installed Redemption and tried it. Whilst it does list all the names, I can&#39;t see how to then pull the email addresses of individuals from that...? Perhaps I&#39;m missing something really obvious."}, {"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "edited": false, "score": 1, "creation_date": 1527587427, "post_id": 50369497, "comment_id": 88171721, "body": "Relacing AE.Name with AE.smtpaddress worked perfectly.  Thanks for putting me on the right track."}], "tags": [], "owner": {"reputation": 38, "user_id": 1521544, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e9sN9xAZmjQ/AAAAAAAAAAI/AAAAAAAAB5Q/BgurUvi0Omk/photo.jpg?sz=128", "display_name": "Joel Magoun", "link": "https://stackoverflow.com/users/1521544/joel-magoun"}, "is_accepted": true, "score": 1, "last_activity_date": 1526469510, "creation_date": 1526469510, "answer_id": 50369497, "question_id": 50369134, "link": "https://stackoverflow.com/questions/50369134/find-email-address-from-gal-for-two-people-with-same-name/50369497#50369497", "title": "Find email address from GAL for two people with same name", "body": "<p>Unfortunately this is not something that you can achieve with just VBA.</p>\n\n<p>On the Extended MAPI level (C++ or Delphi only) you can create a PR_ANR restriction on the contents table of a particular search container (such as GAL). That is what Outlook does when it resolves a name you typed in the To edit box - it goes through all containers in the search path and applies the PR_ANR restriction. If there are multiple matches found, it displays a dialog box with the list. If there is a single match, it is returned and the search is stopped, otherwise it continues to the next container in the search path.</p>\n\n<p>Outlook Object Model however does not expose this functionality. If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> (any language) is an option, it exposes <a href=\"http://www.dimastr.com/redemption/rdoaddressbook.htm\" rel=\"nofollow noreferrer\">RDOAddressBook</a>.ResolveNameEx and <a href=\"http://www.dimastr.com/redemption/RDOAddressList.htm\" rel=\"nofollow noreferrer\">RDOAddressList</a>.ResolveNameEx, which return a list of matches.</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset AdrrEntries = Session.AddressBook.ResolveNameEx(\"john\")\nDebug.Print AdrrEntries.Count &amp; \" names were retruned by ResolveNameEx:\"\nDebug.Print \"------------\"\nfor each AE in AdrrEntries\nDebug.Print AE.Name\nnext\nDebug.Print \"------------\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 50369497, "answer_count": 1, "score": 2, "last_activity_date": 1610337471, "creation_date": 1526468445, "last_edit_date": 1610337471, "question_id": 50369134, "link": "https://stackoverflow.com/questions/50369134/find-email-address-from-gal-for-two-people-with-same-name", "title": "Find email address from GAL for two people with same name", "body": "<p>I'm creating a form in Access 2016 where a user can type in an individual's name and send that individual an email.</p>\n<p>My code will return the email address where the name is unique, however we have over 70,000 employees some of which have the same name.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GetEmail() \n\n    Set out_App = New Outlook.Application\n    Set out_NS = out_App.GetNamespace(&quot;MAPI&quot;)\n    Set out_Recip = out_NS.CreateRecipient(&quot;Gavin Thomson&quot;)\n\n    out_Recip.Resolve\n\n    Set out_Addr = out_Recip.addressEntry\n    Set out_ExUser = out_Addr.GetExchangeUser\n\n    MsgBox out_ExUser.primarysmtpaddress\n    \nEnd Sub\n</code></pre>\n<p>When I change the value to a name which exists more than once I get</p>\n<blockquote>\n<p>&quot;The operation failed.&quot;</p>\n</blockquote>\n<p>on <code>Set out_ExUser = out_Addr.GetExchangeUser</code>.</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9691767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FhtNMp-tSQs/AAAAAAAAAAI/AAAAAAAAD2w/TkSwz6qLBnM/photo.jpg?sz=128", "display_name": "josiesprx", "link": "https://stackoverflow.com/users/9691767/josiesprx"}, "edited": false, "score": 0, "creation_date": 1526469862, "post_id": 50369225, "comment_id": 87755052, "body": "Thanks for the code. Currently, it&#39;s bugging when I use.text in the 6th line, but works for .Value. It&#39;s also not returning any values, when I use the line break on line 6, I can see that the value of the Location variable never goes above 1. It should be between 6 and 9. Any further ideas would be amazing. Thanks again."}, {"owner": {"reputation": 25, "user_id": 9691767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FhtNMp-tSQs/AAAAAAAAAAI/AAAAAAAAD2w/TkSwz6qLBnM/photo.jpg?sz=128", "display_name": "josiesprx", "link": "https://stackoverflow.com/users/9691767/josiesprx"}, "edited": false, "score": 0, "creation_date": 1526472048, "post_id": 50369225, "comment_id": 87756565, "body": "Thanks for the update, there was no leading space in column Y and the location variable is still always 1. Annoyingly, in my half completed code, the location was changing correctly for each row. Cheers again!"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 25, "user_id": 9691767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FhtNMp-tSQs/AAAAAAAAAAI/AAAAAAAAD2w/TkSwz6qLBnM/photo.jpg?sz=128", "display_name": "josiesprx", "link": "https://stackoverflow.com/users/9691767/josiesprx"}, "edited": false, "score": 0, "creation_date": 1526476029, "post_id": 50369225, "comment_id": 87759394, "body": "That&#39;s cos I&#39;m an idiot! Location = instr(&quot; &quot;,trim(c.text)) should be location = instr(&quot; &quot;,c.text)  I got them the wrong way round!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1526470114, "last_edit_date": 1526470114, "creation_date": 1526468708, "answer_id": 50369225, "question_id": 50369068, "link": "https://stackoverflow.com/questions/50369068/excel-vba-extract-substring-based-on-instr-and-paste-into-worksheet2-loop-for-al/50369225#50369225", "title": "Excel VBA extract substring based on InStr and paste into worksheet2 loop for all cells in column", "body": "<pre><code>Dim Location as long\nDim c as range\nFor each c in range(\"Y:Y\")\n    Location = instr(\" \",trim(c.text))\n    if location &gt;0 then\n        sheets(\"Part 1\").range(\"C\" &amp; c.row).value = left(c,location)\n    end if\n next c\n</code></pre>\n\n<p>This assumes that you want them to appear in column C in the same row as they are in in column Y</p>\n\n<p>Edit to fix my error and to add a trim - I suspect you have a leading space in column Y?</p>\n"}], "owner": {"reputation": 25, "user_id": 9691767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FhtNMp-tSQs/AAAAAAAAAAI/AAAAAAAAD2w/TkSwz6qLBnM/photo.jpg?sz=128", "display_name": "josiesprx", "link": "https://stackoverflow.com/users/9691767/josiesprx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 50369225, "answer_count": 1, "score": 0, "last_activity_date": 1526470114, "creation_date": 1526468260, "question_id": 50369068, "link": "https://stackoverflow.com/questions/50369068/excel-vba-extract-substring-based-on-instr-and-paste-into-worksheet2-loop-for-al", "title": "Excel VBA extract substring based on InStr and paste into worksheet2 loop for all cells in column", "body": "<p>Microsoft Excel VBA</p>\n\n<p>I have a list of strings containing shop ID codes &amp; address combined in column Y, and I want to go down this list, extract just the ID code, and paste this into a second spreadsheet in column C.</p>\n\n<p>I am struggling with how to use a For statement to loop this for each cell in the columns, as I want the statement to find the info from a cell in Activesheet column Y, then paste the substring into Sheet Part 1 Column C, and then loop to the next cell in the range for both sheets.</p>\n\n<p>My insufficient code:</p>\n\n<p>set up a for loop for the Y column in ActiveSheet, where the shop ID info is stored</p>\n\n<pre><code>For Each cell In ActiveSheet.Range(\"Y:Y\")\n</code></pre>\n\n<p>create a location variable to store the instr value, should change each loop, not sure if this is the way to do it however</p>\n\n<pre><code>    Dim location As Integer\n</code></pre>\n\n<p>create an object that stores where the ID code finishes in my string</p>\n\n<pre><code>    location = InStr(1, ActiveSheets.Range(\"Y:Y\"), \" \")-1\n</code></pre>\n\n<p>using the left function with the location object, tell excel I want to copy the shop ID and paste it into column C in the Part 1 Sheet.</p>\n\n<pre><code>    Left(xCell, location).Copy Sheets(\"Part 1\").Range(\"C:C\")\n\nNext\n</code></pre>\n\n<p>Full Code without annotations:</p>\n\n<pre><code>For Each cell In ActiveSheet.Range(\"Y:Y\")\n    Dim location As Integer\n    location = InStr(1, ActiveSheets.Range(\"Y:Y\"), \" \")-1\n    Left(xCell, location).Copy Sheets(\"Part 1\").Range(\"C:C\")\nNext\n</code></pre>\n\n<p>Thanks for any advice</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1526466474, "post_id": 50368409, "comment_id": 87752854, "body": "SQL Server and MS Access are rather different.  Which are you really using?"}, {"owner": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1526466661, "post_id": 50368409, "comment_id": 87752979, "body": "Sorry, MS-Access"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1526466806, "post_id": 50368409, "comment_id": 87753073, "body": "A recordset has it&#39;s source. You should just query from that source, instead of querying the recordset. Querying a recordset indeed is not possible (you can filter and order, though), and there are no easy alternatives."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "edited": false, "score": 1, "creation_date": 1526466838, "post_id": 50368426, "comment_id": 87753089, "body": "But can x be a recordset? The data is stored in a recordset"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "edited": false, "score": 1, "creation_date": 1526467620, "post_id": 50368426, "comment_id": 87753621, "body": "No, data is always stored in tables. A recordset is a way to access that data. A query is another. @bimmer55"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 3, "last_activity_date": 1526466419, "creation_date": 1526466419, "answer_id": 50368426, "question_id": 50368409, "link": "https://stackoverflow.com/questions/50368409/count-distinct-from-a-recordset/50368426#50368426", "title": "Count distinct from a Recordset", "body": "<p>You are looking for <code>count(distinct)</code>:</p>\n\n<pre><code>SELECT COUNT(DISTINCT tag)\nFROM x;\n</code></pre>\n\n<p>MS Access doesn't support this standard functionality, so you can use a subquery:</p>\n\n<pre><code>SELECT COUNT(tag)\nFROM (SELECT DISTINCT tag FROM x) as xx\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526471863, "creation_date": 1526466383, "last_edit_date": 1526471863, "question_id": 50368409, "link": "https://stackoverflow.com/questions/50368409/count-distinct-from-a-recordset", "title": "Count distinct from a Recordset", "body": "<p>I have a recordset, I want to count how many different values has a \"column\" of that recordset.</p>\n\n<p>In a SQL query it would be something like that:</p>\n\n<pre><code>SELECT COUNT(tag) \nFROM x \nGROUP BY tag\n</code></pre>\n\n<p>Where <em>x</em> would be the recordset and <em>tag</em> would be the \"column\"</p>\n\n<p>For example, if <em>tag</em> is: y1,y1,y1,y2,y3,y3,y4,y4,y5 I want to get 5, since there are 5 different values for <em>tag</em>.</p>\n\n<p>The problem is that I can't execute a SQL query to the recordset.</p>\n"}, {"tags": ["vba", "excel", "copy", "powerpoint"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1526468796, "post_id": 50368068, "comment_id": 87754381, "body": "What issues are you getting with the code you have posted?  How does it differ from what you expect?  A minor change I would suggest is either capturing the <code>PPslide.Shapes.Paste</code> in an Object with (e.g. <code>Set PPShape = PPslide.Shapes.Paste</code>) or using it in a <code>With</code> (<code>With PPSlide.Shapes.Paste</code>), so that you can move it more easily"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": false, "score": 0, "last_activity_date": 1526469821, "creation_date": 1526469821, "answer_id": 50369614, "question_id": 50368068, "link": "https://stackoverflow.com/questions/50368068/copy-excel-data-to-exact-powerpoint-slide-cell-using-vba/50369614#50369614", "title": "Copy Excel data to exact PowerPoint slide cell using VBA", "body": "<p>You could create a custom layout with text boxes in the positions you want the cells. The text inside the text boxes can be used to identify them (e.g. \"mybox1\"). You can google how to add a new slide from a custom layout. Then search through the shapes and paste the cells in the same locations. Something like this:</p>\n\n<pre><code>'Paste\n  For Each PPshape In PPslide.Shapes\n    If PPshape.HasTextFrame Then\n        If PPshape.TextFrame.HasText Then\n            If PPshape.TextFrame.TextRange.Text = \"mybox1\" Then\n                PPslide.Shapes.Paste.Select\n                PP.ActiveWindow.Selection.ShapeRange.Left = PPshape.Left\n                PP.ActiveWindow.Selection.ShapeRange.Top = PPshape.Top\n                PPshape.Delete\n            End If\n        End If\n    End If\nNext PPshape\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9798729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cBSc1bGXHfg/AAAAAAAAAAI/AAAAAAAAABs/Wtoh3FKYxdE/photo.jpg?sz=128", "display_name": "Martin Zhechev", "link": "https://stackoverflow.com/users/9798729/martin-zhechev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526469821, "creation_date": 1526465407, "question_id": 50368068, "link": "https://stackoverflow.com/questions/50368068/copy-excel-data-to-exact-powerpoint-slide-cell-using-vba", "title": "Copy Excel data to exact PowerPoint slide cell using VBA", "body": "<p>So I have a working Macro that copies Excel rows as pictures, and pastes each picture in a new PowerPoint slide.</p>\n\n<p>So my job now is to to take individual data from an exact cell (for example A1, D1, H1, X1) and paste it in a predefined PowerPoint slide layout. So each cell goes to its corresponding place in the slide layout. I think only a bit of modifying is needed but I have absolutely no clue what to do. I'm really quite new with VBA so all help is appreciated.</p>\n\n<p>Thank you for your time and have a great day! :)</p>\n\n<pre><code>Sub CopyRangeToPresentation()\n'Variables\n  Dim PP As PowerPoint.Application\n  Dim PPpres As PowerPoint.Presentation\n  Dim PPslide As PowerPoint.Slide\n  Dim SlideTitle As String\n  Dim lRow As Long\n  Dim i As Integer\n'Fider\n  lRow = Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n'New presentation\nSet PP = New PowerPoint.Application\n  Set PPpres = PP.Presentations.Add\n  Set PP = GetObject(, \"PowerPoint.Application\")\n  PP.Visible = 1\n\nFor i = 1 To lRow\n'New slide\n      Set PPslide = PPpres.Slides.Add(i, ppLayoutBlank)\n      PP.ActiveWindow.ViewType = ppViewSlide\n      PPpres.PageSetup.SlideSize = ppSlideSizeOnScreen\n      PP.ActiveWindow.WindowState = ppWindowMaximized\n      PPslide.Select\n'Copy\n      Sheets(\"dataflows\").Range(Cells(i, 1), Cells(i, 24)).CopyPicture _\n      Appearance:=xlScreen, Format:=xlPicture\n'Paste\n      PPslide.Shapes.Paste.Select\n      PP.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n      PP.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\n'Title\nNext i\n\n'Memory\n      PP.Activate\n      Set PPslide = Nothing\n      Set PPpres = Nothing\n      Set PP = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1526465733, "post_id": 50367995, "comment_id": 87752364, "body": "Do yoiu have any non blank values in Column B? When you step through the code, what value is being assigned to lRow?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526465896, "post_id": 50367995, "comment_id": 87752468, "body": "Not sure why you think the above causes an infinite loop - unless your column B has some data near the very bottom of the sheet and you just ran out of patience before it got to the top.."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1526474498, "post_id": 50367995, "comment_id": 87758258, "body": "@Olly Yes there are non-blank values in in column B."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526474543, "post_id": 50367995, "comment_id": 87758288, "body": "@CLR I am assuming its an infinite loop because the macro does not stop. I let it run for about 10 minutes and nothing happened."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1526482355, "post_id": 50367995, "comment_id": 87764307, "body": "So when you step through the code, what value does lRow have?"}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526475106, "post_id": 50368171, "comment_id": 87758660, "body": "Thank you for your reply SJR. Unfortunately both solutions do not seem to be working. The first one just runs and does not stop, the second one causes excel to not respond and I need to force close it. Perhaps its worth mentioning that there are 8000 rows in the sheet?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526477924, "post_id": 50368171, "comment_id": 87760787, "body": "Just try the second method as you have quite a lot of data. Have you stepped through - what is the value of lRow?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526478035, "post_id": 50368171, "comment_id": 87760877, "body": "I&#39;ve made a few changes above so let me know how you get on."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526478817, "post_id": 50368171, "comment_id": 87761507, "body": "Maybe add the line <code>If iCntr Mod 50 = 0 Then Application.Statusbar = &quot;Row : &quot; &amp; iCntr</code> as the first line inside the <code>For... Next</code> loop to see where in the spreadsheet it is? If you do, reset <code>Application.Statusbar = False</code> before Ending the Sub."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526485225, "post_id": 50368171, "comment_id": 87766273, "body": "@CLR Thank you for the reply.. I did try to do what you suggested, but it did not work.. Program becomes unresponsive.."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526485327, "post_id": 50368171, "comment_id": 87766344, "body": "SJR - I tried again, and still the same thing happens.. Also, I need to correct my previous statement about the amount of of rows that there are.. Its actually quite a lot more - 99977 is the correct amount. If you will, please refer to the bottom of my post, I have updated it."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526485543, "post_id": 50368171, "comment_id": 87766478, "body": "You might want to change the <code>If</code> into an <code>If</code> and <code>End If</code> with the <code>StatusBar</code> line between them but also a <code>DoEvents</code> to ensure the status bar is updated..?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526487092, "post_id": 50368171, "comment_id": 87767404, "body": "How long did you wait? Have you stepped through? Does the status bar show anything?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526487181, "post_id": 50368171, "comment_id": 87767447, "body": "You might want to consult this question <a href=\"https://stackoverflow.com/questions/30959315/excel-vba-performance-1-million-rows-delete-rows-containing-a-value-in-less\" title=\"excel vba performance 1 million rows delete rows containing a value in less\">stackoverflow.com/questions/30959315/&hellip;</a> Do you have any other code in the file?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526489026, "post_id": 50368171, "comment_id": 87768387, "body": "OK now there is another method above which I ran on your file. It&#39;s not quick - it took about 35 seconds but did the job. The original code was also interminably slow for me."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526544687, "post_id": 50368171, "comment_id": 87788432, "body": "Okay, we are making progress! :) SJR, thank you, the latest solution does work 100%, but it is slow like you said, BUT again, its nearly 100 000 lines soooo yeah.. Also I did step through the code on the previous solution, it completely skips over the If Trim(.Cells(iCntr, 2).Value) = &quot;&quot; Then statement and goes straight to End If. I will mark this solution as correct, but if you can perhaps figure out why the if statement is skipped and I can test that too, it would be appreciated :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1526488977, "last_edit_date": 1526488977, "creation_date": 1526465749, "answer_id": 50368171, "question_id": 50367995, "link": "https://stackoverflow.com/questions/50367995/vba-delete-blank-rows-in-column-b-stuck-in-infinite-loop/50368171#50368171", "title": "VBA - Delete Blank Rows in Column B - Stuck in Infinite Loop", "body": "<p>You were still referencing column 1 in your first check (which is possibly redundant anyway). I have suggested an alternative approach to deleting rows which is more efficient (Autofilter is another option).</p>\n\n<pre><code>Sub DeleteBlankRows()\n\nDim lRow As Long, iCntr As Long, ws As Worksheet, wkbk1 As Workbook, r As Range\n\nSet wkbk1 = Workbooks(\"SampleBook.xlsm\")\nSet ws = wkbk1.Worksheets(\"HR\")\n\nApplication.ScreenUpdating = False\n\nWith ws\n    .AutoFilterMode = False\n    .Range(\"A1\").AutoFilter Field:=2, Criteria1:=\"=\"\n    With .AutoFilter.Range\n        On Error Resume Next\n        Set r = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        On Error GoTo 0\n        If Not r Is Nothing Then\n            r.EntireRow.Delete shift:=xlUp\n        End If\n    End With\n    .AutoFilterMode = False\nEnd With\n\n'With ws\n'    lRow = .Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n'    For iCntr = lRow To 1 Step -1\n'        If Trim(.Cells(iCntr, 2).Value) = \"\" Then\n'            If r Is Nothing Then\n'                Set r = .Cells(iCntr, 2)\n'            Else\n'                Set r = Union(r, .Cells(iCntr, 2))\n'            End If\n'        End If\n'    Next iCntr\n'End With\n'If Not r Is Nothing Then r.EntireRow.Delete shift:=xlUp\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 50368171, "answer_count": 1, "score": 0, "last_activity_date": 1526488977, "creation_date": 1526465231, "last_edit_date": 1526485384, "question_id": 50367995, "link": "https://stackoverflow.com/questions/50367995/vba-delete-blank-rows-in-column-b-stuck-in-infinite-loop", "title": "VBA - Delete Blank Rows in Column B - Stuck in Infinite Loop", "body": "<p>I have the code below which deletes the blank rows in column A for all worksheets in the workbook - and it works well.</p>\n\n<p><em>Code:</em></p>\n\n<pre><code>Option Explicit\n\nSub DeleteBlankRows()\n\n    Dim lRow As Long\n    Dim iCntr As Long\n    Dim ws As Worksheet\n    Dim wkbk1 As Workbook\n\n    Set wkbk1 = Workbooks(\"test.xlsm\")\n\n    wkbk1.Activate\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        ' Find last row in column A\n        lRow = ws.Range(\"A\" &amp; ws.Rows.count).End(xlUp).Row\n\n        For iCntr = lRow To 1 Step -1\n\n            If IsEmpty(ws.Cells(iCntr, 1)) Or Trim(ws.Cells(iCntr, 1).Value) = \"\" Then\n\n                ws.Rows(iCntr).Delete\n\n            End If\n\n        Next iCntr\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>When I modify this code for a different purpose - to delete the blank rows in column B of a specific worksheet, then it just gets stuck in a loop and it did not delete a single row.</p>\n\n<pre><code>Option Explicit\n\nSub DeleteBlankRows()\n\n    Dim lRow As Long\n    Dim iCntr As Long\n    Dim ws As Worksheet\n    Dim wkbk1 As Workbook\n\n    Set wkbk1 = Workbooks(\"test.xlsm\")\n    Set ws = wkbk1.Worksheets(\"sheet1\")\n\n    wkbk1.Activate\n    ws.Activate\n\n    With ws\n\n        ' Find last row in column A\n        lRow = ws.Range(\"B\" &amp; ws.Rows.count).End(xlUp).Row\n\n        For iCntr = lRow To 1 Step -1\n\n            If IsEmpty(ws.Cells(iCntr, 1)) Or Trim(ws.Cells(iCntr, 2).Value) = \"\" Then\n\n                ws.Rows(iCntr).Delete\n\n            End If\n\n        Next iCntr\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I basically need help to let the code execute without getting stuck in a loop and to delete the blank rows found in column B on sheet1.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I have uploaded a sample file to Google Drive if anyone would like to test on the file itself.</p>\n\n<p><a href=\"https://drive.google.com/file/d/1ImIqiA0znynSXAyZnUtpCG8mRIFlnXAl/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1ImIqiA0znynSXAyZnUtpCG8mRIFlnXAl/view?usp=sharing</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1526466192, "post_id": 50367854, "comment_id": 87752669, "body": "What data do you want to average? How about you write code to average that data? What is your question?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526466220, "post_id": 50367854, "comment_id": 87752696, "body": "The <b>best</b> way of doing this would be within the SQL itself."}, {"owner": {"reputation": 13, "user_id": 9757156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e90059d6ecc4e83d5e6e4b2ec6ee073?s=128&d=identicon&r=PG&f=1", "display_name": "Aim&#233;", "link": "https://stackoverflow.com/users/9757156/aim%c3%a9"}, "edited": false, "score": 0, "creation_date": 1526469902, "post_id": 50367854, "comment_id": 87755078, "body": "here above is the code to calculate the Fuel index for 9 countries by weeks translate into months (January, February and so on) through an Access database. With this code I can estimate the sum by months but not the average. I&#39;m wondering where exactly I have to insert the average functions?"}], "owner": {"reputation": 13, "user_id": 9757156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e90059d6ecc4e83d5e6e4b2ec6ee073?s=128&d=identicon&r=PG&f=1", "display_name": "Aim&#233;", "link": "https://stackoverflow.com/users/9757156/aim%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526465057, "creation_date": 1526464835, "last_edit_date": 1531164843, "question_id": 50367854, "link": "https://stackoverflow.com/questions/50367854/vba-excel-average", "title": "VBA excel average", "body": "<p>I'm looking to calculate the average of multiples columns into each months of the year through a VBA code without having to divide by the numbers of weeks for each month. Can someone help me to figure out where I have to insert the average in my code?</p>\n\n<pre><code>Private Sub CALCULATE_BTN_Click()\n    Dim DBS As Database\n    Dim RST As Recordset\n    Dim SQL_TXT As String\n    Range(\"AA9:BV10\").Select\n    Selection.Clear\n\n    If OPEN_DBS(DBS, FUEL_DB) Then\n        SQL_TXT = \"SELECT * FROM FUEL_DATA\"\n        If OPEN_RST(DBS, RST, SQL_TXT) Then\n            While Not RST.EOF\n                For i = 1 To 12\n                    If Month(RST![FUELDATA_DATE]) = Month(Cells(8, 26 + i).Value) And Year(RST![FUELDATA_DATE]) = Year(Cells(8, 26 + i).Value) Then\n                        Cells(9, 26 + i).Value = Cells(9, 26 + i).Value + RST![FUELDATA_AUTOMOTIVE] / 9 / 1000\n                    End If\n                Next i\n                RST.MoveNext\n            Wend\n            RST.Close\n        End If\n        DBS.Close\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1526571361, "post_id": 50367753, "comment_id": 87806536, "body": "Did you show an example of your first data line only within a loop? In any case plz (1) Could you add some example data to your question by <i>editing your OP</i> (especially in column XY containing &quot;BUKRS&quot; and cell BH1 (<code>cells(1,60)</code>)? (2) Do you export your data row wise? - if not, you would have to edit the <code>ExportData</code> code, too. (3) Did you declare variables in the declaration head of your code module (or public) or in the cited Sub VENDOR (assume you use <code>Option Explicit</code>)? (4) Please edit occuring error messages of your code so far."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1526571914, "post_id": 50367753, "comment_id": 87806914, "body": "BTW: when using <code>Application.WorksheetFunction.HLookup</code>, it&#39;s necessary that you always find a column containing &quot;BUKRS&quot;, otherwise you&#39;ll have to provide by error trapping. (the alternative <code>Application.HLookup</code> function would require a somewhat different approach via <code>IsError</code>)"}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1527088407, "post_id": 50367753, "comment_id": 87996702, "body": "The whole issue was actually related to the macros that I called from the procedures. Thank you TM nonetheless!"}], "owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526464587, "creation_date": 1526464587, "last_edit_date": 1531164843, "question_id": 50367753, "link": "https://stackoverflow.com/questions/50367753/vba-excel-cannot-insert-right-data-into-loadfiles", "title": "VBA Excel - cannot insert right data into loadfiles", "body": "<p>I have an issue with creating .txt load files for SAP LSMW. The code takes data from an opened workbook and then populates various .txt files by various conditions - mostly by headers. The file worked well, but I would like to move data into two separate load files based on the data that is in the column under \"BUKRS\". Here comes an issue with Hlookup not being able to look for various values. Moreover, all of the data gets saved only to the file \"05-Vend-Loadcache(No WHTAX).xls\" I woudl like to divide the files by cost centre numbers that are in column \"BUKRS\". These are 9000, 5500, 6200, 8400, 8600, 8500. These ones should go to \"06-Vend-Loadcache(WHTAX).xls\". Unfortunately it does not work and only \"05-Vend-Loadcache(No WHTAX).xls\" gets populated. I have no clue why? Could you help me, please? </p>\n\n<pre><code>Sub VENDOR()\n'CC3200 (LSMW1)  LNRZB (LSMW4) Line 60 for 5500 ....\n\nCCD = Application.WorksheetFunction.HLookup(\"BUKRS\", DTA.Range(\"A1:IV2\"), 2, 0)\nCCE = DTA.Cells(1, 60)\nWFNA = \"05-Vend-Loadcache(No WHTAX).xls\"\n\n\nSelect Case CCD\nCase 9000, 5500, 6200, 8400, 8600, 8500\nWFNA = \"06-Vend-Loadcache(WHTAX).xls\"\nEnd Select\n\nSHT = \"BISOVSH\"\nDATACHK = 1\n\nIf ((CCE = \"\" Or CCE = \"CC3200\" Or CCE = \"VERKF\" Or CCE = \"TELF1\" Or CCE = \"KZRET\") And WFNA = \"05-Vend-Loadcache(No WHTAX).xls\") Then\nCall EXPORTDTA\nElse\n'do nothing as not to Export\n End If\n\nIf CCE = \"LNRZB\" And WFNA = \"06-Vend-Loadcache(WHTAX).xls\" Then\nCall EXPORTDTA\nElse\n'do nothing as not to Export\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1526470941, "post_id": 50368922, "comment_id": 87755793, "body": "Thank you, I tried that on my data and the formatting copied across perfectly but it didn&#39;t change the formulas to values? any ideas?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1526471429, "post_id": 50368922, "comment_id": 87756106, "body": "If A1 has blank cells around it then dest.currentregion.copy would fail. Try  dest.parent.usedrange.copy instead"}, {"owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "edited": false, "score": 0, "creation_date": 1526477074, "post_id": 50368922, "comment_id": 87760173, "body": "Still no luck with the following - seems strange! <code>&#39;Copy and PasteSpecial a between worksheets     Dim dest As Range     Set dest = Worksheets(NewSheetName).Range(&quot;A1&quot;)     Worksheets(&quot;Monthly Summary&quot;).Range(&quot;I3:U2270&quot;).Copy dest     dest.Parent.UsedRange.Copy     dest.PasteSpecial xlPasteValues</code>"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1526467792, "creation_date": 1526467792, "answer_id": 50368922, "question_id": 50367704, "link": "https://stackoverflow.com/questions/50367704/vba-copy-and-pastespecial-table-values-and-formatting/50368922#50368922", "title": "VBA Copy and PasteSpecial Table Values and Formatting", "body": "<p>Copy everything including formulas, then change formulas to values in the copy</p>\n\n<pre><code>'Copy and PasteSpecial a between worksheets\n    dim dest as range\n    set dest = Worksheets(NewSheetName).Range(\"A1\")\n    Worksheets(\"Monthly Summary\").Range(\"I3:U2270\").Copy dest\n    dest.currentregion.copy\n    dest.pastespecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9653817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5b14de4197c338d5a517b1018d2437?s=128&d=identicon&r=PG", "display_name": "Dean Cohen", "link": "https://stackoverflow.com/users/9653817/dean-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5998, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526467792, "creation_date": 1526464483, "question_id": 50367704, "link": "https://stackoverflow.com/questions/50367704/vba-copy-and-pastespecial-table-values-and-formatting", "title": "VBA Copy and PasteSpecial Table Values and Formatting", "body": "<p>I am still new with VBA but decided using VBa to streamline a Monthly report i am working on for our payroll would be the most efficient way, I wish to export a range I3:U2270 into a new sheet named from a cell in the summary sheet.\neverything works fine except formatting;</p>\n\n<p>If I use <code>xlPasteAll</code> the formatting is perfect but it shows values as formulas.</p>\n\n<p>If I use: </p>\n\n<pre><code>.PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n.PasteSpecial Paste:=xlPasteColumnWidths\n.PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p>The data and cell widths are perfect but because some data is in Tables it doesn't bring the formatting across.</p>\n\n<p>Any ideas would be appreciated!</p>\n\n<pre><code>Sub MonthlySummaryExport()\n\n    Dim NewSheetName As String\n    Dim Newsheet As Object\n    On Error Resume Next\n    NewSheetName = Worksheets(\"Monthly Summary\").Range(\"T1\")\n    If NewSheetName = \"\" Then Exit Sub\n        Set Newsheet = Sheets(NewSheetName)\n        If Not Newsheet Is Nothing Then\n            MsgBox \"Sheet cannot be created as there is already a worksheet with the same name\" &amp; \" \" &amp; (NewSheetName)\n            Exit Sub\n            End If\n            Sheets.Add(, Sheets(Sheets.Count)).Name = NewSheetName\n\n    'Copy and PasteSpecial a between worksheets\n    Worksheets(\"Monthly Summary\").Range(\"I3:U2270\").Copy\n\n    With Worksheets(NewSheetName).Range(\"A1\")\n    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n    .PasteSpecial Paste:=xlPasteColumnWidths\n    .PasteSpecial Paste:=xlPasteFormats\n    End With\n\n    'Disable marching ants around copied range\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Any suggestions would be great! Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1526478705, "post_id": 50367919, "comment_id": 87761417, "body": "Thanks a lot @SJR works smooth :) I just added <code>Set Rng = Tabelle10.UsedRange</code> <code>Rng.RemoveDuplicates Columns:=Array(1)</code> to remove all duplicated rows. So <code>Tabelle10</code> is just listing everything once."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1526465028, "creation_date": 1526465028, "answer_id": 50367919, "question_id": 50367300, "link": "https://stackoverflow.com/questions/50367300/excel-vba-run-macro-automatically-whenever-a-cell-in-a-range-is-changed-by-drop/50367919#50367919", "title": "Excel VBA run macro automatically whenever a cell in a range is changed by drop down list", "body": "<p>You have to use Intersect as you cannot compare the address of a single cell with a range (not like for like for a start).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim lastrow As Long\n\nlastrow = Tabelle3.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(8).Row\n\nIf Not Intersect(Target, Range(\"AV9:AV\" &amp; lastrow)) Is Nothing And Target.Value &lt;&gt; \"\" Then\n   Cells(Target.Row, \"A\").Resize(, 2).Copy\n   Tabelle10.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n   Application.CutCopyMode = False\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 50367919, "answer_count": 1, "score": 0, "last_activity_date": 1526465028, "creation_date": 1526463429, "question_id": 50367300, "link": "https://stackoverflow.com/questions/50367300/excel-vba-run-macro-automatically-whenever-a-cell-in-a-range-is-changed-by-drop", "title": "Excel VBA run macro automatically whenever a cell in a range is changed by drop down list", "body": "<p>I do have a drop down list in every cell in <code>Tabelle3.Range(\"AV9:AV\" &amp; lastrow)</code>. If one of the options is selected in any row in this range <code>Then</code> the Values in <code>Cell A and B</code>of this row should be copied to the next free line in <code>Tablle10</code></p>\n\n<p>This is my code so far: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  Dim lastrow As Long\n\n  lastrow = Tabelle3.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(8).Row\n\n  If Target.Address = Range(\"AV9:AV\" &amp; lastrow) And Range(\"AV9:AV\" &amp; lastrow) &lt;&gt; \"\" Then\n     Range(\"A9:B9\").Copy\n     Tabelle10.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n\n     Application.CutCopyMode = False\n\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>However, if I select any option in a cell in <code>Tabelle3.Range(\"AV9:AV\" &amp; lastrow)</code> <code>run-time error 13</code> occurs in this line</p>\n\n<pre><code>If Target.Address = Range(\"AV9:AV\" &amp; lastrow) And Range(\"AV9:AV\" &amp; lastrow) &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Does someone know what I'm doing wrong here? :) </p>\n\n<hr>\n\n<p>NOTE: First I run this code only for <code>Cell AV9</code>. Which worked perfectly fine. So I proberly have to adjust my above defined <code>Copy Range</code>as well</p>\n\n<pre><code>Private Sub Worksheet_Change2(ByVal Target As Range)\nIf Target.Address = \"$AV$9\" And \"$AV$9\" &lt;&gt; \"\" Then\n    Range(\"A9:BE9\").Copy\n    Tabelle10.Range(\"A9:BE9\").PasteSpecial xlPasteValues\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548222955, "post_id": 50367147, "comment_id": 95460688, "body": "Have you tried adding <code>.Value</code> to the end of <code>Cells(rng.row,34)</code>? Also, is <code>Columns</code> a mehod of <code>.ListRows(row)</code> ? Finally, you have <code>.ListRows(row)</code> when it probably should be <code>.ListRows(row.row)</code>"}], "owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526464502, "creation_date": 1526463048, "last_edit_date": 1531164843, "question_id": 50367147, "link": "https://stackoverflow.com/questions/50367147/excel-vba-find-and-update-table-values-from-another-sheet", "title": "Excel VBA - Find and Update Table Values from Another Sheet", "body": "<p>I need to update some values in a table column from another sheet. For each row in the table called \"tbPartnerList\" find the row number in sheet ws2 where the value in ws2.Range(\"B:B\") matches the value in column 1 of the table. Then transfer the associated value from ws2.Range(\"AH:AH\") to the 14th column in the table. Although I can find the value in the ws2 I am struggling to return it to the table. Method not supported on [tbPartnerList].ListRows(row).Columns(14) = ws2.Cells(rng.row, 34)</p>\n\n<pre><code>Set ws2 = Sheet6\n\nFor Each row In [tbPartnerList].Rows\n    partAccount = row.Columns(1).Value\n    With ws2.Range(\"B:B\")\n        Set rng = .find(What:=partAccount, _\n                                After:=.Cells(.Cells.Count), _\n                                LookIn:=xlValues, _\n                                LookAt:=xlWhole, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlNext, _\n                                MatchCase:=False)\n        If Not rng Is Nothing Then\n            [tbPartnerList].ListRows(row).Columns(14) = ws2.Cells(rng.row, 34)\n        End If\n    End With\nNext\n</code></pre>\n"}, {"tags": ["vba", "collections"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1526462910, "post_id": 50367022, "comment_id": 87750403, "body": "Why do you want to hardcode your list? Wouldn&#39;t it be better to put the list in a textfile (or Excel, or database) and read it from there"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1526463398, "creation_date": 1526463398, "answer_id": 50367287, "question_id": 50367022, "link": "https://stackoverflow.com/questions/50367022/handling-large-vba-collection-data-procedure-too-large-error/50367287#50367287", "title": "Handling large VBA collection data - procedure too large error", "body": "<p>Replace the <code>With SpamList</code> etc. with this:</p>\n\n<pre><code>Dim FSO As Object\nDim fsList As Object\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet fsList = FSO.OpenTextFile(\"c:\\spamlist.txt\")\nDo Until fsList.AtEndOfStream\n    SpamList.Add fsList.readline\nLoop\nfsList.Close\n</code></pre>\n\n<p>And then move all your entries to a text file, one entry per line.</p>\n"}], "owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50367287, "answer_count": 1, "score": 1, "last_activity_date": 1526535623, "creation_date": 1526462700, "last_edit_date": 1526535623, "question_id": 50367022, "link": "https://stackoverflow.com/questions/50367022/handling-large-vba-collection-data-procedure-too-large-error", "title": "Handling large VBA collection data - procedure too large error", "body": "<p>I am getting a procedure too large compiling error.</p>\n\n<p>Not sure how to re-structure the following code.</p>\n\n<p>Help would be appreciated. Thank you.</p>\n\n<pre><code>Dim SpamList As VBA.Collection\nSet SpamList = New VBA.Collection\nWith SpamList\n    .Add \"abc@gmail.com\"\n    .Add \"abc@aol.com\"\n\n    '...Very large list - about 5000 entries\n\n    .Add \"abc@yahoo.com\"\nEnd With\n\nDim z as long\nFor z = 1 To SpamList.Count\n    If current email address is in SpamList Then\n        msgbox \"Spam mail!\"\n        Exit For\n    End If\nNext\n\nSet SpamList = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1526462453, "post_id": 50366867, "comment_id": 87750053, "body": "Why not use AutoFilter?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1526464142, "post_id": 50366867, "comment_id": 87751259, "body": "Probably should be a question on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 0, "last_activity_date": 1526467360, "last_edit_date": 1526467360, "creation_date": 1526463355, "answer_id": 50367273, "question_id": 50366867, "link": "https://stackoverflow.com/questions/50366867/improve-speed-on-macro-hiding-rows/50367273#50367273", "title": "Improve speed on Macro hiding rows", "body": "<p>In case you don't have negative values, but just zero or positive, skip the <code>ElseIf</code> statement. If you do have, change the <code>If</code>statement to <code>If ... &gt;=0 Then</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1526485986, "post_id": 50372692, "comment_id": 87766753, "body": "It&#39;s generally frowned upon to modify the environment (i.e., the Calculation setting) but OP reverts to <code>xlCalculationAutomatic</code> at the end of the procedure, so it&#39;s not really a problem in this case (although I think it&#39;s not necessary!) :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1526502024, "post_id": 50372692, "comment_id": 87774793, "body": "@David Zemens - I consider it a rule of a thumb never to use it. And a good sign that refactoring is needed, if the system has to be cheated this way. \u263a"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1526503104, "post_id": 50372692, "comment_id": 87775273, "body": "yep definitely a safe rule of thumb, I can probably count on one hand the number of times I&#39;ve used it, ever!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1526501774, "last_edit_date": 1526501774, "creation_date": 1526478508, "answer_id": 50372692, "question_id": 50366867, "link": "https://stackoverflow.com/questions/50366867/improve-speed-on-macro-hiding-rows/50372692#50372692", "title": "Improve speed on Macro hiding rows", "body": "<p>It is really a strange design decision to hide and unhide rows, based on their values and to implement it in a <code>_Calculation</code> event. However, there is a way to make it significantly faster, if you combine all the rows that have to be hidden to one range and all the rows that have to be shown in another:</p>\n\n<pre><code>Public Sub HideQuickly()    \n\n    Dim wholeRangeV As Range, wholeRangeNV As Range, myCell As Range, lastRow As Long\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False        \n    lastRow = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\n\n    For Each myCell In Range(\"A1:A\" &amp; lastRow)            \n        Select Case myCell\n        Case Is &gt; 0\n            If wholeRangeV Is Nothing Then\n                Set wholeRangeV = myCell\n            Else\n                Set wholeRangeV = Union(wholeRangeV, myCell)\n            End If\n        Case Is = 0\n            If wholeRangeNV Is Nothing Then\n                Set wholeRangeNV = myCell\n            Else\n                Set wholeRangeNV = Union(wholeRangeNV, myCell)\n            End If\n        End Select\n    Next myCell\n\n    If Not wholeRangeNV Is Nothing Then\n        wholeRangeNV.EntireRow.Hidden = True\n    End If        \n    If Not wholeRangeV Is Nothing Then\n        wholeRangeV.EntireRow.Hidden = False\n    End If\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True        \nEnd Sub\n</code></pre>\n\n<p>As you see, with the above code, the hiding/unhiding action is carried out only once per type:</p>\n\n<pre><code>wholeRangeV.EntireRow.Hidden = False\nwholeRangeNV.EntireRow.Hidden = True\n</code></pre>\n\n<p>Concerning the setting the calculation to manual in Excel, this is sometimes considered a bad habit, thus try to avoid it.</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 3, "last_activity_date": 1526486780, "last_edit_date": 1526486780, "creation_date": 1526485504, "answer_id": 50375122, "question_id": 50366867, "link": "https://stackoverflow.com/questions/50366867/improve-speed-on-macro-hiding-rows/50375122#50375122", "title": "Improve speed on Macro hiding rows", "body": "<p>As @SJR said - use an <code>AutoFilter</code>.<br>\nChange the <code>VisibleDropDown</code> property to TRUE if you want to see the filter arrow. </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Dim LastRow As Long\n\n    LastRow = Cells(Cells.Rows.Count, \"CP\").End(xlUp).Row\n\n    With ActiveSheet\n        If .AutoFilterMode Then\n            .AutoFilterMode = False\n        End If\n\n        .Range(.Cells(1, \"CP\"), .Cells(LastRow, \"CP\")).AutoFilter _\n            Field:=1, _\n            Criteria1:=\"&gt;0\", _\n            Operator:=xlAnd, _\n            VisibleDropDown:=False\n\n    End With\n\nEnd Sub  \n</code></pre>\n\n<p><strong>Edit:</strong>  After testing it filtered 139987 rows in 93ms.  </p>\n\n<p>Timing code:   </p>\n\n<pre><code>Private Declare Function GetTickCount Lib \"kernel32\" () As Long\n\nPublic CodeTimer As Long\n\n'^^^^^ Top of module ^^^^^^\n\nPublic Function StartTimer()\n    CodeTimer = GetTickCount\nEnd Function\n\nPublic Function StopTimer()\n    Dim FinalTime As Long\n    FinalTime = GetTickCount - CodeTimer\n    MsgBox Format(Now(), \"ddd dd-mmm-yy hh:mm:ss\") &amp; vbCr &amp; vbCr &amp; _\n            Format((FinalTime / 1000) / 86400, \"hh:mm:ss\") &amp; vbCr &amp; _\n            FinalTime &amp; \" ms.\", vbOKOnly + vbInformation, _\n        \"Code Timer\"\n    CodeTimer = 0\nEnd Function\n</code></pre>\n\n<p>Just add <code>StartTimer</code> at top of your code, and <code>StopTimer</code> at the bottom.</p>\n"}], "owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1526501774, "creation_date": 1526462262, "question_id": 50366867, "link": "https://stackoverflow.com/questions/50366867/improve-speed-on-macro-hiding-rows", "title": "Improve speed on Macro hiding rows", "body": "<p>I have a macro that is used to hide rows that are not relevant for the selected Customer. But since my report has gotten bigger and bigger, the macro is getting way to slow. </p>\n\n<p>I am looking for a way to improve the speed on this macro, as of now its running over 4 minutes.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim LastRow As Long, c As Range\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nLastRow = Cells(Cells.Rows.Count, \"CP\").End(xlUp).Row\nOn Error Resume Next\nFor Each c In Range(\"CP1:CP\" &amp; LastRow)\n   If c.Value = 0 Then\n        c.EntireRow.Hidden = True\n    ElseIf c.Value &gt; 0 Then\n        c.EntireRow.Hidden = False\n    End If\nNext\nOn Error GoTo 0\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "vba", "outlook"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1528827719, "post_id": 50366836, "comment_id": 88652002, "body": "Replace <code>CStr(Msg.Body)</code> with <code>Replace(Replace(Replace(CStr(Msg.Body), vbLf, &quot;\\n&quot;), vbCr, &quot;\\r&quot;), vbTab, &quot;\\t&quot;)</code>"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1542394720, "post_id": 50366836, "comment_id": 93566569, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/42068/how-do-i-handle-newlines-in-json\">How do I handle newlines in JSON?</a>: &quot;The reason for having to do this: <a href=\"http://www.ietf.org/rfc/rfc4627.txt\" rel=\"nofollow noreferrer\">RFC 4627 - JSON spec</a> - <i>All Unicode characters may be placed within the quotation marks except for the characters that must be escaped: quotation mark, reverse solidus, and the control characters (U+0000 through U+001F). Since a newline is a control character, it must be escaped.</i>&quot;"}], "owner": {"reputation": 859, "user_id": 7986808, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9c7c2b8e8a67a276bbc476d48a102b?s=128&d=identicon&r=PG&f=1", "display_name": "khashashin", "link": "https://stackoverflow.com/users/7986808/khashashin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592990882, "creation_date": 1526462179, "last_edit_date": 1592990882, "question_id": 50366836, "link": "https://stackoverflow.com/questions/50366836/how-to-fix-newline-error-in-json-illegal-unquoted-character-has-to-be-escap", "title": "How to fix newline error in json: Illegal unquoted character ... has to be escaped using backslash", "body": "<p>I am generating json from email in Outlook using VBA.</p>\n\n<p>The content of <code>Meetingitem.Body</code> includes newlines. When I include this content in my json as a string, I get an error.</p>\n\n<p>Is it possible to avoid this?</p>\n\n<pre><code>{\"fields\": {\n    \"project\": {\n        \"id\": 30611\n    },\n    \"summary\": \"Release Produktion-System\",\n    \"description\": \"Guten Tag\n\nSie erhalten diese Terminanfrage weil Ihnen im Change 2018.04.24.015 &lt;http://pww.post.ch/appl/oe/it/changemanagement/wpl/pages/editchange.aspx?changeId=29774&gt;  die im Betreff aufgef\u00fchrte T\u00e4tigkeit zugeordnet wurde. Bitte best\u00e4tigen Sie die Terminanfrage im Outlook, damit f\u00fcr die Ausf\u00fchrung der T\u00e4tigkeit der entsprechende Zeitraum in Ihrem Kalender reserviert wird.\n(Unter offene Termine die entsprechende T\u00e4tigkeit mit Bearbeiten \u00f6ffnen, und den Status anpassen. Es stehen Ihnen folgende Abschlussstatus zur Verf\u00fcgung: Erledigt, Verz\u00f6gert, Abgebrochen).\n\nFreundliche Gr\u00fcsse\nMuster Mus\n\nMusterfirma\nInformatik\n\nTelefon: +553344556622\nEmail: muster.muss@mail.com\n\n\",\n    \"issuetype\": {\n        \"name\": \"Test\"\n    }\n}\n}\n</code></pre>\n\n<p>It is a POST request to server and here is the response:</p>\n\n<pre><code>{\n    \"errorMessages\": [\n        \"Illegal unquoted character ((CTRL-CHAR, code 13)): has to be escaped using backslash to be included in string value\\n at [Source: org.apache@4jasdn4; line: 6, column: 28]\"\n    ]\n}\n</code></pre>\n\n<p>To generate this json I am using following code (short variant):</p>\n\n<pre><code>Dim smry, descrp, jsTest As String\nsmry = \"\"\"summary\"\"\"\ndescrp = \"\"\"description\"\"\"\njsTest = \"{\" + smry + \":\" + \"\"\"\" + CStr(Msg.Subject) + \"\"\"\" + \",\" + descrp + \":\" + \"\"\"\" + CStr(Msg.Body) + \"\"\"\" + \"}\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1526461394, "creation_date": 1526461394, "answer_id": 50366578, "question_id": 50366352, "link": "https://stackoverflow.com/questions/50366352/using-a-macro-if-formula-static-date/50366578#50366578", "title": "Using a macro + IF formula + static date?", "body": "<p>Think this should do it. You can replace the formula with the value so that it won't continually update.</p>\n\n<p>The On Error should go before the the SpecialCells - if there are no blanks there is no range to which the formula can be applied, hence the error.</p>\n\n<p>Also, no need to Select anything.</p>\n\n<p>I havn't tested this so no surprises if it doesn't work first time.</p>\n\n<pre><code>Sub ResetFlags()\n\nWith Sheets(\"Matrix\").Columns(\"E:E\")\n    .Replace What:=\"y\", Replacement:=\"Flagged\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n    Dim r As Range\n\n    On Error Resume Next\n    Set r = .Range(\"F:F\").Cells.SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\nEnd With\n\nIf Not r Is Nothing Then\n    r.Formula = \"=IF((RC[-1]=\"\"Flagged\"\"),(TODAY()),\"\"\"\")\"\n    r.Value = r.Value\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9798867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de6400e8bf157fc60d6ab9ff0012db0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathrine", "link": "https://stackoverflow.com/users/9798867/kathrine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526461394, "creation_date": 1526460705, "question_id": 50366352, "link": "https://stackoverflow.com/questions/50366352/using-a-macro-if-formula-static-date", "title": "Using a macro + IF formula + static date?", "body": "<p>I've only just started using Excel so am a bit of a newbie - please excuse my ignorance/lack of proper terminology!</p>\n\n<p>I currently have column E, where people will manually enter a 'Y' to flag certain accounts. Once these accounts have been flagged, I have a macro button to change all these Y's to 'Flagged', so that I know they've been dealt with. </p>\n\n<p>I wanted column F to add in the date that these were flagged, so I have an IF formula to say that if 'Raised' is in colE, add in today's date in colF. I was having issues with 2 things, firstly I need it to ignore any that already have a date in colF (as I don't want old dates overridden), and I didn't know how to 'freeze' the date. Currently, any time I open the worksheet it changes all the old dates to todays date, but I need to keep whatever the date was at the time it was entered. </p>\n\n<p>All of my excel is self taught through reading forums (so please forgive me if this is terrible!), but at the moment I've come up with this:</p>\n\n<pre><code>Sub ResetFlags()\n'\n' ResetFlags Macro\n'\n\n'\nSheets(\"Matrix\").Select\nColumns(\"E:E\").Select\nRange(\"E2\").Activate\nSelection.Replace What:=\"y\", Replacement:=\"Flagged\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nRange(\"E12\").Select\n\nDim r As Range\nSet r = Range(\"F:F\").Cells.SpecialCells(xlCellTypeBlanks)\nOn Error Resume Next\nr.Formula = \"=IF((RC[-1]=\"\"Flagged\"\"),(TODAY()),\"\"\"\")\"\nOn Error Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>The macro seems to work well in that it replaces the Y's with 'Flagged', it skips old dates and add today's date.. BUT every time I open the workbook it changes ALL the dates to today. How to I freeze the date?!</p>\n\n<p>Also, when I run the macro, although it all runs through at the very end I get an error box saying 'Run-time error 1004: No cells were found'. I can't figure this out/how to get rid of it. </p>\n\n<p>Thank you very much!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1526461100, "post_id": 50366319, "comment_id": 87749094, "body": "use dictionary. <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a>"}], "answers": [{"tags": [], "owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "is_accepted": false, "score": 0, "last_activity_date": 1526461058, "creation_date": 1526461058, "answer_id": 50366478, "question_id": 50366319, "link": "https://stackoverflow.com/questions/50366319/excel-vba-check-for-existing-value-with-loop/50366478#50366478", "title": "Excel VBA, check for existing value with loop", "body": "<p>If you want to check for duplicate phone numbers:</p>\n\n<pre><code>Public Sub CheckForDupes()\n    For b = 1 To 70\n        For c = b + 1 To 70\n            If Cells(b, 2).Value = Cells(c, 2).Value Then\n                MsgBox (\"Rows \" &amp; b &amp; \" and \" &amp; c &amp; \"are duplicates.\")\n            End If\n        Next c\n    Next b\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8359588, "user_type": "registered", "profile_image": "https://graph.facebook.com/1500261133328155/picture?type=large", "display_name": "Kalin Stoev", "link": "https://stackoverflow.com/users/8359588/kalin-stoev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526462686, "creation_date": 1526460620, "last_edit_date": 1531164843, "question_id": 50366319, "link": "https://stackoverflow.com/questions/50366319/excel-vba-check-for-existing-value-with-loop", "title": "Excel VBA, check for existing value with loop", "body": "<p>i have a 70 names with phone numbers, how can i check with For or if else statement or both if there is phone number which is duplicating and remove the number. Thanks in advance! </p>\n\n<pre><code>Sub GenerateNames()\nDim ssheet1 As Worksheet\nDim rngen As Worksheet\nDim rnsheet As Worksheet\n\nDim i As Integer, intValueToFind As Integer\nintValueToFind = 12345\n\nSet ssheet1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet rngen = ThisWorkbook.Sheets(\"RnGen\")\nSet rnsheet = ThisWorkbook.Sheets(\"RandomNames\")\n\nrngen.Range(\"A3:A70\").Copy rnsheet.Range(\"A3:A70\")\nssheet1.Range(\"B3:B70\").Copy rnsheet.Range(\"B3:B70\")\n\n\nFor b = 1 To 70\n    If Cells(b, 2).Value = intValueToFind Then\n        MsgBox (\"Found value on row \" &amp; i)\n        Exit Sub\n    End If\nNext b\n\nMsgBox (\"Value not found in the range!\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1526460633, "post_id": 50366125, "comment_id": 87748774, "body": "... and so on? I&#39;m sorry, but this site is not a free coding service. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a question"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1526471317, "creation_date": 1526471317, "answer_id": 50370158, "question_id": 50366125, "link": "https://stackoverflow.com/questions/50366125/confused-in-looping/50370158#50370158", "title": "Confused in looping", "body": "<pre><code>Sub Moveit\n'declare your variables\ndim r as range\ndim t as range\ndim i as integer\n 'initialise your ranges\nset r = worksheets(1).range(\"A1\")\nset t = worksheets(2).range(\"a1\")\n\ndo  'begin looping\n     for i = 1 to 4  'do 4 times\n           t=r  \n           set t = t.offset(1,0) 'move target down 1\n      next i\n      set r = r.offset(1,0)  'move source down 1\n\nloop until r= \"\" 'repeat until you run out of sources\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9750971, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arianne Gale Cruz", "link": "https://stackoverflow.com/users/9750971/arianne-gale-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1526471317, "creation_date": 1526460007, "last_edit_date": 1531161705, "question_id": 50366125, "link": "https://stackoverflow.com/questions/50366125/confused-in-looping", "title": "Confused in looping", "body": "<p>What code can give me this result?</p>\n\n<p>Copy value in A1, Worksheet 1 to Worksheet 2 column A 4 times (e.g A1 - A4)\nThen Copy value in A2, Worksheet 1 to Worksheet 2 column A 4 times again (e.g A5 - A8), and so on. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526493787, "post_id": 50365995, "comment_id": 87770900, "body": "Fascinating. I played around and didn&#39;t find a method that worked consistently except for changing the outline level to expose the groups before assigning then closing again."}, {"owner": {"reputation": 11, "user_id": 6806548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fW-dd7xLb5M/AAAAAAAAAAI/AAAAAAAAAGI/ivGe-P8Ck1Q/photo.jpg?sz=128", "display_name": "Torben Kirk Wolf", "link": "https://stackoverflow.com/users/6806548/torben-kirk-wolf"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526993288, "post_id": 50365995, "comment_id": 87949299, "body": "OK, so I have figured out a workaround/verification that this is a bug in Excel. If you select a cell outside the table range before inserting the array, it works fine - even when both filtering and grouping is active. Why this is the case, I have no idea. It&#39;s a clumsy solution (I&#39;m not fond of selecting cells through VBA), but it works."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526993456, "post_id": 50365995, "comment_id": 87949438, "body": "Remember to post as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6806548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fW-dd7xLb5M/AAAAAAAAAAI/AAAAAAAAAGI/ivGe-P8Ck1Q/photo.jpg?sz=128", "display_name": "Torben Kirk Wolf", "link": "https://stackoverflow.com/users/6806548/torben-kirk-wolf"}, "is_accepted": true, "score": 0, "last_activity_date": 1527081799, "creation_date": 1527081799, "answer_id": 50489596, "question_id": 50365995, "link": "https://stackoverflow.com/questions/50365995/writing-array-to-filtered-and-grouped-table-fails/50489596#50489596", "title": "Writing array to filtered and grouped table fails", "body": "<p>OK, so I have figured out a workaround/verification that this is a bug in Excel. If you select a cell outside the table range before inserting the array, it works fine - even when both filtering and grouping is active. Why this is the case, I have no idea. It's a clumsy solution (I'm not fond of selecting cells through VBA), but it works.</p>\n\n<p>(Sorry, I originaly posted it as a comment, and not an answer).</p>\n\n<p>If anyone has a more elegant solution, I would still be very interested in seeing it.</p>\n"}], "owner": {"reputation": 11, "user_id": 6806548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fW-dd7xLb5M/AAAAAAAAAAI/AAAAAAAAAGI/ivGe-P8Ck1Q/photo.jpg?sz=128", "display_name": "Torben Kirk Wolf", "link": "https://stackoverflow.com/users/6806548/torben-kirk-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 50489596, "answer_count": 1, "score": 1, "last_activity_date": 1527081799, "creation_date": 1526459647, "last_edit_date": 1526473727, "question_id": 50365995, "link": "https://stackoverflow.com/questions/50365995/writing-array-to-filtered-and-grouped-table-fails", "title": "Writing array to filtered and grouped table fails", "body": "<p>I am having trouble writing an array defined in VBA to a range in a table that has been grouped and filtered.</p>\n\n<p>Writing an array to a table range is done using:</p>\n\n<pre><code>Sheets(1).ListObjects(1).ListRows(1).Range = MyArray\n</code></pre>\n\n<p>This works fine on a filtered table (i.e. filtering the rows using the filter buttons in the row headers). It also works fine in a grouped table (i.e. with some columns grouped using Data --> Outline --> Group.</p>\n\n<p>However, when combining this, the array is not written to the cells in a correct manner. An array [1,2,3,4,5,6,7,8] is written as [1,2,3,1,2,3,4,5], if I group columns 2 and 3 in the table. This is NOT the case, if I haven't also filtered the table.</p>\n\n<p>Do anyone have an idea what's going on here? An example workbook can be found <a href=\"https://1drv.ms/x/s!AnV6w5QgXk-jjdtx-iP_Jwa5iaN80Q\" rel=\"nofollow noreferrer\">here</a>. It contains a simple table and one sub that tries to write an array to the table.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>BR\nTorben</p>\n"}, {"tags": ["excel", "vba", "reference", "excel-r1c1-notation"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9753997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9457945d0595032b893635c0d4c88e?s=128&d=identicon&r=PG&f=1", "display_name": "CHsu", "link": "https://stackoverflow.com/users/9753997/chsu"}, "edited": false, "score": 0, "creation_date": 1526463677, "post_id": 50366505, "comment_id": 87750936, "body": "Thanks Thomas, but the result doesn&#39;t seem to refer to the correct cell - I got C113 instead of F89. Any idea why that happened?"}, {"owner": {"reputation": 17, "user_id": 9753997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9457945d0595032b893635c0d4c88e?s=128&d=identicon&r=PG&f=1", "display_name": "CHsu", "link": "https://stackoverflow.com/users/9753997/chsu"}, "edited": false, "score": 0, "creation_date": 1526479330, "post_id": 50366505, "comment_id": 87761942, "body": "Ok I got it- relative reference. Now it works. Thank you very much!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1526472880, "last_edit_date": 1526472880, "creation_date": 1526461132, "answer_id": 50366505, "question_id": 50365709, "link": "https://stackoverflow.com/questions/50365709/vba-r1c1-formula-calculation-with-cell-in-another-worksheet/50366505#50366505", "title": "VBA R1C1 formula calculation with cell in another worksheet", "body": "<p>You cannot mix R1C1 and A1-notation in a formula. If you use <code>FormulaR1C1</code>, you have to provide all addressen in R1C1-notation. You can use <code>Application.ConvertFormula</code> to convert your <code>F89</code>:</p>\n\n<pre><code>dim r as range\nset r = ws2.Cells(87, col - 2)\nr.FormulaR1C1 = \"=R[-5]C[0]-\" &amp; _\n      Application.ConvertFormula(\"'Another Sheet'!F89\", xlA1, xlR1C1, , r)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9753997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9457945d0595032b893635c0d4c88e?s=128&d=identicon&r=PG&f=1", "display_name": "CHsu", "link": "https://stackoverflow.com/users/9753997/chsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 0, "accepted_answer_id": 50366505, "answer_count": 1, "score": 0, "last_activity_date": 1526472880, "creation_date": 1526458790, "question_id": 50365709, "link": "https://stackoverflow.com/questions/50365709/vba-r1c1-formula-calculation-with-cell-in-another-worksheet", "title": "VBA R1C1 formula calculation with cell in another worksheet", "body": "<pre><code>ws2.Cells(87, col - 2).FormulaR1C1 = \"=R[-5]C[0]-'Another Sheet'!F89\"\n</code></pre>\n\n<p>When I run the above code, the result would be, \"=AW83- 'Another Sheet'!'F89\", which returns an error because the ' between ! and F89. I tried to use \" &amp; \" but it does not work this way. Does anyone know how to solve this? Thanks in advance!!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526459167, "post_id": 50365401, "comment_id": 87747856, "body": "So you ignore row 5?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526459785, "post_id": 50365401, "comment_id": 87748220, "body": "Why is the value for Ref4 20? It&#39;s unique so shouldn&#39;t it be 40?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526460706, "post_id": 50365401, "comment_id": 87748823, "body": "Hi. Yes we ignore Row 5 because in Row 4 the value of Ref 3 is selected. And for Ref4, we first have to check value2. If it is not present then we have to check value1."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1526461543, "post_id": 50365401, "comment_id": 87749406, "body": "match is much <a href=\"https://stackoverflow.com/questions/29972016/is-there-a-faster-countif\">faster than countif[</a>]"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1526461807, "post_id": 50365401, "comment_id": 87749581, "body": "Thank you for that @Jeepad. Can you also help me improve my attempt to get the correct output?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526461884, "post_id": 50365401, "comment_id": 87749633, "body": "Your response contradicts your question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526462059, "post_id": 50365401, "comment_id": 87749749, "body": "You&#39;re right @SJR. Thank you. I have edited my question"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526462236, "post_id": 50365401, "comment_id": 87749890, "body": "OK. Is the only output you want the 150 or do you need the constituent totals also?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1526462311, "post_id": 50365401, "comment_id": 87749946, "body": "The only output I want is 150."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526465325, "post_id": 50365401, "comment_id": 87752128, "body": "@SJR Could you kindly help me out?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1526466197, "post_id": 50365401, "comment_id": 87752673, "body": "Yes, I will take a look, but need to give it a bit of thought. In reality do you have a lot of data?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1526466554, "post_id": 50365401, "comment_id": 87752911, "body": "No I won&#39;t have more that 20 rows, I think."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1528802686, "post_id": 50372435, "comment_id": 88636731, "body": "Hope you&#39;re doing well. You asked me if I needed constituent totals as well. At the time I said no. But I think in the future I might need the constituent total as well. Could you kindly tell me how to capture that too? Thanks."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1528885679, "post_id": 50372435, "comment_id": 88673628, "body": "@PriyankaDembla What do you mean by <i>constituent totals</i>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1528886138, "post_id": 50372435, "comment_id": 88673899, "body": "If you would kindly look at my question, 100, 20 and 30 are my constituent totals. Thank you"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1528914389, "post_id": 50372435, "comment_id": 88691309, "body": "@PriyankaDembla I should have been more precise: <i>What steps are needed to figure out the constituent totals?</i> Considering that <code>20</code> appears twice in the data you have posted, providing 3 arbitrary numbers isn&#39;t very helpful when trying to figure out the algorithm for getting constituent totals."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1528951021, "post_id": 50372435, "comment_id": 88702150, "body": "@ZevSpitz: Please read my requirement in the question. Those 3 numbers are not arbitrary. They have come after deriving a logic. And the answer by SJR covers most of the logic."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1526477784, "creation_date": 1526477784, "answer_id": 50372435, "question_id": 50365401, "link": "https://stackoverflow.com/questions/50365401/redundancy-in-logic-for-excel-vba/50372435#50372435", "title": "Redundancy in logic for excel VBA", "body": "<p>There must be a more concise way, but I think this does what you want. It is based on your example, so data in A1:F6 so will need amending.</p>\n\n<pre><code>Sub x()\n\nDim v2() As Variant, v1, i As Long, n As Long, d As Double\n\nv1 = Sheet1.Range(\"A1:F6\").Value\nReDim v2(1 To UBound(v1, 1), 1 To 5) 'ref/count/null/value null/value selected\n\nWith CreateObject(\"Scripting.Dictionary\")\n    For i = 2 To UBound(v1, 1)\n        If Not .Exists(v1(i, 1)) Then\n            n = n + 1\n            v2(n, 1) = v1(i, 1)\n            v2(n, 2) = v2(n, 2) + 1\n            If v1(i, 3) = \"\" Then\n                v2(n, 3) = v2(n, 3) + 1\n                v2(n, 4) = IIf(v1(i, 6) = \"\", v1(i, 5), v1(i, 6))\n            ElseIf v1(i, 3) = \"selected\" Then\n                v2(n, 5) = IIf(v1(i, 6) = \"\", v1(i, 5), v1(i, 6))\n            End If\n            .Add v1(i, 1), n\n        ElseIf .Exists(v1(i, 1)) Then\n            v2(.Item(v1(i, 1)), 2) = v2(.Item(v1(i, 1)), 2) + 1\n            If v1(i, 3) = \"\" Then\n                v2(.Item(v1(i, 1)), 3) = v2(.Item(v1(i, 1)), 3) + 1\n                If v1(i, 6) = \"\" Then\n                    v2(.Item(v1(i, 1)), 4) = v2(.Item(v1(i, 1)), 4) + v1(i, 5)\n                Else\n                    v2(.Item(v1(i, 1)), 4) = v2(.Item(v1(i, 1)), 4) + v1(i, 6)\n                End If\n            Else\n                If v1(i, 6) = \"\" Then\n                    v2(.Item(v1(i, 1)), 5) = v2(.Item(v1(i, 1)), 5) + v1(i, 5)\n                Else\n                    v2(.Item(v1(i, 1)), 5) = v2(.Item(v1(i, 1)), 5) + v1(i, 6)\n                End If\n            End If\n        End If\n    Next i\nEnd With\n\nFor i = LBound(v2, 1) To UBound(v2, 1)\n    If v2(i, 2) &gt; 1 And v2(i, 3) = v2(i, 2) Then\n        d = d + v2(i, 4) / v2(i, 2)\n    End If\n    If v2(i, 2) &gt; 1 And v2(i, 3) &lt; v2(i, 2) Then\n        d = d + v2(i, 5) / (v2(i, 2) - v2(i, 3))\n    End If\n    If v2(i, 2) = 1 And v2(i, 3) = v2(i, 2) Then\n        d = d + v2(i, 4) / v2(i, 2)\n    End If\nNext i\n\nMsgBox \"Total = \" &amp; d\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 1, "last_activity_date": 1526497905, "last_edit_date": 1526497905, "creation_date": 1526479917, "answer_id": 50373259, "question_id": 50365401, "link": "https://stackoverflow.com/questions/50365401/redundancy-in-logic-for-excel-vba/50373259#50373259", "title": "Redundancy in logic for excel VBA", "body": "<h3>Using a SQL statement against the worksheet</h3>\n\n<p>If I understand your requirements, they are as follows:</p>\n\n<ul>\n<li>For each <code>Ref no</code>, you want </li>\n<li>the average of \n\n<ul>\n<li><code>value2</code> if it exists, otherwise <code>value1</code></li>\n</ul></li>\n<li>where the <code>status</code> is <code>selected</code>, or\n\n<ul>\n<li>there is no <code>status = selected</code> for this <code>Ref no</code></li>\n</ul></li>\n</ul>\n\n<p>I would open an ADODB Recordset against the data, with the following SQL:</p>\n\n<pre><code>SELECT [Ref no], Avg(Iif(value2 IS NOT NULL, value2, value1)) AS Result\nFROM Sheet1\nLEFT JOIN (\n    SELECT DISTINCT [Ref No]\n    FROM Sheet1\n    WHERE status = \"selected\"\n) t1 ON Sheet1.[Ref no] = t1.[Ref no]\nWHERE Sheet1.status=\"selected\" OR t1.[Ref no] IS NULL\nGROUP BY [Ref no]\n</code></pre>\n\n<hr>\n\n<h3>Using nested <code>Scripting.Dictionary</code></h3>\n\n<p>If SQL is not your thing, then you could something like the following:</p>\n\n<pre><code>'Define names for the columns; much easier to read row(RefNo) then arr(0)\nConst refNo = 1\nConst status = 3\nConst value1 = 5\nConst value2 = 6\n\n'For each RefNo, we have to store 3 pieces of information:\n'   whether any of the rows are selected\n'   the sum of the values\n'   the count of the values\nDim aggregates As New Scripting.Dictionary\n\nDim arr() As Variant\narr = Sheet1.UsedRange.Value\n\nDim maxRow As Long\nmaxRow = UBound(arr, 1)\n\nDim i As Long\nFor i = 2 To maxRow 'exclude the column headers in the first row\n    Dim row() As Variant\n    row = GetRow(arr, i)\n\n    'Get the current value of the row\n    Dim currentValue As Integer\n    currentValue = row(value1)\n    If row(value2) &lt;&gt; Empty Then currentValue = row(value2)\n\n    'Ensures the dictionary always has a record corresponding to the RefNo\n    If Not aggregates.Exists(row(refNo)) Then Set aggregates(row(refNo)) = InitDictionary\n\n    Dim hasPreviousSelected As Boolean\n    hasPreviousSelected = aggregates(row(refNo))(\"selected\")\n\n    If row(status) = \"selected\" Then\n        If Not hasPreviousSelected Then\n            'throw away any previous sum and count; they are from unselected rows\n            Set aggregates(row(refNo)) = InitDictionary(True)\n        End If\n    End If\n\n    'only include currently seleced refNos, or refNos which weren't previously selected,\n    If row(status) = \"selected\" Or Not hasPreviousSelected Then\n        aggregates(row(refNo))(\"sum\") = aggregates(row(refNo))(\"sum\") + currentValue\n        aggregates(row(refNo))(\"count\") = aggregates(row(refNo))(\"count\") + 1\n    End If\nNext\n\nDim key As Variant\nFor Each key In aggregates\n    Debug.Print key, aggregates(key)(\"sum\") / aggregates(key)(\"count\")\nNext\n</code></pre>\n\n<p>with the following two helper functions:</p>\n\n<pre><code>Function GetRow(arr() As Variant, rowIndex As Long) As Variant()\n    Dim ret() As Variant\n    Dim lowerbound As Long, upperbound As Long\n    lowerbound = LBound(arr, 2)\n    upperbound = UBound(arr, 2)\n    ReDim ret(1 To UBound(arr, 2))\n    Dim i As Long\n    For i = lowerbound To upperbound\n        ret(i) = arr(rowIndex, i)\n    Next\n    GetRow = ret\nEnd Function\n\nFunction InitDictionary(Optional selected As Boolean = False) As Scripting.Dictionary\n    Set InitDictionary = New Scripting.Dictionary\n    InitDictionary.Add \"selected\", selected\n    InitDictionary.Add \"sum\", 0\n    InitDictionary.Add \"count\", 0\nEnd Function\n</code></pre>\n\n<hr>\n\n<h3>Explanation of SQL</h3>\n\n<ul>\n<li>For each <code>Ref no</code>, you want </li>\n</ul>\n\n<p>Group the records by <code>Ref no</code>, using the <code>GROUP BY</code> clause</p>\n\n<ul>\n<li>the average of </li>\n</ul>\n\n<p>We'll return both the <code>Ref no</code> and the <code>average</code> -- <code>SELECT [Ref no], Avg(...)</code></p>\n\n<ul>\n<li><code>value2</code> if it exists, otherwise <code>value1</code></li>\n</ul>\n\n<p><code>Iif(value2 IS NOT NULL, value2, value1)</code></p>\n\n<ul>\n<li>where the <code>status</code> is <code>selected</code>, or</li>\n</ul>\n\n<p><code>WHERE Sheet1.status=\"selected\" OR</code></p>\n\n<ul>\n<li>there is no <code>status = selected</code> for this <code>Ref no</code></li>\n</ul>\n\n<p>We get a list of (unique -- <code>DISTINCT</code>) <code>Ref no</code>s that have <code>status = \"selected\"</code>:</p>\n\n<pre><code>SELECT DISTINCT [Ref No]\nFROM Sheet1\nWHERE status = \"selected\"\n</code></pre>\n\n<p>and give it a name (<code>AS t1</code>) so we can refer to it separately from the main list (<code>Sheet1</code>)</p>\n\n<p>Then we connect, or join (<code>JOIN</code>) that sublist to the main list, where the [Ref no] is the same in both (<code>ON Sheet1.[Ref no] = t1.[Ref no]</code>).</p>\n\n<p>A simple <code>JOIN</code> is an <code>INNER JOIN</code>, where the records on both sides of the connection have to match. What we want in this case, is the records on the main list which <strong>do not</strong> match the records in the sublist. In order to see such records, we can use a <code>LEFT JOIN</code>, which displays all the records on the left side, and only those records on the right side that match.</p>\n\n<p>We can then filter out the records that do match, using <code>OR t1.[Ref no] IS NULL</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 50373259, "answer_count": 2, "score": 1, "last_activity_date": 1526497905, "creation_date": 1526457726, "last_edit_date": 1531161705, "question_id": 50365401, "link": "https://stackoverflow.com/questions/50365401/redundancy-in-logic-for-excel-vba", "title": "Redundancy in logic for excel VBA", "body": "<p>Please see the image attached - </p>\n\n<p><a href=\"https://i.stack.imgur.com/47ghJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/47ghJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>My requirement is -</p>\n\n<ul>\n<li>\"If <code>status null</code> and <code>Ref No. not unique</code> then</li>\n</ul>\n\n<blockquote>\n  <p>check value2. If value2 not present, check value1 and take average</p>\n</blockquote>\n\n<p>Example: For ref number = 1, calculated value is (50+10)/2 = 30  \"</p>\n\n<ul>\n<li>\"if <code>status is selected</code> or <code>Ref no is unique</code> then </li>\n</ul>\n\n<blockquote>\n  <p>copy from value2, if not present then copy from value1</p>\n</blockquote>\n\n<p>Example: For Ref No 3, value is 100 and for Ref No 4, value is 20</p>\n\n<ul>\n<li><p>Total value= 100+30+20 = 150</p></li>\n</ul>\n\n<p>My attempt</p>\n\n<pre><code>For I = 2 To lrow 'sheets all have headers that are 2 rows\n\n        'unique\n            If Application.WorksheetFunction.CountIf(ws.Range(\"A\" &amp; fRow, \"A\" &amp; lrow), ws.Range(\"A\" &amp; I)) = 1 Then\n                If (ws.Range(\"AW\" &amp; I) &lt;&gt; \"\") Then 'AW has value2\n                    calc = calc + ws.Range(\"AW\" &amp; I).Value\n                Else: calc = calc + ws.Range(\"AV\" &amp; I).Value 'AV has value1\n                End If\n        'not unique\n            Else\n                'selected\n                If ws.Range(\"AY\" &amp; I) = \"Selected\" Then 'AY has status (Selected/Null)\n                    If (ws.Range(\"AW\" &amp; I) &lt;&gt; \"\") Then\n                        calc = calc + ws.Range(\"AW\" &amp; I).Value\n                    Else: calc = calc + ws.Range(\"AV\" &amp; I).Value\n                    End If\n                'not selected\n                Else\n                    If (ws.Range(\"AW\" &amp; I) &lt;&gt; \"\") Then\n                        calc1 = calc1 + ws.Range(\"AW\" &amp; I).Value\n                    Else: calc1 = calc1 + ws.Range(\"AV\" &amp; I).Value\n                    End If\n                    calc1 = calc1/Application.WorksheetFunction.CountIf(ws.Range(\"A\" &amp; fRow, \"A\" &amp; lrow), ws.Range(\"A\" &amp; I))\n                End If\n            End If\n</code></pre>\n\n<p>My problem is - </p>\n\n<ul>\n<li>Getting the Ref No 3 twice in my logic.</li>\n<li>Not able to calculate the correct average.</li>\n</ul>\n\n<p>How can I get the correct output? Thanks.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "edited": false, "score": 0, "creation_date": 1526459555, "post_id": 50365749, "comment_id": 87748084, "body": "Hi, sorry but with &quot;Table&quot; I mean a table of the database. I was no clear."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "edited": false, "score": 0, "creation_date": 1526460988, "post_id": 50365749, "comment_id": 87749035, "body": "Yes, that what the answer covers."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1526458934, "creation_date": 1526458934, "answer_id": 50365749, "question_id": 50365339, "link": "https://stackoverflow.com/questions/50365339/how-to-get-tables-size-with-access-vba/50365749#50365749", "title": "How to get table&#39;s size with Access VBA?", "body": "<p>There is no such option, if you mean the table content.</p>\n\n<p>If it is the measures of the table when opened and displayed (which is done internally using a form not member of the Forms collection), you can use something like:</p>\n\n<pre><code>With Screen.ActiveForm\n    Debug.Print .Height, .Width\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594634864, "creation_date": 1526457575, "last_edit_date": 1594634864, "question_id": 50365339, "link": "https://stackoverflow.com/questions/50365339/how-to-get-tables-size-with-access-vba", "title": "How to get table&#39;s size with Access VBA?", "body": "<p>If <code>Me.Subform_name.Height</code> and <code>Me.Subform_name.Width</code> are the strings to get the size of the <strong>Subform</strong> \"<em>Subform_name</em>\", what are the strings to get the size of the <strong>Table</strong> \"<em>Table_name</em>\"?</p>\n\n<p>EDIT:\nWith \"<strong>Table</strong>\" I mean a table of the database.</p>\n"}, {"tags": ["json", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1526458366, "creation_date": 1526458366, "answer_id": 50365589, "question_id": 50365126, "link": "https://stackoverflow.com/questions/50365126/enclosing-the-content-of-object-in-double-quotes-in-vba/50365589#50365589", "title": "Enclosing the content of object in double quotes in VBA", "body": "<p>If you replace this:</p>\n\n<pre><code>jsTest = \"{\" + smry + \":\" + \"'\" + CStr(Msg.Subject) + \"'\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>jsTest = \"{\" + smry + \":\" + \"\"\"\" + CStr(Msg.Subject) + \"\"\"\"\n</code></pre>\n\n<p>and so on, you will get your quotes.</p>\n"}], "owner": {"reputation": 859, "user_id": 7986808, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9c7c2b8e8a67a276bbc476d48a102b?s=128&d=identicon&r=PG&f=1", "display_name": "khashashin", "link": "https://stackoverflow.com/users/7986808/khashashin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 50365589, "answer_count": 1, "score": 0, "last_activity_date": 1526458366, "creation_date": 1526456863, "question_id": 50365126, "link": "https://stackoverflow.com/questions/50365126/enclosing-the-content-of-object-in-double-quotes-in-vba", "title": "Enclosing the content of object in double quotes in VBA", "body": "<p>It probably sounds simple, but I can not find a way out.\nI'm trying to create a more or less dynamic json and I need to convert the content of object to a string between double quotes. Something like that  :\n<code>\"\"\" + object + \"\"\"</code> gives the following result <code>\"object\"</code> and the expected result would be <code>\"content of object\"</code>.</p>\n\n<p>Here is my code, will probably be more clear, about what it's about.</p>\n\n<pre><code>Dim jsTest As String\njsTest = \"\"\" + CStr(Msg.Subject) + \"\"\" + \"\"\" + CStr(Msg.Body) + \"\"\"\n</code></pre>\n\n<p><code>Msg.Subject</code> and <code>Msg.Body</code> are objects from Email. I can do that this way(with single quotes):</p>\n\n<pre><code>Dim smry, descrp, jsTest As String\nsmry = \"\"\"summary\"\"\"\ndescrp = \"\"\"description\"\"\"\njsTest = \"{\" + smry + \":\" + \"'\" + CStr(Msg.Subject) + \"'\" + \",\" + descrp + \":\" + \"'\" + CStr(Msg.Body) + \"'\" + \"}\"\n</code></pre>\n\n<p>but then I get content of object as String with single quotes and I cant put it in my JSON like so:</p>\n\n<pre><code>{\"summary\": 'Release 18.20 Produktion', \"description\": 'Guten Tag Sie erhalten diese Terminanfrage'}\n</code></pre>\n\n<p>How can I get result like (<strong>Note</strong> double quotes):</p>\n\n<pre><code>{\"summary\": \"Release 18.20 Produktion\", \"description\": \"Guten Tag Sie erhalten diese Terminanfrage\"}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1526456254, "post_id": 50364721, "comment_id": 87746029, "body": "<i>I am trying to figure out</i> and <i>I want to be able to</i> - see next comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1526456260, "post_id": 50364721, "comment_id": 87746034, "body": "Please do not come here with a list of requirements and an expectation that someone is going to write all of your code for free. This is counter to the site&#39;s conditions and requirements that you agreed upon when joining this community and frankly, more than just a little insulting to the altruistic volunteers whose valuable time and attention you&#39;ve misdirected in your request to have someone do your work for you. Take a step back and read all of the readily available Help white papers on what sort of question (and effort on your part) is expected before posting your question."}, {"owner": {"reputation": 1, "user_id": 1613237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a3276edde7390c50c8e1e6ac58d989?s=128&d=identicon&r=PG", "display_name": "user1613237", "link": "https://stackoverflow.com/users/1613237/user1613237"}, "edited": false, "score": 0, "creation_date": 1526459335, "post_id": 50364721, "comment_id": 87747957, "body": "No offense but I have been spending my time trying to figure out different approaches and they aren&#39;t coming together.  You want me to splil out all of the various formulas and failed attempts in order to try and at least point in the right direction.  Not trying to be insulting. I am trying to figure out where I am going wrong."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1526460376, "post_id": 50364721, "comment_id": 87748595, "body": "This might seem counter-productive to you but in this community we correct original effort; we go not supply key-turn code without some original effort."}, {"owner": {"reputation": 1, "user_id": 1613237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a3276edde7390c50c8e1e6ac58d989?s=128&d=identicon&r=PG", "display_name": "user1613237", "link": "https://stackoverflow.com/users/1613237/user1613237"}, "edited": false, "score": 0, "creation_date": 1526465124, "post_id": 50364721, "comment_id": 87751975, "body": "I am not looking for someone to write it out for me and plug-n-play.  Jeeped go relax with a beer and forget I even asked for guidance.  Repeat, guidance.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1613237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a3276edde7390c50c8e1e6ac58d989?s=128&d=identicon&r=PG", "display_name": "user1613237", "link": "https://stackoverflow.com/users/1613237/user1613237"}, "edited": false, "score": 0, "creation_date": 1526465034, "post_id": 50366856, "comment_id": 87751914, "body": "Thanks so much. I will check that out.  I have started already seeing what I can do to adjust the original sources.  Thought that was a good area to start on first.  Appreciate the suggestion"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1526462231, "creation_date": 1526462231, "answer_id": 50366856, "question_id": 50364721, "link": "https://stackoverflow.com/questions/50364721/pull-information-from-multiple-worksheets-and-consolidate-and-sum-by-vendor/50366856#50366856", "title": "Pull Information From Multiple Worksheets And Consolidate and Sum By Vendor", "body": "<p>You can use Power Query / Get and Transform to combine multiple sheets into one data source and then use pivot tables to report on that combined data. You may need to revisit the data architecture of the original sources to ensure that the data can be combined with logic that does not require human intervention.</p>\n"}], "owner": {"reputation": 1, "user_id": 1613237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a3276edde7390c50c8e1e6ac58d989?s=128&d=identicon&r=PG", "display_name": "user1613237", "link": "https://stackoverflow.com/users/1613237/user1613237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526462231, "creation_date": 1526455534, "last_edit_date": 1526462034, "question_id": 50364721, "link": "https://stackoverflow.com/questions/50364721/pull-information-from-multiple-worksheets-and-consolidate-and-sum-by-vendor", "title": "Pull Information From Multiple Worksheets And Consolidate and Sum By Vendor", "body": "<p>I am trying to figure out the best way to return information from multiple worksheets into a consolidated summed total worksheet but having a problem getting to completion.</p>\n\n<p>I am trying to take information from 2 different reports (1) Master Vendor/Factory List) and (2) Capacity By Factory sans Vendor Name as how its currently provided by the vendor.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZViyj.png\" alt=\"Capacity Worksheet\">\n<img src=\"https://i.stack.imgur.com/NBDqF.png\" alt=\"Vendor List\"></p>\n\n<p>I want to be able to, in a separate worksheet return the results plus the capacity values into a consolidated worksheet.  Ideally, after each vendor I would also like to Sum the totals.  Total vendor list well over 100.</p>\n\n<p><img src=\"https://i.stack.imgur.com/4o9pL.png\" alt=\"Ideal Final State\"></p>\n\n<p>I have tried multiple Index functions but feel like there is a scan needed that I am not able to figure out how to complete or that the code is more complex than I am capable of figuring out on my own.</p>\n\n<p>Thanks for any help those that can provide.  Open to taking small portions to try and solve.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 9798455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1LNVy61TLg/AAAAAAAAAAI/AAAAAAAAAG8/0kcXorJJch4/photo.jpg?sz=128", "display_name": "Moataz Gamal", "link": "https://stackoverflow.com/users/9798455/moataz-gamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526459022, "creation_date": 1526455434, "last_edit_date": 1531164843, "question_id": 50364693, "link": "https://stackoverflow.com/questions/50364693/how-to-refer-data-to-different-sheets-with-different-range-cells-in-the-main-sh", "title": "How to refer data to different sheets (with different range cells in the main sheet)", "body": "<p>I am building an excel sheet, in which it copy the data with reference cells in other sheet in the same excel I have this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  If Target.Cells.Count &gt; 1 Or IsEmpty(Target) Then Exit Sub\n\n    If Not Intersect(Target, Range(\"b10:B10\")) Is Nothing Then\n\n        If IsNumeric(Target) Then\n\n            'Stop any possible runtime errors and halting code\n\n            On Error Resume Next\n\n                'Turn off ALL events so the Target does not put the code into a loop.\n\n                Application.EnableEvents = False\n\n                Call Update_Monthly\n\n                'Turn events back on\n\n                Application.EnableEvents = True\n\n            'Allow run time errors again\n\n            On Error GoTo 0\n\n        End If\n\n    End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>And I made another code in the module of WS2 with this code:</p>\n\n<pre><code>Sub Update_Monthly()\nDim ws1 As Worksheet, ws2 As Worksheet\nSet ws1 = Sheets(\"Daily Testing\")\nSet ws2 = Sheets(\"Monthly Record\")\nApplication.ScreenUpdating = False\nlr = ws2.Cells(Rows.Count, \"C\").End(xlUp).Row\nFor i = 1 To 5\nws2.Cells(i + lr, \"C\") = ws1.Cells(i + 5, \"B\")\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The coloumn range refer data to sheet 2\nNow if I have sheet3 , sheet 4\nHow will I refer data with same code w1 ( but differes only in Range b10:B10)?</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1526462598, "post_id": 50364464, "comment_id": 87750156, "body": "That&#39;s nice. Thanks for sharing. Who is the person you refer to as &quot;him&quot;? And is there a question anywhere in your post? Please learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and then <a href=\"https://stackoverflow.com/posts/50364464/edit\">edit</a> your question to help us learn what you need help with."}, {"owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1526473238, "post_id": 50364464, "comment_id": 87757438, "body": "Sorry , for not being too direct , i edited so it&#39;s more simple to people understand my question."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1526473593, "post_id": 50364464, "comment_id": 87757680, "body": "@PedroGaspar your editing is still poor.  You&#39;re not asking any questions."}, {"owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1526474507, "post_id": 50364464, "comment_id": 87758267, "body": "I isolated my question."}], "owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526474472, "creation_date": 1526454559, "last_edit_date": 1526474472, "question_id": 50364464, "link": "https://stackoverflow.com/questions/50364464/excel-vba-allow-only-if-condition-verifies", "title": "EXCEL VBA , Allow only if condition verifies", "body": "<p>I need a condition that sees if an item has stock in X wharehouse(CC) , if there's any stock than the user can move if there's no stock than the item can't be moved. \nRight now i have a condition than only allows only to move from 1 to max stock.</p>\n\n<pre><code>last = Application.ThisWorkbook.Worksheets(\"Registos\").Range(\"A65536\").End(xlUp).Row\n\n   For i = 1 To last\n        REFERENCIA = Application.ThisWorkbook.Worksheets(\"Registos\").Cells(i, 8)\n        ENTRADAeSAIDA = Application.ThisWorkbook.Worksheets(\"Registos\").Cells(i, 12)\n        CC = Application.ThisWorkbook.Worksheets(\"Registos\").Cells(i, 6)\n</code></pre>\n\n<p>Down bellow  is my condition that's suppose to check for the check in and if there's no check in can't be any checkout my problema is that the first time i run CommandButton it doesn't works so there will be a checkout without having any check in , and after the first time i run CommandButton it works but not properly as it also doesn't let me move nothing even if i have it on stock</p>\n\n<pre><code>            If registos.ComboBox1 = \"SA\u00cdDA\" Then\n                If REFERENCIA &lt;&gt; registos.TextBox1 And CC = registos.Label11.Caption Then\n                    MsgBox \"N\u00e3o existe em stock!\"\n                    GoTo fim\n                Else: GoTo salto_1\n                End If\n            End If\n</code></pre>\n\n<p>End here the condition           </p>\n\n<pre><code>salto_1:\n            If REFERENCIA = registos.TextBox1 And registos.ComboBox1 = \"SA\u00cdDA\" Then\n                Worksheets(\"registos\").Select\n                ActiveSheet.ListObjects(\"Tabela1\").Range.AutoFilter Field:=8, Criteria1:= _\n                registos.TextBox1.Text                                                        'Filtrar refer\u00eancia\n\n                ActiveSheet.ListObjects(\"Tabela1\").Range.AutoFilter Field:=6, Criteria1:= _\n                registos.Label11.Caption                                                      'Filtrar CC\n\n                ActiveSheet.ListObjects(\"Tabela1\").Range.AutoFilter Field:=12, Criteria1:= _\n                \"ENTRADA\"                                                                     'Filtrar Entrada\n\n                'Somar quantidades de pe\u00e7as de Entrada\n                xty100 = ThisWorkbook.Worksheets(\"calculos\").Range(\"A1\")\n\n                ActiveSheet.ListObjects(\"Tabela1\").Range.AutoFilter Field:=12, Criteria1:= _\n                \"SA\u00cdDA\"                                                                       'Filtrar Sa\u00edda\n\n                'Somar quantidade de pe\u00e7as de sa\u00edda\n                xty101 = ThisWorkbook.Worksheets(\"calculos\").Range(\"A1\")\n\n                sumfinal = xty100 - xty101                                                     'Calculo do Stock\n\n\n                ThisWorkbook.Worksheets(\"calculos\").Range(\"A20\") = Format(registos.TextBox4, \"@\")\n                xtybx4 = ThisWorkbook.Worksheets(\"calculos\").Range(\"A20\")\n\n                If xtybx4 &lt;= sumfinal And xtybx4 &gt; 0 Then\n                    GoTo salto_2\n                Else\n                    MsgBox \"N\u00e3o foi poss\u00edvel concluir o movimento!Stock  \" &amp; sumfinal &amp; \"\"\n                GoTo fim\n                End If\n            End If\n\n    Next i\n\n\n\n\n\n\nsalto_2:\n\n\n\n\n         If registos.TextBox3 = \"\" And registos.TextBox1 &lt;&gt; \"\" And registos.TextBox2 &lt;&gt; \"\" And registos.TextBox4 &lt;&gt; \"\" And registos.ComboBox5 &lt;&gt; \"\" Then\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 1) = Now()                                                  'data\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 5) = registos.Label20.Caption                               'ano fiscal\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 6) = registos.Label11.Caption                               'cc\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 7) = a1logiin.TextBox1                                      'operario\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 8) = registos.TextBox1                                      'referencia formata\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 9) = registos.TextBox2                                      'ordem\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 11) = Format(registos.TextBox4, \"#\")                        'quantidade\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 12) = registos.ComboBox1                                    'ENTRADA/SAIDA\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 13) = registos.ComboBox5                                    ' ESTADO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 14) = Format(registos.ComboBox3, \"#\")                       'CODIGO DEFEITO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 16) = registos.ComboBox6                                    'ORIGEM DEFEITO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 17) = registos.TextBox5                                     'OBSERVA\u00c7\u00d5ES\n            MsgBox \"Dados introduzidos com sucesso!\"\n            'GoTo fim\n            GoTo fim2\n         End If\n            MsgBox \"Insira todos os dados\"\n        GoTo fim\n\nfim2: If registos.ComboBox1 &lt;&gt; \"SA\u00cdDA\" Then\n    GoTo fim\n    End If\n\n\n         If registos.ComboBox1 = \"SA\u00cdDA\" And registos.TextBox3 = \"\" And registos.TextBox1 &lt;&gt; \"\" And registos.TextBox2 &lt;&gt; \"\" And registos.TextBox4 &lt;&gt; \"\" And registos.ComboBox5 &lt;&gt; \"\" And registos.ComboBox2 &lt;&gt; \"\" Then\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 1) = Now()                                                  'data\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 5) = registos.Label20.Caption           'ThisWorkbook.Worksheets(\"anofiscal\").Range(\"A1\")       'ano fiscal\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 6) = registos.ComboBox2                                     'cc\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 7) = a1logiin.TextBox1                                      'operario\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 8) = registos.TextBox1                                      'referencia formata\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 9) = registos.TextBox2                                      'ordem\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 11) = Format(registos.TextBox4, \"#\")                        'quantidade\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 12) = \"ENTRADA\"                                             'Define a sa\u00edda de um como a entrada de outro\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 13) = registos.ComboBox5                                    ' ESTADO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 14) = Format(registos.ComboBox3, \"#\")                       'CODIGO DEFEITO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 16) = registos.ComboBox6                                    'ORIGEM DEFEITO\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 17) = registos.TextBox5                                     'OBSERVA\u00c7\u00d5ES\n            Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 18) = registos.ComboBox7                                    'detalhe produ\u00e7\u00e3o\n            GoTo fim\n            End If\n\nIf contador = 1 Then\n        MsgBox \"Foi efetuado o registo de \" &amp; contador &amp; \" refer\u00eancia!\", vbInformation\n   ' Else\n    '    MsgBox \"Foi efetuado o registo de \" &amp; contador &amp; \" refer\u00eancias!\", vbInformation\nEnd If\ncontador = 0\nGoTo fim:\n\nfim:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting", "range"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1526455863, "creation_date": 1526455863, "answer_id": 50364812, "question_id": 50364268, "link": "https://stackoverflow.com/questions/50364268/excel-vba-copying-info-to-other-sheet-but-with-random-names/50364812#50364812", "title": "Excel VBA, Copying info to other sheet but with random names", "body": "<p>Add something like this, and apply it either on the source sheet or on the target sheet:</p>\n\n<pre><code>Range(\"C3\").Formula = \"=RAND()\"\nRange(\"C3\").AutoFill Destination:=Range(\"C3:C70\")\n\nRange(\"A:C\").Sort key1:=Range(\"C3\"), order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>It creates a column of random values, used for sorting. You might want to delete it afterwards.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9798421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb12ff5a1e881ed5ccf5662a3b5c640?s=128&d=identicon&r=PG", "display_name": "fatique", "link": "https://stackoverflow.com/users/9798421/fatique"}, "is_accepted": false, "score": 0, "last_activity_date": 1526457626, "creation_date": 1526457626, "answer_id": 50365368, "question_id": 50364268, "link": "https://stackoverflow.com/questions/50364268/excel-vba-copying-info-to-other-sheet-but-with-random-names/50365368#50365368", "title": "Excel VBA, Copying info to other sheet but with random names", "body": "<pre><code>Sub randomName()\nDim ws As String, ws2 As String, rg As Range, rg2 As Range\nDim DataRange As Variant, i As Integer\nDim n As Integer, tmp As String\nDim nData As Integer\n      '== set by user\n            nData = 70        '== data size\n            ws = \"sheet1\":                ws2 = \"RandomNames\"     '== sheets name\n            Set rg = Sheets(ws).Cells(3, 1):            Set rg2 = Sheets(ws2).Cells(3, 1)       '=range with start row\n      '== Run\n            rg2.Resize(nData, 2).Value = rg.Resize(nData, 2).Value\n            DataRange = rg.Resize(nData).Value\n            For i = 1 To UBound(DataRange)\n                  n = CLng(Rnd(i) * Second(Now) * 100) Mod UBound(DataRange) + 1\n                  If i &lt;&gt; n Then tmp = DataRange(n, 1):          DataRange(n, 1) = DataRange(i, 1):         DataRange(i, 1) = tmp\n            Next i\n            rg2.Resize(nData) = DataRange:            Set rg = Nothing:            Set rg2 = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8359588, "user_type": "registered", "profile_image": "https://graph.facebook.com/1500261133328155/picture?type=large", "display_name": "Kalin Stoev", "link": "https://stackoverflow.com/users/8359588/kalin-stoev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 50364812, "answer_count": 2, "score": 0, "last_activity_date": 1526457626, "creation_date": 1526453869, "question_id": 50364268, "link": "https://stackoverflow.com/questions/50364268/excel-vba-copying-info-to-other-sheet-but-with-random-names", "title": "Excel VBA, Copying info to other sheet but with random names", "body": "<p>I'm having a problem with my excel program. I want to make the names and the telephone numbers to paste at the other sheet, but names must be sorted randomly and the phone numbers must be the same. For Example at the first sheet i have Kalin Kalinov +22222222 and Martin Martinov +99119911 and at the other sheet after the copy paste action they must be like Martin Martinov +99119911 and Kalin Kalinov +22222222. </p>\n\n<pre><code>Sub GenerateNames()\nDim ssheet1 As Worksheet\nDim rnsheet As Worksheet\nSet ssheet1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet rnsheet = ThisWorkbook.Sheets(\"RandomNames\")\n\nssheet1.Range(\"A3:A70\").Copy rnsheet.Range(\"A3:A70\")\nssheet1.Range(\"B3:B70\").Copy rnsheet.Range(\"B3:B70\")\nEnd Sub  \n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "array-formulas", "vba"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1526451941, "post_id": 50363494, "comment_id": 87743648, "body": "I might be wrong but... Can&#39;t you get what you want by simply setting a multi-level sort?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1526454837, "last_edit_date": 1526454837, "creation_date": 1526454278, "answer_id": 50364382, "question_id": 50363494, "link": "https://stackoverflow.com/questions/50363494/excel-vba-looping-formula-array-and-pass-it-into-variables/50364382#50364382", "title": "Excel VBA - looping formula array and pass it into variables", "body": "<p>I am not entirely clear on which max and mins you want but provided you convert your date strings to actual dates, you can use a pivottable to get any combination of max, mins from the date e.g.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qSTbS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qSTbS.png\" alt=\"Example\"></a></p>\n\n<p>With the above: </p>\n\n<p>Helper column F has the formula in F2, which autofills down as source is set up as Excel table.</p>\n\n<pre><code>=DATE(LEFT(B2,4),MID(B2,5,2),RIGHT(B2,2))\n</code></pre>\n\n<p>This generates an actual date. </p>\n\n<p>Pressing <kbd>Ctrl</kbd>+<kbd>T</kbd>, with a cell selected in the range, convertes the data into an Excel table, then <kbd>Alt</kbd>+<kbd>N</kbd>+<kbd>V</kbd> generates a pivottable from that table.</p>\n\n<p>Then arrange as you wish. For example, with date in the rows area you can easily then select max and min dates via filter. You can have ticker either as a page field filter or add to the rows in front of the converted date. And then add open and closed fields to the values area. You can add the same field more than once. Make sure to right click on the first time you add and do value > field settings > min</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZTCez.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZTCez.png\" alt=\"value field settings\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6qvjQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6qvjQ.png\" alt=\"Min\"></a></p>\n\n<p>Repeat for adding the same field and set as max.</p>\n\n<p>Close up on pivot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8CZMD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8CZMD.png\" alt=\"Pivot\"></a></p>\n\n<hr>\n\n<p>If you want the all time max and min value, simply remove the date field from the rows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rp0G2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rp0G2.png\" alt=\"Example\"></a></p>\n\n<hr>\n\n<p>If you want for a particular year, when date field is in the rows area, right click and use the  date filters functionality:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZV2t0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZV2t0.png\" alt=\"Date filters\"></a></p>\n"}], "owner": {"reputation": 59, "user_id": 4822099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zDdp7.jpg?s=128&g=1", "display_name": "Andres Silvia", "link": "https://stackoverflow.com/users/4822099/andres-silvia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 50364382, "answer_count": 1, "score": 0, "last_activity_date": 1526454837, "creation_date": 1526450773, "last_edit_date": 1531164843, "question_id": 50363494, "link": "https://stackoverflow.com/questions/50363494/excel-vba-looping-formula-array-and-pass-it-into-variables", "title": "Excel VBA - looping formula array and pass it into variables", "body": "<p>i'm working on an exercise where i have the following columns</p>\n\n<ul>\n<li>first column for primary key</li>\n<li>second column for open date</li>\n<li>third column for open price</li>\n<li>fourth column for close date</li>\n<li>fifth column for close price</li>\n</ul>\n\n<p>The primary key will repeat multiple time due to different open date and close date through the year. So currently i'm able to use advance filtering function through vba and get an unique record of primary key, but i also need to find the min and max of open date and close date based on each primary key and identify the open price based on min of open date and closed price based on max  of closed date. </p>\n\n<p>can anyone help? because i can solve this with array formula within excel but no luck of converting each array formula into vba and pass it to variables.</p>\n\n<p>sample list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PbspN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PbspN.jpg\" alt=\"sample list\"></a></p>\n\n<p>expected result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OquaB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OquaB.jpg\" alt=\"expected result\"></a></p>\n\n<p>array formulas used:</p>\n\n<p>=MIN(IF(A1:A70926=J2,B1:B70926))</p>\n\n<p>=INDEX(C:C,MATCH(1,(J2=$A:$A)*(M2=$B:$B),0))</p>\n\n<p>=MAX(IF($A:$A=J2,$B:$B))</p>\n\n<p>=INDEX(F:F,MATCH(1,(J2=$A:$A)*(O2=$B:$B),0))</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1526574285, "post_id": 50363564, "comment_id": 87808366, "body": "@Baron, any feedback?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1526451089, "creation_date": 1526451089, "answer_id": 50363564, "question_id": 50363267, "link": "https://stackoverflow.com/questions/50363267/delete-two-rows-at-the-same-time-by-using-vba-in-a-given-condition/50363564#50363564", "title": "Delete two rows at the same time by using VBA in a given condition", "body": "<p>you could try this:</p>\n\n<pre><code>Sub test()\n    Dim i As Long\n\n    For i = 300 To 1 Step -1\n        If Cells(i + 1, 1).MergeCells Then Rows(i).Resize(2).EntireRow.Delete 'delete the row with the merged cell and the row above\n    Next\n    If Cells(1, 1).MergeCells Then Rows(1).EntireRow.Delete 'if first cell is merged, then delete its row\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 2, "last_activity_date": 1526451092, "creation_date": 1526451092, "answer_id": 50363565, "question_id": 50363267, "link": "https://stackoverflow.com/questions/50363267/delete-two-rows-at-the-same-time-by-using-vba-in-a-given-condition/50363565#50363565", "title": "Delete two rows at the same time by using VBA in a given condition", "body": "<pre><code>For i = 1 To 300 Step 1\n    If Cells(i, 1).MergeCells = True Then\n        Cells(i, 1).MergeArea.EntireRow.Delete\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7682179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03bc59a143b19a8d0b847a365453bc28?s=128&d=identicon&r=PG&f=1", "display_name": "Baron", "link": "https://stackoverflow.com/users/7682179/baron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 50363564, "answer_count": 2, "score": 0, "last_activity_date": 1526451092, "creation_date": 1526449760, "last_edit_date": 1526450629, "question_id": 50363267, "link": "https://stackoverflow.com/questions/50363267/delete-two-rows-at-the-same-time-by-using-vba-in-a-given-condition", "title": "Delete two rows at the same time by using VBA in a given condition", "body": "<p>The condition is that in <code>Column A</code>, if the cell (<code>A1,A2,A3....</code>) is a merged cell, then delete the entire row and the row above this cell</p>\n\n<p>I know how to delete one entire row but I duplicate the language when trying to delete the 2nd row (can I put them together?)</p>\n\n<pre><code>Sub test()\n\nDim i As Integer\n\nFor i = 1 To 300 Step 1\n    If Cells(i, 1).MergeCells = True Then\n        Rows(i - 1).EntireRow.Delete 'delete  the row above the merged cell\n    End If\nNext i\n\nFor i = 1 To 300 Step 1\n    If Cells(i, 1).MergeCells = True Then\n    Rows(i).EntireRow.Delete 'delete another row where the merged cell is\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}]