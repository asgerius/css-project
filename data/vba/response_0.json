[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1420675118, "post_id": 27830796, "comment_id": 44067526, "body": "There&#39;s an answer with 3 upvotes in that same link you posted to which provides the code for using autofilter which is much faster"}, {"owner": {"reputation": 283, "user_id": 4421557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24e40e924457ef3532f34723da181332?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/4421557/tomek"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1420692916, "post_id": 27830796, "comment_id": 44071939, "body": "@tigeravatar oh ok thanks, i didn&#39;t see that... i wished there was bit more explanation to it. I&#39;ll try to re-write it for my case and if the results are what i&#39;m looking for. Thanks again, will get back to it once i have tried it."}, {"owner": {"reputation": 283, "user_id": 4421557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24e40e924457ef3532f34723da181332?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/4421557/tomek"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1420693540, "post_id": 27830796, "comment_id": 44072123, "body": "Ok, this one can be closed. I used the auto filter suggestion described in the post i mentioned in my problem. worked fine for me <code>Range(&quot;A1:A10000&quot;).AutoFilter 1, &quot;&lt;&gt;&quot;, , , False</code>"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421691982, "post_id": 27830796, "comment_id": 44447068, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/24078437/faster-way-to-hide-empty-rows\">Faster way to hide empty rows</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1420675813, "creation_date": 1420675813, "answer_id": 27830934, "question_id": 27830796, "link": "https://stackoverflow.com/questions/27830796/hide-rows-when-cell-is-empty-excel-faster-way/27830934#27830934", "title": "Hide Rows when cell is empty excel (faster way)", "body": "<pre><code>Dim rngBlnk As Range\n\nOn Error Resume Next 'in case no blanks are present...\nSet rngBlnk = Range(\"A1:A100000\").SpecialCells(xlCellTypeBlanks)\nOn Error GoTo 0\n\nIf Not rngBlnk Is Nothing Then\n    Debug.Print rngBlnk.Address()\n    rngBlnk.EntireRow.Hidden = True\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 4421557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24e40e924457ef3532f34723da181332?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/4421557/tomek"}, "is_accepted": true, "score": 1, "last_activity_date": 1421818741, "last_edit_date": 1495541187, "creation_date": 1421818741, "answer_id": 28060340, "question_id": 27830796, "link": "https://stackoverflow.com/questions/27830796/hide-rows-when-cell-is-empty-excel-faster-way/28060340#28060340", "title": "Hide Rows when cell is empty excel (faster way)", "body": "<p>As in my comments and in this post: <a href=\"https://stackoverflow.com/questions/24078437/faster-way-to-hide-empty-rows\">Faster way to hide empty rows</a>\nand thanks to @tigeravatar for pointing it out. I used the following code which worked in my scenario:</p>\n\n<pre><code>Range(\"A1:A10000\").AutoFilter 1, \"&lt;&gt;\", , , False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4743846, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6747ab615685b61f21ed792be34f6161?s=128&d=identicon&r=PG", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/4743846/neil-humphries"}, "is_accepted": false, "score": 0, "last_activity_date": 1428000618, "creation_date": 1428000618, "answer_id": 29420300, "question_id": 27830796, "link": "https://stackoverflow.com/questions/27830796/hide-rows-when-cell-is-empty-excel-faster-way/29420300#29420300", "title": "Hide Rows when cell is empty excel (faster way)", "body": "<p>The select process takes time, and there is no need to select the row before hiding the row. Try the variation below...</p>\n\n<pre><code>Application.ScreenUpdating = False\nDim s As String\nFor i = 1 To range(\"A1:A10000\").Count\n    s = i &amp; \":\" &amp; i\n    If IsEmpty(Cells(i, 1).Value) Then\n         Rows(s).EntireRow.Hidden = True\n    End If\nNext \nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 4421557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24e40e924457ef3532f34723da181332?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/4421557/tomek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40846, "favorite_count": 0, "accepted_answer_id": 28060340, "answer_count": 3, "score": 2, "last_activity_date": 1428000618, "creation_date": 1420674866, "last_edit_date": 1495539805, "question_id": 27830796, "link": "https://stackoverflow.com/questions/27830796/hide-rows-when-cell-is-empty-excel-faster-way", "title": "Hide Rows when cell is empty excel (faster way)", "body": "<p>I had a look at some articles and suggestions and came up with a solution for my problem.</p>\n\n<p>The article <a href=\"https://stackoverflow.com/questions/24078437/faster-way-to-hide-empty-rows\">Faster way to hide empty rows</a> suggested to use to toggle <code>Application.ScreenUpdating</code> before the loop to false and after to true. It sped up the script a little but for 10.000 rows it still takes quite some time.</p>\n\n<p><strong>Requirements:</strong></p>\n\n<p>If the first cell in the row is empty, hide the complete row\nit needs to be backwards compatible to other excel versions than 2013</p>\n\n<p><strong>Current working solution for excel 2013</strong></p>\n\n<pre><code> Application.ScreenUpdating = False\n Dim s As String\n For i = 1 To range(\"A1:A10000\").Count\n     s = i &amp; \":\" &amp; i\n     If IsEmpty(Cells(i, 1).Value) Then\n         Rows(s).Select\n         Selection.EntireRow.Hidden = True\n    End If\n Next\n Application.ScreenUpdating = True\n</code></pre>\n\n<p>Unfortunately I don't know how much data in the sheet is, it can contain less than 10.000 which i used in my example or even more. When i run the script it works fine, but takes quite a while for 10.000 rows and ages for all cells in the sheet.</p>\n\n<p>The macro would run on automatically when the workbook is loaded (not sure yet how to do that either haha)</p>\n"}, {"tags": ["variables", "excel", "calculated-field", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1420673504, "post_id": 27830435, "comment_id": 44067057, "body": "What&#39;s wrong with the code you have here? You&#39;ve not explained the problem you&#39;re having (or frankly, the problem you&#39;re trying to solve)."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1420675667, "post_id": 27830435, "comment_id": 44067672, "body": "To read it, I&#39;m seeing some differences of how I would go about it, and I have to assume there is an error as a result of one of those differences.  What exactly is your error?"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1420676416, "post_id": 27830435, "comment_id": 44067916, "body": "I&#39;m going to guess that there is a problem with attempting to multiply text without first converting it to a numeric variably type.  The logic of the code you&#39;ve posted is good and looks like it would work."}, {"owner": {"reputation": 57, "user_id": 4267482, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/2415724/picture?type=large", "display_name": "Bethany Minor", "link": "https://stackoverflow.com/users/4267482/bethany-minor"}, "edited": false, "score": 0, "creation_date": 1420760589, "post_id": 27830435, "comment_id": 44107152, "body": "Hi Peege I think you&#39;re right and will try this when I&#39;m back in the office tomorrow. Ken the issue I had was as soon as I submitted the form there was no answer in the field. Basically it always ended up just being 0 no matter what I typed in."}], "answers": [{"tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 0, "last_activity_date": 1420680470, "last_edit_date": 1420680470, "creation_date": 1420676342, "answer_id": 27831018, "question_id": 27830435, "link": "https://stackoverflow.com/questions/27830435/multiplying-with-vba/27831018#27831018", "title": "Multiplying with VBA", "body": "<p>I am assuming that the error is because you are trying to multiply strings of text that happen to be numeric characters.  They will need converted to numbers.  I would use Long type, or Double, depending on what kind of numbers you are using.  Integer is more likely to have errors with varying user inputs in the text boxes.  I'm going to use Long in the example, because it's closest to Integer, but if the numbers get very large, or use decimals, I'd switch them to Double.</p>\n\n<p>I've modified a few other things about your code.  Mainly in getting the .Text Property of the text boxes and converting them to Long variables.  Also, in the declaration of addresses, instead of using Offset from A1, just declare the address using '.Cells(Row,Col)'.  In general, your logic seems right.  </p>\n\n<p>Try this and see if there are any errors. </p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim emptyRow As Long\nDim ctl As Control\nDim A As Long, B As Long, C As Long, D As Long, E As Long\nDim Answer As Long, Answer2 As Long, Answer3 As Long\n\n    'Validation\n    If txtNoTotalAff.Text= \"\" Then\n        MsgBox (\"Please enter the Total Number of Affiliates\", vbExclamation, \"ROI\")\n        txtNoTotalAff.SetFocus\n        Exit Sub\n    End If\n\n    If Me.lstClientName.Value = \"\" Then\n        MsgBox (\"Please enter Client Name\", vbExclamation, \"ROI\")\n        lstClientName.SetFocus\n        Exit Sub\n    End If\n\n    'Determine Empty Row\n    emptyRow = Sheets(\"ROI\").Range(\"A\" &amp; Rows.count).End(xlUp).row + 1\n    A = CLng(txtNoTotalAff.Text)\n    B = CLng(txtActiveAff.Text)\n    C = CLng(txtAvgTraffic.Text)\n    D = CLng(txtConvRate.Text)\n    E = CLng(txtAOV.Text)\n\n    Answer = A * B\n    Answer2 = Answer * C\n    Answer3 = (Answer2 * D) * E\n\n    'Transfer Information\n    Sheets(\"ROI\").Cells(emptyRow, 1) = lstClientName.Text     'Col \"A\"\n    Sheets(\"ROI\").Cells(emptyRow, 2 ) = txtNoTotalAff.Text    'Col \"B\"\n    Sheets(\"ROI\").Cells(emptyRow, 3) = txtActiveAff.Text      'Col \"C\"\n    Sheets(\"ROI\").Cells(emptyRow, 4) = Answer                 'Col \"D\"\n    Sheets(\"ROI\").Cells(emptyRow, 5) = txtAvgTraffic.Text     'Col \"E\"\n    Sheets(\"ROI\").Cells(emptyRow, 6) = Answer2                'Col \"F\"\n    Sheets(\"ROI\").Cells(emptyRow, 7) = txtConvRate.Text       'Col \"G\"\n    Sheets(\"ROI\").Cells(emptyRow, 8) = txtAOV.Text            'Col \"H\"\n    Sheets(\"ROI\").Cells(emptyRow, 9) = Answer3                'Col \"I\"\n    Sheets(\"ROI\").Cells(emptyRow, 10) = txtAffName.Value      'Col \"J\"\n\n    'Clear the Form\n    For Each ctl In Me.Controls\n        If TypeName(ctl) = \"TextBox\" Or TypeName(ctl) = \"ComboBox\" Then\n        ctl.Value = \"\"\n        ElseIf TypeName(ctl) = \"CheckBox\" Then\n        ctl.Value = False\n        End If\n    Next ctl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4267482, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/2415724/picture?type=large", "display_name": "Bethany Minor", "link": "https://stackoverflow.com/users/4267482/bethany-minor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4059, "favorite_count": 0, "accepted_answer_id": 27831018, "answer_count": 1, "score": 1, "last_activity_date": 1420680470, "creation_date": 1420672711, "last_edit_date": 1531164843, "question_id": 27830435, "link": "https://stackoverflow.com/questions/27830435/multiplying-with-vba", "title": "Multiplying with VBA", "body": "<p>I have a form where i need to multiply 3 different values to provide the desired result. It is below:</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim emptyRow As Long\nDim ctl As Control\nDim A As Integer\nDim B As Integer\nDim C As Integer\nDim D As Integer\nDim E As Integer\nDim Answer As Integer\nDim Answer2 As Integer\nDim Answer3 As Integer\n\n\n\nIf Me.txtNoTotalAff.Value = \"\" Then\n    MsgBox \"Please enter the Total Number of Affiliates\", vbExclamation, \"ROI\"\n    Me.txtNoTotalAff.SetFocus\n    Exit Sub\nEnd If\nIf Me.lstClientName.Value = \"\" Then\n    MsgBox \"Please enter Client Name\", vbExclamation, \"ROI\"\n    Me.lstClientName.SetFocus\n    Exit Sub\nEnd If\n'Determine Empty Row\n emptyRow = Worksheets(\"ROI\").Range(\"A1\").CurrentRegion.Rows.Count\n A = txtNoTotalAff.Value\n B = txtActiveAff.Value\n C = txtAvgTraffic.Value\n D = txtConvRate.Value\n E = txtAOV.Value\n\n Answer = A * B\n Answer2 = Answer * C\n Answer3 = (Answer2 * D) * E\n\n 'Transfer Information\n With Worksheets(\"ROI\").Range(\"A1\")\n.Offset(emptyRow, 0).Value = lstClientName.Value\n.Offset(emptyRow, 1).Value = txtNoTotalAff.Value\n.Offset(emptyRow, 2).Value = txtActiveAff.Value\n.Offset(emptyRow, 3).Value = Answer\n.Offset(emptyRow, 4).Value = txtAvgTraffic.Value\n.Offset(emptyRow, 5).Value = Answer2\n.Offset(emptyRow, 6).Value = txtConvRate.Value\n.Offset(emptyRow, 7).Value = txtAOV.Value\n.Offset(emptyRow, 8).Value = Answer3\n.Offset(emptyRow, 9).Value = txtAffName.Value\n\n End With\n\n'Clear the Form\nFor Each ctl In Me.Controls\n    If TypeName(ctl) = \"TextBox\" Or TypeName(ctl) = \"ComboBox\" Then\n    ctl.Value = \"\"\n    ElseIf TypeName(ctl) = \"CheckBox\" Then\n    ctl.Value = False\n    End If\nNext ctl\n End Sub\n</code></pre>\n\n<p>I need to either use the variables and have them calculate each or I would like to use the answers themselves to get the desired result.</p>\n\n<p>How can I accomplish this?</p>\n"}, {"tags": ["excel", "vba", "insert", "row"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1420674746, "post_id": 27830418, "comment_id": 44067414, "body": "Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and post further details about your problem"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2941651"}, "edited": false, "score": 0, "creation_date": 1420674749, "post_id": 27830418, "comment_id": 44067416, "body": "Hi. Could you please provide the exact error in your answer and - if possible- mor code that the line lies within ?"}], "answers": [{"tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1420684099, "creation_date": 1420684099, "answer_id": 27832035, "question_id": 27830418, "link": "https://stackoverflow.com/questions/27830418/application-defined-or-object-defined-error-when-inserting-row/27832035#27832035", "title": "&quot;Application-defined or object-defined error&quot; when inserting row", "body": "<p>Based on the error message and lack of surrounding code I would say that your tmp_n variable either doesn't have a value or is declared as a String.</p>\n"}], "owner": {"reputation": 23, "user_id": 4191800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e273d40b89848ce431b189b4eacf2f?s=128&d=identicon&r=PG&f=1", "display_name": "adt772", "link": "https://stackoverflow.com/users/4191800/adt772"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420684099, "creation_date": 1420672618, "last_edit_date": 1420675473, "question_id": 27830418, "link": "https://stackoverflow.com/questions/27830418/application-defined-or-object-defined-error-when-inserting-row", "title": "&quot;Application-defined or object-defined error&quot; when inserting row", "body": "<p>I've completed parsed my code and found that the error is in this line of code, but I have no idea why:</p>\n\n<pre><code>Range(c).Resize(tmp_n).EntireRow.Insert\n</code></pre>\n\n<p>Where <code>c</code> is defined as string that looks like : <code>\"A3\"</code> or some other row and <code>tmp_n</code> is simply an integer. </p>\n"}, {"tags": ["vba", "excel", "if-statement", "replace"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4430676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Brc9q.jpg?s=128&g=1", "display_name": "Adiamond", "link": "https://stackoverflow.com/users/4430676/adiamond"}, "edited": false, "score": 0, "creation_date": 1420751421, "post_id": 27830513, "comment_id": 44103037, "body": "That worked!  Thank you so much!"}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 0, "last_activity_date": 1420673128, "creation_date": 1420673128, "answer_id": 27830513, "question_id": 27830188, "link": "https://stackoverflow.com/questions/27830188/excel-vba-if-then-replace/27830513#27830513", "title": "Excel VBA - If Then Replace", "body": "<p>This should do what you're looking to do... If it works for you, please mark the answer as accepted by clicking the checkmark to the left.</p>\n\n<pre><code>Sub Freplace()\ndim i as int\ndim s as string\ni = 1\ns = \"specific network\"\n\nDo until Cells(i,10).Value = \"\"\nIf Cells(i,10).Value = s Then Cells(i,8).Value = s\ni = i+1\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4430676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Brc9q.jpg?s=128&g=1", "display_name": "Adiamond", "link": "https://stackoverflow.com/users/4430676/adiamond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2431, "favorite_count": 0, "closed_date": 1420705530, "accepted_answer_id": 27830513, "answer_count": 1, "score": -1, "last_activity_date": 1420673128, "creation_date": 1420671490, "question_id": 27830188, "link": "https://stackoverflow.com/questions/27830188/excel-vba-if-then-replace", "closed_reason": "Needs more focus", "title": "Excel VBA - If Then Replace", "body": "<p>I am very new to VBA and I have read so much on the If-Then-Replace that I think I'm confusing myself.  Within my worksheet I have two columns that come in with more data than what I need and I have to get it pared down in order to concatenate it. </p>\n\n<p>Column H (Header) has the following data in each cell: Network: Series: Episode : Data</p>\n\n<p>Column J (Header) has the following data in each cell: Network: Type: Type2: Type3</p>\n\n<p>I run a text-to-columns to get it down to have the Network in 1 column and the Series in the 2nd column.  </p>\n\n<p>What I need is a Search in Column J for \"specific network\".  If this is true then replace the network in Column H. </p>\n\n<p><strong>Question:  Will I need to also run a text-to-columns in Column J to get a 1:1 comparison?\nQuestion: Can you help me with the VBA code to do the Find-If-Then-Replace?</strong>  </p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 276, "user_id": 4089665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9c822a6912f75b5867470bf5dfc380f8?s=128&d=identicon&r=PG&f=1", "display_name": "CodeEngine", "link": "https://stackoverflow.com/users/4089665/codeengine"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1420671703, "post_id": 27829962, "comment_id": 44066395, "body": "Sorry it is a combobox but by mistake I name it txt_DesignEngineer"}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420676584, "post_id": 27829962, "comment_id": 44067960, "body": "Are the items in Design_Engineer_2 items that are in whatever your rowsource for the combobox?"}, {"owner": {"reputation": 276, "user_id": 4089665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9c822a6912f75b5867470bf5dfc380f8?s=128&d=identicon&r=PG&f=1", "display_name": "CodeEngine", "link": "https://stackoverflow.com/users/4089665/codeengine"}, "reply_to_user": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420726502, "post_id": 27829962, "comment_id": 44088022, "body": "@KevenDenen Yes they are populated from a table called ElectricalDesigner.  Row Source...... ElectricalDesigners. Any Ideas or sugestions why this is happening ? Thanks"}], "owner": {"reputation": 276, "user_id": 4089665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9c822a6912f75b5867470bf5dfc380f8?s=128&d=identicon&r=PG&f=1", "display_name": "CodeEngine", "link": "https://stackoverflow.com/users/4089665/codeengine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420676470, "creation_date": 1420670413, "last_edit_date": 1420676470, "question_id": 27829962, "link": "https://stackoverflow.com/questions/27829962/access-2000-getting-name-when-running-query-programmatically", "title": "Access 2000 getting #Name? when running query programmatically", "body": "<p>I have a Form in Access 2000 bound to a table. When you open this form all the textbox and dropdowns work fine. I have a combobox where a user selects a option. Depending on what is selected, a query is run. When I do this all the Textbox that are link to their assign field in the table work fine but one. I have even tried to assigned it promatically. I get the error #Name?.  I know it means that is not finding it but why. Any help would be appreciated. Below is my code behind where I run the query programmatically and a screenshot of the error that I get.  </p>\n\n<pre><code>Public Sub Select_Table(LineNumber As Integer, kvaNumber As Integer)\n\nDim strlineNumber As String\n\nSelect Case LineNumber\n\n   Case 0\n      strlineNumber = \"52\"\n   Case 1\n      strlineNumber = \"53\"\n   Case 2\n      strlineNumber = \"54\"\n   Case 3\n      strlineNumber = \"55\"\nEnd Select\n\n Dim message As Integer\n Dim param As String\n\n\n\nSelect Case kvaNumber\n        Case 0\n            txt_DesignEngineer.ControlSource = \"Design_Engineer_2\"                \n            Me.RecordSource = \"SELECT [Sequence Number], [Design_Engineer_2], [ED Plan Start], [ED Plan Finish], [Prel Person], [Prel Plan Start], [Prel Plan Finish], [Catalog No], [Internal Designer], [Int Plan Start], [Int Plan Finish], [External Designer], [Ext Plan Start], [Ext Plan Finish], [OTL Plan Start], [OTL Plan Finish], [Control Engineer], [Cnl Plan Start], [Cnl Plan Finish] FROM [Engineering Schedule 2] WHERE [Catalog No] LIKE '\" &amp; strlineNumber &amp; \"03*' ORDER BY [Sequence Number]\"\n        Case 1\n\n     End Select\n\n\nEnd Sub \n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/rzBCe.png\" alt=\"Error Form\"></p>\n"}, {"tags": ["vba", "runtime"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420670478, "post_id": 27829931, "comment_id": 44065891, "body": "It would be great to know <i>on which line</i> the error is raised."}, {"owner": {"reputation": 43, "user_id": 4430787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f5477ce3837129d745d8a11c1348f?s=128&d=identicon&r=PG&f=1", "display_name": "Mirage24", "link": "https://stackoverflow.com/users/4430787/mirage24"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420670646, "post_id": 27829931, "comment_id": 44065976, "body": "It varies on the line depending on how many inputs I put in, but it is always within the for loop that says: &quot;For i = 0 To PnIDPage - 1&quot; and seems to fail when I call the Range object over and over again"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420671186, "post_id": 27829931, "comment_id": 44066196, "body": "Please use one of these values and copy here both the value you input and the precise line where the error raises."}, {"owner": {"reputation": 43, "user_id": 4430787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f5477ce3837129d745d8a11c1348f?s=128&d=identicon&r=PG&f=1", "display_name": "Mirage24", "link": "https://stackoverflow.com/users/4430787/mirage24"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420671789, "post_id": 27829931, "comment_id": 44066431, "body": "If I follow the prompts and enter in: 14 pages, then 41, 26, 19, 28, 26, 28, 17, 26, 21, 19, 19, 10, 23, 28 as quantities for the valves, then click yes for use default title. I get an error hereWorksheets(1).Range(ConvertToLetter(TempSize) &amp; TitleBlockSize + 2 &amp; &quot;:&quot; &amp; ConvertToLetter(TempSize + TitleSize - 1) &amp; Maximum + TitleBlockSize).Interior.ColorIndex = 43"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420672261, "post_id": 27829931, "comment_id": 44066615, "body": "Sorry but we still miss something. What is the input variable (where you insert 14)? Could you please edit your question&#39;s body and add all this information (the one of your previous comment + this one), and reduce the code size to a minimized sample on which we can see directly the problem?"}, {"owner": {"reputation": 43, "user_id": 4430787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f5477ce3837129d745d8a11c1348f?s=128&d=identicon&r=PG&f=1", "display_name": "Mirage24", "link": "https://stackoverflow.com/users/4430787/mirage24"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420672705, "post_id": 27829931, "comment_id": 44066803, "body": "I added in comments in the code to see which values to put into the inputs. If you copy and paste that into a module you should see the error."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1420673327, "post_id": 27829931, "comment_id": 44066991, "body": "Can you reduce your code to the <i>minimum necessary to reproduce the problem</i>? There&#39;s a lot of clutter here that could be removed, it would seem, and during the process of doing so you may find a cause. There&#39;s simply too much to expect us to wade through here. See <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> for tips on doing so."}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 43, "user_id": 4430787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f5477ce3837129d745d8a11c1348f?s=128&d=identicon&r=PG&f=1", "display_name": "Mirage24", "link": "https://stackoverflow.com/users/4430787/mirage24"}, "edited": false, "score": 0, "creation_date": 1420675269, "post_id": 27830581, "comment_id": 44067568, "body": "@Mirage24 to this <a href=\"http://meta.stackexchange.com/a/5235\">link</a> there&#39;s a clear explanation. Welcome to stack overflow ;)"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1420673893, "last_edit_date": 1495535599, "creation_date": 1420673458, "answer_id": 27830581, "question_id": 27829931, "link": "https://stackoverflow.com/questions/27829931/run-time-error-1004-application-defined-or-object-defined-error-with-repeated/27830581#27830581", "title": "Run-time error &#39;1004&#39;: Application-defined or object-defined error with repeated use of &quot;range&quot; object", "body": "<p>The problem does not depend on your <code>Valve</code>, but on your <code>ConvertToLetter</code> function. In fact, at some point the error occurs because the function returns an invalid range letter:</p>\n\n<pre><code>input: iCol = 53\nreturn: \"A[\"\n</code></pre>\n\n<p>Clearly, when you try to call the <code>Range(\"A[2\")</code>, this raises the exception. </p>\n\n<p>The code inside your function is not solid because converts the number into letter with:</p>\n\n<pre><code>ConvertToLetter = Chr(iAlpha + 64)\n</code></pre>\n\n<p>The <code>Chr()</code> function returns the value associated to the index from the characters collection, which is a unique chars list and cannot be used as you try to do there. \nI would just replace your <code>ConvertToLetter</code> function with a more solid one, such as the following: </p>\n\n<pre><code>Function ConvertToLetter(iCol As Integer) As String\n    Dim vArr\n    vArr = Split(Cells(1, iCol).Address(True, False), \"$\")\n    ConvertToLetter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>...which has been kindly provided by <a href=\"https://stackoverflow.com/users/641067/brettdj\">brettdj</a> in one of his precious <a href=\"https://stackoverflow.com/a/12797190/3111149\">answers</a> (don't forget to give him an upvote for this piece of gold ;). </p>\n\n<p>P.s. note that this explain also why a low number would not raise the exception: as long as the number is small, your function doesn't need to append a second letter to the output so it remains consistent. But as soon as it has to do that, CRASH ;)</p>\n\n<p>Use the above function, it's way safer because it just retrieves the Range address from the Cells object. Your code will work fine once you will replace your old function with the new one above. </p>\n"}], "owner": {"reputation": 43, "user_id": 4430787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f5477ce3837129d745d8a11c1348f?s=128&d=identicon&r=PG&f=1", "display_name": "Mirage24", "link": "https://stackoverflow.com/users/4430787/mirage24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 27830581, "answer_count": 1, "score": 0, "last_activity_date": 1420673893, "creation_date": 1420670265, "last_edit_date": 1420672550, "question_id": 27829931, "link": "https://stackoverflow.com/questions/27829931/run-time-error-1004-application-defined-or-object-defined-error-with-repeated", "title": "Run-time error &#39;1004&#39;: Application-defined or object-defined error with repeated use of &quot;range&quot; object", "body": "<p>I'm trying to make an automated templated with VBA and this code seems to run fine when I enter in a low number of \"pages\", but when I enter in something such as the following into the prompts it gives me a run-time error 1004: 14 pages: 41, 26, 19, 28, 26, 28, 17, 26, 21, 19, 19, 10, 23, 28.</p>\n\n<pre><code>Public TitleSize As Integer\nPublic MostValves() As Integer\nPublic TotalValves As Integer\nPublic TitleBlockSize As Integer\n\nFunction ConvertToLetter(iCol As Integer) As String\n   Dim iAlpha As Integer\n   Dim iRemainder As Integer\n   iAlpha = Int(iCol / 27)\n   iRemainder = iCol - (iAlpha * 26)\n   If iAlpha &gt; 0 Then\n      ConvertToLetter = Chr(iAlpha + 64)\n   End If\n   If iRemainder &gt; 0 Then\n      ConvertToLetter = ConvertToLetter &amp; Chr(iRemainder + 64)\n   End If\nEnd Function\n\nSub ManualValve()\n\n'On Error GoTo ErrHandler\n'On Error Resume Next\n\nWorksheets(1).Activate\nActiveSheet.Name = \"Valve List\"\nActiveSheet.Cells.Clear\n\nPnIDPage = InputBox(\"How many pages are on your P&amp;ID?\")\n'Values for Number of Pages: 14\n\nDim i As Integer\n\nTotalValves = 0\n\nReDim MostValves(PnIDPage)\n\nFor i = 0 To PnIDPage - 1\n\n    ValveCount = InputBox(\"How many valves are on page \" &amp; i + 1 &amp; \" ?\")\n'Values for valves: 41, 26, 19, 28, 26, 28, 17, 26, 21, 19, 19, 10, 23, 28\n    If IsNumeric(ValveCount) Then\n        MostValves(i) = ValveCount\n        TotalValves = TotalValves + ValveCount\n    Else\n        MsgBox (\"You did not enter a valid number\")\n        'GoTo ErrHandler\n    End If\nNext i\n\nDim Title As Variant\n\nResponse = MsgBox(prompt:=\"Do you want to use the default titleblock? (Count, Valve, Module, Note)\", Buttons:=vbYesNo)\n\nIf Response = vbYes Then\n    Title = Array(\"Count\", \"Valve\", \"Module\", \"Note\")\n    TitleSize = UBound(Title, 1) - LBound(Title, 1) + 1\nElse\n    Title = Array(\"Count\", \"Valve\", \"Module\")\n    TitleSize1 = UBound(Title, 1) - LBound(Title, 1) + 1\n    XtraCol = InputBox(\"How many extra columns would you like to add?\")\n    ReDim Preserve Title(XtraCol + TitleSize1 - 1)\n    TitleSize = UBound(Title, 1) - LBound(Title, 1) + 1\n        For i = TitleSize1 + 1 To TitleSize\n            XtraTitle = InputBox(\"Extra Title \" &amp; i &amp; \"?\")\n            Title(i - 1) = XtraTitle\n        Next i\nEnd If\n\nDim TitleBlock As Variant\n\nTitleBlock = Array(\"Project Number\", \"Project Name\", \"By\", \"Rev\", \"Date\")\nTitleBlockSize = UBound(TitleBlock, 1) - LBound(TitleBlock, 1) + 1\nRange(ConvertToLetter(1) &amp; \"1:\" &amp; ConvertToLetter(1) &amp; TitleBlockSize) = Application.Transpose(TitleBlock)\n\nDim Maximum As Integer\nDim ValveNum() As Integer\nDim TempSize As Integer\n\nTempSize = 1\nMaximum = WorksheetFunction.Max(MostValves) + 1\n\nFor i = 0 To PnIDPage - 1\n    Do Until MostValves(i) &lt;&gt; 0\n        i = i + 1\n    Loop\n\n    ReDim ValveNum(MostValves(i))\n\n    For j = 0 To MostValves(i)\n        ValveNum(j) = j + 1\n    Next j\n        MsgBox TempSize\n        If i Mod 2 = 0 Then\n            Worksheets(1).Range(ConvertToLetter(TempSize) &amp; TitleBlockSize + 2 &amp; \":\" &amp; ConvertToLetter(TempSize + TitleSize - 1) &amp; Maximum + TitleBlockSize).Interior.ColorIndex = 42\n        Else\n'This is where I encounter the run-time error\n            Worksheets(1).Range(ConvertToLetter(TempSize) &amp; TitleBlockSize + 2 &amp; \":\" &amp; ConvertToLetter(TempSize + TitleSize - 1) &amp; Maximum + TitleBlockSize).Interior.ColorIndex = 43\n        End If\n\n        Worksheets(1).Range(ConvertToLetter(TempSize) &amp; TitleBlockSize + 2 &amp; \":\" &amp; ConvertToLetter(TempSize) &amp; CStr(MostValves(i) + 1 + TitleBlockSize)). _\n        Resize(MostValves(i), 1) = Application.Transpose(ValveNum)\n        Worksheets(1).Range(ConvertToLetter(TempSize + 2) &amp; TitleBlockSize + 2 &amp; \":\" &amp; ConvertToLetter(TempSize + 2) &amp; CStr(MostValves(i) + 1 + TitleBlockSize)) = \"00\" &amp; CStr(i + 1)\n        Worksheets(1).Range(ConvertToLetter(TempSize) &amp; TitleBlockSize + 1 &amp; \":\" &amp; ConvertToLetter(TempSize + TitleSize - 1) &amp; TitleBlockSize + 1) = Title\n        TempSize = TempSize + TitleSize\n        Worksheets(1).Range(ConvertToLetter(TempSize - 1) &amp; TitleBlockSize + 1 &amp; \":\" &amp; ConvertToLetter(TempSize - 1) &amp; Maximum + TitleBlockSize). _\n        Borders(xlEdgeRight).Weight = xlMedium\n    Next i\n\n    Cells(1, 4) = \"Total Valve Count\"\n    Cells(1, 5) = TotalValves\n    Range(\"A1:\" &amp; ConvertToLetter(TempSize) &amp; Maximum + TitleBlockSize).HorizontalAlignment = xlCenter\n    Range(\"A1:A\" &amp; TitleBlockSize).HorizontalAlignment = xlLeft\n    Columns(\"A:\" &amp; ConvertToLetter(TempSize)).AutoFit\n    Range(\"A1:\" &amp; ConvertToLetter(TempSize) &amp; TitleBlockSize + 1).Font.Bold = True\n    Range(\"A\" &amp; TitleBlockSize + 1 &amp; \":\" &amp; ConvertToLetter(TempSize - 1) &amp; TitleBlockSize + 1).Interior.ColorIndex = 1\n    Range(\"A\" &amp; TitleBlockSize + 1 &amp; \":\" &amp; ConvertToLetter(TempSize - 1) &amp; TitleBlockSize + 1).Font.Color = vbWhite\n    Range(\"A\" &amp; Maximum + TitleBlockSize &amp; \":\" &amp; ConvertToLetter(TempSize - 1) &amp; Maximum + TitleBlockSize). _\n        Borders(xlEdgeBottom).Weight = xlMedium\n\n'ErrHandler:\n    'MsgBox \"An error has occurred. The macro will end.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420669362, "post_id": 27829636, "comment_id": 44065391, "body": "So what&#39;s going wrong? Are you getting an error? Wrong results? There&#39;s a lot of code here to be renaming some sheets..."}, {"owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420670151, "post_id": 27829636, "comment_id": 44065743, "body": "The user puts in some numbers on the TMP Data sheet, this is then supposed to copy a sheet called CLO x amount of times and give each sheet a unique number from the information on the TMP data sheet."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420670801, "post_id": 27829636, "comment_id": 44066038, "body": "Okay. <i>and what actually happens?</i>"}, {"owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420670880, "post_id": 27829636, "comment_id": 44066074, "body": "It just creates one copy of the sheet and calls it &quot;CLO (2)&quot;"}, {"owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420671031, "post_id": 27829636, "comment_id": 44066134, "body": "The code below works, but instead of just adding blank sheets I need it to copy the Sheet called CLO and use the naming convention.   `            For w = 1 To Target.Value                 Sheets.Add(after:=Sheets(Sheets.Count)).Name = _                   Target.Offset(0, -1) &amp; Chr(46) &amp; w`"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1420671910, "post_id": 27829636, "comment_id": 44066482, "body": "Should <code>Target.Offset(0, -1) &amp; Chr(46) &amp; w</code> be <code>Target.Offset(0, -1).Value &amp; Chr(46) &amp; w</code>? It looks like you&#39;re not using the value of the range to name the sheet..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420680671, "post_id": 27829636, "comment_id": 44069050, "body": "Calling <code>Copy()</code> on a worksheet doesn&#39;t return a reference to the resulting copy.  You have to rename it in a separate operation.  If you comment out the error handler you will see the problem."}], "answers": [{"tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1420683068, "creation_date": 1420683068, "answer_id": 27831897, "question_id": 27829636, "link": "https://stackoverflow.com/questions/27829636/copying-and-renaming-sheets/27831897#27831897", "title": "Copying and renaming sheets", "body": "<p>By default the sheet will be copied as CLO (2),  rename it after it has been copied:</p>\n\n<pre><code>Sheets(\"CLO\").Copy After:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = Target.Offset(0, -1).Value &amp; Chr(46) &amp; w\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420683068, "creation_date": 1420669070, "question_id": 27829636, "link": "https://stackoverflow.com/questions/27829636/copying-and-renaming-sheets", "title": "Copying and renaming sheets", "body": "<p>Could someone please help me work out how to copy and rename sheets based on values on another sheet,\ncurrently the sheet is being called \"CLO (2)\" not \"CLO 1.2\". I want the code to copy the sheet named \"CLO\" and rename it based on values found on the sheet called \"TMP Data\", using the cell values from B7 and C7 and below (B and C values create the sheet name).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Count &gt; 1 Then Exit Sub\n\n    If Target.Address = \"$B$6\" Then\n\n        Application.EnableEvents = False\n\n        With Target.Offset(1, 0)\n\n            Range(.Cells(1), .Cells(1).End(xlDown)).ClearContents\n\n            .Value = 1\n\n            .Resize(Target.Value, 1).DataSeries _\n\n              Rowcol:=xlColumns, Type:=xlLinear, Step:=1\n\n        End With\n\n        Target.Offset(0, 1).Activate\n\n    ElseIf Not Intersect(Target, Columns(\"C\")) Is Nothing Then\n\n        If Target.Row &gt; 6 And Application.Count(Target.Offset(0, -1).Resize(1, 2)) = 2 Then\n\n            On Error GoTo F\u00ecn\n\n            Application.EnableEvents = False\n\n            Dim w As Long\n\n            For w = 1 To Target.Value\n\n                Sheets(\"CLO\").Copy(after:=Sheets(Sheets.Count)).Name = _\n\n                  Target.Offset(0, -1) &amp; Chr(46) &amp; w\n\n            Next w\n\n            Me.Activate\n\n        End If\n\n    End If\nF\u00ecn:\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://drive.google.com/file/d/0B2mcZKXhV5wob2oxTlNRQ0tPOUpOajRjT2Y4ZjNNby1CUU1Z/view?usp=sharing\" rel=\"nofollow\">Here is the Excel file</a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "activex"], "answers": [{"comments": [{"owner": {"reputation": 726, "user_id": 2228155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7626859a98cda5fd877037d62d34a402?s=128&d=identicon&r=PG", "display_name": "barker", "link": "https://stackoverflow.com/users/2228155/barker"}, "edited": false, "score": 0, "creation_date": 1420671464, "post_id": 27829991, "comment_id": 44066288, "body": "Just figured it out right before you typed this hah! yep, I added it to the form load event and set the slider.max and min&#39;s. Thanks for the tip! In the future, how can i find out that the slider object has a max and min value in vba like that? I was searching everywhere and couldnt figure it out. Also, if you being typing slider0.ma- it usually pops up code complete, but not in this case."}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "reply_to_user": {"reputation": 726, "user_id": 2228155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7626859a98cda5fd877037d62d34a402?s=128&d=identicon&r=PG", "display_name": "barker", "link": "https://stackoverflow.com/users/2228155/barker"}, "edited": false, "score": 0, "creation_date": 1420672170, "post_id": 27829991, "comment_id": 44066588, "body": "I just added it to a form and looked through the controls. The MSDN documentation for it lacked any specific information, so playing in the debug window helped me."}], "tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": true, "score": 1, "last_activity_date": 1420670522, "creation_date": 1420670522, "answer_id": 27829991, "question_id": 27829512, "link": "https://stackoverflow.com/questions/27829512/microsoft-access-slider-6-0-create-the-max-and-min-based-on-a-query/27829991#27829991", "title": "Microsoft access slider 6.0 create the max and min based on a query", "body": "<pre><code>Dim x as double\nDim rs as ADODB.Recordset\nDim s as string\n\ns = \"SELECT COUNT(mydata) FROM mytable\"\nrs = ThisDB.Execute(s)\nx = Cint(rs)\nSet Me!Slider0.Max = x\nSet Me!Silder0.Min = x - x\n</code></pre>\n\n<p>Or something like that. Change for your min values.</p>\n"}], "owner": {"reputation": 726, "user_id": 2228155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7626859a98cda5fd877037d62d34a402?s=128&d=identicon&r=PG", "display_name": "barker", "link": "https://stackoverflow.com/users/2228155/barker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 27829991, "answer_count": 1, "score": 0, "last_activity_date": 1420670522, "creation_date": 1420668544, "question_id": 27829512, "link": "https://stackoverflow.com/questions/27829512/microsoft-access-slider-6-0-create-the-max-and-min-based-on-a-query", "title": "Microsoft access slider 6.0 create the max and min based on a query", "body": "<p>Is it possible to set the max and min of a slider using a query in an access database? something like :  </p>\n\n<pre><code>Dim x as double  \n\nx = select count(mydata) from mytable;  \n\nset me.Slider0.max = x\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1420667725, "post_id": 27829008, "comment_id": 44064642, "body": "Have you considered using a pivot table?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4430487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7165200768afc734fc9cb2d06b54cf47?s=128&d=identicon&r=PG&f=1", "display_name": "MarcOne1", "link": "https://stackoverflow.com/users/4430487/marcone1"}, "edited": false, "score": 0, "creation_date": 1420739378, "post_id": 27829607, "comment_id": 44096644, "body": "Thanks!! This worked perfectly!"}], "tags": [], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "is_accepted": true, "score": 0, "last_activity_date": 1420668962, "creation_date": 1420668962, "answer_id": 27829607, "question_id": 27829008, "link": "https://stackoverflow.com/questions/27829008/how-to-select-rows-in-column-a-based-on-values-and-take-actio-on-corresponding/27829607#27829607", "title": "How to select rows in column &quot;A&quot; based on values and take actio on corresponding cells in column &quot;F&quot;?", "body": "<pre><code>Sub AverageFinG()\n    Dim topA As Range, bottomA As Range, sliceF As Range, sliceG As Range\n    Set topA = Cells(1, 1)\n   Do Until IsEmpty(topA.Value)\n        Set bottomA = topA\n        Do While bottomA.Offset(RowOffset:=1).Value = bottomA.Value\n            Set bottomA = bottomA.Offset(RowOffset:=1)\n        Loop\n\n        Set sliceF = Range(topA, bottomA).Offset(ColumnOffset:=5)\n        Set sliceG = sliceF.Offset(ColumnOffset:=1)\n        sliceG.Merge\n        sliceG.Formula = \"=AVERAGE(\" + sliceF.Address + \")\"\n\n        Set topA = bottomA.Offset(RowOffset:=1)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4430487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7165200768afc734fc9cb2d06b54cf47?s=128&d=identicon&r=PG&f=1", "display_name": "MarcOne1", "link": "https://stackoverflow.com/users/4430487/marcone1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "closed_date": 1420703883, "accepted_answer_id": 27829607, "answer_count": 1, "score": -3, "last_activity_date": 1420668962, "creation_date": 1420666309, "last_edit_date": 1531161705, "question_id": 27829008, "link": "https://stackoverflow.com/questions/27829008/how-to-select-rows-in-column-a-based-on-values-and-take-actio-on-corresponding", "closed_reason": "Not suitable for this site", "title": "How to select rows in column &quot;A&quot; based on values and take actio on corresponding cells in column &quot;F&quot;?", "body": "<p>I am at a lost on how to accomplish this task, so any help will be appreciated. I have a spreadsheet with about 9000 rows (snippet shown below) and I am attempting to do the following:</p>\n\n<p>1) Select cells in column G if the values in column A are the same and merge the selected cells. \n2) Select cells in column F if the values in column A are the same, find average of the selected cells and input results in merged cell from task 1 above.</p>\n\n<p>I have attempted to accomplish this via the macros in Excel, however, I lack the programming/scripting skills to get the desired results.</p>\n\n<pre><code>1.   A    B     C     D     E     F     G\n2. 21004    High   date1   date2   date3   51\n3. 21004    High   date1   date2   date3   51\n4. 21004    High   date1   date2   date3   51\n5. 21004    High   date1   date2   date3   60\n6. 21003    High   date1   date2   date3   21\n7. 21003    High   date1   date2   date3   44\n8. 21011    High   date1   date2   date3   55\n9. 21011    High   date1   date2   date3   58\n10. 21405    High   date1   date2   date3   91\n11. 21405    High   date1   date2   date3   36\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1420665490, "post_id": 27828774, "comment_id": 44063574, "body": "you want to use the Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range) event not the activate event.  Then just check the target to see if it is the F column then check the value and hide the row if needed"}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 1, "last_activity_date": 1420665789, "creation_date": 1420665789, "answer_id": 27828873, "question_id": 27828774, "link": "https://stackoverflow.com/questions/27828774/hide-rows-when-a-cell-is-populated/27828873#27828873", "title": "Hide Rows when a cell is populated", "body": "<p>as per my comment</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    'check to make sure we only have 1 cell\n    If Target.Count = 1 Then\n        'check the column\n        If Target.Column = 6 Then 'F column\n            'check text length and if greater then 0 hide the row\n            If Len(Target.Text) &gt; 0 Then\n                Target.EntireRow.Hidden = True\n            Else\n                Target.EntireRow.Hidden = False\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4430520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f73395db47d4c3f072293fb11e65970a?s=128&d=identicon&r=PG&f=1", "display_name": "user118282", "link": "https://stackoverflow.com/users/4430520/user118282"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 27828873, "answer_count": 1, "score": 0, "last_activity_date": 1421689303, "creation_date": 1420665266, "last_edit_date": 1421689303, "question_id": 27828774, "link": "https://stackoverflow.com/questions/27828774/hide-rows-when-a-cell-is-populated", "title": "Hide Rows when a cell is populated", "body": "<p>So I have a list of data(tasks) in cells A2 to E2, and in column F is the option for my team to assign their name to it. What I'm trying to make happen, is as a name is inputted in F2, F3, F4.... the respective row disappears. </p>\n\n<p>Example. </p>\n\n<p>F1=\"Bob\" , then row 1 dissapears. </p>\n\n<p>This is what I have so far, but I have a feeling I might be going in the wrong direction with it. </p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Activate()\n    Dim r As Range, c As Range\n    Set r = Range(\"a1:a299\")\n    Application.ScreenUpdating = False\n    For Each c In r\n        If Len(c.text) = 0 Then\n            c.EntireRow.Hidden = True\n        Else\n            c.EntireRow.Hidden = False\n        End If\n    Next c\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I'm also not sure if this will update it straight away, or I'll have to run the macro everytime. If I've got it right, it should do the first.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1420665626, "creation_date": 1420665626, "answer_id": 27828851, "question_id": 27828744, "link": "https://stackoverflow.com/questions/27828744/global-variable-not-holding-value/27828851#27828851", "title": "Global variable not holding value", "body": "<p>You would need to use:</p>\n\n<pre><code>Public whereAtt As String\n</code></pre>\n\n<p>To ensure a value is passed, you could also do this:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPublic whereAtt As String\n\n\nPrivate Sub cmbAnalyst_AfterUpdate()\n    If cmbAnalyst.ListIndex &lt;&gt; -1 Then\n        whereAtt = whereAtt &amp; \" And Analyst = 'me.cmbAnalyst'\"\n        queryBuilder(whereAtt)\n    End If\nEnd Sub\n\nPrivate Sub Form_Load()\n    whereAtt = \"Select * from tblActionLog where LogID is not null\"\n    cmbAnalyst.RowSource = \"SELECT DISTINCT Analyst FROM tblActionLog\"\n    queryBuilder(whereAtt)\nEnd Sub\n\nPublic Sub queryBuilder(whereAtt as String)\n    testTable.RowSource = whereAtt\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1420667700, "creation_date": 1420667700, "answer_id": 27829324, "question_id": 27828744, "link": "https://stackoverflow.com/questions/27828744/global-variable-not-holding-value/27829324#27829324", "title": "Global variable not holding value", "body": "<p>Your code alters the <code>WHERE</code> clause in a <code>SELECT</code> statement like this ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>whereAtt = whereAtt &amp; \" And Analyst = 'me.cmbAnalyst'\"\n</code></pre>\n\n<p>That condition will restrict rows returned by the query to only those which have the literal text string <em>'me.cmbAnalyst'</em> stored in <code>tblActionLog.Analyst</code>.  </p>\n\n<p>I suspect you want those rows where <code>tblActionLog.Analyst</code> matches the value selected in that <code>cmbAnalyst</code> combo box.  </p>\n\n<p>If that is correct, construct the string to include the combo box's value instead of its name:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>whereAtt = whereAtt &amp; \" And Analyst = '\" &amp; Me.cmbAnalyst.Value &amp; \"'\"\n</code></pre>\n\n<p>Regarding <em>\"whereAtt is not holding a value when I step into the after update method\"</em>, I don't understand what is going on there.  It looks like you would add another <em>\"And Analyst = ... \"</em> segment to the query each time After Update fires.  But I don't understand why the value of <em>whereAtt</em> would disappear completely.</p>\n\n<p>I suggest you add <code>Debug.Print</code> statements before and after the line where you alter <em>whereAtt</em>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print \"Before: \" &amp; whereAtt\nDebug.Print \"cmbAnalyst.Value: \" &amp; Me.cmbAnalyst.Value\nwhereAtt = whereAtt &amp; \" And Analyst = '\" &amp; Me.cmbAnalyst.Value &amp; \"'\"\nDebug.Print \"After: \" &amp; whereAtt\n</code></pre>\n\n<p>Hopefully the situation will be clear when you view the <code>Debug.Print</code> output in the Immediate window.  If not, show us what <code>Debug.Print</code> shows you.</p>\n"}], "owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420667875, "creation_date": 1420665144, "last_edit_date": 1420667875, "question_id": 27828744, "link": "https://stackoverflow.com/questions/27828744/global-variable-not-holding-value", "title": "Global variable not holding value", "body": "<p>The Global whereAtt is not holding a value when I step into the after update method. Is there a problem with how I'm calling globals or the set up of my code?</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nDim whereAtt As String\n\n\nPrivate Sub cmbAnalyst_AfterUpdate()\n\nIf cmbAnalyst.ListIndex &lt;&gt; -1 Then\n    whereAtt = whereAtt &amp; \" And Analyst = 'me.cmbAnalyst'\"\n    Call queryBuilder\nEnd If\nEnd Sub\n\nPrivate Sub Form_Load()\nwhereAtt = \"Select * from tblActionLog where LogID is not null\"\ncmbAnalyst.RowSource = \"SELECT DISTINCT Analyst FROM tblActionLog\"\nCall queryBuilder\nEnd Sub\n\nPublic Sub queryBuilder()\ntestTable.RowSource = whereAtt\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 2568841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbea683b77a6c7dcb78587201def050?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2568841/dan"}, "is_accepted": true, "score": 1, "last_activity_date": 1429153038, "creation_date": 1429153038, "answer_id": 29664568, "question_id": 27828619, "link": "https://stackoverflow.com/questions/27828619/how-to-reference-text-to-respective-email-address-using-vba/29664568#29664568", "title": "How to reference Text to respective email address using VBA", "body": "<p>I think I am able to follow what the issue is here.  It doesn't look like your code is using any vlookup formula or matching formula to find the email.  Unless they are on the same row between the different sheets, you will need to find the value.</p>\n\n<p>VBA has the ability to use the functions that you would normally use in Excel.</p>\n\n<p>If you tweek the code below with the correct range and column number, you should be able to find the correct email address based on an ID.</p>\n\n<pre><code>' instead of 1 below, use the column for the id to look up\nlookupValue = Worksheets(\"Register\").Cells(Row, 1).Value\n\n' range of the ids and emails in the permissions table - edit whatever the range should be\nRng = Worksheets(\"Permissions\").Range(\"A1:B100\")\n\n' column to look up - number of columns between the id and email in the permissions tab\ncol = 2\n\n' whether you want excel to try to find like match for the lookup value\n' pretty much never have this be true if you want to have confidence in the result\nlikeMatch = False\n\nemailAddress = WorksheetFunction.VLookup(lookupValue, Rng, col, likeMatch)\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4075015, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e41c8dece72211fffda6a3c2d460c80b?s=128&d=identicon&r=PG&f=1", "display_name": "adit123", "link": "https://stackoverflow.com/users/4075015/adit123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 29664568, "answer_count": 1, "score": 0, "last_activity_date": 1429153038, "creation_date": 1420664689, "last_edit_date": 1531164843, "question_id": 27828619, "link": "https://stackoverflow.com/questions/27828619/how-to-reference-text-to-respective-email-address-using-vba", "title": "How to reference Text to respective email address using VBA", "body": "<p>so I have set up an emailing system in which emails are sent out to people that own a specific item that have a due date coming up. There are at least 1,000 items on my excel sheet and each item has a specific owner. However the owners are labeled using an ID. The ID refers to an email address in another sheet called \"Permissions\" . My email function works, however I am having trouble with my recepients. I am not able to match the ID on the sheet that has the items to the email address in the other sheet. I am fairly new to VBA so please excuse my code. I am still learning. Thank you!</p>\n\n<p>The worksheet name \"Register\" is the worksheet with all of the items and due dates.</p>\n\n<p>Code :</p>\n\n<pre><code>Option Explicit\n\nSub TestEmailer()\n\nDim Row        As Long\nDim lstRow      As Long\n\nDim Message As Variant\nDim Frequency As String 'Cal Frequency\nDim DueDate As Date 'Due Date for Calibration\nDim vbCrLf As String 'For HTML formatting\nDim registerkeynumber As String 'Register Key Number\nDim class As Variant 'Class\nDim owner As String ' Owner\nDim status As String 'Status\nDim ws As Worksheet\nDim toList As Variant\nDim Ebody As String\nDim esubject As String\nDim Filter As String\nDim LQAC As String\n\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .DisplayAlerts = True\n\nEnd With\n\nSet ws = Sheets(1)\nws.Select\n\nlstRow = WorksheetFunction.Max(2, ws.Cells(Rows.Count, Range(\"CalDueDate\").Column).End(xlUp).Row)\n\n\nFor Row = 2 To lstRow\n\n\nDueDate = CDate(Worksheets(\"Register\").Cells(Row, Range(\"DueDate\").Column).Value) 'DUE DATE\n\n\n\n\nregisterkeynumber = Worksheets(\"Register\").Cells(Row, Range(\"RegisterKey\").Column).Value\n\nclass = Worksheets(\"Register\").Cells(Row, Range(\"Class\").Column).Value\n\n\nstatus = Worksheets(\"Register\").Cells(Row, Range(\"Status\").Column).Value\n\nLQAC = Worksheets(\"Register\").Cells(Row, Range(\"LQAC\").Column).Value\n\nFilter = Worksheets(\"Permissions\").Cells(Row, Worksheets(\"Permissions\").Range(\"MailFilter\").Column).Value\n\n\nIf DueDate - Date &lt;= 7 And class &gt; 1 And status = \"In Service\" And DueDate &lt;&gt; \"12:00:00 AM\" Then\n\nvbCrLf = \"&lt;br&gt;&lt;br&gt;\"\n\n'THIS IS WHERE I AM NOT SURE IF I AM REFERENCING CORRECTLY.  I AM NOT SURE HOW TO REFERENCE THE ID FROM THE 'REGISTER' AND MATCH IT WITH THE EMAIL ADDRESS IN THE 'PERMISSIONS' WORKSHEET. AS OF NOW I AM ONLY REFERENCING THE EMAIL ADDRESS BUT THEY ARE NOT MATCHING UP.\n\ntoList = Worksheets(\"Permissions\").Cells(Row, Worksheets(\"Permissions\").Range(\"Email\").Column).Value                                                   'RECEPIENT OF EMIAL\n\n\nesubject = \"TEXT \" &amp; Cells(Row, Range(\"Equipment\").Column).Value &amp; \" is due in the month of \" &amp; Format(DueDate, \"mmmm-yyyy\")\n\n\n        Ebody = \"&lt;HTML&gt;&lt;BODY&gt;\"\n        Ebody = Ebody &amp; \"Dear \" &amp; Cells(Row, Range(\"LQAC\").Column).Value &amp; vbCrLf\n        Ebody = Ebody &amp; \"&lt;/BODY&gt;&lt;/HTML&gt;\"\n\n\n\n\n\nSendEmail Bdy:=Ebody, Subjct:=esubject, Two:=toList\n\n\n\n\n\nEnd If\n\nNext Row\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .DisplayAlerts = True\n\nEnd With\n\n\nEnd Sub\n\nFunction SendEmail(Bdy As Variant, Subjct As Variant, Optional Two As Variant = \"Email@xxx\", Optional ReplyTo As Variant = \"Email@xxx\", Optional Carbon As Variant = \"Email@xxx\", Optional Attch As Variant = \"FilePath\", Optional Review As Boolean = False)\n    Dim OutlookEM As Outlook.Application\n    Dim EMItem As MailItem\n\n\n\n         If Not EmailActive Then Exit Function\n\n\n        If Two = \"Email@xxx\" Then\n            MsgBox \"There is no Address to send this Email\"\n            Two = \"\"\n            Review = True\n            'Exit Function\n        End If\n        'Create Outlook object\n         Set OutlookEM = CreateObject(\"Outlook.Application\")\n\n         'Create Mail Item\n         Set EMItem = OutlookEM.CreateItem(0)\n\n        With EMItem\n            .To = Two\n            .Subject = Subjct\n            .HTMLBody = Bdy\n\n        End With\n        If ReplyTo &lt;&gt; \"Email@xxx\" Then EMItem.ReplyRecipients.Add ReplyTo\n        If Attch &lt;&gt; \"FilePath\" Then EMItem.Attachments.Add Attch\n        If Carbon &lt;&gt; \"Email@xxx\" Then EMItem.CC = Carbon\n        If Review = True Then\n            EMItem.Display (True)\n        Else\n            EMItem.Display\n           ' EMItem.Send\n        End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420664737, "post_id": 27828504, "comment_id": 44063203, "body": "Unsure, it looks like a solid question @user3682157..."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1420664781, "post_id": 27828623, "comment_id": 44063224, "body": "Use <code>Long</code> rather than Integer"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1420664812, "post_id": 27828623, "comment_id": 44063247, "body": "Happy now @chrisneilsen?"}, {"owner": {"reputation": 1353, "user_id": 3682157, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f0fba83e4788bb33bb49f87611266fe2?s=128&d=identicon&r=PG&f=1", "display_name": "user3682157", "link": "https://stackoverflow.com/users/3682157/user3682157"}, "edited": false, "score": 0, "creation_date": 1420664939, "post_id": 27828623, "comment_id": 44063305, "body": "ahh was just missing that &amp; sign -- so one question I have is that the value in FF4 is &quot;1&quot; and using this macro, it just autifills the entire columns with one.  Perhaps I should have been more clear, I need it to read 1,2,3,4,etc..."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1353, "user_id": 3682157, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f0fba83e4788bb33bb49f87611266fe2?s=128&d=identicon&r=PG&f=1", "display_name": "user3682157", "link": "https://stackoverflow.com/users/3682157/user3682157"}, "edited": false, "score": 0, "creation_date": 1420665340, "post_id": 27828623, "comment_id": 44063515, "body": "@user3682157 Updated my answer."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1420665330, "last_edit_date": 1420665330, "creation_date": 1420664701, "answer_id": 27828623, "question_id": 27828504, "link": "https://stackoverflow.com/questions/27828504/vba-to-auto-fill-specific-number-of-rows/27828623#27828623", "title": "VBA to Auto Fill Specific Number of Rows", "body": "<p>Assuming you have a value in <code>FF4</code> to autofill down:</p>\n\n<pre><code>Range(\"FF4\").Value = 1\nRange(\"FF4\").AutoFill Destination:=Range(\"FF4:FF\" &amp; MyValue), Type:=xlFillSeries\n</code></pre>\n\n<p>You'll want to add <code>Dim MyValue As Long</code> to avoid errors because it will make sure the value of D2 is a number when you move it into the <code>MyValue</code>.</p>\n"}], "owner": {"reputation": 1353, "user_id": 3682157, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f0fba83e4788bb33bb49f87611266fe2?s=128&d=identicon&r=PG&f=1", "display_name": "user3682157", "link": "https://stackoverflow.com/users/3682157/user3682157"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8357, "favorite_count": 0, "accepted_answer_id": 27828623, "answer_count": 1, "score": 1, "last_activity_date": 1420665330, "creation_date": 1420664204, "question_id": 27828504, "link": "https://stackoverflow.com/questions/27828504/vba-to-auto-fill-specific-number-of-rows", "title": "VBA to Auto Fill Specific Number of Rows", "body": "<p>I am trying to autofill a specific number of rows in a column based on a number found in another cell (which changes based on data)</p>\n\n<p>So say cell <strong>D2 = 250</strong></p>\n\n<p>I need to label FF4:FF<strong>250</strong> with numbers 1,2,3,4,5... so that it looks like this</p>\n\n<pre><code>       Column FF\nCell 4    1\nCell 5    2\nCell 6    3\nCell 7    4\n ...     ...\n</code></pre>\n\n<p>I'm playing around with something like this but it doesn't work</p>\n\n<pre><code>Sub AutoFillSpecific()\n\n    MyValue = Range(\"D2\").Value\n    Range(\"FF4\").Select\n    Selection.AutoFill Destination:=Range(FF4:FFMyValue)  \n</code></pre>\n\n<p>Any help?</p>\n"}, {"tags": ["excel", "format", "xlm", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1420665314, "post_id": 27828470, "comment_id": 44063500, "body": "<a href=\"http://stackoverflow.com/questions/21342408/how-to-detect-changes-in-cell-format\" title=\"how to detect changes in cell format\">stackoverflow.com/questions/21342408/&hellip;</a>"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1420667904, "post_id": 27828470, "comment_id": 44064719, "body": "Your question requires a combination of several &quot;tricks&quot;. I am testing code that implements them..."}, {"owner": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1420738894, "post_id": 27828470, "comment_id": 44096365, "body": "@Sorceri the question states &quot;without VBA&quot;."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 4, "creation_date": 1420740134, "post_id": 27828470, "comment_id": 44097022, "body": "Title says &quot;Without VBA&quot;, tag says &quot;VBA.&quot;"}, {"owner": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "edited": false, "score": 0, "creation_date": 1420740382, "post_id": 27828470, "comment_id": 44097168, "body": "This may require VBA, too.  Why no VBA?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "edited": false, "score": 1, "creation_date": 1420743277, "post_id": 27828470, "comment_id": 44098672, "body": "@CharlesWood it didnt say without VBA when I posted that link. IF thats all you had, DONT POST"}, {"owner": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "edited": false, "score": 0, "creation_date": 1420743471, "post_id": 27828470, "comment_id": 44098753, "body": "Sorry all, I didn&#39;t check the edits."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420748863, "post_id": 27828470, "comment_id": 44101705, "body": "@pnuts - Now I read the whole thread. I was surprised I missed that part of the title. I do not see why you assumed that the OP meant &quot;no VBA&quot;. I find no hint about it. One should be very careful about adding such strong statements/requirements."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1420749378, "post_id": 27828470, "comment_id": 44101961, "body": "@pnuts, this is another fine mess you&#39;ve got yourself into :-). I would have just asked the OP, if anything."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1420749724, "post_id": 27828470, "comment_id": 44102128, "body": "And to answer the question, why not just apply the same conditional formatting to both cells?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420756572, "post_id": 27828470, "comment_id": 44105625, "body": "@pnuts - The question is &quot;Any suggestions?&quot;. I posted one. If not explicitly stated &quot;I want to follow the path that I started&quot; or the like, I guess one should presume the OP is looking for something useful for the stated objective."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421378161, "post_id": 27828470, "comment_id": 44345836, "body": "@yue86231 - Did you find anything &quot;acceptable&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "is_accepted": false, "score": 0, "last_activity_date": 1420667047, "creation_date": 1420667047, "answer_id": 27829182, "question_id": 27828470, "link": "https://stackoverflow.com/questions/27828470/set-the-color-of-one-cell-based-on-the-color-of-another-cell/27829182#27829182", "title": "Set the color of one cell based on the color of another cell", "body": "<p>The GET.CELL function, whilst useful, comes from the old XLM macro language which was used before VBA.  You may encounter restrictions using this e.g. at that time Excel used a limited number of colours (I have read somewhere around 60?).</p>\n\n<p>Alternatively, with a bit of VBA, you could experiment with the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff196598%28v=office.15%29.aspx\" rel=\"nofollow\">Interior Object</a> and also the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff840959%28v=office.15%29.aspx\" rel=\"nofollow\">Font Object</a> :</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A1\").Interior.Color = vbBlue\nSheets(\"Sheet1\").Range(\"A1\").Font.Color = vbYellow\n    If Sheets(\"Sheet1\").Range(\"A1\").Interior.Color = vbBlue Then _\n    Sheets(\"Sheet2\").Range(\"A1\").Interior.Color = vbBlue\n    If Sheets(\"Sheet1\").Range(\"A1\").Font.Color = vbYellow Then _\n    Sheets(\"Sheet2\").Range(\"A1\").Font.Color = vbYellow\n</code></pre>\n\n<p>You will likely need to explore the various ways of specifying the colors to use to give you maximum control/flexibility.</p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420753383, "post_id": 27832055, "comment_id": 44104093, "body": "Help!  Can you please explain how the CF you added to sheet 1 A1 is linked to the colour of the sheet 2 A1 cell.  I don&#39;t get it.    Also what is the text &quot;CellColour&quot; in the formula referring to?  SI it a named range?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420755521, "post_id": 27832055, "comment_id": 44105135, "body": "I read the web page linked.  My question still stands.  If the conditional formating on the destination cell that needs the formatiing has the reference to the named range, as the named range is defined using &quot;RC&quot; then it will inspect the colour of the cell with the conditional formatting.  I tried this and it&#39;s true.  Using the technique described at the end of my answer works though."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420767756, "post_id": 27832055, "comment_id": 44109185, "body": "Ah.  So you would need a named range for every cell.... I see. A bit messy. But it would work."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1421380418, "post_id": 27832055, "comment_id": 44346386, "body": "Actually not a named range for each cell, a relative range would do it."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1421116361, "last_edit_date": 1421116361, "creation_date": 1420684273, "answer_id": 27832055, "question_id": 27828470, "link": "https://stackoverflow.com/questions/27828470/set-the-color-of-one-cell-based-on-the-color-of-another-cell/27832055#27832055", "title": "Set the color of one cell based on the color of another cell", "body": "<p>Not recommended because of reliance on the XLM (not XML) Macro function <a href=\"http://support2.microsoft.com/default.aspx?scid=KB;EN-US;Q128185&amp;ID=KB;EN-US;Q128185&amp;FR=1\" rel=\"nofollow\">GET.CELL</a>. This from a technology introduced 30 years ago that was effectively superseded eight years later. With almost all its elements now defunct, the few that remain can be expected to have a low life expectancy. <a href=\"https://support.office.com/en-us/article/Working-with-Excel-40-macros-ba8924d4-e157-4bb2-8d76-2c07ff02e0b8?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow\">Microsoft</a> encourages migration to VBA.  </p>\n\n<p>Nevertheless, you have asked \u2018how\u2019 rather than \u2018why not\u2019, so I suggest you proceed from where you have reached and select Sheet1 A1 and HOME > Styles - Conditional Formatting - New Rule..., <em>Use a formula to determine which cells to format</em>, <em>Format values where this formula is true:</em>  </p>\n\n<pre><code>=CellColor=23  \n</code></pre>\n\n<p>and select blue formatting of your choice, OK, OK, Apply.</p>\n\n<p><code>23</code> is a fairly standard number for Blue (not Light, not Dark) but your configuration may expect a different number.</p>\n\n<p>Note that another disadvantage is that, unlike CF in general, the response is not automatic \u2013 you may need to enter something in Sheet1 A1, or Shift+F9 to force an update.</p>\n\n<hr>\n\n<p>If your data is spread across two sheets (Sheet1 and Sheet2, both ColumnA) and there is a 1:1 relationship (the p-value in A1 of Sheet2 is that for the correlation coefficient in A1 of Sheet1) then a simple Conditional Formatting rule may suffice:  </p>\n\n<p>Select Sheet1 ColumnA and HOME > Styles - Conditional Formatting, New Rule...</p>\n\n<p><em>Use a formula to determine which cells to format</em><br>\n<strong>Format values where this formula is true:</strong>  </p>\n\n<pre><code>=Sheet2!A1&gt;0.05\n</code></pre>\n\n<p><kbd>Format...</kbd>, select dark blue or to suit, OK, OK.   </p>\n\n<p>The same rule might be applied in Sheet2 (ColumnA) in the same way so the cells (by row) conditionally formatted in one sheet are those conditionally formatted in the other.</p>\n"}, {"comments": [{"owner": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "edited": false, "score": 0, "creation_date": 1420738859, "post_id": 27842082, "comment_id": 44096347, "body": "From the title: &quot;<b>without VBA</b>&quot;"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 764, "user_id": 1110820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J93qq.jpg?s=128&g=1", "display_name": "Charles Wood", "link": "https://stackoverflow.com/users/1110820/charles-wood"}, "edited": false, "score": 0, "creation_date": 1420749037, "post_id": 27842082, "comment_id": 44101794, "body": "@CharlesWood - If you downvoted based on &quot;without VBA&quot;, please revise based on the thread of comments above."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420753443, "post_id": 27842082, "comment_id": 44104122, "body": "In your code, Sub Worksheet_SelectionChange has the Target parameter declared as a Range therefore you don&#39;t need to test that it has type range using typename."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420757127, "post_id": 27842082, "comment_id": 44105850, "body": "@HarveyFrench - I was preventing the case <code>Target = Nothing</code>. I do not know if that is ever possible, though."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420767638, "post_id": 27842082, "comment_id": 44109157, "body": "If target were to equal nothing in a selection change event it would be like having Christmas without jesus. The event gets called because and when a new cell is selected.  I would be very concerned if this ever happened."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1420793235, "post_id": 27842082, "comment_id": 44116597, "body": "@HarveyFrench - Agreed. But I have seen quite a few unexpected cases in Excel. So, instead of elaborating any further, I&#39;d just leave it. In any case, it doesn&#39;t hurt."}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 2, "last_activity_date": 1420760549, "last_edit_date": 1495540316, "creation_date": 1420726176, "answer_id": 27842082, "question_id": 27828470, "link": "https://stackoverflow.com/questions/27828470/set-the-color-of-one-cell-based-on-the-color-of-another-cell/27842082#27842082", "title": "Set the color of one cell based on the color of another cell", "body": "<p>What you need is a way to <strong>detect changes in cell format</strong>.\nThere appears to be no event that triggers upon change in format. See\n<a href=\"https://stackoverflow.com/questions/21342408/how-to-detect-changes-in-cell-format\">How to detect changes in cell format?</a></p>\n\n<p>I will describe <strong>a workaround</strong>, almost step-by-step. It is not keystroke-by-keystroke, so you may have to google a bit, depending on you background knowledge.\n<strong>The description is not short, so please read it through.</strong></p>\n\n<p>You have to:</p>\n\n<ol>\n<li>Detect change in Selection (there is an event for this).</li>\n<li>Inquire about the color of your source cell.</li>\n<li>Act if needed.</li>\n</ol>\n\n<p>Go to the Visual Basic Editor (VBE) and add code in three modules:</p>\n\n<ol>\n<li>A standard module (say, Module1). You have to first insert the module.</li>\n<li>ThisWorkbook.</li>\n<li>Sheet2.</li>\n</ol>\n\n<p>In Module1:</p>\n\n<pre><code>Public prev_sel As Range\nPublic wssrc As Worksheet, wstrg As Worksheet\nPublic ssrc As String, strg As String\nPublic rngsrc As Range, rngtrg As Range\n\nSub copy_color(rngs As Range, rngt As Range)\n    Dim csrc As Long\n    csrc = rngs.Interior.Color\n    If (csrc = vbBlue) Then\n        rngt.Interior.Color = vbBlue\n    End If\nEnd Sub\n\nSub copy_color2(rngs As Range, rngt As Range)\n    If (TypeName(prev_sel) = \"Range\") Then\n        Dim pss As String\n        pss = prev_sel.Parent.Name\n        If (pss = ssrc) Then\n            Dim ints As Range\n            Set ints = Application.Intersect(rngs, prev_sel)\n            If (Not (ints Is Nothing)) Then\n                Call copy_color(rngs, rngt)\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>In ThisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    ssrc = \"Sheet2\"\n    strg = \"Sheet1\"\n    Set wssrc = Worksheets(ssrc)\n    Set wstrg = Worksheets(strg)\n    Set rngsrc = wssrc.Range(\"A1\")\n    Set rngtrg = wstrg.Range(\"A1\")\n    Call copy_color(rngsrc, rngtrg)\n\n    If (TypeName(Selection) = \"Range\") Then\n        Set prev_sel = Selection\n    Else\n        Set prev_sel = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>In Sheet2:</p>\n\n<pre><code>Private Sub Worksheet_Deactivate()\n    Call copy_color(rngsrc, rngtrg)\n    If (TypeName(Selection) = \"Range\") Then\n        Set prev_sel = Selection\n    Else\n        Set prev_sel = Nothing\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Call copy_color2(rngsrc, rngtrg)\n    If (TypeName(Target) = \"Range\") Then\n        Set prev_sel = Target\n    End If\nEnd Sub\n</code></pre>\n\n<p>I will soon edit with explanations. Reading carefully, it can be readily understood, though.</p>\n\n<p>Notes:</p>\n\n<ol>\n<li><p>This code does not act if the source cell color changes from <code>vbBlue</code> to something else. You did not specify anything for this action. Actually, your specification was not detailed enough to cover all possible cases.</p></li>\n<li><p>There might be cases (extremely unlikely, I guess) where this code fails. For instance, if color is changed via other VBA code, without selecting/deselecting cells.</p></li>\n<li><p>The idea is to check for the need of acting after as many relevant events as possible. Here I am detecting <code>Workbook_Open</code>, <code>Worksheet_Deactivate</code>, <code>Worksheet_SelectionChange</code>. You may add other events with suitable <code>Sub</code>s, e.g., <code>Workbook_BeforeClose</code>, <code>Workbook_BeforeSave</code>. All this is a way of substituting for the non-existing event of changing cell format.</p></li>\n<li><p>I like the <a href=\"https://stackoverflow.com/a/27832055/2707864\">answer by pnuts</a> (although I did not have time to test it). But the present one gives a flexibility that is not available with the other. There might be some cases (depending on what you need to do) that would not be covered by it.</p></li>\n<li><p>There are other possible combinations of places to locate variables declaration and other code, essentially performing the same actions.</p></li>\n</ol>\n\n\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1420757966, "last_edit_date": 1420757966, "creation_date": 1420738137, "answer_id": 27846070, "question_id": 27828470, "link": "https://stackoverflow.com/questions/27828470/set-the-color-of-one-cell-based-on-the-color-of-another-cell/27846070#27846070", "title": "Set the color of one cell based on the color of another cell", "body": "<p>Just to be clear and to keep the functionality you deliver simple,  you could use conditional formatting and choose to set the format with a colour.  This is incredibly easy once you know how.  The main trick is what formula to enter and specifically which cell you need a conditional formats formula to reference when the conditional format applies to a multi cell range. </p>\n\n<p>As an example.  If your conditional formatting rule is created such that it applies to the range $C$5:$C$10 the formula you use will often need to be entered as =(A5=\"A\").  Note this is a relative addressing formula ie no dollar signs.  this has the effect of the cell c6 inspecting the value of a6 etc.   </p>\n\n<p>Your only complication now is to inspect the formatting of the cell rather than the value it stores.   In 2013, you can still use <code>=GET.CELL(63,A5)</code> to do this, however this can't be entered in the formula of the CF rule ... Other posts discuss the whys and wherefores of using this.  See <a href=\"http://www.mrexcel.com/forum/excel-questions/20611-info-only-get-cell-arguments.html\" rel=\"nofollow\">this link</a> which described how to get cell info.</p>\n\n<p>So you'll end up with a formula in a cell next to the cell that has the colouring. The formula will use a named range that returns true or false depending on whether the colour of the cell matches the colour you specify in the named range.  You conditional formatting on another sheet will reference this formula cell and set the colour of the new cell.</p>\n\n<p>You would use the following formula in the named range called \"Get .\n=GET.CELL(65,OFFSET(INDIRECT(\"RC\",FALSE),0,1)) </p>\n\n<p>I've got this to work, and the key information can be found one the referenced web site page.</p>\n\n<p>Ok? </p>\n"}], "owner": {"reputation": 41, "user_id": 4213622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aefa836bf2af6b33b99173f7f59effd?s=128&d=identicon&r=PG&f=1", "display_name": "yue86231", "link": "https://stackoverflow.com/users/4213622/yue86231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13420, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1447293573, "creation_date": 1420664103, "last_edit_date": 1531161705, "question_id": 27828470, "link": "https://stackoverflow.com/questions/27828470/set-the-color-of-one-cell-based-on-the-color-of-another-cell", "title": "Set the color of one cell based on the color of another cell", "body": "<p>What I would like to have is:</p>\n\n<pre><code>IF   A1 in Sheet 2 is blue  \nThen A1 in Sheet 1 changes to blue\n</code></pre>\n\n<p>I know I can get the color of A1 in Sheet 2 by using:</p>\n\n<pre><code>=GET.CELL(63,Sheet2!A1)\n</code></pre>\n\n<p>(<a href=\"https://stackoverflow.com/questions/20008632/excel-can-i-create-a-conditional-formula-based-on-the-color-of-a-cell\">Excel: Can I create a Conditional Formula based on the Color of a Cell?</a>)</p>\n\n<p>But I can't figure out what I should do in the next step.</p>\n\n<p>Any suggestions?</p>\n\n#\n\n<p>Update on 12.01.2015\nsorry if I gave too little information about my case, and not pointed out at the beginning clearly whether I want to do it in VBA or not.\nAt the beginning I thought a function would work, but as I considered my file, a function might not work at all.</p>\n\n<p>It is about the output of a correlation analyse from SPSS, there are three columns: correlation coefficient, p-value and sample size.\nI need to check the coefficient and p-value at the same time, and present the coefficient in a readable way. Say I run a correlation between 50 variables with 100 variables, I would not paste coefficient and p-value in one sheet, rather:</p>\n\n<p>sheet one : coefficient\nsheet two: p-value</p>\n\n<p>What I would to have is:</p>\n\n<p>If value of p-value is bigger than 0.05, then coefficient (cell) changes to blue/dark blue or black.</p>\n\n<p>So that when I watch the first sheet, I know blue ones should be ignored because of non-significance.</p>\n\n<p>I will try all the suggestions below and report it later.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420666557, "post_id": 27828448, "comment_id": 44064109, "body": "Have you tried to debug this using the VBA debugger? My guess is that you are performing a mathematics operation on a string value. I think it will be easy to find with debugging."}, {"owner": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420669045, "post_id": 27828448, "comment_id": 44065260, "body": "Yes VBA debugger have been used! - Function Exit right after <code>For Each WS In Wbk.Worksheets</code> and returns #VALUE! - so it does never get to that part."}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1420669793, "post_id": 27828448, "comment_id": 44065592, "body": "What do you mean it exits the code? It does not see any sheets in the Excel file? Have you looked at the locals window to see if this workbook is created correctly?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1420670269, "post_id": 27828448, "comment_id": 44065809, "body": "Tip 1: add a watcher to the variable <code>Wbk</code> just before executing the line where the function escapes, then tell us what it&#39;s in there. Tip 2: make sure the variable <code>ExcelFile</code> it&#39;s of kind <code>name+extension</code> and not only <code>name</code>. To be clearer, make sure you pass <code>MyWorkbook.xlsx</code> and not only <code>MyWorkbook</code>."}, {"owner": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "edited": false, "score": 0, "creation_date": 1420676030, "post_id": 27828448, "comment_id": 44067788, "body": "Tip1: Wbk = Nothing.  Tip2: it is the correct path ExcelFile = &quot;C:\\test\\test.xlsx&quot;"}, {"owner": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1420676481, "post_id": 27828448, "comment_id": 44067932, "body": "@cronos2546 I mean escapes - I think when i use the <code>Workbooks.Open</code> it gennerate an error, but because the function have been called from a cell, I do not get any error messages. But how to fix it ? :-)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "edited": false, "score": 0, "creation_date": 1420746840, "post_id": 27844592, "comment_id": 44100615, "body": "You nailed it :-) - that was the problem... <code>Workbooks.Open</code> does not work when called from a cell in excel. Your workaround works, but my problem with this method, is that I do not know the path/filename of the workbooks at that point. I guess I need to make a macro that check every cell that call my <code>DatasheetLookup</code> and the open the relevant workbooks (hidden), but if you introduced a new workbook it will only work if you close and open the &quot;master&quot; workbook - or do you have better suggestion?"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "reply_to_user": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "edited": false, "score": 0, "creation_date": 1420748427, "post_id": 27844592, "comment_id": 44101481, "body": "I&#39;m not certain of the tasks you are doing so I don&#39;t think I can be of much more help. I think that a macro-based solution might be a good way to handle this. Perhaps a &quot;RECALCULATE&quot; button that runs a macro to refresh all the data on the page?"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "reply_to_user": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "edited": false, "score": 0, "creation_date": 1420748478, "post_id": 27844592, "comment_id": 44101500, "body": "This article can explain how to get data from a closed file, but the method has some stipulations on how its used: <a href=\"http://spreadsheetpage.com/index.php/site/tip/a_vba_function_to_get_a_value_from_a_closed_file/\" rel=\"nofollow noreferrer\">spreadsheetpage.com/index.php/site/tip/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "is_accepted": true, "score": 0, "last_activity_date": 1420733567, "last_edit_date": 1495540256, "creation_date": 1420733567, "answer_id": 27844592, "question_id": 27828448, "link": "https://stackoverflow.com/questions/27828448/%c3%89xcel-vba-open-workbook-in-macro-that-have-been-called-in-a-cell/27844592#27844592", "title": "&#201;xcel-VBA Open Workbook in macro that have been called in a cell", "body": "<p>I am not sure the reason for this specifically, but you cannot open a file in a user defined function. There are many additional actions that cannot be performed in a <code>Function</code> as well. This is also discussed in this Stack Overflow answer <a href=\"https://stackoverflow.com/questions/7693530/excel-vba-cant-open-workbook\">here</a>. </p>\n\n<p>However, in your case, you can easily cheat this limitation by opening the file you want to read before you call the function. I prepared a very basic demonstration of this, you will need to modify the code as needed to fit your particular example:</p>\n\n<p>Code in \"ThisWorkbook\":</p>\n\n<pre><code>' when the workbook opens, also open the companion spreadsheet so it is available to use\nPrivate Sub Workbook_Open()\n    Set Wbk = Workbooks.Open(\"C:\\Users\\lrr\\Desktop\\Myworkbook.xlsx\")\nEnd Sub\n</code></pre>\n\n<p>Code in \"Module1\":</p>\n\n<pre><code>Global Wbk As Workbook\n\nPublic Function testFunc()\n    ' the workbook is already opened, so you may perform this iteration operation w/o any problems.\n    For Each WS In Wbk.Worksheets\n        testFunc = 1\n        Exit Function\n    Next WS\nEnd Function\n</code></pre>\n\n<p>Code in Cell A1:</p>\n\n<pre><code>=testFunc()\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4430499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5788be4664121bf8a5d0d4b10dd73764?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren Juul", "link": "https://stackoverflow.com/users/4430499/s%c3%b8ren-juul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 27844592, "answer_count": 1, "score": 2, "last_activity_date": 1423113400, "creation_date": 1420664006, "last_edit_date": 1423113400, "question_id": 27828448, "link": "https://stackoverflow.com/questions/27828448/%c3%89xcel-vba-open-workbook-in-macro-that-have-been-called-in-a-cell", "title": "&#201;xcel-VBA Open Workbook in macro that have been called in a cell", "body": "<p>I have some trouble with a function that I call from a cell in Excel. \nThe macro shall open a workbook get some data and then return a mathematical results to the cell.</p>\n\n<p>But when I use the the following code it does not open the wordbook, just return #VALUE! to the cell. It break out of the code right after I tried to open the workbook.</p>\n\n<pre><code>' This Interpolation function is used to get data from other Excel sheets\nPublic Function DatasheetLookup(ExcelFile As String, ExcelSheet As String, xVal As Double, Optional isSorted As Boolean = True) As Variant\n    ' abosolute or relative path?\n    If Not (Left(ExcelFile, 3) Like \"[A-Z]:\\\") Or (Left(ExcelFile, 2) = \"\\\\\") Then\n        ExcelFile = ThisWorkbook.path &amp; \"\\\" &amp; ExcelFile\n    End If\n\n    ' does file exits?\n    If Dir(ExcelFile, vbDirectory) = vbNullString Then\n        DatasheetLookup = \"No such file!\"\n        Exit Function\n    End If\n\n    ' open the source workbook, read only\n    Dim Wbk As Workbook\n    Dim WS As Worksheet\n'    Application.ScreenUpdating = False ' turn off the screen updating\n    Set Wbk = Workbooks.Open(ExcelFile)\n       ' Run through all sheets in the source workBook to find \"the one\"\n        For Each WS In Wbk.Worksheets     ' &lt;-- Here it exit the code and return #VALUE!\n            If WS.Name &lt;&gt; ExcelSheet Then\n                DatasheetLookup = \"Sheet not found!\"\n            Else\n                Dim xRange As Range\n                Dim yRange As Range\n                xRange = WS.Range(\"A1\", \"A\" &amp; WS.UsedRange.Rows.Count)\n                yRange = WS.Range(\"B1\", \"B\" &amp; WS.UsedRange.Rows.Count)\n\n\n\n                Dim yVal As Double\n                Dim xBelow As Double, xAbove As Double\n                Dim yBelow As Double, yAbove As Double\n                Dim testVal As Double\n                Dim High As Long, Med As Long, Low As Long\n\n                Low = 1\n                High = WS.UsedRange.Rows.Count\n\n                If isSorted Then\n                    ' binary search sorted range\n                    Do\n                        Med = Int((Low + High) \\ 2)\n                        If (xRange.Cells(Med).Value) &lt; (xVal) Then\n                        Low = Med\n                        Else\n                        High = Med\n                        End If\n                    Loop Until Abs(High - Low) &lt;= 1\n                Else\n                    ' search every entry\n                    xBelow = -1E+205\n                    xAbove = 1E+205\n\n                    For Med = 1 To xRange.Cells.Count\n                        testVal = xRange.Cells(Med)\n                        If testVal &lt; xVal Then\n                            If Abs(xVal - testVal) &lt; Abs(xVal - xBelow) Then\n                                Low = Med\n                                xBelow = testVal\n                            End If\n                        Else\n                            If Abs(xVal - testVal) &lt; Abs(xVal - xAbove) Then\n                                High = Med\n                                xAbove = testVal\n                            End If\n                        End If\n                    Next Med\n                End If\n\n                xBelow = xRange.Cells(Low): xAbove = xRange.Cells(High)\n                yBelow = yRange.Cells(Low): yAbove = yRange.Cells(High)\n                DatasheetLookup = yBelow + (xVal - xBelow) * (yAbove - yBelow) / (xAbove - xBelow)\n                Exit For\n            End If\n\n        Next WS\n    Wbk.Close Savechanges:=False\n    Set Wbk = Nothing\n    Application.ScreenUpdating = True\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "function", "class", "error-handling"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420664050, "post_id": 27828316, "comment_id": 44062843, "body": "I&#39;ve not completely read through this yet, but (in general) my classes <i>raise</i> errors and my main routine listens for them."}], "answers": [{"comments": [{"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 0, "creation_date": 1420668396, "post_id": 27828555, "comment_id": 44064951, "body": "Good answer, I&#39;ve used this technique many times. I&#39;d add though that setting the Error source to something like &quot;method name:&quot; &amp; Err.Source allows you to show the logic path that caused the error."}, {"owner": {"reputation": 22156, "user_id": 154439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63c2ea30cedb0e3a9488df1e1861d1e7?s=128&d=identicon&r=PG", "display_name": "mwolfe02", "link": "https://stackoverflow.com/users/154439/mwolfe02"}, "reply_to_user": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 0, "creation_date": 1420668777, "post_id": 27828555, "comment_id": 44065132, "body": "Thanks, @jac, I updated my answer to incorporate your suggestion."}, {"owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "edited": false, "score": 0, "creation_date": 1420671009, "post_id": 27828555, "comment_id": 44066125, "body": "That did it!!! When I step through the code it jumps from the Err.Raise line up to the main sub. It bypasses the first Class Module function. It is so sudden I don&#39;t fully understand how or why it works, but it works. Thank you so much."}], "tags": [], "owner": {"reputation": 22156, "user_id": 154439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63c2ea30cedb0e3a9488df1e1861d1e7?s=128&d=identicon&r=PG", "display_name": "mwolfe02", "link": "https://stackoverflow.com/users/154439/mwolfe02"}, "is_accepted": true, "score": 4, "last_activity_date": 1420668729, "last_edit_date": 1420668729, "creation_date": 1420664421, "answer_id": 27828555, "question_id": 27828316, "link": "https://stackoverflow.com/questions/27828316/error-handling-in-a-class-module-function/27828555#27828555", "title": "Error handling in a Class Module Function", "body": "<p>Your <code>On Error Resume Next</code> statement is swallowing the error in <code>toGlobal</code> and preventing it from \"bubbling up\" the call stack.  One option you have is to \"re-throw\" the error.  Doing this in VBA is a bit kludgier than other languages, but is still possible.</p>\n\n<p>For example, you can change the <code>toGlobal</code> function to something like the following:</p>\n\n<pre><code>Function toGlobal(ByVal cord As cCordCol)\n\nOn Error Resume Next\nctype = cord.Item(Me.cord1).sys\n\n' Missing Coordinate System Error\nIf Err.Number &lt;&gt; 0 Then\n  i = MsgBox(\"The definition of Coordinate \" &amp; Me.cord1 &amp; \" was missing from the Bulk Data \" &amp; Chr(10) &amp; _\n             \"File. Include this Coord in the .bdf and re-execute the program.\", vbOKOnly, \"Runtime Error\")\n\n' *** TERMINATE MAIN SUBROUTING HERE ***\n    'Save info from the error object (it will get cleared in the On Error statement below)\n    Dim ErrNum As Long: ErrNum = Err.Number\n    Dim ErrMsg As String: ErrMsg = Err.Description\n    Dim ErrSrc As String: ErrSrc = Err.Source\n\n    'Reset error handling to allow errors to bubble up the call stack\n    On Error Goto 0    \n\n    '\"Re-throw\" the error\n    Err.Raise ErrNum, \"toGlobal:\" &amp; ErrSrc, ErrMsg\n\nEnd If\n</code></pre>\n\n<hr>\n\n<p>The other option is to just remove your <code>On Error Resume Next</code> statement from your class module so that the error simply bubbles up naturally.  This is the approach that I would generally take unless there was some compelling reason to stray from it.</p>\n"}], "owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2172, "favorite_count": 0, "accepted_answer_id": 27828555, "answer_count": 1, "score": 4, "last_activity_date": 1420759777, "creation_date": 1420663501, "last_edit_date": 1420759777, "question_id": 27828316, "link": "https://stackoverflow.com/questions/27828316/error-handling-in-a-class-module-function", "title": "Error handling in a Class Module Function", "body": "<p>I have several Class Modules in my Workbook. One of public functions in Class Module 1 relies on data from a function in Class Module 2, this happens four times. In the event that the object is missing from Class 2 the program crashes (as expected). I am having difficulty debugging the code properly as it seems that I can only exit the program from the main subroutine. I would prefer to kill the program from the Class function, but I don't know if that is possible (we can squash this here if it is). I am currently using On Error statements in the main subroutine, but these don't execute in a timely manner because the function in Class 1 gets data from Class 2 four times.</p>\n\n<p>Class Module 1 Function</p>\n\n<pre><code>Function oload(ByVal pload As Double, ByVal cord As cCordCol, ByVal grid As cGridCol)\n\n' cord is a scripting.dictionary of Class Module Objects (cCord)\n' grid is a scripting.dictionary of Class Module Objects (cGrid)\n\n  n1 = grid.Item(pg1).toGlobal(cord)\n  n2 = grid.Item(pg2).toGlobal(cord)\n  n3 = grid.Item(pg3).toGlobal(cord)\n  n4 = grid.Item(pg4).toGlobal(cord)\n\n' do something here\n\noload = sum_Ploads\n\nEnd Function\n</code></pre>\n\n<p>Above the n1 thru n4 is where I am calling on the public function of Class Module 2.</p>\n\n<p>Below is the Class Module 2 Function</p>\n\n<pre><code>Function toGlobal(ByVal cord As cCordCol)\n\nOn Error Resume Next\nctype = cord.Item(Me.cord1).sys\n\n' Missing Coordinate System Error\nIf Err.Number &lt;&gt; 0 Then\n  i = MsgBox(\"The definition of Coordinate \" &amp; Me.cord1 &amp; \" was missing from the Bulk Data \" &amp; Chr(10) &amp; _\n             \"File. Include this Coord in the .bdf and re-execute the program.\", vbOKOnly, \"Runtime Error\")\n\n' *** TERMINATE MAIN SUBROUTING HERE ***\n\nEnd If\n</code></pre>\n\n<p>This will raise a message box indicating that an object was missing, specifically the (me.cord1) part - this is an item in a scripting.dictionary. I want to terminate the program here.</p>\n\n<p>The main subroutine (greatly reduced) is here:</p>\n\n<pre><code>Sub main()\n\n  ' lookup Element ID, Calc OLOAD, Sum Load Set OLOAD\n  On Error GoTo PROC_ERR\n  If dict_quad.Exists(EID) Then dict_oload.Item(LS).add_to_oload (dict_quad.Item(EID).oload(pload, dict_cord, dict_grid))\n  If dict_tria.Exists(EID) Then dict_oload.Item(LS).add_to_oload (dict_tria.Item(EID).oload(pload, dict_cord, dict_grid))\n\nPROC_ERR:\nIf Err.Number &lt;&gt; 0 Then Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>I have a lot of nested operations here. You can see the \"goto\" statement won't execute until the \"oload\" function is complete. The \"oload\" function calls upon the \"toGlobal\" function four times before it finishes its calculations.</p>\n\n<p>How can I terminate the subroutine after the first occurance of a missing object in the \"toGlobal\" function?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1420664232, "post_id": 27828212, "comment_id": 44062938, "body": "First, check <b><a href=\"http://stackoverflow.com/a/10717999/2687063\">this</a></b>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1420666201, "post_id": 27828212, "comment_id": 44063925, "body": "Two changes:  <code>1</code> Eliminate all of the <code>Select</code>, <code>Selection</code> statements.  <code>2</code> Where you are moving data, or the results of formulas, and not the actual formulas, read all the data into a VBA array in a single step: eg <code>V=Range(&quot;B5:V23&quot;)</code>, then move the particular cells into the new array <code>array1(0)=v(1,5)</code> would place the contents of what was in F5 into array1(0); and so forth.  Then read the array back to the worksheet <code>myrange = array1</code> In my experience, working with arrays in VBA can afford as much as a ten-fold improvement in speed, vs going back and forth to the worksheet."}, {"owner": {"reputation": 11, "user_id": 4347316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3c0d9408fd87fdc2bd874deb780f5b?s=128&d=identicon&r=PG&f=1", "display_name": "clysaght62", "link": "https://stackoverflow.com/users/4347316/clysaght62"}, "edited": false, "score": 0, "creation_date": 1420731595, "post_id": 27828212, "comment_id": 44091452, "body": "Thanks for this tip! I didn&#39;t think of this way of doing it but it definitely helped to increase the speed of my macro!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4347316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3c0d9408fd87fdc2bd874deb780f5b?s=128&d=identicon&r=PG&f=1", "display_name": "clysaght62", "link": "https://stackoverflow.com/users/4347316/clysaght62"}, "edited": false, "score": 0, "creation_date": 1420731687, "post_id": 27831425, "comment_id": 44091523, "body": "Thanks for your help! I guess I got into the bad habit of using selection when I was learning &quot;on-the-go&quot; and never got rid of it. I&#39;m going to try to implement more of this type of code going forward."}], "tags": [], "owner": {"reputation": 15, "user_id": 3924321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e8a9770a16ae3379066deddadc6177?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/3924321/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1420679336, "creation_date": 1420679336, "answer_id": 27831425, "question_id": 27828212, "link": "https://stackoverflow.com/questions/27828212/is-there-any-way-to-speed-up-my-macro/27831425#27831425", "title": "Is there any way to speed up my macro?", "body": "<p>Whilst this won't speed up the entire thing. You can defs save on time by getting rid of the 'select/selection' bits.</p>\n\n<p>For example for that first section replace:</p>\n\n<pre><code>Range(\"A10\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Range([A10],[A10].End(xlDown)).ClearContents\n</code></pre>\n\n<p>Note: the use of [] in this case replaces Range(). Not always healthy to use this shortcut but for your purposes it should be fine.\nYou should always try and rewrite a code you recorded with this formatting before anything else, it bypasses the clumsiness of the macro recorder and turns it into neat vba code :)</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4347316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3c0d9408fd87fdc2bd874deb780f5b?s=128&d=identicon&r=PG&f=1", "display_name": "clysaght62", "link": "https://stackoverflow.com/users/4347316/clysaght62"}, "edited": false, "score": 0, "creation_date": 1420731641, "post_id": 27833050, "comment_id": 44091494, "body": "Thanks for doing that! I tried to implement as much as possible using everyone&#39;s comments, but it helped exponentially to see the code as you typed it."}], "tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1420691997, "creation_date": 1420691997, "answer_id": 27833050, "question_id": 27828212, "link": "https://stackoverflow.com/questions/27828212/is-there-any-way-to-speed-up-my-macro/27833050#27833050", "title": "Is there any way to speed up my macro?", "body": "<p>It is not very pretty but it is fast. I am not very good with making Array's faster but this could be an alternative solution.</p>\n\n<pre><code>Sub watchlist_updated()\n\n'***Define your Variables***\nDim wsAnalysis As Excel.Worksheet\nDim wsWatchList As Excel.Worksheet\nDim wsSelectData As Excel.Worksheet\nDim LastRow1 As Long\nDim LastRow2 As Long\nDim LastRow3 As Long\n\n'***Set the objects***\nSet wsAnalysis = Sheets(\"Analysis\")\nSet wsWatchList = Sheets(\"Watchlist\")\nSet wsSelectData = Sheets(\"Selected Data\")\n\n'***Turn off Background***\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n'***Finding Last Row - Each Sheet***\nLastRow1 = wsSelectData.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nLastRow2 = wsAnalysis.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastRow3 = wsWatchList.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n'***Handle any Errors***\nOn Error GoTo ErrorHandler:\n\nWith wsWatchList\n    .Range(.Cells(10, 1), .Cells(10 + LastRow3, 17)).ClearContents\nEnd With\n\nWith wsAnalysis\n    .Range(\"C5:D5\").ClearContents\n    .Range(\"N6\").FormulaR1C1 = \"Yes\"\nEnd With\n\n'***New Copy &amp; Paste Method***\nwsWatchList.Range(wsWatchList.Cells(10, 1), wsWatchList.Cells(10 + LastRow1, 1)).Value = _\nwsSelectData.Range(wsSelectData.Cells(6, 3), wsSelectData.Cells(6 + LastRow1, 3)).Value\n\nwsAnalysis.Range(\"C5\") = LastRow1 - 5\n\nwsWatchList.Range(wsWatchList.Cells(10, 2), wsWatchList.Cells(LastRow1 + 4, 2)).Value = wsAnalysis.Range(\"F5\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 3), wsWatchList.Cells(LastRow1 + 4, 3)).Value = wsAnalysis.Range(\"C20\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 4), wsWatchList.Cells(LastRow1 + 4, 4)).Value = wsAnalysis.Range(\"J2\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 5), wsWatchList.Cells(LastRow1 + 4, 5)).Value = wsAnalysis.Range(\"B8\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 6), wsWatchList.Cells(LastRow1 + 4, 6)).Value = wsAnalysis.Range(\"J13\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 7), wsWatchList.Cells(LastRow1 + 4, 7)).Value = wsAnalysis.Range(\"C21\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 8), wsWatchList.Cells(LastRow1 + 4, 8)).Value = wsAnalysis.Range(\"B11\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 9), wsWatchList.Cells(LastRow1 + 4, 9)).Value = wsAnalysis.Range(\"V5\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 10), wsWatchList.Cells(LastRow1 + 4, 10)).Value = wsAnalysis.Range(\"B12\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 11), wsWatchList.Cells(LastRow1 + 4, 11)).Value = wsAnalysis.Range(\"J6\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 12), wsWatchList.Cells(LastRow1 + 4, 12)).Value = wsAnalysis.Range(\"B9\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 13), wsWatchList.Cells(LastRow1 + 4, 13)).Value = wsAnalysis.Range(\"N20\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 14), wsWatchList.Cells(LastRow1 + 4, 14)).Value = wsAnalysis.Range(\"H23\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 15), wsWatchList.Cells(LastRow1 + 4, 15)).Value = wsAnalysis.Range(\"F23\").Value\nwsWatchList.Range(wsWatchList.Cells(10, 16), wsWatchList.Cells(LastRow1 + 4, 16)).Value = wsAnalysis.Range(\"D23\").Value\n\n\nwsAnalysis.Range(\"N6\").FormulaR1C1 = \"No\"\n\nwsWatchList.Select\n\n'***Clean Up***\nBeforeExit:\n\nSet wsAnalysis = Nothing\nSet wsWatchList = Nothing\nSet wsSelectData = Nothing\n\n'***Turn on Background***\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nExit Sub\n'***Add in a simple ErrorHandler***\nErrorHandler:\n\nMsgBox \"Error\"\n\nGoTo BeforeExit\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4347316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3c0d9408fd87fdc2bd874deb780f5b?s=128&d=identicon&r=PG&f=1", "display_name": "clysaght62", "link": "https://stackoverflow.com/users/4347316/clysaght62"}, "edited": false, "score": 0, "creation_date": 1420731564, "post_id": 27834130, "comment_id": 44091423, "body": "Thanks for all of your help! These are great tips and I tried to implement as much as I could."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1420698996, "last_edit_date": 1420698996, "creation_date": 1420698189, "answer_id": 27834130, "question_id": 27828212, "link": "https://stackoverflow.com/questions/27828212/is-there-any-way-to-speed-up-my-macro/27834130#27834130", "title": "Is there any way to speed up my macro?", "body": "<p>The key to speedy VBA loop is to <em>minimise</em> interaction with the workbook inside the loop.</p>\n\n<p>In your case you won't be able to eliminate interaction entirely, but you can reduce it substantially.</p>\n\n<p>Key steps are:</p>\n\n<ol>\n<li>You <em>can</em> use Manual calculation.  (see below)</li>\n<li>Create <code>Worksheet</code> and <code>Range</code> objects variables to refer to your sheets and ranges</li>\n<li>Create Variant Array's to hold your source data, result data and Analysis results</li>\n<li>Once you have a reference to your source data, copy it into a Variant Array.  do a <code>For</code> loop over the rows of this array (rather than using <code>ActiveCell</code>)</li>\n<li>Create a Results array, sized to the source data rows, by 16 columns wide</li>\n<li>On each iteration, copy the source data value onto the Analysis sheet (here's where you can't avoid <em>some</em> workbook interaction) </li>\n<li>Force a recalculation of the Analysis sheet with <code>wsAnalysis.Calculate</code></li>\n<li>Copy the results to a variant array in one step.  I'd copy the range <code>A1:V23</code>.  (Copying too many cells in one step is faster than copying many cells one at a time)</li>\n<li>Map the required results into your Results array, into the current row</li>\n<li>After the loop, copy the result array to the results range in your workbook (again in one step)</li>\n</ol>\n\n<p>Other notes:</p>\n\n<ol>\n<li>Eliminate all the <code>Select</code>, <code>Selection</code>, <code>ActiveSheet</code>, <code>ActiveCell</code> stuff (as others have mentioned)</li>\n<li>Declare all your variables</li>\n<li>Be explicit of Lower and Upper bounds in your array declarations</li>\n<li>Provide an Error Handler, and CleanUp code to turn on <code>Application</code> properties even when the code errors</li>\n</ol>\n\n<p>After all this, performance will depend on the calculation time of your <code>Analysis</code> worksheet.  There may be opportunity for improvement there too, if you would care to share its details</p>\n"}], "owner": {"reputation": 11, "user_id": 4347316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3c0d9408fd87fdc2bd874deb780f5b?s=128&d=identicon&r=PG&f=1", "display_name": "clysaght62", "link": "https://stackoverflow.com/users/4347316/clysaght62"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1423113415, "creation_date": 1420663081, "last_edit_date": 1423113415, "question_id": 27828212, "link": "https://stackoverflow.com/questions/27828212/is-there-any-way-to-speed-up-my-macro", "title": "Is there any way to speed up my macro?", "body": "<p>I have a macro that will take each value in a list, place it in a different sheet (which performs its own calculations) and returns certain values (like a summary sheet). I have created a looping macro to do this very action, but since there are about 6500 entries on the list, the macro executes at a very slow pace. I have turned off screen updating, and calculations have to be automatic, so I was wondering: is there any other way to speed up the macro?</p>\n\n<pre><code>Sub watchlist_updated()\n\nApplication.ScreenUpdating = False\n\nRange(\"A10\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n\nRange(\"B10:Q10\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n\nSheets(\"Analysis\").Select\nRange(\"C5:D5\").ClearContents\nRange(\"N6\").Select\nActiveCell.FormulaR1C1 = \"Yes\"\n\nSheets(\"Selected Data\").Select\nRange(\"C6\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nSheets(\"Watchlist\").Select\nRange(\"A10\").Select\nActiveSheet.Paste\ncountermax = Selection.Count\n\nRange(\"A10\").Select\ncounter = 1\nDo Until ActiveCell = \"\"\n    sStatus = Format(counter / countermax, \"0.0%\") &amp; \" Complete\"\n    Application.StatusBar = sStatus\n    Sheets(\"Analysis\").Range(\"C5\") = ActiveCell.Value\n\nDim array1(16)\nDim myrange As Range\n\nSet myrange = Range(ActiveCell.Offset(0, 1), ActiveCell.Offset(0, 16))\n\narray1(0) = Sheets(\"Analysis\").Range(\"F5\").Value\narray1(1) = Sheets(\"Analysis\").Range(\"C20\").Value\narray1(2) = Sheets(\"Analysis\").Range(\"J2\").Value\narray1(3) = Sheets(\"Analysis\").Range(\"B8\").Value\narray1(4) = Sheets(\"Analysis\").Range(\"J13\").Value\narray1(5) = Sheets(\"Analysis\").Range(\"R13\").Value\narray1(6) = Sheets(\"Analysis\").Range(\"C21\").Value\narray1(7) = Sheets(\"Analysis\").Range(\"B11\").Value\narray1(8) = Sheets(\"Analysis\").Range(\"V5\").Value\narray1(9) = Sheets(\"Analysis\").Range(\"B12\").Value\narray1(10) = Sheets(\"Analysis\").Range(\"J6\").Value\narray1(11) = Sheets(\"Analysis\").Range(\"B9\").Value\narray1(12) = Sheets(\"Analysis\").Range(\"N20\").Value\narray1(13) = Sheets(\"Analysis\").Range(\"H23\").Value\narray1(14) = Sheets(\"Analysis\").Range(\"F23\").Value\narray1(15) = Sheets(\"Analysis\").Range(\"D23\").Value\n\nmyrange = array1\n\n    ActiveCell.Offset(1, 0).Select\n\ncounter = counter + 1\nLoop\n\nApplication.StatusBar = False\nSheets(\"Analysis\").Select\nRange(\"N6\").Select\nActiveCell.FormulaR1C1 = \"No\"\nSheets(\"Watchlist\").Select\nApplication.ScreenUpdating = True\n\nApplication.StatusBar = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1420663648, "post_id": 27828148, "comment_id": 44062619, "body": "Have you considered a <code>Worksheet_Change</code> Sub?"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1420665520, "last_edit_date": 1420665520, "creation_date": 1420664184, "answer_id": 27828499, "question_id": 27828148, "link": "https://stackoverflow.com/questions/27828148/conditional-formatting-global-formatting-definitions/27828499#27828499", "title": "Conditional Formatting: Global Formatting Definitions?", "body": "<p>A <code>Worksheet_Change Sub</code> will do what you are looking for:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Place Sub in only the Reference Worksheet\n\n   'Do nothing if more than one cell is changed or content deleted\n   If Target.Cells.Count &gt; 1 Or IsEmpty(Target) Then Exit Sub\n\n   With Sheets(\"Sheet1\").Range(\"DefineRange\").FormatConditions.Modify(Type:=xlCellValue, Operator:=xlEqual, Formula1:=\"=\" &amp; Target.Value)\n     .Interior.Color = Target.Interior.Color\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>Edit:  I used <code>.Modify</code> because I assume you will already have a conditional format specified if a cell equals a certain value.  If you want to add a new conditional formatting rule, use <code>.Add</code> instead.</p>\n"}], "owner": {"reputation": 2437, "user_id": 1860293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fa280715e26126211dcd762fb340085?s=128&d=identicon&r=PG", "display_name": "Brandon Lebedev", "link": "https://stackoverflow.com/users/1860293/brandon-lebedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1420665520, "creation_date": 1420662818, "last_edit_date": 1420663753, "question_id": 27828148, "link": "https://stackoverflow.com/questions/27828148/conditional-formatting-global-formatting-definitions", "title": "Conditional Formatting: Global Formatting Definitions?", "body": "<p>Lets say I have Sheet1 where</p>\n\n<pre><code>    A    B\n1   foo  foo\n2   bar  bar\n</code></pre>\n\n<p>and ReferenceSheet where</p>\n\n<pre><code>    A\n1   bar  &lt;-- cell is formatted with red background\n2   foo  &lt;-- cell is formatted with blue background\n</code></pre>\n\n<p>and where, as in all other programming examples, \"bar\" and \"foo\" are arbitrary placeholder values. :)</p>\n\n<p>I would like to make it so that for each cell (A1:D4) in Sheet1 that matches the value of a definition cell in ReferenceSheet (A1:A2), the cell will automatically copy the formatting of the definition cell.</p>\n\n<p>So that, continuing with the above example, Sheet1's background colors will be formatted as</p>\n\n<pre><code>    A    B\n1   bl   bl\n2   red  red\n</code></pre>\n\n<p>But if I change the ReferenceSheet's formatting to </p>\n\n<pre><code>    A\n1   bar  &lt;-- cell is formatted with pink background\n2   foo  &lt;-- cell is formatted with black background\n</code></pre>\n\n<p>Sheet1's background formatting will update to</p>\n\n<pre><code>    A    B\n1   blk  blk\n2   pk   pk\n</code></pre>\n\n<p>If possible, how does one go about implementing this?</p>\n\n<p>======</p>\n\n<p>*I would like to define my formatting in a sheet (rather than in Visual Basic code) in order to create more user-accessible formatting definitions. If that's not an option, Visual Basic (and therefore global) definitions would be my next choice.  Mass-copied conditional formatting applied to each cell would be my last choice, though finding a style-abstraction option similar to styles in Microsoft Word would make it a more paletable alternative.</p>\n"}, {"tags": ["vba", "excel", "method-chaining"], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1420663621, "last_edit_date": 1592644375, "creation_date": 1420663088, "answer_id": 27828218, "question_id": 27828134, "link": "https://stackoverflow.com/questions/27828134/why-does-range-address-return-the-address-of-the-first-cell-when-chained/27828218#27828218", "title": "Why does Range.Address() return the address of the first cell when chained?", "body": "<p>There is documentation on using <code>Range().Cells()</code> which indicates that <code>Cells()</code> will return the location within the given <code>Range()</code> relative to the top left cell of the <code>Range()</code>.  Testing this theory with <code>Range().Range()</code> gives:</p>\n<pre><code>Public Sub Unexpected()\n\n    Debug.Print Range(&quot;B1:C3&quot;).Range(&quot;A1&quot;).Address\n        '$B$1\n    Debug.Print Range(&quot;B1:C3&quot;).Range(&quot;B1&quot;).Address\n        '$C$1\nEnd Sub\n</code></pre>\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff834676%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">Documentation here</a>:</p>\n<blockquote>\n<p>When applied to a <code>Range</code> object, the property is relative to the <code>Range</code> object.</p>\n<p>For example, if the selection is cell <code>C3</code>, then <code>Selection.Range(&quot;B1&quot;)</code> returns cell <code>D3</code> because it\u2019s relative to the <code>Range</code> object returned by the <code>Selection</code> property. On the other hand, the code <code>ActiveSheet.Range(&quot;B1&quot;)</code> always returns cell <code>B1</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 27828218, "answer_count": 1, "score": 1, "last_activity_date": 1422888918, "creation_date": 1420662765, "last_edit_date": 1495535170, "question_id": 27828134, "link": "https://stackoverflow.com/questions/27828134/why-does-range-address-return-the-address-of-the-first-cell-when-chained", "title": "Why does Range.Address() return the address of the first cell when chained?", "body": "<p>I stumbled across some unexpected behavior when writing <a href=\"https://stackoverflow.com/a/27827942/3198973\">an answer</a> for <a href=\"https://stackoverflow.com/q/27827384/3198973\">this question</a>.</p>\n\n<p>When chaining together <code>Range</code> calls, <code>Address</code> always returns the address of the very first <code>Range</code> object in the statement. For example:</p>\n\n<pre><code>Public Sub Unexpected()\n\n    Debug.Print Range(\"B3\").Address\n    Debug.Print Range(\"B3\").Range(\"A1\").Address\n\nEnd Sub\n</code></pre>\n\n<p>Returns the following output.</p>\n\n<pre><code>$B$3\n$B$3\n</code></pre>\n\n<p>But I would have expected it to return the Address of the <em>last</em> Range object in the chain.</p>\n\n<pre><code>$B$3\n$A$1\n</code></pre>\n\n<p>Can anyone explain this behavior? Preferably with a quote of and link to the appropriate documentation.</p>\n"}, {"tags": ["vba", "autocad"], "comments": [{"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "edited": false, "score": 0, "creation_date": 1420661734, "post_id": 27827844, "comment_id": 44061588, "body": "Silly question: did you try <code>ThisDrawing.ModelSpace.Count</code>?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420661950, "post_id": 27827844, "comment_id": 44061688, "body": "What about a <code>For Each Item in ThisDrawing.ModelSpace.Item</code>?  Possibly wrong syntax."}, {"owner": {"reputation": 4035, "user_id": 2102389, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0339babf64d57456486611e63811231f?s=128&d=identicon&r=PG", "display_name": "tony9099", "link": "https://stackoverflow.com/users/2102389/tony9099"}, "reply_to_user": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "edited": false, "score": 0, "creation_date": 1420662085, "post_id": 27827844, "comment_id": 44061770, "body": "@JasonFaulkner see updated question"}, {"owner": {"reputation": 4035, "user_id": 2102389, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0339babf64d57456486611e63811231f?s=128&d=identicon&r=PG", "display_name": "tony9099", "link": "https://stackoverflow.com/users/2102389/tony9099"}, "edited": false, "score": 0, "creation_date": 1420662586, "post_id": 27827844, "comment_id": 44062037, "body": "Guys The solution for this was to use ThisDrawing.ModelSpace.Count but set it inside an Integer variable. it worked now using----- Dim X As Integer ; X = ThisDrawing.ModelSpace.Count"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420662667, "post_id": 27827844, "comment_id": 44062087, "body": "@tony9099 Add it as an answer then."}, {"owner": {"reputation": 4035, "user_id": 2102389, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0339babf64d57456486611e63811231f?s=128&d=identicon&r=PG", "display_name": "tony9099", "link": "https://stackoverflow.com/users/2102389/tony9099"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420706401, "post_id": 27827844, "comment_id": 44076408, "body": "@Chrismas007 done :)"}], "answers": [{"comments": [{"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 0, "creation_date": 1420852638, "post_id": 27835950, "comment_id": 44146119, "body": "You might consider upping that to a Long instead of an Integer, otherwise you might regularly run into overflows."}], "tags": [], "owner": {"reputation": 4035, "user_id": 2102389, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0339babf64d57456486611e63811231f?s=128&d=identicon&r=PG", "display_name": "tony9099", "link": "https://stackoverflow.com/users/2102389/tony9099"}, "is_accepted": false, "score": 0, "last_activity_date": 1421097201, "last_edit_date": 1421097201, "creation_date": 1420706387, "answer_id": 27835950, "question_id": 27827844, "link": "https://stackoverflow.com/questions/27827844/get-the-count-of-items-inside-a-drawing-in-autocad-using-vba/27835950#27835950", "title": "Get the count of items inside a drawing in autocad using VBA", "body": "<p>Guys The solution for this was to use <code>ThisDrawing.ModelSpace.Count</code> but set it inside an Integer variable. it worked now using the below </p>\n\n<pre><code>Dim X As Long\nX = ThisDrawing.ModelSpace.Count \n</code></pre>\n"}], "owner": {"reputation": 4035, "user_id": 2102389, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0339babf64d57456486611e63811231f?s=128&d=identicon&r=PG", "display_name": "tony9099", "link": "https://stackoverflow.com/users/2102389/tony9099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421097201, "creation_date": 1420661552, "last_edit_date": 1420662069, "question_id": 27827844, "link": "https://stackoverflow.com/questions/27827844/get-the-count-of-items-inside-a-drawing-in-autocad-using-vba", "title": "Get the count of items inside a drawing in autocad using VBA", "body": "<p>I am trying to get the number of items present inside the model space.\nIf i am not mistaken the <code>Count</code> does that trick, but I am not able to make it work (I might be wrong).</p>\n\n<p>For example, <code>Set entity = ThisDrawing.ModelSpace.Item(0)</code> gets only the first item. and <code>Set entity = ThisDrawing.ModelSpace.Item(0)</code> gets the second. But how to know how many we have ?</p>\n\n<p>I tried <code>ThisDrawing.ModelSpace.Count</code> but it gives the below error when running it. </p>\n\n<p><img src=\"https://i.stack.imgur.com/roqWw.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1420660913, "post_id": 27827384, "comment_id": 44061162, "body": "Not entirely sure, but it might be in case <code>ref</code> is a collection of cells, so it will always return a value."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420660927, "post_id": 27827384, "comment_id": 44061175, "body": "We would need to see the <code>ExecuteExcel4Macro()</code> code to see what input it needs.  But the syntax after <code>.Address()</code> is this: <a href=\"http://msdn.microsoft.com/en-us/library/office/ff821207%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "edited": false, "score": 0, "creation_date": 1420667755, "post_id": 27827384, "comment_id": 44064654, "body": "ExecuteExcel4Macro is -&gt; <a href=\"http://msdn.microsoft.com/en-us/library/office/ff193589%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>  Although if you&#39;re still using Excel 4 macros now ... might be time to upgrade."}], "answers": [{"tags": [], "owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "is_accepted": false, "score": 1, "last_activity_date": 1420661914, "last_edit_date": 1420661914, "creation_date": 1420661456, "answer_id": 27827815, "question_id": 27827384, "link": "https://stackoverflow.com/questions/27827384/why-is-cell-a1-being-used-in-this-getvalue-function-in-vba/27827815#27827815", "title": "Why is cell &quot;A1&quot; being used in this GetValue function in VBA?", "body": "<p><code>xlR1C1</code> is a <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlreferencestyle%28v=office.15%29.aspx\" rel=\"nofollow\" title=\"Reference Style\">reference style</a> which is used to specify how formulas work. When using this style, your formulas will work and look very differently than you expect. The R1C1 specification, basically means the cells are referred to differently using row &amp; column ordinals instead of letter names. For example, when using xlR1C1, you would access cell B2 by using <code>=R2C2</code> (row2, column 2). Another Example, cell C10 could be referred to as <code>=R10C3</code></p>\n\n<p>As to whats happening on line 8... you are constructing a cell reference that looks like this: (Note that your cell reference will be different because it has a file path in it)</p>\n\n<pre><code>='[Myfilename.xlsx]Sheet1'!R1C1\n</code></pre>\n\n<p>You can use the debugger to view the string contained in the <code>arg</code> variable.</p>\n"}, {"comments": [{"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "edited": false, "score": 0, "creation_date": 1420663975, "post_id": 27827942, "comment_id": 44062806, "body": "It doesn&#39;t do anything to a single cell range, but for a multi cell range (i.e. Range(&quot;C3:H99&quot;)) it returns the top left cell."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "edited": false, "score": 1, "creation_date": 1420664695, "post_id": 27827942, "comment_id": 44063180, "body": "I actually just learned that @Tmdean. <a href=\"http://stackoverflow.com/a/27828218/3198973\">stackoverflow.com/a/27828218/3198973</a>"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1420661983, "creation_date": 1420661983, "answer_id": 27827942, "question_id": 27827384, "link": "https://stackoverflow.com/questions/27827384/why-is-cell-a1-being-used-in-this-getvalue-function-in-vba/27827942#27827942", "title": "Why is cell &quot;A1&quot; being used in this GetValue function in VBA?", "body": "<p>Adding <code>Range(\"A1\")</code> to the code doesn't appear to do anything at all. Typing this into the immediate window results in some... unexpected results.</p>\n\n<pre><code>?Range(\"B3\").Range(\"A1\").Address\n$B$3\n</code></pre>\n\n<p>Now, I would have expected that to return <code>$A$1</code>, but it seems that this part of the function will return the address of <code>Range(ref)</code>. </p>\n\n<p>Now, calling <a href=\"http://msdn.microsoft.com/en-us/library/office/ff837625(v=office.15).aspx\" rel=\"nofollow\"><code>Range.Address</code></a> with the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlreferencestyle%28v=office.15%29.aspx\" rel=\"nofollow\">ReferenceStyle</a> argument would produce these results.</p>\n\n<pre><code>?Range(\"B3\").Range(\"A1\").Address(,,xlR1C1)\nR3C2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 4, "last_activity_date": 1420663473, "creation_date": 1420663473, "answer_id": 27828307, "question_id": 27827384, "link": "https://stackoverflow.com/questions/27827384/why-is-cell-a1-being-used-in-this-getvalue-function-in-vba/27828307#27828307", "title": "Why is cell &quot;A1&quot; being used in this GetValue function in VBA?", "body": "<p><code>Range().Range()</code> <a href=\"http://msdn.microsoft.com/en-us/library/office/ff834676%28v=office.15%29.aspx\" rel=\"nofollow\">Documentation here</a>:</p>\n\n<blockquote>\n  <p>When applied to a <code>Range</code> object, the property is relative to the <code>Range</code> object. For example, if the selection is cell <code>C3</code>, then <code>Selection.Range(\"B1\")</code> returns cell <code>D3</code> because it\u2019s relative to the <code>Range</code> object returned by the <code>Selection</code> property. On the other hand, the code <code>ActiveSheet.Range(\"B1\")</code> always returns cell <code>B1</code>.</p>\n</blockquote>\n\n<p>The code is using that second <code>Range(\"A1\")</code> to ensure that if you have a <code>ref</code> range larger than one cell, it only returns the top left cell of that range.  Also it would appear your other <code>Sub</code> called <code>ExecuteExcel4Macro()</code> requires an <code>R1C1</code> type cell reference so the address is being converted into that type for passing the <code>arg</code> string into the <code>Sub</code>.</p>\n"}], "owner": {"reputation": 392, "user_id": 4010409, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/25ee666bcb16433b3338091d1608cb2c?s=128&d=identicon&r=PG&f=1", "display_name": "shampouya", "link": "https://stackoverflow.com/users/4010409/shampouya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1881, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1422888100, "creation_date": 1420659827, "last_edit_date": 1422888100, "question_id": 27827384, "link": "https://stackoverflow.com/questions/27827384/why-is-cell-a1-being-used-in-this-getvalue-function-in-vba", "title": "Why is cell &quot;A1&quot; being used in this GetValue function in VBA?", "body": "<p>I'm using this function to retrieve a value from a closed workbook. In this 8th line of this code, I don't understand why \"A1\" is being used. What exactly is happening in that entire 8th line? I'm confused by the xlR1C1 argument as well.</p>\n\n<pre><code>Private Function GetValue(path, file, sheet, ref)\n\n    Dim arg As String\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetValue = \"File Not Found\"\n        Exit Function\n    End If\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _\n      Range(ref).Range(\"A1\").Address(, , xlR1C1)\n    GetValue = ExecuteExcel4Macro(arg)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "format", "decimal", "separator", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1420658949, "post_id": 27827114, "comment_id": 44060059, "body": "Tried Search-Replace? Record a macro while doing that if you want to use VBA"}, {"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1420659533, "post_id": 27827114, "comment_id": 44060381, "body": "You didn&#39;t mention your version of excel.  This may help if you go the VBA route: <a href=\"http://msdn.microsoft.com/en-us/library/office/ff195207%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 4421719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30127186a067cdb76a8d4b0484067f07?s=128&d=identicon&r=PG&f=1", "display_name": "majbanana", "link": "https://stackoverflow.com/users/4421719/majbanana"}, "edited": false, "score": 0, "creation_date": 1420660062, "post_id": 27827114, "comment_id": 44060706, "body": "I just found the solution:   =SUBSTITUTE(A1;&quot;.&quot;;&quot;,&quot;)+0    Thank you for your help."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4421719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30127186a067cdb76a8d4b0484067f07?s=128&d=identicon&r=PG&f=1", "display_name": "majbanana", "link": "https://stackoverflow.com/users/4421719/majbanana"}, "edited": false, "score": 0, "creation_date": 1420660031, "post_id": 27827291, "comment_id": 44060682, "body": "Thank you, but system separators not working. I just found the solution: =SUBSTITUTE(A1;&quot;.&quot;;&quot;,&quot;)+0"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1420659921, "last_edit_date": 1420659921, "creation_date": 1420659474, "answer_id": 27827291, "question_id": 27827114, "link": "https://stackoverflow.com/questions/27827114/excel-separator-point-change-to-decimal-places/27827291#27827291", "title": "Excel Separator point change to decimal places", "body": "<p>You can either change the <strong>system separators</strong> or make a local change by going to the <em>Advanced</em> section of Excel Options, clear <strong>use system separators</strong> and pick your own:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Mao2z.png\" alt=\"enter image description here\"></p>\n\n<p>If you want to change on certain cells in the worksheet, you would need a <strong>macro</strong></p>\n"}], "owner": {"reputation": 1, "user_id": 4421719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30127186a067cdb76a8d4b0484067f07?s=128&d=identicon&r=PG&f=1", "display_name": "majbanana", "link": "https://stackoverflow.com/users/4421719/majbanana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420659921, "creation_date": 1420658795, "last_edit_date": 1531161705, "question_id": 27827114, "link": "https://stackoverflow.com/questions/27827114/excel-separator-point-change-to-decimal-places", "title": "Excel Separator point change to decimal places", "body": "<p>I apologize in advance for my english is not perfect.</p>\n\n<p>I have a web query more than 400 value and the data show in table $20.49.\nI would like import an other table, but I would like if show the value $20,49.\nI tried all cell format, but it is not change.\nColumn is C3:C459.</p>\n\n<p>I think macro resolve this problem, but I can not write.\nI would like change \".\" ---> \",\"   (20.49 --> 20,49)\nCould you help me?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1420657623, "post_id": 27826625, "comment_id": 44059335, "body": "You don&#39;t appear to be looping through your items. Where is your definition and assignment of variables i and oItems? Also, why are you using a function if you are not returning any value?"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1420659432, "post_id": 27826625, "comment_id": 44060331, "body": "This is the function I am calling from my main procedure within the loop. It fires whenever the loop in the main function finds an email that fits within the designated criteria. The variables are all defined (oItems is a Private variable.) I&#39;ll put the main procedure up here as well."}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1420661357, "post_id": 27827576, "comment_id": 44061382, "body": "Works great, I&#39;m self-taught and mostly use vb for Excel. Just for future reference, if you do not store the referenced item as a single object, each line is instead read as a separate object?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1420689161, "post_id": 27827576, "comment_id": 44071018, "body": "Do you mean if you keep calling &quot;oItems.Item(i)&quot;? Yes, you will get a brand new COM object each time even though it happens to refer to the same Outlook message. But since the messages are transacted (MailItem.Save is required), the changes will never be saved in case of multiple dot notation."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1420660554, "creation_date": 1420660554, "answer_id": 27827576, "question_id": 27826625, "link": "https://stackoverflow.com/questions/27826625/how-to-pass-items-to-a-function-to-set-categories/27827576#27827576", "title": "How to pass items to a function to set categories?", "body": "<p>This is multiple dot notation taken to its extreme - the following code sets Unread property on one object and calls Save on a completely different object that has no idea about anything else your code has previously done.</p>\n\n<pre><code>oItems.Item(i).UnRead = False\noItems.Item(i).Save\n</code></pre>\n\n<p>Do not use multiple dot notation and do not make i a global variable - pass the object as a parameter</p>\n\n<pre><code>Function MoveSort(olDestination As Outlook.Folder, Item as Object)\nDim StCategory\nIf Item.Categories = \"\" Then\n    Item.Categories = \"Category\"\nEnd If\n\nItem.UnRead = False\nItem.Save\nItem.Move olDestination\nEnd Function\n\n...\nDim Item as Object\nFor i = oItems.Count To 1 Step -1\n    set Item = oItems.Item(i)\n    SEmail = Item.SenderEmailAddress\n    SSubject = Item.Subject\n    If SEmail = \"Email1@email..com\" Or SSubject = \"Sample Subject 1\" Or _\n        Left(SSubject, 16) = \"Sample Subject 2\" Then\n\n        MoveSort oStock, Item\n\n    ElseIf SEmail = \"Email2@email.com\" Then\n\n        MoveSort oBStock, Item\n\n    ElseIf SEmail = \"Email3@email.com\" Then\n\n        MoveSort oCStock, Item\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 27827576, "answer_count": 1, "score": 0, "last_activity_date": 1596818641, "creation_date": 1420657009, "last_edit_date": 1596818641, "question_id": 27826625, "link": "https://stackoverflow.com/questions/27826625/how-to-pass-items-to-a-function-to-set-categories", "title": "How to pass items to a function to set categories?", "body": "<p>I am building a function to sort a number of automated messages received daily in a shared email inbox. I use a loop to go through each mail message in the inbox and an IF statement to filter/sort messages and then run this function:</p>\n<pre><code>Function MoveSort(olDestination As Outlook.Folder)\n    Dim StCategory\n    If oItems.Item(i).Categories = &quot;&quot; Then\n        oItems.Item(i).Categories = &quot;Category&quot;\n    End If\n\n    oItems.Item(i).UnRead = False\n    oItems.Item(i).Save\n    oItems.Item(i).Move olDestination\nEnd Function\n</code></pre>\n<p>The Category is usually not getting assigned. (Sometimes it will seemingly randomly assign it to the first or last message.)</p>\n<p>This is the main procedure:</p>\n<pre><code>Private i As Integer\nPrivate oItems As Outlook.Items\n\nSub OrganizeIt()\n    Dim oNS As Outlook.NameSpace\n    Dim oInbox As Outlook.Folder\n    Dim oBStock As Outlook.Folder\n    Dim oCStock As Outlook.Folder\n    Dim oStock As Outlook.Folder\n    Dim SEmail As String\n    Dim SSubject As String\n\n    Set oNS = Application.GetNamespace(&quot;MAPI&quot;)\n    Set oInbox = oNS.folders(&quot;HelpDeskEmail&quot;).folders(&quot;Inbox&quot;)\n    Set oItems = oInbox.Items\n    Set oCStock = oInbox.folders(&quot;Folder1&quot;)\n    Set oBStock = oInbox.folders(&quot;Folder2&quot;)\n\n    For i = oItems.Count To 1 Step -1\n        SEmail = oItems.Item(i).SenderEmailAddress\n        SSubject = oItems.Item(i).Subject\n        If SEmail = &quot;Email1@email.com&quot; Or SSubject = &quot;Sample Subject 1&quot; Or _\n            Left(SSubject, 16) = &quot;Sample Subject 2&quot; Then\n            \n            MoveSort oStock\n\n        ElseIf SEmail = &quot;Email2@email.com&quot; Then\n\n            MoveSort oBStock\n\n        ElseIf SEmail = &quot;Email3@email.com&quot; Then\n\n            MoveSort oCStock\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["email", "excel", "vba"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1420658060, "post_id": 27826618, "comment_id": 44059570, "body": "Define &quot;can&#39;t seem to get it working&quot;. What result do you get, and how does that differ from the expected result? Do you get an error? What does it say? Also, please reduce that wall of code to a smaller sample that still demonstrates the problem."}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1420671723, "post_id": 27826618, "comment_id": 44066404, "body": "Oh sorry, so the problem is that it only dispatches one email for the first target row (2nd row) and missed the the rest of the other rows."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1420674034, "post_id": 27826618, "comment_id": 44067206, "body": "That is most likely due to the <code>Exit Sub</code> at the end of the inner loop."}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1420723204, "post_id": 27826618, "comment_id": 44085785, "body": "Great Spot, Thanks Ansgar"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1420728055, "post_id": 27826618, "comment_id": 44089051, "body": "Does that solve your problem, or does the code still not work as expected?"}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1420763093, "post_id": 27826618, "comment_id": 44107917, "body": "Yes it does. Cheers Ansgar"}], "answers": [{"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 0, "last_activity_date": 1420976573, "creation_date": 1420976573, "answer_id": 27886637, "question_id": 27826618, "link": "https://stackoverflow.com/questions/27826618/loop-subroutine-for-every-used-row-using-multiple-dynamic-cell-references/27886637#27886637", "title": "Loop subroutine for every used row using multiple dynamic cell references", "body": "<p>There is an <code>Exit Sub</code> at the end of your inner loop that makes the code exit from the procedure after the first iteration:</p>\n\n<pre><code>Sub TestEmail1()\n  ...\n  For Each c In ActiveSheet.UsedRange.Columns(\"A\").Cells\n    ...\n    For i = 2 To LRow\n      ...\n      <b>Exit Sub</b>\n    Next i\n  Next c\nEnd Sub</code></pre>\n\n<p>Remove it and processing should continue as desired.</p>\n"}], "owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 27886637, "answer_count": 1, "score": -1, "last_activity_date": 1420976573, "creation_date": 1420656982, "last_edit_date": 1531164843, "question_id": 27826618, "link": "https://stackoverflow.com/questions/27826618/loop-subroutine-for-every-used-row-using-multiple-dynamic-cell-references", "title": "Loop subroutine for every used row using multiple dynamic cell references", "body": "<p>Basically what I am trying to do is, sending an email for every used row on the target worksheet, each row has the details of the addresses, subject line, table with values etc.</p>\n\n<p>So I can't seem to get it working, as it only dispatches one email from the first target row (2nd row).</p>\n\n<p>I have tried using a combination of <code>For Each</code> and <code>For i = 1 to LR</code> which aren't working. I suspect it is to do with the cell references.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub TestEmail1()\n  Application.ScreenUpdating = False\n\n    Dim aOutlook As Object\n    Dim aEmail As Object\n    Dim rngeAddresses As Range, rngeCell As Range, strRecipients As String\n    Dim ccAddresses As Range, ccCell As Range, ccRecipients As String\n    Dim rngeSubject As Range, SubjectCell As Range, SubjectContent As Variant\n    Dim rngeBody As Range, bodyCell As Range, bodyContent As Variant\n    Dim Table1 As Range\n    Dim i As Integer\n\n    For Each c In ActiveSheet.UsedRange.Columns(\"A\").Cells\n      Set rng = ActiveSheet.UsedRange\n      LRow = rng.Rows.Count\n      For i = 2 To LRow\n        Set Table1 = Worksheets(1).Range(\"K1:R1\")\n        Set Table2 = Worksheets(2).Range(\"K\" &amp; i &amp; \":\" &amp; \"R\" &amp; i)\n        Set aOutlook = CreateObject(\"Outlook.Application\")\n        Set aEmail = aOutlook.CreateItem(0)\n\n        'set sheet to find address for e-mails as I have several people to\n        'mail to\n\n        Set rngeAddresses = ActiveSheet.Range(\"B\" &amp; i)\n        For Each rngeCell In rngeAddresses.Cells\n          strRecipients = strRecipients &amp; \";\" &amp; rngeCell.Value\n        Next\n\n        Set ccAddresses = ActiveSheet.Range(\"C\" &amp; i)\n        For Each ccCell In ccAddresses.Cells\n          ccRecipients = ccRecipients &amp; \";\" &amp; ccCell.Value\n        Next\n\n        Set rngeSubject = ActiveSheet.Range(\"D\" &amp; i)\n        For Each SubjectCell In rngeSubject.Cells\n          SubjectContent = SubjectContent &amp; SubjectCell.Value\n        Next\n\n        Set rngeBody = ActiveSheet.Range(\"E\" &amp; i)\n        For Each bodyCell In rngeBody.Cells\n          bodyContent = bodyContent &amp; bodyCell.Value\n        Next\n\n        'set Importance\n        'aEmail.Importance = 2\n        'Set Subject\n        aEmail.Subject = rngeSubject\n        'Set Body for mail\n        'aEmail.Body = bodyContent\n        aEmail.HTMLBody = bodyContent &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\" &amp; RangetoHTML_   (Table1)            \n        aEmail.To = strRecipients\n        aEmail.CC = ccRecipients\n        aEmail.Send\n        Exit Sub\n      Next i\n    Next c\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 846, "user_id": 2551655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98da58fe7b513d8b450a38598826aa31?s=128&d=identicon&r=PG", "display_name": "114", "link": "https://stackoverflow.com/users/2551655/114"}, "edited": false, "score": 0, "creation_date": 1420652910, "post_id": 27825195, "comment_id": 44056641, "body": "Is the value &quot;Dollars Spent&quot; always in the same column?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420653896, "post_id": 27825195, "comment_id": 44057217, "body": "You can use <code>Find()</code> to locate the cell label, then offset from there."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1420655507, "post_id": 27825195, "comment_id": 44058091, "body": "<b>Are the sheets in a single file or in different files??</b>"}, {"owner": {"reputation": 27, "user_id": 4429900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e09a6b40a454817daf21293f614e52?s=128&d=identicon&r=PG&f=1", "display_name": "Excel Noob", "link": "https://stackoverflow.com/users/4429900/excel-noob"}, "edited": false, "score": 0, "creation_date": 1423768931, "post_id": 27825195, "comment_id": 45293748, "body": "The sheets are all in different files. I have a function that will repeatively open the sheets"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4429900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e09a6b40a454817daf21293f614e52?s=128&d=identicon&r=PG&f=1", "display_name": "Excel Noob", "link": "https://stackoverflow.com/users/4429900/excel-noob"}, "edited": false, "score": 0, "creation_date": 1423769315, "post_id": 27826571, "comment_id": 45293991, "body": "Thanks for the help. I have copied what I have to build on below. This should provide a lot more detail on what I am trying to do"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1420656757, "creation_date": 1420656757, "answer_id": 27826571, "question_id": 27825195, "link": "https://stackoverflow.com/questions/27825195/pulling-data-from-100s-of-diiferent-excel-workbooks-into-one-workbook/27826571#27826571", "title": "Pulling data from 100s of diiferent excel Workbooks into one workbook", "body": "<p>This assumes that:</p>\n\n<ol>\n<li>all the sheets are in a single book</li>\n<li>sheet #1 will record the gathered data</li>\n<li>column <strong>A</strong> will contain the sheet name</li>\n<li>column <strong>B</strong> will contain the gathered value</li>\n</ol>\n\n<p>Run this small macro:</p>\n\n<pre><code>Sub FindingDollarsSpent()\n    Dim i As Long\n    Dim l As Long\n    l = 1\n    For i = 2 To Sheets.Count\n        For Each r In Sheets(i).UsedRange\n            If r.Value = \"Dollars spent\" Then\n                With Sheets(1)\n                    .Cells(l, 1).Value = Sheets(i).Name\n                    .Cells(l, 2).Value = r.Offset(0, 1).Value\n                End With\n                l = l + 1\n            End If\n        Next r\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4429900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e09a6b40a454817daf21293f614e52?s=128&d=identicon&r=PG&f=1", "display_name": "Excel Noob", "link": "https://stackoverflow.com/users/4429900/excel-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 27826571, "answer_count": 1, "score": 0, "last_activity_date": 1539733511, "creation_date": 1420652070, "last_edit_date": 1539733511, "question_id": 27825195, "link": "https://stackoverflow.com/questions/27825195/pulling-data-from-100s-of-diiferent-excel-workbooks-into-one-workbook", "title": "Pulling data from 100s of diiferent excel Workbooks into one workbook", "body": "<p>I am trying to pull certain data from multiple excel spreadsheets. I am trying to consolidate data from literally 100s of similar excel sheets. I want to write a Macro that will allow me to select the excel spreadsheets then will pull the desired data from a given variable name. </p>\n\n<p>This is what I have</p>\n\n<pre><code>Public Sub CommandButton1_Click()\n\n' Record job, modular code, multiple customers.\n\n    Dim counter As Integer\n    Dim PadPercentage As Single\n    Dim Charactercounter As Integer\n    Dim Date1 As String\n    Dim Date2 As String\n    Dim fd As FileDialog\n    Dim vrtSelectedItem As Variant\n    Dim Designcounter As Integer\n    Dim Customer As String\n    Dim Chemicals As String\n    Dim Chemcounter As Integer\n    Dim column As String\n    Dim Sand As Integer\n    Dim FindRow As Range\n\n\n\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    Designcounter = -1\n\n\n    With fd\n\n        If .Show = -1 Then\n\n            For Each vrtSelectedItem In .SelectedItems\n                Designcounter = Designcounter + 1\n                Workbooks.Open Filename:=vrtSelectedItem\n                Sheets(\"Interval Summary\").Select\n                counter = 4\n                Charactercounter = 1\n\n\n'   Find and Copy date from Interval Summary.\n\n                    Set FindRow = Cells.Find(What:=\"Date:\", LookAt:=xlPart)\n                    FindRow.Select\n                    ActiveCell.Offset(0, 3).Select\n                    Selection.Copy\n\n                Windows(\"2014 GJ PE Engineering Job Logs - Iteration 2.xls\").Activate\n                Range(\"A\" &amp; CStr(counter)).Select\n\n\n'   Search for first blank cell in column A.\n                Do While ActiveCell.Value &lt;&gt; \"\"\n                    counter = counter + 1\n                    Range(\"A\" &amp; CStr(counter)).PasteSpecial xlPasteValuesAndNumberFormats\n                Loop\n\n'   Paste date onto job recording sheet.\n                Range(\"A\" &amp; CStr(counter)).Select\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n                Selection.UnMerge\n                Selection.NumberFormat = \"m/d/yyyy\"\n\n' Record previous engineer name on job recording sheet.\n                Range(\"B\" &amp; CStr(counter - 1)).Select\n                Selection.Copy\n                Range(\"B\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n'   Copy customer name onto reporting sheet.\n                ActiveWindow.ActivatePrevious\n                Worksheets(\"Actual Design\").Range(\"C1\").Select\n                Customer = ActiveCell.Value\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"E\" &amp; CStr(counter)).Select\n                ActiveSheet.Paste\n\n'   Paste SO from design onto recording sheet.\n                ActiveWindow.ActivateNext\n                If Customer = \"Noble Energy Inc.\" Then\n                    Worksheets(\"Design\").Range(\"O1\").Select\n                Else\n                    Worksheets(\"Design\").Range(\"Q1\").Select\n                End If\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"C\" &amp; CStr(counter)).Select\n                ActiveSheet.Paste\n                Selection.UnMerge\n\n\n    Call Lease_Pad_Well_Copy(Customer, counter)\n\n\n\n'   Find and Copy Interval # from Well Data\n                With Worksheets(\"Well Data\")\n                    Set FindRow = .Range(\"B:B\").Find(What:=\"Date\", LookIn:=xlValues)\n                Windows(\"2014 GJ PE Engineering Job Logs.xls\").Activate\n                Range(\"A\" &amp; CStr(counter)).Select\n                End With\n\n\n'   Copy mid perf depth to reporting sheet.\n\n                Worksheets(\"Actual\").Range(\"C40\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"I\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\n'   Copy mid perf depth TVD to reporting sheet.\n\n                Worksheets(\"Actual\").Range(\"C40\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"I\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\n'   Copy Top perf depth to reporting sheet.\n\n                Worksheets(\"Actual\").Range(\"C40\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"I\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\n'   Copy Bottom perf depth to reporting sheet.\n\n                Worksheets(\"Actual\").Range(\"C40\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"I\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\n'   Copy formation name to reporting sheet.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"C3\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"J\" &amp; CStr(counter)).Select\n                ActiveSheet.Paste\n\n\n'   Copy fluid system.\n                Range(\"K\" &amp; CStr(counter - 1)).Select\n                Selection.Copy\n                Range(\"K\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n'   Copy crew from previous job.\n                Range(\"L\" &amp; CStr(counter - 1)).Select\n                Selection.Copy\n                Range(\"L\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    If Customer = \"Williams Prod RMT\" Or Customer = \"Chevron\" Then\n        Call Copy_Williams_Data(Customer, counter)\n    End If\n\n    If Customer = \"Noble Energy Inc.\" Then\n        Call Copy_Noble_Data(Customer, counter)\n    End If\n\n    If Customer = \"Bill Barrett Corp.\" Then\n        Call Copy_BBC(Customer, counter)\n    End If\n\n'   Copy slurry volume\n\n                If Customer = \"Williams Prod RMT\" Then\n                    ActiveWindow.ActivateNext\n                    Sheets(\"Actuals\").Select\n                    Worksheets(\"Actuals\").Range(\"H30\").Select\n                    Selection.Copy\n                Else\n                    ActiveWindow.ActivateNext\n                    Sheets(\"Design\").Select\n                    Worksheets(\"Design\").Range(\"H30\").Select\n                    Selection.Copy\n                End If\n                    ActiveWindow.ActivatePrevious\n                    Range(\"S\" &amp; CStr(counter)).Select\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                        :=False, Transpose:=False\n\n\n\n    '   Copy chemicals from design to Job recording sheet.\n                ActiveWindow.ActivateNext\n                Chemcounter = 78\n                column = Chr(Chemcounter)\n                Sheets(\"Well Data\").Select\n                Worksheets(\"Design\").Range(column &amp; \"5\").Select\n                Do While ActiveCell.Value &lt;&gt; \"\"\n                    If Chemcounter &lt; 79 Then Chemicals = ActiveCell.Value\n                    If Chemcounter &gt; 78 Then Chemicals = Chemicals &amp; \", \" &amp; ActiveCell.Value\n                    Chemcounter = Chemcounter + 1\n                    column = Chr(Chemcounter)\n                    Worksheets(\"Well Data\").Range(column &amp; \"5\").Select\n                Loop\n                ActiveWindow.ActivatePrevious\n                Range(\"P\" &amp; CStr(counter)).Select\n                ActiveCell.Value = Chemicals\n\n\n\n'   Switch back to and close design\n                ActiveWindow.ActivateNext\n                ActiveWorkbook.Save\n                ActiveWindow.Close\n\n            Next vrtSelectedItem\n        End If\n    End With\n\n'   Format job log entries.\n                ActiveWindow.ActivatePrevious\n                Range(\"A\" &amp; CStr(counter - Designcounter) &amp; \":AE\" &amp; CStr(counter)).Select\n                Application.CutCopyMode = False\n                With Selection.Font\n                    .Name = \"Arial\"\n                    .Size = 10\n                    .Strikethrough = False\n                    .Superscript = False\n                    .Subscript = False\n                    .OutlineFont = False\n                    .Shadow = False\n                    .Underline = xlUnderlineStyleNone\n                    .ColorIndex = xlAutomatic\n                End With\n                Selection.Font.Bold = False\n                Rows(CStr(counter) &amp; \":\" &amp; CStr(counter)).Select\n                Selection.RowHeight = 13.5\n\n\n\nEnd Sub\n\n\n\nSub Lease_Pad_Well_Copy(Customer, counter)\n\n    Dim Wellstrng As String\n    Dim Pad As String\n    Dim Wellpad As String\n    Dim Lease As String\n    Dim Well As String\n\n\n\n    If Customer = \"Williams Prod RMT\" Or Customer = \"Chevron\" Or Customer = \"Noble Energy Inc.\" Or Customer = \"Bill Barrett Corp.\" Then\n    '   Sort lease, well, and pad number and copy to reporting sheet.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"C2\").Select\n                If ActiveCell.Value &lt;&gt; \"\" Then\n                    Wellstrng = ActiveCell.Value\n                    Lease = Left(Wellstrng, CLng(InStr(Wellstrng, \" \")) - 1)\n                    Pad = Right(Wellstrng, Len(Wellstrng) - CLng(InStrRev(Wellstrng, \"-\")))\n                    Wellpad = Left(Wellstrng, CLng(InStr(Wellstrng, \"-\")) - 1)\n                    Well = Right(Wellpad, Len(Wellpad) - CLng(InStrRev(Wellpad, \" \")))\n\n\n\n                    If Customer = \"Noble Energy Inc.\" Then\n\n                        Wellstrng = ActiveCell.Value\n                        Lease = Left(Wellstrng, CLng(InStr(Wellstrng, \" \")) - 1)\n                        Wellpad = Right(Wellstrng, Len(Wellstrng) - CLng(InStr(Wellstrng, \" \")))\n                        Wellpad = Left(Wellpad, Len(Wellpad) - CLng(InStrRev(Wellpad, \" -\")))\n                        Pad = Left(Wellpad, CLng(InStr(Wellpad, \"-\")) - 1)\n                        Wellpad = Left(Wellstrng, CLng(InStr(Wellstrng, \" -\")) - 1)\n                        Well = Right(Wellpad, Len(Wellpad) - CLng(InStrRev(Wellpad, \"-\")))\n\n                    End If\n\n                    If Customer = \"Bill Barrett Corp.\" Then\n                        Wellstrng = ActiveCell.Value\n                        Lease = Left(Wellstrng, CLng(InStr(Wellstrng, \" \")) - 1)\n                        Pad = Right(Wellstrng, Len(Wellstrng) - CLng(InStr(Wellstrng, \"-\")))\n                        Wellpad = Left(Wellstrng, CLng(InStr(Wellstrng, \"-\")) - 1)\n                        Well = Right(Wellpad, Len(Wellpad) - CLng(InStrRev(Wellpad, \" \")))\n                    End If\n\n\n\n                    ActiveWindow.ActivatePrevious\n\n\n\n    '   Copy lease name onto reporting sheet.\n                    Range(\"F\" &amp; CStr(counter)).Select\n                    ActiveCell.Value = Lease\n\n    '   Copy well number onto reporting sheet.\n                    Range(\"G\" &amp; CStr(counter)).Select\n                    ActiveCell.Value = Well\n\n    '   Copy pad onto reporting sheet.\n                    Range(\"H\" &amp; CStr(counter)).Select\n                    ActiveCell.Value = Pad\n                    ActiveWindow.ActivateNext\n                End If\n\n    End If\n\n\nEnd Sub\n\n\n\n\nSub Copy_BBC(Customer, counter)\n\n    Dim Twosands As String\n    Dim Sandint As Integer\n\n    '   Copy average rate\n            ActiveWindow.ActivateNext\n            Sheets(\"Database\").Select\n            Worksheets(\"Database\").Range(\"B16\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"M\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy average pressure\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"B17\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"N\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy perfs open.\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"G18\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"W\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy actual sand\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"B26\").Select\n            Twosands = ActiveCell.Value\n            Twosands = Twosands &amp; \" / \"\n            Worksheets(\"Database\").Range(\"B28\").Select\n            Twosands = Twosands &amp; ActiveCell.Value\n            ActiveWindow.ActivatePrevious\n            Range(\"Q\" &amp; CStr(counter)).Select\n            ActiveCell.Value = Twosands\n\n\n    '   Copy initial frac gradient\n            ActiveWindow.ActivateNext\n            Sheets(\"Database\").Select\n            Worksheets(\"Database\").Range(\"B21\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"V\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy final frac gradient\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"B23\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"Y\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISIP\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"B20\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"U\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISDP\n            ActiveWindow.ActivateNext\n            Worksheets(\"Database\").Range(\"B22\").Select\n            Selection.Copy\n            ActiveWindow.ActivatePrevious\n            Range(\"X\" &amp; CStr(counter)).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\n\nEnd Sub\n\nSub Copy_Williams_Data(Customer, counter)\n\n\n    '   Copy average rate to reporting sheet.\n                ActiveWindow.ActivateNext\n                Sheets(\"Actuals\").Select\n                Worksheets(\"Actuals\").Range(\"G63\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"M\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy average pressure to reporting sheet.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"F63\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"N\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy perfs open.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"D64\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"W\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy actual sand\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"D65\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"Q\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy initial frac gradient\n                ActiveWindow.ActivateNext\n                Sheets(\"Actuals\").Select\n                Worksheets(\"Design\").Range(\"D61\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"V\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy final frac gradient\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"D63\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"Y\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISIP\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"D60\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"U\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISDP\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actuals\").Range(\"D62\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"X\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\nEnd Sub\n\nSub Copy_Noble_Data(Customer, counter)\n\n    Dim SandColor As String\n    Dim Sieve As String\n    Dim Sandtemp As String\n    Dim Sandtype As String\n\n    '   Copy average rate to reporting sheet.\n                ActiveWindow.ActivateNext\n                Sheets(\"Actuals Design\").Select\n                Worksheets(\"Actual Design\").Range(\"H63\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"M\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy average pressure to reporting sheet.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actual Design\").Range(\"H62\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"N\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n   '   Copy Total perfs open.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Actual Design\").Range(\"E65\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"W\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n     '   Copy actual sand.\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"M61\").Select\n                Greensand = ActiveCell.Value\n                Worksheets(\"Design\").Range(\"M60\").Select\n                Whitesand = ActiveCell.Value &amp; \" / \"\n                Combinedsand = Whitesand &amp; Greensand\n                ActiveWindow.ActivatePrevious\n                Range(\"Q\" &amp; CStr(counter)).Select\n                ActiveCell.Value = Combinedsand\n\n\n      '   Copy initial frac gradient\n                ActiveWindow.ActivateNext\n                Sheets(\"Interval Summart\").Select\n                Worksheets(\"Design\").Range(\"E64\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"V\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy final frac gradient\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"H65\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"Y\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISIP\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"E63\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"U\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n    '   Copy ISDP\n                ActiveWindow.ActivateNext\n                Worksheets(\"Design\").Range(\"H64\").Select\n                Selection.Copy\n                ActiveWindow.ActivatePrevious\n                Range(\"X\" &amp; CStr(counter)).Select\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                    :=False, Transpose:=False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel"], "comments": [{"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420651790, "post_id": 27824936, "comment_id": 44056010, "body": "Why not just use Exit For to jump out of the loop early when you need to?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 1, "creation_date": 1420651965, "post_id": 27824936, "comment_id": 44056120, "body": "@KevenDenen The original purpose of this test was to see if you were copying data over from one sheet to another in that new sheet&#39;s <code>LastRow</code> if you could use the same <code>LastRow</code> variable.  My original theory was that changing it mid-loop with actually create an infinite loop: Copy Row 1 in Sheet1 to Row 2 in Sheet 2, <code>LastRow</code> becomes 2, <code>Next</code> changes <code>CurRow</code> to 2 which fits so <code>Loop</code> continues.  This would technically create an infinite loop. <a href=\"http://stackoverflow.com/a/27825010/4241535\">But documentation proved otherwise.</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420656911, "post_id": 27824936, "comment_id": 44058933, "body": "It&#39;s typically considered bad practise to alter any of the counters inside of a <code>For...Next</code> loop: if you need this type of approach then a <code>While</code>-type loop is the preferred approach."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1420656984, "post_id": 27824936, "comment_id": 44058973, "body": "@TimWilliams I&#39;m talking specifically about <code>&lt;end-value&gt;</code> which apparently cannot be changed per the answers."}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 4, "last_activity_date": 1420652361, "last_edit_date": 1420652361, "creation_date": 1420651412, "answer_id": 27825010, "question_id": 27824936, "link": "https://stackoverflow.com/questions/27824936/for-start-to-end-loop-with-end-variable-changing-mid-loop/27825010#27825010", "title": "For start To end Loop with end Variable Changing Mid-Loop", "body": "<p>Given that the <a href=\"http://msdn.microsoft.com/en-us/library/ee157012.aspx\" rel=\"nofollow\">Correct MSDN Reference</a> mentions:</p>\n\n<blockquote>\n  <p>The expressions <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code> are evaluated once, in order, and prior to any of the following computations.</p>\n</blockquote>\n\n<p>It appears that Visual Basic <strong>CAN</strong> remember the value of the <code>end</code> during the loop even if the variable containing the <code>end</code> amount changes.</p>\n"}, {"tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": false, "score": 1, "last_activity_date": 1420654311, "last_edit_date": 1420654311, "creation_date": 1420652075, "answer_id": 27825199, "question_id": 27824936, "link": "https://stackoverflow.com/questions/27824936/for-start-to-end-loop-with-end-variable-changing-mid-loop/27825199#27825199", "title": "For start To end Loop with end Variable Changing Mid-Loop", "body": "<p>Building on @Chrismas007's answer above, if you want to short-circuit the loop within the confines of the <code>For</code> structure, you can just set the incremented variable to the terminating value:</p>\n\n<pre><code>For CurRow = 1 To LastRow\n    Range(\"B\" &amp; CurRow).Value = \"Done\"\n\n    ' This will end the loop.\n    ' When Next is hit, CurRow will be LastRow + 1.\n    CurRow = LastRow\n\n    ' Alternately, you can exit the for loop immediately.\n    ' Usually this would be inside an If statement.\n    Exit For\nNext CurRow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 3, "last_activity_date": 1420676386, "last_edit_date": 1420676386, "creation_date": 1420652139, "answer_id": 27825211, "question_id": 27824936, "link": "https://stackoverflow.com/questions/27824936/for-start-to-end-loop-with-end-variable-changing-mid-loop/27825211#27825211", "title": "For start To end Loop with end Variable Changing Mid-Loop", "body": "<p>I'd like to note a few things here. First, you're referencing the <strong>VB.Net</strong> documentation. So, I wouldn't rely on that when talking about <em>VBA</em>. In fact, the <a href=\"http://msdn.microsoft.com/en-us/library/office/gg251601(v=office.15).aspx\" rel=\"nofollow\">VBA Documentation for the <code>For...Next</code> statement</a> doesn't mention this behavior at all. So, I dug a little deeper and VBA does indeed behave the same as VB.Net here. The following is from the <a href=\"http://msdn.microsoft.com/en-us/library/ee157012.aspx\" rel=\"nofollow\">[MS-VBAL]: VBA Language Specification</a>.</p>\n\n<blockquote>\n  <p>The expressions <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code> are evaluated <strong><em>once</em></strong>, in order, and prior to any of the following computations. </p>\n</blockquote>\n\n<p>This means that <code>LastRow</code> in your example is only calculated when first entering the loop. Changing it afterward has no effect on the number of times the loop will run. (Not that I advise trying to do that to begin with.)</p>\n\n<p>This also means that you can not change the size of the steps the loop takes mid-execution as well and this snippet shows the \"odd\" behavior of both of these at once.</p>\n\n<pre><code>Sub TestLoop()\n\n    Dim LastRow As Long, CurRow As Long, StepsToTake As Integer\n    LastRow = 100\n    StepsToTake = 2\n\n    For CurRow = 1 To LastRow Step StepsToTake\n        Range(\"B\" &amp; CurRow).Value = \"Done\"\n        LastRow = 2\n        StepsToTake = 1\n    Next CurRow\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>For those interested, here are the entire runtime semantics of the <code>For...Next</code> statement.</p>\n\n<blockquote>\n  <p><strong>Runtime Semantics.</strong></p>\n  \n  <ul>\n  <li><p>The expressions <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code> are evaluated once, in order, and prior to any of\n  the following computations. If the value of <code>&lt;start-value&gt;</code>,\n  <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code> are not Let-coercible to Double,\n  error 13 (Type mismatch) is raised immediately. Otherwise, proceed\n  with the following algorithm using the original, uncoerced values.</p></li>\n  <li><p>Execution of the <code>&lt;for-statement&gt;</code> proceeds according to the following algorithm:</p>\n  \n  <ol>\n  <li><p>If the data value of <code>&lt;step-increment&gt;</code> is zero or a positive number, and the value of <code>&lt;bound-variable-expression&gt;</code> is greater than\n  the value of <code>&lt;end-value&gt;</code>, then execution of the <code>&lt;forstatement&gt;</code>\n  immediately completes; otherwise, advance to Step 2.</p></li>\n  <li><p>If the data value of <code>&lt;step-increment&gt;</code> is a negative number, and the value of <code>&lt;bound-variable-expression&gt;</code> is less than the value\n  of <code>&lt;end-value&gt;</code>, execution of the <code>&lt;for-statement&gt;</code> immediately\n  completes; otherwise, advance to Step 3.</p></li>\n  <li><p>The <code>&lt;statement-block&gt;</code> is executed. If a <code>&lt;nested-for-statement&gt;</code> is present, it is then executed. Finally, the\n  value of <code>&lt;bound-variable-expression&gt;</code> is added to the value of\n  <code>&lt;step-increment&gt;</code> and Let-assigned back to\n  <code>&lt;bound-variable-expression&gt;</code>. Execution then repeats at step 1.</p></li>\n  </ol></li>\n  <li><p>If a <code>&lt;goto-statement&gt;</code> defined outside the <code>&lt;for-statement&gt;</code> causes a <code>&lt;statement&gt;</code> within <code>&lt;statement-block&gt;</code> to be executed, the\n  expressions <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code> are\n  not evaluated. If execution of the <code>&lt;statement-block&gt;</code> completes and\n  reaches the end of the <code>&lt;statement-block&gt;</code> without having evaluated\n  <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code> and <code>&lt;step-increment&gt;</code> during this\n  execution of the enclosing procedure, an error is generated (number\n  92, \"For loop not initialized\"). This occurs even if \n  contains an assignment expression that initializes\n  <code>&lt;bound-variable-expression&gt;</code> explicitly. Otherwise, if the\n  expressions <code>&lt;start-value&gt;</code>, <code>&lt;end-value&gt;</code>, and <code>&lt;step-increment&gt;</code>\n  have already been evaluated, the algorithm continues at Step 3\n  according to the rules defined for execution of a <code>&lt;for-statement&gt;</code>.</p></li>\n  <li><p>When the <code>&lt;for-statement&gt;</code> has finished executing, the value of <code>&lt;bound-variable-expression&gt;</code> remains at the value it held as of the\n  loop completion.</p></li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6022, "favorite_count": 0, "accepted_answer_id": 27825211, "answer_count": 3, "score": 3, "last_activity_date": 1422888235, "creation_date": 1420651090, "last_edit_date": 1592644375, "question_id": 27824936, "link": "https://stackoverflow.com/questions/27824936/for-start-to-end-loop-with-end-variable-changing-mid-loop", "title": "For start To end Loop with end Variable Changing Mid-Loop", "body": "<p>Starting with test data:</p>\n<p><img src=\"https://i.stack.imgur.com/q8n5U.png\" alt=\"Start\" /></p>\n<p>And running the code:</p>\n<pre><code>Sub TestLoop()\n\nDim LastRow As Long, CurRow As Long\nLastRow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n\nFor CurRow = 1 To LastRow\n    Range(&quot;B&quot; &amp; CurRow).Value = &quot;Done&quot;\n    LastRow = 2\nNext CurRow\n\nEnd Sub\n</code></pre>\n<p>I would expect the Loop to end at Row 2 because I changed the variable <code>LastRow</code>.  However the result is:</p>\n<p><img src=\"https://i.stack.imgur.com/UxDZj.png\" alt=\"Done\" /></p>\n<p>The <a href=\"http://msdn.microsoft.com/en-us/library/5z06z1kb.aspx\" rel=\"nofollow noreferrer\">MSDN Reference <strong>FOR VB.NET</strong> has this to say</a>:</p>\n<blockquote>\n<p>When a <code>For...Next</code> loop starts, Visual Basic evaluates <code>start</code>, <code>end</code>, and <code>step</code>. Visual Basic evaluates these values only at this time and then assigns <code>start</code> to <code>counter</code>. Before the statement block runs, Visual Basic compares <code>counter</code> to <code>end</code>. If <code>counter</code> is already larger than the <code>end</code> value (or smaller if <code>step</code> is negative), the <code>For loop</code> ends and control passes to the statement that follows the <code>Next</code> statement. Otherwise, the statement block runs.</p>\n<p>Each time Visual Basic encounters the <code>Next</code> statement, it increments <code>counter</code> by <code>step</code> and returns to the <code>For</code> statement. <strong>Again it compares <code>counter</code> to <code>end</code></strong>, and again it either runs the block or exits the loop, depending on the result. This process continues until <code>counter</code> passes <code>end</code> or an <code>Exit For</code> statement is encountered. <strong>[Emphasis mine]</strong></p>\n</blockquote>\n<p><strong>Given that it checks the <code>counter</code> against the <code>end</code> every iteration, shouldn't changing the variable change the <code>end</code>?</strong></p>\n"}, {"tags": ["c#", "excel", "batch-file", "vba"], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 639739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a6eda9992c171e9fd308dcf0b51340cf?s=128&d=identicon&r=PG", "display_name": "Grault", "link": "https://stackoverflow.com/users/639739/grault"}, "edited": false, "score": 0, "creation_date": 1420657520, "post_id": 27826366, "comment_id": 44059288, "body": "<code>Environ()</code> is reasonably close to my ideal solution. Ew, registry; I can&#39;t believe that made a close second. Many thanks. I was looking at compiler flags and didn&#39;t even think of environment variables."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 788, "user_id": 639739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a6eda9992c171e9fd308dcf0b51340cf?s=128&d=identicon&r=PG", "display_name": "Grault", "link": "https://stackoverflow.com/users/639739/grault"}, "edited": false, "score": 0, "creation_date": 1421066114, "post_id": 27826366, "comment_id": 44203599, "body": "One doesn&#39;t need to like it <i>g</i>, but SaveSetting / GetSetting() would hide things a bit better from the end user than an environment variable, if this is a demand. Still, if you know the key (e.g. <code>HKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\\[YourGroup]\\Settings\\[YourParam]</code>) it can be directly patched via regedit.exe and doesnt harm otherwise."}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": true, "score": 1, "last_activity_date": 1420656071, "creation_date": 1420656071, "answer_id": 27826366, "question_id": 27824923, "link": "https://stackoverflow.com/questions/27824923/how-can-i-pass-a-value-from-batch-to-an-excel-vba-macro/27826366#27826366", "title": "How can I pass a value from Batch to an Excel VBA macro?", "body": "<p>Porting your CSV generating program to a user machine you could:</p>\n\n<ul>\n<li>set an environment variable on the user machine to the target directory; e.g. (cmd line) <code>SET CSVPATH=C:\\My\\CSV</code></li>\n<li>let the macro from your CSV processing XLSM read this environment variable using the <code>Environ()</code> function; e.g. (VBA) <code>MyPath = Environ(\"CSVPATH\") &amp; \"\\\"</code></li>\n</ul>\n\n<p>alternatively, you could</p>\n\n<ul>\n<li>use a directory selection dialog in an \"installation XLSM\" to write the correct file path(s) to the target machine's registry using the <code>SaveSetting</code> statement</li>\n<li>let the macro from your CSV processing XLSM read the registry using the <code>GetSetting()</code> function to get the correct path</li>\n</ul>\n"}], "owner": {"reputation": 788, "user_id": 639739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a6eda9992c171e9fd308dcf0b51340cf?s=128&d=identicon&r=PG", "display_name": "Grault", "link": "https://stackoverflow.com/users/639739/grault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 27826366, "answer_count": 1, "score": 0, "last_activity_date": 1420656805, "creation_date": 1420651064, "last_edit_date": 1531161705, "question_id": 27824923, "link": "https://stackoverflow.com/questions/27824923/how-can-i-pass-a-value-from-batch-to-an-excel-vba-macro", "title": "How can I pass a value from Batch to an Excel VBA macro?", "body": "<p>I have a C# program which generates a CSV file, then opens an XLSM file in Excel (using <code>ProcessStartInfo</code> and <code>Process.Start</code>). The macro in the XLSM loads the CSV file and distributes data from it to specific cells. Eventually this will be C# generating a spreadsheet without macros that can be loaded in any office suite, and the CSV will disappear.</p>\n\n<p>My problem is that this system now needs to support running the XLSM from anywhere on disk. It finds the CSV via a hardcoded relative path, which doesn't work from a user-specified location. I'd like to do something similar to passing a compiler parameter to define a constant.</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>Alternative approaches I have considered and rejected:</p>\n\n<ul>\n<li><p>Copy the XLSM to a standard location near the CSV and run it from there.</p>\n\n<p>I would need to copy the file back to its original location, but I don't know when Excel is closed to do that... Except maybe in Excel, but it doesn't know the original location, hence this question.</p></li>\n<li><p>Create the CSV file next to the user-specified XLSM location.</p>\n\n<p>The CSV file's location is specified in an NLOG configuration file, and changing the surrounding implementation to use a hardcoded path would be expensive. This is the only idea I've had that could work, but it would hurt.</p></li>\n<li><p>Create a Windows-based hard link to the custom location from the standard location.</p>\n\n<p>I can't assume I'm running on an NTFS filesystem.</p></li>\n</ul>\n"}, {"tags": ["vba", "date", "excel", "locale"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1420650940, "post_id": 27824513, "comment_id": 44055505, "body": "You may have some issues here, and might be difficult to resolve... I&#39;ve tackled this before I think, though... Storing the dates as <code>Variant</code> type will probably rely on system locale to determine what they actually <i>are</i>, so some dates will appear as strings, others will appear dyslexically (August 8 instead of December 12, etc.) depending on who is running the code in what locale.  Where do they key values come from? Are they originating on the sheet? Or are they constructed in the VBA?"}, {"owner": {"reputation": 2597, "user_id": 2026637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019b98c2b46b6b0e310a51207db34647?s=128&d=identicon&r=PG", "display_name": "grahamj42", "link": "https://stackoverflow.com/users/2026637/grahamj42"}, "edited": false, "score": 1, "creation_date": 1420651335, "post_id": 27824513, "comment_id": 44055740, "body": "Dates represented as mm/dd/yyyy are always risky when crossing the Atlantic. As Excel dates are the number of days since 01/01/1900 00:00:00, you can avoid the problem by storing them as Long (if the time is not important) or Double if you need to preserve the time."}, {"owner": {"reputation": 361, "user_id": 2356181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea8c89cb6acc37e682132425d0219d19?s=128&d=identicon&r=PG", "display_name": "FinanceGuyThatCantCode", "link": "https://stackoverflow.com/users/2356181/financeguythatcantcode"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1420651772, "post_id": 27824513, "comment_id": 44055998, "body": "@DavidZemens  The dates are coming by making a call through an API from a third party (Bloomberg) in VBA.  The call to my Bloomberg terminal returns a Time Series of data in the Dictionary container.  So Bloomberg supplies the dates which appear to be correctly in UK locale format.  I see no evidence of any dates being treated as strings.  The watch window for the dictionary indicates #08/12/2014# for example - the # implies that this is being read as a date I believe - correct me if I am wrong."}, {"owner": {"reputation": 361, "user_id": 2356181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea8c89cb6acc37e682132425d0219d19?s=128&d=identicon&r=PG", "display_name": "FinanceGuyThatCantCode", "link": "https://stackoverflow.com/users/2356181/financeguythatcantcode"}, "edited": false, "score": 0, "creation_date": 1420651788, "post_id": 27824513, "comment_id": 44056009, "body": "I think that everything is fine in the dictionary and on the sheet - on the sheet, for example when I add 1 to the incorrect 12/08/2014, I get 13/08/2014 implying that it is a date and that the range format is using the UK locale.  Something gets messed up on my first snippet of code:  rng.value = Application.Transpose(data_dict.keys())"}, {"owner": {"reputation": 361, "user_id": 2356181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea8c89cb6acc37e682132425d0219d19?s=128&d=identicon&r=PG", "display_name": "FinanceGuyThatCantCode", "link": "https://stackoverflow.com/users/2356181/financeguythatcantcode"}, "reply_to_user": {"reputation": 2597, "user_id": 2026637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019b98c2b46b6b0e310a51207db34647?s=128&d=identicon&r=PG", "display_name": "grahamj42", "link": "https://stackoverflow.com/users/2026637/grahamj42"}, "edited": false, "score": 0, "creation_date": 1420652072, "post_id": 27824513, "comment_id": 44056182, "body": "@grahamj42 - Yes, I believe that would work.  It is an extra step that I will have to be cognizant of unless there is a better solution.  It is just very surprising that dates I have in the dictionary are in the UK locale with a sheet that is in the UK locale would not simply paste the dates as is. I will try casting the variant array to an array of dates and I will also try casting to an array of longs to see what I get.  The longs should definitely work - curious if the dates will."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1420654992, "post_id": 27824513, "comment_id": 44057774, "body": "OK it looks like everything is OK on the dates in the Keys of the dictionary then.  thanks for clarifying the origin of the dates. An interesting thing happens if I do something like <code>Const d as Date = #13&#47;1&#47;2014#</code> while on the US Locale, this <i>automatically</i> changes itself to <code>#1&#47;13&#47;2014#</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 2356181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea8c89cb6acc37e682132425d0219d19?s=128&d=identicon&r=PG", "display_name": "FinanceGuyThatCantCode", "link": "https://stackoverflow.com/users/2356181/financeguythatcantcode"}, "edited": false, "score": 0, "creation_date": 1420651937, "post_id": 27824780, "comment_id": 44056105, "body": "I think that everything is fine in the dictionary and on the sheet - on the sheet, for example when I add 1 to the incorrect 12/08/2014, I get 13/08/2014 implying I that rng.NumberFormat is ok. Something gets messed up on my first snippet of code: rng.value = Application.Transpose(data_dict.keys())"}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1420650648, "creation_date": 1420650648, "answer_id": 27824780, "question_id": 27824513, "link": "https://stackoverflow.com/questions/27824513/excel-2010-vba-bug-when-copying-a-date-using-the-uk-locale-to-the-sheet-from/27824780#27824780", "title": "Excel 2010 VBA Bug(?) when copying a date using the UK locale to the sheet from a variant array", "body": "<p>Some date formats are regionally sensitive, others are not.</p>\n\n<p>Regionally sensitive:\n<code>rng.NumberFormat = \"m/d/yyyy\"</code></p>\n\n<p>Not regionally sensitive:\n<code>rng.NumberFormat = \"dd/mm/yyyy;@\"</code></p>\n\n<p>The difference appears to be the <code>;@</code> at the end of the date format.</p>\n"}], "owner": {"reputation": 361, "user_id": 2356181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea8c89cb6acc37e682132425d0219d19?s=128&d=identicon&r=PG", "display_name": "FinanceGuyThatCantCode", "link": "https://stackoverflow.com/users/2356181/financeguythatcantcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420650648, "creation_date": 1420649777, "question_id": 27824513, "link": "https://stackoverflow.com/questions/27824513/excel-2010-vba-bug-when-copying-a-date-using-the-uk-locale-to-the-sheet-from", "title": "Excel 2010 VBA Bug(?) when copying a date using the UK locale to the sheet from a variant array", "body": "<p>I work in the US and made a sheet for use in both the US and the UK.  In the US, things work fine.</p>\n\n<p>In the UK, I created a Scripting.Dictionary whose keys were dates (represented as variants so they could be keys in a Scripting.Dictionary).  When the sheet runs in the UK, the format according to the watch viewer has the keys in the correct dd/mm/yyyy format.  This is good.</p>\n\n<p>Then I tried to paste the keys onto the sheet where rng is the range that is simply meant to hold my dates:</p>\n\n<pre><code>rng.value = Application.Transpose(data_dict.keys())\n</code></pre>\n\n<p>When I do this, dates that are unambiguously in UK format like 21/12/2014 are represented as such on the sheet.  Good!</p>\n\n<p>On the other hand, when a date could be valid in bot the US and the UK like 08/12/2014 (December 8, 2014), then this code places that date on the sheet as 12/08/2014 (BAD!) which the sheet is now interpreting as August 12, 2014 - as it should in the UK.  </p>\n\n<p>Is this a Microsoft bug that is swapping the month and day when a date could be valid in both the US and UK? Is this some kind of obscure feature?!</p>\n\n<p>Here is my non-ideal workaround that gives me the proper date formats in the sheet (non-ideal because iterating like this is slower):</p>\n\n<pre><code>i=1\nFor i = 1 To numDates\n    rng.Cells(i, 1) = data_dict.keys()(i - 1)\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1420650304, "post_id": 27824156, "comment_id": 44055114, "body": "Missing a period before <code>Item</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1420771205, "post_id": 27824156, "comment_id": 44110048, "body": "@amejel Since you have solved your own question, post the details as an <i>answer</i> rather that an edit."}], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": false, "score": 0, "last_activity_date": 1420749432, "last_edit_date": 1420749432, "creation_date": 1420652540, "answer_id": 27825358, "question_id": 27824156, "link": "https://stackoverflow.com/questions/27824156/filling-a-xychart-excel-chart-programmatically/27825358#27825358", "title": "Filling a XYchart excel chart programmatically?", "body": "<p>Elaborating on Tim's comment: your two references to Item(1) need to be preceded with a dot.</p>\n\n<pre><code>With ChartXY.Chart.SeriesCollection\n    If .Count = 0 then .NewSeries\n        .Item(1).Xvalues = PointsX\n        .Item(1).values = PointsY\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 0, "last_activity_date": 1423142833, "last_edit_date": 1423142833, "creation_date": 1420790692, "answer_id": 27856199, "question_id": 27824156, "link": "https://stackoverflow.com/questions/27824156/filling-a-xychart-excel-chart-programmatically/27856199#27856199", "title": "Filling a XYchart excel chart programmatically?", "body": "<p>This is the answer to my question:</p>\n\n<pre><code>Assume that ChartXY is a XYchart object created in an Excel sheet\nDim i as interger\nDim chartXY as Object\n\nset chartXY = ActiveSheet.ChartObjects(1) 'There's one chart.\n\nDim PointsX(0 To 3, 0 To 0) As Double\nDim PointsY(0 To 3, 0 To 0) As Double\n\nFor i = 0 to 3\n    PointsX (i,0)= i \n    PointsY (i,0)= i\nNext \n\nWith ChartXY.SeriesCollection\n    If .Count = 0 then .NewSeries\n        Item(1).values = PointsX\n        Item(1).Xvalues = PointsY\n    End If\nWith End \n</code></pre>\n"}], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 27856199, "answer_count": 2, "score": 0, "last_activity_date": 1423142833, "creation_date": 1420648699, "last_edit_date": 1420771144, "question_id": 27824156, "link": "https://stackoverflow.com/questions/27824156/filling-a-xychart-excel-chart-programmatically", "title": "Filling a XYchart excel chart programmatically?", "body": "<p>I'm trying to add data points to an excel chart so I basically wrote:</p>\n\n<pre><code>'Assume that ChartXY is a XYchart object created in an Excel sheet\nDim i as interger\nDim chartXY as Object\n\nset chartXY = ActiveSheet.ChartObjects(1) 'There's one chart.\n\nDim PointsX(0 To 3, 0 To 0) As Double\nDim PointsY(0 To 3, 0 To 0) As Double\n\nFor i = 0 to 3\n    PointsX (i,0)= i \n    PointsY (i,0)= i\nNext \n\nWith ChartXY.SeriesCollection\n    If .Count = 0 then .NewSeries\n        Item(1).Xvalues = PointsX\n        Item(1).Yvalues = PointsY\n    End If\nWith End \n</code></pre>\n\n<p>It doesn't seem to be working? Any ideas!</p>\n"}, {"tags": ["sql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "edited": false, "score": 1, "creation_date": 1420651283, "post_id": 27824358, "comment_id": 44055701, "body": "This did not work. I&#39;m asking how to catch an SQL error, not a VBA error. I ran the same folder through the program in SQL Server Management Studio with a planted error and it gave me an error whereas the VBA program did not."}, {"owner": {"reputation": 22481, "user_id": 162167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MIM9R.jpg?s=128&g=1", "display_name": "Will Marcouiller", "link": "https://stackoverflow.com/users/162167/will-marcouiller"}, "edited": false, "score": 0, "creation_date": 1420653150, "post_id": 27824358, "comment_id": 44056788, "body": "I read a post where it says that errors below number 19 are not reported back to VBA, hence perhaps the fact that the VBA can&#39;t trap it."}], "tags": [], "owner": {"reputation": 22481, "user_id": 162167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MIM9R.jpg?s=128&g=1", "display_name": "Will Marcouiller", "link": "https://stackoverflow.com/users/162167/will-marcouiller"}, "is_accepted": false, "score": 0, "last_activity_date": 1420649340, "last_edit_date": 1495541209, "creation_date": 1420649340, "answer_id": 27824358, "question_id": 27824035, "link": "https://stackoverflow.com/questions/27824035/how-to-catch-sql-error-through-excel-vba/27824358#27824358", "title": "How to Catch SQL Error through Excel VBA", "body": "<p>I guess this might be what you are looking for...</p>\n\n<p><a href=\"https://stackoverflow.com/a/9141641/162167\"><strong>MS Access VBA trapping SQL Server Connection Error</strong></a></p>\n\n<pre><code>Sub OpenConnection()\n    On Error GoTo ErrorHandler\n\n    // Do your stuff here...\n\n    ErrorHandler:\n    Debug.Print Err.Number &amp; \" \" &amp; Err.Description\n    ' Or else you could log the error in a file, or even display a message box, whatever...'\nEnd Sub\n</code></pre>\n\n<p>From the answer provided by <a href=\"https://stackoverflow.com/users/2548/fionnuala\"><strong>fionnuala</strong></a> to the above-linked question.</p>\n"}], "owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5972, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1424097322, "creation_date": 1420648272, "last_edit_date": 1531164843, "question_id": 27824035, "link": "https://stackoverflow.com/questions/27824035/how-to-catch-sql-error-through-excel-vba", "title": "How to Catch SQL Error through Excel VBA", "body": "<p>I have a program that is going through the subfolders of a folder and running a stored SQL command on each. I am in the process of writing another module that will automatically check the files before being inputted, but I don't like having my company's test data hinging on a program without any way to know if something errored out. Here is the code I currently have:</p>\n\n<pre><code>Sub openConnection()\n\nSet varConnection = New ADODB.Connection\nSet varCommand = New ADODB.Command\n\nvarConnection.ConnectionString = \"PROVIDER=SQLOLEDB;DATA SOURCE=192.168.1.186,1433;INITIAL CATALOG=Test1; INTEGRATED SECURITY=sspi;\"\nvarConnection.Open\n\nvarCommand.CommandText = \"importFile\"\nvarCommand.CommandType = adCmdStoredProc\nvarCommand.ActiveConnection = varConnection\n\nSet varParameter = varCommand.CreateParameter(\"filePath\", adChar, adParamInput, Len(varFolderPath), varFolderPath)\nvarCommand.Parameters.Append varParameter\n\nvarCommand.Execute\n\nvarConnection.Close\n\nEnd Sub\n</code></pre>\n\n<p>On occasion, the command will error out, causing the data to not be uploaded. How can I catch these <strong><em>SQL errors</em></strong> through Excel VBA in order to handle them appropriately without it being treated as though it had gone through like a normal file?</p>\n\n<p>Note: I don't mind rewriting code- this is all still in alpha.</p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "edited": false, "score": 0, "creation_date": 1421352755, "post_id": 27827020, "comment_id": 44336915, "body": "Hello, @Matteo, your code works great most of the time, but sometimes i get this error message of &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set&quot; on your first for loop. is it possible to fix this? Thanks."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "edited": false, "score": 0, "creation_date": 1421352808, "post_id": 27827020, "comment_id": 44336937, "body": "Hi @JLee, sure it is. Where does it happen exactly?"}, {"owner": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "edited": false, "score": 0, "creation_date": 1421353124, "post_id": 27827020, "comment_id": 44337092, "body": "it happens on this line -&gt;   For Each tr In tb.Rows"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1421355643, "last_edit_date": 1421355643, "creation_date": 1420658458, "answer_id": 27827020, "question_id": 27823784, "link": "https://stackoverflow.com/questions/27823784/excel-vba-login-to-website-pull-data-from-table/27827020#27827020", "title": "Excel VBA: Login to Website, Pull data from table", "body": "<p>This code snippet might help you: </p>\n\n<pre><code>    Dim tb As Object, tr As Object, th As Object\n    Dim yourValue As String \n\n    Set tb = HTMLdoc.getElementById(\"tblActiveProjects\") 'tb is the Table object\n\n    For Each tr In tb.Rows 'loop through the &lt;tr&gt; rows of your table\n      For Each th In tr.cells 'loop through the &lt;th&gt; cells of your row\n        yourValue = th.outerText 'your value is now in the variable \"yourValue\"\n      Next th\n    Next tr\n</code></pre>\n\n<p>The value contained in each <code>th</code> element gets temporarily stored in the variable <code>yourValue</code>. I let you decide if you want to add it to a values collection: </p>\n\n<pre><code>Dim myValues As New Collection\n'...\n    myValues.Add th.outerText\n</code></pre>\n\n<p>... or printing it into a spreadsheet cell...</p>\n\n<pre><code>Range(\"A\" &amp; j).Value = th.outerText\nj = j + 1\n</code></pre>\n\n<p>... or whatever else you would like to do with your values. Please note this is a starting input, you will probably need to adjust the code to match it fully with your needs.</p>\n\n<p><strong>EDIT - how to deal with 'object not set'</strong></p>\n\n<p>Basically, a webpage is a file loaded from a server machine through the Internet. When you automate the web, you are \"running\" with VBA (a Ferrari) against a server loading an HTML file and its contents from the databases through your Internet connection (an old man on an old donkey). </p>\n\n<p>In other words, you need to tell your VBA program to wait until the webpage is loaded, otherwise you risk to start looking for a variable before the server has pushed it into the webpage. You are actually already doing something like this in your code: </p>\n\n<pre><code>Do While ieApp.Busy\n    DoEvents\nLoop  \n</code></pre>\n\n<p>This code will loop until the statement <code>ieApp.Busy</code> will return <code>False</code>; when it's not busy anymore, then, it will release the code and let it run again. </p>\n\n<p><em>What might be happening to you sometimes?</em></p>\n\n<p>Depending on the architecture of the host server of your website, as well as on the design of the webpage, it might be that sometimes the application is released before it has actually loaded the data. Hence, when you will try to look <code>For Each tr In tb.Rows</code>, you won't find any <code>Rows</code> into your <code>tb</code> because in the moment in which your execution has <code>Set tb = HTMLdoc.getElementById(\"tblActiveProjects)</code>, that object was still empty. </p>\n\n<p>Hence, the \"non-elegant\" but best solution to avoid this kind of delays is to put a physical time waiter in case of error. To talk \"in code\":</p>\n\n<pre><code>    'we turn on the error handler. If there is an error, it will ignore it and go to the next instruction\n    On Error Resume Next\n    'we try to set the element. We don't know how it will go...\n    Set tb = HTMLdoc.getElementById(\"tblActiveProjects\") 'tb is the Table object\n\n    If Err.Number &lt;&gt; 0 Then 'if an error occurred, we wait for 5 seconds and then we re-try\n        Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 5) \n        Set tb = HTMLdoc.getElementById(\"tblActiveProjects\") 'we retry, it should be fine\n        On Error GoTo 0 'we re-turn the error to 0\n    End If\n\n    On Error Resume Next 'we re-turn the error handler on\n    Set whatever = tb.Rows 'we see if there's something wrong here\n\n    If Err.Number &lt;&gt; 0 Then 'if an error occurred now, it means the table existed but was empty, so we wait for 5 seconds and then we re-set the object that this time should be filled up\n        Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 5) \n        Set tb = HTMLdoc.getElementById(\"tblActiveProjects\") 'we retry, it should be fine\n        On Error GoTo 0 'we re-turn the error to 0\n    End If        \n\n    'we restart our code execution regularly, this time we're almost sure our browser has been able to load the content\n\n    For Each tr In tb.Rows 'loop through the &lt;tr&gt; rows of your table\n      For Each th In tr.cells 'loop through the &lt;th&gt; cells of your row\n        yourValue = th.outerText 'your value is now in the variable \"yourValue\"\n      Next th\n    Next tr\n</code></pre>\n\n<p>Again, it's not a very nice solution, but with web-scraping (i.e. raw scraping of data rather than using any better API) it's all about work-arounds that work in 99% of the cases. </p>\n"}], "owner": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4233, "favorite_count": 0, "accepted_answer_id": 27827020, "answer_count": 1, "score": -1, "last_activity_date": 1422629362, "creation_date": 1420647526, "last_edit_date": 1422629362, "question_id": 27823784, "link": "https://stackoverflow.com/questions/27823784/excel-vba-login-to-website-pull-data-from-table", "title": "Excel VBA: Login to Website, Pull data from table", "body": "<p>i'm want my excel macro to go on to this website, log on, and copy the entire table and paste it on to the excel spreadsheet.</p>\n\n<p>I'm not too familiar with ExcelVba and i don't know what to do after logging into the website.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub DataPulling()\n\nDim ieApp As InternetExplorer\nDim ieDoc As Object\nDim URL As String\nDim ReportURL As String\nDim CurrentSheet As Worksheet\nDim HTML_Element As IHTMLElement\nDim HTMLDoc As HTMLDocument\n\n'set CurrentSheet as Active Worksheet\nSet CurrentSheet = ActiveSheet\n\n'On the Error, go Err_Clear\nOn Error GoTo Err_Clear\n\n'Create a new instance of IE\nSet ieApp = New InternetExplorer\n\n'Declare Web Addresses\nURL = \"http://www.login-page.com\"\nReportURL = \"http://www.the-table-page.com\"\n\nieApp.Visible = True\nieApp.Silent = True\n\n'Go to the main website\nieApp.navigate URL\n\nDo\n    Loop Until ieApp.readyState = READYSTATE_COMPLETE\n    Set HTMLDoc = ieApp.document\n    HTMLDoc.all.UserId.Value = \"userid\"\n    HTMLDoc.all.password.Value = \"password\"\n\n    For Each HTML_Element In HTMLDoc.getElementsByTagName(\"input\")\n        If HTML_Element.Type = \"submit\" Then HTML_Element.Click: Exit For\n    Next\n\nieApp.navigate ReportURL\n\nDo While ieApp.Busy\n    DoEvents\nLoop\n\n'I dont know what to put here..!!??\n\nieApp.Quit\n\nSet ieApp = Nothing\nSet ieDoc = Nothing\n</code></pre>\n\n<p>and the source page of the website looks something like this below..</p>\n\n<pre><code>&lt;div id=\"divDt\" class=\"dt\"&gt;\n&lt;table id=\"tblActiveProjects\" class=\"display dt\" cellspacing=\"0\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;ContentA1&lt;/th&gt;\n            &lt;th&gt;ContentA2&lt;/th&gt;\n            &lt;th&gt;ContentA3&lt;/th&gt;\n            &lt;th&gt;ContentA4&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;tr&gt;\n            &lt;th&gt;ContentB1&lt;/th&gt;\n            &lt;th&gt;ContentB2&lt;/th&gt;\n            &lt;th&gt;ContentB3&lt;/th&gt;\n            &lt;th&gt;ContentB4&lt;/th&gt;\n        &lt;/tr&gt;\n</code></pre>\n"}, {"tags": ["html", "vba", "click"], "comments": [{"owner": {"reputation": 2390, "user_id": 4118466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37dc934c10a22e574c39f21446f4755d?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4118466/billy"}, "edited": false, "score": 0, "creation_date": 1420647093, "post_id": 27823536, "comment_id": 44053082, "body": "put the 0 in square brackets and try thatfro the get elements by class.<code>(&quot;hint hint_search&quot;)[0]</code> and no zero for the elem by id edited for the fourth time....take the s off getElementById and make the I capital"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1420648203, "last_edit_date": 1420648203, "creation_date": 1420647791, "answer_id": 27823890, "question_id": 27823536, "link": "https://stackoverflow.com/questions/27823536/search-button-on-website-wont-click-vba/27823890#27823890", "title": "Search button on website won&#39;t click VBA", "body": "<p>Without having the URL, I would say that the reason why this line of code cannot work:</p>\n\n<pre><code>IE.Document.getElementsByid(\"SiteSearchForm_SearchBtn\")(0).submit\n</code></pre>\n\n<p>is two-folded. </p>\n\n<p><strong>1)</strong> It's <code>getElementById</code>, not <code>Elements</code>;</p>\n\n<p><strong>2)</strong> The function returns a single element, so you don't need to access a collection with <code>(0)</code></p>\n\n<p>If you are sure about your ID, just try:</p>\n\n<pre><code>IE.Document.getElementByid(\"SiteSearchForm_SearchBtn\").Click\n</code></pre>\n\n<p>...otherwise please provide us with the URL for us to troubleshooting. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>According to the HTML line you provided, you cannot get the element by class name simply because the element you get is a <code>&lt;div&gt;</code> element, which doesn't support the Click event. \nBy default, in fact, the div does not have the property <code>cursor:pointer</code> because it is thought as a \"container\". The link, i.e. <code>&lt;a&gt;</code>, is instead a clickable element by default which redirects you to the <code>href</code> address (where you want to go). </p>\n\n<p>As for the line setting up the value of the search field, instead, it seems to be fine. But are you sure you cannot go by a unique property (such as an <code>id</code>) to avoid a change in the CSS naming of the website might turn into a crash of your code in the future? </p>\n"}], "owner": {"reputation": 5, "user_id": 3229103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5096b8ea987a77073a51b7a34cd753e?s=128&d=identicon&r=PG&f=1", "display_name": "Royalty411", "link": "https://stackoverflow.com/users/3229103/royalty411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 27823890, "answer_count": 1, "score": 0, "last_activity_date": 1441566524, "creation_date": 1420646769, "last_edit_date": 1441566524, "question_id": 27823536, "link": "https://stackoverflow.com/questions/27823536/search-button-on-website-wont-click-vba", "title": "Search button on website won&#39;t click VBA", "body": "<p>I am trying to insert data into a search field and then click the search button. I tried <code>getElementsByid(\"SiteSearchForm_SearchBtn\")(0).Click</code> and <code>getElementsByclassname(\"searchBtn\")(0).Click</code>. </p>\n\n<p><strong>HTML</strong>:</p>\n\n<pre><code>&lt;div class=\"searchBtn\"&gt;&lt;a href=\"#search\" id=\"SiteSearchForm_SearchBtn\"&gt;Search&lt;/a&gt;&lt;/div&gt;\n</code></pre>\n\n<p><strong>VBA CODE</strong>:</p>\n\n<pre><code>With IE\n        .Visible = True\n        .Navigate URL_1\n        Do Until .ReadyState = 4\n        DoEvents\n        Loop\n\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n            IE.Document.getelementsbyclassname(\"hint hint-search\")(0).Value = \"Eliroyal2$\"\n            IE.Document.getElementsByid(\"SiteSearchForm_SearchBtn\")(0).submit\n\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420665893, "post_id": 27823225, "comment_id": 44063773, "body": "you mentioned the error code 32809 is related to open workbook error.  Check where you open the workbook instead.  Post your whole block of code if possible.  More info required.  Also, if it&#39;s working on 1 computer and not other, check accessiblity on your file / folder."}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420703429, "post_id": 27823225, "comment_id": 44075343, "body": "When the workbook is opened it calls a sub routine. Running the routine on its own still causes the same error at the same place. We both have the same permissions on the file and directory"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1420733039, "post_id": 27823225, "comment_id": 44092529, "body": "do debug.print and run your code with F8 function key.  Check if each variable / object is assigned correctly (i.e. the &#39;wb&#39; value you set for new workbook does contains the correct value).  Last thing to check is if the sheet is locked.  Again, more codes are required"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420737510, "post_id": 27823225, "comment_id": 44095638, "body": "I&#39;ve stepped through the code all values are as expected &amp; the sheet is not locked. I have posted the code however I don&#39;t think the code is the issue"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420753433, "post_id": 27823225, "comment_id": 44104120, "body": "Assuming chkAllJPM is a named range, does it exists on the sheet?  Or what is it if it&#39;s not a named range"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420790499, "post_id": 27823225, "comment_id": 44115485, "body": "chkAllJPM is the name of the activex checkbox control"}, {"owner": {"reputation": 1874, "user_id": 3761815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Zrlop.png?s=128&g=1", "display_name": "Rusan Kax", "link": "https://stackoverflow.com/users/3761815/rusan-kax"}, "edited": false, "score": 1, "creation_date": 1420800987, "post_id": 27823225, "comment_id": 44120593, "body": "Are the Excel versions the same? Are the security settings the same? Excel options-&gt;Trust Center -&gt; Trust Center Settings -&gt;ActiveX Settings -&gt; &quot;Enable all controls&quot;/ Safe mode, etc?"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1420805539, "post_id": 27823225, "comment_id": 44122920, "body": "Yes are Excel versions are the same. I&#39;ve checked the Trust Center Settings. Under ActiveX we both have &quot;Prompt me before enabling all controls with minimal restrictions&quot; and the Safe Mode ticked. Macro settings are the same too. Both have Trust Access to the VBA project object model ticked &amp; enable all macros"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1420816776, "post_id": 27823225, "comment_id": 44129495, "body": "Now that we are still not sure if the error comes from activex control or access right, I will suggest to write a simple code on the same workbook, just to open the workbook and add a value to a cell (say add &quot;hello&quot; on range A1.  See if that prompt for errors.  If that&#39;s fine, then try another simple function with local activex control"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1420836792, "post_id": 27823225, "comment_id": 44140469, "body": "did the other user do any Microsoft updates to office that you dont have?"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1421054131, "post_id": 27823225, "comment_id": 44197147, "body": "No we do not believe so. All microsoft updates are managed by our IT team so everything should be the same however something is obviously not"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1421422948, "post_id": 27823225, "comment_id": 44366010, "body": "@mHelpMe Regarding your last update: Excel does not recognize chkTest ActiveX object any longer but it knows of an object which hase a name &quot;chkTest&quot;. Most of the stuff you could do with the chkTest before you will not any longer, but the code change you&#39;ve made saves you a raised error in this context."}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": true, "score": 5, "last_activity_date": 1435919846, "last_edit_date": 1435919846, "creation_date": 1421422470, "answer_id": 27987410, "question_id": 27823225, "link": "https://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer/27987410#27987410", "title": "opening workbook error code 32809 on one computer but not the other computer", "body": "<p>There is only one solution that works 100% (and believe me, I've been working through (arguably) all of the possible solutions, in a corp environment): <strong><em>get rid of imbedded ActiveX controls</em></strong>. </p>\n\n<p>You have three options, IMO: </p>\n\n<ol>\n<li><p>Option 1 is to move the controls' functionality into the ribbon, perhaps with an addition of a UserForm depending on an ActiveX control (no UserForms would be needed for a command button of course). There is quite a bit of work here but it is the cleanest and the safest way to go. </p></li>\n<li><p>Option 2 is to replace ActiveX controls with Form Controls. This really sucks because you will lose most of the functionality an ActiveX controls gives you but it is an option nonetheless. </p></li>\n<li><p>Option 3 is to replace ActiveX Controls with Shape objects; some new specific problems to deal with (e.g., protection/locking) but you get a beautiful range of formatting options :) </p></li>\n</ol>\n\n<p>In any case you will need to rework/update your workbooks. I've mostly used the Option 1, and a bit of the Option 3. Please note that you can use a mix of the above options in the same app.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4397085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a403387f82592fb180f2a28df929378c?s=128&d=identicon&r=PG&f=1", "display_name": "microstat10", "link": "https://stackoverflow.com/users/4397085/microstat10"}, "is_accepted": false, "score": 1, "last_activity_date": 1421908521, "creation_date": 1421908521, "answer_id": 28082605, "question_id": 27823225, "link": "https://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer/28082605#28082605", "title": "opening workbook error code 32809 on one computer but not the other computer", "body": "<p>After trying recommended .exd file deletions that didn't work for us, and considering rewriting vb code in numerous files, we finally solved this problem by uninstalling the MS KB update and not allowing it on subsequent updates. (Office 2013 KB2726958; 2010 KB2553154; 2007 KB2596927).\nWe're hoping that MS will find an elegant way to solve the Active X issue seamlessly in a future update.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4531159, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zXOhb3iUtHk/AAAAAAAAAAI/AAAAAAAAk5I/3mpUqbT2x4M/photo.jpg?sz=128", "display_name": "Brandon White", "link": "https://stackoverflow.com/users/4531159/brandon-white"}, "is_accepted": false, "score": 0, "last_activity_date": 1423105338, "creation_date": 1423105338, "answer_id": 28335470, "question_id": 27823225, "link": "https://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer/28335470#28335470", "title": "opening workbook error code 32809 on one computer but not the other computer", "body": "<p>Micorsoft relesed an update in December 2014 that is causing errors in Excel application that use ActiveX controls. Apply the fix depending on the version of Excel on the machine.</p>\n\n<p>Close all Office Applications</p>\n\n<p>For Excel 2007 Install Microsoft Update KB2596927</p>\n\n<p>For Excel 2010 Install Microsoft Update KB 2553154</p>\n\n<ul>\n<li><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=45224\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=45224</a></li>\n</ul>\n\n<p>For Excel 2013 Install Microsoft Update KB 2726958</p>\n\n<ul>\n<li><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=45202\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=45202</a></li>\n</ul>\n\n<p>Open the File Explorer</p>\n\n<p>Type <em>%Temp%</em> in the address Window</p>\n\n<p>Click on the Excel 8.0 Folder</p>\n\n<p>Delete all *.exd files</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8026179, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/db8bbab24c263605ed4e851d26d962cf?s=128&d=identicon&r=PG", "display_name": "alfredo", "link": "https://stackoverflow.com/users/8026179/alfredo"}, "is_accepted": false, "score": -1, "last_activity_date": 1495032340, "creation_date": 1495032340, "answer_id": 44028118, "question_id": 27823225, "link": "https://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer/44028118#44028118", "title": "opening workbook error code 32809 on one computer but not the other computer", "body": "<p>My problem is over I deleted all files from the %temp% folder\nOne important thing is that the user account must have Administrator privileges\nThis solves my problem\nGreetings to all, I hope this helps many.</p>\n"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2074, "favorite_count": 0, "accepted_answer_id": 27987410, "answer_count": 4, "score": 2, "last_activity_date": 1495032340, "creation_date": 1420645821, "last_edit_date": 1531161705, "question_id": 27823225, "link": "https://stackoverflow.com/questions/27823225/opening-workbook-error-code-32809-on-one-computer-but-not-the-other-computer", "title": "opening workbook error code 32809 on one computer but not the other computer", "body": "<p>I have an excel 2013 macro workbook.</p>\n\n<p>This workbook has been working fine for the last 6 months. The first day this year I had an issue below with line of code below. All this line of code did was to set the activex checkbox control to true when the workbook is opened.</p>\n\n<pre><code>Sheets(WSCHARTS).chkAllJPM.value = True\n</code></pre>\n\n<p>I manage to fix the issue through a previous post. The answer was by following <a href=\"http://excelmatters.com/2014/12/10/office-update-breaks-activex-controls/\" rel=\"nofollow\">the instructions</a>. However a team member who is back in the office for their first day is having issues with this workbook. Again they have been using this workbook daily without any issues. The code debugs on the same line above with the error code number 32809.</p>\n\n<p>I tried following the same instructions that fixed the issue for me but no joy. I cannot replicate the issues on my computer. Not sure what is causing this error?</p>\n\n<p>Here is the sub routine. Please note WSCHARTS is public const string - its value is \"charts\"</p>\n\n<pre><code>Sub SetDefaultSetting()\n\n' set the default view upon opening the spreadsheet\n\nDim ws As Worksheet\nDim wsTime As Worksheet\nSet wsTime = ThisWorkbook.Sheets(WSTSJPM)\nSet ws = ThisWorkbook.Sheets(WSCHARTS)\n\n' get last date\nDim lRow As Long\nlRow = wsTime.Range(\"A65536\").End(xlUp).Row\nws.DropDowns(\"DropDownStart\").ListFillRange = wsTime.Name &amp; \"!\" &amp; wsTime.Range(\"A2:A\" &amp; lRow).Address\nws.DropDowns(\"DropDownEnd\").ListFillRange = wsTime.Name &amp; \"!\" &amp; wsTime.Range(\"A2:A\" &amp; lRow).Address\n\nws.Range(COLDATES &amp; \"1\") = 1                      ' start date is 12 dec 2013\nws.Range(COLDATES &amp; \"2\") = lRow - 1               ' latest avaiable date\n\n' control are linked to cells so just need to change their cell values\nws.Range(\"C1\") = 6\nws.Range(\"D1\") = 7\nws.Range(\"E1\") = 8\nws.Range(\"F1\") = 9\nws.Range(\"G1\") = 10\n\n' rest should be blank\nws.Range(\"H1\") = 1\nws.Range(\"I1\") = 1\nws.Range(\"J1\") = 1\nws.Range(\"K1\") = 1\nws.Range(\"L1\") = 1\n\nSheets(WSCHARTS).chkAllJPM.value = True\nws.OLEObjects(\"chkBOAML5\").Object.Enabled = False\n\nSet wsTime = Nothing\nSet ws = Nothing\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>So I created a new workbook and just place a single activex checkbox control on Sheet1 &amp; renamed it chkTest.</p>\n\n<p>I added the code below. The code works on my PC but not on my colleagues computer. This is rather frustrating now. Any ideas? </p>\n\n<pre><code> Private Sub Workbook_Open()\n\n    Sheets(\"Sheet1\").chkTest.Value = True\n\n End Sub\n</code></pre>\n\n<p><strong>Another Update</strong></p>\n\n<p>Not sure if this has anything to do with my issue. When I follow the instruction mentioned earlier I did notice in my c:\\users\\username\\Appdata\\local\\Temp\\VBE directory I had an extra file which my colleague did not have.</p>\n\n<p>I had a MsForms.exd and RefEdit.exd. My colleague only had the MsForms.exd file. Could this cause any issues?</p>\n\n<p><strong>Hopefully my last update</strong></p>\n\n<p>So changing the code above in the update directly above this to the code below it now works on both our computers. Is anyone able to explain why or what the difference is?</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim ws As Worksheet\nSet ws = Sheets(\"Sheet1\")\nws.OLEObjects(\"chkTest\").Object.Value = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "reply_to_user": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "edited": false, "score": 0, "creation_date": 1420646824, "post_id": 27823216, "comment_id": 44052896, "body": "Gave it a shot. It&#39;s not using the selecteb property so it always steps into the Exit Sub instead of calling queryBuilder"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420648008, "post_id": 27823514, "comment_id": 44053699, "body": "That fixed it! thanks! But somehow my querry is bringing up no records."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420648172, "post_id": 27823514, "comment_id": 44053823, "body": "You&#39;re Welcome ! :) What is your combo box bound column and are you applying the filter on the right column?"}, {"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420648650, "post_id": 27823514, "comment_id": 44054119, "body": "It&#39;s the whereAtt the select statement I put in it gets cleared when I reupdate cmbAnalyst.  So instead of Select * from tblActionLog where LogID is not null And Analyst = &#39; cmbAnalyst.Selected  It&#39;s just And Analyst = &#39; cmbAnalyst.Selected"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420650013, "post_id": 27823514, "comment_id": 44054949, "body": "Did you not use my Code? I have made changes, i.e dropped the .Selected, also you might need to requery your form to reflect the changes."}, {"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420652113, "post_id": 27823514, "comment_id": 44056208, "body": "Yeah I changed it. The problem is whereAtt isn&#39;t properly updating. not sure how to make it global."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1420646711, "creation_date": 1420646711, "answer_id": 27823514, "question_id": 27823216, "link": "https://stackoverflow.com/questions/27823216/selected-property-compile-error/27823514#27823514", "title": "Selected property Compile error", "body": "<p>You can use the ListIndex method of the ComboBox to test if something is being selected. You can also use Len() function. </p>\n\n<pre><code>Private Sub cmbAnalyst_AfterUpdate()\n    If cmbAnalyst.ListIndex &lt;&gt; -1 Then\n        whereAtt = whereAtt &amp; \" And Analyst = '\" &amp; Me.cmbAnalyst &amp;\"'\"\n        Call queryBuilder\n    End If\nEnd Sub\n</code></pre>\n\n<p>I would personally go for ListIndex. As ListIndex would return -1 if there is no selection. </p>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1420649006, "post_id": 27823603, "comment_id": 44054325, "body": "Thanks Hans this is helpful!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1420646960, "creation_date": 1420646960, "answer_id": 27823603, "question_id": 27823216, "link": "https://stackoverflow.com/questions/27823216/selected-property-compile-error/27823603#27823603", "title": "Selected property Compile error", "body": "<p>From the Access help topic, <em>ComboBox.Selected Property</em> ...</p>\n\n<p><em>\"The Selected property is a zero-based array that contains the selected state of each item in a combo box.\"</em></p>\n\n<p>So the argument Access demands is an index which identifies a member of that array.</p>\n\n<p>If yours is a simple select combox box, you can check its <code>.Value</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'If cmbAnalyst.Selected = \"\" Or IsNull(cmbAnalyst.Selected) Then\nIf Len(Trim(Me.cmbAnalyst.Value &amp; vbNullString)) = 0 Then\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 27823514, "answer_count": 2, "score": 0, "last_activity_date": 1420646960, "creation_date": 1420645801, "question_id": 27823216, "link": "https://stackoverflow.com/questions/27823216/selected-property-compile-error", "title": "Selected property Compile error", "body": "<p>I'm getting a compiler error for this block of code that im trying to run. Apparently the selected property is throwing a error: Argument not optional. Is there a better way to do this or a different property i could use? </p>\n\n<pre><code> Private Sub cmbAnalyst_AfterUpdate()\n\n    If cmbAnalyst.Selected = \"\" Or IsNull(cmbAnalyst.Selected) Then\n        Exit Sub\n    Else\n        whereAtt = whereAtt &amp; \" And Analyst = ' cmbAnalyst.Selected '\"\n        Call queryBuilder\n    End If\n    End Sub\n\n    Private Sub Form_Load()\n    whereAtt = \"Select * from tblActionLog where LogID is not null\"\n    cmbAnalyst.RowSource = \"SELECT DISTINCT Analyst FROM tblActionLog\"\n    Call queryBuilder\n    End Sub\n\n    Public Sub queryBuilder()\n    testTable.RowSource = whereAtt\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4420493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514bcd578f444c5205f01a25332915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Angelina ", "link": "https://stackoverflow.com/users/4420493/angelina"}, "edited": false, "score": 0, "creation_date": 1420735984, "post_id": 27823953, "comment_id": 44094627, "body": "Hi Gary&#39;s Student, thank you very much for your reply. My spreadsheet will be used by a number of people who don&#39;t have advanced knowledge of Excel and who will need to use different filtering criteria on each occasion. Do you know how I can use VBA to code for a filter that will allow me to select discrete words? Thanks again."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 4420493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514bcd578f444c5205f01a25332915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Angelina ", "link": "https://stackoverflow.com/users/4420493/angelina"}, "edited": false, "score": 0, "creation_date": 1420737629, "post_id": 27823953, "comment_id": 44095704, "body": "You would create a <i>Userform</i> that you allow them to either create a list of words or select from a pre-assigned list of words.  The <b>VBA</b> code would then use this created list to run the filter."}, {"owner": {"reputation": 1, "user_id": 4420493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514bcd578f444c5205f01a25332915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Angelina ", "link": "https://stackoverflow.com/users/4420493/angelina"}, "edited": false, "score": 0, "creation_date": 1420804373, "post_id": 27823953, "comment_id": 44122307, "body": "Thanks for this suggestion. I want other people (who are not v familiar with Excel) to be able to add to and update the spreadsheet regularly, so I think creating a Userform would be a bit restrictive. I would want the filter criteria to update automatically, just as Excel filters normally do."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1420647993, "creation_date": 1420647993, "answer_id": 27823953, "question_id": 27823193, "link": "https://stackoverflow.com/questions/27823193/vba-to-filter-comma-separated-values-using-multiple-criteria-in-excel/27823953#27823953", "title": "VBA to filter comma separated values using multiple criteria in Excel", "body": "<p>Say we start with data like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/KVO8m.png\" alt=\"enter image description here\"></p>\n\n<p>and we wish to see only rows with either <em>cat</em> or <em>dog</em>  Since we are using <strong>VBA</strong> we can filter \"by hand\"</p>\n\n<pre><code>Sub MultiFilter()\n    Dim N As Long, i As Long, v As String\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = 2 To N\n        v = Cells(i, \"A\").Value\n        If InStr(1, v, \"dog\") &gt; 0 Or InStr(1, v, \"cat\") &gt; 0 Then\n            Cells(i, \"A\").EntireRow.Hidden = False\n        Else\n            Cells(i, \"A\").EntireRow.Hidden = True\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>This results in:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3mWLs.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4420493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514bcd578f444c5205f01a25332915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Angelina ", "link": "https://stackoverflow.com/users/4420493/angelina"}, "edited": false, "score": 0, "creation_date": 1420736120, "post_id": 27824815, "comment_id": 44094714, "body": "Hi Cruter, Thanks a lot for your reply. I will need to be able to filter using more than 2 criteria, and this option is slightly less user-friendly than what I had in mind. Thanks again.."}], "tags": [], "owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "is_accepted": false, "score": 0, "last_activity_date": 1420650752, "creation_date": 1420650752, "answer_id": 27824815, "question_id": 27823193, "link": "https://stackoverflow.com/questions/27823193/vba-to-filter-comma-separated-values-using-multiple-criteria-in-excel/27824815#27824815", "title": "VBA to filter comma separated values using multiple criteria in Excel", "body": "<p>You could also do this without VBA by applying filters to your headings and then adding 'contains' text filters, such as 'Cat'.</p>\n\n<p>The limitation without using VBA is that there is only room for 2 criteria in the text filters by using the 'AND/OR' criteria.</p>\n\n<p>This same logic can be used on each column. Hope this non-VBA alternative helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 4420493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514bcd578f444c5205f01a25332915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Angelina ", "link": "https://stackoverflow.com/users/4420493/angelina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1560, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420650752, "creation_date": 1420645687, "last_edit_date": 1531161705, "question_id": 27823193, "link": "https://stackoverflow.com/questions/27823193/vba-to-filter-comma-separated-values-using-multiple-criteria-in-excel", "title": "VBA to filter comma separated values using multiple criteria in Excel", "body": "<p>I'm new to VBA and would really appreciate some help. </p>\n\n<p>I want to filter a column that has comma separated values using multiple criteria. At the moment, if I put more than one word in a cell, my filtering options/criteria are all of the words in the cell rather than coming up as discrete words/criteria. </p>\n\n<p>Example: I have documented pets that each family has in a village. I want the filter to show separate criterion of <em>'dog'</em> and/or <em>'cat'</em> and/or <em>'horse'</em>, and not <em>'dog; cat; horse'</em> or <em>'dog; cat'</em>. If I wanted to know which families have a dog and I searched for <em>'dog'</em> in excel, it would only show me the dogs in families who don't own any other pets, since families that own other pets would come under a filter category of, say, <em>'dog; cat'</em>. </p>\n\n<p>I also want to have the option of filtering more than one column in this way (with multiuple criteria) so that I can search which pets are in the village, which hobbies each child has, and which professions are in the family. For example, I might want to search in the pet column A for all the cats and/or dogs, in the child hobby column B for all the children that play basketball and/or chess, and in professions column C for all the architects and/or chefs and/or newsreaders. I would want my spreadsheet only to display all the families (rows) that fit all of these criteria.</p>\n\n<p>Does anyone know how I can achieve this using VBA?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1420646246, "creation_date": 1420646246, "answer_id": 27823358, "question_id": 27823100, "link": "https://stackoverflow.com/questions/27823100/populating-cells-based-on-another-cell-ranges-value/27823358#27823358", "title": "Populating cells based on another cell range&#39;s value", "body": "<p>Perhaps:</p>\n\n<pre><code>Sub Populate()\n    Dim rng As Range\n    Set rng = Range(\"C5:CC5\")\n    For Each r In rng\n        v = r.Value\n        If v = 11 Or v = 23 Then\n            r.Offset(10, 0).Value = \"Populate\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 492, "user_id": 3559739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1MvwL.png?s=128&g=1", "display_name": "maoizm", "link": "https://stackoverflow.com/users/3559739/maoizm"}, "is_accepted": false, "score": 0, "last_activity_date": 1420646719, "creation_date": 1420646719, "answer_id": 27823519, "question_id": 27823100, "link": "https://stackoverflow.com/questions/27823100/populating-cells-based-on-another-cell-ranges-value/27823519#27823519", "title": "Populating cells based on another cell range&#39;s value", "body": "<p>Do you really need VBA for this?</p>\n\n<p>You may add the following formula to your second range ($C$15 - $CC$15):</p>\n\n<p>=IF(OR(C5=11,C5=23),C5,\"\")</p>\n"}], "owner": {"reputation": 39, "user_id": 988921, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b70530a739fbd56ab78cd7017fd32daf?s=128&d=identicon&r=PG", "display_name": "kallell", "link": "https://stackoverflow.com/users/988921/kallell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2519, "favorite_count": 0, "accepted_answer_id": 27823358, "answer_count": 2, "score": 0, "last_activity_date": 1420646719, "creation_date": 1420645412, "last_edit_date": 1531164843, "question_id": 27823100, "link": "https://stackoverflow.com/questions/27823100/populating-cells-based-on-another-cell-ranges-value", "title": "Populating cells based on another cell range&#39;s value", "body": "<p>I have a cell range c5:cc5 that has values ranging from 0-23 (time). I would like for a corresponding row (15) to populate if the number is either 11 or 23. Sorry for such a noob question, I just am very new to VB</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1420645137, "post_id": 27822781, "comment_id": 44051773, "body": "Will the value in column <b>A</b> contain the <i>full</i> name like <b>Book1.xlsm</b> or just <b>Book1??</b>"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1420645286, "post_id": 27822781, "comment_id": 44051893, "body": "worksheet not workbook @Gary&#39;sStudent"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1420651744, "last_edit_date": 1495540674, "creation_date": 1420645650, "answer_id": 27823181, "question_id": 27822781, "link": "https://stackoverflow.com/questions/27822781/copy-row-where-cell-matches-worksheet-name/27823181#27823181", "title": "Copy row where cell matches worksheet name", "body": "<p>Edited... Apparently you <a href=\"https://stackoverflow.com/questions/27824936/for-start-to-end-loop-with-end-variable-changing-mid-loop\"><strong>CAN</strong> use <code>RowCount</code> twice and change it mid-loop</a>.  Not good practice as the variable is being sourced in two different sheets, but it technically will work.</p>\n\n<p>First off <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">STOP USING <code>SELECT</code></a></p>\n\n<p>Second this should do it (only if you want to move \"not planned\" items to a different sheet):</p>\n\n<pre><code>Sub Not_Planned()\n\nDim DataSht As Worksheet, DestSht As Worksheet\n\nSet DataSht = Sheets(\"All Data\")\n\nRowCount = DataSht.Cells(Cells.Rows.count, \"A\").End(xlUp).Row\n\nFor i = 2 To RowCount\n\n    check_value = DataSht.Range(\"M\" &amp; i).Value\n\n    If check_value = \"not planned\" Then\n        DataSht.Range(\"M\" &amp; i).EntireRow.Copy\n        Set DestSht = Sheets(DataSht.Range(\"A\" &amp; i).Value)\n          'You might want some error handling here for if the Sheet doesn't exist!\n        DestLast = DestSht.Cells(Cells.Rows.count, \"a\").End(xlUp).Row\n        DestSht.Range(\"a\" &amp; DestLast + 1).Paste\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>If you want to run the \"planned\" after your \"not planned\" macro then:</p>\n\n<pre><code>Sub Planned()\n\nDim DataSht As Worksheet, DestSht As Worksheet\n\nSet DataSht = Sheets(\"All Data\")\n\nRowCount = DataSht.Cells(Cells.Rows.count, \"A\").End(xlUp).Row\n\nFor i = 2 to RowCount\n        DataSht.Range(\"A\" &amp; i).EntireRow.Copy\n        Set DestSht = Sheets(DataSht.Range(\"A\" &amp; i).Value)\n          'You might want some error handling here for if the Sheet doesn't exist!\n        DestLast = DestSht.Cells(Cells.Rows.count, \"a\").End(xlUp).Row\n        DestSht.Range(\"a\" &amp; DestLast + 1).Paste\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1420645835, "post_id": 27823204, "comment_id": 44052270, "body": "1. <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">STOP USING SELECT</a> and 2. he said it needs to check M for &quot;not planned&quot;."}, {"owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "edited": false, "score": 0, "creation_date": 1420647187, "post_id": 27823204, "comment_id": 44053156, "body": "@Gary&#39;s Student - I get a &#39;Substring out of range&#39; error on line &#39;Sheets(DestinationSheet).Select&#39; ... any ideas ?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "edited": false, "score": 0, "creation_date": 1420648110, "post_id": 27823204, "comment_id": 44053778, "body": "@SMORF.......... This usually means that there is a spelling error somewhere and the variables in column <b>A</b> do not exactly match the tabnames."}, {"owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "edited": false, "score": 0, "creation_date": 1420648742, "post_id": 27823204, "comment_id": 44054174, "body": "@Gary&#39;sStudent ... when I hover over the &#39;DestinationSheet&#39; it shows me &#39;CUNR&#39; which is the column A header ... how can I start the code at row 2 and ignore the column header?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "edited": false, "score": 1, "creation_date": 1420648813, "post_id": 27823204, "comment_id": 44054213, "body": "@SMORF <code>i = 2 to RowCount</code>"}, {"owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "edited": false, "score": 0, "creation_date": 1420650416, "post_id": 27823204, "comment_id": 44055171, "body": "@Gary&#39;sStudent ... this code duplicates row 2 on each worksheet the same amount of times as the count of each column A value ?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1420645747, "creation_date": 1420645747, "answer_id": 27823204, "question_id": 27822781, "link": "https://stackoverflow.com/questions/27822781/copy-row-where-cell-matches-worksheet-name/27823204#27823204", "title": "Copy row where cell matches worksheet name", "body": "<p>This version ignores column <strong>M</strong> and uses column <strong>A</strong> instead:</p>\n\n<pre><code>Sub Not_Planned()\n\nSheets(\"All Data\").Select\n\nRowCount = Cells(Cells.Rows.Count, \"a\").End(xlUp).Row\n\nFor i = 1 To RowCount\n    DestinationSheet = Range(\"A\" &amp; i).Value\n\n        ActiveCell.EntireRow.Copy\n        Sheets(DestinationSheet).Select\n        RowCount = Cells(Cells.Rows.Count, \"a\").End(xlUp).Row\n        Range(\"a\" &amp; RowCount + 1).Select\n        ActiveSheet.Paste\n        Sheets(\"All Data\").Select\n        Range(\"A2\").Select\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3816407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/906ca9641c9f8a6bb1d9746904c6f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "SMORF", "link": "https://stackoverflow.com/users/3816407/smorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2038, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420651744, "creation_date": 1420644527, "last_edit_date": 1420648679, "question_id": 27822781, "link": "https://stackoverflow.com/questions/27822781/copy-row-where-cell-matches-worksheet-name", "title": "Copy row where cell matches worksheet name", "body": "<p>I have the following code that moves rows to a specific worksheet where a cell value in column M is equal to value: 'not planned'</p>\n\n<pre><code>Sub Not_Planned()\n\nSheets(\"All Data\").Select\n\nRowCount = Cells(Cells.Rows.count, \"a\").End(xlUp).Row\n\nFor i = 1 To RowCount\n\n    Range(\"M\" &amp; i).Select\n    check_value = ActiveCell\n\n    If check_value = \"not planned\" Then\n        ActiveCell.EntireRow.Copy\n        Sheets(\"Not Planned\").Select\n        RowCount = Cells(Cells.Rows.count, \"a\").End(xlUp).Row\n        Range(\"a\" &amp; RowCount + 1).Select\n        ActiveSheet.Paste\n        Sheets(\"All Data\").Select\n        Range(\"A2\").Select\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Is there a way to adapt the code so it runs through all rows and copies the row to a worksheet where the value in column A is equal to a worksheet name ?</p>\n\n<p>Please note: I already have a code that creates worksheets and names them as per unique values in column A.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1420645561, "creation_date": 1420645561, "answer_id": 27823149, "question_id": 27822635, "link": "https://stackoverflow.com/questions/27822635/macro-to-create-multiple-workbooks-from-single-worksheet-by-number-of-rows/27823149#27823149", "title": "macro to create multiple workbooks from single worksheet by number of rows", "body": "<p>This should get you started:</p>\n\n<pre><code>Sub splitSheet()\n\n    Const maxLines As Integer = 40\n\n    Dim wsTarget As Worksheet\n    Dim wbNew As Workbook\n    Dim wsNew As Worksheet\n    Dim rngTarget As Range\n    Dim rngTemp As Range\n\n    Set wsTarget = ThisWorkbook.Sheets(1)\n    Set rngTarget = wsTarget.Range(\"A1\", wsTarget.Range(\"A\" &amp; wsTarget.Cells.Rows.Count).End(xlUp)).EntireRow\n\n    Set rngTemp = wsTarget.Range(\"1:\" &amp; maxLines)\n\n    Do\n        Set wbNew = Workbooks.Add\n        Set wsNew = wbNew.Worksheets.Add\n\n        rngTemp.Copy\n        wsNew.Paste\n\n        Set rngTemp = rngTemp.Offset(maxLines, 0)\n\n    Loop Until Intersect(rngTemp, rngTarget) Is Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4429308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327b46be9df492197c9c751221bfa797?s=128&d=identicon&r=PG&f=1", "display_name": "catgracePM", "link": "https://stackoverflow.com/users/4429308/catgracepm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 663, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424227265, "creation_date": 1420644105, "last_edit_date": 1531164843, "question_id": 27822635, "link": "https://stackoverflow.com/questions/27822635/macro-to-create-multiple-workbooks-from-single-worksheet-by-number-of-rows", "title": "macro to create multiple workbooks from single worksheet by number of rows", "body": "<p>So far I have created a macro to pull 1 row of data from multiple workbooks in a folder into a single .csv worksheet with a stable header section (3 rows). </p>\n\n<p>The next step is to upload the data, however our system will only accept .csv files with a max of 40 rows.</p>\n\n<p><strong>I need a macro that will create multiple workbooks, each with 40 lines of the data (including headers rows (1-3). There are 157 columns, each row is unique</strong>.</p>\n\n<p>I'm very much still a beginner at VBA so any help will be much appreciated!</p>\n\n<p>Let me know if you need more info from me in order to help.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "word-2010", "custom-properties"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420645095, "post_id": 27822529, "comment_id": 44051739, "body": "<a href=\"http://msdn.microsoft.com/en-us/library/office/aa212718%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\"><code>CustomDocumentProperties()</code> MSDN</a> and <a href=\"http://msdn.microsoft.com/en-us/library/office/aa211950%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Returning an object from a collection</a>.  I don&#39;t think you can call a <code>.Value</code> from a collection property."}, {"owner": {"reputation": 127, "user_id": 4425378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9IEFS.png?s=128&g=1", "display_name": "Clyde", "link": "https://stackoverflow.com/users/4425378/clyde"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420647747, "post_id": 27822529, "comment_id": 44053522, "body": "Can you call a .value from a Regular Document Property and store it as a variable? That would be enough for me."}], "answers": [{"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 1, "last_activity_date": 1420645461, "creation_date": 1420645461, "answer_id": 27823120, "question_id": 27822529, "link": "https://stackoverflow.com/questions/27822529/print-a-custom-doc-property/27823120#27823120", "title": "Print a Custom doc property", "body": "<p>You need to call <code>CustomDocumentProperties</code> with a string. You forgot the quotes.</p>\n\n<pre><code>PropVal = ActiveDocument.CustomDocumentProperties(\"MasterTime\").Value\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4425378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9IEFS.png?s=128&g=1", "display_name": "Clyde", "link": "https://stackoverflow.com/users/4425378/clyde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 27823120, "answer_count": 1, "score": 1, "last_activity_date": 1420647564, "creation_date": 1420643830, "last_edit_date": 1420647564, "question_id": 27822529, "link": "https://stackoverflow.com/questions/27822529/print-a-custom-doc-property", "title": "Print a Custom doc property", "body": "<p>Here is my  current code.</p>\n\n<pre><code>Sub PrintMasterTime()\n\nDim PropVal As Integer\n    PropVal = ActiveDocument.CustomDocumentProperties(MasterTime).Value\n    Print PropVal\n\nEnd Sub\n</code></pre>\n\n<p>Compile Error: <code>Method not valid without suitable object</code></p>\n\n<p>Not sure why it's not printing. <code>\"MasterTime\"</code> is the name of my custom document property.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 3, "creation_date": 1420643713, "post_id": 27822426, "comment_id": 44050707, "body": "try: <code>cell.Offset(0,1)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420644085, "post_id": 27822426, "comment_id": 44050976, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/25409175/declare-a-range-relative-to-the-active-cell-with-vba\">Declare a Range relative to the Active Cell with VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1420643717, "creation_date": 1420643717, "answer_id": 27822480, "question_id": 27822426, "link": "https://stackoverflow.com/questions/27822426/loop-through-a-range-but-use-the-nxt-col-as-value/27822480#27822480", "title": "loop through a range but use the nxt col as value", "body": "<p>Use the <code>.Offset</code> method, which \"Returns a Range object that represents a range that\u2019s offset from the specified range.\"</p>\n\n<pre><code>If cell.Offset(0, 1).Value &gt; 1 Then\n</code></pre>\n\n<p>The above would evaluate to the <em>next</em> column.</p>\n\n<p>Documentation:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff840060%28v=office.15%29.aspx\" rel=\"noreferrer\">http://msdn.microsoft.com/en-us/library/office/ff840060%28v=office.15%29.aspx</a></p>\n"}], "owner": {"reputation": 2732, "user_id": 2061886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dkfiz.jpg?s=128&g=1", "display_name": "lightweight", "link": "https://stackoverflow.com/users/2061886/lightweight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 27822480, "answer_count": 1, "score": 0, "last_activity_date": 1420643717, "creation_date": 1420643517, "question_id": 27822426, "link": "https://stackoverflow.com/questions/27822426/loop-through-a-range-but-use-the-nxt-col-as-value", "title": "loop through a range but use the nxt col as value", "body": "<p>I have an excel code that looks at range A1:A100...it loops through those ranges, but when it loops, I wanted to pick the value in col B...for instance, when the range loop starts, it'll look at A1 first, but in the VBA, I want it to pick the value in B1 to use...</p>\n\n<pre><code>Sub DRAWb()\n'\n' DRAWb Macro\n'\n\n'\nDim rng As Range, cell As Range\n\nSet rng = Sheet1.Range(\"A1:A3\")\n\nFor Each cell In rng\n\n\nIf cell.Value &gt; 1 Then\n\n\n    ActiveSheet.Shapes.AddShape(msoShapeRectangle, 11.25, 50 * cell, 93.75, 43.5) _\n        .Name = \"R cell\"\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "quotes"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420643319, "post_id": 27822182, "comment_id": 44050450, "body": "you want one double quote in the text file rather then a doubled?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420643326, "post_id": 27822182, "comment_id": 44050454, "body": "Please clarify your question by adding expected and actual output."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420643487, "post_id": 27822182, "comment_id": 44050554, "body": "Try <code>&amp; Chr(34) &amp;</code> where you want quotes in the string?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 4, "creation_date": 1420643522, "post_id": 27822182, "comment_id": 44050580, "body": "<code>Write</code> quotes the String. Use <code>Print</code> instead."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4429041"}, "is_accepted": true, "score": 1, "last_activity_date": 1420644143, "creation_date": 1420644143, "answer_id": 27822645, "question_id": 27822182, "link": "https://stackoverflow.com/questions/27822182/excel-2013-vba-adding-strange-quotes/27822645#27822645", "title": "Excel 2013 VBA adding strange quotes", "body": "<pre><code>Sub test()\n    Worksheets(\"1\").Cells(1, 1).Value = \"html\"\n    Worksheets(\"1\").Cells(1, 2).Value = \"&lt;xml xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\" &gt; \"\n    txt = \"                   '\" &amp; Worksheets(\"1\").Cells(1, 1) &amp; \"'=&gt;array('\" &amp; Worksheets(\"1\").Cells(1, 2) &amp; \"' =&gt; $\" &amp; Worksheets(\"1\").Cells(1, 1) &amp; \"),\"\n    MsgBox txt\n    FilePath = Application.DefaultFilePath &amp; \"\\array.txt\"\n    Open FilePath For Output As #2\n    Print #2, txt\n    Close #2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 27822645, "answer_count": 1, "score": 0, "last_activity_date": 1420644143, "creation_date": 1420642717, "last_edit_date": 1420643021, "question_id": 27822182, "link": "https://stackoverflow.com/questions/27822182/excel-2013-vba-adding-strange-quotes", "title": "Excel 2013 VBA adding strange quotes", "body": "<p>Let say </p>\n\n<pre><code>Sub test()\n    Worksheets(\"1\").Cells(1, 1).Value = \"html\"\n    Worksheets(\"1\").Cells(1, 2).Value = \"&lt;xml xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\" &gt; \"\n    txt = \"                   '\" &amp; Worksheets(\"1\").Cells(1, 1) &amp; \"'=&gt;array('\" &amp; Worksheets(\"1\").Cells(1, 2) &amp; \"' =&gt; $\" &amp; Worksheets(\"1\").Cells(1, 1) &amp; \"),\"\n    MsgBox txt\n    FilePath = Application.DefaultFilePath &amp; \"\\array.txt\"\n    Open FilePath For Output As #2\n    Write #2, txt\n    Close #2\nEnd Sub\n</code></pre>\n\n<p>Now compare msgbox output with array.txt file.</p>\n\n<p>So all my txt string became quoted, also added additional quotes to url, how to prevent changes and get string as it is.</p>\n\n<p>Question is how to put msgbox output in array.txt ?</p>\n"}, {"tags": ["arrays", "excel", "vba", "resize"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420650761, "post_id": 27822137, "comment_id": 44055400, "body": "Why not try writing it? You&#39;d need to loop through <code>splitted</code> twice: on the first pass find the maximum size of each sub-array and on the second pass use <code>Redim Preserve</code> to resize as required."}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420650868, "post_id": 27822137, "comment_id": 44055461, "body": "Yeah, I am currently in the process of writing it myself. I didn&#39;t find a solution online and thought maybe someone had one. I will answer the question with a working code as soon as I am done."}], "answers": [{"tags": [], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "is_accepted": true, "score": 0, "last_activity_date": 1420654014, "creation_date": 1420654014, "answer_id": 27825799, "question_id": 27822137, "link": "https://stackoverflow.com/questions/27822137/streamline-resize-array-size-in-array-of-arrays/27825799#27825799", "title": "Streamline/resize array size in array of arrays", "body": "<p>The following function resizes an Array of an Array to the same dimensions:</p>\n\n<pre><code>Function oneDimensionArray(tmpArr As Variant, maxDim As Long) As Variant\nDim r As Long, redimArray As Variant\nFor r = LBound(tmpArr) To UBound(tmpArr)\n    redimArray = tmpArr(r)\n    If maxDim &gt; UBound(redimArray) Then ReDim Preserve redimArray(LBound(redimArray) To maxDim)\n    tmpArr(r) = redimArray\nNext r\n\noneDimensionArray = tmpArr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 27825799, "answer_count": 1, "score": 0, "last_activity_date": 1420654014, "creation_date": 1420642549, "last_edit_date": 1420644554, "question_id": 27822137, "link": "https://stackoverflow.com/questions/27822137/streamline-resize-array-size-in-array-of-arrays", "title": "Streamline/resize array size in array of arrays", "body": "<p>I have the following code:</p>\n\n<pre><code>Function SplitMe(sourceArray As Variant) As Variant\nDim source As Variant, tempArr As Variant\nsource = sourceArray\n\nIf Not IsArray(source) Then _\n    Exit Function\n\nDim r As Integer\nDim parts() As String\nDim splitted As Variant\nReDim splitted(LBound(source) To UBound(source))\n\nFor r = LBound(source) To UBound(source)\n    parts = VBA.Split(source(r, 1), \"\\\")\n    splitted(r) = parts\nNext r\n</code></pre>\n\n<p>It works fine until here:</p>\n\n<pre><code>splitted = Application.Transpose(splitted)\nSplitMe = splitted\n\nFor r = LBound(splitted) To UBound(splitted)\n    Debug.Print uniqueValues(splitted, r)\nNext r\nEnd Function\n</code></pre>\n\n<p>At this Point I want to transpose the Array. It works fine if the Arrays within the splited Array are the same size. The Problem occurs when I have a query like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/x7HUD.png\" alt=\"Array of Array before transposing\"></p>\n\n<p>The transposing is necessary for the  <code>uniqueValues(splitted, r)</code> function.</p>\n\n<p>I now want to write a function that goes ahead and adds length to the queries that are not the maximal size.<br>\n  In this case <code>splitted(1)</code> would give the length <code>0 to 9</code> and then the other 5 nodes would need to be increased to be <code>0 to 9</code>.</p>\n\n<p>Anyone with a function at hand that does that?</p>\n"}, {"tags": ["vba", "excel", "return-value", "messagebox"], "comments": [{"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1420641911, "post_id": 27821882, "comment_id": 44049541, "body": "You could use Range(&quot;F&quot; &amp; cell.row) - Nevermind, it got answered while I typed!"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2797492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/571b11813d990a49e109166c93fc95a4?s=128&d=identicon&r=PG&f=1", "display_name": "o0Lucky0o", "link": "https://stackoverflow.com/users/2797492/o0lucky0o"}, "edited": false, "score": 1, "creation_date": 1420643151, "post_id": 27821952, "comment_id": 44050342, "body": "Thank you very much, so simple."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1420641880, "creation_date": 1420641880, "answer_id": 27821952, "question_id": 27821882, "link": "https://stackoverflow.com/questions/27821882/excel-vba-returing-a-value-of-a-cell/27821952#27821952", "title": "Excel VBA returing a value of a cell", "body": "<p>You are going to want to use the <code>Range.Offset()</code> method <a href=\"http://msdn.microsoft.com/en-us/library/office/ff840060%28v=office.15%29.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/office/ff840060%28v=office.15%29.aspx</a></p>\n\n<p>Because you are checking each <code>Cell</code>, then the variable <code>Cell</code> is your Range.  So you would write:</p>\n\n<pre><code>Cell.Offset(0, Number of columns offset from current location).Value\n</code></pre>\n\n<p>Alteratively you could use a different method if you always want column F:</p>\n\n<pre><code>Range(\"F\" &amp; Cell.Row).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 4299441, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c19a79107735dd05f5df5ad080b91176?s=128&d=identicon&r=PG&f=1", "display_name": "AngularDev", "link": "https://stackoverflow.com/users/4299441/angulardev"}, "is_accepted": false, "score": 0, "last_activity_date": 1420641894, "creation_date": 1420641894, "answer_id": 27821957, "question_id": 27821882, "link": "https://stackoverflow.com/questions/27821882/excel-vba-returing-a-value-of-a-cell/27821957#27821957", "title": "Excel VBA returing a value of a cell", "body": "<p>This is what you want?</p>\n\n<p><code>Range(\"F\" &amp; Cell.row).Value</code></p>\n"}], "owner": {"reputation": 91, "user_id": 2797492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/571b11813d990a49e109166c93fc95a4?s=128&d=identicon&r=PG&f=1", "display_name": "o0Lucky0o", "link": "https://stackoverflow.com/users/2797492/o0lucky0o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 27821952, "answer_count": 2, "score": 1, "last_activity_date": 1420641894, "creation_date": 1420641675, "question_id": 27821882, "link": "https://stackoverflow.com/questions/27821882/excel-vba-returing-a-value-of-a-cell", "title": "Excel VBA returing a value of a cell", "body": "<p>Hopefully someone will be able to help me with this. I am completely new to the VBA and coding. Here is my code below:</p>\n\n<pre><code>Private Sub Workbook_Open()\nFor Each Cell In Range(\"I2:I500\")\n\n\nIf Cell.Value &lt; Date - 9 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 22 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"Status 1 \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 22\n        Cell.Font.Bold = True\nEnd If\nElseIf Cell.Value &lt; Date - 5 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 55 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"Status 2 \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 55\n        Cell.Font.Bold = True\nEnd If\nElseIf Cell.Value &lt; Date - 4 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 41 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"Status 3 \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 41\n        Cell.Font.Bold = True\nEnd If\nElseIf Cell.Value &lt; Date - 2 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 33 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"Status 4 \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 33\n        Cell.Font.Bold = True\nEnd If\nElse\nCell.Font.ColorIndex = 1\nCell.Font.Bold = False\n\nEnd If\nNext\n\nFor Each Cell In Range(\"O2:O500\")\n\nIf Cell.Value &lt; Date - 30 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 22 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"30 Days \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 44\n        Cell.Font.Bold = True\nEnd If\nElseIf Cell.Value &lt; Date - 60 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 55 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"60 Days \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 46\n        Cell.Font.Bold = True\nEnd If\nElseIf Cell.Value &lt; Date - 90 And Cell.Value &lt;&gt; \"\" Then\n    If Cell.Font.ColorIndex &lt;&gt; 41 And Cell.Interior.Color &lt;&gt; RGB(151, 210, 86) Then\n        MsgBox \"90 Days \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 3\n        Cell.Font.Bold = True\nEnd If\nElse\nCell.Font.ColorIndex = 1\nCell.Font.Bold = False\n\nEnd If\nNext\n\nFor Each Cell In Range(\"L2:L500\")\n\nIf Cell.Value = \"NO\" Then\n        MsgBox \"Actione has not been taken \" &amp; ***Cell.Address(False, False)***\n\n        Cell.Font.ColorIndex = 3\n        Cell.Font.Bold = True\n        Cell.Font.Underline = True\nEnd If\nIf Cell.Value = \"YES\" Then\n        Cell.Font.ColorIndex = 1\n        Cell.Font.Bold = False\n        Cell.Font.Underline = False\nEnd If\nNext\n\nFor Each Cell In Range(\"N2:N500\")\n\nIf Cell.Value = \"NO\" Then\n        MsgBox \"Actione has not been taken \" &amp; ***Cell.Address(False, False)***\n        Cell.Font.ColorIndex = 3\n        Cell.Font.Bold = True\n        Cell.Font.Underline = True\nEnd If\nIf Cell.Value = \"YES\" Then\n        Cell.Font.ColorIndex = 1\n        Cell.Font.Bold = False\n        Cell.Font.Underline = False\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>It does not do much, just pops up Message Box when criteria is met. What I was hoping to do is along with the message within the message box to return value of a cell from the same row but different column. I have highlighted with *** code which currently returns an address of an active cell, but as I explained earlier I would like this to be value of a different cell from the same active row but from column \"F\". I have tried to use range function but it did not work. Can someone please assist me with this?</p>\n\n<p>Thank you and any help will be appreciated.</p>\n"}, {"tags": ["c#", "sql", ".net", "vba", "ms-access"], "comments": [{"owner": {"reputation": 53572, "user_id": 116614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/37b82b77d83d9db3e5b2784f2080dc3c?s=128&d=identicon&r=PG", "display_name": "mellamokb", "link": "https://stackoverflow.com/users/116614/mellamokb"}, "edited": false, "score": 0, "creation_date": 1420641569, "post_id": 27821738, "comment_id": 44049321, "body": "What connection string are you using in the C# code?"}, {"owner": {"reputation": 649, "user_id": 2842827, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7e14f6cc2a63aaae7fb89879de9f0718?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2842827/alex"}, "reply_to_user": {"reputation": 53572, "user_id": 116614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/37b82b77d83d9db3e5b2784f2080dc3c?s=128&d=identicon&r=PG", "display_name": "mellamokb", "link": "https://stackoverflow.com/users/116614/mellamokb"}, "edited": false, "score": 0, "creation_date": 1420641688, "post_id": 27821738, "comment_id": 44049402, "body": "Just: Provider=Microsoft.ACE.OLEDB.12.0;Data Source=pathtodb.mdb.  Could that have something to do with it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420643039, "post_id": 27821738, "comment_id": 44050269, "body": "shouldn&#39;t there be an extra space in the C# query right before the <code>WHERE</code> clause?"}, {"owner": {"reputation": 649, "user_id": 2842827, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7e14f6cc2a63aaae7fb89879de9f0718?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2842827/alex"}, "edited": false, "score": 0, "creation_date": 1420643396, "post_id": 27821738, "comment_id": 44050501, "body": "Yes, typo while pasting it into here.  The actual c# query has this."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1420653483, "post_id": 27821738, "comment_id": 44056982, "body": "In this fragment ... <code>&#39;rampup&#39; AS Expr2</code> ... <i>Expr2</i> is an alias for the  expression <i>&#39;rampup&#39;</i>.  Is that what you meant by <i>&quot;named fields&quot;</i>?  If so, aliasing is implemented by the db engine and an alias can work regardless of whether the query is executed from c# or Access VBA."}, {"owner": {"reputation": 649, "user_id": 2842827, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7e14f6cc2a63aaae7fb89879de9f0718?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2842827/alex"}, "edited": false, "score": 0, "creation_date": 1420653624, "post_id": 27821738, "comment_id": 44057085, "body": "Thanks - so that&#39;s probably not the issue."}], "answers": [{"tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1421264576, "creation_date": 1421264576, "answer_id": 27951091, "question_id": 27821738, "link": "https://stackoverflow.com/questions/27821738/queries-in-c-and-access-vba-producing-different-results/27951091#27951091", "title": "Queries in c# and access vba producing different results", "body": "<blockquote>\n  <p>Any reasons why the rows would be inserted in a different order and some different between vba and ace.oledb.12.0?</p>\n</blockquote>\n\n<p>The order of data returned by an OLEDB query is generally not guaranteed unless you specify it with an <code>ORDER BY</code> clause.  Since Access queries itself directly, it likely does preserve physical record order.  Since you can't specify an order when executing an <code>INSERT INTO ... SELECT</code> there's not a way to force the order of inserts.</p>\n\n<p>As for the different results, I would look at one particular result and dig deeper, run a non-grouping query in each system and see if you get the same records back or if there is a difference in translation.</p>\n\n<p>As a side note, grouping by constant values (<code>'\" &amp; stringUser &amp; \"', 'rampup'</code>) is unneccessary, but it shouldn't change your results.</p>\n"}], "owner": {"reputation": 649, "user_id": 2842827, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7e14f6cc2a63aaae7fb89879de9f0718?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2842827/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 27951091, "answer_count": 1, "score": 2, "last_activity_date": 1421264576, "creation_date": 1420641243, "last_edit_date": 1421263547, "question_id": 27821738, "link": "https://stackoverflow.com/questions/27821738/queries-in-c-and-access-vba-producing-different-results", "title": "Queries in c# and access vba producing different results", "body": "<p>I'm in the process of writing a c#/.net4.0 program to replace an access vba module.  I'm getting different results from running the same queries.</p>\n\n<p>vba query:</p>\n\n<pre><code>dbs.Execute \"INSERT INTO tmpTable ( L1, D1, L2, UserID, FmN ) \" &amp; _\n  \"SELECT Table1.Field1, Table2.Field1, \" &amp; _\n  \"Sum(Table2.Field2) AS SumOfNoWork, '\" &amp; stringUser &amp; \"' AS Expr1, 'rampup' AS Expr2 \" &amp; _\n  \"FROM Table1 INNER JOIN Table2 ON Table1.Field2 = Table2.Field3 \" &amp; _\n  \"WHERE (((Table2.Field4) = 6)) \" &amp; _\n  \"GROUP BY Table1.Field1, Table2.Field1, '\" &amp; stringUser &amp; \"', 'rampup';\"\n</code></pre>\n\n<p>c# query:</p>\n\n<pre><code>string exec1 = \"INSERT INTO tmpTable ( L1, D1, L2, UserID, FmN ) \" + \n  \"SELECT Table1.Field1, Table2.Field1, \" +\n  \"Sum(Table2.Field2) AS SumOfNoWork, '\" + stringUser + \"' AS Expr1, 'rampup' AS Expr2 \" +\n  \"FROM Table1 INNER JOIN Table2 ON Table1.Field2 = Table2.Field3 \" +\n  \"WHERE (((Table2.Field4) = 6)) \" +\n  \"GROUP BY Table1.Field1, Table2.Field1, '\" &amp; stringUser &amp; \"', 'rampup';\";\n\nusing (OleDbConnection conn = new OleDbConnection(strconn)) \n{ conn.Open(); OleDbCommand comm = new OleDbCommand(exec1, conn);  \n  comm.ExecuteNonQuery(); conn.Close(); }\n</code></pre>\n\n<p>I compared the results after running both of them.  Looking at tempTable from the insert query, fields D1 and FmN are the same, but L1 and L2 differ between the c# and vba version in 11 of the 100 rows.  Also, they are inserted in a different order.</p>\n\n<p>There aren't any exceptions in the c# version, but could this be a result of the access expression service?  Any reasons why the rows would be inserted in a different order and some different between vba and ace.oledb.12.0?  </p>\n\n<p><strong>Edit:</strong> I found something I hadn't noticed earlier - L1 and L2 are long integer types, D1 is datetime, userid and fmn are strings.  After executing these, the rows inserted into the tmpTable are in completely different orders with respect to datetime D1.  If I sort the table by D1 and compare the results from the two, all of the data is the same except in 11 of 100 rows, where L1 and L2 are different.  After looking closer, the data is the same except that for these 11 rows, the datetimes are the same so they don't sort correctly.</p>\n\n<p><strong>The question is:</strong>  Why are the queries inserting the rows in different orders with respect to D1 between executing the same query in Access/vba versus c#/.net/ace.oledb.12.0?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 2, "creation_date": 1420642796, "post_id": 27821680, "comment_id": 44050103, "body": "Did you try it without <code>Set</code>?  I&#39;ve seen <code>Set</code> used to define a variable with an object, but never the other way around."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420643222, "post_id": 27821680, "comment_id": 44050392, "body": "What is the type of <code>XValues</code>? I think @Chrismas007 is on to something."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 4, "creation_date": 1420643275, "post_id": 27821680, "comment_id": 44050423, "body": "Does your chart have a SeriesCollection added already? If not, you will need to add one like this <code>MyChartSheet_1.SeriesCollection.NewSeries</code>. The <code>NewSeries</code> method adds a series everytime you call it."}, {"owner": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1420646612, "post_id": 27821680, "comment_id": 44052763, "body": "@Chrismas007 I have tried without Set but it gives the same error"}, {"owner": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420646706, "post_id": 27821680, "comment_id": 44052816, "body": "@laylarenee exactly this was the problem. Thank you, you can add it as an answer."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420647607, "post_id": 27821680, "comment_id": 44053426, "body": "My answer has been added!"}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1466975095, "post_id": 27823694, "comment_id": 63526266, "body": "Also, you don&#39;t use Set, you just assign the values with an equals sign. @laylarenee did this but I think it must have attention drawn to it."}], "tags": [], "owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "is_accepted": true, "score": 7, "last_activity_date": 1466975038, "last_edit_date": 1466975038, "creation_date": 1420647260, "answer_id": 27823694, "question_id": 27821680, "link": "https://stackoverflow.com/questions/27821680/how-to-assign-xvalues-for-excel-chart-using-vba/27823694#27823694", "title": "How to assign XValues for excel chart using VBA", "body": "<p>Before you can set the Values and XValues of a series, you will need to add the series first. This is simple to do using the <code>SeriesCollection.NewSeries</code> method as show below:</p>\n\n<pre><code>With ActiveSheet.ChartObjects.Add(a, b, 900, 300) ' Left, Top, Width, Height\n    With .Chart\n        .ChartType = xlBarClustered\n\n        ' need to add the series before you can assign the values/xvalues\n        ' calling the \"NewSeries\" method add one series each time you call it.\n\n        .SeriesCollection.NewSeries\n\n        ' now that the series is added, you may assign (not set) the values/xvalues\n\n        .SeriesCollection(1).XValues = XLabels\n        .SeriesCollection(1).Values = DataValues\n    End With\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1466975189, "post_id": 37998822, "comment_id": 63526284, "body": "You can indeed use named ranges for .XValues or .Values."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1473256513, "post_id": 37998822, "comment_id": 66071630, "body": "Also, while you can&#39;t include names beginning with &quot;R&quot; or &quot;C&quot; in the series formula (manually or in VBA), you can include them using <code>.Values =</code> or <code>.XValues =</code> (manually in the Select Data dialog or in VBA)."}], "tags": [], "owner": {"reputation": 1, "user_id": 6505716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c566400bb510e0cdcf33dffc46bf03c?s=128&d=identicon&r=PG", "display_name": "Thomas Hartl", "link": "https://stackoverflow.com/users/6505716/thomas-hartl"}, "is_accepted": false, "score": -1, "last_activity_date": 1466705155, "creation_date": 1466705155, "answer_id": 37998822, "question_id": 27821680, "link": "https://stackoverflow.com/questions/27821680/how-to-assign-xvalues-for-excel-chart-using-vba/37998822#37998822", "title": "How to assign XValues for excel chart using VBA", "body": "<p>You cannot use named ranges for .XValues or .Values, but you can change the .Formula property by replacing the series formula</p>\n\n<p>For more information on editing the series formula see <a href=\"http://peltiertech.com/change-series-formula-improved-routines/\" rel=\"nofollow\">http://peltiertech.com/change-series-formula-improved-routines/</a></p>\n\n<p>Note of caution, there is a bug in Excel 2013 that prevents you from using named ranges starting with \"R\" or \"C\" when using VBA to change the series formula; see <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/named-range-use-in-chart-series-formulas-causes/c5a40317-c33f-4a83-84db-0eeee5c8827f/?auth=1&amp;rtAction=1466703182593\" rel=\"nofollow\">http://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/named-range-use-in-chart-series-formulas-causes/c5a40317-c33f-4a83-84db-0eeee5c8827f/?auth=1&amp;rtAction=1466703182593</a></p>\n"}], "owner": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24900, "favorite_count": 0, "accepted_answer_id": 27823694, "answer_count": 2, "score": 2, "last_activity_date": 1466975038, "creation_date": 1420640996, "last_edit_date": 1531164843, "question_id": 27821680, "link": "https://stackoverflow.com/questions/27821680/how-to-assign-xvalues-for-excel-chart-using-vba", "title": "How to assign XValues for excel chart using VBA", "body": "<p>I have this VBA function for drawing charts in Excel 2013:</p>\n\n<pre><code>Sub DrawChart2(obj_worksheetTgt As Worksheet, ByVal XLabels As Range, ByVal DataValues As Range, ByVal chartTitle As String, a As Integer, b As Integer)\n'\n'obj_worksheetTgt   - Object worksheet on which to be placed the chart\n'XLabels            - Data range for X labels\n'DataValues         - Data range for Y values\n'chartTitle         - Chart title\n'a                  - left border position of chart in pixels\n'b                  - top border position of chart in pixels\n\n\nWith obj_worksheetTgt.ChartObjects.Add(a, b, 900, 300) ' Left, Top, Width, Height\n    With .Chart\n        .ChartType = xlBarClustered  \n        Set .SeriesCollection(1).XValues = XLabels ' Here is the error\n        Set .SeriesCollection(1).Values = DataValues\n        .Legend.Position = -4107\n        .HasTitle = True\n        .chartTitle.Text = chartTitle\n        .chartTitle.Font.Size = 12\n        With .Axes(1).TickLabels\n            .Font.Size = 8\n            .Orientation = 90\n        End With\n    End With\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I call the function this way:</p>\n\n<pre><code>ChartsWorksheet = \"Summary\"\nQueryname = \"query1\"\nchartTitle = \"Values\"\nWith .Worksheets(\"LastDayData\").ListObjects(Queryname)\n    Set chart_labels = .ListColumns(2).DataBodyRange\n    Set chart_values = .ListColumns(6).DataBodyRange\nEnd With\nCall DrawChart2(.Worksheets(ChartsWorksheet), chart_labels, chart_values, chartTitle, 10, 10)\n</code></pre>\n\n<p>And I receive an error: </p>\n\n<blockquote>\n  <p>Runtime Error '1004':</p>\n  \n  <p>Invalid Parameter</p>\n</blockquote>\n\n<p>When I click debug it marks the row \"Set .SeriesCollection(1).XValues = XLabels\" in the function above.</p>\n\n<p>In the documentation is written: </p>\n\n<blockquote>\n  <p>The XValues property can be set to a range on a worksheet or to an\n  array of values, but it cannot be a combination of both</p>\n</blockquote>\n\n<p>So it should be able to take the given range as values for XValues, but I can't understand why this error appears.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 100, "user_id": 4411380, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1080056110/picture?type=large", "display_name": "Reuben Molloy", "link": "https://stackoverflow.com/users/4411380/reuben-molloy"}, "edited": false, "score": 0, "creation_date": 1420643499, "post_id": 27821557, "comment_id": 44050565, "body": "I have tried different data types; If Queried value and filter are <b>Dates</b>; the result is 0 If <b>String</b> the result is All When the filter is applied"}], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 4411380, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1080056110/picture?type=large", "display_name": "Reuben Molloy", "link": "https://stackoverflow.com/users/4411380/reuben-molloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1420694867, "last_edit_date": 1495535599, "creation_date": 1420694867, "answer_id": 27833487, "question_id": 27821557, "link": "https://stackoverflow.com/questions/27821557/millisecond-time-filter-form-by-date/27833487#27833487", "title": "Millisecond time: Filter form by date", "body": "<p>Answer! From @pathDongle</p>\n\n<p>Time is stored as Millisecond UTC;</p>\n\n<pre><code>!DateTimeMS = GetTimeUTC()\n</code></pre>\n\n<p>And restored by;</p>\n\n<pre><code>Public Function UTCtoTimeLocal(dSysUTC As Date) As Date\n'Dim sysTime As SYSTEMTIME\n    Dim DST As Long\n    Dim tzi As TIME_ZONE_INFORMATION\n\n    DST = GetTimeZoneInformation(tzi)\n    UTCtoTimeLocal = dSysUTC - TimeSerial(0, tzi.Bias, 0) + IIf(DST = 2, TimeSerial(1, 0, 0), 0)\nEnd Function\n</code></pre>\n\n<p>Query;</p>\n\n<pre><code>SELECT tblzzAuditTrail.DateTimeMS, FormatDate(UTCtoTimeLocal([DateTimeMS])) AS DateTimeLocal\n</code></pre>\n\n<p>Which can be filtered on as a String.</p>\n\n<pre><code>Private Sub BuildFilter()\n    Dim strFilter As String\n    Dim ctl As Control\n\n    strFilter = \"\"\n\n'add selected values to string\n    For Each ctl In Me.FormHeader.Controls\n        With ctl\n            If .ControlType = acTextBox Or .ControlType = acComboBox Then\n                If Nz(.Value) &lt;&gt; \"\" Then\n                    If InStr(.Name, \"Date\") &lt;&gt; 0 Then\n                        If Nz(StartDate) &lt;&gt; \"\" And Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] BETWEEN '\" &amp; FormatDate(Me.StartDate.Value) &amp; \"' AND '\" &amp; FormatDate(Me.EndDate.Value) &amp; \"' AND \"\n                        ElseIf Nz(StartDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] &gt; '\" &amp; FormatDate(Me.StartDate.Value) &amp; \"' AND \"\n                        ElseIf Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] &lt;= '\" &amp; FormatDate(Me.EndDate.Value) &amp; \"' AND \"\n                        End If\n                    ElseIf InStr(.Name, \"ID\") &lt;&gt; 0 Then\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = \" &amp; .Value &amp; \" AND \"\n                    Else\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = '\" &amp; .Value &amp; \"' AND \"\n                    End If\n                End If\n            End If\n        End With\n    Next ctl\n'trim trailing And\n    strFilter = TrimR(strFilter, 5)\n\nDebug.Print strFilter\n    With Me.subfrmzzAuditTrailDisplay\n        .Form.Filter = strFilter\n        .Form.FilterOn = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Resulting Filter String;</p>\n\n<pre><code>[UserID] = 2 AND [DateTimeLocal] BETWEEN '06/01/2015 00:00:00.000' AND '07/01/2015 00:00:00.000'\n</code></pre>\n\n<p>As per my other question;</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27816493/millisecond-time-msec2-incorrect-return\">millisecond-time-msec2-incorrect-return</a></p>\n"}], "owner": {"reputation": 100, "user_id": 4411380, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1080056110/picture?type=large", "display_name": "Reuben Molloy", "link": "https://stackoverflow.com/users/4411380/reuben-molloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420694867, "creation_date": 1420640625, "last_edit_date": 1420643616, "question_id": 27821557, "link": "https://stackoverflow.com/questions/27821557/millisecond-time-filter-form-by-date", "title": "Millisecond time: Filter form by date", "body": "<p>I am trying to implement millisecond timestamping in Access 2010/13 using this method; \n<a href=\"http://www.devx.com/dbzone/Article/39046\" rel=\"nofollow\">MS Access Can Handle Millisecond Time Values--Really - See more at: </a></p>\n\n<p>The Millisecond value is queried by; \n<code>SELECT DateValueMsec([DateTimeMs]) AS DateOnly FROM</code> - to provide a date only control to sort the form from a textbox.\nAny filter applied programmatically on DateOnly yeilds 0 results.</p>\n\n<pre><code>Private Sub BuildFilter()\n    Dim strFilter As String\n    Dim ctl As Control\n\n    strFilter = \"\"\n\n'add selected values to string\n    For Each ctl In Me.FormHeader.Controls\n        With ctl\n            If .ControlType = acTextBox Or .ControlType = acComboBox Then\n                If Nz(.Value) &lt;&gt; \"\" Then\n                    If InStr(.Name, \"Date\") &lt;&gt; 0 Then\n                        If Nz(StartDate) &lt;&gt; \"\" And Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateOnly\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateOnly] BETWEEN #\" &amp; Me.StartDate.Value &amp; \"# AND #\" &amp; Me.EndDate.Value &amp; \"# AND \"\n                        ElseIf Nz(StartDate) &lt;&gt; \"\" And InStr(strFilter, \"DateOnly\") = 0 Then\n                       strFilter = strFilter &amp; \"[DateOnly] &gt;= #\" &amp; DateValueMsec(Me.StartDate.Value) &amp; \"# AND \"\n                     '       strFilter = strFilter &amp; \"[DateOnly] &gt;= #\" &amp; Me.StartDate.Value &amp; \"# AND \"\n                        ElseIf Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateOnly\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateOnly] &lt;= #\" &amp; Me.EndDate.Value &amp; \"# AND \"\n                        End If\n                    ElseIf InStr(.Name, \"ID\") &lt;&gt; 0 Then\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = \" &amp; .Value &amp; \" AND \"\n                    Else\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = '\" &amp; .Value &amp; \"' AND \"\n                    End If\n                End If\n            End If\n        End With\n    Next ctl\n'trim trailing\n    strFilter = TrimR(strFilter, 5)\n\nDebug.Print strFilter\n    With Me.subfrmzzAuditTrailDisplay\n        .Form.Filter = strFilter\n        .Form.FilterOn = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "clipboard", "vba"], "comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420639782, "post_id": 27821075, "comment_id": 44048178, "body": "Copy/paste or keyed or get from VBA does no matter, result the same"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420640900, "post_id": 27821075, "comment_id": 44048894, "body": "Yes but it is no change anything i tryed trim newline and the same"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420641294, "post_id": 27821075, "comment_id": 44049140, "body": "Maybe you right man, so how to trim them?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420641330, "post_id": 27821075, "comment_id": 44049164, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/68347/discussion-between-dmitrij-holkin-and-pnuts\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1420639421, "post_id": 27821173, "comment_id": 44047945, "body": "Yes I&#39;m shure! you can test by yourself"}, {"owner": {"reputation": 144, "user_id": 4299441, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c19a79107735dd05f5df5ad080b91176?s=128&d=identicon&r=PG&f=1", "display_name": "AngularDev", "link": "https://stackoverflow.com/users/4299441/angulardev"}, "edited": false, "score": 0, "creation_date": 1420639505, "post_id": 27821173, "comment_id": 44047997, "body": "yaa i have tested it and it didn&#39;t actually doubled the <code>&quot;</code> only problem was that first single quote was missing which is natural in case of Excel"}, {"owner": {"reputation": 144, "user_id": 4299441, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c19a79107735dd05f5df5ad080b91176?s=128&d=identicon&r=PG&f=1", "display_name": "AngularDev", "link": "https://stackoverflow.com/users/4299441/angulardev"}, "edited": false, "score": 0, "creation_date": 1420639616, "post_id": 27821173, "comment_id": 44048063, "body": "YOU MUST BE DOING IT IN vba I GUESS"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1420639661, "post_id": 27821173, "comment_id": 44048098, "body": "I do this in VBA also and result is the same"}, {"owner": {"reputation": 144, "user_id": 4299441, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c19a79107735dd05f5df5ad080b91176?s=128&d=identicon&r=PG&f=1", "display_name": "AngularDev", "link": "https://stackoverflow.com/users/4299441/angulardev"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1420640089, "post_id": 27821173, "comment_id": 44048374, "body": "DO <code>cell.PrefixCharacter &amp; cell.Value</code> to get the proper string in VBA"}], "tags": [], "owner": {"reputation": 144, "user_id": 4299441, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c19a79107735dd05f5df5ad080b91176?s=128&d=identicon&r=PG&f=1", "display_name": "AngularDev", "link": "https://stackoverflow.com/users/4299441/angulardev"}, "is_accepted": true, "score": 0, "last_activity_date": 1420639332, "creation_date": 1420639332, "answer_id": 27821173, "question_id": 27821075, "link": "https://stackoverflow.com/questions/27821075/excel-copy-from-cell-to-clipboard/27821173#27821173", "title": "Excel copy from cell to clipboard", "body": "<p>Excel identifies the first <code>'</code> as Symbol that the value in a cell is text.</p>\n\n<p>And are you sure it is doubling the <code>\"</code> when pasting it into notepad?</p>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 27821173, "answer_count": 1, "score": 0, "last_activity_date": 1420640362, "creation_date": 1420639003, "last_edit_date": 1531161705, "question_id": 27821075, "link": "https://stackoverflow.com/questions/27821075/excel-copy-from-cell-to-clipboard", "title": "Excel copy from cell to clipboard", "body": "<p>In Excel 2013 into cell i post this string</p>\n\n<pre><code>'&lt;xml xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;'\n</code></pre>\n\n<p>Then i copying this cell to clipboard using ctrl+c and post to notepad using ctrl+v I get this</p>\n\n<pre><code>\"&lt;xml xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\"&gt;'\n\"\n</code></pre>\n\n<p>So all my string became quoted and trimed first single quote, also added additional quotes to url, how to prevent changes and get string as it is.</p>\n\n<p><img src=\"https://i.stack.imgur.com/DTJGt.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "edited": false, "score": 0, "creation_date": 1420636379, "post_id": 27820166, "comment_id": 44046217, "body": "try use <code>for each sheets</code> loop :) . Have a nice day :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4428884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9576ac67ca12e49aa173d17ca47e3b45?s=128&d=identicon&r=PG&f=1", "display_name": "KIMco", "link": "https://stackoverflow.com/users/4428884/kimco"}, "edited": false, "score": 0, "creation_date": 1420645587, "post_id": 27820366, "comment_id": 44052113, "body": "I tried the both proposals. The first one did not run, but the second one ( provided by Sathish K) did the job. Thank you guys!"}, {"owner": {"reputation": 1497, "user_id": 968318, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/noL7T.jpg?s=128&g=1", "display_name": "Sathish Kothandam", "link": "https://stackoverflow.com/users/968318/sathish-kothandam"}, "reply_to_user": {"reputation": 23, "user_id": 4428884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9576ac67ca12e49aa173d17ca47e3b45?s=128&d=identicon&r=PG&f=1", "display_name": "KIMco", "link": "https://stackoverflow.com/users/4428884/kimco"}, "edited": false, "score": 0, "creation_date": 1420696235, "post_id": 27820366, "comment_id": 44072886, "body": "Glad i could help . don&#39;t forget to accept the appropriate answer"}], "tags": [], "owner": {"reputation": 1497, "user_id": 968318, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/noL7T.jpg?s=128&g=1", "display_name": "Sathish Kothandam", "link": "https://stackoverflow.com/users/968318/sathish-kothandam"}, "is_accepted": true, "score": 5, "last_activity_date": 1420636519, "creation_date": 1420636519, "answer_id": 27820366, "question_id": 27820166, "link": "https://stackoverflow.com/questions/27820166/macro-to-delete-the-first-rows-in-all-existing-sheets-in-excel/27820366#27820366", "title": "Macro to delete the first rows in all existing sheets in Excel", "body": "<p>Atleast try to post what you have tried.</p>\n\n<p>below code will delete 1st in all sheets in active workbook</p>\n\n<pre><code>Sub LoopThroughSheets()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n\n     ws.Range(\"1:1\").Delete\n\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4428884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9576ac67ca12e49aa173d17ca47e3b45?s=128&d=identicon&r=PG&f=1", "display_name": "KIMco", "link": "https://stackoverflow.com/users/4428884/kimco"}, "edited": false, "score": 0, "creation_date": 1421835453, "post_id": 27820375, "comment_id": 44509460, "body": "Hi, Could you please update the macro with task do replace all &quot;<i>&quot; with &quot;&quot; (</i> with empty symbol) for the first row after the deletion. I mean after the first row is deleted the replacement to be done for the new first row in every sheet. If it is done with two cycles is fine too."}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1420636544, "creation_date": 1420636544, "answer_id": 27820375, "question_id": 27820166, "link": "https://stackoverflow.com/questions/27820166/macro-to-delete-the-first-rows-in-all-existing-sheets-in-excel/27820375#27820375", "title": "Macro to delete the first rows in all existing sheets in Excel", "body": "<pre><code>Private Sub deleteRows()\n\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Sheets\n        ws.Range(\"A1\").EntireRow.Delete\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4428884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9576ac67ca12e49aa173d17ca47e3b45?s=128&d=identicon&r=PG&f=1", "display_name": "KIMco", "link": "https://stackoverflow.com/users/4428884/kimco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16217, "favorite_count": 1, "accepted_answer_id": 27820366, "answer_count": 2, "score": 0, "last_activity_date": 1420636544, "creation_date": 1420635837, "last_edit_date": 1531164843, "question_id": 27820166, "link": "https://stackoverflow.com/questions/27820166/macro-to-delete-the-first-rows-in-all-existing-sheets-in-excel", "title": "Macro to delete the first rows in all existing sheets in Excel", "body": "<p>I have an excel file with around 300 sheets for which I need to remove the first rows.\nCould you please suggest VBA code for doing this?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 1, "creation_date": 1420634478, "post_id": 27819719, "comment_id": 44045144, "body": "In what way is this connected to opening a hyperlink?"}, {"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1420636156, "post_id": 27819719, "comment_id": 44046096, "body": "Oh now I see, I was misunderstanding due to the title. Is the column in your table set to hyperlink? If it is, try using a query to update the records."}, {"owner": {"reputation": 1, "user_id": 4300221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1489393545/picture?type=large", "display_name": "Saar Bitton", "link": "https://stackoverflow.com/users/4300221/saar-bitton"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1420636395, "post_id": 27819719, "comment_id": 44046224, "body": "i dont want query to uptade them... this short vba do this allready and this is in AutoExe..."}, {"owner": {"reputation": 1, "user_id": 4300221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1489393545/picture?type=large", "display_name": "Saar Bitton", "link": "https://stackoverflow.com/users/4300221/saar-bitton"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1420636463, "post_id": 27819719, "comment_id": 44046251, "body": "and in the table i see the links and the hand pointer are appears on it but when i click nothing happend"}, {"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1421056061, "post_id": 27819719, "comment_id": 44198135, "body": "Well, if &#39;Nothing&#39; happens, not even an error message of any kind, I can&#39;t help you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4300221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1489393545/picture?type=large", "display_name": "Saar Bitton", "link": "https://stackoverflow.com/users/4300221/saar-bitton"}, "edited": false, "score": 0, "creation_date": 1420636574, "post_id": 27820325, "comment_id": 44046313, "body": "it is if i enter the path+filename manual by writing or copy past it will work"}], "tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1420636390, "creation_date": 1420636390, "answer_id": 27820325, "question_id": 27819719, "link": "https://stackoverflow.com/questions/27819719/access-vba-hperling-wont-work/27820325#27820325", "title": "access vba hperling wont work", "body": "<p>If clicking the link throws an error, it is because the link provided is incorrect, but since nothing happens, the problem is probably caused by a wrong datatype in your table.</p>\n\n<p>Go to the design view of your table, and set the datatype to <em>Hyperlink</em>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4300221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1489393545/picture?type=large", "display_name": "Saar Bitton", "link": "https://stackoverflow.com/users/4300221/saar-bitton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420636390, "creation_date": 1420634335, "question_id": 27819719, "link": "https://stackoverflow.com/questions/27819719/access-vba-hperling-wont-work", "title": "access vba hperling wont work", "body": "<pre><code> Dim dbs As DAO.Database\n Dim rst As DAO.Recordset\n\n    Set dbs = CurrentDb\n    Set rst = dbs.OpenRecordset(\"\u05d9\u05d5\u05de\u05df \u05ea\u05e7\u05dc\u05d5\u05ea\")\n    Dim str As String\n   rst.MoveFirst\n\n    Do Until rst.EOF\n          If IsNull(rst!\u05d0\u05d9\u05e9\u05d5\u05e8) Then\n               str = rst![\u05de\u05e1' \u05ea\u05e7\u05dc\u05d4]\n               rst.Edit\n          rst!\u05d0\u05d9\u05e9\u05d5\u05e8 = \"C:\\test\\pic\\\" + str + \".jpg\"\n          rst.Update\n          End If\n       rst.MoveNext\n    Loop\n</code></pre>\n\n<p>i have this code and it work perfect\nbut when im trying to press the hyperlink nothing heppned\nthe path is ok and also the file name\ni tried to rightClick->hyperling->open hyperling and nothng also\nplease help me</p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 1205, "user_id": 2575630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iI59n.jpg?s=128&g=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/2575630/robert"}, "edited": false, "score": 0, "creation_date": 1420634349, "post_id": 27819611, "comment_id": 44045075, "body": "Don&#39;t know if it helps but found a piece of doc about a convert function: i.e. Format (Now, \u201cMM/dd/yyyy\u201d) <a href=\"https://www.udemy.com/blog/vba-format-date/\" rel=\"nofollow noreferrer\">udemy.com/blog/vba-format-date</a>"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 1205, "user_id": 2575630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iI59n.jpg?s=128&g=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/2575630/robert"}, "edited": false, "score": 0, "creation_date": 1420634480, "post_id": 27819611, "comment_id": 44045146, "body": ":/ I read that a while ago!"}, {"owner": {"reputation": 1205, "user_id": 2575630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iI59n.jpg?s=128&g=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/2575630/robert"}, "edited": false, "score": 0, "creation_date": 1420634671, "post_id": 27819611, "comment_id": 44045262, "body": "However, since the columns should be date fields, the format shouldn&#39;t have any effect on the comparison, or am I wrong!? Is it possible that <code>[Orders].[Date]</code> is of another type (maybe a text)?"}, {"owner": {"reputation": 118, "user_id": 1152502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5abb78faa4f410ee891715c5016589?s=128&d=identicon&r=PG", "display_name": "Fabooo", "link": "https://stackoverflow.com/users/1152502/fabooo"}, "edited": false, "score": 0, "creation_date": 1420634690, "post_id": 27819611, "comment_id": 44045270, "body": "I would do a &quot;select getDate()&quot; and watch the format returned then use that format in the query. Another thing is that he formatting of the dates is a localization setting for the database."}, {"owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "edited": false, "score": 0, "creation_date": 1420634887, "post_id": 27819611, "comment_id": 44045372, "body": "Your belief is incorrect. Is the date column of type date is one question. The other is what&#39;s the locale of the server i.e. is it treating 08/05/2015 as the 8th of May or the 5th of August. If you want between to work properly it should be using dates, formatting is irrelevant."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "edited": false, "score": 0, "creation_date": 1420635083, "post_id": 27819611, "comment_id": 44045484, "body": "@TonyHopkinson, Formatting will do the job, if the date will be formated in ISO standard: MM/dd/yyyy"}, {"owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1420649038, "post_id": 27819611, "comment_id": 44054349, "body": "@MaciejLos, This is one of those just because you can doesn&#39;t mean you should things in my book."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "edited": false, "score": 0, "creation_date": 1420649247, "post_id": 27819611, "comment_id": 44054490, "body": "So the RDBM system will compare dates whether mm/dd/yyyy or dd/mm/yyyy. It depends how it treats the input days? @TonyHopkinson"}, {"owner": {"reputation": 19518, "user_id": 968969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0802303aaa5f03f4cec652171dffcbc7?s=128&d=identicon&r=PG", "display_name": "Tony Hopkinson", "link": "https://stackoverflow.com/users/968969/tony-hopkinson"}, "edited": false, "score": 0, "creation_date": 1420663407, "post_id": 27819611, "comment_id": 44062478, "body": "Sure it&#39;s assuming based on it&#39;s current locale. Change your settings and 5/8 is August. The format idea works as would using an unambiguous date format. Lost count of how many times I&#39;ve seen people trip over this one &#39;05/08/2005&#39; is not a date, it&#39;s a string.."}], "answers": [{"comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1420635280, "post_id": 27819883, "comment_id": 44045586, "body": "I can&#39;t use that. VBA has &quot; problems. Can you format it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 1, "creation_date": 1420635468, "post_id": 27819883, "comment_id": 44045690, "body": "try <code>between #&quot; &amp; Format([StartDate], &quot;MM&#47;dd&#47;yyyy&quot;) &amp; &quot;# AND #&quot; &amp; Format([EndDate], &quot;MM&#47;dd&#47;yyyy&quot;) &amp; &quot;#&quot;</code>"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1420635668, "last_edit_date": 1420635668, "creation_date": 1420634916, "answer_id": 27819883, "question_id": 27819611, "link": "https://stackoverflow.com/questions/27819611/how-to-format-date-in-a-sql-query/27819883#27819883", "title": "How to format date in a SQL query?", "body": "<p>Use <a href=\"http://www.techonthenet.com/access/functions/date/format.php\" rel=\"nofollow\">Format function</a>.</p>\n\n<pre><code>SQL = \"SELECT COUNT(Date)\" &amp; vbcr &amp; _\n\"FROM [Orders]\" &amp; vbcr &amp; _\n\"WHERE [Orders].[Date] BETWEEN #Format(\" &amp; StartDate &amp; \"], 'MM/dd/yyyy')# AND #Format(\" &amp; EndDate &amp; \",'MM/dd/yyyy')#\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 2, "last_activity_date": 1420635619, "creation_date": 1420635619, "answer_id": 27820095, "question_id": 27819611, "link": "https://stackoverflow.com/questions/27819611/how-to-format-date-in-a-sql-query/27820095#27820095", "title": "How to format date in a SQL query?", "body": "<p>Always use ISO date formatting YYYY-MM-DD and you will have no problems. Without formatting.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8541590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20003d17cbddf0d06788e598c80a708f?s=128&d=identicon&r=PG", "display_name": "George Tomeh", "link": "https://stackoverflow.com/users/8541590/george-tomeh"}, "is_accepted": false, "score": 1, "last_activity_date": 1504161183, "last_edit_date": 1504161183, "creation_date": 1504160055, "answer_id": 45974452, "question_id": 27819611, "link": "https://stackoverflow.com/questions/27819611/how-to-format-date-in-a-sql-query/45974452#45974452", "title": "How to format date in a SQL query?", "body": "<p>I have noticed from the SQL compilation of the query when using Between, that it turns it to MM/DD/YYYY and it did not work till I used Format(startdate, \"mm/dd/yyyy\"). Please check the snapshop.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gwsun.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gwsun.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16806, "favorite_count": 0, "accepted_answer_id": 27819883, "answer_count": 3, "score": 0, "last_activity_date": 1504161183, "creation_date": 1420633981, "last_edit_date": 1420635651, "question_id": 27819611, "link": "https://stackoverflow.com/questions/27819611/how-to-format-date-in-a-sql-query", "title": "How to format date in a SQL query?", "body": "<p>Hello I'm using MS JET OLEDB 4.0 on VBA (MS ACCESS)</p>\n\n<pre><code>SQL = \"SELECT COUNT(Date) FROM [Orders] WHERE [Orders].[Date] BETWEEN \" &amp; \"#\" &amp; StartDate &amp; \"#\" &amp; \" AND \" &amp; \"#\" &amp; EndDate &amp; \"#\"\n</code></pre>\n\n<p>The [Date] is formatted like f dd/mm/yyyy (French) and the StartDate and EndDate are formatted like mm/dd/yyyy (Two date objects). </p>\n\n<p>My belief is that BETWEEN only compares dates formatted mm/dd/yyyy, so is there a way like a function to convert the [Date] formatting into mm/dd/yyyy so the between function can compare correctly?</p>\n\n<p>Edit: Using a string instead of the dates like follow:</p>\n\n<pre><code>StartDateFormatted = Format(StartDate,\"dd/mm/yyyy\")\nEndDateFormatted = Format(EndDate,\"dd/mm/yyyy\")\n</code></pre>\n\n<p>So as to be sure of the startdate and enddate format. It doesn't work still.</p>\n\n<p>I'm left to assume two things:</p>\n\n<ul>\n<li><p>Either BETWEEN onlys compares mm/dd/yyyy formats</p></li>\n<li><p>I have to use a function to format [Date] to mm/dd/yyyy</p></li>\n</ul>\n\n<p>Thanks to @Maciej Los for answering my question.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "edited": false, "score": 0, "creation_date": 1420635663, "post_id": 27819461, "comment_id": 44045796, "body": "Can you provide a sample of duplicate rows that are not deleting? The only time I&#39;m seeing issues are when there are blank cells in the rows."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "edited": false, "score": 0, "creation_date": 1420635628, "post_id": 27819972, "comment_id": 44045778, "body": "First of all thanks for your quick answer! But the same lines are still there :/"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "edited": false, "score": 0, "creation_date": 1420636436, "post_id": 27819972, "comment_id": 44046239, "body": "@Cryxon  -Pick two values that look like they are duplicates; say A5 and A9. In an unused row, use this formula =CODE(MID($A$5, COLUMN(A:A), 1)) and underneath it use the same formula replacing $A$5 with $A$9. Fill right. Are the numbers generated exactly the same?"}, {"owner": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "edited": false, "score": 0, "creation_date": 1420700414, "post_id": 27819972, "comment_id": 44074260, "body": "I picked 2 rows that are exact the same and checked it with the formular. I changed the commas in semicolons and the outpot was &quot;#NAME?&quot;. So I checked the values of the rows with the formular =CODE() and the values were exact the same."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "edited": false, "score": 0, "creation_date": 1420700759, "post_id": 27819972, "comment_id": 44074380, "body": "Upload a sample of the &#39;duplicate&#39; data in a redacted worksheet to a public file repository and post a <i>publically shared</i> link to the worksheet back here in your original question."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1420635209, "creation_date": 1420635209, "answer_id": 27819972, "question_id": 27819461, "link": "https://stackoverflow.com/questions/27819461/delete-all-duplicate-rows-excel-vba-doesn%c2%b4t-work-correctly/27819972#27819972", "title": "Delete all duplicate rows Excel vba doesn&#180;t work correctly", "body": "<p>I strongly suspect that the negative sign is not a conventional <code>CHAR(45)</code> hyphen or has leading/trailing zeroes. Are some of the values left aligned while other are right aligned? This would indicate that some are considered <em>text</em> and others true <em>numbers</em>.</p>\n\n<p>The quickest way to remove leading/trailing spaces in a Text-to-Columns \u25ba Fixed Width on each column.</p>\n\n<pre><code>Sub DeleteRows()\n    Dim c As Long\n    With ActiveSheet\n        For c = 1 To 20\n            If Application.CountA(.Columns(c)) Then\n                .Columns(c).TextToColumns Destination:=.Cells(1, c), _\n                  DataType:=xlFixedWidth, FieldInfo:=Array(0, 1)\n            End If\n        Next c\n        With .Range(\"A1\", .Range(\"T1\").End(xlDown)).Cells\n            .RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20), Header:=xlYes\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>There may be less obvious reasons for this; non-breaking spaces (ASCII 160 or 0\u00d7A0) comes immediately to mind. In lieu of actually showing some sample data, you need to examine your values closely to see what is causing Excel not to treat the values as duplicates.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "is_accepted": true, "score": 1, "last_activity_date": 1421066434, "creation_date": 1421066434, "answer_id": 27902269, "question_id": 27819461, "link": "https://stackoverflow.com/questions/27819461/delete-all-duplicate-rows-excel-vba-doesn%c2%b4t-work-correctly/27902269#27902269", "title": "Delete all duplicate rows Excel vba doesn&#180;t work correctly", "body": "<p>I don\u00b4t know the real issue but i fixed it by adding a dot in each cell.\nExanmple:</p>\n\n<pre><code>1. Cell1  -&gt; .Cell1\n2. Remove the duplicates\n3. .Cell1 -&gt; Cell1\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub DeleteRows()\nDim c As Long\nWith ActiveSheet\n    For c = 1 To 20\n        If Application.CountA(.Columns(c)) Then\n            .Columns(c).TextToColumns Destination:=.Cells(1, c), _\n              DataType:=xlFixedWidth, FieldInfo:=Array(0, 1)\n        End If\n    Next c\n    With .Range(\"A1\", .Range(\"T1\").End(xlDown)).Cells\n        .RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20), Header:=xlYes\n    End With\nEnd With\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n.\n.'some code'\n.\nFor i = 2 To ActiveSheet.Cells(Rows.Count, 1).End(xlUp).row\n    column = ActiveSheet.Range(\"A\" &amp; i).value\n    If column &lt; 0 Then\n        column = \".\" &amp; column\n        ActiveSheet.Range(\"A\" &amp; i).value = column\n    End If\nNext\n\nCall DeleteRows\n\nFor i = 2 To ActiveSheet.Cells(Rows.Count, 1).End(xlUp).row\n    firstChar = Left(ActiveSheet.Range(\"A\" &amp; i).value, 1)\n    If firstChar = \".\" Then\n        column = Right(ActiveSheet.Range(\"A\" &amp; i).value, Len(ActiveSheet.Range(\"A\" &amp; i).value) - 1)\n        ActiveSheet.Range(\"A\" &amp; i).value = column\n    End If\nNext\n.\n.'some code'\n.\nEnd Sub\n</code></pre>\n\n<p>It\u00b4s not the best solution but it works!\nThx for the help.</p>\n"}], "owner": {"reputation": 171, "user_id": 4428711, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/774f501287165f482261bcaf238caad0?s=128&d=identicon&r=PG&f=1", "display_name": "Metabinary", "link": "https://stackoverflow.com/users/4428711/metabinary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2172, "favorite_count": 1, "accepted_answer_id": 27902269, "answer_count": 2, "score": 2, "last_activity_date": 1421066434, "creation_date": 1420633418, "last_edit_date": 1495541624, "question_id": 27819461, "link": "https://stackoverflow.com/questions/27819461/delete-all-duplicate-rows-excel-vba-doesn%c2%b4t-work-correctly", "title": "Delete all duplicate rows Excel vba doesn&#180;t work correctly", "body": "<p>I\u00b4ve created a workbook in excel with a userform which allows you to import .csv data in a worksheet.\nKnow I\u00b4ve the problem with duplicate rows. I found a solution here, but it is not working 100%.\n(<a href=\"https://stackoverflow.com/questions/16988816/delete-all-duplicate-rows-excel-vba\">Delete all duplicate rows Excel vba</a>) The script delete most of the duplicate data, but there are still 2-5 duplicate rows. First I thought it\u00b4s the format of the cells, but thats not the problem...</p>\n\n<p>Here is the makro:</p>\n\n<pre><code>    Sub DeleteRows()\n       With ActiveSheet\n           Set Rng = Range(\"A1\", Range(\"T1\").End(xlDown))\n            Rng.RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20), Header:=xlYes\n       End With\n    End Sub\n</code></pre>\n\n<p>The duplicate data which is left over start with a negativ number. I don\u00b4t know if this will help to find a solution ...</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 3912849, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/QDhC2.jpg?s=128&g=1", "display_name": "hunch", "link": "https://stackoverflow.com/users/3912849/hunch"}, "edited": false, "score": 0, "creation_date": 1420640041, "post_id": 27819977, "comment_id": 44048351, "body": "Thanks for your reply...can you please clear the concept little bit more, as VBA is object oriented and by defining an object of the same type(var1) and making it equal to same type of variable means object type(var2).. copies all the values in the defining variable(var1). So why this is not happening here. or vba is  not exactly object oreiented.."}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "reply_to_user": {"reputation": 279, "user_id": 3912849, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/QDhC2.jpg?s=128&g=1", "display_name": "hunch", "link": "https://stackoverflow.com/users/3912849/hunch"}, "edited": false, "score": 0, "creation_date": 1420640975, "post_id": 27819977, "comment_id": 44048938, "body": "As far as I understand it, and I could be corrected on this, it is because the default property of the Range object is .Value so when you make the Variant equal to the Range it is not making it the same object type (the reference to .Range is equivalent to .Range.Value - In the case of a single cell, it returns the value, if multiple cells are selected it returns an array of values)."}], "tags": [], "owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1420635598, "last_edit_date": 1420635598, "creation_date": 1420635224, "answer_id": 27819977, "question_id": 27819088, "link": "https://stackoverflow.com/questions/27819088/copying-the-selection-and-later-pasting-it/27819977#27819977", "title": "Copying the selection and later pasting it", "body": "<p>Your range creates a reference to that group of cells. What you are asking requires you to write the values into memory. This should do what you are asking:</p>\n\n<pre><code>Option Explicit\n\nPublic selArray As Variant    ' Add this global variable\nPublic SelRange As Range\n\nSub per_num()\n\nDim cell As Range\nSet SelRange = Selection\nselArray = SelRange    ' Returns the values from your range into a variant\n\nFor Each cell In Selection\n    'perform some action\nNext cell\n\nEnd Sub\n\nSub num_per()\n   ' if something is false\n   SelRange = selArray     ' Writes the values from the variant back into the range\n   Set SelRange = Nothing\n   If IsArray(selArray) Then Erase selArray\nEnd Sub\n</code></pre>\n\n<p>In the per_num sub, it creates the reference to your selection and writes the values into the selArray variable.</p>\n\n<p>In the num_per sub it writes the values back into the cells referred to by your range.</p>\n\n<p>*It is worth noting that selArray won't actually be an array if you have only selected one cell, the naming was just a hangover from my initial attempt.</p>\n"}], "owner": {"reputation": 279, "user_id": 3912849, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/QDhC2.jpg?s=128&g=1", "display_name": "hunch", "link": "https://stackoverflow.com/users/3912849/hunch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420635598, "creation_date": 1420632089, "last_edit_date": 1531161705, "question_id": 27819088, "link": "https://stackoverflow.com/questions/27819088/copying-the-selection-and-later-pasting-it", "title": "Copying the selection and later pasting it", "body": "<p>I need to store the selected cells and use their values in future. I am storing the the selection to a variable of range object and then i am modifying the selected cells. I am checking the results in other subroutine and if condition is false then i need to restore the values on the same range as it was previously.</p>\n\n<pre><code>Public hi, hj As Integer\n\nPublic ActSheet As Worksheet\n\nPublic SelRange As Range\n\nSub per_num()\n\n\nDim cell As Object\n\nSet ActSheet = ActiveSheet\nSet SelRange = Selection\nSelRange.Copy\n\n\n\nFor Each cell In Selection\n\n    'perform some action\n\nNext cell\n\nhi = Selection.Row\nhj = Selection.Column\n\n\nEnd Sub\n\n  Sub num_per()\n     if something is false\n     Cells(hi, hj).Select\n     SelRange.PasteSpecial xlPasteFormats \n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "reply_to_user": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "edited": false, "score": 0, "creation_date": 1420629864, "post_id": 27818316, "comment_id": 44042549, "body": "The pivot, just as the consolidate function, sums up all occurrences of X. I only want the adjacent ones summed up."}], "answers": [{"comments": [{"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420633900, "post_id": 27818790, "comment_id": 44044849, "body": "I get the following error: &quot;Run-time error &#39;438&#39;&quot;. I replaced 80 with 29990 since that is how many rows I have."}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420634197, "post_id": 27818790, "comment_id": 44044992, "body": "Please change Time stamp to Date type."}, {"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420634865, "post_id": 27818790, "comment_id": 44045359, "body": "Done. I&#39;ve also changed sheets to 2 and 3. And now it says Run-time error &#39;9&#39;: Script out of range. I&#39;ve changed the 29990 to 100, but that was not the source."}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420635958, "post_id": 27818790, "comment_id": 44045987, "body": "@FloIancu try add ActiveSheet.Sheets(&quot;nameOfYourSheet&quot;)."}, {"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420637204, "post_id": 27818790, "comment_id": 44046653, "body": "I replaced all Sheets(1) with ActiveSheet.Sheets(&quot;Sheet2&quot;) and so on and now I get Run-time error 91: Object variable or With block variable not set. Sorry for bothering you so much, I am completely clueless in VBA!"}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420637504, "post_id": 27818790, "comment_id": 44046852, "body": "@FloIancu It&#39;s no problem. We should help together :) Which line make this error? (try press F8 until the error)."}, {"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420638969, "post_id": 27818790, "comment_id": 44047672, "body": "<code>Name = ActiveSheet.Sheets(&quot;Sheet1&quot;).Cells(i, 2).Value</code> This is the one."}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420646973, "post_id": 27818790, "comment_id": 44053007, "body": "It&#39;s works on my example data. Even without <code>activesheet</code>. Make sure that in TimeStamp column you have right cell data type like <code>DD&#47;MM&#47;YYYY</code> or <code>MM&#47;DD&#47;YYYY</code> and in Value column you have only Integer. If you have long or sth else, you should change this type in VBA."}, {"owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420710056, "post_id": 27818790, "comment_id": 44078279, "body": "It hasn&#39;t properly worked for me, but that&#39;s maybe because my table is a lot more complicated than that and perhaps I&#39;m missing something. I will try to tweak the code until I get it right. In the meantime I&#39;m going to go ahead and mark your reply as the answer and I thank you for your effort and time, it&#39;s much appreciated!"}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "edited": false, "score": 0, "creation_date": 1420710810, "post_id": 27818790, "comment_id": 44078691, "body": "@FloIancu If you want, I can help you. Pleas paste here sample of your data."}], "tags": [], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1420634225, "last_edit_date": 1420634225, "creation_date": 1420631107, "answer_id": 27818790, "question_id": 27818316, "link": "https://stackoverflow.com/questions/27818316/excel-sum-adjacent-rows-with-same-value/27818790#27818790", "title": "Excel: Sum adjacent rows with same value", "body": "<pre><code>Sub SumAdjacent()\nDim TimeStamp As Date\nDim Name As String\nDim Value As Integer\nk = 1\nFor i = 2 To 80 'range of your data from secound row to 80row(or whatewer you want)\n    Value = 0\n    TimeStamp = Sheets(1).Cells(i, 1).Value\n    Name = Sheets(1).Cells(i, 2).Value\n    Value = Sheets(1).Cells(i, 3).Value\n    j = i + 1\n    'check next row\nCheckNextRow:\n    If Sheets(1).Cells(j, 2) = Name Then\n        Value = Value + Sheets(1).Cells(j, 3).Value\n            j = j + 1\n            GoTo CheckNextRow ' loop to check every next row value\n    Else\n        Sheets(2).Cells(k, 1).Value = TimeStamp\n        Sheets(2).Cells(k, 2).Value = Name\n        Sheets(2).Cells(k, 3).Value = Value\n        k = k + 1\n                i = j - 1\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2559, "user_id": 1048172, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/106f34014922a3c1a18c3f464efa6b42?s=128&d=identicon&r=PG", "display_name": "FloIancu", "link": "https://stackoverflow.com/users/1048172/floiancu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 27818790, "answer_count": 1, "score": 0, "last_activity_date": 1423515908, "creation_date": 1420629625, "last_edit_date": 1531161705, "question_id": 27818316, "link": "https://stackoverflow.com/questions/27818316/excel-sum-adjacent-rows-with-same-value", "title": "Excel: Sum adjacent rows with same value", "body": "<p>I have a table with the following structure:</p>\n\n<pre><code>Timestamp    Name    Value\n01/01/2013   X       20\n01/01/2013   Y        5\n01/01/2013   Y        3\n01/01/2013   X        7\n01/02/2013   X       15\n01/02/2013   X        1  \n01/02/2013   Z        8\n01/03/2013   Y        1\n</code></pre>\n\n<p>I want to sum the <code>Value</code> of adjacent rows with the same <code>Name</code> into the first row (keeping the same <code>Timestamp</code> and other values on the row, only the <code>Value</code> is updated). There can be any number of successive occurrences, I've only put two for the sake of the example. The result of the above example should look like this:</p>\n\n<pre><code>Timestamp    Name    Value\n01/01/2013   X       20\n01/01/2013   Y        8\n01/01/2013   X       23\n01/02/2013   Z        8\n01/03/2013   Y        1\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4429381, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/637ca21b852c0a7d26adc37b4ac9578c?s=128&d=identicon&r=PG", "display_name": "InActivex", "link": "https://stackoverflow.com/users/4429381/inactivex"}, "is_accepted": false, "score": 0, "last_activity_date": 1420643859, "creation_date": 1420643859, "answer_id": 27822544, "question_id": 27818234, "link": "https://stackoverflow.com/questions/27818234/activex-multiselect-listbox-working-for-one-excel-workbook-but-not-working-in-an/27822544#27822544", "title": "ActiveX Multiselect Listbox working for one excel workbook but not working in another workbook", "body": "<p>Same solution; restart your computer and before opening any office apps search out MSforms.exd <em>again</em> and delete all instances. this is apparently not a \"once and for all\" solution, I guess we're still waiting Microsoft's solution to their update 'faux pas.'</p>\n"}], "owner": {"reputation": 1, "user_id": 2353724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbabb905ab18047ea319a7559d4a8519?s=128&d=identicon&r=PG", "display_name": "PDM", "link": "https://stackoverflow.com/users/2353724/pdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420643859, "creation_date": 1420629375, "last_edit_date": 1531164843, "question_id": 27818234, "link": "https://stackoverflow.com/questions/27818234/activex-multiselect-listbox-working-for-one-excel-workbook-but-not-working-in-an", "title": "ActiveX Multiselect Listbox working for one excel workbook but not working in another workbook", "body": "<p>I had created a activex multiselect listbox in one excel workbook in my machine. It was not working. On deleting MSForms.exd, it started working again. However, another excel workbook with the same piece of code for activex multiselect listbox is not working in my machine.</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420631672, "post_id": 27818152, "comment_id": 44043541, "body": "Why would you like to know if data have been copied? Is there any specific reason? What do you want to achieve? Do you want to populate this data into another workbook/worksheet?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420632873, "post_id": 27818152, "comment_id": 44044299, "body": "Have you seen this: <a href=\"http://www.siddharthrout.com/2011/08/15/vba-excelallow-paste-special-only/\" rel=\"nofollow noreferrer\">siddharthrout.com/2011/08/15/vba-excelallow-paste-special-on&zwnj;&#8203;ly</a> ?"}, {"owner": {"reputation": 449, "user_id": 2061496, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b4fb4cdbd83805e528808d55e9db68b?s=128&d=identicon&r=PG&f=1", "display_name": "Nahbyr", "link": "https://stackoverflow.com/users/2061496/nahbyr"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420635358, "post_id": 27818152, "comment_id": 44045625, "body": "@MaciejLos The reason why is because the people who will use the file get a large list of data every week. They will paste this list into the first worksheet of the file I&#39;m currently working on and I need the file to then filter the relevant data out and display it in other worksheets based on certain values per row. RE: your other comment: I had opened it before my break, but hadn&#39;t finished reading it. I&#39;m currently trying it out and it appears to do what I want. Will post the answer if it does."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420635738, "post_id": 27818152, "comment_id": 44045842, "body": "Please, see my answer ;)"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420641565, "post_id": 27818152, "comment_id": 44049319, "body": "@Nahbyr   You say &quot; I&#39;ve tried the Worksheet.Change event, but the paste command (CTRL+V) does not trigger the Change event.&quot; It is deeply troubling if this is what your experience is. Wow! What kind of setup, version, mods, addons etc. do you have going there for this to be true?!"}, {"owner": {"reputation": 449, "user_id": 2061496, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b4fb4cdbd83805e528808d55e9db68b?s=128&d=identicon&r=PG&f=1", "display_name": "Nahbyr", "link": "https://stackoverflow.com/users/2061496/nahbyr"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420643504, "post_id": 27818152, "comment_id": 44050570, "body": "@GeneSkuratovsky Apparently it did. I just didn&#39;t know how to check it.  The answer I posted below is the solution to my problem, but I can&#39;t accept it yet (it says I need to wait 2 days)."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 2061496, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b4fb4cdbd83805e528808d55e9db68b?s=128&d=identicon&r=PG&f=1", "display_name": "Nahbyr", "link": "https://stackoverflow.com/users/2061496/nahbyr"}, "edited": false, "score": 0, "creation_date": 1420640079, "post_id": 27819803, "comment_id": 44048369, "body": "That would work if it weren&#39;t for the fact that I do not know how large the data list they&#39;ll import will be. I have found a fix for my problem in the link you sent earlier. Will post the code."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1420634604, "creation_date": 1420634604, "answer_id": 27819803, "question_id": 27818152, "link": "https://stackoverflow.com/questions/27818152/excel-vba-how-to-detect-if-something-was-pasted-in-a-worksheet/27819803#27819803", "title": "Excel VBA How to detect if something was pasted in a Worksheet", "body": "<p><strong>Worksheet_Change</strong> event will do the job if you add a formula into cell which will never be overwritten. Let's say your data are pasted into A1 cell and occupied 5 columns. So, enter below formula into 6. column and row 1.</p>\n\n<pre><code>=COUNTBLANK(A1:A1048576)\n</code></pre>\n\n<p>Now, you're able to handle/detect paste event ;)</p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 2061496, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b4fb4cdbd83805e528808d55e9db68b?s=128&d=identicon&r=PG&f=1", "display_name": "Nahbyr", "link": "https://stackoverflow.com/users/2061496/nahbyr"}, "is_accepted": true, "score": 13, "last_activity_date": 1420720104, "last_edit_date": 1420720104, "creation_date": 1420640529, "answer_id": 27821527, "question_id": 27818152, "link": "https://stackoverflow.com/questions/27818152/excel-vba-how-to-detect-if-something-was-pasted-in-a-worksheet/27821527#27821527", "title": "Excel VBA How to detect if something was pasted in a Worksheet", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Dim UndoList As String\n\n  '~~&gt; Get the undo List to capture the last action performed by user\n  UndoList = Application.CommandBars(\"Standard\").Controls(\"&amp;Undo\").List(1)\n\n  '~~&gt; Check if the last action was not a paste nor an autofill\n  If Left(UndoList, 5) = \"Paste\" Then\n    'Do stuff\n  End If\nEnd Sub\n</code></pre>\n\n<p>This did the trick. For those who need something similar and know the size of their list @MaciejLos' answer would also work.</p>\n"}], "owner": {"reputation": 449, "user_id": 2061496, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b4fb4cdbd83805e528808d55e9db68b?s=128&d=identicon&r=PG&f=1", "display_name": "Nahbyr", "link": "https://stackoverflow.com/users/2061496/nahbyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21905, "favorite_count": 2, "accepted_answer_id": 27821527, "answer_count": 2, "score": 8, "last_activity_date": 1550760547, "creation_date": 1420629102, "last_edit_date": 1420635764, "question_id": 27818152, "link": "https://stackoverflow.com/questions/27818152/excel-vba-how-to-detect-if-something-was-pasted-in-a-worksheet", "title": "Excel VBA How to detect if something was pasted in a Worksheet", "body": "<p>I'll start by saying that my experience with Excel and VBA is limited to what I saw in school. I have programming experience, but in other languages.</p>\n\n<p>I have a file that I get every week. The structure of this file is always the same:\nID, Name, Date, Value between 1 and 4, non-relevant data.</p>\n\n<p>This data is selected through the 'select all' button (top left corner of the worksheet, little triangle below the cellname in MS excel 2013) and then copied into another default file that reworks the data to show and filter it in different sheets based on the 1-4 value and the date.</p>\n\n<p><strong>My question:</strong> How do I detect when data has/is being pasted? I've tried the Worksheet.Change event, but the paste command (CTRL+V) does not trigger the Change event.\nAlso, how will the data be copied? Will it update Row by row, cell by cell (which direction), ...?\nI know I can easily find the answer to the last question by debugging it once I can detect the copy command, but you never know if someone knows the answer.</p>\n\n<p>Is there another, more easy (or better) way to do this?</p>\n\n<p>More data and information can be given if needed.</p>\n\n<p>Thank you for your help.</p>\n\n<p>EDIT: '...has/is being copied?' changed to pasted as it should've been.</p>\n"}, {"tags": ["excel", "indexing", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1420632875, "post_id": 27817584, "comment_id": 44044302, "body": "To write the code, start by recording a macro.  You can combine the two tables, then use a stable sort algorithm on the Index column.  Probably the simplest to implement would be the range.sort (the worksheet built-in sort) of Excel. (A stable sort is one that retains the original order if two keys are equal)."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 4412280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7vBB.jpg?s=128&g=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/4412280/angel"}, "is_accepted": true, "score": 1, "last_activity_date": 1420632238, "creation_date": 1420632238, "answer_id": 27819127, "question_id": 27817584, "link": "https://stackoverflow.com/questions/27817584/combining-data-tables/27819127#27819127", "title": "Combining data tables", "body": "<p>Copy the values of the second table (without the headers) under the values of the first table, select the two resultant columns and sort them by <em>index</em>.</p>\n\n<p>Hope it works!</p>\n"}], "owner": {"reputation": 79, "user_id": 2882635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a629023f61205efa56c278bb4532f9a?s=128&d=identicon&r=PG&f=1", "display_name": "user2882635", "link": "https://stackoverflow.com/users/2882635/user2882635"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 27819127, "answer_count": 1, "score": 0, "last_activity_date": 1478355028, "creation_date": 1420627282, "last_edit_date": 1531161705, "question_id": 27817584, "link": "https://stackoverflow.com/questions/27817584/combining-data-tables", "title": "Combining data tables", "body": "<p>I have two data tables, similar to the ones below:</p>\n\n<p><strong>table1</strong>  </p>\n\n<pre><code>index   value\na   6352\na   67\na   43\nb   7765\nb   53\nc   243\nc   7\nc   543\n</code></pre>\n\n<p><strong>table 2</strong> </p>\n\n<pre><code>index   value\na   425\na   6\nb   532\nb   125\nb   89\nb   664\nc   314\n</code></pre>\n\n<p>I would like to combine the data in one table as in the table bellow using the index values. The order is important, so the first batch of values under one index in the common table must be from the table 1</p>\n\n<pre><code>index   value\na   6352\na   67\na   43\na   425\na   6\nb   7765\nb   53\nb   532\nb   125\nb   89\nb   664\nc   243\nc   7\nc   543\nc   314\n</code></pre>\n\n<p>I tried to do it using VBA but I'm sadly a complete novice and I was wondering if someone has any pointers how to approach to write the code?</p>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1421786346, "post_id": 27817519, "comment_id": 44491265, "body": "hope this finds you well. Would you still like to get in touch?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "edited": false, "score": 0, "creation_date": 1420730794, "post_id": 27820165, "comment_id": 44090888, "body": "It works!!! Awesome mate, For some reason though I get an error message on the third iteration for Range(&quot;B&quot; &amp; j) etc etc. Any thoughts on that...... also, any chance i can schedule a skype call so you can walk me through what you did (I would pay of course) and also any change I can retain your help on one or two other projects?"}, {"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "reply_to_user": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "edited": false, "score": 0, "creation_date": 1420731750, "post_id": 27820165, "comment_id": 44091580, "body": "@user3509663 glad it works for you! I was getting the same error, that&#39;s why I added the &quot;On Error GoTo Skip&quot; line as a quick workaround. Since then I&#39;m not getting any more errors though. Can you please check that this line is present in your code? Feel free to contact me on Skype, I have added my username on my profile page."}, {"owner": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "edited": false, "score": 0, "creation_date": 1424258011, "post_id": 27820165, "comment_id": 45472179, "body": "Hi SilentSurfer, it seemed to work - am trying to contact you on Skype but having difficulty finding you!!"}, {"owner": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "edited": false, "score": 0, "creation_date": 1424528004, "post_id": 27820165, "comment_id": 45591078, "body": "Hey I have added you , can you see ?"}, {"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "reply_to_user": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "edited": false, "score": 0, "creation_date": 1424616233, "post_id": 27820165, "comment_id": 45613822, "body": "can&#39;t see you, sorry. Do you wanna put your skype name on your profile maybe?"}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1420635837, "creation_date": 1420635837, "answer_id": 27820165, "question_id": 27817519, "link": "https://stackoverflow.com/questions/27817519/scraping-from-vba-scraper-already-works-on-some-data-but-not-others/27820165#27820165", "title": "Scraping from VBA - scraper already works on some data but not others", "body": "<p>Use this code to retrieve the price elements:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Const READYSTATE_COMPLETE = 4\n\n    Dim j As Integer\n\n    Dim ie As InternetExplorer\n    Dim Doc As IHTMLDocument\n    Dim xcolElements As IHTMLElementCollection\n    Dim ell As IHTMLElement\n\n    Dim pn As Integer\n\n    j = 1\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    For pn = 1 To 10\n\n        ie.Visible = True\n        ie.Navigate \"http://www.foxtons.co.uk/search?current_page=\" &amp; pn &amp; \"&amp;location_ids=288&amp;search_form=map&amp;search_type=SS&amp;sold=1&amp;submit_type=search\"\n        Do\n          DoEvents\n        Loop Until Not ie.Busy And ie.readyState = READYSTATE_COMPLETE\n\n        Set Doc = ie.Document\n\n        'Set xcolElements = Doc.getElementsByClassName(\"description\")\n        'Here lies the problem. Description works perflectly, price doesn't\n        Set xcolElements = Doc.getElementsByClassName(\"price\")\n\n\n\n        For Each ell In xcolElements\n          On Error GoTo Skip\n          Range(\"B\" &amp; j).Value = ell.Children(0).Children(1).innerText\n          j = j + 1\nSkip:\n        Next ell \n\n    On Error Goto 0\n\n    Next pn\n\n    ie.Quit\n    Set el = Nothing\n    Set xcolElements = Nothing\n    Set Doc = Nothing\n    Set ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Good luck finding your new home :)</p>\n"}], "owner": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420635837, "creation_date": 1420627120, "question_id": 27817519, "link": "https://stackoverflow.com/questions/27817519/scraping-from-vba-scraper-already-works-on-some-data-but-not-others", "title": "Scraping from VBA - scraper already works on some data but not others", "body": "<p>I have used code from this website to pull data from property site Foxtons, the code is as follows</p>\n\n<pre><code>Sub foxtons()\n\nConst READYSTATE_COMPLETE = 4\n\nDim j\nDim xcolElements\nDim Doc, ell, ie\nDim pn\nj = 1\nFor pn = 1 To 10\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = False\nie.Navigate \"http://www.foxtons.co.uk/search?current_page=\" &amp; pn &amp; \"&amp;location_ids=288&amp;search_form=map&amp;search_type=SS&amp;sold=1&amp;submit_type=search\"\nDo\n  DoEvents\nLoop Until Not ie.Busy And ie.readyState = READYSTATE_COMPLETE\n\nSet Doc = ie.Document\n\nSet xcolElements = Doc.getElementsByClassName(\"description\")\n'Here lies the problem. Description works perflectly, price doesn't\n\nFor Each ell In xcolElements\n  Range(\"B\" &amp; j).Value = ell.FirstChild.Data\n  j = j + 1\nNext\nNext pn\nie.Quit\nSet el = Nothing\nSet xcolElements = Nothing\nSet Doc = Nothing\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>The above code works and should pull in 600 property descriptions into column B. The problem arises when I switch \"descriptions\" to price. Here I receive an error message yet this is probably much more important for me</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 1, "creation_date": 1420625250, "post_id": 27816678, "comment_id": 44039882, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/17285897/row-count-on-the-filtered-data\">Row count on the Filtered data</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 1631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d7bbaac0d033a9540fc9fd1a4d947f?s=128&d=identicon&r=PG", "display_name": "daria8877", "link": "https://stackoverflow.com/users/1631546/daria8877"}, "is_accepted": false, "score": 0, "last_activity_date": 1429211478, "creation_date": 1429211478, "answer_id": 29683932, "question_id": 27816678, "link": "https://stackoverflow.com/questions/27816678/define-visible-rows-count-to-implement-functions-on-visible-cells-only/29683932#29683932", "title": "define visible rows count to implement functions on visible cells only", "body": "<p>Here is a function I created to count the visible rows in a filtered list, and it also works with non-filtered ranges where rows are hidden.  You have to be careful of working with filtered ranges. (If rows are contiguous in the source data then they could be contiguous in the filtered data.  So three rows could = 1 area.)  So to get around that I am looping through each area and then counting the rows in each area.</p>\n\n<pre><code>Function CountVisibleRowsInFilteredAreas(Optional myRange As Range)\nDim lCount As Long\nDim lCount2 As Long\nDim CurrRng As Range\nDim vArrRows As Variant\nDim vArrUnqRows As Variant\nDim iRow As Long\nDim iUnq As Long\nDim nUnq As Long\nDim rw As Range\nDim isUnq As Boolean\n\n'if range to use was not specified in the code, then use the ActiveSheets' UsedRange\nIf myRange Is Nothing Then Set myRange = ActiveSheet.UsedRange\n\n'this is created for autofiltered ranges, or non-autofiltered ranges with hidden rows,\n'to count the number of rows that are visible.\n'it assumes there is a header row and will count that as a row\n\n'count the number of rows in each area to get the upper bound for the array that\n 'will contain the row numbers of all of the rows in each area.\n lCount = 0\n    For Each CurrRng In myRange.SpecialCells(xlCellTypeVisible).Areas\n        lCount = lCount + CurrRng.Rows.Count\n    Next CurrRng\n\n'dim the array and give it upper and lower bounds, Set up a second counter to identify\n'which row the loop is on, then loop through each row in each area,\n'and get the row number and store it in an array.\nReDim vArrRows(1 To lCount)\n    lCount2 = 0\n    For Each CurrRng In myRange.SpecialCells(xlCellTypeVisible).Areas\n        For Each rw In CurrRng.Rows\n            lCount2 = lCount2 + 1\n            vArrRows(lCount2) = rw.Row\n        Next rw\n    Next CurrRng\n\n'remove duplicates/count unique rows\nReDim vArrUnqRows(1 To lCount2)\nnUnq = 0\nFor iRow = 1 To lCount2\n    isUnq = True\n    'first one in vArrRows is always unique, and added to vArrUnqRows, the rest are compared\n    'against the known unique ones in vArrUnqRows, if they are unique then they are added\n    'to vArrUnqRows\n    For iUnq = 1 To nUnq\n        If vArrRows(iRow) = vArrUnqRows(iUnq) Then\n            isUnq = False\n            Exit For\n        End If\n    Next iUnq\n    'add unique row numbers to vArrUnqRows\n    If isUnq = True Then\n        nUnq = nUnq + 1\n        vArrUnqRows(iUnq) = vArrRows(iRow)\n    End If\nNext iRow\nReDim Preserve vArrUnqRows(1 To nUnq)\n'creates an array of the row numbers of visible rows, but that is not used here and only the\n'count of the visible rows is returned (nUnq)\nCountVisibleRowsInFilteredAreas = nUnq\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4428167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ecb9d5275495881b63f8b6418e5bcef?s=128&d=identicon&r=PG&f=1", "display_name": "Pradip", "link": "https://stackoverflow.com/users/4428167/pradip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429211478, "creation_date": 1420624412, "last_edit_date": 1531164843, "question_id": 27816678, "link": "https://stackoverflow.com/questions/27816678/define-visible-rows-count-to-implement-functions-on-visible-cells-only", "title": "define visible rows count to implement functions on visible cells only", "body": "<p>I used </p>\n\n<p>for i= 2 to activesheet.usedrange.rows.count</p>\n\n<p>but the moment i am filtering columns on certain criteria and later put some If conditions I am not able to define the same way for visible rows.</p>\n\n<p>Kindly help</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2451, "user_id": 4141176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f08bcf8a868d6695af1eaa968949284?s=128&d=identicon&r=PG", "display_name": "Jack hardcastle", "link": "https://stackoverflow.com/users/4141176/jack-hardcastle"}, "edited": false, "score": 0, "creation_date": 1420623975, "post_id": 27816493, "comment_id": 44039173, "body": "If it&#39;s about 10 hours out; perhaps timezone could be a factor?"}, {"owner": {"reputation": 100, "user_id": 4411380, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1080056110/picture?type=large", "display_name": "Reuben Molloy", "link": "https://stackoverflow.com/users/4411380/reuben-molloy"}, "reply_to_user": {"reputation": 2451, "user_id": 4141176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f08bcf8a868d6695af1eaa968949284?s=128&d=identicon&r=PG", "display_name": "Jack hardcastle", "link": "https://stackoverflow.com/users/4141176/jack-hardcastle"}, "edited": false, "score": 0, "creation_date": 1420625769, "post_id": 27816493, "comment_id": 44040202, "body": "I believe so.  It never runs this code;"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3904868"}, "is_accepted": true, "score": 1, "last_activity_date": 1420645030, "creation_date": 1420645030, "answer_id": 27822977, "question_id": 27816493, "link": "https://stackoverflow.com/questions/27816493/millisecond-time-msec2-incorrect-return/27822977#27822977", "title": "Millisecond time; Msec(2) incorrect return", "body": "<p>Most of those functions can be simplified down to the following:</p>\n\n<p>Function <code>GetTimeLocal</code> will return the users local system datetime with daylight saving adjustment</p>\n\n<p>Function <code>GetTimeUTC</code> will return UTC time</p>\n\n<p>Function <code>FormatDate</code> will format a <code>Date</code> as a string with the correct millisecond component.</p>\n\n<p>Usually it's better to store all times as UTC and convert if needed.</p>\n\n<pre><code>Option Explicit\n\n#If Win64 Then\n    Public Declare PtrSafe Sub GetSystemTime Lib \"kernel32\" (ByRef lpSystemTime As SYSTEMTIME)\n    Private Declare PtrSafe Function GetTimeZoneInformation Lib \"kernel32\" (lpTimeZoneInformation As TIME_ZONE_INFORMATION) As Long\n#Else\n    Public Declare Sub GetSystemTime Lib \"kernel32\" (ByRef lpSystemTime As SYSTEMTIME)\n    Private Declare Function GetTimeZoneInformation Lib \"kernel32\" (lpTimeZoneInformation As TIME_ZONE_INFORMATION) As Long\n#End If\n\nPublic Type SYSTEMTIME\n    wYear           As Integer\n    wMonth          As Integer\n    wDayOfWeek      As Integer\n    wDay            As Integer\n    wHour           As Integer\n    wMinute         As Integer\n    wSecond         As Integer\n    wMilliseconds   As Integer\nEnd Type\n\nPrivate Type TIME_ZONE_INFORMATION\n    Bias As Long\n    StandardName(31) As Integer\n    StandardDate As SYSTEMTIME\n    StandardBias As Long\n    DaylightName(31) As Integer\n    DaylightDate As SYSTEMTIME\n    DaylightBias As Long\nEnd Type\n\nSub test()\nDim dtLcl As Date\nDim dtUTC As Date\n    dtLcl = GetTimeLocal 'Gets local time including adjustement for daylight saving time\n    dtUTC = GetTimeUTC 'Gets UTC time\n\n    Debug.Print FormatDate(dtLcl)\n    Debug.Print FormatDate(dtUTC)\n\nEnd Sub\n\nFunction FormatDate(ByVal dt As Date) As String\nDim sysTime As SYSTEMTIME\nDim sec As Double\nDim x As Double\n\n    With sysTime\n        .wYear = Year(dt)\n        .wMonth = Month(dt)\n        .wDay = Day(dt)\n        .wHour = Hour(dt)\n        .wMinute = Minute(dt)\n        'Second() function rounds to nearest second so calc floor second\n        'Eg 12:15:09.678 will give second component as 10 instead of 09\n        x = (dt - Int(dt)) * 86400#\n        sec = x - Fix(x / 60#) * 60#\n        .wSecond = Int(sec)\n        .wMilliseconds = Int(Round(sec - .wSecond, 3) * 1000)\n        FormatDate = Format(dt, \"dd/mm/yyyy hh:mm:ss.\") &amp; Format(sysTime.wMilliseconds, \"000\")\n    End With\n\nEnd Function\n\nPublic Function GetTimeLocal() As Date\nDim dSysUTC As Date, sysTime As SYSTEMTIME\nDim DST As Long, IsDST As Boolean\nDim tzi As TIME_ZONE_INFORMATION\nDim ms As Double\n\n    GetSystemTime sysTime\n    With sysTime\n        'Debug.Print \"ms=\" &amp; .wMilliseconds\n        ms = CDbl(.wMilliseconds) / (86400# * 1000#)\n        dSysUTC = DateSerial(.wYear, .wMonth, .wDay) + TimeSerial(.wHour, .wMinute, .wSecond) + ms\n    End With\n    DST = GetTimeZoneInformation(tzi)\n    GetTimeLocal = dSysUTC - TimeSerial(0, tzi.Bias, 0) + IIf(DST = 2, TimeSerial(1, 0, 0), 0)\nEnd Function\n\nPublic Function GetTimeUTC() As Date\nDim dSysUTC As Date\nDim sysTime As SYSTEMTIME\nDim ms As Double\n\n    GetSystemTime sysTime\n    With sysTime\n        'Debug.Print \"ms=\" &amp; .wMilliseconds\n        ms = CDbl(.wMilliseconds) / (86400# * 1000#)\n        GetTimeUTC = DateSerial(.wYear, .wMonth, .wDay) + TimeSerial(.wHour, .wMinute, .wSecond) + ms\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 100, "user_id": 4411380, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1080056110/picture?type=large", "display_name": "Reuben Molloy", "link": "https://stackoverflow.com/users/4411380/reuben-molloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 27822977, "answer_count": 1, "score": 0, "last_activity_date": 1420693959, "creation_date": 1420623848, "last_edit_date": 1495540674, "question_id": 27816493, "link": "https://stackoverflow.com/questions/27816493/millisecond-time-msec2-incorrect-return", "title": "Millisecond time; Msec(2) incorrect return", "body": "<p>I am trying to implement millisecond timestamping in Access 2010/13 using this method;\n<a href=\"http://www.devx.com/dbzone/Article/39046\" rel=\"nofollow noreferrer\">MS Access Can Handle Millisecond Time Values--Really - See more at: http://www.devx.com/dbzone/Article/39046#sthash.xEIruMyE.dpuf</a></p>\n\n<p>The function Msec(2) is supposed to return the system time in milliseconds but it seems to be about 10 hours out.</p>\n\n<pre><code>Public Function Msec( _\n  Optional ByVal intTimePart As Integer) _\n  As Date\n\n' This is the core function.\n' It generates the current time with millisecond resolution.\n'\n' Returns current (local) date/time including millisecond.\n' Parameter intTimePart determines level of returned value:\n'   0: Millisecond value only.\n'   1: Time value only including milliseconds.\n'   2: Full Date/time value including milliseconds.\n'   None or any other value: Millisecond value only.\n\n  Const cintMsecOnly            As Integer = 0\n  Const cintMsecTime            As Integer = 1\n  Const cintMsecDate            As Integer = 2\n\n  Static typTime      As SYSTEMTIME\n  Static lngMsecInit  As Long\n\n  Dim datMsec         As Date\n  Dim datDate         As Date\n  Dim intMilliseconds As Integer\n  Dim lngTimeZoneBias As Long\n  Dim lngMsec         As Long\n  Dim lngMsecCurrent  As Long\n  Dim lngMsecOffset   As Long\n\n  ' Set resolution of timer to 1 ms.\n  timeBeginPeriod 1\n  lngMsecCurrent = timeGetTime()\n\n  If lngMsecInit = 0 Or lngMsecCurrent &lt; lngMsecInit Then\n    ' Initialize.\n    ' Get bias for local time zone respecting\n    ' current setting for daylight savings.\n    lngTimeZoneBias = GetLocalTimeZoneBias(False)\n    ' Get current UTC system time.\n    Call GetSystemTime(typTime)\n    intMilliseconds = typTime.wMilliseconds\n    ' Repeat until GetSystemTime retrieves next count of milliseconds.\n    ' Then retrieve and store count of milliseconds from launch.\n    Do\n      Call GetSystemTime(typTime)\n    Loop Until typTime.wMilliseconds &lt;&gt; intMilliseconds\n    lngMsecInit = timeGetTime()\n    ' Adjust UTC to local system time by correcting for time zone bias.\n    typTime.wMinute = typTime.wMinute - lngTimeZoneBias\n    ' Note: typTime may now contain an invalid (zero or negative) minute count.\n    ' However, the minute count is acceptable by TimeSerial().\n  Else\n    ' Retrieve offset from initial time to current time.\n    lngMsecOffset = lngMsecCurrent - lngMsecInit\n  End If\n\n  With typTime\n    ' Now, current system time is initial system time corrected for\n    ' time zone bias.\n    lngMsec = (.wMilliseconds + lngMsecOffset)\n    Select Case intTimePart\n      Case cintMsecTime, cintMsecDate\n        ' Calculate the time to add as a date/time value with millisecond resolution.\n        datMsec = lngMsec / 1000 / clngSecondsPerDay\n        ' Add to this the current system time.\n        datDate = datMsec + TimeSerial(.wHour, .wMinute, .wSecond)\n        If intTimePart = cintMsecDate Then\n          ' Add to this the current system date.\n          datDate = datDate + DateSerial(.wYear, .wMonth, .wDay)\n        End If\n      Case Else\n        ' Calculate millisecond part as a date/time value with millisecond resolution.\n        datMsec = (lngMsec Mod 1000) / 1000 / clngSecondsPerDay\n        ' Return millisecond part only.\n        datDate = datMsec\n    End Select\n  End With\n\n  Msec = datDate\n\nEnd Function\n</code></pre>\n\n<p>As Jack hardcastle says; Probably Timezone related.</p>\n\n<p>It never runs this code;</p>\n\n<pre><code>  If lngMsecInit = 0 Or lngMsecCurrent &lt; lngMsecInit Then\n    ' Initialize.\n    ' Get bias for local time zone respecting\n    ' current setting for daylight savings.\n    lngTimeZoneBias = GetLocalTimeZoneBias(False)\n    ' Get current UTC system time.\n    Call GetSystemTime(typTime)\n    intMilliseconds = typTime.wMilliseconds\n    ' Repeat until GetSystemTime retrieves next count of milliseconds.\n    ' Then retrieve and store count of milliseconds from launch.\n    Do\n      Call GetSystemTime(typTime)\n    Loop Until typTime.wMilliseconds &lt;&gt; intMilliseconds\n    lngMsecInit = timeGetTime()\n    ' Adjust UTC to local system time by correcting for time zone bias.\n    typTime.wMinute = typTime.wMinute - lngTimeZoneBias\n    ' Note: typTime may now contain an invalid (zero or negative) minute count.\n    ' However, the minute count is acceptable by TimeSerial().\n</code></pre>\n\n<p>But goes to;</p>\n\n<pre><code>  Else\n    ' Retrieve offset from initial time to current time.\n    lngMsecOffset = lngMsecCurrent - lngMsecInit\n  End If\n</code></pre>\n\n<p>Answer! From @pathDongle</p>\n\n<p>Time is stored as Millisecond UTC;</p>\n\n<pre><code>!DateTimeMS = GetTimeUTC()\n</code></pre>\n\n<p>And restored by;</p>\n\n<pre><code>Public Function UTCtoTimeLocal(dSysUTC As Date) As Date\n'Dim sysTime As SYSTEMTIME\n    Dim DST As Long\n    Dim tzi As TIME_ZONE_INFORMATION\n\n    DST = GetTimeZoneInformation(tzi)\n    UTCtoTimeLocal = dSysUTC - TimeSerial(0, tzi.Bias, 0) + IIf(DST = 2, TimeSerial(1, 0, 0), 0)\nEnd Function\n</code></pre>\n\n<p>Query;</p>\n\n<pre><code>SELECT tblzzAuditTrail.DateTimeMS, FormatDate(UTCtoTimeLocal([DateTimeMS])) AS DateTimeLocal\n</code></pre>\n\n<p>Which can be filtered on as a String.</p>\n\n<pre><code>Private Sub BuildFilter()\n    Dim strFilter As String\n    Dim ctl As Control\n\n    strFilter = \"\"\n\n'add selected values to string\n    For Each ctl In Me.FormHeader.Controls\n        With ctl\n            If .ControlType = acTextBox Or .ControlType = acComboBox Then\n                If Nz(.Value) &lt;&gt; \"\" Then\n                    If InStr(.Name, \"Date\") &lt;&gt; 0 Then\n                        If Nz(StartDate) &lt;&gt; \"\" And Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] BETWEEN '\" &amp; FormatDate(Me.StartDate.Value) &amp; \"' AND '\" &amp; FormatDate(Me.EndDate.Value) &amp; \"' AND \"\n                        ElseIf Nz(StartDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] &gt; '\" &amp; FormatDate(Me.StartDate.Value) &amp; \"' AND \"\n                        ElseIf Nz(EndDate) &lt;&gt; \"\" And InStr(strFilter, \"DateTimeLocal\") = 0 Then\n                            strFilter = strFilter &amp; \"[DateTimeLocal] &lt;= '\" &amp; FormatDate(Me.EndDate.Value) &amp; \"' AND \"\n                        End If\n                    ElseIf InStr(.Name, \"ID\") &lt;&gt; 0 Then\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = \" &amp; .Value &amp; \" AND \"\n                    Else\n                        strFilter = strFilter &amp; \"[\" &amp; .Name &amp; \"] = '\" &amp; .Value &amp; \"' AND \"\n                    End If\n                End If\n            End If\n        End With\n    Next ctl\n'trim trailing And\n    strFilter = TrimR(strFilter, 5)\n\nDebug.Print strFilter\n    With Me.subfrmzzAuditTrailDisplay\n        .Form.Filter = strFilter\n        .Form.FilterOn = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Resulting Filter String;</p>\n\n<pre><code>[UserID] = 2 AND [DateTimeLocal] BETWEEN '06/01/2015 00:00:00.000' AND '07/01/2015 00:00:00.000'\n</code></pre>\n\n<p>As per my other question;</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27821557/millisecond-time-filter-form-by-date\">Millisecond time: Filter form by date</a></p>\n"}, {"tags": ["vba", "syntax-error", "messagebox"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 3, "creation_date": 1420623589, "post_id": 27816308, "comment_id": 44038958, "body": "The problem are the quotation marks. Try to delete and re-type both and re-run program. It should look like <code>MsgBox &quot;The answer is &quot; &amp; Sum</code>."}, {"owner": {"reputation": 113, "user_id": 4412917, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/62773c4da761a9b1930dbd1b2e4cea96?s=128&d=identicon&r=PG", "display_name": "Aadil", "link": "https://stackoverflow.com/users/4412917/aadil"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1420624018, "post_id": 27816308, "comment_id": 44039193, "body": "Wow can&#39;t even copy and paste code right! Worked perfect thanks"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 4418403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89d00da7dee7b6db06aeb66a2aa94299?s=128&d=identicon&r=PG&f=1", "display_name": "Chasky", "link": "https://stackoverflow.com/users/4418403/chasky"}, "is_accepted": true, "score": 4, "last_activity_date": 1420624459, "creation_date": 1420624459, "answer_id": 27816693, "question_id": 27816308, "link": "https://stackoverflow.com/questions/27816308/vba-for-dummies-example-display-message-box-giving-syntax-error/27816693#27816693", "title": "VBA for Dummies example, display message box giving syntax error", "body": "<p>As pointed by L42, it  is the quotation usage; While you might have problems to copy-paste, it could be the source that have wrong formatting as well.</p>\n\n<p>Try to always type your code when learning, it will still more to you :)</p>\n"}], "owner": {"reputation": 113, "user_id": 4412917, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/62773c4da761a9b1930dbd1b2e4cea96?s=128&d=identicon&r=PG", "display_name": "Aadil", "link": "https://stackoverflow.com/users/4412917/aadil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 27816693, "answer_count": 1, "score": 2, "last_activity_date": 1420624459, "creation_date": 1420623322, "last_edit_date": 1420623650, "question_id": 27816308, "link": "https://stackoverflow.com/questions/27816308/vba-for-dummies-example-display-message-box-giving-syntax-error", "title": "VBA for Dummies example, display message box giving syntax error", "body": "<p>I am trying to run this code from an example in 'VBA for Dummies'</p>\n\n<p>It is giving me 'Syntax Error' at the message box line, not very encouraging</p>\n\n<pre><code>Sub AddEmUp()\n  Sum = 1 + 1\n  MsgBox \u201cThe answer is \u201c &amp; Sum\nEnd Sub\n</code></pre>\n\n<p>Why does this not work?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2941651"}, "edited": false, "score": 0, "creation_date": 1420622233, "post_id": 27815908, "comment_id": 44038177, "body": "Could you please provide the exact syntax error?"}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1420623728, "post_id": 27815908, "comment_id": 44039032, "body": "&quot;Run-time error &#39;3134&#39;: Syntax error in INSERT INTO statement&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1420623697, "post_id": 27816006, "comment_id": 44039018, "body": "Both tried, i still get the &quot;Syntax error in INSERT INTO statement&quot; :("}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1420623820, "post_id": 27816006, "comment_id": 44039078, "body": "I rest my case - It works. I just accidently deleteted the VALUE statement when i pasted your code. THANK you very much!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2941651"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1420623860, "post_id": 27816006, "comment_id": 44039107, "body": "No problem. I&#39;m really glad I could help. Regards :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2941651"}, "is_accepted": true, "score": 3, "last_activity_date": 1420622347, "creation_date": 1420622347, "answer_id": 27816006, "question_id": 27815908, "link": "https://stackoverflow.com/questions/27815908/how-to-insert-string-into-query-using-insert-to-in-access/27816006#27816006", "title": "How to insert string into query using INSERT TO in access", "body": "<p>As far as I understood well please try:</p>\n\n<pre><code>strTMP = (counter - 1) * [Forms]![f_Main]![PowerBinCombo] &amp; \" - \" &amp; counter * [Forms]![f_Main]!    [PowerBinCombo] &amp; \" kW\"\n\nstrSQL = \"INSERT INTO q_000 (Bin, Zero1, Zero2, Zero3, Zero4, Zero5) ('\" &amp; strTMP &amp; \"','1','1','1','1','1');\"\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>strSQL = \"INSERT INTO q_000 (Bin, Zero1, Zero2, Zero3, Zero4, Zero5) ('\" &amp; ((counter - 1) * [Forms]![f_Main]![PowerBinCombo] &amp; \" - \" &amp; counter * [Forms]![f_Main]!    [PowerBinCombo] &amp; \" kW\") &amp; \"','1','1','1','1','1');\"\n</code></pre>\n"}], "owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 27816006, "answer_count": 1, "score": 0, "last_activity_date": 1420622347, "creation_date": 1420621987, "question_id": 27815908, "link": "https://stackoverflow.com/questions/27815908/how-to-insert-string-into-query-using-insert-to-in-access", "title": "How to insert string into query using INSERT TO in access", "body": "<p>Hopefully a quick one, but I cant find the solution.</p>\n\n<p>I have a simple query q_000 that i want to put in a line of zeroes, with a name in a column.</p>\n\n<pre><code>strTMP = (counter - 1) * [Forms]![f_Main]![PowerBinCombo] &amp; \" - \" &amp; counter * [Forms]![f_Main]!    [PowerBinCombo] &amp; \" kW\"\n\nstrSQL = \"INSERT INTO q_000 (Bin, Zero1, Zero2, Zero3, Zero4, Zero5) (strTMP,'1','1','1','1','1');\"\n</code></pre>\n\n<p>The strin strTMP is fine, it shows what i want in a msgbox.\nI can fill the the rows with 1's, but i get syntax error on the case above.</p>\n\n<p>I would prefer not to do a dbs/rst command, i want to keep it short, if possible.</p>\n\n<p>Best regards, Emil.</p>\n"}, {"tags": ["vba", "excel", "mshtml"], "comments": [{"owner": {"reputation": 1693, "user_id": 464431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84623f1706592fad1daf9d8f4cfdd0?s=128&d=identicon&r=PG", "display_name": "Tom Robinson", "link": "https://stackoverflow.com/users/464431/tom-robinson"}, "edited": false, "score": 0, "creation_date": 1420959049, "post_id": 27814073, "comment_id": 44170898, "body": "For Jan 6, are you interested in just the 4 links for <code>Ruakaka , Seymour , Tamworth , Taree</code> or do you want all 61 links on the page, which include other dates?"}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 3725021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0885ae8d54dab62fa9b164e4fb54799e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725021", "link": "https://stackoverflow.com/users/3725021/user3725021"}, "edited": false, "score": 0, "creation_date": 1420758021, "post_id": 27816701, "comment_id": 44106225, "body": "I tested this and wasn&#39;t able to get it working properly. It runs without producing any errors, but is not able to capture the data I request. When the input value=&quot;2009-1-1&quot;, the html that should appear is:        &lt;a href=&quot;/horse-racing-results/ASCOT/2009-1-1&quot; target=&quot;_blank&quot;&gt;ASCOT&lt;/a&gt;                  ,            &lt;a href=&quot;/horse-racing-results/BALLINA/2009-1-1&quot; target=&quot;_blank&quot;&gt;BALLINA&lt;/a&gt;                  ,            &lt;a href=&quot;/horse-racing-results/BURRUMBEET/2009-1-1&quot; target=&quot;_blank&quot;&gt;BURRUMBEET&lt;/a&gt;"}, {"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "reply_to_user": {"reputation": 494, "user_id": 3725021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0885ae8d54dab62fa9b164e4fb54799e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725021", "link": "https://stackoverflow.com/users/3725021/user3725021"}, "edited": false, "score": 0, "creation_date": 1420766771, "post_id": 27816701, "comment_id": 44108912, "body": "yes, i see what you mean. Very strange... I will look into that"}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1420769238, "last_edit_date": 1420769238, "creation_date": 1420624482, "answer_id": 27816701, "question_id": 27814073, "link": "https://stackoverflow.com/questions/27814073/use-vba-to-click-html-button-and-then-scrape-refreshed-data/27816701#27816701", "title": "Use VBA to click html button and then scrape refreshed data", "body": "<p>Insert a condition to wait while the page is loading. </p>\n\n<p>The following rewrite successfully fetches data from the target page on my pc:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    'dimension variables\n    Dim ie As InternetExplorer\n    Dim htmldoc As MSHTML.IHTMLDocument                                                         'Document object\n    Dim inputs As MSHTML.IHTMLElementCollection                                                 'Element collection for \"input\" tags\n    Dim eles1, eles2 As MSHTML.IHTMLElementCollection                                            'Element collection for th tags\n    Dim element As MSHTML.IHTMLElement                                                          'input elements\n    Dim ele1, ele2 As MSHTML.IHTMLElement                                                       'Header elements\n\n    'Open InternetExplorer\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True                                                                          'make IE invisible\n\n    'Navigate to webpage\n    Dim ieURL As String:    ieURL = \"http://www.racenet.com.au/horse-racing-results/\"           'set URL from which to retrieve racemeet and date data\n    ie.navigate ieURL                                                                           'navigate to URL\n    Do While ie.Busy Or ie.readyState &lt;&gt; 4                                                      'wait for page to load\n        DoEvents\n    Loop\n\n    Set htmldoc = ie.document                                                                   'Document webpage\n    Set inputs = htmldoc.getElementsByTagName(\"input\")                                          'Find all input tags\n\n    Dim dd, mm, yyyy As Integer\n    Dim startdate, enddate As Date\n    Dim i, j, k As Long\n    Dim raceMeet, raceURL As String\n    startdate = #1/1/2008#: enddate = Date - 1\n    Dim racemeetArr As Variant\n    ReDim racemeetArr(1 To 2, 1)\n\n    For i = startdate To enddate\n        dd = Day(i): mm = Month(i): yyyy = Year(i)\n\n\n        For Each element In inputs\n            If element.Name = \"Mdate\" Then\n                element.Value = yyyy &amp; \"-\" &amp; mm &amp; \"-\" &amp; dd\n            Else\n                If element.Name = \"button\" Then\n                    element.Click\n                    Exit For\n                End If\n            End If\n\n        Next element\n\n\n        Do\n        ' Wait until the Browser is loaded'\n        Loop Until ie.readyState = READYSTATE_COMPLETE\n\n        'insert scraper\n        Set eles1 = htmldoc.getElementsByTagName(\"a\")                                          'Find all centre tags\n            For Each ele1 In eles1\n                If InStr(ele1.href, \"/horse-racing-results/\") &gt; 0 Then\n                    raceMeet = ele1.innerText\n                    raceURL = ele1.innerHTML\n                    ReDim Preserve racemeetArr(1 To 2, UBound(racemeetArr, 2) + 1)\n                    racemeetArr(1, UBound(racemeetArr, 2)) = raceMeet\n                    racemeetArr(2, UBound(racemeetArr, 2)) = raceURL\n                End If\n            Next ele1\n\n        Stop\n\n    Next i\n\n    ie.Quit\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>After analyzing the HTTP requests I managed to slim down the code a little bit (results can be queried directly without filling the form and submitting the page)</p>\n\n<p>I am not a huge fan of expensive array ReDims, so I created a class instead, and save the results in a collection of that class (feel free to use it or not). </p>\n\n<p>Add a new class module, call it clRaceMeet and paste this code:</p>\n\n<pre><code>Option Explicit\n\nPrivate pMeet As String\nPrivate pUrl As String\n\n\nPublic Property Let Meet(ByVal Val As String)\n    pMeet = Val\nEnd Property\nPublic Property Get Meet() As String\n    Meet = pMeet\nEnd Property\n\nPublic Property Let URL(ByVal Val As String)\n    pUrl = Val\nEnd Property\nPublic Property Get URL() As String\n    URL = pUrl\nEnd Property\n</code></pre>\n\n<p>Then, use this modified code version to scrape the data and dump it to the debugging window:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\n    'dimension variables\n    Dim ie As InternetExplorer\n    Dim ieURL As String\n\n    Dim dd As Integer\n    Dim mm As Integer\n    Dim yyyy As Integer\n    Dim startDate As Date\n    Dim endDate As Date\n    Dim i As Long\n\n    Dim htmlDoc As MSHTML.IHTMLDocument\n    Dim colLeftEleColl As MSHTML.IHTMLElementCollection\n    Dim colLeftEle As MSHTML.IHTMLElement\n    Dim centerEleColl As MSHTML.IHTMLElementCollection\n    Dim centerEle As MSHTML.IHTMLElement\n\n    Dim raceMeet As String\n    Dim raceURL As String\n    Dim objRaceMeet As clRaceMeet\n    Dim raceMeetColl As New Collection\n\n\n    'Open InternetExplorer\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n\n    startDate = #1/1/2009#\n    endDate = Date - 1\n\n    For i = startDate To endDate\n        dd = Day(i)\n        mm = Month(i)\n        yyyy = Year(i)\n\n        ieURL = \"http://www.racenet.com.au/horse-racing-results-search.asp?Mdate=\" &amp; yyyy &amp; \"-\" &amp; mm &amp; \"-\" &amp; dd\n        ie.navigate ieURL\n\n        Do\n        ' Wait until the Browser is loaded'\n        Loop Until ie.readyState = READYSTATE_COMPLETE\n\n        Set htmlDoc = ie.document\n\n        'insert scraper\n        Set colLeftEleColl = htmlDoc.getElementById(\"ColLeft\").all\n\n        'Loop through elements of ColLeft div\n        For Each colLeftEle In colLeftEleColl\n\n            If colLeftEle.tagName = \"CENTER\" Then\n                Set centerEleColl = colLeftEle.all\n\n                'Loop through elements of &lt;center&gt; tag\n                For Each centerEle In centerEleColl\n\n                    If centerEle.tagName = \"A\" Then\n                        If InStr(centerEle.href, \"/horse-racing-results/\") &gt; 0 Then\n                            raceMeet = centerEle.innerText\n                            raceURL = centerEle.href\n\n                            Set objRaceMeet = New clRaceMeet\n\n                            objRaceMeet.Meet = raceMeet\n                            objRaceMeet.URL = raceURL\n                            raceMeetColl.Add objRaceMeet\n\n                        End If\n                    End If\n                Next centerEle\n\n                Exit For\n            End If\n        Next colLeftEle\n\n        ' Dump results to immediate window:\n        For Each objRaceMeet In raceMeetColl\n            Debug.Print objRaceMeet.Meet &amp; \" - \" &amp; objRaceMeet.URL\n        Next objRaceMeet\n\n        'Stop\n\n    Next i\n\n    ie.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Happy betting! :)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4835209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29c1aec5714d185567ed1a564583eb5c?s=128&d=identicon&r=PG", "display_name": "EL Montgomery", "link": "https://stackoverflow.com/users/4835209/el-montgomery"}, "is_accepted": false, "score": 0, "last_activity_date": 1430074449, "creation_date": 1430074449, "answer_id": 29882019, "question_id": 27814073, "link": "https://stackoverflow.com/questions/27814073/use-vba-to-click-html-button-and-then-scrape-refreshed-data/29882019#29882019", "title": "Use VBA to click html button and then scrape refreshed data", "body": "<p>I toyed around with the last one and the for each loop within the for next loop has to go after it. I then also made it list into sheet1 and it worked. I did a few minor adjustments such as adding a variable to increment the cells. </p>\n\n<p>this code didn't produce the actual results just the websites, not sure if that is what you were aiming for.</p>\n"}], "owner": {"reputation": 494, "user_id": 3725021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0885ae8d54dab62fa9b164e4fb54799e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725021", "link": "https://stackoverflow.com/users/3725021/user3725021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7534, "favorite_count": 0, "accepted_answer_id": 27816701, "answer_count": 2, "score": 1, "last_activity_date": 1430074449, "creation_date": 1420614177, "last_edit_date": 1531164843, "question_id": 27814073, "link": "https://stackoverflow.com/questions/27814073/use-vba-to-click-html-button-and-then-scrape-refreshed-data", "title": "Use VBA to click html button and then scrape refreshed data", "body": "<p>I am trying to write a procedure which enters a date into an input box </p>\n\n<pre><code>&lt;input name=\"Mdate\" type=\"text\" id=\"Mdate\" size=\"30\" value=\"\" /&gt;&lt;/td&gt;\n</code></pre>\n\n<p>clicks a submit button</p>\n\n<pre><code>&lt;input type=\"submit\" name=\"button\" id=\"button\" value=\"Submit\" /&gt;\n</code></pre>\n\n<p>then scrapes the resulting data, which appears in the \"a\" tags.</p>\n\n<pre><code>&lt;center&gt;\n&lt;b&gt;Tuesday, 6 January 2015&lt;/b&gt;&lt;br /&gt;\n&lt;a href=\"/horse-racing-results/Ruakaka/2015-1-6\" target=\"_blank\"&gt;Ruakaka&lt;/a&gt;\n</code></pre>\n\n<p>This data is not available until the submit button has been entered. My attempt is posted in full below. The problem I seem to be having is that i am not able to access the modified html code (modified by clicking submit). Can anyone provide any suggestions?</p>\n\n<pre><code>'dimension variables\nDim ie As InternetExplorer\nDim htmldoc As MSHTML.IHTMLDocument                                                         'Document object\nDim inputs As MSHTML.IHTMLElementCollection                                                 'Element collection for \"input\" tags\nDim eles1, eles2 As MSHTML.IHTMLElementCollection                                            'Element collection for th tags\nDim element As MSHTML.IHTMLElement                                                          'input elements\nDim ele1, ele2 As MSHTML.IHTMLElement                                                       'Header elements\n\n'Open InternetExplorer\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = False                                                                          'make IE invisible\n\n'Navigate to webpage\nDim ieURL As String:    ieURL = \"http://www.racenet.com.au/horse-racing-results/\"           'set URL from which to retrieve racemeet and date data\nie.navigate ieURL                                                                           'navigate to URL\nDo While ie.Busy Or ie.readyState &lt;&gt; 4                                                      'wait for page to load\n    DoEvents\nLoop\n\nSet htmldoc = ie.document                                                                   'Document webpage\nSet inputs = htmldoc.getElementsByTagName(\"input\")                                          'Find all input tags\n\nDim dd, mm, yyyy As Integer\nDim startdate, enddate As Date\nDim i, j, k As Long\nDim raceMeet, raceURL As String\nstartdate = #1/1/2008#: enddate = Date - 1\nDim racemeetArr As Variant\nReDim racemeetArr(1 To 2, 1)\n\nFor i = startdate To enddate\n    dd = Day(i): mm = Month(i): yyyy = Year(i)\n\n    For Each element In inputs\n        If element.Name = \"Mdate\" Then\n            element.Value = yyyy &amp; \"-\" &amp; mm &amp; \"-\" &amp; dd\n        Else\n            If element.Name = \"button\" Then\n                element.Click\n                'insert scraper\n                Set eles1 = htmldoc.getElementsByTagName(\"a\")                                          'Find all centre tags\n                    For Each ele1 In eles1\n                        If InStr(ele1.href, \"/horse-racing-results/\") &gt; 0 Then\n                            raceMeet = ele1.innerText\n                            raceURL = ele1.innerHTML\n                            ReDim Preserve racemeetArr(1 To 2, UBound(racemeetArr, 2) + 1)\n                            racemeetArr(1, UBound(racemeetArr, 2)) = raceMeet\n                            racemeetArr(2, UBound(racemeetArr, 2)) = raceURL\n                        End If\n                    Next ele1\n            Else\n            End If\n        End If\n\n    Next element\nStop\n\nNext i\n\nie.Quit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420618980, "post_id": 27814018, "comment_id": 44036649, "body": "VBA is much older than VB.NET and there isn&#39;t an equivalent way to do a try/catch block. You could <i>fake</i> it with a quite weird syntax and multiple <code>goto</code>s but I see no point in doing that really.."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1420636555, "post_id": 27814018, "comment_id": 44046302, "body": "@vba4all You should check out my answer below. I&#39;m quite proud of my innovation. You can call it weird if you want but history often has progress overtaking the naysayers. It certainly isn&#39;t bad code IMHO."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420639748, "post_id": 27814018, "comment_id": 44048155, "body": "I see exactly what you did there but to me the <code>Resume EndTry1</code> ain&#39;t any different then saying <code>GoTo &lt;anyLabel&gt;</code> and random <code>goto</code>s are bad habits and should be avoided at all costs. Btw what you&#39;ve done here <a href=\"http://www.vbforums.com/showthread.php?448403-Classic-VB-Why-do-errors-crash-my-program-and-how-can-I-stop-that-from-happening\" rel=\"nofollow noreferrer\">been generally known for years already</a> <i>just hasn&#39;t probably been mentioned on SO</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 1, "creation_date": 1420640263, "post_id": 27814018, "comment_id": 44048477, "body": "And also see this: <a href=\"http://msdn.microsoft.com/en-gb/library/aa242093%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">Inline Error Handling</a>"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1435016737, "post_id": 27814018, "comment_id": 50012918, "body": "You can simulate a TRY CTACH block in VBA Please see here   <a href=\"http://stackoverflow.com/q/30991653/4413676\">stackoverflow.com/q/30991653/4413676</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1420647567, "post_id": 27814019, "comment_id": 44053397, "body": "try that in a real world environment - <i>if you know what i mean</i> ;)"}], "tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 2, "last_activity_date": 1435283745, "last_edit_date": 1525816098, "creation_date": 1420613907, "answer_id": 27814019, "question_id": 27814018, "link": "https://stackoverflow.com/questions/27814018/how-to-do-an-error-handling-block-inline-like-try-catch/27814019#27814019", "title": "How to do an error handling block inline like Try/Catch", "body": "<p>This code will handle the error inline. This is a very cleanly structured pattern for handling an error. The flow moves very cleanly from top to bottom; no spaghetti code here.</p>\n\n<p>VBA is an old language and has limitations. One of the ways to use error handling is to use <code>Goto</code> statements in the form of <code>On Error Goto &lt;Label&gt;</code> and <code>Resume &lt;Label&gt;</code>. This creates an opportunity.</p>\n\n<p>Traditionally the error handler is placed at the bottom. But with the advances made in VB.net, it seems reasonable to leverage ideas to improve code. Try/Catch is a very structured way of handling errors and is very easy to follow. This pattern attempts to reproduce that in a very clean concise way. The flow is very consistent and doesn't jump from place to place.</p>\n\n<pre><code>Sub InLineErrorHandling()\n\n    'code without error handling\n\nBeginTry1:\n\n    'activate inline error handler\n    On Error GoTo ErrHandler1\n\n    'code block that may result in an error\n    Dim a As String: a = \"Abc\"\n    Dim c As Integer: c = a 'type mismatch\n\nErrHandler1:\n\n    'handle the error\n    If Err.Number &lt;&gt; 0 Then\n\n        'the error handler is now active\n        Debug.Print (Err.Description)\n\n    End If\n\n    'disable previous error handler (VERY IMPORTANT)\n    On Error GoTo 0\n    'exit the error handler\n    Resume EndTry1\n\nEndTry1:\n\n    'more code with or without error handling\n\nEnd Sub\n</code></pre>\n\n<p>Sources:</p>\n\n<ul>\n<li><a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">Pearson Error Handling In VBA</a> </li>\n<li><a href=\"http://msdn.microsoft.com/en-us/library/bb258159.aspx\" rel=\"nofollow noreferrer\">How to: Handle Run-Time Errors in VBA</a> </li>\n<li><a href=\"https://stackoverflow.com/questions/6028288/properly-handling-errors-in-vba-excel\">Properly Handling Errors in VBA (Excel)</a></li>\n</ul>\n\n<p>Properly managed this works quite nicely. It is a very clean flowing pattern that is reproducible anywhere it is needed.</p>\n"}, {"comments": [{"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1420636647, "post_id": 27814846, "comment_id": 44046354, "body": "This is a great example of how to solve this specific problem. But the broader question was how do do error handling inline."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1420765039, "post_id": 27814846, "comment_id": 44108468, "body": "@D_Bester That is what I&#39;ve provided exactly. OERN + OEG0 actually gives you the <code>Try</code> part. After that, you can actually have a <code>Select Case</code> or <code>If</code> (which will serve as your <code>Catch</code>) for the possible error numbers and react accordingly. I agree with vba4all regarding the use of <code>Goto</code> so as much as possible I avoid it as well. I limit myself to 1 <code>Goto</code> per code :) Well that&#39;s me. It might not be true to all."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1420766181, "post_id": 27814846, "comment_id": 44108761, "body": "Excellent code I agree! There are many problems that can be solved with this approach. I would call this a Try/Test method. And it does solve the error inline."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1420618034, "last_edit_date": 1420618034, "creation_date": 1420617714, "answer_id": 27814846, "question_id": 27814018, "link": "https://stackoverflow.com/questions/27814018/how-to-do-an-error-handling-block-inline-like-try-catch/27814846#27814846", "title": "How to do an error handling block inline like Try/Catch", "body": "<p>You can try assigning your object in a variable and use <em>On Error Resume Next</em> instead.</p>\n\n<pre><code>Dim sh As Worksheet\n\n'This is essentially the \"Try\" part\nOn Error Resume Next 'this ignores the error\nSet sh = Worksheets(\"NewSheet\")\nOn Error Goto 0 'this resets the active error handling routine\n\n'Then this is the \"Catch\" part I guess\nIf sh Is Nothing Then 'check is something is assigned to sh\n    'And I think this is \"Finally\" part\n    Set sh = Worksheets.Add: sh.Name = \"NewSheet\" 'add otherwise\nEnd If\n</code></pre>\n\n<p>Not really familiar with the Try/Catch since I've not done some VB.Net but this is the closest inline error correction I can think of for your example. HTH.</p>\n"}], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1648, "favorite_count": 0, "accepted_answer_id": 27814019, "answer_count": 2, "score": 1, "last_activity_date": 1435283745, "creation_date": 1420613907, "last_edit_date": 1525816150, "question_id": 27814018, "link": "https://stackoverflow.com/questions/27814018/how-to-do-an-error-handling-block-inline-like-try-catch", "title": "How to do an error handling block inline like Try/Catch", "body": "<p>How would I do an inline error handling routine in VBA? I don't want to put the error handler at the end.</p>\n\n<p>This is from <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">CPearson's Error Handling in VBA</a></p>\n\n<pre><code>Sub testErrHandling()\n    On Error GoTo ErrHandler:\n\n    Debug.print 9 / 0 'divide by zero error\n\n    Worksheets(\"NewSheet\").Activate 'missing worksheet error\n\n    'more code here\n\n    Exit Sub\n\nErrHandler:\n    If Err.Number = 9 Then\n        ' sheet does not exist, so create it\n        Worksheets.Add.Name = \"NewSheet\"\n        ' go back to the line of code that caused the problem\n        Resume\n    End If\nEnd Sub\n</code></pre>\n\n<p>But I'm looking for something more like a Try/Catch block in VB.net</p>\n"}, {"tags": ["vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "is_accepted": false, "score": 0, "last_activity_date": 1421040494, "creation_date": 1421040494, "answer_id": 27895826, "question_id": 27813434, "link": "https://stackoverflow.com/questions/27813434/vba-ie-navigate-doesnt-work/27895826#27895826", "title": "vba ie.navigate doesn&#39;t work", "body": "<p>This doesn't answer your actual question, but:</p>\n\n<p>(1) You should always have a timeout in your \"wait until document ready\" loops. Otherwise, those loops can wait forever if the page does not go ready. In fact when I tried navigating manually (via the IE URL bar) to \"<a href=\"http://cltd.ro/customer/account/login/\" rel=\"nofollow\">http://cltd.ro/customer/account/login/</a>\", it sat there spinning for quite some time, until I gave up and hit stop. Your code should detect cases where the document takes too ling to go ready, and reply with something like \"Website hasn't responded for 60 seconds, do you want to keep waiting? [yes] [No]\".</p>\n\n<p>(2) You don't allow for the case where the page <em>does</em> go ready, but it's not the page you wanted. For example, if the website returns an error, or IE decides to time it out, you'll get a page with a URL of the form \"res://...\" - not the page you actually asked for. You can't just assume that you actually got the right page.</p>\n\n<p>So your existing code is ok for a 1-off script, but not sufficiently robust for proper production use.</p>\n"}], "owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421276597, "creation_date": 1420611149, "last_edit_date": 1421037235, "question_id": 27813434, "link": "https://stackoverflow.com/questions/27813434/vba-ie-navigate-doesnt-work", "title": "vba ie.navigate doesn&#39;t work", "body": "<p>I need to navigate to a page using VBA. I created the code bellow and it worked just fine until I reinstalled Windows. I don't know if this is the cause, but it is not working anymore.</p>\n\n<p>There are tho cases:</p>\n\n<ol>\n<li><p>If I'm not logged in before running the macro</p>\n\n<p>The first part, for logging onto the page is working, but when I try to navigate to \"<a href=\"http://cltd.ro/catalogsearch/result/?q=60041\" rel=\"nofollow\">http://cltd.ro/catalogsearch/result/?q=60041</a>\", I get an error \"Method 'Navigate' of object 'IWebBrowser 2' failed\".</p></li>\n<li><p>If I'm already logged on to the site</p>\n\n<p>On the other hand, if I'm already logged in before running the macro, the code is working and I get to the desired page, but the code gets stuccked in to the loop \"Do/DoEvents/Loop Until ie.readystate = 4\" forever and I cannot continue</p></li>\n</ol>\n\n<p>Please help!\nThanks!</p>\n\n<pre><code>Sub xx()\n\n    Dim ie As Object\n    Set ie = CreateObject(\"internetexplorer.application\")\n\n    ie.Visible = True\n    AppActivate ie\n    apiShowWindow ie.hwnd, 3\n    ie.Visible = True\n    ie.navigate \"http://cltd.ro/customer/account/login/\"\n    Do\n    DoEvents\n    Loop Until ie.readystate = 4\n\n    On Error Resume Next    'in case I'm already loggen in\n    Call ie.Document.getElementById(\"email\").setattribute(\"value\", \"dfgsdfg\")   'not real value ;-)\n    Call ie.Document.getElementById(\"pass\").setattribute(\"value\", \"dfgsdfg\")    'not real value ;-)\n    Call ie.Document.getElementById(\"send2\").Click\n    Do\n    DoEvents\n    Loop Until ie.readystate = 4\n    On Error GoTo 0         'cancels the resume next\n\n    Application.Wait (Now() + TimeValue(\"0:00:02\"))\n\n    link = \"http://cltd.ro/catalogsearch/resuilt/?q=60041\"\n    ie.navigate link\n    Do\n    DoEvents\n    Loop Until ie.readystate = 4\n\n'Other lines of code ...............\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420611841, "post_id": 27813400, "comment_id": 44034094, "body": "i managed to get the view code. But when i look into it there is already code in it. like this &#39;Private Sub btnGenTestSumm_Click()  End Sub &#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420613622, "post_id": 27813400, "comment_id": 44034751, "body": "ok. did the same. but then how shall it works. I mean, I would like to select the cells and then click on this ? please treat me as a beginer"}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420613668, "post_id": 27813400, "comment_id": 44034769, "body": "Yes! Just select the cells you want to copy, you would see that they are highlighted, just like when you use Ctrl + C !!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420614074, "post_id": 27813400, "comment_id": 44034914, "body": "Yes.. but when i opened the clipboard, the cell contents are not in it. Also, when i press CTRL+V also , the contents are not pasting.."}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420614141, "post_id": 27813400, "comment_id": 44034943, "body": "Not sure if you are doing it right then, are the cells highlighted when you click on them?"}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420614169, "post_id": 27813400, "comment_id": 44034956, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/68319/discussion-between-neomen-and-master-mind\">continue this discussion in chat</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420614250, "post_id": 27813400, "comment_id": 44034992, "body": "Yes, it gets highlighted Chat is blocked in my network."}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420614318, "post_id": 27813400, "comment_id": 44035015, "body": "with dotted flickering lines?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420614474, "post_id": 27813400, "comment_id": 44035069, "body": "no, when i select the cells, a light blue shade is seen. I think its is the general highlight of Excel. sorry my mistake"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420614634, "post_id": 27813400, "comment_id": 44035135, "body": "this is what i can see in my VB.....  &#39;Private Sub btnGenTestSumm_Click()  End Sub  Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range) Application.CutCopyMode = False Target.Copy End Sub &#39;"}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420614926, "post_id": 27813400, "comment_id": 44035240, "body": "Not sure if the already existing function is interferring, you might want to try the code in the fresh excel sheet or you could comment out the already existing code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420616507, "post_id": 27813400, "comment_id": 44035802, "body": "In a new sheet , <b>1</b>) i tried with a button and on its right click i removed all the defaults and pasted the above code. <b>2</b>) then i selected the cells-- which are not seen with that dotted flickering lines <b>3</b>) And still i cant see the contents in the clipboard.... :("}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420624405, "post_id": 27813400, "comment_id": 44039413, "body": "I am really not sure what is the mistake that you are making! At most i could post screenshots of how I have done it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "edited": false, "score": 0, "creation_date": 1420624776, "post_id": 27813400, "comment_id": 44039609, "body": "shall i show my code again- or shall i post it in a jsfiddle for u to easily see"}, {"owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "edited": false, "score": 0, "creation_date": 1420625893, "post_id": 27813400, "comment_id": 44040287, "body": "I am not able to upload pics right now. May be I will do it later. Meanwhile try going through this site - <a href=\"http://www.mrexcel.com/forum/excel-questions/418891-copy-cell-clipboard-single-click.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1908, "user_id": 4294868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/70WKg.jpg?s=128&g=1", "display_name": "NEOmen", "link": "https://stackoverflow.com/users/4294868/neomen"}, "is_accepted": false, "score": 1, "last_activity_date": 1420610940, "creation_date": 1420610940, "answer_id": 27813400, "question_id": 27813233, "link": "https://stackoverflow.com/questions/27813233/copy-specific-cell-contents-into-clipboard-in-excel/27813400#27813400", "title": "Copy specific cell contents into clipboard in Excel", "body": "<p>This will work for any sheet in the workbook and clear the clipboard before copying. Right click the Excel logo just to the left of File on the menu bar, select View Code and paste in</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\nApplication.CutCopyMode = False\nTarget.Copy\nEnd Sub\n</code></pre>\n\n<p>then press ALT + Q to return to your sheet. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4348246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420615357, "creation_date": 1420610100, "last_edit_date": 1420615357, "question_id": 27813233, "link": "https://stackoverflow.com/questions/27813233/copy-specific-cell-contents-into-clipboard-in-excel", "title": "Copy specific cell contents into clipboard in Excel", "body": "<p>I am a frequent user of Excel. Now I was looking to copy some of specific cells into clipboard for pasting them in another application. </p>\n\n<p>I could see the copy single cell data into clipboard. Can someone suggest steps to make a configurable way to copy specific cell data into clipboard by the click of a button?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 795, "user_id": 4404399, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-oQ1pUmRbWy8/AAAAAAAAAAI/AAAAAAAAAAA/AiLol5KoHqU/photo.jpg?sz=128", "display_name": "Edward Bagby", "link": "https://stackoverflow.com/users/4404399/edward-bagby"}, "edited": false, "score": 0, "creation_date": 1420606863, "post_id": 27812597, "comment_id": 44032764, "body": "Please, give it your best shot and ask for help when you encounter problems you cannot resolve (after doing your research)."}, {"owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "reply_to_user": {"reputation": 795, "user_id": 4404399, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-oQ1pUmRbWy8/AAAAAAAAAAI/AAAAAAAAAAA/AiLol5KoHqU/photo.jpg?sz=128", "display_name": "Edward Bagby", "link": "https://stackoverflow.com/users/4404399/edward-bagby"}, "edited": false, "score": 0, "creation_date": 1420607966, "post_id": 27812597, "comment_id": 44033031, "body": "<a href=\"http://imgur.com/MeIp3KD\" rel=\"nofollow noreferrer\">Image of issue</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1420608389, "post_id": 27812597, "comment_id": 44033146, "body": "Your image does not match your description. Is the user intended to type a number into B6 or A6? Are the initial series of numbers to be generating starting B7 or B6?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "edited": false, "score": 0, "creation_date": 1420665994, "post_id": 27812843, "comment_id": 44063825, "body": "Thanks @Jeeped, but I&#39;m still having trouble getting the it to copy a sheet (to use as a template) and then giving it a the name &quot;Unit 1.1&quot;. <code>Sheets(&quot;Unit&quot;).Copy(after:=Sheets(Sheets.Count))..Name = _                   Target.Offset(0, -1) &amp; Chr(46) &amp; w </code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1420607812, "creation_date": 1420607812, "answer_id": 27812843, "question_id": 27812597, "link": "https://stackoverflow.com/questions/27812597/creating-a-list-from-a-number-then-creating-sheets-from-the-list/27812843#27812843", "title": "Creating a list from a number, then creating sheets from the list", "body": "<p>I worked all of the code into a single <code>Worksheet_Change</code> event macro. This may be more automatic than you intended. Error control to avoid attempting to create a worksheet with a duplicate name should be added.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    If Target.Address = \"$B$6\" Then\n        Application.EnableEvents = False\n        With Target.Offset(1, 0)\n            Range(.Cells(1), .Cells(1).End(xlDown)).ClearContents\n            .Value = 1\n            .Resize(Target.Value, 1).DataSeries _\n              Rowcol:=xlColumns, Type:=xlLinear, Step:=1\n        End With\n        Target.Offset(0, 1).Activate\n    ElseIf Not Intersect(Target, Columns(\"C\")) Is Nothing Then\n        If Target.Row &gt; 6 And Application.Count(Target.Offset(0, -1).Resize(1, 2)) = 2 Then\n            On Error GoTo F\u00ecn\n            Application.EnableEvents = False\n            Dim w As Long\n            For w = 1 To Target.Value\n                Sheets.Add(after:=Sheets(Sheets.Count)).Name = _\n                  Target.Offset(0, -1) &amp; Chr(46) &amp; w\n            Next w\n            Me.Activate\n        End If\n    End If\nF\u00ecn:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>If you prefer a button to create the additional worksheets and are having trouble peeling out the relevant section of code, post back showing your own effort (noting any line that generates a error). As noted above, error control for duplicate worksheet names should definitely be addressed.</p>\n"}], "owner": {"reputation": 3, "user_id": 4427424, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8bbc9864106dcd7782d096ebdbb5429?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Stalling", "link": "https://stackoverflow.com/users/4427424/aaron-stalling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1420608326, "creation_date": 1420606319, "last_edit_date": 1531164843, "question_id": 27812597, "link": "https://stackoverflow.com/questions/27812597/creating-a-list-from-a-number-then-creating-sheets-from-the-list", "title": "Creating a list from a number, then creating sheets from the list", "body": "<p>Could someone please help me with the following: If the user puts \"10\" in B6 on a sheet called \"Data\", then B7 downwards will count up to the number e.g. B7 will be \"1\", B8 will be \"2\", B9 will be \"3\", and so on.<br>\nThe user then puts a value to the right of those numbers and clicks a on screen button the following new sheets are created from a template sheet called \"ML\".<br>\ne.g. B6 is \"1\" and C6 is \"3\" then 4 sheets are created (a copy of \"ML\") called \"1.1\", \"1.2\", and \"1.3\"\nB7 is \"2\" and C7 is \"5\" then 5 sheets are created (a copy of \"ML\") called \"2.1\", \"2.2\", \"2.3\", \"2.4\", and \"2.5\"  </p>\n\n<p><strong>Image Illustrating problem</strong></p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/zF8xT.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1420604914, "post_id": 27812260, "comment_id": 44032283, "body": "Post the code which generates the report please"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1420605171, "post_id": 27812260, "comment_id": 44032328, "body": "Nop. It is generated from a system. No codes for that... :-("}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1420608850, "post_id": 27812260, "comment_id": 44033273, "body": "Yep. It output to excel..."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1420633823, "post_id": 27812260, "comment_id": 44044799, "body": "Will the names of the fields be always the same?"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1420610271, "post_id": 27813035, "comment_id": 44033646, "body": "Thx for the quick response. I am not an expert in VB. Could you please at least help me by putting the line break before Service Schedule?"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1420610490, "post_id": 27813035, "comment_id": 44033698, "body": "When I select the relevant cell and use this code, it stack all the characters vertically...."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1420612467, "post_id": 27813035, "comment_id": 44034307, "body": "@Isu - As posted, &quot;the code below adds a newline character after every character in the selected cell.&quot; That is why it stacks all the characters vertically. It was meant just as an example. Please take it as such. Interpret what each line is doing (it is quite simple), and adapt it to your needs. The <code>&amp;</code> character means string concatenation. You will have to find the way to tell your code where are the appropriate points to insert the newlines."}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420633903, "post_id": 27813035, "comment_id": 44044854, "body": "@sancho.s FYI: Chr(10) = vbLf"}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1420608945, "creation_date": 1420608945, "answer_id": 27813035, "question_id": 27812260, "link": "https://stackoverflow.com/questions/27812260/adding-line-breaks-in-a-single-cell/27813035#27813035", "title": "Adding line breaks in a single cell", "body": "<p>To add a newline character in Excel via VBA, you have to use <code>Chr(10)</code>.</p>\n\n<p>For instance, the code below adds a newline character after every character in the selected cell.</p>\n\n<p>You will have to find the way to tell your code where are the appropriate points to insert the newlines.</p>\n\n<pre><code>Sub insert_nl()\n    Dim rng As Range\n    Set rng = Selection\n    Dim ic As Integer, nc As Integer\n    Dim s1 As String, s2 As String\n    s1 = rng.Value\n    nc = Len(s1)\n    s2 = \"\"\n    For ic = 1 To nc - 1\n        s2 = s2 &amp; Mid(s1, ic, 1) &amp; Chr(10)   ' This line adds the newline character\n    Next ic\n    s2 = s2 &amp; Mid(s1, nc, 1)\n    rng.Value = s2\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1421021080, "post_id": 27814147, "comment_id": 44188364, "body": "Thx. I hope this should work. But how I select the relevant column?"}], "tags": [], "owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "is_accepted": false, "score": 1, "last_activity_date": 1420615054, "last_edit_date": 1420615054, "creation_date": 1420614488, "answer_id": 27814147, "question_id": 27812260, "link": "https://stackoverflow.com/questions/27812260/adding-line-breaks-in-a-single-cell/27814147#27814147", "title": "Adding line breaks in a single cell", "body": "<p>You could use the following UDF</p>\n\n<pre><code>Function SplitText(r As Range) As String\n\nDim i As Integer, ii As Integer\n\n    i = Application.Find(\"Service S\", r)\n    SplitText = SplitText &amp; Left(r, i - 1) &amp; vbLf\n    ii = Application.Find(\"Site A\", r)\n    SplitText = SplitText &amp; Mid(r, i, ii - i) &amp; vbLf\n    i = Application.Find(\"City A\", r)\n    SplitText = SplitText &amp; Mid(r, ii, i - ii) &amp; vbLf\n    ii = Application.Find(\"Site B\", r)\n    SplitText = SplitText &amp; Mid(r, i, ii - i) &amp; vbLf\n    i = Application.Find(\"City B\", r)\n    SplitText = SplitText &amp; Mid(r, ii, i - ii) &amp; vbLf\n    ii = Application.Find(\"Service ID\", r)\n    SplitText = SplitText &amp; Mid(r, i, ii - i) &amp; vbLf\n    i = Application.Find(\"W/O\", r)\n    SplitText = SplitText &amp; Mid(r, ii, i - ii) &amp; vbLf\n    ii = Application.Find(\"Capacity\", r)\n    SplitText = SplitText &amp; Mid(r, i, ii - i) &amp; vbLf\n    SplitText = SplitText &amp; Right(r, Len(r) - i + 1)\n\nEnd Function\n</code></pre>\n\n<p>After entering the formula in the destination cell you will need to format the destination cell as Wrap Text.</p>\n\n<p>e.g. If text is in A1 and destination cell is A4, then in A4 put <strong>=SplitText(A1)</strong> and the format A4 to Wrap Text.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1420640824, "creation_date": 1420640824, "answer_id": 27821619, "question_id": 27812260, "link": "https://stackoverflow.com/questions/27812260/adding-line-breaks-in-a-single-cell/27821619#27821619", "title": "Adding line breaks in a single cell", "body": "<p>Here is a slightly different approach:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const sFldNames = \",Contract Ref:,Service Schedule,Site A:,City A:,Site B:,City B:,Service ID:,W/O:,Capacity:\"\n\n'Call this Sub with the parameters supplied and it is done\nPrivate Sub SplitReportString(sRpt As String, sTabName As String, row As Long, col As Long)\n'sTabName is the worksheet's name you want to write your output to\n'row and col is where you want to start writing your output at\n    Dim vFldNamesArray As Variant\n    Dim i As Long\n    Dim vRptArray As Variant\n\n    vFldNamesArray = Split(sFldNames, \",\")\n    For i = 1 To UBound(vFldNamesArray, 1)\n        sRpt = Replace(sRpt, vFldNamesArray(i), \",\" &amp; vFldNamesArray(i))\n    Next\n    vRptArray = Split(sRpt, \",\")\n    With ThisWorkbook.Worksheets(sTabName)\n        For i = 1 To UBound(vRptArray)\n            .Cells(row + i - 1, col) = vRptArray(i)\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "closed_date": 1420644223, "answer_count": 3, "score": 2, "last_activity_date": 1421690049, "creation_date": 1420603684, "last_edit_date": 1421690049, "question_id": 27812260, "link": "https://stackoverflow.com/questions/27812260/adding-line-breaks-in-a-single-cell", "closed_reason": "Duplicate", "title": "Adding line breaks in a single cell", "body": "<p>I try to found a solution for this for sometime now.\nI generate specific report every month and use this report to automatically generate invoices.</p>\n\n<p>One of the report cells include data similar to this</p>\n\n<pre><code>Contract Ref: #Service Schedule 001 Site A: No, 22, ABC Road,City A: TSV Site \nB: Home exchange  City B: TSV Service ID: xxxxxxxxxxx W/O: 123 Capacity: Multiple\n</code></pre>\n\n<p>I need to force line breaks to all these cells that looks like this after that.</p>\n\n<pre><code>Contract Ref: #\nService Schedule 001 \nSite A: No, 22, ABC Road, \nCity A: TSV \nSite B: Home exchange  \nCity B: TSV \nService ID: xxxxxxxxxxx \nW/O: 123 \nCapacity: Multiple\n</code></pre>\n\n<p>Can some one help me with that?</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420618105, "post_id": 27812231, "comment_id": 44036342, "body": "Not sure what are you trying to achieve... What you mean by &quot;embed a single excel &#39;cell&#39; into the userform instead of an entire workbook?&quot; I can&#39;t get it... Do you want to create a userform in which you&#39;ll be able to edit single record?"}, {"owner": {"reputation": 53, "user_id": 4139509, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/dU7ol.jpg?s=128&g=1", "display_name": "Jordan Elphick", "link": "https://stackoverflow.com/users/4139509/jordan-elphick"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420664560, "post_id": 27812231, "comment_id": 44063109, "body": "I want to embed an object that has similar functionality to an excel &#39;cell&#39;. Thus affording me more control over the environment in which the users can edit a record."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420671790, "post_id": 27812231, "comment_id": 44066433, "body": "Still can&#39;t get you ;( Would you like to create form like this: <a href=\"http://losmac.republika.pl/download/so_singlecellobject.jpg\" rel=\"nofollow noreferrer\">losmac.republika.pl/download/so_singlecellobject.jpg</a> ?"}, {"owner": {"reputation": 53, "user_id": 4139509, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/dU7ol.jpg?s=128&g=1", "display_name": "Jordan Elphick", "link": "https://stackoverflow.com/users/4139509/jordan-elphick"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420696358, "post_id": 27812231, "comment_id": 44072926, "body": "I want a way of embedding a spreadsheet object into a userform (hide all the columns, rows besides col 1, row 1 i.e. a single visible cell). I have tried this method described above however the spreadsheet object once embedded into a userform causes the application to crash when doing basic manipulations to properties such as: UserForm1.Spreadsheet1.activewindow.DisplayHeadings = false How else can I embed a spreadsheet in the userform?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420699508, "post_id": 27812231, "comment_id": 44073949, "body": "Thank you for clarification. Please, see my answer."}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1420699485, "creation_date": 1420699485, "answer_id": 27834416, "question_id": 27812231, "link": "https://stackoverflow.com/questions/27812231/vba-creating-a-userform-single-cell-object/27834416#27834416", "title": "VBA creating a Userform single cell object", "body": "<p>You can't. There is no way to embed Worksheet into the userform. But...</p>\n\n<p>You can imitate it via using <a href=\"http://msdn.microsoft.com/en-us/library/office/gg278821%28v=office.15%29.aspx\" rel=\"nofollow\">ListBox</a>. It provides a way to display data as Excel Sheet displays rows and columns. It gives you a possibility to select single row or multiple rows at a time. You can make visible only one column, the rest of columns can be hidden (use ColumnWidth property).</p>\n\n<p>Cheers<br/>\nMaciej</p>\n"}], "owner": {"reputation": 53, "user_id": 4139509, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/dU7ol.jpg?s=128&g=1", "display_name": "Jordan Elphick", "link": "https://stackoverflow.com/users/4139509/jordan-elphick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420699485, "creation_date": 1420603387, "last_edit_date": 1420603834, "question_id": 27812231, "link": "https://stackoverflow.com/questions/27812231/vba-creating-a-userform-single-cell-object", "title": "VBA creating a Userform single cell object", "body": "<p>I've developed an application that uses excel/ VBA to interface a MySQL database in a WAMP configuration. One of the features of this application is the automatic saving of cells values, including the colors of words, font style, font size etc. The application loads up a calendar and renders the entered cell text upon workbook open.</p>\n\n<p>This is achieved through breaking down the cell value into characters and storing them into a cell_value table that references other objects within my database in the following manor</p>\n\n<pre><code>+----+-------------+------------+------------+----------------------+--------------------+\n| id | employee_id | project_id |    date    |      cell_value      |     font_color     |\n+----+-------------+------------+------------+----------------------+--------------------+\n|  1 |           1 |          1 | 2015-01-07 | the weather is crazy | 1:14:70,15:20:2000 |\n+----+-------------+------------+------------+----------------------+--------------------+\n</code></pre>\n\n<p>this table stores the text entered by person with id=1 for project with id=1 on '2015-01-07'. The cell value is 'the weather is crazy'. the font color is listed in a comma delimited string with each element of this string delimited by a colon.</p>\n\n<pre><code>+--------------------------+------------------------+------------+\n| starting_character_index | ending_character_index | font_color |\n+--------------------------+------------------------+------------+\n|                        1 |                     14 |         70 |\n|                       15 |                     20 |       2000 |\n+--------------------------+------------------------+------------+\n</code></pre>\n\n<p>I have been using the cell_selection_change event to trigger an automatic write to the database to store the contents of a global called LAST_SELECTED_CELL (as the active cell is set prior to the user making changes to it and hence does not cater for writing to the database AFTER the user makes changes to the contents of the cell).</p>\n\n<p>this method works although is prone to bugs and for large amounts of cells and complex cell font/ color configurations is slow.</p>\n\n<p>I was looking into using a spreadsheet embedded into a userform as potentially a better way of doing a similar process however i've found it to be quite buggy and prone to crashing. Is there a tool out there that allows you to embed a single excel 'cell' into the userform instead of an entire workbook?</p>\n\n<p>If not, is there anything else that could be modified to suit my needs? Or do you have any suggestions as to how to improve my current method of storing/ rendering the data</p>\n\n<p>Kind regards\nJordan</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 4, "last_activity_date": 1420608354, "last_edit_date": 1420608354, "creation_date": 1420604329, "answer_id": 27812339, "question_id": 27811066, "link": "https://stackoverflow.com/questions/27811066/how-to-load-multiple-files-into-my-excel-tool/27812339#27812339", "title": "How to load multiple files into my excel tool?", "body": "<p>I like to use the FileDialogs, which I think are more flexible. Here's a bit of code that you should be able to modify and use:</p>\n\n<pre><code>Private Sub PickExcelFiles()\nDim fdFileDialog As FileDialog\nDim SelectedItemsCount As Long\nDim i As Long\n\nSet fdFileDialog = Application.FileDialog(msoFileDialogOpen)\nWith fdFileDialog\n    .Filters.Clear\n    .Filters.Add \"XLS* Files (*.xls*)\", \"*.xls*\"\n    .FilterIndex = 1\n    .InitialView = msoFileDialogViewDetails\n    .Title = \"Select SQL Files\"\n    .ButtonName = \"Select\"\n    .AllowMultiSelect = True\n    .Show\n    If .SelectedItems.Count = 0 Then\n        Exit Sub\n    End If\n    SelectedItemsCount = .SelectedItems.Count\n    For i = 1 To SelectedItemsCount\n        Workbooks.Open .SelectedItems(i)\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1420611258, "post_id": 27813028, "comment_id": 44033921, "body": "Thanks for the edit on mine. I&#39;ll have to go fix the code I pulled it from :-)."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1420612064, "post_id": 27813028, "comment_id": 44034172, "body": "@DougGlancy No worries. Only do it for a few cool VBA gurus who don&#39;t mind others edits on their answers. :-)"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 3, "last_activity_date": 1420608913, "creation_date": 1420608913, "answer_id": 27813028, "question_id": 27811066, "link": "https://stackoverflow.com/questions/27811066/how-to-load-multiple-files-into-my-excel-tool/27813028#27813028", "title": "How to load multiple files into my excel tool?", "body": "<p>Another way is to set the <em>MultiSelect</em> argument to TRUE.</p>\n\n<pre><code>vfile = Application.GetOpenFilename(\"Excel Files (*.xls*)\" &amp; _\n        \",*.xls*\", 1, \"Select Excel File\", \"Open\", True)\nIf Not IsArray(vfile) Then Exit Sub\nFor i = LBound(vfile) To UBound(vfile)\n    Workbooks.Open vfile(i)\n    'other cool stuff go here\nNext\n</code></pre>\n\n<p>Take note that <code>vfile</code> should be declared as <code>Variant</code> as you've done.</p>\n"}], "owner": {"reputation": 29, "user_id": 4289956, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90f3b779bf063dc7fac8132e80fa40b8?s=128&d=identicon&r=PG&f=1", "display_name": "patchlam", "link": "https://stackoverflow.com/users/4289956/patchlam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 27813028, "answer_count": 2, "score": 2, "last_activity_date": 1420608913, "creation_date": 1420601787, "last_edit_date": 1531161705, "question_id": 27811066, "link": "https://stackoverflow.com/questions/27811066/how-to-load-multiple-files-into-my-excel-tool", "title": "How to load multiple files into my excel tool?", "body": "<p>I would like to make my tool to be able to select multiple files and do the loading without going through the open file dialogue for every single file. Here is my initial coding:</p>\n\n<pre><code>Sub Step_One()\n\nDim vFile As Variant\nDim sInputFileName As String\nDim sInputTabName As String\nDim sInputWorkbookName As String\nDim wb As Workbook\nDim wbCurrent As Workbook\n\nSet wbCurrent = ActiveWorkbook\n\n'Showing Excel Open Dialog Form\nvFile = Application.GetOpenFilename(\"Excel Files (*.xls*),\" &amp; _\n\"*.xls*\", 1, \"Select Excel File\", \"Open\", False)\n\n'If Cancel then exit\nIf TypeName(vFile) = \"Boolean\" Then\nExit Sub\nEnd If\n\n'Retrieve Filename\nsInputFileName = Dir(vFile, vbDirectory)\nsInputTabName = Dir(vFile, vbDirectory)\nsInputWorkbookName = Dir(vFile, vbDirectory)\n\nApplication.DisplayAlerts = False\n\n'Open selected file\nWorkbooks.Open vFile\n\nApplication.DisplayAlerts = False\n\n\nbFound = False\nFor Each wb In Application.Workbooks\n    If InStr(UCase(wb.Name), UCase(sInputFileName)) &gt; 0 Then\n        bFound = True\n        Exit For\n    End If\nNext wb\nIf Not bFound Then Set wb = Application.Workbooks.Open(sInputWorkbookName)\n\nbFound = False\nFor Each shtData2 In wb.Sheets\n    If UCase(shtData2.Name) = UCase(\"Tank Super\") Then\n        bFound = True\n\n        Exit For\n    End If\n\n\nNext shtData2\nIf Not bFound Then\n    MsgBox \"Worksheet missing\", vbInformation + vbOKOnly\n    Set shtData2 = Nothing\n    Exit Sub\nEnd If\n\nbFound = False\nFor Each shtMain In wbCurrent.Sheets\n    If UCase(shtMain.Name) = UCase(\"Daily Comparison\") Then\n        bFound = True\n        Exit For\n    End If\nNext shtMain\nIf Not bFound Then\n    MsgBox \"Worksheet missing\", vbInformation + vbOKOnly\n    Set shtMain = Nothing\n    Exit Sub\nEnd If\n\nFor Each sh In wb.Worksheets\nIf sh.Name Like \"Tank Diesel\" _\n    Or sh.Name Like \"Tank V-Power\" _\n    Or sh.Name Like \"Tank Super\" Then sh.Copy After:=wbCurrent.Sheets(\"Daily Comparison\")\nNext\n\nwb.Close\nSet wb = Nothing\n\nWorksheets(\"Daily Comparison\").Unprotect \"superman\"\n\nSheets(\"Daily Comparison\").Select\nRange(\"A1\").Select\n\nIf (ActiveSheet.AutoFilterMode And ActiveSheet.FilterMode) Or ActiveSheet.FilterMode Then\n\n    ActiveSheet.ShowAllData\n\nEnd If\n\nApplication.DisplayAlerts = False\n\nFor Each sh In wbCurrent.Sheets\n\nIf sh.Name Like \"Tank Diesel\" Then\n\n\n    If Sheets(\"Tank Diesel\").AutoFilterMode Then 'autofilter is 'on'\n        On Error Resume Next   'turn off error reporting\n        Sheets(\"Tank Diesel\").ShowAllData\n        On Error GoTo 0   'turn error reporting back on\n    End If\n\n    Dim dys As Long\n\n    dys = Day(Application.EoMonth(DateValue(Sheets(\"Tank Diesel\").Cells(1, 5).Value &amp; \" 1, \" &amp; Year(Date)), 0))\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"K\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(1, 2).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"L\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(1, 8).Value\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"M\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 1).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"O\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 2).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"Q\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 3).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"V\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 6).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AA\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 8).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AC\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Diesel\").Cells(5, 10).Resize(dys, 1).Value\n\n\n    Sheets(\"Tank Diesel\").Delete\n\n\nElseIf sh.Name Like \"Tank V-Power\" Then\n\n    If Sheets(\"Tank V-Power\").AutoFilterMode Then 'autofilter is 'on'\n        On Error Resume Next   'turn off error reporting\n        Sheets(\"Tank V-Power\").ShowAllData\n        On Error GoTo 0   'turn error reporting back on\n    End If\n\n\n\n    dys = Day(Application.EoMonth(DateValue(Sheets(\"Tank V-Power\").Cells(1, 5).Value &amp; \" 1, \" &amp; Year(Date)), 0))\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"K\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(1, 2).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"L\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(1, 8).Value\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"M\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 1).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"O\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 2).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"Q\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 3).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"V\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 6).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AA\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 8).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AC\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank V-Power\").Cells(5, 10).Resize(dys, 1).Value\n\n\n    Sheets(\"Tank V-Power\").Delete\n\n\n\nElseIf sh.Name Like \"Tank Super\" Then\n\n\n\n    If Sheets(\"Tank Super\").AutoFilterMode Then 'autofilter is 'on'\n        On Error Resume Next   'turn off error reporting\n        Sheets(\"Tank Super\").ShowAllData\n        On Error GoTo 0   'turn error reporting back on\n    End If\n\n\n\n    dys = Day(Application.EoMonth(DateValue(Sheets(\"Tank Super\").Cells(1, 5).Value &amp; \" 1, \" &amp; Year(Date)), 0))\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"K\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(1, 2).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"L\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(1, 8).Value\n\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"M\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 1).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"O\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 2).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"Q\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 3).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"V\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 6).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AA\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 8).Resize(dys, 1).Value\n    Sheets(\"Daily Comparison\").Cells(Rows.Count, \"AC\").End(xlUp).Offset(1, 0).Resize(dys, 1) = Sheets(\"Tank Super\").Cells(5, 10).Resize(dys, 1).Value\n\n    Sheets(\"Tank Super\").Delete\n\n\n\n\nElse\n\n    SheetExists = False\n\n\n\nEnd If\n\nNext sh\n\nSheets(\"Daily Comparison\").Select\nRange(\"A1\").Select\n\nWorksheets(\"Daily Comparison\").Protect \"superman\", AllowFiltering:=True\n\nwbCurrent.Save\n\nApplication.DisplayAlerts = False\n\nMsgBox \"Step 1: \" &amp; sInputTabName &amp; \" is imported succesfully!\", vbInformation + vbOKOnly\n\n\nEnd Sub\n</code></pre>\n\n<p>May I know how can I enhance this coding to be able to select multiple files and execute the loading?</p>\n"}, {"tags": ["vba", "button", "webpage"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420748975, "post_id": 27810946, "comment_id": 44101764, "body": "Yesterday your solution worked, today it&#39;s not working anymore. I just don&#39;t get it. The button is pressed, but the page remains the same. If I press the button with the mouse, then it works!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420776358, "post_id": 27810946, "comment_id": 44111234, "body": "I cannot really speak as to why the button is not processing the call but it appear to be clicking. Personally, I avoid the <code>&lt;button&gt;.Click</code> method in favor of something more like <code>IE.Document.getelementsbytagname(&quot;form&quot;)(0).submit</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1420600856, "creation_date": 1420600856, "answer_id": 27810946, "question_id": 27810771, "link": "https://stackoverflow.com/questions/27810771/cannot-press-button-with-vba/27810946#27810946", "title": "Cannot press button with VBA", "body": "<p>You do not need the <code>.GetAttribute</code> call. </p>\n\n<pre><code>For Each hyper_link In allhyperlinks\n      If hyper_link.Name = \"submitImportFile\" Then\n           hyper_link.Click\n           Exit For\n      End If\nNext hyper_link\n</code></pre>\n\n<p>That should be sufficient for checking the <code>.Name</code> of an element. Remember that VBA is by default case sensitive. Is there a reason you are not using the following?</p>\n\n<p><code>IE.Document.getElementById(\"submitImportFile\").Click\n</code></p>\n"}], "owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420880916, "creation_date": 1420599289, "last_edit_date": 1420880916, "question_id": 27810771, "link": "https://stackoverflow.com/questions/27810771/cannot-press-button-with-vba", "title": "Cannot press button with VBA", "body": "<p>I want to press a button on a webpage through VBA, using Internet Explorer.\nI do it for several webpages without problems, but I cannot do it for a particular one.</p>\n\n<p>The HTML code of the button is </p>\n\n<pre><code>&lt;button type=\"submit\" name=\"submitImportFile\" id=\"submitImportFile\" class=\"btn btn-default pull-right\" &gt;\n&lt;i class=\"process-icon-next\"&gt;&lt;/i&gt;\n&lt;span&gt;Pasul urm\u0103tor&lt;/span&gt;\n&lt;/button&gt;\n</code></pre>\n\n<p>How can I press it using VBA?</p>\n\n<p>I tried </p>\n\n<pre><code>Set allhyperlinks = IE.Document.getelementsbytagname(\"button\")\n        For Each hyper_link In allhyperlinks\n            If hyper_link.getattribute(\"name\") = \"submitImportFile\" Then\n                hyper_link.Click\n                Exit For\n            End If\n        Next\n</code></pre>\n\n<p>...and it's not working.\nThanks!</p>\n\n<p>I figured out that the code is wotking very well when run from a different computer.\nBut when I run it from my desktop, I get the error \"Object required\" at line</p>\n\n<pre><code>ie.Document.getElementById(\"import\").Click\n</code></pre>\n\n<p>Why could be wrong? I checked the VBA refferences, they are the same on both computers.</p>\n"}, {"tags": ["vba", "excel", "recursion", "directory"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1420599128, "post_id": 27810671, "comment_id": 44030204, "body": "Get rid of <code>On Error Resume Next</code> then you will likely see where your error lies"}, {"owner": {"reputation": 21, "user_id": 4426174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b223d19581cd9f430f6d157b24d51954?s=128&d=identicon&r=PG&f=1", "display_name": "CapnJack", "link": "https://stackoverflow.com/users/4426174/capnjack"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1420599839, "post_id": 27810671, "comment_id": 44030390, "body": "Thanks for the tip.  Removing that didn&#39;t help but I&#39;ve figured out the problem.  My key (i) was declared inside the function and therefore was being reset to &#39;1&#39; every time the function was called.  Thanks again"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4426174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b223d19581cd9f430f6d157b24d51954?s=128&d=identicon&r=PG&f=1", "display_name": "CapnJack", "link": "https://stackoverflow.com/users/4426174/capnjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1420669168, "creation_date": 1420669168, "answer_id": 27829668, "question_id": 27810671, "link": "https://stackoverflow.com/questions/27810671/vba-recursive-folder-function-is-missing-particular-subfolders/27829668#27829668", "title": "VBA Recursive folder function is missing particular subfolders", "body": "<p>My key (i) was declared inside the function and therefore was being reset to '1' every time the function was recursed.</p>\n\n<p>This resulted in non-unique keys and therefore some items were not being added to the collection.</p>\n\n<p>Thanks to everyone for their help.</p>\n"}], "owner": {"reputation": 21, "user_id": 4426174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b223d19581cd9f430f6d157b24d51954?s=128&d=identicon&r=PG&f=1", "display_name": "CapnJack", "link": "https://stackoverflow.com/users/4426174/capnjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1420669168, "creation_date": 1420598502, "last_edit_date": 1531164843, "question_id": 27810671, "link": "https://stackoverflow.com/questions/27810671/vba-recursive-folder-function-is-missing-particular-subfolders", "title": "VBA Recursive folder function is missing particular subfolders", "body": "<p>I'm trying to create a recursive function which adds each folder (and subfolders) to a collection of custom objects.  My code is working for around 75% of the folders / subfolders but seemingly random ones are being missed from the collection.</p>\n\n<p>Any ideas?</p>\n\n<p>FolderObj is a custom class, the collection I'm adding to is called ToPathList</p>\n\n<pre><code>Option Explicit\n\nSub RecurseFolderList(Foldername As String)\n    On Error Resume Next\n    Dim FSO, NextFolder\n    Dim OriginalRange As Range\n    Dim tempFolderObj As FolderObj\n    Dim i As Integer\n    i = 1\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Err.Number &gt; 0 Then\n    Exit Sub\n    End If\n\n    If FSO.FolderExists(Foldername) Then\n\n        Set NextFolder = FSO.GetFolder(Foldername)\n        Set FolderArray = NextFolder.subfolders\n\n        For Each NextFolder In FolderArray\n\n            Set tempFolderObj = New FolderObj\n\n            'assign variables to temporary object\n            With tempFolderObj\n                .ID = i\n                .Filename = NextFolder.Name\n                .path = NextFolder.path\n                .first3ints = first3Non0Ints(NextFolder.Name)\n            End With\n\n            'add temporary object to colelction\n            Call ToPathList.Add(tempFolderObj, CStr(i))\n\n            i = i + 1\n\n            RecurseFolderList (NextFolder)\n\n        Next\n\n'        Set NextFolder = Nothing\n'        Set FolderArray = Nothing\n\n    End If\n\n    Set FSO = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1420597964, "post_id": 27810534, "comment_id": 44029896, "body": "Why are you using <code>WorksheetFunction.Today()</code> in VBA rather than the simpler (and VBA native) <code>Date</code> ?"}, {"owner": {"reputation": 3, "user_id": 3992669, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e96a75c4d6120c16b2301f6a9428d42?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Keoh", "link": "https://stackoverflow.com/users/3992669/alex-keoh"}, "edited": false, "score": 0, "creation_date": 1420598080, "post_id": 27810534, "comment_id": 44029921, "body": "Because i want to display today&#39;s date in the records and this problem occur when i copy and paste the info from one sheet to other sheet"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1420598644, "post_id": 27810534, "comment_id": 44030061, "body": "When viewed tomorrow, should the date show the 6th or the 7th? IOW, should it update on a daily basis on the remote worksheet or be remain as the day it was copied? Can you show a few lines of code that provide the copy/paste operation to the remote worksheet?"}, {"owner": {"reputation": 3, "user_id": 3992669, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e96a75c4d6120c16b2301f6a9428d42?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Keoh", "link": "https://stackoverflow.com/users/3992669/alex-keoh"}, "edited": false, "score": 0, "creation_date": 1420601564, "post_id": 27810534, "comment_id": 44030762, "body": "actually i just paste the values only, not the operation :)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1420600554, "last_edit_date": 1420600554, "creation_date": 1420597821, "answer_id": 27810576, "question_id": 27810534, "link": "https://stackoverflow.com/questions/27810534/excel-vba-date-format-display-different-result-in-different-pc/27810576#27810576", "title": "Excel VBA date format display different result in different pc?", "body": "<p>That does not appear to be a regular date format by any international regional standard so you will have to format the cell (Ctrl+1) on the worksheet using a custom number format or with a subsequent VBA line like,</p>\n\n<pre><code>Range(\"A2:A10\").NumberFormat = \"yyyy/m/d h:mm\"\n</code></pre>\n\n<p>If you are already in VBA, the latter solution provides more versatility.</p>\n"}], "owner": {"reputation": 3, "user_id": 3992669, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e96a75c4d6120c16b2301f6a9428d42?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Keoh", "link": "https://stackoverflow.com/users/3992669/alex-keoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420600554, "creation_date": 1420597502, "last_edit_date": 1420600520, "question_id": 27810534, "link": "https://stackoverflow.com/questions/27810534/excel-vba-date-format-display-different-result-in-different-pc", "title": "Excel VBA date format display different result in different pc?", "body": "<p>I'm facing a problem here in Excel VBA.<br>\nI set <code>Today()</code> as values in the column and the result display is <strong>2015/1/6 0:00</strong> but in other computer, the result is <strong>42010</strong>.</p>\n\n<p>Guys, do you have any solution to avoid this problem to occur in a different pc?<br> This problem occur when I trying to copy and paste from one sheet to another sheet in other pc. I want the result <strong>2015/1/6 0:00</strong> to be display in all computers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1420600314, "post_id": 27810531, "comment_id": 44030497, "body": "<code>LSourceRow</code> is a string not a range so <code>LSourceRow.Row</code> will give out the qualifier error."}, {"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1420601627, "post_id": 27810531, "comment_id": 44030776, "body": "Oh. so i have to declare lsourcerow as a range? Is that how it works? Sorry i am new to VBA"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1420601814, "post_id": 27810531, "comment_id": 44030814, "body": "Ah no, since you are not actually passing a range object to it. Rather, you shouldn&#39;t use <code>.Row</code> since I believe the user already entered the row number right? And again, <code>.Row</code> is a Range object Property."}, {"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1420602403, "post_id": 27810531, "comment_id": 44031873, "body": "i hope it&#39;s not asking for too much but i tried it and it didnt work. Could you assist me with the codes?"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1420608027, "creation_date": 1420608027, "answer_id": 27812881, "question_id": 27810531, "link": "https://stackoverflow.com/questions/27810531/moving-row-based-on-input-value-in-inputbox/27812881#27812881", "title": "Moving row based on Input value in inputbox", "body": "<p>Not entirely sure what you want to achieve. But you can give this a try.</p>\n\n<pre><code>With ActiveSheet 'Replace to suit - e.g. Sheets(\"Sheet1\")\n    Dim lSourceRow As Long\n    Dim lDestRow As Long\n    Dim zMsg As String\n\n    lSourceRow = InputBox(\"Please Enter the row you want to move.\")\n    zMsg = \"Move Row \" &amp; Format(lSourceRow) &amp; \" to what Row?\" &amp; _\n          vbCrLf &amp; \"Enter 0 to Exit\"\n\n    lDestRow = InputBox(zMsg, \"Move Entire Row\", 0)\n\n    If lDestRow &lt;&gt; 0 And lSourceRow &lt;&gt; 0 Then\n        If lDestRow &lt;&gt; lSourceRow Then\n            .Rows(lSourceRow).Cut\n            .Rows(lDestRow + IIf(lDestRow = 1, 0, 1)).Insert xlDown\n        Else\n            MsgBox \"Source Row and Destination Row\" &amp; vbCrLf &amp; _\n                \"are the same -NO Action Taken-\", _\n                vbOKOnly + vbInformation, _\n                \"Invalid Row Move Request.\"\n        End If\n    End If\nEnd With\n</code></pre>\n\n<p>This is the simplest form. What you want done must include a lot of test on the input.<br>\nLike testing if it is not negative, not a string or decimal or if the user presses <strong>Cancel</strong> or <strong>Close</strong>.<br>\nThis is just something for you to start with. I leave the rest to you. <br>\nThis literally move the row to the previous location of the target row. HTH.</p>\n"}], "owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420608027, "creation_date": 1420597451, "last_edit_date": 1531161705, "question_id": 27810531, "link": "https://stackoverflow.com/questions/27810531/moving-row-based-on-input-value-in-inputbox", "title": "Moving row based on Input value in inputbox", "body": "<p>I need some assitance. What I'm trying to do is to move a row based on the user input in the inputbox. However I received an Invalid Qualifier error. Do help me, thanks! The error highlighted is <code>lSource</code> row.</p>\n\n<pre><code>Sub MoveRow()\n\n       Dim lDestRow   As Long\n       Dim lSourceRow As String\n       Dim zMsg       As String\n\n       lSourceRow = InputBox(\"Please Enter the row you want to move\")\n       zMsg = \"Move Row \" &amp; Format(lSourceRow.Row) &amp; \" to Row?\" &amp; _\n              vbCrLf &amp; \"Enter 0 to Exit\"\n\n       lDestRow = InputBox(zMsg, \"Move Entire Row\", 0)\n       If lDestRow &lt;&gt; 0 And lDestRow &lt;&gt; lSourceRow Then\n\n         ActiveCell.EntireRow.Select\n         Selection.Cut\n         Rows(lDestRow).Select\n         Selection.Insert Shift:=xlDown\n\n       Else\n\n         If lDestRow &lt;&gt; 0 Then\n\n           MsgBox \"Source Row and Destination Row\" &amp; vbCrLf &amp; _\n                  \"are the same -NO Action Taken-\", _\n                  vbOKOnly + vbInformation, _\n                  \"Invalid Row Move Request\"\n\n         End If\n\n       End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "shell"], "comments": [{"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 1, "creation_date": 1420597136, "post_id": 27810463, "comment_id": 44029697, "body": "I don&#39;t have all the details handy, so it&#39;s just a comment, but your code needs to make a registry change somewhere in hkey_classes_root."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420601540, "post_id": 27810463, "comment_id": 44030752, "body": "Joel is correct, but <i>why</i> would you want to do this? They&#39;re user settings for a reason. I would be pretty pissed if somebody&#39;s code was mucking around with my settings like that."}, {"owner": {"reputation": 795, "user_id": 4404399, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-oQ1pUmRbWy8/AAAAAAAAAAI/AAAAAAAAAAA/AiLol5KoHqU/photo.jpg?sz=128", "display_name": "Edward Bagby", "link": "https://stackoverflow.com/users/4404399/edward-bagby"}, "edited": false, "score": 0, "creation_date": 1420606677, "post_id": 27810463, "comment_id": 44032712, "body": "So I understand, do you want the python.py to open in notepad every time you open notepad, or do you want python.py to in notepad through another application, such as Excel, when you execute VBA from that application?"}, {"owner": {"reputation": 37, "user_id": 3441801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6428a352ba09da10da45ad8c975198?s=128&d=identicon&r=PG&f=1", "display_name": "user3441801", "link": "https://stackoverflow.com/users/3441801/user3441801"}, "edited": false, "score": 0, "creation_date": 1420615914, "post_id": 27810463, "comment_id": 44035578, "body": "thank you all for your comments...@Joel, thank you for your suggestion but i would prefer not to do it as I am making a tool for everyone to use..@RubberDuck, you are right..i think the same too...@Edward, I want python.py to open in notepad everytime one opens python.py...thanks plasma33"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1461706508, "creation_date": 1461706508, "answer_id": 36876203, "question_id": 27810463, "link": "https://stackoverflow.com/questions/27810463/how-to-open-a-file-and-make-it-default-in-vba/36876203#36876203", "title": "How to open a file and make it default in VBA", "body": "<p>You could try a VBA macro attached to a button that does this. But I am unsure if this is what you are asking for. </p>\n\n<pre><code>Sub LetterChecklist()    \n\nDim strPath As String\nDim strProgram As String\n\n    strPath = \"\\\\aw\\data\\Letters\\2099_Correspondence\\Incoming Letters\\.pdf\"\n    strProgram = \"C:\\Program Files (x86)\\Adobe\\Acrobat 11.0\\Acrobat\\Acrobat.exe\"\n\n    Call Shell(\"\"\"\" &amp; strProgram &amp; \"\"\" \"\"\" &amp; strPath &amp; \"\"\"\", vbNormalFocus)\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3441801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6428a352ba09da10da45ad8c975198?s=128&d=identicon&r=PG&f=1", "display_name": "user3441801", "link": "https://stackoverflow.com/users/3441801/user3441801"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1461706508, "creation_date": 1420597003, "last_edit_date": 1420601437, "question_id": 27810463, "link": "https://stackoverflow.com/questions/27810463/how-to-open-a-file-and-make-it-default-in-vba", "title": "How to open a file and make it default in VBA", "body": "<p>I am trying to make \"python.py\" to open in notepad each time...I have got the code that does that but how to make it as default..so next time if the user wants to open the python file in notepad, it should open in notepad all the time using VBA and only after the code is excecuted...please find the code below for opening a python file in notepad..</p>\n\n<pre><code>Shell \"notepad C:\\Users\\stackoverflow\\Desktop\\python.py\", vbNormalFocus\n</code></pre>\n"}, {"tags": ["xml", "vba", "encoding", "utf-8", "character-encoding"], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 4353173, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh6.googleusercontent.com/-AUFZrcnRe44/AAAAAAAAAAI/AAAAAAAAAB4/CbNxvTbLO2g/photo.jpg?sz=128", "display_name": "squall leonhart", "link": "https://stackoverflow.com/users/4353173/squall-leonhart"}, "edited": false, "score": 0, "creation_date": 1420605958, "post_id": 27810839, "comment_id": 44032529, "body": "Thanks for your answer. I&#39;ve tried your solution just now but it still didn&#39;t solve the problem. The unknown character still appear and now the output structure becomes more weird. Below is the output: <code>&lt; s t r i n g   n a m e = &quot; T h r e e D M o d e Q &quot; &gt; \ufffd V e r   e n   M o d o   3 D ? &lt; &#47; s t r i n g &gt;</code> Seems that the structure is way too weird isn&#39;t it?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 291, "user_id": 4353173, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh6.googleusercontent.com/-AUFZrcnRe44/AAAAAAAAAAI/AAAAAAAAAB4/CbNxvTbLO2g/photo.jpg?sz=128", "display_name": "squall leonhart", "link": "https://stackoverflow.com/users/4353173/squall-leonhart"}, "edited": false, "score": 0, "creation_date": 1420612996, "post_id": 27810839, "comment_id": 44034528, "body": "I would expect it to look like that from <code>CreateTextFile()</code> outputting UTF-16, if the input string from the <code>Cells()</code> was ill-formed to begin with. I would not expect it to look like that from <code>SaveToFile()</code> outputting UTF-8. Did you verify the initial file has the correct text before loading it into the <code>ADODB.Stream</code>? Did you validate the <code>ADODB.Stream</code> contains the correct text before calling <code>SaveToFile()</code>?"}, {"owner": {"reputation": 291, "user_id": 4353173, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh6.googleusercontent.com/-AUFZrcnRe44/AAAAAAAAAAI/AAAAAAAAAB4/CbNxvTbLO2g/photo.jpg?sz=128", "display_name": "squall leonhart", "link": "https://stackoverflow.com/users/4353173/squall-leonhart"}, "edited": false, "score": 0, "creation_date": 1420619718, "post_id": 27810839, "comment_id": 44036943, "body": "Yup. The .xml file before load into ADODB.Stream is in unicode encoded with all character are visible/shown normally. Just now I found a new way to solve my problem. Instead of &#39;convert to utf-8&#39; the encode, I use &#39;save as to utf-8&#39; approach. This is easier and my code becomes shorter since there is no need to use <code>FileSystemObject</code>. Just put my code from <code>i=11</code> until <code>Loop</code> in between <code>stream.Open</code> and <code>stream.Close</code>. But anyway, thanks again for your reply @Remy"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1420600803, "last_edit_date": 1420600803, "creation_date": 1420599952, "answer_id": 27810839, "question_id": 27810266, "link": "https://stackoverflow.com/questions/27810266/why-unknown-character-appear-in-xml-even-after-convert-from-ansi-to-utf-8/27810839#27810839", "title": "Why unknown character appear in XML even after convert from ANSI to UTF-8?", "body": "<p>The problem is that you are saving the initial file as ASCII (you are setting the <code>Unicode</code> parameter of <code>CreateTextFile()</code> to False).  Per the <a href=\"http://msdn.microsoft.com/en-us/library/aa265018.aspx\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>object.CreateTextFile(filename[, overwrite[<strong>, unicode</strong>]])</p>\n  \n  <p>The CreateTextFile method has these parts:</p>\n  \n  <p>Part Description</p>\n  \n  <p>object Required. Always the name of a FileSystemObject or Folder object.</p>\n  \n  <p>filename Required. String expression that identifies the file to create.</p>\n  \n  <p>overwrite Optional. Boolean value that indicates if an existing file can be overwritten. The value is True if the file can be overwritten; False if it can't be overwritten. If omitted, existing files are not overwritten.</p>\n  \n  <p><strong>unicode Optional. Boolean value that indicates whether the file is created as a Unicode or ASCII file. The value is True if the file is created as a Unicode file; False if it's created as an ASCII file. If omitted, an ASCII file is assumed.</strong></p>\n</blockquote>\n\n<p>You are then loading the ASCII file as UTF-8.  That is fine for ASCII characters (since ASCII is a subset of UTF-8), but you are losing non-ASCII characters, like <code>\u00f3</code> and <code>\u00bf</code>.  That is why you end up with <code>\ufffd</code> (Unicode codepoint <code>U+FFFD REPLACEMENT CHARACTER</code>) characters in your final file.</p>\n\n<p>You need to save the initial file as Unicode, and then load it into the <code>ADODB.Stream</code> as Unicode, then you won't lose any characters, and can then save the text in whatever charset you want afterwards:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set objF = objFso.CreateTextFile(xmlFile, True, True) ' Unicode parameter is True\n' ...\nSet stream = CreateObject(\"ADODB.Stream\")\nstream.Type = 2\nstream.Charset = \"utf-16\"\nstream.Open\nstream.LoadFromFile xmlFile ' load as Unicode\nstream.Charset = \"utf-8\"\nstream.SaveToFile xmlFile, 2 ' save as UTF-8\nstream.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 4353173, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh6.googleusercontent.com/-AUFZrcnRe44/AAAAAAAAAAI/AAAAAAAAAB4/CbNxvTbLO2g/photo.jpg?sz=128", "display_name": "squall leonhart", "link": "https://stackoverflow.com/users/4353173/squall-leonhart"}, "is_accepted": true, "score": 0, "last_activity_date": 1420684317, "last_edit_date": 1495542508, "creation_date": 1420684317, "answer_id": 27832060, "question_id": 27810266, "link": "https://stackoverflow.com/questions/27810266/why-unknown-character-appear-in-xml-even-after-convert-from-ansi-to-utf-8/27832060#27832060", "title": "Why unknown character appear in XML even after convert from ANSI to UTF-8?", "body": "<p>After make some research, finally I find the solution. I need to load my unicode file using <code>LoadFromFile</code> and make the stream to read the content using <code>stream.ReadText</code> and then close it first. And then I need to open back the stream, write back the content into <code>utf-8</code>using <code>stream.WriteText</code> and save it using <code>SaveToFile</code> and then close it permanently. Below is the code. Actually I get the reference from <a href=\"https://stackoverflow.com/questions/25243803/use-adodb-stream-to-convert-ansi-to-utf-8-miss-1-2-character-in-the-first-row\">Use &quot;ADODB.Stream&quot; to convert ANSI to UTF-8, miss 1-2 character in the first row</a>. </p>\n\n<pre><code>Set stream = CreateObject(\"ADODB.Stream\")\n            stream.Type = 2\n            stream.Charset = \"unicode\"\n            stream.Open\n            stream.LoadFromFile xmlFile\n            strText = stream.ReadText\n            stream.Close\n\n            stream.Type = 2\n            stream.Charset = \"utf-8\"\n            stream.Open\n            stream.WriteText strText\n            stream.SaveToFile xmlFile, 2\n            stream.Close\n            Set stream = Nothing\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 4353173, "user_type": "registered", "accept_rate": 19, "profile_image": "https://lh6.googleusercontent.com/-AUFZrcnRe44/AAAAAAAAAAI/AAAAAAAAAB4/CbNxvTbLO2g/photo.jpg?sz=128", "display_name": "squall leonhart", "link": "https://stackoverflow.com/users/4353173/squall-leonhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2552, "favorite_count": 0, "accepted_answer_id": 27832060, "answer_count": 2, "score": 0, "last_activity_date": 1584023092, "creation_date": 1420595508, "last_edit_date": 1584023092, "question_id": 27810266, "link": "https://stackoverflow.com/questions/27810266/why-unknown-character-appear-in-xml-even-after-convert-from-ansi-to-utf-8", "title": "Why unknown character appear in XML even after convert from ANSI to UTF-8?", "body": "<p>I have an issue here. Currently,  I made research on how to convert the encoded of .xml file from ANSI to UTF-8 and luckily and I found the solution. But there is one problem. My .xml file contain many Spanish language and of course, there is many inverted question mark symbol. In order for eclipse able to perfectly shown all the character in the .xml file, I need to change the encode of the .xml file from ANSI to UTF-8. I manage to change the encoded. But its weird. Even after change the encoded, the contain itself show the unknown character. Below is my code:</p>\n\n<pre><code>Dim objFso, objF As Object\nSet objFso = CreateObject(\"Scripting.FileSystemObject\")\nxmlFile = NewFolderName &amp; \"\\\" &amp; Application.Cells(5, j + 1).Value\n            Set objF = objFso.CreateTextFile(xmlFile, True, False)\n            objF.Write \"&lt;resources&gt;\"\n            objF.WriteBlankLines (1)\n            i = 11\n            Var = Application.Cells(8, j + 1).Value\n            Do Until Application.Cells(i, 2).Value = 0\n                    objF.Write \"     &lt;string name=\" &amp; Chr(34) &amp; Application.Cells(i, 2).Value &amp; Var &amp; Chr(34) &amp; \"&gt;\" &amp; Application.Cells(i, j + 1).Value &amp; \"&lt;/string&gt;\"\n                    objF.WriteBlankLines (1)\n                i = i + 1\n            Loop\n            objF.WriteBlankLines (1)\n            objF.Write (\"&lt;/resources&gt;\")\n            objF.Close\n            Set stream = CreateObject(\"ADODB.Stream\")\n            stream.Open\n            stream.Type = 2\n            stream.Charset = \"utf-8\"\n            stream.LoadFromFile xmlFile\n            stream.SaveToFile xmlFile, 2\n            stream.Close\n            Set stream = Nothing\n</code></pre>\n\n<p>The output from above code is as shown below:</p>\n\n<pre><code>&lt;string name=\"BroadcastFailed\"&gt;No se recibi\ufffd emisi\ufffdn [E202]&lt;/string&gt;\n&lt;string name=\"NoInputSelect\"&gt;No hay selecci\ufffdn de entrada disponible&lt;/string&gt;\n&lt;string name=\"ThreeDModeQ\"&gt;\ufffdVer en Modo 3D?&lt;/string&gt;\n</code></pre>\n\n<p>above .xml output is encoded in UTF-8 but unknown characters still appear. What I want is like this:</p>\n\n<pre><code>&lt;string name=\"BroadcastFailed\"&gt;No se recibi\u00f3 emisi\u00f3n [E202]&lt;/string&gt;\n&lt;string name=\"NoInputSelect\"&gt;No hay selecci\u00f3n de entrada disponible&lt;/string&gt;\n&lt;string name=\"ThreeDModeQ\"&gt;\u00bfVer en Modo 3D?&lt;/string&gt;\n</code></pre>\n\n<p>anyone who knows what is the error in my code, please drop down your answer. I really appreciate your answers :):)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1420592447, "post_id": 27809802, "comment_id": 44028607, "body": "If the selection is fully contained within your unioned ranges then the intersect and the selection will both have the same number of cells..."}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420594700, "post_id": 27809802, "comment_id": 44029097, "body": "@Sam Could you explain in a bit more detailed form why &quot;Performing this line several times for individual ranges isn&#39;t an option&quot;. Is it because you do not like typin much or is there a more technical reason?"}, {"owner": {"reputation": 128, "user_id": 4372296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebafe4459a78ce6ce33bcdd5005d4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Weston", "link": "https://stackoverflow.com/users/4372296/sam-weston"}, "edited": false, "score": 0, "creation_date": 1420594902, "post_id": 27809802, "comment_id": 44029151, "body": "That is a good point Tim."}, {"owner": {"reputation": 128, "user_id": 4372296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebafe4459a78ce6ce33bcdd5005d4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Weston", "link": "https://stackoverflow.com/users/4372296/sam-weston"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420594975, "post_id": 27809802, "comment_id": 44029169, "body": "@Gene No I just thought that performing the same if statement thirty times wasn&#39;t very elegant"}, {"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 1, "creation_date": 1420595430, "post_id": 27809802, "comment_id": 44029281, "body": "@Sam  I agree, it is not... But it seems you have to type the ranges in no matter what. You could type them (the addresses) into a comma-delimited string (string constant). Then set up a for loop with the Split(strRangeAddresses,&quot;,&quot;) array.... Anyways, it seems you are quite OK with the silentsurfer&#39;s solution., so this does not matter. Thanks for answering."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 4372296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebafe4459a78ce6ce33bcdd5005d4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Weston", "link": "https://stackoverflow.com/users/4372296/sam-weston"}, "edited": false, "score": 0, "creation_date": 1420594808, "post_id": 27809976, "comment_id": 44029122, "body": "This is <b>Perfect</b>. I was planning on using the second solution you&#39;ve posted but the user found that the first solution was much easier to understand."}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1420593217, "creation_date": 1420593217, "answer_id": 27809976, "question_id": 27809802, "link": "https://stackoverflow.com/questions/27809802/how-do-i-perform-an-intersect-of-a-selection-and-a-union-effectively/27809976#27809976", "title": "How do I perform an intersect of a selection and a union effectively?", "body": "<p>It depends on what you are trying to achieve. </p>\n\n<p>If in case of partial overlaps you want to fill only the intersected range of your selection, use:</p>\n\n<pre><code>Dim rngIntersect As Range \nSet rngIntersect = Intersect(Selection, Union(Range(\"B4:X23\"), Range(\"Z4:AH23\"), _\n                              Range(\"B25:X32\"), Range(\"Z25:AH32\"), Range(\"B34:X44\"), _\n                              Range(\"Z34:AH44\")))\n\nIf Not rngIntersect Is Nothing Then\n    rngIntersect.Interior.ColorIndex = modButtons.intColour \nEnd If\n</code></pre>\n\n<p>If you want to fill your selection only if it is completely intersected, use:</p>\n\n<pre><code>Dim rngIntersect As Range \nSet rngIntersect = Intersect(Selection, Union(Range(\"B4:X23\"), Range(\"Z4:AH23\"), _\n                              Range(\"B25:X32\"), Range(\"Z25:AH32\"), Range(\"B34:X44\"), _\n                              Range(\"Z34:AH44\")))\n\nIf Not rngIntersect Is Nothing And rngIntersect.Cells.Count = Selection.Cells.Count Then\n    Selection.Interior.ColorIndex = modButtons.intColour \nEnd If\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 4372296, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebafe4459a78ce6ce33bcdd5005d4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Weston", "link": "https://stackoverflow.com/users/4372296/sam-weston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 27809976, "answer_count": 1, "score": 0, "last_activity_date": 1420593217, "creation_date": 1420591869, "last_edit_date": 1420592143, "question_id": 27809802, "link": "https://stackoverflow.com/questions/27809802/how-do-i-perform-an-intersect-of-a-selection-and-a-union-effectively", "title": "How do I perform an intersect of a selection and a union effectively?", "body": "<p>I am writing a code that will fill the users selection with a colour so long as that selection is completely incompassed within a union of ranges.</p>\n\n<pre><code>If Not Application.Intersect(Selection, Union(Range(\"B4:X23\"), Range(\"Z4:AH23\"), _\n                              Range(\"B25:X32\"), Range(\"Z25:AH32\"),Range(\"B34:X44\"),  _\n                              Range(\"Z34:AH44\"))) Is Nothing Then   \n    Selection.Interior.ColorIndex = modButtons.intColour   \nEnd If\n</code></pre>\n\n<p>Performing this line several times for individual ranges isn't an option because There is 30 range sets in my actual code.</p>\n\n<p>So the issue is that while it won't fill in cells in the selection when the active cell is outside the ranges, it will fill cells in the selection that are outside the ranges if the active cell is inside the range.</p>\n"}, {"tags": ["vba", "save"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4406628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a793e1d577a85f7616e07531e8393016?s=128&d=identicon&r=PG&f=1", "display_name": "QProgram", "link": "https://stackoverflow.com/users/4406628/qprogram"}, "edited": false, "score": 0, "creation_date": 1420590989, "post_id": 27809642, "comment_id": 44028265, "body": "Thanks, Exactly what I needed"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1420590720, "creation_date": 1420590720, "answer_id": 27809642, "question_id": 27809538, "link": "https://stackoverflow.com/questions/27809538/vba-this-command-is-not-available-because-no-document-is-open/27809642#27809642", "title": "VBA &quot;This Command is not Available because no document is open&quot;", "body": "<pre><code>CreateObject(\"Word.Application\").ActiveDocument.SaveAs2 Filename:=\"joseph.docx\" 'etc\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>wdoc.SaveAs2 Filename:=\"joseph.docx\" 'etc\n</code></pre>\n\n<p>When you call <code>CreateObject</code> the second time you're creating a whole new instance of Word (and that second instance doesn't have any document open in it). .</p>\n"}], "owner": {"reputation": 51, "user_id": 4406628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a793e1d577a85f7616e07531e8393016?s=128&d=identicon&r=PG&f=1", "display_name": "QProgram", "link": "https://stackoverflow.com/users/4406628/qprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3355, "favorite_count": 0, "accepted_answer_id": 27809642, "answer_count": 1, "score": 3, "last_activity_date": 1420590720, "creation_date": 1420589968, "question_id": 27809538, "link": "https://stackoverflow.com/questions/27809538/vba-this-command-is-not-available-because-no-document-is-open", "title": "VBA &quot;This Command is not Available because no document is open&quot;", "body": "<p>Being new to the VBA language, I have researched this simple task for hours and I am having nothing work.  I am getting the error back  \"This Command is not Available because no document is open\", and there is a word document with writing coming right up.  What is going on here?  Thanks for your help.</p>\n\n<pre><code>Sub excel_to_word()\nDim wapp As Word.Application\nDim wdoc As Word.Document\n\nSet wapp = CreateObject(\"word.application\")\nwapp.Visible = True\n\n\nSet wdoc = wapp.Documents.Add\n\nwdoc.Content.InsertAfter Range(\"B5\")\n\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\n\n\n'CreateObject(\"Word.Application\").ChangeFileOpenDirectory \"C:\\USERS\\JOSEPH\\DESKTOP\\\"\n Dim NEWPATH As String\n NEWPATH = \"C:\\USERS\\JOSEPH\\DESKTOP\"\n\n\n   CreateObject(\"Word.Application\").ActiveDocument.SaveAs2 Filename:=\"joseph.docx\",       FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", addtorecentfiles:=False, savenativepictureformat:=False, SaveFormsData:=False, saveasaoceletter:=False, CompatibilityMode:=14\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 23, "user_id": 4364792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75090824c862e730c2dd1d2058dbd7a0?s=128&d=identicon&r=PG&f=1", "display_name": "smcollins", "link": "https://stackoverflow.com/users/4364792/smcollins"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420590772, "post_id": 27809466, "comment_id": 44028201, "body": "I would use this to ensure that groups of related items (in this case, electrical transformers) maintain consistent labeling across several parameters."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420591051, "post_id": 27809466, "comment_id": 44028282, "body": "You can use a <code>Worksheet_Change</code> event for this."}, {"owner": {"reputation": 23, "user_id": 4364792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75090824c862e730c2dd1d2058dbd7a0?s=128&d=identicon&r=PG&f=1", "display_name": "smcollins", "link": "https://stackoverflow.com/users/4364792/smcollins"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1420592907, "post_id": 27809466, "comment_id": 44028695, "body": "Thanks @TimWilliams &amp; @pnuts, <code>Worksheet_Change</code> was what I needed to make it all happen &quot;behind the scenes&quot; and the named range is what I think I&#39;ll need to define the set of cells in the worksheet and not to VBA script, which will allow the order of the cells to change."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4364792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75090824c862e730c2dd1d2058dbd7a0?s=128&d=identicon&r=PG&f=1", "display_name": "smcollins", "link": "https://stackoverflow.com/users/4364792/smcollins"}, "edited": false, "score": 3, "creation_date": 1420592969, "post_id": 27809739, "comment_id": 44028707, "body": "Thanks @silentsurfer! That works perfectly - I&#39;m going to try right now to tweak it a little bit for my needs.  I&#39;ve lurked on stackoverflow for a while but this was my first time asking a question -- I&#39;m thrilled at how helpful everyone has been. Now that I&#39;ve got an account, I&#39;ll try to answer some questions and pay it forward!"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1420596873, "post_id": 27809739, "comment_id": 44029628, "body": "Nice answer. FYI, you can slim your <code>For&#47;Next</code> down to one line, I believe: <code>chngRange.Value = Target.Value</code>."}, {"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1420622807, "post_id": 27809739, "comment_id": 44038517, "body": "@DougGlancy you are mostly right. However, in some border cases you might get unexpected results, e.g. when pressing Delete while selecting multiple cells within the Target range"}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1420591372, "creation_date": 1420591372, "answer_id": 27809739, "question_id": 27809466, "link": "https://stackoverflow.com/questions/27809466/mirrored-cells-intentional-circular-referencing/27809739#27809739", "title": "Mirrored Cells: Intentional Circular Referencing", "body": "<p>Try pasting this to your worksheet code page in the VBA editor:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim chngRange As Range\n    Dim xlCell As Range\n\n    Set chngRange = Range(\"A1:A3\")\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, chngRange) Is Nothing Then\n        For Each xlCell In chngRange\n            xlCell.Value = Target.Value\n        Next xlCell\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4364792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75090824c862e730c2dd1d2058dbd7a0?s=128&d=identicon&r=PG&f=1", "display_name": "smcollins", "link": "https://stackoverflow.com/users/4364792/smcollins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 27809739, "answer_count": 1, "score": 2, "last_activity_date": 1420595419, "creation_date": 1420589520, "last_edit_date": 1420595419, "question_id": 27809466, "link": "https://stackoverflow.com/questions/27809466/mirrored-cells-intentional-circular-referencing", "title": "Mirrored Cells: Intentional Circular Referencing", "body": "<p>I want to build a sheet that has \"Mirrored Cells\" i.e. I want several cells to display the same value and for that value to change in <em>all</em> cells if it changes in <em>any</em> cell.</p>\n\n<p>For example:</p>\n\n<pre><code>Cell A1: \"Apple\"\nCell A2: \"Apple\"\nCell A3: \"Apple\"\n</code></pre>\n\n<p>If I change A3 to \"Banana\" I want my sheet to display \"Banana\" in Cells A1, A2 and A3. I know that if I set A1 = A3 and A2 = A3 I can accomplish this. However, I want to also have the ability to, say, change A1 to \"Carrot\" and have all three cells display \"Carrot\". I don't know how to force excel to take the circular reference for the set of three cells, where the value can be changed by addressing any cell.</p>\n\n<p>P.S. - What I described is how I would like the behavior to \"appear\" to someone who's simply trying to update the sheet. If anyone has ideas for writing a VBA script that can automatically process this update (i.e. can be called automatically and behind the scenes each time a cell value is changed), I am happy to write one up and use it, programming the cells that belong in each circularly referenced set directly into the script.</p>\n\n<p>Edit: I implemented the script provided by @silentsurfer and it worked well on a simple worsheet with values in A1:A3. I then implemented the named range feature that @pnuts suggested.</p>\n\n<p>In my worksheet, I selected three cells (C3, C5, C7) and set them as the named range (\"config3P\"). I simply want @silentsurfer's script to monitor these three cells instead of A1:A3, so this is the changed code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim c3P As Range\nDim xlCell As Range\n\nSet c3P = Range(\"config3P\")\nApplication.EnableEvents = False\n\nIf Not Intersect(Target, c3P) Is Nothing Then\n    For Each xlCell In c3P\n        xlCell.Value = Target.Value\n    Next xlCell\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 0, "creation_date": 1420589279, "post_id": 27809220, "comment_id": 44027809, "body": "Why do you have single quotation marks around the less than sign?"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4421796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kd-NInRwM40/AAAAAAAAAAI/AAAAAAAAAIc/O7pO393gPlI/photo.jpg?sz=128", "display_name": "RByrns", "link": "https://stackoverflow.com/users/4421796/rbyrns"}, "is_accepted": false, "score": 0, "last_activity_date": 1420589788, "creation_date": 1420589788, "answer_id": 27809507, "question_id": 27809220, "link": "https://stackoverflow.com/questions/27809220/excel-macro-is-only-copying-false-value-of-a-logic-statement/27809507#27809507", "title": "Excel Macro is only copying &quot;false&quot; value of a logic statement", "body": "<p>You might try Worksheet.Activate after you select different sheets.  Worksheet.Calculate might be in order as well.  </p>\n\n<p>I think that using Range...  implies  Activesheet.Range.    Hope it helps </p>\n"}], "owner": {"reputation": 11, "user_id": 4425833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752c0460b765f88713d705baa09007e8?s=128&d=identicon&r=PG&f=1", "display_name": "zoro1krr", "link": "https://stackoverflow.com/users/4425833/zoro1krr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421694219, "creation_date": 1420587924, "last_edit_date": 1421694219, "question_id": 27809220, "link": "https://stackoverflow.com/questions/27809220/excel-macro-is-only-copying-false-value-of-a-logic-statement", "title": "Excel Macro is only copying &quot;false&quot; value of a logic statement", "body": "<p>I used the Macro Recorder to create a macro to copy files from one worksheet to a second worksheet and reset a form to default values. </p>\n\n<p>When the macro is run the \"false\" value (\"NO\") of a logic statement is copied regardless of the value in the cell at the time the macro is run. If I change the value in the false statement from \"NO\" to any other value (i.e. \"Blue\") it copies over the new value (\"Blue\").</p>\n\n<p>Here is the formula for the logic statement:</p>\n\n<pre><code>=IF(AND(D15&gt;VLOOKUP(C13,CCT,3,FALSE),D15&lt;VLOOKUP(C13,CCT,4,TRUE)),\"YES\",\"NO\") \n</code></pre>\n\n<p>where <code>CCT</code> is a list.</p>\n\n<p>Here is the code for the macro:</p>\n\n<pre><code>Range(\"D17\").Select\nSelection.Copy\nSheets(\"Worksheet2\").Select\nRange(\"G3\").Select\nActiveSheet.Paste\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Worksheet1\").Select\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "report"], "comments": [{"owner": {"reputation": 5253, "user_id": 308375, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ae4b12742a37c68cf7a58583c7146ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/308375/matt"}, "edited": false, "score": 2, "creation_date": 1420588040, "post_id": 27809051, "comment_id": 44027431, "body": "Welcome to SO, please take a moment to post a little more about what you have tried so far, your input data, and what your desired output is"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4417424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503b20a1f11d3efc301dc58567fd9775?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz", "link": "https://stackoverflow.com/users/4417424/wiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1420626156, "creation_date": 1420626156, "answer_id": 27817214, "question_id": 27809051, "link": "https://stackoverflow.com/questions/27809051/automating-access-queries-and-report-generation/27817214#27817214", "title": "Automating Access Queries and Report Generation", "body": "<ul>\n<li>Create a report for the single employee.</li>\n<li>Select the specific printer you want in the report (Page Setup). I set AdobePDF to print in pdf. </li>\n<li>Save the report.  </li>\n<li>When you open the report for a given employee you have apply a filter to see only the selected one.</li>\n<li><p>Set the report caption with employee name, id, etc. It will be used as filename when saving in pdf</p>\n\n<p>DoCmd.SetWarnings False                         <em>' Disable warnings</em><br>\nDoCmd.OpenReport <strong><em>YourReportName</em></strong>, acViewDesign, , <strong><em>YourFilterCondition</em></strong>    <em>' Open report</em>\nReports!rptQuotDetails.Report.Caption = <strong><em>YourEmployeeNameAndID</em></strong><br>\nDoCmd.PrintOut acPrintAll                       <em>' print report</em><br>\nDoCmd.Close acReport, <strong><em>YourReportName</em></strong>, acSaveNo            <em>' Close report w/o saving</em>\nDoCmd.SetWarnings True  Close                       <em>' Re-enable warnings</em></p></li>\n</ul>\n\n<p>You can use this snippet as the code for _Click event of a button.</p>\n\n<p>Alternatively you can use the employee ID or its name o whatever within report code to set the caption (Me.caption = ...).</p>\n"}], "owner": {"reputation": 61, "user_id": 4425827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/721f7b1ca6e7df8d865b33271ec03d4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vibhor Kalra", "link": "https://stackoverflow.com/users/4425827/vibhor-kalra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1420626156, "creation_date": 1420586809, "question_id": 27809051, "link": "https://stackoverflow.com/questions/27809051/automating-access-queries-and-report-generation", "title": "Automating Access Queries and Report Generation", "body": "<p>I have an access database which consists of employee records. I am trying to generate a report for each record separately (as a PDF with the file name as the Employee Name). In addition to this I have a query that needs to be run per record to generate some external metrics. Kindly advise me on how to proceed as I currently unable to produce anything significant.\nThanks in advance,\nVibhor</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420586638, "post_id": 27808957, "comment_id": 44026950, "body": "<a href=\"http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/A_11770-HOW-TO-Manipulating-Office-Ribbon-Bar-only-with-VBA.html\" rel=\"nofollow noreferrer\">experts-exchange.com/Software/Office_Productivity/Office_Sui&zwnj;&#8203;tes/&hellip;</a>"}, {"owner": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420586913, "post_id": 27808957, "comment_id": 44027059, "body": "Interesting way to add to the ribbon. That helps me with #1. Thanks! Any idea on #2?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420587990, "post_id": 27808957, "comment_id": 44027407, "body": "Please, see my answer ;)"}], "answers": [{"comments": [{"owner": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "edited": false, "score": 1, "creation_date": 1420639095, "post_id": 27809225, "comment_id": 44047747, "body": "I think this works for Excel and Word but not Outlook. It adds the button but clicking it does not run that sub."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "edited": false, "score": 0, "creation_date": 1421046331, "post_id": 27809225, "comment_id": 44194109, "body": "@IMTheNachoMan, i never tested it. I believe you&#39;re right."}, {"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "reply_to_user": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "edited": false, "score": 0, "creation_date": 1436958444, "post_id": 27809225, "comment_id": 50827859, "body": "@IMTheNachoMan did you find a solution to get a callback when the button is clicked?"}, {"owner": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "reply_to_user": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1460994963, "post_id": 27809225, "comment_id": 60985564, "body": "@ZerOne: Not yet. :("}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1420588360, "last_edit_date": 1420588360, "creation_date": 1420587975, "answer_id": 27809225, "question_id": 27808957, "link": "https://stackoverflow.com/questions/27808957/how-to-add-to-outook-2013s-ribbon-and-or-get-a-ribbon-buttons-name-using-vba/27809225#27809225", "title": "How to add to Outook 2013&#39;s ribbon and/or get a ribbon button&#39;s name using VBA?", "body": "<p>I think i found it!</p>\n\n<p>For #1 see this: <a href=\"http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/A_11770-HOW-TO-Manipulating-Office-Ribbon-Bar-only-with-VBA.html\" rel=\"nofollow\">\nHOW TO: Manipulating Office Ribbon Bar only with VBA</a>.</p>\n\n<p>For #2 you need to add <strong>onAction</strong> subroutine in ribbon definition XML file. </p>\n\n<pre><code>&lt;mso:button id=\"MyButtonIdentifier1\" label=\"MyMacroLabel\" imageMso=\"HyperlinksVerify\" onAction=\"NameOfMyMacro\" visible=\"true\"/&gt;\n</code></pre>\n\n<p>The definition of <strong>NameOfMyMacro</strong> should looks like:</p>\n\n<pre><code>Sub NameOfMyMacro(control As IRibbonControl)\n    'here your logic\n    Select Case control.Id\n        Case \"MyButtonIdentifier1\"\n           'call another subroutine ;)\n        Case \"MyButtonIdentifier2\"\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 3, "last_activity_date": 1420720711, "creation_date": 1420720711, "answer_id": 27840334, "question_id": 27808957, "link": "https://stackoverflow.com/questions/27808957/how-to-add-to-outook-2013s-ribbon-and-or-get-a-ribbon-buttons-name-using-vba/27840334#27840334", "title": "How to add to Outook 2013&#39;s ribbon and/or get a ribbon button&#39;s name using VBA?", "body": "<p>The only possible way is to develop an add-in. Outlook doesn't allow to customize the UI using VBA.</p>\n\n<p>You may find the <a href=\"http://msdn.microsoft.com/en-us/library/bb386104.aspx\" rel=\"nofollow\">Walkthrough: Creating a Custom Tab by Using the Ribbon Designer</a> page helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 8157003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67199ea5de7f3e9070ce8d9037f786f6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Bauer", "link": "https://stackoverflow.com/users/8157003/stefan-bauer"}, "is_accepted": false, "score": 0, "last_activity_date": 1523097757, "creation_date": 1523097757, "answer_id": 49706510, "question_id": 27808957, "link": "https://stackoverflow.com/questions/27808957/how-to-add-to-outook-2013s-ribbon-and-or-get-a-ribbon-buttons-name-using-vba/49706510#49706510", "title": "How to add to Outook 2013&#39;s ribbon and/or get a ribbon button&#39;s name using VBA?", "body": "<p>There is a way to add a custom ribbon into Outlook 2013 with the help of ADODB.Stream</p>\n\n<p>I'm working with this solution at work since some years - but I was not able to apply it also at home.</p>\n\n<p>First of all I'm preparing a text file that has the XML-strukture in it:</p>\n\n<pre><code>Dim Stream As Object\nDim FSO As FileSystemObject\nDim tsZwischenspeicher As TextStream\n\nSet Stream = CreateObject(\"ADODB.Stream\")\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nstrPfad = \"C:\\Users\\\" &amp; (Environ(\"username\")) &amp; \"\\AppData\\Local\\Microsoft\\Office\\\"\nstrSpeicherpfad = strPfad &amp; \"olkexplorer.officeUI\"\nstrTempSpeicherpfad = strPfad &amp; \"olkexplorer.temp\"\n</code></pre>\n\n<p>...</p>\n\n<pre><code>tsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;mso:customUI xmlns:x1='http://schemas.microsoft.com/office/2009/07/customui/macro' xmlns:mso='http://schemas.microsoft.com/office/2009/07/customui'&gt;\")\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;mso:ribbon&gt;\") &amp; vbCrLf\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;mso:qat&gt;\")\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;mso:sharedControls&gt;\")\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;mso:control idQ='mso:FilePrint' visible='false'/&gt;\")\n</code></pre>\n\n<p>Then the generated XML-File could be transfered into Outlook via ADODB.Stream:</p>\n\n<pre><code>'Eine neue Fu\u00dfzeile erstellen\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;/mso:tabs&gt;\")\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;/mso:ribbon&gt;\")\ntsZwischenspeicher.WriteLine Anf\u00fchrungszeichen(\"&lt;/mso:customUI&gt;\")\n\n'Zwischengespeicherte Datei schlie\u00dfen\ntsZwischenspeicher.Close\n\nStream.Open\nStream.Type = 2 'text\nStream.Charset = \"utf-8\"\nStream.LoadFromFile strTempSpeicherpfad\nFSO.OpenTextFile(strSpeicherpfad, 2, True, True).Write Stream.ReadText\nStream.Close\n</code></pre>\n\n<p>Outlook has to be restarted and the new Ribbon will be displayed.</p>\n"}, {"tags": [], "owner": {"reputation": 525, "user_id": 1635670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/158f329295d4e01d527802628153fa4e?s=128&d=identicon&r=PG", "display_name": "jumpjack", "link": "https://stackoverflow.com/users/1635670/jumpjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1561120593, "creation_date": 1561120593, "answer_id": 56703613, "question_id": 27808957, "link": "https://stackoverflow.com/questions/27808957/how-to-add-to-outook-2013s-ribbon-and-or-get-a-ribbon-buttons-name-using-vba/56703613#56703613", "title": "How to add to Outook 2013&#39;s ribbon and/or get a ribbon button&#39;s name using VBA?", "body": "<p>Working in Outlook 2010, 14.0.7232.5000:</p>\n\n<p>In ThisOutlookSession:</p>\n\n<pre><code>Private WithEvents Button As Office.CommandBarButton\n\nPrivate Sub Application_Startup()\n  Dim oExplorer As Outlook.Explorer\n  Set oExplorer = Application.ActiveExplorer\n  ' Dynamically create button at  Outlook startup (no need for XML file)\n  Set Button = CreateCommandBarButton(oExplorer.CommandBars)\nend sub\n\n\n\nPrivate Sub Button_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)\n  ' Code to be executed upon clicking the button.\n  ' The name of the function MUST be \"buttonname_Click\", with \"buttonname\" \n  ' defined in Application_Startup().\n  MsgBox \"Click: \" &amp; Ctrl.Caption\nEnd Sub\n\n\n\nPrivate Function CreateCommandBarButton(oBars As Office.CommandBars) As Office.CommandBarButton\n  On Error Resume Next\n  Dim oMenu As Office.CommandBar\n  Dim oBtn As Office.CommandBarButton\n  Const BAR_NAME As String = \"YourCommandBarName\"\n  Const CMD_NAME As String = \"YourButtonName\"\n\n  Set oMenu = oBars(BAR_NAME)\n  If oMenu Is Nothing Then\n    Set oMenu = oBars.Add(BAR_NAME, msoBarTop, , True)\n    Set oBtn = oMenu.Controls.Add(msoControlButton, , CMD_NAME, , True)\n    oBtn.Caption = CMD_NAME\n    oBtn.Tag = CMD_NAME\n\n  Else\n    Set oBtn = oMenu.FindControl(, , CMD_NAME)\n    If oBtn Is Nothing Then\n      Set oBtn = oMenu.Controls.Add(msoControlButton, , CMD_NAME, , True)\n    End If\n  End If\n\n  oMenu.Visible = True\n  Set CreateCommandBarButton = oBtn\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3650, "favorite_count": 1, "accepted_answer_id": 27840334, "answer_count": 4, "score": 2, "last_activity_date": 1592871779, "creation_date": 1420586383, "last_edit_date": 1592871779, "question_id": 27808957, "link": "https://stackoverflow.com/questions/27808957/how-to-add-to-outook-2013s-ribbon-and-or-get-a-ribbon-buttons-name-using-vba", "title": "How to add to Outook 2013&#39;s ribbon and/or get a ribbon button&#39;s name using VBA?", "body": "<p>I need to do two things:</p>\n\n<ol>\n<li><p>Add buttons to a custom group on the \"Home\" tab of the Outlook 2013 ribbon using Outlook 2013 VBA.</p>\n\n<ul>\n<li>Everything I found online refers to Excel or Word.</li>\n</ul></li>\n<li><p>Within the macro that runs when each button is clicked I want to be able to tell the name of the button that was clicked.</p>\n\n<ul>\n<li>I want to have a variable number of buttons like \"Do 1\", \"Do 2\", \"Do 3\", ..., \"Do X\" and each of them would run the same macro/sub and within the macro/sub I can see the name of the button so I know what to do. Otherwise I'd have to create a sub/macro for each button and I'm trying to avoid that.</li>\n</ul></li>\n</ol>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 2, "creation_date": 1420581268, "post_id": 27807802, "comment_id": 44024717, "body": "<code>Trim</code> does remove both leading and trailing spaces. Are you sure that&#39;s a space? Try to <code>Print Asc(Txt)</code> to see if the ascii code is really 32"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1420581335, "post_id": 27807802, "comment_id": 44024751, "body": "Either your data does not contain a space (character code 32) at the start of the string, or your are implementing your code incorrectly.  The VBA Trim function is well described in VBA Help for that function.  It is somewhat different from the Worksheet function with the same name."}], "answers": [{"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420582075, "post_id": 27807945, "comment_id": 44025047, "body": "Comp2Strings = (InStr(str1, str2) &lt;&gt; 0 Or InStr(str2, str1) &lt;&gt; 0)"}, {"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 0, "creation_date": 1420582183, "post_id": 27807945, "comment_id": 44025089, "body": "This would fail with <code>str1 = &quot; test&quot;</code> and <code>str1 = &quot;test &quot;</code>"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1420582527, "post_id": 27807945, "comment_id": 44025276, "body": "Based on the OP, only one of the strings will have leading or trailing space. So this would work"}, {"owner": {"reputation": 147, "user_id": 3059069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31b6c264478dc38f8c5bfd8d0fec7575?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/3059069/jmichael"}, "edited": false, "score": 0, "creation_date": 1420584911, "post_id": 27807945, "comment_id": 44026309, "body": "This would tell me if there were leading spaces (or white space characters depending on str2)m but I&#39;m needing to clean off the shite space for later storage (sorry didn&#39;t reference that in original post, wasn&#39;t thinking about it as my problem was a InStr returning 0 when, to my brain, it should return a value &gt;0)"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1420581613, "creation_date": 1420581613, "answer_id": 27807945, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/27807945#27807945", "title": "VBA Trim leaving leading white space", "body": "<p>Why don't you try using the Instr function instead? Something like this</p>\n\n<pre><code>Function Comp2Strings(str1 As String, str2 As String) As Boolean\n    If InStr(str1, str2) &lt;&gt; 0 Or InStr(str2, str1) &lt;&gt; 0 Then\n        Comp2Strings = True\n    Else\n        Comp2Strings = False\n    End If\nEnd Function\n</code></pre>\n\n<p>Basically you are checking if string1 contains string2 or string2 contains string1. This will always work, and you dont have to trim the data.</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 3059069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31b6c264478dc38f8c5bfd8d0fec7575?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/3059069/jmichael"}, "edited": false, "score": 0, "creation_date": 1420584158, "post_id": 27808208, "comment_id": 44025998, "body": "Turns out this is the case. I used Code(left({cell}m 1)) to get the character (160 for those who were curious). Given that I went ahead and created a function to clear the leading white space (any code value less than 32, 160, and a handful of others)."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1420582770, "creation_date": 1420582770, "answer_id": 27808208, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/27808208#27808208", "title": "VBA Trim leaving leading white space", "body": "<p><strong>TRIM()</strong> will remove all leading <em>spaces</em></p>\n\n<pre><code>Sub demo()\n    Dim s As String\n    s = \"   test   \"\n    s2 = Trim(s)\n    msg = \"\"\n    For i = 1 To Len(s2)\n        msg = msg &amp; i &amp; vbTab &amp; Mid(s2, i, 1) &amp; vbCrLf\n    Next i\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p>It is possible your data has characters that are not visible, but are not spaces either.</p>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1420583152, "creation_date": 1420583152, "answer_id": 27808295, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/27808295#27808295", "title": "VBA Trim leaving leading white space", "body": "<p>Without seeing your code it is hard to know, but you could also use the <code>Application.WorksheetFunction.Clean()</code> method in conjunction with the <code>Trim()</code> method which removes non-printable characters.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.worksheetfunction.clean%28v=office.14%29.aspx\" rel=\"nofollow\">MSDN Reference page for WorksheetFunction.Clean()</a></p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 3059069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31b6c264478dc38f8c5bfd8d0fec7575?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/3059069/jmichael"}, "edited": false, "score": 0, "creation_date": 1420585019, "post_id": 27808526, "comment_id": 44026353, "body": "To my knowledge this should work. I&#39;ve just never been a fan of regex, too easy to screw it up with how dense the code is."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1420597790, "post_id": 27808526, "comment_id": 44029852, "body": "This will not work with the OP&#39;s problem.  <code>\\s</code> does NOT match the NBSP (character code 160) in vbscript.  You could use a regex like <code>[\\s\\xA0]</code> though, with the appropriate beginning and end of line anchors, and multiline set to true."}], "tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": false, "score": 0, "last_activity_date": 1420586182, "last_edit_date": 1420586182, "creation_date": 1420584172, "answer_id": 27808526, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/27808526#27808526", "title": "VBA Trim leaving leading white space", "body": "<p>VBA's Trim function is limited to dealing with spaces. It will remove spaces at the start and end of your string.</p>\n\n<p>In order to deal with things like newlines and tabs, I've always imported the Microsoft VBScript RegEx library and used it to replace whitespace characters.</p>\n\n<p>In your VBA window, go to Tools, References, the find Microsoft VBScript Regular Expressions 5.5. Check it and hit OK.</p>\n\n<p>Then you can create a fairly simple function to trim all white space, not just spaces.</p>\n\n<pre><code>Private Function TrimEx(stringToClean As String)\n    Dim re As New RegExp\n    ' Matches any whitespace at start of string\n    re.Pattern = \"^\\s*\"\n    stringToClean = re.Replace(stringToClean, \"\")\n    ' Matches any whitespace at end of string\n    re.Pattern = \"\\s*$\"\n    stringToClean = re.Replace(stringToClean, \"\")\n    TrimEx = stringToClean\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1420584988, "post_id": 27808627, "comment_id": 44026339, "body": "If you are going to trim the data, I would go with a Regular Expression solution, it is more general and robust"}, {"owner": {"reputation": 679, "user_id": 5198805, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Ir61o.png?s=128&g=1", "display_name": "Ryu S.", "link": "https://stackoverflow.com/users/5198805/ryu-s"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1543779874, "post_id": 27808627, "comment_id": 94031353, "body": "@Jeanno the regex solution below didn&#39;t catch all the characters, this solution did."}], "tags": [], "owner": {"reputation": 147, "user_id": 3059069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31b6c264478dc38f8c5bfd8d0fec7575?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/3059069/jmichael"}, "is_accepted": false, "score": 3, "last_activity_date": 1420584544, "creation_date": 1420584544, "answer_id": 27808627, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/27808627#27808627", "title": "VBA Trim leaving leading white space", "body": "<p>So as Gary's Student aluded to, the character wasn't 32. It was in fact 160. Now me being the simple man I am, white space is white space. So in line with that view I created the following function that will remove ALL Unicode characters that don't actual display to the human eye (i.e. non-special character, non-alphanumeric). That function is below:</p>\n\n<pre><code>Function TrueTrim(v As String) As String\nDim out As String\nDim bad As String\nbad = \"||127||129||141||143||144||160||173||\" 'Characters that don't output something\n       'the human eye can see based on http://www.gtwiki.org/mwiki/?title=VB_Chr_Values\n\nout = v\n\n'Chop off the first character so long as it's white space\nIf v &lt;&gt; \"\" Then\n    Do While AscW(Left(out, 1)) &lt; 33 Or InStr(1, bad, \"||\" &amp; AscW(Left(out, 1)) &amp; \"||\") &lt;&gt; 0 'Left(out, 1) = \" \" Or Left(out, 1) = Chr(9) Or Left(out, 1) = Chr(160)\n        out = Right(out, Len(out) - 1)\n    Loop\n\n    'Chop off the last character so long as it's white space\n    Do While AscW(Right(out, 1)) &lt; 33 Or InStr(1, bad, \"||\" &amp; AscW(Right(out, 1)) &amp; \"||\") &lt;&gt; 0 'Right(out, 1) = \" \" Or Right(out, 1) = Chr(9) Or Right(out, 1) = Chr(160)\n        out = Left(out, Len(out) - 1)\n    Loop\nEnd If 'else out = \"\" and there's no processing to be done\n\n'Capture result for return\nTrueTrim = out\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9306944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFHWT.jpg?s=128&g=1", "display_name": "certifiedtranslator.hu", "link": "https://stackoverflow.com/users/9306944/certifiedtranslator-hu"}, "is_accepted": false, "score": 0, "last_activity_date": 1519062701, "creation_date": 1519062701, "answer_id": 48871632, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space/48871632#48871632", "title": "VBA Trim leaving leading white space", "body": "<p>Non-printables divide different lines of a Web page. I replaced them with X, Y and Z respectively.</p>\n\n<p>Debug.Print Trim(Mid(\"X     test  \", 2)) ' first place counts as 2 in VBA</p>\n\n<p>Debug.Print Trim(Mid(\"XY    test  \", 3)) ' second place counts as 3 in VBA</p>\n\n<p>Debug.Print Trim(Mid(\"X Y Z test  \", 2)) ' more rounds needed :)</p>\n\n<p>Programmers prefer large text as may neatly be chopped with built in tools (inSTR, Mid, Left, and  others). Use of text from several children (i.e taking .textContent versus .innerText) may result several non-printables to cope with, yet DOM and REGEX are not for beginners. Addressing sub-elements for inner text precisely (child elements one-by-one !) may help evading non-printable characters. </p>\n"}], "owner": {"reputation": 147, "user_id": 3059069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31b6c264478dc38f8c5bfd8d0fec7575?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/3059069/jmichael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5128, "favorite_count": 1, "answer_count": 6, "score": 3, "last_activity_date": 1519062701, "creation_date": 1420581106, "question_id": 27807802, "link": "https://stackoverflow.com/questions/27807802/vba-trim-leaving-leading-white-space", "title": "VBA Trim leaving leading white space", "body": "<p>I'm trying to compare strings in a macro and the data isn't always entered consistently. The difference comes down to the amount of leading white space (ie \" test\" vs. \"test\" vs. \"  test\")</p>\n\n<p>For my macro the three strings in the example should be equivalent. However I can't use Replace, as any spaces in the middle of the string (ex. \"test one two three\") should be retained. I had thought that was what Trim was supposed to do (as well as removing all trailing spaces). But when I use Trim on the strings, I don't see a difference, and I'm definitely left with white space at the front of the string.</p>\n\n<p>So A) What does Trim really do in VBA? B) Is there a built in function for what I'm trying to do, or will I just need to write a function?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1420580767, "post_id": 27807641, "comment_id": 44024506, "body": "Can you post what you&#39;ve tried already to see if the community can troubleshoot?"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 4403105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61f7d7a640fc7dbd6861e1b5a0be21?s=128&d=identicon&r=PG", "display_name": "Michael Martin", "link": "https://stackoverflow.com/users/4403105/michael-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1420737698, "creation_date": 1420737698, "answer_id": 27845959, "question_id": 27807641, "link": "https://stackoverflow.com/questions/27807641/macro-to-skip-blank-lines/27845959#27845959", "title": "Macro to Skip Blank Lines", "body": "<p>I was able to answer this myself, sorry I wasn't able to post this sooner.  I had the macro check for an empty cell in Column P, if there wasn't one, I had it copy that row to a sheet specified by that player's position.</p>\n\n<pre><code>Sub ActivePlayers()\n\nDim i As Long\n\nSheets(\"AllPlayers\").Select\n' Find the last row of data\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n' Loop through each row\nFor i = 3 To FinalRow\n    ' Decide if to copy based on column P and which sheet to copy to based on Column B\n    ThisValue = Cells(i, 16).Value\n    Position = Cells(i, 2).Value\n    If ThisValue &lt;&gt; \"\" Then\n        Cells(i, 1).Resize(1, 33).Copy\n        Sheets(Position).Select\n        NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Cells(NextRow, 1).Select\n        ActiveSheet.Paste\n        Sheets(\"AllPlayers\").Select\n\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4403105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61f7d7a640fc7dbd6861e1b5a0be21?s=128&d=identicon&r=PG", "display_name": "Michael Martin", "link": "https://stackoverflow.com/users/4403105/michael-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1468, "favorite_count": 0, "accepted_answer_id": 27845959, "answer_count": 1, "score": 0, "last_activity_date": 1420737698, "creation_date": 1420580434, "question_id": 27807641, "link": "https://stackoverflow.com/questions/27807641/macro-to-skip-blank-lines", "title": "Macro to Skip Blank Lines", "body": "<p>I understand that this is a question that has been asked before in a multitude of forms, but every time I try to use the solution to answer my problem, it's not working and I can't figure out how to adjust to make it work for me.</p>\n\n<p>I have a sheet that, with formulas, pulls all of the data from a daily-updated spreadsheet based on NBA games; in other words, who they're playing, what their opponent's rank is, etc...  This creates a large spreadsheet with a line for each player with the aforementioned data next to players who are active tonight.  </p>\n\n<p>If a player isn't active, his line is blank.</p>\n\n<p>I want to set up a way to automatically parse a new sheet with <em>just</em> the list of active players, skipping the inactive players.  I understand that I need to create a looped macro that will go through each cell and copy that cell value if it &lt;>\"\", but I can't seem to get it to work.</p>\n"}, {"tags": ["excel", "concatenation", "filenames", "renaming", "vba"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1420581157, "creation_date": 1420581157, "answer_id": 27807816, "question_id": 27807581, "link": "https://stackoverflow.com/questions/27807581/vba-write-a-macro-to-change-a-number-in-a-workbooks-name/27807816#27807816", "title": "vba write a macro to change a number in a workbooks name", "body": "<p>You can use:</p>\n\n<pre><code>Workbooks(\"cash\" &amp; d &amp; \".xlsx\").Activate\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>y = \"cash \" &amp; d &amp; \".xlsx\"\nWorkbooks(y).activate\n</code></pre>\n\n<p>If you put quotes around your variables they become strings and are intepreted as just <code>d</code> or <code>y</code></p>\n\n<p>Also, it's best to come up with names for your variables so the next person that has to maintain your code doesn't hunt you down at your new job and stab your eyeballs out with a pair of chopsticks while screaming obscenities at you.</p>\n"}, {"tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": false, "score": 0, "last_activity_date": 1420582200, "last_edit_date": 1420582200, "creation_date": 1420581497, "answer_id": 27807913, "question_id": 27807581, "link": "https://stackoverflow.com/questions/27807581/vba-write-a-macro-to-change-a-number-in-a-workbooks-name/27807913#27807913", "title": "vba write a macro to change a number in a workbooks name", "body": "<p>If you want to break down the old name and rename it with a new year, try this.</p>\n\n<p>As long as the form is \"AAAA ####.ext\" with a space between the name and year. </p>\n\n<p>This will take the old name, break out the year, add one, then Save As the new name.</p>\n\n<pre><code>Sub RenameNewYear()\nDim oldPath As String, path As String, OldName As String, fileExt As String\nDim tempYear As Long, newYear As Long\nDim old() As String\nDim Filename As String, FileNPath As String\n\n    path = ActiveWorkbook.path    'C:\\users\\owner\\desktop\n    OldName = ActiveWorkbook.Name '\"cash 2015.xlsm\"   \n\n    'Split original name up into sections.  \n    old = Split(OldName, \".\")     'old(0) = \"cash 2014\", old(1) = \"xlsm\"\n    fileExt = \".\" &amp; old(1)        '.xlsm\n    old = Split(old(0), \" \")      'old(0) = \"cash\", old(1) = \"2014\"\n\n    tempYear = CLng(old(1))       '2014\n    newYear = tempYear + 1        '2015\n\n    Filename = (old(0) &amp; \" \" &amp; newYear &amp; fileExt)   '\"cash 2015.xlsm\"\n\n    FileNPath = path &amp; \"\\\" &amp; Filename           'C:\\users\\owner\\desktop\\cash 2015.xlsm\n\n    ActiveWorkbook.SaveAs fileName:=FileNPath\n    Sheets(\"sum\").Activate\nEnd Sub\n</code></pre>\n\n<p>To open it you'd use this:  But it would already be open, as the last code saves As the new name.</p>\n\n<pre><code>Workbooks.Open Filename:=FileNPath\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4425522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b653e1cffad2b81c20be9f551c089db5?s=128&d=identicon&r=PG&f=1", "display_name": "gary27nini", "link": "https://stackoverflow.com/users/4425522/gary27nini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424227276, "creation_date": 1420580192, "last_edit_date": 1531161705, "question_id": 27807581, "link": "https://stackoverflow.com/questions/27807581/vba-write-a-macro-to-change-a-number-in-a-workbooks-name", "title": "vba write a macro to change a number in a workbooks name", "body": "<p>I want a macro that will at the start of a year change, for example,</p>\n\n<pre><code>Workbooks(\"cash 2014.xlsx\").Worksheets(\"sum\").Activate\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Workbooks(\"cash 2015.xlsx\").Worksheets(\"sum\").Activate\n</code></pre>\n\n<p>I've created the steps that on 1/1/2015 would give me d = 2015, so that I can write</p>\n\n<pre><code>y = \"cash \" &amp; d &amp; \".xlsx\", which yields cash 2015.xlsx (with no quotes).\n</code></pre>\n\n<p>If I then write \n    Workbooks(y).Worksheets(\"sum\").Activate,\nor \n    Workbooks(\"y\").Worksheets(\"sum\").Activate,\nExcel won't run either one.</p>\n\n<p>VBA also doesn't recognize: \n    Workbooks(\"\"cash \" &amp; d &amp; \".xlsx\"\").Activate\nor \n    Workbooks('\"cash \" &amp; d &amp; \".xlsx\"').Activate\nor \n    Workbooks(\"'cash ' &amp; d &amp; '.xlsx').Activate</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420580855, "post_id": 27807510, "comment_id": 44024540, "body": "This is what QueryTable does. When you Refresh it it replaces the old data with the new data (it refreshes!). What I really wonder about is why it does not overwrite the old data but moves it to a side? maybe it is because you Add yet a new QueryTable every time you run your code? Anyway, quit using QueryTables and just get query result into a recordset and write the records where you wish."}, {"owner": {"reputation": 137, "user_id": 4667805, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e8f6a33f5091f1f25385b25efd88a77?s=128&d=identicon&r=PG&f=1", "display_name": "LearningMacro", "link": "https://stackoverflow.com/users/4667805/learningmacro"}, "reply_to_user": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "edited": false, "score": 0, "creation_date": 1420581633, "post_id": 27807510, "comment_id": 44024858, "body": "@GeneSkuratovsky - I&#39;m new to Excel VBA. I would really appreciate, if you can help me with the recordset for my current Macro."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420584632, "post_id": 27807510, "comment_id": 44026195, "body": "That happens because of this piece of code: Destination:=Range(&quot;a1&quot;"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1420599480, "post_id": 27807510, "comment_id": 44030294, "body": "what is going on at Range(&quot;A1000&quot;)?"}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 4375632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vtawv.jpg?s=128&g=1", "display_name": "Gene Skuratovsky", "link": "https://stackoverflow.com/users/4375632/gene-skuratovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1420593908, "creation_date": 1420593908, "answer_id": 27810062, "question_id": 27807510, "link": "https://stackoverflow.com/questions/27807510/shift-excel-cell-down-after-executing-a-macro-for-second-time/27810062#27810062", "title": "Shift Excel Cell down after executing a macro for second time", "body": "<p>You could have something like this:</p>\n\n<pre><code>Sub a()\n'Must set Reference to \"Microsoft ActiveX Data Objects 2.8 Library\"\n    Dim ws As Worksheet\n    Dim n As Long ' Row To Write In\n    Dim sql As String\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim i As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Tab Name\")\n    'Assuming you already have Headings in row 1 _\n        and start adding records from \"A2\" down...\n    n = ws.Range(\"A10000\").End(xlUp).row + 1\n    'you sql string above is missing some double quotes...\n    sql = \"select distinct m.JobNumber, cast(m.ExpectedDate as DATE) 'Ship Date', m.CustLongName 'Customer'\" &amp; _\n             \" from ArchiveJobHeader m  left join AuxiliaryInfoFile af (nolock) on af.jobnumber=m.jobnumber\" &amp; _\n             \" where m.JobNumber = '\" &amp; Trim(Strcode) &amp; \"'\" &amp; _\n             \" order by 'Resulttime'\"\n    Set cn = New ADODB.Connection\n    ' using an ODBC DSN... as in &lt;http://msdn.microsoft.com/en-us/library/ms807027.aspx&gt;\n    cn.Open \"SQLDSN\", \"test\", \"test123\"\n    Set rs = cn.Execute(sql) ' likely, in your case, to return one record only, _\n                                so you are on there right away\n    For i = 0 To rs.Fields.Count\n        ws.Cells(n, i + 1) = rs(i)\n    Next\n    rs.Close\n    cn.Close\nEnd Sub\n</code></pre>\n\n<p>You would need to put more work into this, I am afraid, but this is the direction you may consider.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4667805, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e8f6a33f5091f1f25385b25efd88a77?s=128&d=identicon&r=PG&f=1", "display_name": "LearningMacro", "link": "https://stackoverflow.com/users/4667805/learningmacro"}, "edited": false, "score": 0, "creation_date": 1420643347, "post_id": 27810821, "comment_id": 44050468, "body": "@Gene Skuratovsky- Thanks for your help"}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 1, "last_activity_date": 1420599767, "creation_date": 1420599767, "answer_id": 27810821, "question_id": 27807510, "link": "https://stackoverflow.com/questions/27807510/shift-excel-cell-down-after-executing-a-macro-for-second-time/27810821#27810821", "title": "Shift Excel Cell down after executing a macro for second time", "body": "<p>If you incorporate a lastRow check and then assign a variable the Next Row number, you can concatenate your Range and it will be a new row every time.</p>\n\n<pre><code>Dim lastRow As Long, nextRow As Long\n\nlastRow = Sheets(\"Sheet Name\").Range(\"A\" &amp; Rows.count).End(xlUp).row\nnextRow = lastRow + 1\n</code></pre>\n\n<p>Then when you set your Range, concatenate the variable with the string.</p>\n\n<pre><code>Set thisQT = ActiveSheet.QueryTables.Add( _\n                 Connection:=connstring, _\n                 Destination:=Range(\"A\" &amp; nextRow))\n</code></pre>\n\n<p>I'm not sure what you are doing with row 1000 as shown in your question.  But this is the idea of using a variable with your normal Range Address.</p>\n"}], "owner": {"reputation": 137, "user_id": 4667805, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e8f6a33f5091f1f25385b25efd88a77?s=128&d=identicon&r=PG&f=1", "display_name": "LearningMacro", "link": "https://stackoverflow.com/users/4667805/learningmacro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "accepted_answer_id": 27810821, "answer_count": 2, "score": 1, "last_activity_date": 1424227303, "creation_date": 1420579864, "last_edit_date": 1531164843, "question_id": 27807510, "link": "https://stackoverflow.com/questions/27807510/shift-excel-cell-down-after-executing-a-macro-for-second-time", "title": "Shift Excel Cell down after executing a macro for second time", "body": "<p>I've written a (below)macro that pulls data from the sql server 2008 r2. My issue is when the user runs the macro for first time by entering Jobnumber (say J0001) excel puts data on the spreadsheet starting from cell \"A1\" which is fine. The issue here is, when the user runs the macro for the second time by entering the jobnumber (say J0002), excel puts the data for Jobnumber (J0002) on cell \"A1\" and shifts the cells for J0001(first job) to cell \"F\" instead of moving down. How can I shift the previous entry down in the spreadsheet with the latest entry on top?</p>\n\n<p>Here is my macro and attachment:</p>\n\n<pre><code>Sub Task()\nDim sqlstring As String\nDim connstring As String\nDim Strcode As String\nStrcode = Trim(InputBox(\"Please enter a Job #\", \"Task history\"))\nsqlstring = \"select distinct m.JobNumber , cast(m.ExpectedDate as DATE) 'Ship Date' ,m.CustLongName 'Customer' &amp; _\n             \" from ArchiveJobHeader m  left join AuxiliaryInfoFile af (nolock) on af.jobnumber=m.jobnumber &amp; _\n             \" where m.JobNumber = '\" &amp; Trim(Strcode) &amp; \"'\" &amp; _\n             \" order by 'Resulttime'\"\nconnstring = \"ODBC;DSN=SQLDSN;UID=test;PWD=test123\"\n Dim thisQT As QueryTable\n Set thisQT = ActiveSheet.QueryTables.Add(Connection:=connstring, Destination:=Range(\"a1\", \"a1000\"))\n thisQT.BackgroundQuery = False\n thisQT.Sql = sqlstring\nthisQT.Refresh\nEnd Sub][1]\n</code></pre>\n"}, {"tags": ["vba", "excel", "syntax", "row"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1420581031, "post_id": 27807454, "comment_id": 44024618, "body": "Are the entries on <code>Sheet1</code> and <code>Sheet2</code> numbers? Words (i.e. strings)? You&#39;ve got the gist of this one down, but will need to loop through the ranges cell-by-cell to compare values"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1420582854, "post_id": 27807454, "comment_id": 44025432, "body": "They will be numbers, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1420581457, "last_edit_date": 1495542507, "creation_date": 1420581457, "answer_id": 27807903, "question_id": 27807454, "link": "https://stackoverflow.com/questions/27807454/excel-vba-for-hiding-cells-in-one-sheet-if-they-match-cells-in-another-sheet/27807903#27807903", "title": "Excel VBA for hiding cells in one sheet if they match cells in another sheet", "body": "<p>Few things:</p>\n\n<ol>\n<li><p>you cannot compare entire column:</p>\n\n<pre><code>Sheet2Value = Sheets(\"Sheet2\").Range(\"A:A\").Value\n</code></pre>\n\n<p>you need to loop through the collection of cells, see this: <a href=\"https://stackoverflow.com/questions/19567060/excel-vba-fast-compare-method-of-2-columns\">Fast compare method of 2 columns</a></p></li>\n<li><p>you cannot hide row without defining a range to hide</p>\n\n<pre><code>Sheets(\"BMAC=N\").Range(\"Some_address\").EntireRow.Hidden\n</code></pre></li>\n<li><p>Finally, i'd suggest to change your code to shortest way:</p>\n\n<pre><code>Sheets(\"BMAC=N\").Range(\"A1\").EntireRow.Hidden = (value1&lt;&gt;value2)\n</code></pre></li>\n</ol>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 651, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420581457, "creation_date": 1420579628, "question_id": 27807454, "link": "https://stackoverflow.com/questions/27807454/excel-vba-for-hiding-cells-in-one-sheet-if-they-match-cells-in-another-sheet", "title": "Excel VBA for hiding cells in one sheet if they match cells in another sheet", "body": "<p>I am new to VBA and am having problems learning the rules of variables (I think that's the problem here).</p>\n\n<p>I have two worksheets in a spreadsheet.  I need to make code that automatically hides a row on worksheet 2 if that same value in column a is on worksheet 1, column a.</p>\n\n<p>Here's one of the variations of code I've tried:</p>\n\n<pre><code>Dim Sheet2Value As Variant\nDim Sheet1Value As Variant\n'\nSheet2Value = Sheets(\"Sheet2\").Range(\"A:A\").Value\nSheet1Value = Sheets(\"Sheet1\").Range(\"A:A\").Value\n'\nIf Sheet2Value = Sheet1Value Then\n    Sheets(\"BMAC=N\").EntireRow.Hidden = False\nElse\n    Sheets(\"BMAC=N\").EntireRow.Hidden = True\nEnd If\n</code></pre>\n\n<p>I get a type mismatch error but I'm not sure exactly why.  I chose variant because I don't know what I'm doing, but both columns in excel will be set to \"General\".</p>\n\n<p>Can anyone help with this?  What concept am I missing?</p>\n\n<p>Thanks so much for your time.</p>\n"}, {"tags": ["c#", "excel", "filtering", "delete-row", "vba"], "comments": [{"owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "edited": false, "score": 1, "creation_date": 1420579963, "post_id": 27807450, "comment_id": 44024078, "body": "How about deleting them in a block together, e.g. <code>Rows(\u201c[1:1048576]\u201d).EntireRow.Delete</code>?"}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1420580068, "post_id": 27807450, "comment_id": 44024146, "body": "First of all, insert a <code>DoEvents</code> above the <code>Next</code>."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "edited": false, "score": 0, "creation_date": 1420580117, "post_id": 27807450, "comment_id": 44024172, "body": "@RickTeachey : I can&#39;t do bulk delete as between 1 to 1048576 rows, I need to delete those rows where column C is blank. Upon debug I find that when I step through the .delete command, it just freezes (forever). I kept if for like 45 mins and when I checked later, it was still frozen."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1420580162, "post_id": 27807450, "comment_id": 44024192, "body": "@KekuSemau : I have tried that. The issue is it not even coming out of the very 1st &quot;delete&quot; command."}, {"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1420580342, "post_id": 27807450, "comment_id": 44024292, "body": "What is the purpose of deleting row by row? Updating the staus bar is a waste of time - especially with having <code>Application.ScreenUpdating</code> set to <code>False</code>. Would it be okay to just delete the whole range in one hit?"}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1420580361, "post_id": 27807450, "comment_id": 44024302, "body": "<code>r.rows(i).Delete</code> looks odd, this will not delete the entire row, but only one cell and left shift the row. Do you need that? Anyway, can you not just sort by Column A, mark blanks and delete those entire rows manually?"}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1420580611, "post_id": 27807450, "comment_id": 44024415, "body": "@KekuSemau: r.rows(i).Delete -&gt; I thought it deletes the row. I am not sure if it deletes cell by cell in each row?"}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 1, "creation_date": 1420580755, "post_id": 27807450, "comment_id": 44024502, "body": "No, <code>r</code> is only Column A, you could use <code>r.rows(i).EntireRow.Delete</code>. Again, if C is your key column, sort by C, mark empty rows manually downwards in one step and delete...?"}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 2, "creation_date": 1420581195, "post_id": 27807450, "comment_id": 44024683, "body": "How about just writing out all the rows you want to keep to a new file/spreadsheet instead?"}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1420641422, "post_id": 27807450, "comment_id": 44049223, "body": "@LasseV.Karlsen : I would like to try this approach as deletion is going to take more than 2 days. I guess I will have to loop through and create new worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420580744, "post_id": 27807645, "comment_id": 44024491, "body": ":I thought it would delete the entire row at one shot. What I am doing is stepping all the rows from bottom. and if the row is blank, then I am issuing delete command. As said in OP, it freezes here. You mentioned it deletes Cell A. so what&#39;s the command to delete entire row?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420580851, "post_id": 27807645, "comment_id": 44024538, "body": "jsut need to tell it the entire row.  I updated the above code with; r.rows(i).EntireRow.Delete.  I also updated it to check column C"}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420581007, "post_id": 27807645, "comment_id": 44024609, "body": "I am going to try it now."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420581993, "post_id": 27807645, "comment_id": 44025009, "body": "Is there anything I need to do in above code for auto-save? or do I need to run any command for &#39;save&#39;?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420585390, "post_id": 27807645, "comment_id": 44026498, "body": "at the end jsut add ActiveWorkbook.Save"}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420640460, "post_id": 27807645, "comment_id": 44048610, "body": "Process is still running but it shows count..Looks like it is doing 12,000 rows per hour (approx) and may take another 24 hours or so. If I hit ESC key multiple times, will it abort? and if it aborts it doesn&#39;t roll back deleted records? please suggest"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420644536, "post_id": 27807645, "comment_id": 44051297, "body": "hitting esc key stops the macro and does not roll back but you hard coded the range so it will start over and look at the entire range again."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 2, "last_activity_date": 1420580827, "last_edit_date": 1420580827, "creation_date": 1420580448, "answer_id": 27807645, "question_id": 27807450, "link": "https://stackoverflow.com/questions/27807450/excel-need-to-delete-about-1-million-blank-rows/27807645#27807645", "title": "Excel : Need to delete about 1 million blank rows", "body": "<p>I made a few updates to your code such as the doevents, turning on  the status bar, since oyu are writing to it, and updating the screen when needed and adding cstr() when you write out an numeric value.  I ran this with no problem. as noted in the comments, this only deletes cell A not the entire row</p>\n\n<pre><code>Sub BlankRowDelete()\nOn Error GoTo myError\nDim r As Range, rows As Long, i As Long\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\nActiveSheet.AutoFilterMode = False\n\nSet r = ActiveSheet.Range(\"C1:C1048576\") \nrows = r.rows.Count\nFor i = rows To 1 Step (-1)\n    If WorksheetFunction.CountA(r.rows(i)) = 0 Then\n        r.rows(i).EntireRow.Delete\n        RowDeleted = RowDeleted + 1\n    Else\n        NotDeleted = NotDeleted + 1\n    End If\n    totalcnt = totalcnt + 1\n    If RowDeleted = 100 Then\n\n       Application.ScreenUpdating = True\n       TotalDeleted = TotalDeleted + RowDeleted\n       RowDeleted = 0\n                   'you can uncomment this but since this is a dup since writting to statusbar (imo)\n      'Debug.Print \"count now is \" + CStr(totalcnt)\n\n       Application.ScreenUpdating = False\n    End If\n    Application.StatusBar = \"Row count is \" + CStr(totalcnt)\n    DoEvents\nNext\nmyError:\nIf Err.Number &lt;&gt; 0 Then\nMsgBox CStr(i) &amp; \": \" &amp; Err.Description\nEnd If\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\nActiveSheet.AutoFilterMode = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "edited": false, "score": 0, "creation_date": 1420584835, "post_id": 27808311, "comment_id": 44026272, "body": ":That&#39;s what I have done but manual deletion just freezes for hours. So I am going the VBA route but with issues so far."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420641476, "post_id": 27808311, "comment_id": 44049263, "body": "@pnuts : I tried that first time. It just froze. Now it makes sense to me because VBA script has deleted only 130000 rows in the last 14 hours."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1420641870, "post_id": 27808311, "comment_id": 44049518, "body": "@pnuts: The file seems fine to me but it takes to apply any formula to the column also. I am going to try the approach of creating new worksheet for GOOD rows."}, {"owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1420642529, "post_id": 27808311, "comment_id": 44049926, "body": "@pnuts:I guess the new VBA script to copy GOOD rows to new worksheet should work even when they newer versions. Correct?"}], "tags": [], "owner": {"reputation": 2856, "user_id": 835591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f40a853c80ab7320114f4284f81a31e6?s=128&d=identicon&r=PG", "display_name": "thalesmello", "link": "https://stackoverflow.com/users/835591/thalesmello"}, "is_accepted": false, "score": 0, "last_activity_date": 1420583215, "creation_date": 1420583215, "answer_id": 27808311, "question_id": 27807450, "link": "https://stackoverflow.com/questions/27807450/excel-need-to-delete-about-1-million-blank-rows/27808311#27808311", "title": "Excel : Need to delete about 1 million blank rows", "body": "<p>Sort the document in ascending order by the C column. Blank lines will go to the end, so it should be easy to delete them.</p>\n"}], "owner": {"reputation": 561, "user_id": 901504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65040505d501fc6dc98dcb7d0e69fa98?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/901504/anirudh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1944, "favorite_count": 0, "accepted_answer_id": 27807645, "answer_count": 2, "score": 1, "last_activity_date": 1497512389, "creation_date": 1420579598, "last_edit_date": 1531161705, "question_id": 27807450, "link": "https://stackoverflow.com/questions/27807450/excel-need-to-delete-about-1-million-blank-rows", "title": "Excel : Need to delete about 1 million blank rows", "body": "<p>I have an excel file from one of our customers and the file has close to 1 million blank rows.</p>\n\n<p>I did try filtering it on column C (called Items) where it is blank and then chose all rows and tried deleting. It almost froze for nearly couple of hours but at the end I had kill excel process.</p>\n\n<p>I also tried below VBA script but the actual line where it says \"r.rows(i).Delete\" just freezes. This is for the 1st delete instance itself.</p>\n\n<p>I have the excel file set to Manual for formula calculation also.</p>\n\n<p>I don't mind the entire job taking few hours. I can leave it overnight and check in the morning. </p>\n\n<p>If there is anything with VB.NET or C# that's also fine.</p>\n\n<p><strong>Update  1:</strong>  I can't do bulk delete as between 1 to 1048576 rows, I need to delete those rows where column C is blank (which means the row is blank).</p>\n\n<p><strong>Update 2:</strong> I marked the below deletion as the answer but I eventually ended up resolving the issue by copying the GOOD rows to another worksheet.</p>\n\n<p>Please suggest the best options to handle this scenario.</p>\n\n<p>VBA source</p>\n\n<pre><code>Sub BlankRowDelete()\n\nDim r As Range, rows As Long, i As Long\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\nActiveSheet.AutoFilterMode = False\n\nSet r = ActiveSheet.Range(\"A1:A1048576\")\nrows = r.rows.Count\nFor i = rows To 1 Step (-1)\n    If WorksheetFunction.CountA(r.rows(i)) = 0 Then\n        r.rows(i).Delete\n        RowDeleted = RowDeleted + 1\n    Else\n        NotDeleted = NotDeleted + 1\n    End If\n    totalcnt = totalcnt + 1\n    If RowDeleted = 100 Then\n       TotalDeleted = TotalDeleted + RowDeleted\n       RowDeleted = 0\n       Debug.Print \"count now is \" + totalcnt\n    End If\n    Application.StatusBar = \"Row count is \" + totalcnt\nNext\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\nActiveSheet.AutoFilterMode = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 2, "creation_date": 1420578229, "post_id": 27806987, "comment_id": 44023214, "body": "Is this an exercise to learn about obfuscation, or are you trying to secure your VBA?"}, {"owner": {"reputation": 43, "user_id": 2597855, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000430812843/picture?type=large", "display_name": "Jefferson Neves", "link": "https://stackoverflow.com/users/2597855/jefferson-neves"}, "edited": false, "score": 0, "creation_date": 1420587892, "post_id": 27806987, "comment_id": 44027377, "body": "This is an exercise but also i am trying to secure my vba. My vba code is not any comercial kind of code, i share a lot macro with colleagues. The last time they broke my vba pw (i know its easy), i also understand that obfuscation in vba isnt the best security mechanism, but im sure it will prevent a lot of ppl."}, {"owner": {"reputation": 43, "user_id": 2597855, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000430812843/picture?type=large", "display_name": "Jefferson Neves", "link": "https://stackoverflow.com/users/2597855/jefferson-neves"}, "edited": false, "score": 0, "creation_date": 1420587960, "post_id": 27806987, "comment_id": 44027398, "body": "Gene, only temp is variant, but i dont understand how your comment can help in this question."}, {"owner": {"reputation": 523, "user_id": 3650944, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0881550421fcac56ddaadafde11d2f2f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Jensen", "link": "https://stackoverflow.com/users/3650944/adam-jensen"}, "edited": false, "score": 0, "creation_date": 1428567881, "post_id": 27806987, "comment_id": 47219829, "body": "What is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1445618282, "creation_date": 1445618282, "answer_id": 33307411, "question_id": 27806987, "link": "https://stackoverflow.com/questions/27806987/obfuscation-vba-excel-break-line-var-names/33307411#33307411", "title": "Obfuscation VBA Excel - Break Line, Var Names", "body": "<p>Why not start with <a href=\"http://sourceforge.net/projects/invisiblebasic/\" rel=\"nofollow\">this</a> Open Source code and make a new build from that instead of reinventing the wheel? </p>\n\n<p>You need to change all the file extensions in the code from <code>.xls</code> to <code>.xlsm</code>, save the IB_test.xls workbook as a macro-enabled workbook and save the addin as <code>.xlam</code>, not <code>.xla</code> to make this work, but even though the code is 9 years old, it still works in Excel 2013.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 7439152, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f8af9a0c161f05c27bcd2a466ff7351?s=128&d=identicon&r=PG&f=1", "display_name": "YeP", "link": "https://stackoverflow.com/users/7439152/yep"}, "is_accepted": false, "score": 0, "last_activity_date": 1551916973, "creation_date": 1551916973, "answer_id": 55034083, "question_id": 27806987, "link": "https://stackoverflow.com/questions/27806987/obfuscation-vba-excel-break-line-var-names/55034083#55034083", "title": "Obfuscation VBA Excel - Break Line, Var Names", "body": "<p>If you are into VBA obfuscation, you may want to try out VBASH (www.ayedeal.com/vbash). It is pretty straight forward and powerful. </p>\n"}], "owner": {"reputation": 43, "user_id": 2597855, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000430812843/picture?type=large", "display_name": "Jefferson Neves", "link": "https://stackoverflow.com/users/2597855/jefferson-neves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1551916973, "creation_date": 1420577580, "last_edit_date": 1485610010, "question_id": 27806987, "link": "https://stackoverflow.com/questions/27806987/obfuscation-vba-excel-break-line-var-names", "title": "Obfuscation VBA Excel - Break Line, Var Names", "body": "<p>Im trying to build my own Obfuscation add-in for my VBA projects.</p>\n\n<p>I started with the easier tasks:</p>\n\n<ul>\n<li>Remove Blank Lines</li>\n<li>Remove Indentts</li>\n<li>Remove Comments</li>\n</ul>\n\n<p>I could figure out how to do this things, maybe not in the best way, but im stuck in:</p>\n\n<ul>\n<li>Insert Random Break Lines (\" _\")</li>\n</ul>\n\n<p>I would like to have this working for diferent types of delimiter, for now im only working with \"=\" signal. By the way, i have problems when i have multiple delimiters in the line (Eg: If bla = \"abc\" or ble = \"acd\"). The code causes incorrects splits in my line.</p>\n\n<pre><code>Sub VBE_Break_The_Lines()\nDim VBC As VBComponent\nDim a, i, j, lCount As Long\nDim str As String\nDim temp As Variant\nlCount = 0\ni = 1\nDim blnStringMode, blnLineContinue As Boolean\n    For Each VBC In VBProjToClean.VBComponents\n        blnStringMode = False\n        i = 1\n        With VBC.CodeModule\n            Do Until i &gt; .CountOfLines\n                If Not .ProcOfLine(i, vbext_pk_Proc) = \"VBE_Remove_Comments\" Then\n                    str = .Lines(i, 1)\n                End If\n\n                If InStr(1, str, \" = \", vbTextCompare) &gt; 0 Then\n                    temp = Split(str, \" = \")\n                    .InsertLines i, \"\"\n                    .ReplaceLine i, temp(0) &amp; \" _\"\n                    .InsertLines i + 1, \"= \" &amp; temp(1)\n                    .DeleteLines i + 2\n                    lCount = lCount + 1\n                    'a = InStr(1, str, \"=\", vbTextCompare)\n                    i = i + 1\n                End If\n            i = i + 1\n            Loop\n        End With\n    Next\nMsgBox lCount &amp; \"  LINES BREAKED ( = )\", , strFileToClean\n\nEnd Sub\n</code></pre>\n\n<p>My next step will be change procedure/variable names, but not sure if REGEX should be the best way, i just read a lot, but not sure yet.</p>\n\n<p>Hope you guys can give me a way to follow</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420580067, "post_id": 27806878, "comment_id": 44024145, "body": "Why are you filtering in Access? Excel has plenty of options for filtering data."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1420581832, "post_id": 27806878, "comment_id": 44024949, "body": "Sorry, but your question is not clear. Are you trying to add new row in Excel sheet or are you trying to add data into Access database?"}, {"owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "reply_to_user": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420640167, "post_id": 27806878, "comment_id": 44048419, "body": "@KevenDenen I filter the data in access since I use it to generate reports."}, {"owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420640206, "post_id": 27806878, "comment_id": 44048447, "body": "@Maciej Los I am trying to add a new row in an access table using a query.However that table already has data, but I want to add the row as the first row above the data that is already there."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "edited": false, "score": 0, "creation_date": 1420664957, "post_id": 27821978, "comment_id": 44063313, "body": "What about inserting data in say the second row or any other row except the first one?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "edited": false, "score": 0, "creation_date": 1420669537, "post_id": 27821978, "comment_id": 44065473, "body": "@Navron, As i mentioned, there is no way to insert data in first, second, etc. row."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1420641996, "creation_date": 1420641996, "answer_id": 27821978, "question_id": 27806878, "link": "https://stackoverflow.com/questions/27806878/insert-into-first-row-excel/27821978#27821978", "title": "Insert Into First Row Excel", "body": "<p>There is no way to insert data into MS Access database (table) at the beginning of the table. But you can sort data.</p>\n\n<p>For further information, please see: <a href=\"https://support.office.com/en-ca/article/Save-a-sort-order-with-a-table-query-form-or-report-4f255441-7326-486a-97ad-7760e8b0880b\" rel=\"nofollow\">Save a sort order with a table, query, form, or report</a> </p>\n"}], "owner": {"reputation": 125, "user_id": 4240240, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4da022c7061b9eae402b8a26c0121c75?s=128&d=identicon&r=PG&f=1", "display_name": "Navron", "link": "https://stackoverflow.com/users/4240240/navron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420641996, "creation_date": 1420577115, "last_edit_date": 1420577637, "question_id": 27806878, "link": "https://stackoverflow.com/questions/27806878/insert-into-first-row-excel", "title": "Insert Into First Row Excel", "body": "<p>I have an excel file that I run through access whereby it is filtered. I am trying to create an update query that adds a new row above the filtered data and enters the value \"Filtered Values\". However, I cannot seem to find the SQL statement to do so. Any insights?</p>\n\n<p>I think something similar to:</p>\n\n<pre><code>INSERT INTO Cus (CusName) VALUES ('Filtered Values')\n</code></pre>\n\n<p>However, how do i ensure its inserted into row 1?</p>\n"}, {"tags": ["forms", "ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4425407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/01e1aa626cd2fd8b8abe1df2b3f6adaf?s=128&d=identicon&r=PG&f=1", "display_name": "Alisa", "link": "https://stackoverflow.com/users/4425407/alisa"}, "edited": false, "score": 0, "creation_date": 1420583908, "post_id": 27807839, "comment_id": 44025903, "body": "The form itself only contains customer contact information and family contact information such as names, addresses, etc. All of that needs to be editable, but I don&#39;t want someone accidentally editing things. What do you mean by directly in the &quot;edit&quot; and &quot;save&quot; buttons? -Thank you."}, {"owner": {"reputation": 419, "user_id": 1140909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RGwua.jpg?s=128&g=1", "display_name": "Alexander Remesch", "link": "https://stackoverflow.com/users/1140909/alexander-remesch"}, "reply_to_user": {"reputation": 49, "user_id": 4425407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/01e1aa626cd2fd8b8abe1df2b3f6adaf?s=128&d=identicon&r=PG&f=1", "display_name": "Alisa", "link": "https://stackoverflow.com/users/4425407/alisa"}, "edited": false, "score": 0, "creation_date": 1420584104, "post_id": 27807839, "comment_id": 44025976, "body": "Sorry, I was a bit unclear here: I meant the OnClick events of your two buttons. I&#39;m going to edit the answer."}, {"owner": {"reputation": 49, "user_id": 4425407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/01e1aa626cd2fd8b8abe1df2b3f6adaf?s=128&d=identicon&r=PG&f=1", "display_name": "Alisa", "link": "https://stackoverflow.com/users/4425407/alisa"}, "edited": false, "score": 0, "creation_date": 1420647231, "post_id": 27807839, "comment_id": 44053184, "body": "That combined with what I was doing before was exactly what I needed. Thank you for your help."}, {"owner": {"reputation": 419, "user_id": 1140909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RGwua.jpg?s=128&g=1", "display_name": "Alexander Remesch", "link": "https://stackoverflow.com/users/1140909/alexander-remesch"}, "reply_to_user": {"reputation": 49, "user_id": 4425407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/01e1aa626cd2fd8b8abe1df2b3f6adaf?s=128&d=identicon&r=PG&f=1", "display_name": "Alisa", "link": "https://stackoverflow.com/users/4425407/alisa"}, "edited": false, "score": 0, "creation_date": 1420648967, "post_id": 27807839, "comment_id": 44054305, "body": "You&#39;re welcome! If my answer was helpful in solving your problem, may I kindly ask you to mark it as solution? Thanks in advance!"}], "tags": [], "owner": {"reputation": 419, "user_id": 1140909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RGwua.jpg?s=128&g=1", "display_name": "Alexander Remesch", "link": "https://stackoverflow.com/users/1140909/alexander-remesch"}, "is_accepted": true, "score": 1, "last_activity_date": 1420584528, "last_edit_date": 1420584528, "creation_date": 1420581251, "answer_id": 27807839, "question_id": 27806839, "link": "https://stackoverflow.com/questions/27806839/allowing-conditional-editing-while-hiding-other-command-buttons-access-2007-2010/27807839#27807839", "title": "Allowing conditional editing while hiding other command buttons Access 2007-2010", "body": "<p>Instead of closing and reopening the form in \"edit\" mode, you could just set the properties of the fields you want to be able to change, i.e. .locked = false and/or .enabled = true directly in the OnClick event of your \"edit\" button.</p>\n\n<p>In the OnClick event of your \"save\" button you do it just the other way round.</p>\n\n<p>For example:</p>\n\n<pre><code>Private Sub EditButton_Click()\n    Field1.Enabled = True\nEnd Sub\n\nPrivate Sub SaveButton_Click()\n    Field1.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>Now, when you click the edit button, your field1 will be enabled for input and after clicking your save button, your field1 will be disabled (i.e. greyed and not allowing any input or focus setting) again.</p>\n\n<p>If you prefer to just \"lock\" the fields (i.e. let them have the focus and don't grey them but prevent any input), just use the .Locked field property.</p>\n"}], "owner": {"reputation": 49, "user_id": 4425407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/01e1aa626cd2fd8b8abe1df2b3f6adaf?s=128&d=identicon&r=PG&f=1", "display_name": "Alisa", "link": "https://stackoverflow.com/users/4425407/alisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 27807839, "answer_count": 1, "score": 1, "last_activity_date": 1594652518, "creation_date": 1420576953, "last_edit_date": 1594652518, "question_id": 27806839, "link": "https://stackoverflow.com/questions/27806839/allowing-conditional-editing-while-hiding-other-command-buttons-access-2007-2010", "title": "Allowing conditional editing while hiding other command buttons Access 2007-2010", "body": "<p>I currently have a form that is locked to prevent accidental editing. However, the form contains information such as customer contact information that might need to be edited. I currently have a command button that users can click that closes the form and reopens it in \"edit\" mode. What I would like to happen is to have all other command buttons on the page disappear when the form reloads and a \"save\" button appear. Once the save button is clicked I want the form to go back to non-editable and all the command buttons to reappear.</p>\n\n<p>I currently have something similar set up on another form in the database (see code below) but that is for adding a new record. How do I set it up for an existing record? Is there a more elegant way to do it besides closing and reopening the form? I've searched for quite a while and can't seem to find anything to this end. Please let me know if you need more background information about how the database is structured or more specifics with what I am trying to do. Thank you for your help!</p>\n\n<p>*</p>\n\n<pre><code>Private Sub add_Click()\nOn Error Resume Next\nDoCmd.GoToRecord , , acNewRec\nEnd Sub\nPrivate Sub Form_Current()\n   If Me.NewRecord Then\n    Me.recordcounter.Caption = \"New Record\"\n    Me.next.Visible = False\n    Me.previous.Visible = False\n    Me.first.Visible = False\n    Me.last.Visible = False\n    Me.add.Visible = False\n    Me.save.Visible = True\n   Else\n    Me.recordcounter.Caption = \"Record \" &amp; Me.CurrentRecord &amp; \" of \" &amp; Me.Recordset.RecordCount\n    Me.next.Visible = True\n    Me.previous.Visible = True\n    Me.first.Visible = True\n    Me.last.Visible = True\n    Me.add.Visible = True\n    Me.save.Visible = False\n    End If\n End Sub\nPrivate Sub save_Click()\nDoCmd.save\n    Me.previous.Visible = True\n    Me.first.Visible = True\n    Me.recordcounter.Caption = \"Record \" &amp; Me.CurrentRecord &amp; \" of \" &amp; Me.Recordset.RecordCount + 1\n    Me.previous.SetFocus\n    Me.save.Visible = False\nEnd Sub\n</code></pre>\n\n<p>*</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421444774, "post_id": 27806813, "comment_id": 44377253, "body": "Did you find anything here useful? You did not post ant feedback,"}], "answers": [{"comments": [{"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1420633435, "post_id": 27810934, "comment_id": 44044603, "body": "I cannot find: 1) <code>First</code> as a member of <code>Points</code>, 2) <code>Label</code> as a member of <code>Point</code>, 3) <code>Font</code> as a member of <code>Point</code>. Could you clarify this?"}], "tags": [], "owner": {"reputation": 175, "user_id": 4093439, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bd2a40b00936bfa10e58dff3c7f51ff8?s=128&d=identicon&r=PG&f=1", "display_name": "uqji", "link": "https://stackoverflow.com/users/4093439/uqji"}, "is_accepted": false, "score": 0, "last_activity_date": 1420600761, "creation_date": 1420600761, "answer_id": 27810934, "question_id": 27806813, "link": "https://stackoverflow.com/questions/27806813/format-data-labels-for-each-series-in-a-chart/27810934#27810934", "title": "Format data labels for each series in a chart", "body": "<p>You can loop over series and in the loop you can put </p>\n\n<pre><code>With currentSeries.points.first\n    .label = \"lable name\"\n    .font  = font(...)\n    ...\nEnd With\n</code></pre>\n\n<p>This way you only specify one point in each series.</p>\n"}, {"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1420612345, "last_edit_date": 1420612345, "creation_date": 1420610649, "answer_id": 27813339, "question_id": 27806813, "link": "https://stackoverflow.com/questions/27806813/format-data-labels-for-each-series-in-a-chart/27813339#27813339", "title": "Format data labels for each series in a chart", "body": "<p>You can do this with VBA or directly.</p>\n\n<h2>VBA</h2>\n\n<p>Assuming <code>sc</code> is a reference to your <code>SeriesCollection</code>, use</p>\n\n<pre><code>Dim isr As Integer, nsr As Integer\nnsr = sc.Count\nDim sr As Series\nDim dp As Point\nDim dl As DataLabel\nDim fn As Font\nFor isr = 1 To nsr\n    Set sr = sc(isr)\n    Set dp = sr.Points(1)\n    dp.HasDataLabel = True\n    Set dl = dp.DataLabel\n    dl.Text = \"&lt;your contents&gt;\"\n    Set fn = dl.Characters.Font\n    ' Format the data label\nNext isr\n</code></pre>\n\n<p>You have to replace <code>\"&lt;your contents&gt;\"</code>.\n<strong>Note that here you can set a reference to an Excel range instead of setting a fixed value for the data label</strong>, which appears to be your intention.</p>\n\n<h2>Direct operation</h2>\n\n<p>There is something much easier than what you are doing.</p>\n\n<p>To select a single data point, click on the target series, and then: 1) click again on the target data point, or 2) press the right arrow, to select the first data point.</p>\n\n<p>Then to add a data label, right click on the data point, and <em>Add Data Label</em>.</p>\n\n<p>Then to select a single data label, click on the data label once (this selects all data labels for the series, even if there is only one), and then: 1) click again on the target data label, or 2) press the right arrow, to select the first data label.</p>\n\n<p>Then to edit the data label, go to the formula bar and type the contents that you want. Format at will.\n<strong>Note that here you can set a reference to an Excel range instead of typing text directly into the data label</strong>, which appears to be your intention.</p>\n"}], "owner": {"reputation": 1798, "user_id": 3469243, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/r3H49.gif?s=128&g=1", "display_name": "As3adTintin", "link": "https://stackoverflow.com/users/3469243/as3adtintin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2595, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1420612345, "creation_date": 1420576822, "question_id": 27806813, "link": "https://stackoverflow.com/questions/27806813/format-data-labels-for-each-series-in-a-chart", "title": "Format data labels for each series in a chart", "body": "<p>I am trying to figure out an efficient way, either VBA or not, to format the data labels on a line graph I have. </p>\n\n<p>The graph should present the series name at the right most data label, for each series, while the remaining data labels are blank.</p>\n\n<p>Currently I just add data labels through each series, and then format each individual data label separately - but this is slow when I have series with multiple points, in addition to several series.</p>\n\n<p>Any suggestions? Thanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1420575922, "post_id": 27806600, "comment_id": 44022241, "body": "this&#39;d be a major reason to sit back, re-evaluate the design, and conclude it&#39;s crap and start using a real database, without depending on external files which apparently are movable at-whim."}, {"owner": {"reputation": 3, "user_id": 4425389, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4uYDFXliboQ/AAAAAAAAAAI/AAAAAAAAERk/2nUO-uyAWYw/photo.jpg?sz=128", "display_name": "Joe Berish", "link": "https://stackoverflow.com/users/4425389/joe-berish"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1420666084, "post_id": 27806600, "comment_id": 44063874, "body": "Thanks. There are many reasons for doing this. We have a fairly sophisticated database and a dedicated dev team. However, they are not agile, nor are we guaranteed stable internet access since we are consultants traveling all the time to remote areas. So, this is a local, slimmed down version of the Oracle DB with just essentials for us to use on the road. It is movable because I want to develop it on a file server, but then deploy it to each of the individuals on my team each day with updated data files."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4425389, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4uYDFXliboQ/AAAAAAAAAAI/AAAAAAAAERk/2nUO-uyAWYw/photo.jpg?sz=128", "display_name": "Joe Berish", "link": "https://stackoverflow.com/users/4425389/joe-berish"}, "edited": false, "score": 0, "creation_date": 1420726201, "post_id": 27806972, "comment_id": 44087826, "body": "This is great. Thank you Newd. I will work in a loop function to handle all of them."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 3, "user_id": 4425389, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4uYDFXliboQ/AAAAAAAAAAI/AAAAAAAAERk/2nUO-uyAWYw/photo.jpg?sz=128", "display_name": "Joe Berish", "link": "https://stackoverflow.com/users/4425389/joe-berish"}, "edited": false, "score": 0, "creation_date": 1420739071, "post_id": 27806972, "comment_id": 44096470, "body": "No problem, and after your explanation in your comments I can see why this could be useful in your situation."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": true, "score": 0, "last_activity_date": 1420577503, "creation_date": 1420577503, "answer_id": 27806972, "question_id": 27806600, "link": "https://stackoverflow.com/questions/27806600/re-map-linked-tables-in-access-2010/27806972#27806972", "title": "Re-map linked tables in Access 2010", "body": "<p>While I agree with Marc B that this seems like a very oddly constructed database you could use the following code the manually link the tables again to the proper location. You would need to work this into a system that can loop through all tables and do them all one by one or adjust this code to do that automatically.  But you may want to just rethink your system.  </p>\n\n<pre><code>Function SetTableLinkPath(strTableName As String, strTablePath As String)\n\n    If Nz(strTableName, \"\") &lt;&gt; \"\" And Nz(strTablePath, \"\") &lt;&gt; \"\" Then\n        Dim cdb As DAO.Database\n\n        Set cdb = CurrentDb\n\n        cdb.TableDefs(strTableName).Connect = \";DATABASE=\" &amp; strTablePath\n        cdb.TableDefs(strTableName).RefreshLink\n\n        MsgBox \"Table link for \" &amp; strTableName &amp; \" has been successfully set to the path: \" &amp; strTablePath &amp; \".\"\n    Else\n        MsgBox \"You must enter a valid Table path and name!\"\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4425389, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4uYDFXliboQ/AAAAAAAAAAI/AAAAAAAAERk/2nUO-uyAWYw/photo.jpg?sz=128", "display_name": "Joe Berish", "link": "https://stackoverflow.com/users/4425389/joe-berish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 27806972, "answer_count": 1, "score": 0, "last_activity_date": 1420577503, "creation_date": 1420575769, "question_id": 27806600, "link": "https://stackoverflow.com/questions/27806600/re-map-linked-tables-in-access-2010", "title": "Re-map linked tables in Access 2010", "body": "<p>I am a relative novice with Access and starting from scratch with coding, so be gentle.</p>\n\n<p>I have an Access 2010 database with dozens of linked tables based on .txt files. Sometimes the database moves, the source files move or the file server just gets re-named. In these events I am looking for a simple way for a user of the database to remap and refresh the linked tables. Ideally, it would be user prompted, i.e. the user pushes a button to refresh from a navigation form or something. Then, the system prompts for the new folder location. The folder location would house all of the necessary files, so it only needs to be selected one time. Once selected, all linked tables should remap and refresh with the user getting an error or success message.</p>\n\n<p>I have seen a lot of these questions asked, but they seem to be in older versions of Access or it is not asking for a user prompt or for a user to browse for the new path.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "email", "outlook", "copy"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1420576189, "post_id": 27806562, "comment_id": 44022382, "body": "What do you mean by &quot;It doesn&#39;t work&quot;. Do you get an error of somekind? Or does simply nothing happen?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1420582479, "post_id": 27806562, "comment_id": 44025249, "body": "Sening keys to read email message is poor solution. Read email message by opening each mail: <a href=\"http://msdn.microsoft.com/en-us/library/office/ff861332%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420611238, "post_id": 27806562, "comment_id": 44033914, "body": "I don&#39;t like it either, but how do i select the text body without sendkeys"}, {"owner": {"reputation": 698, "user_id": 2760773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b87b1b18411f5c97707cde95f5cdb6d?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/2760773/max"}, "edited": false, "score": 0, "creation_date": 1420616726, "post_id": 27806562, "comment_id": 44035889, "body": "the code is going through all items of the currently open outlook-Folder, intead of just one mail."}, {"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420622963, "post_id": 27806562, "comment_id": 44038598, "body": "The code is displaying only the selected email. The problem is that the email window is not staying activated all time, so the sendkeys act on other windows instead of the email window."}, {"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420622985, "post_id": 27806562, "comment_id": 44038615, "body": "How do I keep the email window activated, so the sendkeys act on it?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420642452, "post_id": 27820858, "comment_id": 44049878, "body": "I didn&#39;t know about HTMLBody. But how do I copy the formatted body into my Excel sheet. If I copy the HTMLBody I only get a cell with the HTML code of the body. Instead, I need a sheet with the formatted text of the mail (with tables, hyperlinks, etc.)."}, {"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "reply_to_user": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "edited": false, "score": 0, "creation_date": 1420642807, "post_id": 27820858, "comment_id": 44050110, "body": "@user3254924 Please post a new question for that. We will be happy to assist."}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1420638241, "creation_date": 1420638241, "answer_id": 27820858, "question_id": 27806562, "link": "https://stackoverflow.com/questions/27806562/vba-select-text-from-mail-body/27820858#27820858", "title": "VBA select text from mail body", "body": "<p>You can access the mailbody through the MailItem.Body (plain text) or MailItem.HTMLBody (HTML) properties. No need to use SendKeys:</p>\n\n<pre><code>Sub getMailtext()\n\n    Dim objOutlook As Outlook.Application\n    Dim objInspector As Outlook.Inspector\n\n    Dim strDateTime As String\n\n    ' Instantiate an Outlook Application object.\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n\n    ' The ActiveInspector is the currently open item.\n    Set objExplorer = objOutlook.ActiveExplorer\n\n    ' Check and see if anything is open.\n    If Not objExplorer Is Nothing Then\n        ' Get the current item.\n        Dim arySelection As Object\n        Set arySelection = objExplorer.Selection\n\n        For x = 1 To arySelection.Count\n            Dim m As MailItem\n            Set m = arySelection.Item(x)\n\n            Debug.Print m.Body\n            Debug.Print m.HTMLBody\n\n        Next x\n\n    Else\n        ' Show error message with only the OK button.\n        MsgBox \"No explorer is open\", vbOKOnly\n    End If\n\n    ' Set all objects equal to Nothing to destroy them and\n    ' release the memory and resources they take.\n    Set objOutlook = Nothing\n    Set objExplorer = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1420724901, "creation_date": 1420724901, "answer_id": 27841655, "question_id": 27806562, "link": "https://stackoverflow.com/questions/27806562/vba-select-text-from-mail-body/27841655#27841655", "title": "VBA select text from mail body", "body": "<p>Outlook uses Word as an email editor. You can use the Word object model for making manipulatins on the message body. The WordEditor property of the Inspector class returns an instance of the Document class (from the Word object model) which represents the body. You can read more about that way and all possible ways in the <a href=\"http://msdn.microsoft.com/en-us/library/dd492012.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. </p>\n"}], "owner": {"reputation": 83, "user_id": 3254924, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41229b66f142f6efa09b6c10ff7620f4?s=128&d=identicon&r=PG&f=1", "display_name": "user3254924", "link": "https://stackoverflow.com/users/3254924/user3254924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593474989, "creation_date": 1420575587, "last_edit_date": 1593474989, "question_id": 27806562, "link": "https://stackoverflow.com/questions/27806562/vba-select-text-from-mail-body", "title": "VBA select text from mail body", "body": "<p>I want to copy the entire body of an email message.\nI used this code (wich I found somewhere and modified myself) and it works from time to time.\nThe problem is that the mail window is not activated each time => the code selects other things from the active winwow.\nHow can I get it right?</p>\n\n<p>I tried <code>AppActivate (\"Microsoft Outlook\")</code> but it doesn't work.</p>\n\n<pre><code>Private Sub copymail()\n\n    Dim objOutlook As Outlook.Application\n    Dim objInspector As Outlook.Inspector\n\n    Dim strDateTime As String\n\n    ' Instantiate an Outlook Application object.\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n\n    ' The ActiveInspector is the currently open item.\n    Set objExplorer = objOutlook.ActiveExplorer\n\n    ' Check and see if anything is open.\n    If Not objExplorer Is Nothing Then\n        ' Get the current item.\n        Dim arySelection As Object\n        Set arySelection = objExplorer.Selection\n\n        For x = 1 To arySelection.Count\n            Dim m As MailItem\n            Set m = arySelection.Item(x)\n            m.Display\n            'DoEvents\n            'DoEvents\n            Application.Wait (Now + #12:00:02 AM#)\n            'AppActivate (\"Microsoft Outlook\")\n            SendKeys (\"^a^c\")\n            DoEvents\n            Application.Wait (Now + #12:00:01 AM#)\n\n        Next x\n\n    Else\n        ' Show error message with only the OK button.\n        MsgBox \"No explorer is open\", vbOKOnly\n    End If\n\n    ' Set all objects equal to Nothing to destroy them and\n    ' release the memory and resources they take.\n    Set objOutlook = Nothing\n    Set objExplorer = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup", "array-formulas"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1420571971, "post_id": 27805497, "comment_id": 44020159, "body": "What about <code>&quot;=INDEX(Database!A:KG,MATCH(1,(Database!A:A=&#39;TempSheet&#39;!A2)*&zwnj;&#8203;(Database!G:G=&#39;TempS&zwnj;&#8203;heet&#39;!G2),0),10)&quot;</code>?"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1420571979, "post_id": 27805497, "comment_id": 44020162, "body": "Please show your actual code in the question, formatted with the code viewer."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1420572033, "post_id": 27805497, "comment_id": 44020204, "body": "You need to escape the double-quotes inside a literal string... Also, you can&#39;t use Variable names like <code>DB</code> inside a literal string."}, {"owner": {"reputation": 1874, "user_id": 3761815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Zrlop.png?s=128&g=1", "display_name": "Rusan Kax", "link": "https://stackoverflow.com/users/3761815/rusan-kax"}, "edited": false, "score": 0, "creation_date": 1420583230, "post_id": 27805497, "comment_id": 44025618, "body": "If you cannot get a complicated expression to work, try building up to it using smaller components of the expression. For instance, try getting the <code>Match</code> expression to work, followed by <code>Index</code> - separately. You need to use either <code>Application.Worksheetfunction.</code> or <code>Evaluate</code> - and you can check the syntax here <a href=\"http://msdn.microsoft.com/en-us/library/office/ff835873%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> (with example)."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4425295, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5lWvw-mNP1M/AAAAAAAAAAI/AAAAAAAABpE/yQz1DvzFgEI/photo.jpg?sz=128", "display_name": "Lucas Guido", "link": "https://stackoverflow.com/users/4425295/lucas-guido"}, "is_accepted": false, "score": 0, "last_activity_date": 1420573769, "creation_date": 1420573769, "answer_id": 27806114, "question_id": 27805497, "link": "https://stackoverflow.com/questions/27805497/convert-excel-array-formula-vba/27806114#27806114", "title": "Convert Excel array formula VBA", "body": "<p>Every time you use a spreadsheet formula inside a VBA code, you need to precede it with &lt;<em>Excel.WorksheetFunction.</em>> or &lt;<em>Application.WorksheetFunction.</em>>.</p>\n\n<p>For example:</p>\n\n<p><code>Application.WorksheetFunction.Match</code></p>\n\n<p>instead of Match only.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 1959776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59af5dba5dadbdfc7b0cf992f150d4e4?s=128&d=identicon&r=PG", "display_name": "Casey Morter", "link": "https://stackoverflow.com/users/1959776/casey-morter"}, "is_accepted": false, "score": 0, "last_activity_date": 1420576521, "creation_date": 1420576521, "answer_id": 27806739, "question_id": 27805497, "link": "https://stackoverflow.com/questions/27805497/convert-excel-array-formula-vba/27806739#27806739", "title": "Convert Excel array formula VBA", "body": "<p>I have had little luck getting array formulas to work correctly via VBA, and use the 'IFERROR' as a workaround like so:</p>\n\n<pre><code>=IFERROR(VLOOKUP(A1, Database!A:Z,1,FALSE),VLOOKUP(B1, Database!A:Z,1,FALSE))\n</code></pre>\n\n<p>This function will attempt to match A1, and in case of a #VALUE error, it will match B1.</p>\n\n<p>To get this kind of formula populated on a sheet in VBA, you can loop down your sheet using the '.formula' approach.</p>\n\n<pre><code>' get length of source data\nDim RowCount As Long\nRowCount = ThisWorkbook.Sheets(\"Database\").Cells(Rows.Count, 1).End(xlUp).Row\n' now starting from row 2 to preserve headings\nFor i = 2 To RowCount\n    ThisWorkbook.Sheets(\"Summary\").Cells(i, 1).Formula = \"=IF(ISERROR(SEARCH(\"\"ISO\"\",V\" &amp; i &amp; \")),\"\"Order type not supported\"\",\"\"Transit\"\")\"\n    ThisWorkbook.Sheets(\"Summary\").Cells(i, 6).Formula = \"=IFERROR(TEXT(VLOOKUP(B\" &amp; i &amp; \",Database!A:N,7,FALSE),\"\"dd-mmm-yyyy HH:MM AM/PM\"\"),\"\"\"\")\"\nNext\n</code></pre>\n\n<p>Not exactly what you were after, but hope it helps!</p>\n"}], "owner": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420576521, "creation_date": 1420571376, "last_edit_date": 1531164843, "question_id": 27805497, "link": "https://stackoverflow.com/questions/27805497/convert-excel-array-formula-vba", "title": "Convert Excel array formula VBA", "body": "<p>I'm trying to do \"vlookup\" with 2 different criteria(Column A and G values) using \"Index\" and \"Match\" functions.</p>\n\n<p>and here is the line i used for the Excel command.</p>\n\n<pre><code>=INDEX(Database!A:KG,MATCH(1,(Database!A:A='TempSheet'!A2)*(Database!G:G='TempSheet'!G2),0),10)\n</code></pre>\n\n<p>How would I do it with VBA? It's keep giving me the error message \"Compile error: Expected end of statement\".</p>\n\n<pre><code>Selection= _\n    \"=Index(DB.Range(\"A:KG\"), Match(1, (DB.Range(\"A\" = Temp.Range(\"A\" &amp; i).Value)) * (DB.Range(\"G\" = Temp.Range(\"G\" &amp; i).Value)), 0), 10)\"\n</code></pre>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1420572417, "post_id": 27805332, "comment_id": 44020395, "body": "If you were to do this by hand, would you apply a Filter to column L to only show &quot;Yes&quot; entries then copy the results to the &quot;data&quot; sheet?"}], "answers": [{"comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1420572478, "post_id": 27805736, "comment_id": 44020423, "body": "Couldn&#39;t you get the last row used instead of hardcoding the 3800?  And wouldn&#39;t it be better to get rid of those <code>Select</code>s?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1420572550, "post_id": 27805736, "comment_id": 44020446, "body": "@chancea right for both, but I assumed the user didn&#39;t want to touch his code but just know how to re-use it through the lines. Happy to accept your edit, if you propose it!"}, {"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420573144, "post_id": 27805736, "comment_id": 44020773, "body": "@MatteoNNZ thanks very much for your answer and assistance. The proposed edit doesn&#39;t seem to work. It copies line 9 again but nothing underneath. If you guys prefer changing my proposal (e.g. getting the last row), I&#39;d be happy to take this as well, it probably will be a more intelligent solution than the one initially created."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1420573293, "post_id": 27805736, "comment_id": 44020847, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">DON&#39;T USE <code>SELECT</code></a>"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420573763, "post_id": 27805736, "comment_id": 44021113, "body": "This answer looked correct to me so I did not answer. I observed that a variable named <code>copytorow</code> is DIM&#39;ed, but <code>LCopyToRow</code> is used. Could there be an issue with these getting mixed up?"}, {"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420574000, "post_id": 27805736, "comment_id": 44021246, "body": "@laylarenee indeed lcopyrow is used but I had changed this already before my comment in the code so that wasn&#39;t the issue (edited this in the original question now as well)."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1420574195, "post_id": 27805736, "comment_id": 44021356, "body": "Is Cell <code>L10</code> equals to &quot;yes&quot;? (If it is not, then row 10 would not be copied)"}, {"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420575056, "post_id": 27805736, "comment_id": 44021787, "body": "I doesn&#39;t equal &quot;yes&quot;. L 13 is the next that does."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 1, "creation_date": 1420575418, "post_id": 27805736, "comment_id": 44021970, "body": "@simon, it was a stupid mistake i did. The variable LCopyToRow was inside the loop so it was being initialized each time. Try it now, it should be better."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 2, "last_activity_date": 1420646200, "last_edit_date": 1420646200, "creation_date": 1420572316, "answer_id": 27805736, "question_id": 27805332, "link": "https://stackoverflow.com/questions/27805332/continue-code-in-next-line/27805736#27805736", "title": "continue code in next line", "body": "<p>Please correct me if I misunderstood your question, but I think you only need to index the row number in your definitions: </p>\n\n<pre><code>Dim r1 As Range, r2 As Range, multiAreaRange As Range, copytorow As Long\nWorksheets(\"data\").Activate\n\nLCopyToRow = 2\n\nFor j = 9 To 3800 'repeat this 3791 times, or use Range(\"c9\").End(xlDown).Row to get the last line as suggested by chancea (definitely more flexible)\n\n    Set r1 = Range(\"c\" &amp; j &amp; \":i\" &amp; j)\n    Set r2 = Range(\"m\" &amp; j &amp; \":af\" &amp; j)\n    Set multiAreaRange = Union(r1, r2)\n\n    If Range(\"L\" &amp; j).Value = \"yes\" Then\n\n        multiAreaRange.Select \n        Selection.Copy\n        Sheets(\"drop\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        LCopyToRow = LCopyToRow + 1\n\n        Sheets(\"data\").Select\n\n    End If\n\nNext j\n</code></pre>\n\n<p>The above is the same code you had before, but instead of running on line 9 only it's running from line 9 to line 3800 (custom your values as you prefer, of course). Please note I'm assuming the previous code is working fine for line 9, so it is applicable to all the other lines. </p>\n\n<p><strong>EDIT suggested by chancea:</strong> </p>\n\n<p>You don't need to select ranges and sheets everytime, it would just make a big useless mess if run over 3800 lines because you would see the screen continuously jumping from one place to the other. But I don't touch the code, I let you update as you prefer. </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420575252, "post_id": 27806068, "comment_id": 44021884, "body": "Thanks for your elaborate comment and explanation. I am just trying to work in your changes. I am getting an error message (syntax error) for the last part: multiAreaRange.Copy(Sheets(&quot;drop&quot;).Rows(CStr(lcopytorow) &amp; &quot;:&quot; &amp; CStr(lcopytorow))   I am sure I&#39;m missing something obvious here..."}, {"owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "reply_to_user": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420575516, "post_id": 27806068, "comment_id": 44022027, "body": "Try <code>multiAreaRange.copy destination:=Sheets(&quot;drop&quot;).Rows(CStr(LCopyToRow) &amp; &quot;:&quot; &amp; CStr(LCopyToRow))</code>. I generally have better luck with stating things explicitly, than hoping VBA understands its own rules"}, {"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420576860, "post_id": 27806068, "comment_id": 44022563, "body": "The first answer suggested above works but you have a point with speeding it up and preventing the workbook from flipping. Still doesn&#39;t seem to work with the last change for me however..."}, {"owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "reply_to_user": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420584873, "post_id": 27806068, "comment_id": 44026294, "body": "I have edited the original answer to include a sample sub which is working for me."}, {"owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "edited": false, "score": 0, "creation_date": 1420619151, "post_id": 27806068, "comment_id": 44036714, "body": "Tried your edit for my sample file and it works now indeed. Great to have the workbook not flipping anymore. Thanks very much for your help!"}], "tags": [], "owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "is_accepted": true, "score": 0, "last_activity_date": 1420646725, "last_edit_date": 1420646725, "creation_date": 1420573613, "answer_id": 27806068, "question_id": 27805332, "link": "https://stackoverflow.com/questions/27805332/continue-code-in-next-line/27806068#27806068", "title": "continue code in next line", "body": "<p>You are on the right track, you simply need to generalize the example you provided through the use of a for loop and a variable.</p>\n\n<p>For loops basically work like this</p>\n\n<pre><code>For [some variable] = [starting number] to [ending number]\n    [Run some code while variable equals current value]\nNext\n</code></pre>\n\n<p>Essentially you will want to wrap your entire code inside a for loop so that it can evaluate each row, one-by-one. The only thing you want outside the loop are your <code>Dim</code> declarations and <code>LCopyToRow = 2</code> so that they do not reset on each iteration of the loop.</p>\n\n<p>You can set variables by saying something like <code>Dim i as Long</code>. It appears you want to start your for loop by setting <code>i = 9</code> for the 9th row and looping through to your last row of the original sheet. If the row will be constant you can simply set it to that value, but if it changes making a \"lastrow\" variable would be a good idea.</p>\n\n<p>For example, the first line within your for loop would be: <code>Set r1 = Sheets(\"data\").Range(\"c\" &amp; i &amp; \":i\" &amp; i)</code>, and then you would follow a similar format while placing the variable into your other statements.</p>\n\n<p>One other thing I would recommend is declare your sheet in front of your range, as I did in the example above, and then drop the select statements from the code. This can help speed up your code it, keep it cleaner, and help prevent errors. Also it will stop the workbook from flipping back and forth between sheets, which can be annoying if you are watching the process run.</p>\n\n<p>For example, instead of:</p>\n\n<pre><code>multiAreaRange.Select\nSelection.Copy\nSheets(\"drop\").Select\nRows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\nActiveSheet.Paste\n</code></pre>\n\n<p>You could simply say something like:</p>\n\n<pre><code>multiAreaRange.copy destination:=Sheets(\"drop\").Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow))\n</code></pre>\n\n<p>Edit: I have this working for me in a sample workbook:</p>\n\n<pre><code>Sub test()\n    Dim r1 As Range, _\n    r2 As Range, _\n    multiAreaRange As Range, _\n    lcopytorow As Long, _\n    i As Long\n\n    lcopytorow = 2\n\n    For i = 9 To 100\n        Set r1 = Sheets(\"data\").Range(\"c\" &amp; i &amp; \":i\" &amp; i)\n        Set r2 = Sheets(\"data\").Range(\"m\" &amp; i &amp; \":af\" &amp; i)\n        Set multiAreaRange = Union(r1, r2)\n\n        If Sheets(\"data\").Range(\"L\" &amp; i).Value = \"yes\" Then\n\n            multiAreaRange.Copy Destination:=Sheets(\"drop\").Rows(lcopytorow &amp; \":\" &amp; lcopytorow)\n\n            lcopytorow = lcopytorow + 1\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4423179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbed07ac11fed140be7800795ef3fc65?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4423179/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 27806068, "answer_count": 2, "score": 0, "last_activity_date": 1420646725, "creation_date": 1420570861, "last_edit_date": 1420573925, "question_id": 27805332, "link": "https://stackoverflow.com/questions/27805332/continue-code-in-next-line", "title": "continue code in next line", "body": "<p>I have the following code:</p>\n\n<pre><code>Sub rangeSelect()\n\n    Dim r1 As Range, r2 As Range, multiAreaRange As Range, lcopytorow As Long\n    Worksheets(\"data\").Activate\n    Set r1 = Range(\"c9:i9\")\n    Set r2 = Range(\"m9:af9\")\n    Set multiAreaRange = Union(r1, r2)\n\n    LCopyToRow = 2\n\n    If Range(\"L9\").Value = \"yes\" Then\n\n        multiAreaRange.Select\n        Selection.Copy\n        Sheets(\"drop\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        LCopyToRow = LCopyToRow + 1\n\n        Sheets(\"data\").Select\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>my purpose is to copy the selected ranges into another worksheet called \"drop\" only if there is \"yes\" in each corresponding L column. The code works fine for the first item in the table. However, I would need to duplicate it for the whole table (some 3800 rows). I want to avoid copying the entire row but rather only copy the defined ranges as stated above. I assume I would have to define a loop through which the code can jump along,but I am not sure how to do it. Hope my explanation makes sense, new to vba but learning quickly. Any help would be highly appreciated. Thanks guys. </p>\n"}, {"tags": ["c#", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 5, "last_activity_date": 1420656013, "last_edit_date": 1420656013, "creation_date": 1420568826, "answer_id": 27804808, "question_id": 27804620, "link": "https://stackoverflow.com/questions/27804620/how-to-load-vba-macros-to-the-excel-file-from-a-text-file-by-a-c-code/27804808#27804808", "title": "How to load vba macros to the excel file from a text file by a C# code?", "body": "<p>You'll need a reference to <code>Microsoft.Vbe.Interop;</code>.</p>\n\n<p>Then you need to get a handle on the module you want to insert into. \nThen you can just use the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff821352(v=office.15).aspx\" rel=\"nofollow\">CodeModule.AddFromFile method</a> to insert the code in your text file into the module.</p>\n\n<pre><code>VBE.VBProjects(\"NameOfProject\").VBComponents.Item(\"NameOfWorksheet\").CodeModule.AddFromFile(\"C:\\Path\\to\\file.txt\");\n</code></pre>\n\n<p>The default name for a newly created project is <code>\"VBAProject\"</code> and you the name of the component for a sheet is the name of the sheet. </p>\n\n<p>So, for your particular case, you could add this line of code at the end of your snippet to insert the VBA into Sheet1. </p>\n\n<pre><code>application.VBE.VBProjects(\"VBAProject\").VBComponents.Item(\"Sheet1\").CodeModule.AddFromFile(\"C:\\VBA_MACROS\\VBA1.txt\");\n</code></pre>\n\n<p>I just learned that another option is to use the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.vbproject.aspx\" rel=\"nofollow\">VBProject property of the Workbook</a>, which makes the call a little cleaner. </p>\n\n<pre><code>workbook.VBProject.VBComponents.Item(\"Sheet1\").CodeModule.AddFromFile(\"C:\\VBA_MACROS\\VBA1.txt\");\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4322375, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2aa1ea4c6053758a69783d120e9557b1?s=128&d=identicon&r=PG&f=1", "display_name": "Evgraph", "link": "https://stackoverflow.com/users/4322375/evgraph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1423172848, "creation_date": 1420568110, "last_edit_date": 1423172848, "question_id": 27804620, "link": "https://stackoverflow.com/questions/27804620/how-to-load-vba-macros-to-the-excel-file-from-a-text-file-by-a-c-code", "title": "How to load vba macros to the excel file from a text file by a C# code?", "body": "<p>My C# code has to create an Excel file with two Worksheets and output some data over there. Besides data columns, the Sheet 1 has to be enabled with a VBA macros which would allow a user to perform some mathematical calculations with provided data upon clicking on a particular cell. This VBA macros are stored in a text file, like <code>C:\\VBA_MACROS\\VBA1.txt.</code></p>\n\n<p>Right now I can do it manually, i.e. </p>\n\n<ol>\n<li>C# code creates an Excel file and populates it with data.</li>\n<li>I do a right click on Sheet1 and select an option \"View Code\". </li>\n<li>I click on the button \"Insert\" from the Microsoft Visual Basic for Applications Menu and load the file <code>C:\\VBA_MACROS\\VBA1.txt</code>. </li>\n<li>I close the VBA code window.</li>\n</ol>\n\n<p>Question: can steps 2 - 4 be performed automatically by a C# code as well as the step 1? In this case a user would not have to perform them manually which would be a way more comfortable for her.</p>\n\n<p>To be exact, this is how the application is created:</p>\n\n<pre><code>Excel.Application application = new Excel.Application();\nExcel.Workbook workbook = application.Workbooks.Add();\nExcel.Worksheet worksheet = workbook.Sheets[1];\nExcel.Worksheet worksheet2 = workbook.Sheets[2];\n\n// output data to the worksheets\nDataTable2Worksheet(tableMain, worksheet, verSize);\nDataTable2Worksheet(tableExtra, worksheet2, 0);\n\n// output workbook to the file\nstring fileDir = @\"D:\\MyTests\\ExcelTests\\\";\nOutput2File(fileDir, workbook);\n</code></pre>\n\n<p><code>DataTable2Worksheet</code> and <code>Output2File</code> functions are quite trivial, but how to attach the content of the text file to <code>worksheet = workbook.Sheets[1]</code> by using <code>AddFromFile</code> method?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 1, "creation_date": 1420565752, "post_id": 27803975, "comment_id": 44016994, "body": "Try Dim dbCon As New ADODB.Connection"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1420565808, "post_id": 27803975, "comment_id": 44017026, "body": "Will also want to do a similar thing for the recordset"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 3233451, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/583ad6f21809315e3c0d2461b150fd4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3233451", "link": "https://stackoverflow.com/users/3233451/user3233451"}, "edited": false, "score": 0, "creation_date": 1420566514, "post_id": 27804133, "comment_id": 44017433, "body": "Thanks silentsurfer !"}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1420566074, "creation_date": 1420566074, "answer_id": 27804133, "question_id": 27803975, "link": "https://stackoverflow.com/questions/27803975/vba-error-while-running-stored-proc-run-time-error-91-object-variable-or-with/27804133#27804133", "title": "VBA Error while running Stored Proc - run time error 91 object variable or with block not set", "body": "<p>You need to instantiate your Connection object. </p>\n\n<p>Use either:</p>\n\n<pre><code>Dim dbCon As New ADODB.Connection\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim dbCon As ADODB.Connection\nSet dbCon = New ADODB.Connection\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 3233451, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/583ad6f21809315e3c0d2461b150fd4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3233451", "link": "https://stackoverflow.com/users/3233451/user3233451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 27804133, "answer_count": 1, "score": 0, "last_activity_date": 1420566074, "creation_date": 1420565419, "last_edit_date": 1531164843, "question_id": 27803975, "link": "https://stackoverflow.com/questions/27803975/vba-error-while-running-stored-proc-run-time-error-91-object-variable-or-with", "title": "VBA Error while running Stored Proc - run time error 91 object variable or with block not set", "body": "<p>I am new to VBA and trying to call a sybase ASE stored proc and get the result set back, this is what i am doing. While running i am getting error \"run time error 91 object variable or with block not set\" at line opening the connection (dbCon.Open connectionString), can anyone please provide some pointers ?</p>\n\n<pre><code>Sub GetEmployees()\n    Dim dbCon As ADODB.Connection\n    Dim rstTemp As New ADODB.Recordset\n    Dim query As String\n    Dim connectionString As String\n    query = \"exec sp\"\n    connectionString = \"Driver=Sybase.ASEOLEDBProvider;Server Name=serverName,port;\n    Initial Catalog=DBname;User id=user;Password=pass;\"\n    dbCon.Open connectionString\n    dbCon.CommandTimeout = 600\n    rstTemp.Open query, dbCon, adOpenForwardOnly\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "spreadsheet", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1420564087, "post_id": 27803565, "comment_id": 44016121, "body": "This doesn&#39;t appear to be a programming question to me. It&#39;s more to do with formulas/filters."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4424754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BpnVh.jpg?s=128&g=1", "display_name": "NowHearThis", "link": "https://stackoverflow.com/users/4424754/nowhearthis"}, "edited": false, "score": 1, "creation_date": 1420568718, "post_id": 27803627, "comment_id": 44018611, "body": "That is just what I needed. Thank you."}], "tags": [], "owner": {"reputation": 15580, "user_id": 2431885, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/1LBbl.png?s=128&g=1", "display_name": "Jean-Paul", "link": "https://stackoverflow.com/users/2431885/jean-paul"}, "is_accepted": true, "score": 0, "last_activity_date": 1420564921, "last_edit_date": 1420564921, "creation_date": 1420564068, "answer_id": 27803627, "question_id": 27803565, "link": "https://stackoverflow.com/questions/27803565/ms-excel-how-to-sum-one-column-based-on-criteria-for-other-columns/27803627#27803627", "title": "MS Excel: how to sum one column based on criteria for other columns", "body": "<p>You are looking for <a href=\"https://support.office.com/en-ie/article/Sum-values-based-on-multiple-conditions-e610ae0f-4d27-480c-9119-eb644f1e847e\" rel=\"nofollow noreferrer\">SUMIFS</a> together with a normal <code>SUM</code>:</p>\n\n<p>What you wanted:</p>\n\n<pre><code>=SUM(SUMIFS(B1:B6, C1:C6,{\"Open\", \"Complete\"},D1:D6,{\"Jan\", \"Feb\"}))\n</code></pre>\n\n<p>The way this works is as follows:</p>\n\n<p><code>SUMIF([summing range], [range 1], [condition 1], [range 2], [condition 2], ..)</code></p>\n\n<p>Where </p>\n\n<ul>\n<li><code>[summing range]</code> is the range to sum over</li>\n<li><code>[range 1]</code> is the range of the first filter</li>\n<li><code>[condition 1]</code> is the condition of the first filter</li>\n<li><code>[range 2]</code> is the range of the second filter</li>\n<li><code>[condition 2]</code> is the condition of the second filter</li>\n<li>etc.</li>\n</ul>\n\n<p>We then need to use <code>SUM()</code> because <code>SUMIFS</code> will output an array (due to the multiple string conditions).</p>\n\n<p>See the result below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RgPYX.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 13, "user_id": 4424754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BpnVh.jpg?s=128&g=1", "display_name": "NowHearThis", "link": "https://stackoverflow.com/users/4424754/nowhearthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "accepted_answer_id": 27803627, "answer_count": 1, "score": -1, "last_activity_date": 1606750789, "creation_date": 1420563876, "last_edit_date": 1531161705, "question_id": 27803565, "link": "https://stackoverflow.com/questions/27803565/ms-excel-how-to-sum-one-column-based-on-criteria-for-other-columns", "title": "MS Excel: how to sum one column based on criteria for other columns", "body": "<p>Running into a bit of an problem in that I can't find any function that will let me add multiple criteria to a formula to filter on.  In SQL I would put what I'm looking for in the where clause, but I can't seem to replicate that type of functionality in Excel</p>\n\n<p>Columns:</p>\n\n<pre><code>A       B       C          D\n-------------------------------\nJim     1000    Open       Jan\n\nBill    1200    Won        Feb\n\nSuzy    1500    Complete   Mar\n\nJane    2000    Complete   Feb\n</code></pre>\n\n<p>I'm looking for a Formula that will let me say: </p>\n\n<hr>\n\n<p>Sum values in Column B if Column C contains 'Open' or 'Complete' <em>and if</em> Column D contains 'Jan' and 'Feb'</p>\n\n<hr>\n\n<p>Ideally I'd like to be able to even add a 3rd or a 4th column (in Columns E &amp; F) that I could further filter the results.  Any ideas?</p>\n"}, {"tags": ["excel", "vba", "extract", "formula"], "comments": [{"owner": {"reputation": 23, "user_id": 4424568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PtGg4.jpg?s=128&g=1", "display_name": "Nox", "link": "https://stackoverflow.com/users/4424568/nox"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1420564929, "post_id": 27803560, "comment_id": 44016590, "body": "I&#39;m aware of the Text to Columns function but it would be inconvenient. Addresses are still being added to the spreadsheet and they need to be processed automatically. In case someone wonders, the reason behind the addresses being added into the comments is to have some kind of formatting like you would have in a Word document, because every address is formatted differently according to the postal regulations of the addressee&#39;s country."}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420564887, "post_id": 27803742, "comment_id": 44016570, "body": "Interesting method for achieving this. How did you ever come up with this?"}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1420566240, "post_id": 27803742, "comment_id": 44017267, "body": "Well, yes, he copy &amp; pasted it from another answer he gave. I&#39;d like to know where he got the idea from originally. It&#39;s an odd solution."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1420567691, "post_id": 27803742, "comment_id": 44018041, "body": "@KevenDenen..............I did not develop this formula........if I can retrieve the &quot;source&quot; I will update my Answer."}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 1, "creation_date": 1420569634, "post_id": 27803742, "comment_id": 44019060, "body": "That is a fascinating formula for extracting data."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1465245089, "last_edit_date": 1465245089, "creation_date": 1420564498, "answer_id": 27803742, "question_id": 27803560, "link": "https://stackoverflow.com/questions/27803560/excel-formula-to-extract-a-string-of-text-delimited-by-markers-from-cells/27803742#27803742", "title": "Excel: Formula to extract a string of text delimited by markers from cells", "body": "<p>With comma separated data in <strong>A1,</strong> in <strong>B1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,\",\",REPT(\" \",999)),COLUMNS($A:A)*999-998,999))\n</code></pre>\n\n<p>and copy across.  For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/P0No8.png\" alt=\"enter image description here\"></p>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p>Why not use <em>TextToColumns</em> ?</p>\n\n<ul>\n<li>The row of formulas re-calculates automatically if <strong>A1</strong> changes.</li>\n<li>The row of formulas will work even if <strong>A1</strong>, itself, contains a formula.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": true, "score": 1, "last_activity_date": 1420565171, "creation_date": 1420565171, "answer_id": 27803912, "question_id": 27803560, "link": "https://stackoverflow.com/questions/27803560/excel-formula-to-extract-a-string-of-text-delimited-by-markers-from-cells/27803912#27803912", "title": "Excel: Formula to extract a string of text delimited by markers from cells", "body": "<p>If you are wanting to do this programmatically instead of using a built-in, check out the split function for chopping up your comma separated string. It will split up your input string into an array. Then you can do whatever you like with the array.</p>\n\n<pre><code> Dim Names() As String\n\n Names() = Split(inputValue, \",\")\n For i = 0 To UBound(Names)\n    ' do what you want with each piece\n Next\n</code></pre>\n\n<p>Gary's Student's answer is great for using the built-in functions.</p>\n"}, {"tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1420565212, "creation_date": 1420565212, "answer_id": 27803924, "question_id": 27803560, "link": "https://stackoverflow.com/questions/27803560/excel-formula-to-extract-a-string-of-text-delimited-by-markers-from-cells/27803924#27803924", "title": "Excel: Formula to extract a string of text delimited by markers from cells", "body": "<p>If you want a VBA solution: </p>\n\n<pre><code>Sub spitString()\n\n    Dim sourceRange As Range\n    Dim stringArr() As String\n    Dim i As Integer\n\n\n    Set sourceRange = ActiveSheet.Range(\"A1\")\n    stringArr = Split(sourceRange.Value, \",\")\n\n    For i = LBound(stringArr) To UBound(stringArr)\n        sourceRange.Offset(0, i + 1).Value = stringArr(i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1420565632, "creation_date": 1420565632, "answer_id": 27804030, "question_id": 27803560, "link": "https://stackoverflow.com/questions/27803560/excel-formula-to-extract-a-string-of-text-delimited-by-markers-from-cells/27804030#27804030", "title": "Excel: Formula to extract a string of text delimited by markers from cells", "body": "<p>You could avoid adding comments: Are you aware that users can add line breaks inside a cell by pressing ALT+RETURN?</p>\n\n<p>If having high rows d is a problem and you don't like that  formatting,  an alternative approach might be to write a simple bit of code that changes the height of the current row when a user clicks in a certain range. It would , make other rows less high. Perhaps. </p>\n\n<p>Just a thought.  It has benefits keeping it simple. </p>\n\n<p>Harvey. </p>\n"}], "owner": {"reputation": 23, "user_id": 4424568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PtGg4.jpg?s=128&g=1", "display_name": "Nox", "link": "https://stackoverflow.com/users/4424568/nox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13173, "favorite_count": 0, "accepted_answer_id": 27803912, "answer_count": 4, "score": 2, "last_activity_date": 1465245089, "creation_date": 1420563865, "question_id": 27803560, "link": "https://stackoverflow.com/questions/27803560/excel-formula-to-extract-a-string-of-text-delimited-by-markers-from-cells", "title": "Excel: Formula to extract a string of text delimited by markers from cells", "body": "<p>I'm messing with a spreadsheet containing postal addresses that have been inserted in the cells' comments\nEach comment contain an address composed of a variable number of lines (damn UK addresses, they can have up to 7 lines!) in the following format:</p>\n\n<pre><code>Line1,\nLine2,\nLine3,\n[...],\nState\n</code></pre>\n\n<p>With my poor skills, I've managed to extract the comment with a VBA script, obtaining the following string on a single cell:</p>\n\n<pre><code>Line1,Line2,Line3,[...],State\n</code></pre>\n\n<p>At this point each string between commas must be extracted to its own cell.\nI've managed to extract the 1st 3 lines with the following formulas:</p>\n\n<p>For Line1:</p>\n\n<pre><code>=LEFT(A8;(SEARCH(\",\";A8))-1)\n</code></pre>\n\n<p>For Line2:</p>\n\n<pre><code>=MID(A8; SEARCH(\",\";A8)+1; SEARCH(\",\"; A8; SEARCH(\",\"; A8)+1)-SEARCH(\",\";A8)-1)\n</code></pre>\n\n<p>For Line3:</p>\n\n<pre><code>=MID(A8; SEARCH(\",\";A8;SEARCH(\",\";A8;SEARCH(\",\";A8;SEARCH(\",\";A8)))+1)+1;SEARCH(\",\"; A8; SEARCH(\",\"; A8;SEARCH(\",\";A8)+1)+1)-SEARCH(\",\";A8;SEARCH(\",\";A8)+1)-1)\n</code></pre>\n\n<p>From this point I start to get overflow errors from my brain... I probably need some days of sleep.</p>\n\n<p>Can anybody help me to get to \"line6\", and finally suggest me how to pull out the \"State line\" which ends without comma?</p>\n\n<p>I thought I could pull out the \"State\" line with =RIGHT(\",\";SEARCH(\",\";A8)-1) but I'm obviously doing something wrong because that pulls out a comma instead of a string.</p>\n\n<p>I guess I could do everything with a VBA script, but I'm not that skilled yet :(</p>\n"}, {"tags": ["excel", "automation", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1420563639, "post_id": 27803463, "comment_id": 44015879, "body": "For/Each loop. Show us your function, please?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 3723502, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1334040008/picture?type=large", "display_name": "user3723502", "link": "https://stackoverflow.com/users/3723502/user3723502"}, "edited": false, "score": 0, "creation_date": 1420565724, "post_id": 27803647, "comment_id": 44016981, "body": "tried this, getting error: &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;  FYI macro name is: RDB_Worksheet_Or_Worksheets_To_PDF_And_Create_Mail"}, {"owner": {"reputation": 7, "user_id": 3723502, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1334040008/picture?type=large", "display_name": "user3723502", "link": "https://stackoverflow.com/users/3723502/user3723502"}, "edited": false, "score": 0, "creation_date": 1420566093, "post_id": 27803647, "comment_id": 44017184, "body": "got it to work with this:  <code>Sub RunAll()  Dim SHt As Worksheet For Each SHt In ThisWorkbook.Worksheets SHt.Activate  Call RDB_Worksheet_Or_Worksheets_To_PDF_And_Create_Mail  Next SHt End Sub</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1420564132, "creation_date": 1420564132, "answer_id": 27803647, "question_id": 27803463, "link": "https://stackoverflow.com/questions/27803463/programming-a-macro-to-run-other-macros-on-each-worksheet/27803647#27803647", "title": "Programming a macro to run other macros on each worksheet", "body": "<p>Say there is a macro in each worksheet called <strong>SheetMac.</strong>  Put the following in a standard module and run it:</p>\n\n<pre><code>Sub MASTER()\nFor Each sh In Sheets\n    sh.Activate\n    Call sh.SheetMac\nNext sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3723502, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1334040008/picture?type=large", "display_name": "user3723502", "link": "https://stackoverflow.com/users/3723502/user3723502"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 27803647, "answer_count": 1, "score": 0, "last_activity_date": 1424227324, "creation_date": 1420563516, "last_edit_date": 1531164843, "question_id": 27803463, "link": "https://stackoverflow.com/questions/27803463/programming-a-macro-to-run-other-macros-on-each-worksheet", "title": "Programming a macro to run other macros on each worksheet", "body": "<p>I have an excel workbook with many different sheets. Each sheet has a single macro in it wich saves the sheet as a pdf and opens outlook with that pdf as an attachment. I am looking for a function to place on one worksheet that will run each macro without having to manually run each on their respective worksheets.</p>\n"}]