[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489015665, "post_id": 42683835, "comment_id": 72491821, "body": "Have you looked at an If statement with multiple conditions?  Something like IF AND(crit1, crit2, crit3) THEN would allow you to put each of the three criteria you specify in your question (Is it possible to search for matching county and then city (for all cities not LA), as well as for Los Angeles (city) and then zip code? County is column &quot;I&quot;, City is column &quot;G&quot;, and Zip is column &quot;H&quot;. So &quot;Andrew&quot; would have within LA county cities of Alhambra, Arcadia, etc. and also LA (city) zip codes of 90004, 90006, etc.).  Your criteria could use MATCH() or FIND(), even."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489016982, "post_id": 42683835, "comment_id": 72492284, "body": "I&#39;m fairly new to coding (the code posted above is a modification of code Jeeped posted for me in another question. He recommended that since this question is quite a bit different than that one, I should start a new question.   Which is to say: I&#39;d love to use an If statement for these criteria, but I don&#39;t know the syntax to use, or how/where to insert it into my existing code."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489073120, "post_id": 42683835, "comment_id": 72520145, "body": "So, I&#39;ve looked at the test doc and I&#39;m a little a little taken asunder.  If I can follow this... you want your sheet &quot;Los Angeles&quot; as a reference sheet to create an if-statement and move rows from the sheet &quot;List&quot; to the individual named sheets?"}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489075285, "post_id": 42683835, "comment_id": 72521809, "body": "Yes, that&#39;s exactly what I want it to do."}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489078789, "post_id": 42701156, "comment_id": 72524416, "body": "I was going to use AND() for the conditions, but making the matches verify the same row seemed more efficient, since there can be duplicate zips/cities."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489078858, "post_id": 42701156, "comment_id": 72524470, "body": "PS I hope the walk-though of why/how I ordered things helps you in the long run.  Only did that as you mentioned you were new to VBA coding."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1489078657, "creation_date": 1489078657, "answer_id": 42701156, "question_id": 42683835, "link": "https://stackoverflow.com/questions/42683835/copy-rows-with-multiple-sub-criteria/42701156#42701156", "title": "Copy rows with multiple sub criteria", "body": "<p>So, I'm going to try to give one example for this (Thomas).  Note that I am looking at the city/zip only, as the county should be inclusive of these two unique values; some cities can share the same zip.</p>\n\n<p>The overall process I intend to follow is:</p>\n\n<p>.1)  Remember the range on the reference sheet (I do this so I can set my matches up correctly)</p>\n\n<pre><code>Sheets(\"Los Angeles\").Range(\"W4:W15\") 'City\nSheets(\"Los Angeles\").Range(\"X4:X15\") 'Zip\n</code></pre>\n\n<p>.2)  Remember the range on the List sheet</p>\n\n<pre><code>Sheets(\"List\").Range(\"G6:G338\") 'City\nSheets(\"List\").Range(\"H6:H338\") 'Zip\n</code></pre>\n\n<p>.3)  Set-up a loop for sorting through Thomas' references</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 15 to 4\n</code></pre>\n\n<p>.4)  Within the loop, create another loop to search the values on the List</p>\n\n<pre><code>Dim j As Integer\n\nFor j = 6 to 338\n</code></pre>\n\n<p>.5)  Use an If-statement to check the condition</p>\n\n<pre><code>If Match(Sheets(\"Los Angeles\").Range(\"W\"&amp;j),Sheets(\"List\").Range(\"G\"&amp;i))=Match(Sheets(\"Los Angeles\").Range(\"X\"&amp;j),Sheets(\"List\").Range(\"H\"&amp;i)) Then\n</code></pre>\n\n<p>.6)  If conditions are met, then we will cut and paste the row to the appropriate sheet</p>\n\n<pre><code>Sheets(\"List\").Row(j).Copy Sheets(\"Thomas\").Row(j)\n</code></pre>\n\n<p>.7)  Close the If-statement</p>\n\n<pre><code>End If\n</code></pre>\n\n<p>.8)  Go to the next j in the loop</p>\n\n<pre><code>Next j\n</code></pre>\n\n<p>.9)  Go to the next i in the loop</p>\n\n<pre><code>Next i\n</code></pre>\n\n<p>.10)  Filter Thomas' sheet by Zip code (should remove all empty rows)</p>\n\n<pre><code>Sheets(\"Thomas\").Range(\"A1:I338\").Sort key1:=Range(\"H1:H338\"), order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>With this one example, you should be able to set-up each other person's sheets!</p>\n\n<p>Altogether, it looks like (there may be better ways, but this was the easiest of the Match() things I could think of, which in my head seemed easier than the Find() alternative):</p>\n\n<pre><code>Dim i As Integer\nDim j As Integer\n\nFor i = 15 to 4\n    For j = 6 to 338\n\n        If Match(Sheets(\"Los Angeles\").Range(\"W\"&amp;j),Sheets(\"List\").Range(\"G\"&amp;i))=Match(Sheets(\"Los Angeles\").Range(\"X\"&amp;j),Sheets(\"List\").Range(\"H\"&amp;i)) Then\n            Sheets(\"List\").Row(j).Copy Sheets(\"Thomas\").Row(j)\n        End If\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489104927, "creation_date": 1489015379, "last_edit_date": 1489104927, "question_id": 42683835, "link": "https://stackoverflow.com/questions/42683835/copy-rows-with-multiple-sub-criteria", "title": "Copy rows with multiple sub criteria", "body": "<p>I'm working on a macro that will search a List sheet for different counties and then paste the entire row onto the current sheet. I have a worksheet for each person (named Mark, John, etc.) and each person is assigned several counties. Mark has three counties, listed in cells J1:L1, which I've named as a range (MyCounties). My macro looks through Sheet \"List\" column \"I\" for each of those counties and copy the entire row onto Sheet \"Mark\" starting at \"A4\". The macro that I have works very well for that. </p>\n\n<p>For larger areas like Los Angeles County though, it gets split up between 6 people, who each take different cities within that county, and within the city of LA itself, take different zip codes. Is it possible to search for matching county and then city (for all cities not LA), as well as for Los Angeles (city) and then zip code? County is column \"I\", City is column \"G\", and Zip is column \"H\". So \"Andrew\" would have within LA county cities of Alhambra, Arcadia, etc. and also LA (city) zip codes of 90004, 90006, etc. I know that the macro posted below won't work for this, but is there a way to edit it to make it do what I want? I have a helper sheet (\"Los Angeles\") that shows persons name (Peter) in A1:D1 (Merged Cells), B3 and down are Counties to filter by, C3 and down are cities to filter by, and D3 and down are zip codes to filter by. Then we skip a column, and F1:I1 is next person. </p>\n\n<p>I have a test document that I'll attach as soon as I figure out how to do that. \n<a href=\"https://www.dropbox.com/s/umnh61z47ijtho9/Test%20Doc.xlsm?dl=0\" rel=\"nofollow noreferrer\">test doc</a></p>\n\n<pre><code>Sub MoreReports()\n    Dim w As Long, cVar As Variant, zVar As Variant, rw As Long, sDoc As Worksheet, tDoc As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set sDoc = Sheets(\"List\")\n    Set tDoc = Sheets(\"Peter\")\n    Set cVar = Sheets(\"Los Angeles\").Range(\"C3:C52\")\n    Set zVar = Sheets(\"Los Angeles\").Range(\"d3:d52\")\n\n\n         With sDoc\n            If .AutoFilterMode Then .AutoFilterMode = False\n            With .Range(.Cells(4, \"G\"), .Cells(.Rows.Count, \"I\").End(xlUp))\n                .AutoFilter field:=3, Criteria1:=\"Los Angeles\", Operator:=xlAnd\n                .AutoFilter field:=1, Criteria1:=cVar, Operator:=xlFilterValues\n                .AutoFilter field:=1, Criteria1:=\"Los Angeles\", Operator:=xlAnd\n                .AutoFilter field:=2, Criteria1:=zVar, Operator:=xlFilterValues\n                .AutoFilter field:=3, Criteria1:=\"Ventura\", Operator:=xlFilterValues                    \n                With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        .Cells.EntireRow.Copy Destination:=tDoc.Cells(rw, \"A\")\n                    End If\n                End With\n            End With\n            If .AutoFilterMode Then .AutoFilterMode = False\n        End With\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "filter", "ms-access-2016", "continuous-forms"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489014033, "post_id": 42683548, "comment_id": 72491210, "body": "you need the word AND in also i believe."}, {"owner": {"reputation": 95, "user_id": 4095574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-efFWX7ljwxo/AAAAAAAAAAI/AAAAAAAAA3s/E6gcX4jJipo/photo.jpg?sz=128", "display_name": "Matthew Kelsay", "link": "https://stackoverflow.com/users/4095574/matthew-kelsay"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489014619, "post_id": 42683548, "comment_id": 72491407, "body": "@Nathan_Sav AND instead of &amp; or  &amp; AND &amp;?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4095574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-efFWX7ljwxo/AAAAAAAAAAI/AAAAAAAAA3s/E6gcX4jJipo/photo.jpg?sz=128", "display_name": "Matthew Kelsay", "link": "https://stackoverflow.com/users/4095574/matthew-kelsay"}, "edited": false, "score": 0, "creation_date": 1489016740, "post_id": 42683803, "comment_id": 72492194, "body": "This works great however, if I leave any one of the boxes empty I still get the Invalid use of Null. Is there a way I can only call certain addToFilter based on if the box is empty or not"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 95, "user_id": 4095574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-efFWX7ljwxo/AAAAAAAAAAI/AAAAAAAAA3s/E6gcX4jJipo/photo.jpg?sz=128", "display_name": "Matthew Kelsay", "link": "https://stackoverflow.com/users/4095574/matthew-kelsay"}, "edited": false, "score": 0, "creation_date": 1489017867, "post_id": 42683803, "comment_id": 72492572, "body": "@MatthewKelsay please try this edit. I now pass the object texbox to the routine and check there if it is null... The problem is that in access vba an empty texbox does not yield an empty string but a null variant. Now the routine deals correctly with that..."}, {"owner": {"reputation": 95, "user_id": 4095574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-efFWX7ljwxo/AAAAAAAAAAI/AAAAAAAAA3s/E6gcX4jJipo/photo.jpg?sz=128", "display_name": "Matthew Kelsay", "link": "https://stackoverflow.com/users/4095574/matthew-kelsay"}, "edited": false, "score": 0, "creation_date": 1489018734, "post_id": 42683803, "comment_id": 72492844, "body": "that works beautifully! Thank you for that and the information about the textbox as well, was not aware of that."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1489017783, "last_edit_date": 1489017783, "creation_date": 1489015201, "answer_id": 42683803, "question_id": 42683548, "link": "https://stackoverflow.com/questions/42683548/vba-filter-contious-form-multple-textboxes/42683803#42683803", "title": "VBA Filter Contious Form - Multple Textboxes", "body": "<p>You are missing the <code>AND</code> in the query. But you also need to check if the textbox is empty before adding it to the filter. I suggest to do this with two subs.</p>\n\n<p>The first one <code>addToFilter</code> manipulates the control and adds it to the filter if it is not empty, and it adds the <code>AND</code> only if necessary. This approach simplifies the code as it factorizes some of the common string manipulations.</p>\n\n<pre><code>Sub addToFilter(ByRef sFilter As String, ctrl As Object, fieldName As String)\n    If IsNull(ctrl.Value) Then Exit Sub\n    If Len(Trim(ctrl.Value)) = 0 Then Exit Sub\n    If Len(sFilter) &lt;&gt; 0 Then sFilter = sFilter &amp; \" AND \"\n    sFilter = sFilter &amp; fieldName &amp; \" Like '*\" &amp; Replace(Trim(ctrl.Value), \"'\", \"''\") &amp; \"*'\"\nEnd Sub\n\nPrivate Sub bttnSearch_Click()\n    Dim strFilter As String\n    addToFilter strFilter, Me.tbLastNameFilter, \"LastName\"\n    addToFilter strFilter, Me.tbFirstNameFilter, \"FirstName\"\n    addToFilter strFilter, Me.tbCompanyFilter, \"Company\"\n\n    If Len(strFilter) = 0 Then\n        MsgBox (\"No Search Information Entered\")\n        Me.FilterOn = False\n    Else\n        Me.filter = strFilter\n        Me.FilterOn = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4095574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-efFWX7ljwxo/AAAAAAAAAAI/AAAAAAAAA3s/E6gcX4jJipo/photo.jpg?sz=128", "display_name": "Matthew Kelsay", "link": "https://stackoverflow.com/users/4095574/matthew-kelsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 42683803, "answer_count": 1, "score": 0, "last_activity_date": 1593956507, "creation_date": 1489013856, "last_edit_date": 1593956507, "question_id": 42683548, "link": "https://stackoverflow.com/questions/42683548/vba-filter-contious-form-multple-textboxes", "title": "VBA Filter Contious Form - Multple Textboxes", "body": "<p>I am trying to create a filter that uses 3 textboxes (tbLastNameFilter, tbFirstNameFilter, and tbCompanyFilter. I have successfully managed to get it to work with one. However, I am not sure how I would go about getting it to work in unison with the other two. I have tried couple of ways.</p>\n\n<pre><code>Private Sub bttnSearch_Click()\nDim strFilter As String\n\nIf IsNull(Me.tbLastNameFilter &amp; Me.tbFirstNameFilter &amp; Me.tbCompanyFilter) Then\n MsgBox (\"No Search Information Entered\")\n Me.FilterOn = False\nElse\n strFilter = \"LastName Like '*\" &amp; Replace(Me.tbLastNameFilter, \"'\", \"''\") &amp; \"*'\"\n Me.Filter = strFilter\n Me.FilterOn = True\nEnd If\n</code></pre>\n\n<p>I have tried changing the strFilter to </p>\n\n<pre><code>strFilter = \"LastName Like '*\" &amp; Replace(Me.tbLastNameFilter, \"'\", \"''\") &amp; \"*'\" &amp; _\n\"FirstName Like '*\" &amp; Replace(Me.tbFirstNameFilter, \"'\", \"''\") &amp; \"*'\" &amp; _\n\"Company Like '*\" &amp; Replace(Me.tbCompanyFilter, \"'\", \"''\") &amp; \"*'\"\n</code></pre>\n\n<p>If I leave any one of the boxes blank I get an invalid use of null and if I put letter into each I get Syntax error (missing operator).</p>\n\n<p>I would like to be able to enter anything into one or all of the boxes, click search and see matched criteria. </p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "sql-server-2012", "ms-access-2010"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489013345, "post_id": 42683395, "comment_id": 72490916, "body": "What line does the error occur on?"}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489013425, "post_id": 42683395, "comment_id": 72490952, "body": "@Nick.McDermaid I&#39;m not sure what you mean; it&#39;s not a compile error so it doesn&#39;t show what line it&#39;s screwing up."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 8949, "user_id": 3270427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8nv26.jpg?s=128&g=1", "display_name": "McNets", "link": "https://stackoverflow.com/users/3270427/mcnets"}, "edited": false, "score": 0, "creation_date": 1489013480, "post_id": 42683395, "comment_id": 72490980, "body": "@McNets that&#39;s not valid vba and won&#39;t do anything"}, {"owner": {"reputation": 8949, "user_id": 3270427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8nv26.jpg?s=128&g=1", "display_name": "McNets", "link": "https://stackoverflow.com/users/3270427/mcnets"}, "edited": false, "score": 0, "creation_date": 1489013533, "post_id": 42683395, "comment_id": 72491000, "body": "Yes, sorry, I&#39;ve misread it."}, {"owner": {"reputation": 8949, "user_id": 3270427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8nv26.jpg?s=128&g=1", "display_name": "McNets", "link": "https://stackoverflow.com/users/3270427/mcnets"}, "edited": false, "score": 0, "creation_date": 1489013605, "post_id": 42683395, "comment_id": 72491028, "body": "Is Me.M_RN a Variant?"}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 8949, "user_id": 3270427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8nv26.jpg?s=128&g=1", "display_name": "McNets", "link": "https://stackoverflow.com/users/3270427/mcnets"}, "edited": false, "score": 0, "creation_date": 1489013645, "post_id": 42683395, "comment_id": 72491041, "body": "@McNets no, it&#39;s not"}, {"owner": {"reputation": 8949, "user_id": 3270427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8nv26.jpg?s=128&g=1", "display_name": "McNets", "link": "https://stackoverflow.com/users/3270427/mcnets"}, "edited": false, "score": 1, "creation_date": 1489013667, "post_id": 42683395, "comment_id": 72491047, "body": "Have you tried with IsEmpty()?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489013668, "post_id": 42683395, "comment_id": 72491048, "body": "It&#39;s a while since I&#39;ve done MS Access VBA but... if it&#39;s a runtime error then it must break on the line that&#39;s causing the error. Or is it just somewhere in the automatic binding between the form and the table? Are you assigning the field value to a variable somewhere or is the form just directly bound to a table?"}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489013729, "post_id": 42683395, "comment_id": 72491075, "body": "@Nick.McDermaid I&#39;m not assigning it to a variable, it&#39;s directly bound to the table (well, the query from the table)"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489014259, "post_id": 42683395, "comment_id": 72491285, "body": "Sounds frustrating! I came across two things in my google searches: 1. Can it be handed in the Form_Error event? 2. Is there formatting on the field confusing things? Also does this source query come from one table or many tables?"}, {"owner": {"reputation": 362, "user_id": 6591527, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rhIHjmWgstQ/AAAAAAAAAAI/AAAAAAAAAQw/ZyFmiscBeRQ/photo.jpg?sz=128", "display_name": "Will Jobs", "link": "https://stackoverflow.com/users/6591527/will-jobs"}, "edited": false, "score": 0, "creation_date": 1489015006, "post_id": 42683395, "comment_id": 72491569, "body": "What is the field type of M_RN in SQL Server? What does it show in MS Access is the field type?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1489015074, "post_id": 42683395, "comment_id": 72491592, "body": "Is the non-working variable bound to an identity field in the database?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1489015139, "post_id": 42683395, "comment_id": 72491617, "body": "Can you print out <code>TypeName(Me.M_RN)</code> and let us know what it says?"}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1489017879, "post_id": 42683395, "comment_id": 72492577, "body": "Maybe the field is set to not allow null values?"}, {"owner": {"reputation": 1356, "user_id": 989516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9950f13477753d04f4f6e8b83ea84d25?s=128&d=identicon&r=PG", "display_name": "Kevin Collins", "link": "https://stackoverflow.com/users/989516/kevin-collins"}, "edited": false, "score": 0, "creation_date": 1489019287, "post_id": 42683395, "comment_id": 72493008, "body": "If I remember correctly isnull(vbnull) will return False. Try: if Me.M_RN &amp; &quot;&quot; = &quot;&quot; then  MsgBox &quot;null!&quot; Else     MsgBox &quot;Not null!&quot; End If"}], "answers": [{"comments": [{"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1489081454, "post_id": 42693729, "comment_id": 72526134, "body": "Yes, the server bounces an error back on nulls, but it&#39;s a confusing error that can freeze Access if a non-technical user doesn&#39;t know how to deal with it properly. Hence preventing the null from going to the server in the first place."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 1, "last_activity_date": 1489057593, "creation_date": 1489057593, "answer_id": 42693729, "question_id": 42683395, "link": "https://stackoverflow.com/questions/42683395/isnull-always-returns-false/42693729#42693729", "title": "IsNull always returns false", "body": "<p>I think this part of your information is critical; </p>\n\n<blockquote>\n  <p>the non-working variable is in int format and has a <strong>unique index.</strong></p>\n</blockquote>\n\n<p>If it has a unique index then I'm pretty sure you won't be able to assign a null value anyway. Do you have a default value set in the table? </p>\n"}, {"tags": [], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "is_accepted": true, "score": 0, "last_activity_date": 1489086449, "creation_date": 1489086449, "answer_id": 42703511, "question_id": 42683395, "link": "https://stackoverflow.com/questions/42683395/isnull-always-returns-false/42703511#42703511", "title": "IsNull always returns false", "body": "<p>The issue was based on the <code>not null</code> setting on the SQL back end table.  Access was checking the validation rule it derived from that restriction <em>immediately before</em> the <code>BeforeUpdate</code> event. </p>\n\n<p>It was then popping the <code>You tried to assign the Null value to a variable that is not a Variant data type</code> error, which apparently prevents the <code>BeforeUpdate</code> event from firing at all.</p>\n\n<p>Removing the <code>not null</code> restriction allowed the code to function, while retaining the unique index.</p>\n\n<p>Using <code>Form_Error</code> couldn't work around it, even with <code>Response</code> set to<code>acDataErrContinue</code>.  In that case it would pop an actual runtime error about validation rules preventing changing the value on the line trying to set the field back to <code>.OldValue</code>.</p>\n"}], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 42703511, "answer_count": 2, "score": 0, "last_activity_date": 1489086449, "creation_date": 1489013175, "question_id": 42683395, "link": "https://stackoverflow.com/questions/42683395/isnull-always-returns-false", "title": "IsNull always returns false", "body": "<p>I'm using MS Access as a front-end for SQL Server 2012, testing for null values in a field before passing the update to the server, and displaying a helpful message to the user.</p>\n\n<p>I have it working fine for one field, using <code>If IsNull</code> in the <code>BeforeUpdate</code> event, along with some fancy duplicate checking.  However, when implementing the same code for another variable, <code>IsNull</code> is always evaluating to false.</p>\n\n<p>I've tried stripping out all the useful code and just using <code>IsNull</code> with a message box:</p>\n\n<pre><code>If IsNull(Me.M_RN) Then\n    MsgBox \"null!\"\nElse\n    MsgBox \"Not null!\"\nEnd If\n</code></pre>\n\n<p>This code always returns \"Not null!\".  If I reverse it and use :</p>\n\n<pre><code>If not IsNull(Me.M_RN) Then\n    MsgBox \"Not null!\"\nElse\n    MsgBox \"null!\"\nEnd If\n</code></pre>\n\n<p>It still returns \"Not null!\" every time.  I also tried other Event states e.g. <code>Change</code>, <code>KeyUp</code>, and <code>Dirty</code>.  No matter the Event, <code>IsNull</code> comes back false.</p>\n\n<p>The Form objects for these fields have identical properties.  The only differences I can see are that the working variable is in <code>numeric(18,0)</code> format and not indexed, while the non-working variable is in <code>int</code> format and has a unique index.</p>\n\n<p>If I remove all the code I get the <code>You tried to assign the Null value to a variable that is not a Variant data type</code> error on update.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9, "user_id": 7680969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d2945a7b573939fa83fe8bf5861c09?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/7680969/wombat"}, "edited": false, "score": 0, "creation_date": 1489022258, "post_id": 42682907, "comment_id": 72493798, "body": "Thanks a million! Just put it to work."}], "answers": [{"comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1489013987, "post_id": 42683166, "comment_id": 72491186, "body": "Should the 20-Oct entry be converted to 10-20 instead of 20-10 and the 6-Apr entry to 4-6 instead of 6-4? From the question it sounds like Month-Day is required rather than Day-Month"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1489014538, "last_edit_date": 1489014538, "creation_date": 1489012299, "answer_id": 42683166, "question_id": 42682907, "link": "https://stackoverflow.com/questions/42682907/excel-vba-data-cleaning-date-to-string/42683166#42683166", "title": "Excel VBA- Data Cleaning- Date to string", "body": "<p>Select the cells you wish to convert and run this short macro:</p>\n\n<pre><code>Sub fixdata()\n    Dim v As Variant\n\n    For Each r In Intersect(ActiveSheet.UsedRange, Selection)\n        v = r.Value\n        If v &lt;&gt; \"\" And IsDate(v) Then\n            r.Value = \"'\" &amp; Day(v) &amp; \"-\" &amp; Month(v)\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WgndG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WgndG.png\" alt=\"enter image description here\"></a></p>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BjHAj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BjHAj.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Correction:</p>\n\n<pre><code>Sub fixdata()\n    Dim v As Variant\n\n    For Each r In Intersect(ActiveSheet.UsedRange, Selection)\n        v = r.Value\n        If v &lt;&gt; \"\" And IsDate(v) Then\n            r.Value = \"'\" &amp; Month(v) &amp; \"-\" &amp; Day(v)\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7680969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d2945a7b573939fa83fe8bf5861c09?s=128&d=identicon&r=PG&f=1", "display_name": "Wombat", "link": "https://stackoverflow.com/users/7680969/wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489014538, "creation_date": 1489011216, "last_edit_date": 1531164843, "question_id": 42682907, "link": "https://stackoverflow.com/questions/42682907/excel-vba-data-cleaning-date-to-string", "title": "Excel VBA- Data Cleaning- Date to string", "body": "<p>I need to clean data tables to eventually create Bracket placements for NCAA Men's Basketball.  Unfortunately some of the data that I was given has transformed the record (i.e 10-20) to 20 Oct, whereas most other records remain in Win-Loss format (i.e. 20-10).  Could anyone offer any suggestions on how to transform the date formats (20 Oct) back to the intended win-loss format (10-20) for the worksheet on VBA?</p>\n\n<p>Any help would be greatly appreciated as I am new to this and must use VBA for this problem set.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7680632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad1e96b38bae23bf87b01847e810aca?s=128&d=identicon&r=PG&f=1", "display_name": "sloshake", "link": "https://stackoverflow.com/users/7680632/sloshake"}, "edited": false, "score": 0, "creation_date": 1489076113, "post_id": 42691476, "comment_id": 72522448, "body": "This was a simplified version of my final table. There will be 30+ formulas. Which I could still make as a case statement but putting into a table feels a lot cleaner and easier to maintain. There is no form. It&#39;s all tables, queries, VBA. The data is getting imported via an import macro and will have 100s of rows a day. I used this smaller version to cover the code I was stumped on, thinking I can take the rest from here. At this time, we have 30 different queries, then a macro that calls one after the other. Which works, but again, feels dirty."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1489052760, "last_edit_date": 1489052760, "creation_date": 1489051631, "answer_id": 42691476, "question_id": 42682437, "link": "https://stackoverflow.com/questions/42682437/update-a-ms-access-table-using-a-formula-stored-in-another-table/42691476#42691476", "title": "Update a MS Access table using a formula stored in another table", "body": "<p>Only 3 formulas? Use conditional code in the VBA. Send a card identifier to the procedure as an argument:</p>\n\n<pre><code>Sub testFormulat(strC As String)\nDim result As String\n\nSelect Case strC\n    Case \"Visa\"\n        result = Mid(Me.Data, 3, 2)\n    Case \"Mastercard\"\n        result = Left(Me.Data, 2)\n    Case \"AMEX\"\n        result = Right(Me.Data, 2)\nEnd Select\n\nCurrentDb.Execute \"Update PayerData set CheckNum = '\" &amp; result &amp; \"' WHERE ID = \" &amp; Me.ID\n\nEnd Sub\n</code></pre>\n\n<p>Where will the Data value come from? Is code behind a form? Is form bound to the table result needs to be saved in? If so, the SQL is not needed, simply:\nMe!PayerData = result</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7680632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad1e96b38bae23bf87b01847e810aca?s=128&d=identicon&r=PG&f=1", "display_name": "sloshake", "link": "https://stackoverflow.com/users/7680632/sloshake"}, "edited": false, "score": 0, "creation_date": 1489438675, "post_id": 42703409, "comment_id": 72661972, "body": "The eval function works great! Thank you! If I were to take this a step further, is there a way to make a priority order with this as well? For instance, if I also had data where Payer may be Amjet, Amway, etc and I  wanted to set a PayerFormula rule for Am*. Such that when Data.Payer = Amex to hit on that specific formula, but the other &#39;Am&#39;s to hit on Am*."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 3, "user_id": 7680632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad1e96b38bae23bf87b01847e810aca?s=128&d=identicon&r=PG&f=1", "display_name": "sloshake", "link": "https://stackoverflow.com/users/7680632/sloshake"}, "edited": false, "score": 0, "creation_date": 1489439645, "post_id": 42703409, "comment_id": 72662505, "body": "Requires complicated IIf() expression or custom VBA function. Kinda defeats purpose of table. Just how many formula variations are there?"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1489087559, "last_edit_date": 1489087559, "creation_date": 1489086040, "answer_id": 42703409, "question_id": 42682437, "link": "https://stackoverflow.com/questions/42682437/update-a-ms-access-table-using-a-formula-stored-in-another-table/42703409#42703409", "title": "Update a MS Access table using a formula stored in another table", "body": "<p>Okay, to continue with the original example of 3 formulas. Your idea to use Eval() is valid but have to concatenate the variable provided by [Data] field. Modify the formulas table to break up the function parts into separate fields.   </p>\n\n<pre><code>Payer      | Func   | Arg1 | Arg2\n-----------|---------------------\nVisa       | mid    |  3   | 2\nMastercard | left   |  2   |\nAmex       | right  |  2   |\n</code></pre>\n\n<p>Then in the query that joins tables:</p>\n\n<p>CheckNum: Eval([Func] &amp; \"('\" &amp; [Data] &amp; \"', \" &amp; [Arg1] &amp; \", \" &amp; [Arg2] &amp; \")\")</p>\n\n<p>Note the apostrophe delimiters around [Data].</p>\n\n<p>Or the args can be in one field and entered as CSV: 3, 2</p>\n\n<p>Then:</p>\n\n<p>CheckNum: Eval([Func] &amp; \"('\" &amp; [Data] &amp; \"', \" &amp; [Args] &amp; \")\")</p>\n\n<p>BTW, don't really need to save the result to table, calculate when needed.</p>\n"}], "owner": {"reputation": 3, "user_id": 7680632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad1e96b38bae23bf87b01847e810aca?s=128&d=identicon&r=PG&f=1", "display_name": "sloshake", "link": "https://stackoverflow.com/users/7680632/sloshake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 42703409, "answer_count": 2, "score": 0, "last_activity_date": 1593956496, "creation_date": 1489009299, "last_edit_date": 1593956496, "question_id": 42682437, "link": "https://stackoverflow.com/questions/42682437/update-a-ms-access-table-using-a-formula-stored-in-another-table", "title": "Update a MS Access table using a formula stored in another table", "body": "<p>I have one table called PayerFormulas that includes a different formula for each payer. Another table is PayerData that has the payer and the data we receive. I want to populate PayerData.CheckNum using the appropriate formula stored in PayerFormulas. The CheckNum data in the table below is what I would like the result to be.</p>\n\n<p>In pseudocode it feels like this is what I'm looking for.</p>\n\n<pre><code>Update PayerData PD\ninner join PayerFormulas PF on PD.Payer = PF.Payer\nset PD.Check = PF.Formula\n</code></pre>\n\n<p>I've tried the above in a regular Access query and it doesn't work. Trying the following code only puts the formula text in the table, not the result. I've looked at using Eval() in some way, but since my result will often include text, it doesn't look like the route to go down..</p>\n\n<pre><code>Sub testFormula()\n\nDim SQLString As String\nDim ActiveQuery As QueryDef\n\nSQLString = \"Update PayerData PD inner join PayerFormulas PF on PD.Payer = PF.Payer set PD.CheckNum = PF.Formula\"\n\nSet ActiveQuery = CurrentDb.CreateQueryDef(\"\", SQLString)\nActiveQuery.Execute dbFailOnError\n\nEnd Sub\n</code></pre>\n\n<p>PayerFormulas table</p>\n\n<pre><code>Payer      | Formula\n-----------|--------\nVisa       | mid([PayerData].[Data],3,2)\nMastercard | left([PayerData].[Data],2)\nAmex       | right([PayerData].[Data],2)\n</code></pre>\n\n<p>PayerData table</p>\n\n<pre><code>Payer      |  Data  | CheckNum\n-----------|--------|---------\nVisa       | 123456 | 34\nVisa       | ABCDEF | CD\nVisa       | qwerty | er\nMastercard | 123456 | 12\nMastercard | ABCDEF | AB\nMastercard | qwerty | qw\nAmex       | 123456 | 56\nAmex       | ABCDEF | EF\nAmex       | qwerty | ty\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1489009077, "post_id": 42682317, "comment_id": 72488887, "body": "You need to qualify the <code>Range</code> call immediately after <code>Sum(</code>.  It implicitly references the <code>ActiveSheet</code> - this fails if the <code>ActiveSheet</code> isn&#39;t &quot;Resource Allocation Schedule&quot;."}, {"owner": {"reputation": 11, "user_id": 6032786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce23403782e4fca53fdf4bfa21185e2?s=128&d=identicon&r=PG&f=1", "display_name": "Flower_Dance", "link": "https://stackoverflow.com/users/6032786/flower-dance"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489009322, "post_id": 42682317, "comment_id": 72489000, "body": "I changed it to     Worksheets(&quot;Per individual Per Month&quot;).Cells(RowMark, nCol) = Application.Sum(Range(Worksheets(&quot;Resource Allocation Schedule&quot;).Cells(RowMark + 7, ColStart), Worksheets(&quot;Resource Allocation Schedule&quot;).Cells(RowMark + 7, ColEnd)))     and still does not work"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1489009452, "post_id": 42682317, "comment_id": 72489070, "body": "That&#39;s exactly what it was before.  It <i>should</i> be <code>... = Application.Sum(Worksheets(&quot;Resource Allocation Schedule&quot;).Range( ...</code>, although you should do yourself a favor and either put that in a <code>With</code> block or get a Worksheet variable for <code>Worksheets(&quot;Resource Allocation Schedule&quot;)</code>."}], "owner": {"reputation": 11, "user_id": 6032786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce23403782e4fca53fdf4bfa21185e2?s=128&d=identicon&r=PG&f=1", "display_name": "Flower_Dance", "link": "https://stackoverflow.com/users/6032786/flower-dance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489008836, "creation_date": 1489008836, "question_id": 42682317, "link": "https://stackoverflow.com/questions/42682317/vba-application-defined-or-object-defined-error", "title": "VBA &quot;Application defined or object defined error &quot;", "body": "<p>I tried to use the excel formula sum in VBA and always got this error \"Application-defined or object defined error\". I used the same one in my other module and it works.</p>\n\n<pre><code>For nCol = 4 To 15\n  Worksheets(\"Per individual Per Month\").Cells(RowMark, nCol) = Application.Sum(Range(Worksheets(\"Resource Allocation Schedule\").Cells(RowMark + 7, ColStart), Worksheets(\"Resource Allocation Schedule\").Cells(RowMark + 7, ColEnd)))\n  ColStart = ColStart + ColCount\n  ColEnd = ColEnd + ColCount\nNext nCol\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7531258, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a57b82cecca2d46dea324023bc1e05f5?s=128&d=identicon&r=PG&f=1", "display_name": "user7531258", "link": "https://stackoverflow.com/users/7531258/user7531258"}, "edited": false, "score": 0, "creation_date": 1489013018, "post_id": 42682816, "comment_id": 72490775, "body": "Hi, thanks for the code, but there&#39;s an issue I would like it to add 1 if the username is entered again, this goes up to 1 only :("}, {"owner": {"reputation": 27, "user_id": 7531258, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a57b82cecca2d46dea324023bc1e05f5?s=128&d=identicon&r=PG&f=1", "display_name": "user7531258", "link": "https://stackoverflow.com/users/7531258/user7531258"}, "edited": false, "score": 1, "creation_date": 1489013338, "post_id": 42682816, "comment_id": 72490913, "body": "Thank you for the code, I fixed the issue by doing this  Cells(i, 1).Offset(0, 1).Value =  Cells(i, 1).Offset(0, 1).Value + 1 Thanks again!"}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": 0, "last_activity_date": 1489010863, "creation_date": 1489010863, "answer_id": 42682816, "question_id": 42682255, "link": "https://stackoverflow.com/questions/42682255/formula-for-searching-a-record-if-found-it-adds-1-else-it-makes-a-new-record/42682816#42682816", "title": "Formula for searching a record if found it adds 1 else it makes a new record", "body": "<p>This is a macro that will do the same thing as a formula:</p>\n\n<p>Put this in your sheet code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$F$4\" Then 'assuming the name you are searching is in F4\n    Dim i As Integer\n    Dim check As Integer\n\n    Dim LastRow As Long\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    For i = 2 To LastRow\n        If Cells(i, 1).Value = Target.Value Then\n            Cells(i, 1).Offset(0, 1).Value = 1\n            check = 1\n        End If\n    Next i\n\n    If check &gt; 0 Then\n        Exit Sub\n    Else\n        LastRow = LastRow + 1\n        Cells(LastRow, 1).Value = Target.Value\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7531258, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a57b82cecca2d46dea324023bc1e05f5?s=128&d=identicon&r=PG&f=1", "display_name": "user7531258", "link": "https://stackoverflow.com/users/7531258/user7531258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 1, "accepted_answer_id": 42682816, "answer_count": 1, "score": 0, "last_activity_date": 1489010863, "creation_date": 1489008606, "question_id": 42682255, "link": "https://stackoverflow.com/questions/42682255/formula-for-searching-a-record-if-found-it-adds-1-else-it-makes-a-new-record", "title": "Formula for searching a record if found it adds 1 else it makes a new record", "body": "<p>I'm new to Excel, yes sorry about this but could you help me with resources that I could use to solve my problem?</p>\n\n<p>I would like a simple formula that the user would enter the Username</p>\n\n<p>The forumla searches for the Username in all the A:A cells and if it could find it, it would add 1 to the cell on the right, if not it would make a Username on the bottom open cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7wxcM.png\" rel=\"nofollow noreferrer\">example here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489008725, "post_id": 42682196, "comment_id": 72488710, "body": "Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278528.aspx\" rel=\"nofollow noreferrer\"><code>Split</code> function</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1489009135, "post_id": 42682196, "comment_id": 72488917, "body": "Why are you looping through nearly 300 cells when TexttoColumns will do all at once?"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 6744985, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02f7ee5afc2a18517035ee4e9ff92e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6744985/alan"}, "edited": false, "score": 0, "creation_date": 1489155910, "post_id": 42682511, "comment_id": 72561171, "body": "Does exactly what I need it to. Thank you!!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1489010266, "last_edit_date": 1489010266, "creation_date": 1489009593, "answer_id": 42682511, "question_id": 42682196, "link": "https://stackoverflow.com/questions/42682196/cut-a-string-based-on-a-delimiter/42682511#42682511", "title": "Cut a string based on a delimiter", "body": "<p>The TextToColumns can handle all of the nearly 3000 entries in column I and spit them out to columns AI:AK.</p>\n\n<pre><code>Sub Split_Without_Loop()\n\n  With ActiveSheet\n    .Range(.Cells(2, \"I\"), .Cells(.Rows.Count, \"I\").End(xlUp)).TextToColumns _\n          Destination:=Range(\"AI2\"), _\n          DataType:=xlDelimited, _\n          Tab:=False, _\n          Semicolon:=False, _\n          Comma:=False, _\n          Space:=False, _\n          Other:=True, _\n          OtherChar:=\"-\"\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>Some of the recorded code can be eliminated for clarity as it does not pertain to this operation.</p>\n\n<p>Your original problem was that you were looping through the cells into a range variable representing each cell but then using <code>Selection</code> to govern the TextToColumns command. There was either nothing selected or the current selected cell didn't contain hyphen and in any event, you were not changing the selection to the cell being iterated through in the loop. It probably would have worked with <code>cell.TextToColumns _</code> instead of <code>Selection.TextToColumns _</code> but the looping would have slowed it down immensely.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LqRwS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LqRwS.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 225, "user_id": 6744985, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02f7ee5afc2a18517035ee4e9ff92e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6744985/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 42682511, "answer_count": 1, "score": 2, "last_activity_date": 1489010266, "creation_date": 1489008378, "last_edit_date": 1489010043, "question_id": 42682196, "link": "https://stackoverflow.com/questions/42682196/cut-a-string-based-on-a-delimiter", "title": "Cut a string based on a delimiter", "body": "<p>I am trying to use a for each loop to iterate through a few thousand rows of data that all have this style: <code>1010-2020-3030</code></p>\n\n<p>I want to break this string apart into 3 cells using the hyphen as a delimiter. I want to put 1010 in the AI cell, 2020 in the AJ cell, and 3030 in the AK cell.</p>\n\n<p>I've searched all over Google and combined a few examples I found but I am getting an object error 1004. This is the code I have so far:</p>\n\n<pre><code>Sub Cell_Loop()\nDim cell As Range\n\n  For Each cell In ActiveSheet.Range(\"I2:I3000\")\n    Selection.TextToColumns _\n          Destination:=Range(\"AI\" &amp; cell), _           '(I'm trying to use cell as a variable to iterate through.)\n          DataType:=xlDelimited, _\n          TextQualifier:=xlDoubleQuote, _\n          ConsecutiveDelimiter:=False, _\n          Tab:=True, _\n          Semicolon:=False, _\n          Comma:=False, _\n          Space:=False, _\n          Other:=True, _\n          OtherChar:=\"-\"\n  Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone see where I'm going wrong?</p>\n"}, {"tags": ["vba", "excel", "charts", "label"], "answers": [{"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 0, "last_activity_date": 1489052157, "last_edit_date": 1489052157, "creation_date": 1489050696, "answer_id": 42691126, "question_id": 42681728, "link": "https://stackoverflow.com/questions/42681728/vba-code-to-set-labels-on-a-chart/42691126#42691126", "title": "Vba code to set labels on a Chart", "body": "<p>The default is a column chart which unfortunately doesn't have the xlLabelPositionLeft; given that you don't mention the chart type I'll assume you're dealing with a column chart.  The only valid label positions for a column chart are: xlLabelPositionOutsideEnd, xlLabelPositionInsideEnd, xlLabelPositionCenter, and xlLabelPositionInsideBase.  You can see that these are the only selections provided when you manually right click on a column chart data label and then select the 'Format Data Labels' tab.  This shows these options with a radio button adjacent to each allowing for only one of these possibilities.</p>\n\n<p>So something like the following works for me:</p>\n\n<pre><code>Sub newC()\n  Dim ch As Chart\n\n  Dim rng As Range\n  Set rng = Range(\"B65\", \"I66\")\n\n  Set ch = Charts.Add\n  ch.SetSourceData Source:=rng\n  ch.HasTitle = True\n  ch.ChartTitle.Text = \"Prova\"\n\n  Dim s As Series\n  Dim objLabels As DataLabels\n  Dim objLabel As DataLabel\n  For Each s In ch.SeriesCollection\n      s.HasDataLabels = True\n      Set objLabels = s.DataLabels\n      For Each objLabel In objLabels\n          objLabel.Position = xlLabelPositionInsideBase\n      Next objLabel\n  Next s\n\nEnd Sub\n</code></pre>\n\n<p>These label positions might not be what you hoped for.  But having said that you can adjust the margin alignment to get something close to what you want - in your case by setting the right margin label alignment to shift the label to the left.</p>\n"}], "owner": {"reputation": 25, "user_id": 6835816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4333cc21265af4594eed2af569afa47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave92", "link": "https://stackoverflow.com/users/6835816/dave92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3725, "favorite_count": 0, "accepted_answer_id": 42691126, "answer_count": 1, "score": 2, "last_activity_date": 1489052157, "creation_date": 1489006402, "last_edit_date": 1531164843, "question_id": 42681728, "link": "https://stackoverflow.com/questions/42681728/vba-code-to-set-labels-on-a-chart", "title": "Vba code to set labels on a Chart", "body": "<p>I am encountering a problem with the following code:</p>\n\n<pre><code>Sub newC()\nDim ch As Chart\nDim s As Series\nDim objLabels As DataLabels\nDim objLabel As DataLabel\n\nRange(\"B65\", \"I66\").Select\n\nSet ch = Charts.Add\n\nch.ChartTitle = \"Prova\"\nconta = 1\nFor Each s In ch.SeriesCollection\n    s.HasDataLabels = True\n    s.Points(conta).DataLabel.Position = xlLeft\n    conta = conta + 1\n\n    Set objLabels = s.DataLabels\n    For Each objLabel In objLabels\n        objLabel.Position = xlLabelPositionLeft\n    Next objLabel\nNext s\nEnd Sub\n</code></pre>\n\n<p>The problem arise when setting the label position:</p>\n\n<pre><code>objLabel.Position = xlLabelPositionLeft\n</code></pre>\n\n<p>and it says:</p>\n\n<blockquote>\n  <p>Method position of dataLabel object failed.</p>\n</blockquote>\n\n<p>Do anyone has any suggestion?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1489077994, "post_id": 42681667, "comment_id": 72523846, "body": "I have suggested an answer - could you let me know if it worked please?"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489008110, "post_id": 42681812, "comment_id": 72488391, "body": "<code>Set wb2 = &quot;data file.xlsx&quot;</code> ??"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489008280, "post_id": 42681812, "comment_id": 72488486, "body": "@A.S.H - lordy, thanks for spotting that. I looked over that several times and completely missed it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489008538, "post_id": 42681812, "comment_id": 72488608, "body": "For a while I was excited about it, like wow, is this yet another syntax I didn&#39;t know about? Tried it and was disappointed :D"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1489008754, "post_id": 42681812, "comment_id": 72488728, "body": "@A.S.H - you have to have the special setting turned on. Don&#39;t know if you know about it - I could tell you but ..."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1489079011, "post_id": 42681812, "comment_id": 72524563, "body": "This work! My code sent from running more than 50 min to running just 3 min. Thanks!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1489009169, "last_edit_date": 1489009169, "creation_date": 1489006699, "answer_id": 42681812, "question_id": 42681667, "link": "https://stackoverflow.com/questions/42681667/vba-storing-a-value-to-paste-from-a-non-active-window/42681812#42681812", "title": "vba storing a value to paste from a non active window", "body": "<p>Try this, your syntax was slightly off and I think you were referencing wrong sheets. You should turn on Option Explicit which would have alerted you to wrong variable names.</p>\n\n<pre><code>Dim wb1 As Workbook, wb2 as workbook\nDim wk1sh As Worksheet, wk2sh as worksheet, x\n\nSet wb1 = ActiveWorkbook\nSet wk1sh = wb1.Sheets(\"sheet1\")\nSet wb2 = workbooks(\"data file.xlsx\")\nSet wk2sh = wb2.Sheets(\"sheet1\")\n\n'Then I do the filter selecting wich works fine via:\n\nx= Application.WorksheetFunction.Subtotal(3,wk2sh.Range(\"A1:A100\")) \n\nwk1sh.Range(\"A1\")=x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 42681812, "answer_count": 1, "score": 0, "last_activity_date": 1489009169, "creation_date": 1489006175, "question_id": 42681667, "link": "https://stackoverflow.com/questions/42681667/vba-storing-a-value-to-paste-from-a-non-active-window", "title": "vba storing a value to paste from a non active window", "body": "<p>I have two workbooks. I've automated the code to set different filters and then measure the subtotal in wb2 then take that value and paste it into an 8x11 table in wb1, however it takes ages as I'm using. </p>\n\n<pre><code>Windows(\"wb2name\").Activate\nSheets(\"sheet2\").Select\n ' do the filtering and copy subtotal value\n Windows(\"wb1name\").Activate\n Sheets(\"sheet1\").Range(\"A1\").Paste \n</code></pre>\n\n<p>I know its better to try and not use <code>Activate</code> and <code>Select</code> so I was thinking it would be quicker if I did the code below it would work faster. The problem is it isn't storing x=subtotal properly. How do I fix this?</p>\n\n<pre><code>Dim wb1 As Workbook\nDim wb1sh As Worksheet\n\nSet wb1 = ActiveWorkbook\nSet wk1sh = wb1.Sheets(\"sheet1\")\nSet wb2 = \"data file.xlsx\"\nSet wk2sh = wb1.Sheets(\"sheet1\")\n\n'Then I do the filter selecting wich works fine via:\n\nx= wb2sh.Application.WorksheetFunction.Subtotal(3,Range(\"A1:A100\")) \n\nwb1sh.Range(\"A1\")=x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1489006234, "post_id": 42681650, "comment_id": 72487382, "body": "does this get you going in the right direction: <a href=\"http://stackoverflow.com/questions/3587662/how-do-i-sort-a-collection\" title=\"how do i sort a collection\">stackoverflow.com/questions/3587662/how-do-i-sort-a-collecti&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1489006657, "post_id": 42681650, "comment_id": 72487628, "body": "Is a Dictionary a Collection?  Maybe the other way around?  Or are they not related?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1489006810, "post_id": 42681650, "comment_id": 72487703, "body": "A dictionary is a type of collection"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489007312, "post_id": 42681650, "comment_id": 72487964, "body": "Maybe this can be of help to compare dictionaries to collections: <a href=\"http://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays\" title=\"comparison of dictionary collections and arrays\">stackoverflow.com/questions/32479842/&hellip;</a> Lists (as you might know them from java) do not exist in VBA. But it seems you are merely missing the &quot;sorting&quot; part of your dictionary before adding it to the ComboBox: <a href=\"http://stackoverflow.com/questions/14808104/sorting-a-dictionary-by-key-in-vba\" title=\"sorting a dictionary by key in vba\">stackoverflow.com/questions/14808104/&hellip;</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489008560, "post_id": 42681650, "comment_id": 72488623, "body": "I&#39;m assuming that you don&#39;t have 16,384 potential values for your <code>ComboBox</code> (if you do, that&#39;s some seriously bad UX going on). There&#39;s no reason to test the last 15,000 or so empty cells from the range <code>B:B</code> to see if you already have <code>Empty</code> in your <code>Dictionary</code> - limit your data range to the <b><i>data</i></b>."}, {"owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1489056491, "post_id": 42681650, "comment_id": 72508854, "body": "The length of the list in B:B will change in different instances on the spreadsheet. I do have a known endpoint I can look for, but how do I dynamically set that range?"}], "answers": [{"comments": [{"owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1489023836, "post_id": 42682697, "comment_id": 72494170, "body": "Does calling .NET require additional code, libraries, permissions, or compatibility problems with Windows 10, Citrix, or Office 2013?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1489038537, "post_id": 42682697, "comment_id": 72498486, "body": ".Net framework must be installed on the target system so you can use its classes. I do not understand what you mean with additional code. The code you need is shown in the example. Once you have .net framework installed, in <code>VBA</code> code you need to add a reference to the mentioned type library file from .net framework (or perhaps some other version of .net framework which is actually installed) and then you can create instances of those class.<code>SortedList</code> is marked with <code>ComVisibleAttribute</code> so it can be used via <code>COM</code> anywhere. But try it yourself on your target environment."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 4, "last_activity_date": 1549759600, "last_edit_date": 1549759600, "creation_date": 1489010368, "answer_id": 42682697, "question_id": 42681650, "link": "https://stackoverflow.com/questions/42681650/how-to-make-a-list-in-vba-not-a-dictionary/42682697#42682697", "title": "How to make a list in VBA (not a dictionary)?", "body": "<blockquote>\n  <p>I'd like to use a data structure that offers a sort function, if one exists.</p>\n</blockquote>\n\n<p>Yes exists, for example <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.sortedlist(v=vs.110).aspx\" rel=\"nofollow noreferrer\">SortedList</a> from .Net framework can be used. </p>\n\n<p><code>SortedList</code> represents a collection of key/value pairs that are sorted by the keys and are accessible by key and by index.</p>\n\n<blockquote>\n  <p>VBA code example:</p>\n</blockquote>\n\n<p><em>Add reference to <code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\mscorlib.tlb</code></em> </p>\n\n<pre><code>Sub SortedListDemo()\n    Dim sr As mscorlib.SortedList\n    Set sr = New mscorlib.SortedList\n    sr.Add \"D\", \"D\"\n    sr.Add \"B\", \"B\"\n    sr.Add \"A\", \"A\"\n    sr.Add \"C\", \"C\"\n    Dim i As Integer\n    For i = 0 To sr.Count - 1\n        Debug.Print \"Key: \" &amp; sr.GetKey(i) &amp; \", Value: \" &amp; sr.GetByIndex(i)\n    Next i\n    Set sr = Nothing\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Output</p>\n</blockquote>\n\n<pre><code>Key: A, Value: A\nKey: B, Value: B\nKey: C, Value: C\nKey: D, Value: D\n</code></pre>\n\n<p><em>Some more information e.g.</em> <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.collections.sortedlist?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">here</a>. HTH</p>\n"}], "owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549759600, "creation_date": 1489006093, "last_edit_date": 1531164843, "question_id": 42681650, "link": "https://stackoverflow.com/questions/42681650/how-to-make-a-list-in-vba-not-a-dictionary", "title": "How to make a list in VBA (not a dictionary)?", "body": "<p>I'm not that familiar with VB or VBA, though I am familiar with programming.</p>\n\n<p>I'm working with Excel 2016 and trying to populate a combobox (that lives on a user form) based on a column of cells in another worksheet.  I need to remove empty cells, duplicates, a few known values, and then sort what I wind up with.</p>\n\n<p>I had some code that mostly worked (I had everything but sort), but I didn't save it before overwriting it.  It was based on <a href=\"https://stackoverflow.com/a/28483188/2484483\">this answer</a>.  I could not figure out how to add sorting to it.  It used a dictionary and took 5 seconds to pop up a userform and populate the combobox.  There are only 1000 cells in the list, so it seems to me that a dictionary is too complex of a data structure for this project.</p>\n\n<p>I'm trying to get code from <a href=\"https://www.mrexcel.com/forum/excel-questions/217977-remove-duplicates-combo-box.html\" rel=\"nofollow noreferrer\">here</a> to work, but I can't figure out what it's doing because the variable names are so vague, and I'm not familiar with VB.</p>\n\n<p>At this point, I'm thinking I just need to do my own search and replace and sort and not rely on copypasta.  I can't seem to find if VBA has a List() object.  Everyone is talking about Arrays and Dictionaries.  I'd like to use a data structure that offers a sort function, if one exists. </p>\n\n<p>What data structure should I use for something like this?</p>\n\n<p>I have reconstructed the code that mostly works.  This is on a UserForm Initialize, if that's not obvious.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    '*Start with empty inputs\n    InitialsTextBox.Value = \"\"\n\n    MakeComboBox.Clear\n    ModelComboBox.Clear\n\n    '*Fill the Combo Boxes\n\n    Dim oDictionary As Object\n    Dim strCellContent As String\n    Dim rngComboValues As Range\n    Dim rngCell As Range\n\n    Set rngComboValues = Sheets(\"BOM\").Range(\"B:B\")\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    For Each rngCell In rngComboValues\n        strCellContent = rngCell.Value\n\n        If Not oDictionary.exists(strCellContent) Then\n            oDictionary.Add strCellContent, 0\n        End If\n    Next rngCell\n\n    For Each itm In oDictionary.keys\n        Me.MakeComboBox.AddItem itm\n    Next itm\n\n    Set oDictionary = Nothing\n    End Sub\n</code></pre>\n\n<p><strong>Edit/update</strong></p>\n\n<p>The answer below is a good one, but requires additional libraries to be installed on the machine running the VBA code.  While that may work for most cases (.NET is pretty common anyways), for this project I would strongly prefer to not have dependencies and/or leave the VBA language.  The environments where this will run may not like such a thing.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1489005641, "post_id": 42681393, "comment_id": 72487079, "body": "PERFECTO, Only one little thing I would Like to put &quot;Bottle Of Water: &quot; in the front.... is it possible"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1489006465, "last_edit_date": 1489006465, "creation_date": 1489005180, "answer_id": 42681393, "question_id": 42681290, "link": "https://stackoverflow.com/questions/42681290/vba-copy-a-specific-cell-from-a-sheet-in-an-another-cell/42681393#42681393", "title": "VBA Copy a specific Cell from a sheet in an another cell", "body": "<p>Do you mean this? Have shortened your code a little too.</p>\n\n<pre><code>Sub x()\n\nDim LRowA As String, LRowB As String\n\nWith Sheets(\"Water\")\n    .Range(\"A2:A\" &amp; .Cells(Rows.Count, 2).End(xlUp).Row).Formula = \"=SUM(D2:N2)+((COUNTIF(D2:N2,\"\"GOLD\"\")+COUNTIF(D2:N2,\"\"PLATIN\"\"))*1)+((COUNTIF(D2:N2,\"\"PLPLUS\"\")+COUNTIF(D2:N2,\"\"AMBASS\"\"))*2)\"\n    LastRow = .Range(\"A2\").End(xlDown).Row\n    .Cells(LastRow + 2, \"A\").Formula = \"=SUM(A2:A\" &amp; LastRow &amp; \")\"\n    LRowA = .Range(\"A4200\").End(xlUp).Address\n    .Range(\"A:A\").Interior.ColorIndex = xlNone\n    .Range(\"A2:\" &amp; LRowA).Interior.ColorIndex = 33\n    .Range(\"A:A\").HorizontalAlignment = xlCenter\nEnd With\n\nSheets(\"Download\").Range(\"M8\").Formula = \"=\"\"Bottle of water: \"\" &amp; SUM(Water!A2:A\" &amp; LastRow &amp; \")\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 42681393, "answer_count": 1, "score": 0, "last_activity_date": 1489006465, "creation_date": 1489004826, "question_id": 42681290, "link": "https://stackoverflow.com/questions/42681290/vba-copy-a-specific-cell-from-a-sheet-in-an-another-cell", "title": "VBA Copy a specific Cell from a sheet in an another cell", "body": "<p>Here is my case</p>\n\n<p>I have this code in my Macro : The code is Good, no need to change it.</p>\n\n<pre><code>Sheets(\"Water\").Select\nCells.Select\nRange(\"A2\").Select\nActiveCell.Formula = \"=SUM(D2:N2)+((COUNTIF(D2:N2,\"\"GOLD\"\")+COUNTIF(D2:N2,\"\"PLATIN\"\"))*1)+((COUNTIF(D2:N2,\"\"PLPLUS\"\")+COUNTIF(D2:N2,\"\"AMBASS\"\"))*2)\"\nRange(\"A2\").AutoFill Destination:=Range(\"A2:A\" &amp; Cells(Rows.Count, 2).End(xlUp).Row)\nLastRow = Range(\"A2\").End(xlDown).Row\nCells(LastRow + 2, \"A\").Formula = \"=SUM(A2:A\" &amp; LastRow &amp; \")\"\nDim LRowA As String, LRowB As String\nLRowA = [A4200].End(xlUp).Address\nRange(\"A:A\").Interior.ColorIndex = xlNone\nRange(\"A2:\" &amp; LRowA).Interior.ColorIndex = 33\nRange(\"A:A\").HorizontalAlignment = xlCenter\n</code></pre>\n\n<p>On this Code we are on Sheets \"Water\". </p>\n\n<p>I have a formula and the Result Appear here in the sheet \"Water\":</p>\n\n<pre><code> Cells(LastRow + 2, \"A\").Formula = \"=SUM(A2:A\" &amp; LastRow &amp; \")\"\n</code></pre>\n\n<p>Now I want that this result appear on Sheet \"Download\" in the cell M8.</p>\n\n<p>Is it possible.....</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "is_accepted": true, "score": 0, "last_activity_date": 1489004732, "creation_date": 1489004732, "answer_id": 42681257, "question_id": 42681256, "link": "https://stackoverflow.com/questions/42681256/format-now-to-yyyymmdd-for-date-serialization-when-exporting-a-pdf/42681257#42681257", "title": "Format Now() to yyyymmdd for date serialization when exporting a PDF", "body": "<p>The unknown function is this:</p>\n\n<pre><code>                   Format(now(), \"yyyymmdd\") \n</code></pre>\n\n<p>The finished code looks like this: </p>\n\n<pre><code>     DoCmd.OutputTo acOutputReport, _\n     \"Issue_invsnapshotR\", acFormatPDF, _\n     \"\\\\SPFS1\\Stone\\Quality\\Support Docs\\Issues\\\" &amp; _\n    [issue_id] &amp; _\n    \"\\inv_snapshot_for_issue_\" &amp; _\n    Me.issue_id &amp; _\n    \"_on_\" &amp; _\n    Format(Now(), \"yyyymmdd\") &amp; _\n    \".pdf\", _\n    False, _\n    \"\", , acExportQualityPrint\n</code></pre>\n\n<p>this function will return a string of (today being 3/8/17) 20170308. which can be used to serialize files and folders.</p>\n"}], "owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 42681257, "answer_count": 1, "score": 0, "last_activity_date": 1489004732, "creation_date": 1489004732, "question_id": 42681256, "link": "https://stackoverflow.com/questions/42681256/format-now-to-yyyymmdd-for-date-serialization-when-exporting-a-pdf", "title": "Format Now() to yyyymmdd for date serialization when exporting a PDF", "body": "<p>How do I simply format the now() function to a string to name a file that needs a date in it so I don't over write files when I export them?\nMy reason for asking is I need to export a report to a PDF and I need the name of the PDF in the file location to be:</p>\n\n<pre><code>    DoCmd.OutputTo acOutputReport, _\n     \"Issue_invsnapshotR\", acFormatPDF, _\n     \"\\\\SPFS1\\Stone\\Quality\\Support Docs\\Issues\\\" &amp; _\n    [issue_id] &amp; _\n    \"\\inv_snapshot_for_issue_\" &amp; _\n    Me.issue_id &amp; _\n    \"_on_\" &amp; _\n    ???yyyymmdd function??? &amp; _    &lt;-----unknown function here\n    \".pdf\", _\n    False, _\n    \"\", , acExportQualityPrint\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1489004531, "post_id": 42681095, "comment_id": 72486495, "body": "What&#39;s wrong with the code? Does it give an error (if so, what error, where)? Does it just not run? Does it run, but not output what you expect? ..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1489004610, "post_id": 42681095, "comment_id": 72486544, "body": "I assume &quot;Sheet 1&quot; and &quot;Sheet 2&quot; are the <b>names</b> of your worksheets, as they contain spaces.  What are the codenames of each of them (i.e. is <code>Sheet1</code> the codename of &quot;Sheet 1&quot; or of &quot;Sheet 2&quot;)?  Also, which sheet is the first one (i.e. <code>Sheets(1)</code>) and which is the second one?"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 1, "creation_date": 1489004660, "post_id": 42681095, "comment_id": 72486563, "body": "&quot;Ai&quot; doesn&#39;t look like a valid range."}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489005291, "post_id": 42681309, "comment_id": 72486914, "body": "Yes, You can replace -&gt; Range(&quot;B1&quot;).Column &lt;- with 2 I wanted to make it clear only."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489005475, "post_id": 42681309, "comment_id": 72487005, "body": "OK - I wasn&#39;t sure whether you were using that method simply because you thought it was a useful way of doing things when you were using Cells with a column of, for instance, &quot;DHA&quot; - and didn&#39;t realise that you could just use <code>&quot;DHA&quot;</code> instead of <code>2913</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489006339, "post_id": 42681309, "comment_id": 72487443, "body": "<code>Cells(5, &quot;DHA&quot;)</code> is the same as <code>Cells(5, 2913)</code> which is the same as <code>Range(&quot;DHA5&quot;)</code> - the second parameter of <code>Cells</code> can be a number or a String.  (I was using &quot;DHA&quot; as a &quot;for instance&quot;, i.e. as an example.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489012304, "post_id": 42681309, "comment_id": 72490435, "body": "Sorry - I keep forgetting that people might still be using older versions of Excel - it&#39;s valid in Excel 2007 and later.  Maximum column in Excel 2003 is column &quot;IV&quot;.  So your version might allow <code>Cells(5, &quot;IV&quot;)</code> (equivalent to <code>Cells(5, 256)</code>) but not <code>Cells(5, &quot;IW&quot;)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489012959, "post_id": 42681309, "comment_id": 72490751, "body": "(And it&#39;s possible that the ability to use a string for the column wasn&#39;t introduced at all until Excel 2007, so even <code>Cells(5, &quot;IV&quot;)</code> may not work in Excel 2003.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841096.aspx\" rel=\"nofollow noreferrer\">Excel 2007 documentation</a> states that the ColumnIndex is a Variant representing &quot;the column number of the cell you want to access, starting with either 1 or &quot;A&quot; for the first column in the range&quot;, so definitely available from 2007 onwards.)"}], "tags": [], "owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "is_accepted": false, "score": 0, "last_activity_date": 1489004874, "creation_date": 1489004874, "answer_id": 42681309, "question_id": 42681095, "link": "https://stackoverflow.com/questions/42681095/vba-coding-in-excel/42681309#42681309", "title": "VBA Coding in Excel", "body": "<p>I feel that this code is what you want.\nLet me know if it's different that what you expected. </p>\n\n<pre><code>Sub Button1_Click()\n    Dim value1 As Integer\n    Dim value2 As Integer\n    For i = 1 To 6\n        value1 = ThisWorkbook.Sheets(1).Range(\"A\" &amp; i).Value ' we can't make Range(\"Ai\").Value\n        Sheet2.Range(\"B1\").Value = value1\n        Sheet1.Cells(i, Range(\"B1\").Column).Value = Sheet2.Range(\"B3\").Value 'Cells(row, columns), that is the correct format for cells\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7680542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldWJFEzuBgU/AAAAAAAAAAI/AAAAAAAAABY/BSr4964Fk5E/photo.jpg?sz=128", "display_name": "Archa", "link": "https://stackoverflow.com/users/7680542/archa"}, "edited": false, "score": 0, "creation_date": 1489030734, "post_id": 42681314, "comment_id": 72496019, "body": "I will try the above codes.I have not named my sheets yet.Its still the default name.The error thrown is method or data memeber not found."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 7680542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldWJFEzuBgU/AAAAAAAAAAI/AAAAAAAAABY/BSr4964Fk5E/photo.jpg?sz=128", "display_name": "Archa", "link": "https://stackoverflow.com/users/7680542/archa"}, "edited": false, "score": 0, "creation_date": 1489032099, "post_id": 42681314, "comment_id": 72496365, "body": "@Archa If the sheets are still the defaults, you have (by default) named them &quot;Sheet1&quot; and &quot;Sheet2&quot; - update the code to change &quot;Sheet 1&quot; to &quot;Sheet1&quot; and &quot;Sheet 2&quot; to &quot;Sheet2&quot;."}, {"owner": {"reputation": 11, "user_id": 7680542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldWJFEzuBgU/AAAAAAAAAAI/AAAAAAAAABY/BSr4964Fk5E/photo.jpg?sz=128", "display_name": "Archa", "link": "https://stackoverflow.com/users/7680542/archa"}, "edited": false, "score": 0, "creation_date": 1489053505, "post_id": 42681314, "comment_id": 72506684, "body": "thank you so much .It worked ! can I use a while loop to stop it when cell is  blank?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 7680542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldWJFEzuBgU/AAAAAAAAAAI/AAAAAAAAABY/BSr4964Fk5E/photo.jpg?sz=128", "display_name": "Archa", "link": "https://stackoverflow.com/users/7680542/archa"}, "edited": false, "score": 0, "creation_date": 1489083966, "post_id": 42681314, "comment_id": 72527534, "body": "@Archa You can use a <code>While</code> loop, or you can modify the <code>For</code> statement to just run until the last non-empty cell.  I prefer to use <code>For</code> loops myself because they automatically increment the row number, which you have to remember to write yourself when using a <code>While</code> loop.  (I have put myself into an infinite loop so many times due to not remembering to do that!)  I updated the answer to show how to change the <code>For</code> loop to go to the last cell, with an extra test to skip any empty cells found before the last non-empty cell.  (That then allows you to have breaks in your data if you want.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1489084010, "last_edit_date": 1489084010, "creation_date": 1489004893, "answer_id": 42681314, "question_id": 42681095, "link": "https://stackoverflow.com/questions/42681095/vba-coding-in-excel/42681314#42681314", "title": "VBA Coding in Excel", "body": "<p>It sounds like you want the following code:</p>\n\n<pre><code>Sub Button1_Click()\n    Dim i As Long\n    For i = 1 To 6\n        ThisWorkbook.WorkSheets(\"Sheet 2\").Range(\"B1\").Value = ThisWorkbook.WorkSheets(\"Sheet 1\").Cells(i, \"A\").Value\n        ThisWorkbook.WorkSheets(\"Sheet 1\").Cells(i, \"B\").Value = ThisWorkbook.WorkSheets(\"Sheet 2\").Range(\"B3\").Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I've used sheet names of \"Sheet 1\" and \"Sheet 2\", as that is what you have in your question.  Those should be changed if your sheets are actually called \"Sheet1\" and \"Sheet2\".</p>\n\n<hr>\n\n<p>It's hard to know how close you were without knowing which <code>CodeName</code> your sheets were using, and which order they appeared in the workbook.  But your use of a <code>Range(\"Ai\")</code> was definitely wrong - it needs to be <code>Range(\"A\" &amp; i)</code> or <code>Cells(i, \"A\")</code> (or <code>Cells(i, 1)</code>).</p>\n\n<hr>\n\n<p>Updated to process <strong>all</strong> values in column A of worksheet \"Sheet 1\":</p>\n\n<pre><code>Sub Button1_Click()\n    Dim i As Long\n    With ThisWorkbook.WorkSheets(\"Sheet 1\")\n        For i = 1 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            'Check so that we only process non-empty cells\n            '(just in case there is an empty cell part-way through the data)\n            If Not IsEmpty(.Cells(i, \"A\").Value) Then\n                ThisWorkbook.WorkSheets(\"Sheet 2\").Range(\"B1\").Value = .Cells(i, \"A\").Value\n                .Cells(i, \"B\").Value = ThisWorkbook.WorkSheets(\"Sheet 2\").Range(\"B3\").Value\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7680542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ldWJFEzuBgU/AAAAAAAAAAI/AAAAAAAAABY/BSr4964Fk5E/photo.jpg?sz=128", "display_name": "Archa", "link": "https://stackoverflow.com/users/7680542/archa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1489084010, "creation_date": 1489004125, "last_edit_date": 1489004414, "question_id": 42681095, "link": "https://stackoverflow.com/questions/42681095/vba-coding-in-excel", "title": "VBA Coding in Excel", "body": "<p>I am very new to VBA Coding. I have <strong>two sheets</strong> in excel .</p>\n\n<p>Sheet 1 - Columns include CTC ,TCC (A1,B1)\n          Rows contain the ctc and tcc details (A2,B2)</p>\n\n<p>Sheet 2 - Rows include CTC and TCC. It's in this page that TCC Calculated.\n          B1 has CTC taken from first row of sheet1.Then calculations are done to calculate TCC in B3.</p>\n\n<p><strong>Requirement :</strong>\nFor calculating TCC ,we need to paste the first CTC in sheet 1 to sheet 2 CTC Column.The result obtained has TCC should appear on sheet 1 under TCC Column.</p>\n\n<p><strong>This is the code I tried :</strong></p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim value1 As Integer\n    Dim value2 As Integer\n\n    For i = 1 To 6\n\n        value1 = ThisWorkbook.Sheets(1).Range(\"Ai\").Value\n\n        Sheet2.Range(\"B1\") = value1\n\n        Sheet1.Cells(B, i) = ThisWorkbook.Sheets(2).Range(\"B3\").Value\n\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1489004094, "post_id": 42681025, "comment_id": 72486260, "body": "If there&#39;s a cell with the specified color, do you want to hide the row it&#39;s in, or the column (or both)?"}, {"owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1489004232, "post_id": 42681025, "comment_id": 72486329, "body": "I want to NOT hide them, if that makes sense. I want anything without the specified formatting to be hidden; but yes, both rows and columns @BruceWayne"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489005215, "post_id": 42681025, "comment_id": 72486876, "body": "I just recorded a macro filtering by color and got this: <code>ActiveSheet.ListObjects(&quot;Table1&quot;).Range.AutoFilter Field:=5, Criteria1:=RGB(255, 255, 0), Operator:=xlFilterCellColor</code> Maybe you can also record a macro and easily get the code you want?"}], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1489007525, "last_edit_date": 1489007525, "creation_date": 1489004232, "answer_id": 42681123, "question_id": 42681025, "link": "https://stackoverflow.com/questions/42681025/excel-hiding-all-rows-and-columns-that-dont-contain-coloured-cells/42681123#42681123", "title": "Excel: Hiding all rows and columns that don&#39;t contain coloured cells", "body": "<p>Here's how to hide all the row and column of a cell that is black. I'm sure you can modify to fit your need.</p>\n\n<pre><code>Sub hide_cell()\n\n    Dim Rng As Range\n    Dim MyCell As Range\n    Set Rng = Range(\"A2:d10\")\n    For Each MyCell In Rng\n        If MyCell.Interior.ColorIndex = 1 Then\n            MyCell.EntireRow.Hidden = True\n            MyCell.EntireColumn.Hidden = True\n        End If\n    Next MyCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7072499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c52ab1d4406d04f41658e8d5e1242e65?s=128&d=identicon&r=PG&f=1", "display_name": "R Mannix", "link": "https://stackoverflow.com/users/7072499/r-mannix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 42681123, "answer_count": 1, "score": 0, "last_activity_date": 1489007525, "creation_date": 1489003909, "question_id": 42681025, "link": "https://stackoverflow.com/questions/42681025/excel-hiding-all-rows-and-columns-that-dont-contain-coloured-cells", "title": "Excel: Hiding all rows and columns that don&#39;t contain coloured cells", "body": "<p>I want to create a macro that when activated, will hide all columns and rows that don't have a cell formatted to a certain colour. I adapted a similar sub for columns with content only but this is another step extra that my brain can't seem to get around this morning. For reference, this is what I used to hide all columns that did not have content:</p>\n\n<pre><code>Sub HideCols()\nDim LC As Integer, j As Integer\nDim LR As Integer, curCnt As Integer\nDim k As Integer\nDim Data As Variant\n\nApplication.ScreenUpdating = False\n\nLC = Cells(3, Columns.Count).End(xlToLeft).Column\n\nFor j = 3 To LC\n    LR = Cells(Rows.Count, j).End(xlUp).Row\n    curCnt = 0\n    Data = Range(Cells(1, 1), Cells(LR, LC))\n    For k = 1 To LR\n       If Rows(k).Hidden = False And Data(k, j) &lt;&gt; \"\" Then _\n       curCnt = curCnt + 1\n    Next k\n    Columns(j).Hidden = curCnt &lt; 2\nNext j\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1489004392, "post_id": 42680578, "comment_id": 72486416, "body": "Welcome to StackOverflow, Wilson. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. We will be waiting here for you ready to assist you finalize <b>your</b> code."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489004752, "post_id": 42680578, "comment_id": 72486619, "body": "You might want to start by recording a macro: <a href=\"https://support.office.com/en-us/article/Automate-tasks-with-the-Macro-Recorder-974ef220-f716-4e01-b015-3ea70e64937b\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> Afterwards, look at the recorded code and try to understand it. You can highlight key-words (blue words) in the code and press <code>F1</code> to get more information on them. Maybe that&#39;s already all you need: a recorded macro?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7833703, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43ae754ece67789cdc1709fbf4e8bdf1?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7833703/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491581253, "last_edit_date": 1491581253, "creation_date": 1491580605, "answer_id": 43282468, "question_id": 42680578, "link": "https://stackoverflow.com/questions/42680578/how-to-insert-a-column-to-an-existing-table-next-to-the-last-column-using-excel/43282468#43282468", "title": "How to insert a column to an existing table next to the last column using Excel VBA", "body": "<p>The application I used this for is a little different than yours, but I this this will work all the same. </p>\n\n<pre><code>Dim LastCol As String\n\nLastCol = ActiveSheet.ListObjects(\"Table1\").Range.Columns.Count\n\nColumns(LastCol - 0).EntireColumn.Insert\n\nActiveSheet.Columns(LastCol + 1).Cut\nColumns(LastCol - 0).EntireColumn.Insert\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7680340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399f258f16a24c392bc3311a88f69c42?s=128&d=identicon&r=PG&f=1", "display_name": "wilson kao", "link": "https://stackoverflow.com/users/7680340/wilson-kao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529127705, "creation_date": 1489002294, "last_edit_date": 1592644375, "question_id": 42680578, "link": "https://stackoverflow.com/questions/42680578/how-to-insert-a-column-to-an-existing-table-next-to-the-last-column-using-excel", "title": "How to insert a column to an existing table next to the last column using Excel VBA", "body": "<h3>screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/3vzhz.png\" alt=\"please see screenshot\" /></p>\n<p>Hi I am a total noob at Excel VBA but how do I insert a column to a table that sums row by row. Because new columns need to be added to the table, I want the new column to be inserted in the table, essentially expanding the table but keep the new column within the table so the last column with the sum formula can include the new column.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 7674705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Resp4.jpg?s=128&g=1", "display_name": "Chris Stewart", "link": "https://stackoverflow.com/users/7674705/chris-stewart"}, "is_accepted": false, "score": 0, "last_activity_date": 1489002837, "creation_date": 1489002837, "answer_id": 42680738, "question_id": 42680194, "link": "https://stackoverflow.com/questions/42680194/change-meeting-from-an-all-day-event-to-not-an-all-day-event/42680738#42680738", "title": "Change meeting from an all day event to not an all day event", "body": "<p>Try this </p>\n\n<pre><code>Function FindAppts(apptDate As Date, strSubject As String)\n\nDim myDate As Date\nDim myEnd As Date\nDim oCalendar As Outlook.Folder\nDim oItems As Outlook.Items\nDim oItemsInDateRange As Outlook.Items\nDim oFinalItems As Outlook.Items\nDim oAppt As Outlook.AppointmentItem\nDim strRestriction As String\n\nmyStart = apptDate\nmyEnd = DateAdd(\"d\", 30, myStart)\n\nDebug.Print \"Start:\", myStart\nDebug.Print \"End:\", myEnd\n\n'Construct filter for the next 30-day date range\nstrRestriction = \"[Start] &gt;= '\" &amp; _\nFormat$(myStart, \"mm/dd/yyyy hh:mm AMPM\") _\n&amp; \"' AND [End] &lt;= '\" &amp; _\nFormat$(myEnd, \"mm/dd/yyyy hh:mm AMPM\") &amp; \"'\"\n\n'Check the restriction string\nDebug.Print strRestriction\n\nSet oCalendar = Application.Session.GetDefaultFolder(olFolderCalendar)\nSet oItems = oCalendar.Items\noItems.IncludeRecurrences = False\noItems.Sort \"[Start]\"\n\n'Restrict the Items collection for the 30-day date range\nSet oItemsInDateRange = oItems.Restrict(strRestriction)\n\n'Construct filter for Subject containing 'team'\nConst PropTag  As String = \"http://schemas.microsoft.com/mapi/proptag/\"\nstrRestriction = \"@SQL=\" &amp; Chr(34) &amp; PropTag _\n    &amp; \"0x0037001E\" &amp; Chr(34) &amp; \" like '%' &amp; strSubject &amp; '%'\"\n\n'Restrict the last set of filtered items for the subject\nSet oFinalItems = oItemsInDateRange.Restrict(strRestriction)\n'Sort and Debug.Print final results\noFinalItems.Sort \"[Start]\"\nFor Each oAppt In oFinalItems\n    Debug.Print oAppt.Start, oAppt.Subject\n    If oAppt.Start = apptDate Then\n        oAppt.Delete\n    End If\n\nNext\nEnd Function\n</code></pre>\n\n<p>I modified this from the Office Dev Center: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff867729.aspx\" rel=\"nofollow noreferrer\">Search the Calendar for Appointments Within a Date Range that Contain a Specific Word in the Subject</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7679856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b17a64d6276e96c991f107a22d2dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/7679856/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1054, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1596527049, "creation_date": 1489001103, "last_edit_date": 1596527049, "question_id": 42680194, "link": "https://stackoverflow.com/questions/42680194/change-meeting-from-an-all-day-event-to-not-an-all-day-event", "title": "Change meeting from an all day event to not an all day event", "body": "<p>I send a meeting to two recipients and have it show up as desired.</p>\n<p>How do I find the meeting by date and time (same as when it was sent) and change it from being an all day event to not being an all day event?</p>\n<pre><code>Sub Appointment()\n\n    Dim olApt As AppointmentItem\n\n    Set olApp = Outlook.Application\n    Set olApt = olApp.CreateItem(olAppointmentItem)\n\n    With olApt\n        .Start = #3/10/2017 4:00:00 PM#\n        .End = #3/3/1017 5:00:00 PM#\n        .MeetingStatus = olMeeting\n        .AllDayEvent = True\n        .Subject = &quot;OOO - Test&quot;\n        .Body = &quot;Testing Stuff&quot;\n        .BusyStatus = olFree\n        .ReminderSet = False\n        .RequiredAttendees = &quot;Placeholder&quot; &amp; &quot;;&quot; &amp; &quot; Placeholder&quot;\n        .Save\n        .Send\n    End With \n   \n    Set olApt = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1489000908, "post_id": 42679876, "comment_id": 72484419, "body": "Does each row in <code>Timetable</code> refer to a different date? What does the formula you posted mean in relation to putting the date in <code>Timetable</code>?  It would help to see some sample data with the expected output too."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1489001341, "creation_date": 1489001341, "answer_id": 42680270, "question_id": 42679876, "link": "https://stackoverflow.com/questions/42679876/excel-2010-copying-filtered-results-to-new-sheet/42680270#42680270", "title": "Excel 2010 - Copying filtered results to new sheet", "body": "<p>In an unused cell in the Timetable worksheet, put this formula,</p>\n\n<pre><code>=IFERROR(INDEX(Pupils!A:A, AGGREGATE(15, 6, ROW(A$1:A$99)/(Pupils!B$1:B$99=Days!$C$2), ROW(1:1))), TEXT(,))\n</code></pre>\n\n<p>Fill down. Adjust the <code>$99</code> portion if you have pupils listed in the Pupils worksheet below row 99.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7680252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6518ae7038ad4434219a27af4e2179?s=128&d=identicon&r=PG&f=1", "display_name": "SamC", "link": "https://stackoverflow.com/users/7680252/samc"}, "edited": false, "score": 0, "creation_date": 1489005907, "post_id": 42680384, "comment_id": 72487213, "body": "This is the route I&#39;ve chosen.  I&#39;ve amended the code a little and output to a new sheet: <code>code</code>Sub run_me()  Dim i As Integer Dim LR As Long  LR = Sheets(&quot;Pupils&quot;).Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row  Sheets(&quot;Pupils&quot;).Range(&quot;B1:G700&quot; &amp; LR).Copy Sheets(&quot;Output&quot;).Range(&quot;A1:C20&quot; &amp; LR)  For i = LR To 2 Step -1     If Sheets(&quot;Output&quot;).Cells(i, 2).Value = Sheets(&quot;Pupils&quot;).Cells(2, 2).Value Then     Else:     Columns(&quot;E&quot;).SpecialCells(xlCellTypeBlanks).EntireRow.Delete     End If Next i  End Sub<code>code</code>  Would there be a way to limit the output of days, say five of each day?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 43, "user_id": 7680252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6518ae7038ad4434219a27af4e2179?s=128&d=identicon&r=PG&f=1", "display_name": "SamC", "link": "https://stackoverflow.com/users/7680252/samc"}, "edited": false, "score": 0, "creation_date": 1489007855, "post_id": 42680384, "comment_id": 72488244, "body": "Couple things... 1) If you&#39;re using set ranges, e.g. B1:G700, you don&#39;t need LR.  LR is used to dynamically define the last row.  2) If you&#39;re looking to only have 5 outputs for a given variable, you will need to go back through and either loop and remove rows after 5, or use .FIND.  You can look up the .FIND info, as there is a LOT out there.  Glad this worked out for you!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1489002037, "last_edit_date": 1489002037, "creation_date": 1489001700, "answer_id": 42680384, "question_id": 42679876, "link": "https://stackoverflow.com/questions/42679876/excel-2010-copying-filtered-results-to-new-sheet/42680384#42680384", "title": "Excel 2010 - Copying filtered results to new sheet", "body": "<p>If you're intent to use VBA, a simple approach is to just copy everything over, then do the evaluation on sheets(\"Timetable\") .</p>\n\n<pre><code>Dim i as integer\nDim LR as Long\n\nLR = Sheets(\"Pupils).Cells(Rows.Count, \"A\").End(xlUp).Row\n\nSheets(\"Pupils\").Range(\"A1:B\"&amp;LR).Copy Sheets(\"Timetable\").Range(\"A1:B\"&amp;LR)\n\nFor i = LR to 2 Step -1\n    If Sheets(\"Timetable\").Cells(i,2).Value=Sheets(Pupils).Cells(2,2).Value Then\n    Else: Sheets(\"Timetable\").Rows(i).Delete\n    End If\nNext i    \n</code></pre>\n\n<p>I went the route of using an if statement, where if your day in column B matches the Pupils tab cell B2, then nothing happens, but if it doesn't match, it deletes the row.  Note that the For loop has a negative step, since the last row is defined BEFORE you start deleting, so you want to go backwards from the bottom to top.</p>\n\n<p>Edit:</p>\n\n<p>If you want to make a cell on Sheets(\"Timetable\") say the date, you could change the If statement to reflect that cell, e.g.</p>\n\n<pre><code>=Sheets(\"Timetable\").Cells(1,3) 'if you have the drop-down table in C1\n</code></pre>\n\n<p>You could also make a Userform to select the day of the week, if you really want to dig into it.  You would save the input as a variable and compare similar to:</p>\n\n<pre><code>Dim DayInput as String\n\nDayInput=CheckBox1.Value\n\nIf Sheets(\"Timetable\").Cells(i,2).Value=DayInput Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1489007093, "last_edit_date": 1489007093, "creation_date": 1489005509, "answer_id": 42681477, "question_id": 42679876, "link": "https://stackoverflow.com/questions/42679876/excel-2010-copying-filtered-results-to-new-sheet/42681477#42681477", "title": "Excel 2010 - Copying filtered results to new sheet", "body": "<p>Wish I could attach a file. I took part of Jeeped suggested formula. </p>\n\n<p>In Timetable I set up 7 columns: Sun, Mon, Tue, Wed, Thu, Fri, Sat</p>\n\n<p>In Timetable cell A2: =IF(Pupils!$B$2:$B$99=Days!$A$1,Pupils!$A2,\"\")</p>\n\n<p>In Timetable cell B2: =IF(Pupils!$B$2:$B$99=Days!$A$2,Pupils!$A2,\"\")</p>\n\n<p>... continue across for all 7 columns, note the edit of the Days cell reference</p>\n\n<p>... then pull all 7 columns down for as many rows as there are pupils</p>\n\n<p>In Timetable cell A3: =IF(Pupils!$B$2:$B$99=Days!$A$1,Pupils!$A3,\"\")</p>\n\n<p>In Timetable cell A4: =IF(Pupils!$B$2:$B$99=Days!$A$1,Pupils!$A4,\"\")</p>\n\n<p>...</p>\n\n<p>Hope this is what you wanted for a 'timetable'.</p>\n"}], "owner": {"reputation": 43, "user_id": 7680252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6518ae7038ad4434219a27af4e2179?s=128&d=identicon&r=PG&f=1", "display_name": "SamC", "link": "https://stackoverflow.com/users/7680252/samc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 42680384, "answer_count": 3, "score": 0, "last_activity_date": 1489007093, "creation_date": 1489000122, "last_edit_date": 1531161705, "question_id": 42679876, "link": "https://stackoverflow.com/questions/42679876/excel-2010-copying-filtered-results-to-new-sheet", "title": "Excel 2010 - Copying filtered results to new sheet", "body": "<p>I'm struggling with M$ Excel trying to create a formula to copy results over to another sheet. I think I may need to VBA it.</p>\n\n<p>I have three sheets. One called <strong>Pupils</strong>, one called <strong>Days</strong> and the other, <strong>Timetable</strong>.</p>\n\n<p><strong>Pupils</strong> column A is \"<em>Name</em>\" and column B is a drop down list \"<em>Day</em>\" with days off the week as options.</p>\n\n<p>I'm trying to create a formula that looks at column B and determines what day has been chosen then copies the pupils name from column A (<em>Name</em>) into sheet <strong>Timetable</strong> column A; row 1, 2, 3, etc.</p>\n\n<p>Is this possible?</p>\n\n<p>I've got this in my <strong>Timetable</strong> sheet</p>\n\n<pre><code>=IF(SUM(COUNTIF(Pupils!$G$2:$G$663,Days!$C$2)),\"true\",\"false\")\n</code></pre>\n\n<p>but this only checks if the results are true, which they are.</p>\n\n<p>Do my ramblings make sense?</p>\n\n<p>Thanx for looking.</p>\n\n<p>Sam</p>\n"}, {"tags": ["ms-access", "vba", "export-to-excel"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1489000381, "last_edit_date": 1489000381, "creation_date": 1488999943, "answer_id": 42679815, "question_id": 42679423, "link": "https://stackoverflow.com/questions/42679423/export-data-from-access-2010-to-excel-2013/42679815#42679815", "title": "Export data from Access 2010 to Excel 2013", "body": "<p>Which line errors - adding the worksheet?</p>\n\n<p>Code works for me:</p>\n\n<p>Set Sheet4 = Sheets.Add</p>\n\n<p>Maybe post your full procedure for analysis.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1493401709, "creation_date": 1493401709, "answer_id": 43686118, "question_id": 42679423, "link": "https://stackoverflow.com/questions/42679423/export-data-from-access-2010-to-excel-2013/43686118#43686118", "title": "Export data from Access 2010 to Excel 2013", "body": "<p>Without seeing the code it's impossible to say for sure.  Maybe a worksheet name is misspelled.  Just a guess.  Try the code samples below for some different ways of how to do this kind of task.</p>\n\n<pre><code>'************* Code Start *****************\n'This code was originally written by Dev Ashish\n'It is not to be altered or distributed,\n'except as part of an application.\n'You are free to use it in any application,\n'provided the copyright notice is left unchanged.\n'\n'Code Courtesy of\n'Dev Ashish\n'\nSub sCopyFromRS()\n'Send records to the first\n'sheet in a new workbook\n'\nDim rs As Recordset\nDim intMaxCol As Integer\nDim intMaxRow As Integer\nDim objXL As Excel.Application\nDim objWkb As Workbook\nDim objSht As Worksheet\n  Set rs = CurrentDb.OpenRecordset(\"Customers\", _\n                    dbOpenSnapshot)\n  intMaxCol = rs.Fields.Count\n  If rs.RecordCount &gt; 0 Then\n    rs.MoveLast:    rs.MoveFirst\n    intMaxRow = rs.RecordCount\n    Set objXL = New Excel.Application\n    With objXL\n      .Visible = True\n      Set objWkb = .Workbooks.Add\n      Set objSht = objWkb.Worksheets(1)\n      With objSht\n        .Range(.Cells(1, 1), .Cells(intMaxRow, _\n            intMaxCol)).CopyFromRecordset rs\n      End With\n    End With\n  End If\nEnd Sub\n\nSub sCopyRSExample()\n'Copy records to first 20000 rows\n'in an existing Excel Workbook and worksheet\n'\nDim objXL As Excel.Application\nDim objWkb As Excel.Workbook\nDim objSht As Excel.Worksheet\nDim db As Database\nDim rs As Recordset\nDim intLastCol As Integer\nConst conMAX_ROWS = 20000\nConst conSHT_NAME = \"SomeSheet\"\nConst conWKB_NAME = \"J:\\temp\\book1.xls\"\n  Set db = CurrentDb\n  Set objXL = New Excel.Application\n  Set rs = db.OpenRecordset(\"Customers\", dbOpenSnapshot)\n  With objXL\n    .Visible = True\n    Set objWkb = .Workbooks.Open(conWKB_NAME)\n    On Error Resume Next\n    Set objSht = objWkb.Worksheets(conSHT_NAME)\n    If Not Err.Number = 0 Then\n      Set objSht = objWkb.Worksheets.Add\n      objSht.Name = conSHT_NAME\n    End If\n    Err.Clear\n    On Error GoTo 0\n    intLastCol = objSht.UsedRange.Columns.Count\n    With objSht\n      .Range(.Cells(1, 1), .Cells(conMAX_ROWS, _\n          intLastCol)).ClearContents\n      .Range(.Cells(1, 1), _\n        .Cells(1, rs.Fields.Count)).Font.Bold = True\n      .Range(\"A2\").CopyFromRecordset rs\n    End With\n  End With\n  Set objSht = Nothing\n  Set objWkb = Nothing\n  Set objXL = Nothing\n  Set rs = Nothing\n  Set db = Nothing\nEnd Sub\n\nSub sCopyRSToNamedRange()\n'Copy records to a named range\n'on an existing worksheet on a\n'workbook\n'\nDim objXL As Excel.Application\nDim objWkb As Excel.Workbook\nDim objSht As Excel.Worksheet\nDim db As Database\nDim rs As Recordset\nConst conMAX_ROWS = 20000\nConst conSHT_NAME = \"SomeSheet\"\nConst conWKB_NAME = \"c:\\temp\\book1.xls\"\nConst conRANGE = \"RangeForRS\"\n\n  Set db = CurrentDb\n  Set objXL = New Excel.Application\n  Set rs = db.OpenRecordset(\"Customers\", dbOpenSnapshot)\n  With objXL\n    .Visible = True\n    Set objWkb = .Workbooks.Open(conWKB_NAME)\n    On Error Resume Next\n    Set objSht = objWkb.Worksheets(conSHT_NAME)\n    If Not Err.Number = 0 Then\n      Set objSht = objWkb.Worksheets.Add\n      objSht.Name = conSHT_NAME\n    End If\n    Err.Clear\n    On Error GoTo 0\n    objSht.Range(conRANGE).CopyFromRecordset rs\n  End With\n  Set objSht = Nothing\n  Set objWkb = Nothing\n  Set objXL = Nothing\n  Set rs = Nothing\n  Set db = Nothing\nEnd Sub\n'************* Code End *****************\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7680130, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TFHXSMH97As/AAAAAAAAAAI/AAAAAAAABtc/qe_04YpDRro/photo.jpg?sz=128", "display_name": "Anil Sundar", "link": "https://stackoverflow.com/users/7680130/anil-sundar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1493401709, "creation_date": 1488998620, "last_edit_date": 1489004648, "question_id": 42679423, "link": "https://stackoverflow.com/questions/42679423/export-data-from-access-2010-to-excel-2013", "title": "Export data from Access 2010 to Excel 2013", "body": "<p>i am exporting data from Access to Excel using recordset to transfer data from access query to excel(as I have to manual formatting which cannot be done with transferSpreadsheet) and while i am using the code</p>\n\n<pre><code>with sheet1\n.range(\"A2\").CopyRecordset rs1\nEnd With\n</code></pre>\n\n<p>This works fine till 3 sheets but when I initiate 4th sheet (as Excel has 3 sheets by default)</p>\n\n<pre><code>Set sheet4 = wb.Worksheets.Add\n</code></pre>\n\n<p>I am getting an error saying </p>\n\n<blockquote>\n  <p>Subscript out of range error.</p>\n</blockquote>\n\n<p>Can someone help me out with the same?</p>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489015415, "post_id": 42679749, "comment_id": 72491716, "body": "Thank you for your post! The form in reference is based on a query using three tables. I tried something along the lines of what you suggested earlier, although couldn&#39;t get it to work. I prefer VBA as well, just can&#39;t quite get it to work... :)"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489025002, "post_id": 42679749, "comment_id": 72494470, "body": "A data entry form based on 3 tables? Are 2 of the tables just to display related info? No problem with adding a new record on this form? What does &quot;couldn&#39;t get it to work&quot; mean - error message, wrong results, nothing happens? DanielG has given a lot of good info. To add to it, look into use of CurrentDb.Execute to run SQL action queries in VBA."}, {"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489025266, "post_id": 42679749, "comment_id": 72494545, "body": "Lol sorry 2 tables! Yes the issue is that it doesn&#39;t display anything in the control and it does not input the data when the form is closed or updated with a new record."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489030897, "post_id": 42679749, "comment_id": 72496069, "body": "This is not productive, really need to analysis db structure, query, and form design. If you want to provide db, I like Box.com fileshare site."}, {"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489032960, "post_id": 42679749, "comment_id": 72496650, "body": "Figured you&#39;d say that after my typo. :) I can provide the database, although I&#39;m pretty sure I&#39;m on the right track now from DanielG&#39;s third option. Thank you though. If you do want a copy send me a message with the box.com account and I&#39;ll send it over. It&#39;s a simple database though. One table for company info and another for cable details associated with the company in a subform."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1488999709, "creation_date": 1488999709, "answer_id": 42679749, "question_id": 42679383, "link": "https://stackoverflow.com/questions/42679383/ms-access-insert-calculated-field-to-table-field/42679749#42679749", "title": "MS Access Insert Calculated Field to Table Field", "body": "<p>This is not done with expression in event property that does the calc.</p>\n\n<p>Macro or VBA code is required to save calculated data, I prefer VBA.</p>\n\n<p>Is this form bound to the table you want to save data into? If so, the appropriate approach is simply:</p>\n\n<p>Me!fieldname = Me.textboxname</p>\n\n<p>The real trick, as you have discovered, is figuring out the correct event to put this code into. Select [Event procedure] in preferred event property then click the ellipsis (...) to go to the VBA procedure and type the desired code.</p>\n"}, {"comments": [{"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489014965, "post_id": 42681775, "comment_id": 72491549, "body": "Thank you for the post! The calculated field was something I tried initially although dismissed when my needs changed.  The form is based on a query that uses three tables. I\u2019m trying to use your suggestion about adding the SQL command to the After Update, although that doesn\u2019t transfer as intended. Any help would be great in that realm.  Using your third option I would create a query to give me the value I want and then use it in a form that will use the table needed for tracking cable specifics. I could then use the CableDetailsID to link the records together."}, {"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489015230, "post_id": 42681775, "comment_id": 72491657, "body": "Ran out of room there... That of course is if I even need to link the records. Which I most likely don&#39;t. I would run reports based on the new table for cable specifics for individual cables based on the cable label...I hope... :) Thanks again!"}, {"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489032642, "post_id": 42681775, "comment_id": 72496544, "body": "please disregard my typo to prevent further confusion. I am working on using your third option and I do believe that will solve my problem. Thank you for your time."}, {"owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "reply_to_user": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489071683, "post_id": 42681775, "comment_id": 72519105, "body": "Awesome, Tag. Are you hitting any roadblocks with option 3?"}, {"owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "edited": false, "score": 0, "creation_date": 1489071999, "post_id": 42681775, "comment_id": 72519321, "body": "I think I got it with option 3. Really I&#39;m putting this together as a concept before I create it as a Access Web App in SharePoint. That is why I&#39;m interested in a SQL solution. :)"}], "tags": [], "owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "is_accepted": true, "score": 1, "last_activity_date": 1489008347, "last_edit_date": 1489008347, "creation_date": 1489006566, "answer_id": 42681775, "question_id": 42679383, "link": "https://stackoverflow.com/questions/42679383/ms-access-insert-calculated-field-to-table-field/42681775#42681775", "title": "MS Access Insert Calculated Field to Table Field", "body": "<p>If all of the fields are in the same table, Access Tables have a Calculated data type accessible in the Design View of the table which will handle this, quite easily. This would be your simplest route; just use your expression in the calculated field as pictured below. Note that Calculated fields have other potential limitations down the road, but I would not worry too much about that. The name of your calculated field would be CompletedLabel, and Access will maintain its value based on the other fields current value in the expression.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UKeZk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UKeZk.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the fields are not in the same table and the Form is bound and Access is handling Saves (meaning the form has a RecordSource property, and you have Access handling the saving of the record when a user changes a value, they navigate to a new record, they close the form, etc.), you could add a VBA BeforeUpdate event that stamps the column just before Access auto-saves the field. Just add the CompletedLabel field to the form (it can be hidden), then create a Before update event:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n   Me!CompletedLabel = [Company] &amp; \" \" &amp; IIf([Cable]=\"Fiber\",\"FO Cable\",\"CC Cable\")    &amp; \" \" &amp; [CableStartPoint] &amp; \"-\" &amp; [CableEndPoint]\nEnd Sub\n</code></pre>\n\n<p>In some cases you will not even need the CompletedLabel textbox on the form, but it must be in the record source (query or table) that the form is based on. It must also be editable which is likely already the case.</p>\n\n<p>You could do it with SQL as you suggest, perhaps in an After Update event.</p>\n\n<pre><code>UPDATE \ntblCableDetails\nSET \nCompletedLabel=[Company] &amp; \" \" &amp; IIf([Cable]=\"Fiber\",\"FO Cable\",\"CC Cable\") &amp; \" \" &amp; [CableStartPoint] &amp; \"-\" &amp; [CableEndPoint]\nWHERE \nCableDetailsID=Form!CableDetailsID.Value\n</code></pre>\n\n<p>Or with an external query when the form opens or closes, like:</p>\n\n<pre><code>UPDATE \n     tblCableDetails\nSET \n     CompletedLabel=[Company] &amp; \" \" &amp; IIf([Cable]=\"Fiber\",\"FO Cable\",\"CC Cable\")    &amp; \" \" &amp; [CableStartPoint] &amp; \"-\" &amp; [CableEndPoint]\nWHERE \n     CompletedLabel = null Or Nz(CompletedLabel,\"\") = \"\"\n</code></pre>\n\n<p>You could also create a Query that contains the expression, and use it in the locations you need to see the calculated value.</p>\n\n<p>Lots of possibilities. Good luck, Tag!!</p>\n"}], "owner": {"reputation": 68, "user_id": 3188228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/168254a74a7a27a79de56bd1c5204fa2?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/3188228/tag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1700, "favorite_count": 1, "accepted_answer_id": 42681775, "answer_count": 2, "score": 0, "last_activity_date": 1489008347, "creation_date": 1488998474, "last_edit_date": 1495542709, "question_id": 42679383, "link": "https://stackoverflow.com/questions/42679383/ms-access-insert-calculated-field-to-table-field", "title": "MS Access Insert Calculated Field to Table Field", "body": "<p>I'm trying to get a form control that is doing the following as the Control Source to add it to a field in the associated table.</p>\n\n<pre><code>=[Company] &amp; \" \" &amp; IIf([Cable]=\"Fiber\",\"FO Cable\",\"CC Cable\") &amp; \" \" &amp; [CableStartPoint] &amp; \"-\" &amp; [CableEndPoint]\n</code></pre>\n\n<p>The above displays something along the following in the control on the form when associated fields are entered -> Company FO Cable Start-End</p>\n\n<p>I have tried using the expression in the After Update and the other On ... properties. This left me with a blank value though.</p>\n\n<p>My next go to was to use VBA and I tried using something along the lines of VBA from this question (<a href=\"https://stackoverflow.com/questions/30873555/access-form-calculated-fields?rq=1\">Access form calculated fields</a>) but my VBA skills seem to have diminished some and I'm not sure how to proceed to meet my needs... :(</p>\n\n<p>My main goal is to not have to manually enter the information for this to prevent typos and entering redundant information that is already stored in the database such as company, start point, and end point.</p>\n\n<p>If this could be done with SQL, I am interested in that solution as well. This is what I think I need for my SQL, although I'm not sure where it needs to go to update the record (After, Before, or just use the Code builder).</p>\n\n<pre><code>UPDATE tblCableDetails\nSET CompletedLabel=Form!CableDetails!Label.Value\nWHERE CableDetailsID=Form!CableDetailsID.Value\n</code></pre>\n\n<p>The reason I would like to store these in the database vs running the expression when needed, is that I would like to use this value in another table as a lookup for another form to track specifics regarding the cable.</p>\n\n<p>Thank you all for your time!</p>\n"}, {"tags": ["vba", "excel", "validation", "drop-down-menu"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488998397, "post_id": 42679305, "comment_id": 72482930, "body": "In your first sub, why are you <code>Activating</code> the cells? Do you want to do something with those? Or are you doing that, in order to trigger the <code>Worksheet_SelectionChange</code>?"}, {"owner": {"reputation": 143, "user_id": 3594344, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100000676967513/picture?type=large", "display_name": "cfrancklin", "link": "https://stackoverflow.com/users/3594344/cfrancklin"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488998569, "post_id": 42679305, "comment_id": 72483046, "body": "@BruceWayne to trigger the <code>Worksheet_SelectionChange</code>, yes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1488999873, "post_id": 42679305, "comment_id": 72483794, "body": "If you are using Data Validation, List to generate your drop-downs then they should be triggered by the Worksheet_Change. No other code is necessary and possibly confusing the issue. Remember to turn EnableEvents back on before exiting the Worksheet_Change event sub."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1489000151, "post_id": 42679305, "comment_id": 72483957, "body": "Seems we were typing at the same time, Jeeped.  I agree that EnableEvents not being turned back on is the issue."}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": false, "score": 1, "last_activity_date": 1489000023, "creation_date": 1489000023, "answer_id": 42679843, "question_id": 42679305, "link": "https://stackoverflow.com/questions/42679305/excel-vba-update-cell-based-on-previous-cells-change/42679843#42679843", "title": "Excel VBA: update cell based on previous cells change", "body": "<p>Your code is fine except that you need to <strong>turn events back on</strong>.  You have stopped events from firing with this line:  <code>Application.EnableEvents = False</code> but you never turn the event firings back on again.  So your code will work the first time you change a cell, the <code>Worksheet_Change</code> event will fire as expected.  However, within this sub you have set EnableEvents to false and then never set it back to true.  So you have stopped all future events, including this one, from firing again in the future.  Here is the solution:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Row = 1 Then Exit Sub\n        Application.EnableEvents = False\n        Cells(Target.Row, \"U\").Value = Date\n        Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 3594344, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100000676967513/picture?type=large", "display_name": "cfrancklin", "link": "https://stackoverflow.com/users/3594344/cfrancklin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490092313, "creation_date": 1488998251, "last_edit_date": 1490092313, "question_id": 42679305, "link": "https://stackoverflow.com/questions/42679305/excel-vba-update-cell-based-on-previous-cells-change", "title": "Excel VBA: update cell based on previous cells change", "body": "<p>I'm working on an Excel worksheet and using VBA to complete and update information on the cells.</p>\n\n<p>There are seven columns in the Excel table. Three of them are drop-down lists with Data Validation, which I used the following VBA code to fill them.</p>\n\n<pre><code>Private Sub TempCombo_KeyDown(ByVal _KeyCode As MSForms.ReturnInteger, _ ByVal Shift As Integer)\n\n    'Ocultar caixa de combina\u00e7\u00e3o e mover a pr\u00f3xima c\u00e9lula com Enter e Tab\n\n    Select Case KeyCode\n        Case 9\n            ActiveCell.Offset(0, 1).Activate\n        Case 13\n            ActiveCell.Offset(1, 0).Activate\n        Case Else\n            'Nada\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>These columns also work with autocomplete, using the code below:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim str As String\n    Dim cboTemp As OLEObject\n    Dim ws As Worksheet\n    Dim wsList As Worksheet\n\n    Set ws = ActiveSheet\n    Set wsList = Sheets(Me.Name)\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    If Application.CutCopyMode Then\n        'Permite copiar e colar na planilha\n        GoTo errHandler\n    End If\n\n    Set cboTemp = ws.OLEObjects(\"TempCombo\")\n\n    On Error Resume Next\n\n    With cboTemp\n        .Top = 10\n        .Left = 10\n        .Width = 0\n        .ListFillRange = \"\"\n        .LinkedCell = \"\"\n        .Visible = False\n        .Value = \"\"\n  End With\n\n  On Error GoTo errHandler\n\n      If Target.Validation.Type = 3 Then\n          Application.EnableEvents = False\n          str = Target.Validation.Formula1\n          str = Right(str, Len(str) - 1)\n          With cboTemp\n              .Visible = True\n              .Left = Target.Left\n              .Top = Target.Top\n              .Width = Target.Width + 15\n              .Height = Target.Height + 5\n              .ListFillRange = str\n              .LinkedCell = Target.Address\n         End With\n         cboTemp.Activate\n         'Abrir a lista suspensa automaticamente\n         Me.TempCombo.DropDown\n    End If\n\n    errHandler:\n        Application.ScreenUpdating = True\n        Application.EnableEvents = True\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Anytime I update any cell on a row, I want that the content of the seventh column of this row is updated with the current date.</p>\n\n<p>I tried using the following code, but it only works with common cells, the ones that I manually type its content. I want the seventh column to be updated when I change the drop-down list selection also.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Row = 1 Then Exit Sub\n        Application.EnableEvents = False\n        Cells(Target.Row, \"U\").Value = Date\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to update the content of the column as I said before? Even when I change the option selected in the drop-down list?</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 7680113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d257be4ba95cb79f60921abe6c7ccc?s=128&d=identicon&r=PG&f=1", "display_name": "heygivethatback", "link": "https://stackoverflow.com/users/7680113/heygivethatback"}, "edited": false, "score": 1, "creation_date": 1488998359, "post_id": 42679306, "comment_id": 72482899, "body": "... wow, I&#39;m an idiot.  Thank you so much, that was exactly my issue."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1488998552, "post_id": 42679306, "comment_id": 72483031, "body": "Fails for <b>64</b>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1488998636, "post_id": 42679306, "comment_id": 72483084, "body": "@Gary&#39;sStudent interesting, must be a floating decimal issue."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1488999103, "post_id": 42679306, "comment_id": 72483347, "body": "@Gary&#39;sStudent fixed it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 81, "user_id": 7680113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d257be4ba95cb79f60921abe6c7ccc?s=128&d=identicon&r=PG&f=1", "display_name": "heygivethatback", "link": "https://stackoverflow.com/users/7680113/heygivethatback"}, "edited": false, "score": 0, "creation_date": 1488999146, "post_id": 42679306, "comment_id": 72483385, "body": "@heygivethatback look at the edit,  There is a floating point issue with the old method.  I have fixed it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1489001379, "post_id": 42679306, "comment_id": 72484715, "body": "@ScottCraner  Also <code>CDec(x ^ (1 &#47; 3)) = Int(CDec(x ^ (1 &#47; 3)))</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1489003331, "post_id": 42679306, "comment_id": 72485853, "body": "@ScottCraner Unfortunately, it seems to fail with values of <code>728,757,026,999</code> or greater (<code>8999^3</code>).  So I guess you&#39;ll still need to use Rounding."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1489003909, "post_id": 42679306, "comment_id": 72486156, "body": "Somehow all versions including my 1st version give me <code>Run-time error &#39;5&#39;: Invalid procedure call or argument</code> with negative variable, but are fine with negative constant"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1489004514, "post_id": 42679306, "comment_id": 72486485, "body": "@Slai then just test the Abs of the input instead."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 6, "last_activity_date": 1489001737, "last_edit_date": 1489001737, "creation_date": 1488998251, "answer_id": 42679306, "question_id": 42679227, "link": "https://stackoverflow.com/questions/42679227/vba-testing-for-perfect-cubes/42679306#42679306", "title": "VBA: Testing for perfect cubes", "body": "<p>You are testing whether the cube is equal to the double supplied.</p>\n\n<p>So for 8 you would be testing whether 2 = 8.</p>\n\n<p>EDIT:  Also found a floating point issue.  To resolve we will round the decimals a little to try and overcome the issue.</p>\n\n<p>Change to the following:</p>\n\n<pre><code>Function PerfectCubeTest(x As Double)\n\n    If Round((x) ^ (1 / 3), 10) = Round((x) ^ (1 / 3), 0) Then\n        PerfectCubeTest = \"Perfect\"\n    Else\n        PerfectCubeTest = \"Flawed\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Or (Thanks to Ron)</p>\n\n<pre><code>Function PerfectCubeTest(x As Double)\n\n    If CDec(x ^ (1 / 3)) = Int(CDec(x ^ (1 / 3))) Then\n        PerfectCubeTest = \"Perfect\"\n    Else\n        PerfectCubeTest = \"Flawed\"\n    End If\n\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xbKzH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xbKzH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1489022759, "last_edit_date": 1489022759, "creation_date": 1489001059, "answer_id": 42680184, "question_id": 42679227, "link": "https://stackoverflow.com/questions/42679227/vba-testing-for-perfect-cubes/42680184#42680184", "title": "VBA: Testing for perfect cubes", "body": "<p>Fixed the integer division error thanks to @Comintern. Seems to be correct up to <code>208064 ^ 3 - 2</code></p>\n\n<pre><code>Function isPerfectCube(n As Double) As Boolean \n    n = Abs(n)\n    isPerfectCube = n = Int(n ^ (1 / 3) - (n &gt; 27)) ^ 3\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1489025310, "post_id": 42681755, "comment_id": 72494562, "body": "never mind .. the limit seems to be at <code>208064 ^ 3 - 1</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1489026514, "post_id": 42681755, "comment_id": 72494891, "body": "@Slai - That makes sense - that&#39;s roughly the <i>integer</i> precision of a <code>Double</code>."}, {"owner": {"reputation": 81, "user_id": 7680113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d257be4ba95cb79f60921abe6c7ccc?s=128&d=identicon&r=PG&f=1", "display_name": "heygivethatback", "link": "https://stackoverflow.com/users/7680113/heygivethatback"}, "edited": false, "score": 0, "creation_date": 1489038935, "post_id": 42681755, "comment_id": 72498633, "body": "So the only reason I used <code>Double</code> as the input is because my instructor for this VBA class recommended using either <code>Single</code> or <code>Double</code> variable types when dealing with variables that can be changed by the spreadsheet user.  Thank you for the informative and somewhat over-my-head code (what exactly is <code>Fix()</code> doing here?).  Also, what&#39;s floating point error?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 81, "user_id": 7680113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d257be4ba95cb79f60921abe6c7ccc?s=128&d=identicon&r=PG&f=1", "display_name": "heygivethatback", "link": "https://stackoverflow.com/users/7680113/heygivethatback"}, "edited": false, "score": 1, "creation_date": 1489040714, "post_id": 42681755, "comment_id": 72499343, "body": "@heygivethatback - <a href=\"https://support.office.com/en-us/article/Int-Fix-Functions-5446da0c-fbdc-425f-a818-7e3153984ff8\" rel=\"nofollow noreferrer\"><code>Fix()</code></a> basically does the same thing as <code>Int()</code>, but has slightly different behavior with negative numbers. The floating point error refers to <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">how non-integers are stored internally</a>. What it comes down to is that <a href=\"https://en.wikipedia.org/wiki/Irrational_number\" rel=\"nofollow noreferrer\">irrational numbers</a> can&#39;t be accurately represented in binary."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 3, "last_activity_date": 1489006504, "creation_date": 1489006504, "answer_id": 42681755, "question_id": 42679227, "link": "https://stackoverflow.com/questions/42679227/vba-testing-for-perfect-cubes/42681755#42681755", "title": "VBA: Testing for perfect cubes", "body": "<p>@ScottCraner correctly explains why you were getting incorrect results, but there are a couple other things to point out here.  First, I'm assuming that you are taking a <code>Double</code> as input because the range of acceptable numbers is higher.  However, by your implied definition of a perfect cube only numbers with an integer cube root (i.e. it would exclude 3.375) need to be evaluated. I'd just test for this up front to allow an early exit.</p>\n\n<p>The next issue you run into is that 1 / 3 can't be represented exactly by a <code>Double</code>.  Since you're raising to the inverse power to get your cube root you're also compounding the floating point error.  There's a <em>really</em> easy way to avoid this - take the cube root, cube it, and see if it matches the input.  You get around the rest of the floating point errors by going back to your definition of a perfect cube as an integer value - just round the cube root to <em>both</em> the next higher and next lower integer before you re-cube it:</p>\n\n<pre><code>Public Function IsPerfectCube(test As Double) As Boolean\n    'By your definition, no non-integer can be a perfect cube.\n    Dim rounded As Double\n    rounded = Fix(test)\n    If rounded &lt;&gt; test Then Exit Function\n\n    Dim cubeRoot As Double\n    cubeRoot = rounded ^ (1 / 3)\n    'Round both ways, then test the cube for equity.\n    If Fix(cubeRoot) ^ 3 = rounded Then\n        IsPerfectCube = True\n    ElseIf (Fix(cubeRoot) + 1) ^ 3 = rounded Then\n        IsPerfectCube = True\n    End If\nEnd Function\n</code></pre>\n\n<p>This returned the correct result up to 1E+27 (1 billion cubed) when I tested it. I stopped going higher at that point because the test was taking so long to run and by that point you're probably outside of the range that you would reasonably need it to be accurate. </p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1489010869, "creation_date": 1489010869, "answer_id": 42682819, "question_id": 42679227, "link": "https://stackoverflow.com/questions/42679227/vba-testing-for-perfect-cubes/42682819#42682819", "title": "VBA: Testing for perfect cubes", "body": "<p>For fun, here is an implementation of a number-theory based method described <a href=\"http://burningmath.blogspot.com/2013/09/how-to-know-or-check-if-number-is.html\" rel=\"nofollow noreferrer\">here</a> . It defines a Boolean-valued (rather than string-valued) function called <code>PerfectCube()</code> that tests if an integer input (represented as a Long) is a perfect cube. It first runs a quick test which throws away many numbers. If the quick test fails to classify it, it invokes a factoring-based method. Factor the number and check if the multiplicity of each prime factor is a multiple of 3. I could probably optimize this stage by not bothering to find the complete factorization when a bad factor is found, but I had a VBA factoring algorithm already lying around:</p>\n\n<pre><code>Function DigitalRoot(n As Long) As Long\n    'assumes that n &gt;= 0\n    Dim sum As Long, digits As String, i As Long\n\n    If n &lt; 10 Then\n        DigitalRoot = n\n        Exit Function\n    Else\n        digits = Trim(Str(n))\n        For i = 1 To Len(digits)\n            sum = sum + Mid(digits, i, 1)\n        Next i\n        DigitalRoot = DigitalRoot(sum)\n    End If\nEnd Function\n\nSub HelperFactor(ByVal n As Long, ByVal p As Long, factors As Collection)\n    'Takes a passed collection and adds to it an array of the form\n    '(q,k) where q &gt;= p is the smallest prime divisor of n\n    'p is assumed to be odd\n    'The function is called in such a way that\n    'the first divisor found is automatically prime\n\n    Dim q As Long, k As Long\n    q = p\n    Do While q &lt;= Sqr(n)\n        If n Mod q = 0 Then\n            k = 1\n            Do While n Mod q ^ k = 0\n                k = k + 1\n            Loop\n            k = k - 1 'went 1 step too far\n            factors.Add Array(q, k)\n            n = n / q ^ k\n            If n &gt; 1 Then HelperFactor n, q + 2, factors\n            Exit Sub\n        End If\n        q = q + 2\n    Loop\n    'if we get here then n is prime - add it as a factor\n    factors.Add Array(n, 1)\nEnd Sub\n\nFunction factor(ByVal n As Long) As Collection\n    Dim factors As New Collection\n    Dim k As Long\n\n    Do While n Mod 2 ^ k = 0\n        k = k + 1\n    Loop\n    k = k - 1\n    If k &gt; 0 Then\n        n = n / 2 ^ k\n        factors.Add Array(2, k)\n    End If\n    If n &gt; 1 Then HelperFactor n, 3, factors\n    Set factor = factors\nEnd Function\n\nFunction PerfectCubeByFactors(n As Long) As Boolean\n    Dim factors As Collection\n    Dim f As Variant\n\n    Set factors = factor(n)\n    For Each f In factors\n        If f(1) Mod 3 &gt; 0 Then\n            PerfectCubeByFactors = False\n            Exit Function\n        End If\n    Next f\n    'if we get here:\n    PerfectCubeByFactors = True\nEnd Function\n\nFunction PerfectCube(n As Long) As Boolean\n    Dim d As Long\n    d = DigitalRoot(n)\n    If d = 0 Or d = 1 Or d = 8 Or d = 9 Then\n        PerfectCube = PerfectCubeByFactors(n)\n    Else\n        PerfectCube = False\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7680113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d257be4ba95cb79f60921abe6c7ccc?s=128&d=identicon&r=PG&f=1", "display_name": "heygivethatback", "link": "https://stackoverflow.com/users/7680113/heygivethatback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 4, "score": 7, "last_activity_date": 1489022759, "creation_date": 1488997979, "question_id": 42679227, "link": "https://stackoverflow.com/questions/42679227/vba-testing-for-perfect-cubes", "title": "VBA: Testing for perfect cubes", "body": "<p>I'm trying to write a simple function in VBA that will test a real value and output a string result if it's a perfect cube.  Here's my code:</p>\n\n<pre><code>Function PerfectCubeTest(x as Double)\n\n    If (x) ^ (1 / 3) = Int(x) Then\n        PerfectCubeTest = \"Perfect\"\n    Else\n        PerfectCubeTest = \"Flawed\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>As you can see, I'm using a simple if statement to test if the cube root of a value is equal to its integer portion (i.e. no remainder).  I tried testing the function with some perfect cubes (1, 8, 27, 64, 125), but it only works for the number 1.  Any other value spits out the \"Flawed\" case.  Any idea what's wrong here? </p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488996767, "post_id": 42678613, "comment_id": 72481959, "body": "<code>application.VBE.ActiveVBProject.References.AddFromFile(&quot;&quot;)</code> you could use based on the version?"}, {"owner": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489000983, "post_id": 42678613, "comment_id": 72484487, "body": "And I can reference the library based on GUID? Do you know where I could find the appropriate GUID or a list of GUIDs? I can&#39;t find anything in google"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489002363, "post_id": 42678974, "comment_id": 72485297, "body": "<code>msoBarPopup</code> is undefined - are you specifying <code>Option Explicit</code> at the top of the module? That code shouldn&#39;t compile. You need to define your own <code>msoBarPopup</code> constant (or use its underlying value directly) if you&#39;re not referencing MSO.DLL."}, {"owner": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "edited": false, "score": 0, "creation_date": 1489002516, "post_id": 42678974, "comment_id": 72485388, "body": "Thanks. I&#39;ve tried to switch to late binding without success. Here&#39;s my code:      <code>Private Sub CreateSimpleShortcutMenu()</code>    ` Dim cmbShortcutMenu As Object &#39;Office.CommandBar`    ` &#39;Create a shortcut menu named &quot;SimpleShortcutMenu.`    ` Set cmbShortcutMenu = CommandBars.Add(&quot;SimpleShortcutMenu&quot;, msoBarPopup, False, True)`     <code>Set cmbShortcutMenu = Nothing</code>     <code>End Sub</code>  And this works fine, as long as Ive referenced the library and am using Access 2016. But when I try to run the database in an older version, I still get the same problem"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "edited": false, "score": 0, "creation_date": 1489002559, "post_id": 42678974, "comment_id": 72485423, "body": "You have to <b>remove</b> the referenced library, otherwise you&#39;re still early-bound."}, {"owner": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "edited": false, "score": 0, "creation_date": 1489002646, "post_id": 42678974, "comment_id": 72485473, "body": "Ok Thank you. I&#39;ll try that and get back to you"}, {"owner": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "edited": false, "score": 0, "creation_date": 1489003287, "post_id": 42678974, "comment_id": 72485831, "body": "Thank you! That fixed it! I replaced the mso constants with the underlying values."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1488997283, "creation_date": 1488997283, "answer_id": 42678974, "question_id": 42678613, "link": "https://stackoverflow.com/questions/42678613/reference-office-object-library-for-older-versions-missing-mso-dll/42678974#42678974", "title": "Reference Office Object Library for older versions...missing mso.dll", "body": "<p>It seems you've early-bound your dependency to the 16.0 type library; early-bound references are always version-specific, and you can only early-bind to one specific version.</p>\n\n<p>Because you're going to need to support multiple versions, you need to switch everything over to late-binding.</p>\n\n<p>You haven't provided any code, so I'll give you a hypothetical example - instead of this:</p>\n\n<pre><code>Dim foo As Library.SomeType\nSet foo = New Library.SomeType\nfoo.DoSomething(Library.SomeEnumValue)\n</code></pre>\n\n<p>You need to do this (and remove the early-bound reference from your project):</p>\n\n<pre><code>Const SomeEnumValue As Long = 42 'Library.SomeEnumValue\nDim foo As Object\nSet foo = CreateObject(\"Library.SomeType\")\nfoo.DoSomething(SomeEnumValue)\n</code></pre>\n\n<p>There's no automated way to do this that I know of, however you may want to keep an eye on <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/1184\" rel=\"nofollow noreferrer\">Rubberduck issue #1184</a>, which aims specifically to make a refactoring tool exactly for this (full disclosure: I manage that open-source project).</p>\n"}], "owner": {"reputation": 59, "user_id": 5781398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-NOgW3vV6MPE/AAAAAAAAAAI/AAAAAAAAAAA/wJYpeBg4M3g/photo.jpg?sz=128", "display_name": "Tj Keel", "link": "https://stackoverflow.com/users/5781398/tj-keel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2339, "favorite_count": 0, "accepted_answer_id": 42678974, "answer_count": 1, "score": 1, "last_activity_date": 1488997283, "creation_date": 1488996080, "question_id": 42678613, "link": "https://stackoverflow.com/questions/42678613/reference-office-object-library-for-older-versions-missing-mso-dll", "title": "Reference Office Object Library for older versions...missing mso.dll", "body": "<p>I do my development in Access 2016. I've created a custom shortcut menu (right-click menu) with VBA. In order for this VBA code to run, I have to enable the Microsoft Office 16.0 Object Library reference.</p>\n\n<p>Whenever I deploy this database to PCs with older versions of Access (2013 and 2010) the database is looking for the Microsoft Office 16.0 Object Library, which does not exist. I hoped that Access would be smart enough to automatically select the appropriate Object Library for the version of Microsoft that is installed. However, it does not and the code will not run until I manually set the appropriate object library.</p>\n\n<p>Is there a better way to automate this? Is there some VBA code I can implement that will find the correct library? The only solution I've come up with is setting the Object Library in an older version of Access before deploying the database to other PCs(there doesn't seem to be a problem finding newer Object libraries, only older ones.)</p>\n\n<p>Thanks guys.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488997634, "post_id": 42678257, "comment_id": 72482449, "body": "&quot;Page10&quot; indeeds comes before &quot;Page2&quot; in any alphabetical sort. Pad your numbers with zeroes to make that &quot;Page001&quot; instead; that way &quot;Page010&quot; will always come after &quot;Page002&quot;."}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488999666, "post_id": 42678257, "comment_id": 72483677, "body": "@Mat&#39;sMug, its worked as you suggested. Thank you verymuch!"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1488997718, "post_id": 42678698, "comment_id": 72482495, "body": "Thanks for your reply. Work book has many named range. When I export to word for specific named range from particular sheet, it is showing different order and also through clipboard error. Any alternative or help would be much appreciated. thank you!"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1488999707, "post_id": 42678698, "comment_id": 72483700, "body": "Changing the name from page1 to page001 , page002 etc worked. thank you!"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1489093786, "last_edit_date": 1489093786, "creation_date": 1488996356, "answer_id": 42678698, "question_id": 42678257, "link": "https://stackoverflow.com/questions/42678257/excel-vba-finding-named-range-in-specific-order/42678698#42678698", "title": "excel vba finding named range in specific order", "body": "<p>a proposition</p>\n\n<pre><code>nbrofpage=10 'set your number of pages\nFor intcounter = 1 To nbrofpage\n    With objDoc\n        Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n        'Insert page break if not first page\n        If intcounter &lt;&gt; 1 Then rtarget.InsertBreak Type:=wdPageBreak\n        'Copy data from named range\n        Range(\"page\" &amp; intcounter).Copy\n        Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n        rtarget.Paste\n    End With\nNext intcounter\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489093786, "creation_date": 1488994900, "last_edit_date": 1531164843, "question_id": 42678257, "link": "https://stackoverflow.com/questions/42678257/excel-vba-finding-named-range-in-specific-order", "title": "excel vba finding named range in specific order", "body": "<p>I create named range dynamically using vba. Then I want to export to word in each named range in each page. E.g: Named range would be Page1,Page2,...Page10...etc. When I try to export, Page1 comes first and page10 comes second. How to make it page1,page2, etc...</p>\n\n<pre><code>For intCounter = 1 To wbBook.Names.Count\n      MsgBox Names(intCounter).name\n       'If IsNameRefertoSheet(oSht, Names(intCounter)) Then\n        If Names(intCounter).name Like \"Page*\" Then\n            With objDoc\n                 Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n                 'Insert page break if not first page\n                 If Names(intCounter).name &lt;&gt; \"Page1\" Then rtarget.InsertBreak Type:=wdPageBreak\n                 'Copy data from named range\n                 Range(wbBook.Names(intCounter)).Copy\n                 Set rtarget = .Range(.Content.End - 1, .Content.End - 1)\n                 rtarget.Paste\n            End With\n        End If\n       'End If\n    Next intCounter\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1488995086, "post_id": 42678060, "comment_id": 72480988, "body": "put <code>Sheets(&quot;List&quot;).</code> in front of the second <code>Range</code> in that line."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488995291, "post_id": 42678060, "comment_id": 72481113, "body": "I did that. It now looks like <code>Set Rng = Sheets(&quot;List&quot;).Range([I4], Sheets(&quot;List&quot;).Range(&quot;I&quot; &amp; Rows.Count).End(xlUp))</code> I&#39;m still getting the same error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488995353, "post_id": 42678060, "comment_id": 72481162, "body": "put the <code>[I4]</code> in quotes and not brackets <code>Set Rng = Sheets(&quot;List&quot;).Range(&quot;I4&quot;, Sheets(&quot;List&quot;).Range(&quot;I&quot; &amp; Sheets(&quot;List&quot;).Rows.Count).End(xlUp))</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1488995465, "post_id": 42678060, "comment_id": 72481227, "body": "If <code>MyCounties</code> is a named range on the Mark worksheet, what is the named range on the John worksheet? Are these named ranges with worksheet-level scope?"}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1488995756, "post_id": 42678060, "comment_id": 72481410, "body": "I will rename the ranges to be MarkCounties, JohnCounties, etc. once I get the code working. I think they are worksheet-level. I highlighted the cells I wanted, then typed the name in the name box in the upper left hand corner."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1488996133, "post_id": 42678060, "comment_id": 72481625, "body": "So the code runs without error now, but its not bringing all the rows over. My named range is J1:L1, and is Fresno, Kings, then Tulare. When I run the macro, there should be 7 rows with Fresno, 1 with Kings, and 2 with Tulare. Instead, I get the two Tulare results first, then 5 Fresno results, and no Kings."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1488996287, "post_id": 42678060, "comment_id": 72481698, "body": "Look to your data and make sure there are no unprintable characters like trailing spaces or mistypes n either list."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1488996611, "post_id": 42678060, "comment_id": 72481873, "body": "Ok, checked the data, its good. Retyped it just to make sure. Figured out the issue, but don&#39;t know how to fix it. So it&#39;s bringing over all 7 of Fresno starting at A4, then starts at A4 again for the one Kings, then again starts at A4 for Tulare. How do I make it go down to the first blank row and paste there?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1488997623, "post_id": 42678060, "comment_id": 72482446, "body": "You&#39;ve created named ranges with workbook scope. Instead of thinking &#39;<i>they are worksheet-level</i>&#39;, you should go into Formulas, Defined Names and find out. Typically, defined names are generated with workbook scope but if you want to use the same name for different named ranges on different worksheets then you would use worksheet scope."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489001127, "post_id": 42679013, "comment_id": 72484571, "body": "This code is fantastic. Works like a charm for all of these easy ones. One more question, though. For larger areas like Los Angeles County, it gets split up between 5 people, who each take different cities within that county, and within LA itself, take different zip codes. Is it possible to search for matching county and city (for all cities not LA), as well as for Los Angeles (city) and zip code? County is column &quot;I&quot;, City is column &quot;G&quot;, and Zip is column &quot;H&quot;. So &quot;Christina&quot; would have within LA county cities of Acton, Burbank, etc. and also LA (city) zip codes of 90008, 90016, etc."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489001362, "post_id": 42679013, "comment_id": 72484705, "body": "I could either use a helper sheet to list all these, say Sheet &quot;LA County&quot; where A1 would be persons name, A2 would list counties (Just LA in this example), A3 (and B3, C3, etc. however many cities she has total) would list cities within LA county, and A4 would list zip codes within LA city."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489001658, "post_id": 42679013, "comment_id": 72484882, "body": "When using an array as criteria for AutoFilter, you cannot have a <code>Criteria2</code> parameter but you can add additional columns for filtering. If you want to expand on this solution then you will need to close this off and ask a new question. There are simply too many things to consider for this to be dealt in comments. Provide your current code, sample data and show the results you expect. No screenshots; no one wants to waste time retyping sample data."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489095373, "post_id": 42679013, "comment_id": 72533696, "body": "Using this code today, I noticed that on the &quot;List&quot; sheet, it doesn&#39;t copy row 4. It copies everything else that matches the criteria, but that row it skips, for some reason."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489100987, "post_id": 42679013, "comment_id": 72536316, "body": "AutoFilter requires a header row no matter whether it has column text labels or not. That&#39;s why the code offsets one row to  look for filtered results. I assumed from your original code that the header row was in row 4.  If your header row is in row 3 and your data starts in row 4 then change <code>.Cells(4, &quot;I&quot;)</code> to <code>.Cells(3, &quot;I&quot;)</code>."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489104070, "post_id": 42679013, "comment_id": 72537370, "body": "Ok, that worked perfectly. Thank you. I&#39;ve taken your advice and started a new question for the more difficult filters here:    <a href=\"http://stackoverflow.com/questions/42683835/copy-rows-with-multiple-sub-criteria\">link</a>    Would you mind looking at it and telling me what I&#39;m doing wrong? I&#39;ve edited the code a bit to fit the situation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1488997755, "last_edit_date": 1488997755, "creation_date": 1488997384, "answer_id": 42679013, "question_id": 42678060, "link": "https://stackoverflow.com/questions/42678060/copy-rows-from-one-sheet-to-another-with-multiple-criteria/42679013#42679013", "title": "copy rows from one sheet to another with multiple criteria", "body": "<p>This code will need to be adjusted to accommodate your named ranges and worksheet names. It currently uses named ranges with worksheet scope from each worksheet.</p>\n\n<pre><code>Sub NewSheetData()\n    Dim w As Long, sWSs As Variant, vCrit As Variant, rw As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    sWSs = Array(\"Mark\", \"John\", \"etc\")\n\n    For w = LBound(sWSs) To UBound(sWSs)\n        With Worksheets(sWSs(w))\n            vCrit = .Range(\"MyCounties\").Value2\n            rw = Application.Max(.Cells(.Rows.Count, \"A\").End(xlUp).Row + 1, 4)\n        End With\n\n         With Worksheets(\"List\")\n            If .AutoFilterMode Then .AutoFilterMode = False\n            With .Range(.Cells(4, \"I\"), .Cells(.Rows.Count, \"I\").End(xlUp))\n                .AutoFilter field:=1, Criteria1:=vCrit, Operator:=xlFilterValues\n                With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        .Cells.EntireRow.Copy Destination:=Worksheets(sWSs(w)).Cells(rw, \"A\")\n                    End If\n                End With\n            End With\n            If .AutoFilterMode Then .AutoFilterMode = False\n        End With\n   Next w\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This uses the values from each worksheet's <em>MyCounties</em> named range as an array of criteria for .AutoFilter. using an array as criteria requires the <code>Operator:=xlFilterValues</code> parameter. It also checks to make sure that there are filtered values to copy before copying them.</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1488998914, "post_id": 42679027, "comment_id": 72483244, "body": "When I run this code, there are no errors, but it also doesn&#39;t find anything."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1489002160, "post_id": 42679027, "comment_id": 72485195, "body": "As per your explanations, this code has to be launched with &quot;Mark&quot; sheet as the active one"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1488997440, "creation_date": 1488997440, "answer_id": 42679027, "question_id": 42678060, "link": "https://stackoverflow.com/questions/42678060/copy-rows-from-one-sheet-to-another-with-multiple-criteria/42679027#42679027", "title": "copy rows from one sheet to another with multiple criteria", "body": "<p>may be your <code>EntireRow</code> is copying rows whose first column is blank</p>\n\n<p>you could use <code>UsedRange</code> property of worksheet object to get the last used row</p>\n\n<p>furthermore you'd better place <code>With Rng</code> oustide the loop, since it doesn't change with it</p>\n\n<pre><code>Option Explicit\n\nSub NewSheetData()\n    Dim Rng As Range, rCell As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    With Sheets(\"List\")\n        Set Rng = .Range(\"I4\", .Range(\"I\" &amp; .Rows.Count).End(xlUp))\n    End With\n\n    With Rng\n        For Each rCell In Range(\"MyCounties\")\n            .AutoFilter , Field:=1, Criteria1:=rCell.Value\n            If Application.WorksheetFunction.Subtotal(103, .cells) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).EntireRow.Copy _\n            Sheets(\"Sheeta2\").Range(\"A\" &amp; Sheets(\"Sheeta2\").UsedRange.Rows(Sheets(\"Sheeta2\").UsedRange.Rows.Count).Row).Offset(1)\n        Next\n        .Parent.AutoFilterMode = False\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 42679013, "answer_count": 2, "score": 0, "last_activity_date": 1488997755, "creation_date": 1488994294, "last_edit_date": 1488995657, "question_id": 42678060, "link": "https://stackoverflow.com/questions/42678060/copy-rows-from-one-sheet-to-another-with-multiple-criteria", "title": "copy rows from one sheet to another with multiple criteria", "body": "<p>I'm working on a macro that will search a List sheet for different counties and then paste the entire row onto the current sheet. I have a worksheet for each person (named Mark, John, etc.) and each person is assigned several counties. Mark has three counties, listed in cells J1:L1, which I've named as a range (MyCounties). I need a macro that will look through Sheet \"List\" column \"I\" for each of those counties and copy the entire row onto Sheet \"Mark\" starting at \"A4\". I'm using a modified macro I found on here, but I must be doing something wrong. It is currently giving me an error \"Application defined or object defined error\" in regards to <code>Set Rng = Sheets(\"List\").Range([I4], Range(\"I\" &amp; Rows.Count).End(xlUp))</code></p>\n\n<pre><code>Sub NewSheetData()\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nDim Rng As Range, rCell As Range\n\nSet Rng = Sheets(\"List\").Range([I4], Range(\"I\" &amp; Rows.Count).End(xlUp))\n\nFor Each rCell In Range(\"MyCounties\")\n    On Error Resume Next\n        With Rng\n            .AutoFilter , field:=1, Criteria1:=rCell.Value\n            .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Copy _\n                Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n            .AutoFilter\n        End With\n    On Error GoTo 0\nNext rCell\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ibm-midrange", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1488998111, "post_id": 42677920, "comment_id": 72482738, "body": "With output = output &amp; Line you skip CRLF. Is that on intention? Although I  do not believe it has anything to do with your problem. Can you check what the encoding of your input file is?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1488999115, "post_id": 42677920, "comment_id": 72483363, "body": "I guess encoding of your input file is UNICODE, right?"}, {"owner": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1489053535, "post_id": 42677920, "comment_id": 72506708, "body": "Indeed was UNICODE. Just learned how to check <a href=\"http://stackoverflow.com/questions/6947749/how-to-check-if-a-txt-file-is-in-ascii-or-utf-8-format-in-windows-environment\" title=\"how to check if a txt file is in ascii or utf 8 format in windows environment\">stackoverflow.com/questions/6947749/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1489000564, "last_edit_date": 1489000564, "creation_date": 1489000243, "answer_id": 42679916, "question_id": 42677920, "link": "https://stackoverflow.com/questions/42677920/excel-vba-read-write-dft-file-ibm-data-tranfer/42679916#42679916", "title": "EXCEL VBA read / write . dft file (IBM Data Tranfer)", "body": "<p>So, I assume your input file is an UNICODE file then you coud use the following function</p>\n\n<pre><code>Function ReadUniCodeTextFile(inpFile As String) As String\n\nDim sText As String\nDim objFSO As Object\nDim objFile As Object\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFile = objFSO.OpenTextFile(inpFile, 1, False, -1)\n    ReadUniCodeTextFile = objFile.ReadAll\n    objFile.Close\n\nEnd Function\n</code></pre>\n\n<p>And replace </p>\n\n<pre><code>   'Read from template\n    FileNum = FreeFile()\n    Open TemplateFilePath For Input As #FileNum\n        While Not EOF(FileNum)\n            Line Input #FileNum, Line\n            output = output &amp; Line\n        Wend\n    Close #FileNum\n</code></pre>\n\n<p>just with</p>\n\n<pre><code>output = ReadUniCodeTextFile(TemplateFilePath)\n</code></pre>\n\n<p>So your code should look like this then</p>\n\n<pre><code>Public Sub CreateDataTranderFile(TemplateFilePath As String)\nDim output As String\nDim OutFullPath As String\nDim Line As String\nDim FileNum As Integer\n\n    OutFullPath = \"C:\\tmpTranferfile.dtf\"\n\n    'Read from template\n    output = ReadUniCodeTextFile(TemplateFilePath)\n\n    'Write .dtf\n    Open OutFullPath For Output As #1\n    Print #1, output\n    Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 42679916, "answer_count": 1, "score": 1, "last_activity_date": 1489000564, "creation_date": 1488993923, "last_edit_date": 1531164843, "question_id": 42677920, "link": "https://stackoverflow.com/questions/42677920/excel-vba-read-write-dft-file-ibm-data-tranfer", "title": "EXCEL VBA read / write . dft file (IBM Data Tranfer)", "body": "<p>I would like to edit a .dtf (IBM Data Transfer file) via VBA. Opening it in excel is causing me problems so I was hoping to read the file line-by-line and export to a new .dtf. However something goes wrong when I try to <code>Print #1</code> the string to the .dtf</p>\n\n<p><a href=\"https://i.stack.imgur.com/fe6ZS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fe6ZS.jpg\" alt=\"INPUT\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fe6ZS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e6Rgz.jpg\" alt=\"OUPUT\"></a></p>\n\n<pre><code>Sub test()\n    Dim TemplateFilePath As String\n    TemplateFilePath = \"C:\\TemplateFile.dtf\"\n    Call CreateDataTranderFile(TemplateFilePath)\nEnd Sub\n\n\n\nPublic Sub CreateDataTranderFile(TemplateFilePath As String)\n    Dim output As String\n    Dim OutFullPath As String\n    Dim Line As String\n    Dim FileNum As Integer\n\n    OutFullPath = \"C:\\tmpTranferfile.dtf\"\n\n\n    'Read from template\n    FileNum = FreeFile()\n    Open TemplateFilePath For Input As #FileNum\n        While Not EOF(FileNum)\n            Line Input #FileNum, Line\n            output = output &amp; Line\n        Wend\n    Close #FileNum\n\n    'Write .dtf\n    Open OutFullPath For Output As #1\n        Print #1, output\n    Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-word", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7679520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee233bfe8aa2e5bfd95a992f7d3e207?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/7679520/jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1489008001, "creation_date": 1489008001, "answer_id": 42682118, "question_id": 42677480, "link": "https://stackoverflow.com/questions/42677480/vba-code-to-open-many-word-forms-and-import-data-to-excel/42682118#42682118", "title": "VBA code to open many word forms and import data to Excel", "body": "<p>I figured it out.  Still need to do more cleanup and fix other issues, but this code works for my purposes.  Hopefully someone else will find some use for it as well.</p>\n\n<pre><code> Sub MultFileLoad()\n\n 'Remember: this code requires a reference to the Word object model\n\n Dim wdApp As New Word.Application\n Dim wdDoc As Word.Document\n Dim fName As String\n Dim i As Long, Rw As Long, f As Variant 'Word.FormField\n Dim file\n Dim Path As String\n\n ChDir ActiveWorkbook.Path\n Path = ActiveWorkbook.Path &amp; \"\\\"\n\nfile = Dir(\"C:\\temp\\test\\*.docx\")\nDo While file &lt;&gt; \"\"\nwdApp.Documents.Open Filename:=Path &amp; file\n\n Set wdDoc = wdApp.Documents.Open(Path &amp; file)\n Rw = Cells(Rows.Count, 1).End(xlUp).Row + 1\n Cells(Rw, 1) = Cells(Rw - 1, 1) + 1\n i = 1\n For Each f In wdDoc.FormFields\n i = i + 1\n On Error Resume Next\n Cells(Rw, i) = f.Result\n Next\n\nwdApp.ActiveDocument.Close\n\nfile = Dir()\nLoop\n\nwdApp.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\nwdApp.Quit\nSet wdApp = Nothing\n\nExits:\nwdApp.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\nwdApp.Quit\nSet wdApp = Nothing\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7679520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee233bfe8aa2e5bfd95a992f7d3e207?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/7679520/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2769, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522178184, "creation_date": 1488992686, "last_edit_date": 1531161705, "question_id": 42677480, "link": "https://stackoverflow.com/questions/42677480/vba-code-to-open-many-word-forms-and-import-data-to-excel", "title": "VBA code to open many word forms and import data to Excel", "body": "<p>I'm trying to write VBA in Excel to loop through many Word documents (up to 1,500 or more) and extract the form field data for each document into a separate line in the same spreadsheet.  Unfortunately, the time frame is tight and my VBA knowledge is seriously lacking.</p>\n\n<p>I've created the Frankenstein-esque module below after gleaning what I could from other people who've tried to do similar things.  I'm not sure how to resolve the error I'm getting now and not even positive I'm going about it the right way.  When I execute the code below, I get \"Object variable or With block variable not set (Error 91)\".  It appears to be choking on For Each loop.  I assume there's a variable definition or assignment that's incorrect.</p>\n\n<p>I wanted to write this as Excel VBA to ensure that the Word form can be distributed to my users in the near future while I get this VBA module working properly.  Those forms need to be sent out this week and they'll start coming back to me immediately.  In past years, the staff in this department has done mass data entry to port the form data to Excel--hoping to avoid that this year.</p>\n\n<p>I also considered saving those forms as data only delimited text files, but that would require opening each Word doc, saving as delimited text, concatenating the files together and opening it in Word.  Pretty simple process, but I don't want to open 1,500 Word docs to save them as delimited text.  The rest would be easy.</p>\n\n<p>I believe I also need to beef up the error handling.  When I run another macro which just handles one file, it fails if I have column headings in the spreadsheet and that leaves the Word doc open..  But that's a secondary concern now.</p>\n\n<p>Thanks in advance for any help you can provide.</p>\n\n<pre><code> Sub MultFileLoad()\n\n 'Remember: this code requires a reference to the Word object model\n\n Dim wdApp As New Word.Application\n Dim wdDoc As Word.Document\n Dim fName As String\n Dim i As Long, Rw As Long, f As Variant\n Dim file\n Dim Path As String\n\n ChDir ActiveWorkbook.Path\n Path = ActiveWorkbook.Path &amp; \"\\\"\n\nfile = Dir(\"C:\\temp\\test\\*.docx\")\nDo While file &lt;&gt; \"\"\nwdApp.Documents.Open Filename:=Path &amp; file\n\n Rw = Cells(Rows.Count, 1).End(xlUp).Row + 2\n Cells(Rw, 1) = Cells(Rw - 1, 1) + 1\n i = 1\n For Each f In wdDoc.FormFields\n i = i + 1\n On Error Resume Next\n Cells(Rw, i) = f.Result\n Next\n\nwdApp.ActiveDocument.Close\n\nfile = Dir()\nLoop\n\nwdApp.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\nwdApp.Quit\nSet wdApp = Nothing\n\nExits:\n End Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1488993166, "post_id": 42677158, "comment_id": 72479747, "body": "&quot;Application-defined or object-defined error.&quot; is what I got with that, unfortunately."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1488993531, "post_id": 42677158, "comment_id": 72479967, "body": "Would it be simpler to store the recordset in a query, run that and check if recordcount &gt; 0 instead of trying to reference the form"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1488998875, "last_edit_date": 1488998875, "creation_date": 1488991755, "answer_id": 42677158, "question_id": 42677107, "link": "https://stackoverflow.com/questions/42677107/display-a-message-if-a-form-displays-no-results-after-filtering/42677158#42677158", "title": "Display a message if a form displays no results after filtering", "body": "<p>Try with:</p>\n\n<pre><code>If Me!Search_Results.Form.RecordsetClone.RecordCount = 0 Then\n    MsgBox (\"No Results Found\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488998875, "creation_date": 1488991598, "question_id": 42677107, "link": "https://stackoverflow.com/questions/42677107/display-a-message-if-a-form-displays-no-results-after-filtering", "title": "Display a message if a form displays no results after filtering", "body": "<p>Below is what my VBA currently looks like. searchCrit is the Combo Box with various search criteria like First Name, Last Name, etc. and searchTxt is the value entered:</p>\n\n<pre><code>If searchCrit = \"First Name\" Then\n    Me.Search_Results.Form.Filter = \"[FirstName] LIKE '%\" &amp; searchTxt &amp; \"%'\n    Me.Search_Results.Form.FilterOn = True\n\n    If Me.Search_Results.Form.RecordCount &lt; 1 Then\n        MsgBox (\"No Results Found\")\n    End If\nElse If .......\n</code></pre>\n\n<p>I am getting an error on the line:</p>\n\n<pre><code> If Me.Search_Results.Form.RecordCount &lt; 1 Then\n</code></pre>\n\n<p>Is RecordCount not a viable method here? Is there some other way to detect if the form had returned no results?</p>\n"}, {"tags": ["vba", "excel", "if-statement", "user-controls"], "comments": [{"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 1, "creation_date": 1488992286, "post_id": 42677067, "comment_id": 72479214, "body": "You don&#39;t have <code>= True</code> next to Intact.Value in the line <code>ElseIf Intact.Value And Compugen.Value = True Then</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488992290, "post_id": 42677067, "comment_id": 72479215, "body": "Much copy-pasta code in here. How about extracting a procedure to remove code duplication? (after you address the unreachable code issue)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488992620, "post_id": 42677067, "comment_id": 72479400, "body": "This is a good example of a problem that could be solved with a rubber duck. See <a href=\"https://blog.codinghorror.com/rubber-duck-problem-solving/\" rel=\"nofollow noreferrer\">rubber duck problem solving</a>. As for the insufficient indentation of <code>With</code> blocks, that&#39;s a good example of a problem that could be solved with a <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Rubberduck</a> (full disclosure: I manage the Rubberduck open-source project) ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1488992340, "last_edit_date": 1488992340, "creation_date": 1488991756, "answer_id": 42677159, "question_id": 42677067, "link": "https://stackoverflow.com/questions/42677067/vba-if-statements-with-and-not-working/42677159#42677159", "title": "VBA - IF statements with AND not working", "body": "<p>If <code>Intact.Value = True</code> is true then the first, not the third block will run.</p>\n\n<p>Similarly if <code>Intact.Value = True</code> is not true and <code>Compugen.Value = True</code> is true, then the second block will run.</p>\n\n<p>So you can see that the third block is not reachable.</p>\n\n<p>The solution is to put the <code>Intact.Value = True And Compugen.Value = True</code> case first in the group.</p>\n\n<p>Finally, <code>Foo.Value = True</code> is a tautology of the simpler <code>Foo.Value</code>. You can drop all the explicit <code>= True</code> comparisons.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488992216, "post_id": 42677204, "comment_id": 72479173, "body": "I&#39;d just remove the explicit <code>= True</code> fluff - if <code>.Value</code> is a <code>Boolean</code>, then comparing it to <code>True</code> to make a Boolean expression is redundant."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488992295, "post_id": 42677204, "comment_id": 72479219, "body": "@Mat&#39;sMug - quite right, thanks, had missed in the latter two."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489000477, "post_id": 42677204, "comment_id": 72484155, "body": "@YowE3K in that case isn&#39;t there some <code>CheckState</code> enum to test against (I might be mixing up UserForms and WinForms and WPF stuff)?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489000826, "post_id": 42677204, "comment_id": 72484356, "body": "@Mat&#39;sMug - Ahh - it appears to be <code>Null</code> if the checkbox is in the third state, so I guess it <b>will</b> only evaluate to <code>True</code> if it is checked.  I thought it returned -2 or something.  Forget I said anything."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1488992272, "last_edit_date": 1488992272, "creation_date": 1488991883, "answer_id": 42677204, "question_id": 42677067, "link": "https://stackoverflow.com/questions/42677067/vba-if-statements-with-and-not-working/42677204#42677204", "title": "VBA - IF statements with AND not working", "body": "<p>Try changing the order. Otherwise as soon as one condition is met the If clause is exited.</p>\n\n<pre><code>If Intact.Value And Compugen.Value Then\n    'code\nElseIf Intact.Value Then\n    'code\nElseIf Compugen.Value Then\n    'code\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7636718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5993b69b92948eccfd2014f4c838b8f8?s=128&d=identicon&r=PG&f=1", "display_name": "GreatSc0tt", "link": "https://stackoverflow.com/users/7636718/greatsc0tt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488992340, "creation_date": 1488991491, "question_id": 42677067, "link": "https://stackoverflow.com/questions/42677067/vba-if-statements-with-and-not-working", "title": "VBA - IF statements with AND not working", "body": "<p>Any help would be great. I cant seem to get the ELSEIF with the AND to work.</p>\n\n<p>I am using a user-form. When they press the button the user form appears with check boxes. I am having trouble when both check boxes are checked. individually they work fine,</p>\n\n<p>I am not sure what i am doing wrong. any help would be greatly appreciated </p>\n\n<pre><code>If Intact.Value = True Then\n    storDate = Sheets(\"escalation\").Cells(Selection.Row, 2)\n    storProject = Sheets(\"escalation\").Cells(Selection.Row, 3)\n    StorBill = Sheets(\"escalation\").Cells(Selection.Row, 4)\n    storIntact = \"Intact\"\n\n    With objWord.ActiveDocument\n    .formfields(\"text2\").Result = storDate\n    .formfields(\"Text3\").Result = storProject\n    .formfields(\"Text4\").Result = StorBill\n    .formfields(\"Text9\").Result = storIntact\n    End With\n\nElseIf Compugen.Value = True Then\n    storDate = Sheets(\"escalation\").Cells(Selection.Row, 2)\n    storProject = Sheets(\"escalation\").Cells(Selection.Row, 3)\n    StorBill = Sheets(\"escalation\").Cells(Selection.Row, 4)\n    storCompugen = \"Compugen\"\n\n    With objWord.ActiveDocument\n    .formfields(\"text2\").Result = storDate\n    .formfields(\"Text3\").Result = storProject\n    .formfields(\"Text4\").Result = StorBill\n    .formfields(\"Text9\").Result = storCompugen\n    End With\n\nElseIf Intact.Value And Compugen.Value = True Then\n    storDate = Sheets(\"escalation\").Cells(Selection.Row, 2)\n    storProject = Sheets(\"escalation\").Cells(Selection.Row, 3)\n    StorBill = Sheets(\"escalation\").Cells(Selection.Row, 4)\n    storIntact = \"Intact\"\n    storDate1 = Sheets(\"escalation\").Cells(Selection.Row, 2)\n    storProject1 = Sheets(\"escalation\").Cells(Selection.Row, 3)\n    StorBill1 = Sheets(\"escalation\").Cells(Selection.Row, 4)\n    storCompugen = \"Compugen\"\n\n    With objWord.ActiveDocument\n    .formfields(\"text2\").Result = storDate\n    .formfields(\"Text3\").Result = storProject\n    .formfields(\"Text4\").Result = StorBill\n    .formfields(\"Text9\").Result = storIntact\n    .formfields(\"text5\").Result = storDate1\n    .formfields(\"Text6\").Result = storProject1\n    .formfields(\"Text7\").Result = StorBill1\n    .formfields(\"Text8\").Result = storCompugen\n    End With\nEnd If\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488991738, "post_id": 42677036, "comment_id": 72478861, "body": "Arrays (param), collections, dictionaries, classes etc   Where are the 50 source codes etc. kept?  Also, you never close the excel application, so it would open 50 times, you need to hold excel at public declaration or use <code>getobject</code> as a check before <code>createobject</code>  as it&#39;s in Excel, you could just use <code>new excel.application</code>"}, {"owner": {"reputation": 3, "user_id": 7679474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3085ee17a0d22de2f3eb05dd5aee89d7?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisW", "link": "https://stackoverflow.com/users/7679474/chrisw"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488997014, "post_id": 42677036, "comment_id": 72482115, "body": "The 50 source codes are kept in the directory path outside of the .Attachment.add code &quot;G:\\403(b)\\User Folders\\Chris W\\Spark Audit\\&quot; &amp; GlobalAuditDate &amp; &quot;\\00-Ran Reports&quot;  Ah I didn&#39;t think about that opening up 50 times so how would you best fix that? (I&#39;m pretty new to using objects so I&#39;m not 100% sure how to implement what you suggested)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7679474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3085ee17a0d22de2f3eb05dd5aee89d7?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisW", "link": "https://stackoverflow.com/users/7679474/chrisw"}, "edited": false, "score": 0, "creation_date": 1489000943, "post_id": 42677223, "comment_id": 72484444, "body": "Thank you so much Jacob K it worked perfectly - What I ended up doing is added the objects and set like you suggested then added the  &quot;For Each objSubFolder In objFolder.subfolders GlobalVendorId = objSubFolder.Name Call openExcel(GlobalVendorId) Call SendAuditReport  Next objSubFolder&quot;"}], "tags": [], "owner": {"reputation": 529, "user_id": 413276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa90f69d68292185f3c981458d73531?s=128&d=identicon&r=PG", "display_name": "Jacob K", "link": "https://stackoverflow.com/users/413276/jacob-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1488991950, "creation_date": 1488991950, "answer_id": 42677223, "question_id": 42677036, "link": "https://stackoverflow.com/questions/42677036/vba-passing-list-of-variable/42677223#42677223", "title": "vba passing list of variable", "body": "<p>You can enumerate folder names as such:</p>\n\n<pre><code>Dim objFSO As Object\nDim objFolder As Object\nDim objSubFolder As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"C:\\pathtoyourparentfolder\")\n\nFor Each objSubFolder In objFolder.subfolders\n    MsgBox objSubFolder.Name\nNext objSubFolder\n</code></pre>\n\n<p>objSubFolder.Name will be the name of the folder and you can just pass this to GlobalVendorID.</p>\n"}], "owner": {"reputation": 3, "user_id": 7679474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3085ee17a0d22de2f3eb05dd5aee89d7?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisW", "link": "https://stackoverflow.com/users/7679474/chrisw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 42677223, "answer_count": 1, "score": 0, "last_activity_date": 1488992848, "creation_date": 1488991416, "last_edit_date": 1488992848, "question_id": 42677036, "link": "https://stackoverflow.com/questions/42677036/vba-passing-list-of-variable", "title": "vba passing list of variable", "body": "<p>I have already created a macro that creates individual files for me. Now having those files I have created another VBA job in outlook that will add the contact information to the e-mail, locate the needed file, and attach it to an e-mail. I need to do this to a list of about 50 different companies that I send these audits to. Currently I need to add a certain parameter to select what company I am using \"V003\" for example after this job is ran I go to the next one \"V004\" and so on. </p>\n\n<p>I am looking for a way to provide VBA the list of 50 companies codes into which I have all as folders in a certain directory path. So when i kick off the job it will reference the folder named  V003 in the directory path and use that as the VendorID variable I have created then loop back to the beginning and grab the next folder name V004 in the directory path and filter though until it gets to the last one.</p>\n\n<p>Unless someone else has an idea that won't make me kick of the VBA job 50 times and pass in each variable. (Currently that's what I've been doing since I created these jobs and it's still a bit time consuming)</p>\n\n<pre><code>Dim GlobalVarEmail As String\nDim GlobalVarVendorName As String\nDim GlobalVendorId As String\nDim GlobalMonth As String\nDim GlobalYear As String\nDim GlobalAuditDate As String\n\nSub SendFilesbyEmail()\n'the calling method of all sub methods.\n    GlobalVendorId = InputBox(\"What Vendor Letter are you trying to send out? (V Code: ex - V012)\", \"Vendor Code\", \"Type Here\", 7500, 5000)\n    GlobalMonth = InputBox(\"What Month are you auditing for?(ex - Jan. Feb. Mar.)\", \"Month\", \"Type Here\", 7500, 5000)\n    GlobalYear = InputBox(\"What year are you auditing for?(ex - 2016)\", \"Quarter\", \"Type Here\", 7500, 5000)\n    GlobalAuditDate = InputBox(\"What is the audit date?(ex - 20160930)\", \"Quarter\", \"Type Here\", 7500, 5000)\nCall openExcel(GlobalVendorId)\nCall SendAuditReport\nEnd Sub\nPublic Function openExcel(UserReponse) As String\n'this function is used to retrieve the vendor contact e-mail\nDim xlApp As Object\nDim sourceWB As Workbook\nDim sourceWS As Worksheet\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\nWith xlApp\n.Visible = False\n.EnableEvents = True\nEnd With\n\nstrFile = \"G:\\403(b)\\User Folders\\Chris W\\SPARK Info\\Contacts.xlsx\"\n\nSet sourceWB = Workbooks.Open(strFile, , False, , , , , , , True)\nSet sourceWH = sourceWB.Worksheets(\"SPARK\")\nsourceWB.Activate\n    Rows(\"1:1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$H$100\").AutoFilter Field:=1, Criteria1:=UserReponse\n    Range(\"F1\").Select\n    GlobalVarEmail = Selection.End(xlDown).Value\n    Range(\"B1\").Select\n    GlobalVarVendorName = Selection.End(xlDown).Value\nActiveWorkbook.Close SaveChanges:=False\n\nEnd Function\n\n\nFunction SendAuditReport()\n'this function will create a e-mail, (subjectline &amp; body), attach the needed audit letter, and insert the needed vendor contact e-mail.\nDim Fname As String\nDim sAttName As String\n\nDim olApp As Outlook.Application\nDim olMsg As Outlook.MailItem\nDim olAtt As Outlook.Attachments\n\nSet olApp = Outlook.Application\nSet olMsg = olApp.CreateItem(0) ' email\nSet olAtt = olMsg.Attachments\n\n  ' send message\nWith olMsg\n  .Subject = GlobalVarVendorName &amp; \" \" &amp; GlobalMonth &amp; \" \" &amp; GlobalYear &amp; \" SPARK Audit\"\n  .To = GlobalVarEmail\n  .CC = \"SPARK@AXA.com\"\n  .Attachments.Add \"G:\\403(b)\\User Folders\\Chris W\\Spark Audit\\\" &amp; GlobalAuditDate &amp; \"\\00-Ran Reports\\\" &amp; GlobalVendorId &amp; \"\\SPARK Audit Report \" &amp; GlobalVarVendorName &amp; \".xlsx\"\n  'you can add attachments here just type .Attachments.Add \"folder path\"\n  .HTMLBody = \"Hello, &lt;br /&gt;&lt;br /&gt; Attached is the file\n  '.Send\n  .Display\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488990875, "post_id": 42676668, "comment_id": 72478238, "body": "The term &quot;passing object variable to a function&quot; typically implies <i>parameters</i>, and your functions have none. Did you read up on <i>parameters</i>? <code>btn</code> seems to be a module-level variable, aka &quot;public field&quot; or &quot;global variable&quot;, which is the opposite of &quot;passing parameters&quot;"}, {"owner": {"reputation": 75, "user_id": 6239503, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8a2667bb54210973c7d16fc9f63c24c8?s=128&d=identicon&r=PG&f=1", "display_name": "Thom G", "link": "https://stackoverflow.com/users/6239503/thom-g"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488990973, "post_id": 42676668, "comment_id": 72478315, "body": "@SJR That provides me the same results as what I have now, through testing, and is perhaps more logical. I think the issue I&#39;m having is that, when calling the &quot;RemovetoArchive&quot; Function, the btn.Name property isn&#39;t set, i.e. it has no value, and thus cannot manipulate the string."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488991129, "post_id": 42676668, "comment_id": 72478443, "body": "If the error is run-time error 91, then it&#39;s not the <code>Name</code> property that has no value, it&#39;s the <code>btn</code> reference itself; <code>btn</code> is <code>Nothing</code>. Which type of module is <code>btn</code> declared in? A standard/procedural module? A worksheet/class module? A userform&#39;s code-behind? See <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables/2957/variables#t=201703081638244410797\">Variables and Scopes</a> in the VBA topics of Documentation.SO."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488992036, "post_id": 42676668, "comment_id": 72479058, "body": "I deleted my comment because when I read @Mat&#39;sMug&#39;s comment I realised I hadn&#39;t read your question properly. You need to address the issues he raises (though my suggestion should help in the end). Why does your function need to add the button and define its properties each time it&#39;s called?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1488992130, "post_id": 42676668, "comment_id": 72479118, "body": "Also, specify <code>Option Explicit</code> at the top of every module - I suspect <code>btn</code> is undeclared/inaccessible from the module you&#39;re trying to access it from."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488999012, "post_id": 42676668, "comment_id": 72483305, "body": "It would be useful if your question indicated which modules each of your bits of code are in.  That would help us identify whether it is a scope issue.  But I think you have a more serious issue - assuming you are adding several buttons to <code>Worksheets(&quot;Active Jobs&quot;)</code>, when someone presses a button <code>btn</code> (once the scope is correct) will be referring to the one that you just added (and then only if it was added in the same session) - don&#39;t you want to identify <b>WHICH</b> button they pressed?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489017301, "post_id": 42676668, "comment_id": 72492416, "body": "Does <code>Function GetActiveJob()</code> actually run without errors?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489018851, "post_id": 42676668, "comment_id": 72492876, "body": "@MarkFitzgerald - It works for me. (Pasted that code into a module, created two sheets - Sheet1 and Active Jobs, set Sheet1!C4 to 5, made Active Jobs the active sheet, created a form with two input boxes and a button, called <code>GetActiveJob</code> from the button&#39;s Click event.)  It will have problems if Active Jobs isn&#39;t active though."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489019446, "post_id": 42676668, "comment_id": 72493053, "body": "@YowE3K, I thought <code>Functions</code> couldn&#39;t generally manipulate objects.  They can get values from objects but not change them.  I know there is a quirky exception posted on SO but can&#39;t find it just now.  Only <code>Subs</code> can change objects."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489020123, "post_id": 42676668, "comment_id": 72493243, "body": "@MarkFitzgerald - you&#39;re thinking of UDFs (User Defined Functions) which are able to be called from a cell in the Excel worksheet itself.  Coding-wise they are just like any other function but, as long as a function isn&#39;t used from a cell, it can do whatever it likes.  (Theoretically, the only difference between a Sub and a Function in VBA is that a Function is meant to return a value and a Sub can&#39;t.  But in this case the OP&#39;s function doesn&#39;t even return a value and therefore should really be called a Sub, but VBA doesn&#39;t really care.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489020785, "post_id": 42676668, "comment_id": 72493439, "body": "@MarkFitzgerald - FWIW - <a href=\"http://stackoverflow.com/a/42657717/6535336\">here&#39;s a recent answer of mine where I used a function</a>.  On looking back on it, although I intended it to be used as a &quot;normal&quot; function (i.e. a piece of code that returns a value) I now notice that it could also be used as a UDF (e.g. cell C5 could have the formula <code>=CountOccupiedRooms(&quot;Champagne&quot;)</code>) and it would <b>nearly</b> work - it would still need to be marked as <code>Volatile</code> in order to force it to recalculate whenever <b>any</b> change was made to a worksheet."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489024497, "post_id": 42676668, "comment_id": 72494346, "body": "@YowE3K, I&#39;ve learned something then!  I guess there could be some use for a <code>Private Function ChangeSomethingAndConfirm() As Boolean</code> in a module instead of having a Sub that modifies a Global <code>Success</code> variable."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489026870, "post_id": 42676668, "comment_id": 72494989, "body": "@MarkFitzgerald - Yep - lots of code <b>calculates</b> something, rather than processing something - and calculations should be coded as Functions that return a value, and &quot;processing&quot; should be done as subroutines as Subs"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6239503, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8a2667bb54210973c7d16fc9f63c24c8?s=128&d=identicon&r=PG&f=1", "display_name": "Thom G", "link": "https://stackoverflow.com/users/6239503/thom-g"}, "edited": false, "score": 0, "creation_date": 1489045603, "post_id": 42679588, "comment_id": 72501806, "body": "This solved it, and thank you for the additional information. The jobs get placed onto sheets determined by the value of one of three option buttons. So I was going to do something like:         If optionbutton2.value = true then       Sheet2.activate  for example, but your suggestion is definitely better imo. Thank you!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1489021454, "last_edit_date": 1489021454, "creation_date": 1488999184, "answer_id": 42679588, "question_id": 42676668, "link": "https://stackoverflow.com/questions/42676668/trouble-passing-object-variable-within-functions-vba/42679588#42679588", "title": "Trouble Passing Object Variable within Functions VBA", "body": "<p>Using the name of a temporary object that you created when you created the button can, at best, return you the name of the last one you created - and even that won't be possible once that temporary object is garbage-collected.</p>\n\n<p>So, if you want to find the <code>Name</code> of the button that invoked <code>RemoveToArchive</code>, you should do something like the following, which uses the <code>Application.Caller</code> to determine which button was pressed:</p>\n\n<pre><code>Sub RemovetoArchive()  'Only use Function when you have a function,\n                       'use Sub when you have a subroutine\n    Dim ButtonID As Integer\n    Dim ButtonString As String\n\n    ButtonString = Mid(Application.Caller, 16, 2)\n    ButtonID = CInt(ButtonString)\n\n    Worksheets(\"Active Jobs\").Range(\"A\" &amp; (5 * ButtonID) &amp; \":R\" &amp; (3 + (5 * ButtonID))).Select\n\n    MsgBox (\"ButtonID is \" &amp; ButtonID) 'Testing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>A subsequent comment to the question by Mark Fitzgerald also made me see that there is a potential problem in your <code>GetActiveJob</code> code.  The section of your code which says:</p>\n\n<pre><code>With Worksheets(\"Active Jobs\")\n  .Range(\"A\" &amp; (5 * i1)) = UserForm1.TextBox1\n  ActiveSheet.Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).Merge\n  .Range(\"B\" &amp; (5 * i1)) = UserForm1.TextBox2  '//Handles a decent bit of text \n  .Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).VerticalAlignment = xlTop\n  Set t = ActiveSheet.Range(\"G\" &amp; (5 * i1))\n  Set btn = Worksheets(\"Active Jobs\").Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n\n  With btn\n    .Name = \"RemovetoArchive\" &amp; i1\n    .Caption = \"Archive\"\n    .OnAction = \"RemovetoArchive\"\n  End With\n\nEnd With\n</code></pre>\n\n<p>has a few references to <code>ActiveSheet</code>.  If the active sheet isn't the \"Active Jobs\" worksheet then that will cause problems.  (But it will obviously work if you always ensure that the active sheet <strong>is</strong> \"Active Jobs\".)  To avoid problems, I suggest you change that code to:</p>\n\n<pre><code>With Worksheets(\"Active Jobs\")\n  .Range(\"A\" &amp; (5 * i1)) = UserForm1.TextBox1\n  .Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).Merge\n  .Range(\"B\" &amp; (5 * i1)) = UserForm1.TextBox2  '//Handles a decent bit of text \n  .Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).VerticalAlignment = xlTop\n  Set t = .Range(\"G\" &amp; (5 * i1))\n  Set btn = .Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n\n  With btn\n    .Name = \"RemovetoArchive\" &amp; i1\n    .Caption = \"Archive\"\n    .OnAction = \"RemovetoArchive\"\n  End With\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6239503, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8a2667bb54210973c7d16fc9f63c24c8?s=128&d=identicon&r=PG&f=1", "display_name": "Thom G", "link": "https://stackoverflow.com/users/6239503/thom-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 42679588, "answer_count": 1, "score": 0, "last_activity_date": 1489021454, "creation_date": 1488990376, "question_id": 42676668, "link": "https://stackoverflow.com/questions/42676668/trouble-passing-object-variable-within-functions-vba", "title": "Trouble Passing Object Variable within Functions VBA", "body": "<p>I have a program that takes user input and places it in a sheet, based on job type. For the purposees of this we're only concerned with Sheet(\"Active Jobs\").</p>\n\n<p>I have a function which takes information from a UserForm, and places it into Cells, based on jobID. A simple count keeps track of the JobID, and places the job into the sheet, based on its ID, as such:</p>\n\n<pre><code>Public btn As Button\nPublic t As Range\n\nFunction GetActiveJob()\n\nDim i1 As Integer\ni1 = Worksheets(\"Sheet1\").Range(\"C4\").Value '//Keeps count of jobs, gives the JobID\n\n  With Worksheets(\"Active Jobs\")\n    .Range(\"A\" &amp; (5 * i1)) = UserForm1.TextBox1\n    ActiveSheet.Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).Merge\n    .Range(\"B\" &amp; (5 * i1)) = UserForm1.TextBox2  '//Handles a decent bit of text \n    .Range(\"B\" &amp; (5 * i1) &amp; \":\" &amp; \"E\" &amp; (3 + (5 * i1))).VerticalAlignment = xlTop\n    Set t = ActiveSheet.Range(\"G\" &amp; (5 * i1))\n    Set btn = Worksheets(\"Active Jobs\").Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n\n  With btn\n    .Name = \"RemovetoArchive\" &amp; i1\n    .Caption = \"Archive\"\n    .OnAction = \"RemovetoArchive\"\n  End With\n\n  End With\n\nUserForm1.TextBox1.Value = \"\"\nUserForm1.TextBox2.Value = \"\"\n\ni1 = i1 + 1\nWorksheets(\"Sheet1\").Range(\"C4\").Value = i1\nMsgBox (\"I1 = \" &amp; i1) 'For testing purposes\n\nEnd Function\n</code></pre>\n\n<p>(The job ID needn't be unique)</p>\n\n<p>As you can see, the userform creates a button with a name (Name of the function) followed by the jobID.</p>\n\n<p>When a job is complete, &amp; the archive button is pressed, I want to move it into a new sheet, called Archive.</p>\n\n<p>To do this I take the string and manipulate it to get the ID Number, then convert the string to integer:</p>\n\n<pre><code>  Function RemovetoArchive()\n\n    Dim ButtonID As Integer\n    Dim ButtonString As String\n\n    ButtonString = Mid(btn.Name, 16, 2)  '&lt;-- Error here, (see below)\n    ButtonID = CInt(ButtonString)\n\n    Worksheets(\"Active Jobs\").Range(\"A\" &amp; (5 * ButtonID) &amp; \":R\" &amp; (3 + (5 * ButtonID))).Select\n\n\n    MsgBox (\"ButtonID is \" &amp; ButtonID) 'Testing\n</code></pre>\n\n<p>The ID Number is used as a variable to determine which range needs to be selected, and moved to archive.</p>\n\n<p>Running this however, I get</p>\n\n<pre><code>Object variable or With Block Variable not set\n</code></pre>\n\n<p>I'm having issues with setting the btn.Name object. \ni.e. </p>\n\n<pre><code>I enter a job with JobID '5'\nThe information is created along with a button.\nI press Button 5, a.k.a \"RemovetoArchive5\"\n</code></pre>\n\n<p>My code should take just the numeric character from the string \"RemovetoArchive5\" and convert it to integer, to be used as ButtonID.</p>\n\n<p>As it is now, btn.Name, doesn't have the value</p>\n\n<pre><code>btn.Name = \"RemovetoArchive5\"\n</code></pre>\n\n<p>Will this have to be done in the GetActiveJobs Function? How can I pass the btn.Name Object, after Clicking the button it refers to?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["windows", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1488990811, "post_id": 42676272, "comment_id": 72478197, "body": "You can&#39;t really just make up methods. The DataObject doesn&#39;t cope with images (it doesn&#39;t even cope with text very well in Win 8 or later). What are you planning to do with the image?"}, {"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1488991242, "post_id": 42676272, "comment_id": 72478539, "body": "I want to manually paste the image into a non-msft application. The link I provided seems to indicate that images can be put on the clipboard."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488991394, "post_id": 42676272, "comment_id": 72478643, "body": "You can load the image into a shape (~0,~0 dimension), and do the following <code>ActiveSheet.Shapes(1).CopyPicture xlScreen, xlBitmap</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1488992727, "post_id": 42676272, "comment_id": 72479470, "body": "The first line from Chip&#39;s page: &quot;The MSForms library contains an object called the DataObject that provides support for working with <b>text strings</b> on the Windows clipboard&quot; (emphasis added). Of course the clipboard can hold images, but the <code>DataObject</code> is <b>not</b> the clipboard."}, {"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1488993103, "post_id": 42676272, "comment_id": 72479709, "body": "Yes, I have read again and see you are correct. I will look for a work around, thanks"}], "owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488989299, "creation_date": 1488989299, "last_edit_date": 1525816150, "question_id": 42676272, "link": "https://stackoverflow.com/questions/42676272/windows-clipboard-store-image-using-ms-forms-data-object-vba", "title": "Windows Clipboard, Store Image Using MS Forms Data Object - VBA", "body": "<p>I want to put an image on the Windows clipboard using VBA. I currently do this for text essentially as described <a href=\"http://www.cpearson.com/excel/clipboard.aspx\" rel=\"nofollow noreferrer\">here</a> using the DataObject in the MS Forms 2.0 Library.</p>\n\n<p>I want to do the same thing using an image file, putting the image on the clipboard instead of text.</p>\n\n<p>My working code used for text is below, I have tried using the image file path as the variable but just stores the text. Also tried \"SetImage\" as a method but throws error as below.</p>\n\n<pre><code>Dim DataObj As MSForms.DataObject\nSet DataObj = New MSForms.DataObject\n\nDataObj.SetText str1   &lt;--------------- works for string variable\nDataObj.SetImage strImageFilePath &lt;----------- Error Method not available\n\nDataObj.PutInClipboard\n</code></pre>\n"}, {"tags": ["vba", "excel", "visio", "organizational-chart"], "comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1489048132, "post_id": 42676044, "comment_id": 72503175, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff768971.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff768971.aspx</a> Have a go at it and post your code if you run into troubles"}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1489062886, "post_id": 42676044, "comment_id": 72513031, "body": "This question seems a bit too broad to answer.  If you have any specific question about doing something in Visio VBA, ask that.  It&#39;s definitely possible to do what you want though.  I don&#39;t know if you&#39;re looking to change the behavior of Visio&#39;s built-in org chart tool, or just roll your own from scratch.  If you&#39;re doing one from scratch then you need to know how to read the spreadsheet from Visio, how to drop shapes on a page and position them, and how to glue arrows.  So I&#39;d start by looking at how to do each of those things, and ask if you can&#39;t find resources."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7769454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61bae39d44ce6908794a9408e1327c2?s=128&d=identicon&r=PG", "display_name": "John Visio MVP", "link": "https://stackoverflow.com/users/7769454/john-visio-mvp"}, "is_accepted": true, "score": 1, "last_activity_date": 1490533429, "creation_date": 1490533429, "answer_id": 43029081, "question_id": 42676044, "link": "https://stackoverflow.com/questions/42676044/excel-vba-to-create-visio-org-chart/43029081#43029081", "title": "Excel VBA to create Visio Org Chart", "body": "<p>The Visio OrgChart wizard can round trip data. You can use an Excel file to create a Visio OrgChart, modify it and then export the information back to Excel but... The OrgChart wizard randomly places the individuals on the page so whatever order you tried to put in the Excel file is lost. There is a 3rd party OrgChart wizard that will respect your order, but I do not have the details at hand.\nAs to the version issue, you will have to save the Excel file in an older format that Visio 10 can handle.</p>\n"}], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1505, "favorite_count": 0, "accepted_answer_id": 43029081, "answer_count": 1, "score": 0, "last_activity_date": 1490533429, "creation_date": 1488988673, "question_id": 42676044, "link": "https://stackoverflow.com/questions/42676044/excel-vba-to-create-visio-org-chart", "title": "Excel VBA to create Visio Org Chart", "body": "<p>My boss has asked me to try to figure out a way to automate our company's org charts. They have been using Visio and would like to continue. So far they just take the previous years drawings and go in and manually do the changes to all of the positions. SO far I have taken all of the employee data, put it into an excel workbook, given each employee a unique ID number, and created a reports to column to put the ID number of the person each employee reports too. With that I can make the org charts in visio by importing data. I have two problems though:</p>\n\n<ol>\n<li><p>Visio makes orgcharts for every worksheet in the workbook. My boss wants to keep all of the past org chart data in one workbook, so I do not want to recreate every years org charts  by importing the excel workbook. </p></li>\n<li><p>The structure is not very good in Visio. I don't know if there is a way to get Visio to put the boxes in order by how I have them listed in Excel but that would be helpful. I have several people who report to one person, but one of them should be placed higher than the other (so in excel they would be directly the second row). Visio places people randomly through out their level of the hierarchy. </p></li>\n</ol>\n\n<p>I am new to VBA but have done a few small projects with it and a lot of research. I am wanting to know if anyone has any idea how to use VBA to create structured org charts in Visio using Excel data. (Also we have the 2016 excel version but only the 2010 Visio version so that has been a bit of  road block). Any help on this would be greatly appreciated!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3457, "user_id": 1143681, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1Q8mW.png?s=128&g=1", "display_name": "smoore4", "link": "https://stackoverflow.com/users/1143681/smoore4"}, "edited": false, "score": 0, "creation_date": 1488990638, "post_id": 42676040, "comment_id": 72478048, "body": "This is just asking for SQL Injection.  In any case you need to separate the parts coming from your Access form from the parts that you have hard-coded, like this:  &quot;( 30,&quot; &amp; [Forms]![Daily Appearance Sheet Verified]![FirstName] &amp; &quot;,&quot; &amp;..."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "edited": false, "score": 0, "creation_date": 1488990327, "post_id": 42676096, "comment_id": 72477831, "body": "Thank you for your response, i am almost there in getting the formatting correct now. I just changed my code above if you are able to help at all. Thanks again!"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1488988804, "creation_date": 1488988804, "answer_id": 42676096, "question_id": 42676040, "link": "https://stackoverflow.com/questions/42676040/breaking-vba-code-docmd-runsql-into-seperate-lines/42676096#42676096", "title": "Breaking VBA code docmd.runsql into seperate lines", "body": "<p>It is only 1 statement.  You have put the names of the controls in literally, needs to be like so <code>\"30 as e1, \" &amp; [Forms]![Daily Appearance Sheet Verified]![FirstName] &amp; \"......</code> also 'letter to client' and 'MC'  You could just used <code>VALUES (</code> rather than the select part</p>\n"}], "owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488992334, "creation_date": 1488988663, "last_edit_date": 1488992334, "question_id": 42676040, "link": "https://stackoverflow.com/questions/42676040/breaking-vba-code-docmd-runsql-into-seperate-lines", "title": "Breaking VBA code docmd.runsql into seperate lines", "body": "<pre><code> DoCmd.RunSQL _\n\"INSERT INTO dbo_TimerTable ( Minutes, ClientFirst, ClientLast, StartTime, EndTime, Reason, UserInitials, ClientID )\" &amp; _\n\"SELECT 30 AS Expr1, [Forms]![Daily Appearance Sheet Verified]![FirstName] AS Expr2, [Forms]![Daily Appearance Sheet Verified]![LastName] AS Expr3, Now() AS Expr4, Now() AS Expr5, \"Letter to Client\" AS Expr6, \"MC\" AS Expr7, [Forms]![Daily Appearance Sheet Verified]![ClientID] AS Expr8\"\"\n</code></pre>\n\n<p>I am trying to break this runsql command into separate lines. I currently have this command running through a while loop on a record set. I cannot seem to get this sql to work correctly. Any help is appreciated and thank you!</p>\n\n<p>EDIT:</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO dbo_TimerTable \" _\n&amp; \"(Minutes, ClientFirst, ClientLast, StartTime, EndTime, Reason, UserInitials, ClientID ) VALUES\" _\n&amp; \"( 30, &amp; [Forms]![Daily Appearance Sheet Verified]![FirstName], &amp; [Forms]![Daily Appearance Sheet Verified]![LastName], Now(), Now(), \" &amp; \"Letter to Client\", \"MC\", [Forms]![Daily Appearance Sheet Verified]![ClientID]\n</code></pre>\n\n<p>I changed my code to this now and i just need help with the formating of the values, i am getting stuck on when to put &amp; for the variables. Thanks again!</p>\n"}, {"tags": ["ms-access", "printing", "vba"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "edited": false, "score": 0, "creation_date": 1489002081, "post_id": 42679525, "comment_id": 72485142, "body": "Yes, but i try with a macro to print but happened this, <a href=\"http://imgur.com/a/MNRwS\" rel=\"nofollow noreferrer\">link image</a>. I want that, <b>Paga 1 of 1</b>, is in auto height, and not in format acces for default."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "edited": false, "score": 0, "creation_date": 1489013070, "post_id": 42679525, "comment_id": 72490799, "body": "Sorry, don&#39;t understand that. What do you mean by &#39;in auto height&#39; and &#39;not in format access for default&#39;."}, {"owner": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "edited": false, "score": 0, "creation_date": 1489022382, "post_id": 42679525, "comment_id": 72493825, "body": "I want the printed ticket to be adapted to the length of the customer&#39;s purchase to the order quantity, and not as it is in the image that I put in the previous comment, which as you can see, only two articles, but there is still a space in White of the generated report."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "edited": false, "score": 0, "creation_date": 1489032463, "post_id": 42679525, "comment_id": 72496482, "body": "You want to eliminate white space between records and page footer so the page number prints just under the last record? This is an issue I have never seen a solution for."}, {"owner": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "edited": false, "score": 0, "creation_date": 1489035131, "post_id": 42679525, "comment_id": 72497301, "body": "Thanks for all, i try to use the configure when install driver for that ticket printer"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1488998900, "creation_date": 1488998900, "answer_id": 42679525, "question_id": 42675828, "link": "https://stackoverflow.com/questions/42675828/how-confifure-ticket-printer-in-ms-access/42679525#42679525", "title": "How confifure ticket printer in ms access", "body": "<p>The ticket output is based on an Access report? I expect the report will have to be a report/subreport design with textboxes and labels on the subreport arranged vertically. </p>\n\n<p>This presumes conventional normalized data structure with a parent table for the order header info and a related dependent table with products ordered details.</p>\n"}], "owner": {"reputation": 387, "user_id": 4756890, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh5.googleusercontent.com/-pfnyEtqrofQ/AAAAAAAAAAI/AAAAAAAACzI/_TfvrNvu2WA/photo.jpg?sz=128", "display_name": "Pedro Miguel Pimienta Morales", "link": "https://stackoverflow.com/users/4756890/pedro-miguel-pimienta-morales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488998900, "creation_date": 1488988110, "question_id": 42675828, "link": "https://stackoverflow.com/questions/42675828/how-confifure-ticket-printer-in-ms-access", "title": "How confifure ticket printer in ms access", "body": "<p>I have <strong>Epson M244A</strong> for print ticket in the store, but i don't know how to configurate the sheet size(width and heigth), for one a multiples objects for each product sell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dB9Nj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dB9Nj.png\" alt=\"Image example\"></a></p>\n\n<p>For example, how to do, when have one item (Ticket 1) and multiples item's (Ticket 2).</p>\n"}, {"tags": ["excel", "vbscript", "scheduled-tasks", "taskscheduler", "vba"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1489000728, "post_id": 42675530, "comment_id": 72484299, "body": "Add logging to your script, to see where it actually hangs (something like <code>CreateObject(&quot;WScript.Shell&quot;).LogEvent 4, &quot;some marker&quot;</code> after each statement). That will probably show that the issue is caused by the macro you&#39;re invoking, so you&#39;d need to do the same thing there. Report back with your findings if you need further help."}, {"owner": {"reputation": 493, "user_id": 3396539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/h2xhY.jpg?s=128&g=1", "display_name": "pallupz", "link": "https://stackoverflow.com/users/3396539/pallupz"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1489056058, "post_id": 42675530, "comment_id": 72508549, "body": "@AnsgarWiechers Thanks for the tip. I tried adding a log entry before and after every line of the above code to find where the issue is. It looks like, in &quot;Run whether user is logged on or not&quot; mode, the code gets stuck at the very first line of creating Excel object! It&#39;s not executing even that one line successfully."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1489070471, "post_id": 42675530, "comment_id": 72518183, "body": "Did you try running the script with the 64-bit interpreter (<code>%windir%\\system32\\cscript.exe</code>)?"}, {"owner": {"reputation": 493, "user_id": 3396539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/h2xhY.jpg?s=128&g=1", "display_name": "pallupz", "link": "https://stackoverflow.com/users/3396539/pallupz"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1489155642, "post_id": 42675530, "comment_id": 72560981, "body": "@AnsgarWiechers Yes, I did. Same result. Gets stuck at the first line."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1489157440, "post_id": 42675530, "comment_id": 72562232, "body": "Weird. Any auto-loading workbooks/macros perhaps? Do you get the same behavior if you start the task under a different (new) user?"}], "owner": {"reputation": 493, "user_id": 3396539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/h2xhY.jpg?s=128&g=1", "display_name": "pallupz", "link": "https://stackoverflow.com/users/3396539/pallupz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488987310, "creation_date": 1488987310, "last_edit_date": 1531161705, "question_id": 42675530, "link": "https://stackoverflow.com/questions/42675530/unable-to-schedule-vb-script-to-run-whether-user-is-logged-on-or-not", "title": "Unable to schedule VB Script to run whether user is logged on or not", "body": "<p>I have a small VB Script that does the following</p>\n\n<ol>\n<li>Access an Excel file in a network path</li>\n<li>Run a macro in it</li>\n<li>Save the Excel as a CSV in the same path</li>\n</ol>\n\n<p>Below is the code of the same</p>\n\n<pre><code>Set objexcel = CreateObject(\"Excel.Application\")\nobjexcel.Interactive = False\nobjExcel.DisplayAlerts = FALSE\nobjexcel.Visible = FALSE\n\nobjexcel.Application.Run \"'\\\\network_path\\XL_Filename.xlsm'!MacroName\"\n\nobjexcel.ActiveWorkbook.Save\nobjexcel.ActiveWorkbook.SaveAs(\"\\\\network_path\\CSV_Filename.csv\"), 6\nobjexcel.ActiveWorkbook.Close\nobjexcel.Quit\n</code></pre>\n\n<p>When its run from my machine manually, the code executes perfectly. The trouble is when I try to schedule this VBS in Windows Task Scheduler.</p>\n\n<p>In the Scheduler, if I select \"Run only when user is logged on\", it runs fine. However, if instead I select \"Run whether user is logged on or not\", the task gets stuck at Running.</p>\n\n<p>The Action in Task is <code>\"%windir%\\syswow64\\cscript.exe\" //nologo //B \"C:\\Users\\MyID\\Documents\\Script.VBS\"</code></p>\n\n<p>I have tried everything I know and read online</p>\n\n<ul>\n<li>Making sure to use CSCRIPT and no interactive elements</li>\n<li>Checking folder accesses and ID accesses (incl. DCOMCNFG)</li>\n<li>Creating folders C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop and  C:\\Windows\\System32\\config\\systemprofile\\Desktop</li>\n<li>Running with admin rights</li>\n<li>Disabling UAC</li>\n</ul>\n\n<p>Nothing seems to work. Could someone please help me figure out what am I not doing correctly?!</p>\n"}, {"tags": ["excel", "autocad", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488986823, "post_id": 42675224, "comment_id": 72475126, "body": "You should check the MSDN documentation if the objects you call are available in excel. For example SolidObject and NewRegionObject"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488987706, "post_id": 42675224, "comment_id": 72475793, "body": "First off, did you load AutoCad library into your VBA project?"}, {"owner": {"reputation": 5, "user_id": 7674249, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212441059567156/picture?type=large", "display_name": "Thomas Heesom", "link": "https://stackoverflow.com/users/7674249/thomas-heesom"}, "edited": false, "score": 0, "creation_date": 1488988463, "post_id": 42675224, "comment_id": 72476380, "body": "Yeah, I loaded it in"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1488996200, "creation_date": 1488996200, "answer_id": 42678655, "question_id": 42675224, "link": "https://stackoverflow.com/questions/42675224/adapt-autocad-vba-to-work-in-excel/42678655#42678655", "title": "Adapt AutoCAD VBA to work in Excel", "body": "<p>you could use this function to see if there's a running instance of AutoCad and, if there is, get it:</p>\n\n<pre><code>Function Set_Acad(Acad As AcadApplication) As Boolean\n    On Error Resume Next\n    Set Acad = GetObject(, \"AutoCAD.Application\") 'Get a running instance of the class AutoCAD.Application\n    On Error GoTo 0\n    Set_Acad = Not Acad Is Nothing\nEnd Function\n</code></pre>\n\n<p>to be exploited in your main code as follows:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Section()\n    Dim SolidObject As Acad3DSolid\n    Dim NewRegionObject As AcadRegion\n    Dim PlaneOrigin As Variant\n    Dim PlaneXaxisPoint As Variant\n    Dim PlaneYaxisPoint As Variant\n    Dim PickedPoint As Variant\n\n    Dim Acad As AcadApplication '&lt;--| declare a variable of type 'AcadApplication'\n\n    If Not Set_Acad(Acad) Then Exit Sub '&lt;--| exit if there's no Autocad running instance, otehrwise set 'Acad' variable to it\n\n    With Acad.ActiveDocument.Utility '&lt;--| now you can use Acad to reference 'Autocad' application and all its objects/methods/properties\n\n        On Error Resume Next\n       .GetEntity SolidObject, PickedPoint, vbCr &amp; \"Select solid to cut.\"\n        If Err Then\n            MsgBox \"Selected solid must be a 3DSolid\"\n            Set Acad = Nothing\n            Exit Sub\n        End If\n        On Error GoTo 0\n\n        PlaneOrigin = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define origin.\")\n        PlaneXaxisPoint = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define x-axis.\")\n        PlaneYaxisPoint = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define y-axis.\")\n        Dim minPoint As Variant, maxPoint As Variant\n        Set NewRegionObject = SolidObject.SectionSolid(PlaneOrigin, PlaneXaxisPoint, PlaneYaxisPoint)\n        With NewRegionObject\n            MsgBox \"Area: \" &amp; .area\n            MsgBox \"Perimeter: \" &amp; .Perimeter\n\n            .GetBoundingBox minPoint, maxPoint\n            MsgBox \"Min Point coordinates: (\" &amp; minPoint(0) &amp; \",\" &amp; minPoint(1) &amp; \",\" &amp; minPoint(2) &amp; \")\"\n            MsgBox \"Max Point coordinates: (\" &amp; maxPoint(0) &amp; \",\" &amp; maxPoint(1) &amp; \",\" &amp; maxPoint(2) &amp; \")\"\n        End With\n    End With\n\n    Set Acad = Nothing    \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11213720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JsfICKL03Ms/AAAAAAAAAAI/AAAAAAAAAJc/VLYaUQvkNEY/photo.jpg?sz=128", "display_name": "tracciatura.net", "link": "https://stackoverflow.com/users/11213720/tracciatura-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1553204902, "creation_date": 1553204902, "answer_id": 55289757, "question_id": 42675224, "link": "https://stackoverflow.com/questions/42675224/adapt-autocad-vba-to-work-in-excel/55289757#55289757", "title": "Adapt AutoCAD VBA to work in Excel", "body": "<p>Create a line in AutoCAD (must be opened) from Excel<br>\nBut you have to go in Tools->References and add [<strong>AutoCAD 20xx Type Library</strong>]</p>\n\n<pre><code>    Sub testline()\n    Dim app\n    Dim lineObj As AcadLine\n    Dim startPoint(0 To 2) As Double\n    Dim endPoint(0 To 2) As Double\n\n    On Error Resume Next\n        Set app = GetObject(, \"AutoCAD.Application\")\n    On Error GoTo 0\n\n    If (app Is Nothing) Then Exit Sub\n\n    startPoint(0) = 100\n    startPoint(1) = 100\n    startPoint(2) = 0\n    endPoint(0) = 200\n    endPoint(1) = 200\n    endPoint(2) = 0\n\n    Set lineObj = app.Documents(0).ModelSpace.AddLine(startPoint, endPoint)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7674249, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212441059567156/picture?type=large", "display_name": "Thomas Heesom", "link": "https://stackoverflow.com/users/7674249/thomas-heesom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 1, "accepted_answer_id": 42678655, "answer_count": 2, "score": 0, "last_activity_date": 1553204902, "creation_date": 1488986572, "last_edit_date": 1531164843, "question_id": 42675224, "link": "https://stackoverflow.com/questions/42675224/adapt-autocad-vba-to-work-in-excel", "title": "Adapt AutoCAD VBA to work in Excel", "body": "<p>I have written a code (with help) that works in AutoCAD VBA but I'd like to adapt it so I can run it from Excel and integrate it into a longer macro. I've tried replacing <code>ThisDrawing</code> with <code>ACAD.ActiveDocument</code> but this isn't working. Here's my full AutoCAD VBA code:</p>\n\n<pre><code>Public Sub Section()\n    Dim SolidObject As Acad3DSolid\n    Dim NewRegionObject As AcadRegion\n    Dim PlaneOrigin As Variant\n    Dim PlaneXaxisPoint As Variant\n    Dim PlaneYaxisPoint As Variant\n    Dim PickedPoint As Variant\n    On Error Resume Next\n    With ThisDrawing.Utility\n        .GetEntity SolidObject, PickedPoint, vbCr &amp; \"Select solid to cut.\"\n        If Err Then\n            MsgBox \"Selected solid must be a 3DSolid\"\n            Exit Sub\n        End If\n        PlaneOrigin = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define origin.\")\n        PlaneXaxisPoint = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define x-axis.\")\n        PlaneYaxisPoint = .GetPoint(PickedPoint, vbCr &amp; \"Select point to define y-axis.\")\n        Dim minPoint As Variant, maxPoint As Variant\n        Set NewRegionObject = SolidObject.SectionSolid(PlaneOrigin, PlaneXaxisPoint, PlaneYaxisPoint)\n        With NewRegionObject\n            MsgBox \"Area: \" &amp; .Area\n            MsgBox \"Perimeter: \" &amp; .Perimeter\n\n            .GetBoundingBox minPoint, maxPoint\n            MsgBox \"Min Point coordinates: (\" &amp; minPoint(0) &amp; \",\" &amp; minPoint(1) &amp; \",\" &amp; minPoint(2) &amp; \")\"\n            MsgBox \"Max Point coordinates: (\" &amp; maxPoint(0) &amp; \",\" &amp; maxPoint(1) &amp; \",\" &amp; maxPoint(2) &amp; \")\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488987434, "post_id": 42675164, "comment_id": 72475585, "body": "You&#39;re in MS-Access, are you not (I edited the tags)? <code>Workbooks</code> doesn&#39;t exist in Access, hence the error you&#39;re getting. You need to reference the Excel object model, create an instance of <code>Excel.Application</code> (call it say <code>xlApp</code>), and then use <code>xlApp.Workbooks.Open</code> to get the workbook object (call it say <code>xlBook</code>), and then do <code>xlBook.Worksheets.Add</code> to add a worksheet. The <code>Worksheets</code> collection doesn&#39;t exist in Access either."}, {"owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "edited": false, "score": 0, "creation_date": 1488987605, "post_id": 42675164, "comment_id": 72475708, "body": "Yes. Thanks for that"}, {"owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488987986, "post_id": 42675164, "comment_id": 72475996, "body": "I tried the below code and it didn&#39;t work. I want to add a new sheet to the excel work book i created using -<i>DoCmd.TransferSpredsheet</i>                                                      <code>Private Sub Command1685_Click() xlApp = Excel.Application DoCmd.TransferSpreadsheet acExport, , &quot;Query&quot;, &quot;Report&quot; &amp; &quot;_&quot; &amp; Format(Date, &quot;yyyy-mm-dd&quot;) &amp; &quot;.xlsx&quot;, True, &quot;BRReport&quot; xlBook = xlApp.Workbooks.Open xlBook.Worksheet.Add End Sub</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488988124, "post_id": 42675164, "comment_id": 72476103, "body": "If you have very little to no knowledge, then you need to do a bit of research. This question is answered several hundreds of times over already. go to Tools &gt; References... &gt; Microsoft Excel {version} to add a reference to the Excel object model if you want to use types defined in the Excel type library."}, {"owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488988615, "post_id": 42675164, "comment_id": 72476520, "body": "I understand .. I did searc for the answers but most of them did not involve exporting a query into an excel workbook and then adding a new sheet to it. That is where i was stuck. i just need some help  executing it. Thanks for your help"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488988701, "post_id": 42675164, "comment_id": 72476593, "body": "Makes no difference - you&#39;ve exported the workbook already, so your use case is identical to anyone trying to open a workbook in Excel, given a filename, from an Access VBA project."}, {"owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489077319, "post_id": 42675164, "comment_id": 72523357, "body": "I still am facing issues implementing this. Please let me know what I am doing wrong.       <code>Private Sub Command1679_Click()  DoCmd.TransferSpreadsheet acExport, , &quot;SQL QueryName&quot;, &quot;C:&#47;Report&quot; &amp; &quot;_&quot; &amp; Format(Date, &quot;yyyy-mm-dd&quot;) &amp; &quot;.xlsx&quot;, True, &quot;Sheet1&quot;  Dim objexcel As Excel.Application Dim wbexcel As Excel.Workbook  Set objexcel = CreateObject(&quot;Excel.Application&quot;)  Set wbexcel = objexcel.Workbooks.Open(&quot;C:&#47;Report&quot; &amp; &quot;_&quot; &amp; Format(Date, &quot;yyyy-mm-dd&quot;))  Set objexcel = wbexcel.Worksheets.Add()  End Sub</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489077373, "post_id": 42675164, "comment_id": 72523394, "body": "If the linked question doesn&#39;t fix your problem, <a href=\"https://stackoverflow.com/posts/42675164/edit\">edit</a> your question and tell us how it&#39;s different - we&#39;ll reopen it accordingly."}, {"owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489082044, "post_id": 42675164, "comment_id": 72526480, "body": "edited the question as suggested."}], "owner": {"reputation": 13, "user_id": 7243202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d29f10e574c0f8ddfd92d359d58fd?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen Subramanian", "link": "https://stackoverflow.com/users/7243202/naveen-subramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1488987738, "answer_count": 0, "score": 0, "last_activity_date": 1489079513, "creation_date": 1488986428, "last_edit_date": 1489079513, "question_id": 42675164, "link": "https://stackoverflow.com/questions/42675164/add-new-sheets-to-the-exported-excel-using-vba-and-do-a-lookup-between-two-sheet", "closed_reason": "Duplicate", "title": "Add new sheets to the exported excel using vba and do a lookup between two sheets using access VBA", "body": "<p>I have a query in Access DB which I need to export to an excel workbook. In the same excel workbook I want to add 2 more excel sheet - one with no data and the other with a pre-coded (using access vba) vlookup/dlookup between sheet1 and sheet2. Below is the code i am using to create export the data but i am not able to add new sheets to it. When i click on the button which is embedded to the below script the access DB hangs. Appreciate any assistance/guidance. How to add additional sheets and how to do a lookup between them. Thanks.</p>\n\n<pre><code>Private Sub Command1679_Click()\nDoCmd.TransferSpreadsheet acExport, , \"SQL QueryName\", \"C:/Report\" &amp; \"_\" &amp; Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\", True, \"Sheet1\"\n\nDim objexcel As Excel.Application\nDim wbexcel As Excel.Workbook\n\nSet objexcel = CreateObject(\"Excel.Application\")\nSet wbexcel = objexcel.Workbooks.Open(\"C:/Report\" &amp; \"_\" &amp; Format(Date, \"yyyy-mm-dd\"))\n\nSet objexcel = wbexcel.Worksheets.Add()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "oracle12c", "vba"], "owner": {"reputation": 2373, "user_id": 1819427, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/AqNgV.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/1819427/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 945, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488986048, "creation_date": 1488986048, "last_edit_date": 1592644375, "question_id": 42675031, "link": "https://stackoverflow.com/questions/42675031/how-to-connect-to-oracle-12c-db-with-vba", "title": "How to connect to Oracle 12c DB with VBA", "body": "<p>I have added a reference to Microsoft ActiveX Data Object 2.0 Library, and tried to execute the following code:</p>\n<pre><code>Sub Ora_Connection()\n    Dim con As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim query As String\n    Set con = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n\n    strCon = &quot;Driver={Microsoft ODBC for Oracle}; &quot; &amp; _\n        &quot;CONNECTSTRING=(DESCRIPTION=&quot; &amp; _\n        &quot;(ADDRESS=(PROTOCOL=TCP)&quot; &amp; _\n        &quot;(HOST=****)(PORT=****))&quot; &amp; _\n        &quot;(CONNECT_DATA=(SERVICE_NAME=****))); uid=****; pwd=****;&quot;\n\n    con.Open (strCon)\n\nEnd Sub\n</code></pre>\n<p>I am getting these errors:</p>\n<p><a href=\"https://i.stack.imgur.com/xuz1H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xuz1H.png\" alt=\"Error1\" /></a>\n<a href=\"https://i.stack.imgur.com/dExDs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dExDs.png\" alt=\"Error2\" /></a></p>\n<p>I have tried installing Oracle instant client ODBC drivers (I've tried 32bit and 64 bit versions) and I am having no luck.</p>\n<p>I am not sure what the problem is.  I can connect to the database in Visual Studio 2012 with VB.Net, but I am unable to connect in excel 2010 using VBA.</p>\n<p>Any insight would be greatly appreciated!</p>\n"}, {"tags": ["vba", "substitution", "save-as"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488985645, "post_id": 42674587, "comment_id": 72474277, "body": "If the <code>ActiveWorkbook</code> is a fresh new workbook that is not saved yet, its name will be something like <code>Book1</code> so it wont match any of those extensions. What do you want to do in that case?"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1488986157, "post_id": 42674587, "comment_id": 72474623, "body": "In the case where the excel file is extracted from a separate application (and has a pre-determined file name) or in the case where a new book (Book1) is created, I would like it save as the current name (whichever of the 2 it is) - so Book1.xlsx"}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "edited": false, "score": 0, "creation_date": 1488997823, "post_id": 42675991, "comment_id": 72482555, "body": "thanks for the response. I tried this out and found the following:"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1488999276, "last_edit_date": 1488999276, "creation_date": 1488988527, "answer_id": 42675991, "question_id": 42674587, "link": "https://stackoverflow.com/questions/42674587/vba-saving-file-to-my-personal-desktop-code/42675991#42675991", "title": "vba - saving file to my personal desktop code", "body": "<p>Is this what you are trying to do?</p>\n\n<pre><code>Sub SavetoDesktop()\n    'this macro will save the activesheet into the default path giving it the current name and xlsx extension\n    Dim fname As String\n    Select Case True\n        Case ActiveWorkbook.Name Like \"*.xlsx\", _\n             ActiveWorkbook.Name Like \"*.xlsm\", _\n             ActiveWorkbook.Name Like \"*.xls\", _\n             ActiveWorkbook.Name Like \"*.csv\"\n             fname = Application.DefaultFilePath &amp; \"\\\" &amp; ActiveWorkbook.Name\n        Case Else\n            msgBox \"No file extension. Will be saved as .xlsx in the Desktop folder\"\n            fname = Environ$(\"HOMEDRIVE\") &amp; Environ$(\"HOMEPATH\") &amp; \"\\Desktop\\\" &amp; ActiveWorkbook.Name &amp; \".xlsx\"\n    End Select\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.SaveAs Filename:=fname\n    msgBox IIf(Err.Number, \"Could not Save\", \"Saved\")\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1488998654, "creation_date": 1488998654, "answer_id": 42679442, "question_id": 42674587, "link": "https://stackoverflow.com/questions/42674587/vba-saving-file-to-my-personal-desktop-code/42679442#42679442", "title": "vba - saving file to my personal desktop code", "body": "<p>thanks for the response. I tried this out and found the following: 1) The msgbox popped up when I tried saving Book1, and then it said \"could not save\" , and it did not save to desktop. For already saved files, I just got the \"could not save\" msgbox. I've never seen the \"LIKE\" and the \"<em>\" syntax (at least in VBA, have seen in SQL). Is the like used for patterns in strings? and does the \"</em>\" function as a wildcard for anything before or after? I also used a select case statement and found it was successful. I'll post below. Thanks again for the reply.</p>\n\n<pre><code>Sub SavetoDesktop()\n\n'this macro will save the activesheet into the default path giving it the current name and xlsx extension,\n' unless it already has an extension of the 4 most common formats, then it will simply save over \n'(replace) the current file w a prompt\n\n\nDim fname As String\n\nOn Error GoTo errormessage\n\nSelect Case Right(ActiveWorkbook.Name, 4)\nCase \"xlsx\"\nfname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xlsx\", \"\") &amp; \".xlsx\"\nActiveWorkbook.SaveAs Filename:=fname\nCase \".xls\"\nfname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xls\", \"\") &amp; \".xls\"\nActiveWorkbook.SaveAs Filename:=fname\nCase \"xlsm\"\nfname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xlsm\", \"\") &amp; \".xlsm\"\nActiveWorkbook.SaveAs Filename:=fname\nCase \".csv\"\nfname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".csv\", \"\") &amp; \".csv\"\nActiveWorkbook.SaveAs Filename:=fname\nCase Else\nMsgBox \"Saved to desktop as .xlsx file!\"\nActiveWorkbook.SaveAs Filename:=\"C:\\Users\\mmirabelli\\Desktop\\\" &amp; ActiveWorkbook.Name &amp; \".xlsx\"\nEnd Select\n\nExit Sub\n\nerrormessage:\nMsgBox \"No action\", vbInformation + vbOKCancel, Time()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488999276, "creation_date": 1488984862, "question_id": 42674587, "link": "https://stackoverflow.com/questions/42674587/vba-saving-file-to-my-personal-desktop-code", "title": "vba - saving file to my personal desktop code", "body": "<p>I have the following code which is designed so I can quick save to my desktop and then put the file into a folder. This code works fine if the file is already saved in an .xls, .csv, .xlsx or .xlsm file extension, however, when the file IS NOT saved, I only get the pop-up message boxes, and nothing happens. I was thinking about re-structuring using a CASE STATEMENT with right(activeworkbook.name, 4), but didn't know how to structure as I am not familiar with these statements.  Thank you.</p>\n\n<pre><code>Sub SavetoDesktop()\n\n'this macro will save the activesheet into the default path giving it the current name and xlsx extension\n\n    Dim fname As String\n\n'    If Right(ActiveWorkbook.Name, 5) &lt;&gt; \".xlsx\" And Right(ActiveWorkbook.Name, 5) &lt;&gt; \".xls\" And _\n'    Right(ActiveWorkbook.Name, 5) &lt;&gt; \".xlsm\" And Right(ActiveWorkbook.Name, 5) &lt;&gt; \".csv\" Then\n\n                 If Right(ActiveWorkbook.Name, 5) = \".xlsx\" Then\n                         fname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xlsx\", \"\") &amp; \".xlsx\"\n                         ActiveWorkbook.SaveAs Filename:=fname\n                 Else\n                     MsgBox \"Not an .xlsx file!\"\n                     ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\mmirabelli\\Desktop\\\" &amp; ActiveWorkbook.Name &amp; \".xlsx\"\n                 End If\n\n                 If Right(ActiveWorkbook.Name, 4) = \".csv\" Then\n                         fname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".csv\", \"\") &amp; \".csv\"\n                         ActiveWorkbook.SaveAs Filename:=fname\n                 Else\n                     MsgBox \"Not an .csv file!\"\n                     MsgBox ActiveWorkbook.Name\n\n                 End If\n\n                 If Right(ActiveWorkbook.Name, 4) = \".xls\" Then\n                         fname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xls\", \"\") &amp; \".xls\"\n                         ActiveWorkbook.SaveAs Filename:=fname\n                  Else\n                     MsgBox \"Not an .xls file!\"\n                  End If\n\n                 If Right(ActiveWorkbook.Name, 5) = \".xlsm\" Then\n                         fname = Application.DefaultFilePath &amp; \"\\\" &amp; Application.WorksheetFunction.Substitute(ActiveWorkbook.Name, \".xlsm\", \"\") &amp; \".xlsm\"\n                         ActiveWorkbook.SaveAs Filename:=fname\n                 Else\n                    MsgBox \"Not an .xlsm file!\"\n                 End If\n\n'     Else\n'\n'     ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\mmirabelli\\Desktop\\\" &amp; ActiveWorkbook.Name &amp; \".xlsx\"\n\n'     End If\n\n\n'MsgBox Application.DefaultFilePath\n'MsgBox ActiveWorkbook.Name\n'\n'    ActiveWorkbook.SaveAs Filename:=fname\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1488987127, "post_id": 42674515, "comment_id": 72475360, "body": "Is there a specific reason you&#39;re opening a second instance of <code>Excel.Application</code> if the code you are running is in Excel VBA?"}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1488987410, "post_id": 42674515, "comment_id": 72475566, "body": "the hope was to be able to open up workbook 2 and not have it become visible. I was advised by other posts here on stackoverflow that the way to do this is to open a new application as the workbook object does not have a .visible property"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1488988223, "post_id": 42674515, "comment_id": 72476178, "body": "Okay fair enough. The issue may lie with the fact that you are using <code>Application.Run</code> to call your <code>CheckSpreadsheet</code> subroutine which will initiate from your first instance of Excel, you are then passing an <code>Excel.Workbook</code> variable that is open in your second instance of Excel. Try replacing <code>Application.Run</code> with <code>app.Run</code> so it runs the subroutine from your second instance of Excel"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488988443, "post_id": 42674515, "comment_id": 72476362, "body": "^ that. <code>wbook.Activate</code> is trying to activate a workbook that is in another Excel instance. ...but why would you <code>.Activate</code> anything anyway? Also drop the parentheses around the <code>MsgBox</code> arguments: <code>MsgBox ActiveSheet.Name</code>."}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1488997696, "post_id": 42674515, "comment_id": 72482488, "body": "Thank you for all of your comments. The only issue remaining is that the macro in spreadsheet 2 doesn&#39;t seem to do anything; the wosheet.Cells(5, 5) = &quot;Hello world!&quot; - see updated code"}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1489000575, "post_id": 42674515, "comment_id": 72484217, "body": "Issue here is workbook was being opened as read only. Issue resolved. Thanks for all your help!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1489002442, "post_id": 42674515, "comment_id": 72485340, "body": "Trying to save a ReadOnly file gives a Run-time error 1004. It seems that there is an <code>On Error Resume Next</code> somewhere before calling <code>LastWeekOfMonth</code> see <a href=\"http://stackoverflow.com/documentation/excel-vba/861/debugging-and-troubleshooting\">Debugging and Troubleshooting</a>"}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1488997752, "post_id": 42676678, "comment_id": 72482514, "body": "Thank you for all of your comments, and your help so far on this. Your way works, I&#39;m only having trouble making sure that I can close out of all of the workbooks and applications that I open, so I&#39;m not going to go with it for now. The issue remaining is that the macro in spreadsheet 2 doesn&#39;t seem to do anything; the wosheet.Cells(5, 5) = &quot;Hello world!&quot; - see updated code"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1488990406, "creation_date": 1488990406, "answer_id": 42676678, "question_id": 42674515, "link": "https://stackoverflow.com/questions/42674515/two-issues-saving-changes-in-an-instantiated-workbook-and-activating-other-wo/42676678#42676678", "title": "Two issues - saving changes in an instantiated workbook, and activating other workbooks", "body": "<p>Don't need to have another instance of Excel, the property to hide a workbook is <code>Windows</code>, in order to hide the excel windows used by the workbook. Also bear in mind that a workbook can have more than one window.</p>\n\n<p>If you are sure that the workbook you want to hide has only one window use this line:</p>\n\n<pre><code>Workbooks(\"WbkName\").Windows(1).Visible = False\n</code></pre>\n\n<p>If the workbook has several windows use this procedure:</p>\n\n<pre><code>Sub Wbk_Hide()\nDim wbk As Workbook, wdw As Window\n    Set wbk = Workbooks(\"WbkName\")   'Update as required\n    For Each wdw In wbk.Windows\n        wdw.Visible = False\n    Next\nEnd Sub\n</code></pre>\n\n<p>I believe this changes the scope of your procedures, let me know otherwise.</p>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488997605, "creation_date": 1488984702, "last_edit_date": 1488997605, "question_id": 42674515, "link": "https://stackoverflow.com/questions/42674515/two-issues-saving-changes-in-an-instantiated-workbook-and-activating-other-wo", "title": "Two issues - saving changes in an instantiated workbook, and activating other workbooks", "body": "<p>I have two spreadsheets; I'll call them spreadsheet 1 and spreadsheet 2. Spreadsheet one has a function which generates days of the month, and if it's at the end of the month, it is trying to call the module/sub in spreadsheet 2. This is to generate both \"daily\" reports and \"monthly\" reports. </p>\n\n<p>At this point, there are two errors: the first is when I am trying to save the new instance of spreadsheet 2 that I created. The error is that it asks to save the workbook in a macro-free format. I simply want to save it! Not to make any changes to formatting. I am not even sure that it is trying to save changes to the instantiated book object. </p>\n\n<p>the second is in spreadsheet 2, even though I set it to be active sheet (I think), the activesheet still comes up as the worksheet on spreadsheet 1 that runs the macro in the first place.</p>\n\n<p>Any help is appreciated.</p>\n\n<pre><code>    Option Explicit\nPublic Function LastWeekOfMonth() As Boolean\n\n'finds the current date\n    Dim CurrentDate As Date\n    CurrentDate = CDate(ActiveSheet.Cells(FIRST_DATA_ROW, 1))\n\n'find filepath and filename of the monthly documentation file\n    Dim mFilePath As String\n    Dim mFileName As String\n\n    mFilePath = \"F:\\Project Sweep\\Kim Checklist\\Barry Polinsky\\Brathwaite, Tamika\\\"\n    mFileName = Cells(3, 4) &amp; \".m_d.xlsm\"\n\n     'if it is the last week of the month, write a monthly report, and return true to continue with the face to face paperwork\n     If (31 - Day(CurrentDate)) &lt;= 7 Then\n        'write a monthly report\n        Dim app As New Excel.Application\n        Dim book As Excel.Workbook\n\n      '  app.Visible = False 'Visible is False by default, so this isn't necessary\n        Set book = app.Workbooks.Add(mFilePath &amp; mFileName)\n\n        'run the subroutine CheckSpreadsheet in module WriteReport in target book\n        app.Run \"'\" &amp; mFilePath &amp; mFileName &amp; \"'!\" &amp; \"WriteReport\" &amp; \".CheckSpreadsheet\", book\n      '  CheckSpreadsheet (book)\n\n\n\n\n        'error next line\n        book.Save\n        book.Close\n\n        app.Quit\n        Set app = Nothing\n        LastWeekOfMonth = True\n\n    'if it is not, simply continue with the face to face paperwork\n     Else\n        LastWeekOfMonth = False\n     End If\n\nEnd Function\n</code></pre>\n\n<p>In the target worksheet, in module WriteReport, subroutine CheckSpreadsheet, the following code is located.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CheckSpreadsheet(wbook As Excel.Workbook)\n\n\n    Set wosheet = wbook.Sheets(\"Monthly\")\n\nwosheet.Cells(5, 5) = \"Hello world!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1488983675, "post_id": 42674119, "comment_id": 72472763, "body": "<code>Z</code> is already a workbook and does not need the Workbook wrapper:"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1488983705, "post_id": 42674119, "comment_id": 72472790, "body": "So: <code>Z.SaveAs Filename:=&quot;PROVA.xlsx&quot;</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488983771, "post_id": 42674119, "comment_id": 72472843, "body": "Please take a minute to take the <a href=\"https://stackoverflow.com/tour\">tour</a> ;)"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1488984951, "post_id": 42674119, "comment_id": 72473766, "body": "A lot is wrong here. 1. You start the loop with C = 0 which will yield an invalid range (B0) the first time the loop is exectuted. 2. &quot;x&quot; is a literal string, but I think you need to use the Object variable X which points to a range, so Workbooks(x.Value).Open is the right syntax 3. Sheet2 is a literal string so needs quotes &quot;Sheet2&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1488985699, "post_id": 42674119, "comment_id": 72474310, "body": "@jkpieterse good catches. FWIW <code>Sheet2</code> might actually be an automatically created global-scope object referring to <code>ThisWorkbook.Sheet2</code> (which of course is going to go up in flames when you do <code>.Sheets(Sheet2)</code>; every sheet in an Excel VBA project can have a &quot;code name&quot;, an identifier that you can use in code to refer to that sheet, e.g. <code>ThisWorkbook.Sheets(&quot;SelectedFiles&quot;)</code> could have a <code>(name)</code> property of <code>SelectedFilesSheet</code> and then you can do <code>x = SelectedFilesSheet.Range(&quot;B&quot; &amp; C)</code>. Also <code>x</code> being assigned with <code>Set</code> makes <code>x</code> a <code>Range</code> object, which makes <code>.Open(x)</code> feel wrong."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1488986970, "post_id": 42674119, "comment_id": 72475239, "body": "@Mat&#39;sMug: I saw x is a range object so deliberately added the (default) .Value property to it. I don&#39;t like depending on the default property of an object (which is slower as well)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1488986995, "post_id": 42674119, "comment_id": 72475261, "body": "@jkpieterse absolutely agreed!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1488987158, "last_edit_date": 1488987158, "creation_date": 1488986835, "answer_id": 42675328, "question_id": 42674119, "link": "https://stackoverflow.com/questions/42674119/vba-copy-a-sheet-to-another-workbook/42675328#42675328", "title": "VBA - Copy a sheet to another workbook", "body": "<p>VBA is blowing up on this line:</p>\n\n<pre><code>Set x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)\n</code></pre>\n\n<p>Because the value of <code>C</code> is 0, and 0 isn't a valid row number - <code>B0</code> isn't a valid range address. So you could start with <code>C = 1</code> and that would fix <em>this</em> error.</p>\n\n<p>I'd strongly recommend using a <code>Long</code> integer (32-bit) instead of an <code>Integer</code> (16-bit) when referring to row numbers (regardless of which rows you need). The maximum value of an <code>Integer</code> is 32,767, and a worksheet can have many more rows than that.</p>\n\n<p><code>x</code> is declared as a <code>Variant</code>. This means it can be/become literally anything you make it.</p>\n\n<p>If you do this:</p>\n\n<pre><code>x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)\n</code></pre>\n\n<p>Then <code>x</code> will contain the value of the cell referred to by the <code>Range</code> call.</p>\n\n<p>However you did this:</p>\n\n<pre><code>Set x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)\n</code></pre>\n\n<p>This instructs VBA that <code>x</code> should contain an <em>object reference</em>, so instead of assigning it the <em>value</em> of the cell, you're getting <em>the cell itself</em>.</p>\n\n<p>Then you do this:</p>\n\n<pre><code>Worlbooks.Open(\"x\").Sheets(Sheet2).Range(\"A1:U1000\").Copy\n</code></pre>\n\n<p>If this compiles, it's only because <code>Option Explicit</code> isn't specified. <code>Worlbooks</code> doesn't exist anywhere, it's a typo - but because <code>Option Explicit</code> isn't specified, VBA allows you to use variables without declaring them, and so happily compiles <code>Worlbooks</code> and defers its resolution to run-time... at which point <em>another</em> error will pop up.</p>\n\n<p>This would fix it:</p>\n\n<pre><code>Workbooks.Open(\"x\").Sheets(Sheet2).Range(\"A1:U1000\").Copy\n</code></pre>\n\n<p>Except... it's inside the loop: at every iteration of that loop, you try to open a workbook named <code>\"x\"</code> (which most probably doesn't exist). If <code>\"x\"</code> means to be a file name contained in <code>ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)</code>, then <code>x</code> should be declared as a <code>String</code> variable, and you would refer to it like this:</p>\n\n<pre><code>Dim source As Workbook\nSet source = Workbooks.Open(x)\n</code></pre>\n\n<p>And you would do that <em>outside the loop</em>, so that you don't try to open the same workbook every time the loop makes an iteration: IIRC opening a workbook that's already opened will throw yet another run-time error.</p>\n\n<p>If each iteration should be working with a different workbook/file, then each iteration should also close that workbook, otherwise you end up with 12 workbooks opened, 11 of which you don't need anymore.</p>\n\n<p>So you keep a reference to the workbook object you want to work with:</p>\n\n<pre><code>For C = 1 To 11\n    x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C).Value\n    Set source = Worlbooks.Open(x)\n    source.Sheets(Sheet2).Range(\"A1:U1000\").Copy\n    '...\n    source.Close\nNext\n</code></pre>\n\n<p>Same with your <em>destination</em> book:</p>\n\n<pre><code>Set Z = Workbooks.Open(\"D:\\PTP\\MASTERDATA\\SPACCHETTAMENTO FILE\\TEMPLATE.Template.xlsx\")\n</code></pre>\n\n<p>You're opening the same file 11 times, and not closing it once. And then you paste from the <em>source</em> book into that <em>destination</em> book...</p>\n\n<pre><code>Z.Sheets(\"SPLIT TAB\").Range(\"A1:U1000\").PasteSpecial\n</code></pre>\n\n<p>...overwriting the previous iteration's work everytime, and saving 11 times.</p>\n\n<hr>\n\n<p>So, there's <em>a lot</em> of serious issues in that code. Recap:</p>\n\n<ul>\n<li>Specify <code>Option Explicit</code> at the top of every module.</li>\n<li>Declare all variables, with an explicit specific type whenever possible.</li>\n<li>Clean up after yourself.</li>\n</ul>\n\n<p>Learn to use the debugger. <kbd>F9</kbd> sets a breakpoint, which stops execution; from that point on you can use <kbd>F8</kbd> to run your code one instruction at a time, and you can use the <em>immediate pane</em> (<kbd>Ctrl</kbd>+<kbd>G</kbd>) to output anything in the current execution context. Use the <em>locals</em> toolwindow to visualize everything the current scope has access to.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 7678582, "user_type": "registered", "profile_image": "https://graph.facebook.com/1564892346873336/picture?type=large", "display_name": "Cheries Mewengkang", "link": "https://stackoverflow.com/users/7678582/cheries-mewengkang"}, "is_accepted": false, "score": 0, "last_activity_date": 1488987037, "creation_date": 1488987037, "answer_id": 42675413, "question_id": 42674119, "link": "https://stackoverflow.com/questions/42674119/vba-copy-a-sheet-to-another-workbook/42675413#42675413", "title": "VBA - Copy a sheet to another workbook", "body": "<p>you don't need to copy and paste data between Workbook as it will run more slowly. Here some example code, hope it can help you..!</p>\n\n<pre><code>Option Explicit\n\n    Public Sub SplitFile_Click()\n      Dim C As Integer\n      Dim x As Range\n      Dim Z As Workbook\n\n      For C = 1 To 10\n          Set x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)\n          Set Z = Workbooks.Open(\"D:\\Template.xlsx\")\n\n          Z.Sheets(\"SPLIT TAB\").Range(\"A1\") = x 'this code is faster that copy &amp; paste\n          Z.SaveAs \"PROVA\" &amp; C &amp; \".xlsx\" 'workbook should have a unique filename\n\n          Z.Close 'close workbook\n      Next C\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7678768, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-snqFb-yVN7I/AAAAAAAAAAI/AAAAAAAALDQ/hjJNbWiKDxs/photo.jpg?sz=128", "display_name": "Ivan Iuliano", "link": "https://stackoverflow.com/users/7678768/ivan-iuliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 999, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488987158, "creation_date": 1488983597, "last_edit_date": 1488983735, "question_id": 42674119, "link": "https://stackoverflow.com/questions/42674119/vba-copy-a-sheet-to-another-workbook", "title": "VBA - Copy a sheet to another workbook", "body": "<p>I want to copy a sheet (sheet2) from certain workbooks (paths in cell column \"B\") to another workbook (template).</p>\n\n<p>I tried the following one but Excel Return me the following error \"Run-time error '1004': Application-defined or object defined error\".</p>\n\n<pre><code>Private Sub SplitFile_Click()\n  Dim C As Integer\n  Dim x As Variant\n  Dim Z As Workbook\n\n  For C = 0 To 10\n\n  Set x = ThisWorkbook.Sheets(\"SelectedFiles\").Range(\"B\" &amp; C)\n  Worlbooks.Open(\"x\").Sheets(Sheet2).Range(\"A1:U1000\").Copy\n  Set Z = Workbooks.Open(\"D:\\PTP\\MASTERDATA\\SPACCHETTAMENTO FILE\\TEMPLATE.Template.xlsx\")\n\n\n  Z.Sheets(\"SPLIT TAB\").Range(\"A1:U1000\").PasteSpecial\n  Workbooks(\"Z\").SaveAs Filename:=\"PROVA.xlsx\"\n  Next C\nEnd Sub\n</code></pre>\n\n<p>Can you help me?</p>\n\n<p>Thanks,\nIvan</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1490808271, "post_id": 42681389, "comment_id": 73281998, "body": "This is perfect! Thank you! I&#39;ve got one more request if possible. If I want to &#39;cyanize&#39; non bold text excluding bullet point, is that possible?"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "reply_to_user": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1490859911, "post_id": 42681389, "comment_id": 73303204, "body": "If oChar.Bold = False And oChar.ListFormat.ListType &lt;&gt; wdListBullet Then"}, {"owner": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1490893273, "post_id": 42681389, "comment_id": 73327289, "body": "Thanks, however it doesn&#39;t quite work as I wanted. The change suggested means any text alongside a bullet point is not &#39;cyanized&#39; (whether bolded or unbolded). I want all unbolded text cyanized, just not the bullet symbols. Apologies for the hassle, if my request is possible somehow please let me know? I&#39;ve edited the original post with a picture to illustrate this."}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "reply_to_user": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1490894109, "post_id": 42681389, "comment_id": 73327772, "body": "Oh you mean the bullet itself should be cyan?"}, {"owner": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1490899063, "post_id": 42681389, "comment_id": 73330673, "body": "No, the bullet should be black/remain whatever color it originally was. Eg <a href=\"https://i.stack.imgur.com/Thw1C.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/Thw1C.png</a>. The change you recommended (If oChar.Bold = False And oChar.ListFormat.ListType &lt;&gt; wdListBullet Then) basically prevents any text next to a bullet point being cyanized."}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "reply_to_user": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "edited": false, "score": 0, "creation_date": 1491781072, "post_id": 42681389, "comment_id": 73691000, "body": "It might not be the most optimized way to do it, but for every character is made bold, I check if it has any listparagraphs (= there is by definition only one), then if so, I get the ListLevel object via the ListLevelNumber, whose Font.ColorIndex can in turn be set"}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1491780958, "last_edit_date": 1491780958, "creation_date": 1489005169, "answer_id": 42681389, "question_id": 42674003, "link": "https://stackoverflow.com/questions/42674003/select-unbolded-text-change-its-colour-of-a-selected-paragraph-ms-word-vba/42681389#42681389", "title": "Select unbolded text &amp; change its colour (of a selected paragraph)- MS Word VBA Macro", "body": "<p>You look through every character in the selected text, then colour it if it isn't bold:</p>\n\n<pre><code>Option Explicit\n\nSub CyanizeNonBoldInSelection()\n    Dim oRange As range\n    Dim oChar As range\n    Dim oListFormat As ListFormat\n\n    Application.UndoRecord.StartCustomRecord \"CyanizeNonBoldInSelection\"\n\n    Set oRange = Selection.range\n\n    For Each oChar In oRange.Characters\n\n        If oChar.Bold = False Then\n\n            oChar.Font.ColorIndex = wdTurquoise\n\n            If oChar.ListParagraphs.Count &gt; 0 Then\n                Set oListFormat = oChar.ListParagraphs(1).range.ListFormat\n                oListFormat.ListTemplate.ListLevels(oListFormat.ListLevelNumber).Font.ColorIndex = wdTurquoise\n            End If\n\n        End If\n    Next oChar\n\n    Application.UndoRecord.EndCustomRecord\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5630287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580550b715024b847f46bf8b88cd64ba?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5630287/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1491780958, "creation_date": 1488983327, "last_edit_date": 1490893333, "question_id": 42674003, "link": "https://stackoverflow.com/questions/42674003/select-unbolded-text-change-its-colour-of-a-selected-paragraph-ms-word-vba", "title": "Select unbolded text &amp; change its colour (of a selected paragraph)- MS Word VBA Macro", "body": "<ul>\n<li>I would like to select a piece of text in MS Word 2010 document.  </li>\n<li>Then using a macro: select the unbolded text &amp; change the colour of that text to blue</li>\n</ul>\n\n<p>NB: I don't want to do this to the whole of the document text, just to the paragraph/block of text I have selected)</p>\n\n<p>Picture demonstrating what I would like to do:</p>\n\n<p><img src=\"https://i.stack.imgur.com/oIECd.png\" alt=\"pic\"></p>\n\n<p>I have tried creating the following macro - but it for some reason makes all of the text (bolded and unbolded) blue</p>\n\n<pre><code>    Sub MakeUnboldedTextBlue()\n'\n' MakeUnboldedTextBlue Macro\n'\n'\n    Selection.Find.ClearFormatting\n    Selection.Find.Font.Bold = False\n    With Selection.Find\n        .Text = \"\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Font.Color = 15773696\nEnd Sub\n</code></pre>\n\n<p>Update:\nI would also like to exclude the bullet symbols from 'cyanizisation' (if possible)</p>\n\n<p>For example:\n<a href=\"https://i.stack.imgur.com/Thw1C.png\" rel=\"nofollow noreferrer\">Example of the bullet symbols not being cyanized</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 400, "user_id": 6715663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868308a7044f1255729afc807a446497?s=128&d=identicon&r=PG&f=1", "display_name": "MertTheGreat", "link": "https://stackoverflow.com/users/6715663/mertthegreat"}, "edited": false, "score": 0, "creation_date": 1488982956, "post_id": 42673708, "comment_id": 72472188, "body": "yes it works thank you."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488983066, "post_id": 42673708, "comment_id": 72472279, "body": "Welcome to SO, please take a minute to take the <a href=\"https://stackoverflow.com/tour\">tour</a> (click it) to see how SO community works : accepting answers and upvotes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1488983738, "post_id": 42673708, "comment_id": 72472813, "body": "See <a href=\"http://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a>"}, {"owner": {"reputation": 400, "user_id": 6715663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868308a7044f1255729afc807a446497?s=128&d=identicon&r=PG&f=1", "display_name": "MertTheGreat", "link": "https://stackoverflow.com/users/6715663/mertthegreat"}, "edited": false, "score": 0, "creation_date": 1488999535, "post_id": 42673708, "comment_id": 72483607, "body": "great article, thanks..."}], "answers": [{"comments": [{"owner": {"reputation": 400, "user_id": 6715663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868308a7044f1255729afc807a446497?s=128&d=identicon&r=PG&f=1", "display_name": "MertTheGreat", "link": "https://stackoverflow.com/users/6715663/mertthegreat"}, "edited": false, "score": 0, "creation_date": 1488982909, "post_id": 42673759, "comment_id": 72472144, "body": "It works fine, I cannot thank you enough. It bugged me all day."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 400, "user_id": 6715663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868308a7044f1255729afc807a446497?s=128&d=identicon&r=PG&f=1", "display_name": "MertTheGreat", "link": "https://stackoverflow.com/users/6715663/mertthegreat"}, "edited": false, "score": 1, "creation_date": 1488983020, "post_id": 42673759, "comment_id": 72472242, "body": "My pleasure. It&#39;s a very common problem."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1488982708, "creation_date": 1488982708, "answer_id": 42673759, "question_id": 42673708, "link": "https://stackoverflow.com/questions/42673708/excel-vba-using-variables-in-cells-and-range-function/42673759#42673759", "title": "Excel VBA Using Variables in Cells and Range Function", "body": "<p>Try this. You need to qualify all the range/cells references in case aws is not the active sheet when the macro is run.</p>\n\n<pre><code>Dim lastrow as Long\nDim lastcolumn as Long\nDim sclnr as Range\ndim aws as WorkSheet\n\nSet aws = Thisworkbook.Sheets(\"Sheet1\")\n\n'Using UsedRange\nlastrow = aws.UsedRange.Rows(aws.UsedRange.Rows.Count).Row\nlastcolumn = aws.UsedRange.Columns(aws.UsedRange.Columns.Count).Column\n'UsedRange works fine no problem with finding last row and column\n\nSet sclnr = aws.Range(aws.Cells(1, 1), aws.Cells(lastrow, lastcolumn)).Find(\"Example\") \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1488982975, "creation_date": 1488982975, "answer_id": 42673875, "question_id": 42673708, "link": "https://stackoverflow.com/questions/42673708/excel-vba-using-variables-in-cells-and-range-function/42673875#42673875", "title": "Excel VBA Using Variables in Cells and Range Function", "body": "<pre><code>Sub test_MertTheGreat()\nDim FirstAddress As String, LookForString As String\nLookForString = \"Example\"\n\nDim LastRow As Long\nDim LastColumn As Long\nDim SclnR As Range\nDim awS As Worksheet\n\nSet awS = ThisWorkbook.Sheets(\"Sheet1\")\n\n'Using UsedRange\nWith awS.UsedRange\nLastRow = .Rows(.Rows.Count).Row\nLastColumn = .Columns(.Columns.Count).Column\nEnd With 'awS.UsedRange\n\nSet SclnR = awS.Range(Cells(1, 1), Cells(LastRow, LastColumn)).Find(\"Example\")\n'the word Example exits in one of the cells\n\nWith awS.Range(awS.Cells(1, 1), awS.Cells(LastRow, LastColumn))\n    .Cells(1, 1).Activate\n    'First, define properly the Find method\n    Set SclnR = .Find(What:=LookForString, _\n                After:=ActiveCell, _\n                LookIn:=xlValues, _\n                LookAt:=xlWhole, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False, _\n                SearchFormat:=False)\n\n    'If there is a result, keep looking with FindNext method\n    If Not SclnR Is Nothing Then\n        FirstAddress = SclnR.Address\n        Do\n            '''---+++--- Your actions here ---+++---\n            Set SclnR = .FindNext(SclnR)\n        'Look until you find again the first result\n        Loop While Not SclnR Is Nothing And SclnR.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 400, "user_id": 6715663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868308a7044f1255729afc807a446497?s=128&d=identicon&r=PG&f=1", "display_name": "MertTheGreat", "link": "https://stackoverflow.com/users/6715663/mertthegreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 42673759, "answer_count": 2, "score": 1, "last_activity_date": 1488982975, "creation_date": 1488982584, "question_id": 42673708, "link": "https://stackoverflow.com/questions/42673708/excel-vba-using-variables-in-cells-and-range-function", "title": "Excel VBA Using Variables in Cells and Range Function", "body": "<p>I am tring to find the word \"Example\" in whole used cells. But the code gives me  Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d. I know there is something wrong with the line <code>Range(Cells(1, 1), Cells(lastrow, lastcolumn))</code> \nWhat could it be?</p>\n\n<p>Thanks in advance.\nHere is the Code:</p>\n\n<pre><code>Dim lastrow as Long\nDim lastcolumn as Long\nDim sclnr as Range\ndim aws as WorkSheet\n\nSet aws = Thisworkbook.Sheets(\"Sheet1\")\n\n'Using UsedRange\nlastrow = aws.UsedRange.Rows(aws.UsedRange.Rows.Count).Row\nlastcolumn = aws.UsedRange.Columns(aws.UsedRange.Columns.Count).Column\n'UsedRange works fine no problem with finding last row and column\n\nSet sclnr = aws.Range(Cells(1, 1), Cells(lastrow, lastcolumn)).Find(\"Example\") \n'the word Example exits in one of the cells\n</code></pre>\n"}, {"tags": ["vba", "excel", "rows", "move"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488982751, "post_id": 42673573, "comment_id": 72472043, "body": "sub category does not matter?"}, {"owner": {"reputation": 63, "user_id": 7445728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4434432d6cb06dd0161efc561e19e525?s=128&d=identicon&r=PG&f=1", "display_name": "CMBart", "link": "https://stackoverflow.com/users/7445728/cmbart"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488983644, "post_id": 42673573, "comment_id": 72472741, "body": "It does. So in the first example row C3:C5 need to replace B3:B5, E3:E5 need to replace D3:D5 etc. When there is no row below the product containing categories, the product row can be removed."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488984107, "post_id": 42673573, "comment_id": 72473112, "body": "so if the sub categories are different, they should not override each other? my understanding is that you want to make a unique list based on product, category and sub category, right? empty cells in any column represent the first value above them in the same column?"}, {"owner": {"reputation": 63, "user_id": 7445728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4434432d6cb06dd0161efc561e19e525?s=128&d=identicon&r=PG&f=1", "display_name": "CMBart", "link": "https://stackoverflow.com/users/7445728/cmbart"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488984364, "post_id": 42673573, "comment_id": 72473307, "body": "The whole row needs to be replaced, so yeah, they can be overrided. The use for this is I need to make an import of products to my webshop, but I can only import one category (with subs) per import (so one row of categories per product can be used per import)."}, {"owner": {"reputation": 63, "user_id": 7445728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4434432d6cb06dd0161efc561e19e525?s=128&d=identicon&r=PG&f=1", "display_name": "CMBart", "link": "https://stackoverflow.com/users/7445728/cmbart"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1488985299, "post_id": 42673573, "comment_id": 72474017, "body": "Added some images to clarify. Thanks in advance!"}], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "reply_to_user": {"reputation": 63, "user_id": 7445728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4434432d6cb06dd0161efc561e19e525?s=128&d=identicon&r=PG&f=1", "display_name": "CMBart", "link": "https://stackoverflow.com/users/7445728/cmbart"}, "edited": false, "score": 0, "creation_date": 1488991074, "post_id": 42674846, "comment_id": 72478398, "body": "No problem. Feel free to accept it if you feel it answered your question :)"}], "tags": [], "owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "is_accepted": true, "score": 2, "last_activity_date": 1488985493, "creation_date": 1488985493, "answer_id": 42674846, "question_id": 42673573, "link": "https://stackoverflow.com/questions/42673573/move-cells-up-based-on-value/42674846#42674846", "title": "Move Cells up based on value", "body": "<p>You were on the right track, this should do what you want:</p>\n\n<pre><code>Sub MoveEmpty()\n\nDim i As Long, j As Long\nDim ws As Worksheet\n\nApplication.ScreenUpdating = False\n\n' Set this appropriately\nSet ws = ThisWorkbook.Worksheets(\"MyWorksheet\")\n\nj = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = j To 3 Step -1\n    If ws.Range(\"A\" &amp; i) &lt;&gt; \"\" Then\n        ' Copy the product name to be next to the 2nd category set down, if there is a category\n        If ws.Range(\"A\" &amp; (i + 1)) = \"\" And ws.Range(\"C\" &amp; (i + 1)) &lt;&gt; \"\" Then\n            ' If you just want the values (i.e. no formatting copied)\n            ws.Range(\"A\" &amp; (i + 1)).Resize(, 2).Value = ws.Range(\"A\" &amp; i).Resize(, 2).Value\n            ' If you want everything, including formats\n            Call ws.Range(\"A\" &amp; i).Resize(, 2).Copy(ws.Range(\"A\" &amp; (i + 1)).Resize(, 2))\n        End If\n\n        ws.Range(\"A\" &amp; i).EntireRow.Delete\n    End If\nNext i\n' Reset the screen to updating\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7445728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4434432d6cb06dd0161efc561e19e525?s=128&d=identicon&r=PG&f=1", "display_name": "CMBart", "link": "https://stackoverflow.com/users/7445728/cmbart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 42674846, "answer_count": 1, "score": 0, "last_activity_date": 1488985493, "creation_date": 1488982251, "last_edit_date": 1488985276, "question_id": 42673573, "link": "https://stackoverflow.com/questions/42673573/move-cells-up-based-on-value", "title": "Move Cells up based on value", "body": "<p>I'm kind of struggeling with VBA for excel. I have a table with products, where products can have multiple categories. The categories that are linked to a product can have sub-categories, which are located in the columns next to it. If a product has multiple categories, these categories are located one row below the product. See pic1. </p>\n\n<p><a href=\"https://i.stack.imgur.com/KXqTK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KXqTK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>What I want to achieve:</strong>\nEvery time I execute the script, the current categories that are on the row of the product info need to be replaced with the categories below it, until you reach the next product. If there is no new category to replace, the product row can be deleted. (In this example I need to run the script 3 times). So I eventually will end up with this:</p>\n\n<p>Run script first time:\n<a href=\"https://i.stack.imgur.com/vaygX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vaygX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Run script second time:\n<a href=\"https://i.stack.imgur.com/L7c86.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L7c86.png\" alt=\"enter image description here\"></a></p>\n\n<p>Run script 3rd time:\n<a href=\"https://i.stack.imgur.com/vaygX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fRjRi.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I've got so far is: </p>\n\n<pre><code>Sub MoveEmpty()\n\nDim i as Long, j as Long\n\nApplication.ScreenUpdating = False\nj = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = j to 3 Step -1\n    If Range(\"A\" &amp; i) &lt;&gt; \"\" Then  \n       Range(\"C\" &amp; i -1) = Range(\"C\" &amp; i).Resize(,3)\n       Range(\"A\" &amp; i).EntireRow.Delete\n    End If\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Hope this makes sense, and thanks for helping out,</p>\n\n<p>Bart</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": true, "score": 2, "last_activity_date": 1488982962, "last_edit_date": 1488982962, "creation_date": 1488982642, "answer_id": 42673735, "question_id": 42673508, "link": "https://stackoverflow.com/questions/42673508/access-convert-string-like-feb-2017-to-date/42673735#42673735", "title": "access convert string like &quot;FEB 2017&quot; to date", "body": "<pre><code>SELECT LastDayInMonth(DateValue(Mid(\"Feb 2017\", 1, 3) &amp; \" 1, \" &amp;\n                                Mid(\"Feb 2017\", 5, 4))) AS LastDayInMonth\nFROM yourTable\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The concatenated term inside the call to <code>DateValue()</code> will be <code>Feb 1, 2017</code>, and will evaluate to the same date, at least for the sample data I used.  In general, it will be the first day of the month for the data you showed us.  Then, we use <code>LastDayInMonth()</code> to shift that date to the last day of the same month.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1488985481, "creation_date": 1488985481, "answer_id": 42674841, "question_id": 42673508, "link": "https://stackoverflow.com/questions/42673508/access-convert-string-like-feb-2017-to-date/42674841#42674841", "title": "access convert string like &quot;FEB 2017&quot; to date", "body": "<p>You can also use native functions, adding one month, subtracting one day:</p>\n\n<pre><code>MonthYear = \"FEB 2017\"\nUltimo = DateAdd(\"d\", -1, DateAdd(\"m\", 1, CDate(\"1 \" &amp; MonthYear)))\n\nUltimo -&gt; 2017-02-28\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 42673735, "answer_count": 2, "score": 1, "last_activity_date": 1594022744, "creation_date": 1488982050, "last_edit_date": 1594022744, "question_id": 42673508, "link": "https://stackoverflow.com/questions/42673508/access-convert-string-like-feb-2017-to-date", "title": "access convert string like &quot;FEB 2017&quot; to date", "body": "<p>report out of account system comes out with month like \"FEB 2017\". I need to convert that string to a date that is the end of the month like 02/28/2017. Any ideas?</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "excel-2007"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1488981460, "post_id": 42673218, "comment_id": 72471118, "body": "try .cells as you look to be referencing a sheet?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488981966, "post_id": 42673218, "comment_id": 72471487, "body": "If the worksheet you&#39;re using <code>Select</code> on isn&#39;t the <code>ActiveSheet</code>, you&#39;ll get a run-time error 1004 for 2 reasons: the <code>Cells</code> calls aren&#39;t qualified, and you can&#39;t select cells on the non-active sheet.  Qualify all your references, and use the <code>Range</code> objects - not the selection."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "edited": false, "score": 1, "creation_date": 1488987782, "post_id": 42673368, "comment_id": 72475841, "body": "Thank you for the help !"}], "tags": [], "owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "is_accepted": false, "score": 1, "last_activity_date": 1488981693, "creation_date": 1488981693, "answer_id": 42673368, "question_id": 42673218, "link": "https://stackoverflow.com/questions/42673218/vba-delete-rows-using-variables/42673368#42673368", "title": "VBA : Delete rows using variables", "body": "<p>You can use this simple one line to delete any number of rows you need.</p>\n\n<pre><code>Rows(\"2:\" &amp; Z).Delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1488981772, "post_id": 42673386, "comment_id": 72471341, "body": "Wouldn&#39;t <code>.Range(.Rows(2), .Rows(z))</code> be a bit cleaner?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1488981952, "post_id": 42673386, "comment_id": 72471476, "body": "@Comintern : It sure would be I wanted to illustrate the use of <code>EntireRow</code>, I&#39;ll edit to include it ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "edited": false, "score": 0, "creation_date": 1488987792, "post_id": 42673386, "comment_id": 72475848, "body": "@FrancisZHENG : Glad I could help! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 3, "last_activity_date": 1488981892, "last_edit_date": 1488981892, "creation_date": 1488981730, "answer_id": 42673386, "question_id": 42673218, "link": "https://stackoverflow.com/questions/42673218/vba-delete-rows-using-variables/42673386#42673386", "title": "VBA : Delete rows using variables", "body": "<p>You need to specify you want to select the rows with <code>EntireRow</code>, as your range is only a few cells :</p>\n\n<pre><code>.Range(.Cells(2, 1), .Cells(z, 10)).EntireRow.Delete Shift:=xlUp\n</code></pre>\n\n<hr>\n\n<p>Or cleaner ways if you directly use <code>Rows</code> :</p>\n\n<pre><code>.Range(.Rows(2), .Rows(z)).Delete Shift:=xlUp\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>.Rows(\"2:\" &amp; z).Delete Shift:=xlUp\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7610519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da01ad51f95b2270fa51a6c109659fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/7610519/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10089, "favorite_count": 0, "accepted_answer_id": 42673386, "answer_count": 2, "score": 2, "last_activity_date": 1488982160, "creation_date": 1488981316, "last_edit_date": 1531164843, "question_id": 42673218, "link": "https://stackoverflow.com/questions/42673218/vba-delete-rows-using-variables", "title": "VBA : Delete rows using variables", "body": "<p>I wanted to delete rows from 2 to z (z > 2). I wrote 2 methods but neither worked. I searched for answers but didn't find a solution.</p>\n\n<pre><code>'.Rows(\"2:\" &amp; z).Select  \n.Range(Cells(2, 1), Cells(z, 10)).Select  \nSelection.Delete Shift:=xlUp\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488981638, "post_id": 42673155, "comment_id": 72471257, "body": "Welcome to SO, please take a minute to take the <a href=\"https://stackoverflow.com/tour\">tour</a> (click it) to learn how SO works! ;)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1488981664, "post_id": 42673155, "comment_id": 72471276, "body": "<code>WORKSHEETFUNCTION.MAX</code> then <code>WORKSHEETFUNCTION.INDEX</code> then <code>OFFSET</code> and <code>ADDRESS</code>.  or just do it as a formula.  If data a to h, something like <code>=CHAR(65+MATCH(MAX(A16:H16),A16:H16,0)-1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488982403, "post_id": 42673333, "comment_id": 72471774, "body": "run time error 1004 unable to get the max property of the worksheet function class"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488982653, "post_id": 42673333, "comment_id": 72471971, "body": "@AnkitSingh : Give the edit a try and please take the <a href=\"https://stackoverflow.com/tour\">tour</a>"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488983925, "post_id": 42673333, "comment_id": 72472963, "body": "thank you very much i just have a query what if there are two cells with same no can i get name of both column header"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488984088, "post_id": 42673333, "comment_id": 72473098, "body": "@AnkitSingh : Glad it worked! :) You could, but you&#39;ll most probably need to loop again on the range to test each cells against the max! :/ As this worked, thx to accept my answer! ;)"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488986191, "post_id": 42673333, "comment_id": 72474648, "body": "hello sir again... I am also happy it worked but i want all the coulmn headers having max no is a single cell like D/E/H. is it possible"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1488982592, "last_edit_date": 1488982592, "creation_date": 1488981598, "answer_id": 42673333, "question_id": 42673155, "link": "https://stackoverflow.com/questions/42673155/column-name-of-max-no-in-a-row/42673333#42673333", "title": "column name of max no in a row", "body": "<p>Using <code>MATCH</code> worksheet function will give you the column matching the <code>MAX</code> :</p>\n\n<p>There is a <code>+1</code> because your range start at col 2! ;)</p>\n\n<pre><code>Sub shanaya()\n    Dim j As Integer\n    Dim i As Integer\n    Dim z As Integer\n    Dim x As Integer\n    Dim ColOfMax As Integer\n    Dim RgToSearch As Range\n\n    z = 35\n    For i = 11 To 28\n        For j = 2 To 19\n            If Sheet8.Cells(j, 1) = Sheet1.Cells(i, 1) Then\n                Sheet1.Cells(i, 10) = Sheet8.Cells(j, z)\n                Set RgToSearch = Sheet8.Range(Sheet8.Cells(j, 2), Sheet8.Cells(j, z))\n                ColOfMax = Application.WorksheetFunction.Match(Application.WorksheetFunction.Max(RgToSearch), RgToSearch, 0) + 1\n\n                Sheet1.Cells(i, 13) = Sheet8.Cells(1, ColOfMax)\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 42673333, "answer_count": 1, "score": 1, "last_activity_date": 1488982592, "creation_date": 1488981128, "last_edit_date": 1488981205, "question_id": 42673155, "link": "https://stackoverflow.com/questions/42673155/column-name-of-max-no-in-a-row", "title": "column name of max no in a row", "body": "<p>Column header for different sheet</p>\n\n<p>iI have many rows having data in sheet 2 and iI want the column name of the max of a row (i.e. from column from column name of B2 to AH2 inside if loop).</p>\n\n<pre><code>Sub shanaya()\n\n    Dim j As Integer\n    Dim i As Integer\n    Dim z As Integer\n    Dim x As Integer\n\n    z = 35\n    For i = 11 To 28\n        For j = 2 To 19\n            If Sheet8.Cells(j, 1) = Sheet1.Cells(i, 1) Then\n                Sheet1.Cells(i, 10) = Sheet8.Cells(j, z)\n                Max [(Sheet8.Cells(J,2)): (Sheet8.Cells(j,z))]\n                Sheet1.Cells(i,13) = column header of max function             \n            End If     \n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 6, "creation_date": 1488980997, "post_id": 42672954, "comment_id": 72470777, "body": "Your observation that they work differently is correct. But what is your question?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1488981054, "post_id": 42672954, "comment_id": 72470821, "body": "And so?? what is the question?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1488981450, "post_id": 42672954, "comment_id": 72471105, "body": "There are now more observations but still no question. Are you trying to ask how to make the third piece work? If so, please describe what it should do and what it does instead."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1488981687, "post_id": 42672954, "comment_id": 72471288, "body": "When you say it copies the cells containing <code>&quot;&quot;</code> do you mean the formulas place an empty string result, like <code>=IF(A1=2,A1,&quot;&quot;)</code>. If so, Excel treat this as text and you may need to use another method to collect only the cells you want to copy."}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488981998, "post_id": 42672954, "comment_id": 72471510, "body": "It copies the column and the cells, which contain a &quot;&quot; result in the original range. are left empty"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1488982038, "post_id": 42672954, "comment_id": 72471535, "body": "your reply is still not clear to me but check out my proposed solution posted as an answer"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1488982307, "post_id": 42672954, "comment_id": 72471709, "body": "It works like it should. It might not be what you expect, but that&#39;s because an empty string is <a href=\"http://stackoverflow.com/q/1119614/11683\">not the same</a> as blank."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488982377, "post_id": 42673507, "comment_id": 72471760, "body": "Just to comment: This does not replace the number 3 of the question. This copies <b>any</b> non-empty cell (including numeric values) instead of text values of formulas only!"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1489042561, "post_id": 42673507, "comment_id": 72500222, "body": "Still not the same. If the formula returns a string convertible to number (e.g. <code>=&quot;42&quot;</code>), <code>SpecialCells(xlCellTypeFormulas, xlTextValues)</code> will properly see it, but <code>IsNumeric()</code> on it will be <code>True</code>. You probably want <code>and vartype(vData(i,1)) = vbstring</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1489053120, "post_id": 42673507, "comment_id": 72506423, "body": "@GSerg yes and another difference is <code>xlCellTypeFormulas</code> takes only results of formulas (e.g. cell contains <code>=&quot;aaa&quot;</code>) and no constant strings (e.g. cell contains <code>aaa</code>). But your code still does. Nontheless the question owner accepted the answer it should be clear that the code does not the same as number 3 of the question."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1488993047, "last_edit_date": 1488993047, "creation_date": 1488982041, "answer_id": 42673507, "question_id": 42672954, "link": "https://stackoverflow.com/questions/42672954/vba-code-works-differently/42673507#42673507", "title": "VBA code works differently", "body": "<p>Since excel treats formula results of <code>\"\"</code> as text, try this method instead.</p>\n\n<pre><code>Dim vData as Variant\nvData = Worksheets(\"Calculator\").Range(\"K10:K61\")\n\nDim i as Integer\nFor i = Lbound(vData) to uBound(vData)\n   If len (vData(i,1)) And Not IsNumeric(vData(i,1)) Then \n     With Worksheets(\"Graphs\")\n         .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1).Value = vData(i,1)\n     End With\n   End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 42673507, "answer_count": 1, "score": 0, "last_activity_date": 1488993047, "creation_date": 1488980513, "last_edit_date": 1488982097, "question_id": 42672954, "link": "https://stackoverflow.com/questions/42672954/vba-code-works-differently", "title": "VBA code works differently", "body": "<p>I have these 3 pieces of code, which work differently but deliver similar result. The aim is that I have in a separate column only the values from filled cells, and no blanks</p>\n\n<ol>\n<li><p>This code copies only the results from the formulas in <code>I10:I61</code>. The formula returns also \"\", which I do not need.</p>\n\n<pre><code>With Worksheets(\"Calculator\").Range(\"I10:I61\")\n    .Offset(, 0).SpecialCells(xlCellTypeFormulas, xlNumbers).Copy\n    Worksheets(\"Graphs\").Range(\"F2\").PasteSpecial SkipBlanks:=True, Paste:=xlPasteValues\nEnd With\n</code></pre></li>\n<li><p>This code copies values, where there are no formulas</p>\n\n<pre><code>With Worksheets(\"Calculator\")\n    Set VisRng = .Range(\"D10:D61\").SpecialCells(xlCellTypeConstants)\n    VisRng.Copy\n    Worksheets(\"Graphs\").Range(\"B2\").PasteSpecial xlValues\nEnd With\n</code></pre></li>\n<li><p>This is supposed to copy text results from formula. It does not work. The formula returns also \"\", which I do not need.</p>\n\n<pre><code>With Worksheets(\"Calculator\").Range(\"K10:K61\")\n    .Offset(, 0).SpecialCells(xlCellTypeFormulas, xlTextValues).Copy\n    Worksheets(\"Graphs\").Range(\"A2\").PasteSpecial SkipBlanks:=True, Paste:=xlPasteValues\nEnd With\n</code></pre></li>\n</ol>\n\n<p>However, the last piece of code does not work. It should copy and paste only the filled cells and not the emty once(containing \"\"). Now it copies and pastes everything. How can I make it work? The result is:</p>\n\n<pre><code>K             A\nParis         Paris\n\n\nAmsterdam      Amsterdam\n</code></pre>\n\n<p>I need it to be</p>\n\n<pre><code>A\nParis\nAmsterdam\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1488980594, "post_id": 42672919, "comment_id": 72470489, "body": "What&#39;s the <code>.NumberFormat</code> on these cells?"}, {"owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1488980800, "post_id": 42672919, "comment_id": 72470651, "body": "I&#39;ve set the .NumberFormat to &quot;@&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "is_accepted": false, "score": 1, "last_activity_date": 1489133438, "creation_date": 1489133438, "answer_id": 42713366, "question_id": 42672919, "link": "https://stackoverflow.com/questions/42672919/sql-query-in-excel-shows-blank-for-some-values/42713366#42713366", "title": "SQL Query in Excel shows blank for some values", "body": "<p>The problem is with the range I am copying the query results to. Only the source range has the text format. The format of the range I am copying the query results to is in general, so I guess Excel automatically converts the data into a number, based on the first cell value.</p>\n\n<p>I resolved this problem by changing the format into text.</p>\n"}], "owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489133438, "creation_date": 1488980416, "last_edit_date": 1531164843, "question_id": 42672919, "link": "https://stackoverflow.com/questions/42672919/sql-query-in-excel-shows-blank-for-some-values", "title": "SQL Query in Excel shows blank for some values", "body": "<p>I have a data on a sheet on excel and I use SQL to query to get a dataset.\nThis is the column the query is returning.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pT62n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pT62n.png\" alt=\"Sample Data\"></a></p>\n\n<p>However, only items on numeric format is shown, and if the item is alphanumeric, it is blank.  The resulting query is below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GgoVN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GgoVN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have formatted this column as a text and below is my connection string:</p>\n\n<pre><code>objConnectionXL.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n    \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=\"\"Excel 8.0;HDR=Yes;\"\";\"\n</code></pre>\n\n<p>Used query string:</p>\n\n<pre><code>sQueryFilteredValues = \"Select [Reference] From [Data$] Where \" &amp; sFilterCriteria\n</code></pre>\n\n<p>I also tried using the query string below but it resulted the same:</p>\n\n<pre><code>sQueryFilteredValues = \"Select CSTR([Reference]) From [Data$] Where \" &amp; sFilterCriteria\n</code></pre>\n\n<p>Recordset:</p>\n\n<pre><code>objRecordsetXL.Open sQueryFilteredValues, objConnectionXL, adOpenStatic, adLockOptimistic, adCmdText\n</code></pre>\n\n<p>Where: adOpenStatic = 3, adLockOptimistic = 3, adCmdText = &amp;H1</p>\n\n<p>And I use below to copy the recordset into Excel</p>\n\n<pre><code>rngRange.Offset(1, 0).CopyFromRecordset objRecordsetXL\n</code></pre>\n\n<p>How can I show alphanumeric items on the recordset as well? \nThanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1488979996, "post_id": 42672663, "comment_id": 72470093, "body": "This kind of code can be a bit buggy. Sometimes adding a <code>DoEvents</code> call, or reading the <code>.Top</code> value into a variable first can help."}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": true, "score": 2, "last_activity_date": 1488983122, "creation_date": 1488983122, "answer_id": 42673930, "question_id": 42672663, "link": "https://stackoverflow.com/questions/42672663/resize-plot-area-in-embedded-chart-object/42673930#42673930", "title": "Resize plot area in embedded chart object", "body": "<p>The comment Rory made about reading the value solved the issue, strange that this is needed though..</p>\n\n<pre><code>Dim temp As Integer\nWith myChart.PlotArea\n    temp = .Top\n    temp = .Height\n    .Top = 70\n    .Height = 420\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1488993868, "post_id": 42674397, "comment_id": 72480185, "body": "I prefer to pass ch as an object, not sure that is possible with your code, however Rory code worked, and then I do not have to add a fix delay, but your code works aswell:)"}, {"owner": {"reputation": 76, "user_id": 7678582, "user_type": "registered", "profile_image": "https://graph.facebook.com/1564892346873336/picture?type=large", "display_name": "Cheries Mewengkang", "link": "https://stackoverflow.com/users/7678582/cheries-mewengkang"}, "reply_to_user": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1489062631, "post_id": 42674397, "comment_id": 72512858, "body": "In programming world there are many ways to solve one problem, so choose the easiest and the fastest way.......Since Rory code&#39;s is more simple, I recommend that one."}], "tags": [], "owner": {"reputation": 76, "user_id": 7678582, "user_type": "registered", "profile_image": "https://graph.facebook.com/1564892346873336/picture?type=large", "display_name": "Cheries Mewengkang", "link": "https://stackoverflow.com/users/7678582/cheries-mewengkang"}, "is_accepted": false, "score": 0, "last_activity_date": 1488984392, "creation_date": 1488984392, "answer_id": 42674397, "question_id": 42672663, "link": "https://stackoverflow.com/questions/42672663/resize-plot-area-in-embedded-chart-object/42674397#42674397", "title": "Resize plot area in embedded chart object", "body": "<p>I think the problem why your code return error because PlotArea properies can only be modify after the Chart object if fully loaded. So yes, you need to complete Chart Object loading process and modify any PlotArea properties.\nThe code below will work. Try it..!</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Demo()\n\n    Dim maxPie As Long\n    Dim myChart As Chart\n\n    'I assume that your chart is on Sheet1\n    maxPie = Sheet1.Range(\"A1048576\").End(xlUp).Row\n    Set myChart = Sheet1.Shapes.AddChart2.Chart\n\n    With myChart\n        .ChartType = xlBarClustered\n        .SetSourceData Source:=Range(\"Sheet1!$B$2:$C$\" &amp; maxPie)\n    End With\n\n    With myChart.Parent\n        .Top = 10\n        .Left = 500\n        .Width = 500\n        .Height = 500\n    End With\n\n    'Delay the SetPlotArea code execution using OnTime function\n    Application.OnTime Now, \"SetPlotArea\", Now + TimeValue(\"0:0:5\")\n\nEnd Sub\n\nPublic Sub SetPlotArea()\n    Dim ch As Chart\n    Set ch = Sheet1.ChartObjects(1).Chart\n\n    ch.PlotArea.Top = 70\n    ch.PlotArea.Height = 420\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 42673930, "answer_count": 2, "score": 1, "last_activity_date": 1488984392, "creation_date": 1488979779, "last_edit_date": 1531164843, "question_id": 42672663, "link": "https://stackoverflow.com/questions/42672663/resize-plot-area-in-embedded-chart-object", "title": "Resize plot area in embedded chart object", "body": "<p>I have problem resizing plot area in an embedded chart in excel</p>\n\n<pre><code>Dim myChart As Chart\n\nmaxPie = ThisWorkbook.Sheets(sheetName).Range(\"A1048576\").End(xlUp).Row\n\nSet myChart = ThisWorkbook.Sheets(sheetName).Shapes.AddChart.Chart\n\n\nmyChart.ChartType = xlBarClustered\nmyChart.SetSourceData Source:=Range(sheetName &amp; \"!$A$5:$C$\" &amp; maxPie)\n\nWith myChart.Parent\n    .Top = 10\n    .Left = 500\n    .Width = 500\n    .Height = 500\nEnd With\n\nWith myChart.PlotArea\n    .Top = 70\n    .Height = 420\nEnd With\n</code></pre>\n\n<p>if i press debug and then F5 then it resizes it, do I need to add a delay in my code because its not finished generating the plot area before I try to resize it</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 1, "creation_date": 1488979714, "post_id": 42672297, "comment_id": 72469885, "body": "Can you describe exactly what happens when you run the above code? What do you mean that it doesn&#39;t work? Can you add what was recorded before you modified it?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488984788, "post_id": 42672297, "comment_id": 72473635, "body": "You say &quot;some of the values as stored as text&quot; so why don&#39;t you select them all and format them as default or number?"}, {"owner": {"reputation": 3, "user_id": 7678433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1813180475374690/picture?type=large", "display_name": "Luiz Moita", "link": "https://stackoverflow.com/users/7678433/luiz-moita"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1488987578, "post_id": 42672297, "comment_id": 72475692, "body": "@Mike It should change the dates and numbers that are stored as text to their correct type."}, {"owner": {"reputation": 3, "user_id": 7678433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1813180475374690/picture?type=large", "display_name": "Luiz Moita", "link": "https://stackoverflow.com/users/7678433/luiz-moita"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488987649, "post_id": 42672297, "comment_id": 72475754, "body": "@Peh I have to do it to many Workbooks throughout the time, so It&#39;s very appropriate to have a macro to do that for me."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7678433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1813180475374690/picture?type=large", "display_name": "Luiz Moita", "link": "https://stackoverflow.com/users/7678433/luiz-moita"}, "edited": false, "score": 0, "creation_date": 1488987947, "post_id": 42675288, "comment_id": 72475975, "body": "Perfect solution! Thank you!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1488986749, "creation_date": 1488986749, "answer_id": 42675288, "question_id": 42672297, "link": "https://stackoverflow.com/questions/42672297/excel-vba-pastespecial-with-xlpastespecialoperationadd-not-working/42675288#42675288", "title": "Excel VBA PasteSpecial with xlPasteSpecialOperationAdd not working", "body": "<p>Instead of adding zero try this <em>(it worked on my test)</em> </p>\n\n<pre><code>With Range(Range(\"D3:E3\"), Range(\"D3:E3\").End(xlDown))\n    .Value = .Value2\nEnd With\nWith Range(Range(\"G3:J3\"), Range(\"G3:J3\").End(xlDown))\n    .Value = .Value2\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7678433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1813180475374690/picture?type=large", "display_name": "Luiz Moita", "link": "https://stackoverflow.com/users/7678433/luiz-moita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 42675288, "answer_count": 1, "score": 0, "last_activity_date": 1488986749, "creation_date": 1488978695, "last_edit_date": 1531161705, "question_id": 42672297, "link": "https://stackoverflow.com/questions/42672297/excel-vba-pastespecial-with-xlpastespecialoperationadd-not-working", "title": "Excel VBA PasteSpecial with xlPasteSpecialOperationAdd not working", "body": "<p>I'm trying to get a code that I generated using the macro recorder to work. The spreadsheet I'm using has some columns that should only contain numbers or dates, but, for some reason, some of the values as stored as text.</p>\n\n<p>To solve it, I decided to copy and paste adding <code>0</code> to all those cells. If I do it by hand, it works fine. So, I started Excel macro recorder to get the code. I did some modification to the code generated, just to make it more readable and clean, but actually, nor the original code nor my version of it work.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Range(\"F1\").Value = 0\nRange(\"F1\").Copy\nSet rngPaste = Range(Range(\"D3:E3\"), Range(\"D3:E3\").End(xlDown))\nrngPaste.PasteSpecial Paste:=xlPasteValues, Operation:=xlPasteSpecialOperationAdd, \n                                             _ SkipBlanks:=False, Transpose:=False\nSet rngPaste = Range(Range(\"G3:J3\"), Range(\"G3:J3\").End(xlDown))\nrngPaste.PasteSpecial Paste:=xlPasteValues, Operation:=xlPasteSpecialOperationAdd, \n                                             _ SkipBlanks:=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Any ideas why this is not working?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488979662, "post_id": 42672218, "comment_id": 72469846, "body": "please share your code."}, {"owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488980349, "post_id": 42672218, "comment_id": 72470329, "body": "Hello Nathan_Sav"}, {"owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488980780, "post_id": 42672218, "comment_id": 72470628, "body": "Hello Nathan_Sav , Currently my code does is It will traversal from first Column to last and copy into the array, But it does only for visible columns&#39;to get the column count and names For Each TB In ActiveProject.TaskTables   If TB.Name = ActiveProject.CurrentTable Then     Exit For   End If Next TB"}, {"owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489489754, "post_id": 42672218, "comment_id": 72682743, "body": "Can I get some solution or hint for above my question, becuase currently its a blocker to me am not able to move on"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489490767, "post_id": 42672218, "comment_id": 72683436, "body": "<code>getfield</code> maybe with a loop of the fields to <code>.fields.count</code>?  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861413.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff861413.aspx</a>"}], "owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488981518, "creation_date": 1488978453, "last_edit_date": 1488981518, "question_id": 42672218, "link": "https://stackoverflow.com/questions/42672218/how-to-paste-the-values-for-hidden-columns-in-mpp-file", "title": "How to paste the values for hidden columns in MPP file", "body": "<p>Currently am struck because currently my code is pasting only visible columns from MPP file</p>\n\n<pre><code>For Each TB In ActiveProject.TaskTables \n      If TB.Name = ActiveProject.CurrentTable Then \n          Exit For \n      End If \nNext TB \n</code></pre>\n\n<p>My question is How to get all hidden columns from MPP, MY code should paste the values for hidden columns as well</p>\n\n<p>For Ex:- Resource name will be hidden in MPP File in one of the view But in my Source file we have values for that so My code should search hidden Column and paste the value </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1488983949, "post_id": 42672169, "comment_id": 72472988, "body": "When I click on the link it takes me to a CSV like file. Did you consider doing a web request to pull the data?"}, {"owner": {"reputation": 1, "user_id": 6538972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fc9414484c3d9172f664913921c42a?s=128&d=identicon&r=PG&f=1", "display_name": "JDQ", "link": "https://stackoverflow.com/users/6538972/jdq"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1489018325, "post_id": 42672169, "comment_id": 72492707, "body": "That&#39;s my problem.  When I open the URL in Chrome, I get the CSV type file.  That is what I want.  However, when I do the web query using the VBA code above (is this the same as a web request?), I don&#39;t get the same CSV type file.  Instead, I get the contents of the normal website in my destination worksheet."}], "owner": {"reputation": 1, "user_id": 6538972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fc9414484c3d9172f664913921c42a?s=128&d=identicon&r=PG&f=1", "display_name": "JDQ", "link": "https://stackoverflow.com/users/6538972/jdq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488978310, "creation_date": 1488978310, "question_id": 42672169, "link": "https://stackoverflow.com/questions/42672169/excel-query-table-formats-website-incorrectly", "title": "Excel query table formats website incorrectly", "body": "<p>I have some VBA code that has worked fine for a couple of years. The code is:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; myURL, Destination:=Range(\"$A$1\"))\n    .Name = \"Weather\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlOverwriteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>Where myURL is: <a href=\"http://www.wunderground.com/history/airport/AMS/2011/1/1/CustomHistory.html?dayend=31&amp;monthend=12&amp;yearend=2011&amp;req_city=NA&amp;req_state=NA&amp;req_statename=NA&amp;format=1\" rel=\"nofollow noreferrer\">http://www.wunderground.com/history/airport/AMS/2011/1/1/CustomHistory.html?dayend=31&amp;monthend=12&amp;yearend=2011&amp;req_city=NA&amp;req_state=NA&amp;req_statename=NA&amp;format=1</a></p>\n\n<p>The code used to return a comma delimted file that I could parse to obtain the needed data.  However, in the past few days, the code returns a fully formatted website.  It seems the \"&amp;format=1\" (needed to return the comma delimited file) isn't being recognized by the website.</p>\n\n<p>When I enter the URL directly into Chrome or IE, I receive the comma delimited file.  No luck (anymore) with my query table.  Can anyone give me some guidance?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1488977997, "post_id": 42671845, "comment_id": 72468706, "body": "Get rid of the <code>On Error Goto Message</code> and see if any error is thrown. Also, please format (indent) your code before posting."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488978759, "post_id": 42671845, "comment_id": 72469238, "body": "Anything about the content of <code>ThisWorkbook.Worksheets(1).Range(&quot;M4&quot;).value</code> that might be restricting the files being returned?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1488978461, "last_edit_date": 1495540436, "creation_date": 1488978139, "answer_id": 42672107, "question_id": 42671845, "link": "https://stackoverflow.com/questions/42671845/vba-list-all-files-in-a-folder-works-50-of-the-time/42672107#42672107", "title": "VBA list all files in a folder, works 50% of the time?", "body": "<p>Try to change all your code looking like this:</p>\n\n<pre><code>Cells(i, 6) = objFile.Path\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>ThisWorkbook.Worksheets(1).Cells(i, 6) = objFile.Path\n</code></pre>\n\n<p>It will run probably better. <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221533(v=office.11).aspx\" rel=\"nofollow noreferrer\">Anyhow, make sure to refer the workbook and the worksheet.</a> </p>\n\n<p>And a bit offtopic:</p>\n\n<ol>\n<li><p>Use something like <a href=\"http://www.oaltd.co.uk/\" rel=\"nofollow noreferrer\">SmartIndent</a> for the indentation. You cannot understand what is happening otherwise.</p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Do not use <code>integer</code> in VBA</a>.</p></li>\n</ol>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 42672107, "answer_count": 1, "score": 1, "last_activity_date": 1488978461, "creation_date": 1488977358, "question_id": 42671845, "link": "https://stackoverflow.com/questions/42671845/vba-list-all-files-in-a-folder-works-50-of-the-time", "title": "VBA list all files in a folder, works 50% of the time?", "body": "<p>I am using the following VBA code to list all of my excel files in a folder.</p>\n\n<p>For some reason this only works correct 50% of the time.</p>\n\n<p>Lets say i have 12 excel files in a folder, then sometimes only 1 file is listed and then other times all the files are listed.</p>\n\n<p>Pleas can someone show me where i am going wrong?</p>\n\n<pre><code>Sub List()\n\nOn Error GoTo Message\nActiveSheet.DisplayPageBreaks = False\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\nDim i2 As Long\nDim i3 As Long\nDim j2 As Long\nDim name As String\nDim Txt As String\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nSet objFolder = objFSO.GetFolder(ThisWorkbook.Worksheets(1).Range(\"M4\").value)\ni = 18\n'loops through each file in the directory and prints their names and path\nFor Each objFile In objFolder.files\n'print file path\nCells(i, 6) = objFile.path\n\n'print file path\nCells(i, 7) = Replace(objFile.name, \".xlsx\", \"\")\n\n'print file removal icon\nCells(i, 30) = \"Remove\"\n\n'Add Hyperlink\nThisWorkbook.Worksheets(1).Hyperlinks.Add Anchor:=Cells(i, 27), Address:=objFile.path, TextToDisplay:=\"Open Announcement\"\n\n\n\n\n\n'Lookup contact info\n\nCells(i, 11).Formula = \"=IFERROR(INDEX(Contacts!$C:$C,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Range(\"G\" &amp; i).value &amp; \"\"\" &amp; \"\"*\"\",Contacts!$B:$B,0)),IFERROR(INDEX(Contacts!$C:$C,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Left(Range(\"G\" &amp; i).value, 7) &amp; \"\"\" &amp; \"\"*\"\",Contacts!$B:$B,0)),\"\"\"\"))\"\nCells(i, 14).Formula = \"=IF(\"\"\" &amp; Range(\"K\" &amp; i).value &amp; \"\"\" = \"\"\"\",\"\"\"\",IFERROR(INDEX(Contacts!$D:$D,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Range(\"K\" &amp; i).value &amp; \"\"\" &amp; \"\"*\"\",Contacts!$C:$C,0)),\"\"\"\"))\"\nCells(i, 18).Formula = \"=IF(\"\"\" &amp; Range(\"K\" &amp; i).value &amp; \"\"\" = \"\"\"\",\"\"\"\",IFERROR(INDEX(Contacts!$E:$E,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Range(\"K\" &amp; i).value &amp; \"\"\" &amp; \"\"*\"\",Contacts!$C:$C,0)),\"\"\"\"))\"\nCells(i, 23) = \"=IF(K\" &amp; i &amp; \"=\"\"\"\",\"\"Missing Contact! \"\",\"\"\"\")&amp;IF(INDEX(Data!L:L,MATCH(G\" &amp; i &amp; \",Data!F:F,0))=\"\"TBC\"\",\"\"Missing Data! \"\",\"\"\"\")&amp;IF(U\" &amp; i &amp; \"&gt;=DATE(2017,1,1),\"\"\"\",\"\"Check Date!\"\")\"\n\n'Delivery Dates\nCells(i, 21).Formula = \"=IFERROR(INDEX(Data!$Q:$Q,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Range(\"G\" &amp; i).value &amp; \"\"\" &amp; \"\"*\"\",Data!$F:$F,0)),IFERROR(INDEX(Data!$Q:$Q,MATCH(\"\"*\"\" &amp; \"\"\" &amp; Left(Range(\"G\" &amp; i).value, 7) &amp; \"\"\" &amp; \"\"*\"\",Data!$F:$F,0)),\"\"\"\"))\"\n\n\nCells(i, 25) = \"Sync\"\n\n\n\n\n\n\ni = i + 1\n\nNext objFile\n\nThisWorkbook.Worksheets(1).Calculate\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\nExit Sub\nMessage:\nApplication.DisplayAlerts = False\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488979797, "post_id": 42671815, "comment_id": 72469941, "body": "I do not believe the <code>INDEX</code> function can accept an array as an argument for <code>row_num</code> or <code>column_num</code>. If one of them is zero; the other has to point to a single row/column."}, {"owner": {"reputation": 11, "user_id": 7678252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5PdF5LMJ13I/AAAAAAAAAAI/AAAAAAAAALg/V9eRr2-B3Aw/photo.jpg?sz=128", "display_name": "Matt Carter", "link": "https://stackoverflow.com/users/7678252/matt-carter"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488980090, "post_id": 42671815, "comment_id": 72470147, "body": "Thanks Ron I was starting to wonder that, I&#39;m not sure how to explain this though: <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow noreferrer\">usefulgyaan.wordpress.com/2013/06/12/&hellip;</a> then, and there are many more examples out there of people instructing others to use it in that form."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1488981054, "post_id": 42671815, "comment_id": 72470823, "body": "In the comments are a number of users who were unable to get the example in the article to work, when using an array argument for <code>row_num</code>.  Also note that if you use the fully qualified <code>application.worksheetfunction.index...</code> you will get a type mis-match when you use the <code>Array(1,2)</code> argument."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 1, "creation_date": 1488981465, "post_id": 42671815, "comment_id": 72471125, "body": "In any event, its probably more efficient to do this using VBA array loops which would only require one copy operation rather than passing a copy of the array to Index and then Index passing a subset copy back."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488984233, "post_id": 42671815, "comment_id": 72473216, "body": "as a side note, the most efficient is to not copy the array at all and just use  values in the original array. Index can&#39;t be used to return more than one row/column AFAIK"}, {"owner": {"reputation": 11, "user_id": 7678252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5PdF5LMJ13I/AAAAAAAAAAI/AAAAAAAAALg/V9eRr2-B3Aw/photo.jpg?sz=128", "display_name": "Matt Carter", "link": "https://stackoverflow.com/users/7678252/matt-carter"}, "edited": false, "score": 0, "creation_date": 1488984680, "post_id": 42671815, "comment_id": 72473547, "body": "So if I wanted to paste columns 3 &amp; 4 from my array into a worksheet range, could I do this without looping or Indexing?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488986873, "post_id": 42671815, "comment_id": 72475160, "body": "@MattCarter you can fill the 2 columns separately with 2 Index calls, or better just use 2 separate array(2,11139) instead of one array(4,11139)"}, {"owner": {"reputation": 11, "user_id": 7678252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5PdF5LMJ13I/AAAAAAAAAAI/AAAAAAAAALg/V9eRr2-B3Aw/photo.jpg?sz=128", "display_name": "Matt Carter", "link": "https://stackoverflow.com/users/7678252/matt-carter"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488988181, "post_id": 42671815, "comment_id": 72476149, "body": "Cheers @Slai, that&#39;s a no then. It&#39;s my own fault for changing my spreadsheet format after writing the code but having already written a few thousand lines of code to get to the Array in question and now wanting to paste the two sets of columns separately I don&#39;t really want to go back through a long way to split the arrays earlier. Therefore I think I&#39;ll be doing the 2 Index calls in this instance as I shouldn&#39;t have more than 20,000 rows and never more than 4 columns to deal with so it&#39;s pretty quick really. Then I&#39;ll write a function for future work. Cheers for all your ideas :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7678252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5PdF5LMJ13I/AAAAAAAAAAI/AAAAAAAAALg/V9eRr2-B3Aw/photo.jpg?sz=128", "display_name": "Matt Carter", "link": "https://stackoverflow.com/users/7678252/matt-carter"}, "edited": false, "score": 0, "creation_date": 1488983202, "post_id": 42673599, "comment_id": 72472388, "body": "Thanks Charles, still not working properly though. I now have a 2,1 array rather than the 1,2 that was there before. Edited original post above to show it. Looks like I&#39;m writing a function with loops to do it so my code stays nice and neat."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1488997508, "last_edit_date": 1488997508, "creation_date": 1488982314, "answer_id": 42673599, "question_id": 42671815, "link": "https://stackoverflow.com/questions/42671815/vba-application-index-array-in-rows-doesnt-work/42673599#42673599", "title": "VBA application.index Array() in rows doesn&#39;t work", "body": "<p>You can use the INDEX approach if you wrap the ARRAY inside a TRANSPOSE</p>\n\n<pre><code>var1 = Application.Index(varData, Application.Transpose(Array(1, 2)), 0)\nvar2 = Application.Index(varData, Application.Transpose(Array(3, 4)), 0)\n</code></pre>\n\n<p><br> \nApologies: actually this does not work!<br><br>But its about 2.5 times slower than just copying the relevant parts of the array using VBA.<br></p>\n\n<pre><code>For k = 1 To UBound(varData, 2)\n    For j = 1 To 2\n        var1(j, k) = varData(j, k)\n        var2(j, k) = varData(j + 2, k)\n    Next \nNext \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 5182777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7826204353d38e61aa39839183a355e4?s=128&d=identicon&r=PG&f=1", "display_name": "Docmarti", "link": "https://stackoverflow.com/users/5182777/docmarti"}, "is_accepted": false, "score": 0, "last_activity_date": 1493092005, "creation_date": 1493092005, "answer_id": 43601240, "question_id": 42671815, "link": "https://stackoverflow.com/questions/42671815/vba-application-index-array-in-rows-doesnt-work/43601240#43601240", "title": "VBA application.index Array() in rows doesn&#39;t work", "body": "<pre><code>TheAddress = \"row(1:2)\"\nTheRows = Application.Evaluate(TheAddress) 'must be a 2 dimensions array \nTheColumns = Array(1, 2, 3)'must be a 1 dimension array \nSys1_Data_Array = Application.Index(Final_Data_Array, TheRows, TheColumns) \nCells(9, 1).Resize(UBound(Sys1_Data_Array), UBound(Sys1_Data_Array, 2)) = Sys1_Data_Array\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7678252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5PdF5LMJ13I/AAAAAAAAAAI/AAAAAAAAALg/V9eRr2-B3Aw/photo.jpg?sz=128", "display_name": "Matt Carter", "link": "https://stackoverflow.com/users/7678252/matt-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4266, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1529131865, "creation_date": 1488977282, "last_edit_date": 1592644375, "question_id": 42671815, "link": "https://stackoverflow.com/questions/42671815/vba-application-index-array-in-rows-doesnt-work", "title": "VBA application.index Array() in rows doesn&#39;t work", "body": "<p>I am trying to use the Application.Index function in excel VBA.</p>\n<p>I currently have an array(4,11139) that I am trying to splice into two separate arrays one containing the first 2 rows (2,11139) and the other containing the 3rd/4th rows (2, 11139). Various searches have suggested this code is the correct method but it's not working properly: (I've condensed the code to what is relevant)</p>\n<pre><code>Dim Adjusted_Data_Array() As Single\nDim Final_Data_Array() As Variant\nDim Sys1_Data_Array() As Variant\nDim Sys2_Data_Array() As Variant\n'Function that creates a 4,11139 variant array\nFinal_Data_Array = Strip_Erroneous(Adjusted_Data_Array, 1)\n'Splice first two rows\nSys1_Data_Array = Application.Index(Final_Data_Array, Array(1, 2), 0)\n'splice 3/4th rows\nSys2_Data_Array = Application.Index(Final_Data_Array, Array(3, 4), 0)\n</code></pre>\n<p>So I should now have 2 arrays each containing half the data from the first array. But all I get in the new arrays is a one dimensional array with two rows. Like this:</p>\n<h3>Screenshot of the watches from the 3 arrays discussed above.</h3>\n<p><img src=\"https://i.stack.imgur.com/ZSDbX.jpg\" alt=\"Screenshot of the watches from the 3 arrays discussed above.\" /></p>\n<p>I've tried it with the Array(1,2) in the columns and that doesn't work either.</p>\n<p>I can solve the issue in this regard by simply splitting into 4 separate one dimensional arrays (that works fine, it's the Array(1,2) or Array(3,4) that doesn't seem to. But I know in a future work coming up I'll be needing to splice much bigger arrays so would like to understand why it's not working ready for that.\nBig thanks in advance.</p>\n<p>Edit:\nTried using:</p>\n<pre><code>Sys1_Data_Array = Application.Index(Final_Data_Array, Application.Transpose(Array(1, 2)), 0)\n</code></pre>\n<p>as per charles suggestion below but end up with the array's simply switched indices as shown:</p>\n<h3>Screenshot of watches from transpose(array(1,2) attempt</h3>\n<p><img src=\"https://i.stack.imgur.com/L8e30.jpg\" alt=\"Screenshot of watches from transpose(array(1,2) attempt\" /></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1488977248, "post_id": 42671667, "comment_id": 72468175, "body": "Not sure what you want to do. Just getting the numbers 5 and 3 from the headings is easy, but what do you want to do with the numbers? Enter the text <code>Cre1 ... Cre5</code> in the rows below the heading or what?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1488977372, "post_id": 42671667, "comment_id": 72468265, "body": "Just record a macro when you do it manually.  But I suspect that is not what you really want to do, and your real requirements are more involved. Please read the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "edited": false, "score": 0, "creation_date": 1488977534, "post_id": 42671667, "comment_id": 72468376, "body": "I want to copy those columns to a different page but instead of doing it cell by cell i want to copy according to the heading so if it says (5) then display columns cred1 to cre5 on that separate sheet as well as the  the heading if that makes sense?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1488978061, "post_id": 42671667, "comment_id": 72468759, "body": "I believe that you actually want to copy 3 or 5 <i>rows</i> from that <i>column</i> to the other work[sheet|book]. Follow @RonRosenfeld advice and record a macro while you do it by hand. From there you can start to modify it to A) identify how many rows to pick up and B) how many columns to process. When you get stuck on a specific step, show your code and ask for help on that specific thing."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488978511, "post_id": 42671667, "comment_id": 72469087, "body": "Use the Right or Split function to get the number from the cell, then store that in a variable and make a loop using that variable."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "edited": false, "score": 0, "creation_date": 1488988583, "post_id": 42672269, "comment_id": 72476491, "body": "So instead of sTitle = Worksheets(&quot;Sheet1&quot;).Cells(1, 1) and select only cell 1,1 I want to look from A1 to A50 for any titles (because theres more than one title heading) I get type mismatch message when I do sTitle = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A50&quot;)"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "edited": false, "score": 0, "creation_date": 1488990185, "post_id": 42672269, "comment_id": 72477726, "body": "See edited answer."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 0, "last_activity_date": 1488990169, "last_edit_date": 1495540835, "creation_date": 1488978598, "answer_id": 42672269, "question_id": 42671667, "link": "https://stackoverflow.com/questions/42671667/how-to-relay-on-a-number-in-a-cell-and-list-columns-based-on-that-number-in-vba/42672269#42672269", "title": "how to relay on a number in a cell and list columns based on that number in vba", "body": "<p>Something like this? Credit to paxdiablo <a href=\"https://stackoverflow.com/a/7293481/1726522\">here</a>. <strong>Edited</strong>.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim sTitle As String\n    Dim openPos As Integer\n    Dim closePos As Integer\n    Dim midBit As Integer\n    Dim i As Integer\n    Dim k As Integer\n\n    For k = 1 To 50\n        sTitle = Worksheets(\"Sheet1\").Cells(1, k)\n        If sTitle &lt;&gt; \"\" Then\n            openPos = InStr(sTitle, \"(\")\n            closePos = InStr(sTitle, \")\")\n            midBit = Mid(sTitle, openPos + 1, closePos - openPos - 1)\n\n            For i = 1 To midBit\n                Worksheets(\"Sheet1\").Cells(i + 1, k) = \"cre\" &amp; i\n            Next i\n        End If\n    Next k\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1490344497, "accepted_answer_id": 42672269, "answer_count": 1, "score": -1, "last_activity_date": 1488990169, "creation_date": 1488976835, "question_id": 42671667, "link": "https://stackoverflow.com/questions/42671667/how-to-relay-on-a-number-in-a-cell-and-list-columns-based-on-that-number-in-vba", "closed_reason": "Needs more focus", "title": "how to relay on a number in a cell and list columns based on that number in vba", "body": "<p>Basically, I have list of credits in a spreadsheet. Each credit heading on the sheet is displayed as Credit(5) and it displays below that 5 credits i.e:</p>\n\n<pre><code>Credit(5)\nCre1\nCre2\nCre3\nCre4\nCre5\n</code></pre>\n\n<p>Then I have another heading with Credit(3) and that displays 3 credits below it i.e:</p>\n\n<pre><code>Credit(3)\nCre1\nCre2\nCre3\n</code></pre>\n\n<p>Now my question is how to do this in VB and relay on the numbers (3) and (5) and display below the heading list according to the number in the heading? so in other words have 5 columns below the heading if heading has (5) and 3 for the other one. </p>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1488977982, "post_id": 42671475, "comment_id": 72468694, "body": "Not sure what your For each loop is doing at all - it&#39;s not referenced in the loop at all? You should probably post all your code."}, {"owner": {"reputation": 13, "user_id": 7332082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b2ef56a89aa4084c6e8aaf6720090e?s=128&d=identicon&r=PG&f=1", "display_name": "dexterd", "link": "https://stackoverflow.com/users/7332082/dexterd"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1488978795, "post_id": 42671475, "comment_id": 72469274, "body": "I have edited the post to include complete code."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1488979138, "post_id": 42671475, "comment_id": 72469501, "body": "OK, so what is the point of the loop through the range?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1488979512, "post_id": 42671475, "comment_id": 72469738, "body": "did you try my answer below? Because it solved the problem in my test case."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7332082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b2ef56a89aa4084c6e8aaf6720090e?s=128&d=identicon&r=PG&f=1", "display_name": "dexterd", "link": "https://stackoverflow.com/users/7332082/dexterd"}, "edited": false, "score": 0, "creation_date": 1488980268, "post_id": 42672226, "comment_id": 72470261, "body": "Thank you! Works like a charm."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1488978811, "last_edit_date": 1488978811, "creation_date": 1488978476, "answer_id": 42672226, "question_id": 42671475, "link": "https://stackoverflow.com/questions/42671475/looping-through-dynamic-named-range-in-vba/42672226#42672226", "title": "Looping through Dynamic Named Range in VBA", "body": "<p>Hard to say whats wrong here but I suggest you try the following:</p>\n\n<ul>\n<li>use <code>For Each cell In wsSheet2.Range(\"TransTypes\").Cells</code> in for/each</li>\n</ul>\n\n<hr>\n\n<pre><code>For j = 1 To 96\n    i = 1\n    Set cell = Nothing\n    For Each cell In wsSheet2.Range(\"TransTypes\").Cells 'changed this line (2)\n        wsMain.Range(\"A\" &amp; j, \"C\" &amp; j).Copy\n        nws.Range(\"A\" &amp; k).PasteSpecial xlPasteValues\n        nws.Range(\"A\" &amp; k).PasteSpecial xlPasteFormats\n        wsSheet2.Range(\"A\" &amp; i).Copy\n        nws.Range(\"D\" &amp; k).PasteSpecial xlPasteValues\n        nws.Range(\"D\" &amp; k).PasteSpecial xlPasteFormats\n        i = i + 1\n        k = k + 1\n    Next cell\nNext j\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7332082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b2ef56a89aa4084c6e8aaf6720090e?s=128&d=identicon&r=PG&f=1", "display_name": "dexterd", "link": "https://stackoverflow.com/users/7332082/dexterd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2819, "favorite_count": 0, "accepted_answer_id": 42672226, "answer_count": 1, "score": 1, "last_activity_date": 1488978811, "creation_date": 1488976293, "last_edit_date": 1488978752, "question_id": 42671475, "link": "https://stackoverflow.com/questions/42671475/looping-through-dynamic-named-range-in-vba", "title": "Looping through Dynamic Named Range in VBA", "body": "<p>I have a nested loop on a dynamic named range in Sheet2 \"TransTypes\" which I defined as:</p>\n\n<pre><code>=OFFSET(Sheet2!$A$1,0,0,COUNTA(Sheet2!A:A),1)\n</code></pre>\n\n<p>and my looping is as follows:</p>\n\n<pre><code>Sub Repeat_trans_type()\n    Dim Trans_type_count As Integer, wb As Workbook, wsMain As Worksheet, nwb As Workbook\n    Dim i As Integer, nws As Worksheet, wsSheet2 As Worksheet, j As Integer, cell As Range\n    Dim k As Integer\n\n\n    Trans_type_count = Sheet2.Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n    Application.ScreenUpdating = False\n\n    Set wb = Workbooks(\"Book1.xlsm\")\n    Set wsMain = wb.Sheets(\"Sheet1\")\n    Set wsSheet2 = wb.Sheets(\"Sheet2\")\n\n    j = 1\n    k = 1\n\nSet nwb = Workbooks.Add\nSet nws = nwb.Sheets(1)\n\nFor j = 1 To 96\n        i = 1\n        Set cell = Nothing\n        For Each cell In wsSheet2.Names(\"TransTypes\").RefersToRange.Cells            \n        wsMain.Range(\"A\" &amp; j, \"C\" &amp; j).Copy\n        nws.Range(\"A\" &amp; k).PasteSpecial xlPasteValues\n        nws.Range(\"A\" &amp; k).PasteSpecial xlPasteFormats\n        wsSheet2.Range(\"A\" &amp; i).Copy\n        nws.Range(\"D\" &amp; k).PasteSpecial xlPasteValues\n        nws.Range(\"D\" &amp; k).PasteSpecial xlPasteFormats\n        i = i + 1\n        k = k + 1\n    Next cell\n    Next j\nEnd Sub\n</code></pre>\n\n<p>The first iteration of nested loop works fine but when it starts executing for second time, i.e j=2, I get the error message:</p>\n\n<pre><code>Application-defined or object-defined error\n</code></pre>\n\n<p>As of now, I have worked around this by using below:</p>\n\n<pre><code>For Each cell In wsSheet2.Range(\"A1\", wsSheet2.Range(\"A1\").End(xlDown))\n</code></pre>\n\n<p>instead of directly using the named range.</p>\n\n<p>Any ideas on why the offset approach is not working would be appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1488975764, "post_id": 42671206, "comment_id": 72467111, "body": "Have a look at this: <a href=\"http://stackoverflow.com/questions/37875901/ms-excel-join-external-sql-data-with-local-table-sheet/37896889#37896889\" title=\"ms excel join external sql data with local table sheet\">stackoverflow.com/questions/37875901/&hellip;</a> It <b>starts</b> by pulling a random table from the SQL but then the connection is altered and an SQL-Select is executed instead to pull data from the SQL."}, {"owner": {"reputation": 1391, "user_id": 2134932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bdc920302a09f31a7424d2f8eb3efb04?s=128&d=identicon&r=PG&f=1", "display_name": "Inus C", "link": "https://stackoverflow.com/users/2134932/inus-c"}, "edited": false, "score": 0, "creation_date": 1488978111, "post_id": 42671206, "comment_id": 72468795, "body": "Are you not able to run a extract from the database, so instead of pulling from excel, push from the database. In this case it is easy enough to specify your query."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489151823, "post_id": 42671206, "comment_id": 72558421, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37875901/ms-excel-join-external-sql-data-with-local-table-sheet\">MS Excel - join external (SQL) data with local table (sheet)</a>"}], "owner": {"reputation": 2373, "user_id": 1819427, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/AqNgV.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/1819427/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488975502, "creation_date": 1488975502, "last_edit_date": 1531161705, "question_id": 42671206, "link": "https://stackoverflow.com/questions/42671206/is-it-possible-to-connect-to-a-database-with-excel-and-execute-a-query-without-d", "title": "Is it possible to connect to a database with excel and execute a query without downloading the tables?", "body": "<p>I am not sure if what I want to do is possible...</p>\n\n<p>I want to be able to connect to a database using the \"Connection Wizard\" in Microsoft Excel 2010, without copying an entire table into excel.</p>\n\n<p>I need to run a select statement that is using several tables and enter this information into a spreadsheet on it's own.  Is this even possible?</p>\n\n<p>I have tried to use VBA to connect to the database and run my query but I am receiving this error : The Oracle(tm) client and networking components were not found.  These components are supplied by Oracle Corporation and are part of the Oracle Version 7.3 (or greater) client software.  </p>\n\n<p>I have added a reference to Microsoft Active X, but still not working.  I have tried downloading drivers, with no success.  I am able to connect to the database and run a query through Visual Studio, just not with Excel VBA.</p>\n\n<p>Is what I want to do even possible?</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7569963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a4120f226fa0ea841ddd19072dce7dc0?s=128&d=identicon&r=PG&f=1", "display_name": "wra", "link": "https://stackoverflow.com/users/7569963/wra"}, "edited": false, "score": 0, "creation_date": 1488975773, "post_id": 42670983, "comment_id": 72467122, "body": "Still new to pivot tables. I didn&#39;t realize putting it under rows will give me unique values. That&#39;s perfect, thanks a lot!"}], "tags": [], "owner": {"reputation": 261, "user_id": 7659656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eQBo.png?s=128&g=1", "display_name": "OES", "link": "https://stackoverflow.com/users/7659656/oes"}, "is_accepted": true, "score": 1, "last_activity_date": 1488974959, "creation_date": 1488974959, "answer_id": 42670983, "question_id": 42670843, "link": "https://stackoverflow.com/questions/42670843/how-to-remove-duplicates-depending-on-values-in-another-columns/42670983#42670983", "title": "How to remove duplicates depending on values in another column(s)?", "body": "<p>Insert Pivot Table.\nIn a Rows put [Week] and below that put [User]</p>\n\n<p>It would automatically give you list of weeks and users (only once).</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1488975242, "creation_date": 1488975242, "answer_id": 42671105, "question_id": 42670843, "link": "https://stackoverflow.com/questions/42670843/how-to-remove-duplicates-depending-on-values-in-another-columns/42671105#42671105", "title": "How to remove duplicates depending on values in another column(s)?", "body": "<p>You can use  <strong><em>Remove Duplicates</em></strong> to achieve what you described in your post.</p>\n\n<p>Select your range, and then select both columns, click the check mark <strong>V</strong> next to \"My data has headers\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/1jvw2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1jvw2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Result after running:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WyaUu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WyaUu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8463770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16763b6e8cb498f5fddd4f5baa1e302?s=128&d=identicon&r=PG", "display_name": "user8463770", "link": "https://stackoverflow.com/users/8463770/user8463770"}, "is_accepted": false, "score": 0, "last_activity_date": 1523681524, "last_edit_date": 1523681524, "creation_date": 1523650011, "answer_id": 49824401, "question_id": 42670843, "link": "https://stackoverflow.com/questions/42670843/how-to-remove-duplicates-depending-on-values-in-another-columns/49824401#49824401", "title": "How to remove duplicates depending on values in another column(s)?", "body": "<p>If you have a large data set and you want to accomplish this in VBA, you can achieve this by using the RemoveDuplicates method. </p>\n\n<p>Try this:</p>\n\n<pre><code>Dim LR as Long \n\nLR = activesheet.usedrange.rows.count\n\nRange(\u201cA1:B\u201d &amp; LR).RemoveDuplicates Columns:=Array(1, 2), Header:=xlYes\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 7569963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a4120f226fa0ea841ddd19072dce7dc0?s=128&d=identicon&r=PG&f=1", "display_name": "wra", "link": "https://stackoverflow.com/users/7569963/wra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 42670983, "answer_count": 3, "score": 0, "last_activity_date": 1523681524, "creation_date": 1488974561, "question_id": 42670843, "link": "https://stackoverflow.com/questions/42670843/how-to-remove-duplicates-depending-on-values-in-another-columns", "title": "How to remove duplicates depending on values in another column(s)?", "body": "<pre><code>[Week]           [User]\n\nWeek 1           Bryan\nWeek 1           Sam\nWeek 1           Bryan\nWeek 1           Will\nWeek 2           Bryan\nWeek 2           Will\nWeek 2           Will\n</code></pre>\n\n<p>I'm looking to be able to count unique users per week.  Therefore, I'd like to remove duplicates, but per week.  So in the example above, Week 1 should only have Bryan, Sam, and Will, and Week 2 will have Bryan, and Will.\nRegular \"Remove Duplicates\" will remove names across weeks as well which is what I don't want.  So is there someway to count and/or remove duplicates in a column, based on value(s) in another column?  VBA code is also very much welcome.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "edited": false, "score": 0, "creation_date": 1488973211, "post_id": 42670292, "comment_id": 72465264, "body": "In case you are using office 2013 or above, you can use built in comparer for desired results,  <a href=\"https://technet.microsoft.com/en-us/library/dn205148.aspx\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/dn205148.aspx</a>, Important: .NET Framework 4.0 must be installed before you can use Spreadsheet Compare."}, {"owner": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "edited": false, "score": 0, "creation_date": 1488973543, "post_id": 42670292, "comment_id": 72465529, "body": "is varSheetA(iRow, iCol).Interior.Color = RGB(127,187,199) not working?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "edited": false, "score": 0, "creation_date": 1488973581, "post_id": 42670292, "comment_id": 72465560, "body": "Thanks for the suggestion. I need to have it with vba as I will be putting it in a button so it will be one click for the user."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "edited": false, "score": 0, "creation_date": 1488973979, "post_id": 42670292, "comment_id": 72465844, "body": "I tried to add the varSheetA(iRow, iCol).Interior.Color = RGB(127,187,199). But it gives me error on the line: For iRow = LBound(varSheetA, 1) To UBound(varSheetA, 1) which is type mismatch. What could be the problem?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "edited": false, "score": 0, "creation_date": 1488974194, "post_id": 42670292, "comment_id": 72466018, "body": "Now it says object required for the line: varSheetA(iRow, iCol).Interior.Color = RGB(127,187,199)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1488975097, "post_id": 42670292, "comment_id": 72466651, "body": "You are treating varSheetA as an array, using LBound, but it is a range so loop through with a range variable."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488975360, "post_id": 42670292, "comment_id": 72466830, "body": "How would I put it in a code?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1488975595, "post_id": 42670292, "comment_id": 72466996, "body": "Suggested below."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488975871, "post_id": 42671249, "comment_id": 72467212, "body": "Thanks for the suggestion, I am now encountering error on the line: For iRow = 1 To varSheetA.Rows.Count and it says &quot;Object Required&quot;."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488976474, "post_id": 42671249, "comment_id": 72467624, "body": "Have you tried stepping through you code? Are you using my code exactly as posted - I have changed the declarations also?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488976908, "post_id": 42671249, "comment_id": 72467909, "body": "it is working now. Somehow, it is highlighting the Range B2:D49. I need to only highlight the duplicate it detects from the sheet of another workbook."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488977606, "post_id": 42671249, "comment_id": 72468426, "body": "There&#39;s nothing in your code that highlights anything."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488978846, "post_id": 42671249, "comment_id": 72469298, "body": "I have added what @Anil Kumar suggested which is: varSheetA(iRow).Interior.Color = RGB(127, 187, 199). I have added it after: If varSheetA(iRow, iCol) = varSheetB(iRow, iCol) Then. But it only highlights the range B2:D49. How would I put it in code that will highlight the detected duplicates between sheets of 2 workbooks?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488979101, "post_id": 42671249, "comment_id": 72469475, "body": "At the moment you&#39;re saying colour the cells if it&#39;s the same in both workbooks. What do you want to happen?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488979712, "post_id": 42671249, "comment_id": 72469883, "body": "I have workbook(main) and workbook(2) opened. I need to compare the sheet(SAP) of workbook(main) to the sheet(SAP) of workbook(2). They have the same sheet names and columns. If there is an item from sheet(SAP) of workbook(main) existing in sheet(SAP) of Workbook(2). Then I need the cell / entire row of the item in sheet(SAP) of workbook(main) be highlighted. In the case of above code, it highlights the range B2:D49."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488979832, "post_id": 42671249, "comment_id": 72469967, "body": "I&#39;ve amended the code above which should not highlight the whole range. So you&#39;re saying that if it exists anywhere in workbook(2) it should be highlighted, not only if it is in the same cell?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488980660, "post_id": 42671249, "comment_id": 72470538, "body": "I have tried the code above but it still highlighted the defined range which is B2:D49. Yes, because item might be in the different cell in the next days. It&#39;s like I need to find duplicate in sheet 1 and sheet 2 and highlight the cell / item if it exists in sheet 2."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488981200, "post_id": 42671249, "comment_id": 72470936, "body": "I have tried above code and it says that: &quot;Invalid next control variable reference&quot; on the line Next iRow."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488981252, "post_id": 42671249, "comment_id": 72470964, "body": "I got the next&#39;s the wrong way round - corrected above. Just need to swap variables."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488981530, "post_id": 42671249, "comment_id": 72471181, "body": "Hi SJR I have tried the code but it is still the same. Highlighting the Range B2:D49.."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488981561, "post_id": 42671249, "comment_id": 72471199, "body": "Have you cleared the range of formatting before you run the code?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488981879, "post_id": 42671249, "comment_id": 72471423, "body": "Yes, I have cleared the range. Actually I have deleted the sheet and created again. Maybe this declaration has something to do with it that&#39;s why it highlights B2:D49 --&gt; strRangeToCheck = &quot;B2:D49&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488982063, "post_id": 42671249, "comment_id": 72471559, "body": "If you can try once more as I spotted a small typo in the code (doubt it will make much difference though). Are there definitely values in sheetA that are not in sheetB?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983071, "post_id": 42671249, "comment_id": 72472285, "body": "Yes there are. I tried it now and it seems to be working. It highlights an item in sheetA which is existing in SheetB and ignores that are not duplicate. Somehow, it highlights what ever range I declare in strRangeToCheck. Like for example I changed the value to B2:B100. I have items from B2 til B6. And only B2 is highlight which is actually existing in sheetB. So this is already correct. Somehow, the highlight continues from B7 until B100. Could this be related to it?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983203, "post_id": 42671249, "comment_id": 72472391, "body": "Well I suppose a blank cell would be regarded as duplicate. If the range you want to check in sheetA is going to change then the code should be amended. Will it always start in B2, and could it be any number of rows and columns?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983435, "post_id": 42671249, "comment_id": 72472579, "body": "The other question is, will you always be checking the same range in sheetB as sheetA?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983477, "post_id": 42671249, "comment_id": 72472611, "body": "Oh ok. Yes it always starts at B2 as I have a header in B1. There are no definite number of rows, but in column yes, and the column will always 4.Currently I have 5 items starting B2 til B6. And tomorrow or any other day, it will change. -- The purpose of this is to highlight the item that is not posted from yesterday. So this feature will be very helpful to remind the user to process it so it will be removed from the list on the other day. Just to give you background of it. :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983860, "post_id": 42671249, "comment_id": 72472919, "body": "I&#39;ve amended code above once more so let me know how it goes."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488983920, "post_id": 42671249, "comment_id": 72472961, "body": "To answer the other question. Actually, I needed to only check the rows in a certain column. Like for this example, I am checking column B if there are any rows that are duplicate from SheetA to SheetB."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488984763, "post_id": 42671249, "comment_id": 72473614, "body": "I tried it and it is almost working to what I needed! :) Somehow, could you please help amend the code that it will only search in column B? As I have checked, column B is working fine. But I think it searches also on the other column. With this, it highlights when there are some blanks on the other column. I only need it to be in Column B."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488984885, "post_id": 42671249, "comment_id": 72473723, "body": "Off we go again! Amended above."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488984942, "post_id": 42671249, "comment_id": 72473760, "body": "I have 4 columns and when there are any blanks / same value on columns A, C, D it highlights also. I would like to focus on column B only."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488985291, "post_id": 42671249, "comment_id": 72474009, "body": "Hi :)  It still highlights the rows of other columns. I needed it only to be highlighted the duplicate row in column B."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488985378, "post_id": 42671249, "comment_id": 72474078, "body": "I think you probably need to clear all formatting before you start. Henceforth, the code should take care of it."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488985807, "post_id": 42671249, "comment_id": 72474388, "body": "I have cleared everything before starting to test again. I have column A, B, C and D. The code above works fine with the rows of Column B. And highlights the duplicate(which is working fine). Somehow, it seems that it is also search in the other columns. In this case, all rows of other columns are highlighted. I would like to focus on the data in column B and highlight it when it&#39;s a duplicate in SheetB."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488986055, "post_id": 42671249, "comment_id": 72474560, "body": "I have simplified the code above, but I don&#39;t see how that can be happening as it is only looking at column B."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488986254, "post_id": 42671249, "comment_id": 72474686, "body": "Thanks, SJR, I will try after 30 mins. And will let you. I&#39;ll be back. :)"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1488987953, "post_id": 42671249, "comment_id": 72475978, "body": "Tested it and works the way I wanted it. Thanks SJR! Up you go! :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1488985942, "last_edit_date": 1488985942, "creation_date": 1488975623, "answer_id": 42671249, "question_id": 42670292, "link": "https://stackoverflow.com/questions/42670292/highlight-duplicates-between-two-sheets-of-2-workbook/42671249#42671249", "title": "Highlight Duplicates between two sheets of 2 workbook", "body": "<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Range\nDim varSheetB As Range\nDim r As Range\nDim wbkA As Workbook\nDim rFind As Range\n\nSet wbkA = ActiveWorkbook\nWith wbkA.Worksheets(\"SAP\")\n    .UsedRange.Interior.ColorIndex = xlNone\n    Set varSheetA = .Range(\"B2\", .Range(\"B\" &amp; Rows.Count).End(xlUp))\nEnd With\nSet wbkB = Workbooks.Open(Filename:=\"C:\\Request Distribution\\Reminder 20170302.xls\")\nSet varSheetB = wbkB.Worksheets(\"SAP\").Range(varSheetA.Address)\n\nFor Each r In varSheetA\n    Set rFind = varSheetB.Find(What:=r, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        r.Interior.Color = RGB(127, 187, 199)\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 42671249, "answer_count": 1, "score": 0, "last_activity_date": 1488985942, "creation_date": 1488972991, "last_edit_date": 1531164843, "question_id": 42670292, "link": "https://stackoverflow.com/questions/42670292/highlight-duplicates-between-two-sheets-of-2-workbook", "title": "Highlight Duplicates between two sheets of 2 workbook", "body": "<p>I am creating a macro that will compare the sheets of two workbook. And I need the row to be highlighted if found duplicate in a sheet of another workbook. So far, I have been search and I found code but I am not sure how I can highlight the cell / entire row if it found a duplicate in another sheet of another workbook. Here is my code below:</p>\n\n<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim strRangeToCheck As String\nDim iRow As Long\nDim iCol As Long\n\n\n\nstrRangeToCheck = \"B2:D49\"\n\nSet wbkA = ActiveWorkbook \nSet varSheetA = wbkA.Worksheets(\"SAP\").Range(strRangeToCheck)\nSet wbkB = Workbooks.Open(FileName:=\"C:\\Request Distribution\\Reminder 20170302.xls\")\nSet varSheetB = wbkB.Worksheets(\"SAP\").Range(strRangeToCheck)\n\nFor iRow = LBound(varSheetA, 1) To UBound(varSheetA, 1)\nFor iCol = LBound(varSheetA, 2) To UBound(varSheetA, 2)\n    If varSheetA(iRow, iCol) = varSheetB(iRow, iCol) Then\n\n       'What to put to hightlight the cell / entire row\n\n    Else\n\n    'Some msgbox to display that there are no duplicates between sheets of 2 workbooks\n\n    End If\nNext\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 1, "creation_date": 1488973659, "post_id": 42670187, "comment_id": 72465612, "body": "Is <code>Id</code> a number?"}, {"owner": {"reputation": 13, "user_id": 7654657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2c354fd2b72278c7d2cb57aa0453b68?s=128&d=identicon&r=PG&f=1", "display_name": "dataMan", "link": "https://stackoverflow.com/users/7654657/dataman"}, "reply_to_user": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 0, "creation_date": 1488974005, "post_id": 42670187, "comment_id": 72465865, "body": "Nope Id is a string, another example would be <code>Custom field(Status)</code> where i would just want to keep <code>Status</code>"}, {"owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 0, "creation_date": 1488974102, "post_id": 42670187, "comment_id": 72465954, "body": "so my <code>Solution1</code> will work for both cases. You can create a VBA code that will <code>&quot;Find And Replace&quot;</code>  the string <code>Custom field(</code> for <code>nothing</code> and <code>&quot;Find And Replace&quot;</code>  the char <code>)</code> for <code>nothing</code>"}, {"owner": {"reputation": 13, "user_id": 7654657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2c354fd2b72278c7d2cb57aa0453b68?s=128&d=identicon&r=PG&f=1", "display_name": "dataMan", "link": "https://stackoverflow.com/users/7654657/dataman"}, "reply_to_user": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 0, "creation_date": 1488974211, "post_id": 42670187, "comment_id": 72466029, "body": "I have tried that but it does nothing when i run the macro, I have updated the question with the code"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7654657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2c354fd2b72278c7d2cb57aa0453b68?s=128&d=identicon&r=PG&f=1", "display_name": "dataMan", "link": "https://stackoverflow.com/users/7654657/dataman"}, "edited": false, "score": 0, "creation_date": 1488974977, "post_id": 42670499, "comment_id": 72466578, "body": "Thanks for answer, it was very helpful, however I am still having a slight issue in that when I run the Macro nothing happens? I have altered your find a replace suggestion in my code but as I said when I run it nothing changes?"}, {"owner": {"reputation": 13, "user_id": 7654657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2c354fd2b72278c7d2cb57aa0453b68?s=128&d=identicon&r=PG&f=1", "display_name": "dataMan", "link": "https://stackoverflow.com/users/7654657/dataman"}, "edited": false, "score": 1, "creation_date": 1488975171, "post_id": 42670499, "comment_id": 72466723, "body": "Solved the issue, turns out the security level was set to high and the marcos were disabled, thanks again"}], "tags": [], "owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "is_accepted": true, "score": 1, "last_activity_date": 1488973577, "creation_date": 1488973577, "answer_id": 42670499, "question_id": 42670187, "link": "https://stackoverflow.com/questions/42670187/excel-find-and-replace-regex-macro/42670499#42670499", "title": "Excel FInd and Replace Regex Macro", "body": "<p>You can achieve this using <code>Find &amp; Replace</code> without regex!</p>\n\n<p><a href=\"https://i.stack.imgur.com/nqBZX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nqBZX.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Solution1:</strong></p>\n\n<ol>\n<li>Select your data</li>\n<li>Open Find &amp; Replace module</li>\n<li>Replace <code>\"Custom Field(\"</code> for <code>\"\"</code></li>\n<li>Replace <code>\")\"</code> for <code>\"\"</code></li>\n</ol>\n\n<p><strong>Solution2:</strong></p>\n\n<p>You can either use the formula present in <a href=\"https://www.mrexcel.com/forum/excel-questions/459758-how-do-i-strip-out-all-non-numeric-characters.html\" rel=\"nofollow noreferrer\">this site</a> or use the VBA code posted at <a href=\"https://www.extendoffice.com/documents/excel/651-excel-remove-non-numeric-characters.html\" rel=\"nofollow noreferrer\">this site</a> to remove all the non-numeric characters out of a string.</p>\n\n<pre><code>Sub RemoveNotNum()\n'Updateby20131129\nDim Rng As Range\nDim WorkRng As Range\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nFor Each Rng In WorkRng\n    xOut = \"\"\n    For i = 1 To Len(Rng.Value)\n        xTemp = Mid(Rng.Value, i, 1)\n        If xTemp Like \"[0-9]\" Then\n            xStr = xTemp\n        Else\n            xStr = \"\"\n        End If\n        xOut = xOut &amp; xStr\n    Next i\n    Rng.Value = xOut\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1489024590, "creation_date": 1489024590, "answer_id": 42685282, "question_id": 42670187, "link": "https://stackoverflow.com/questions/42670187/excel-find-and-replace-regex-macro/42685282#42685282", "title": "Excel FInd and Replace Regex Macro", "body": "<p>Regexp / Variant array solution</p>\n\n<p>Also handles situations where user selects multiple areas in the range.</p>\n\n<pre><code>Sub Retain()\nDim X\nDim rng1 As Range\nDim rng2 As Range\nDim objRegex As Object\nDim lngRow As Long\nDim lngCOl As Long\n\nOn Error Resume Next\nSet rng1 = Application.InputBox(\"select range\", , Selection.Address, , , , , 8)\nOn Error GoTo 0\n\nIf rng1 Is Nothing Then Exit Sub\n\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Pattern = \"[^0-9]\"\n    .Global = True\nFor Each rng2 In rng1.Areas\nIf rng2.Cells.Count &gt; 1 Then\n    X = rng2.Value2\n        For lngRow = 1 To UBound(X, 1)\n            For lngCOl = 1 To UBound(X, 2)\n                X(lngRow, lngCOl) = .Replace(X(lngRow, lngCOl), vbNullString)\n            Next\n        Next\n    rng2.Value2 = X\nElse\n   rng2.Value2 = .Replace(rng2, vbNullString)\nEnd If\nNext\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7654657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2c354fd2b72278c7d2cb57aa0453b68?s=128&d=identicon&r=PG&f=1", "display_name": "dataMan", "link": "https://stackoverflow.com/users/7654657/dataman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 42670499, "answer_count": 2, "score": 1, "last_activity_date": 1489024590, "creation_date": 1488972716, "last_edit_date": 1488974255, "question_id": 42670187, "link": "https://stackoverflow.com/questions/42670187/excel-find-and-replace-regex-macro", "title": "Excel FInd and Replace Regex Macro", "body": "<p>I am trying to create a Macro that is giving me some issue as I have no experience and no idea where to start.</p>\n\n<p>All I am trying to do is create a find and replace Macro that will replace part of a string with nothing.</p>\n\n<p>For example I have the following <code>Custom Field(Id)</code> and all I want the marco to do is remove everything apart from<code>Id</code>.</p>\n\n<p>How can I achieve this?</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FindReplace()\n\nDim sht As Worksheet\nDim fndList As Variant\nDim rplcList As Variant\nDim x As Long\n\nfndList = Array(\"Custom field(\", \")\")\nrplcList = Array(\"\", \"\")\n\n'Loop through each item in Array lists\nFor x = LBound(fndList) To UBound(fndList)\n    'Loop through each worksheet in ActiveWorkbook\n    For Each sht In ActiveWorkbook.Worksheets\n        sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n        SearchFormat:=False, ReplaceFormat:=False\n    Next sht\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488973570, "post_id": 42670092, "comment_id": 72465550, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18794284/excel-vba-how-to-copy-sheet-with-all-formatting-page-setup\">Excel vba how to copy sheet with all formatting &amp; page setup</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7677910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DhHA5cysu7s/AAAAAAAAAAI/AAAAAAAAAY4/fyhmWm2A92U/photo.jpg?sz=128", "display_name": "ChL", "link": "https://stackoverflow.com/users/7677910/chl"}, "edited": false, "score": 0, "creation_date": 1488976956, "post_id": 42670717, "comment_id": 72467948, "body": "Thanks Shai Rado for your answer, but the my problem is how to conserve the same format of sheet1 when copying tipically the colours of some cells ?????! Do I need to use Paste special ????"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7677910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DhHA5cysu7s/AAAAAAAAAAI/AAAAAAAAAY4/fyhmWm2A92U/photo.jpg?sz=128", "display_name": "ChL", "link": "https://stackoverflow.com/users/7677910/chl"}, "edited": false, "score": 0, "creation_date": 1488977022, "post_id": 42670717, "comment_id": 72467995, "body": "@ChL this copies the entire sheet as it is, cell colors, cell&#39;s font colors, borders, everything just as it is"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1488974176, "creation_date": 1488974176, "answer_id": 42670717, "question_id": 42670092, "link": "https://stackoverflow.com/questions/42670092/copy-worksheet-after-another-and-conserve-the-format-colours/42670717#42670717", "title": "Copy worksheet after another and conserve the format (colours)", "body": "<p>The code below will copy \"Sheet1\" , will paste it at the end, and will rename it to \"Sheet\" &amp; number of sheets in this workbook.</p>\n\n<p><em>Example</em>: Let's say you have 3 sheets, you copy \"Sheet1\", it's placed after \"Sheet3\" (ot whatever is the name of your last sheet), and it renames it to \"Sheet4\" (since now the count of sheets is 4).</p>\n\n<p><strong>Code</strong> </p>\n\n<pre><code>Option Explicit\n\nSub CopySheet_andFormat()\n\nApplication.Interactive = False\nWorksheets(\"Sheet1\").Copy After:=Worksheets(ThisWorkbook.Worksheets.Count)\nActiveSheet.Name = \"Sheets\" &amp; ThisWorkbook.Worksheets.Count\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7677910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DhHA5cysu7s/AAAAAAAAAAI/AAAAAAAAAY4/fyhmWm2A92U/photo.jpg?sz=128", "display_name": "ChL", "link": "https://stackoverflow.com/users/7677910/chl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1488974176, "creation_date": 1488972501, "last_edit_date": 1488973795, "question_id": 42670092, "link": "https://stackoverflow.com/questions/42670092/copy-worksheet-after-another-and-conserve-the-format-colours", "title": "Copy worksheet after another and conserve the format (colours)", "body": "<p>I want to know how I can copy with format (colours) the content of a worksheet after another using special paste.</p>\n\n<p>My code:</p>\n\n<pre><code>Application.Interactive = False\nbtVar = Sheets.Count\nWorksheets(\"sheets1\").copy after:=Worksheets((\"sheetsB\" &amp; btVar))\nbtVar = btVar + 1\nActiveSheet.Name = (\"sheetsB\" &amp; btVar)\n</code></pre>\n\n<p>with this code the new sheet <code>\"sheetsB\" &amp; btVar</code> is a copy of <code>\"sheets1\"</code> but without conservig the format (colours of some cells). </p>\n\n<p>Can anyone help me please ?</p>\n"}, {"tags": ["vba", "powerpoint-2013"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1488974354, "post_id": 42669448, "comment_id": 72466141, "body": "i m not sure but i think it is like selection.style.fontfamily= &quot;Courier New&quot; .fontstyle=Bold or font.bold=true"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "edited": false, "score": 0, "creation_date": 1520874609, "post_id": 42671003, "comment_id": 85485330, "body": "This doesn&#39;t work for text within SmartArt graphics, any idea how to get around that?"}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 2, "last_activity_date": 1488975003, "creation_date": 1488975003, "answer_id": 42671003, "question_id": 42669448, "link": "https://stackoverflow.com/questions/42669448/how-to-change-the-font-of-a-selection-in-powerpoint-2013-with-vba/42671003#42671003", "title": "How to change the font of a selection in powerpoint 2013 with VBA", "body": "<p>This will change the font and make it bold when you run it</p>\n\n<pre><code>With ActiveWindow.Selection.TextRange.Font\n    .Name = \"Courier New\"\n    .Bold = msoTrue\nEnd With\n</code></pre>\n\n<p>Since you are running it from a selection the document will should always be the active one, other wise you will need to change the <code>ActiveWindow</code></p>\n"}], "owner": {"reputation": 101, "user_id": 2733168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f6d7b466ba00b115b68dbc11d513a6?s=128&d=identicon&r=PG&f=1", "display_name": "Drago", "link": "https://stackoverflow.com/users/2733168/drago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 42671003, "answer_count": 1, "score": 1, "last_activity_date": 1488975003, "creation_date": 1488970685, "question_id": 42669448, "link": "https://stackoverflow.com/questions/42669448/how-to-change-the-font-of-a-selection-in-powerpoint-2013-with-vba", "title": "How to change the font of a selection in powerpoint 2013 with VBA", "body": "<p>I would like to to change for the text selection in powerpoint 2013 the font to be bold and \"Couirier New\". I tried with this VBA script to change the font:</p>\n\n<pre><code>Sub chengeFont()\n    With ActiveDocument.Selection\n        With .Font\n            .Name = \"Courier New\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>but it is not working. Any suggestions? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488972027, "post_id": 42669404, "comment_id": 72464387, "body": "Can you elaborate a touch more on the sheet it resides in, a quick test off the Change event showing a message box for me, worked instantly.  Is the linked cell used in any formula that could be causing the lag.  How long does a recalc of the workbook take?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1488973300, "post_id": 42669404, "comment_id": 72465341, "body": "@Nathan_Sav He/she is using <a href=\"http://chandoo.org/wp/2014/03/03/handle-volatile-functions-like-they-are-dynamite/\" rel=\"nofollow noreferrer\">volatile-functions</a>. To me that explains already a lot. Depending on the code of these UDFs and how often they have been used in the file this can easily slow down any recalculation by 5 seconds (as described). Obviously the problem lies within all the hidden features within that file we don&#39;t know about (possibly also Worksheet_SelectionChange or other events). Anyhow, this does not seem to be a question for SO but rather for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>."}, {"owner": {"reputation": 69, "user_id": 2606124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6851d3dd6a7990f84bcd6c3ae4b69ba9?s=128&d=identicon&r=PG", "display_name": "kururu", "link": "https://stackoverflow.com/users/2606124/kururu"}, "edited": false, "score": 0, "creation_date": 1488975865, "post_id": 42669404, "comment_id": 72467205, "body": "Thanks for your reply. Yes, the problem lies with volatile-functions. But I cannot find any resource on the internet regarding the excel event firing and   volatile re-calculations. Sorry for the mistake in the post, a mouse click after a new selection in the drop list will trigger this function; It seems the mouse click force the sheet to recalculate all  volatile functions as well as the event."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1488976010, "post_id": 42669404, "comment_id": 72467298, "body": "If you had read through the link I posted in my comment above then you&#39;d know that <b>all</b> volatile functions get recalculated and it does <b>not</b> matter if they are related to any cell that was changed. Download that Excel file which is offered in the above link and see for yourself."}, {"owner": {"reputation": 69, "user_id": 2606124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6851d3dd6a7990f84bcd6c3ae4b69ba9?s=128&d=identicon&r=PG", "display_name": "kururu", "link": "https://stackoverflow.com/users/2606124/kururu"}, "edited": false, "score": 0, "creation_date": 1488976183, "post_id": 42669404, "comment_id": 72467438, "body": "I read it through, the wired points the drop down list changed event is emit with the  re-calculations, this is my question and this is not really explained in this article. Thanks a lot if you could give me some insights on that."}], "owner": {"reputation": 69, "user_id": 2606124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6851d3dd6a7990f84bcd6c3ae4b69ba9?s=128&d=identicon&r=PG", "display_name": "kururu", "link": "https://stackoverflow.com/users/2606124/kururu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 724, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488975681, "creation_date": 1488970550, "last_edit_date": 1488975681, "question_id": 42669404, "link": "https://stackoverflow.com/questions/42669404/excel-drop-down-change-event-not-firing-on-time", "title": "Excel drop down change event not firing on time", "body": "<p>I am currently working on a excel project. Because of the data is coming from real time database; so there are many volatile functions in that and the recalculation will loop about 10 loops per minutes.</p>\n\n<p>In one sheet where I need to provide a drop down box as a selection for users.\nThe drop down list is created by <strong>ActiveX control</strong>  not from data visualization.</p>\n\n<p>The <code>Sub DropDown2_Change()</code> is assigned to this drop down list.</p>\n\n<pre><code>Sub DropDown2_Change()\n    Call Sheets(\"LS Chart\").FormatChart\nEnd Sub\n</code></pre>\n\n<p>The drop box is also <strong>linked to a cell</strong> where I can get the selection of it. Because there is many selections, it is more efficient to do that than a hard wired case clause.</p>\n\n<p>However, I observed the function is not triggered immediately after the selection changed. <strong>I have to wait for nearly 5 seconds</strong> until the function starts to execute. I verified that by adding bread points, but if I do a mouse click after a new selection in the list, the function will be evoked immediately., which is quite wired.</p>\n\n<p>Here are my questions,</p>\n\n<ol>\n<li>Is the drop list change event is blocked until the current loop of auto re-computation evoked by volatile functions finished?</li>\n<li>If the answer is yes, why the <code>beforedoubleclick</code> event is always handled on time? What are the differences between them?</li>\n<li>What can I do to force excel to emit drop list change event immediately?</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1488970618, "post_id": 42669341, "comment_id": 72463413, "body": "If you have working code which merely needs improvements then you&#39;re probably in the wrong place with this post. <a href=\"http://codereview.stackexchange.com/\">Code Review</a> is where they handle existing / working code and do their upmost to improve it in terms of speed, security, sustainability, and longevity including best-practices. Give it a try. They&#39;re good!"}, {"owner": {"reputation": 43, "user_id": 7545615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6c2d6c815b1ad13c4699a866182b66?s=128&d=identicon&r=PG&f=1", "display_name": "Morten", "link": "https://stackoverflow.com/users/7545615/morten"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1488970679, "post_id": 42669341, "comment_id": 72463451, "body": "Thanks! I will post it there and hope for some help :D"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 1, "creation_date": 1488971771, "post_id": 42669341, "comment_id": 72464221, "body": "practice loading the data into variant arrays then dumping it back into the worksheet. as it stands you have close to 100,000 potential transactions and comparisons. The mean calculations are almost 90,000 of these which explains their impact on the speed."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7545615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6c2d6c815b1ad13c4699a866182b66?s=128&d=identicon&r=PG&f=1", "display_name": "Morten", "link": "https://stackoverflow.com/users/7545615/morten"}, "edited": false, "score": 0, "creation_date": 1489058482, "post_id": 42670485, "comment_id": 72510179, "body": "Wow, that made it instant!! Thanks so much, why does that make it so much faster?"}, {"owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "reply_to_user": {"reputation": 43, "user_id": 7545615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6c2d6c815b1ad13c4699a866182b66?s=128&d=identicon&r=PG&f=1", "display_name": "Morten", "link": "https://stackoverflow.com/users/7545615/morten"}, "edited": false, "score": 0, "creation_date": 1489060181, "post_id": 42670485, "comment_id": 72511274, "body": "@MinMorts You welcome. If my answer help you, please accept it. To understand why the code is most faster, please read this:  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193498.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff193498.aspx</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1489151571, "post_id": 42670485, "comment_id": 72558242, "body": "For future VBA coding you might want to read-up on coding best practices as documented here: <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/5925/switch-off-properties-during-macro-execution#t=201703101311474631047\">stackoverflow.com/documentation/excel-vba/1107/&hellip;</a> @Marius suggestion is also part of it."}], "tags": [], "owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "is_accepted": true, "score": 1, "last_activity_date": 1488973544, "creation_date": 1488973544, "answer_id": 42670485, "question_id": 42669341, "link": "https://stackoverflow.com/questions/42669341/smallish-vba-macro-runs-really-slow/42670485#42670485", "title": "Smallish VBA Macro runs really Slow", "body": "<p>Insert your code where I commented:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\n'----enter here all of your code----\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7545615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6c2d6c815b1ad13c4699a866182b66?s=128&d=identicon&r=PG&f=1", "display_name": "Morten", "link": "https://stackoverflow.com/users/7545615/morten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1489152803, "accepted_answer_id": 42670485, "answer_count": 1, "score": 0, "last_activity_date": 1488973544, "creation_date": 1488970422, "last_edit_date": 1488971700, "question_id": 42669341, "link": "https://stackoverflow.com/questions/42669341/smallish-vba-macro-runs-really-slow", "closed_reason": "Not suitable for this site", "title": "Smallish VBA Macro runs really Slow", "body": "<p>My Macro that I wrote is running really slowly and I'm not sure why. The Macro deletes the area, then reproduces one column of locations as a row, deleting any duplicates, then copy's across a column of dates, then puts the corresponding Mean value for each date under the correct functional location.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n\n\n' Delete Previous Data\nRange(\"J1:AQ1000\").Clear\n\n' Functional Location\n\nDim toAdd As Boolean, uniqueTag As Integer, i As Integer, j As Integer\nCells(1, 11).Value = Cells(2, 2).Value\nuniqueTag = 11\ntoAdd = True\nFor i = 3 To 1000\nFor j = 11 To uniqueTag\nIf Cells(i, 2).Value = Cells(1, j).Value Then\ntoAdd = False\nEnd If\nNext j\nIf toAdd = True Then\nCells(1, uniqueTag + 1).Value = Cells(i, 2).Value\nuniqueTag = uniqueTag + 1\nEnd If\ntoAdd = True\nNext i\n\n' Date\n\nDim k As Integer\nFor k = 2 To 1000\nCells(k, 10).Value = Cells(k, 6).Value\nNext k\n\n' Mean Value\nDim l As Integer, m As Integer\nFor l = 2 To 1000\nFor m = 11 To 100\nIf Cells(l, 2).Value = Cells(1, m).Value Then\nCells(l, m).Value = Cells(l, 5).Value\nEnd If\nNext m\nNext l\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Are there any optimizations that would make it run faster, or something I haven't included? \nThe first parts all work pretty speedily, its only the copying of the mean values which appears to take time.</p>\n"}, {"tags": ["regex", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1488970683, "post_id": 42669238, "comment_id": 72463456, "body": "Let me know if you need more details."}, {"owner": {"reputation": 83, "user_id": 7592193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e649a8df81406d97f5dfe897800823a?s=128&d=identicon&r=PG&f=1", "display_name": "ahsoe", "link": "https://stackoverflow.com/users/7592193/ahsoe"}, "edited": false, "score": 0, "creation_date": 1488972008, "post_id": 42669238, "comment_id": 72464379, "body": "Hi Wiktor. Thanks for your quick and detailed reply. This is exactly what I need. &quot;12&quot; should for instance return true, so 1 comma is not needed. One thing though: what does ?: mean exactly in the (?:, \\d+)* part?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 83, "user_id": 7592193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e649a8df81406d97f5dfe897800823a?s=128&d=identicon&r=PG&f=1", "display_name": "ahsoe", "link": "https://stackoverflow.com/users/7592193/ahsoe"}, "edited": false, "score": 0, "creation_date": 1488972172, "post_id": 42669238, "comment_id": 72464494, "body": "That is a <a href=\"http://stackoverflow.com/questions/3512471/what-is-a-non-capturing-group-what-does-a-question-mark-followed-by-a-colon\"><i>non-capturing group</i></a> that is only used for grouping subpatterns and does not store the captured value in the memory buffer. Since the group is quantified, and we are not interested in what text is captured, there is no point in using a capturing group here."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1488970128, "creation_date": 1488970128, "answer_id": 42669238, "question_id": 42669141, "link": "https://stackoverflow.com/questions/42669141/access-vba-regex-input-mask-validation-check-if-string-is-comprised-of-repeati/42669238#42669238", "title": "Access VBA Regex: Input mask validation. Check if string is comprised of repeating pattern only", "body": "<p>The <code>\\d+, +</code> and <code>(\\d+, )+</code> patterns are not appropriate since they will find <em>partial</em> matches (<code>\"22, \"</code> in <code>abc 22, end</code>) and the second one - even if you fix the previous issue by adding anchors (<code>^</code> and <code>$</code>), will still require <code>,</code> + a single space at the end of the string.</p>\n\n<p>You need to use</p>\n\n<pre><code>^\\d+(?:, \\d+)*$\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/KqTpxw/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p>If at least 1 comma  is required, replace the <code>*</code> quantifier with <code>+</code> to match 1 or more occurrences of the grouped subpattern.</p>\n\n<p><strong>Details</strong>:</p>\n\n<ul>\n<li><code>^</code> - start of the string</li>\n<li><code>\\d+</code> - 1 or more digits</li>\n<li><code>(?:, \\d+)*</code>- 0+ sequences of\n\n<ul>\n<li><code>,</code> - comma</li>\n<li><code> </code> - space</li>\n<li><code>\\d+</code> - 1 or more digits</li>\n</ul></li>\n<li><code>$</code> - end of string</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 3, "last_activity_date": 1500922132, "last_edit_date": 1500922132, "creation_date": 1488972239, "answer_id": 42670002, "question_id": 42669141, "link": "https://stackoverflow.com/questions/42669141/access-vba-regex-input-mask-validation-check-if-string-is-comprised-of-repeati/42670002#42670002", "title": "Access VBA Regex: Input mask validation. Check if string is comprised of repeating pattern only", "body": "<p>I have simple solution:</p>\n\n<p>1) first, split the whole string:</p>\n\n<pre><code>numberArray = Split(YourSequence, \", \")\n</code></pre>\n\n<p>now, <code>numberArray</code> should contain only integers, if the string was correct,</p>\n\n<p>2) secondly, you iterate through the <code>numberArray</code> in a loop and check if particular element can be converted to a number using <code>IsNumeric</code> function, if any element cannot be converted, then your answer is <code>false</code> and you can exit loop.</p>\n\n<p>The code is easy and doesn't require any regular expressions.</p>\n"}], "owner": {"reputation": 83, "user_id": 7592193, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e649a8df81406d97f5dfe897800823a?s=128&d=identicon&r=PG&f=1", "display_name": "ahsoe", "link": "https://stackoverflow.com/users/7592193/ahsoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 42670002, "answer_count": 2, "score": 2, "last_activity_date": 1594639447, "creation_date": 1488969853, "last_edit_date": 1594639447, "question_id": 42669141, "link": "https://stackoverflow.com/questions/42669141/access-vba-regex-input-mask-validation-check-if-string-is-comprised-of-repeati", "title": "Access VBA Regex: Input mask validation. Check if string is comprised of repeating pattern only", "body": "<p>I am trying to restrict a user from inputting a wrong string in a form field in <code>Access</code>.</p>\n\n<p>I am trying to determine whether a <code>string</code> is of the form \"1, 2, 54, 765, 43222\".\nThe sequence is </p>\n\n<ol>\n<li>a strictly positive integer</li>\n<li>a comma</li>\n<li>a space (\u2423)</li>\n</ol>\n\n<p>and this sequence can be repeated an unknown number of times.</p>\n\n<p>I have tried using the <code>String Like</code> function with <code>\"#, #\"</code> but have hit my head against the wall on how to allow this pattern to possibly repeat.</p>\n\n<p>I am also open to <code>Regex</code> patterns, even though, I have a very limited amount of knowledge and understanding of this. I have tried with a pattern <code>\"\\d+, +\"</code> and <code>\"(\\d+, )+\"</code>, but I am not convinced this is correct.</p>\n\n<p>Another solution could be using <code>substring</code> and searching for single occurrences of the pattern in the first three characters of the supplied string, trimming the string removing the first three characters and repeating this action.</p>\n\n<p>To give you some examples:</p>\n\n<ul>\n<li>\"1, 2, 3, 4\" should return true </li>\n<li>\"1,2, 3, 4\" should return false </li>\n<li>\"a, 3, 65!, 34\" should return false </li>\n<li>\"1, 3, 2, 4, 5442\" should return true</li>\n</ul>\n\n<p>I hope my description is sufficient.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488969636, "post_id": 42669018, "comment_id": 72462735, "body": "can you show your full name of <code>**salary sheets**</code> worksheet ? so we can simulate this error ?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "edited": false, "score": 0, "creation_date": 1488972950, "post_id": 42669060, "comment_id": 72465068, "body": "exactly what i was looking for. Thanks"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1488969632, "creation_date": 1488969632, "answer_id": 42669060, "question_id": 42669018, "link": "https://stackoverflow.com/questions/42669018/naming-a-sheet-with-space-in-a-vlookup-function-vba/42669060#42669060", "title": "Naming a sheet with space in a VLookup function (VBA)", "body": "<p>You'll have to use <code>Sheets</code> to reference the sheet you want :<br> <code>ThisWorkbook.Sheets(\"salary sheets\").Range(...</code></p>\n\n<pre><code>Sub SALEXAMPLE()  \nDim names As String  \nnames = \"Justin Jones\"  \nSal = Application.WorksheetFunction.VLookup(names, ThisWorkbook.Sheets(\"salary sheets\").Range(\"A1:C10\"), 2, False)  \nMsgBox \"Salary is : $ \" &amp; Sal\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4866052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6bcf7654cb0e64557e1076505b77ef?s=128&d=identicon&r=PG&f=1", "display_name": "Moza", "link": "https://stackoverflow.com/users/4866052/moza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 42669060, "answer_count": 1, "score": 1, "last_activity_date": 1488978288, "creation_date": 1488969510, "last_edit_date": 1531161705, "question_id": 42669018, "link": "https://stackoverflow.com/questions/42669018/naming-a-sheet-with-space-in-a-vlookup-function-vba", "title": "Naming a sheet with space in a VLookup function (VBA)", "body": "<p>I am trying to get certain information from a sheet and copying it to a different worksheet and my worksheets have long names (cannot change them for a reason) </p>\n\n<p>I keep coming up with message \"Compile Error: Expected List Separator or )\" and \nI am pretty sure its to do with the sheet name unless I'm wrong?</p>\n\n<p>Code:</p>\n\n<pre><code>Sub SALEXAMPLE()  \nDim names As String  \nnames = \"Justin Jones\"  \nSal = Application.WorksheetFunction.VLookup(names, **salary sheets**.Range(\"A1:C10\"), 2, False)  \nMsgBox \"Salary is : $ \" &amp; Sal\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1488969667, "post_id": 42668999, "comment_id": 72462757, "body": "So basically the answer is &quot;no&quot; there is not possibility to avoid For loops... right?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1488969826, "post_id": 42668999, "comment_id": 72462863, "body": "@Noldor130884 : Yup, basically! ;) At least, none that I know of, but I have stacked quite a few flight hours, so I&#39;m pretty there isn&#39;t except once you&#39;ve made such a custom routine..."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1488969464, "creation_date": 1488969464, "answer_id": 42668999, "question_id": 42668846, "link": "https://stackoverflow.com/questions/42668846/excel-vba-how-to-copy-a-2d-matrix-content-from-a-3d-matrix-with-a-single-comma/42668999#42668999", "title": "Excel VBA - How to copy a 2D matrix content from a 3D matrix with a single command?", "body": "<p>I've made that custom Sub a while ago to display part of a 3D array :</p>\n\n<pre><code>Public Sub Print2D_of_3D_Array(ByVal ArrayT As Variant, _\n                ByVal FixedDim As Integer, _\n                ByVal FixedDimValue As Double, _\n                ByRef Sheet_to_PrintOn As Worksheet, _\n                Optional ByVal DeleteSheet As Boolean = False)\n\n\nIf DeleteSheet Then Set Sheet_to_PrintOn = DeleteAndAddSheet(Sheet_to_PrintOn)\n\nSelect Case FixedDim\n    Case Is = 1\n        For i = LBound(ArrayT, 2) To UBound(ArrayT, 2)\n            For j = LBound(ArrayT, 3) To UBound(ArrayT, 3)\n              Sheet_to_PrintOn.Cells(i + 1, j + 1) = ArrayT(FixedDimValue, i, j)\n            Next j\n        Next i\n    Case Is = 2\n        For i = LBound(ArrayT, 1) To UBound(ArrayT, 1)\n            For j = LBound(ArrayT, 3) To UBound(ArrayT, 3)\n              Sheet_to_PrintOn.Cells(i + 1, j + 1) = ArrayT(i, FixedDimValue, j)\n            Next j\n        Next i\n    Case Is = 3\n        For i = LBound(ArrayT, 1) To UBound(ArrayT, 1)\n            For j = LBound(ArrayT, 2) To UBound(ArrayT, 2)\n              Sheet_to_PrintOn.Cells(i + 1, j + 1) = ArrayT(i, j, FixedDimValue)\n            Next j\n        Next i\n    Case Else\n        MsgBox \"error\"\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>So, you'd have to use it like this :</p>\n\n<pre><code>Call Print2D_of_3D_Array(MyArray, 1, 2, WorksheetVariable, False)\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 42668999, "answer_count": 1, "score": 3, "last_activity_date": 1488969464, "creation_date": 1488969060, "last_edit_date": 1488969330, "question_id": 42668846, "link": "https://stackoverflow.com/questions/42668846/excel-vba-how-to-copy-a-2d-matrix-content-from-a-3d-matrix-with-a-single-comma", "title": "Excel VBA - How to copy a 2D matrix content from a 3D matrix with a single command?", "body": "<p>I have a 3D matrix, which contains something I would like to write in a range of cells using the command:</p>\n\n<pre><code>Worksheet.Range(Worksheet.Cells(RowStart, ColumnStart), Worksheet.Cells(RowEnd, ColumnEnd)).Value = MyData\n</code></pre>\n\n<p>The problem is that <code>MyData</code>'s data is actually described by index = 2 of the first dimension of a 3D matrix.</p>\n\n<p>Since I don't see the possibility to use <code>Application.WorksheetFunction.Index</code> here, I would like to copy the content of the whole specific index of the 3D matrix inside a 2D one.</p>\n\n<p>Is this possible without having to resort to a <code>For</code> loop (or writing a subroutine that does it)?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979203, "post_id": 42668749, "comment_id": 72469540, "body": "How can adapt the code so it works with cells with formulas, which give text results"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979275, "post_id": 42668749, "comment_id": 72469593, "body": "@tombata change the last part <code>SpecialCells(xlCellTypeFormulas)</code>"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979421, "post_id": 42668749, "comment_id": 72469681, "body": "I tried this, it copies the range, but it keeps the blank cells"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979511, "post_id": 42668749, "comment_id": 72469737, "body": "@tombata if the cell has a formula, and the result is <code>&quot;&quot;</code> it will stil copy it"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979648, "post_id": 42668749, "comment_id": 72469834, "body": "Yes, this is the case. How can I work around this problem?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1488979778, "post_id": 42668749, "comment_id": 72469934, "body": "@tombata sounds like a new SO question, i think you should post this new question, add you latest working code, this will allow other users to answer your post as well (besides me)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1488968801, "creation_date": 1488968801, "answer_id": 42668749, "question_id": 42668530, "link": "https://stackoverflow.com/questions/42668530/vba-skip-blank-does-not-work/42668749#42668749", "title": "VBA Skip blank does not work", "body": "<p>Sadly, skip blanks doesn't do what you think it does, you can read here what it does <a href=\"http://chandoo.org/wp/2009/03/19/skp-blank-cells/\" rel=\"nofollow noreferrer\">Chandoo</a></p>\n\n<p>Try the code below instead:</p>\n\n<pre><code>Dim VisRng As Range\n\nWith Worksheets(\"Calculator\")\n    Set VisRng = .Range(\"H10:H61\").SpecialCells(xlCellTypeConstants)\n    VisRng.Copy\n    Worksheets(\"Graphs\").Range(\"D2\").PasteSpecial xlValues\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2066, "favorite_count": 0, "accepted_answer_id": 42668749, "answer_count": 1, "score": 2, "last_activity_date": 1488968801, "creation_date": 1488968230, "question_id": 42668530, "link": "https://stackoverflow.com/questions/42668530/vba-skip-blank-does-not-work", "title": "VBA Skip blank does not work", "body": "<p>I have this code in excel, which copies a range and pastes it. However it does not skip blanks, how it is supposed to do.</p>\n\n<pre><code>With Worksheets(\"Calculator\")\n    .Range(\"H10:H61\").Copy\n    Worksheets(\"Graphs\").Range(\"D2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n    SkipBlanks:=True, Transpose:=False\nEnd With\n</code></pre>\n\n<p>The range <code>H10:H61</code> contains only values, no fromulas.</p>\n"}, {"tags": ["excel", "named-ranges", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489470881, "post_id": 42671758, "comment_id": 72671720, "body": "@Tal Kuce have you tried my code above ? if it&#39;s working for you mark as &quot;ANSWER&quot; , this is how we do thing here on SO. People ask questions, and once they get answers, they credit by marking as &quot;ANSWER&quot;"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1488977730, "last_edit_date": 1488977730, "creation_date": 1488977108, "answer_id": 42671758, "question_id": 42668202, "link": "https://stackoverflow.com/questions/42668202/trying-to-delete-hidden-names-by-selection-excel-macro/42671758#42671758", "title": "trying to delete hidden names by selection excel macro", "body": "<p>Try the code below, it will loop thorugh all rows in Column A, check if column C is empty, and will delete that <code>Name</code> from your workbook.</p>\n\n<p><em>Note</em>: I've commented 5 lines from your original code, since according to your post you don't care if the <code>Names</code> are <code>Visible</code> or not, you want to delete them based on the value in Column C.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub DelNames()\n\nDim xName           As Name\nDim Indx            As Long\nDim Vis             As Variant\nDim LastRow         As Long\n\nWith Worksheets(\"LOG\")\n    If IsEmpty(.Range(\"A2\").Value) Then Exit Sub\n\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row '&lt;-- get last row in column A (where you have a NamedRange)\n    For Indx = 2 To LastRow\n        If .Range(\"C\" &amp; Indx).Value = \"\" Then\n            ' set xName with the text entered in column A (as the Named Range Name)\n            Set xName = ThisWorkbook.Names(.Range(\"A\" &amp; Indx).Value)\n\n            ' not sure you need the 5 lines with the If criteria below so I Commented them for now\n            'If xName.Visible = True Then\n            '    Vis = \"Visible\"\n            'Else\n            '    Vis = \"Hidden\"\n            'End If\n            xName.Delete\n        End If\n    Next Indx\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6770519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190e425e18c6691c53435163bfca176b?s=128&d=identicon&r=PG&f=1", "display_name": "Tal Kuce", "link": "https://stackoverflow.com/users/6770519/tal-kuce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1710, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488977730, "creation_date": 1488967298, "last_edit_date": 1531161705, "question_id": 42668202, "link": "https://stackoverflow.com/questions/42668202/trying-to-delete-hidden-names-by-selection-excel-macro", "title": "trying to delete hidden names by selection excel macro", "body": "<p>I'm trying to delete hidden <code>Names</code> but with a rule that I choose what hidden <code>Name</code> to delete and what not.</p>\n\n<p>Using the code from Microsoft support I managed to make a list of the names\non a log sheet and added a column that when I enter <code>1</code> next to it I want to not delete the name, and when I leave it blank U want it to remove the name.</p>\n\n<ul>\n<li>code from Microsoft support (<a href=\"https://support.microsoft.com/en-us/help/119826/macro-to-remove-hidden-names-in-active-workbook\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/119826/macro-to-remove-hidden-names-in-active-workbook</a>)</li>\n</ul>\n\n<p>here is my code:</p>\n\n<pre><code>Sub clean_names()\n\nApplication.ScreenUpdating = False\nOn Error Resume Next\n\nSet nms = ActiveWorkbook.Names\nMsgBox (nms.Count)\n\nFor R = 1 To nms.Count\n    Name_Name = nms(R).Name\n    Name_Referance = nms(R).RefersTo\n    '###########ActiveWorkbook.Names(Name_Name).Delete\n    'ActiveWorkbook.nms(R).Delete\n    Sheets(\"LOG\").Cells(R + 1, 1).Value = Name_Name\n    Sheets(\"LOG\").Cells(R + 1, 2).Value = \"'\" + Name_Referance\n    'Application.StatusBar = R\nNext R\n'Application.StatusBar = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n'================================================================\n\nSub DelNames()\n\nDim xName As Variant\nDim Indx As Integer\nDim Vis As Variant\n\nCells(2, 1).Select\nIf (ActiveCell = \"\") Then Exit Sub\nIndx = 1\n\nDo\n    If (ActiveCell.Offset(Indx, 2) = \"\") Then\n\n        xName = ActiveCell.Offset(Indx, 0).Value\n        If xName.Visible = True Then\n            Vis = \"Visible\"\n        Else\n            Vis = \"Hidden\"\n        End If\n        xName.Delete\n    End If\n    Indx = Indx + 1\nLoop While Len(ActiveCell.Offset(Indx, 0))\n\nEnd Sub\n</code></pre>\n\n<p>How can i make this code work ?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1488967120, "post_id": 42668120, "comment_id": 72461065, "body": "Where is your code attempt ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488967171, "post_id": 42668120, "comment_id": 72461099, "body": "Damn you&#39;re fast! @ShaiRado"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488967234, "post_id": 42668120, "comment_id": 72461138, "body": "Alexandru, please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and see <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>! ;)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488967485, "post_id": 42668120, "comment_id": 72461298, "body": "Few similar posts here : <a href=\"http://stackoverflow.com/questions/42599995/error-on-pivot-cache-syntax/42604818#42604818\" title=\"error on pivot cache syntax\">stackoverflow.com/questions/42599995/&hellip;</a> , and <a href=\"http://stackoverflow.com/questions/42144495/vba-pivot-table-range-change/42144940#42144940\" title=\"vba pivot table range change\">stackoverflow.com/questions/42144495/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 7677445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aCLPn0RfxX4/AAAAAAAAAAI/AAAAAAAAAB4/rce5TDwn2U4/photo.jpg?sz=128", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/7677445/alexandru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488967047, "creation_date": 1488967047, "question_id": 42668120, "link": "https://stackoverflow.com/questions/42668120/vba-create-pivot-table-from-dinamic-source", "title": "VBA create Pivot Table from dinamic source", "body": "<p>I saw similar questions being asked. But I could not find what I need.</p>\n\n<p>I have a sheet, the name of the file and the sheet is variable.</p>\n\n<p>In that sheet there is a table starting from cell A1, the number of columns and rows varies, it is never the same.</p>\n\n<p>I need a macro that creates a PivotTable from this sheet into a brand new sheet with a predefined name, taking into consideration that the number of rows and columns is varying.\nThe pivot sheet must be created, it can't be in existence prior to creating the pivot</p>\n\n<p>Thank You in advance for any help provided. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1489043062, "post_id": 42667821, "comment_id": 72500456, "body": "Please provide a full working minimal example that produces the error. We can not do much with one line of code. I don&#39;t get any messages if the string is not found with the line above! Everything looks fine."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1488966827, "creation_date": 1488966827, "answer_id": 42668042, "question_id": 42667821, "link": "https://stackoverflow.com/questions/42667821/how-to-ignore-message-window-when-range-replace-method-not-found/42668042#42668042", "title": "How to ignore message window when range.replace method not found?", "body": "<p>You can use <code>Application.DisplayAlerts = False</code> to prevent Excel showing any alerts.</p>\n\n<p>Don't forget to turn it on afterwards with <code>Application.DisplayAlerts = True</code>.</p>\n"}], "owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 0, "accepted_answer_id": 42668042, "answer_count": 1, "score": 0, "last_activity_date": 1488966827, "creation_date": 1488966198, "last_edit_date": 1531164843, "question_id": 42667821, "link": "https://stackoverflow.com/questions/42667821/how-to-ignore-message-window-when-range-replace-method-not-found", "title": "How to ignore message window when range.replace method not found?", "body": "<p>I'm using vba to write a batch replace script.\nBut the warnning message window always pop up everytime the search string not found,it makes me have to close it again and again.Is it possible to hide this window?</p>\n\n<pre><code>targetRng.Replace s, s.Offset(0, 1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/T0nrw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T0nrw.png\" alt=\"enter image description here\"></a></p>\n\n<p>this pic mainly says search string not found,xxxxxxxxx</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "is_accepted": true, "score": 1, "last_activity_date": 1489147544, "creation_date": 1489147544, "answer_id": 42718042, "question_id": 42667763, "link": "https://stackoverflow.com/questions/42667763/column-header-for-different-sheet/42718042#42718042", "title": "Column header for different sheet", "body": "<p>The two key lines you need are along the lines of:</p>\n\n<pre><code>MaxVal = application.max(sheet8.range(sheet8.cells(j,2),sheet8.cells(j,z)))\nsheet1.cells(i,13) = sheet8.cells(1,application.match(MaxVal,sheet8.rows(j)))\n</code></pre>\n\n<p>The first line finds the maximum value in the row. The second line returns the column header (presumably in row 1 as you're searching from row 2).</p>\n"}], "owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 42718042, "answer_count": 1, "score": -1, "last_activity_date": 1489147544, "creation_date": 1488966048, "last_edit_date": 1488966989, "question_id": 42667763, "link": "https://stackoverflow.com/questions/42667763/column-header-for-different-sheet", "title": "Column header for different sheet", "body": "<p>I have many rows having data in sheet 2 and I want the column name of the max of a row (i.e. from column name of B2 to AH2 inside if loop).</p>\n\n<pre><code>Sub shanaya()\n    Dim j As Integer\n    Dim i As Integer\n    Dim z As Integer\n    Dim x As Integer\n    z = 35\n    For i = 11 To 28\n        For j = 2 To 19\n            If Sheet8.Cells(j, 1) = Sheet1.Cells(i, 1) Then\n                Sheet1.Cells(i, 10) = Sheet8.Cells(j, z)\n                Max [(Sheet8.Cells(J,2)): (Sheet8.Cells(j,z))]\n                Sheet1.Cells(i,13) = column header of max function\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1488965640, "post_id": 42667520, "comment_id": 72460039, "body": "The easiest way (without VBA) would be grouping all march columns and then using the [1] and [2] buttons of the <a href=\"https://support.office.com/en-us/article/Outline-group-data-in-a-worksheet-08CE98C4-0063-4D42-8AC7-8278C49E9AFF\" rel=\"nofollow noreferrer\">grouping feature</a> to toggle visability."}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1488965665, "post_id": 42667520, "comment_id": 72460058, "body": "Should this button toggle only March visibility? Have you written any code yet?"}, {"owner": {"reputation": 5, "user_id": 7677251, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b586ae52a22419918d20d517eff834a2?s=128&d=identicon&r=PG&f=1", "display_name": "SANDY", "link": "https://stackoverflow.com/users/7677251/sandy"}, "edited": false, "score": 0, "creation_date": 1488966881, "post_id": 42667520, "comment_id": 72460909, "body": "Not Yet, because im just a beginner in VBA programing.. i think toggle grouping feature works only for rows??? i didn&#39;t try yet... =).."}, {"owner": {"reputation": 5, "user_id": 7677251, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b586ae52a22419918d20d517eff834a2?s=128&d=identicon&r=PG&f=1", "display_name": "SANDY", "link": "https://stackoverflow.com/users/7677251/sandy"}, "edited": false, "score": 0, "creation_date": 1488967107, "post_id": 42667520, "comment_id": 72461052, "body": "sorry what i mean for the button is a command click in VBA excel.. if  i input March in Input box then clicked unhide.. all date march 2010, 2011,2012... will unhide else all non March column will hide.. Hope this will help"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1488970939, "post_id": 42669047, "comment_id": 72463658, "body": "Or both procedures as single line:  <code>Columns(&quot;A:BZ&quot;).EntireColumn.Hidden = Not Columns(&quot;A:BZ&quot;).EntireColumn.Hidden</code>"}, {"owner": {"reputation": 5, "user_id": 7677251, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b586ae52a22419918d20d517eff834a2?s=128&d=identicon&r=PG&f=1", "display_name": "SANDY", "link": "https://stackoverflow.com/users/7677251/sandy"}, "edited": false, "score": 0, "creation_date": 1489022003, "post_id": 42669047, "comment_id": 72493737, "body": "Thank you for sharing.. I need a little help for my codes. this turns ou that if cell.entirecolumn.Hidden = cell.value = Range(&quot;I1&quot;)  is True then column with cell value In a range will hide.. Supposed that i have column  with headers A to Z how to make this in a sense that if range (&quot;A1&quot;) contains A then All columns with A will unhide and all columns that is not will hide... here is my code"}, {"owner": {"reputation": 5, "user_id": 7677251, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b586ae52a22419918d20d517eff834a2?s=128&d=identicon&r=PG&f=1", "display_name": "SANDY", "link": "https://stackoverflow.com/users/7677251/sandy"}, "edited": false, "score": 0, "creation_date": 1489022008, "post_id": 42669047, "comment_id": 72493740, "body": "Sub Hide_Columns()     Dim cell As Range     Application.ScreenUpdating = False     For Each cell In Intersect(ActiveSheet.UsedRange, Range(&quot;A1:F1&quot;))         cell.EntireColumn.Hidden = cell.Value = Range(&quot;I1&quot;) And Not IsEmpty(cell)     Next cell     Application.ScreenUpdating = True End Sub  Sub Show_All_Columns()     Columns.Hidden = False End Sub"}], "tags": [], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "is_accepted": true, "score": 1, "last_activity_date": 1488969600, "creation_date": 1488969600, "answer_id": 42669047, "question_id": 42667520, "link": "https://stackoverflow.com/questions/42667520/hide-selected-columns-using-vba/42669047#42669047", "title": "Hide Selected Columns using VBA", "body": "<p>You should try to use Google before ask here.\nI think that you could start with this:</p>\n\n<pre><code>Sub HideCols()\n    Columns(\"A:BZ\").Select\n    Selection.EntireColumn.Hidden = True ''Hide\nEnd Sub\n\nSub ShowCols()\n    Columns(\"A:BZ\").Select\n    Selection.EntireColumn.Hidden = False ''Unhide\nEnd Sub\n</code></pre>\n\n<p>and then parametrize the <code>Columns(\"A:BZ\").Select</code> with some if statements. Finally add a button that call the two Subs.</p>\n"}], "owner": {"reputation": 5, "user_id": 7677251, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b586ae52a22419918d20d517eff834a2?s=128&d=identicon&r=PG&f=1", "display_name": "SANDY", "link": "https://stackoverflow.com/users/7677251/sandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3612, "favorite_count": 0, "accepted_answer_id": 42669047, "answer_count": 1, "score": -2, "last_activity_date": 1580108019, "creation_date": 1488965369, "last_edit_date": 1580108019, "question_id": 42667520, "link": "https://stackoverflow.com/questions/42667520/hide-selected-columns-using-vba", "title": "Hide Selected Columns using VBA", "body": "<p>I have this data<br>\n<a href=\"https://i.stack.imgur.com/JipIu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JipIu.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to make a button for Hide and a button for Unhide.</p>\n\n<p>Suppose each column is labeled with Date from January 2010 to January 2016.<br>\nI want to unhide all columns with Date March and automatically hide all non March columns.</p>\n\n<p>It turns out if cell.entirecolumn.Hidden = cell.value = Range(\"I1\") is True then column with cell value in a range will hide.</p>\n\n<p>Suppose I have a column with headers A to Z how to make this in a sense that if range (\"A1\") contains A then all columns with A will unhide and all columns that do not will hide.</p>\n\n<pre><code>Sub Hide_Columns()\n    Dim cell As Range\n    Application.ScreenUpdating = False\n    For Each cell In Intersect(ActiveSheet.UsedRange, Range(\"A1:F1\"))\n        cell.EntireColumn.Hidden = cell.Value = Range(\"I1\") And Not IsEmpty(cell)\n    Next cell\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub Show_All_Columns()\n    Columns.Hidden = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 7107097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a2ab24dc07ff2eaddeff5f7243779c5?s=128&d=identicon&r=PG&f=1", "display_name": "WSC", "link": "https://stackoverflow.com/users/7107097/wsc"}, "edited": false, "score": 1, "creation_date": 1488968238, "post_id": 42667882, "comment_id": 72461810, "body": "Thanks for this Robin. Sounds like using a Dictionary is the way to go. I&#39;ve never used this before, so might have to do a bit of research to apply it, but it&#39;s a good starting point."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1488966370, "creation_date": 1488966370, "answer_id": 42667882, "question_id": 42667327, "link": "https://stackoverflow.com/questions/42667327/send-single-email-to-recipients-with-multiple-messages/42667882#42667882", "title": "Send single email to recipients with multiple messages", "body": "<p>Use a <code>Dictionary</code> - one method would to:</p>\n\n<ul>\n<li>iterate recipient column</li>\n<li>for a new recipient add the key and value</li>\n<li>for an existing recipient append the value to the existing list</li>\n</ul>\n\n<p>For the e-mailing part:</p>\n\n<ul>\n<li>iterate the dictionary</li>\n<li>send a single mail per recipient with the list of ids</li>\n</ul>\n\n<p>Code sample:</p>\n\n<pre><code>Option Explicit\n\nSub GetInfo()\n\n    Dim ws As Worksheet\n    Dim rngData As Range\n    Dim rngCell As Range\n    Dim dic As Object\n    Dim varKey As Variant\n\n    'source data\n    Set ws = ThisWorkbook.Worksheets(\"Sheet3\")\n    Set rngData = ws.Range(\"A1:B5\") '&lt;~~~ adjust for your range\n\n    'create dictionary\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n\n    'iterate recipient column in range\n    For Each rngCell In rngData.Columns(2).Cells\n        If dic.Exists(rngCell.Value) Then\n            dic(rngCell.Value) = dic(rngCell.Value) &amp; \",\" &amp; rngCell.Offset(0, -1).Value\n        Else\n            dic.Add rngCell.Value, CStr(rngCell.Offset(0, -1).Value)\n        End If\n    Next rngCell\n\n    'check dictionary values &lt;~~~ you could do the e-mailing here...\n    For Each varKey In dic.Keys\n        Debug.Print dic(CStr(varKey))\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Output with your sample data:</p>\n\n<pre><code>RecipientA : 1,3,5\nRecipientB : 2\nRecipientC : 4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 720, "user_id": 7107097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a2ab24dc07ff2eaddeff5f7243779c5?s=128&d=identicon&r=PG&f=1", "display_name": "WSC", "link": "https://stackoverflow.com/users/7107097/wsc"}, "edited": false, "score": 0, "creation_date": 1488968271, "post_id": 42667924, "comment_id": 72461837, "body": "Thank you for this. Think using a Dictionary is the way to go."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1488966482, "creation_date": 1488966482, "answer_id": 42667924, "question_id": 42667327, "link": "https://stackoverflow.com/questions/42667327/send-single-email-to-recipients-with-multiple-messages/42667924#42667924", "title": "Send single email to recipients with multiple messages", "body": "<p>You could use a Dictionary like this :</p>\n\n<pre><code>Sub test_WillC()\nDim DicT As Object\n'''Create a dictionary\nSet DicT = CreateObject(\"Scripting.Dictionary\")\n\nDim LastRow As Double\nDim i As Double\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        '''Syntax : DicT.Exists(Key)\n        If DicT.Exists(.Cells(i, 2)) Then\n            '''If the key (mail) exists, add the value\n            DicT(.Cells(i, 2)) = DicT(.Cells(i, 2)) &amp; \"/\" &amp; .Cells(i, 1)\n        Else\n            '''If the key doesn't exist create a new entry\n            '''Syntax : DicT.Add Key, Value\n            DicT.Add .Cells(i, 2), .Cells(i, 1)\n        End If\n    Next i\nEnd With 'ThisWorkbook.Sheets(\"Sheet1\")\n\n'''Loop on your dictionary to send your mails\nFor i = 0 To DicT.Count - 1\n    YourSubNameToSendMails DicT.Keys(i), DicT.Items(i)\nNext i\n\nSet DicT = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 720, "user_id": 7107097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a2ab24dc07ff2eaddeff5f7243779c5?s=128&d=identicon&r=PG&f=1", "display_name": "WSC", "link": "https://stackoverflow.com/users/7107097/wsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 1, "accepted_answer_id": 42667882, "answer_count": 2, "score": 1, "last_activity_date": 1593414090, "creation_date": 1488964789, "last_edit_date": 1593414090, "question_id": 42667327, "link": "https://stackoverflow.com/questions/42667327/send-single-email-to-recipients-with-multiple-messages", "title": "Send single email to recipients with multiple messages", "body": "<p>I have a macro I wrote where users put a list of numbers into column 1, and they press a button and a form opens which lets them select a variety of parameters for the outlook email, including who the email should be sent to. It then sends this list of numbers in the email.</p>\n\n<p>I want to change the macro so the user puts the list of numbers in column 1, and in column 2 they put the recipients. Then a single email is sent to each recipient with the corresponding numbers.</p>\n\n<p>It would be easy to create a new email for each number in the column, but there might be multiple emails going to the same recipient, which would not be well received. It would also be very inefficient.</p>\n\n<p>I want to have my macro group up the numbers who are going to the same person, then send one email per different recipient.</p>\n\n<p>Example data:</p>\n\n<pre><code>1      RecipientA\n2      RecipientB\n3      RecipientA\n4      RecipientC\n5      RecipientA\n</code></pre>\n\n<p>I want to send an email to recipient A with 1/3/5, B with 2, C with 4.</p>\n\n<p>I don't necessarily need help with the actual code, I just can't think of a way to do this.</p>\n\n<p>Can anyone suggestion a solution?</p>\n"}, {"tags": ["vba", "excel", "login", "excel-web-query"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488965433, "post_id": 42667162, "comment_id": 72459928, "body": "Depending on how ofte you would have to log in / run the macro you could as a first step check if you are logged in. If not manually do so, and then run the rest of the macro."}, {"owner": {"reputation": 11, "user_id": 7380230, "user_type": "registered", "profile_image": "https://graph.facebook.com/1310955565638418/picture?type=large", "display_name": "Ryan Carter", "link": "https://stackoverflow.com/users/7380230/ryan-carter"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488966609, "post_id": 42667162, "comment_id": 72460691, "body": "@Luuklag the system will always log me out and does not save user&#39;s logins, just the way the website was set up."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488973253, "post_id": 42667162, "comment_id": 72465310, "body": "I once had something similar. I had the code open the website, the log in manually, and run the rest of the code. As long as the code was running it stayed logged in. Something like this could work if you only have to run your code ocasionally."}, {"owner": {"reputation": 11, "user_id": 7380230, "user_type": "registered", "profile_image": "https://graph.facebook.com/1310955565638418/picture?type=large", "display_name": "Ryan Carter", "link": "https://stackoverflow.com/users/7380230/ryan-carter"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488975400, "post_id": 42667162, "comment_id": 72466855, "body": "@Luuklag thats exactly what i want, all it does is pull a user list from the website for the purpose of running KPI reports"}], "answers": [{"tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": false, "score": 1, "last_activity_date": 1488976386, "creation_date": 1488976386, "answer_id": 42671514, "question_id": 42667162, "link": "https://stackoverflow.com/questions/42667162/vba-web-query-with-loginpassword/42671514#42671514", "title": "VBA Web query with login+password", "body": "<p>I used the following in something similar:</p>\n\n<pre><code>Set ie = GetIE(\"www.url.com\")\n If Not ie is Nothing Then\n\n  ie.navigate (strtarget) 'strtarget is the target url\n  Do Until ie.ReadyState = 4: DoEvents: Loop\n    If ie.LocationURL = \"www.url.com/loginpage\" Then\n     MsgBox \"Login Please!!\"\n    Else \n     pageText = ie.document.body.innertext\n    End if\n  Else\n   MsgBox \"IE not found!!\"\n  End if\n</code></pre>\n\n<p>It will display a messagebox which asks you to sign in if you land on the loginpage. Then you manually log in and start the script again.</p>\n"}], "owner": {"reputation": 11, "user_id": 7380230, "user_type": "registered", "profile_image": "https://graph.facebook.com/1310955565638418/picture?type=large", "display_name": "Ryan Carter", "link": "https://stackoverflow.com/users/7380230/ryan-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2527, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488976386, "creation_date": 1488964300, "last_edit_date": 1488966670, "question_id": 42667162, "link": "https://stackoverflow.com/questions/42667162/vba-web-query-with-loginpassword", "title": "VBA Web query with login+password", "body": "<p>Morning guys,</p>\n\n<p>Using already answered questions on here i am still unable to get any code to work for my particular site, unfortunately as it is an internal website i cannot share the actual site.</p>\n\n<p>The site is a .jsp login page could this be causing the issue? The macro opens the login page in IE but doesn't enter any user data into the fields or submit currently.</p>\n\n<p>I also get error message \"the object invoked has disconnected from it's clients\" once the macro is running.</p>\n\n<p>Microsoft internet controls is active and\nForms 2.0 is active in references also</p>\n\n<p>I am fairly new to VBA to if i am missing anything obvious please let me know, i have lowered security settings within IE also.</p>\n\n<p><strong>EDIT</strong> I am somewhat sure this is to do with my form ID's but i can't see where i went wrong?</p>\n\n<pre><code>Sub GetTable()\n\n\n    Dim ieApp As InternetExplorer\n    Dim ieDoc As Object\n    Dim ieTable As Object\n    Dim clip As DataObject\n\n\n    'create a new instance of ie\n    Set ieApp = New InternetExplorer\n\n\n    'you don\u2019t need this, but it\u2019s good for debugging\n    ieApp.Visible = True\n\n\n    'assume we\u2019re not logged in and just go directly to the login page\n    ieApp.Navigate \"http://dss-gp-mida-002/MidasDS/login.jsp\n    Do While ieApp.Busy: DoEvents: Loop\n    Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n\n    Set ieDoc = ieApp.Document\n\n\n    'fill in the login form \u2013 View Source from your browser to get the control names\n    With ieDoc.forms(0)\n    .Username.Value = \"Carterr\"\n    .Password.Value = \"password\"\n    .submit\n    End With\n    Do While ieApp.Busy: DoEvents: Loop\n    Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n\n    'now that we\u2019re in, go to the page we want\n    ieApp.Navigate \"http://dss-gp-mida-002/MidasDS/homepage.jsp\"\n    Do While ieApp.Busy: DoEvents: Loop\n    Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n\n    'get the table based on the table\u2019s id\n    Set ieDoc = ieApp.Document\n    Set ieTable = ieDoc.all.Item(\"sampletable\")\n\n\n    'copy the tables html to the clipboard and paste to teh sheet\n    If Not ieTable Is Nothing Then\n    Set clip = New DataObject\n    clip.SetText \"\" &amp; ieTable.outerHTML &amp; \"\"\n    clip.PutInClipboard\n    Sheet1.Select\n    Sheet1.Range(\"A1\").Select\n    Sheet1.PasteSpecial \"Unicode Text\"\n    End If\n\n\n    'close 'er up\n    ieApp.Quit\n    Set ieApp = Nothing\n\n\n    End Sub\n</code></pre>\n\n<p>Page Source:</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"urlwanted\" value=\"\"&gt;&lt;input type=\"hidden\" name=\"sourcePageURL\" value=\"\"&gt;&lt;input type=\"hidden\" name=\"ssoiid\" value=\"\"&gt;\n&lt;div&gt;\n&lt;div class=\"form-group\"&gt;\n&lt;label for=\"username\"&gt;Username&lt;/label&gt;&lt;input name=\"username\" id=\"username\" type=\"text\" class=\"form-control\" placeholder=\"Enter Username\"&gt;\n&lt;/div&gt;\n&lt;div class=\"form-group\"&gt;\n&lt;label for=\"password\"&gt;Password&lt;/label&gt;&lt;input name=\"password\" id=\"password\" type=\"password\" class=\"form-control\" placeholder=\"Enter Password\"&gt;\n&lt;/div&gt;\n&lt;script&gt;\n                    $(\"#username\").keyup(function(event) {\n                        if (event.which == 13) {\n                              $(\"#loginform\").submit();\n                         }\n                    });\n                    $(\"#password\").keyup(function(event) {\n                        if (event.which == 13) {\n                              $(\"#loginform\").submit();\n                         }\n                    });\n                &lt;/script&gt;\n&lt;div class=\"form-group\"&gt;\n&lt;div class=\"btn-group-vertical-justified\"&gt;\n&lt;button name=\"login\" type=\"button\" value=\"Log In\" class=\"btn btn-primary\" onclick=\"document.loginform.ssoiid.value=&amp;quot;&amp;quot;;document.loginform.submit()\"&gt;Log In&lt;/button&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform", "frames"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "edited": false, "score": 0, "creation_date": 1488963283, "post_id": 42666587, "comment_id": 72458618, "body": "I want to know how I am supposed to link the first frame with the second and third frames. I know about vba editor."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1488965093, "post_id": 42666587, "comment_id": 72459693, "body": "edited with an example, I am sorry I though it was clear that you can cross edit your fields. And sorry I cannot comment because I donnot have the reputation. It is not nice to downvote: I am ready to delete the answer if somebody point that is in the wrong."}, {"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "edited": false, "score": 0, "creation_date": 1488966038, "post_id": 42666587, "comment_id": 72460314, "body": "I haven&#39;t downvoted you though. And i&#39;m not using combobox just a label to display passout year and qualification."}], "tags": [], "owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "is_accepted": false, "score": -1, "last_activity_date": 1488964730, "last_edit_date": 1488964730, "creation_date": 1488962405, "answer_id": 42666587, "question_id": 42666160, "link": "https://stackoverflow.com/questions/42666160/how-to-link-frames-dynamically-in-excel-userforms/42666587#42666587", "title": "How to link frames dynamically in excel userforms?", "body": "<p>Double clic on the form in the userform, this open the userform module in the VBA editor,\nHere you can edit what happens when you clic on any of the entry.</p>\n\n<p>For instance, you will get:</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n\nEnd Sub\n</code></pre>\n\n<p>you can fill it with:</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n    ComboBox1.Clear\n    With ComboBox1\n         .AddItem \"A\"\n         .AddItem \"B\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488964730, "creation_date": 1488960932, "last_edit_date": 1488962592, "question_id": 42666160, "link": "https://stackoverflow.com/questions/42666160/how-to-link-frames-dynamically-in-excel-userforms", "title": "How to link frames dynamically in excel userforms?", "body": "<p>I am working on an excel 2013 userform which contains 3 different frames in a single userform . The first frame contains usernames, second frame contains qualification and the third contains year of passout.</p>\n\n<p>Now my first frame contains radio buttons to select the user. When the user is selected I want the other two frames to automatically display the associated qualification and passout. So that when a different user is selected I get a qualification and passout of that user. </p>\n\n<p>This is the Userform I am working on. </p>\n\n<p><img src=\"https://i.stack.imgur.com/nK0US.jpg\" alt=\"Userform\"></p>\n\n<p>Can anyone suggest a way to proceed forward?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 3, "creation_date": 1488961676, "post_id": 42666090, "comment_id": 72457747, "body": "What are you struggling with? You did not ask a question. This is not a free code writing service. We&#39;re happy to help you with your own effort, if you post what you have so far."}, {"owner": {"reputation": 13, "user_id": 7662537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb479a05560b937f950560d318e036e1?s=128&d=identicon&r=PG&f=1", "display_name": "efe can tercan", "link": "https://stackoverflow.com/users/7662537/efe-can-tercan"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1488962766, "post_id": 42666090, "comment_id": 72458295, "body": "Is the last edit ok for you to consider that I gave an effort on it? I just didn&#39;t write the code to not confuse others and to be simple."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488962881, "post_id": 42666090, "comment_id": 72458360, "body": "Have you tried recording a macro while performing the required actions manually?  It will give you lots of code that you can edit to get rid of the superfluous lines and hopefully end up with something useful."}, {"owner": {"reputation": 13, "user_id": 7662537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb479a05560b937f950560d318e036e1?s=128&d=identicon&r=PG&f=1", "display_name": "efe can tercan", "link": "https://stackoverflow.com/users/7662537/efe-can-tercan"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488963125, "post_id": 42666090, "comment_id": 72458498, "body": "@MarkFitzgerald yes I tried to do thet in the first place but I could not do the first copying thing, because the lenght of the file will change everyday. I did not know how to set that dynamic range manually. I just did not try shift+end process. I just realized that let me just try that. thank you"}, {"owner": {"reputation": 13, "user_id": 7662537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb479a05560b937f950560d318e036e1?s=128&d=identicon&r=PG&f=1", "display_name": "efe can tercan", "link": "https://stackoverflow.com/users/7662537/efe-can-tercan"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488964052, "post_id": 42666090, "comment_id": 72459049, "body": "@MarkFitzgerald Thank you Mr. Fitzgerald, That worked now."}, {"owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "edited": false, "score": 0, "creation_date": 1488964211, "post_id": 42666090, "comment_id": 72459132, "body": "@efecantercan If my code work Accept the answer"}, {"owner": {"reputation": 13, "user_id": 7662537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb479a05560b937f950560d318e036e1?s=128&d=identicon&r=PG&f=1", "display_name": "efe can tercan", "link": "https://stackoverflow.com/users/7662537/efe-can-tercan"}, "reply_to_user": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "edited": false, "score": 0, "creation_date": 1488965238, "post_id": 42666090, "comment_id": 72459784, "body": "@Marius That absulateley worked for me. It is doing the same with my manual recorded code but more seems like robust and smooth . Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "is_accepted": true, "score": 0, "last_activity_date": 1488963633, "creation_date": 1488963633, "answer_id": 42666949, "question_id": 42666090, "link": "https://stackoverflow.com/questions/42666090/defining-dynamic-range/42666949#42666949", "title": "Defining dynamic range", "body": "<p>Try this:</p>\n\n<pre><code>Dim ws_ca As Worksheet\nDim ws_17 As Worksheet\nDim nr_2017 As Long\nDim nr_ca As Long\n\nSet ws_ca = ThisWorkbook.Worksheets(\"C.A.\")\nSet ws_17 = ThisWorkbook.Worksheets(\"2017\")\n\nnr_ca = ws_ca.Cells(Rows.Count, 8).End(xlUp).Row\nnr_2017 = ws_17.Cells(Rows.Count, 2).End(xlUp).Row\n\nws_17.Range(\"B\" &amp; nr_2017 + 3 &amp; \":H\" &amp; nr_2017 + nr_ca).Value = ws_ca.Range(\"B3:H\" &amp; nr_ca).Value\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7662537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb479a05560b937f950560d318e036e1?s=128&d=identicon&r=PG&f=1", "display_name": "efe can tercan", "link": "https://stackoverflow.com/users/7662537/efe-can-tercan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 42666949, "answer_count": 1, "score": -1, "last_activity_date": 1488963633, "creation_date": 1488960642, "last_edit_date": 1488962665, "question_id": 42666090, "link": "https://stackoverflow.com/questions/42666090/defining-dynamic-range", "title": "Defining dynamic range", "body": "<p>1) I have a sheet named <code>C.A.</code><br>\nI want to copy the range starting from <code>B$3</code> to the last cell (which is of column <code>H</code>)</p>\n\n<p>2) Then paste it to another sheet called <code>2017</code><br>\nTo 2 cells below the (last cell of column <code>B</code> containing data)</p>\n\n<p>I did the second one, but, cant define the first one.</p>\n\n<pre><code>Dim lastRow As String\n\nlastRow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row + 2\nRange(\"B\" &amp; lastRow).Select\nSelection.PasteSpecial\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "event-handling"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 23, "user_id": 7676922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1176f925fa079992207f816cc318a66?s=128&d=identicon&r=PG&f=1", "display_name": "Graaf", "link": "https://stackoverflow.com/users/7676922/graaf"}, "edited": false, "score": 0, "creation_date": 1488964515, "post_id": 42666556, "comment_id": 72459329, "body": "Glad I could help! ;) @Graaf"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1488962297, "creation_date": 1488962297, "answer_id": 42666556, "question_id": 42666036, "link": "https://stackoverflow.com/questions/42666036/excel-worksheet-change-event-triggering-when-deleting-row/42666556#42666556", "title": "Excel Worksheet_Change event triggering when deleting row", "body": "<p>You can do some tests on Range <code>Target</code>, to avoid executing the code <br>\n(with <code>Goto</code> or rather <code>Exit Sub</code>) :</p>\n\n<ul>\n<li><code>Target.Cells.Count &gt; 1</code></li>\n<li><code>Target.Rows.Count &gt; 1</code></li>\n<li><code>Target.Columns.Count &gt; 1</code></li>\n</ul>\n\n<p>You can use theses tests at the start of the Sub or with <code>If Not WorkRng Is Nothing Then</code></p>\n\n<p>So your code could be :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim WorkRng As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\n\nIf Target.Columns.Count &gt; 1 Then Exit Sub\n\nSet WorkRng = Intersect(Application.Sheets(\"Example\").Range(\"H10: H306, M10: M306, R10: R306, W10: W306, AB10: AB306, AG10: AG306\"), Target)\nxOffsetColumn = 1\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each Rng In WorkRng\n        If Not VBA.IsEmpty(Rng.Value) Then\n        Sheets(\"Example\").Unprotect\n            Rng.Offset(0, xOffsetColumn).Value = Now\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"dd-mm-yyyy\"\n        Sheets(\"Example\").Protect\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7676922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1176f925fa079992207f816cc318a66?s=128&d=identicon&r=PG&f=1", "display_name": "Graaf", "link": "https://stackoverflow.com/users/7676922/graaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1855, "favorite_count": 0, "accepted_answer_id": 42666556, "answer_count": 1, "score": 2, "last_activity_date": 1488962458, "creation_date": 1488960443, "last_edit_date": 1488962458, "question_id": 42666036, "link": "https://stackoverflow.com/questions/42666036/excel-worksheet-change-event-triggering-when-deleting-row", "title": "Excel Worksheet_Change event triggering when deleting row", "body": "<p>I have an excel worksheet with some vba code that when i change a specific cell it automatically sets the date of today into the cell next to it.</p>\n\n<p>That all works good, but when i delete an entire row that's above that specific cell it changes the date automatically to the date of today.</p>\n\n<p>This is the code i use to automatically the change the cell:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim WorkRng As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\nSet WorkRng = Intersect(Application.Sheets(\"Example\").Range(\"H10: H306, M10: M306, R10: R306, W10: W306, AB10: AB306, AG10: AG306\"), Target)\nxOffsetColumn = 1\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each Rng In WorkRng\n        If Not VBA.IsEmpty(Rng.Value) Then\n        Sheets(\"Example\").Unprotect\n            Rng.Offset(0, xOffsetColumn).Value = Now\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"dd-mm-yyyy\"\n        Sheets(\"Example\").Protect\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Is someone familiar with this problem?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5542471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mqsdPmGUpqk/AAAAAAAAAAI/AAAAAAAAADc/UIfDzZ3tkMY/photo.jpg?sz=128", "display_name": "Tich Mabiza", "link": "https://stackoverflow.com/users/5542471/tich-mabiza"}, "edited": false, "score": 0, "creation_date": 1488960046, "post_id": 42665891, "comment_id": 72456881, "body": "Would this be possible for the Picture to move with multiple cells? What I had read online was about resizing the picture to fit a cell.I have the picture across the top of the sheet as a wide banner, and sometimes the column widths change, depending on the values in them. I wanted the pictures width to always be to the end of column J"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 5542471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mqsdPmGUpqk/AAAAAAAAAAI/AAAAAAAAADc/UIfDzZ3tkMY/photo.jpg?sz=128", "display_name": "Tich Mabiza", "link": "https://stackoverflow.com/users/5542471/tich-mabiza"}, "edited": false, "score": 0, "creation_date": 1488960193, "post_id": 42665891, "comment_id": 72456957, "body": "Yes, it does. Why don&#39;t you just try it? If you change the width of any column under the image, the image will automatically resize."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1488959900, "creation_date": 1488959900, "answer_id": 42665891, "question_id": 42665715, "link": "https://stackoverflow.com/questions/42665715/automatically-resize-image-with-column-width/42665891#42665891", "title": "Automatically resize image with column width", "body": "<p>You don't need VBA for this. </p>\n\n<p>To make the control stay with a cell when the cell moves (for example, when it is sorted) and to resize the control when the cell height and width changes, select <strong>Move and size with cells</strong>.</p>\n\n<ol>\n<li><p>Right-click the selection, click Format Control, and then click the Properties tab.</p></li>\n<li><p>Under Object Positioning, make sure <strong>Move and size with cells</strong> is selected.</p></li>\n</ol>\n\n<p>See also <a href=\"https://support.office.com/en-us/article/Position-and-size-a-control-with-its-underlying-cell-on-a-worksheet-f91032aa-b245-41e3-b296-9d13104af484\" rel=\"nofollow noreferrer\">Position and size a control with its underlying cell on a worksheet</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 6612545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba84be9426d462a2b75ac7bd04014ba?s=128&d=identicon&r=PG&f=1", "display_name": "DaveD", "link": "https://stackoverflow.com/users/6612545/daved"}, "is_accepted": false, "score": 0, "last_activity_date": 1582113486, "creation_date": 1582113486, "answer_id": 60299866, "question_id": 42665715, "link": "https://stackoverflow.com/questions/42665715/automatically-resize-image-with-column-width/60299866#60299866", "title": "Automatically resize image with column width", "body": "<p>Unfortunately, there is no <code>Worksheet_CellSizeChange</code> or any other comparable event avaiable in Excel. However, you could use the <code>Worksheet_SelectionChange</code> event to autofit your picture whenever you select another cell. Just paste the code in the regarding worksheet in Visual Basic Editor:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim myRange As Range\n    Set myRange = Me.Columns(\"A:J\")\n\n    Application.EnableEvents = False\n    If Not Intersect(Target, myRange) Is Nothing Then\n        If Not Me.Pictures(1).Width = myRange.Columns.Width Then\n            Me.Pictures(1).Width = myRange.Columns.Width\n        End If\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5542471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mqsdPmGUpqk/AAAAAAAAAAI/AAAAAAAAADc/UIfDzZ3tkMY/photo.jpg?sz=128", "display_name": "Tich Mabiza", "link": "https://stackoverflow.com/users/5542471/tich-mabiza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 42665891, "answer_count": 2, "score": 0, "last_activity_date": 1582113486, "creation_date": 1488959307, "last_edit_date": 1488960019, "question_id": 42665715, "link": "https://stackoverflow.com/questions/42665715/automatically-resize-image-with-column-width", "title": "Automatically resize image with column width", "body": "<p>I would like to automatically resize an image so that it's width is that of a certain column range, say column A to J in Excel.</p>\n\n<p>The image is a banner image that spans the width of the page on a quotation.\nI would like it's width to change as the column widths change so the width of the image always coincides with the width of column A to J</p>\n"}, {"tags": ["ms-access", "vba", "msgbox"], "comments": [{"owner": {"reputation": 7243, "user_id": 4356204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ6Nk.jpg?s=128&g=1", "display_name": "parsethis", "link": "https://stackoverflow.com/users/4356204/parsethis"}, "edited": false, "score": 3, "creation_date": 1488959833, "post_id": 42665700, "comment_id": 72456764, "body": "consider editing your code blocks for clarity. I suspect that there is an error with the order of the if and while statements."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6522944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1196286487083324/picture?type=large", "display_name": "Ionut P.", "link": "https://stackoverflow.com/users/6522944/ionut-p"}, "edited": false, "score": 0, "creation_date": 1488966060, "post_id": 42666759, "comment_id": 72460326, "body": "Great, that was the problem :D"}, {"owner": {"reputation": 63, "user_id": 6522944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1196286487083324/picture?type=large", "display_name": "Ionut P.", "link": "https://stackoverflow.com/users/6522944/ionut-p"}, "edited": false, "score": 0, "creation_date": 1488966157, "post_id": 42666759, "comment_id": 72460388, "body": "May i have another question ?  It pop&#39;s up a msgbox for every line where are differences. How can i pop up just one msgbox even if i have 1 line with differences or &quot;n&quot; lines ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 63, "user_id": 6522944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1196286487083324/picture?type=large", "display_name": "Ionut P.", "link": "https://stackoverflow.com/users/6522944/ionut-p"}, "edited": false, "score": 1, "creation_date": 1488966651, "post_id": 42666759, "comment_id": 72460725, "body": "@IonutP. Add a counter inside the loop (<code>i = i +1</code> or smthg like that) and put the <code>MsgBox</code> after the loop with a test like <code>If i &gt; 0 Then MsgBox</code> ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1488962992, "creation_date": 1488962992, "answer_id": 42666759, "question_id": 42665700, "link": "https://stackoverflow.com/questions/42665700/vba-alert-when-the-result-is-different-by-0/42666759#42666759", "title": "VBA alert when the result is different by 0", "body": "<p>You just misplaced your <code>If</code> statement, it should be inside the loop :</p>\n\n<pre><code>DM.OnUpdate = \"VerificareDiferente\"\nDM.OnInsert = \"VerificareDiferente\"\n\nPublic Sub VerificareDiferente()\n    Stl.first\n    Do While Not Stl.EOF\n        If Dsrid.Value = 50000 And Cantv.Value - Cantc.Value &lt;&gt; 0 Then\n            MsgBox \"Exista diferente intre cantitate comandata si cantitate verificata.\", _\n                vbInformation, \"Atentie !!!\"\n        Else\n        End If\n        Stl.Next\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6522944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1196286487083324/picture?type=large", "display_name": "Ionut P.", "link": "https://stackoverflow.com/users/6522944/ionut-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 42666759, "answer_count": 1, "score": 1, "last_activity_date": 1494311967, "creation_date": 1488959247, "last_edit_date": 1494311967, "question_id": 42665700, "link": "https://stackoverflow.com/questions/42665700/vba-alert-when-the-result-is-different-by-0", "title": "VBA alert when the result is different by 0", "body": "<p>I have this code:</p>\n\n<pre><code>DM.OnUpdate=\"CalculDiferenta\"\nDM.OnInsert=\"CalculDiferenta\"\n\nSub CalculDiferenta\n\nIf Dsrid.Value=50000 Then\n\nstl.first\nDo While Not Stl.Eof\nDiferenta.Value=Cantv.Value-Cantc.Value\n\n\nStl.Next\nLoop\n\nend if\nEnd Sub\n</code></pre>\n\n<p>It calculates the difference between 2 Quantity columns in a document. \nNow, i want to be alerted if there is any difference (Cantv.Value-Cantc.Value &lt;> 0 ). The code should check every line of the document for any differences and when it finds the first one, stop and show msgbox.</p>\n\n<p>I did this, but i'm not sure it's ok. It show's a pop up just when the last line has a difference.</p>\n\n<pre><code>DM.OnUpdate=\"VerificareDiferente\"\nDM.OnInsert=\"VerificareDiferente\"\n\nPublic Sub VerificareDiferente\n\nIf Dsrid.value=50000 and Cantv.Value-Cantc.Value &lt;&gt; 0  then\n\nstl.first\n             Do  While Not Stl.Eof\n       MsgBox \"Exista diferente intre cantitate comandata si cantitate verificata.\", vbInformation, \"Atentie !!!\"\n             Stl.Next\n             Loop\n       end if\nEnd Sub\n</code></pre>\n\n<p>Could you help me guys ? Thank you.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1488962825, "post_id": 42665554, "comment_id": 72458331, "body": "Just as you loop through rows you should loop through columns as well. First defining the last column that has data and then step through them. To add BBB and CCC you should look into the OR operator within an IF statement."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488964830, "post_id": 42665554, "comment_id": 72459528, "body": "Welcome to SO, please take the <a href=\"https://stackoverflow.com/tour\">tour</a> (click it) to learn how this community works! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1488965317, "post_id": 42666853, "comment_id": 72459840, "body": "You should place <code>lol = .Value</code> after testing for the error, and then use it : <code>If Not IsInArray(lol, arr)  Then .EntireRow.Delete</code>"}, {"owner": {"reputation": 13, "user_id": 7676408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10ab956ee39d88b1c96707306c25ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Che.L", "link": "https://stackoverflow.com/users/7676408/che-l"}, "edited": false, "score": 0, "creation_date": 1488966240, "post_id": 42666853, "comment_id": 72460449, "body": "Hi Cudny , thanks for your code,  after applying the above , turns out all rows deleted ... was that something wrong ? could you please help , thanks!!"}, {"owner": {"reputation": 13, "user_id": 7676408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10ab956ee39d88b1c96707306c25ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Che.L", "link": "https://stackoverflow.com/users/7676408/che-l"}, "edited": false, "score": 0, "creation_date": 1488966535, "post_id": 42666853, "comment_id": 72460642, "body": "Hi R3uK, i found the line &quot;lol = .Value&quot; , I should remove it ?                    where should I put &quot;If Not IsInArray(lol, arr) Then .EntireRow.Delete&quot;  after"}, {"owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "edited": false, "score": 0, "creation_date": 1488981162, "post_id": 42666853, "comment_id": 72470904, "body": "&quot;lol = .Value&quot;  - you can delete that, i forgot to remove that.  Oh i think i misunderstood you. You wanted to check each row if there is at least one of Values, and if there is not, then remove this row?"}, {"owner": {"reputation": 13, "user_id": 7676408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10ab956ee39d88b1c96707306c25ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Che.L", "link": "https://stackoverflow.com/users/7676408/che-l"}, "edited": false, "score": 0, "creation_date": 1489022693, "post_id": 42666853, "comment_id": 72493903, "body": "@ Cudny, ya, check the row if they hv either AAA / BBB / CCC ... JJJ either one, if yes, keep the row, if not , delete the entire row, thanks"}], "tags": [], "owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "is_accepted": false, "score": 0, "last_activity_date": 1489048319, "last_edit_date": 1489048319, "creation_date": 1488963329, "answer_id": 42666853, "question_id": 42665554, "link": "https://stackoverflow.com/questions/42665554/delete-rows-if-not-containing-one-of-the-value-in-a-list/42666853#42666853", "title": "Delete rows if not containing one of the value in a list", "body": "<p>You can try to use array to check if value you are looking for exists.\nsub \"FillArray\" fills array with your data from sheet 3. You can change range if you add more values, or change code to dynamically check how big array should be.\ncode: </p>\n\n<pre><code>   Dim arr(9) As Variant\n\nSub RemoveCell()\nDim Firstrow As Long\nDim Lastrow As Long\nDim Lrow As Long\nDim CalcMode As Long\nDim ViewMode As Long\nDim colsTocheck As Integer\n\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\nCall FillArray\nWith Sheets(\"Sheet1\")\n    .Select\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    .DisplayPageBreaks = False\n\n    'Set the first and last row to loop through\n        Firstrow = .UsedRange.Cells(1).Row\n        Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n        'loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n        deleteRow = False\n            For colsTocheck = 8 To 18 '8 is H 18 is R - i find it easier to use column numbers\n                With .Cells(Lrow, colsTocheck)\n                    If IsError(.Value) = False And .Value &lt;&gt; \"\" Then\n                        If IsInArray(.Value, arr) Then\n                            deleteRow = False\n                            Exit For\n                        Else\n                        deleteRow = True\n                        End If\n\n                    End If\n                End With\n            Next colsTocheck\n\n            If deleteRow Then .Cells(Lrow, colsTocheck).EntireRow.Delete\n\n        Next Lrow\n\nEnd With\n\nActiveWindow.View = ViewMode\nWith Application\n    .ScreenUpdating = True\n    .Calculation = CalcMode\nEnd With\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean 'chceck if value is in array\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n\nSub FillArray() 'fill array with values to check against\n    Dim sList As Worksheet\n    Set sList = Sheets(\"Sheet3\")\n\n    For i = 0 To 9\n        arr(i) = sList.Cells(i + 1, 1)\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1489055320, "last_edit_date": 1489055320, "creation_date": 1488964378, "answer_id": 42667188, "question_id": 42665554, "link": "https://stackoverflow.com/questions/42665554/delete-rows-if-not-containing-one-of-the-value-in-a-list/42667188#42667188", "title": "Delete rows if not containing one of the value in a list", "body": "<p>Here, you'll just have to <strong>use it like this</strong> :</p>\n\n<pre><code>Sub Test_CheL()\n    '''Tune the parameters to fit your need : Sheet1 and AAA/BBB/CCC/JJJ\n    Call DeleteRowsNotContaining(ThisWorkbook.Sheets(\"Sheet1\"), \"AAA/BBB/CCC/JJJ\")\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I've added a few things to improve performances and stability : </p>\n\n<ul>\n<li><code>EnableEvents = False</code> , </li>\n<li>redisplay PageBreaks after removing rows, </li>\n<li>few <code>Exit For</code>s to avoid keeping looping when you have enough to go on</li>\n<li>store cell's value into a variable to improve performance while testing against values of the array</li>\n</ul>\n\n<hr>\n\n<p><strong>Code to remove rows not containing any value in a list</strong> :</p>\n\n<pre><code>Sub DeleteRowsNotContaining(wS As Worksheet, ValuesToKeep As String)\nDim FirstRow As Long\nDim LastRow As Long\nDim LastColInRow As Long\nDim LoopRow As Long\nDim CalcMode As Long\nDim ViewMode As Long\n\nDim VtK() As String\nDim i As Integer\nDim KeepRow As Boolean\nDim CelRg As Range\nDim CelStr As String\n\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nVtK = Split(ValuesToKeep, \"/\")\n\nWith wS\n    .Select\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    .DisplayPageBreaks = False\n\n    '''Set the first and last row to loop through\n    FirstRow = .UsedRange.Cells(1, 1).Row\n    LastRow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n    '''Loop from Lastrow to Firstrow (bottom to top)\n    For LoopRow = LastRow To FirstRow Step -1\n        '''If you don't find any of your values, delete the row\n        KeepRow = False\n        LastColInRow = .Cells(LoopRow, .Columns.Count).End(xlToLeft).Column\n\n        With .Range(.Cells(LoopRow, \"A\"), .Cells(LoopRow, LastColInRow))\n            For Each CelRg In .Cells\n                '''If cell contains an error, go directly to the next cell\n                If IsError(CelRg.Value) Then\n                Else\n                    CelStr = CStr(CelRg.Value)\n                    For i = LBound(VtK) To UBound(VtK)\n                        If CelStr &lt;&gt; VtK(i) Then\n                        Else\n                            '''Cell contains a value to keep\n                            KeepRow = True\n                            Exit For\n                        End If\n                    Next i\n                    '''If you already found a value you want to keep, go next line\n                    If KeepRow Then Exit For\n                End If\n            Next CelRg\n            '''Check if you need to delete the row\n            If Not KeepRow Then .EntireRow.Delete\n        End With '.Range(.Cells(LoopRow, \"A\"), .Cells(LoopRow, LastColInRow))\n    Next LoopRow\n    .DisplayPageBreaks = True\nEnd With 'wS\n\nActiveWindow.View = ViewMode\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7676408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10ab956ee39d88b1c96707306c25ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Che.L", "link": "https://stackoverflow.com/users/7676408/che-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4166, "favorite_count": 0, "accepted_answer_id": 42667188, "answer_count": 2, "score": 1, "last_activity_date": 1594003849, "creation_date": 1488958762, "last_edit_date": 1594003849, "question_id": 42665554, "link": "https://stackoverflow.com/questions/42665554/delete-rows-if-not-containing-one-of-the-value-in-a-list", "title": "Delete rows if not containing one of the value in a list", "body": "<p>I am new to VBA, I am trying my best to explain what I want to do</p>\n\n<p>I need to check sheet 1 and sheet 2 \nif they have value \"AAA\" or \"BBB\" or \"CCC\" in the row, I want to keep it, \nif not, delete the entire row</p>\n\n<p>My below code can only help me to remove rows except it contains \"AAA\" in column Q </p>\n\n<blockquote>\n  <ol>\n  <li><p>i don't know how to add more value like \"BBB\" &amp; \"CCC\", if the row have these value, either one, I would like to keep it</p></li>\n  <li><p>how to add more columns to check ? now is only checking in column Q, if I want to check it from column H to R ?</p></li>\n  <li><p>i actually have 10 values (AAA, BBB, CCC .... JJJ) want to keep, do I need to type them out one by one , or there is a method to ask excel\n  to check a list, if any cell in Sheet 1 and Sheet 2 matched with any\n  one from these 10 values, keep the row, otherwise, delete the entire\n  row</p></li>\n  </ol>\n</blockquote>\n\n<p>the list is locate at Sheet 3 from column A1 :A10</p>\n\n<p>thanks !\nmy code as below</p>\n\n<pre><code>Sub RemoveCell()\nDim Firstrow As Long\nDim Lastrow As Long\nDim Lrow As Long\nDim CalcMode As Long\nDim ViewMode As Long\n\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\n\nWith Sheets(\"Sheet1\")\n\n\n    .Select\n\n\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    .DisplayPageBreaks = False\n\n    'Set the first and last row to loop through\n    Firstrow = .UsedRange.Cells(1).Row\n    Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n    'loop from Lastrow to Firstrow (bottom to top)\n    For Lrow = Lastrow To Firstrow Step -1\n\n        With .Cells(Lrow, \"Q\")\n\n            If Not IsError(.Value) Then\n\n                If .Value &lt;&gt; \"AAA\" Then .EntireRow.Delete\n\n\n            End If\n\n        End With\n\n    Next Lrow\n\nEnd With\n\nActiveWindow.View = ViewMode\nWith Application\n    .ScreenUpdating = True\n    .Calculation = CalcMode\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1488954859, "post_id": 42664480, "comment_id": 72454244, "body": "Did you save the file as <code>.xlsm</code> ? (Excel Macro-Enabled Workbook)"}, {"owner": {"reputation": 27, "user_id": 7646740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3fb2c9d9025f0084a857f4d68ec6ec3?s=128&d=identicon&r=PG&f=1", "display_name": "saif", "link": "https://stackoverflow.com/users/7646740/saif"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488955212, "post_id": 42664480, "comment_id": 72454408, "body": "No, I saved in excel format itself"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1488959366, "post_id": 42664480, "comment_id": 72456532, "body": "I use copy/ paste and keep a copy in a text (or word) file as a backup, sorry I understand your pain."}], "answers": [{"comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488957388, "post_id": 42664851, "comment_id": 72455498, "body": "<code>.xlsb</code> is also a valid save format for Excel files containing macros."}], "tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": true, "score": 1, "last_activity_date": 1488956175, "creation_date": 1488956175, "answer_id": 42664851, "question_id": 42664480, "link": "https://stackoverflow.com/questions/42664480/how-to-save-vba-excel-code-in-ms-office-excel/42664851#42664851", "title": "How to save VBA Excel code in MS Office Excel", "body": "<p>Wont work as the file was not saved as xlsm, you will have to do it again.</p>\n"}], "owner": {"reputation": 27, "user_id": 7646740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3fb2c9d9025f0084a857f4d68ec6ec3?s=128&d=identicon&r=PG&f=1", "display_name": "saif", "link": "https://stackoverflow.com/users/7646740/saif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 42664851, "answer_count": 1, "score": -1, "last_activity_date": 1488956175, "creation_date": 1488954704, "question_id": 42664480, "link": "https://stackoverflow.com/questions/42664480/how-to-save-vba-excel-code-in-ms-office-excel", "title": "How to save VBA Excel code in MS Office Excel", "body": "<p>I had a VBA code for excel. I wrote the code and saved and exited the file. When I opened it once again the code was missing and it wasn't saved but I remember I had saved the code.</p>\n"}, {"tags": ["sql", "vba", "excel", "odbc"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488955288, "post_id": 42664427, "comment_id": 72454447, "body": "If <code>AND ((VPXXX.PDXXX=&#39;LDPDQ&#39;))&quot;</code> works, you probably need to add the quotation marks to <code>AND ((VPXXX.PDXXX=&quot; + Param3 + &quot; ))&quot;</code>, i.e. <code>AND ((VPXXX.PDXXX=&#39;&quot; + Param3 + &quot;&#39; ))&quot;</code>, unless the quotation marks are already included in your cell value.  (P.S.  Why do you have two sets of <code>(  )</code>?  Not that it should affect things, but it shouldn&#39;t be needed either.)"}, {"owner": {"reputation": 119, "user_id": 7150126, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6fa3bf5f4682b89a07f6a425fe666d8?s=128&d=identicon&r=PG&f=1", "display_name": "RR33", "link": "https://stackoverflow.com/users/7150126/rr33"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488956578, "post_id": 42664427, "comment_id": 72455089, "body": "1) Thanks! I appreciate it.  I hate how simple it is sometimes :) 2) As for the double sets of &quot;()&quot; I have obviously been trained by the assistant to the assistant for the Department of Redundancy Department."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488959440, "post_id": 42664427, "comment_id": 72456574, "body": "I&#39;ll put an &quot;answer&quot; in for the quotation marks (just so people don&#39;t keep looking at the question thinking it hasn&#39;t yet been solved), once I stop ROTFLMAO re your response about the double brackets."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1488959542, "creation_date": 1488959542, "answer_id": 42665796, "question_id": 42664427, "link": "https://stackoverflow.com/questions/42664427/use-range-values-as-parameters-in-sql-statement/42665796#42665796", "title": "Use range values as parameters in SQL Statement", "body": "<p>Assuming your cell value itself isn't enclosed in single-quotation marks, you probably need to change</p>\n\n<pre><code>AND ((VPXXX.PDXXX=\" + Param3 + \" ))\"\n</code></pre>\n\n<p>to include the quotation marks, i.e. </p>\n\n<pre><code>AND ((VPXXX.PDXXX='\" + Param3 + \"' ))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1488961793, "creation_date": 1488961793, "answer_id": 42666423, "question_id": 42664427, "link": "https://stackoverflow.com/questions/42664427/use-range-values-as-parameters-in-sql-statement/42666423#42666423", "title": "Use range values as parameters in SQL Statement", "body": "<p>As said by @YowE3K, you were missing <code>'</code> to enclose your values, so your code should be :</p>\n\n<pre><code>\"VPXXX.PDXXX Between '\" + Param1 + \"' and '\" + Param2 + \"')\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\"AND (VPXXX.PDXXX='\" + Param3 + \"')\"\n</code></pre>\n\n<hr>\n\n<p>Btw, if you are using any <code>IN</code> statement in you SQL query, this could come in very handy :</p>\n\n<pre><code>Public Function ConcatSQL(RgToConcat As Range, Optional AllowMultipleS As Boolean = False) As String\nDim CelRg As Range\nConcatSQL = \"('\"\nFor Each CelRg In RgToConcat.Cells\n    If CelRg.Value &lt;&gt; vbNullString And (InStr(1, ConcatSQL, CelRg.Value) = 0 Or AllowMultipleS) Then\n        ConcatSQL = ConcatSQL &amp; CelRg.Value &amp; \"', '\"\n    End If\nNext CelRg\nConcatSQL = Left(ConcatSQL, Len(ConcatSQL) - 3) &amp; \")\"\nEnd Function\n</code></pre>\n\n<p>How to use :</p>\n\n<pre><code>\"VPXXX.PDXXX IN \" &amp; ConcatSQL(Sheets(\"SHEET1\").Range(\"P1:P3\"))\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7150126, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6fa3bf5f4682b89a07f6a425fe666d8?s=128&d=identicon&r=PG&f=1", "display_name": "RR33", "link": "https://stackoverflow.com/users/7150126/rr33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 1, "accepted_answer_id": 42665796, "answer_count": 2, "score": 1, "last_activity_date": 1488961865, "creation_date": 1488954456, "last_edit_date": 1488961865, "question_id": 42664427, "link": "https://stackoverflow.com/questions/42664427/use-range-values-as-parameters-in-sql-statement", "title": "Use range values as parameters in SQL Statement", "body": "<p>I am connecting to a database via ODBC.  I have the SQL Statement written in VBA.  I have defined three parameters to pass, defined as cell references:</p>\n\n<pre><code>Dim Param1 As String\nDim Param2 As String\nDim Param3 As String\n\nParam1 = Sheets(\"SHEET1\").Range(\"P1\").Value\nParam2 = Sheets(\"SHEET1\").Range(\"P2\").Value`\nParam3 = Sheets(\"SHEET1\").Range(\"P3\").Value\n</code></pre>\n\n<p>The between clause of the Where Statement works fine (Tables are examples) This is the end of the Statement:</p>\n\n<pre><code>(VPXXX.PDXXX Between \" + Param1 + \" and \" + Param2 + \"))\"\n</code></pre>\n\n<p>When I try to add an \"equal' Statement at the end, I throw an error \"General ODBC Error:</p>\n\n<pre><code>AND ((VPXXX.PDXXX=\" + Param3 + \" ))\"\n</code></pre>\n\n<p>Note: The Below end works </p>\n\n<pre><code>AND ((VPXXX.PDXXX='LDPDQ'))\"\n</code></pre>\n\n<p>It just hard codes a single vendor</p>\n\n<p>Hope this is enough info ..... First time building a query in SQL.  thanks in Advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488952825, "post_id": 42664019, "comment_id": 72453396, "body": "Try Worksheets(&quot;Sheet1&quot;) instead of Sheet1 and the same for Sheet2"}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1488952828, "post_id": 42664019, "comment_id": 72453397, "body": "Based on the snippet, either <code>Sheet1</code> or its property <code>Cells</code> is missing, I would guess - or you&#39;ve tried to reference a cell that doesn&#39;t exist."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1488953148, "post_id": 42664019, "comment_id": 72453507, "body": "Did you mean to use <code>Sheet1</code> and <code>Sheet2</code> as sheet <code>CodeNames</code> ?"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488953413, "post_id": 42664019, "comment_id": 72453609, "body": "Hey guys thanks it working but i am getting wrong output    like if my sheet had data  a\t b\t c\t d\t e\t f\t g and my sheet two has data \t a  100\t b  100\t e  100 \t f  100  so i should get data substitute for a b e and f only but i getting a\t100 b\t100 c\t100 d\t100 e\t100 f\t100 g\t100 h\t100  kindly tell me whats wrong in code"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1488953655, "post_id": 42664019, "comment_id": 72453733, "body": "it is substituting value in b column of sheet 1 whether value matches to sheet 2 or not"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488953823, "post_id": 42664019, "comment_id": 72453816, "body": "Don&#39;t you mean <code>If Sheet1.Cells(i, 1) = Sheet2.Cells(j, 1) Then</code> ?  i.e. when the value in column A of the two sheets <b>match</b>, copy the value of column B in Sheet2 to column B in Sheet1."}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "is_accepted": true, "score": 0, "last_activity_date": 1488955165, "creation_date": 1488955165, "answer_id": 42664592, "question_id": 42664019, "link": "https://stackoverflow.com/questions/42664019/error-in-vba-excel/42664592#42664592", "title": "Error in VBA excel", "body": "<p>You can try like this:</p>\n\n<pre><code>Dim j As Integer\nDim i As Integer\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\nFor i = 1 To 8\n    For j = 1 To 4\n        If ws1.Cells(i, 1) &lt;&gt; ws2.Cells(j, 1) Then\n            ws1.Cells(i, 2) = ws2.Cells(j, 2)\n        End If\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 42664592, "answer_count": 1, "score": 0, "last_activity_date": 1488955165, "creation_date": 1488952690, "last_edit_date": 1488953055, "question_id": 42664019, "link": "https://stackoverflow.com/questions/42664019/error-in-vba-excel", "title": "Error in VBA excel", "body": "<p>my program is giving error </p>\n\n<pre><code>Sub my()\n\nDim j As Integer\nDim i As Integer\nFor i = 1 To 8\n    For j = 1 To 4\n        If Sheet1.Cells(i, 1) &lt;&gt; Sheet2.Cells(j, 1) Then\n            Sheet1.Cells(i, 2) = Sheet2.Cells(j, 2)\n        End If      \n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>it gives an error object required \ncan someone tell me what is wrong in it i am new in VBA</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1488950841, "last_edit_date": 1488950841, "creation_date": 1488950530, "answer_id": 42663570, "question_id": 42663167, "link": "https://stackoverflow.com/questions/42663167/extracting-a-name-from-excel/42663570#42663570", "title": "Extracting a Name from excel", "body": "<p>Just make another small function to get name by eliminating email address. See below...</p>\n\n<p><strong><em>Use of function in worksheet.</em></strong>\n<a href=\"https://i.stack.imgur.com/LR1np.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LR1np.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function GetName(refCell As String)\nDim tempName As String\n    tempName = Trim(Left(refCell, Len(refCell) - Len(ExtractEmailAddress(refCell))))\n    GetName = tempName\nEnd Function\n\n'----------------------------------------------------------\n\nFunction ExtractEmailAddress(s As String) As String\n    Dim AtSignLocation As Long\n    Dim i As Long\n    Dim TempStr As String\n    Const CharList As String = \"[A-Za-z0-9._-]\"\n\n    'Get location of the @\n    AtSignLocation = InStr(s, \"@\")\n    If AtSignLocation = 0 Then\n        ExtractEmailAddress = \"\" 'not found\n    Else\n        TempStr = \"\"\n        'Get 1st half of email address\n        For i = AtSignLocation - 1 To 1 Step -1\n            If Mid(s, i, 1) Like CharList Then\n                TempStr = Mid(s, i, 1) &amp; TempStr\n            Else\n                Exit For\n            End If\n        Next i\n        If TempStr = \"\" Then Exit Function\n        'get 2nd half\n        TempStr = TempStr &amp; \"@\"\n        For i = AtSignLocation + 1 To Len(s)\n            If Mid(s, i, 1) Like CharList Then\n                TempStr = TempStr &amp; Mid(s, i, 1)\n            Else\n                Exit For\n            End If\n        Next i\n    End If\n    'Remove trailing period if it exists\n    If Right(TempStr, 1) = \".\" Then TempStr = _\n       Left(TempStr, Len(TempStr) - 1)\n    ExtractEmailAddress = TempStr\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>You can also use built in function in place of <code>GetName</code> with <code>ExtractEmailAddress</code> like </p>\n</blockquote>\n\n<pre><code>=TRIM(LEFT(A1,LEN(A1)-LEN(ExtractEmailAddress(A1))))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/x03co.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x03co.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1488950983, "last_edit_date": 1490005094, "creation_date": 1488950983, "answer_id": 42663664, "question_id": 42663167, "link": "https://stackoverflow.com/questions/42663167/extracting-a-name-from-excel/42663664#42663664", "title": "Extracting a Name from excel", "body": "<p>Formula only approach relies on this <a href=\"https://superuser.com/questions/680769/i-need-to-find-the-last-space-in-a-xls-cell\">Super User</a> answer regarding finding the last space in a cell. You then just use <code>LEFT(position_of_last_space-1)</code> to get everything to the left of the e-mail address.</p>\n\n<pre><code>=LEFT(A1,FIND(\"`\",SUBSTITUTE(A1,\" \",\"`\",LEN(A1)-LEN(SUBSTITUTE(A1,\" \",\"\"))))-1)\n</code></pre>\n\n<p>The use of the back-tick is to be a substitute for spaces. The assumption is there is no back-tick in either the name or the e-mail address.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vHEB9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vHEB9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 7659656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eQBo.png?s=128&g=1", "display_name": "OES", "link": "https://stackoverflow.com/users/7659656/oes"}, "is_accepted": false, "score": 0, "last_activity_date": 1488977341, "creation_date": 1488977341, "answer_id": 42671839, "question_id": 42663167, "link": "https://stackoverflow.com/questions/42663167/extracting-a-name-from-excel/42671839#42671839", "title": "Extracting a Name from excel", "body": "<p>Did you try this non-VBA solution called <a href=\"https://online-excel-solutions.com/t/how-to-easily-extract-part-of-the-string-flash-fill/184\" rel=\"nofollow noreferrer\">Flash Fill</a></p>\n\n<p>If you have data with same pattern (as for example e-mail address where you want to extract First name) then:</p>\n\n<ul>\n<li>In next column write example of what you want to extract (i.e. John Smith in your example): </li>\n<li>Select that cell and press Ctrl+E </li>\n<li>You will get list that you can further check.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/TEGN4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TEGN4.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 7676061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885c282cf355020616c6d2bce59e3b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Brad E", "link": "https://stackoverflow.com/users/7676061/brad-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1488977341, "creation_date": 1488948072, "last_edit_date": 1531161705, "question_id": 42663167, "link": "https://stackoverflow.com/questions/42663167/extracting-a-name-from-excel", "title": "Extracting a Name from excel", "body": "<p>I have to extract Customer names in a column that is a combination of name and email address. Examples of what would appear in this column could look like:</p>\n\n<p><code>John Smith Johnsmith@me.com</code></p>\n\n<p><code>Joe Bloggs theycallmejoe@myemail.com</code></p>\n\n<p><code>Justin Credible JustinC@provider.com</code></p>\n\n<p>I have found this cool VBA to extract the email address.</p>\n\n<pre><code>Function ExtractEmailAddress(s As String) As String\n    Dim AtSignLocation As Long\n    Dim i As Long\n    Dim TempStr As String\n    Const CharList As String = \"[A-Za-z0-9._-]\"\n\n    'Get location of the @\n    AtSignLocation = InStr(s, \"@\")\n    If AtSignLocation = 0 Then\n        ExtractEmailAddress = \"\" 'not found\n    Else\n        TempStr = \"\"\n        'Get 1st half of email address\n        For i = AtSignLocation - 1 To 1 Step -1\n            If Mid(s, i, 1) Like CharList Then\n                TempStr = Mid(s, i, 1) &amp; TempStr\n            Else\n                Exit For\n            End If\n        Next i\n        If TempStr = \"\" Then Exit Function\n        'get 2nd half\n        TempStr = TempStr &amp; \"@\"\n        For i = AtSignLocation + 1 To Len(s)\n            If Mid(s, i, 1) Like CharList Then\n                TempStr = TempStr &amp; Mid(s, i, 1)\n            Else\n                Exit For\n            End If\n        Next i\n    End If\n    'Remove trailing period if it exists\n    If Right(TempStr, 1) = \".\" Then TempStr = _\n       Left(TempStr, Len(TempStr) - 1)\n    ExtractEmailAddress = TempStr\nEnd Function\n</code></pre>\n\n<p>But I need something similar to extract the name as well.</p>\n\n<p>Can anyone assist?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 3, "creation_date": 1488944785, "post_id": 42662538, "comment_id": 72450847, "body": "The use of <code>$</code> for locking only applies in <code>A1</code> mode. In <code>R1C1</code> mode a reference can look like <code>R1C1</code>, <code>R[1]C1</code>, <code>R1C[1]</code>, or <code>R[1]C[1]</code>. The <code>[</code> &amp; <code>]</code> indicate a relative reference, but if they are not there then it is an absolute (or locked) reference."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1488945891, "post_id": 42662538, "comment_id": 72451171, "body": "And formulas should be assigned to cells using the <code>.Formula</code> or <code>.FormulaR1C1</code> property - it isn&#39;t a good idea to use the <code>.Value</code> property for a formula (although it usually works)."}, {"owner": {"reputation": 13, "user_id": 7650937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc1013b8d343b999a2c0fdd264cb4ec?s=128&d=identicon&r=PG&f=1", "display_name": "excel noob", "link": "https://stackoverflow.com/users/7650937/excel-noob"}, "edited": false, "score": 0, "creation_date": 1488946886, "post_id": 42662538, "comment_id": 72451446, "body": "I understand that the <code>[ ]</code> make it relative referencing  and without them it becomes absolute referencing.  I just need a solution to lock the relative reference for later when I use auto fill to pull that formula down inside the worksheet."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1488946953, "post_id": 42662538, "comment_id": 72451466, "body": "@excelnoob - You can&#39;t lock a relative reference. You need to compute the absolute reference before you assign the formula."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1488960751, "creation_date": 1488960751, "answer_id": 42666122, "question_id": 42662538, "link": "https://stackoverflow.com/questions/42662538/locking-a-relative-reference-inside-a-formula/42666122#42666122", "title": "Locking a Relative Reference inside a Formula", "body": "<p>As you want to lock a cell for a further use of AutoFill, you'll have to use A1 reference style.</p>\n\n<p>For a reminder (said in comments), you can't use <code>$</code> to lock something in a formula using R1C1 style.</p>\n\n<pre><code>Sub Test_Excel_Noob()\nDim SrchRng As Range\nDim CelRg As Range\n\n    Set SrchRng = ThisWorkbook.Sheets(\"Feuil1\").Range(\"F6:F30\")\n\n    For Each CelRg In SrchRng.Cells\n        'SL Events\n        If CelRg.Value &lt;&gt; \"SL\" Then\n        Else\n            '''Equivalent of \"=RC[-9]-$R$C[-9]\" \n            '''which is incorrect as you can't use $ in R1C1 style\n            CelRg.Offset(0, 7).Formula = _\n                \"=\" &amp; CelRg.Offset(0, -2).Address(0, 0) &amp; _\n                \"-\" &amp; CelRg.Offset(0, -2).Address(1, 1)\n        End If\n    Next CelRg\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7650937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc1013b8d343b999a2c0fdd264cb4ec?s=128&d=identicon&r=PG&f=1", "display_name": "excel noob", "link": "https://stackoverflow.com/users/7650937/excel-noob"}, "edited": false, "score": 0, "creation_date": 1489006953, "post_id": 42673789, "comment_id": 72487774, "body": "Perfect answer!! I&#39;m sure there are many other ways to solve the same problem but this was simple and easy to apply to my prior code. Thanks once again."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1488982784, "creation_date": 1488982784, "answer_id": 42673789, "question_id": 42662538, "link": "https://stackoverflow.com/questions/42662538/locking-a-relative-reference-inside-a-formula/42673789#42673789", "title": "Locking a Relative Reference inside a Formula", "body": "<p>The formula <code>=RC[-9]-R6C4</code> uses the <code>R1C1</code> reference style.</p>\n\n<p>This style uses numbers for both the rows and columns (i.e. <code>R?C?</code>). The Cell References are represented in relation to the cell containing the formula.</p>\n\n<p><strong><em>Absolute References</em></strong> are declared by the numbers to the right of the <code>R</code> for rows and <code>C</code> for columns (<code>R6C4</code> equals to <code>$D$6</code>).</p>\n\n<p><strong><em>Relative References</em></strong> are declared by a number within square brackets, a negative number indicates the cells above\\left for rows\\columns to the cell containing the formula, while a positive number determine the cells below\\right for rows\\columns (<code>C[-9]</code> indicates nine columns to the left of the cell with the formula). Another form of relative reference is when the R or C appear without a number beside, meaning it refers to the same row\\column of the cell containing the formula.</p>\n\n<p>From the above to ensure that in the formula <code>=RC[-9]-R6C4</code> (i.e. <code>=D6-$D$6</code>) the second cell always refers to the same row of the found cell <code>cel</code> just need to replace this line:</p>\n\n<pre><code>I = \"=RC[-9]-R6C4\"\n</code></pre>\n\n<p>With this line:</p>\n\n<pre><code>I = \"=RC[-9]-R\" &amp; cel.Row &amp; \"C4\"\n</code></pre>\n\n<p>Thus making the row fix and to Always refers to same row of the cell <code>cel</code></p>\n"}], "owner": {"reputation": 13, "user_id": 7650937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc1013b8d343b999a2c0fdd264cb4ec?s=128&d=identicon&r=PG&f=1", "display_name": "excel noob", "link": "https://stackoverflow.com/users/7650937/excel-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "accepted_answer_id": 42673789, "answer_count": 2, "score": 1, "last_activity_date": 1488982784, "creation_date": 1488944330, "last_edit_date": 1488960773, "question_id": 42662538, "link": "https://stackoverflow.com/questions/42662538/locking-a-relative-reference-inside-a-formula", "title": "Locking a Relative Reference inside a Formula", "body": "<p>I'm trying to create a search that when found will input a formula into a cell.\nThe problem is trying to create a formula that will reference the row that the search is found (<code>OffSet</code>?) and locking it inside the formula (Same as using <kbd>F4</kbd> or <code>$</code> outside of VBA) </p>\n\n<pre><code>Set SrchRng = Range(\"F6:F30\")\n\nFor Each cel In SrchRng\n\n    'SL Events\n       If cel.Value = \"SL\" Then\n\n\n       I = \"=RC[-9]-R6C4\"\n       ''''I want it to be along these lines\n       ''''I = \"=RC[-9]-$R$C[-9]\"                      or\n       ''''I = \"=RC[-9]-($Cel.Offset(, -9).Value)\"\n\n\n              cel.Offset(0, 7).Value = I\n\n        End If\n</code></pre>\n\n<p>The second cell needs to be locked because I'm using auto fill on a different part of the macro.</p>\n\n<p>Can this be done?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488947112, "post_id": 42662475, "comment_id": 72451520, "body": "At what line does the error occur? One thing that will likely help is that you need to fully qualify all uses of a range with the sheet you want to run it on.  See how you did <code>SHT1.Range(&quot;Q1&quot;)...</code>? You also need to do that with <code>Cells()</code> and <code>Rows.Count</code>, <i>even when in a defined range</i>, i.e. <code>SHT2.Range(SHT2.Cells(....)</code> otherwise, it&#39;s going to grab <code>Cells()</code> from the ActiveSheet and if that&#39;s not <code>SHT2</code>, you&#39;ll likely get an error."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488957888, "post_id": 42664964, "comment_id": 72455764, "body": "BTW : 1) <code>Set FoundCell = Nothing</code> is not needed since it&#39;ll be reset at every loop at <code>Set FoundCell = SHT2.Cells(X, &quot;C&quot;)</code> 2)  <code>Application.CutCopyMode = False</code> is not needed at all since there&#39;s no <code>Copy()</code> method active"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488958269, "post_id": 42664964, "comment_id": 72455949, "body": "@user3598756 Force of habit I guess.  I always clear objects when I&#39;ve finished using them."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488958351, "post_id": 42664964, "comment_id": 72456007, "body": "well you&#39;re not actually done with that object till you&#39;re out of the loop"}, {"owner": {"reputation": 3, "user_id": 7675830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa0498e873ec7480b00df137c395898?s=128&d=identicon&r=PG&f=1", "display_name": "Sockmonster1945", "link": "https://stackoverflow.com/users/7675830/sockmonster1945"}, "edited": false, "score": 0, "creation_date": 1499672562, "post_id": 42664964, "comment_id": 76986149, "body": "Thanks Mark Fitzgerald!"}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1488956667, "creation_date": 1488956667, "answer_id": 42664964, "question_id": 42662475, "link": "https://stackoverflow.com/questions/42662475/match-value-in-1st-workbook-to-a-column-in-the-2nd-workbook-and-copy-specific-c/42664964#42664964", "title": "Match value in 1st Workbook to a column in the 2nd Workbook, and copy specific cells", "body": "<p>Within your <code>X = 3 to LastRow</code> loop you are populating variables using the <code>FoundRow</code> range object <strong>but FoundRow has not been set.</strong></p>\n\n<p>Try replacing that loop with this:</p>\n\n<pre><code>For X = 3 To LastRow\n\n    If SHT2.Cells(X, \"C\") = FindNo Then\n\n        Set FoundCell = SHT2.Cells(X, \"C\")\n        FRow = FoundCell.Row\n        FColumn = FoundCell.Column\n        Set FoundCell = Nothing\n    SHT2.Range(Cells(FColumn + 14, FRow)) = SHT1.Cells(13, 1)\n    SHT2.Range(Cells(FColumn + 15, FRow)) = SHT1.Cells(7, 6)\n    SHT2.Range(Cells(FColumn + 17, FRow)) = SHT1.Cells(46, 2)\n    SHT2.Range(Cells(FColumn + 18, FRow)) = SHT1.Cells(58, 2)\n    SHT2.Range(Cells(FColumn + 19, FRow)) = SHT1.Cells(58, 13)\n\n    End If\n\n    Application.CutCopyMode = False\n\nNext X\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7675830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa0498e873ec7480b00df137c395898?s=128&d=identicon&r=PG&f=1", "display_name": "Sockmonster1945", "link": "https://stackoverflow.com/users/7675830/sockmonster1945"}, "edited": false, "score": 0, "creation_date": 1499672538, "post_id": 42665282, "comment_id": 76986137, "body": "Thanks @user3598756!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1488957776, "creation_date": 1488957776, "answer_id": 42665282, "question_id": 42662475, "link": "https://stackoverflow.com/questions/42662475/match-value-in-1st-workbook-to-a-column-in-the-2nd-workbook-and-copy-specific-c/42665282#42665282", "title": "Match value in 1st Workbook to a column in the 2nd Workbook, and copy specific cells", "body": "<p>you're not setting <code>FoundCell</code> before exploiting it, so you should add some <code>Set FoundCell = SHT2.Cells(X, \"C\")</code> right after <code>If SHT2.Cells(X, \"C\") = FindNo Then</code>. But it's a waste of crossed references since you already know that matched cell row and column indexes are, respectively <code>X</code> and <code>3</code>.</p>\n\n<p>furthermore you may want to adopt <code>With-End With</code> syntax to reference an object (a <code>workbook</code>, a <code>worksheet</code> a <code>range</code>...) and access its methods or properties by means of a simple dot (<code>.</code>). this will give you more control over proper object referencing and relieve you from many variables declaring and using.</p>\n\n<p>finally you should avoid repeating access to the same objects within a loop when those objects doesn't change </p>\n\n<p>for all what above you could consider the following refactoring</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim FindNo As String\n    Dim X As Long\n    Dim val1 As Variant, val2 As Variant, val3 As Variant, val4 As Variant, val5 As Variant\n\n    Application.ScreenUpdating = False\n\n    With ThisWorkbook.Sheets(\"F-IMS-11\") '&lt;--| reference Worksheet object directly from \"WB1\" workbook\n        FindNo = .Range(\"Q1\").Value\n        val1 = .cells(13, 1)\n        val2 = .cells(7, 6)\n        val3 = .cells(46, 2)\n        val4 = .cells(58, 2)\n        val5 = .cells(58, 13)\n    End With\n\n    With Workbooks.Open(\"Z:\\ISO MTSO DOCUMENTS (New Templates)\\Incident &amp; Accident Monitoring (2016 and 2017)\\Incident Monitoring 2016 and 2017.xlsx\") '&lt;--| open and reference wanted \"WB2\" workbook\n        With .Sheets(\"2017\") '&lt;--| reference its \"2017\" worksheet\n            For X = 3 To .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row '&lt;--| loop through its column \"C\" cells from row 3 down to last not empty one\n                If .cells(X, \"C\") = FindNo Then\n                    .cells(X, 17) = val1\n                    .cells(X, 18) = val2\n                    .cells(X, 20) = val3\n                    .cells(X, 21) = val4\n                    .cells(X, 22) = val5\n                End If\n            Next X\n            Range(\"Q:Q , T:T, U:U\").WrapText = True\n        End With\n        .Close True\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7675830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baa0498e873ec7480b00df137c395898?s=128&d=identicon&r=PG&f=1", "display_name": "Sockmonster1945", "link": "https://stackoverflow.com/users/7675830/sockmonster1945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 42665282, "answer_count": 2, "score": 0, "last_activity_date": 1488957776, "creation_date": 1488943907, "last_edit_date": 1488956340, "question_id": 42662475, "link": "https://stackoverflow.com/questions/42662475/match-value-in-1st-workbook-to-a-column-in-the-2nd-workbook-and-copy-specific-c", "title": "Match value in 1st Workbook to a column in the 2nd Workbook, and copy specific cells", "body": "<p>I have to match a value in 1st workbook to a column of data in the 2nd workbook, then copy specific cells in 1st workbook and paste it in specific cells (same row as match data) in second workbook.</p>\n\n<p>Here is the code I've come up with so far, but it doesn't work, and returns a run time error 1004: application-defined or object-defined error.</p>\n\n<pre><code>Dim FindNo As String\nDim X As Long, LastRow As Long\nDim FoundCell As Range\nDim FColumn As Integer, FRow As Integer\nDim WB1 As Workbook, SHT1 As Worksheet\nDim WB2 As Workbook, SHT2 As Worksheet\n\nApplication.ScreenUpdating = False\n\n    Set WB1 = ThisWorkbook\n    Set WB2 = Workbooks.Open(\"Z:\\ISO MTSO DOCUMENTS (New Templates)\\Incident &amp; Accident Monitoring (2016 and 2017)\\Incident Monitoring 2016 and 2017.xlsx\")\n    Set SHT1 = WB1.Sheets(\"F-IMS-11\")\n    Set SHT2 = WB2.Sheets(\"2017\")\n\n    FindNo = SHT1.Range(\"Q1\").Value\n    LastRow = SHT2.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor X = 3 To LastRow\n\n    If SHT2.Cells(X, \"C\") = FindNo Then\n\n        FRow = FoundCell.Row\n        FColumn = FoundCell.Column\n\n    SHT2.Range(Cells(FColumn + 14, FRow)) = SHT1.Cells(13, 1)\n    SHT2.Range(Cells(FColumn + 15, FRow)) = SHT1.Cells(7, 6)\n    SHT2.Range(Cells(FColumn + 17, FRow)) = SHT1.Cells(46, 2)\n    SHT2.Range(Cells(FColumn + 18, FRow)) = SHT1.Cells(58, 2)\n    SHT2.Range(Cells(FColumn + 19, FRow)) = SHT1.Cells(58, 13)\n\n    End If\n\n    Application.CutCopyMode = False\n\nNext X\n\nSHT2.Columns(17).WrapText = True\nSHT2.Columns(20).WrapText = True\nSHT2.Columns(21).WrapText = True\n\nWB2.Save\nWB2.Close\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>It would great to hear suggestions, as I don't really have a good background in VBA, and I just tried to modify most of the codes.</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 39513, "user_id": 584183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc31dff5555e427e5829e385376c46c4?s=128&d=identicon&r=PG", "display_name": "jmcilhinney", "link": "https://stackoverflow.com/users/584183/jmcilhinney"}, "edited": false, "score": 0, "creation_date": 1488944399, "post_id": 42662282, "comment_id": 72450712, "body": "Obviously the <code>Color</code> property is not read-only because you&#39;re setting it in the code you posted. The original issue would presumably have been that you were trying to assign a <code>System.Drawing.Color</code> value to a property that is not that type. That &quot;extra code&quot; is creating a value of the appropriate type, i.e. <code>Integer</code>, that represents the desired <code>System.Drawing.Color</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4877, "user_id": 741136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07f04ae4aad966f7ef35779315a54816?s=128&d=identicon&r=PG", "display_name": "SSS", "link": "https://stackoverflow.com/users/741136/sss"}, "is_accepted": false, "score": 0, "last_activity_date": 1488945308, "creation_date": 1488945308, "answer_id": 42662713, "question_id": 42662282, "link": "https://stackoverflow.com/questions/42662282/why-is-the-code-to-change-the-color-of-a-cell-in-vb-net-different-from-vba/42662713#42662713", "title": "Why is the code to change the color of a cell in vb.net different from vba?", "body": "<p>VB.NET stores colors differently to VBA. The <code>ToOle</code> function converts the VB.NET color to the equivalent VBA version. This is an example of <a href=\"https://en.wikipedia.org/wiki/Marshalling_(computer_science)\" rel=\"nofollow noreferrer\">marshalling</a>.</p>\n\n<p>(If you are interested, the \"OLE\" in \"ToOle\" stands for \"Object Linking and Embedding\" which is an older way for windows programs to communicate with each other)</p>\n"}, {"tags": [], "owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "is_accepted": false, "score": 0, "last_activity_date": 1488946721, "last_edit_date": 1488946721, "creation_date": 1488946379, "answer_id": 42662879, "question_id": 42662282, "link": "https://stackoverflow.com/questions/42662282/why-is-the-code-to-change-the-color-of-a-cell-in-vb-net-different-from-vba/42662879#42662879", "title": "Why is the code to change the color of a cell in vb.net different from vba?", "body": "<p>In VBA, you would set the color something like this:</p>\n\n<pre><code>Range(\"A1\").Interior.Color = Excel.XlRgbColor.rgbYellow\n' Or\nRange(\"A2\").Interior.Color = VBA.RGB(255, 255, 0)\n</code></pre>\n\n<p>Note that I purposely fully qualified the VBA code.  This is valid VBA code, but in a style you rarely see.</p>\n\n<p>In VB.Net you can do it like:</p>\n\n<pre><code>ws.Range(\"A1\").Interior.Color = Excel.XlRgbColor.rgbYellow\nws.Range(\"A2\").Interior.Color = Microsoft.VisualBasic.Information.RGB(255, 255, 0)\n</code></pre>\n\n<p>essentially the same code.  Or you can do it like you are currently doing.</p>\n\n<p>The net effect is the same; an integer value that represents color is being assigned to the Interior.Color property.  Either you use a function to compute that value, or you use a constant.   The various .Net functions are equivalents to the <code>VBA.RGB</code> function.  VBA knows nothing about colors defined as a <code>System.Drawing.Color</code>, hence a conversion function is necessary.</p>\n"}], "owner": {"reputation": 47, "user_id": 6785576, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9f924658d5a83bcd9bf54c5d7d6c3925?s=128&d=identicon&r=PG&f=1", "display_name": "Tm1985", "link": "https://stackoverflow.com/users/6785576/tm1985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 826, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488946721, "creation_date": 1488942717, "last_edit_date": 1531161705, "question_id": 42662282, "link": "https://stackoverflow.com/questions/42662282/why-is-the-code-to-change-the-color-of-a-cell-in-vb-net-different-from-vba", "title": "Why is the code to change the color of a cell in vb.net different from vba?", "body": "<p>This may sound dumb but can someone explain the reason why I need to include this extra code in vb.net that I don't need in VBA when changing the color of a cell.\nI wrote a program that creates and saves an excel file using the microsoft.office.interop reference. Here is my code:</p>\n\n<pre><code>Public Class Export_Excel_Class\nPublic excelapp As Microsoft.Office.Interop.Excel.Application\nPublic excelbook As Microsoft.Office.Interop.Excel.Workbook\nPublic excelsheet As Microsoft.Office.Interop.Excel.Worksheet\n\nPublic Sub newExcel()\n\n    excelapp = New Microsoft.Office.Interop.Excel.Application\n    excelbook = excelapp.Workbooks.Add()\n    excelsheet = excelbook.Sheets(\"sheet1\")\n    excelsheet.Range(\"A1\").Select()\n    excelsheet.Range(\"a1\").AddComment(\"hello\")\n    excelsheet.Range(\"a1:B10\").Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)\n    excelbook.SaveAs(\"C:\\Users\\DatOneBull\\Desktop\\Excel_Test\")\n    excelapp.Quit()\n\nEnd Sub\n</code></pre>\n\n<p>On the line that sets the color I had originally had tried     <code>excelsheet.Range(\"a1:B10\").Interior.Color =</code> \nand tried to set a color but the color proptery is read only. I found the solution online but there was no explanation. Can someone tell me what this section of code means and why it is able to set the color value of th range?</p>\n\n<pre><code>System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)\n</code></pre>\n"}, {"tags": ["xml", "vba", "user-interface", "ms-word"], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489278137, "creation_date": 1488935671, "last_edit_date": 1489278137, "question_id": 42661263, "link": "https://stackoverflow.com/questions/42661263/xml-error-handler", "title": "XML Error handler", "body": "<p>Using the Custom UI Editor I created the following code which works perfectly.</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n&lt;contextMenus&gt;\n&lt;contextMenu idMso=\"ContextMenuText\"&gt;\n&lt;!-- Add a commandbar button before \"Cut\" (at the top) --&gt;\n&lt;dynamicMenu id=\"SSYLingo\" insertBeforeMso=\"Cut\"\ngetVisible=\"GetMenuVisible\" \ngetLabel=\"GetMenuLabel\"\ngetImage=\"GetMenuIcon\"\ngetContent=\"SetSSYLingo\" /&gt;\n&lt;!-- Add a separator before \"Cut\" (below SSYLingo) --&gt;\n&lt;menuSeparator id=\"SSYSeptor\" insertBeforeMso=\"Cut\" /&gt;\n&lt;/contextMenu&gt;\n&lt;/contextMenus&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>I need it NOT to run, or at least not to crash out, when any of the get-procedures aren't available. The code is embedded in a Word 2010 template. The get-procedures aren't available while Word is in Design mode, and I should like to suppress the resulting error messages.\nI realise that this is probably a question solved easily by someone who knows the language. I don't. I am programming VBA and would appreciate some help with the XML here.</p>\n"}, {"tags": ["vba", "email", "outlook", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 7, "last_activity_date": 1584501636, "last_edit_date": 1592644375, "creation_date": 1488945209, "answer_id": 42662697, "question_id": 42661190, "link": "https://stackoverflow.com/questions/42661190/how-to-insert-text-into-outlook-email-editor-using-vba/42662697#42662697", "title": "How to insert text into Outlook email editor using VBA", "body": "<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/aa212203(v=office.11).aspx\" rel=\"nofollow noreferrer\">InsertBefore Method</a></em> or <em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff192427.aspx\" rel=\"nofollow noreferrer\">InsertAfter Method</a></em></p>\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196.aspx\" rel=\"nofollow noreferrer\">Inspector.WordEditor Property (Outlook)</a></em></p>\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff863939.aspx\" rel=\"nofollow noreferrer\">Application.ActiveInspector Method (Outlook)</a></em></p>\n<p>Example</p>\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Inspector As Outlook.Inspector\n    Dim wdDoc As Word.Document\n    Dim Selection As Word.Selection\n        \n\n    Set Inspector = Application.ActiveInspector()\n    Set wdDoc = Inspector.WordEditor\n    Set Selection = wdDoc.Application.Selection\n        Selection.InsertBefore Format(Now, &quot;DD/MM/YYYY&quot;)\n    \n    \n    Set Inspector = Nothing\n    Set wdDoc = Nothing\n    Set Selection = Nothing\nEnd Sub\n</code></pre>\n<hr />\n<blockquote>\n<p><a href=\"https://i.stack.imgur.com/F1yFh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F1yFh.png\" alt=\"enter image description here\" /></a></p>\n</blockquote>\n<hr />\n<p><em><strong>Reference to Microsoft Word xx.x Object Library</strong></em></p>\n<hr />\n<blockquote>\n<p><em>Go to Outlook VBA editor either by pressing <strong><code>&quot;Alt + F11&quot;</code></strong> keys or clicking on the <strong><code>&quot;Visual Basic&quot;</code></strong> button in the \u201cDeveloper\u201d ribbon.</em></p>\n<ul>\n<li><p><em><strong>1.</strong> In VBA editor window, click the &quot;Tools&quot; button in the menu bar.</em></p>\n</li>\n<li><p><em><strong>2.</strong> Then, from the drop down list, select the &quot;References&quot; option.</em></p>\n</li>\n</ul>\n<p><a href=\"https://i.stack.imgur.com/ezuo1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ezuo1.png\" alt=\"enter image description here\" /></a></p>\n<ul>\n<li><em><strong>3.</strong> In the dialog box, you can pull the scrolling bar down until you locate what you want, such as &quot;Microsoft Word XX.X Object Library&quot;.</em></li>\n</ul>\n<p><a href=\"https://i.stack.imgur.com/pGtnN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pGtnN.png\" alt=\"enter image description here\" /></a></p>\n</blockquote>\n"}], "owner": {"reputation": 303, "user_id": 4997466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ddd355ddc8c055d9a2c371330368e4?s=128&d=identicon&r=PG", "display_name": "Marty131", "link": "https://stackoverflow.com/users/4997466/marty131"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10155, "favorite_count": 0, "accepted_answer_id": 42662697, "answer_count": 1, "score": 3, "last_activity_date": 1592694802, "creation_date": 1488935205, "last_edit_date": 1592694802, "question_id": 42661190, "link": "https://stackoverflow.com/questions/42661190/how-to-insert-text-into-outlook-email-editor-using-vba", "title": "How to insert text into Outlook email editor using VBA", "body": "<p>I wish to create a macro that inserts the date into an email body which <strong>is currently open for editing, prior to sending</strong>. </p>\n\n<p>I am using Outlook 2013 on a Windows 7 machine.</p>\n\n<p>Desired workflow:</p>\n\n<ul>\n<li>Click reply to an email</li>\n<li>Within the email editor, place the text cursor within email body for desired position to insert text</li>\n<li>Execute the macro (by clicking on an icon in the email editor window's quick access toolbar). Macro will insert the date. </li>\n</ul>\n\n<p>(Assume the date has been stored as a string variable, i.e. the macro simply inserts a variable into the email body at a desired position).</p>\n\n<p>All Outlook VBA examples I have found for inserting text into an email body involve storing the active email's HTMLBody as a string, appending the desired text to that string, then creating a brand new email, and re-populating the to, cc, bcc, subject and htmlbody. I wish to avoid this, as it seems very clunky.</p>\n\n<p>Thank you in advance for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1488939214, "post_id": 42661184, "comment_id": 72449284, "body": "Why not put a pivot table in I7 and avoid VBA altogether?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1488937661, "last_edit_date": 1488937661, "creation_date": 1488937334, "answer_id": 42661484, "question_id": 42661184, "link": "https://stackoverflow.com/questions/42661184/how-to-add-text-in-a-specific-cells-by-vba/42661484#42661484", "title": "How to add Text in a specific cells by VBA", "body": "<p>Something like:</p>\n\n<pre><code>Dim arr, i\n\narr = Array(\"Bronze\",\"Silver\",\"Gold\",\"Platin\")'&lt;&lt; add the rest here...\n\nFor i = lbound(arr) to UBound(arr)\n    With Sheets(\"Download\").Range(\"I7\")\n       .Offset(i, 0).Value = arr(i)\n       .Offset(i, 1).Formula = \"= COUNTIF(C:C,\"\"\" &amp; arr(i) &amp; \"\"\")\"\n    End With\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1488943087, "creation_date": 1488943087, "answer_id": 42662340, "question_id": 42661184, "link": "https://stackoverflow.com/questions/42661184/how-to-add-text-in-a-specific-cells-by-vba/42662340#42662340", "title": "How to add Text in a specific cells by VBA", "body": "<pre><code>Sub TEST()\nConst kFml As String = \"=COUNTIF(C[-7],RC9)\"    'Use a constant to define the formula\nDim aValues As Variant\naValues = [{\"Bronze\",\"Silver\",\"Gold\",\"Platin\",\"PlPlus\",\"Ambass\"}]   'Use an array to contain all the values\n\n    With Sheets(\"Download\").Range(\"I7:I12\")                         'Work with the target range\n        .Columns(1).Value = WorksheetFunction.Transpose(aValues)    'Applies the values to 1st column `I`\n        .Columns(2).FormulaR1C1 = kFml                              'Applies the formula to 2nd column `J`\n    End With\n    Sheets(\"Download\").Range(\"J13\").Formula = \"= SUM(J7:J12)\"       'Enters total formula\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1390, "favorite_count": 1, "accepted_answer_id": 42662340, "answer_count": 2, "score": -2, "last_activity_date": 1488943087, "creation_date": 1488935170, "last_edit_date": 1488936551, "question_id": 42661184, "link": "https://stackoverflow.com/questions/42661184/how-to-add-text-in-a-specific-cells-by-vba", "title": "How to add Text in a specific cells by VBA", "body": "<p>I want to put in my sheets on the cell :</p>\n\n<pre><code>\"I7\" the word \"Bronze\"\n\"I8\" the word \"Silver\"\n\"I9\" the word \"Gold\"\n\"I10\" the word \"Platin\"\n</code></pre>\n\n<p>Because on the on the Cells \"J7\" I have a formula for the total of Bronze.\nwhich is this one : </p>\n\n<pre><code>Sheets(\"Download\").Select\nCells.Select\nRange(\"J7\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"Bronze\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J8\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"Silver\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J9\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"Gold\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J10\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"Platin\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J11\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"PlPlus\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J12\").Select\nActiveCell.Formula = \"= COUNTIF(C:C,\"\"Ambass\"\")\"\n\n  Sheets(\"Download\").Select\nCells.Select\nRange(\"J13\").Select\nActiveCell.Formula = \"= SUM(J7:J12)\"\n</code></pre>\n\n<p>It gaves me number but to make it easy I want to see what's the total of Bronze, silver etc...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1997, "user_id": 2058281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jppqe.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2058281/aaron"}, "edited": false, "score": 0, "creation_date": 1488942887, "post_id": 42661105, "comment_id": 72450307, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7675435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dc22a428e486f07fc16a4e858229af?s=128&d=identicon&r=PG&f=1", "display_name": "Pauline", "link": "https://stackoverflow.com/users/7675435/pauline"}, "edited": false, "score": 0, "creation_date": 1489009768, "post_id": 42663141, "comment_id": 72489249, "body": "Your answer was most helpful. Thank you so much for taking the time to help!"}], "tags": [], "owner": {"reputation": 24, "user_id": 7675109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SvFxk.jpg?s=128&g=1", "display_name": "IzDaBait", "link": "https://stackoverflow.com/users/7675109/izdabait"}, "is_accepted": true, "score": 0, "last_activity_date": 1488947933, "creation_date": 1488947933, "answer_id": 42663141, "question_id": 42661105, "link": "https://stackoverflow.com/questions/42661105/automated-batch-numbering-in-excel/42663141#42663141", "title": "Automated Batch Numbering in Excel", "body": "<p>Interesting Question. <em>One way</em> to handle this is to have a batch file export the excel (or vbs but batch is way easier) or you can do it manually then you may get the program to draw from the file</p>\n\n<p>ex: (Batch Code UTF-8)\n*</p>\n\n<pre><code>set RUNCHB=1\nset /p RUNCHB=&lt;\".\\Variables\\RUNCHB.dll\"\n::OR set /p RUNCHB=&lt;&lt;\".\\Variables\\RUNCHB.dll\"\necho %RUNCHB%\npause &gt;nul\nexit\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7675435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dc22a428e486f07fc16a4e858229af?s=128&d=identicon&r=PG&f=1", "display_name": "Pauline", "link": "https://stackoverflow.com/users/7675435/pauline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "closed_date": 1488968089, "accepted_answer_id": 42663141, "answer_count": 1, "score": -5, "last_activity_date": 1488947933, "creation_date": 1488934601, "last_edit_date": 1531164843, "question_id": 42661105, "link": "https://stackoverflow.com/questions/42661105/automated-batch-numbering-in-excel", "closed_reason": "Needs details or clarity", "title": "Automated Batch Numbering in Excel", "body": "<p>I have several columns with data, but I want a VBA script that can copy the data from Column 9 (Job Numbers), put it in Column 1 (Batch Numbers) and create automated batch numbering starting at 20. If it search through the existing data and find a previous batch 20 it must mark the next one as 21 and so on e.g. 15845-02-06/20....15845-02-06/21....15860-05-01/20, etc </p>\n"}, {"tags": ["excel", "is-empty", "vba"], "comments": [{"owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "edited": false, "score": 0, "creation_date": 1488935785, "post_id": 42661034, "comment_id": 72448390, "body": "So instead of using IsEmpty, I used len(trim(c)) = 0 .. This seemed to not work either as c pointed to a &quot;0&quot;, from what I understand, and the length &gt; 0. If you skip the variable and use the cell reference...len(trim(cell reference)) then it comes out as a 0, aka empty cell."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1488941462, "post_id": 42661034, "comment_id": 72449925, "body": "When you do <code>Dim a, b, c As Single</code> then only <code>c</code> is a <code>Single</code> and <code>a</code> and <code>b</code> are <code>Variant</code>."}], "owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488934108, "creation_date": 1488934108, "last_edit_date": 1531164843, "question_id": 42661034, "link": "https://stackoverflow.com/questions/42661034/empty-cell-inputs-are-numbers-coming-up-as-0-vba-help", "title": "Empty cell (inputs are numbers) coming up as 0 (VBA help!)", "body": "<p>I have three variables. (Dim a, b, c as Single)\nI have all 3 set to values in a worksheet (percentages). When those values are cleared, I would like to see IsEmpty() = True for all three. However, c shows a 0 when empty and I can't figure a way to get it to show as an empty cell. The other two variables work just fine. </p>\n\n<p>I'm assuming this is happening because VBA turns empty cells into 0's for cells with numbers as the designated inputs. What's the best way of finding empty cells for cases like this? </p>\n"}, {"tags": ["excel", "loops", "copy", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 2, "creation_date": 1488928502, "post_id": 42659798, "comment_id": 72446174, "body": "Please show whatever code you have and describe where you are stuck or seeing errors."}, {"owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488933017, "post_id": 42659798, "comment_id": 72447586, "body": "ok i tried adding what i have so far"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488935419, "post_id": 42659798, "comment_id": 72448278, "body": "Presumably Sheet3 has formulas which update based on whatever is in Sheet1 A9.  When you copy Sheet3 it will still have a formula linking back to Sheet1 A9 and the other formulas in the Sheet3 copy will also update based on Sheet1 A9 in the source workbook.  Do you want the Sheet3 copies to be values only so they don&#39;t link back to the source workbook?"}, {"owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488941271, "post_id": 42659798, "comment_id": 72449859, "body": "Yes that would be great. Same format thought"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "edited": false, "score": 0, "creation_date": 1488987998, "post_id": 42664469, "comment_id": 72476003, "body": "Thank you so much.. I really appreciate the help! One question.. at the end of the loop.. i get a Run time error 1004.. application-defined or object defined error... when i debug it points to .Name = ID_cell.Value2. in the code..  and the destination workbook has an extra Sheet 3 with #N/A errors. what do you think?"}, {"owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "edited": false, "score": 0, "creation_date": 1488988998, "post_id": 42664469, "comment_id": 72476840, "body": "It doesnt seem to be stopping at the blank cell (maybe because their is still a formula in that cell?) Should I use the count function to count how many IDs there are and then use that # to tell macro how many times to loop?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "edited": false, "score": 0, "creation_date": 1489013429, "post_id": 42664469, "comment_id": 72490955, "body": "I didn&#39;t consider that your ID#s may be formula derived.  What&#39;s the formula?  I&#39;ll need to add test(s) for any invalid formula results like blank, 0 or errors."}, {"owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "edited": false, "score": 0, "creation_date": 1489014026, "post_id": 42664469, "comment_id": 72491206, "body": "=IFERROR(INDEX(&#39;Data&#39;!$A:$D,MATCH(C2,&#39;Data&#39;!$D:$D,0),1),&quot;&quot;)"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "edited": false, "score": 0, "creation_date": 1489015927, "post_id": 42664469, "comment_id": 72491908, "body": "Code has been edited to test for <code>ID_cell &lt;&gt; &quot;&quot;</code>.  Please accept answer if this is now satisfying your requirements."}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 0, "last_activity_date": 1489015816, "last_edit_date": 1489015816, "creation_date": 1488954659, "answer_id": 42664469, "question_id": 42659798, "link": "https://stackoverflow.com/questions/42659798/excel-vba-loop-until-blank-cell-and-copy-worksheet-to-new-workbook/42664469#42664469", "title": "Excel VBA loop until blank cell and copy worksheet to new workbook", "body": "<p>There isn't much of your code left apart from ScreenUpdating, For and Next.  I've commented some steps where it may not be obvious why they are being done.  There's some additional comments about things you may not be familiar with.</p>\n\n<pre><code>Sub CopySheetsToNewWB()\nDim ID_cell As Range 'will be used to control loop flow\nDim SourceWB As Workbook\nDim DestWB As Workbook\nDim ControlSheet As Worksheet 'sheet with ID#s\nDim IDsToCopy As Range\nDim SheetToCopy As Worksheet\nDim PathSeparator As String\nDim SaveName As String\n\n    Application.ScreenUpdating = False\n    Set SourceWB = ThisWorkbook\n    'test if file saved on device/network or cloud and set separator\n    'because new file will be saved in same location\n    If InStr(1, SourceWB.Path, \"\\\") &gt; 0 Then\n        PathSeparator = \"\\\"\n    Else\n        PathSeparator = \"/\"\n    End If\n    Set ControlSheet = SourceWB.Sheets(\"Sheet2\")\n    Set SheetToCopy = SourceWB.Sheets(\"Sheet3\")\n    With ControlSheet\n        Set IDsToCopy = Range(.[A2], .[A2].End(xlDown))\n    End With\n    For Each ID_cell In IDsToCopy\n        'As ID_Cell is based on an IFERROR(...,\"\") formula, test if blank.\n        If ID_cell &lt;&gt; \"\" Then\n            With SourceWB 'allows subsequent commands without having to specify it\n                .Sheets(\"Sheet1\").[A9] = ID_cell.Value2\n                'Test if DestWB already exists\n                If Not DestWB Is Nothing Then\n                    'it's not nothing so it must be something (i.e. it exists)\n                    SheetToCopy.Copy after:=DestWB.Sheets(DestWB.Sheets.Count)\n                Else\n                    'create DestWB and save it in the same location as SourceWB\n                    'using SourceWB name with date appended and SourceWB file extension.\n                    'INSTR is similar to FIND in Excel but doesn't error if search\n                    'string is not found - just returns 0.  INSTRREV finds position of\n                    'the last instance of searched string (in case of \".\"s in filename).\n                    SaveName = .Path &amp; PathSeparator &amp; Left(.Name, InStr(1, .Name, \".\") - 1) _\n                    &amp; \" as at \" &amp; _\n                    Format(Date, \"yyyymmdd\") &amp; _\n                    Right(.Name, Len(.Name) - InStrRev(.Name, \".\") + 1)\n                    SheetToCopy.Copy\n                    ActiveWorkbook.SaveAs Filename:=SaveName, FileFormat:=SourceWB.FileFormat\n                    Set DestWB = ActiveWorkbook\n                End If\n            End With\n            'Copied sheet may have formulas linking to SourceWB so change to values\n            'and as it's still named \"Sheet3\", rename it after ID#\n            With DestWB.Sheets(\"Sheet3\")\n                .UsedRange.Copy\n                .[A1].PasteSpecial xlPasteValues\n                .Name = ID_cell.Value2\n            End With\n        End If\n    Next\n    DestWB.Save\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>All variables are declared - you can and should set your VBA editor to \"Require Variable Declaration\" (under Tools -> Options).  This will insert \"Option Explicit\" at the top of every new module.</p>\n\n<p>There are no \"Select\" or \"Activate\" commands.  You can usually avoid them by using With...EndWith structures or fully qualifying objects.</p>\n\n<p>Square bracket range references - [A2] is the same as Range(\"A2\").</p>\n\n<p>Any questions, post a comment.</p>\n"}], "owner": {"reputation": 3, "user_id": 7675062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7b0be6c9d325da74f1acb48a45608?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/7675062/jeremy-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 1, "accepted_answer_id": 42664469, "answer_count": 1, "score": 0, "last_activity_date": 1489015816, "creation_date": 1488926817, "last_edit_date": 1531161705, "question_id": 42659798, "link": "https://stackoverflow.com/questions/42659798/excel-vba-loop-until-blank-cell-and-copy-worksheet-to-new-workbook", "title": "Excel VBA loop until blank cell and copy worksheet to new workbook", "body": "<p>I have a list of ID#s in column A on Sheet 2 (starting at cell A2).  </p>\n\n<p>I am trying to create a macro to loops through each ID #, copies it into cell A9 on Sheet 1 and then copies Sheet 3 into a new workbook. </p>\n\n<p>For each ID#, Sheet 3 should be copied into that same new workbook under a different worksheet/tab.  </p>\n\n<p>I am not a coder so all I have is what I can find on Google and I can't seem to get everything in order.  Any and all help is greatly appreciated. </p>\n\n<p>This is what I have so far.. what i cant figure out is how to end the loop at blank cell, how to get the macro to revert back to the source after copying worksheet to new workbook, and then how to add the subsequent loops to that now existing workbook.  </p>\n\n<pre><code>    Sub Test1()\n  Dim x As Integer\n  Application.ScreenUpdating = False\n  ' Set numrows = number of rows of data.\n  NumRows = Range(\"a2\", Range(\"a2\").End(xlDown)).Rows.Count\n  ' Select cell a2.\n  Range(\"a2\").Select\n  ' Establish \"For\" loop to loop \"numrows\" number of times.\n  For x = 1 To NumRows\n     Sheets(\"Sheet 1\").Range(\"A9\").Value = ActiveCell\n      Sheets(\"Sheet 3\").Copy\n     ' Selects cell down 1 row from active cell.\n     ActiveCell.Offset(1, 0).Select\n  Next\n  Application.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1488933592, "post_id": 42659628, "comment_id": 72447775, "body": "Do you have manual page breaks? If not, what happens when the text shifts upwards due to deletion?"}], "answers": [{"comments": [{"owner": {"reputation": 2104, "user_id": 6174268, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/753dfea908c2215fbf8d7dc74ef65ea5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayyoub", "link": "https://stackoverflow.com/users/6174268/ayyoub"}, "edited": false, "score": 0, "creation_date": 1489000650, "post_id": 42676430, "comment_id": 72484261, "body": "Thank you so much you just saved my life, Thank you so much, even though that removing blank pages will be a nice addition but anyway thank you so much,"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 2104, "user_id": 6174268, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/753dfea908c2215fbf8d7dc74ef65ea5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayyoub", "link": "https://stackoverflow.com/users/6174268/ayyoub"}, "edited": false, "score": 0, "creation_date": 1489003348, "post_id": 42676430, "comment_id": 72485862, "body": "I updated the code to delete blank (empty) pages that contain only a page break. If there is a manual page break at the end of the document, then there will technically a blank page that follows. You can check for that in VBA by going to the end of the document, checking if a paragraph with only one character, then backing up to the prior paragraph and checking if it is a page break. Good Luck!"}, {"owner": {"reputation": 2104, "user_id": 6174268, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/753dfea908c2215fbf8d7dc74ef65ea5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayyoub", "link": "https://stackoverflow.com/users/6174268/ayyoub"}, "edited": false, "score": 0, "creation_date": 1489006164, "post_id": 42676430, "comment_id": 72487347, "body": "Thank you for helping me out once again :), but the only wrong thing about this is that it leaves a blank page in the bottom... it perfectly removes the blank pages at the center and it does remove blank lines at the but once again it leaves the a blank page at the botom,,, THANK you Wayne"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 2104, "user_id": 6174268, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/753dfea908c2215fbf8d7dc74ef65ea5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayyoub", "link": "https://stackoverflow.com/users/6174268/ayyoub"}, "edited": false, "score": 0, "creation_date": 1489028867, "post_id": 42676430, "comment_id": 72495552, "body": "OK, I think I&#39;m Dunn (er, done). I added code to delete the final manual page-break so there is no blank page at the end...."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 1, "last_activity_date": 1489028785, "last_edit_date": 1489028785, "creation_date": 1488989736, "answer_id": 42676430, "question_id": 42659628, "link": "https://stackoverflow.com/questions/42659628/how-to-remove-top-blank-lines-in-vba-office-word/42676430#42676430", "title": "How to remove Top blank lines in VBA office word", "body": "<p>UPDATE 2: I figured out how to delete the last manual page-break in the document.</p>\n\n<p>UPDATE 1: I modified the following code to delete blank pages. If a blank page consists of any or a number of blank lines (and not other text), then the original code will delete all of those since they technically start at the top of a page. Then in the second pass it will look just for Page Breaks as the only 'paragraph' on the page. If found, it will be deleted.  </p>\n\n<p>I think the following may solve the issue of deleting the blanks at the top of each page. Keep in mind that Word will continue to 'redraw' the page as text is deleted. But more importantly, a paragraph can be any size which means 1, 2, or 20 'lines'. </p>\n\n<pre><code>Option Explicit\n\nSub RemoveBlankParas()\n    Dim oDoc        As Word.Document\n    Dim para        As Word.Paragraph\n    Dim i           As Integer\n    Dim oRng        As Range\n    Dim lParas      As Long\n    Dim lEnd        As Long\n    Dim lDeleted    As Long\n\n    Set oDoc = ActiveDocument\n    lParas = oDoc.Paragraphs.Count          ' Total paragraph count\n    'Debug.Print \"Total paragraph Count: \" &amp; lParas\n\n    ' Loop thru each page\n    i = 0       ' Reset starting page - if I'm testing\n    Do\n        ' Select one page\n        i = i + 1\n        Selection.GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Count:=i\n        Set oRng = Selection.Range\n        oRng.End = Selection.Bookmarks(\"\\Page\").Range.End\n        oRng.Select\n\n        Debug.Print \"Range Count: \" &amp; oRng.Paragraphs.Count        ' Paragraphs in this page range\n        lEnd = lEnd + oRng.Paragraphs.Count                         ' Keep track of how many processed\n\n        For Each para In oRng.Paragraphs\n            'Debug.Print \"Par Len:\" &amp; vbTab &amp; Len(para.Range.Text) &amp; \" | \" &amp; Left(para.Range.Text, Len(para.Range.Text) - 1)\n            If Len(para.Range.Text) = 1 Then\n                para.Range.Delete\n                lDeleted = lDeleted + 1\n            Else        ' If not blank, then delete o more in this page!\n                Exit For\n            End If\n        Next para\n\n        ' Calc how many paragraphs processed\n        If lDeleted + lEnd &gt;= lParas Then       ' If more that we started with, let's call it a day!\n            Exit Do\n        End If\n    Loop\n\n    ' You can add code to loop thru each page and if only one paagraph, ...\n    ''' Check if 'empty' page\n\n    ' Get latest count...\n    lParas = oDoc.Paragraphs.Count          ' Total paragraph count\n\n    lDeleted = 0        ' reset stuff - in case\n    lEnd = 0\n    i = 0\n    Do\n        i = i + 1\n        Selection.GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Count:=i\n        Set oRng = Selection.Range\n        oRng.End = Selection.Bookmarks(\"\\Page\").Range.End\n        oRng.Select\n\n        Debug.Print \"Range Count: \" &amp; oRng.Paragraphs.Count        ' Paragraphs in this page range\n        lEnd = lEnd + oRng.Paragraphs.Count\n        If oRng.Paragraphs.Count = 1 Then\n            If oRng.Paragraphs(1).Range.Text = Chr(12) &amp; Chr(13) Then\n                oRng.Paragraphs(1).Range.Delete\n                lDeleted = lDeleted + 1\n                i = i - 1\n            'ElseIf Len(oRng.Paragraphs(1).Range.Text) = 1 Then\n            '    oRng.Paragraphs(1).Range.Delete\n            '    lDeleted = lDeleted + 1\n            '    i = i - 1\n            End If\n        End If\n        If lEnd &gt;= lParas Then\n            Exit Do\n        End If\n    Loop\n\n    ' Finally!!!  Deal with the lingering final page-break!\n    Selection.GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Count:=999      ' Go to Last Page.\n    Set oRng = Selection.Range                                              ' Select the end..\n    oRng.MoveStart wdCharacter, -3                                          ' Backup 3 characters\n    If Left(oRng.Text, 2) = Chr(13) &amp; Chr(12) Then                          ' Should be 13+12\n        oRng.Text = \"\"                                                      ' Remove that thingy!\n    End If\n\n    Set para = Nothing\n    Set oDoc = Nothing\n    Exit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2104, "user_id": 6174268, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/753dfea908c2215fbf8d7dc74ef65ea5?s=128&d=identicon&r=PG&f=1", "display_name": "Ayyoub", "link": "https://stackoverflow.com/users/6174268/ayyoub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "accepted_answer_id": 42676430, "answer_count": 1, "score": 0, "last_activity_date": 1489028785, "creation_date": 1488926012, "last_edit_date": 1488977551, "question_id": 42659628, "link": "https://stackoverflow.com/questions/42659628/how-to-remove-top-blank-lines-in-vba-office-word", "title": "How to remove Top blank lines in VBA office word", "body": "<p>How i can delete <strong>Only</strong> the blank lines at the top of each page in VBA word 2016. </p>\n\n<p>I tried to do something like this</p>\n\n<pre><code>Sub RemoveBlankParas()\n    Dim para As Paragraph\n\n    For Each para In ActiveDocument.Paragraphs\n        If Len(para.Range.Text) = 1 Then\n            'only the paragraph mark, so..\n            para.Range.Delete\n        End If\n    Next para\nEnd Sub\n</code></pre>\n\n<p>But the problem with that code is that it removes all blank lines not only at TOP of the page but also at the center or bottom of the page.</p>\n\n<p>Also if you can implement removing blank pages(Pages with no words on it) in the macro that will be fantastic. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "edited": false, "score": 0, "creation_date": 1488934367, "post_id": 42660235, "comment_id": 72447968, "body": "That works!!  Thanks so much for the explanation as well.  New to this - so understanding why will help with future work."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "edited": false, "score": 0, "creation_date": 1488935504, "post_id": 42660235, "comment_id": 72448306, "body": "Good, and thank you for accepting the answer - so many people don&#39;t."}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 1, "last_activity_date": 1488929017, "creation_date": 1488929017, "answer_id": 42660235, "question_id": 42659625, "link": "https://stackoverflow.com/questions/42659625/counta-function-in-loop/42660235#42660235", "title": "CountA Function in Loop", "body": "<p>You just need to qualify the columnCount otherwise it will always look at the ActiveSheet.</p>\n\n<p>Change</p>\n\n<p><code>columnCount = WorksheetFunction.CountA(Range(\"5:5\")) + 1</code></p>\n\n<p>to</p>\n\n<p><code>columnCount = WorksheetFunction.CountA(ws.Range(\"5:5\")) + 1</code></p>\n"}], "owner": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 42660235, "answer_count": 1, "score": 0, "last_activity_date": 1488929017, "creation_date": 1488925996, "question_id": 42659625, "link": "https://stackoverflow.com/questions/42659625/counta-function-in-loop", "title": "CountA Function in Loop", "body": "<p>I have the following code that adds checkboxes to worksheets with the text \"benefits\" in the sheet name.</p>\n\n<p>I need a checkbox in row 3 for each column that has text in row 5.  Each worksheet will have a different number of columns.</p>\n\n<p>The code below works, but sets and then uses the columnCount for the first worksheet for all the worksheets.</p>\n\n<p>I think I have the right code, but have it placed in the wrong order??</p>\n\n<pre><code>    'Checks for the text \"Benefits\" in the sheetname.\n    'If true then runs AddCheckBoxesRange Macro to add selection checkboxes for each plan.\n    Sub CheckSheets()\n        Dim sh As Worksheet\n        Application.ScreenUpdating = False\n        For Each sh In ActiveWorkbook.Sheets\n            If LCase$(sh.Name) Like \"*benefits*\" Then Call AddCheckBoxesRange(sh)\n        Next sh\n        Application.ScreenUpdating = True\n    End Sub\n\n\n'Macro CheckSheets looks for the text benefits in sheetname, if it exists it calls this macro\n    Sub AddCheckBoxesRange(ws As Worksheet)\n    'add Form checkboxes\n    Dim c As Range\n    Dim myCBX As CheckBox\n    Dim rngCB As Range\n    Dim strCap As String\n\n    Dim columnCount As Integer\n    columnCount = WorksheetFunction.CountA(Range(\"5:5\")) + 1\n    Set rngCB = ws.Range(\"B3\", ws.Cells(3, columnCount))\n\n    strCap = \"Select Plan\"\n\n    For Each c In rngCB\n      With c\n        Set myCBX = ws.CheckBoxes.Add _\n          (Top:=.Top, Width:=.Width, _\n           Height:=.Height, Left:=.Left)\n      End With\n      With myCBX\n        .Name = \"cbx_\" &amp; c.Address(0, 0)\n        .LinkedCell = c.Offset(37, 0) _\n            .Address(external:=True)\n        .Caption = strCap\n      End With\n    Next c\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "user-experience"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488925945, "post_id": 42659538, "comment_id": 72445104, "body": "<code>Countif()</code> and/or <code>Countifs()</code>? What do you mean by &quot;Total&quot;, what are you asking for? Can you please clarify what you&#39;re looking to do, and what you&#39;ve tried already?  What does this have to do with &quot;user-experience&quot;?"}, {"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488927341, "post_id": 42659538, "comment_id": 72445733, "body": "@BruceWayne. First of all I thought it was clear in my question. In column C I have different Status: Bronze, silver, gold etc... Then I want to put on the same sheet but in range J7 the total of cell written Bronze. I want on J7 written &quot; Bronze:&quot; and then the number of cell with bronze... same in J8 but with silver, J9 with gold etc.. and in J13 the SUM of all of them"}, {"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1488927398, "post_id": 42659538, "comment_id": 72445762, "body": "@BruceWayne, I put user experience because I tought you needed experience to find the solution..."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488929303, "post_id": 42659538, "comment_id": 72446481, "body": "In which row in column C does your list start?  Also please show whatever code you already have and describe what is wrong with it - error codes, unexpected outputs."}, {"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1488933443, "post_id": 42659538, "comment_id": 72447716, "body": "@MarkFitzgerald, It start in C2 until there is no more word.. every week it changes so it need to be automatic. In column A I have Room Number, In column B I have the name of the Guest, In column C I have the status (Bronze, Silver, Gold etc...) So I need to know how many guest are Bronze etc.... I want to report the result of each statut on J7, J8 etc.. but not only the number.. As well what status is for this Total...."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 1, "creation_date": 1488934012, "post_id": 42660914, "comment_id": 72447888, "body": "In excel Formula, I know how to do it... but it is on vba that is more difficult..."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1488934791, "post_id": 42660914, "comment_id": 72448096, "body": "@JohanEs <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;J1&quot;).Formula = &quot;=COUNTIFS(C:C,C2)&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 1, "creation_date": 1488935324, "post_id": 42660914, "comment_id": 72448248, "body": "How do we put a Name in front of the Result ? it can be in the Cell Before. For Example : ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;J7&quot;).Formula = &quot;=COUNTIFS(C:C,&quot;&quot;BRONZE&quot;&quot;)&quot;  this will give me a number but in front of this result I want the Word Bronze or in the cell before which is I7 in this case"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1488933312, "creation_date": 1488933312, "answer_id": 42660914, "question_id": 42659538, "link": "https://stackoverflow.com/questions/42659538/recap-of-number-of-word-in-a-different-cell/42660914#42660914", "title": "Recap of Number of word in a different Cell", "body": "<p>For Excel Formula Try this on <strong><code>J1</code></strong> </p>\n\n<p><strong><code>=\"Total of \" &amp; COUNTIFS(C:C,C1) &amp; \" \" &amp; C1</code></strong></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1488936724, "post_id": 42661245, "comment_id": 72448619, "body": "THANK YOU !!! I just to figure it out, How to change color each cell to make it Design... lol"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1488937078, "post_id": 42661245, "comment_id": 72448719, "body": "@JohanEs Record a macro setting the colours manually.  Then look at that code and find what colour numbers it used.  Then modify the code in my answer by adding extra lines to say things like <code>.Range(&quot;J7&quot;).Interior.Color = 49407</code> etc."}, {"owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1488937825, "post_id": 42661245, "comment_id": 72448917, "body": "If I want to change the font Color: I can put :                      Sheets(&quot;Download&quot;).Select     Range(&quot;J7:J14&quot;).Cell.Font.Color = 2     I don&#39;t want something complicated just to change the Font in White."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "edited": false, "score": 0, "creation_date": 1488939544, "post_id": 42661245, "comment_id": 72449369, "body": "@JohanEs There is no need to use <code>Select</code> - the two statements in your previous comment can be written as <code>Sheets(&quot;Download&quot;).Range(&quot;J7:J14&quot;).Font.Color = 2</code> (or, within the <code>With</code> block in my code, as <code>.Range(&quot;J7:J14&quot;).Font.Color = 2</code> - the leading <code>.</code> says to use the object of the <code>With</code>).  Avoid <code>Select</code> and <code>Activate</code> as much as possible.  See <a href=\"http://stackoverflow.com/q/10714251/6535336\">this</a>."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1488935560, "creation_date": 1488935560, "answer_id": 42661245, "question_id": 42659538, "link": "https://stackoverflow.com/questions/42659538/recap-of-number-of-word-in-a-different-cell/42661245#42661245", "title": "Recap of Number of word in a different Cell", "body": "<p>I am not sure why you are doing this in VBA, but because you insist it needs to be:</p>\n\n<pre><code>Sub CountThem\n    With Worksheets(\"Download\")\n        .Range(\"J7\").Value = \"Bronze: \" &amp; Application.CountIf(.Range(\"C:C\"), \"Bronze\")\n        .Range(\"J8\").Value = \"Silver: \" &amp; Application.CountIf(.Range(\"C:C\"), \"Silver\")\n        .Range(\"J9\").Value = \"Gold: \" &amp; Application.CountIf(.Range(\"C:C\"), \"Gold\")\n        .Range(\"J10\").Value = \"Platinum: \" &amp; Application.CountIf(.Range(\"C:C\"), \"PLATIN\")\n        .Range(\"J11\").Value = \"Platinum Plus: \" &amp; Application.CountIf(.Range(\"C:C\"), \"PLPLUS\")\n        .Range(\"J12\").Value = \"Ambassador: \" &amp; Application.CountIf(.Range(\"C:C\"), \"AMBASS\")\n        .Range(\"J13\").Value = \"Total: \" &amp; _\n                              (Application.CountIf(.Range(\"C:C\"), \"Bronze\") + _\n                               Application.CountIf(.Range(\"C:C\"), \"Silver\") + _\n                               Application.CountIf(.Range(\"C:C\"), \"Gold\") + _\n                               Application.CountIf(.Range(\"C:C\"), \"PLATIN\") + _\n                               Application.CountIf(.Range(\"C:C\"), \"PLPLUS\") + _\n                               Application.CountIf(.Range(\"C:C\"), \"AMBASS\"))\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7627289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a49f340c143173f4c65cbda02cb9751?s=128&d=identicon&r=PG&f=1", "display_name": "JohanEs", "link": "https://stackoverflow.com/users/7627289/johanes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1488952014, "accepted_answer_id": 42660914, "answer_count": 2, "score": -2, "last_activity_date": 1488935560, "creation_date": 1488925592, "last_edit_date": 1488932791, "question_id": 42659538, "link": "https://stackoverflow.com/questions/42659538/recap-of-number-of-word-in-a-different-cell", "closed_reason": "Needs details or clarity", "title": "Recap of Number of word in a different Cell", "body": "<p>In my sheet \"Download\". </p>\n\n<p>In Column C I have:</p>\n\n<pre><code>BRONZE\nSILVER\nSILVER\nBRONZE\nGOLD\nPLATIN\nPLPLUS\nAMBASS\nPLPLUS \netc...\n</code></pre>\n\n<p>What I Would Like to do is </p>\n\n<pre><code>in the cell J7: Bronze: \"Total of Bronze\"  \nin the cell J8: Silver: \"Total of Silver\"  \nin the cell J9: Gold: \"Total of Gold\"  \nin the cell J10:Platinum \"Total of PLATIN\" \nin the cell J11:Platinum Plus \"Total of PLPLUS\" \nin the cell J12:Ambassador \"Total of AMBASS\" \nin the cell J13:Total \"Total of Bronze, silver, gold, platin, plplus &amp; Ambass\"\n</code></pre>\n\n<p>I don't think for someone who knows well vba it will be difficult to answer.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1488925115, "post_id": 42659386, "comment_id": 72444773, "body": "Title nailed it.  Everything that looks like <code>wsgr(Cells(i, 2)).Value</code> should look like <code>wsgr.Cells(i, 2).Value</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1488926226, "post_id": 42659386, "comment_id": 72445236, "body": "^^ that. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (a free &amp; open-source VBE add-in I&#39;m working on) can help you locate all unqualified / implicit active sheet references... and fix your indentation too ;-)"}, {"owner": {"reputation": 1, "user_id": 5457217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c82b0a4c9ba01f49946b002a42d7571?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne Cabral", "link": "https://stackoverflow.com/users/5457217/shayne-cabral"}, "edited": false, "score": 0, "creation_date": 1488979883, "post_id": 42659386, "comment_id": 72470010, "body": "thank you so much! i knew I wasn&#39;t too far off!"}], "owner": {"reputation": 1, "user_id": 5457217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c82b0a4c9ba01f49946b002a42d7571?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne Cabral", "link": "https://stackoverflow.com/users/5457217/shayne-cabral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488924933, "creation_date": 1488924933, "question_id": 42659386, "link": "https://stackoverflow.com/questions/42659386/runtime-error-1004-cells-not-fully-qualified-im-assuming", "title": "Runtime error 1004. cells not fully qualified I&#39;m assuming", "body": "<p>Right off the bat, I'm not stellar at VBA, and the code below may be riddled with errors in addition to what's stopping me from continuing. Basically I am trying to build a tree (not unlike a BOM) with data found in various other sheets in the workbook. Below is my code: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim acreg As String, eonum As String\nDim wb As Workbook, wsrpt As Range\nDim wsgr As Range, wsassy As Range, wspd As Range\n\n\nDim i As Integer, j As Integer, khor As Integer, x As Integer\nDim kvert As Integer, j2 As Integer\n\nDim parenttemp As String, childtemp As String\n\nSet wb = ThisWorkbook\n\nacreg = \"EK-PPT\"\neonum = \"E-123-0\"\nSet wsgr = wb.Worksheets(\"GEN_ARR\").UsedRange\nSet wsassy = wb.Worksheets(\"ASSY\").UsedRange\nSet wspd = wb.Worksheets(\"PART_DETAIL\").UsedRange\nSet wsrpt = wb.Worksheets(\"REPORT\").UsedRange\n\ni = 1\nj = 1\nj2 = 1\nkhor = 3\nkvert = 1\nx = 1\n\nWhile wsgr(Cells(i, 2)).Value &lt;&gt; \"\"\nIf wsgr(Cells(i, 2)).Value = eonum And wsgr(Cells(i, 5)).Value = acreg Then\n    parenttemp = wsgr(Cells(i, 1)).Value\n    wsrpt(Cells(khor, kvert)).Value = parenttemp\n    kvert = kvert + 1\n    i = i + 1\n\n    While wsassy(Cells(j, 1)).Value &lt;&gt; \"\"\n        If wsassy(Cells(j, 2)).Value = parenttemp Then\n                childtemp = wsassy(Cells(j, 1)).Value\n                wsrpt(Cells(khor, kvert)).Value = childtemp\n                parenttemp = childtemp\n                kvert = kvert + 1\n                j = j + 1\n\n            While wsassy(Cells(j2, 1)).Value &lt;&gt; \"\"\n            If wsassy(Cells(j2, 2)).Value = parenttemp Then\n                childtemp = wsassy(Cells(j2, 1)).Value\n                wsrpt(Cells(khor, kvert)).Value = childtemp\n                parenttemp = childtemp\n                kvert = kvert + 1\n                j2 = 1\n            Else\n                j2 = j2 + 1\n            End If\n            Wend\n\n            While wspd(Cells(x, 1)).Value &lt;&gt; \"\"\n            If wspd(Cells(x, 2).Value) = childtemp Then\n                childtemp = wspd(Cells(x, 1)).Value\n                wsrpt(Cells(khor, kvert)).Value = childtemp\n                khor = khor + 1\n                x = x + 1\n            Else\n                x = x + 1\n            End If\n            Wend\n        Else\n            j = j + 1\n        End If\n        Wend\n\nElse\n    i = i + 1\nEnd If\nWend\n\n\nEnd Sub\n</code></pre>\n\n<p>I think this is because my cells aren't fully qualified because of sheet activation. is activating sheets necessary? Or can we point to these cells without having to activate? </p>\n\n<p>any help would be greatly appreciated! thanks!  </p>\n"}]