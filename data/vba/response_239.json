[{"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1565218286, "post_id": 57403157, "comment_id": 101287822, "body": "Look at TEXTJOIN. If your version of Excel does not support it, there are questions here on SO about how to implement a UDF version of it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1565218405, "post_id": 57403157, "comment_id": 101287847, "body": "here is a udf that mimics TEXTJOIN: <a href=\"https://stackoverflow.com/questions/39532189/vlookup-with-multiple-criteria-returning-values-in-one-cell\" title=\"vlookup with multiple criteria returning values in one cell\">stackoverflow.com/questions/39532189/&hellip;</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1565218499, "post_id": 57403157, "comment_id": 101287865, "body": "@ScottCraner thank you for providing that link, I was too lazy to look for it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565218520, "post_id": 57403157, "comment_id": 101287875, "body": "@BigBen I have it starred so I can find it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1565218540, "post_id": 57403157, "comment_id": 101287885, "body": "@ScottCraner and now I do too lol."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1565218589, "post_id": 57403157, "comment_id": 101287897, "body": "BTW, the formula would be <code>=TEXTJOIN(&quot;, &quot;,TRUE,C5:C100)</code>"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565218291, "creation_date": 1565218130, "last_edit_date": 1565218291, "question_id": 57403157, "link": "https://stackoverflow.com/questions/57403157/copy-all-the-value-filled-cells-in-a-column-into-one-cell", "title": "Copy all the value filled cells in a column into one cell", "body": "<p>I would like to be able to copy and paste all of the value filled cells in column C of the worksheet into one cell with \", \" dividing each of the copied cells.</p>\n\n<p>This is what I have now. Works but the amount of filled cells varies.</p>\n\n<pre><code>=$C$5&amp;\", \"&amp;$C$6&amp;\", \"&amp;$C$7&amp;\", \"&amp;$C$8&amp;\", \"&amp;$C$9&amp;\", \"&amp;$C$10&amp;\", \"&amp;$C$11&amp;\", \"&amp;$C$12&amp;\", \"&amp;$C$13&amp;\", \"&amp;$C$14&amp;\", \"&amp;$C$15&amp;\", \"&amp;$C$16&amp;\", \"&amp;$C$17&amp;\", \"&amp;$C$18&amp;\", \"&amp;$C$19&amp;\", \"&amp;$C$20&amp;\", \"&amp;$C$21&amp;\", \"&amp;$C$22&amp;\", \"&amp;$C$23&amp;\", \"&amp;$C$24&amp;\", \"&amp;$C$25&amp;\", \"&amp;$C$26&amp;\", \"&amp;$C\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1565216148, "post_id": 57402829, "comment_id": 101287325, "body": "what is the value of <code>columna</code> ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1565216791, "post_id": 57402829, "comment_id": 101287481, "body": "put a <code>.</code> in front of the <code>Cells(..</code>: <code>.Range(.Cells(renglon, columna), .Cells(renglon + 1, 16)).Merge</code>"}], "owner": {"reputation": 1, "user_id": 11898655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VV4ImgKDVJI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcQ9DKJb60GjHa5NpVuDYEVFvi22w/photo.jpg?sz=128", "display_name": "Gran Calabaza", "link": "https://stackoverflow.com/users/11898655/gran-calabaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1565223596, "answer_count": 0, "score": 0, "last_activity_date": 1565247205, "creation_date": 1565215517, "last_edit_date": 1565247205, "question_id": 57402829, "link": "https://stackoverflow.com/questions/57402829/how-to-fix-error-1004-wehn-merging-cells-using-excel-vba", "closed_reason": "Duplicate", "title": "How to fix &quot;error 1004&quot; wehn merging cells using Excel-VBA?", "body": "<p>I'm using Excel 2016.<br><br>\nI wrote a macro that shows pictures and information about some colleagues.<br><br>\nIn order to satisfy my boss' wishes, I need to merge some cells.</p>\n\n<p>Some references that I've consulted are:<br>\n<a href=\"https://powerspreadsheets.com/excel-vba-merge-cells/\" rel=\"nofollow noreferrer\">https://powerspreadsheets.com/excel-vba-merge-cells/</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.mergecells\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.mergecells</a><br>\n<a href=\"https://analysistabs.com/vba-code/range/m/merge/\" rel=\"nofollow noreferrer\">https://analysistabs.com/vba-code/range/m/merge/</a><br></p>\n\n<p>The VBA debugger stops on the second line of the next code and returns the 1004 error:</p>\n\n<pre><code>With Worksheets(destino)\n    .Range(Cells(renglon, columna), Cells(renglon + 1, 16)).Merge\n    .Cells(renglon, columna).VerticalAlignment = xlVAlignCenter\n    .Cells(renglon, columna).HorizontalAlignment = xlHAlignCenter\n    .Cells(renglon, columna).Font.Bold = True\n    .Cells(renglon, columna).Font.Size = 20\n    .Cells(renglon, columna).Interior.color = gris\n    .Cells(renglon, columna).Value = criterioActual\nEnd With\n</code></pre>\n\n<p>I've tested this code always with the same data. Sometimes it works, sometimes it doesn't.</p>\n\n<p>Could you please share to me your thoughts about it?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 1, "last_activity_date": 1565214479, "creation_date": 1565214479, "answer_id": 57402698, "question_id": 57402558, "link": "https://stackoverflow.com/questions/57402558/move-items-based-on-multiple-values-of-sendername/57402698#57402698", "title": "Move items based on multiple values of SenderName", "body": "<p>I can't test it because I don't have Outlook on my home computer but I recommend looping through an Array of Strings that contains your search terms:</p>\n\n<pre><code>Sub MoveItems()\n    Dim myNameSpace As Outlook.Namespace\n    Dim myInbox As Outlook.Folder\n    Dim myDestFolder As Outlook.Folder\n    Dim myItems As Outlook.Items\n    Dim myItem As Object\n\n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myItems = myInbox.Items\n    Set myDestFolder = myInbox.Folders(\"test\")\n    Dim varSearchTerm As Variant: For Each varSearchTerm In Array(\"ABC Sprockets\", \"DFG Widgets\", \"XYZ Zippers\")\n    Set myItem = myItems.Find(\"[SenderName] = '\" &amp; varSearchTerm &amp; \"'\")\n        While TypeName(myItem) &lt;&gt; \"Nothing\"\n            myItem.Move myDestFolder\n            Set myItem = myItems.FindNext\n        Wend\n    Next\nEnd Sub\n</code></pre>\n\n<p>You may also move the enumeration of your search terms like this:</p>\n\n<pre><code>Dim varSearchTerms As Variant: varSearchTerms = Array(\"ABC Sprockets\", \"DFG Widgets\", \"XYZ Zippers\")\n' ...\nDim varSearchTerm As Variant: For Each varSearchTerm In varSearchTerms\nSet myItem = myItems.Find(\"[SenderName] = '\" &amp; varSearchTerm &amp; \"'\")\n' ...\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1565218050, "creation_date": 1565218050, "answer_id": 57403147, "question_id": 57402558, "link": "https://stackoverflow.com/questions/57402558/move-items-based-on-multiple-values-of-sendername/57403147#57403147", "title": "Move items based on multiple values of SenderName", "body": "<p>You need to specify every condition in the search string explicitly:</p>\n\n<pre><code>Set myItem = myItems.Find(\"[SenderName] = 'ABC Sprockets' OR [SenderName] = 'DFG Widgets' OR [SenderName] = 'XYZ Zippers'\")\n</code></pre>\n"}], "owner": {"reputation": 2167, "user_id": 824282, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8f0cb967adb644f6408e5ff3df8c8a0f?s=128&d=identicon&r=PG", "display_name": "capser", "link": "https://stackoverflow.com/users/824282/capser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1590663505, "creation_date": 1565213575, "last_edit_date": 1590663505, "question_id": 57402558, "link": "https://stackoverflow.com/questions/57402558/move-items-based-on-multiple-values-of-sendername", "title": "Move items based on multiple values of SenderName", "body": "<p>I move email from my inbox to the test folder.</p>\n\n<p>How do I add more sender names?</p>\n\n<p>Instead of moving just 'ABC Sprockets', move 'DFG Widgets' and 'XYZ Zippers' as well in one script.</p>\n\n<pre><code>Sub MoveItems()\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myInbox As Outlook.Folder\n    Dim myDestFolder As Outlook.Folder\n    Dim myItems As Outlook.Items\n    Dim myItem As Object\n\n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myItems = myInbox.Items\n    Set myDestFolder = myInbox.Folders(\"test\")\n    Set myItem = myItems.Find(\"[SenderName] = 'ABC Sprockets'\")\n    While TypeName(myItem) &lt;&gt; \"Nothing\"\n        myItem.Move myDestFolder\n        Set myItem = myItems.FindNext\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1565281319, "post_id": 57402786, "comment_id": 101313672, "body": "What if this symbol \u5e74 &#39;ChrW(24180)&#39; not apper with the date, what if some other symbol appears with it.!  (For example :\u672b,\u5ea6 ) i think you understand my point."}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "reply_to_user": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1565285543, "post_id": 57402786, "comment_id": 101315519, "body": "@M Ahad - You can use wildcards then."}], "tags": [], "owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1565285526, "last_edit_date": 1565285526, "creation_date": 1565215199, "answer_id": 57402786, "question_id": 57402418, "link": "https://stackoverflow.com/questions/57402418/how-can-i-put-a-check-on-one-integer-so-that-the-if-i-run-the-code-again-it-will/57402786#57402786", "title": "How can i put a check on one integer so that the if i run the code again it will not detect the value?", "body": "<p>Change the following lines to use wildcards, so as to find anything but a digit that follows the year number.</p>\n\n<pre><code>.Text = ChrW(24179) &amp; ChrW(25104) &amp; Heisei &amp; \"([!0-9]*)\"\n.Replacement.Text = ChrW(24179) &amp; ChrW(25104) &amp; Gregorian &amp; \"\\1\"\n.MatchWildcards = True\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57402786, "answer_count": 1, "score": 0, "last_activity_date": 1582696182, "creation_date": 1565212671, "last_edit_date": 1582696182, "question_id": 57402418, "link": "https://stackoverflow.com/questions/57402418/how-can-i-put-a-check-on-one-integer-so-that-the-if-i-run-the-code-again-it-will", "title": "How can i put a check on one integer so that the if i run the code again it will not detect the value?", "body": "<p>I am converting the Chinese date to Gregorian, the code i have run perfectly fine for the first time replace the date but when i run it again it changes the date again.I have found the error but need to put a check on a integer variable so that next time it will not detect the variable value to change the date.</p>\n\n<p>This is the Chinese date : \u5e73\u621029\u5e74\u5ea6\nPerfect result after first run: \u5e73\u62102017\u5e74\u5ea6\nIf some one mistakenly run the code then dates changes to : \u5e73\u6210200817\u5e74\u5ea6</p>\n\n<p>The code matches these three character \u5e73\u621029 and change the dates.</p>\n\n<pre><code>Selection.HomeKey Unit:=wdStory\n      Options.Pagination = False\n      Dim Heisei As Integer\n      Dim Gregorian As Integer\n      Heisei = 20\n      Gregorian = 2008\n      Dim C As Integer\nDo Until C = 50\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = ChrW(24179) &amp; ChrW(25104) &amp; Heisei\n        .Replacement.Text = ChrW(24179) &amp; ChrW(25104) &amp; Gregorian\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        .Replacement.Font.Color = wdColorBlue\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n    Heisei = Heisei + 1\n    Gregorian = Gregorian + 1\n    C = C + 1\nLoop\n</code></pre>\n\n<p>If i run the code mistakenly again &amp; again, the code will check the \"Heisei\" value is 20 or 2017. So that the code will not check for this \u5e73\u621020. But for the \u5e73\u62102017.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11898477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dee38518ce8184632771254ab72490f?s=128&d=identicon&r=PG&f=1", "display_name": "Austin397", "link": "https://stackoverflow.com/users/11898477/austin397"}, "edited": false, "score": 0, "creation_date": 1565285602, "post_id": 57402984, "comment_id": 101315549, "body": "My dude you are awesome! the average code time went from 26.96 seconds to 11.16 seconds! This is much faster than it was but is there any way to further increase the speed that you know of?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 43, "user_id": 11898477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dee38518ce8184632771254ab72490f?s=128&d=identicon&r=PG&f=1", "display_name": "Austin397", "link": "https://stackoverflow.com/users/11898477/austin397"}, "edited": false, "score": 0, "creation_date": 1565286328, "post_id": 57402984, "comment_id": 101315838, "body": "@Austin397 You&#39;re welcome. Regarding the execution time, are you timing this specific section of code, or execution of your entire function? Given that we are not seeing the complete function, there may be efficiency improvements to be found elsewhere."}, {"owner": {"reputation": 43, "user_id": 11898477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dee38518ce8184632771254ab72490f?s=128&d=identicon&r=PG&f=1", "display_name": "Austin397", "link": "https://stackoverflow.com/users/11898477/austin397"}, "edited": false, "score": 0, "creation_date": 1565352467, "post_id": 57402984, "comment_id": 101337191, "body": "I am doing the entire function but this section was definitely the main abuser of time."}, {"owner": {"reputation": 43, "user_id": 11898477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dee38518ce8184632771254ab72490f?s=128&d=identicon&r=PG&f=1", "display_name": "Austin397", "link": "https://stackoverflow.com/users/11898477/austin397"}, "edited": false, "score": 0, "creation_date": 1565352801, "post_id": 57402984, "comment_id": 101337377, "body": "I have added the rest of the code to the question. Thank you!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1565216717, "creation_date": 1565216717, "answer_id": 57402984, "question_id": 57402173, "link": "https://stackoverflow.com/questions/57402173/how-to-optimize-search-through-emails-to-find-text-using-ms-access-vba-2016/57402984#57402984", "title": "How to optimize search through emails to find text using MS Access VBA 2016?", "body": "<p>Since VBA does not support <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow noreferrer\">short-circuit evaluation</a> of boolean expressions, your current code must evaluate each &amp; every <code>InStr</code> expression within the test expression for the <code>If</code> statement before determining whether or not the test expression is validated.</p>\n\n<p>To avoid this, I would suggest using a function which returned a boolean value as soon as a match is found, to minimise the number of <code>InStr</code> tests.</p>\n\n<p>Such a function could be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function SearchString(strStr As String, strCSV As String) As Boolean\n    Dim strItm\n    For Each strItm In Split(strCSV, \",\")\n        If InStr(strStr, strItm) Then\n            SearchString = True\n            Exit For\n        End If\n    Next strItm\nEnd Function\n</code></pre>\n\n<p>Which could be used in your code in the following way:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If SearchString(.Body, \"hsarep,repcosalesofga,p-massoc,tchristy,mlsalesinc,vcmsales,ssafla,bellsouth,jim-bryce,millermays,kennymma,hhrep,bankcs@aol,dtoddcpd,colleenmartinhandh,ppg-sales,asapsales,mechagents,e-technical@zurn.com,Barbara.Cass,Craig.Comito,comfortsystemsusa,hmmechanical,gsphinc,dynaten,ColonialWebb,bchmechanical,rbiva,naminc,designmech,marelich,gowaninc,emcorgroup,emcor,comunale,shambaugh,trautman-shreve,ccimechanical,scaliseindustries,cannistraro,brand,mckenneys,murphy-stl,eganco,jfahern,hillgrp,jhkelly,ewing-doherty,falconplumbing,hmcc,harriscompany,hpeinc,jjkllc,jwdanforth,murraycompany,southlandind,usengineering,kruckph,ppcosa,ppmechanical,northmechanical,welchandrushe,acibuilds,waldinger,precisionplumbing,osullivanplmg,mmccontractors\") Then\n    ProjectID = \"PLA-\" &amp; Format(Initial_Contact, \"yyyy_mm_dd-hhnnss\")\nElseIf SearchString(.SenderEmailAddress, \"hsarep,repcosalesofga,...,\") Then\n    ProjectID = \"PLA-\" &amp; Format(Initial_Contact, \"yyyy_mm_dd-hhnnss\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11898477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dee38518ce8184632771254ab72490f?s=128&d=identicon&r=PG&f=1", "display_name": "Austin397", "link": "https://stackoverflow.com/users/11898477/austin397"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1597920122, "creation_date": 1565211276, "last_edit_date": 1597920122, "question_id": 57402173, "link": "https://stackoverflow.com/questions/57402173/how-to-optimize-search-through-emails-to-find-text-using-ms-access-vba-2016", "title": "How to optimize search through emails to find text using MS Access VBA 2016?", "body": "<p>I have working code taking about 30 seconds to search 80 emails.</p>\n<p>We have about 12 users working out of this database and are getting errors when two or more people are updating their email lists. I tried basing this out of a table instead but that took nearly four times longer.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>'search the body\nIf InStr(.Body, &quot;hsarep&quot;) Or InStr(.Body, &quot;repcosalesofga&quot;) Or InStr(.Body, &quot;p-massoc&quot;) Or InStr(.Body, &quot;tchristy&quot;) Or InStr(.Body, &quot;mlsalesinc&quot;) Or _\nInStr(.Body, &quot;vcmsales&quot;) Or InStr(.Body, &quot;ssafla&quot;) Or InStr(.Body, &quot;bellsouth&quot;) Or InStr(.Body, &quot;jim-bryce&quot;) Or InStr(.Body, &quot;millermays&quot;) Or _\nInStr(.Body, &quot;kennymma&quot;) Or InStr(.Body, &quot;hhrep&quot;) Or InStr(.Body, &quot;bankcs@aol&quot;) Or InStr(.Body, &quot;dtoddcpd&quot;) Or InStr(.Body, &quot;colleenmartinhandh&quot;) Or _\nInStr(.Body, &quot;ppg-sales&quot;) Or InStr(.Body, &quot;asapsales&quot;) Or InStr(.Body, &quot;mechagents&quot;) Or InStr(.Body, &quot;e-technical@zurn.com&quot;) Or _\nInStr(.Body, &quot;Barbara.Cass&quot;) Or InStr(.Body, &quot;Craig.Comito&quot;) Or _\nInStr(.Body, &quot;comfortsystemsusa&quot;) Or InStr(.Body, &quot;hmmechanical&quot;) Or InStr(.Body, &quot;gsphinc&quot;) Or InStr(.Body, &quot;dynaten&quot;) Or InStr(.Body, &quot;ColonialWebb&quot;) Or _\nInStr(.Body, &quot;bchmechanical&quot;) Or InStr(.Body, &quot;rbiva&quot;) Or InStr(.Body, &quot;naminc&quot;) Or InStr(.Body, &quot;designmech&quot;) Or InStr(.Body, &quot;marelich&quot;) Or _\nInStr(.Body, &quot;gowaninc&quot;) Or InStr(.Body, &quot;emcorgroup&quot;) Or InStr(.Body, &quot;emcor&quot;) Or InStr(.Body, &quot;comunale&quot;) Or InStr(.Body, &quot;shambaugh&quot;) Or _\nInStr(.Body, &quot;trautman-shreve&quot;) Or InStr(.Body, &quot;ccimechanical&quot;) Or InStr(.Body, &quot;scaliseindustries&quot;) Or InStr(.Body, &quot;cannistraro&quot;) Or InStr(.Body, &quot;brand&quot;) Or _\nInStr(.Body, &quot;mckenneys&quot;) Or InStr(.Body, &quot;murphy-stl&quot;) Or InStr(.Body, &quot;eganco&quot;) Or InStr(.Body, &quot;jfahern&quot;) Or InStr(.Body, &quot;hillgrp&quot;) Or _\nInStr(.Body, &quot;jhkelly&quot;) Or InStr(.Body, &quot;ewing-doherty&quot;) Or InStr(.Body, &quot;falconplumbing&quot;) Or InStr(.Body, &quot;hmcc&quot;) Or InStr(.Body, &quot;harriscompany&quot;) Or _\nInStr(.Body, &quot;hpeinc&quot;) Or InStr(.Body, &quot;jjkllc&quot;) Or InStr(.Body, &quot;jwdanforth&quot;) Or InStr(.Body, &quot;murraycompany&quot;) Or InStr(.Body, &quot;southlandind&quot;) Or _\nInStr(.Body, &quot;usengineering&quot;) Or InStr(.Body, &quot;kruckph&quot;) Or InStr(.Body, &quot;ppcosa&quot;) Or InStr(.Body, &quot;ppmechanical&quot;) Or InStr(.Body, &quot;northmechanical&quot;) Or _\nInStr(.Body, &quot;welchandrushe&quot;) Or InStr(.Body, &quot;acibuilds&quot;) Or InStr(.Body, &quot;waldinger&quot;) Or InStr(.Body, &quot;precisionplumbing&quot;) Or InStr(.Body, &quot;osullivanplmg&quot;) Or _\nInStr(.Body, &quot;mmccontractors&quot;) Then\n\n    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n    \n'search sender address\nElseIf InStr(.SenderEmailAddress, &quot;hsarep&quot;) Or InStr(.SenderEmailAddress, &quot;repcosalesofga&quot;) Or InStr(.SenderEmailAddress, &quot;p-massoc&quot;) Or _\nInStr(.SenderEmailAddress, &quot;tchristy&quot;) Or InStr(.SenderEmailAddress, &quot;mlsalesinc&quot;) Or InStr(.SenderEmailAddress, &quot;vcmsales&quot;) Or _\nInStr(.SenderEmailAddress, &quot;ssafla&quot;) Or InStr(.SenderEmailAddress, &quot;bellsouth&quot;) Or InStr(.SenderEmailAddress, &quot;jim-bryce&quot;) Or _\nInStr(.SenderEmailAddress, &quot;millermays&quot;) Or InStr(.SenderEmailAddress, &quot;kennymma&quot;) Or InStr(.SenderEmailAddress, &quot;hhrep&quot;) Or _\nInStr(.SenderEmailAddress, &quot;bankcs@aol&quot;) Or InStr(.SenderEmailAddress, &quot;dtoddcpd&quot;) Or InStr(.SenderEmailAddress, &quot;colleenmartinhandh&quot;) Or _\nInStr(.SenderEmailAddress, &quot;ppg-sales&quot;) Or InStr(.SenderEmailAddress, &quot;asapsales&quot;) Or InStr(.SenderEmailAddress, &quot;mechagents&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Jon.Huddle&quot;) Or InStr(.SenderEmailAddress, &quot;Jonathan.Huddle&quot;) Or InStr(.SenderEmailAddress, &quot;Dennis.Haeberlin&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Jon.Drobac&quot;) Or InStr(.SenderEmailAddress, &quot;John.McNutt&quot;) Or InStr(.SenderEmailAddress, &quot;Mark.Marini&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Frank.Schaetzke&quot;) Or InStr(.SenderEmailAddress, &quot;Dave.Gomo&quot;) Or InStr(.SenderEmailAddress, &quot;Bill.Woehlke&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Joe.Clarey&quot;) Or InStr(.SenderEmailAddress, &quot;Joe.Cunningham&quot;) Or InStr(.SenderEmailAddress, &quot;Donald.Cormany&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Jim.Fessler&quot;) Or InStr(.SenderEmailAddress, &quot;Eddy.Edmunds&quot;) Or InStr(.SenderEmailAddress, &quot;Alan.Squires&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Brian.Gillespie&quot;) Or InStr(.SenderEmailAddress, &quot;e-technical@zurn.com&quot;) Or InStr(.SenderEmailAddress, &quot;Lyndsey.Smith&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Jim.Stafford&quot;) Or InStr(.SenderEmailAddress, &quot;Eric.Klump&quot;) Or InStr(.SenderEmailAddress, &quot;Ryan.Langan&quot;) Or _\nInStr(.SenderEmailAddress, &quot;Barbara.Cass&quot;) Or InStr(.SenderEmailAddress, &quot;Craig.Comito&quot;) Then\n\n    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n\n' Regular Email\nProjectID = &quot;E-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd_hhnnss&quot;)\nEnd If\n\n</code></pre>\n<p>I would like the time it takes to run this code to be closer to 10 seconds or less.</p>\n<p>The rest of the code.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function AppEmailSearch()\nOn Error GoTo errhndlr\n'----------------------------------Timer-----------------------------------\nDim StartTime As Double\nDim SecondsElapsed As Double\nStartTime = Timer\n'----------------------------------Timer-----------------------------------\n    Dim ns As Outlook.NameSpace\n    Dim AppInbox As Outlook.folder\n    Dim Email As Outlook.MailItem\n    Dim rst As DAO.Recordset\n    Dim Count As Integer\n    Dim EntryID, From, Subject, ProjectID As String\n    Dim Initial_Contact, ETA As Date\n        \n    Set ns = GetNamespace(&quot;MAPI&quot;)\n    Set AppInbox = ns.GetFolderFromID(DLookup(&quot;Location&quot;, &quot;List_FileLocations&quot;, &quot;[LocationName] = 'AppEngr_Inbox'&quot;))\n    \n    Set rst = CurrentDb.OpenRecordset(&quot;Email_Info&quot;, dbOpenDynaset)\n    Count = AppInbox.Items.Count\n            \n    For Each Email In AppInbox.Items\n        With Email\n            EntryID = .EntryID\n            Subject = .Subject\n            Initial_Contact = .ReceivedTime\n            \n      '      ETA = Functions.ETA(CStr(Initial_Contact), &quot;E&quot;, 0)\n            \n            Select Case .SenderName\n            \n            ' System Specifier Emails\n            Case &quot;specifier@flothru.com&quot;\n                ProjectID = &quot;SSE-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                Dim Beginning As Integer\n             Beginning = InStr(.Body, &quot;http://&quot;) - 1\n                From = Right(.Body, Len(.Body) - Beginning)\n                \n            ' Platinum Emails\n            Case &quot;Zurn-Platinum&quot;\n                ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                From = .SenderName\n                \n            Case Else\n                'search the body\n'                If InStr(.Body, &quot;hsarep&quot;) Or InStr(.Body, &quot;repcosalesofga&quot;) Or InStr(.Body, &quot;p-massoc&quot;) Or InStr(.Body, &quot;tchristy&quot;) Or InStr(.Body, &quot;mlsalesinc&quot;) Or _\n'                InStr(.Body, &quot;vcmsales&quot;) Or InStr(.Body, &quot;ssafla&quot;) Or InStr(.Body, &quot;bellsouth&quot;) Or InStr(.Body, &quot;jim-bryce&quot;) Or InStr(.Body, &quot;millermays&quot;) Or _\n'                InStr(.Body, &quot;kennymma&quot;) Or InStr(.Body, &quot;hhrep&quot;) Or InStr(.Body, &quot;bankcs@aol&quot;) Or InStr(.Body, &quot;dtoddcpd&quot;) Or InStr(.Body, &quot;colleenmartinhandh&quot;) Or _\n'                InStr(.Body, &quot;ppg-sales&quot;) Or InStr(.Body, &quot;asapsales&quot;) Or InStr(.Body, &quot;mechagents&quot;) Or InStr(.Body, &quot;e-technical@zurn.com&quot;) Or _\n'                InStr(.Body, &quot;Barbara.Cass&quot;) Or InStr(.Body, &quot;Craig.Comito&quot;) Then\n                \n'                    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                    \n                'search sender address\n'                ElseIf InStr(.SenderEmailAddress, &quot;hsarep&quot;) Or InStr(.SenderEmailAddress, &quot;repcosalesofga&quot;) Or InStr(.SenderEmailAddress, &quot;p-massoc&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;tchristy&quot;) Or InStr(.SenderEmailAddress, &quot;mlsalesinc&quot;) Or InStr(.SenderEmailAddress, &quot;vcmsales&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;ssafla&quot;) Or InStr(.SenderEmailAddress, &quot;bellsouth&quot;) Or InStr(.SenderEmailAddress, &quot;jim-bryce&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;millermays&quot;) Or InStr(.SenderEmailAddress, &quot;kennymma&quot;) Or InStr(.SenderEmailAddress, &quot;hhrep&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;bankcs@aol&quot;) Or InStr(.SenderEmailAddress, &quot;dtoddcpd&quot;) Or InStr(.SenderEmailAddress, &quot;colleenmartinhandh&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;ppg-sales&quot;) Or InStr(.SenderEmailAddress, &quot;asapsales&quot;) Or InStr(.SenderEmailAddress, &quot;mechagents&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Jon.Huddle&quot;) Or InStr(.SenderEmailAddress, &quot;Jonathan.Huddle&quot;) Or InStr(.SenderEmailAddress, &quot;Dennis.Haeberlin&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Jon.Drobac&quot;) Or InStr(.SenderEmailAddress, &quot;John.McNutt&quot;) Or InStr(.SenderEmailAddress, &quot;Mark.Marini&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Frank.Schaetzke&quot;) Or InStr(.SenderEmailAddress, &quot;Dave.Gomo&quot;) Or InStr(.SenderEmailAddress, &quot;Bill.Woehlke&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Joe.Clarey&quot;) Or InStr(.SenderEmailAddress, &quot;Joe.Cunningham&quot;) Or InStr(.SenderEmailAddress, &quot;Donald.Cormany&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Jim.Fessler&quot;) Or InStr(.SenderEmailAddress, &quot;Eddy.Edmunds&quot;) Or InStr(.SenderEmailAddress, &quot;Alan.Squires&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Brian.Gillespie&quot;) Or InStr(.SenderEmailAddress, &quot;e-technical@zurn.com&quot;) Or InStr(.SenderEmailAddress, &quot;Lyndsey.Smith&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Jim.Stafford&quot;) Or InStr(.SenderEmailAddress, &quot;Eric.Klump&quot;) Or InStr(.SenderEmailAddress, &quot;Ryan.Langan&quot;) Or _\n'                InStr(.SenderEmailAddress, &quot;Barbara.Cass&quot;) Or InStr(.SenderEmailAddress, &quot;Craig.Comito&quot;) Then\n                \n'                    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                \n                ' Regular Email\n'                Else\n'                ProjectID = &quot;E-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd_hhnnss&quot;)\n'                End If\n\n                If SearchString(.Body, &quot;hsarep,repcosalesofga,p-massoc,tchristy,mlsalesinc,vcmsales,ssafla,bellsouth,jim-bryce,millermays,kennymma,hhrep,bankcs@aol,dtoddcpd,colleenmartinhandh,ppg-sales,asapsales,mechagents,e-technical@zurn.com,Barbara.Cass,Craig.Comito,comfortsystemsusa,hmmechanical,gsphinc,dynaten,ColonialWebb,_bchmechanical,rbiva,naminc,designmech,marelich,gowaninc,emcorgroup,emcor,comunale,shambaugh,trautman-shreve,ccimechanical,scaliseindustries,cannistraro,brand,mckenneys,murphy-stl,eganco,jfahern,hillgrp,jhkelly,ewing-doherty,falconplumbing,hmcc,harriscompany,hpeinc,jjkllc,jwdanforth,murraycompany,southlandind,usengineering,kruckph,ppcosa,ppmechanical,northmechanical,welchandrushe,acibuilds,waldinger,precisionplumbing,osullivanplmg,mmccontractors&quot;) Then\n                    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                ElseIf SearchString(.SenderEmailAddress, &quot;hsarep,repcosalesofga,p-massoc,tchristy,mlsalesinc,vcmsales,ssafla,bellsouth,jim-bryce,millermays,kennymma,hhrep,bankcs@aol,dtoddcpd,colleenmartinhandh,ppg-sales,asapsales,mechagents,Jon.Huddle,Jonathan.Huddle,Dennis.Haeberlin,Jon.Drobac,John.McNutt,Mark.Marini,Frank.Schaetzke,Dave.Gomo,Bill.Woehlke,Joe.Clarey,Joe.Cunningham,Donald.Cormany,Jim.Fessler,Eddy.Edmunds,Alan.Squires,Brian.Gillespie,e-technical@zurn.com,Lyndsey.Smith,Jim.Stafford,Eric.Klump,Ryan.Langan,Barbara.Cass,Craig.Comito&quot;) Then\n                    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                ElseIf SearchString(.SenderEmailAddress, &quot;comfortsystemsusa,hmmechanical,gsphinc,dynaten,ColonialWebb,_bchmechanical,rbiva,naminc,designmech,marelich,gowaninc,emcorgroup,emcor,comunale,shambaugh,trautman-shreve,ccimechanical,scaliseindustries,cannistraro,brand,mckenneys,murphy-stl,eganco,jfahern,hillgrp,jhkelly,ewing-doherty,falconplumbing,hmcc,harriscompany,hpeinc,jjkllc,jwdanforth,murraycompany,southlandind,usengineering,kruckph,ppcosa,ppmechanical,northmechanical,welchandrushe,acibuilds,waldinger,precisionplumbing,osullivanplmg,mmccontractors&quot;) Then\n                    ProjectID = &quot;PLA-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd-hhnnss&quot;)\n                Else\n                    ProjectID = &quot;E-&quot; &amp; Format(Initial_Contact, &quot;yyyy_mm_dd_hhnnss&quot;)\n                End If\n                \n                From = .SenderName\n            End Select\n        End With\n        \n        With rst\n            .FindFirst &quot;[EntryID] = '&quot; &amp; EntryID &amp; &quot;'&quot;\n            If .NoMatch Then\n                .FindFirst &quot;[ProjectID] = '&quot; &amp; ProjectID &amp; &quot;'&quot;\n                If .NoMatch Then\n                    .AddNew\n                        .Fields(&quot;ProjectID&quot;) = ProjectID\n                        .Fields(&quot;From&quot;) = From\n                        .Fields(&quot;Initial_Contact&quot;) = Initial_Contact\n                        \n                        If InStr(ProjectID, &quot;PLA&quot;) Then\n                        .Fields(&quot;ETA&quot;) = Functions.ETA(CStr(Initial_Contact), &quot;PLA&quot;, 1)\n                        Else\n                        .Fields(&quot;ETA&quot;) = Functions.ETA(CStr(Initial_Contact), &quot;E&quot;, 0)\n                        End If\n                        \n                        If Email.Categories = &quot;Flo-Thru&quot; Then\n                        .Fields(&quot;Flo_Thru_Email&quot;) = True\n                        Else: .Fields(&quot;Flo_Thru_Email&quot;) = False\n                        End If\n                        \n                        .Fields(&quot;Found&quot;) = True\n                Else\n                    .Edit\n                End If\n                    .Fields(&quot;Subject&quot;) = Subject\n                    .Fields(&quot;EntryID&quot;) = EntryID\n                .Update\n            Else\n                .Edit\n                    .Fields(&quot;Subject&quot;) = Subject\n                    If Email.Categories = &quot;Flo-Thru&quot; Then\n                        .Fields(&quot;Flo_Thru_Email&quot;) = True\n                    Else: .Fields(&quot;Flo_Thru_Email&quot;) = False\n                    End If\n                    .Fields(&quot;Found&quot;) = True\n                .Update\n            End If\n        End With\n    Next Email\n    rst.Close\n    Set rst = Nothing\n    \n    With DoCmd\n        .RunSQL &quot;DELETE * FROM Email_Info WHERE [Found] = False and IsNull([CompletedDate])&quot;\n        .RunSQL &quot;UPDATE Email_Info SET [Found] = False&quot;\n    End With\n'----------------------------------Timer-----------------------------------\nSecondsElapsed = Round(Timer - StartTime, 2)\nMsgBox &quot;Time lapse = &quot; &amp; SecondsElapsed &amp; &quot; seconds&quot;, , &quot;App Email Search Time Lapse&quot;\n'----------------------------------Timer-----------------------------------\nExit Function\n</code></pre>\n"}, {"tags": ["vba", "dictionary", "scripting"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1565210970, "post_id": 57401991, "comment_id": 101285786, "body": "It&#39;s not super-clear from your question what type of data structure you have.  You say dictionary but it looks more like a nested set of dictionaries.  It would also help to be more explicit about haw you&#39;re searching your data structure.   Including your code is always a big help."}, {"owner": {"reputation": 1, "user_id": 3861549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c48c0598ec606d66d097ff2a456ac735?s=128&d=identicon&r=PG&f=1", "display_name": "jmkse", "link": "https://stackoverflow.com/users/3861549/jmkse"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565217626, "post_id": 57401991, "comment_id": 101287675, "body": "I guess I assumed when I mentioned torrents that people would understand that this is bencoded data which usually includes nested dictionaries. I am &quot;walking it&quot; in the traditional sense -- following nesting recursively. The code is tremendously convoluted and poorly written. I will see if I can extract and clean something relevant."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565221901, "post_id": 57401991, "comment_id": 101288535, "body": "I think you&#39;re going to need to add the path as a parameter in your traversing code - there&#39;s no &quot;parent&quot; attribute you can call on a contained item which will give you the containing object/array."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 232512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73216083e9f252ed99bbc6dd2cac0591?s=128&d=identicon&r=PG", "display_name": "Daniel P", "link": "https://stackoverflow.com/users/232512/daniel-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1565664753, "creation_date": 1565664753, "answer_id": 57470547, "question_id": 57401991, "link": "https://stackoverflow.com/questions/57401991/reasonably-quick-way-to-get-the-full-path-inside-of-a-scripting-dictionary-of-a/57470547#57470547", "title": "Reasonably quick way to get the full path inside of a scripting dictionary of a key you are accessing?", "body": "<p>If I understand the problem correctly, I'd probably use Sqlite to store data as I were parsing it and then run a query to get sorted data back to (re)populate the treeview. I believe you can keep Sqlite database in memory and not need to write to disk for performance.</p>\n\n<p>I intended for this to be a comment, but I cannot make a comment.</p>\n"}], "owner": {"reputation": 1, "user_id": 3861549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c48c0598ec606d66d097ff2a456ac735?s=128&d=identicon&r=PG&f=1", "display_name": "jmkse", "link": "https://stackoverflow.com/users/3861549/jmkse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565664753, "creation_date": 1565210189, "last_edit_date": 1565219280, "question_id": 57401991, "link": "https://stackoverflow.com/questions/57401991/reasonably-quick-way-to-get-the-full-path-inside-of-a-scripting-dictionary-of-a", "title": "Reasonably quick way to get the full path inside of a scripting dictionary of a key you are accessing?", "body": "<p>Does anyone know a reasonably quick way to get the full path inside of a scripting dictionary of a key you are accessing? An example from a current personal project is looking through a torrent for certain files or paths. With small things like a single torrent file, it's easy to create a treeview and search that and reverse-engineer the path since it is constructed to correspond to the dictionary. However, when loading something like a utorrent resume.dat file of 2000 torrents, it takes forever to create and search a treeview whereas the dictionary can be created and searched almost instantly. However, I would like to be able to reconstruct a treeview (single node path as it would appear if I created the entire tree) of the found data that would correspond to a created full treeview.</p>\n\n<p>I am familiar with Ultima's Bencode Editor project, which is great and I use from time to time but only does part of what I need. He must be accomplishing something similar but is keeping his code private. I pieced together VB6/VBA code which helps me create and manipulate a treeview of that kind of data. However, being VBA/6, it is insanely slow (especially since I need to keep it sorted) and I do not have either the time or probably the skill to port it to a C variant to speed it up and then COM/ActiveX it back so I can use it in Excel 2007 VBA. So what I'm looking for, as an example from a single torrent file, is something that could return me a path like:</p>\n\n<p>/info(0)/files(1)/path(2)</p>\n\n<p>when I have found something (\"VIDEO_TS.IFO\") from within a structure like</p>\n\n<pre><code>info(d)[4]\n  files(l)[141]\n    Item 1(d)[2]\n      length(i)=24576\n      path(l)[3]\n        Disk1.ep1-9\n        VIDEO_TS\n        VIDEO_TS.BUP\n    Item 2(d)[2]\n      length(i)=24576\n      path(l)[3]\n        Disk1.ep1-9\n        VIDEO_TS\n        VIDEO_TS.IFO\n</code></pre>\n\n<p>(i.e. if dict.item =   then PathToDictItem(dict.item) = )</p>\n\n<p>Yes, I can keep passing a constructed key as I traverse (search) the dictionary (not quite as simple as it sounds). But my life becomes a whole lot easier if I can simply access the full dictionary path to a key once I've found a value. I'm just hoping someone out there smarter than me knows a relatively simple way I have overlooked to accomplish this.</p>\n\n<p>There were a couple questions similar to this which discussed something called \"yield\" in python but I am not familiar enough to figure out if they are accomplishing what I want and I don't believe VBA has an equivalent anyway.</p>\n\n<p>Per request of Tim Williams, here is the root of the code which produced the small data example:</p>\n\n<pre><code>Private Sub WalkDict(d As Variant, indent As Long)\nDim k, t\nFor Each k In d.keys\n    t = TypeName(d.Item(k))\n    Select Case t\n        Case \"Integer\", \"Long\", \"Currency\"\n            Debug.Print Space(indent * 2); k; \"(i)=\"; Trim(CStr(d.Item(k)))\n        Case \"String\"\n            Debug.Print Space(indent * 2); k; \"(b)[\"; Trim(CStr(Len(d.Item(k)))); \"]=\";\n            If Len(d.Item(k)) &lt; 100 Then Debug.Print d.Item(k) Else Debug.Print Left(d.Item(k), 96); \" ...\"\n        Case \"Variant()\"\n            Debug.Print Space(indent * 2); k; \"(l)[\";\n            If IsDimmed(d.Item(k)) Then\n                Debug.Print Trim(UBound(d.Item(k)) + 1); \"]\"\n                WalkList d.Item(k), indent + 1\n             Else\n                Debug.Print \"0]\"\n            End If\n        Case \"Dictionary\"\n            Debug.Print Space(indent * 2); k; \"(d)[\"; Trim(UBound(d.Item(k).keys) + 1); \"]\"\n            WalkDict d.Item(k), indent + 1\n        Case Else\n            Stop 'oops\n    End Select\n\nNext\nEnd Sub\n\nPrivate Sub WalkList(l As Variant, indent As Long)\nDim li, lin, t\nFor Each li In l\n    lin = lin + 1\n    t = TypeName(li)\n    Select Case t\n        Case \"Integer\", \"Long\", \"Currency\"\n            Debug.Print Space(indent * 2); li; \"(i)=\"; li.Item(li)\n        Case \"String\"\n            Debug.Print Space(indent * 2); li\n        Case \"Variant()\"\n            WalkList li, indent + 1\n        Case \"Dictionary\"\n            Debug.Print Space(indent * 2); \"Item \"; Trim(CStr(lin)); \"(d)[\"; Trim(UBound(li.keys) + 1); \"]\"\n            WalkDict li, indent + 1\n        Case Else\n            Stop 'oops\n    End Select\nNext\nEnd Sub\n</code></pre>\n\n<p>Just imagine that at any point I'm printing a value that I would be checking that data against criteria and, as I had tried to make clear, if matched, I would like to have the full path through the dictionary/ies to that key/value.</p>\n\n<p>I understand that it is unlikely that VBA makes this readily available and I'm already trying to cobble key-building into the calling. It's just that lists make it more complicated because they don't use the same naming and keys as the rest of the dictionary.</p>\n\n<p>I just know that I am a relatively uninformed hobbyist and there are lots of smart and experienced programmers who wander through these forums and I'm hoping one of them had solved the problem before.</p>\n"}, {"tags": ["excel", "vba", "powershell", "windows-services"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1565210032, "last_edit_date": 1565210032, "creation_date": 1565209652, "answer_id": 57401882, "question_id": 57401755, "link": "https://stackoverflow.com/questions/57401755/error-when-running-an-excel-macro-from-a-windows-service-application/57401882#57401882", "title": "Error when Running an Excel Macro from a Windows Service Application", "body": "<p>I think you actually have to open the <code>PERSONAL.XLSB</code> manually, e.g. something like this worked for me:</p>\n\n<pre><code>$myLocalXLS = \"C:\\Users\\aUser\\Desktop\\aFolder\\myLocalXLS.xls\"\n$myPersonalXLSB = \"C:\\Users\\aUser\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\PERSONAL.XLSB\"\n$excel = New-Object -ComObject excel.application\n$excel.DisplayAlerts = $FALSE\n$myXLSWorkbook = $excel.Workbooks.Open($mylocalXLS)\n$myPersonalWorkbook = $excel.Workbooks.Open($myPersonalXLSB)\n$excel.Run(\"PERSONAL.XLSB!MacroForMyLocalXLS\")\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5906335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jEwCd.png?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5906335/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 57401882, "answer_count": 1, "score": 2, "last_activity_date": 1565210032, "creation_date": 1565209033, "question_id": 57401755, "link": "https://stackoverflow.com/questions/57401755/error-when-running-an-excel-macro-from-a-windows-service-application", "title": "Error when Running an Excel Macro from a Windows Service Application", "body": "<p>I have created a Windows Service Application that does many things but a part of it is producing an error. My service runs a PowerShell script that opens an Excel document (I know Microsoft does not support this, but opening the Excel doc is actually not whats giving me an issue). I get the error below when I try to run a macro on it and I have no idea how to fix it.</p>\n\n<pre><code>Exception calling \"Run\" with \"1\" argument(s): \"'C:\\WINDOWS\\system32\\PERSONAL.XLSB' could not be found. \nCheck the spelling of the file name, and verify that the file location is correct.\nIf you are trying to open the file from your list of most recently used files,\nmake sure that the file has not been renamed, moved, or deleted.\"\n\nAt line:54 char:1\n+ $excel.Run(\"PERSONAL.XLSB!MacroForSoftwareFeatureLicensesXLS\")\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>I have applied other solutions already like adding a 'Desktop' folder to C:\\Windows\\System32\\config\\systemprofile and C:\\Windows\\SysWOW64\\config\\systemprofile. This worked for allowing me to open the excel doc.</p>\n\n<p>I have tried putting the PERSONAL.XLSB file in the C:\\WINDOWS\\system32 folder but this does nothing. Similarly, I also tried putting the PERSONAL.XLSB file in C:\\WINDOWS\\sysWOW64 but this completely halts my service.</p>\n\n<p>My PowerShell script is the following:</p>\n\n<pre><code>$myLocalXLS = \"C:\\Users\\aUser\\Desktop\\aFolder\\myLocalXLS.xls\"\n$excel = New-Object -ComObject excel.application\n$excel.DisplayAlerts = $FALSE\n$myXLSWorkbook = $excel.Workbooks.Open($mylocalXLS)\n$excel.Run(\"PERSONAL.XLSB!MacroForMyLocalXLS\")\n$myXLSWorkbook.Save()\n$excel.DisplayAlerts = $TRUE\n$excel.Quit()\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565207770, "post_id": 57401332, "comment_id": 101284542, "body": "For readability, you should work on indenting the code to general standards (e.g., for each on one line, then indent for what happens <i>during</i> that loop)"}, {"owner": {"reputation": 1, "user_id": 10615274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntu-_IpVKXQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDkFRd20p6ENOzmA8UXyyxK_5yEhQ/mo/photo.jpg?sz=128", "display_name": "Arnab Rajkhowa", "link": "https://stackoverflow.com/users/10615274/arnab-rajkhowa"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565208779, "post_id": 57401332, "comment_id": 101284934, "body": "I did indent the sections properly now. Does it make sense to you? Do you see any evident bugs in the code? I&#39;m a bit baffled as the code is working for the first filter, just not for the others."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565209469, "post_id": 57401332, "comment_id": 101285192, "body": "Let&#39;s make sure we&#39;re looking at this appropriately, you intended to re-do the <code>&quot;[Factory_Codes]&quot;.CurrentPageName</code> for every time you loop through items for cm, r, and cu?  Depending on your error, you might not have a found value or you have no visible data within the filter (the latter typically throws a mismatch error)."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565209611, "post_id": 57401332, "comment_id": 101285251, "body": "A note from the microsoft docs for <code>.CurrentPageName</code>: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotfield.currentpagename\" rel=\"nofollow noreferrer\">Returns or sets the currently displayed page of the specified PivotTable report. The name of the page appears in the page field. Note that this property works only if the currently displayed page already exists.  This property applies to PivotTables that are connected to an OLAP data source. Attempting to return or set this property with a PivotTable that is not connected to an OLAP data source will result in a run-time error.</a>."}, {"owner": {"reputation": 1, "user_id": 10615274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntu-_IpVKXQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDkFRd20p6ENOzmA8UXyyxK_5yEhQ/mo/photo.jpg?sz=128", "display_name": "Arnab Rajkhowa", "link": "https://stackoverflow.com/users/10615274/arnab-rajkhowa"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565209669, "post_id": 57401332, "comment_id": 101285271, "body": "Yes, it&#39;s a nested for loop where the customer filter is the largest level of filter. Once I filter based on customer, I go on changing the other filters and extract the data. The funny thing is that I used the same concept to filter 6 different categories a few weeks back and it worked. I don&#39;t know what&#39;s the issue now."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565209966, "post_id": 57401332, "comment_id": 101285411, "body": "My guess is that you&#39;re filtering where there isn&#39;t an option, e.g., your sheet says <code>cu.value = &quot;A&quot;</code> &amp; <code>r.value = &quot;cat&quot;</code>but your pivot table does not have a &quot;cat&quot; in [Runner Levels] after you&#39;ve filtered [Sales_ana] for &quot;A&quot;, so it throws an error as there is no filter available (at least 1 filtered value is required)."}, {"owner": {"reputation": 1, "user_id": 10615274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntu-_IpVKXQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDkFRd20p6ENOzmA8UXyyxK_5yEhQ/mo/photo.jpg?sz=128", "display_name": "Arnab Rajkhowa", "link": "https://stackoverflow.com/users/10615274/arnab-rajkhowa"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565209985, "post_id": 57401332, "comment_id": 101285424, "body": "Is there a way to check if my pivot table is connected to an OLAP source? Because as mentioned in the comments, I rebuilt the data model and even redefined the relationships. Yet, I&#39;m getting the same error."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565210062, "post_id": 57401332, "comment_id": 101285462, "body": "Use refresh in the... i think it&#39;s &quot;layout&quot; ribbon once you&#39;ve selected any cell in the pivot table.  you might also want to re-assign the source data to be sure."}, {"owner": {"reputation": 1, "user_id": 10615274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntu-_IpVKXQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDkFRd20p6ENOzmA8UXyyxK_5yEhQ/mo/photo.jpg?sz=128", "display_name": "Arnab Rajkhowa", "link": "https://stackoverflow.com/users/10615274/arnab-rajkhowa"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1565210376, "post_id": 57401332, "comment_id": 101285577, "body": "Cyril, its working now. Turns out the values in the data column had a trailing white space in the beginning, as a result of which the values were not getting filtered. LOL!! I spent the entire day trying to debug that. Well thank you for your comments. Appreciate the effort. :)"}], "owner": {"reputation": 1, "user_id": 10615274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntu-_IpVKXQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDkFRd20p6ENOzmA8UXyyxK_5yEhQ/mo/photo.jpg?sz=128", "display_name": "Arnab Rajkhowa", "link": "https://stackoverflow.com/users/10615274/arnab-rajkhowa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565209205, "creation_date": 1565206949, "last_edit_date": 1565209205, "question_id": 57401332, "link": "https://stackoverflow.com/questions/57401332/run-time-error-1004-items-missing-in-olap-cube", "title": "Run time error 1004: Items missing in OLAP cube", "body": "<p>I am using a nested for-loop in a macro to filter through my data and accordingly extract the data. The data is getting filtered for the first filter. But it throws a <code>1004 error : items not present in OLAP cube</code> when it goes on to execute my second/third/fourth filter. </p>\n\n<p>I even tried rebuilding the data model and redefined the existing relationships. It's still not working.Can someone have a look at my code and let me know what's happening.</p>\n\n<pre><code>Sub EXTRACT_TOD_DATA()\n\n\n  Dim CustRng As Range, RunnerRng As Range, CommodityRng As Range, \n  FactoryRng \n  As Range\n  Dim cu As Range, r As Range, cm As Range, f As Range\n\n  Sheets(\"tod\").Activate\n\n\n  Sheets(\"tod\").PivotTables(\"PivotTable1\").ClearAllFilters\n\n\n  Set CustRng = Range(\"AE2:AG2\")\n  Set RunnerRng = Range(\"AE3:AG3\")\n  Set CommodityRng = Range(\"AE4:AF4\")\n  Set FactoryRng = Range(\"AE5:AF5\")\n\n\n  For Each cu In CustRng\n      For Each r In RunnerRng\n          For Each cm In CommodityRng\n              For Each f In FactoryRng\n\n                  ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n                      \"[Sales_ana].[Customer Name].[Customer Name]\").CurrentPageName = _\n                      \"[Sales_ana].[Customer Name].&amp;[\" &amp; cu.Value &amp; \"]\"\n\n                  ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n                      \"[Runner Levels].[Runner Level].[Runner Level]\").CurrentPageName = _\n                      \"[Runner Levels].[Runner Level].&amp;[\" &amp; r.Value &amp; \"]\"\n\n                  ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n                      \"[AGC_commodity].[Commodity].[Commodity]\").CurrentPageName = _\n                      \"[AGC_commodity].[Commodity].&amp;[\" &amp; cm.Value &amp; \"]\"\n\n\n                  ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n                      \"[Sales_ana].[Factory_Codes].[Factory_Codes]\").CurrentPageName = _\n                      \"[Sales_ana].[Factory_Codes].&amp;[\" &amp; f.Value &amp; \"]\"\n\n              Next f\n          Next cm\n      Next r\n  Next cu\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565204141, "post_id": 57400676, "comment_id": 101283003, "body": "Opening a workbook in a loop is not normally needed. Don&#39;t you want to open it later, i.e. <code>Set s111 = Workbooks.Open...</code>?"}, {"owner": {"reputation": 158, "user_id": 4641457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbw3f.png?s=128&g=1", "display_name": "T.J.L.", "link": "https://stackoverflow.com/users/4641457/t-j-l"}, "edited": false, "score": 0, "creation_date": 1565206495, "post_id": 57400676, "comment_id": 101284024, "body": "This could probably benefit from some more explanation of what you&#39;re trying to do, more detail on your thought process (and fewer random characters to defeat the system&#39;s attempt to request that extra explanation)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1565206859, "post_id": 57400676, "comment_id": 101284177, "body": "<i>getting a subscript error</i> - what is the error message? they may help you (and us) diagnose the issue"}], "owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565246973, "creation_date": 1565203932, "last_edit_date": 1565246973, "question_id": 57400676, "link": "https://stackoverflow.com/questions/57400676/moving-certain-items-to-workbooks-works-for-one-but-not-the-others", "title": "Moving certain items to workbooks works for one but not the others", "body": "<p>Basically i need to move certain items to their own workbooks but i am getting a subscript error where it is opening the workbook i need it to go to</p>\n\n<pre><code>Sub Team()\n\n    Dim rw As Long, lastrow As Long, MySel As Range 'Grabs skus and moves to new sheet\n\n\n    With Worksheets(\"Sheet1\")\n        For rw = 1000 To 2 Step -1\n            If .Cells(rw, 2).Value Like \"*Minor Novice*\" And .Cells(rw, 3).Value Like (\"*AE*\") Then\n                If MySel Is Nothing Then\n                    Set MySel = .Cells(rw, 1).EntireRow\n\n                        'Workbooks.Open Filename:=\"C:\\CODE\\Team Lists\\11 Minor Novice AE.xlsx\"\n\n                        Else\n                            Set MySel = Union(MySel, .Cells(rw, 1).EntireRow)\n\n                        End If\n                    End If\n                Next rw\n            End With\n\n    With ThisWorkbook.Worksheets(\"M Novice AE\")\n        lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        If Not MySel Is Nothing Then\n            MySel.Copy Destination:=.Cells(lastrow + 1, 1)\n            'MySel.Delete\n        End If\n    End With\n\n    Dim Rng As Range\n    Set Rng = ThisWorkbook.Worksheets(\"M Novice AE\").Range(\"A1:AY300\")\n    Rng.Copy\n    Dim s11 As Workbook\n    Set s11 = Workbooks(\"11 Minor Novice AE\")\n    Dim last As Long\n    Dim Rngnew As Range\n\nWith s11.Sheets(\"Sheet1\")\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        last = .Range(\"A65000\").End(xlUp).Offset(1, 0).Row\n    Else\n        last = 1\n    End If\nEnd With\n    Set Rngnew = s11.Worksheets(\"Sheet1\").Range(\"A\" &amp; last)\n\n    Rngnew.PasteSpecial\n\n\n\n\n\n    Dim rw1 As Long, lastrow1 As Long, MySel1 As Range 'Grabs skus and moves to new sheet\n\n\n    With Workbooks(\"11 Production\").Worksheets(\"Sheet1\")\n        For rw1 = 1000 To 2 Step -1\n            If .Cells(rw1, 2).Value Like \"*Minor Novice*\" And .Cells(rw1, 3).Value Like (\"*A*\") Then\n                If MySel1 Is Nothing Then\n                    Set MySel1 = .Cells(rw1, 1).EntireRow\n\n                        Workbooks.Open Filename:=\"C:\\CODE\\Team Lists\\11 Minor Novice A.xlsx\"\n\n                        Else\n                            Set MySel1 = Union(MySel1, .Cells(rw1, 1).EntireRow)\n\n                        End If\n                    End If\n                Next rw1\n            End With\n\n      With ThisWorkbook.Worksheets(\"M Novice A\")\n        lastrow1 = .Cells(.Rows.Count, 1).End(xlUp).Row\n        If Not MySel1 Is Nothing Then\n            MySel1.Copy Destination:=.Cells(lastrow1 + 1, 1)\n            'MySel.Delete\n        End If\n    End With\n\n    Dim Rng1 As Range\n    Set Rng1 = ThisWorkbook.Worksheets(\"M Novice A\").Range(\"A1:AY300\")\n    Rng1.Copy\n    Dim s111 As Workbook\n    Set s111 = Workbooks(\"11 Minor Novice A.xlsx\")\n    Dim last1 As Long\n    Dim Rngnew1 As Range\n\n    With s111.Sheets(\"Sheet1\")\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        last1 = .Range(\"A65000\").End(xlUp).Offset(1, 0).Row\n    Else\n        last1 = 1\n    End If\nEnd With\n    Set Rngnew1 = s111.Worksheets(\"Sheet1\").Range(\"A\" &amp; last)\n\n    Rngnew1.PasteSpecial\n\n\nEnd Sub\n</code></pre>\n\n<p>Error: </p>\n\n<blockquote>\n  <p>Workbooks.Open Filename:=\"C:\\CODE\\Team Lists\\11 Minor Novice A.xlsx\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 4, "creation_date": 1565203858, "post_id": 57400617, "comment_id": 101282858, "body": "Remove the parentheses around <code>(SeqRecordset)</code> and <code>(VinRecordset)</code>."}, {"owner": {"reputation": 77, "user_id": 4188185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ee57426b1176903bb21aaf5db9eaba?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Fairway", "link": "https://stackoverflow.com/users/4188185/luke-fairway"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1565204447, "post_id": 57400617, "comment_id": 101283178, "body": "@GSerg lol i am dumb. that worked perfectly thanks."}], "owner": {"reputation": 77, "user_id": 4188185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ee57426b1176903bb21aaf5db9eaba?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Fairway", "link": "https://stackoverflow.com/users/4188185/luke-fairway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1565204684, "answer_count": 0, "score": 1, "last_activity_date": 1565203673, "creation_date": 1565203673, "question_id": 57400617, "link": "https://stackoverflow.com/questions/57400617/run-time-error-430-occurs-when-copyfromrecordset-is-ran", "closed_reason": "Duplicate", "title": "Run-time error &#39;430&#39; Occurs when CopyFromRecordset is ran", "body": "<p>The following error message pops up when I execute my VBA code to run a query on an external SQL database and place results in a cell:</p>\n\n<p><strong>Run-time error '430' Class does not support Automation or does not support expected interface.</strong> </p>\n\n<p>It occurs specifically on the line when i try to CopyFromRecordset</p>\n\n<p>I know for a fact that my query is running successfuly and recordset is being filled because my recordcount = 1, and I get the value that I want returned when I run \"?SeqRecordset.Value\" in the immediate window. So its not an issue where there is a blank recordset.</p>\n\n<pre><code>Sub GetData()\n\nDim seqConn As ADODB.Connection\nDim vinConn As ADODB.Connection\nDim SeqRecordset As ADODB.Recordset\nDim VinRecordset As ADODB.Recordset\nDim strSQLSeq, strSQLVin As String\n\n'Variables\n  Set seqConn = New ADODB.Connection\n  Set SeqRecordset = New ADODB.Recordset\n\n  Set vinConn = New ADODB.Connection\n  Set VinRecordset = New ADODB.Recordset\n\n'Open Connections\n  seqConn.connectionString = \"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=...;Password=...;Initial Catalog=...;Data Source=...\"\n  seqConn.Open\n  vinConn.connectionString = \"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=...;Password=...;Initial Catalog=...;Data Source=...\"\n  vinConn.Open\n\n'Set and Execute SQL Commands\n  strSQLSeq = \"...\"\n  strSQLVin = \"...\"\n\n'Open Recordset\n  SeqRecordset.CursorType = adOpenStatic\n  SeqRecordset.LockType = adLockReadOnly\n  SeqRecordset.CursorLocation = adUseClient\n\n  Set SeqRecordset.ActiveConnection = seqConn\n  SeqRecordset.Open strSQLSeq, seqConn\n\n'Copy Data to Excel'\n  ActiveSheet.Range(\"B1\").CopyFromRecordset (SeqRecordset)\n  ActiveSheet.Range(\"B2\").CopyFromRecordset (VinRecordset)\n\nEnd Sub\n</code></pre>\n\n<p>Two queries are being ran from two different data catalogs. I am trying to place results of those 2 queries in two different cells, but with no success as of right now due to the error shown. </p>\n\n<p><em>Note:</em> The content of the connection and query strings have been replaced with \"...\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565203309, "post_id": 57400471, "comment_id": 101282595, "body": "Rec 1 is (1,1) Red 2 is (-1,1), Red 3 (-2,1) Red 4 is (-3,1).  Not what I pasted above."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565203758, "post_id": 57400471, "comment_id": 101282802, "body": "<code>rCell.Delete</code> - do you want to delete just that cell, or the entire row? Because you&#39;ll get a shift with deleting just the cell."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565203857, "post_id": 57400471, "comment_id": 101282857, "body": "@BigBen That&#39;s the problem (thanks - I now know the line!) What I need to do is clear the contents of that cell, because otherwise the loop keeps finding the same Recommendation and continually pasting it one column over and one row below."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565203969, "post_id": 57400471, "comment_id": 101282917, "body": "I&#39;d propose using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.findnext\" rel=\"nofollow noreferrer\"><code>Range.FindNext</code></a>. There are examples of how to use it here on SO. Or if you want to clear contents, <code>rCell.ClearContents</code>."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565206740, "post_id": 57400471, "comment_id": 101284125, "body": "@BigBen.  I hard rCell.Clear before, and rCell.ClearContents makes everything perfect.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565206890, "post_id": 57401295, "comment_id": 101284193, "body": "Maybe use something different than your question text - call out that <code>rCell.ClearContents</code> does the trick? Otherwise glad your problem is solved."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565813644, "post_id": 57401295, "comment_id": 101472152, "body": "Yeah, just making it say rCell.ClearContents made the code work.  Thanks for the help!"}], "tags": [], "owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "is_accepted": true, "score": 0, "last_activity_date": 1565206798, "creation_date": 1565206798, "answer_id": 57401295, "question_id": 57400471, "link": "https://stackoverflow.com/questions/57400471/i-am-creating-a-loop-to-find-specific-text-and-paste-it-in-a-newly-created-row/57401295#57401295", "title": "I am creating a loop to find specific text and paste it in a newly created row", "body": "<p>I am seeking to find Recommendations only in column A. Once I find each Recommendation I want to insert a row below. In that new row I want to paste the recommendation, but over one column (column B).</p>\n\n<p>My code finds each Recommendation and creates a column and pastes the Recommendation text. The problem is Recommendation is pasted where I want it, then each proceeding recommendation is pasted further up.</p>\n\n<p>e.g. Recommendation 1 is offset(1,1) Recommendation 2 is offset (-1,-1) Recommendation 3 is offset (-2, -2).</p>\n\n<p>I'm not sure why this is occurring. I think my text is correct.</p>\n\n<pre><code>Sub Un_Adjust_Recommendations_EAFE()\n\nDim rCell As Range\nDim rRng As Range\n\nWith Sheets(\"EAFE\")\nSet rRng = .Range(\"A1:A1000\")\nEnd With\n\nSet rCell = rRng.Find(What:=\"Recommendation\", LookIn:=xlFormulas, _\n             LookAt:=xlPart, SearchOrder:=xlByRows, \nSearchDirection:=xlNext, _\n             MatchCase:=True)\nIf Not rCell Is Nothing Then\nDo\nrCell.Offset(1, 0).EntireRow.Insert\nrCell.Offset(1, 1).Value = rCell.Value\nrCell.ClearContents\nSet rCell = rRng.Find(\"Recommendation\")\nLoop Until rCell Is Nothing\nEnd If\n\nSheets(\"Macro\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1565209988, "creation_date": 1565209988, "answer_id": 57401954, "question_id": 57400471, "link": "https://stackoverflow.com/questions/57400471/i-am-creating-a-loop-to-find-specific-text-and-paste-it-in-a-newly-created-row/57401954#57401954", "title": "I am creating a loop to find specific text and paste it in a newly created row", "body": "<p>Another option is to loop thru each cell from the last row up.</p>\n\n<pre><code>With Sheets(\"EAFE\")\n    For i = .Cells(.Rows.Count, 1).End(xlUp).Row To 2 Step -1\n        If .Cells(i, 1).Value = \"Recommendation\" Then\n\n        'Or if \"Recommendation\" is part of a string, you can use\n        'If .Cells(i, 1).Value Like \"*Recommendation*\" Then\n\n            .Cells(i, 1).Offset(1).EntireRow.Insert\n            .Cells(i, 1).Offset(1, 1).Value = Cells(i, 1).Value\n            .Cells(i, 1).ClearContents\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57401295, "answer_count": 2, "score": 0, "last_activity_date": 1565209988, "creation_date": 1565203064, "question_id": 57400471, "link": "https://stackoverflow.com/questions/57400471/i-am-creating-a-loop-to-find-specific-text-and-paste-it-in-a-newly-created-row", "title": "I am creating a loop to find specific text and paste it in a newly created row", "body": "<p>I am seeking to find Recommendations only in column A.  Once I find each Recommendation I want to insert a row below.  In that new row I want to paste the recommendation, but over one column (column B).</p>\n\n<p>My code finds each Recommendation and creates a column and pastes the Recommendation text.  The problem is Recommendation is pasted where I want it, then each proceeding recommendation is pasted further up.</p>\n\n<p>e.g. Recommendation 1 is offset(1,1)\nRecommendation 2 is offset (-1,-1)\nRecommendation 3 is offset (-2, -2).</p>\n\n<p>I'm not sure why this is occurring.  I think my text is correct.</p>\n\n<pre><code>Sub Un_Adjust_Recommendations_EAFE()\n\nDim rCell As Range\nDim rRng As Range\n\nWith Sheets(\"EAFE\")\nSet rRng = .Range(\"A1:A1000\")\nEnd With\n\nSet rCell = rRng.Find(What:=\"Recommendation\", LookIn:=xlFormulas, _\n                 LookAt:=xlPart, SearchOrder:=xlByRows, \nSearchDirection:=xlNext, _\n                 MatchCase:=True)\nIf Not rCell Is Nothing Then\nDo\n    rCell.Offset(1, 0).EntireRow.Insert\n    rCell.Offset(1, 1).Value = rCell.Value\n    rCell.Delete\n    Set rCell = rRng.Find(\"Recommendation\")\nLoop Until rCell Is Nothing\nEnd If\n\nSheets(\"Macro\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565219365, "post_id": 57400389, "comment_id": 101288031, "body": "Sorry, you&#39;ll have to find a different way to store the text to retain all formatting. Word&#39;s built-in AutoText/Building Blocks feature already does this. Or you could write formatted text to RTF files, then store the paths to those in an array."}, {"owner": {"reputation": 65, "user_id": 7491372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b493217c259c9b2b66a487cdd11c207?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruva", "link": "https://stackoverflow.com/users/7491372/dhruva"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565229989, "post_id": 57400389, "comment_id": 101289989, "body": "Thank you for guidance. Unfortunately I am newbie in VBA, and I dont have knowledge of auotext/building blocks. Can you please provide any code, how to do that. Thanks"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565261925, "post_id": 57400389, "comment_id": 101302117, "body": "Familiarize yourself with the functionality in the Word UI, first. Insert-&gt;Quick Parts is the starting point. That said, it&#39;s not clear why you&#39;d need to duplicate all the paragraphs in the document at the end of the document? There might be a better way, but it&#39;s unclear what you&#39;re actually trying to achieve..."}], "owner": {"reputation": 65, "user_id": 7491372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b493217c259c9b2b66a487cdd11c207?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruva", "link": "https://stackoverflow.com/users/7491372/dhruva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1582696402, "creation_date": 1565202692, "last_edit_date": 1582696402, "question_id": 57400389, "link": "https://stackoverflow.com/questions/57400389/how-to-store-contents-of-all-paragraph-as-array-elements-in-vba-without-losing-i", "title": "How to store contents of all paragraph as array elements in VBA without losing its formatting", "body": "<p>I want to store ms word document paragraphs as array elements in VBA and display them in the end of document. My program is displaying values as text format only and removing all formattings like bold, italic and images.</p>\n\n<p>I want to preserve the original paragraph formattings and display in bottom.I am trying since several hours but no success. </p>\n\n<p>I want to do this by storing each paragraph as array elements. </p>\n\n<p>Below is my code</p>\n\n<pre><code>Sub Data2Array()\n\n    Dim MyArray() As Variant\n    Dim insertPosition As Range\n    Dim inputWord As Variant\n\n    Total = ActiveDocument.Paragraphs.Count\n    MsgBox Total\n\n    For I = 1 To Total\n\n    Set para = ActiveDocument.Paragraphs(I).Range\n        para.Select\n        ReDim Preserve MyArray(I)\n        MyArray(I) = Selection.Range\n        MsgBox MyArray(I)\n\n    Next I\n\n     Set insertPosition = ActiveDocument.Range\n     For Each inputWord In MyArray\n        insertPosition.Collapse wdCollapseEnd\n        insertPosition = inputWord &amp; vbCrLf\n    Next\n\n\nEnd Sub\n\n</code></pre>\n\n<p>Kindly guide how can I store paragraphs content with its complete formatting in array.</p>\n"}, {"tags": ["excel", "vba", "macos", "multiple-columns"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1565202379, "post_id": 57400291, "comment_id": 101282162, "body": "Add the code you use to paste within the same worksheet"}, {"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1565202411, "post_id": 57400291, "comment_id": 101282174, "body": "The code that you use that copy/pastes from within the same worksheet.  Does it have references (i.e.: <code>(1, 4)</code>, or <code>(A1)</code>) or anything like that?  <a href=\"https://stackoverflow.com/posts/57400291/edit\">Edit</a> that code into your question, I think we can help you by using your existing code to explain."}, {"owner": {"reputation": 7, "user_id": 11825236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb7b12a1aa07150650dfef33032b02d?s=128&d=identicon&r=PG&f=1", "display_name": "pg123", "link": "https://stackoverflow.com/users/11825236/pg123"}, "edited": false, "score": 0, "creation_date": 1565202769, "post_id": 57400291, "comment_id": 101282321, "body": "I&#39;ve added some code somebody else pointed me to to my original question."}], "owner": {"reputation": 7, "user_id": 11825236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb7b12a1aa07150650dfef33032b02d?s=128&d=identicon&r=PG&f=1", "display_name": "pg123", "link": "https://stackoverflow.com/users/11825236/pg123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581926948, "creation_date": 1565202280, "last_edit_date": 1581926948, "question_id": 57400291, "link": "https://stackoverflow.com/questions/57400291/how-can-i-paste-data-only-to-visible-cells", "title": "How can I paste data only to visible cells?", "body": "<p>I have a worksheet ('Sheet 1 ') where I have hidden two columns. I would like to copy data from another workbook and paste it into Sheet 1 but only into the visible cells i.e. all cells in the respective rows excluding the two columns I have hidden. </p>\n\n<p>I understand that there is a manual way to paste specially into visible cells only but since the amount of data to be copied is large and takes multiple rounds, I am looking for a way to automate this process. Essentially, forcing all entries pasted into the worksheet to skip the hidden columns and paste only to the visible ones. </p>\n\n<p>I also have code that allows me to copy and paste from within the same worksheet but not from a different workbook. </p>\n\n<p>Any pointers?</p>\n\n<p>Edit: I have added some code I found online which worked for within the same worksheet here. But this prompts the user to select an input range and output range and works within that. </p>\n\n<pre><code>Sub CopyFilteredCells()\n\nDim rng1 As Range\nDim rng2 As Range\nDim InputRng As Range\nDim OutRng As Range\nDim n As Integer\nxTitleId = \"Example\"\nSet InputRng = Application.Selection\nSet InputRng = Application.InputBox(\"Copy Range :\", xTitleId, InputRng.Address, Type:=8)\nSet OutRng = Application.InputBox(\"Paste Range:\", xTitleId, Type:=8)\n    For Each rng2 In OutRng\n        If rng2.EntireColumn.ColumnWidth &gt; 0 Then\n           If rng2.EntireColumn.Hidden Then\n           Else\n                n = n + 1\n                rng2 = InputRng.Cells(1, n)\n            End If\n        End If\n    Next\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1565202126, "post_id": 57400219, "comment_id": 101282055, "body": "What do you mean by &quot;refer the range of selection to any specific sheet&quot;? Sheet1 must be active for you to select a range on it, so you can&#39;t click a button on Sheet2 and maintain that selection. A selection is on the active sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1565202247, "post_id": 57400219, "comment_id": 101282106, "body": "<code>Selection</code> is based on the active sheet, so (and I cannot believe I am saying this) you need to activate Sheet1 before setting the range."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565250101, "post_id": 57400219, "comment_id": 101295742, "body": "Sorry @P\u1d07\u029c. I&#39;ve taken out my comment."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565206070, "post_id": 57400942, "comment_id": 101283848, "body": "Another option is to use <code>Application.InputBox</code> to allow the user to select the range."}], "tags": [], "owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "is_accepted": false, "score": 0, "last_activity_date": 1565206288, "last_edit_date": 1565206288, "creation_date": 1565205201, "answer_id": 57400942, "question_id": 57400219, "link": "https://stackoverflow.com/questions/57400219/cant-refer-the-range-of-selection-to-any-specific-sheet/57400942#57400942", "title": "Can&#39;t refer the range of selection to any specific sheet", "body": "<p>As others have already mentioned, the \"Application.Selection\" property will refer to what you have selected in your active sheet. I would recommend that you assign a hotkey to this macro and then you can select the cells you want to print and use the macro's hotkey. </p>\n\n<p>This is one possible solution, but if you need that button on a different sheet and want people to interact with the button (rather than a hotkey) then this won't solve your issue.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10817840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x8wzYcNyeg4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbXUDmq5zX8kLG43HQ98Y701uaxqg/mo/photo.jpg?sz=128", "display_name": "Jim McDowell", "link": "https://stackoverflow.com/users/10817840/jim-mcdowell"}, "is_accepted": false, "score": 0, "last_activity_date": 1565208471, "last_edit_date": 1565208471, "creation_date": 1565207998, "answer_id": 57401555, "question_id": 57400219, "link": "https://stackoverflow.com/questions/57400219/cant-refer-the-range-of-selection-to-any-specific-sheet/57401555#57401555", "title": "Can&#39;t refer the range of selection to any specific sheet", "body": "<p>This should help with the issue of two different tabs</p>\n\n<pre><code>Sub DUMMY_TEST()\n\nDim myAREA As Range\nDim mySELECTION As Range\n\nOn Error GoTo error_spot\n\n'Stop Excel from \"blinking\" as tabs are selected/changed and calculating.\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nSet mySELECTION = Application.Selection  'Used to get back to same spot after code has executed\n\n\nIf Sheets(\"Sheet1\").Visible = True Then\n    Sheets(\"Sheet1\").Activate\nElse\n    'tab not visible, end sub\n    GoTo error_spot\nEnd If\n\n\nSet myAREA = Application.Selection\n\nFor Each ocel In myAREA.Cells\n        Debug.Print ocel.Address, ocel.Value\n    Next ocel\n\n\nmySELECTION.Worksheet.Activate\nmySELECTION.Select\n\nerror_spot:\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565246356, "creation_date": 1565201987, "last_edit_date": 1565246356, "question_id": 57400219, "link": "https://stackoverflow.com/questions/57400219/cant-refer-the-range-of-selection-to-any-specific-sheet", "title": "Can&#39;t refer the range of selection to any specific sheet", "body": "<p>I've created a macro to print the range of cells and it's content in the console. The macro is doing just fine. However, the problem is I can't use a button (in another sheet) conected to that macro. To be clearer - I created a macro-enabled button in <code>sheet2</code> whereas the range of cells I wanaa select and print are within <code>sheet1</code>.</p>\n\n<p>I've tried so far:</p>\n\n<pre><code>Sub LoopAndPrintSelection()\n\n    Dim ocel As Range, RangeSelected As Range\n\n    Set RangeSelected = Application.Selection\n\n    For Each ocel In RangeSelected.Cells\n        Debug.Print ocel.Address, ocel.value\n    Next ocel\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>How can I refer the range of selection to any specific sheet?</em></strong></p>\n"}, {"tags": ["excel", "vba", "crash", "move", "worksheet-function"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 3, "creation_date": 1565202230, "post_id": 57400210, "comment_id": 101282102, "body": "Additionally, I would suggest reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1565202580, "post_id": 57400210, "comment_id": 101282246, "body": "@Marcucciboy2 if you don&#39;t specify where to move it to, the sheet gets moved to a new workbook. But I completely and 100% agree with avoiding <code>Select</code>, can&#39;t emphasize that enough."}], "owner": {"reputation": 1, "user_id": 11385605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef966bcb5251cfde81836fcaf04e8a0?s=128&d=identicon&r=PG&f=1", "display_name": "JackDD", "link": "https://stackoverflow.com/users/11385605/jackdd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565246334, "creation_date": 1565201963, "last_edit_date": 1565246334, "question_id": 57400210, "link": "https://stackoverflow.com/questions/57400210/macro-continually-crashes-at-sheets-move-cant-debug", "title": "Macro continually crashes at Sheets.Move. Can&#39;t debug", "body": "<p>My macro works with a large (10,000 row) spreadsheet to sort, delete, paste, and resave the data. When I get to the \"Sheets.Select\" and \"Sheets.Move\" of the new spreadsheet I am trying to create, the code crashes.</p>\n\n<p>When I step through the code, the macro works. If I put in a \"Debug.Assert False\" command at the beginning of the code, the command box does come up, and I click \"Continue\" and the macro runs correctly to the end. Can't debug because the step-through works fine.</p>\n\n<pre><code>'Rename OEM List (2)\n\nDim QuoteNo As String\nSheets(\"OEM List (2)\").Select\nRange(\"B11\").Select\nQuoteNo = ActiveCell.Value\nActiveSheet.Name = QuoteNo &amp; \" - OEM List\"\n\nRange(\"A1\").Select\n\nDim wsA As Worksheet\nDim strName As String\nDim strFile As String\nDim strPathFile As String\n\nSet wsA = ActiveSheet\n\n'Format all rows\n\nRows(\"17:8042\").Select\nRows(\"17:8042\").EntireRow.AutoFit\n\n'Export with no copy newly named \"Quote *\"\n\n'MACRO EITHER CRAHSHES HERE\n\nSheets(QuoteNo &amp; \" - OEM List\").Select\n\n'OR HERE\n\nSheets(QuoteNo &amp; \" - OEM List\").Move\n\n'OR HERE\n</code></pre>\n\n<p>The macro is supposed to take the newly created and named spreadsheet, move it to a new workbook, save the workbook with a saved name, close this new workbook, re-save the original workbook and end.</p>\n\n<p>When I step through the code, the macro works. If I put in a \"Debug.Assert False\" command and run the macro, when the code gets to the .Select or the .Move lines, the command box comes up, I click \"Continue\" and the macro runs correctly to the end. Can't debug because the step-through works fine.</p>\n\n<pre><code>'Rename OEM List (2)\n\nDim QuoteNo As String\nSheets(\"OEM List (2)\").Select\nRange(\"B11\").Select\nQuoteNo = ActiveCell.Value\nActiveSheet.Name = QuoteNo &amp; \" - OEM List\"\n\nRange(\"A1\").Select\n\nRows(\"17:8042\").Select\nRows(\"17:8042\").EntireRow.AutoFit\n\nDim wsA As Worksheet\nDim strName As String\nDim strFile As String\nDim strPathFile As String\n\nSet wsA = ActiveSheet\n\n'Export with no copy newly named \"Quote *\"\n\n'THE MACRO EITHER CRASHES HERE,\n\nSheets(QuoteNo &amp; \" - OEM List\").Select\n\n'OR HERE\n\nSheets(QuoteNo &amp; \" - OEM List\").Move\n</code></pre>\n\n<p>The macro is supposed to take the newly created and named spreadsheet, move it to a new workbook, save the workbook with a saved name, close this new workbook, re-save the original workbook and end.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1565200922, "post_id": 57399917, "comment_id": 101281582, "body": "Are your dates in Sheet13.Range(&quot;A:A&quot;) stored as dates or text.  Excel dates are actually numbers, not text.   You seem to be trying a text match with a date field."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1565208518, "post_id": 57399917, "comment_id": 101284814, "body": "Try:  <code>After:= .Cells(1,1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1565202771, "post_id": 57400151, "comment_id": 101282322, "body": "Shai Rado the solution above throws a type mismatch exception when trying to execute the find statement."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1565202826, "post_id": 57400151, "comment_id": 101282351, "body": "@StormsEdge did you define <code>Dim searchCell  as Range</code> ?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1565203281, "post_id": 57400151, "comment_id": 101282587, "body": "Yes.  searchCell is a range and searchString is a date.  It was a string when I first started.  Neither appear to work"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1565201689, "creation_date": 1565201689, "answer_id": 57400151, "question_id": 57399917, "link": "https://stackoverflow.com/questions/57399917/searching-for-dates-in-column-in-vba/57400151#57400151", "title": "Searching for Dates in Column in VBA", "body": "<p>You need to match the date (stored as number value in Excel):</p>\n\n<pre><code>Dim DateVal As Date\n\nDateVal = Sheet3.Cells(5, 4).Value\n\nWith Sheet13.Range(\"A:A\")\n    Set searchCell = .Find(What:=DateVal, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows)\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1565208848, "creation_date": 1565208848, "answer_id": 57401716, "question_id": 57399917, "link": "https://stackoverflow.com/questions/57399917/searching-for-dates-in-column-in-vba/57401716#57401716", "title": "Searching for Dates in Column in VBA", "body": "<p>Another example of how using references like <code>ActiveAnything</code> can lead to errors.</p>\n\n<p>In your code, if <code>ActiveCell</code> doesn't happen to be in sheet13 column A, your code will error.</p>\n\n<p>Change to <code>After:=.Cells(1,1)</code> or something similar so you ensure you are starting with some cell within in the column you are using as the SearchRange.</p>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565246254, "creation_date": 1565200634, "last_edit_date": 1565246254, "question_id": 57399917, "link": "https://stackoverflow.com/questions/57399917/searching-for-dates-in-column-in-vba", "title": "Searching for Dates in Column in VBA", "body": "<p>I am trying to search for a date in a column in VBA.  I have verified that the value exists within the column and I have also formatted the date to be that of the dates in the reference column.  Have been scratching my head and i'm not sure what i'm doing wrong.  I've seen several questions related to this, and I have even mirrored one of the solutions, which has not worked.</p>\n\n<p>Notes:\n1) All dates are stored in column 1 (A) 2) Date format is \"m/d/yyyy\" 3) Sheet 13 is where the range lives 4) I also have a named range that contains the date i'm searching for and I access that range by referencing the cell rather than the named range since VBA doesn't seem to like that.  Any thoughts?</p>\n\n<pre><code>    searchString = Format(Sheet3.Cells(5, 4).Value, \"m/d/yyyy\")\n\n    With Sheet13.Range(\"A:A\")\n\n        Set searchCell = .Find(What:=CDate(searchString), After:=ActiveCell, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565200465, "post_id": 57399866, "comment_id": 101281388, "body": "<code>If Worksheets(I).Name &lt;&gt; &quot;Master&quot; Then</code> - add after <code>For I = 1 To wsCount</code>. Then add an <code>End If</code> before <code>Next I</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565246187, "post_id": 57399866, "comment_id": 101293886, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 25, "user_id": 11897674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b10ca1c05e6e8a855ad732e12973b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Hoo", "link": "https://stackoverflow.com/users/11897674/dr-hoo"}, "edited": false, "score": 0, "creation_date": 1565255622, "post_id": 57399866, "comment_id": 101298581, "body": "Hi BigBen,  I tried that but must have been entering it in the wrong place. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1565295644, "creation_date": 1565295644, "answer_id": 57420034, "question_id": 57399866, "link": "https://stackoverflow.com/questions/57399866/copy-and-paste-loop-that-ignores-the-master-sheet/57420034#57420034", "title": "Copy and paste loop that ignores the master sheet", "body": "<p>If the master sheet is your first sheet, you can change your for loop to start at the second sheet.</p>\n\n<p>Your code would now be:</p>\n\n<pre><code>Public Sub moveData()\n\nDim wsCount As Integer\nDim I As Integer\n\nwsCount = ActiveWorkbook.Worksheets.Count\n\nFor I = 2 To wsCount\n    Worksheets(I).Activate\n    CurrLastRow = Sheets(i).Cells(Rows.Count, 1).End(xlUp).Row 'This will find the last row on the current sheet\n    Sheets(I).Range(\"A2:O\" &amp; CurrLastRow).Copy\n    Sheets(\"Master\").Activate\n    Sheets(\"Master\").Range(\"A2\").End(xlDown).Offset(1, 0).Select \n    Selection.PasteSpecial Paste:=xlPasteValues\nNext I\n\nEnd Sub\n</code></pre>\n\n<p>If your master sheet is not the first sheet, I suggest moving it there in order to use the above code. </p>\n"}], "owner": {"reputation": 25, "user_id": 11897674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b10ca1c05e6e8a855ad732e12973b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Hoo", "link": "https://stackoverflow.com/users/11897674/dr-hoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "closed_date": 1565445077, "accepted_answer_id": 57420034, "answer_count": 1, "score": 0, "last_activity_date": 1565295644, "creation_date": 1565200409, "last_edit_date": 1565246173, "question_id": 57399866, "link": "https://stackoverflow.com/questions/57399866/copy-and-paste-loop-that-ignores-the-master-sheet", "closed_reason": "Duplicate", "title": "Copy and paste loop that ignores the master sheet", "body": "<p>I have been trying to make a simple loop that cycles through a group of worksheets that contain data and paste them onto a master sheet. \nThe amount of sheets can vary depending on how many people use it (1 sheet per user) and the amount of rows can too (depending on how much work is allocated), however the amount of columns will remain the same. \nEssentially I'm trying to transfer whatever is populated on user's sheets on to a master for reporting purposes. I have been trying to piece together bits of code without success</p>\n\n<pre><code>Public Sub moveData()\n    Dim wsCount As Integer\n    Dim I As Integer\n\n\u00a0\u00a0  wsCount = ActiveWorkbook.Worksheets.Count\n\n\u00a0\u00a0\u00a0 For I = 1 To wsCount\n\u00a0\u00a0\u00a0\u00a0    Worksheets(I).Activate\n\u00a0\u00a0\u00a0     Range(\"A2:O4\").Select\n\u00a0\u00a0\u00a0     Application.Selection.Copy\n\u00a0\u00a0\u00a0     Sheets(\"Master\").Activate\n\u00a0\u00a0      ActiveSheet.Range(\"A2\").End(xlDown).Offset(1, 0).Select \n\u00a0\u00a0\u00a0     Selection.PasteSpecial Paste:=xlPasteValues\n\u00a0\u00a0\u00a0\u00a0Next I\nEnd Sub\n</code></pre>\n\n<p>However, whenever its ran it copies the master too. Is there a way of getting it to ignore the master and just paste into it?\nThank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1565199628, "post_id": 57399686, "comment_id": 101281019, "body": "Are you asking how to update <code>LastRow</code> after each copy?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1565199810, "post_id": 57399686, "comment_id": 101281101, "body": "You will need to put <code>LastRow = .Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code> before each use of last row to keep getting new last rows"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1565200182, "creation_date": 1565200182, "answer_id": 57399823, "question_id": 57399686, "link": "https://stackoverflow.com/questions/57399686/vba-lastrow-pasting-on-top-of-eachother/57399823#57399823", "title": "VBA &quot;LastRow&quot; pasting on top of eachother?", "body": "<p>Since you are pasting data from different points directly after each other that will naturally change the last row after each copy, so you have to account for that in the code.</p>\n\n<p>Try something like the below instead.</p>\n\n<pre><code>If wsFILLS.Range(\"C8\") &gt; 0 Then wsFILLS.Range(\"B4:C9\").Copy wsINPUTS.Range(\"A\" &amp; wsInputs.Rows.Count).End(xlUp).Offset(1)\n\nIf wsFILLS.Range(\"C16\").Value &gt; 0 Then wsFILLS.Range(\"B11:C16\").Copy wsINPUTS.Range(\"A\" &amp; wsInputs.Rows.Count).End(xlUp).Offset(1)\n\nIf wsFILLS.Range(\"C23\").Value &gt; 0 Then wsFILLS.Range(\"B18:C23\").Copy wsINPUTS.Range(\"A\" &amp; &amp; wsInputs.Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1565200373, "creation_date": 1565200373, "answer_id": 57399862, "question_id": 57399686, "link": "https://stackoverflow.com/questions/57399686/vba-lastrow-pasting-on-top-of-eachother/57399862#57399862", "title": "VBA &quot;LastRow&quot; pasting on top of eachother?", "body": "<p>Taking what you wrote and putting into a more compact form that recalculates the lastrow variable each time it's needed.</p>\n\n<pre><code>If wsFILLS.Range(\"C8\") &gt; 0 Then wsFILLS.Range(\"B4:C9\").Copy (wsINPUTS.Range(\"A\" &amp; wsINPUTS.Cells(Rows.Count, \"A\").End(xlUp).Row +1))\n\nIf wsFILLS.Range(\"C16\").Value &gt; 0 Then  wsFILLS.Range(\"B11:C16\").Copy (wsINPUTS.Range(\"A\" &amp; wsINPUTS.Cells(Rows.Count, \"A\").End(xlUp).Row +1))\n\nIf wsFILLS.Range(\"C23\").Value &gt; 0 Then  wsFILLS.Range(\"B18:C23\").Copy (wsINPUTS.Range(\"A\" &amp; wsINPUTS.Cells(Rows.Count, \"A\").End(xlUp).Row +1))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6556283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b823f328dc72c4bf6e03acc78e314a?s=128&d=identicon&r=PG&f=1", "display_name": "Calzone", "link": "https://stackoverflow.com/users/6556283/calzone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57399823, "answer_count": 2, "score": 0, "last_activity_date": 1565200373, "creation_date": 1565199490, "last_edit_date": 1565199697, "question_id": 57399686, "link": "https://stackoverflow.com/questions/57399686/vba-lastrow-pasting-on-top-of-eachother", "title": "VBA &quot;LastRow&quot; pasting on top of eachother?", "body": "<p>I have two workbooks here, and I've named each of the worksheets I'm working on: <code>wsINPUTS</code> and <code>wsFILLS</code>. I'm trying to copy values from <code>wsFILLS</code> onto <code>wsINPUTS</code> only if there is a value >0 in a particular cell. I want to copy onto <code>wsINPUTS</code> starting on <code>A2</code> and then pasting any other values directly below the previous pasted values.</p>\n\n<p>Right now, my code is  copying the data and pasting it in the <code>INPUTS</code> worksheet on top of each other in <code>A2</code> instead of pasting directly below it. Help!</p>\n\n<pre><code>With wsINPUTS\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    LastRow = LastRow + 1\nEnd With\n\n    If wsFILLS.Range(\"C8\") &gt; 0 Then wsFILLS.Range(\"B4:C9\").Copy (wsINPUTS.Range(\"A\" &amp; LastRow))\n\n    If wsFILLS.Range(\"C16\").Value &gt; 0 Then wsFILLS.Range(\"B11:C16\").Copy (wsINPUTS.Range(\"A\" &amp; LastRow))\n\n    If wsFILLS.Range(\"C23\").Value &gt; 0 Then wsFILLS.Range(\"B18:C23\").Copy (wsINPUTS.Range(\"A\" &amp; LastRow))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1565198619, "post_id": 57399457, "comment_id": 101280568, "body": "You just do <code>Dim x, y, z</code>. This will make <i>all</i> of those the <code>Variant</code> type. Instead, it&#39;s recommended that you declare each variable to be what you need them for, e.g. <code>Dim i as Long, j as Long, arrInflation_Bucket as Range</code>, etc...That will help a little bit because I&#39;m thinking when you just call <code>Dim x &#47; x = Range(&quot;A1:A10&quot;)</code>, it might use that <i>Value</i> and not <i>Range</i>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1565207788, "post_id": 57399457, "comment_id": 101284548, "body": "You never dim <code>arrInflation_Label_Match</code> or <code>arrInflation_Quarter_Match</code> as arrays, yet you access them as arrays. The error 13 though is most likely from the fact that <code>Application.Match</code> <a href=\"https://stackoverflow.com/a/18064104/11683\">returns Variant/Error</a> when it does not find anything, and trying to store that in an inappropriate place results in that error."}, {"owner": {"reputation": 11, "user_id": 2215923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f55290cbf1ce9de0b5a3595a17d315?s=128&d=identicon&r=PG", "display_name": "Silverjman", "link": "https://stackoverflow.com/users/2215923/silverjman"}, "edited": false, "score": 0, "creation_date": 1565366096, "post_id": 57399457, "comment_id": 101345033, "body": "Thanks guys, that helped move my debug along"}, {"owner": {"reputation": 11, "user_id": 2215923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f55290cbf1ce9de0b5a3595a17d315?s=128&d=identicon&r=PG", "display_name": "Silverjman", "link": "https://stackoverflow.com/users/2215923/silverjman"}, "edited": false, "score": 0, "creation_date": 1565366425, "post_id": 57399457, "comment_id": 101345200, "body": "I kept arrInflation_Bucket as VAriant because when I Dimmed as Range it gave me a Expected Array error on its redim line."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2215923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f55290cbf1ce9de0b5a3595a17d315?s=128&d=identicon&r=PG", "display_name": "Silverjman", "link": "https://stackoverflow.com/users/2215923/silverjman"}, "is_accepted": false, "score": 0, "last_activity_date": 1565948502, "creation_date": 1565948502, "answer_id": 57522351, "question_id": 57399457, "link": "https://stackoverflow.com/questions/57399457/indexmatch-match-in-vba-type-13-type-mismatch/57522351#57522351", "title": "INDEX(MATCH, MATCH) in VBA (Type 13 Type mismatch)", "body": "<p>OK, so I caved like a you know what and asked my genius friend for help with this. His fantastic code is below:</p>\n\n<pre><code>Function firstMatchInRow(ByVal val, arr, ByVal col As Long) As Long\n    Dim i As Long\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        If arr(i, col) = val Then firstMatchInRow = i: Exit Function\n    Next i\nEnd Function\n\nSub Costs__Repossession_Costs()\n\n    Dim i As Long, j As Long, tempLabelMatch As Long\n    Dim arrInflation_Bucket, arrInflation_Bucket_Label, arrNumber_of_Assets, arrQuarters, arrInflation_Cumulative, arrCosts__Repossession_Costs\n\n    arrQuarters = Range(\"Quarters_1to40\")\n    arrInflation_Bucket = Range(\"Costs.Inflation_Bucket\").Value\n    arrInflation_Bucket_Label = Range(\"Inflation.Inflation_Bucket_Label\").Value\n    arrInflation_Cumulative = Range(\"Inflation.Cumulative\").Value ' + add values\n\n    ReDim arrCosts__Repossession_Costs(1 To UBound(arrInflation_Cumulative, 1), 1 To UBound(arrQuarters, 2))\n\n       For i = LBound(arrInflation_Bucket, 1) To UBound(arrInflation_Bucket, 1)\n            tempLabelMatch = firstMatchInRow(arrInflation_Bucket(i, 1), arrInflation_Bucket_Label, 1)\n            For j = LBound(arrInflation_Cumulative, 2) To UBound(arrInflation_Cumulative, 2)\n                arrCosts__Repossession_Costs(i, j) = arrInflation_Cumulative(tempLabelMatch, j)\n            Next j\n       Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2215923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f55290cbf1ce9de0b5a3595a17d315?s=128&d=identicon&r=PG", "display_name": "Silverjman", "link": "https://stackoverflow.com/users/2215923/silverjman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565948502, "creation_date": 1565198428, "last_edit_date": 1565948371, "question_id": 57399457, "link": "https://stackoverflow.com/questions/57399457/indexmatch-match-in-vba-type-13-type-mismatch", "title": "INDEX(MATCH, MATCH) in VBA (Type 13 Type mismatch)", "body": "<p>I'm trying to use an <code>INDEX(MATCH,MATCH)</code> to recreate this formula:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>INDEX(Inflation!H$129:H$188,MATCH($J10,Inflation!$C$129:$C$188,0))\n</code></pre>\n\n<p>You may notice that the columns are not locked on the INDEX array field <code>Inflation!H$129:H$188</code>. I didn't know how to move over one column so I thought I would use an <code>INDEX(MATCH,MATCH)</code>.</p>\n\n<p>With my code below I get a error 13 Type Mismatch even if I swap out <code>arrInflation_Bucket(I, 1)</code> for \"EWIP\", a known entry in the searched range.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Costs__Repossession_Costs()\n    Dim I, J, arrInflation_Bucket, arrInflation_Bucket_Label, arrNumber_of_Assets, arrQuarters, arrInflation_Label_Match, arrInflation_Quarter_Match\n\n    arrNumber_of_Assets = Range(\"Costs.Number_of_Assets\")\n    arrQuarters = Range(\"Quarters_1to40\")\n    arrInflation_Bucket = Range(\"Costs.Inflation_Bucket\")\n    arrInflation_Bucket_Label = Range(\"Inflation.Inflation_Bucket_Label\")\n\n    ReDim arrCosts__Repossession_Costs(1 To UBound(arrNumber_of_Assets, 1), 1 To UBound(arrQuarters, 2))\n\n    For I = LBound(arrInflation_Bucket, 1) To UBound(arrInflation_Bucket, 1)\n        For J = LBound(arrQuarters, 2) To UBound(arrQuarters, 2)\n\n            arrInflation_Label_Match(I, J) = Application.Match(arrInflation_Bucket(I, 1), Range(\"Inflation.Inflation_Bucket_Label\"), 0)\n\n            arrInflation_Quarter_Match(I, J) = Application.WorksheetFunction.Match(arrQuarters(1, J), Range(\"Quarters_1to40\"), 0)\n\n            arrCosts__Repossession_Costs(I, J) = Application.WorksheetFunction.Index(Range(\"Inflation.Cumulative\"), arrInflation_Label_Match, arrInflation_Quarter_Match)\n\n        Next J\n    Next I\nEnd Sub\n</code></pre>\n\n<p>This is by far the most complicated formula I will need to do in VBA so if I can get this it should be all smooth sailing.</p>\n\n<p>OK, I've updated the code with he instructions of the first two comments, very helpful. It is now performing the two matches correctly (used to error out on the first, but now gives me row 48 adn column 1 which is correct) but Now Type 13 errors on the INDEX().</p>\n\n<pre><code>    Sub Costs__Repossession_Costs()\n\nDim I As Long\nDim J As Long\nDim arrInflation_Bucket As Variant\n\nDim arrInflation_Bucket_Label, arrNumber_of_Assets, arrQuarters, arrInflation_Label_Match, arrInflation_Quarter_Match, arrInflation_Cumulative\n\narrNumber_of_Assets = Range(\"Costs.Number_of_Assets\")\narrQuarters = Range(\"Quarters_1to40\")\narrInflation_Bucket = Range(\"Costs.Inflation_Bucket\")\narrInflation_Bucket_Label = Range(\"Inflation.Inflation_Bucket_Label\")\narrInflation_Cumulative = Range(\"Inflation.Cumulative\")\n\nReDim arrCosts__Repossession_Costs(1 To UBound(arrNumber_of_Assets, 1), 1 To UBound(arrQuarters, 2)), _\n    arrInflation_Label_Match(1 To UBound(arrNumber_of_Assets, 1), 1 To UBound(arrQuarters, 2)), _\n    arrInflation_Quarter_Match(1 To UBound(arrNumber_of_Assets, 1), 1 To UBound(arrQuarters, 2))\n\n   For I = LBound(arrInflation_Bucket, 1) To UBound(arrInflation_Bucket, 1)\n      For J = LBound(arrQuarters, 2) To UBound(arrQuarters, 2)\n\n         arrInflation_Label_Match(I, J) = Application.Match(arrInflation_Bucket(I, 1), Range(\"Inflation.Inflation_Bucket_Label\"), 0)\n\n         arrInflation_Quarter_Match(I, J) = Application.WorksheetFunction.Match(arrQuarters(1, J), Range(\"Quarters_1to40\"), 0)\n\n         arrCosts__Repossession_Costs(I, J) = Application.WorksheetFunction.Index(arrInflation_Cumulative, arrInflation_Label_Match, arrInflation_Quarter_Match)\n\n      Next J\n   Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofill"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565198009, "post_id": 57399347, "comment_id": 101280305, "body": "The destination has to include the origin. From the look of your <code>Offset</code>s, I don&#39;t think <code>newVRow</code> and <code>oldVRow</code> overlap."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565198941, "post_id": 57399347, "comment_id": 101280740, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1528800/excel-vba-autofill-method-of-range-class-failed\">Excel VBA &quot;Autofill Method of Range Class Failed&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1565198828, "creation_date": 1565198828, "answer_id": 57399537, "question_id": 57399347, "link": "https://stackoverflow.com/questions/57399347/autofill-method-of-range-class-failed-what-am-i-missing/57399537#57399537", "title": "AutoFill method of range class failed, what am I missing?", "body": "<p>Modify:</p>\n\n<pre><code>Set newVRow = Range(newV.Offset(0, 1), newV.Offset(0, 8))\n</code></pre>\n\n<p>to include the row above:</p>\n\n<pre><code>Set newVRow = Range(newV.Offset(-1, 1), newV.Offset(0, 8))\n</code></pre>\n\n<p>and change:</p>\n\n<pre><code>newVRow.AutoFill Destination:=oldVRow, Type:=xlFillDefault\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>oldVRow.AutoFill Destination:=newVRow, Type:=xlFillDefault\n</code></pre>\n\n<p>You don't need to use all this <code>Select</code>:</p>\n\n<pre><code>'oldVRow.Select  ' comment this row\n'newVRow.Select  ' comment this row\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11897508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5e839aabda607633424b3f540424cd?s=128&d=identicon&r=PG&f=1", "display_name": "hrc00", "link": "https://stackoverflow.com/users/11897508/hrc00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 57399537, "answer_count": 1, "score": 1, "last_activity_date": 1565246164, "creation_date": 1565197907, "last_edit_date": 1565246164, "question_id": 57399347, "link": "https://stackoverflow.com/questions/57399347/autofill-method-of-range-class-failed-what-am-i-missing", "title": "AutoFill method of range class failed, what am I missing?", "body": "<p>I'm trying to auto fill a row of formulas to the row before it.</p>\n\n<p>I'm on excel 2010. I know that the ranges I'm using in the autofill function are the right ranges, I checked by adding in the select function and going line by line to make sure it selected the right ones.</p>\n\n<pre><code>Sub NewIC()\n\nDim v As Range, newV As Range, oldVRow As Range, newVRow As Range\nDim s As Range\nDim dc As Range\n\nWith Sheets(\"Charts\").Cells\n    'Inserting name into Vios\n    Set v = .Find(\"Vios\", LookIn:=xlValues)\n    If Not v Is Nothing Then\n        v.Select\n        ActiveCell.Offset(4, 0).Select\n\n        With Selection.EntireRow.Insert(xlShiftDown, xlFormatFromRightOrBelow)\n            Set newV = ActiveCell\n            Range(\"T1\").Copy newV\n            newV.Font.Bold = True\n        End With\n    End If\n\n    'Dragging up formulas\n    Set oldVRow = Range(newV.Offset(-1, 1), newV.Offset(-1, 8))\n    Set newVRow = Range(newV.Offset(0, 1), newV.Offset(0, 8))\n    oldVRow.Select\n    newVRow.Select\n\n    newVRow.AutoFill Destination:=oldVRow, Type:=xlFillDefault\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>All of the code works up until the last line. It sets the right cell as newV, sets the right ranges, but I get the error </p>\n\n<blockquote>\n  <p>Run-time error '1004' AutoFill method of Range class failed</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6792620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90571b6e24813cb5bc8bc8cd1d9cc19e?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6792620/albert"}, "edited": false, "score": 0, "creation_date": 1565202423, "post_id": 57400000, "comment_id": 101282179, "body": "good idea. However, this approach could result in repetition of code, I fear.  Hence my thought of processing through a class module. Any ideas there? I&#39;d use your approach as a last resort."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 61, "user_id": 6792620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90571b6e24813cb5bc8bc8cd1d9cc19e?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6792620/albert"}, "edited": false, "score": 0, "creation_date": 1565202953, "post_id": 57400000, "comment_id": 101282409, "body": "@Albert a class module could work, though you would still need to build a similar logic for 2 different scenarios, the left option buttons and the right option buttons.  it may benefit you to use a class module if you have <i>many</i> option buttons, but i would think that the standard approach (<code>for each</code> loop in your command button) would be similar logic to what would be in a class module.  your image lists 1/2/3 and 1/2 buttons, but you will be looking at actual names of 1/2/3/4/5, and you can build logic around that."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 61, "user_id": 6792620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90571b6e24813cb5bc8bc8cd1d9cc19e?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6792620/albert"}, "edited": false, "score": 0, "creation_date": 1565204184, "post_id": 57400000, "comment_id": 101283035, "body": "@Albert Edited to show how little additional code may be needed for the <code>for each</code> loop which precedes the other actions in the <code>commandbutton1_click</code>.  i just tested and that does work.  subjective, but it does have a &quot;little&quot; redundancy, however i feel it is in a way that is controlled and understandable."}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1565224812, "post_id": 57400000, "comment_id": 101289114, "body": "@Cyril if i am not wrong, CommandButton1 is initially disabled and the request is how to enable it when any option of the two options groups is selected. thus your code (Event CommandButton1_Click  ) can not be executed. correct me if i am wrong."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1565204096, "last_edit_date": 1565204096, "creation_date": 1565200958, "answer_id": 57400000, "question_id": 57399254, "link": "https://stackoverflow.com/questions/57399254/enable-a-button-after-a-user-chooses-an-option-from-each-of-two-option-groups/57400000#57400000", "title": "Enable a button after a user chooses an option from each of two option groups", "body": "<p>Standard approach is to use a <code>for each</code> loop to ensure that option buttons are clicked before moving on in the subroutine for the commandbutton_click.  </p>\n\n<pre><code>For each ctrl in userform1.controls\n    if typename(ctrl) = \"optionbutton\" then \n        'do something\n    end if\nnext ctrl\n</code></pre>\n\n<p>You could also assign a global variable once an option button is checked to ensure that you have both items both items marked, such as:</p>\n\n<pre><code>public o1 as string, o2 as string\n\nprivate sub optionbutton1_click()\n    o1 = \"x\"\nend sub\n\nprivate sub optionbutton2_click()\n    o2 = \"x\"\nend sub\n\nprivate sub commandbutton1_click()\n    if o1 = \"\" and o2 = \"\" then exit sub\n    o1 = \"\"\n    o2 = \"\"\n    'Put in rest of your code\nend sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Example of the for each loop... this isn't a class module, but is a few lines of code to determine which frame (f1 and f2 are frames 1 and 2) is filled in.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim ctrl As Control, f1 As Long, f2 As Long\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"OptionButton\" Then\n            If ctrl.Value = True Then\n                If Right(ctrl.Caption, 1) = 1 Or Right(ctrl.Caption, 1) = 2 Then f1 = 1\n                If Right(ctrl.Caption, 1) = 3 Or Right(ctrl.Caption, 1) = 4 Then f2 = 1\n            End If\n        End If\n    Next ctrl\n    If Not f1 + f2 = 2 Then Exit Sub\n    'do something\n    Unload Me\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": false, "score": 2, "last_activity_date": 1565202407, "creation_date": 1565202407, "answer_id": 57400320, "question_id": 57399254, "link": "https://stackoverflow.com/questions/57399254/enable-a-button-after-a-user-chooses-an-option-from-each-of-two-option-groups/57400320#57400320", "title": "Enable a button after a user chooses an option from each of two option groups", "body": "<p>I am  not sure if i clearly understood your request, but here is my solution\nassuming option buttons naming scheme is OptionButton#X#_group#Y#</p>\n\n<pre><code>Option Explicit\nDim Opt_group_1 As Long\nDim Opt_group_2 As Long\n\n\nPrivate Sub OptionsUpdated()\n    CommandButton1.Enabled = (Opt_group_1 &lt;&gt; 0 And Opt_group_2 &lt;&gt; 0)\nEnd Sub\nPrivate Sub OptionButton1_group1_Click()\n    Opt_group_1 = 1\n    Call OptionsUpdated\n\nEnd Sub\n\nPrivate Sub OptionButton1_group2_Click()\n    Opt_group_2 = 1\n    Call OptionsUpdated\n\nEnd Sub\n\nPrivate Sub OptionButton2_group1_Click()\n    Opt_group_1 = 2\n    Call OptionsUpdated\n\nEnd Sub\n\nPrivate Sub OptionButton2_group2_Click()\n    Opt_group_2 = 2\n    Call OptionsUpdated\nEnd Sub\n\nPrivate Sub OptionButton3_group1_Click()\n    Opt_group_1 = 3\n    Call OptionsUpdated\nEnd Sub\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 6792620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90571b6e24813cb5bc8bc8cd1d9cc19e?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6792620/albert"}, "edited": false, "score": 0, "creation_date": 1565203887, "post_id": 57400503, "comment_id": 101282871, "body": "perfect! Just what I was looking for. Thank you very much."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1565203588, "last_edit_date": 1565203588, "creation_date": 1565203184, "answer_id": 57400503, "question_id": 57399254, "link": "https://stackoverflow.com/questions/57399254/enable-a-button-after-a-user-chooses-an-option-from-each-of-two-option-groups/57400503#57400503", "title": "Enable a button after a user chooses an option from each of two option groups", "body": "<p>If you want to use class modules take this approach. I made to classes <code>optBtn</code> and <code>optBtns</code>\nThis is the class <code>optBtn</code></p>\n\n<pre><code>Option Explicit\nPrivate WithEvents mOptBtn As MSForms.OptionButton\nDim mSelected As Boolean\nDim mParent As optBtns\n\nPrivate Sub mOptBtn_Change()\n    mSelected = True\nEnd Sub\n\nProperty Get selected() As Boolean\n    selected = mSelected\nEnd Property\n\nProperty Set btn(nBtn As MSForms.OptionButton)\n    Set mOptBtn = nBtn\nEnd Property\n\nProperty Set parent(nParent As optBtns)\n    Set mParent = nParent\nEnd Property\n\nPrivate Sub mOptBtn_Click()\n    mParent.Raise\nEnd Sub\n</code></pre>\n\n<p>This is the class <code>optBtns</code></p>\n\n<pre><code>Option Explicit\nDim mOpt As Collection\nPublic Event Clicked()\n\nPublic Sub add(ByRef opt As optBtn)\n    mOpt.add opt\nEnd Sub\n\nPublic Sub Raise()\n    RaiseEvent Clicked\nEnd Sub\n\nPublic Function selected() As Boolean\nDim i As Long\n\n    For i = 1 To mOpt.Count\n        If mOpt(i).selected Then\n            selected = True\n            Exit For\n        End If\n    Next i\n\nEnd Function\n\nPrivate Sub Class_Initialize()\n    Set mOpt = New Collection\nEnd Sub\n</code></pre>\n\n<p>In the userform I have </p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents optGrp1 As optBtns\nPrivate WithEvents optGrp2 As optBtns\n\n\nPrivate Sub OptGrp1_Clicked()\n    MyAction\nEnd Sub\n\nPrivate Sub OptGrp2_Clicked()\n    MyAction\nEnd Sub\nPrivate Sub MyAction()\n    Debug.Print \"Event raied\"\n    If optGrp1.selected And optGrp2.selected Then\n        CommandButton1.Enabled = True\n    Else\n        CommandButton1.Enabled = False\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Dim sngOptBtn As optBtn\n    Dim i As Long\n\n    Set optGrp1 = New optBtns\n    Set optGrp2 = New optBtns\n\n    For i = 1 To 3\n        Set sngOptBtn = New optBtn\n        Set sngOptBtn.btn = Controls(\"Optionbutton\" &amp; i)\n        Set sngOptBtn.parent = optGrp1\n        optGrp1.add sngOptBtn\n\n    Next i\n\n    For i = 4 To 5\n        Set sngOptBtn = New optBtn\n        Set sngOptBtn.btn = Controls(\"Optionbutton\" &amp; i)\n        Set sngOptBtn.parent = optGrp2\n        optGrp2.add sngOptBtn\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>The userform looks like that</p>\n\n<p><a href=\"https://i.stack.imgur.com/USOEl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/USOEl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Name of the option buttons are just Optionbutton1 through to Optionbutton5</p>\n\n<p>Feel free to enhance the code.</p>\n"}], "owner": {"reputation": 61, "user_id": 6792620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90571b6e24813cb5bc8bc8cd1d9cc19e?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6792620/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 57400503, "answer_count": 3, "score": 1, "last_activity_date": 1568373531, "creation_date": 1565197488, "last_edit_date": 1568373531, "question_id": 57399254, "link": "https://stackoverflow.com/questions/57399254/enable-a-button-after-a-user-chooses-an-option-from-each-of-two-option-groups", "title": "Enable a button after a user chooses an option from each of two option groups", "body": "<p>I'm setting up a form to help users determine the data to input (option group 1) and the method of input (option group 2).</p>\n\n<p><a href=\"https://i.stack.imgur.com/EsgD7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EsgD7.png\" alt=\"Example form\"></a></p>\n\n<p>Once they have made those choices, I need to enable a button which will open the appropriate form to use for the data input.</p>\n\n<p>I have tried to use WithEvents in a class module to detect when the option buttons have been clicked, assign and store the value of 1 when an option is chosen. My plan was to update a hidden label's caption on the form with the number 2 once two option buttons have been clicked. However, I'm failing to access and update the label under this plan.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565197457, "post_id": 57399199, "comment_id": 101280021, "body": "<code>&quot;Arial Narrow&quot;</code> is a font <code>Name</code>, not a <code>FontStyle</code>, right? The second example works for me, changing <code>FontStyle</code> to <code>Name</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1565214184, "post_id": 57399199, "comment_id": 101286798, "body": "<code>Sheets(&quot;5x5&quot;).Range(Cells(...</code> will fail if <code>Sheets(&quot;5x5&quot;)</code> is not active.  And you don&#39;t need those <code>.Address</code>&#39;s"}], "owner": {"reputation": 1, "user_id": 11897462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cabf98032791485b8c75ccbd9b2ca02a?s=128&d=identicon&r=PG&f=1", "display_name": "dpicassom", "link": "https://stackoverflow.com/users/11897462/dpicassom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565197264, "creation_date": 1565197226, "last_edit_date": 1565197264, "question_id": 57399199, "link": "https://stackoverflow.com/questions/57399199/code-not-doing-stuff-when-running-normally-but-does-it-when-in-debug-mode-step", "title": "code not doing stuff when running normally, but does it when in debug mode, step by step", "body": "<p>I just want to change the size and font of a merged cell, I've tried treating it as a range and as the first cell of the merged group. When i run the code it doesn't changes the font type nor the size, nor changes it to bold. It will change the alignment, and the wrap, but nothing about the font.</p>\n\n<pre><code>'treating it as range\n\n With Sheets(\"5x5\").Range(Cells(filaeti + 2, columnaeti).Address, Cells(filaeti + 7, columnaeti + 4).Address)\n    .WrapText = True\n    .ShrinkToFit = False\n    .HorizontalAlignment = xlLeft\n    .VerticalAlignment = xlCenter\n    .Font.FontStyle = \"Arial Narrow\"\n    .Font.Bold = True\nEnd With\n\n\n*******\n\n'treating it as the first cell of the merged group\n With Sheets(\"5x5\").Cells(filaeti + 2, columnaeti)\n    .WrapText = True\n    .ShrinkToFit = False\n    .HorizontalAlignment = xlLeft\n    .VerticalAlignment = xlCenter\n    .Font.FontStyle = \"Arial Narrow\"\n    .Font.Bold = True\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565202380, "post_id": 57398922, "comment_id": 101282163, "body": "first and foremost, put <code>Option Explicit</code> at the top of your module.  From there, you will need to dimension (e.g., <code>dim theadjustment as string</code>) every variable.  if you have dimensioned elsewhere, please add that to yoru post"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565242998, "post_id": 57398922, "comment_id": 101292661, "body": "Please tell in which line you get the error. Note that you use <code>ForecastDate</code> in your <code>Match</code> function but this variable is not declared or initialized with data (so it is empty)."}, {"owner": {"reputation": 1, "user_id": 11897311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75598eff68005a67bf1fa641a504e66?s=128&d=identicon&r=PG&f=1", "display_name": "NeedHelp715", "link": "https://stackoverflow.com/users/11897311/needhelp715"}, "edited": false, "score": 0, "creation_date": 1565613582, "post_id": 57398922, "comment_id": 101396041, "body": "I just didn&#39;t include the full code but the variables are declared. The error is coming from the UserForm1.RegionFcstAmt1.Value equation."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1565244465, "creation_date": 1565244465, "answer_id": 57406111, "question_id": 57398922, "link": "https://stackoverflow.com/questions/57398922/how-can-i-solve-mis-match-error-and-correct-the-type/57406111#57406111", "title": "How can I solve mis-match error and correct the type?", "body": "<p>The main issue is, that you nested all your WorksheetFunctions without validating each of their results. I recommend to write each result of each WorksheetFunction into a variable and validate it before using it in another WorksheetFunction. </p>\n\n<p>This way it is much easier to debug, because if there is an error in one of them you exactly get in which one.</p>\n\n<p>First define your worksheet so you don't have to repeat that over and over</p>\n\n<pre><code>Dim wsData As Worksheet\nSet wsData = ThisWorkbooks.Worksheets(\"REV DATA\")\n\nDim wsTotal As Worksheet\nSet wsTotal = ThisWorkbooks.Worksheets(\"TOTAL CHANGES\")\n\nDim MatchResult As Double\nMatchResult = Application.Match(ForecastDate, wsData.Range(\"AK3:BH3\"), 0)\n'note that here is the first problem because `ForecastDate` is not defined and therefore empty\n\n'validate if match was successful if not exit\nIf IsError(MatchResult) Then\n    MsgBox \"'\" &amp; ForecastDate &amp; \"' did not match.\", vbCritical\n    Exit Sub\nEnd If\n\nDim IndexResult As Double\nIndexResult = Application.WorksheetFunction.Index(wsData.Range(\"AK:BH\"), MatchResult)\n\nDim SumIfsResult As Double\nSumIfsResult = Application.WorksheetFunction.SumIfs(IndexResult, wsData.Range(\"A:A\"), wsTotal.Range(\"A6\"), wsData.Range(\"H:H\"), TheSubFamily, wsData.Range(\"D:D\"), wsTotal.Range(\"C6\"), wsData.Range(\"E:$\"), wsTotal.Range(\"D6:F6\"))), 0)\n</code></pre>\n\n<p>So now it becomes weird because you try to <code>SumProduct</code> the result of <code>SumIfs</code> (which returns only one value of type <code>Double</code>). So this doesn't make any sense at all, because for example the <code>SumProduct</code> of one value eg. <code>5</code> would be <code>5</code>.</p>\n\n<p>The thing here is that you cannot <em>\"translate\"</em> a formula that you have in a cell one by one using WorksheetFunctions. Maybe have a look if the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.evaluate\" rel=\"nofollow noreferrer\">Application.Evaluate method</a> is something for you.</p>\n\n<p>At least the above code shows the idea how you should work with WorksheetFunctions in combination with variables to validate the sub-results of each function.</p>\n\n<p><em>I think you  are a bit up the wrong tree with what you tried to do. I recommend to ask a new question, telling what you were actually trying to do. Actually the formula you tried will not work that way.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 11897311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75598eff68005a67bf1fa641a504e66?s=128&d=identicon&r=PG&f=1", "display_name": "NeedHelp715", "link": "https://stackoverflow.com/users/11897311/needhelp715"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565244465, "creation_date": 1565196007, "last_edit_date": 1565242865, "question_id": 57398922, "link": "https://stackoverflow.com/questions/57398922/how-can-i-solve-mis-match-error-and-correct-the-type", "title": "How can I solve mis-match error and correct the type?", "body": "<p>I am getting a </p>\n\n<blockquote>\n  <p>mis-match error 13</p>\n</blockquote>\n\n<p>when trying to run my code. I think I understand what is causing it but I can't figure out how to fix it. </p>\n\n<p>The mis-match error is saying <code>RegionFcstAmt1 type is Variant/String</code> but the expression type to the right says Variant/Integer</p>\n\n<pre><code>Sub ShowUserForm1()\n\n    TheAdjustment = ActiveCell.Value\n    TheSubFamily = Cells(ActiveCell.Row, 1)\n    Site = Cells(1, 1)\n\n    UserForm1.RegionFcstAmt1.Value = Application.WorksheetFunction.IfError(Application.WorksheetFunction.SumProduct(Application.WorksheetFunction.SumIfs(Application.WorksheetFunction.Index(Sheets(\"REV DATA\").Range(\"$AK:$BH\"),Application.Match(ForecastDate, Sheets(\"REV DATA\").Range(\"$AK$3:$BH$3\"), 0)), Sheets(\"REV DATA\").Range(\"$A:$A\"), Sheets(\"TOTAL CHANGES\").Range(\"$A6\"), Sheets(\"REV DATA\").Range(\"$H:$H\"), TheSubFamily, Sheets(\"REV DATA\").Range(\"$D:$D\"), Sheets(\"TOTAL CHANGES\").Range(\"$C6\"), Sheets(\"REV DATA\").Range(\"$E:$E\"), Sheets(\"TOTAL CHANGES\").Range(\"$D6:$F6\"))), 0)\n\n    UserForm1.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1565192429, "post_id": 57397972, "comment_id": 101277573, "body": "<code>and not xwks.name like &quot;*- Matrix&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": false, "score": 2, "last_activity_date": 1565192558, "creation_date": 1565192558, "answer_id": 57398044, "question_id": 57397972, "link": "https://stackoverflow.com/questions/57397972/how-to-exclude-worksheets-with-matrix-at-the-end-of-their-name/57398044#57398044", "title": "How to exclude worksheets with &quot;- Matrix&quot; at the end of their name?", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/right-function\" rel=\"nofollow noreferrer\"><code>Right</code></a> function:</p>\n\n<pre><code> Right(xwks.Name, 6) = \"Matrix\" 'returns True if right hand side of the string is \"Matrix\"\n</code></pre>\n\n<p>There is also <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/left-function\" rel=\"nofollow noreferrer\"><code>Left</code></a> and  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/mid-function\" rel=\"nofollow noreferrer\"><code>Mid</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 3, "last_activity_date": 1565192576, "creation_date": 1565192576, "answer_id": 57398049, "question_id": 57397972, "link": "https://stackoverflow.com/questions/57397972/how-to-exclude-worksheets-with-matrix-at-the-end-of-their-name/57398049#57398049", "title": "How to exclude worksheets with &quot;- Matrix&quot; at the end of their name?", "body": "<p><code>Instr</code> will do the Job for you. </p>\n\n<p><strong>Try:</strong></p>\n\n<pre><code>Sub DoForSheets()\n\n    Dim xwks As Worksheet\n    Application.ScreenUpdating = False\n    For Each xwks In Worksheets\n        If xwks.Name &lt;&gt; \"Data\" And Not InStr(1, xwks.Name, \"- Matrix\") &gt; 0 Then\n           Debug.Print xwks.Name\n        End If\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Doesn't Matter where the <code>- Matrix</code> is in the Name. This will not Fail</p>\n"}], "owner": {"reputation": 79, "user_id": 11741419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFxSYVo2ULg/AAAAAAAAAAI/AAAAAAAAALg/y0i7eV7vSf8/photo.jpg?sz=128", "display_name": "Samuel Balun", "link": "https://stackoverflow.com/users/11741419/samuel-balun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57398049, "answer_count": 2, "score": 0, "last_activity_date": 1565192639, "creation_date": 1565192328, "question_id": 57397972, "link": "https://stackoverflow.com/questions/57397972/how-to-exclude-worksheets-with-matrix-at-the-end-of-their-name", "title": "How to exclude worksheets with &quot;- Matrix&quot; at the end of their name?", "body": "<p>I have a code which I want to apply on multiple worksheets.\nI want to exclude \"Data\" and all the worksheets containing \"- Matrix\".\nI used * wildcard to select these worksheets though it doesn't work.</p>\n\n<pre><code>Sub DoForSheets()\n    Dim xwks As Worksheet\n    Application.ScreenUpdating = False\n    For Each xwks In Worksheets\n        If xwks.Name &lt;&gt; \"Data\" And xwks.Name &lt;&gt; \"* - Matrix\" Then\n           Debug.Print xwks.Name\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565192622, "post_id": 57397971, "comment_id": 101277651, "body": "VBA doesn&#39;t have a countif - you need Application.WorksheetFunction.CountIF"}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 1, "creation_date": 1565193392, "post_id": 57398051, "comment_id": 101278048, "body": "thanks a ton! that worked. I didn&#39;t want to use a function because I have a ton of other validation code which checks for conditions and updates this one &quot;validation&quot; column."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1565192652, "last_edit_date": 1565192652, "creation_date": 1565192578, "answer_id": 57398051, "question_id": 57397971, "link": "https://stackoverflow.com/questions/57397971/vba-countif-and-update-adjacent-cell/57398051#57398051", "title": "VBA countif and update adjacent cell", "body": "<p>Try this. You hadn't defined the lookup range on sheet5.</p>\n\n<p>Given you have quite a lot of data you might want to consider speedier alternatives (why not just a worksheet function?).</p>\n\n<pre><code>Sub x()\n\nDim Cell As Range\nDim lr As Long\nDim lookupvalue As Range\n\nlr = sheet5.Range(\"J\" &amp; Rows.Count).End(xlUp).Row\nSet lookupvalue = Sheet2.Range(\"S3:S20000\")\n\nFor Each Cell In lookupvalue\n    If WorksheetFunction.CountIf(sheet5.Range(\"J1:J\" &amp; lr), Cell.Value) &gt; 0 Then\n        Cell.Offset(0, 3).Value = \"message goes here\"\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57398051, "answer_count": 1, "score": 1, "last_activity_date": 1565193033, "creation_date": 1565192318, "last_edit_date": 1565193033, "question_id": 57397971, "link": "https://stackoverflow.com/questions/57397971/vba-countif-and-update-adjacent-cell", "title": "VBA countif and update adjacent cell", "body": "<p>I've tried to write the below snippet of code to perform a \"countif\" and if the value if greater than zero, update the adjacent cell. Unfortunately, I've not had much luck. </p>\n\n<p><strong>Sheet5</strong> has the lookup range, <strong>Sheet2</strong> has the lookup value</p>\n\n<pre><code>Dim Cell As Variant\nDim lr As Long\nDim lookupvalue As Range\nlr = Sheet5.Range(\"J\" &amp; Rows.Count).End(xlUp).Row\nSet lookupvalue = Sheet2.Range(\"S3:S20000\")\nFor Each Cell In lookupvalue\nIf CountIf(lr, (Cell.Value)) &gt; 0 Then\nCell.Offset(0, 3).Value = \"message goes here\"\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1565193202, "post_id": 57397660, "comment_id": 101277946, "body": "I&#39;d suggest setting up a 2nd worksheet with the combinations that you need to process similar to the answer I gave <a href=\"https://stackoverflow.com/a/57383316/2344413\">here</a>. Instead of having a single column of filenames, you&#39;d have a column of &quot;categories&quot; (<code>*Minor Novice*</code>), Codes (<code>AE</code> - not sure what that indicates, but it seems important), and FileNames (<code>11 Minor Novice AE.xlsx</code>). Use that to feed the routine you&#39;ve already written."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565192777, "post_id": 57398028, "comment_id": 101277738, "body": "oldstring has a ByRef argument type mismatch which im not sure what that is"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1565261680, "post_id": 57398028, "comment_id": 101302006, "body": "Try changing dim oldname to oldstring. Can&#39;t test it, not at pc"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565342683, "post_id": 57398028, "comment_id": 101332397, "body": "Yeah, what they said. Sorry, started off using oldname then wrote oldstring"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1565192520, "creation_date": 1565192520, "answer_id": 57398028, "question_id": 57397660, "link": "https://stackoverflow.com/questions/57397660/is-there-a-simpler-way-of-moving-a-lot-of-data/57398028#57398028", "title": "Is there a simpler way of moving a lot of data", "body": "<p>This will generically split a list onto separate sheets based on the contents of columns B and C - from there you can export each sheet as a separate workbook</p>\n\n<pre><code>   Sub SplitIntoSheets()\n    dim r as range\n    set r = range(\"a1\")\n    r.parent.usedrange.sort key1:=range(\"B1\"),key2:=range(\"2c1\"),hasheader:=true \n    'sort by age,division\n    dim oldname as string\n    Do  'start loop\n    if r.offset(0,1)&amp;r.offset(0,2)&lt;&gt;oldstring then\n    'need new sheet\n        oldstring = r.offset(0,1)&amp;r.offset(0,2) 'store new string\n        AddSheet oldstring, r.parent\n    end if\n    r.entirerow.copy sheets(oldstring).range( rows.count,1).end(xlup).offset(1,0) 'copy row\n    set r = r.offset(1,0)\n    loop until r = \"\"\n    end sub\n\n    Sub AddSheet(s as string,source as worksheet)\n    thisworkbook.worksheets.add\n    activesheet.name = s\n    source.rows(1).copy range(\"a1\")  'copy titlw row from source sheet to new sheet\n\n    end sub\n</code></pre>\n\n<p>Not at computer, can't test this, there may be typos, it assumes a single sheet to begin with.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1565227039, "creation_date": 1565227039, "answer_id": 57404040, "question_id": 57397660, "link": "https://stackoverflow.com/questions/57397660/is-there-a-simpler-way-of-moving-a-lot-of-data/57404040#57404040", "title": "Is there a simpler way of moving a lot of data", "body": "<p>Create a new workbook for every unique value:</p>\n\n<pre><code>Sub Copy_To_Workbooks()\n'Note: This macro use the function LastRow\n    Dim My_Range As Range\n    Dim FieldNum As Long\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim ws2 As Worksheet\n    Dim MyPath As String\n    Dim foldername As String\n    Dim Lrow As Long\n    Dim cell As Range\n    Dim CCount As Long\n    Dim WSNew As Worksheet\n    Dim ErrNum As Long\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new workbook\"\n        Exit Sub\n    End If\n\n    'This example filters on the first column in the range(change the field if needed)\n    'In this case the range starts in A so Field:=1 is column A, 2 = column B, ......\n    FieldNum = 1\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Set the file extension/format\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2013\n        If ActiveWorkbook.FileFormat = 56 Then\n            FileExtStr = \".xls\": FileFormatNum = 56\n        Else\n            FileExtStr = \".xlsx\": FileFormatNum = 51\n        End If\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Delete the sheet RDBLogSheet if it exists\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Sheets(\"RDBLogSheet\").Delete\n    Application.DisplayAlerts = True\n    On Error GoTo 0\n\n    ' Add worksheet to copy/Paste the unique list\n    Set ws2 = Worksheets.Add(After:=Sheets(Sheets.Count))\n    ws2.Name = \"RDBLogSheet\"\n\n    'Fill in the path\\folder where you want the new folder with the files\n    'you can use also this \"C:\\Users\\Ron\\test\"\n    MyPath = Application.DefaultFilePath\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'Create folder for the new files\n    foldername = MyPath &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\") &amp; \"\\\"\n    MkDir foldername\n\n    With ws2\n        'first we copy the Unique data from the filter field to ws2\n        My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"A3\"), Unique:=True\n\n        'loop through the unique list in ws2 and filter/copy to a new sheet\n        Lrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For Each cell In .Range(\"A4:A\" &amp; Lrow)\n\n            'Filter the range\n            My_Range.AutoFilter Field:=FieldNum, Criteria1:=\"=\" &amp; _\n             Replace(Replace(Replace(cell.Value, \"~\", \"~~\"), \"*\", \"~*\"), \"?\", \"~?\")\n\n            'Check if there are no more then 8192 areas(limit of areas)\n            CCount = 0\n            On Error Resume Next\n            CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible) _\n                     .Areas(1).Cells.Count\n            On Error GoTo 0\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 areas for the value : \" &amp; cell.Value _\n                     &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n                     &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n                       vbOKOnly, \"Split in worksheets\"\n            Else\n                'Add new workbook with one sheet\n                Set WSNew = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n                'Copy/paste the visible data to the new workbook\n                My_Range.SpecialCells(xlCellTypeVisible).Copy\n                With WSNew.Range(\"A1\")\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                    .Select\n                End With\n\n                'Save the file in the new folder and close it\n                On Error Resume Next\n                WSNew.Parent.SaveAs foldername &amp; _\n                                    cell.Value &amp; FileExtStr, FileFormatNum\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    ErrNum = ErrNum + 1\n\n                    WSNew.Parent.SaveAs foldername &amp; _\n                     \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr, FileFormatNum\n\n                    .Cells(cell.Row, \"B\").Formula = \"=Hyperlink(\"\"\" &amp; foldername &amp; _\n                      \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr &amp; \"\"\")\"\n\n                    .Cells(cell.Row, \"A\").Interior.Color = vbRed\n                Else\n                    .Cells(cell.Row, \"B\").Formula = _\n                    \"=Hyperlink(\"\"\" &amp; foldername &amp; cell.Value &amp; FileExtStr &amp; \"\"\")\"\n                End If\n\n                WSNew.Parent.Close False\n                On Error GoTo 0\n            End If\n\n            'Show all the data in the range\n            My_Range.AutoFilter Field:=FieldNum\n\n        Next cell\n        .Cells(1, \"A\").Value = \"Red cell: can't use the Unique name as file name\"\n        .Cells(1, \"B\").Value = \"Created Files (Click on the link to open a file)\"\n        .Cells(3, \"A\").Value = \"Unique Values\"\n        .Cells(3, \"B\").Value = \"Full Path and File name\"\n        .Cells(3, \"A\").Font.Bold = True\n        .Cells(3, \"B\").Font.Bold = True\n        .Columns(\"A:B\").AutoFit\n\n    End With\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    If ErrNum &gt; 0 Then\n        MsgBox \"Rename every WorkSheet name that start with \"\"Error_\"\" manually\" _\n             &amp; vbNewLine &amp; \"There are characters in the name that are not allowed\" _\n             &amp; vbNewLine &amp; \"in a sheet name or the worksheet already exist.\"\n    End If\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n    ws2.Select\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win006_3.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win006_3.htm</a></p>\n"}], "owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565242832, "creation_date": 1565191218, "last_edit_date": 1565242832, "question_id": 57397660, "link": "https://stackoverflow.com/questions/57397660/is-there-a-simpler-way-of-moving-a-lot-of-data", "title": "Is there a simpler way of moving a lot of data", "body": "<p>Basically i am making a program that will find all of the players from different teams and move them to their own workbook. There is 12 age groups and 4 divisions per age group (AE, A, AA and AAA). The code below works for one team (Minor Novice AE). I was wondering if there is a way for me to sort all of these without having to re write the same code 48 times. Thanks :)</p>\n\n<pre><code>Sub Team()\n\n    Dim rw As Long, lastrow As Long, MySel As Range 'Grabs skus and moves to new sheet\n\n\n    With Worksheets(\"Sheet1\")\n        For rw = 1000 To 2 Step -1\n            If .Cells(rw, 2).Value Like \"*Minor Novice*\" And .Cells(rw, 3).Value Like (\"AE\") Then\n                If MySel Is Nothing Then\n                    Set MySel = .Cells(rw, 1).EntireRow\n\n                        Workbooks.Open Filename:=\"C:\\CODE\\Team Lists\\11 Minor Novice AE.xlsx\"\n\n                        Else\n                            Set MySel = Union(MySel, .Cells(rw, 1).EntireRow)\n\n                        End If\n                    End If\n                Next rw\n            End With\n\n    With ThisWorkbook.Worksheets(\"M Novice AE\")\n        lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        If Not MySel Is Nothing Then\n            MySel.Copy Destination:=.Cells(lastrow + 1, 1)\n            'MySel.Delete\n        End If\n    End With\n\n    Dim Rng As Range\n    Set Rng = ThisWorkbook.Worksheets(\"M Novice AE\").Range(\"A1:AY300\")\n    Rng.Copy\n    Dim s11 As Workbook\n    Set s11 = Workbooks(\"11 Minor Novice AE\")\n    Dim last As Long\n    Dim Rngnew As Range\n\nWith s11.Sheets(\"Sheet1\")\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        last = .Range(\"A65000\").End(xlUp).Offset(1, 0).Row\n    Else\n        last = 1\n    End If\nEnd With\n    Set Rngnew = s11.Worksheets(\"Sheet1\").Range(\"A\" &amp; last)\n\n    Rngnew.PasteSpecial\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 232, "user_id": 5202572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90339fcc33f2a548a97397f861151d1?s=128&d=identicon&r=PG&f=1", "display_name": "hisoka", "link": "https://stackoverflow.com/users/5202572/hisoka"}, "edited": false, "score": 0, "creation_date": 1565231651, "post_id": 57397531, "comment_id": 101290295, "body": "It&#39;s seem a bit odd to me that it runs and there is no error message in all this. If you add in a random <code>MsgBox</code> in your code does it get executed? If so then, the issue might be with the <code>Text28</code> conditional statement."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11694118, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206242820186916/picture?type=large", "display_name": "Kyra Ledkins", "link": "https://stackoverflow.com/users/11694118/kyra-ledkins"}, "edited": false, "score": 0, "creation_date": 1565209305, "post_id": 57399590, "comment_id": 101285132, "body": "The reason that I would like to build it into the OnClick macro for the button is that there are already a couple of actions that are in the macro, so I was trying to find a way to just add to it. I can convert the macro to VBA code, but I, being an Access novice, get confused by everything that is in the code window and I don&#39;t know where to put my If or Select Case actions."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 19, "user_id": 11694118, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206242820186916/picture?type=large", "display_name": "Kyra Ledkins", "link": "https://stackoverflow.com/users/11694118/kyra-ledkins"}, "edited": false, "score": 0, "creation_date": 1565210050, "post_id": 57399590, "comment_id": 101285455, "body": "If you wish to remain using a macro, providing that your function is defined within a public module then you should be able to invoke the function successfully from the macro. If this approach isn&#39;t producing any errors, but also isn&#39;t performing any actions, I would suggest ensuring that your function has a &#39;default branch&#39; to the conditional statement, e.g. a final <code>Else</code> in your sequence of <code>If</code> statements, or the <code>Case Else</code> as shown in my <code>Select Case</code> example - this allows you to verify that at least one condition is being met."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 1, "last_activity_date": 1565199085, "creation_date": 1565199085, "answer_id": 57399590, "question_id": 57397531, "link": "https://stackoverflow.com/questions/57397531/how-do-i-use-runcode-to-run-a-function/57399590#57399590", "title": "How do I use RunCode to run a function?", "body": "<p>Rather than using a Macro with a <code>RunCode</code> action to evaluate your function, I would suggest evaluating the code directly from a VBA event handler associated with the <code>OnClick</code> event for your button, e.g. (changing the <code>Command0</code> to suit your button name):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command0_Click()\n    If Text28 = \"aaa\" Then\n        DoCmd.PrintOut acPages, 2, 2, , 1\n    ElseIf Text28 = \"bbb\" Then\n        DoCmd.PrintOut acPages, 3, 3, , 1\n    ElseIf Text28 = \"ccc\" Then\n        DoCmd.PrintOut acPages, 4, 4, , 1\n    ElseIf Text28 = \"ddd\" Then\n        DoCmd.PrintOut acPages, 5, 5, , 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>A <code>Select Case</code> statement may also be more appropriate than sequential <code>if</code> statements, e.g.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command0_Click()\n    Select Case Text28\n        Case \"aaa\": DoCmd.PrintOut acPages, 2, 2, , 1\n        Case \"bbb\": DoCmd.PrintOut acPages, 3, 3, , 1\n        Case \"ccc\": DoCmd.PrintOut acPages, 4, 4, , 1\n        Case \"ddd\": DoCmd.PrintOut acPages, 5, 5, , 1\n        Case Else: MsgBox \"Text28 has an invalid value.\"\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11694118, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206242820186916/picture?type=large", "display_name": "Kyra Ledkins", "link": "https://stackoverflow.com/users/11694118/kyra-ledkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594549000, "creation_date": 1565190828, "last_edit_date": 1594549000, "question_id": 57397531, "link": "https://stackoverflow.com/questions/57397531/how-do-i-use-runcode-to-run-a-function", "title": "How do I use RunCode to run a function?", "body": "<p>I have written a function to run from a macro using <code>RunCode</code>.</p>\n\n<p>I am trying to call the function from the <code>OnClick</code> event of a command button.</p>\n\n<p>I want to print a different page of my report depending upon the value in the text control <code>Text28</code>. </p>\n\n<p>When I press the button, the function is not running. </p>\n\n<pre><code>Public Function PrintOut()\n    If Text28 = \"aaa\" Then\n        DoCmd.PrintOut acPages, 2, 2, , 1\n    ElseIf Text28 = \"bbb\" Then\n        DoCmd.PrintOut acPages, 3, 3, , 1\n    ElseIf Text28 = \"ccc\" Then\n        DoCmd.PrintOut acPages, 4, 4, , 1\n    ElseIf Text28 = \"ddd\" Then\n        DoCmd.PrintOut acPages, 5, 5, , 1\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1565191046, "post_id": 57397528, "comment_id": 101276803, "body": "You are using <code>x1</code> one not <code>xl</code>  L....!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565191185, "post_id": 57397528, "comment_id": 101276865, "body": "I voted to close this question because: <i>&quot;Questions about a problem that can no longer be reproduced or that was caused by a simple typographical error.&quot;</i> are off-topic."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565191383, "post_id": 57397528, "comment_id": 101276982, "body": "Note that if there is no value right of A4 then <code>.End(xlToRight)</code> will move to the very right cell in Excel and <code>Offset(0, 1)</code> will try to go one more right wich exceeds the amount of columns and fails."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11865504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4595fd7fc496bf9452523e40ad1d6d65?s=128&d=identicon&r=PG&f=1", "display_name": "Shehroz Malik", "link": "https://stackoverflow.com/users/11865504/shehroz-malik"}, "edited": false, "score": 1, "creation_date": 1565191667, "post_id": 57397614, "comment_id": 101277136, "body": "WOW, I legit thought it was 1 not L. THX so much for the help sir!"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1565191078, "creation_date": 1565191078, "answer_id": 57397614, "question_id": 57397528, "link": "https://stackoverflow.com/questions/57397528/how-to-copy-paste-receiving-error-for-vba/57397614#57397614", "title": "How to copy paste, receiving error for VBA", "body": "<p>You are using <code>x1</code> <strong>One</strong>, It should be <strong>L</strong> </p>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>a.Range(\"D24\").Copy Range(\"A4\").End(xlToRight).Offset(0, 1)\n</code></pre>\n\n<p>Also, I would suggest you to use a Sheet reference for Destination in above line.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1565191158, "creation_date": 1565191158, "answer_id": 57397635, "question_id": 57397528, "link": "https://stackoverflow.com/questions/57397528/how-to-copy-paste-receiving-error-for-vba/57397635#57397635", "title": "How to copy paste, receiving error for VBA", "body": "<p>It looks like you used <strong>1</strong> instead of <strong>l</strong> in the second snippet of code.  Change it to the letter,</p>\n\n<pre><code>a.Range(\"D24\").Copy Range(\"A4\").End(xlToRight).Offset(0, 1)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11865504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4595fd7fc496bf9452523e40ad1d6d65?s=128&d=identicon&r=PG&f=1", "display_name": "Shehroz Malik", "link": "https://stackoverflow.com/users/11865504/shehroz-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 57397614, "answer_count": 2, "score": 0, "last_activity_date": 1565191158, "creation_date": 1565190814, "last_edit_date": 1565190899, "question_id": 57397528, "link": "https://stackoverflow.com/questions/57397528/how-to-copy-paste-receiving-error-for-vba", "title": "How to copy paste, receiving error for VBA", "body": "<p>I am trying to copy a cell from a worksheet represented by \"a\" into the current sheet through this code. In the current sheet, I chose a reference point and then go to the last column, and then do an offset into a new column to paste. </p>\n\n<p>This line is EXACTLY like another code I have in my larger code, not sure why its not working and giving a Run Time error </p>\n\n<p>Anybody have thoughts? </p>\n\n<p>Code that works: </p>\n\n<pre><code>Range(\"b15\").End(xlToRight).Copy Range(\"B15\").End(xlToRight).Offset(0, 1)\n</code></pre>\n\n<p>Code that does not work: </p>\n\n<pre><code>a.Range(\"D24\").Copy Range(\"A4\").End(x1ToRight).Offset(0, 1)\n</code></pre>\n\n<p>Run time or user defined error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565190737, "post_id": 57397399, "comment_id": 101276636, "body": "What is the issue? i.e. does it throw an error? does it complete without performing the action? Also a screen print of your sheets and expected sheet will help to resolve the issue"}, {"owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565190918, "post_id": 57397399, "comment_id": 101276717, "body": "So the code throws no errors, but it will only bring one piece of data over and place it in row 1. There are way more than one line of data that should be coming up, and unfortunately I cannot provide screen-prints."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "edited": false, "score": 0, "creation_date": 1565193296, "post_id": 57397885, "comment_id": 101278003, "body": "Amazing, this is perfect. I can&#39;t believe I missed that. Thank you"}], "tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1565192835, "last_edit_date": 1565192835, "creation_date": 1565192004, "answer_id": 57397885, "question_id": 57397399, "link": "https://stackoverflow.com/questions/57397399/trouble-exporting-data-to-a-different-worksheet/57397885#57397885", "title": "Trouble exporting data to a different worksheet", "body": "<p>Seems like you are copying the data to the same row every time. With <code>.End(xlUp)</code> in the second For loop you are getting the last populated row, not the one below it, and just overwrite its contents with a new value. Here's the corrected code:</p>\n\n<pre><code>Public Sub HighlightDups() \n    Dim lastRow As Integer, compRow As Integer, rowNo As Integer, lastCol As Integer \n    With Sheets(\"Sheet1\") \n        lastRow = .Cells(.Rows.Count, 15).End(xlUp).Row \n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column + 1 \n        For rowNo = 2 To lastRow \n            .Cells(rowNo, lastCol) = Right(.Cells(rowNo, 15), 4) \n        Next \n        For rowNo = 2 To lastRow \n            If WorksheetFunction.CountIfs(.Range(.Cells(2, lastCol), .Cells(lastRow, lastCol)), .Cells(rowNo, lastCol), _ \n            .Range(.Cells(2, 20), .Cells(lastRow, 20)), .Cells(rowNo, 20)) &gt; 1 Then \n                Sheets(\"Sheet1\").Cells(rowNo, 15).EntireRow.Copy Destination:=Sheets(\"Sheet2\") _ \n                .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1,0) 'HERE \n            End If \n        Next \n        .Cells(1, lastCol).EntireColumn.ClearContents \n    End With \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 57397885, "answer_count": 1, "score": 1, "last_activity_date": 1565192835, "creation_date": 1565190356, "last_edit_date": 1565190762, "question_id": 57397399, "link": "https://stackoverflow.com/questions/57397399/trouble-exporting-data-to-a-different-worksheet", "title": "Trouble exporting data to a different worksheet", "body": "<p>I am having trouble getting the data I am trying to find in one excel sheet to export into another worksheet. I have tried a couple different things and cannot seem to get just the data I want to be exported. Any help would be appreciated.</p>\n\n<p>Here is my code with the most recent attempt:</p>\n\n<pre><code>Public Sub HighlightDups()\n\n    Dim lastRow As Integer, compRow As Integer, rowNo As Integer, lastCol As Integer\n\n\n    With Sheets(\"Sheet1\")\n\n        lastRow = .Cells(.Rows.Count, 15).End(xlUp).Row\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column + 1\n        For rowNo = 2 To lastRow\n            .Cells(rowNo, lastCol) = Right(.Cells(rowNo, 15), 4)\n        Next\n\n        For rowNo = 2 To lastRow\n            If WorksheetFunction.CountIfs(.Range(.Cells(2, lastCol), .Cells(lastRow, lastCol)), .Cells(rowNo, lastCol), _\n            .Range(.Cells(2, 20), .Cells(lastRow, 20)), .Cells(rowNo, 20)) &gt; 1 Then\n                Sheets(\"Sheet1\").Cells(rowNo, 15).EntireRow.Copy Destination:=Sheets(\"Sheet2\") _\n                .Range(\"A\" &amp; .Rows.Count).End(xlUp)\n            End If\n        Next\n        .Cells(1, lastCol).EntireColumn.ClearContents\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565190520, "post_id": 57397389, "comment_id": 101276526, "body": "Can you show the Data in a Screenshot ? And How are you using the Function ?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565191142, "post_id": 57397389, "comment_id": 101276845, "body": "What data type is column 16?"}, {"owner": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "edited": false, "score": 0, "creation_date": 1565191343, "post_id": 57397389, "comment_id": 101276961, "body": "Column 16 data is the difference between two numbers that are vlookup from another sheet - e.g. 14.6 or -4.62."}, {"owner": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "edited": false, "score": 0, "creation_date": 1565191935, "post_id": 57397389, "comment_id": 101277316, "body": "Have added pictures at the bottom with the data (a lot of hidden columns) and how I am trying to use it."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565193006, "post_id": 57397389, "comment_id": 101277847, "body": "Maybe the Cause is <code>Activecell</code> , which remains the same. Move the line <code>d = ActiveCell.Row</code> outside the loop. that might work. Because in every Iteration it&#39;s setting the value of  d = 2."}, {"owner": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "edited": false, "score": 0, "creation_date": 1565193789, "post_id": 57397389, "comment_id": 101278244, "body": "Unfortunately that&#39;s not it. It&#39;s moving down the column and detecting category changes well enough, it just doesn&#39;t seem to be outputting the right outcome given the inequalities in the Else statement. Thanks though"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565193847, "post_id": 57397389, "comment_id": 101278263, "body": "@OwenPaterson ,, Try the Answer Below."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "edited": false, "score": 0, "creation_date": 1565198200, "post_id": 57398331, "comment_id": 101280387, "body": "Hi Mikku, thanks. However, it still doesn&#39;t work. I realise that I may have actually been unclear in my use example. I have updated the image. I want to end up with a single category - so it takes all the A&#39;s looks at the first and the last number within the A&#39;s rows and if both are positive spit out one output, another for negative, and another if they are differently signed. So the end result is a row with one A and the output, then a row with one B and the output and so on."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "edited": false, "score": 0, "creation_date": 1565237943, "post_id": 57398331, "comment_id": 101291393, "body": "@OwenPaterson .. Try the Answer"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1565237918, "last_edit_date": 1565237918, "creation_date": 1565193645, "answer_id": 57398331, "question_id": 57397389, "link": "https://stackoverflow.com/questions/57397389/vba-if-and-inequality-operation-not-working/57398331#57398331", "title": "VBA If, And inequality operation not working", "body": "<p>Assign the Macro to a Button before Proceeding. I hope it helps, not sure about the conditions being applied as you intend, but this should work.</p>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>Sub tickercurve()\n\nDim dict As New Scripting.Dictionary\nDim cel As Range\nDim varKey As Variant\nDim result As Range\nDim tickers As Range\nDim tickercurve As String\nSet tickers = Application.InputBox(\"Select the Tikers Range\", Type:=8)\nSet result = Application.InputBox(\"Select the result start Range\", Type:=8)\n\nFor Each cel In tickers.Columns(1).Cells\n    i = i + 1\n    If Not dict.Exists(cel.Text) Then\n        dict.Add cel.Text, cel\n\n    Else\n        Set rngTemp = Union(cel, dict(cel.Text))\n        dict.Remove cel.Text\n        dict.Add cel.Text, rngTemp\n    End If\nNext cel\ni = 0\nFor Each varKey In dict.Keys\n\n    With Range(dict.Item(varKey).Address)\n\n            If Cells(.Cells(1, 1).row, 16).Value &gt; 0 And Cells(.Cells(.Rows.Count, .Columns.Count).row, 16).Value &gt; 0 Then\n                tickercurve = \"USD above EUR\"\n            ElseIf Cells(.Cells(1, 1).row, 16).Value &lt; 1 And Cells(.Cells(.Rows.Count, .Columns.Count).row, 16).Value &lt; 0 Then\n                tickercurve = \"EUR above USD\"\n            ElseIf Cells(.Cells(1, 1).row, 16).Value &lt; 0 And Cells(.Cells(.Rows.Count, .Columns.Count).row, 16).Value &gt; 0 Then\n                tickercurve = \"Cross\"\n            ElseIf Cells(.Cells(1, 1).row, 16).Value &gt; 0 And Cells(.Cells(.Rows.Count, .Columns.Count).row, 16).Value &lt; 0 Then\n                tickercurve = \"Cross\"\n            End If\n\n    Cells(result.row + i, result.Column).Value = varKey\n    Cells(result.row + i, result.Column + 1).Value = tickercurve\n    i = i + 1\n\n    End With\n\nNext varKey\n\n\nSet dict = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eGE3W.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eGE3W.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10771237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nCappH8WrQA/AAAAAAAAAAI/AAAAAAAAAGs/9cP-QfPW91Y/photo.jpg?sz=128", "display_name": "Owen Paterson", "link": "https://stackoverflow.com/users/10771237/owen-paterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57398331, "answer_count": 1, "score": 0, "last_activity_date": 1565237918, "creation_date": 1565190324, "last_edit_date": 1565199957, "question_id": 57397389, "link": "https://stackoverflow.com/questions/57397389/vba-if-and-inequality-operation-not-working", "title": "VBA If, And inequality operation not working", "body": "<p>I have a list of data, the first column is a category for which the rows looks like A, A, A, B, B, B, B, C, C, ... then other columns one of which is a positive or negative number for each row (this number differs within categories). I am trying to define a function that takes each a category A, B, C ... and checks whether the first and and last instance of A is positive or negative then spits out a result on a single line. However, the final stage of checking inequalities doesn't seem to be working. It seems to ignore the And operator and just uses the first condition of the And as the only one.</p>\n\n<pre><code>Public Function TickerCurve(Tickers As Range, Ticker As String) As String\n\nDim c As Integer\nDim d As Integer\nDim StrA, StrB As String\nDim col As Range\nc = 0\n\nFor Each col In Tickers.Rows\n    d = ActiveCell.Row\n    If col.Value = Ticker Then\n        StrA = Cells(d, 2).Value\n        StrB = Cells(d + 1, 2).Value\n        If StrA = StrB Then\n            c = c + 1\n            d = d + 1\n        Else\n            If Worksheets(\"Sheet2\").Cells(d - c, 16).Value &gt; 0 And Worksheets(\"Sheet2\").Cells(d, 16).Value &gt; 0 Then\n                TickerCurve = \"USD above EUR\"\n                c = 0\n            ElseIf Worksheets(\"Sheet2\").Cells(d - c, 16).Value &lt; 1 And Worksheets(\"Sheet2\").Cells(d, 16).Value &lt; 0 Then\n                TickerCurve = \"EUR above USD\"\n                c = 0\n            ElseIf Worksheets(\"Sheet2\").Cells(d - c, 16).Value &lt; 0 And Worksheets(\"Sheet2\").Cells(d, 16).Value &gt; 0 Then\n                TickerCurve = \"Cross\"\n                c = 0\n            ElseIf Worksheets(\"Sheet2\").Cells(d - c, 16).Value &gt; 0 And Worksheets(\"Sheet2\").Cells(d, 16).Value &lt; 0 Then\n                TickerCurve = \"Cross\"\n            End If\n        End If\n    End If\nNext col\n\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IvoWZ.png\" rel=\"nofollow noreferrer\">Data</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6u3sL.png\" rel=\"nofollow noreferrer\">Uses (new)</a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1565191641, "post_id": 57397279, "comment_id": 101277125, "body": "Can you add the Screen shots of Before And After ? And what do you mean by clearing the Contents, if there wasn&#39;t anything already ? Also, make sure that this the full question that you want the answer to, changing the Question again and again  like last time isn&#39;t accepted."}, {"owner": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565251974, "post_id": 57397279, "comment_id": 101296645, "body": "Hi Mikku..There will be some formula seating in those rows where H(i) = Y hence the pseudo code will be as below :"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565257155, "post_id": 57408167, "comment_id": 101299501, "body": "Its working but only for fixed value of column H..Values will start from H13 but the the code should work from last row in column H."}, {"owner": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565260333, "post_id": 57408167, "comment_id": 101301343, "body": "Hi Mikku..well the code which you recommended is checking each value in range I11:T11, but the actual scenario is when it encounters first &lt;&gt; TEST member in range I11:T11, it should stop that search ahead. For example if the first &lt;&gt;  TEST member encoutered at N11, it should simple copy range N12:T12 and start pasting from N13:T13 and so on till the last row of column H starting H13 where H(i) &lt;&gt; Y."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565268892, "post_id": 57408167, "comment_id": 101306205, "body": "Hi @NJB ... That was merely an addition of <code>Exit For</code> which I have done in the answer now.  So it will stop the loop after 1st <code>Test</code> is found"}, {"owner": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565270723, "post_id": 57408167, "comment_id": 101307471, "body": "Hi @Mikku its not working...in fact nothing is working after this change."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565270918, "post_id": 57408167, "comment_id": 101307594, "body": "Oh Sorry .. I added the condition in Wrong Place. It should have been inside If condition. @NJB"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565274833, "post_id": 57408167, "comment_id": 101310052, "body": "@NJB .. You can thank me by accepting and Upvoting the Answer :)"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "edited": false, "score": 0, "creation_date": 1565276667, "post_id": 57408167, "comment_id": 101311147, "body": "@NJB .. No you didn&#39;t accept and Upvote the Answer. Tick the sign with the Answer above and click the Upwards arrow to upvote. Maybe you can go back and do that on the previous questions also. !!"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1565270941, "last_edit_date": 1565270941, "creation_date": 1565252313, "answer_id": 57408167, "question_id": 57397279, "link": "https://stackoverflow.com/questions/57397279/copy-row-range-dynamically-based-on-contents-of-the-same-row/57408167#57408167", "title": "Copy Row Range Dynamically Based on Contents of the same row", "body": "<p><strong>Try:</strong></p>\n\n<pre><code>Sub CopyOnCondition1()\n     Dim sh1 As Worksheet, c As Range\n     Set sh1 = Worksheets(\"SheetNameHere\") 'change the sheetname\n     Dim cl As Range\n     Dim cel As Range\n\n     For Each cel In sh1.Range(\"I11:T11\")\n        If Not cel.Value = \"TEST\" Then\n\n            sh1.Range(Cells(12, cel.Column), Cells(12, 20)).Copy\n            For Each cl In sh1.Range(Cells(13, cel.Column), Cells(24, cel.Column))\n                  If Not sh1.Cells(cl.row, 8).Value = \"Y\" Then cl.PasteSpecial xlPasteFormulas\n            Next\n            Exit For\n        End If\n\n     Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11872229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14681cc2776d053c4e03f92c6acd1f2?s=128&d=identicon&r=PG&f=1", "display_name": "NJB", "link": "https://stackoverflow.com/users/11872229/njb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565270941, "creation_date": 1565189965, "last_edit_date": 1565190288, "question_id": 57397279, "link": "https://stackoverflow.com/questions/57397279/copy-row-range-dynamically-based-on-contents-of-the-same-row", "title": "Copy Row Range Dynamically Based on Contents of the same row", "body": "<p>Want to copy row range based on its content and paste in below rows based in flag value in column. For example.</p>\n\n<p>In range  B1:G1 , iF <code>B1 = TEST</code>, move next until that row value is not equal to TEST. For example let say B1,C1 and D1 are equal to TEST and starting from E1 is not equal to TEST(in short we need to check first not equal to TEST value in row <code>B1:G1</code> and start copy from that address but from next row till end), then copy <code>E2:G2</code> ( not E1:G1 as this is the condition row) and paste in below rows say <code>E3:G10</code>.</p>\n\n<p>While pasting in<code>E3:G10</code>, it needs to check values in  A3 : Last row in A, lets if <code>A3 = X</code> then paste above logic to <code>E3:G3</code>, next if <code>A4 = Y</code> then skip, next if <code>A5 = X</code> , then paste above logic to <code>E5:G5.....and so on</code>.</p>\n\n<p>In short we need first identify first &lt;> TEST member in range <code>B1:G1</code> and copy range from that column but from below row and paste in all below rows skipping few based on flag seating in column A. </p>\n\n<p>Below code is working but it clearing the contents of the skipped rows which we don't want. The new code should work for A3 to last row in column A.</p>\n\n<pre><code>Sub CopyOnCondition1()    \n     Dim sh1 As Worksheet, c As Range    \n     Set sh1 = Worksheets(\"SheetNameHere\") 'change the sheetname\n\n     For Each cel In sh1.Range(\"I11:T11\")    \n        If Not cel.Value = \"TEST\" Then    \n            sh1.Range(Cells(12, cel.Column), Cells(12, 20)).Copy\n            sh1.Range(Cells(13, cel.Column), Cells(24, 20)).PasteSpecial xlPasteFormulas    \n        End If    \n     Next\n\n     For Each cel In sh1.Range(\"H13:H24\")    \n        If cel.Value = \"Y\" Then sh1.Range(\"I\" &amp; cel.Row &amp; \":T\" &amp; cel.Row).ClearContents    \n     Next        \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565190150, "post_id": 57397272, "comment_id": 101276318, "body": "Maybe you should try asking this Question on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 1, "creation_date": 1565210027, "post_id": 57397272, "comment_id": 101285444, "body": "PowerPoint doesn&#39;t track positioning at such a fine-grained level. If you could place each paragraph in a separate text box or shape, your task would be easier to solve."}, {"owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565270209, "post_id": 57397272, "comment_id": 101307100, "body": "I would have to agree with @JohnKorchok, Then you could set the height of each object in a more permanent position."}, {"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565423244, "post_id": 57397272, "comment_id": 101357272, "body": "@JohnKorchok for my use case I would need to put each line (rather than each paragraph) in a textbox as I am aligning images to individual words. The text in the textboxes is entered by the user so I want to make the minimum amount of changes to what the user has entered as possible. I did consider dividing up the textbox originally, but I feel having the user ending up with multiple textboxes for the text they have entered could be confusing and messy - especially if they then want to add text, or delete some of it."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565550171, "post_id": 57397272, "comment_id": 101380225, "body": "Are you sure you need to use PowerPoint for this task? Other software, like Word, is better adapted to this kind of inline picture placement. Word picture captions do some of the same tasks, and are indexable."}, {"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1565619152, "post_id": 57397272, "comment_id": 101399094, "body": "Yes, though we will also be making a version of the add-in in Word. This is it: <a href=\"https://symboliser.commtap.org/\" rel=\"nofollow noreferrer\">symboliser.commtap.org</a> (without the word alignment feature as yet). Main users of the software are teachers adding support to their lesson materials for children with learning/communication difficulties. Teachers (in the UK anyway) very often use PowerPoint for their lessons. The same add-in also supports creation of communication boards/books to support those with severe communication disabilities - it&#39;s much easier to make these in PowerPoint."}], "owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565189952, "creation_date": 1565189952, "question_id": 57397272, "link": "https://stackoverflow.com/questions/57397272/getting-the-top-and-height-of-text-within-formatted-paragraphs", "title": "Getting the top and height of text within formatted paragraphs", "body": "<p>I am developing a PowerPoint add-in which inserts images between lines of text. In order to make room for the images, the add-in increases the spacing between the lines.\nUnfortunately, after the line spacing has been increased there doesn't seem to be any way to get at the height and top of the actual text. .Lines(i)BoundTop and .Lines(i)BoundHeight gives dimensions for the line itself. Referring to individual characters within the line (using .Characters(j)) simply returns the same top and height as the line they are contained in - even though the actual height of a character may be much less than that of the line, and its top being below the top position for the line.</p>\n\n<p>I have come up with a solution which involves creating a temporary test textbox and adding lines and paragraph formatting from the original textbox to observe what changes the formatting gives - and particularly using the fact that what spacing is applied depends on whether text is at the bottom, the top, or somewhere else in the textbox.</p>\n\n<p>This seems a slighly inelegant solution - so I was wondering whether there is a better solution, or if I've missed something in the PowerPoint object model that would have given me this information.</p>\n\n<p>This is the solution I have come up with so far:</p>\n\n<pre><code>Option Explicit\n\n' lngLine - the index of the line to compute TextTop and TextHeight for.\n' shTextBox - the text box containing the line.\n' dblTextTop - returned value for the top of the text.\n' dblTextHeight - returned value for the height of the text.\nPublic Sub TextPosition(ByVal lngLine As Long, _\n                        ByRef shTextBox As Shape, _\n                        ByRef dblTextTop As Double, _\n                        ByRef dblTextHeight As Double)\n\n  Dim shTestTextBox As Shape\n  Dim dblMaxCharHeight As Double\n\n  Dim trLine As TextRange\n  Set trLine = shTextBox.TextFrame.TextRange.Lines(lngLine)\n\n  ' The height of the derived textbox before manipulation:\n  Dim dblBaseBoundHeight As Double\n\n  Dim dblSpaceAfterAdded As Double\n  Dim dblSpaceWithinAdded As Double\n  Dim dblSpaceBeforeAdded As Double\n\n  dblMaxCharHeight = MaxCharHeight(trLine)\n\n  Dim lngSlideIndex As Long\n  lngSlideIndex = shTextBox.Parent.SlideIndex\n\n  With shTextBox.Parent.Parent.Slides(lngSlideIndex)\n\n    ' Create a test textbox for the line.\n    ' The height of this before and after paragraph formatting is used to\n    ' compute where the text will be in relation to the bounding box of the\n    ' line.\n    Set shTestTextBox = .Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, _\n                                           Left:=shTextBox.Left, _\n                                           Top:=trLine.BoundTop, _\n                                           Width:=shTextBox.Width, _\n                                           Height:=trLine.BoundHeight)\n\n  End With\n\n  Dim boolIsNewParagraph As Boolean\n  With shTextBox.TextFrame.TextRange\n    Dim i As Long\n    For i = 2 To .Paragraphs.Count\n      If .Paragraphs(i).Start = trLine.Start Then\n        boolIsNewParagraph = True\n        Exit For\n      End If\n    Next i\n  End With\n\n  shTestTextBox.TextFrame.WordWrap = msoFalse\n\n  With shTestTextBox.TextFrame.TextRange\n\n    ' Lines which precede new paragraphs will have a return at the end of them\n    ' (Chr(13)), leave this in for now.\n    .Text = trLine.Text\n    .Characters(1, .Characters.Count).Font.Size = dblMaxCharHeight\n\n    ' Record the bound height of the text box before copying over the\n    ' paragraph formatting.\n    If .Lines.Count &gt; 0 Then\n      dblBaseBoundHeight = .Lines(1).BoundHeight\n    Else\n      dblBaseBoundHeight = .BoundHeight\n    End If\n\n    ' Space will get added if there is a return character Chr(13) - at the end\n    ' of the line (i.e. preceding another paragraph).\n    .ParagraphFormat.LineRuleAfter = trLine.ParagraphFormat.LineRuleAfter\n    .ParagraphFormat.SpaceAfter = trLine.ParagraphFormat.SpaceAfter\n\n    If .Lines.Count &gt; 0 Then\n      dblSpaceAfterAdded = .Lines(1).BoundHeight - dblBaseBoundHeight\n    Else\n      dblSpaceAfterAdded = .BoundHeight - dblBaseBoundHeight\n    End If\n\n    ' If this is the first line of a paragraph, see what space will be added before:\n    If boolIsNewParagraph Then\n      .Text = Chr(13) &amp; .Text\n      If .Lines.Count &gt; 1 Then\n        .ParagraphFormat.LineRuleBefore = trLine.ParagraphFormat.LineRuleBefore\n        .ParagraphFormat.SpaceBefore = trLine.ParagraphFormat.SpaceBefore\n        dblSpaceBeforeAdded = .Lines(2).BoundHeight - (dblBaseBoundHeight + dblSpaceAfterAdded)\n      End If\n    End If\n\n    .Text = Replace(trLine.Text, Chr(13), \"\")\n    ' The text is now (always) on the last (only) line of the test textbox, now\n    ' add the within spacing and see what spacing that adds:\n    .ParagraphFormat.LineRuleWithin = trLine.ParagraphFormat.LineRuleWithin\n    .ParagraphFormat.SpaceWithin = trLine.ParagraphFormat.SpaceWithin\n    dblSpaceWithinAdded = trLine.BoundHeight - .BoundHeight\n\n  End With\n\n  dblTextHeight = dblBaseBoundHeight\n\n  dblTextTop = (trLine.BoundTop + trLine.BoundHeight + dblSpaceBeforeAdded) - _\n                 dblBaseBoundHeight - dblSpaceAfterAdded - dblSpaceWithinAdded\n\n\n  shTestTextBox.Delete\n\nEnd Sub\n\nPublic Function MaxCharHeight(ByRef trLine As TextRange) As Double\n\n  Dim i As Long\n  Dim dblMaxHeight As Double\n\n  For i = 1 To trLine.Characters.Count\n    If trLine.Characters(i, 1).Font.Size &gt; dblMaxHeight Then\n      dblMaxHeight = trLine.Characters(i, 1).Font.Size\n    End If\n  Next i\n\n  MaxCharHeight = dblMaxHeight\n\nEnd Function\n\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565192269, "post_id": 57397212, "comment_id": 101277493, "body": "Have you tried typing into the field? I suspect, by setting the value, <b>OnChange</b> is not being triggered"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565208677, "post_id": 57397212, "comment_id": 101284880, "body": "You need to create and attach a change event to the instrument dropdown and dispatch that event after changing the value. For the next drop down there are a host of events associated with both the parent div and child input - so I suspect some combination and ordering of those is required. There is however a xhr POST request made by the page for the data which returns json. I can&#39;t get it to work with VBA for some reason (I think to do with the encoding of body), though the essentially the same request with python works just fine."}, {"owner": {"reputation": 31, "user_id": 8996471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd60d6b9af6e347806223206c539511?s=128&d=identicon&r=PG&f=1", "display_name": "Mittal", "link": "https://stackoverflow.com/users/8996471/mittal"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565236122, "post_id": 57397212, "comment_id": 101291075, "body": "@Qharr Can you guide me How can I create and attach a change event to instrument Drop down?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565241095, "post_id": 57397212, "comment_id": 101292126, "body": "<a href=\"https://stackoverflow.com/a/56091264/6241235\">stackoverflow.com/a/56091264/6241235</a> when you correctly attach and fire on the first dropdown you will notice select expiry appears in third. When you correctly have the entry registered in the 2nd dropdown the dates will appear in the third."}], "owner": {"reputation": 31, "user_id": 8996471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd60d6b9af6e347806223206c539511?s=128&d=identicon&r=PG&f=1", "display_name": "Mittal", "link": "https://stackoverflow.com/users/8996471/mittal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565191194, "creation_date": 1565189700, "last_edit_date": 1565191194, "question_id": 57397212, "link": "https://stackoverflow.com/questions/57397212/elements-not-able-to-select-on-webpage-vba", "title": "Elements not able to select on Webpage-VBA", "body": "<p>I am fetching data from the following website:</p>\n\n<p><a href=\"https://www.mcxindia.com/market-data/bhavcopy\" rel=\"nofollow noreferrer\">https://www.mcxindia.com/market-data/bhavcopy</a></p>\n\n<p>There are 5 Filterable Fields as per below:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>INSTRUMENT | COMMODITY | EXPIRY | FROM DATE | TO DATE\n</code></pre>\n\n<p>Field <code>EXPIRY</code> is blank by default. If we select <code>COMMODITY</code> then <code>EXPIRY</code> Field Dropdown Appears</p>\n\n<p>I wanted to display data as per below Screenshot</p>\n\n<p><a href=\"https://i.stack.imgur.com/uK1hU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uK1hU.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nPublic Sub Download()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.mcxindia.com/market-data/bhavcopy\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"[Class='today']\").Click\n            .getElementById(\"ddlInstrument\").Value = \"FUTCOM\"\n            .getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Focus\n            .getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Value = \"ALUMINI\"\n            .getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Click\n            .getElementById(\"ddlExpiry\").Value = \"30AUG2019\"\n            .getElementById(\"ddlExpiry\").Focus\n            .getElementById(\"txtFromDate\").Focus\n            .getElementById(\"txtFromDate\").Value = \"01/08/2019\"\n            .getElementById(\"txtToDate\").Focus\n            .getElementById(\"txtToDate\").Value = \"07/08/2019\"\n\n            .querySelector(\"[id='btnShowCommoditywise']\").Click\n\n\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        '.Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p>Field <code>EXPIRY</code> is not fetching automatically when I select <code>COMMODITY</code></p>\n\n<pre><code>.getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Focus\n                .getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Value = ALUMINI\"\n                .getElementById(\"ctl00_cph_InnerContainerRight_C001_ddlSymbols_Input\").Click\n</code></pre>\n\n<p>Also Selecting Date as per my method shows an error: <code>Please Select From Date</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/FWgcm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FWgcm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1565189293, "post_id": 57397031, "comment_id": 101275837, "body": "I believe you just need <code>rRng.Find(...)</code>.  <code>Cells.Find</code> will look through <i>all</i> cells, as you suspected.  But, you&#39;re looping through each cell in column B...so maybe just do <code>rCell.Find()</code> if you want to search that cell for the word."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565189489, "post_id": 57397031, "comment_id": 101275943, "body": "What happens if it finds it in B1 - you can&#39;t go up one row from there?"}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565189595, "post_id": 57397031, "comment_id": 101275988, "body": "There is a header, so B1 is not possible (it will also be after an Investment Strategy) so B3 is the first possibility.  I mean I get that someone could literally type that, but the data- how its coming in won&#39;t have it that way."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1565189834, "post_id": 57397031, "comment_id": 101276129, "body": "@BruceWayne.  I get a run time 13 error based on that.  I&#39;m jumping on a conference call, I&#39;ll see if I can get that to work after.  Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565195575, "post_id": 57397442, "comment_id": 101279146, "body": "The macro inserts 2 columns then ends.  Don&#39;t we want if rCell is &quot;Recommendation&quot; then do?  Also then offset isn&#39;t copying and pasting the recommendation."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565196014, "post_id": 57397442, "comment_id": 101279356, "body": "No, that&#39;s what <code>Find</code> does. Is it right that you are matching case? Sounds like you are not finding the text anywhere."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565196517, "post_id": 57397442, "comment_id": 101279600, "body": "you were right.  I edited your script.  It&#39;s ALMOST there.  It pastes &quot;True&quot; not the Recommendation."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565196693, "post_id": 57397442, "comment_id": 101279684, "body": "Don&#39;t understand that, it works for me. It should put the contents of the cell containing &quot;Recommendation&quot; one cell to the left and one row up."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565196810, "post_id": 57397442, "comment_id": 101279728, "body": "When you say you edited it, what exactly did you do?"}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565196860, "post_id": 57397442, "comment_id": 101279754, "body": "Not sure why - it works perfectly now.  I literally love you.  You don&#39;t know how much time I spent on this."}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565198056, "post_id": 57397442, "comment_id": 101280324, "body": "Any recommendations for this off set? I&#39;m going to run these again, to un adjust these changes?"}, {"owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565199708, "post_id": 57397442, "comment_id": 101281054, "body": "How do I write a script to exactly undo this process (for after I insert the updated data)?  I hoped I&#39;d be able to figure it out on my own, but I&#39;m having difficulty."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "edited": false, "score": 0, "creation_date": 1565202419, "post_id": 57397442, "comment_id": 101282176, "body": "You have to think through the logical steps and reverse them, like a flow chart backwards. Find the text in column A, copy it one cell down and to the right and loop round. If you get stuck, post a new question with the code you&#39;ve tried."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1565195951, "last_edit_date": 1565195951, "creation_date": 1565190456, "answer_id": 57397442, "question_id": 57397031, "link": "https://stackoverflow.com/questions/57397031/error-1004-find-loop-continues-to-run-im-moving-text-so-now-it-continues-to/57397442#57397442", "title": "Error 1004. Find loop continues to run. I&#39;m moving text, so now it continues to run across worksheet", "body": "<p>Try this. It would be worth you reading up on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid Select</a>.</p>\n\n<p>Using <code>Find</code> you don't have to loop through each cell, but you should always check that something is found before proceeding. Because you are deleting the cells you find the code loops until the term is not found any more in the range.</p>\n\n<pre><code>Sub Adjust_Recommendations_EAFE()\n\nDim rCell As Range\nDim rRng As Range\n\nWith Sheets(\"EAFE\")\n    .Range(\"A:A\").Insert Shift:=xlToLeft, Copyorigin:=xlFormatFromRightOrBelow\n    Set rRng = .Range(\"B1:B1000\")\nEnd With\n\nSet rCell = rRng.Find(What:=\"Recommendation\", LookIn:=xlFormulas, _\n                     LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                     MatchCase:=True)\nIf Not rCell Is Nothing Then\n    Do\n        rCell.Offset(-1, -1).Value = rCell.Value\n        rCell.EntireRow.Delete\n        Set rCell = rRng.Find(\"Recommendation\")\n    Loop Until rCell Is Nothing\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11896604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df966640c4f9cbd64461c680e6f7fb92?s=128&d=identicon&r=PG&f=1", "display_name": "Cj17digr", "link": "https://stackoverflow.com/users/11896604/cj17digr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57397442, "answer_count": 1, "score": 1, "last_activity_date": 1565195951, "creation_date": 1565189108, "question_id": 57397031, "link": "https://stackoverflow.com/questions/57397031/error-1004-find-loop-continues-to-run-im-moving-text-so-now-it-continues-to", "title": "Error 1004. Find loop continues to run. I&#39;m moving text, so now it continues to run across worksheet", "body": "<p>This is part of a larger script to automate a very repetitive task.\nThis script is attempting to format each sheet so that data I'm pulling from a database can be pasted in correctly.</p>\n\n<p>The code successfully creates a new column A.</p>\n\n<p>Then all I am trying to do is find (in column B only) when a cell includes the word \"Recommendation\" then paste the information in cell.offset (-1,-1).  This way the recommendation will now be in Column A next to the referred to Investment Strategy.</p>\n\n<p>The moving of the Recommendation works (for all recommendations on the page).</p>\n\n<p>I need the code to stop running after all the text has been moved.</p>\n\n<p>There are likely better ways to write this and potentially other errors.</p>\n\n<p>I think my script is searching the entire worksheet not just column B.  The error occurs after the when Column B is finished and the macro moves to Column A (then tries to off set to -1,-1 which is off the page).</p>\n\n<pre><code> Sub Adjust_Recommendations_EAFE()\n'\n'     Adjust_Recommendations EAFE Macro\n'\n\n'\n Sheets(\"EAFE\").Select\n Range(\"A1\").Select\n Range(\"A:A\").Insert Shift:=xlToLeft, \n Copyorigin:=xlFormatFromRightOrBelow\n\n\nDim rCell As Range\nDim rRng As Range\nDim Index As Variant\n\n\nSet rRng = Range(\"B1:B1000\")\n\n For Each rCell In rRng\n Cells.Find(What:=\"Recommendation\", After:=ActiveCell, \n LookIn:=xlFormulas, \n LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, \n MatchCase:=True).Select\n        Debug.Print rCell.Address, rCell.Value\n\n        If rCell Like \"*Recommendation*\" Then\n        Selection.Copy\n        ActiveCell.Offset(-1, -1).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, \n        SkipBlanks _:=False, Transpose:=False\n        Application.CutCopyMode = False\n        ActiveCell.Offset(1, 0).Select\n        Selection.EntireRow.Delete\n\n        End If\n\n\n\n\n Next rCell\n\n Sheets(\"Macro\").Select\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 2, "creation_date": 1565188686, "post_id": 57396816, "comment_id": 101275498, "body": "Make it a <code>Class Module</code> instead of a simple <code>Module</code> and you will be able to do that. See <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/classes.aspx</a> or <a href=\"https://stackoverflow.com/q/2161666/8597922\">stackoverflow.com/q/2161666/8597922</a>"}, {"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1565195161, "post_id": 57396816, "comment_id": 101278895, "body": "Thanks!  Since it&#39;s now a class module, it has to be instantiated, and since objects can&#39;t be global constants, I have to Dim and Set the object in ShowPopUp to pass it in, right?  If you made that an answer I&#39;d accept it."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566140835, "post_id": 57396816, "comment_id": 101554765, "body": "Have a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/callbyname-function\" rel=\"nofollow noreferrer\">CallByName</a> to invoke a method using a string  <a href=\"https://stackoverflow.com/questions/48952665/passing-a-property-as-an-argument-for-userform-controls/48952944#48952944\">Passing a property as an argument for userform controls</a>. I don&#39;t know if your desigm is recommened, but you should ask at <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "edited": false, "score": 0, "creation_date": 1565199774, "post_id": 57399389, "comment_id": 101281083, "body": "Thanks. I&#39;m trying to stick to a light-touch approach for this refactoring effort, just re-organizing the ~850 global constants and simplifying/commonizing functions.  I realize it won&#39;t be proper, but it should be much quicker for me to complete and easier for the original author and other users to follow that way.  Hopefully then it will also be easier to flush out some of the odd behavior we&#39;re seeing.  That&#39;s the plan, at least..."}], "tags": [], "owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1566138597, "last_edit_date": 1566138597, "creation_date": 1565198076, "answer_id": 57399389, "question_id": 57396816, "link": "https://stackoverflow.com/questions/57396816/can-i-pass-a-vba-module-as-an-argument-to-a-sub-function/57399389#57399389", "title": "Can I pass a VBA module as an argument to a Sub/Function?", "body": "<p>You cannot pass regular modules as arguments (technically you can pass a string and use <code>Application.Run</code>, but that might be a nightmare to deal with), but you can pass classes. </p>\n\n<p>Classes can be in global scope. So technically you can instantiate it at some point (opening a workbook for example) and then use them at any point. I would say that globals are fine in some cases, but most of the time you can (and perhaps should) do without them. I would encourage you to look at the topic of global scope and why it often considered to be bad.</p>\n\n<p>You can have a class like this:</p>\n\n<pre><code>GroupClass:\nOption Explicit\nPrivate Type TypeGroup\n    WS as WorkSheet\n    FirstRow as Long\n    FirstCol as Long\n    ColumnOffset as Long\nEnd Type\nPrivate This as TypeGroup\nPublic Function Initialize(Byval WS as Sheet, Byval FirstRow as Long, ByVal FirstCol as Long, ByVal ColumnOffset as Long)\nWith This\n    Set .WS = WS\n    .FirstRow = FirstRow\n    .FirstCol = FirscCol\n    .ColumnOffset = ColumnOffset\nEnd with\nEnd Function\nPublic Property Get Name() as String\n    Name = This.WS.Name\nEnd Property\n</code></pre>\n\n<p>Then you can use it like this:</p>\n\n<pre><code>Public Sub Popup(Group As GroupClass)\n    MsgBox Group.Name\nEnd Sub\n\nPublic Sub ShowPopUp()\n    Dim Group1 as GroupClass\n    Set Group1 = New GroupClass\n    Group1.Initialize Worksheets(\"Sheet1\"),2,15,4\n    Popup Group1\nEnd \n</code></pre>\n\n<p>The reason I use <code>Private Type</code> and <code>Private This as TypeGroup</code> <a href=\"https://stackoverflow.com/a/57165691/8597922\">can be found here</a>. Some caveats for class instantiation can be <a href=\"https://stackoverflow.com/a/57396829/8597922\">seen here</a>. Depending on what you do, your class organization can be very different. You can read on interfaces, immutability, when to use getters/setters, encapsulation and other topic elsewhere.</p>\n"}], "owner": {"reputation": 85, "user_id": 3433707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62fa32e817831ca527bded4741db75af?s=128&d=identicon&r=PG&f=1", "display_name": "user13803", "link": "https://stackoverflow.com/users/3433707/user13803"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 57399389, "answer_count": 1, "score": 4, "last_activity_date": 1566138597, "creation_date": 1565188369, "last_edit_date": 1565195172, "question_id": 57396816, "link": "https://stackoverflow.com/questions/57396816/can-i-pass-a-vba-module-as-an-argument-to-a-sub-function", "title": "Can I pass a VBA module as an argument to a Sub/Function?", "body": "<p>I'm trying to refactor some Excel VBA code (Excel 2016, VBA 7.1) to eliminate repetitive subroutines for maintainability purposes.  Several of the subroutines only differ by the group of global constants they use, so what I'm basically trying to do is group the globals together into a struct-like data structure so I can pass them into a common function as an argument.</p>\n\n<p>Note that the groups of global constants have some in common, but not all, e.g.:</p>\n\n<pre><code>Global Const GROUP1_SHEET As String = \"Sheet1\"\nGlobal Const GROUP1_FIRST_ROW As Long = 2\nGlobal Const GROUP1_LAST_COL As Long = 15\nGlobal Const GROUP1_SOME_COL_OFFSET = 4\n\nGlobal Const GROUP2_SHEET As String = \"Sheet2\"\nGlobal Const GROUP2_FIRST_ROW As Long = 2\nGlobal Const GROUP2_LAST_COL As Long = 8\nGlobal Const GROUP2_ANOTHER_COL_OFFSET = 2\n</code></pre>\n\n<p>And there are different subroutines for each group, e.g.:</p>\n\n<p>In Sheet1:</p>\n\n<pre><code>Private Sub DoSomething()\n    Set w = Worksheets(GROUP1_SHEET)\n    'some code\nEnd Sub\n</code></pre>\n\n<p>In Sheet2:</p>\n\n<pre><code>Private Sub DoSomething()\n    Set w = Worksheets(GROUP2_SHEET)\n    'same code as above\nEnd Sub\n</code></pre>\n\n<p>There are dozens of these.  Needless to say, this code is a nightmare to even read through, let alone maintain.</p>\n\n<p>What I'm trying to do right now is split the groups into separate modules and set them as properties, similar to what is described in <a href=\"https://stackoverflow.com/questions/53342482/constant-with-dot-operator-vba/53342729\">this question</a>.  The problem with this is I don't know how to pass the module (i.e. the group of globals) to the function as an argument.</p>\n\n<p>In new module GROUP1:</p>\n\n<pre><code>Public Property Get SHEET() As String\n    SHEET = \"Sheet1\"\nEnd Property\n</code></pre>\n\n<p>And this works as I want it to:</p>\n\n<pre><code>Public Sub ShowPopup()\n    MsgBox GROUP1.SHEET\nEnd Sub\n</code></pre>\n\n<p>But passing it as an argument does not:</p>\n\n<pre><code>Public Sub Popup(inModule As Object)\n    MsgBox inModule.SHEET\nEnd Sub\n\nPublic Sub ShowPopUp()\n    Popup GROUP1\nEnd Sub\n</code></pre>\n\n<p>Nothing I've tried works in place of \"Object\" in the example above.  I either get \"ByRef Argument type mismatch\" or \"Expected variable or procedure, not module\" depending on what I put there.</p>\n\n<p>So, can I pass a module like this (maybe as a string and evaluate it somehow?), or should I use some other way of grouping globals?</p>\n"}, {"tags": ["sql", "excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 8995379, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212663765842236/picture?type=large", "display_name": "iraciv94", "link": "https://stackoverflow.com/users/8995379/iraciv94"}, "edited": false, "score": 0, "creation_date": 1565249318, "post_id": 57396864, "comment_id": 101295357, "body": "Thank you so much! I believe that the Chr(13) &amp; &quot;&quot; &amp; Chr(10) comes from the fact that I started the VBA as a recorded macro."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1565191928, "last_edit_date": 1565191928, "creation_date": 1565188543, "answer_id": 57396864, "question_id": 57396760, "link": "https://stackoverflow.com/questions/57396760/query-with-conditions-based-on-cells/57396864#57396864", "title": "Query with conditions based on cells", "body": "<p>You need to get <code>ValueCellD1</code> out of the string so it is recognized as variable.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandText = Array( _\n        \"SELECT database.columnA, database.columnB, database.columnC\" _\n        &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"FROM IMPALA.database database\" _\n        &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"WHERE (database.columnA='\" &amp; ValueCellD1 &amp; \"') AND (database.columnB='London')\")\n</code></pre>\n\n<p>Actually I have no idea why you insert <code>&amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp;</code> in your string. The following should work too:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandText = Array( _\n        \"SELECT database.columnA, database.columnB, database.columnC \" _\n        \"FROM IMPALA.database database \" _\n        \"WHERE (database.columnA='\" &amp; ValueCellD1 &amp; \"') AND (database.columnB='London')\")\n</code></pre>\n\n<p>Note that if you read a cell value into your variable</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ValueCellD1 = Worksheets(\"Input_Sheet\").Range(\"D1\").Value\n</code></pre>\n\n<p>and push this into your SQL command without verifying the cell value, then anyone who can edit the cell value in D1 can easily attack your database and run any SQL command he likes (eg delete it). <strong>Never trust user input. Always validate it</strong>.</p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/SQL_injection</a>.</p>\n"}], "owner": {"reputation": 634, "user_id": 8995379, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212663765842236/picture?type=large", "display_name": "iraciv94", "link": "https://stackoverflow.com/users/8995379/iraciv94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 57396864, "answer_count": 1, "score": 0, "last_activity_date": 1580709922, "creation_date": 1565188153, "last_edit_date": 1580709922, "question_id": 57396760, "link": "https://stackoverflow.com/questions/57396760/query-with-conditions-based-on-cells", "title": "Query with conditions based on cells", "body": "<p>I am trying to write a VBA code that Queries some values.</p>\n\n<p>My SQL query has two conditions in the WHERE statement.</p>\n\n<ul>\n<li><p>The value in column B is within the query, so no issue about it.</p></li>\n<li><p>The value in column A is a code which starts with numbers, but contains Letters and should be seen as a string as such to work '6F3S'; specifically: database.columnA='6F3S'.</p></li>\n</ul>\n\n<p>My issue comes from the fact that I want to outsource the element 6F3S in cell D1 in sheet \"Input_sheet\", so that the user can change it with other codes if necessary.</p>\n\n<p>This is my code so far:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Query1()\n    Dim ValueCellD1 As String\n    ValueCellD1 = Worksheets(\"Input_Sheet\").Range(\"D1\").Value\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n        \"FFFF;DSN=XXXXXXXXXXXX;\", Destination:=Range(\"$A$7\")).QueryTable\n        .CommandText = Array( _\n        \"SELECT database.columnA, database.columnB, database.columnC\" _\n        &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"FROM IMPALA.database database\" _\n        &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"WHERE (database.columnA=ValueCellD1) AND (database.columnB='London')\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = True\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"YYYYYYYYYYYYYYYYY\"\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>I receive a </p>\n\n<blockquote>\n  <p>Run-time error '13': Type mismatch</p>\n</blockquote>\n\n<p>When I try to debug it appears being here:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandText = Array( _\n            \"SELECT database.columnA, database.columnB, database.columnC\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"FROM IMPALA.database database\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"WHERE (database.columnA=ValueCellD1) AND (database.columnB='London')\")\n</code></pre>\n\n<p>Note: I am currently using Excel 2010</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 1250209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmPFj.jpg?s=128&g=1", "display_name": "Dan Meigs", "link": "https://stackoverflow.com/users/1250209/dan-meigs"}, "edited": false, "score": 0, "creation_date": 1590790491, "post_id": 58583884, "comment_id": 109824865, "body": "Getting good information on how to format box and whiskers charts is tough. Thank you for this answer!"}], "tags": [], "owner": {"reputation": 21, "user_id": 12283126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66583b8fb744bb329e6e23cbce7b6faa?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Puls", "link": "https://stackoverflow.com/users/12283126/ken-puls"}, "is_accepted": false, "score": 2, "last_activity_date": 1572215158, "creation_date": 1572215158, "answer_id": 58583884, "question_id": 57396620, "link": "https://stackoverflow.com/questions/57396620/how-to-use-excel-vba-code-to-change-the-color-of-a-series-in-a-box-and-whisker-p/58583884#58583884", "title": "How to use excel vba code to change the color of a series in a box and whisker plot?", "body": "<p>I know this post is a couple of months old, but I had the same issue today, and it took a lot to track this down.  (Nothing out there that I could find easily.)</p>\n\n<p>Hopefully this will help you if you still need it:</p>\n\n<pre><code>Dim cht As Chart\nDim s As Series\n\nActiveSheet.Shapes(1).Select\nSet cht = ActiveChart\nSet s = cht.SeriesCollection(1)\ns.Format.Fill.ForeColor.RGB = 49407\n</code></pre>\n\n<p>Just a heads up that I found this frequently crashed Excel if I ran it with the VBE open, but with it closed it worked just fine.</p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 11896490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5dc0d8f36025a04e0e9a03229a8b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/11896490/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572215158, "creation_date": 1565187790, "last_edit_date": 1565187807, "question_id": 57396620, "link": "https://stackoverflow.com/questions/57396620/how-to-use-excel-vba-code-to-change-the-color-of-a-series-in-a-box-and-whisker-p", "title": "How to use excel vba code to change the color of a series in a box and whisker plot?", "body": "<p>I am unable to code anything that will change the colors of a series in a box and whisker plot, and I can't find any hints at all online.</p>\n\n<p>I've tried using/modifying code that changes the color of series in scatterplots, but those don't work for box and whisker plots. I've tried recording a macro, but the code it produces doesn't show anything for the color change, it just shows me selecting the series and then the code ends, completely leaving out the color change, which I've never seen for any other type of plot when I've tried to do this. </p>\n\n<p>This is the code that I used to make the plot:</p>\n\n<pre><code>Worksheets(\"Data Summary\").Activate\nRange(cells(4, 2), cells(y + 3, a + 1)).Select\nActiveSheet.Shapes.AddChart2(406, xlBoxwhisker).Select\nFor seriesNumber = 1 To a\n    ActiveChart.SeriesCollection(seriesNumber).Name = cells(3,   seriesNumber + 1).Value\nNext seriesNumber    \n\n\nSet capacityChart = ActiveSheet.Shapes(1)\ncapacityChart.Name = \"Data Chart\"\n\nActiveSheet.ChartObjects(\"Data Chart\").Activate\nActiveChart.SetElement (301)\nActiveChart.SetElement (307)\nActiveChart.Axes(xlValue).AxisTitle.Select\nSelection.Caption = \"x axis name\"\nActiveChart.Axes(xlCategory).AxisTitle.Select\nActiveChart.SetElement (300)\nActiveChart.SetElement (msoElementChartTitleAboveChart)\nActiveChart.ChartTitle.Select\nSelection.Caption = \"y axis name\"\nActiveChart.Axes(xlCategory).Select\nActiveChart.SetElement (348)\nActiveChart.HasLegend = True\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 2, "creation_date": 1565192915, "post_id": 57396929, "comment_id": 101277805, "body": "Doesn&#39;t <code>Collection.Item</code> actually return a value of type <code>Variant</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1565193373, "post_id": 57396929, "comment_id": 101278038, "body": "Member calls against both <code>Object</code> and <code>Variant</code> are, through different mechanisms, resolved at run-time (i.e. late-bound); the key to making IntelliSense work everywhere, is to avoid late-bound member calls of any kind."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 0, "creation_date": 1565196022, "post_id": 57396929, "comment_id": 101279362, "body": "@M.Doerner It is not defined what is returned according to: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/item-method-visual-basic-for-applications\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> Is there even a way to test if something is &quot;wrapped&quot; into a variant without looking at the memory/RAM directly?"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 1, "creation_date": 1565197097, "post_id": 57396929, "comment_id": 101279850, "body": "There are two simple things that tell you that it must be <code>Variant</code>. First, the object browser in the VBE does not state a type, which always means that the type is <code>Variant</code>, just like in VBA code. Second, you can store strings and integers in collections, which are no objects."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565367966, "post_id": 57396929, "comment_id": 101345839, "body": "@L8n so in the following <code>Public Function Item(ByVal Index As Long) As ICustomElement</code> would I be replacing <code>ICustomElement</code> with my own class module name for that element?  Example: <code>Public Function Item(ByVal Index As Long) As clsSeq</code>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 1, "creation_date": 1565423102, "post_id": 57396929, "comment_id": 101357247, "body": "@Glenn G exactly, although in my case it was not a class but an Interface, (basically a class that has method declaration but no code), so I could have multiple classes implement that interface and be used in this collection. (The rubberduck link explains it well)"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565423328, "post_id": 57396929, "comment_id": 101357295, "body": "Now if I could just get the enum to work :/  I might make some real progress on my utility"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1565448338, "post_id": 57396929, "comment_id": 101362259, "body": "Have you followed these steps? <a href=\"https://stackoverflow.com/questions/19373081/how-to-use-the-implements-in-excel-vba/19379641#19379641\" title=\"how to use the implements in excel vba\">stackoverflow.com/questions/19373081/&hellip;</a>  The <code>Attribute</code> Lines are not meant to be written in the VBE, you have to do this externally in Notepad++ or anoother editor."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565700766, "post_id": 57396929, "comment_id": 101427990, "body": "@L8n I have and I have gotten a single enum to work in each of the class modules that I needed it for.  I&#39;m currently attempting to enumerate two different collections in the same class module, not sure if this is even possible but if it is, I&#39;d much rather that for my solution than having to go at it a different route"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1565706125, "post_id": 57396929, "comment_id": 101431210, "body": "If you need two iterable collections inside a class, why don&#39;t you just pack two CustomCollections inside the class and expose them? If you do this via a Getter and no Setter you also prevent it from being overwritten.  I&#39;ll also chek if two enumerables are possible, I&#39; write again once I know more."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565805341, "post_id": 57396929, "comment_id": 101469019, "body": "@L8n I&#39;m thinking this will work and is what I&#39;m going to try (enum &amp; class modules are very new for me)   <code>Private Type tSeqs     SequenceNumbers As Collection     RouterSequences As Collection End Type  Private cc1 As tSeqs  Public Property Get NewEnum() As IUnknown     Set NewEnum = cc1.SequenceNumbers.[_NewEnum] End Property  Public Property Get RouterList() As IUnknown     Set RouterList = cc1.RouterSequences.[_NewEnum] End Property </code>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565810298, "post_id": 57396929, "comment_id": 101470934, "body": "@GlennG I did a quick test with a similiar Method and it did not work, I&#39;m a bit strapped for time and will update my answer once I have more time available."}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 3, "last_activity_date": 1565195113, "last_edit_date": 1565195113, "creation_date": 1565188749, "answer_id": 57396929, "question_id": 57396581, "link": "https://stackoverflow.com/questions/57396581/how-to-code-so-that-intellisense-follows-the-complete-chain/57396929#57396929", "title": "How To Code So That Intellisense Follows The Complete Chain", "body": "<p>That is because <code>Parts</code> is a <code>Collection</code> and its Default Member Call (or <code>.Item</code>) will return a value/object depending what was stored. While editing your code VBA does not know what kind of value/object is stored in the collection (as this is only established during run-time, eg. late-bound), so it can not give you any Intellisense-suggestions.<br>\nTo circumvent this, you need a method (property/function) that returns a defined type of value/object (early-bound).<br>\nbtw. (<code>myCollection.(\"Foo\")</code> is the same as <code>myCollection.Item(\"Foo\")</code>)</p>\n\n<p>The solution is to create a custom collection that returns a value of a defined type.<br>\nThe following example also explains how to implement a custom Collection so you can use the default member call instead of using <code>.Item</code>.<br>\n<a href=\"https://stackoverflow.com/questions/19373081/how-to-use-the-implements-in-excel-vba/19379641#19379641\">How to use the Implements in Excel VBA</a></p>\n\n<p>While we're at it, please never use public variables in classes, make them accessible via Property Let/Set/Get methods!<br>\nMore on this here: <a href=\"https://rubberduckvba.wordpress.com/2019/07/08/about-class-modules/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2019/07/08/about-class-modules/</a></p>\n\n<h2>Edit:</h2>\n\n<p>Example for a custom Collection for classes that implement ICustomElement (Interfaces are explained in the link above)</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"CustomCollectionTemplate\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\n'@Folder(\"Classes\")\nOption Explicit\n\n\nPrivate Type  TCustomCollection\n    CustomCollection as Collection\nEnd Type\nDim this as TCustomCollection\n\n\nPrivate Sub Class_Initialize()\n        Set this.CustomCollection = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n        Set this.CustomCollection = Nothing\nEnd Sub\n\nPublic Property Get NewEnum() As IUnknown\nAttribute NewEnum.VB_UserMemId = -4\nAttribute NewEnum.VB_MemberFlags = \"40\"\n    Set NewEnum = this.CustomCollection.[_NewEnum]\nEnd Property\n\nPublic Sub Add(ByVal newCustomElement As ICustomElement)\n    this.CustomCollection.Add newCustomElement\nEnd Sub\n\nPublic Sub Remove(ByVal Index As Long)\n    this.CustomCollection.Remove Index\nEnd Sub\n\nPublic Function Item(ByVal Index As Long) As ICustomElement\n    Set Item = this.CustomCollection.Item(Index)\nEnd Function\n\nPublic Function Count() As Long\n    Count = this.CustomCollection.Count\nEnd Function\n</code></pre>\n\n<p>Thanks to M.Doerner &amp; Mathieu Guindeon for the edits/comments</p>\n"}], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 57396929, "answer_count": 1, "score": 3, "last_activity_date": 1565195113, "creation_date": 1565187671, "question_id": 57396581, "link": "https://stackoverflow.com/questions/57396581/how-to-code-so-that-intellisense-follows-the-complete-chain", "title": "How To Code So That Intellisense Follows The Complete Chain", "body": "<p>While this code works and I can assign and retrieve values across all levels, intellisense only displays the methods or properties 1 level deep.  How would I go about coding this so that I can follow my \"Path\" all the way down using intellisense and not necessarily have to just remember the methods or properties?</p>\n\n<p>for instance if I type <code>Wip.</code>  I get<br>\n<a href=\"https://i.stack.imgur.com/aZYDL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aZYDL.png\" alt=\"Intellisense Showing Methods/Properties\"></a></p>\n\n<p>but when I type <code>Wip.Parts(\"Test\").</code> , the SequenceNumbers member and its Methods/Properties are not displayed \n<a href=\"https://i.stack.imgur.com/BzDUH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BzDUH.png\" alt=\"No Intellisense Menu\"></a></p>\n\n<p>I have the following code</p>\n\n<p>clsSeq:</p>\n\n<pre><code>Option Explicit\nPrivate iSeq As String\nPrivate iQty As Double\n\nPublic Property Get Qty() As Double\n    Qty = iQty\nEnd Property\n\nPublic Property Let Qty(lQty As Double)\n    iQty = lQty\nEnd Property\n\nPublic Property Get Sequence() As String\n    Sequence = iSeq\nEnd Property\n\nPublic Property Let Sequence(lSeq As String)\n    iSeq = lSeq\nEnd Property\n</code></pre>\n\n<p>clsPart:</p>\n\n<pre><code>Option Explicit\n\nPrivate iPart As String\nPublic SequenceNumbers As Collection\n\nPublic Property Get PartNumber() As String\n    PartNumber = iPart\nEnd Property\n\nPublic Property Let PartNumber(lPart As String)\n    iPart = lPart\nEnd Property\n\nPublic Sub AddSequence(aSeq As String, aQty As Double)\n    Dim iSeq As clsSeq\n        If SeqExists(aSeq) Then\n            Set iSeq = SequenceNumbers.Item(aSeq)\n            iSeq.Qty = iSeq.Qty + aQty\n        Else\n            Set iSeq = New clsSeq\n            With iSeq\n                .Sequence = aSeq\n                .Qty = aQty\n            End With\n            SequenceNumbers.Add iSeq, iSeq.Sequence\n        End If\n        Set iSeq = Nothing\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set SequenceNumbers = New Collection\nEnd Sub\n\n\nPrivate Function SeqExists(iSeq As String) As Boolean\n    Dim v As Variant\n        On Error Resume Next\n        v = IsObject(SequenceNumbers.Item(iSeq))\n        SeqExists = Not IsEmpty(v)\nEnd Function\n</code></pre>\n\n<p>clsParts:</p>\n\n<pre><code>Option Explicit\n\nPublic Parts As Collection\n\nPublic Sub AddPart(iPart As String)\n    Dim iPrt As clsPart\n        If Not PartExists(iPart) Then\n            Set iPrt = New clsPart\n            With iPrt\n                .PartNumber = iPart\n            End With\n            Parts.Add iPrt, iPrt.PartNumber\n        End If\nEnd Sub\n\nPrivate Function PartExists(iPT As String) As Boolean\n    Dim v As Variant\n        On Error Resume Next\n        v = IsObject(Parts.Item(iPT))\n        PartExists = Not IsEmpty(v)\nEnd Function\n\n\nPrivate Sub Class_Initialize()\n    Set Parts = New Collection\nEnd Sub\n</code></pre>\n\n<p>modTest:</p>\n\n<pre><code>Sub TestWipCls()\n    Dim Wip As clsParts\n    Dim Part As clsPart\n\n        Set Wip = New clsParts\n        Wip.AddPart (\"Test\")\n        Set Part = Wip.Parts(\"Test\")\n        Part.AddSequence \"Proc7\", 1505\n        Debug.Print Wip.Parts(\"Test\").SequenceNumbers(\"Proc7\").Qty\n        Part.AddSequence \"Proc7\", 100\n        Debug.Print Wip.Parts(\"Test\").SequenceNumbers(\"Proc7\").Qty\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1565188263, "post_id": 57396570, "comment_id": 101275232, "body": "Try <code>.ListColumns(1).DataBodyRange.Resize(objDict.count)</code> ?"}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1565249217, "post_id": 57396570, "comment_id": 101295305, "body": "@PeterT returns <code>invalid use of property</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1565264896, "post_id": 57409877, "comment_id": 101303772, "body": "I&#39;m glad you achieved a workable solution. One suggestion is to use both <code>LBound</code> and <code>UBound</code> for looping over a dynamically created array. The lower bounds can be 0 or 1, depending on how the array is created. So <code>For lngRow = LBound(X, 1) to UBound(X, 1)</code> will always work for you."}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1565265447, "post_id": 57409877, "comment_id": 101304060, "body": "You are correct that it is more robust. Edited my answer."}], "tags": [], "owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "is_accepted": true, "score": 0, "last_activity_date": 1565265458, "last_edit_date": 1565265458, "creation_date": 1565258037, "answer_id": 57409877, "question_id": 57396570, "link": "https://stackoverflow.com/questions/57396570/resize-table-to-dictionary/57409877#57409877", "title": "Resize table to dictionary", "body": "<p>I edited the code so it works:</p>\n\n<pre><code>Sub A_Unique_B()\nDim X\nDim objDict As Object\nDim lngRow As Long\nDim tbl As ListObject\nDim tbl_o As ListObject\nDim keycount As Long\nDim lr As Long\n\nSet tbl = ThisWorkbook.Sheets(\"DATA\").ListObjects(\"tbl_data\")\nSet tbl_o = ThisWorkbook.Sheets(\"Overview\").ListObjects(\"tbl_overview\")\nSet objDict = CreateObject(\"Scripting.Dictionary\")\n\nX = Application.Transpose(tbl.ListColumns(2).DataBodyRange)\n\nFor lngRow = LBound(X, 1) To UBound(X, 1)\n    objDict(X(lngRow)) = 1\nNext\nkeycount = objDict.Count\n\n\nWith tbl_o\n   .Resize Range(\"C6:J\" &amp; keycount + 6)\n    .ListColumns(1).DataBodyRange = Application.Transpose(objDict.Keys)\nEnd With\n\nWith ThisWorkbook.Sheets(\"Overview\")\n    lr = .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1\n    .Range(\"C\" &amp; keycount + 7 &amp; \":J\" &amp; lr).ClearContents\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57409877, "answer_count": 1, "score": 0, "last_activity_date": 1565265458, "creation_date": 1565187648, "last_edit_date": 1565258100, "question_id": 57396570, "link": "https://stackoverflow.com/questions/57396570/resize-table-to-dictionary", "title": "Resize table to dictionary", "body": "<p>I have a dictionary populated from another table and I want to post the keys in the dictionary into my main table. The main table doesn't resize to match the count of keys.</p>\n\n<pre><code>Sub A_Unique_B()\nDim X\nDim objDict As Object\nDim lngRow As Long\nDim tbl As ListObject\nDim tbl_o As ListObject\n\nSet tbl = ThisWorkbook.Sheets(\"DATA\").ListObjects(\"tbl_data\")\nSet tbl_o = ThisWorkbook.Sheets(\"Overview\").ListObjects(\"tbl_overview\")\nSet objDict = CreateObject(\"Scripting.Dictionary\")\n\nX = Application.Transpose(tbl.ListColumns(2).DataBodyRange)\n\nFor lngRow = 1 To UBound(X, 1)\n    objDict(X(lngRow)) = 1\nNext\n\nWith tbl_o\n    ' Some code here maybe?\n    .ListColumns(1).DataBodyRange = Application.Transpose(objDict.Keys)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "file-not-found"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565189979, "post_id": 57396560, "comment_id": 101276206, "body": "Can you add the screenshots of the Cell values ?"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4928186, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y7TCq.jpg?s=128&g=1", "display_name": "Tommy Yap", "link": "https://stackoverflow.com/users/4928186/tommy-yap"}, "edited": false, "score": 0, "creation_date": 1565224520, "post_id": 57397696, "comment_id": 101289058, "body": "Thanks so much, this solve it but it occur another problem. Now is able to detect the file exist but it giving me error when the transfer happen. My code below: Workbooks(destination).Worksheets(destinationSheet).Cells(de&zwnj;&#8203;stinationSheetRow + i, Cells(8, j + 3)) _                 = Workbooks(source).Worksheets(sourceSheet).Cells(sourceSheetR&zwnj;&#8203;ow + i, Cells(4, j + 3)) On debug mode, the source and destination value are correct full path but unable to run."}, {"owner": {"reputation": 81, "user_id": 11885315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y6M0pcKblKw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3remK8Zx-xfduDK-pPqWrMIZSkxhgQ/photo.jpg?sz=128", "display_name": "aSIMetrical", "link": "https://stackoverflow.com/users/11885315/asimetrical"}, "reply_to_user": {"reputation": 85, "user_id": 4928186, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y7TCq.jpg?s=128&g=1", "display_name": "Tommy Yap", "link": "https://stackoverflow.com/users/4928186/tommy-yap"}, "edited": false, "score": 0, "creation_date": 1565267764, "post_id": 57397696, "comment_id": 101305453, "body": "That is because we set <code>source</code> and <code>destination</code> to the full file path.  <code>Workbook(index)</code> only recognizes a filename (i.e. <code>Workbook(&quot;filename.xlsx&quot;</code>) and does not recognize <code>Workbook(&quot;C:\\SampleFolder\\filename.xlsx&quot;)</code> as a valid Workbook.  I have updated my solution accordingly for your purposes."}], "tags": [], "owner": {"reputation": 81, "user_id": 11885315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y6M0pcKblKw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3remK8Zx-xfduDK-pPqWrMIZSkxhgQ/photo.jpg?sz=128", "display_name": "aSIMetrical", "link": "https://stackoverflow.com/users/11885315/asimetrical"}, "is_accepted": true, "score": 1, "last_activity_date": 1565267241, "last_edit_date": 1565267241, "creation_date": 1565191312, "answer_id": 57397696, "question_id": 57396560, "link": "https://stackoverflow.com/questions/57396560/vba-unable-to-read-files-after-closing-and-reopen-excel/57397696#57397696", "title": "VBA unable to read files after closing and reopen excel", "body": "<p>Based on the information you provided, I am assuming that the information provided by the users is just the file name without the extension: <code>item</code> or <code>master</code>, and not the full file path <code>C:\\SampleFolder\\item.xlsx</code> or <code>C:\\SampleFolder\\master.xlsx</code>.  Additionally, I am assuming when you run this code all three files must be in the same folder.</p>\n\n<p>If this is the case, try using <code>ThisWorkbook.Path</code>, you can apply this to your Source and Destination paths to ensure that the appropriate file path is being used.</p>\n\n<pre><code>Dim sPath as String\nsPath = ThisWorkbook.Path + \"\\\"\n\nsource = Cells(5, 2)\nsourceSheet = Cells(6, 2)\nsourceSheetRow = Cells(7, 2) - 1\n\ndestination = Cells(8, 2)\ndestinationSheet = Cells(9, 2)\ndestinationSheetRow = Cells(10, 2) - 1\n\nsource = source + \".xlsx\"\ndestination = destination + \".xlsx\"\n\nIf FileExists(sPath + source) = False Or FileExists(sPath + destination) = False Then\n    MsgBox \"File not found, please double check file name and make sure is in the same folder\"\nExit Sub\nEnd If\n...\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4928186, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y7TCq.jpg?s=128&g=1", "display_name": "Tommy Yap", "link": "https://stackoverflow.com/users/4928186/tommy-yap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 57397696, "answer_count": 1, "score": 1, "last_activity_date": 1565267241, "creation_date": 1565187627, "question_id": 57396560, "link": "https://stackoverflow.com/questions/57396560/vba-unable-to-read-files-after-closing-and-reopen-excel", "title": "VBA unable to read files after closing and reopen excel", "body": "<p>Assuming I have 3 files all in same folder (item.xlsx, master.xlsx, transfer.xlsm) Main purpose is to transfer data from item to master. </p>\n\n<p>I do all the codes inside transfer.xlsm and allow users to input file name and column mappings. I have been doing few hours for the codes and have tested several times and is working perfectly fine. With a click of a button is able to read data from item.xlsx and copy over to master.xlsx according to the column mapping. </p>\n\n<p>However problem arise when i close all 3 files and reopen again. I open up all 3 file, when i click on the button on transfer,xlsm it show file not found which is the error handling i did. I did tried creating a new folder on my desktop and create a brand new transfer.xlsm inside, i copy the item and master file over and my code into my new button. It actually able to work but when i close and reopen in that new folder is not working, </p>\n\n<p>Basically is working fine when i am working on it, when i close it totally and reopen it is unable to detect the 2 files.</p>\n\n<p><em>cell values are entered inside transfer.xlsm according to user input</em></p>\n\n<pre><code>source = Cells(5, 2)\nsourceSheet = Cells(6, 2)\nsourceSheetRow = Cells(7, 2) - 1\n\ndestination = Cells(8, 2)\ndestinationSheet = Cells(9, 2)\ndestinationSheetRow = Cells(10, 2) - 1\n\nsource = source + \".xlsx\"\ndestination = destination + \".xlsx\"\n\nrows = Cells(11, 2)\n\nIf FileExists(source) = False Or FileExists(destination) = False Then\n    MsgBox \"File not found, please double check file name and make sure is in the same folder\"\nExit Sub\nEnd If\n\nFor i = 1 To rows\n...\nNext i\n\nFunction FileExists(FilePath As String) As Boolean\nDim TestStr As String\n    TestStr = \"\"\n    On Error Resume Next\n    TestStr = Dir(FilePath)\n    On Error GoTo 0\n    If TestStr = \"\" Then\n        FileExists = False\n    Else\n        FileExists = True\n    End If\nEnd Function\n</code></pre>\n\n<p>I created this transfer.xlsm so that i can send it to people if they want to copy chunks of data from one excel to another instead of copy paste row by row. Hope someone can give me some guidance</p>\n"}, {"tags": ["excel", "vba", "batch-file"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1565187877, "post_id": 57396541, "comment_id": 101274999, "body": "Does <a href=\"https://stackoverflow.com/q/9403341/4650297\">this question</a> help?  Or <a href=\"https://stackoverflow.com/q/49918987/4650297\">this one</a>? Or any of <a href=\"https://www.google.com/search?hl=en&amp;q=run%20bat%20file%20from%20vba\" rel=\"nofollow noreferrer\">these</a>?"}, {"owner": {"reputation": 47, "user_id": 11714125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fec63d63adce8790e1768b0fc24142?s=128&d=identicon&r=PG&f=1", "display_name": "IoCalisto", "link": "https://stackoverflow.com/users/11714125/iocalisto"}, "edited": false, "score": 0, "creation_date": 1565188575, "post_id": 57396541, "comment_id": 101275433, "body": "What other ways have you tried? Besides path handling?"}, {"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 1, "creation_date": 1565190097, "post_id": 57396541, "comment_id": 101276291, "body": "Well, do you really need a batch file after all? Anyway, I would definitely build the date/time string in VBA rather than batch, because that is way easier and more reliable as not locale-dependent since there are such data types..."}], "owner": {"reputation": 21, "user_id": 10198161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnuUD.jpg?s=128&g=1", "display_name": "Sujit Kumar Swain", "link": "https://stackoverflow.com/users/10198161/sujit-kumar-swain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565187645, "creation_date": 1565187556, "last_edit_date": 1565187645, "question_id": 57396541, "link": "https://stackoverflow.com/questions/57396541/unable-to-execute-bat-file-from-macro", "title": "Unable to execute bat file from macro", "body": "<p>I have a batch file which I want to execute from an excel button click. \nI can execute batch file independently from cmd window but my macro code always throw error, my macro code is here:</p>\n\n<p>This always lead to error run-time error '5' invalid procedure call or argument.</p>\n\n<p>I tried many ways but still no luck, any luck.</p>\n\n<p>I have already tried with paths handling but still no luck.</p>\n\n<p>Macro:</p>\n\n<pre><code>Private Sub update_Click()\n    Dim ret As Integer\n    ret = Shell(\"D:\\Automation\\Main.bat\", vbNormalFocus)\nEnd Sub\n</code></pre>\n\n<p>Batch file:</p>\n\n<pre><code>REM remove files generated Start\ndel D:\\Automation\\results* /Q\nREM remove files generated End\n\nSET y=%date:~10,4%\nSET m=%date:~4,2%\nSET d=%date:~7,2%\nSET h=%time:~0,2%\nSET mm=%time:~3,2%\nSET s=%time:~6,2%\nSET resultfilename=D:\\Automation\\results_%y%%m%%d%_%h%%mm%%s%.txt\n\ncall ./CheckBuildStatus.bat 17 %resultfilename%\ncall ./CheckBuildStatus.bat 18 %resultfilename%\n\nREM remove files generated Start\ndel D:\\Automation\\webcontent.* /Q\nREM remove files generated End\n</code></pre>\n\n<p>I expect the batch should run when I click on the button in excel by macro.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1565188003, "post_id": 57396368, "comment_id": 101275084, "body": "Consider using Selenium instead of trying to use string matching functions to parse HTML."}, {"owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1565188602, "post_id": 57396368, "comment_id": 101275451, "body": "I&#39;m really sorry but I don&#39;t think I&#39;d be able to figure that out. I&#39;ve been looking at Selenium&#39;s website and I really have no idea where to start. I have fairly low levels of programming knowledge, I&#39;m pretty comfortable in Excel, but beyond that, I have extremely basic levels of knowledge. I can usually figure something out given enough time, but that looks like it would take me a couple months haha."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565272780, "post_id": 57413394, "comment_id": 101308826, "body": "Hey Asher, thanks so much for the help! Just a quick question, I&#39;m getting a  &quot;run-time error 91 - object variable or with block variable not set&quot;  at this part:  ``` Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp;i) = oElement(i).innerText ``` That&#39;s the start of the program running through column A (with the i+1&#39;s) right? Is it giving me that error because I&#39;m running VB for Applications rather than VB.net? I did a quick search and read that VB object variables require the Set keyword to be assigned, and this was taken out in VB.net, so maybe that&#39;s my problem?"}, {"owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565278709, "post_id": 57413394, "comment_id": 101312325, "body": "oElement is defined as an object at the top of the program, so I&#39;m totally lost on why I keep getting that error! I&#39;ve tried With, and Set directly before, neither worked; thought that innerText might need to be innerHtml so tried that, that didn&#39;t work, and I can&#39;t think of anything else that might help, so if you&#39;ve got any ideas, it would be very much appreciated :)"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565314301, "post_id": 57413394, "comment_id": 101324066, "body": "Ok, I just made some major changes to my original post.  Try the updated code.  I&#39;m sure this will work for you.  Remember, run this from Excel, not VB.NET."}, {"owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565360160, "post_id": 57413394, "comment_id": 101341979, "body": "Hey Asher so that seems to work until you run into one that doesn&#39;t have a <code>div class = Z0LcW</code> . Think you&#39;d have to put an <code>IF</code> statement in there like if &quot;Z0LcW&quot; not found in html, then return N/A, but I&#39;m not sure on the syntax of a statement like that in VBA. Again, total noob haha"}, {"owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565360869, "post_id": 57413394, "comment_id": 101342383, "body": "Oh interesting! Sometimes it will return the location (Abbott Laboratories Company number of employees returns Chicago, Illinois, United States), but only sometimes, the other times it will run into a 91 error code. And it will also run into an error if one of the strings contains an ampersand (&amp;). Neat! Haha so just run a search / replace on &amp; for and, and that takes care of that problem, but I&#39;m not sure on the other one"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "edited": false, "score": 0, "creation_date": 1565363813, "post_id": 57413394, "comment_id": 101343943, "body": "I saw some weird things too.  I guess if the data isn&#39;t there, it just isn&#39;t there.  You are only seeing what Google can find for you."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1565314184, "last_edit_date": 1565314184, "creation_date": 1565269666, "answer_id": 57413394, "question_id": 57396368, "link": "https://stackoverflow.com/questions/57396368/return-a-number-from-a-google-search-in-excel/57413394#57413394", "title": "Return a number from a google search in excel", "body": "<p>Try this.</p>\n\n<pre><code>Tool  &gt; References: Microsoft Internet Controls\nTool  &gt; References: Microsoft HTML Object Library\n\nSub GetHits()\n\nDim element As IHTMLElement\nDim elements As IHTMLElementCollection\nDim ie As InternetExplorer\nDim html As HTMLDocument\nDim count As Long\nDim erow As Long\n\nlastRow = Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\n' open Internet Explorer in memory, and go to website\nSet ie = New InternetExplorer\nie.Visible = True\n\nFor i = 2 To lastRow\n\n    ie.navigate \"https://www.google.com/search?q=\" &amp; Cells(i, 1)\n    ' Wait until IE has loaded the web page\n    Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        Application.StatusBar = \"Loading Web page . . . \"\n        DoEvents\n    Loop\n\n    Set html = ie.document\n    Set elements = html.getElementsByClassName(\"Z0LcW\")\n\n        Sheets(\"Sheet1\").Range(\"B\" &amp; i) = html.getElementsByClassName(\"Z0LcW\")(0).innerText\n        Debug.Print i\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>In cells A2:A5, you should  have something like this.</p>\n\n<pre><code>apple number of employees\ndisney number of employees\nIBM number of employees\n</code></pre>\n\n<p>That's your Google search.</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YVttm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YVttm.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BSUnf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BSUnf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 8916035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad16cae248821b36665f0acbc2dc9439?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8916035/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 57413394, "answer_count": 1, "score": 0, "last_activity_date": 1565314184, "creation_date": 1565186993, "last_edit_date": 1565194158, "question_id": 57396368, "link": "https://stackoverflow.com/questions/57396368/return-a-number-from-a-google-search-in-excel", "title": "Return a number from a google search in excel", "body": "<p>I have an excel file with about 6,000 entries on it, listing company, employees, and their titles. What I'd like to do is lookup the number of employees the company  has, and return that information in a column. I think there are some similar ideas here already, returning, for example, the number of results, or the first hyperlink, but I don't have enough VBA knowledge to alter those to get what I need to be honest. Here's the number of results macro:</p>\n\n<pre><code>\nDim searchWords As String\n\nWith Sheets(\"Sheet1\")\nRowCount = 2\nDo While .Range(\"A\" &amp; RowCount) &lt;&gt; \"\"\nsearchWords = .Range(\"A\" &amp; RowCount).Value\n\n' Get keywords and validate by adding + for spaces between\nsearchWords = Replace$(searchWords, \" \", \"+\")\n\n' Obtain the source code for the Google-searchterm webpage\nsearch_url = \"https://www.google.com/search?hl=en&amp;q=\" &amp; searchWords &amp; \"&amp;meta=\"\"\"\nSet search_http = CreateObject(\"MSXML2.XMLHTTP\")\nsearch_http.Open \"GET\", search_url, False\nsearch_http.send\nresults_var = search_http.responsetext\nSet search_http = Nothing\n\n' Find the number of results and post to sheet\npos_1 = InStr(1, results_var, \"div id=\" &amp; Chr(34) &amp; \"resultStats\", vbTextCompare) + 21\nIf pos_1 = 21 Then\nNumberofResults = 0\nElse\npos_2 = InStr(pos_1, results_var, \"result\", vbTextCompare) - 1\nNumberofResults = Val(Replace(Replace(Mid(results_var, pos_1, pos_2 - pos_1), \",\", \"\"), \"About\", \"\"))\nEnd If\nRange(\"B\" &amp; RowCount) = NumberofResults\nRowCount = RowCount + 1\nLoop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I believe this is the variable that Google uses for the number of employees :</p>\n\n<pre><code>&lt;div class=\"Z0LcW\"&gt;17,000\n</code></pre>\n\n<p>So I think by replacing <code>div id=</code> with <code>div class=</code> and <code>\"resultStats\"</code> with <code>\"Z0LcW\"</code> That will get me most of the way there? This is all completely new territory for me, I just checked multiple source pages after searching for number of employees, and that was consistently the variable that related to the number of employees.</p>\n\n<p>I know how to do the search - just combine company name with \"number of employees\" and hyperlink it:\n<a href=\"https://i.stack.imgur.com/5E6kJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5E6kJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>And it looks like it should be fairly easy to pull the number of employees, as Google returns it as the first item usually, but getting everything to play nice is beyond me. Any help would be much appreciated!\n<a href=\"https://i.stack.imgur.com/48oSR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/48oSR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "boolean"], "comments": [{"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 3, "creation_date": 1565186931, "post_id": 57396274, "comment_id": 101274394, "body": "What is so bad about <code>if</code>?"}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 0, "creation_date": 1565194897, "post_id": 57396274, "comment_id": 101278768, "body": "<code>tmp = MyVariable if MyVariable &lt;= 100 else MyVariable &#47; 100</code>"}, {"owner": {"reputation": 1, "user_id": 11786194, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j20c7iI39is/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcvLoCmDCTFNuZso9-8w5K53l5LHQ/photo.jpg?sz=128", "display_name": "Luthius", "link": "https://stackoverflow.com/users/11786194/luthius"}, "reply_to_user": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "edited": false, "score": 0, "creation_date": 1565195912, "post_id": 57396274, "comment_id": 101279310, "body": "The ideia is NOT using the IF or Select Case."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 2, "creation_date": 1565196941, "post_id": 57396274, "comment_id": 101279788, "body": "Besides the ambiguous use of the <code>tmp</code>variable with differring  type assignments (first boolean, then numeric) it&#39;s unclear how one can distinguish meters from centimeters only by ist numeric value.   Following your logic you <i>exclude</i> numbers <b>greater 100</b> completely from calculation as <code>tmp</code> will be <code>False</code> thus resulting in a <i>zero</i> multiplication and a result of <code>0</code> (even if not so its unclear how you expect valid meter inputs). Furthermore the <code>tmp</code> variable set to <code>True</code> for your cm indications (i.e. &lt;=100) has a value of <code>-1</code> thus leading in a possibly unwanted <i>negative</i> result :-)"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1565197594, "post_id": 57398327, "comment_id": 101280079, "body": "In what way does this answer the (very broad) question?"}], "tags": [], "owner": {"reputation": 1, "user_id": 11786194, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j20c7iI39is/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcvLoCmDCTFNuZso9-8w5K53l5LHQ/photo.jpg?sz=128", "display_name": "Luthius", "link": "https://stackoverflow.com/users/11786194/luthius"}, "is_accepted": false, "score": -1, "last_activity_date": 1565193629, "creation_date": 1565193629, "answer_id": 57398327, "question_id": 57396274, "link": "https://stackoverflow.com/questions/57396274/elegant-way-to-convert-units-centimeters-cm-to-meters-m-and-vice-versa/57398327#57398327", "title": "Elegant way to convert units Centimeters (Cm) to Meters (m) and Vice Versa", "body": "<p>It is not a matter of bad or good. It is finding/developing different ways to reach the result. Sometimes elegantly sometimes optimized.</p>\n\n<pre><code>Sub ToggleTrueOrFalseSlower()\n Dim bYesNo As Boolean\n\n If bYesNo = False Then\n  bYesNo = True\n Else\n  bYesNo = False\n End If\nEnd Sub\n\nSub ToggleTrueOrFalseFaster()\n Dim bYesNo As Boolean\n bYesNo = Not bYesNo\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11786194, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j20c7iI39is/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcvLoCmDCTFNuZso9-8w5K53l5LHQ/photo.jpg?sz=128", "display_name": "Luthius", "link": "https://stackoverflow.com/users/11786194/luthius"}, "is_accepted": false, "score": -1, "last_activity_date": 1565373164, "last_edit_date": 1565373164, "creation_date": 1565353397, "answer_id": 57429995, "question_id": 57396274, "link": "https://stackoverflow.com/questions/57396274/elegant-way-to-convert-units-centimeters-cm-to-meters-m-and-vice-versa/57429995#57429995", "title": "Elegant way to convert units Centimeters (Cm) to Meters (m) and Vice Versa", "body": "<p>Guys I guess I could solve using this. Only the Number divided by Zero is the problem right now.</p>\n\n<pre><code>tmp=(10)^(2*(MyVariable&gt;100))\n</code></pre>\n\n<p>What do you think guys? See a sample code:</p>\n\n<pre><code>Function BMI(W As Double, H As Double)\n  Dim tmp As Double\n  tmp = (W * H) &gt; 0\n  tmp = tmp * ((10) ^ (2 * (H &gt; 100)) * H)\n  BMI = Round(W / (tmp ^ 2), 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11786194, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j20c7iI39is/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcvLoCmDCTFNuZso9-8w5K53l5LHQ/photo.jpg?sz=128", "display_name": "Luthius", "link": "https://stackoverflow.com/users/11786194/luthius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1565373164, "creation_date": 1565186674, "question_id": 57396274, "link": "https://stackoverflow.com/questions/57396274/elegant-way-to-convert-units-centimeters-cm-to-meters-m-and-vice-versa", "title": "Elegant way to convert units Centimeters (Cm) to Meters (m) and Vice Versa", "body": "<p>I am looking forward a way to develop an elegant way to Convert Cm to Meter and vice versa without using IF conditions or Select Case, only working on Boolean type.\nThes \"tmp\" variable manipulation will be in a elegant way that will NOT change when the value is already in Meters.</p>\n\n<pre><code>MyVariable\ntmp= Not(MyVariable&gt;100)\ntmp= (MyVariable*tmp)/100 '(Converting to meters in case the Value is in Cm)\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "edited": false, "score": 0, "creation_date": 1565186416, "post_id": 57396065, "comment_id": 101274085, "body": "First of all, lets be on the same page about terminology: do you want a separate &quot;presentation&quot; for each correspondence or do you want to have a single presentation with separate &quot;slides&quot; for each correspondence? Secondly, are we dealing with tables here (and if so why?) or can this not be achieved by having a simple TextBox object in each slide, containing the correspondence name and the 2 paragraphs?"}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "reply_to_user": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "edited": false, "score": 0, "creation_date": 1565254097, "post_id": 57396065, "comment_id": 101297765, "body": "Hello thanks for the response. Separate presentation for each, just the first slide for now is what I&#39;m trying to figure out. And at this point no tables also but later on there will be slides which contain charts and other values in the same way (I guess learning how to make it work with textboxes would solve my problem then too though).  Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565187732, "post_id": 57396162, "comment_id": 101274916, "body": "That sounds like an amazing way to approach it. Could you please help me a little further?  Let&#39;s say I have already made some master slides. How do I then save this as a template and use it for the purpose of applying this solution?  So imagine all the page is constant, and I just use one textbox at the right spot to paste this variable from the cells A2 all the way down to A140 for example (I made a mistake regarding this in the question which I will fix now).  And each of these going into a separate powerpoint file, as they are prepared for the different addressees.  Thanks a lot!"}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "reply_to_user": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565188472, "post_id": 57396162, "comment_id": 101275363, "body": "So basically you have one powerpoint already prepared but need 139 of those with just one name different? everything else remaining the same? or do you also need to make the first powerpoint from the excel data itself?"}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565188772, "post_id": 57396162, "comment_id": 101275555, "body": "Let&#39;s say one PowerPoint is already made!  So at later points based on the values in the other cells I would like to also add to each of these powerpoints different things.  For now I have the template already prepared, 1 slide with a text that remains constant, and just 1 textbox that has the different variables from A2 to A140. How would I paste these variables into the different files so they each contain a letter addressed to the recipient based on the Excel sheet?  Thanks a lot for your help!"}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "reply_to_user": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565193599, "post_id": 57396162, "comment_id": 101278156, "body": "I have edited the answer to include sample code, you can modify which text box you want your data to be inserted into. It&#39;ll save as the file as different name into a folder you select, should satisfy your need."}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565253892, "post_id": 57396162, "comment_id": 101297637, "body": "Thanks a lot for your response! I appreciate it very much. This already gives me some really cool ideas and introduces important concepts and tricks I had no idea about. However, unfortunately, there is an issue. Could you help me out a bit further? It says Run-time error &#39;91&#39;: Object variable or With block variable not set; For the line that says Set Rng = ... What could be the problem?  And I must name the text box Title 1 for this to work?"}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "reply_to_user": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565254427, "post_id": 57396162, "comment_id": 101297941, "body": "Is your excel sheet open? you have to open the sheet and run the code in the powerpoint for it to work, and also check if <code>excelSht</code> is not empty/null.  As for the &quot;Title 1&quot; it was the default name of the title box i was trying this on, you need to input your name there, if you aren&#39;t sure you can use <code>like &quot;Title*&quot;</code> if you want to modify the title (will modify all title boxes). you can try adding <code>Debug.print shp.Name</code> in the loop outside the condition to first get the list of all shape names and then choose which one you want."}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565260605, "post_id": 57396162, "comment_id": 101301483, "body": "Man, you&#39;re amazing. Thank you so much! This is so cool. So another question... I really want to learn how to build up on this and do other things. This was only the start. Is there a good resource that you know of which can help me out with this? Would you be okay with helping me out with this also? I suppose I will need to do that in new threads."}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "reply_to_user": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565260771, "post_id": 57396162, "comment_id": 101301574, "body": "yeah, you are right now at the best resource site, search what you need to know, just need to be careful of wording and you&#39;ll find most answers. Normally I just google what I don&#39;t know and I find answers. (Little secret : it was my first time automating powerpoint, i have done a lot of vba in excel and word but I wasn&#39;t familiar with powerpoint object model.) just keep seeking answers to your problem and you&#39;ll learn as you solve more."}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1565260843, "post_id": 57396162, "comment_id": 101301607, "body": "Thank you very very much for all the time and energy you put into helping me out with this. I&#39;ll definitely be doing that. Wish you an awesome day."}, {"owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "edited": false, "score": 0, "creation_date": 1566216216, "post_id": 57396162, "comment_id": 101574355, "body": "Hey there, would there be any chance of getting in touch with you to work out some more VBA issues if your time allows and you&#39;re up for it? Thanks man!"}], "tags": [], "owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "is_accepted": true, "score": 0, "last_activity_date": 1565193473, "last_edit_date": 1565193473, "creation_date": 1565186289, "answer_id": 57396162, "question_id": 57396065, "link": "https://stackoverflow.com/questions/57396065/how-to-create-many-powerpoint-presentations-containing-a-slide-with-a-variable-f/57396162#57396162", "title": "How to create many powerpoint presentations containing a slide with a variable from an Excel table?", "body": "<p>Goto master slide view and make a template as you need; like specific text boxes and things, then from excel make a new slide of that template each time and fill those boxes from variables which are in the cell. If you are just learning to program it'll be better than trying to add text boxes and everything by code.\nThe code on the for loop depends on your presentation slide structure, if you can specify the data and format, then it is clear.\nPut this code in powerpoint VBA, it'll let you access the data in excel, open the excel sheet with data and run it after you put something appropriate in the loop.</p>\n\n<pre><code>Public Sub test()\nDim excelSht As Worksheet\nDim excelApp As Excel.Application\nSet excelApp = GetObject(, \"excel.application\")\nSet excelSht = excelApp.ActiveSheet\nDim path As String\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Show\n    path = .SelectedItems(1)\nEnd With\n'Set rng = excelApp.Selection ' use this if you want to select the data in advance\nSet rng = excelSht.Range(\"A2:A140\") ' use this if your data range is fixed\nFor Each cel In rng\n    For Each shp In Application.Presentations(1).Slides(1).Shapes\n        If shp.Name Like \"Title 1\" Then shp.TextFrame.TextRange.Text = \"Dear, \" &amp; cel.Value ' this one choose the name of the shape of which one you want to change the text.\n    Next\n    Application.Presentations(1).SaveAs (path &amp; \"\\\" &amp; cel.Value &amp; \".pptx\")\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11863550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y_JC8QnO6po/AAAAAAAAAAI/AAAAAAAAAi0/HOipkyk-WV4/photo.jpg?sz=128", "display_name": "Adel Moin", "link": "https://stackoverflow.com/users/11863550/adel-moin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 57396162, "answer_count": 1, "score": 0, "last_activity_date": 1580702839, "creation_date": 1565185990, "last_edit_date": 1592644375, "question_id": 57396065, "link": "https://stackoverflow.com/questions/57396065/how-to-create-many-powerpoint-presentations-containing-a-slide-with-a-variable-f", "title": "How to create many powerpoint presentations containing a slide with a variable from an Excel table?", "body": "<p>I am trying create PowerPoint presentations using values in an Excel table.</p>\n<p>A2, A3, A4, etc. will each contain a name. The slide in each pptx file will be a test containing three paragraphs, and at the beginning the names in those cells are addressed in this way:</p>\n<blockquote>\n<p>Dear 'BA2',</p>\n<p>[paragraph1 ]</p>\n<p>[paragraph 2]</p>\n<p>Yours faithfully,<br />\n...</p>\n</blockquote>\n<p>And same goes for the other cells.</p>\n<pre><code>Dim ppApp As PowerPoint.Application\nDim ppPres As PowerPoint.Presentation\nDm ppSlide As PowerPoint.Slide\n\nSet ppApp = New PowerPoint.Application\n\nppApp.Visible = True\nppApp.Activate\n\nSet ppPres = ppApp.Presentations.Add \n\nSet ppSlide = ppPres.Slides.Add(1, ppLayoutBlank)\n\nSet ppApp = New PowerPoint.Application\n\nppApp.Visible = True\nppApp.Activate\n\nset ppSlide = ppPres.Slides.Add(2,pp LayoutBlank(\nppSlide.Select\n\nRange(&quot;A1&quot;).CurrentRegion.Copy\nppSlide.Shapes.Paste\n</code></pre>\n<p>This code will copy and paste the whole table into one slide. Quite different from what I want, but what I need to know is how to just paste these cell by cell, into separate sheets, using a for loop or something of that sort.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1565187423, "post_id": 57396005, "comment_id": 101274716, "body": "Using the comma &quot;,&quot; range operator, you can create a string and use it like this: <code>range(&quot;a1, a4, a6&quot;).Entirerow.Select</code>"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1565192136, "post_id": 57396005, "comment_id": 101277421, "body": "If you have more than 16383 rows, using an <code>Integer</code> type is a problem. It is recommended to replace all instances of <code>Integer</code> with <code>Long</code> which is a 32-bit integer value. The <code>Integer</code> type is 16-bit wide only. (see <a href=\"https://stackoverflow.com/a/31816532/380384\">stackoverflow.com/a/31816532/380384</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1565187286, "post_id": 57396356, "comment_id": 101274621, "body": "As written, this code will always error on the first attempt at <code>Union</code> because <code>selectionRange</code> will be <code>Nothing</code> at that time and you can&#39;t union a null range. Need to test if <code>selectionRange</code> is nothing and if so simply set it to the range that meets the criteria, otherwise Union as shown. You also need to make sure you use the <code>Set</code> keyword when assigning object variables (such as ranges), so it should be <code>Set selectionRange = ...</code>"}, {"owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1565187533, "post_id": 57396356, "comment_id": 101274786, "body": "You are right, this also goes to show that I should test my answers before posting them :) I have made the related edits, thank you for the warning."}], "tags": [], "owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "is_accepted": true, "score": 1, "last_activity_date": 1565187452, "last_edit_date": 1565187452, "creation_date": 1565186951, "answer_id": 57396356, "question_id": 57396005, "link": "https://stackoverflow.com/questions/57396005/how-to-select-specific-rows-from-an-array-containing-row-indexes-in-excel-with-v/57396356#57396356", "title": "How to select specific rows from an array containing row Indexes in excel with vba", "body": "<p>I would say you need to make use of the <code>Union()</code> function. Modify you code as below, I am assuming you have checked and confirmed that <code>asarray</code> contains the correct indexes of rows and I will not look into those parts.</p>\n\n<pre><code>Sub Playground()\n\nDim currentContract As String\ncurrentContract = \"none\"\nDim CCIsPos As Boolean\nCCIsPos = False\nDim i As Integer\nDim selectionRange as Range\n\nFor Each Cell In Sheets(\"Playground\").Range(\"E:E\")\n    matchRow = Cell.Row\n    If Cell.Value &lt;&gt; currentContract Then\n        currentContract = Cell.Value\n        If Cells(matchRow, \"J\") &gt; 0 Then\n            CCIsPos = True\n        Else\n            CCIsPos = False\n        End If\n    End If\n    If CCIsPos Then\n        If Not selectionRange Is Nothing Then\n            Set selectionRange = Union(selectionRange, Sheets(\"Playground\").Rows(matchRow).EntireRow)\n        Else\n            Set selectionRange = Sheets(\"Playground\").Rows(matchRow).EntireRow\n        End If\n    End If\nNext Cell\n\nselectionRange.Select\n\nEnd Sub\n</code></pre>\n\n<p>I hope this resolves your issue.</p>\n"}], "owner": {"reputation": 17, "user_id": 6796748, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RYJM1_Cp1lo/AAAAAAAAAAI/AAAAAAAABMk/WT1CiN9mCYw/photo.jpg?sz=128", "display_name": "Laurenz Strauch", "link": "https://stackoverflow.com/users/6796748/laurenz-strauch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 57396356, "answer_count": 1, "score": 0, "last_activity_date": 1565187452, "creation_date": 1565185763, "last_edit_date": 1565186996, "question_id": 57396005, "link": "https://stackoverflow.com/questions/57396005/how-to-select-specific-rows-from-an-array-containing-row-indexes-in-excel-with-v", "title": "How to select specific rows from an array containing row Indexes in excel with vba", "body": "<p>I am working with a long list in excel and I have to select specific rows that fit criteria. I managed to create an array containing the index number of those rows. All I have to do now is to select those rows.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Playground()\n\nDim currentContract As String\ncurrentContract = \"none\"\nDim CCIsPos As Boolean\nCCIsPos = False\nDim asarray() As Integer\nDim i As Integer\n\nReDim asarray(1 To Sheets(\"Playground\").UsedRange.Rows.Count)\nFor Each Cell In Sheets(\"Playground\").Range(\"E:E\")\n\n    matchRow = Cell.Row\n\n    If Cell.Value &lt;&gt; currentContract Then\n        currentContract = Cell.Value\n        If Cells(matchRow, \"J\") &gt; 0 Then\n            CCIsPos = True\n        Else\n            CCIsPos = False\n        End If\n       End If\nIf CCIsPos Then\n    i = i + 1\n    asarray(i) = matchRow\nEnd If\nNext Cell\n\n'Would need a function here selecting rows from the array \"asarray\"\n'Rows(asarray).Select doesn't work.\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 4, "creation_date": 1565187759, "post_id": 57395952, "comment_id": 101274937, "body": "You are using <i>lookup fields</i>, so include table <i>Hersteller</i> and <i>Type</i> in your query and select the fields from these that holds the names of <i>Herst</i> and <i>Typ</i>. Lookup fields may seem smart but will cause endless troubles like this."}, {"owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1565188319, "post_id": 57395952, "comment_id": 101275266, "body": "Thank you very much, @Gustav, that was it. It also solved the problem I had with the column names as it seems that Access ignores the aliases on those columns."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1565204973, "post_id": 57395952, "comment_id": 101283399, "body": "Why did you include tblHersteller and tblReifentyp in query to begin with if you did not intend to use any fields from them? What did you think just joining would accomplish?"}, {"owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1565335883, "post_id": 57395952, "comment_id": 101329052, "body": "@June7 This is the SQL Statement that MS-Access <i>gives you</i> when you make the Query with the Query-Assistant so I assumed that is how Access wants the query to look like, but apparently not."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1565336447, "post_id": 57395952, "comment_id": 101329317, "body": "By Query-Assistant you mean query designer or wizard ? I have never seen either include tables I did not request so I am still confused as to why your query had tables whose fields were not referenced."}, {"owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "edited": false, "score": 0, "creation_date": 1565343643, "post_id": 57395952, "comment_id": 101332882, "body": "Yes, I mean the designer. And now I see my mistake. Although the tables where there, I was clicking the whole time the foreign_key fields instead of the fields in the referenced tables... but it works, somehow. It shows the joined fields when testing the query, but not when using it... Anyway, thanks for the hint, now I fully comprehend the error."}], "owner": {"reputation": 186, "user_id": 4767735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612632146c369189e969fe362e96f891?s=128&d=identicon&r=PG&f=1", "display_name": "elserra", "link": "https://stackoverflow.com/users/4767735/elserra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565186929, "creation_date": 1565185605, "last_edit_date": 1565186929, "question_id": 57395952, "link": "https://stackoverflow.com/questions/57395952/listbox-rowsource-not-showing-joined-columns-although-query-does", "title": "Listbox RowSource not showing joined columns although query does", "body": "<p>I have a query which works as it should in the Query-View in Access, but when I use the very same query for populating a list in a Form, the tables are not joined together.</p>\n\n<p>The structure is very easy, the joined data are just brands and types.</p>\n\n<p>The SQL-Code:</p>\n\n<pre><code>SELECT tblDBReifen.herst_fk, tblDBReifen.dbPROFIL AS Profil, tblDBReifen.rtyp_fk AS Reifentyp\nFROM (tblDBReifen \nLEFT JOIN tblHersteller ON tblDBReifen.[herst_fk] = tblHersteller.[herst_id]) \nLEFT JOIN tblReifentyp ON tblDBReifen.[rtyp_fk] = tblReifentyp.[rtype_id];\n</code></pre>\n\n<p>VBA Code:</p>\n\n<pre><code>lstReifenauswahl.RowSourceType = \"Table/Query\"\nlstReifenauswahl.RowSource = \"StringNameOfTheQuery\"\n</code></pre>\n\n<p>When viewing the query in Access, I get the table right:</p>\n\n<pre><code>| Herst    | Profil       |    Typ     |\n| Pirelli  | Somename     | Summer     |\n| Michelin | Othername    | Winter     |\n</code></pre>\n\n<p>But the list in the form shows only the indexes:</p>\n\n<pre><code>| Herst    |   Profil     |    Typ     |\n| 2        | Somename     | 1          |\n| 4        | Othername    | 2          |\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["vba", "addressof"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1565186121, "post_id": 57395851, "comment_id": 101273898, "body": "<i>Compile Error: Expected Expression?</i>  Is that what you have without qualifying <code>VBA.CLngPtr</code>? If so, I can reproduce it, but I haven&#39;t a clue why..."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1565186289, "post_id": 57395851, "comment_id": 101273999, "body": "@DavidZemens yep, should&#39;ve put that in the question. Then if I try to run the code with <code>F5</code> I get <i>Compile Error: Syntax Error</i>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1565187979, "post_id": 57395851, "comment_id": 101275067, "body": "I think it has to do with the AddressOf operator because <code>VBA.CLngPtr(avar)</code> and <code>ClngPtr(avar)</code> work as expected."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565190660, "post_id": 57396732, "comment_id": 101276594, "body": "Can you elaborate on what this means: <i>it&#39;s actually inlining the method</i>? And maybe (if you can) explain why this doesn&#39;t recognize <code>AddressOf func</code> as an expression?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1565194566, "post_id": 57396732, "comment_id": 101278608, "body": "Added an explanation but keep in mind that I do not have full knowledge so I might be wrong in some spot but hopefully that helps explains."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": true, "score": 4, "last_activity_date": 1565194527, "last_edit_date": 1565194527, "creation_date": 1565188085, "answer_id": 57396732, "question_id": 57395851, "link": "https://stackoverflow.com/questions/57395851/difference-between-vba-cblah-and-cblah/57396732#57396732", "title": "Difference between VBA.CBlah and CBlah", "body": "<p>This would be not very obvious if you used the default IDE settings which the keywords and identifiers aren't really set that differently. Here's how it looks when you use different colors:\n<a href=\"https://i.stack.imgur.com/1PYBz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1PYBz.png\" alt=\"Sample Code\"></a></p>\n\n<p>You can see that <code>CLngPtr</code> lights up like a christmas tree and looks just like any other keywords. Compare this with <code>Abs</code>, which is also a function but stays light blue, as if it was just an identifier. </p>\n\n<p>This is a hint that <code>CLngPtr</code> is optimized by VBA compiler so it's actually inlining the method<sup>1</sup>, which is why you get error if you try to use <code>CLngPtr</code> as an expression. However, a <code>VBA.CLngPtr</code> is a proper function and thus can be used as a part of an expression but with very slight performance penalty due to non-optimizing route.</p>\n\n<p>You would see the same thing with say, <code>CLng</code> or any conversion functions, and even <code>Mid</code> the statement (not function). There are several functions within <code>VBA</code> that may get inlined by the compiler and usually can be differed by whether they turn into keywords or not. Note also that the parenthesis are colored differently. </p>\n\n<p>Heck, even <code>Debug.Print</code> gets the special treatment, too and if you are familiar with it, you may know that it's not exactly a class nor a module, yet you can't <code>Print</code> without <code>Debug</code>.</p>\n\n<hr>\n\n<ol>\n<li>When we refer to \"inlinling\" here, we are talking about what the VBA compiler is doing at lower level, below than what we see at the source code level. From the source code, <code>C***()</code> and <code>VBA.C***()</code> are basically the same thing. However, the VBA compiler can and will try to optimize those bits, by internally rearranging the machine instructions for converting (or whatever the inlined function is doing). The effect of rearranging the instruction is that it might no longer be compatible in all contexts. In this case, I can imagine (but do not know for a fact!) that <code>CLngPtr()</code>'s inlined instructions returns a value, rather than a reference, which is incompatible for a parameter declaration, which is why we get a syntax error when we try to use it as a parameter. Note this does not happen with <code>AddressOf</code> -- any other function on the LHS will have the same syntax error, so it has nothing to do with the <code>AddressOf</code> and everything with the method being inlined.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1565188102, "creation_date": 1565188102, "answer_id": 57396739, "question_id": 57395851, "link": "https://stackoverflow.com/questions/57395851/difference-between-vba-cblah-and-cblah/57396739#57396739", "title": "Difference between VBA.CBlah and CBlah", "body": "<p>Not an answer, but more weirdness to ponder...</p>\n\n<p>With the noted compile error in the comment, this works (<a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions\" rel=\"nofollow noreferrer\">ref</a>):</p>\n\n<pre><code>Sub TestCasting()\n    Dim value As Variant\n    Debug.Print \"value cast with     CBool  : \" &amp; CBool(value)\n    Debug.Print \"value cast with VBA.CBool  : \" &amp; VBA.CBool(value)\n\n    Debug.Print \"value cast with     CByte  : \" &amp; CByte(value)\n    Debug.Print \"value cast with VBA.CByte  : \" &amp; VBA.CByte(value)\n\n    Debug.Print \"value cast with     CCur   : \" &amp; CCur(value)\n    Debug.Print \"value cast with VBA.CCur   : \" &amp; VBA.CCur(value)\n\n    Debug.Print \"value cast with     CDate  : \" &amp; CDate(value)\n    Debug.Print \"value cast with VBA.CDate  : \" &amp; VBA.CDate(value)\n\n    Debug.Print \"value cast with     CDbl   : \" &amp; CDbl(value)\n    Debug.Print \"value cast with VBA.CDbl   : \" &amp; VBA.CDbl(value)\n\n    Debug.Print \"value cast with     CDec   : \" &amp; CDec(value)\n    Debug.Print \"value cast with VBA.CDec   : \" &amp; VBA.CDec(value)\n\n    Debug.Print \"value cast with     CInt   : \" &amp; CInt(value)\n    Debug.Print \"value cast with VBA.CInt   : \" &amp; VBA.CInt(value)\n\n    Debug.Print \"value cast with     CLng   : \" &amp; CLng(value)\n    Debug.Print \"value cast with VBA.CLng   : \" &amp; VBA.CLng(value)\n\n    '--- Compile Error: Sub or Function not found\n    '    (error displayed at run time)\n    'Debug.Print \"value cast with     CLngLng: \" &amp; CLngLng(value)\n    'Debug.Print \"value cast with VBA.CLngLng: \" &amp; VBA.CLngLng(value)\n\n    Debug.Print \"value cast with     CLngPtr: \" &amp; CLngPtr(value)\n    Debug.Print \"value cast with VBA.CLngPtr: \" &amp; VBA.CLngPtr(value)\n\n    Debug.Print \"value cast with     CSng   : \" &amp; CSng(value)\n    Debug.Print \"value cast with VBA.CSng   : \" &amp; VBA.CSng(value)\n\n    Debug.Print \"value cast with     CStr   : \" &amp; CStr(value)\n    Debug.Print \"value cast with VBA.CStr   : \" &amp; VBA.CStr(value)\n\n    Debug.Print \"value cast with     CVar   : \" &amp; CVar(value)\n    Debug.Print \"value cast with VBA.CVar   : \" &amp; VBA.CVar(value)\n\nEnd Sub\n</code></pre>\n\n<p>And adding to your code example above:</p>\n\n<pre><code>Function myFunc() As String\n    myFunc = \"help!\"\nEnd Function\n\nFunction getAddress(ByVal func As LongPtr) As LongPtr\n    getAddress = func\nEnd Function\n\nSub printAddress()\n    Dim functionPointer As LongPtr\n    functionPointer = getAddress(AddressOf myFunc)\n    Debug.Print functionPointer\n    functionPointer = VBA.CLngPtr(AddressOf myFunc)\n\n    '--- Compile Error: Syntax Error\n    '    (error displayed in red in VBA Editor)\n    'debug.Print CLngPtr(AddressOf myFunc)\n    'functionPointer = CLngPtr(AddressOf myFunc)\n    Debug.Print functionPointer\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 57396732, "answer_count": 2, "score": 6, "last_activity_date": 1565194527, "creation_date": 1565185248, "last_edit_date": 1565186400, "question_id": 57395851, "link": "https://stackoverflow.com/questions/57395851/difference-between-vba-cblah-and-cblah", "title": "Difference between VBA.CBlah and CBlah", "body": "<p>Weird observation:</p>\n\n<p>Normally when I want to save an address to a function in a variable, I do something like this:</p>\n\n<pre><code>Function getAddress(ByVal func As LongPtr) As LongPtr\n    getAddress = func\nEnd Function\n\nSub printAddress()\n    Dim functionPointer As LongPtr\n    functionPointer = getAddress(AddressOf myFunc)\n    Debug.Print functionPointer\nEnd Sub\n</code></pre>\n\n<p>However I just discovered I can use a 1-liner</p>\n\n<pre><code>functionPointer = VBA.CLngPtr(AddressOf myFunc)\n</code></pre>\n\n<p>while</p>\n\n<pre><code>functionPointer = CLngPtr(AddressOf myFunc)\n</code></pre>\n\n<p>... does not work and raises</p>\n\n<blockquote>\n  <p><em>Compile error:</em></p>\n  \n  <p><em>Expected: expression</em> </p>\n</blockquote>\n\n<p>What's going on? The only difference as far as I'm aware is that <code>CLngPtr</code> is declared in the globals (class?) whereas <code>VBA.CLngPtr</code> is explicitly qualified, but I have no idea why that would lead to the observed behaviour (they both point to the same function don't they?)</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1565366226, "last_edit_date": 1565366226, "creation_date": 1565269123, "answer_id": 57413221, "question_id": 57395627, "link": "https://stackoverflow.com/questions/57395627/paste-the-copied-number-in-find-dialog-box/57413221#57413221", "title": "Paste the copied number in Find dialog box", "body": "<p>The following code sample demonstrates how this can be done. There's a lot to take in...</p>\n\n<p>Create objects for the two documents. Since the question doesn't provide context, it's assumed the documents will be opened. The code loops through the cells in the table and, if the cell is not empty, picks up the content. This is then used in the Find.</p>\n\n<p>Since no context is provided in the question, <code>Execute</code> is missing as well as perhaps needing to reset the search range. But this does show how to get each number from the table cells and use them in Word's Find, as stated in the question.</p>\n\n<pre><code>Dim docSource as Word.Document\nDim docTarget as Word.Document\nDim tbl as Word.Table, cel as Word.Cell\nDim rngCell as Word.Range, rngTarget as Word.Range\nDim searchText as String, lenText as Long\n\nSet docSource = Documents.Open(\"path to document with random numbers\")\nSet docTarget = Documents.Open(\"path to document to be searched\")\n\nSet tbl = docSource.Tables(1)\nSet rngTarget = docTarget.Content\nFor Each cel in tbl.Range.Cells\n  searchText = cel.Range.Text\n  lenText = Len(searchText)\n  If lenText &gt; 1 Then 'If cell is not \"empty\"\n    searchText = Mid(searchText, 1, lenText - 2) 'remove cell structures\n\n    With rngTarget.Find\n      .Replacement.ClearFormatting\n      .Text = searchText\n      .Replacement.Text = Selection.Characters\n      .Forward = True\n      .Wrap = wdFindStop\n      .Format = False\n      .MatchCase = False\n      .MatchWholeWord = False\n      .MatchWildcards = False\n      .MatchSoundsLike = False\n      .MatchAllWordForms = False\n    End With\n  End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11894744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTXKu85amYs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZ3he3tgNyEweWWPBRB61CwVn8tg/photo.jpg?sz=128", "display_name": "Prabhu EduPertZ", "link": "https://stackoverflow.com/users/11894744/prabhu-edupertz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57413221, "answer_count": 1, "score": 1, "last_activity_date": 1565366226, "creation_date": 1565184475, "last_edit_date": 1565268134, "question_id": 57395627, "link": "https://stackoverflow.com/questions/57395627/paste-the-copied-number-in-find-dialog-box", "title": "Paste the copied number in Find dialog box", "body": "<p>Assume I have a list of random numbers like 2,4,6. After searching for 2 I want word to copy number 4 and find 4 in the doc. And then the next number 6. I got everything I need but how to paste the copied number in Find dialog box.</p>\n\n<pre><code>Selection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"2\"\n    .Replacement.Text = Selection.Characters\n    .Forward = True\n    .Wrap = wdFindAsk\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n</code></pre>\n\n<p>After copying \"2\" I want the word to search for \"2\" in other document. And should return back to this sheet and go for next number which is \"4\" and loop. Actually my macro finds \"2\" in the source doc (where \"2\" is question number) copies the question following \"2.\", then pastes in other doc and returns to copy \"4\". I had everything set but I could not copy \"4\" and paste \"4\" in 'find dialog' to copy 4th question, </p>\n\n<p><a href=\"https://i.stack.imgur.com/Z7uzO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z7uzO.png\" alt=\"enter image description here\"></a></p>\n\n<p>The source doc looks like this and those on the left are the number I need to find</p>\n\n<p><a href=\"https://i.stack.imgur.com/waV7P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/waV7P.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1565184472, "post_id": 57395440, "comment_id": 101272798, "body": "i think something is wrong, D6 or D10?"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 4, "last_activity_date": 1565184855, "creation_date": 1565184855, "answer_id": 57395742, "question_id": 57395440, "link": "https://stackoverflow.com/questions/57395440/copy-range-to-destination-and-return-destination-range/57395742#57395742", "title": "Copy range to destination and return destination range", "body": "<p>You can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.resize\" rel=\"nofollow noreferrer\">Resize</a> method as you know the size of destination range will be the same as the source range.</p>\n\n<pre><code>Set rCopiedRange = rStartLocation.resize(rRangeToCopy.rows.count,rRangeToCopy.columns.count)\n</code></pre>\n\n<p>Using Resize, you could transfer the range directly without involving the clipboard.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1565185754, "creation_date": 1565185754, "answer_id": 57395997, "question_id": 57395440, "link": "https://stackoverflow.com/questions/57395440/copy-range-to-destination-and-return-destination-range/57395997#57395997", "title": "Copy range to destination and return destination range", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim rCopiedRange As Range, rRangeToCopy As Range, rStartLocation As Range\n    Dim Rows As Long, Columns As Long\n\n    Set rRangeToCopy = ActiveWorkbook.Sheets(1).Range(\"C4:F10\")\n    Set rStartLocation = ActiveWorkbook.Sheets(2).Range(\"A2\")\n\n    rRangeToCopy.Copy rStartLocation\n\n    Rows = rRangeToCopy.Rows.Count\n    Columns = rRangeToCopy.Columns.Count\n\n    Set rCopiedRange = ActiveWorkbook.Sheets(2).Range(Cells(rStartLocation.Row, rStartLocation.Column), Cells(Rows + 1, Columns))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5292624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0xfyN.png?s=128&g=1", "display_name": "Rhiannon", "link": "https://stackoverflow.com/users/5292624/rhiannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 57395742, "answer_count": 2, "score": 1, "last_activity_date": 1565185754, "creation_date": 1565183899, "question_id": 57395440, "link": "https://stackoverflow.com/questions/57395440/copy-range-to-destination-and-return-destination-range", "title": "Copy range to destination and return destination range", "body": "<p>I would like to copy a range to a new location in such a way that it returns the new range, which I can then store in a variable for further processing.</p>\n\n<p>I gather the usual way of copying cells is to use the Range.Copy method:</p>\n\n<pre><code>Dim rCopiedRange As Range, rRangeToCopy as Range, rStartLocation as Range\nSet rRangeToCopy = ActiveWorkbook.Sheets(1).Range(\"C4:F10\")\nSet rStartLocation = ActiveWorkbook.Sheets(2).Range(\"A2\")\nrRangeToCopy.Copy rStartLocation\n</code></pre>\n\n<p>But since this is a method I can't set the result to a variable and </p>\n\n<pre><code>Set rCopiedRange = rRangeToCopy.Copy rStartLocation\n</code></pre>\n\n<p>is a syntax error.</p>\n\n<p>How can I copy the range to a new location in such a way that the new range (in this case range A2 to D6 of Sheet 2) is stored as a variable?</p>\n"}, {"tags": ["excel", "vba", "listview", "filter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565185478, "post_id": 57395431, "comment_id": 101273483, "body": "Please note that <i>&quot;Help-me, is very important for me.&quot;</i> is not a question. You might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Screenshots might help to explain your issue better. \u2022 What is <code>Riscos</code>?"}, {"owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565185588, "post_id": 57395431, "comment_id": 101273551, "body": "Riscos is a ListView."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565185859, "post_id": 57395431, "comment_id": 101273713, "body": "In addition to what @P\u1d07\u029c said re: screenshots, please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">why we should avoid using Select</a>. What&#39;s Posi&#231;&#227;oAtual? Showing relevant code will also help to understand the issue"}, {"owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "edited": false, "score": 0, "creation_date": 1565185907, "post_id": 57395431, "comment_id": 101273748, "body": "added the screenshot, sorry"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565185990, "post_id": 57395431, "comment_id": 101273818, "body": "What are the red arrows in your screen trying to show?"}, {"owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "edited": false, "score": 0, "creation_date": 1565186079, "post_id": 57395431, "comment_id": 101273871, "body": "I put values \u200b\u200bin a filtered row &quot;Taquari&quot; but returned me in the first row &quot;Uberaba&quot;"}, {"owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "edited": false, "score": 0, "creation_date": 1565186141, "post_id": 57395431, "comment_id": 101273913, "body": "i need to click on the filtered Row and edit the value of that"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1565186755, "post_id": 57395431, "comment_id": 101274288, "body": "There is no such property as <code>ListView.SelectedItem.Index</code>. Use <code>ListView.SelectedIndex</code> or <code>ListView.SelectedItems </code> instead. Both are <code>Collection</code> type. I assume you do not use <code>Option Explicit</code> either. That may be the reason for always getting 1 for <code>Posi&#231;&#227;oAtual</code>. See more here: <a href=\"https://stackoverflow.com/questions/8693897/how-do-i-get-the-selecteditem-or-selectedindex-of-listview-in-vb-net\" title=\"how do i get the selecteditem or selectedindex of listview in vb net\">stackoverflow.com/questions/8693897/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "edited": false, "score": 0, "creation_date": 1565204793, "post_id": 57395431, "comment_id": 101283327, "body": "It didn&#39;t solve my problem, when i use SelectedIndex or SelectedItems return : compile error method or data member not found"}], "owner": {"reputation": 13, "user_id": 11766422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044ead9d79ecd23ec46b55cbe22d4d74?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Menegueli", "link": "https://stackoverflow.com/users/11766422/gabriel-menegueli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565187054, "creation_date": 1565183869, "last_edit_date": 1565187054, "question_id": 57395431, "link": "https://stackoverflow.com/questions/57395431/when-i-filter-and-select-a-filter-row-in-listview-and-input-some-value-in-listv", "title": "When i filter and select a filter row in listview and input some value, in listview is correct but in excel appears in first line", "body": "<p>When i filter and select a filtered row in listview and input some value with button, in listview is correct but in excel appears in first line out of filter.</p>\n\n<p>First Screenshot - value test in \"Unidade\"-\"Taquari\"\n<a href=\"https://i.stack.imgur.com/YxhJ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YxhJ5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Second Screenshot - value test in first row \"Uberaba\"\n<a href=\"https://i.stack.imgur.com/aRaZP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aRaZP.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>RISCOS = ListView</strong></p>\n\n<p><strong>Posi\u00e7\u00e3oAtual = My selected row</strong></p>\n\n<pre><code>Sheets(\"Gerenciamento de Riscos Tableau\").Select\n\n\nRiscos.SetFocus\n\n\nDim Posi\u00e7\u00e3oAtual As Variant\n    Posi\u00e7\u00e3oAtual = Riscos.SelectedItem.Index + 1\n\n\n    Cells(Posi\u00e7\u00e3oAtual, 2).Value = TextBox1.Text\n    Cells(Posi\u00e7\u00e3oAtual, 6).Value = TextBox4.Text\n    Cells(Posi\u00e7\u00e3oAtual, 7).Value = TextBox3.Text\n    Cells(Posi\u00e7\u00e3oAtual, 8).Value = TextBox5.Text\n\n\n     With Riscos\n\n\n        .SelectedItem.SubItems(1) = TextBox1.Text\n        .SelectedItem.SubItems(5) = TextBox4.Text\n        .SelectedItem.SubItems(6) = TextBox3.Text\n        .SelectedItem.SubItems(7) = TextBox5.Text\n\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565183348, "post_id": 57395220, "comment_id": 101272056, "body": "On which line do you get the error ? <code>singlesheet(Range(&quot;A1&quot;, Range(&quot;A1&quot;).End(xlDown))).Rows.Count</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9283389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7127b57b56f3274306b05fc6ecc41153?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/9283389/stanley"}, "edited": false, "score": 0, "creation_date": 1565231053, "post_id": 57395455, "comment_id": 101290183, "body": "Yes. getting an error on that line..i will try this code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 21, "user_id": 9283389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7127b57b56f3274306b05fc6ecc41153?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/9283389/stanley"}, "edited": false, "score": 0, "creation_date": 1565261107, "post_id": 57395455, "comment_id": 101301740, "body": "@Stanley on what line of my code do you get an error ?"}, {"owner": {"reputation": 21, "user_id": 9283389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7127b57b56f3274306b05fc6ecc41153?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/9283389/stanley"}, "edited": false, "score": 0, "creation_date": 1565604638, "post_id": 57395455, "comment_id": 101391896, "body": "the code does not work.  Instead of populating &quot;Max date&quot; in the last blank column it is giving an error message &quot;Error .worksheet is empty&quot;"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1565183936, "creation_date": 1565183936, "answer_id": 57395455, "question_id": 57395220, "link": "https://stackoverflow.com/questions/57395220/looping-over-multiple-worksheets-and-finding-the-last-blank-cell-and-putting-the/57395455#57395455", "title": "Looping over multiple worksheets and finding the last blank cell and putting the max date header &amp; formula from the range L:AD", "body": "<p>In order to write down \"Max Date\" in the header row, at the right column of every sheet, you can use something like the code below.</p>\n\n<p>As mentioned in <strong>SO</strong> many times, you should stay away from using <code>Activate</code> , <code>ActiveCell</code> and <code>Select</code>.</p>\n\n<p><strong><em>Modified Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub MaxDateSheets()\n\nDim SingleSheet As Worksheet\nDim LastCol As Long\nDim LastCell As Range\n\nApplication.ScreenUpdating = False\n\nFor Each SingleSheet In ThisWorkbook.Worksheets\n    With SingleSheet\n        ' Use Find function to get the last column in sheet\n        Set LastCell = .Cells.Find(What:=\"*\", after:=.Cells(1), LookAt:=xlPart, LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\n        If Not LastCell Is Nothing Then\n            LastCol = LastCell.Column\n        Else\n            MsgBox \"Error! worksheet is empty\", vbCritical\n            Exit Sub\n        End If\n\n        .Cells(1, LastCol).Value = \"Max date\" ' write \"Max Date\" in the header of the right column\n    End With\nNext SingleSheet\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1565184968, "creation_date": 1565184968, "answer_id": 57395781, "question_id": 57395220, "link": "https://stackoverflow.com/questions/57395220/looping-over-multiple-worksheets-and-finding-the-last-blank-cell-and-putting-the/57395781#57395781", "title": "Looping over multiple worksheets and finding the last blank cell and putting the max date header &amp; formula from the range L:AD", "body": "<p><strong>Try this code:</strong></p>\n\n<pre><code>Sub fnd_max()\n\nDim singlesheet As Worksheet\n\nFor Each singlesheet In Worksheets\n\n    lr = LastRow(singlesheet)\n    lc = LastCol(singlesheet)\n\n    With singlesheet\n    If lc &gt; 0 And lr &gt; 0 Then\n        singlesheet.Activate\n        .Cells(1, lc + 1).Value = \"Max Header\"\n        .Cells(2, lc + 1).formula = \"=MAX(\" &amp; .Range(Cells(2, 12), Cells(2, lc)).Address(0, 0) &amp; \")\"\n        .Cells(2, lc + 1).AutoFill Destination:=.Range(Cells(2, lc + 1), Cells(lr, lc + 1))\n    End If\n    End With\n\nNext\n\nEnd Sub\n\nFunction LastRow(Sh As Worksheet)\n    On Error Resume Next\n    LastRow = Sh.Cells.Find(What:=\"*\", _\n                            After:=Sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).row\n    On Error GoTo 0\nEnd Function\n\nFunction LastCol(Sh As Worksheet)\n    On Error Resume Next\n    LastCol = Sh.Cells.Find(What:=\"*\", _\n                            After:=Sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9283389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7127b57b56f3274306b05fc6ecc41153?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/9283389/stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565242815, "creation_date": 1565183221, "last_edit_date": 1565242815, "question_id": 57395220, "link": "https://stackoverflow.com/questions/57395220/looping-over-multiple-worksheets-and-finding-the-last-blank-cell-and-putting-the", "title": "Looping over multiple worksheets and finding the last blank cell and putting the max date header &amp; formula from the range L:AD", "body": "<p>I am very new to VBA and trying to automate one of my repetitive tasks. I have multiple sheets in a workbook and the range from L upto a dynamic number of columns ( I say dynamic number of columns because for some sheets I have 2 columns and for some I have 14 columns) I have various dates. I need to go to the last blank cell, give the column header as \"max date\" and find out the max date from  the range of dates</p>\n\n<p>I have tried this script myself but getting errors</p>\n\n<pre><code>Worksheets(1).Activate\nDim singlesheet As Worksheet\nApplication.ScreenUpdating = False\n\nFor Each singlesheet In Worksheets\n    singlesheet(Range(\"A1\", Range(\"A1\").End(xlDown))).Rows.Count\n    Range(\"A1\").Select\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = \"Max date\"\nNext singlesheet\n</code></pre>\n\n<p>I get a Run time error 438</p>\n\n<blockquote>\n  <p>Object does not support this property or method</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1565182858, "post_id": 57394949, "comment_id": 101271751, "body": "Note that we need an exact error message and the line in which the error occurs to be able to help you properly. Note that <code>On Error Resume Next</code> hides all error messages until <code>On Error GoTo 0</code> therefore if an error occurs in between you will never notice that means if <code>strDir = .SelectedItems(1)</code> fails your code will continue with <code>strDir</code> beeing empty for example. \u2022 Also get rid of all <code>.Select</code>, <code>Selection</code> and <code>ActiveSheet</code> statements, therfore read: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 3, "user_id": 11895906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc14ff3b35ba5fd3d197f6dbac31d292?s=128&d=identicon&r=PG&f=1", "display_name": "Misc128", "link": "https://stackoverflow.com/users/11895906/misc128"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565183520, "post_id": 57394949, "comment_id": 101272160, "body": "@P\u1d07\u029c These are two of the errors he got: Run-time error &#39;430&#39;:  Class does not support Automation or does not support expected interface  Run-time error &#39;-2147417848 (80010108)&#39;:  Automation error The object invoked has disconnected from its clients.                                                     Also, I know .Select probably isn&#39;t the most efficient method of running through numbers, but that part of the code is working for him."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565183561, "post_id": 57394949, "comment_id": 101272186, "body": "In which line do the errors occur?"}, {"owner": {"reputation": 3, "user_id": 11895906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc14ff3b35ba5fd3d197f6dbac31d292?s=128&d=identicon&r=PG&f=1", "display_name": "Misc128", "link": "https://stackoverflow.com/users/11895906/misc128"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565183741, "post_id": 57394949, "comment_id": 101272298, "body": "@P\u1d07\u029c He gets the errors on the DO UNTIL line in the if statement."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11895906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc14ff3b35ba5fd3d197f6dbac31d292?s=128&d=identicon&r=PG&f=1", "display_name": "Misc128", "link": "https://stackoverflow.com/users/11895906/misc128"}, "edited": false, "score": 0, "creation_date": 1565186190, "post_id": 57395641, "comment_id": 101273947, "body": "Thanks for doing that! I tested it on my computer and it works well. I&#39;m just awaiting the response from my adviser to see if it fixed his problems. Thanks for all the help!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1565184969, "last_edit_date": 1565184969, "creation_date": 1565184522, "answer_id": 57395641, "question_id": 57394949, "link": "https://stackoverflow.com/questions/57394949/how-to-fix-runtime-error-430-and-other-automation-errors-in-vba-for-excel/57395641#57395641", "title": "How to fix runtime error &#39;430&#39; and other automation errors in vba for excel", "body": "<p>Try the following code. I re-organized it and made it more stable. Also I included an error handling to prevent any hidden IE processes in the background.</p>\n\n<pre><code>Public Sub DownloadItemPDF()\n    MsgBox \"Select Folder to Save .pdf to\"\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        .Show\n\n        On Error Resume Next 'hide all error messages\n        Dim strDir As String\n        strDir = .SelectedItems(1)\n        'check if an error occured and exit sub if something went wrong otherwise yo u end up with an empty strDir \n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"No valid folder was picked.\", vbCritical\n            Exit Sub\n        End If\n        On Error GoTo 0\n    End With\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.ActiveSheet 'better define a concrete sheet: ThisWorkbook.Worksheets(\"SheetName\")\n                                      'because ActiveSheet might be the wrong one!\n\n    Dim CheckRange As Range\n    Set CheckRange = ws.Range(\"H3\").Resize(RowSize:=15)\n\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = False\n\n    On Error GoTo QUIT_IE 'if an error occurs make sure the invisible IE gets closed\n\n    Dim Cell As Range\n    For Each Cell In CheckRange\n        If Not Cell.Value = vbNullString Then\n            Dim itemNum As Long\n            itemNum = Cell.Value\n\n            Dim strPDFLink As String\n            strPDFLink = \"url\" &amp; itemNum &amp; \"url\"\n\n            Dim strPDFFile As String\n            strPDFFile = strDir &amp; \"/Drawing2D_\" &amp; itemNum &amp; \"_\" &amp; Format$(Now, \"yyyy.mm.dd\") &amp; \".pdf\"\n\n            IE.navigate strPDFLink\n            Do While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Loop\n\n            Application.Wait (Now + #12:00:02 AM#)\n            Dim Result As Boolean\n            Result = DownloadFile(strPDFLink, strPDFFile)\n        End If\n    Next Cell\n\nQUIT_IE:\n    IE.Quit 'don't forget to quit IE in case of error otherwise it will stay open invisible\n    Set IE = Nothing\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"Error occured while trying to load:\" &amp; vbCrLf &amp; strPDFLink &amp; vbCrLf &amp; \"To:\" &amp; vbCrLf &amp; strPDFFile\n        Debug.Print \"strPDFLink:\", strPDFLink\n        Debug.Print \"strPDFFile:\", strPDFFile\n        Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11895906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc14ff3b35ba5fd3d197f6dbac31d292?s=128&d=identicon&r=PG&f=1", "display_name": "Misc128", "link": "https://stackoverflow.com/users/11895906/misc128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 57395641, "answer_count": 1, "score": 0, "last_activity_date": 1565184969, "creation_date": 1565182326, "last_edit_date": 1565182370, "question_id": 57394949, "link": "https://stackoverflow.com/questions/57394949/how-to-fix-runtime-error-430-and-other-automation-errors-in-vba-for-excel", "title": "How to fix runtime error &#39;430&#39; and other automation errors in vba for excel", "body": "<p>I have recently written some code for the company I work at in VBA for Excel. The purpose of the code is to run through a list of entered part numbers on Excel, search their respective URL, and then save that webpage as a PDF to the selected folder. </p>\n\n<p>I wrote this code using some inspiration and code from other projects I have seen and also had to add some of my own. </p>\n\n<p><strong>My problem is this:</strong><br>\nThe code I put here works flawlessly on my computer. I have test ran it many times with many different numbers and it works as intended every time. That being said, I sent this to my adviser via email for him to use because I was making this Excel project for him. </p>\n\n<p>When he opened it on the day I sent it, it worked perfectly for him as it had for me. The next day he tried to run it and started getting automation errors I had never seen like </p>\n\n<blockquote>\n  <p>run-time error '430' </p>\n</blockquote>\n\n<p>and a few other similar errors.</p>\n\n<p>Does anyone have any idea why the program would work one day and not the next and/or if there is a solution to it? </p>\n\n<p>I'm mainly confused why it would suddenly stop working for him (it does still run perfectly on my computer). Also, for the code below it does follow a real link I just change website parts to \"url\" for the sake of company privacy. </p>\n\n<p>Although, I don't think that matters anyways because I believe the code is following the first link properly and then has errors when it has to loop through more than one part number.  </p>\n\n<pre><code>Private Declare Function URLDownloadToFile Lib \"urlmon\" Alias _\n\"URLDownloadToFileA\" (ByVal pCaller As Long, ByVal szURL As String, _\nByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nFunction DownloadFile(URL As String, LocalFilename As String) As Boolean\n    Dim lngRetVal As Long\n    lngRetVal = URLDownloadToFile(0, URL, LocalFilename, 0, 0)\n    If lngRetVal = 0 Then DownloadFile = True\nEnd Function\n\nSub DownloadItemPDF()\n    Dim strPDFLink As String\n    Dim strPDFFile As String\n    Dim doc, hcol, text As Variant\n    Dim itemNum As Long\n    Dim count As Integer\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")         \n    IE.Visible = False\n\n    MsgBox \"Select Folder to Save .pdf to\"\n    Dim FolderName As String\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        .Show\n\n        On Error Resume Next\n        strDir = .SelectedItems(1)\n        Err.clear\n        On Error GoTo 0\n    End With\n\n    ActiveSheet.Range(\"H3\").Select\n\n    For count = 1 To 15\n        If Not Selection.Value = \"\" Then        \n            itemNum = Selection.Value\n            strPDFLink = \"url\" &amp; itemNum &amp; \"url\"\n            strPDFFile = strDir &amp; \"/Drawing2D_\" &amp; itemNum &amp; \"_\" &amp; Format(Now, \"yyyy.mm.dd\") &amp; \".pdf\"\n            IE.Navigate strPDFLink\n            Do While IE.ReadyState = 4: DoEvents: Loop\n            Do Until IE.ReadyState = 4: DoEvents: Loop\n            Application.Wait (Now + #12:00:02 AM#)\n            Result = DownloadFile(strPDFLink, strPDFFile)\n        End If\n\n        Selection.Offset(1, 0).Select\n    Next count\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "office365"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1565184056, "post_id": 57394859, "comment_id": 101272509, "body": "Did you try to set the property before the item is submitted?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "edited": false, "score": 0, "creation_date": 1565187038, "post_id": 57395495, "comment_id": 101274466, "body": "Hi Eugene,Thanks for your idea but it doesn&#39;t work &amp; it makes sense why - these are emails that I&#39;m sending so the code errors out with setting myResponse to myItem.Reply."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "edited": false, "score": 0, "creation_date": 1565187170, "post_id": 57395495, "comment_id": 101274548, "body": "This is a sample code showing that you need to try setting the <code>SaveSentMessageFolder</code> property before sending."}, {"owner": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "edited": false, "score": 0, "creation_date": 1565188077, "post_id": 57395495, "comment_id": 101275128, "body": "Hi Eugene, a user could have multiple shared inboxes so can&#39;t really set SaveSentMessageFolder before sending. I suppose you could have the user run a macro but that would mean making an automated process manual which would be far from ideal &amp; I don&#39;t think they&#39;d bother doing it to be honest."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "edited": false, "score": 0, "creation_date": 1565188540, "post_id": 57395495, "comment_id": 101275408, "body": "I have just figured out that you are trying to set a folder from another store in Outlook. I don&#39;t think it is possible at all. You must deal only with folders from the single store."}, {"owner": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "edited": false, "score": 0, "creation_date": 1565189207, "post_id": 57395495, "comment_id": 101275791, "body": "Hi Eugene, if that&#39;s the case it&#39;s unfortunate &amp; I can&#39;t understand why this has changed in 365. This code is being used with Outlook 2013 with no issues."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1565188498, "last_edit_date": 1565188498, "creation_date": 1565184032, "answer_id": 57395495, "question_id": 57394859, "link": "https://stackoverflow.com/questions/57394859/how-to-save-sent-items-to-folder-of-sentonbehalfname-mailbox-in-office-365/57395495#57395495", "title": "How to save Sent Items to folder of SentOnBehalfName mailbox in Office 365?", "body": "<p>You can set a folder from a single store, there is no way to set a folder from another store/account. If you want to get items saved to another store, you must save them first and then move them programmatically to another folder/store.</p>\n\n<p>Also, I'd suggest setting the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.savesentmessagefolder\" rel=\"nofollow noreferrer\">MailItem.SaveSentMessageFolder</a> property before an item is submitted:</p>\n\n<pre><code>Sub SetSentFolder()  \n Dim myItem As Outlook.MailITem  \n Dim myResponse As Outlook.MailITem  \n Dim mpfInbox As Outlook.Folder  \n Dim mpf As Outlook.Folder \n\n Set mpfInbox = Application.Session.GetDefaultFolder(olFolderInbox)  \n Set mpf = mpfInbox.Folders.Add(\"SaveMyPersonalItems\")  \n Set myItem = Application.ActiveInspector.CurrentItem  \n Set myResponse = myItem.Reply  \n myResponse.Display  \n myResponse.To = \"Eugene Astafiev\"  \n Set myResponse.SaveSentMessageFolder = mpf  \n myResponse.Send  \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "is_accepted": true, "score": 0, "last_activity_date": 1565891709, "last_edit_date": 1565891709, "creation_date": 1565858344, "answer_id": 57507025, "question_id": 57394859, "link": "https://stackoverflow.com/questions/57394859/how-to-save-sent-items-to-folder-of-sentonbehalfname-mailbox-in-office-365/57507025#57507025", "title": "How to save Sent Items to folder of SentOnBehalfName mailbox in Office 365?", "body": "<p>In the ThisOutlookSession module add the following variable declaration:</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n</code></pre>\n\n<p>If you don't already have an <code>Application_Startup</code> event procedure create it by selecting <code>Application</code> in the left dropdown over the code area &amp; <code>Startup</code> in the right dropdown over the code area.</p>\n\n<p>The code to add to this procedure:</p>\n\n<pre><code>Set Items = Session.GetDefaultFolder(olFolderSentMail).Items\n</code></pre>\n\n<p>Then in the left dropdown over the code area you need to select <code>Items</code> &amp; in the right dropdown over the code area select <code>ItemSend</code>.</p>\n\n<p>Below is what this procedure should look like:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Items_ItemAdd(ByVal Item As Object)\n    If TypeName(Item) = \"MailItem\" Then     'If Item is a MailItem\n        If Item.SentOnBehalfOfName &lt;&gt; Session.Accounts.Item(1).CurrentUser Then   'And if Item is Sent on Behalf of the users own inbox\n            'Move the email into the Sent Items folder for the inbox in question\n            Item.Move GetNamespace(\"MAPI\").Folders(Item.SentOnBehalfOfName).Folders(\"Sent Items\")\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5104660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1ed3055b2758c39bc631224ed542bc?s=128&d=identicon&r=PG&f=1", "display_name": "jbmb2000", "link": "https://stackoverflow.com/users/5104660/jbmb2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 1, "accepted_answer_id": 57507025, "answer_count": 2, "score": 1, "last_activity_date": 1590663517, "creation_date": 1565181969, "last_edit_date": 1590663517, "question_id": 57394859, "link": "https://stackoverflow.com/questions/57394859/how-to-save-sent-items-to-folder-of-sentonbehalfname-mailbox-in-office-365", "title": "How to save Sent Items to folder of SentOnBehalfName mailbox in Office 365?", "body": "<p>At work we send emails from Shared Inboxes. The emails would go into the user's own Sent Items instead of that of the Shared Inbox.</p>\n\n<p>I wrote some VBA code which sorted this issue. We are moving to Outlook 365 &amp; the code is not working there.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nIf TypeName(Item) = \"MailItem\" Then     'If Item is a MailItem\n        If Item.SentOnBehalfOfName &lt;&gt; \"\" Then   'And if Item is Sent on Behalf of an inbox\n            'Save the sent email in the Sent Items folder for the inbox in question\n            Item.SaveSentMessageFolder GetNamespace(\"MAPI\").Folders(Item.SentOnBehalfOfName).Folders(\"Sent Items\")\n\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>I tried</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>msgbox GetNamespace(\"MAPI\").Folders(Item.SentOnBehalfOfName).Folders(\"Sent Items\").Name\n</code></pre>\n\n<p>It gives the name of the folder but the Sent Item does not go there.</p>\n\n<p>I created a \"Test\" folder &amp; saved to the folder ignoring Item.SentOnBehalfOfName &amp; this works if the \"Test\" folder is in my own inbox but not if it is in a Shared Inbox.</p>\n\n<p>I tried changing the code to use Set &amp; to include Application as per below.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set Item.SaveSentMessageFolder = Application.GetNamespace(\"MAPI\").Folders(Item.SentOnBehalfOfName).Folders(\"Sent Items\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565182679, "post_id": 57394471, "comment_id": 101271614, "body": "Error message starting with &amp;H8 are usually permission type errors.  Either a pointer is addressing an area of memory that you don&#39;t have permission to access, or a file permission error.  Sometimes it is linked to pushing/puling variables onto the stack when subroutines are called. This type error may occur if the parameters arren&#39;t the same in the calling routine and a subroutine.  I would open the task manager as you run the program and see how many processes are being spawned when the program is running.  You may be creating a lot of processes and having some sort of stack issue."}, {"owner": {"reputation": 11, "user_id": 11865497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150756815b488813b9e381d0136204c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahb23", "link": "https://stackoverflow.com/users/11865497/ahb23"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565188700, "post_id": 57394471, "comment_id": 101275507, "body": "It was a stack issue, Thanks!"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565188772, "post_id": 57394471, "comment_id": 101275553, "body": "May I ask you to accept the answer so other people can get the information faster so it helps the community @ahb23"}], "owner": {"reputation": 11, "user_id": 11865497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150756815b488813b9e381d0136204c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahb23", "link": "https://stackoverflow.com/users/11865497/ahb23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565188739, "creation_date": 1565180705, "question_id": 57394471, "link": "https://stackoverflow.com/questions/57394471/chart-macro-resizing", "title": "Chart macro resizing", "body": "<p>I have a macro that creates and formats a chart from user highlighted data to my required specifications, but realized that I had only been testing it with data where the first column was dates for the x axis. When this is not the case and all highlighted columns contain data for the chart, the macro fails.</p>\n\n<pre><code>Sub fullPageLine()\nDim rng As Range\nDim cht As chart\nDim i As Long, color As Long\nDim srs As Series\n\nSet cht = ActiveSheet.Shapes.AddChart2(227, xlLine).chart\n\n'Adjust chart size full vs half using number between ScaleHeight/Width and msoFalse\n    cht.Parent.ShapeRange(1).ScaleWidth 1.3, msoFalse, msoScaleFromTopLeft\n    cht.Parent.ShapeRange(1).ScaleHeight 1.3, msoFalse, msoScaleFromTopLeft\n\n'Format axes\nWith cht.ChartArea\n    .Format.TextFrame2.TextRange.Font.Name = \"Arial\"\n    .Format.TextFrame2.TextRange.Font.Size = 7\n    .Format.TextFrame2.TextRange.Font.Fill.ForeColor.RGB = RGB(1, 0, 0)\nEnd With\n\n'Insert and format axis titles &amp; plot area\n    cht.Axes(xlValue, xlPrimary).HasTitle = True\n    With cht.PlotArea\n        .Left = 10\n        .Width = 422\n        .Height = 220\n    End With\n    With cht.Axes(xlValue).AxisTitle\n        .Left = 5\n        .Top = 20\n        .Orientation = xlHorizontal\n    End With\n\n'Format title change left and top values to shift title location\nWith cht.ChartTitle\n    .Font.Size = 10\n    .Left = 0\n    .Top = 2\n    With .Format.TextFrame2.TextRange.Characters.Font\n    .BaselineOffset = 0\n    .Bold = msoTrue\n    .Size = 10\n    .Name = \"Arial\"\n    .Caps = msoAllCaps\n    .Fill.ForeColor.RGB = RGB(1, 0, 0)\n    End With\nEnd With\n\n'Format legend\nIf cht.HasLegend Then\n    With cht.Legend.Format.TextFrame2.TextRange.Font\n        .NameComplexScript = \"Arial\"\n        .NameFarEast = \"Arial\"\n        .Name = \"Arial\"\n        .Size = 7\n    End With\nEnd If\n\n\n'Change chart series fill color\n\nFor i = 1 To cht.FullSeriesCollection.count\n    ' Get the color based on series index\n    Select Case i\n        Case 1\n            color = RGB(242, 105, 36)\n        Case 2\n            color = RGB(1, 0, 0)\n        Case 3\n            color = RGB(85, 85, 85)\n        Case 4\n            color = RGB(128, 128, 128)\n        Case 5\n            color = RGB(192, 192, 192)\n\n    End Select\n    ' Assign series color formats\n    '## NOTE: This only works for the cases defined in the above Select statement.\n    Set srs = cht.FullSeriesCollection(i)\n    With srs.Format.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = color\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = bright\n        .Transparency = 0\n    End With\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I get a pop up saying \"System Error &amp;H80004005 (-2147467259). Unspecified error\", and have traced it back to this section of code:</p>\n\n<pre><code>With cht.PlotArea\n   .Left = 10\n   .Width = 422\n   .Height = 220\nEnd With\n</code></pre>\n\n<p>I do not understand why resizing the plot area would cause an error depending on the type of x axis the chart has. I would really appreciate any advice.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1565179589, "post_id": 57394096, "comment_id": 101269774, "body": "What version of excel are you using ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1565180320, "post_id": 57394096, "comment_id": 101270159, "body": "Yes, my experience is that with <code>xlsm</code> or <code>xlsx</code> files  with big data and macros are extremely unstable (and easily get corrupted). I recommend to switch them to the binary <code>xlsb</code> format (never had a corrupted file there, and I have some rally big worksheets). \u2022 Once a file is corrupted (even if Excel tells you it repaired it) don&#39;t trust them anymore. Excel&#39;s repair never worked well for my files. \u2022 Note this is rather a personal experience than something I can proof by facts. But I run several times into issues with <code>xlsx&#47;m</code> but never with <code>xlsb</code> (which turned out to be <i>much</i> more stable)."}, {"owner": {"reputation": 23, "user_id": 7660804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e33a725d384483608b68911c2b386e?s=128&d=identicon&r=PG&f=1", "display_name": "Underdog", "link": "https://stackoverflow.com/users/7660804/underdog"}, "edited": false, "score": 0, "creation_date": 1565206652, "post_id": 57394096, "comment_id": 101284098, "body": "Thanks for the help P\u0435\u043d!"}, {"owner": {"reputation": 23, "user_id": 7660804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e33a725d384483608b68911c2b386e?s=128&d=identicon&r=PG&f=1", "display_name": "Underdog", "link": "https://stackoverflow.com/users/7660804/underdog"}, "edited": false, "score": 0, "creation_date": 1565207217, "post_id": 57394096, "comment_id": 101284326, "body": "To anwer your question Nick, I think that started to happen some moths after Office 2016 come into use in the company (as far as I know, because I am new there). The files are used only once per month, so I guess they were used only a couple of times before this started."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7660804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e33a725d384483608b68911c2b386e?s=128&d=identicon&r=PG&f=1", "display_name": "Underdog", "link": "https://stackoverflow.com/users/7660804/underdog"}, "edited": false, "score": 0, "creation_date": 1565206766, "post_id": 57394497, "comment_id": 101284136, "body": "Thanks for the help guys! Unfortunately, I can choose only one answer, that is why I choose the one that came first. Cheers!"}], "tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1565180776, "creation_date": 1565180776, "answer_id": 57394497, "question_id": 57394096, "link": "https://stackoverflow.com/questions/57394096/is-it-possible-for-a-macro-to-corrupt-files/57394497#57394497", "title": "Is it possible for a Macro to corrupt files?", "body": "<p>How big are your code modules? If they are larger than 64 KB, they might cause random corruptions to the file. See <a href=\"https://superuser.com/questions/1381665/is-the-64kb-size-limit-to-modules-corrupting-macros-for-excel-365\">this</a> for more information.</p>\n"}], "owner": {"reputation": 23, "user_id": 7660804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e33a725d384483608b68911c2b386e?s=128&d=identicon&r=PG&f=1", "display_name": "Underdog", "link": "https://stackoverflow.com/users/7660804/underdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57394497, "answer_count": 1, "score": 2, "last_activity_date": 1565183506, "creation_date": 1565179448, "last_edit_date": 1565180146, "question_id": 57394096, "link": "https://stackoverflow.com/questions/57394096/is-it-possible-for-a-macro-to-corrupt-files", "title": "Is it possible for a Macro to corrupt files?", "body": "<p>I have a big file with a lot of Subs. One of these subs opens other files and runs the macros, which are stored in these files. Some of these files go from time to time corrupt. Without doing anything else on them. Is it possible that my macro corrupts these files? What is more, this event started to occur since the beginning of the year (2019). That never occured before that. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565179509, "post_id": 57394081, "comment_id": 101269731, "body": "So thats working better but its still pasting with 2 empty rows"}, {"owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "reply_to_user": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565179652, "post_id": 57394081, "comment_id": 101269812, "body": "Are you sure that there are no empty rows in the range you copy and that there are no whitespace in the workbook in which you copy data? I would suggest deleting each row in the target workbook before running the code."}, {"owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565179790, "post_id": 57394081, "comment_id": 101269888, "body": "Ya sorry theres one empty row in what im copying but it still pastes with 2 empty rows above. Would a picture help?"}, {"owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "reply_to_user": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565179853, "post_id": 57394081, "comment_id": 101269912, "body": "Yes, please, both the end of the range which you want to copy and the range you copy it into"}, {"owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "reply_to_user": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "edited": false, "score": 0, "creation_date": 1565180495, "post_id": 57394081, "comment_id": 101270263, "body": "Glad i could help!"}], "tags": [], "owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "is_accepted": true, "score": 0, "last_activity_date": 1565180360, "last_edit_date": 1565180360, "creation_date": 1565179396, "answer_id": 57394081, "question_id": 57393783, "link": "https://stackoverflow.com/questions/57393783/trying-to-paste-entire-workbooks-at-the-bottom-of-another-workbook/57394081#57394081", "title": "Trying to paste entire workbooks at the bottom of another workbook", "body": "<p>Maybe you could try :</p>\n\n<pre><code>Sub Stuffff()\n\n    Dim Rng As Range\n    Set Rng = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1:AY300\")\n    Rng.Copy\n\n    Dim s11 As Workbook\n    Set s11 = Workbooks(\"11 Production\")\n    Dim last As Long\n    Dim Rngnew As Range\n\nWith s11.Sheets(\"Sheet1\")\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        last = .range(\"A65000\").end(xlup).offset(1,0).row               \n    Else\n        last = 1\n    End If\nEnd With\n    Set Rngnew = s11.Worksheets(\"Sheet1\").Range(\"A\" &amp; last)\n\n    Rngnew.PasteSpecial\nEnd Sub\n</code></pre>\n\n<p>That should work, unless you have more than 65 K rows in your workbook.</p>\n"}], "owner": {"reputation": 9, "user_id": 11837569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b222f261d8de82480cac19bddfa23d?s=128&d=identicon&r=PG&f=1", "display_name": "matt.auerbach", "link": "https://stackoverflow.com/users/11837569/matt-auerbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 57394081, "answer_count": 1, "score": 0, "last_activity_date": 1565180360, "creation_date": 1565178532, "last_edit_date": 1565178714, "question_id": 57393783, "link": "https://stackoverflow.com/questions/57393783/trying-to-paste-entire-workbooks-at-the-bottom-of-another-workbook", "title": "Trying to paste entire workbooks at the bottom of another workbook", "body": "<p>So it's working but it's pasting with 10 empty rows above and I am not sure why. <a href=\"https://i.stack.imgur.com/KaFfP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KaFfP.png\" alt=\"https://imgur.com/a/rJwsnFQ\"></a> </p>\n\n<pre><code>Sub Stuffff()\n\n    Dim Rng As Range\n    Set Rng = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1:AY300\")\n    Rng.Copy\n\n    Dim s11 As Workbook\n    Set s11 = Workbooks(\"11 Production\")\n    Dim last As Long\n    Dim Rngnew As Range\n\nWith s11.Sheets(\"Sheet1\")\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        last = .Cells.Find(What:=\"*\", _\n                      After:=.Range(\"A1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row                 \n    Else\n        last = 1\n    End If\nEnd With\n    Set Rngnew = s11.Worksheets(\"Sheet1\").Range(\"A\" &amp; last + 1)\n\n    Rngnew.PasteSpecial\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565178543, "post_id": 57393630, "comment_id": 101269196, "body": "Regarding &quot;I expect the macros to be at place on the screen no matter the screen.&quot;, I suppose you mean you expect the controls to be at place (macros are always in the macro editor). Try using their .Left and .Top properties."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11895505, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e8B8ikdy158/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1R3VsxhuR_MI2KmD2WlsKJ09vpg/photo.jpg?sz=128", "display_name": "Isabella Nagel", "link": "https://stackoverflow.com/users/11895505/isabella-nagel"}, "edited": false, "score": 0, "creation_date": 1565342990, "post_id": 57401249, "comment_id": 101332544, "body": "I have tried creating a userform in VBA as suggested, but how should I access this userform in the presentation? The only way I could figure this out was to insert a command button(1) on the slide with VBA coding &quot;UserForm.Show&quot; - but then I again obviously experience the same issue with that command button (1) moving around in the slide...?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 3, "user_id": 11895505, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e8B8ikdy158/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1R3VsxhuR_MI2KmD2WlsKJ09vpg/photo.jpg?sz=128", "display_name": "Isabella Nagel", "link": "https://stackoverflow.com/users/11895505/isabella-nagel"}, "edited": false, "score": 1, "creation_date": 1565361695, "post_id": 57401249, "comment_id": 101342780, "body": "You don&#39;t need a command button to run a macro. An ordinary Action Button can do that job and will stay the same size in the same position."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 1, "last_activity_date": 1565206584, "creation_date": 1565206584, "answer_id": 57401249, "question_id": 57393630, "link": "https://stackoverflow.com/questions/57393630/powerpoint-vba-makro-moving-in-slideshow-mode-w-2-screens-vba-textfields-disa/57401249#57401249", "title": "Powerpoint VBA makro moving in slideshow mode w. 2 screens + VBA textfields disabled", "body": "<p>OLE and OLE Controls are resolution-dependent. PowerPoint can calculate the control's positions differently when resolution changes or when used on mixed-resolution multi-monitor setups. You could possibly get around this by using a VBA userform for controls instead of placing them on the slide.</p>\n"}], "owner": {"reputation": 3, "user_id": 11895505, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e8B8ikdy158/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1R3VsxhuR_MI2KmD2WlsKJ09vpg/photo.jpg?sz=128", "display_name": "Isabella Nagel", "link": "https://stackoverflow.com/users/11895505/isabella-nagel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57401249, "answer_count": 1, "score": 0, "last_activity_date": 1593766011, "creation_date": 1565178063, "last_edit_date": 1593766011, "question_id": 57393630, "link": "https://stackoverflow.com/questions/57393630/powerpoint-vba-makro-moving-in-slideshow-mode-w-2-screens-vba-textfields-disa", "title": "Powerpoint VBA makro moving in slideshow mode w. 2 screens + VBA textfields disabled", "body": "<p>My VBA makros in PP works well in slideshow mode on 1 screen, however, disfunctions w. 2 screens. \nMakros either move around on slide or input textbox doesn't work (not able to add input)</p>\n\n<p>The slideshow consist of a textbox input box, a commandbutton, and a textbox output box.\nWhen I change settings on the screens (e.g. change reolution, or which screen to be the main screen), I can make it work again. \nHowever, all these change of setting and testing is not be possible when doing presentations for a customer.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    TextBox2 = TextBox1 * 0.025\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n\nEnd Sub\n</code></pre>\n\n<p>I expect the macros to be at place on the screen no matter the screen.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565178597, "post_id": 57393628, "comment_id": 101269221, "body": "How did you try to color the rows and why did it not work? Which error did you get? Please include your attempt. If you don&#39;t know how the code would look like you can use the Macro Recorder to get an idea how this would work."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 2, "creation_date": 1565178679, "post_id": 57393628, "comment_id": 101269260, "body": "Try something like <code>ThisCell.EntireRow.Interior.ColorIndex = -4142</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565300900, "post_id": 57393628, "comment_id": 101321305, "body": "Did you really mean entire row or entire row of table?"}, {"owner": {"reputation": 468, "user_id": 9771358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a24e06b51fd928225d0c4575a0bc7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Mataunited18", "link": "https://stackoverflow.com/users/9771358/mataunited18"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1565337174, "post_id": 57393628, "comment_id": 101329622, "body": "@QHarr just the entire row, e.g. the whole row of 3"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 2, "last_activity_date": 1565178909, "creation_date": 1565178909, "answer_id": 57393913, "question_id": 57393628, "link": "https://stackoverflow.com/questions/57393628/vba-color-entire-row-based-on-the-colorindex-in-a-table/57393913#57393913", "title": "VBA Color entire row based on the ColorIndex in a table", "body": "<p><strong>Something like this will work:</strong></p>\n\n<pre><code>ActiveSheet.Rows(2).Interior.ColorIndex = Range(\"E2\").Value\n</code></pre>\n\n<p>Put it in a Loop to and change the Row Index and Range Index.</p>\n\n<p><strong>Like:</strong></p>\n\n<pre><code>With Worksheets(\"Sheet2\")\n\nFor i = 1 To 100\n\n     .Rows(i).Interior.ColorIndex = .Range(\"E\" &amp; i).Value\n\nNext\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 468, "user_id": 9771358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a24e06b51fd928225d0c4575a0bc7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Mataunited18", "link": "https://stackoverflow.com/users/9771358/mataunited18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 1, "accepted_answer_id": 57393913, "answer_count": 1, "score": 0, "last_activity_date": 1565178909, "creation_date": 1565178057, "last_edit_date": 1565178524, "question_id": 57393628, "link": "https://stackoverflow.com/questions/57393628/vba-color-entire-row-based-on-the-colorindex-in-a-table", "title": "VBA Color entire row based on the ColorIndex in a table", "body": "<p>I have a table where column <code>E</code> consists of <code>ColorIndex</code></p>\n\n<p>I have extracted the color index from the cells in Sheet1 using below code, </p>\n\n<pre><code>Function BGCol(ThisCell As Range) As Long\nBGCol = ThisCell.Interior.ColorIndex\nEnd Function\n</code></pre>\n\n<p>and pasted the <code>ColorIndex</code> value sto <code>Sheet2</code>. How can I color the entire rows based on the <code>ColorIndex</code> that I now got. The values are <code>-4142</code>,<code>19</code>,<code>35</code>,<code>36</code>,<code>38</code>, and <code>43</code>. I have a table in Sheet2 where column <code>E</code> consists of <code>ColorIndex</code> values.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1565178177, "post_id": 57393603, "comment_id": 101269005, "body": "I can&#39;t see where you declared both <code>sheets3</code> nor <code>sheets1</code> variables. As it is now, those are not declared as sheet objects. Didn&#39;t you meant to write: <code>Sheet3</code> and <code>Sheet1</code>?"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1565178256, "post_id": 57393603, "comment_id": 101269052, "body": "Is <code>sheets3</code> the right CodeName for the Sheet you want? Looking at the rest of your code you probably want to use <code>Sheet3</code>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565178493, "post_id": 57393603, "comment_id": 101269177, "body": "Probably you need to change <code>sheets3</code> to <code>Sheet3</code> and <code>sheets1</code> to <code>Sheet1</code>"}, {"owner": {"reputation": 25, "user_id": 11803274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8beeece155eaefbe9bd514837fc1708b?s=128&d=identicon&r=PG&f=1", "display_name": "aMadNoob", "link": "https://stackoverflow.com/users/11803274/amadnoob"}, "edited": false, "score": 0, "creation_date": 1565178525, "post_id": 57393603, "comment_id": 101269190, "body": "it seems I made a silly mistake with the Sheets names that I just couldn&#39;t see, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11803274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8beeece155eaefbe9bd514837fc1708b?s=128&d=identicon&r=PG&f=1", "display_name": "aMadNoob", "link": "https://stackoverflow.com/users/11803274/amadnoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1565178589, "creation_date": 1565178589, "answer_id": 57393806, "question_id": 57393603, "link": "https://stackoverflow.com/questions/57393603/how-to-fix-object-required-error-in-vba-code/57393806#57393806", "title": "How to fix &quot;Object required&quot; error in VBA code?", "body": "<p>Changed <code>sheets</code> to <code>sheet</code></p>\n\n<pre><code>Sub qwerty()\nDim isamatch As Boolean\nFor myrow = 1 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n    isamatch = True\n    For mycol = 1 To Sheet1.Cells(myrow, \"ZZ\").End(xlToLeft).Column + 1\n        If Sheet1.Cells(myrow, mycol).Value &lt;&gt; Sheet2.Cells(myrow, mycol).Value Then isamatch = False\n    Next mycol\n    If isamatch Then\n        With sheet3\n        .Rows(.Cells(.Rows.Count, 1).End(xlUp).Row) = sheet1.Rows(myrow)\n        End With\n    End If\nNext myrow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11803274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8beeece155eaefbe9bd514837fc1708b?s=128&d=identicon&r=PG&f=1", "display_name": "aMadNoob", "link": "https://stackoverflow.com/users/11803274/amadnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565178589, "creation_date": 1565177993, "question_id": 57393603, "link": "https://stackoverflow.com/questions/57393603/how-to-fix-object-required-error-in-vba-code", "title": "How to fix &quot;Object required&quot; error in VBA code?", "body": "<p>I have a current code that is supposed to take values from sheet1 and sheet2 and output them into sheet3. The only problem I'm having with this code is that I keep getting \"Object required\" errors on the :</p>\n\n<pre><code>With sheets3\n        .Rows(.Cells(.Rows.Count, 1).End(xlUp).Row) = sheets1.Rows(myrow)\n        End With\n</code></pre>\n\n<p>specifically the .Rows line</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>Sub qwerty()\nDim isamatch As Boolean\nFor myrow = 1 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n    isamatch = True\n    For mycol = 1 To Sheet1.Cells(myrow, \"ZZ\").End(xlToLeft).Column + 1\n        If Sheet1.Cells(myrow, mycol).Value &lt;&gt; Sheet2.Cells(myrow, mycol).Value Then isamatch = False\n    Next mycol\n    If isamatch Then\n        With sheets3\n        .Rows(.Cells(.Rows.Count, 1).End(xlUp).Row) = sheets1.Rows(myrow)\n        End With\n    End If\nNext myrow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565250172, "post_id": 57393211, "comment_id": 101295776, "body": "What happens when you put a <code>DoEvents</code> after the line <code>.Send</code>?"}, {"owner": {"reputation": 25, "user_id": 6467591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VaMBS7s24SM/AAAAAAAAAAI/AAAAAAAACGM/z6dbLtt3emI/photo.jpg?sz=128", "display_name": "Anup Patil", "link": "https://stackoverflow.com/users/6467591/anup-patil"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565254359, "post_id": 57393211, "comment_id": 101297906, "body": "That worked like a charm. Thanks a ton for solving my query with your quick response."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6467591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VaMBS7s24SM/AAAAAAAAAAI/AAAAAAAACGM/z6dbLtt3emI/photo.jpg?sz=128", "display_name": "Anup Patil", "link": "https://stackoverflow.com/users/6467591/anup-patil"}, "is_accepted": true, "score": 0, "last_activity_date": 1568099763, "creation_date": 1568099763, "answer_id": 57865786, "question_id": 57393211, "link": "https://stackoverflow.com/questions/57393211/vba-runtime-error-why-am-i-getting-an-error-while-sending-mail-through-outlook/57865786#57865786", "title": "VBA runtime error : Why am i getting an error while sending mail through outlook using mailenvelope", "body": "<p>By adding DoEvents after the .send line solves the issue</p>\n"}], "owner": {"reputation": 25, "user_id": 6467591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VaMBS7s24SM/AAAAAAAAAAI/AAAAAAAACGM/z6dbLtt3emI/photo.jpg?sz=128", "display_name": "Anup Patil", "link": "https://stackoverflow.com/users/6467591/anup-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 57865786, "answer_count": 1, "score": 0, "last_activity_date": 1568099763, "creation_date": 1565176745, "last_edit_date": 1565177111, "question_id": 57393211, "link": "https://stackoverflow.com/questions/57393211/vba-runtime-error-why-am-i-getting-an-error-while-sending-mail-through-outlook", "title": "VBA runtime error : Why am i getting an error while sending mail through outlook using mailenvelope", "body": "<p>I have a code for sending multiple emails on one click to several email id's. The code works absolutely fine if the data is limited, however if the my data sheet contains large amount of data then it throws a run time error as below:</p>\n\n<blockquote>\n  <p>\"Run-time error '-2147417856 (80010100)':</p>\n</blockquote>\n\n<p>The operation failed because of network or other communication problems. Verify your connection and try again.\"</p>\n\n<p>Not sure why this happens. I have to then delete the data for the emails already sent and again start the macro and it again throws an error.</p>\n\n<p>Can someone please help regarding this error</p>\n\n<pre><code>With ActiveSheet.MailEnvelope\n    .Introduction = Sheet3.Range(\"D2\").Value\n\n    With .Item\n        .To = R\n        .CC = S\n        .BCC = T\n        .Subject = Sheet3.Range(\"D1\") &amp; \" - \" &amp; company_name\n        .Send\n    End With\nEnd With\n</code></pre>\n\n<p>I expect the code to run normally irrespective of the data i put in because i have not given any specific range in my coding</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565175846, "post_id": 57392822, "comment_id": 101267654, "body": "If 1st file is sorted then VLOOKUP, otherwise MATCH &amp; INDEX will return the attributes (or error if missing). Then an IF to return &quot;Col not filled&quot;. Then filter and copy to csv"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11524825"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565176323, "post_id": 57392822, "comment_id": 101267918, "body": "thanks a lot. Can you maybe write an answer to this with some photos where I can see this process or some sources I can inform and learn more about this. thank u"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11524825"}, "edited": false, "score": 0, "creation_date": 1565176225, "post_id": 57392926, "comment_id": 101267868, "body": "Requird is to automate this process. Compare these two files and then copy the compared rows into an csv file. Let&#39;s say I search in the first file the user id if it the same user id, copy and paste that row to the new csv file"}], "tags": [], "owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1565175748, "creation_date": 1565175748, "answer_id": 57392926, "question_id": 57392822, "link": "https://stackoverflow.com/questions/57392822/automating-comparing-two-excel-files/57392926#57392926", "title": "Automating comparing two excel files", "body": "<p>I'm aware that your question is tagged with VBA but what exactly are your requirements here?</p>\n\n<p>For example, it might be worth considering to export the excel spreadsheets to XML files and then use XQuery to retrieve that information.\nHowever, I'm not sure whether this fits your needs/requirements in terms of tools/stack.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1565228318, "creation_date": 1565228318, "answer_id": 57404147, "question_id": 57392822, "link": "https://stackoverflow.com/questions/57392822/automating-comparing-two-excel-files/57404147#57404147", "title": "Automating comparing two excel files", "body": "<p>Try it like this.</p>\n\n<pre><code>Sub Compare()\n\nDim WorkRng1 As Range, WorkRng2 As Range, Rng1 As Range, Rng2 As Range\n\nSet objWorkbook1 = Workbooks.Open(\"C:\\your_path\\Book1.xlsx\")\nSet objWorkbook2 = Workbooks.Open(\"C:\\your_path\\Book2.xlsx\")\n\nSet objWorksheet1 = objWorkbook1.Worksheets(1)\nSet objWorksheet2 = objWorkbook2.Worksheets(1)\n\n\nSet WorkRng1 = objWorksheet1.UsedRange\nSet WorkRng2 = objWorksheet2.UsedRange\n\nFor Each Rng1 In WorkRng1\n    Rng1.Value = Rng1.Value\n    For Each Rng2 In WorkRng2\n        If Rng1.Value = Rng2.Value Then\n\n            ' If match, delete\n            ' your biz logic goes here\n\n            Exit For\n        End If\n    Next\nNext\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11524825"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565228318, "creation_date": 1565175437, "last_edit_date": 1565175696, "question_id": 57392822, "link": "https://stackoverflow.com/questions/57392822/automating-comparing-two-excel-files", "title": "Automating comparing two excel files", "body": "<p>I have two excel files. </p>\n\n<p>1st file is big and has a lot of users  and their attributes (found in columns )</p>\n\n<p>2nd file is my file with only my users.</p>\n\n<p>The goal is to look at 1st file for the names of that are on 2nd file. </p>\n\n<p>If the name is found there copy it to a csv file and if one of the columns is empty write a comment saying \u201cColumn/Attribute is not filled\u201d</p>\n\n<p>How would I go with solving this problem considering the fact that I don\u2019t have that much experience excel advanced features. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1565175704, "post_id": 57392782, "comment_id": 101267552, "body": "Can&#39;t assign to array is because of <code>Dim arry(3)</code>. You cannot assign to an array <code>Dim</code>ed with dimensions. Dim without dimensions."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565175965, "post_id": 57392782, "comment_id": 101267702, "body": "Please note that these Functions may be used as UDFs. However, the example code does not do that. A UDF (User Defined Function) is a function that you intend to call in an Excel Formula."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1565175502, "creation_date": 1565175502, "answer_id": 57392850, "question_id": 57392782, "link": "https://stackoverflow.com/questions/57392782/how-to-return-and-use-multiple-values-in-functions-in-vba/57392850#57392850", "title": "How to return and use multiple values in functions in VBA", "body": "<p>You don't use <code>Set</code> and you need a dynamic array of the same type to receive the function result:</p>\n\n<pre><code>Dim arry() As Variant\narry = A()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 2, "last_activity_date": 1565175692, "creation_date": 1565175692, "answer_id": 57392906, "question_id": 57392782, "link": "https://stackoverflow.com/questions/57392782/how-to-return-and-use-multiple-values-in-functions-in-vba/57392906#57392906", "title": "How to return and use multiple values in functions in VBA", "body": "<p>You need to declare <code>arry</code> as <code>Variant</code> and get rid of <code>Set</code>.\nHere is your code corrected:</p>\n\n<pre><code>Function A() As Variant\n    Dim arr(3) As Variant\n    arr(0) = \"zero\"\n    arr(1) = \"one\"\n    arr(2) = \"two\"\n    A = arr\n    MsgBox \"Function A\"\n    MsgBox arr(0)\nEnd Function\n\nFunction B() As Variant\n    Dim arry As Variant: arry = A()\n    MsgBox \"Function B\"\n    MsgBox arry(0)\nEnd Function\n\nSub debugfunc()\n    MsgBox B()\nEnd Sub\n</code></pre>\n\n<p>You may also remove the parens after <code>A</code>, like <code>Dim arry As Variant: arry = A()</code>.</p>\n"}], "owner": {"reputation": 656, "user_id": 7149485, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zvytA.png?s=128&g=1", "display_name": "brb", "link": "https://stackoverflow.com/users/7149485/brb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 57392850, "answer_count": 2, "score": 1, "last_activity_date": 1565175692, "creation_date": 1565175295, "last_edit_date": 1565175689, "question_id": 57392782, "link": "https://stackoverflow.com/questions/57392782/how-to-return-and-use-multiple-values-in-functions-in-vba", "title": "How to return and use multiple values in functions in VBA", "body": "<p>I am would like to write a user defined function (UDF), <code>A</code> that returns multiple values (let's say 3).  I would then like to use these values in another UDF, <code>B</code>.</p>\n\n<p>I have been following \n<a href=\"https://www.geeksengine.com/article/vba-function-multiple-values2.html\" rel=\"nofollow noreferrer\">https://www.geeksengine.com/article/vba-function-multiple-values2.html</a>\non what VBA data structures would support this.  I was originally using a <code>collection</code> to store the multiple values from UDF <code>A</code>,  but in my use case, index 0, 1 and 2 have some value, so would like to use an <code>array</code> instead of a <code>collection</code> so that I can index with base 0 (I am not sure if this is possible with <code>collections</code> - it seems the first element is <code>.Item(1)</code>).</p>\n\n<p>The problem is, I cannot seem to retrieve the values of the array returned by UDF A inside UDF B.</p>\n\n<p>A minimum (not) working example:</p>\n\n<pre><code>Function A() As Variant\n\n    Dim arr(3) As Variant\n\n    arr(0) = \"zero\"\n    arr(1) = \"one\"\n    arr(2) = \"two\"\n\n    A = arr\n\n    MsgBox \"Function A\"\n    MsgBox arr(0)\n\nEnd Function\n\n\nFunction B() As Variant\n\n    Dim arry(3) As Variant\n    Set arry = A()\n\n    MsgBox \"Function B\"\n    MsgBox arry(0)\n\n\n    End Function\n\nSub debugfunc()\n    MsgBox B() \nEnd Sub\n</code></pre>\n\n<p>I have tried both <code>Set arry = A()</code> and <code>arry = A()</code>.  Both produce 'Ca't assign to array' errors when running the debugfunc sub.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "vlookup"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565176683, "post_id": 57392719, "comment_id": 101268114, "body": "Can you use a macro for that or do you need excel formulas?"}], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1565178260, "creation_date": 1565178260, "answer_id": 57393689, "question_id": 57392719, "link": "https://stackoverflow.com/questions/57392719/how-to-extract-records-from-a-worksheet-into-a-seperate-worksheet-using-vlookups/57393689#57393689", "title": "How to extract records from a worksheet into a seperate worksheet using VLOOKUPS and IF&#39;s", "body": "<p>If you can use VBA, you may write some code like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyCloseToExpiration()\n    Dim rngSource As Range: Set rngSource = ThisWorkbook.Worksheets(\"Sheet1\").Cells(2, 1).Resize(LastRow(ThisWorkbook.Worksheets(\"Sheet1\")) - 1, 9)\n    Dim rngDestinationTopLeft As Range: Set rngDestinationTopLeft = ThisWorkbook.Worksheets(\"Sheet2\").Cells(LastRow(ThisWorkbook.Worksheets(\"Sheet2\")) + 1, 1)\n    Dim datLimit As Date: datLimit = DateAdd(\"d\", 90, Date)\n\n    CopyBeforeDate rngSource, rngDestinationTopLeft, datLimit\nEnd Sub\n\nPublic Sub CopyBeforeDate(rngSource As Range, rngDestinationTopLeft As Range, datLimit As Date)\n    Dim lngOffset As Long: lngOffset = 0\n    Dim rngRow As Range: For Each rngRow In rngSource.Rows\n        If rngRow.Cells(1, 8).Value &lt; datLimit Then\n            rngDestinationTopLeft.offset(lngOffset, 0).Resize(rngRow.Rows.Count, rngRow.Columns.Count).Value = rngRow.Value\n            lngOffset = lngOffset + 1\n        End If\n    Next\nEnd Sub\n\nPublic Function LastRow(ewsSheet) As Long\n    With ewsSheet\n        Dim lngResult As Long: lngResult = .Cells(.Rows.Count, 1).End(xlUp).Row\n    End With\n    LastRow = lngResult\nEnd Function\n</code></pre>\n\n<p>You have to put the above into a new Module, customize it (e.g. replace \"Sheet1\" with the name of you worksheet's actual name), and run it (You can place the caret on the sub CopyCloseToExpiration and hit F5 or place a button somewhere and call this function from its event handler).</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4668042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6128f9b9ee43959f30fe175616c2e9e?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4668042/james"}, "edited": false, "score": 0, "creation_date": 1565182508, "post_id": 57394235, "comment_id": 101271482, "body": "For some the reason the code is skipping - as in the data that should be extracted is not being extracted"}, {"owner": {"reputation": 379, "user_id": 9573838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MKXwU2R80e0/AAAAAAAAAAI/AAAAAAAAADM/La93Mvo0dnE/photo.jpg?sz=128", "display_name": "Rishi Mehta", "link": "https://stackoverflow.com/users/9573838/rishi-mehta"}, "reply_to_user": {"reputation": 9, "user_id": 4668042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6128f9b9ee43959f30fe175616c2e9e?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4668042/james"}, "edited": false, "score": 0, "creation_date": 1565183666, "post_id": 57394235, "comment_id": 101272259, "body": "Can you share more screenshots or perhaps type out the formulas here? It may be because of the ranges and how they are being selected like for example using &#39;$&#39; to lock the range when it may not be needed etc."}, {"owner": {"reputation": 9, "user_id": 4668042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6128f9b9ee43959f30fe175616c2e9e?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4668042/james"}, "edited": false, "score": 0, "creation_date": 1565195267, "post_id": 57394235, "comment_id": 101278956, "body": "Should be on a new worksheet but I am just testing :)"}, {"owner": {"reputation": 379, "user_id": 9573838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MKXwU2R80e0/AAAAAAAAAAI/AAAAAAAAADM/La93Mvo0dnE/photo.jpg?sz=128", "display_name": "Rishi Mehta", "link": "https://stackoverflow.com/users/9573838/rishi-mehta"}, "reply_to_user": {"reputation": 9, "user_id": 4668042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6128f9b9ee43959f30fe175616c2e9e?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4668042/james"}, "edited": false, "score": 0, "creation_date": 1565234481, "post_id": 57394235, "comment_id": 101290782, "body": "In your new image, I see that offset is from $B$2. Change it to $B$1 and it will work. The reason being, match returns the position of the matched value and offset navigates to that position starting one below."}], "tags": [], "owner": {"reputation": 379, "user_id": 9573838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MKXwU2R80e0/AAAAAAAAAAI/AAAAAAAAADM/La93Mvo0dnE/photo.jpg?sz=128", "display_name": "Rishi Mehta", "link": "https://stackoverflow.com/users/9573838/rishi-mehta"}, "is_accepted": true, "score": 0, "last_activity_date": 1565179928, "creation_date": 1565179928, "answer_id": 57394235, "question_id": 57392719, "link": "https://stackoverflow.com/questions/57392719/how-to-extract-records-from-a-worksheet-into-a-seperate-worksheet-using-vlookups/57394235#57394235", "title": "How to extract records from a worksheet into a seperate worksheet using VLOOKUPS and IF&#39;s", "body": "<p>While use of Pivot table or VBA macro is recommended in such cases, if you absolutely need to use the formula then you may use the below trick.</p>\n\n<p>You already have the Binary column. Now, add another column say Cumulative Binary that will sum all the 1's till the current row using a <code>SumIf</code> formula as shown in the screenshot below (it is fine if some numbers are repeated because of 0's)</p>\n\n<p><a href=\"https://i.stack.imgur.com/PtP9V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PtP9V.png\" alt=\"enter image description here\"></a></p>\n\n<p>The formula in I3 in my workbook is\n    =SUMIF(H$3:H3,1,H$3:H3)\nand you may adjust it as per your needs.</p>\n\n<p>Now, it is easy since each row has a unique number, we could use <code>Vlookup</code> or like I have done here i.e. use <code>Offset</code> function which simply matches the value in the \"Lookup Column\" to the value in \"Cumulative Binary\" column and returns the rows that match.</p>\n\n<p><a href=\"https://i.stack.imgur.com/V1SDF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V1SDF.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>=IFERROR(OFFSET($F$2,MATCH(M3,$I$3:$I$9,0),0,1,2),\"\")\n</code></pre>\n\n<p>Please note that it is an array formula as I need to return multiple columns (2 here). So, I selected two columns N,O as shown in the screenshot wrote the formula and used Ctrl+Shift+Enter (instead of Enter). Then I simply dragged the formula down. You may want to adjust it as per your needs by including more columns.</p>\n"}], "owner": {"reputation": 9, "user_id": 4668042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6128f9b9ee43959f30fe175616c2e9e?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4668042/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57394235, "answer_count": 2, "score": 0, "last_activity_date": 1565195117, "creation_date": 1565175056, "last_edit_date": 1565195117, "question_id": 57392719, "link": "https://stackoverflow.com/questions/57392719/how-to-extract-records-from-a-worksheet-into-a-seperate-worksheet-using-vlookups", "title": "How to extract records from a worksheet into a seperate worksheet using VLOOKUPS and IF&#39;s", "body": "<p>Worksheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2AYT9.png\" rel=\"nofollow noreferrer\">Excel sheet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/mu2kD.png\" rel=\"nofollow noreferrer\">New</a></p>\n\n<p>Worksheet 1 has licences with 6 columns of information - two being the start and end date.</p>\n\n<p>I need a method of extracting all the records that are within 90 days before the expiry date- the idea being I want a separate alert page</p>\n\n<p>I have done a IF statement that is on the end of the columns that just prints 1 if date is hits the alert criteria or 0 if not...The idea now in Worksheet2 I need some sort of VLOOKUP and IF to extract those records automatically.</p>\n\n<p>How would I do this?</p>\n\n<pre><code>=IF(IFERROR(DATEDIF(TODAY(),H5,\"d\"),91)&lt;90,1,0)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1565174710, "post_id": 57392481, "comment_id": 101267021, "body": "<code>=!</code> is not a valid way to compare two values. You would want to use <code>&lt;&gt;</code>"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565174792, "post_id": 57392481, "comment_id": 101267057, "body": "Not equal is &lt;&gt; in VBA. Moreover, you need an End If before End Sub."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565174913, "post_id": 57392481, "comment_id": 101267110, "body": "It still wont run"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565174919, "post_id": 57392481, "comment_id": 101267112, "body": "@z32a7ul You don&#39;t need an <code>End If</code> if you write it all on a single line"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1565174946, "post_id": 57392481, "comment_id": 101267124, "body": "@KarthikApadodharanan that is hardly a known error message"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565175008, "post_id": 57392481, "comment_id": 101267172, "body": "A compile error message keeps popping up"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1565175085, "post_id": 57392481, "comment_id": 101267218, "body": "@Luuklag Correct, in that case you don&#39;t need it. But as I saw the OP had a line break. Maybe it was just because of the SO engine&#39;s wrapping. But anyway, I would write it on two (three) lines, it is quite long."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565175141, "post_id": 57392481, "comment_id": 101267247, "body": "how can i get this to run"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565175146, "post_id": 57392481, "comment_id": 101267248, "body": "And on which line?"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565175190, "post_id": 57392481, "comment_id": 101267270, "body": "Line 2 on .rows.count"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565175327, "post_id": 57392481, "comment_id": 101267358, "body": "You need a With block if you want to refer to properties of an object like that. Or you should write the object&#39;s name before .Rows. Which objects&#39;s .Rows do you refer to?"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565175772, "post_id": 57392481, "comment_id": 101267602, "body": "Made the changes, now the messagebox says runtime error 1004"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565176112, "post_id": 57392481, "comment_id": 101267783, "body": ".Rows.Count + 5 is more than .Rows.Count, which is the last valid row index. Why do you want to add 5 to it?"}], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1565175984, "post_id": 57392961, "comment_id": 101267708, "body": "!= is not a valid operator"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565176354, "post_id": 57392961, "comment_id": 101267935, "body": "This works great, all i needed to do was add the with statement"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565176897, "post_id": 57392961, "comment_id": 101268246, "body": "The only problem is that i need the cells to be inserted below the workingcell, any idea how to do that"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565177119, "post_id": 57392961, "comment_id": 101268377, "body": "Done defined another object and set it to workincell(offset(1,0) and used that in the then condition"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1565177442, "post_id": 57392961, "comment_id": 101268573, "body": "@KarthikApadodharanan Ah, okay - your question said &quot;one row would need to be inserted above it&quot;.  No need to define a new object, you can just use <code>WorkingCell.Offset(1,0).EntireRow.Insert</code> after the <code>Then</code>"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 2, "last_activity_date": 1565175852, "creation_date": 1565175852, "answer_id": 57392961, "question_id": 57392481, "link": "https://stackoverflow.com/questions/57392481/inserting-rows-using-if-then/57392961#57392961", "title": "Inserting rows using If Then", "body": "<p>As a first step, it might be easier to store the cell in a <code>Range</code> object, instead of re-finding it every time:</p>\n\n<pre><code>Sub Trip()\n    Dim WorkingCell As Range\n\n    Set WorkingCell = Worksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count + 5).End(xlUp)\n\n    If WorkingCell.Value &lt;&gt; \"Red\" Then WorkingCell.EntireRow.Insert\nEnd Sub\n</code></pre>\n\n<p>Now, the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.insert\" rel=\"nofollow noreferrer\"><code>Range.Insert</code></a> command is being used fine, so any issues must be with how you are finding the cell in the first place.  And, sure enough, you say</p>\n\n<blockquote>\n  <p>The fifth cell from the bottom</p>\n</blockquote>\n\n<p>and you write</p>\n\n<pre><code>Worksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count + 5).End(xlUp)\n</code></pre>\n\n<p>So, let's break that down.  The last thing that happens is <code>.End(xlUp)</code> which, per the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\"><code>Range.End</code></a> documentation, is the same as pressing <kbd>Ctrl</kbd>+<kbd>\u2191</kbd> - which will go up until it sees a change from \"data\" to \"no data\" (or hits the top of the sheet), which isn't quite what you want.</p>\n\n<p>Well, what cell is it going up from?  You've written <code>Range(\"G\" &amp; .Rows.Count + 5)</code> - however, <code>Rows.Count</code> will tell you how many rows there are in the <em>entire sheet</em>.  In Excel 2007+, that's 1048576 rows.  Except, you're then adding 5, which is cell G1048581.  But, how is Excel supposed to find row 10485<strong>81</strong> of 10485<strong>76</strong>?</p>\n\n<p>So, let's rework that slightly.  We want to start at the bottom of the sheet (<code>Range(\"G\" &amp; Rows.Count)</code>), then go up until we find data (<code>.End(xlUp)</code>), and <em>then</em> move up by another 4 rows (from the 1<sup>st</sup>-from-the-bottom to the 5<sup>th</sup>-from-the-bottom) which we can do with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\"><code>Range.Offset</code></a> property (<code>.Offset(-4,0)</code>)</p>\n\n<p>Now, we shove that all together:</p>\n\n<pre><code>Worksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count).End(xlUp).Offset(-4,0)\n</code></pre>\n\n<p>And put it into the Sub:</p>\n\n<pre><code>Sub Trip()\n    Dim WorkingCell As Range\n\n    Set WorkingCell = Worksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count).End(xlUp).Offset(-4,0)\n\n    If WorkingCell.Value &lt;&gt; \"Red\" Then WorkingCell.EntireRow.Insert\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565182343, "creation_date": 1565174273, "last_edit_date": 1565182343, "question_id": 57392481, "link": "https://stackoverflow.com/questions/57392481/inserting-rows-using-if-then", "title": "Inserting rows using If Then", "body": "<p>I need the code to insert a row above the cell which is part of the if else statement. If the value of the 5th row from the bottom is not red then one row would need to be inserted above it.\nI tried writing the code but im not very good at it, any suggestions? </p>\n\n<pre><code>Sub Trip()\n\nSet ws = Worksheets(\"WH Calc_new\")\nWith ws\nIf Worksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count + 5).End(xlUp) &lt;&gt; \"Red\" Then\nWorksheets(\"WH Calc_new\").Range(\"G\" &amp; .Rows.Count + 5).End(xlUp).EntireRow.Insert\nEnd If\nEnd With\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "scroll", "combobox", "alignment"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1565174120, "post_id": 57392278, "comment_id": 101266704, "body": "Maybe a very odd suggestion, but could you get away with a second, empty column, to act as a placeholder for the scrollbar?"}, {"owner": {"reputation": 67, "user_id": 11572839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-33MJSzRj-jw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd__WWJM5OaCTHt5Slh7LwND_R4JQ/mo/photo.jpg?sz=128", "display_name": "hi lo", "link": "https://stackoverflow.com/users/11572839/hi-lo"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1565174422, "post_id": 57392278, "comment_id": 101266875, "body": "how can i do this?"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1565174866, "creation_date": 1565174866, "answer_id": 57392655, "question_id": 57392278, "link": "https://stackoverflow.com/questions/57392278/i-have-a-problem-with-combobox-when-showing-scroll/57392655#57392655", "title": "I have a problem with combobox when showing scroll", "body": "<p>Taken from this <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/111948-problem-with-right-aligning-combo-boxes\" rel=\"nofollow noreferrer\">source</a> you can put this code in your <code>UserForm.Initialize</code> procedure, e.g.:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim I As Long, TempString As String\nUserForm1.ComboBox1.ColumnCount = 2\nTempString = LTrim$(Str$(UserForm1.ComboBox1.Width - 15))\nUserForm1.ComboBox1.ColumnWidths = TempString &amp; \" pt; 15 pt\"\nFor I = 1 To 10\n    UserForm1.ComboBox1.AddItem \"Hello\" &amp; Str$(I)\nNext I\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wygBb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wygBb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Another option that works for me is:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim I As Long\nFor I = 1 To 10\n    UserForm1.ComboBox1.AddItem \"Hello \" &amp; I &amp; \"     \"\nNext I\n\nEnd Sub\n</code></pre>\n\n<p>This last option would just put enough trailing spaces to let the text appear fully. Note that when you use those values you will have to <code>TRIM</code> them down.</p>\n"}], "owner": {"reputation": 67, "user_id": 11572839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-33MJSzRj-jw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd__WWJM5OaCTHt5Slh7LwND_R4JQ/mo/photo.jpg?sz=128", "display_name": "hi lo", "link": "https://stackoverflow.com/users/11572839/hi-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 57392655, "answer_count": 1, "score": 3, "last_activity_date": 1566044629, "creation_date": 1565173613, "last_edit_date": 1566044629, "question_id": 57392278, "link": "https://stackoverflow.com/questions/57392278/i-have-a-problem-with-combobox-when-showing-scroll", "title": "I have a problem with combobox when showing scroll", "body": "<p>I have a problem with combobox for showing content.<br>\nWhen I scroll some of the content, like in the attached picture, it is hidden.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dsejj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dsejj.png\" alt=\"enter image description here\"></a></p>\n\n<p>My <code>combobox</code> text alignment is to the right</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 13, "user_id": 11894744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTXKu85amYs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZ3he3tgNyEweWWPBRB61CwVn8tg/photo.jpg?sz=128", "display_name": "Prabhu EduPertZ", "link": "https://stackoverflow.com/users/11894744/prabhu-edupertz"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565174487, "post_id": 57392080, "comment_id": 101266913, "body": "I&#39;m trying to create a macro which automatically copies the question number from doc - A and searches the question number in doc - B, copies the question and pastes the question in doc-C"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565175853, "post_id": 57392080, "comment_id": 101267656, "body": "If that&#39;s all you want to know, then the Answer is Yes!. It is possible."}, {"owner": {"reputation": 13, "user_id": 11894744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTXKu85amYs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZ3he3tgNyEweWWPBRB61CwVn8tg/photo.jpg?sz=128", "display_name": "Prabhu EduPertZ", "link": "https://stackoverflow.com/users/11894744/prabhu-edupertz"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565176094, "post_id": 57392080, "comment_id": 101267770, "body": "@mikku Actually I&#39;ve tried using macros. I&#39;ve done changes to my vba code and I understood how it works. I only want how to copy paste in find and proceed search. TQ"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565176156, "post_id": 57392080, "comment_id": 101267814, "body": "Post the code that you have tried, and point where you are facing issues."}, {"owner": {"reputation": 13, "user_id": 11894744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTXKu85amYs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZ3he3tgNyEweWWPBRB61CwVn8tg/photo.jpg?sz=128", "display_name": "Prabhu EduPertZ", "link": "https://stackoverflow.com/users/11894744/prabhu-edupertz"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565176922, "post_id": 57392080, "comment_id": 101268259, "body": "@Mikku at &#39;.Text = &quot;2&quot; &#39;, I have a list of numbers. But the code only selects 2 question from the doc-B"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565260004, "post_id": 57392080, "comment_id": 101301142, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/57395627/paste-the-copied-number-in-find-dialog-box\">Paste the copied number in Find dialog box</a>"}], "owner": {"reputation": 13, "user_id": 11894744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iTXKu85amYs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZ3he3tgNyEweWWPBRB61CwVn8tg/photo.jpg?sz=128", "display_name": "Prabhu EduPertZ", "link": "https://stackoverflow.com/users/11894744/prabhu-edupertz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565260012, "creation_date": 1565172949, "last_edit_date": 1565260012, "question_id": 57392080, "link": "https://stackoverflow.com/questions/57392080/find-selection-number-and-loop-in-ms-word", "title": "find selection number and loop in ms word", "body": "<p>I have a list of numbers in a row. I want to select the first number, find the number in the other word document, and copy second number and find the second number in the document then move to next number and continue searching.</p>\n\n<pre><code>Selection.Copy\nWindows(\"zoology- repeaters [Compatibility Mode]\").Activate\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"2\"\n    .Replacement.Text = Selection.Characters\n    .Forward = True\n    .Wrap = wdFindAsk\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nSelection.Find.Execute\nSelection.MoveRight Unit:=wdCell\nSelection.MoveDown Unit:=wdLine, Count:=2, Extend:=wdExtend\nSelection.MoveLeft Unit:=wdCharacter, Count:=3, Extend:=wdExtend\nSelection.Copy\nWindows(\"FINAL QP\").Activate\nSelection.PasteAndFormat (wdUseDestinationStylesRecovery)\nWindows(\"01 [Compatibility Mode]\").Activate\nSelection.MoveRight Unit:=wdCell\nSelection.Copy\nWindows(\"zoology- repeaters [Compatibility Mode]\").Activate\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "numpy", "xlwings"], "comments": [{"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1565194249, "post_id": 57391976, "comment_id": 101278442, "body": "See: <a href=\"https://github.com/xlwings/xlwings/issues/1127\" rel=\"nofollow noreferrer\">github.com/xlwings/xlwings/issues/1127</a>"}, {"owner": {"reputation": 129, "user_id": 4495722, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16f9d2dc86ec7d4c42e5480347738fae?s=128&d=identicon&r=PG&f=1", "display_name": "skrhee", "link": "https://stackoverflow.com/users/4495722/skrhee"}, "edited": false, "score": 0, "creation_date": 1569106816, "post_id": 57391976, "comment_id": 102489501, "body": "I have the same issue, I don&#39;t think the github post above helped, but if anybody has a different experience please let me know!"}, {"owner": {"reputation": 77, "user_id": 8714683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4670a72026604510c96a04613e0a90?s=128&d=identicon&r=PG&f=1", "display_name": "jfmhbfrost", "link": "https://stackoverflow.com/users/8714683/jfmhbfrost"}, "edited": false, "score": 0, "creation_date": 1569232167, "post_id": 57391976, "comment_id": 102516410, "body": "Yes the github post didn&#39;t help me either. I had to uninstall and then reinstall anaconda, and during the installation process, when it asks you if you&#39;d like to set anaconda to the windows path (which isn&#39;t recommended in the setup process), I selected yes. This resolved the issue I was having with numpy/pandas. I tried various other solutions and this was the only one that worked for me in the end."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 12484796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b81edfef9641718cf152322eeb6917?s=128&d=identicon&r=PG&f=1", "display_name": "markthebrewer", "link": "https://stackoverflow.com/users/12484796/markthebrewer"}, "is_accepted": false, "score": 0, "last_activity_date": 1577991367, "last_edit_date": 1577991367, "creation_date": 1577986930, "answer_id": 59567660, "question_id": 57391976, "link": "https://stackoverflow.com/questions/57391976/how-to-import-numpy-through-xlwings-package-importerror-dll-load-failed-the/59567660#59567660", "title": "How to import numpy through xlwings package? &quot;ImportError: DLL load failed: The specified module could not be found.&quot;", "body": "<p>I've been trying for a couple of weeks to hit back against this problem too.<br>\nI have a company-owned laptop which is severely restricted to what environment variables I have access too, and PATH is not one of them.<br>\nI have no trouble linking Excel with Python (Spyder / Anaconda3 installation), but as soon as add <code>import numpy as np</code> to my python code, I get the same <code>DLL load failed</code> error. (It didn't always do this though, it just started doing it overnight for no reason I can fathom, but I digress). The code itself works fine in Spyder though.<br>\nI did eventually find something of a workaround though, but it's a bit of a last resort, being more than a bit awkward and daft. Maybe useful for a developer to track down a more sensible solution though?<br>\nAnyway, I found that if I launched Excel from Spyder, the numpy module correctly imports, and remains stable. To do this, I just access the contents of one of the workbook's cells without having Excel already open. This launches Excel, opens the workbooks, and correctly imports numpy.<br>\nWhat do you think?</p>\n"}], "owner": {"reputation": 77, "user_id": 8714683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4670a72026604510c96a04613e0a90?s=128&d=identicon&r=PG&f=1", "display_name": "jfmhbfrost", "link": "https://stackoverflow.com/users/8714683/jfmhbfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 915, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1577991367, "creation_date": 1565172595, "last_edit_date": 1570198567, "question_id": 57391976, "link": "https://stackoverflow.com/questions/57391976/how-to-import-numpy-through-xlwings-package-importerror-dll-load-failed-the", "title": "How to import numpy through xlwings package? &quot;ImportError: DLL load failed: The specified module could not be found.&quot;", "body": "<p>I'm trying to use the 'Run Python' function of xlwings to run Python code through VBA.</p>\n\n<p>I have been using Spyder to execute my code and it runs with no errors.</p>\n\n<p>When trying to run this from VBA with the xlwings package I receive:</p>\n\n<blockquote>\n  <p>\"ImportError: DLL load failed: The specified module could not be found.\"</p>\n</blockquote>\n\n<p>and this error relates to the numpy package.</p>\n\n<p>I tried uninstalling and reinstalling the anaconda package and using <code>pip install numpy</code>.</p>\n\n<p>I checked that I have the most up to date version of xlwings 0.15.8.</p>\n\n<p>I found this thread <a href=\"https://github.com/xlwings/xlwings/issues/954\" rel=\"nofollow noreferrer\">https://github.com/xlwings/xlwings/issues/954</a> stating this issue was fixed with version 0.15.7 of xlwings.</p>\n\n<p>VBA code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>RunPython (\"import Demand; Demand.calibrate_Demand()\")\n</code></pre>\n\n<p>Spyder code:</p>\n\n<pre><code>import numpy as np\nimport xlwings as xw\nimport pandas as pd\nimport statsmodels.api as sm\nfrom statsmodels.tsa.arima_model import ARMA\nfrom statsmodels.tsa.arima_model import ARMAResults\nfrom matplotlib import pyplot as plt\nimport datetime\n\ndef calibrate_dDemand():\n</code></pre>\n\n<p>My Python file is called Demand.py</p>\n\n<p>When executing my VBA code I receive the following error:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"e:\\julia\\calibration automation\\Demand.py\", line 17, in &lt;module&gt;\n    import numpy as np\n  File \"C:\\Users\\julia\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\numpy\\__init__.py\", line 140, in &lt;module&gt;\n    from . import _distributor_init\n  File \"C:\\Users\\julia\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\numpy\\_distributor_init.py\", line 34, in &lt;module&gt;\n    from . import _mklinit\nImportError: DLL load failed: The specified module could not be found.\n</code></pre>\n\n<p>If I place <code>import pandas as pd</code> first (before importing numpy) I receive this error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"e:\\julia\\calibration automation\\Demand.py\", line 19, in &lt;module&gt;\n    import pandas as pd\n  File \"C:\\Users\\julia\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\__init__.py\", line 19, in &lt;module&gt;\n    \"Missing required dependencies {0}\".format(missing_dependencies))\nImportError: Missing required dependencies ['numpy']\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1565203923, "post_id": 57391837, "comment_id": 101282892, "body": "Why use Word and not Access report? Possibly instead of FormFields, build a table in Word."}, {"owner": {"reputation": 25, "user_id": 11837540, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VEPi6_PKub0/AAAAAAAAAAI/AAAAAAAAABo/s8GEtDCSm1M/photo.jpg?sz=128", "display_name": "Sa\u0161a Kristi\u0107", "link": "https://stackoverflow.com/users/11837540/sa%c5%a1a-kristi%c4%87"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1565253812, "post_id": 57391837, "comment_id": 101297594, "body": "I use Word template because before FormField, I have word &quot;Question: &quot; &amp; &quot;Answer: &quot;, I am using Access report when one Q &amp; A is needed, I just don&#39;t have any clue how to export 100 or 1000 Q&#39;s and A&#39;s in same document, if you have any idea please let me know."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1565281048, "post_id": 57391837, "comment_id": 101313548, "body": "Sorry, the limitation you expressed makes no sense to me. I can see no reason why Access report could not accomplish. Would have to know more about your db structure and desired output. But if you are happy with Word merge performance then problem solved."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11837540, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VEPi6_PKub0/AAAAAAAAAAI/AAAAAAAAABo/s8GEtDCSm1M/photo.jpg?sz=128", "display_name": "Sa\u0161a Kristi\u0107", "link": "https://stackoverflow.com/users/11837540/sa%c5%a1a-kristi%c4%87"}, "edited": false, "score": 0, "creation_date": 1565271296, "post_id": 57410827, "comment_id": 101307864, "body": "Dear Cindy Meister, You have just opened my eyes for a new set of toys to play with :)  I don&#39;t have enough words to thank you for your solution, now it first inserts 1 field, then fills it with data from Access, then it does the same for 2, no matter how many Q &amp; A there is. I just managed to export 951 pages of Qs and As.  The code is: <code>Do Until rst.EOF  tmpl.BuildingBlockEntries(&quot;Answer&quot;).Insert Where:=rngEndOfDoc, RichText:=True     myDoc.FormFields(&quot;Answer&quot;).Range.Text = &quot;ANSWER: &quot; &amp; Nz(rst!Answer, &quot;&quot;)      rst.MoveNext Loop</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 11837540, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VEPi6_PKub0/AAAAAAAAAAI/AAAAAAAAABo/s8GEtDCSm1M/photo.jpg?sz=128", "display_name": "Sa\u0161a Kristi\u0107", "link": "https://stackoverflow.com/users/11837540/sa%c5%a1a-kristi%c4%87"}, "edited": false, "score": 0, "creation_date": 1565272274, "post_id": 57410827, "comment_id": 101308498, "body": "Glad it worked for you @Sa\u0161aKristi\u0107 :-) I love new toys, too! I&#39;ve integrated your code snippet into the answer, just in case the comment gets deleted at some point. (Comments on Stack Overflow are &quot;volatile&quot;) This could help someone else who has a similar problem."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1565272147, "last_edit_date": 1565272147, "creation_date": 1565261285, "answer_id": 57410827, "question_id": 57391837, "link": "https://stackoverflow.com/questions/57391837/access-recordset-from-2-columns-to-word-template-or-empty-document/57410827#57410827", "title": "Access recordset (from 2 columns) to Word template (or empty document)", "body": "<p>Most efficient is to save the form fields as <em>Building Blocks</em> which can be inserted as often as required. Building Blocks can only be saved in a template, so <em>open</em> ReportQuestions.docx then use File/Save As to save it as a <code>dotx</code>.</p>\n\n<p>Select the pair of form fields, then use Insert->Quick Parts->Save selection to quick part gallery. Fill out the fields in the dialog box being sure to select the template ReportQuestions.dotx for \"Save in\".</p>\n\n<p>To insert the form fields, the code would look something like below. Note, also, how to get to the end of the document on each iteration, before inserting the next pair of form fields. (See also note below the code!)</p>\n\n<pre><code>Dim tmpl as Word.Template\nDim sTmplPath as String\nsTmplPath = \"C:\\Users\\User\\Desktop\\ReportQuestions.dotx\"\nSet myDoc = Wd.Documents.Add(sTmplPath)\nSet tmpl = myDoc.AttachedTemplate\n\nDim rngEndOfDoc as Word.Range\nSet rngEndOfDoc = myDoc.Content\nrngEndOfDoc.Collapse wdWollapseEnd\ntmpl.BuildingBlockEntries(\"Name of Entry\").Insert Where:=rngEndOfDoc, RichText:=True\n</code></pre>\n\n<p>This builds on the code shown in the question. Based on my experience with form fields, I suspect this code, as shown, does not work for more than one pair of form fields <em>because</em> form field names are also Word bookmarks. And bookmark names <em>must</em> be unique (can only appear once) in a document. So <code>Question</code> and <code>Answer</code> can only be used once. I don't know what you're actually naming the form fields, but you'll probably need to add code to rename the form fields once they've been inserted.</p>\n\n<p><strong>Added from OP's comment</strong>: The suggestion was successfully implemented like this</p>\n\n<pre><code>Do Until rst.EOF \n  tmpl.BuildingBlockEntries(\"Answer\").Insert Where:=rngEndOfDoc, RichText:=True myDoc.FormFields(\"Answer\").Range.Text = \"ANSWER: \" &amp; Nz(rst!Answer, \"\") \n  rst.MoveNext \nLoop\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11837540, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VEPi6_PKub0/AAAAAAAAAAI/AAAAAAAAABo/s8GEtDCSm1M/photo.jpg?sz=128", "display_name": "Sa\u0161a Kristi\u0107", "link": "https://stackoverflow.com/users/11837540/sa%c5%a1a-kristi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57410827, "answer_count": 1, "score": 1, "last_activity_date": 1565272147, "creation_date": 1565172187, "last_edit_date": 1565204150, "question_id": 57391837, "link": "https://stackoverflow.com/questions/57391837/access-recordset-from-2-columns-to-word-template-or-empty-document", "title": "Access recordset (from 2 columns) to Word template (or empty document)", "body": "<p>I'm trying to export (button click) data from Access recordset (data from 2 columns - \"Question\" &amp; \"Answer\") to Word template which has FormFields \"Question\" &amp; \"Answer\".</p>\n\n<p>I managed to do it but only until Word document runs out of FormFields (which I added - 100), if recordset has more than 100 rows, it will result with an error \"error 5941 the requested member of the collection does not exist\" - because it run out of available FormFields (at this time max number of questions is 1100, and it will grow). I can, btw, add several thousand FormFields, but then user will have to delete the empty ones when he uses this option.</p>\n\n<p>I feel like there is an easy way to implement some other kind of loop which will take a document which has only these two FormFields and copy or duplicate first FormField - \"Question\" and insert data in second, but I still didn't find any way of doing that.</p>\n\n<p>Exporting data from 2 columns in Access recordset, one is \"Question\" and other \"Answer\". Code on ButtonClick:</p>\n\n<pre><code>Private Sub cmdToWordMultiple_Click()\nDim db As DAO.Database\nDim rst As DAO.Recordset\n\nSet db = CurrentDb()\nSet rst = Me.RecordsetClone\nSet Wd = New Word.Application\nSet myDoc = Wd.Documents.Add(\"C:\\Users\\User\\Desktop\\ReportQuestions.docx\")\n\nWd.Visible = True\nrst.MoveFirst\n\nDo Until rst.EOF\n\n    myDoc.FormFields(\"Question\").Range.Text = Nz(rst!Question, \"\")\n    myDoc.FormFields(\"Answer\").Range.Text = Nz(rst!Answer, \"\")\n\nrst.MoveNext\nLoop\n\nrst.Close\nSet rst = Nothing\n\nobjWord.Application.Quit\n\nEnd Sub\n</code></pre>\n\n<p>I would like to make this button export data from Access recordset to Word Document, without leaving excess FormFields.</p>\n"}, {"tags": ["excel", "vba", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1576052820, "creation_date": 1576052820, "answer_id": 59281531, "question_id": 57391501, "link": "https://stackoverflow.com/questions/57391501/how-to-export-text-from-annotation-fields-in-nuance-power-pdf-to-excel-using-vba/59281531#59281531", "title": "How to export text from annotation fields in Nuance Power PDF to Excel using VBA?", "body": "<p>Either your annotations are more complex than indicated or you're overthinking it.</p>\n\n<p>Just read the annotation with <code>GetContents</code> and call it a day.</p>\n\n<pre><code>Set PDFApp = CreateObject(\"NuancePDF.App\")\nSet dvDoc = CreateObject(\"NuancePDF.DVDoc\")\n\ndvDoc.Open(\"\\\\adpdc-2\\Users$\\a.goudinoux\\Documents\\Macro Formulaire\\fiche.pdf\")\n\nSet ddDoc = dvDoc.GetDDDoc()\nSet ddPage = ddDoc.AcquirePage(0)\nnbannots = ddPage.GetNumAnnots() - 1\n\nFor i = 0 To nbannots\n    Set ddAnnot = ddPage.GetAnnot(i)\n\n    ThisWorkbook.Sheets(1).Cells(1, i) = ddAnnot.GetTitle\n    ThisWorkbook.Sheets(1).Cells(2, i) = ddAnnot.GetContents\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10728737, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--5a4oumUpuM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jQPRyUlrdJuGTCy3e8IaCrFrlJfw/mo/photo.jpg?sz=128", "display_name": "Antoine G", "link": "https://stackoverflow.com/users/10728737/antoine-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1576052820, "creation_date": 1565171233, "last_edit_date": 1565172210, "question_id": 57391501, "link": "https://stackoverflow.com/questions/57391501/how-to-export-text-from-annotation-fields-in-nuance-power-pdf-to-excel-using-vba", "title": "How to export text from annotation fields in Nuance Power PDF to Excel using VBA?", "body": "<p>I am trying to export some text from annotation fields in Nuance Power PDF to Excel using VBA. I added the Nuance Power PDF reference to Excel VBA (PDF Plus). </p>\n\n<p>I used it and it works well but the text returned from fields is empty.</p>\n\n<pre><code>Set PDFApp = CreateObject(\"NuancePDF.App\")\nSet dvDoc = CreateObject(\"NuancePDF.DVDoc\")\n\ndvDoc.Open(\"\\\\adpdc-2\\Users$\\a.goudinoux\\Documents\\Macro Formulaire\\fiche.pdf\")\n\nSet ddDoc = dvDoc.GetDDDoc()\nSet ddPage = ddDoc.AcquirePage(0)\nnbannots = ddPage.GetNumAnnots() - 1\n\nFor i = 0 To nbannots\n    Texte = \"\"\n    Set ddAnnot = ddPage.GetAnnot(i)\n    Set ddText = ddDoc.CreateTextSelect(0, ddAnnot.GetRect())\n\n    ThisWorkbook.Sheets(1).Cells(1, i) = ddAnnot.GetTitle()\n\n    For k = 0 To ddText.GetNumText()\n        Texte = Texte &amp; ddText.GetText(k)\n    Next\n\n    ThisWorkbook.Sheets(1).Cells(2, i) = Texte\nNext\n</code></pre>\n\n<p>Part of the PDF document : \n<img src=\"https://i.ibb.co/2ns0L3t/Sans-titre.png\" alt=\"doc\"></p>\n\n<p>Results : \n<img src=\"https://i.ibb.co/nzNptnZ/Annotation-2019-08-07-112228.png\" alt=\"Results\"></p>\n\n<p>As you can see the first line is working but not the second one.</p>\n\n<p>I thought the problem was with ddText but ddText.GetNumText() gives the right number of text elements in the text selection (ex : 2, 5, 4, etc...) when I run my program in Debug Mode.\nI think the problem is from the function GetText(k). </p>\n\n<p><img src=\"https://i.ibb.co/GR1pcnS/Annotation-2019-08-07-113041.png\" alt=\"GetText\"></p>\n\n<p>I made it work once but I can't find my code back.. \nDo you see any mistake ?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565175495, "post_id": 57391322, "comment_id": 101267436, "body": "I cannot reproduce the problem in Excel 2013. The only time when the UDF logs multiple entries is when there are some changes made to VBA code. Can you give exact steps to reproduce?"}, {"owner": {"reputation": 109, "user_id": 5324979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0197f0a308736781fe15d40067cf2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "bgordon", "link": "https://stackoverflow.com/users/5324979/bgordon"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565180175, "post_id": 57391322, "comment_id": 101270072, "body": "Create a new workbook. Enter multiple formulas into different cells. Save the workbook. Close and reopen Excel. Double-click on a cell with a formula and press Enter to recalculate. Excel will then recalculate all cells."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565190060, "post_id": 57391322, "comment_id": 101276261, "body": "Definitely no repro in 2013: new workbook, pasted the code in new module, entered 10 random cells with this UDF, saved, closed, reopened. After editing and confirming one of the cells the only output was <code>calculating: $C$3</code>."}, {"owner": {"reputation": 109, "user_id": 5324979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0197f0a308736781fe15d40067cf2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "bgordon", "link": "https://stackoverflow.com/users/5324979/bgordon"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565191006, "post_id": 57391322, "comment_id": 101276780, "body": "@BrakNicku that&#39;s strange. Thanks for trying to reproduce though. Perhaps it&#39;s because I&#39;m using a 2016 version of Excel for Mac"}, {"owner": {"reputation": 109, "user_id": 5324979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0197f0a308736781fe15d40067cf2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "bgordon", "link": "https://stackoverflow.com/users/5324979/bgordon"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565191761, "post_id": 57391322, "comment_id": 101277206, "body": "After testing on Windows Excel 2016 I can confirm that I&#39;m unable to reproduce the issue and Excel recalculates only the cells requested. It seems that this is purely a Mac issue, I&#39;ll update the original question to reflect this."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1565193403, "post_id": 57391322, "comment_id": 101278057, "body": "If it is some version specific defect then there are only 2 ways left - wait for the fix or try to implement some workaround. There is not enough data in the question to suggest one, I can only guess it is all about avoiding some time consuming calculations, so maybe some global variable flag can be of help."}], "owner": {"reputation": 109, "user_id": 5324979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0197f0a308736781fe15d40067cf2a9e?s=128&d=identicon&r=PG&f=1", "display_name": "bgordon", "link": "https://stackoverflow.com/users/5324979/bgordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565191858, "creation_date": 1565170670, "last_edit_date": 1565191858, "question_id": 57391322, "link": "https://stackoverflow.com/questions/57391322/can-i-prevent-cells-being-dirtied-when-a-workbook-opens-mac", "title": "Can I prevent cells being dirtied when a Workbook opens [Mac]?", "body": "<p>I have a UDF that I'm using throughout a Workbook, when I save and reopen the Workbook and then try to recalculate a single cell, Excel will update that cell but it will also recalculate every other cell containing that formula in the Workbook.</p>\n\n<p>Here's a simple formula that demonstrates this issue:</p>\n\n<pre><code>Public Function MyFormula(a As Integer, b As Integer) As Integer\n\n    Debug.Print \"calculating: \" &amp; Application.Caller.Address\n\n    MyFormula = a * b    \n\nEnd Function\n</code></pre>\n\n<p>I would expect that after recalculating a single cell to see a single log statement, but I'm actually seeing 4 (I have 4 cells with this UDF in the Workbook).</p>\n\n<p>I'm guessing that when I save &amp; reopen the Workbook, Excel is marking the cells as \"Dirty\" and in need of recalculation, but that doesn't make sense. According to the docs (<a href=\"https://docs.microsoft.com/en-us/office/client-developer/excel/excel-recalculation#dependence-dirty-cells-and-recalculated-cells\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/client-developer/excel/excel-recalculation#dependence-dirty-cells-and-recalculated-cells</a>) dirty cells are defined as those who's dependancies have changed:</p>\n\n<blockquote>\n  <p>When new data or new formulas are entered, Excel marks all the cells  that depend on that new data as needing recalculation. Cells that are marked in this way are known as dirty.</p>\n</blockquote>\n\n<p>My UDF isn't volatile and I haven't altered any dependancies, so why is Excel recalculating the all cells and how can I stop it from doing so?</p>\n\n<p>(By the way, I'm aware that Manual calculation mode exists. I'd like to be able to use Automatic mode and allow automatic cell updates, but just only when dependancies have changed)</p>\n\n<p>I've since found that this issue is only present on Excel for Mac (tested on the 2016 version).</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1565170958, "post_id": 57391257, "comment_id": 101264974, "body": "You cannot see any errors because you must remove <code>On Error Resume Next</code> to see your error messages! This line hides <b>all</b> error messages until <code>End  Sub</code>, but the errors still occur (you just cannot see their message boxes). To fix your errors you need to make them visible first. Therefore remove that line and see where you get errors and which. \u2022 To debug your code then go through the code using F8 and check the values of your variables to see what is going wrong."}, {"owner": {"reputation": 3, "user_id": 11894544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a94e28dcfd13eed31ae3d90c99d3b7?s=128&d=identicon&r=PG&f=1", "display_name": "Katerina_080", "link": "https://stackoverflow.com/users/11894544/katerina-080"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565171332, "post_id": 57391257, "comment_id": 101265163, "body": "Thank you for your comment! However, the code still works even after removing &quot;On Error Resume Next&quot; and no errors come out."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565171409, "post_id": 57391257, "comment_id": 101265197, "body": "Did you go through the code step by step using F8 to see <i>where</i> it goes wrong? What was the result of your investigation?"}, {"owner": {"reputation": 3, "user_id": 11894544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a94e28dcfd13eed31ae3d90c99d3b7?s=128&d=identicon&r=PG&f=1", "display_name": "Katerina_080", "link": "https://stackoverflow.com/users/11894544/katerina-080"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565171861, "post_id": 57391257, "comment_id": 101265444, "body": "I did, but to be honest, there are 347 messages and I have not checked all of them at once. However, I reached the point when 1 message (that stayed between two others)  was skipped, and code continued to analyse the rest of them. On the second trial, that message was already accounted. That is why after the first iteration, there are just 26 or 23 emails identified, then 39 or 33 and etc till 46. Each time the number of identified emails during the first iteration changes, but between 26, 23 and 22."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1565171920, "post_id": 57391691, "comment_id": 101265478, "body": "Was about to post that :) \u2022 But highly recommended to remove <code>On Error Resume Next</code>  or replace it with a proper error handling:  <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1565172024, "post_id": 57391691, "comment_id": 101265533, "body": "Thanks @P\u1d07\u029c .. I actually removed it while testing. But then while making it compatible for OP, I missed removing it."}, {"owner": {"reputation": 3, "user_id": 11894544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a94e28dcfd13eed31ae3d90c99d3b7?s=128&d=identicon&r=PG&f=1", "display_name": "Katerina_080", "link": "https://stackoverflow.com/users/11894544/katerina-080"}, "edited": false, "score": 0, "creation_date": 1565172450, "post_id": 57391691, "comment_id": 101265782, "body": "@Peh, thank you very much for your help!!! I will remove &quot;On Error Resume Next&quot;! Thank you!"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1565171959, "last_edit_date": 1565171959, "creation_date": 1565171838, "answer_id": 57391691, "question_id": 57391257, "link": "https://stackoverflow.com/questions/57391257/trying-to-move-emails-in-a-loop-but-not-all-get-moved-in-the-first-run/57391691#57391691", "title": "Trying to move emails in a loop, but not all get moved in the first run", "body": "<p><strong>Problem:</strong></p>\n\n<ul>\n<li>Apparently when the items are moved around, it messes with the item being referred in the loop in case of <code>For Each</code> loop</li>\n</ul>\n\n<p><strong>Solution:</strong></p>\n\n<ul>\n<li>Work a Loop after counting the Items and Backwards.So that each item is referred by an Index.</li>\n</ul>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>Sub Emails_Outlook_Transport()\n    Dim olApp As Outlook.Application\n    Set olApp = New Outlook.Application\n\n    Dim olNS As Outlook.NameSpace\n    Set olNS = olApp.GetNamespace(\"MAPI\")\n\n    Dim olFldr As Outlook.MAPIFolder\n    Set olFldr = olNS.GetDefaultFolder(olFolderInbox)\n\n    Dim Items As Outlook.Items\n    Set Items = olFldr.Items\n\n    Dim newFldr As Outlook.MAPIFolder\n    Set newFldr = olFldr.Folders(\"Neu\")\n\n    Dim msg As Object\n    Dim olMailItem As MailItem\n    Dim Found As Boolean\n\n    Dim i As Integer\n\n    For i = Items.Count To 1 Step -1\n        If TypeOf Items(i) Is MailItem And Items(i).UnRead = False Then\n\n            Set olMailItem = Items(i)\n\n            If InStr(olMailItem.Subject, \"has been updated\") &gt; 0 And InStr(olMailItem.Subject, \"Item\") &gt; 0 Then\n                olMailItem.Move newFldr\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11894544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a94e28dcfd13eed31ae3d90c99d3b7?s=128&d=identicon&r=PG&f=1", "display_name": "Katerina_080", "link": "https://stackoverflow.com/users/11894544/katerina-080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 57391691, "answer_count": 1, "score": 0, "last_activity_date": 1590663529, "creation_date": 1565170402, "last_edit_date": 1590663529, "question_id": 57391257, "link": "https://stackoverflow.com/questions/57391257/trying-to-move-emails-in-a-loop-but-not-all-get-moved-in-the-first-run", "title": "Trying to move emails in a loop, but not all get moved in the first run", "body": "<p>The VBA code does not move all emails with a certain words in the Subject \"has been updated\" and \"Item\" from the inbox to the subfolder \"Neu\". Emails should be already read. After 5-6 iterations , all emails will be moved. But why doesn't it work immediately after the first time of code running? Maybe you have faced the same problem? Out of 46 emails, 26 of them are moved firstly, then 39, then 44 and then 46.</p>\n\n<p>Thank you very much in advance!</p>\n\n<pre><code>Sub Emails_Outlook_Transport()\n    Dim olApp As Outlook.Application\n    Set olApp = New Outlook.Application\n\n    Dim olNS As Outlook.Namespace\n    Set olNS = olApp.GetNamespace(\"MAPI\")\n\n    Dim olFldr As Outlook.MAPIFolder\n    Set olFldr = olNS.GetDefaultFolder(olFolderInbox)\n\n    Dim Items As Outlook.Items\n    Set Items = olFldr.Items\n\n    Dim newFldr As Outlook.MAPIFolder\n    Set newFldr = olFldr.Folders(\"Neu\")\n\n    Dim msg As Object\n    Dim olMailItem As MailItem\n    Dim Found As Boolean\n\n    On Error Resume Next\n\n    For Each msg In Items        \n        If TypeOf msg Is MailItem And msg.UnRead = False Then\n            Set olMailItem = msg\n\n            If InStr(olMailItem.Subject, \"has been updated\") &gt; 0 And InStr(olMailItem.Subject, \"Item\") &gt; 0 Then\n                olMailItem.Move newFldr\n            End If \n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>No error messages, just not a proper work of the code</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 5, "creation_date": 1565169916, "post_id": 57391063, "comment_id": 101264409, "body": "Sounds like you might be interested in posting this question on <a href=\"https://codereview.stackexchange.com/\">code review</a> instead. A place that&#39;s dedicated to seeking peer review of code that allready works."}, {"owner": {"reputation": 79, "user_id": 11741419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFxSYVo2ULg/AAAAAAAAAAI/AAAAAAAAALg/y0i7eV7vSf8/photo.jpg?sz=128", "display_name": "Samuel Balun", "link": "https://stackoverflow.com/users/11741419/samuel-balun"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1565173431, "post_id": 57391063, "comment_id": 101266332, "body": "Thank you! I really appreciate your comment."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1565170950, "creation_date": 1565170950, "answer_id": 57391412, "question_id": 57391063, "link": "https://stackoverflow.com/questions/57391063/my-if-statement-is-robust-how-can-i-make-it-more-compact/57391412#57391412", "title": "My if statement is robust. How can I make it more compact?", "body": "<p><strong>Maybe Like this:</strong></p>\n\n<p>You can make use of <code>Select Case</code> and Get rid of Extra Range Definitions as they are same for all the sheets.</p>\n\n<pre><code>Option Explicit\nSub test()\n\nDim LastRow As Long, i As Long\n\nWith Worksheets(\"Data\")\n\nLastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).row\n\n\nFor i = 2 To LastRow\n\n    Select Case .Cells(i, 6)\n\n    Case \"Mfg FG\"\n        Call act(Worksheets(\"ABCX Mfg FG\"), i)\n    Case \"Mfg RAW\"\n        Call act(Worksheets(\"ABCX Mfg RAW\"), i)\n    Case \"Mfg Sub-Assy\"\n        Call act(Worksheets(\"ABCX Mfg Sub-Assy\"), i)\n    Case \"Resale\"\n        Call act(Worksheets(\"ABCX Resale\"), i)\n    Case \"Conv Resale\"\n        Call act(Worksheets(\"ABCX Conv Resale\"), i)\n    Case \"Mfg FG PE\"\n        Call act(Worksheets(\"ABCX Mfg FG PE\"), i)\n    Case \"Mfg Sub-Assy PE\"\n        Call act(Worksheets(\"ABCX Mfg Sub-Assy PE\"), i)\n    Case \"Acrylics\"\n        Call act(Worksheets(\"ABCX Acrylics\"), i)\n    Case \"Mfg Raw PE\"\n        Call act(Worksheets(\"ABCX Mfg Raw PE\"), i)\n    Case \"Mfg FG PVC\"\n        Call act(Worksheets(\"ABCX Mfg FG PVC\"), i)\n    Case \"Mfg Raw PVC\"\n        Call act(Worksheets(\"ABCX Mfg Raw PVC\"), i)\n    Case \"Mfg Sub-Assy PVC\"\n        Call act(Worksheets(\"ABCX Mfg Sub-Assy PVC\"), i)\n    End Select\n    Next i\n\nEnd With\n\nEnd Sub\n\n\nSub act(wks As Worksheet, j As Long)\n\n    With wks\n\n      .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n         Worksheets(\"Data\").Cells(j, 1).Value\n\n      .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n         Worksheets(\"Data\").Cells(j, 8).Value\n\n      .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n         Worksheets(\"Data\").Cells(j, 9).Value\n\n      .Range(\"A13:C1370\").RemoveDuplicates Columns:=Array(1, 2, 3)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11741419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFxSYVo2ULg/AAAAAAAAAAI/AAAAAAAAALg/y0i7eV7vSf8/photo.jpg?sz=128", "display_name": "Samuel Balun", "link": "https://stackoverflow.com/users/11741419/samuel-balun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57391412, "answer_count": 1, "score": 0, "last_activity_date": 1565170950, "creation_date": 1565169794, "question_id": 57391063, "link": "https://stackoverflow.com/questions/57391063/my-if-statement-is-robust-how-can-i-make-it-more-compact", "title": "My if statement is robust. How can I make it more compact?", "body": "<p>I have a robus code that does its job but is rather ugly. The code pick up values from \"Data\" sheet based on its ItemType and copy it into the appropriate worksheet. Sounds simple. However, there are some aesthetical flaws like the gridlines have been deleted and cell formatting is distorted.\nI would appreciate any help or suggestion. </p>\n\n<pre><code>Option Explicit\nSub test()\n\nDim LastRow As Long, i As Long\n'-----------Mfg FG\nDim rng1 As Range\n'-----------Mfg RAW\nDim rng2 As Range\n'-----------Mfg Sub-Assy\nDim rng3 As Range\n'-----------Resale\nDim rng4 As Range\n'-----------Conv Resale\nDim rng5 As Range\n'-----------Mfg FG PE\nDim rng6 As Range\n'-----------Mfg Sub-Assy PE\nDim rng7 As Range\n'-----------Acrylics\nDim rng8 As Range\n'-----------Mfg Raw PE\nDim rng9 As Range\n'-----------Mfg FG PVC\nDim rng10 As Range\n'-----------Mfg Raw PVC\nDim rng11 As Range\n'-----------Mfg Sub-Assy PVC\nDim rng12 As Range\n\n'--------------------------------------------------------\n\nSet rng1 = Worksheets(\"ABCX Mfg FG\").Range(\"A13:C1370\")\nSet rng2 = Worksheets(\"ABCX Mfg RAW\").Range(\"A13:C1370\")\nSet rng3 = Worksheets(\"ABCX Mfg Sub-Assy\").Range(\"A13:C1370\")\nSet rng4 = Worksheets(\"ABCX Resale\").Range(\"A13:C1370\")\nSet rng5 = Worksheets(\"ABCX Conv Resale\").Range(\"A13:C1370\")\nSet rng6 = Worksheets(\"ABCX Mfg FG PE\").Range(\"A13:C1370\")\nSet rng7 = Worksheets(\"ABCX Mfg Sub-Assy PE\").Range(\"A13:C1370\")\nSet rng8 = Worksheets(\"ABCX Acrylics\").Range(\"A13:C1370\")\nSet rng9 = Worksheets(\"ABCX Mfg Raw PE\").Range(\"A13:C1370\")\nSet rng10 = Worksheets(\"ABCX Mfg FG PVC\").Range(\"A13:C1370\")\nSet rng11 = Worksheets(\"ABCX Mfg Raw PVC\").Range(\"A13:C1370\")\nSet rng12 = Worksheets(\"ABCX Mfg Sub-Assy PVC\").Range(\"A13:C1370\")\n\n'---------------------------------------------------------\n\n   With Worksheets(\"Data\")\n      LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n      For i = 2 To LastRow\n\n        If .Cells(i, 6) = \"Mfg FG\" Then\n          With Worksheets(\"ABCX Mfg FG\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng1.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg RAW\" Then\n          With Worksheets(\"ABCX Mfg RAW\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng2.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg Sub-Assy\" Then\n          With Worksheets(\"ABCX Mfg Sub-Assy\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng3.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Resale\" Then\n          With Worksheets(\"ABCX Resale\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng4.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Conv Resale\" Then\n          With Worksheets(\"ABCX Conv Resale\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng5.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg FG PE\" Then\n          With Worksheets(\"ABCX Mfg FG PE\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng6.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg Sub-Assy PE\" Then\n          With Worksheets(\"ABCX Mfg Sub-Assy PE\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng7.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Acrylics\" Then\n          With Worksheets(\"ABCX Acrylics\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng8.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg Raw PE\" Then\n          With Worksheets(\"ABCX Mfg Raw PE\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng9.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n        If .Cells(i, 6) = \"Mfg FG PVC\" Then\n          With Worksheets(\"ABCX Mfg FG PVC\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng10.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n\n                If .Cells(i, 6) = \"Mfg Raw PVC\" Then\n          With Worksheets(\"ABCX Mfg Raw PVC\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng11.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n               If .Cells(i, 6) = \"Mfg Sub-Assy PVC\" Then\n          With Worksheets(\"ABCX Mfg Sub-Assy PVC\")\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = _\n               Worksheets(\"Data\").Cells(i, 1).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1) = _\n               Worksheets(\"Data\").Cells(i, 8).Value\n\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 2) = _\n               Worksheets(\"Data\").Cells(i, 9).Value\n\n            rng12.RemoveDuplicates Columns:=Array(1, 2, 3)\n\n          End With\n        End If\n\n       Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping", "internet-explorer-11"], "comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1565170155, "post_id": 57390821, "comment_id": 101264543, "body": "Try to replace the last line of code with this and check whether it helps to set the value or not.  doc.getElementById(\u201cTransactionID\u201d).value=&quot;test&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565226444, "post_id": 57397740, "comment_id": 101289412, "body": "Thanks for the prompt reply. I have changed to  doc.getElementsByName(&quot;$PAcqCaseCreation$pTransactionID&quot;)(0)&zwnj;&#8203;.setAttribute &quot;value&quot;, &quot;test&quot; as recommended but I am still getting the same error message."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565243575, "post_id": 57397740, "comment_id": 101292869, "body": "Could this be because my update is on new window and it makes some difference in the scripting?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565243674, "post_id": 57397740, "comment_id": 101292914, "body": "Possibly. Try the id version"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565246598, "post_id": 57397740, "comment_id": 101294081, "body": "Would you be able to provide me the script as I am pretty new in this? I have been searching high &amp; low for the appropriate codes but nothing worked. Just to be cleared I am to update the field which is on a new section on the right hand side of the same page after I clicked on CreateAcqCase."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565249316, "post_id": 57397740, "comment_id": 101295355, "body": "You need proper page load waits While ie.Busy Or ie.ReadyState &lt;&gt; 4:DoEvents:Wend  That should appear after .Navigate and after you click on the CresteAcqCase then doc.getElementId(&quot;TransactionID&quot;).setAttribute &quot;value&quot;, &quot;test&quot;  or doc.getElementId(&quot;TransactionID&quot;).value = &quot;Test&quot;"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565251894, "post_id": 57397740, "comment_id": 101296607, "body": "It doesn&#39;t work. It still gave me the same error message."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565253955, "post_id": 57397740, "comment_id": 101297677, "body": "Run-Time error &#39;438&#39;: object doesn&#39;t support this property or method"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1565258427, "post_id": 57397740, "comment_id": 101300238, "body": "You said in your comment,&#39;Could this be because my update is on new window&#39;. Do you mean clicking a button opens a new window or new tab? If yes than you may need to loop through IE windows and create and assign that window to IE object. than you can try to set the value for that input."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565345425, "post_id": 57397740, "comment_id": 101333780, "body": "After selecting the CreateAcqCase button it did open up a new tab. Would you be able to provide me the script to loop through the tab?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565345595, "post_id": 57397740, "comment_id": 101333860, "body": "I\u2019m still confused by your error given it\u2019s not about object not found"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565347111, "post_id": 57397740, "comment_id": 101334548, "body": "I am getting the error (Object doesn&#39;t support this property or method) when I used the script you suggested. I am not sure is this due to the new tab open after CreateAcqCase button selected? Hope you advice."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1565603582, "post_id": 57397740, "comment_id": 101391463, "body": "@user9750397, Try to refer this example may help you to loop through IE tabs. you can try to find specific tab using it&#39;s title. Ref: <a href=\"https://textuploader.com/11gvi\" rel=\"nofollow noreferrer\">textuploader.com/11gvi</a> Further you can try to modify it as per your own requirement and try to implement it in your code."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1565243654, "last_edit_date": 1565243654, "creation_date": 1565191477, "answer_id": 57397740, "question_id": 57390821, "link": "https://stackoverflow.com/questions/57390821/prompted-with-object-doesnt-support-his-property-or-method/57397740#57397740", "title": "Prompted with Object doesn&#39;t support his property or method", "body": "<p>1) You have a mistake here:</p>\n\n<pre><code>doc.getElementByName(\u201cTransactionID\u201d).setAttribute(\u201cvalue\u201d, \u201ctest\u201d)\n</code></pre>\n\n<p>The method is <code>getElementsByName</code> , notice the <code>s</code> indicating plural - a collection is returned. As it is a collection, you will need to supply an appropriate index to target the element of interest.</p>\n\n<p>2) Also, you have introduced smart \u201c where you want \".</p>\n\n<p>3) Neither <code>call</code> keyword, nor parantheses are needed.</p>\n\n<p>4) The <code>name</code> attribute is:</p>\n\n<pre><code>name=\"$PAcqCaseCreation$pTransactionID\" \n</code></pre>\n\n<p>Whereas the <code>id</code> attribute is:</p>\n\n<pre><code>id=\"TransactionID\"\n</code></pre>\n\n<p><code>id</code> is likely unique and a better selector (and is singular, so no <code>s</code> or index):</p>\n\n<pre><code>doc.getElementId(\"TransactionID\").setAttribute \"value\", \"test\"\n</code></pre>\n\n<p>Otherwise,</p>\n\n<pre><code>doc.getElementsByName(\"$PAcqCaseCreation$pTransactionID\")(0).setAttribute \"value\", \"test\" \n</code></pre>\n\n<p>This would be assuming first element in collection is the correct; otherwise, change the index.</p>\n\n<p>5) You can replace all this (and remove the associated declarations):</p>\n\n<pre><code>Set the_button_elements = doc.getElementsByTagName(\"button\")\nFor Each button_element In the_button_elements\n    If button_element.getAttribute(\"onclick\") = \"CreateAcqCase();\" Then\n        button_element.Click\n        Exit For\n    End If\nNext button_element\n</code></pre>\n\n<p>With one line:</p>\n\n<pre><code>doc.querySelector(\"[onclick='CreateAcqCase();']\").Click\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565243654, "creation_date": 1565168963, "last_edit_date": 1565191683, "question_id": 57390821, "link": "https://stackoverflow.com/questions/57390821/prompted-with-object-doesnt-support-his-property-or-method", "title": "Prompted with Object doesn&#39;t support his property or method", "body": "<p>I am trying to update the 1 of the field on the right section after selecting 1 of the button on left section but was prompted with the run-time error 438 code. </p>\n\n<p>I have tried changing the element and attribution of the last row of my code but nothing seems to work.</p>\n\n<p>Below is part of my VBA script:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub BrowseToWebTest1()\n\nDim ie As Object\nDim the_button_elements As Object\nDim button_element As Object\nDim radioButton As Object\nDim radioButtons As Object\nDim doc As HTMLDocument\nSet ie = New InternetExplorerMedium\n\nie.navigate \"company system web\"\nie.Visible = True\n\nWhile ie.Busy\nDoEvents\nWend\n\nSet doc = ie.document\n\nSet the_button_elements = doc.getElementsByTagName(\"button\")\nFor Each button_element In the_button_elements\n    If button_element.getAttribute(\"onclick\") = \"CreateAcqCase();\" Then\n        button_element.Click\n        Exit For\n    End If\nNext button_element\n\nCall doc.getElementByName(\u201cTransactionID\u201d).setAttribute(\u201cvalue\u201d, \u201ctest\u201d)\n</code></pre>\n\n<p>Below is the DOM Explorer code:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;input name=\"$PAcqCaseCreation$pTransactionID\" class=\"leftJustifyStyle\" id=\"TransactionID\" style=\"width: 175px;\" type=\"text\" maxlength=\"15\" value=\"\" data-ctl='[\"TextInput\"]' minchars=\"15\" validationtype=\"minchars\" data-changed=\"false\"&gt;\n</code></pre>\n\n<p>Hopefully someone call help so that i can update fields accordingly. By the way I am using IE11 and Window 10</p>\n"}, {"tags": ["vba", "selenium", "web-scraping", "selenium-chromedriver"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1565174401, "creation_date": 1565174401, "answer_id": 57392519, "question_id": 57390794, "link": "https://stackoverflow.com/questions/57390794/cant-set-chrome-preferences-in-vba-selenium/57392519#57392519", "title": "Can&#39;t set chrome preferences in vba selenium", "body": "<p>You could always try running it headless? That should remove any delay associated with image loading.</p>\n\n<pre><code>driver.AddArgument \"--headless\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1565468303, "last_edit_date": 1565468303, "creation_date": 1565467948, "answer_id": 57445385, "question_id": 57390794, "link": "https://stackoverflow.com/questions/57390794/cant-set-chrome-preferences-in-vba-selenium/57445385#57445385", "title": "Can&#39;t set chrome preferences in vba selenium", "body": "<p>To disable images from that page, this is how you can set the preference within vba selenium bindings:</p>\n\n<pre><code>driver.SetPreference \"profile.managed_default_content_settings.images\", 2\n</code></pre>\n\n<p>Your script looks like the following when you implement the above suggestion:</p>\n\n<pre><code>Sub TestSelenium()\n    Const URL$ = \"https://www.marketscreener.com/\"\n    Dim driver As Object, post As Object\n    Set driver = New ChromeDriver\n\n    driver.SetPreference \"profile.managed_default_content_settings.images\", 2\n    driver.get URL\n    Set post = driver.FindElementByCss(\".une_title\")\n    MsgBox post.Text\n    Stop\n    driver.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1565468303, "creation_date": 1565168895, "question_id": 57390794, "link": "https://stackoverflow.com/questions/57390794/cant-set-chrome-preferences-in-vba-selenium", "title": "Can&#39;t set chrome preferences in vba selenium", "body": "<p>I've created a script in vba in combination with selenium to parse the first headline from <a href=\"https://www.marketscreener.com/\" rel=\"nofollow noreferrer\">this webpage</a>. Most of the times my script throws this error <code>timeout</code> or this error <code>Run-time error 21; Application defined or Object defined error</code> while sometimes it works flawlessly. As the page takes too much time to load it's content, I suppose I'm having one of the side effect of a slow loading page, so I wish to disable images from that page.</p>\n\n<p>I've tried with:</p>\n\n<pre><code>Sub TestSelenium()\n    Const URL$ = \"https://www.marketscreener.com/\"\n    Dim driver As Object, post As Object\n    Set driver = New ChromeDriver\n\n    driver.get URL\n    Set post = driver.FindElementByCss(\".une_title\")\n    MsgBox post.Text\n    driver.Quit\nEnd Sub\n</code></pre>\n\n<p>When I go for python selenium binding, I can use this option to disable images:</p>\n\n<pre><code>option = webdriver.ChromeOptions()\nchrome_prefs = {}\noption.experimental_options[\"prefs\"] = chrome_prefs\nchrome_prefs[\"profile.default_content_settings\"] = {\"images\": 2}\nchrome_prefs[\"profile.managed_default_content_settings\"] = {\"images\": 2}\n\ndriver = webdriver.Chrome(options=option)\n</code></pre>\n\n<p>I know there are options to set different preferences in vba but in case of disabling images I can't find any proper way to set them:</p>\n\n<pre><code>driver.SetPreference\ndriver.AddArgument\n</code></pre>\n\n<p><strong><em>How can I set chrome preferences in vba selenium to let the page load quickly without images?</em></strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1565167087, "post_id": 57390076, "comment_id": 101262822, "body": "Reason for your counter not being incremented is because you haven&#39;t specifically increment your counter. You will need a line like: <code>Row = Row + 1</code>. Also, I would strongly recommend not to use excel reserved words as your vairbales (i.e. <code>Row</code>). Using them can cause errors which at times are very difficult to track"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1565167109, "post_id": 57390076, "comment_id": 101262840, "body": "Note that <code>Check &lt;&gt; &quot; &quot;</code> doesn&#39;t test for an empty cell but for a space character in a cell! If you want to check for an empty string you must use <code>Check &lt;&gt; &quot;&quot;</code> or <code>Check &lt;&gt; vbNullString</code>. Also in the first run of the loop <code>Check</code> is not initialized yet (undeclared empty variable). So the code you show should never run the loop at all."}, {"owner": {"reputation": 3, "user_id": 11894283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c03396a2c76a079e433cb7a537a8b?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Jordan", "link": "https://stackoverflow.com/users/11894283/luca-jordan"}, "edited": false, "score": 0, "creation_date": 1565167683, "post_id": 57390076, "comment_id": 101263183, "body": "This is great! I have changed Row to curRow to avoid errors and included &quot;curRow = curRow + 1&quot; and this integer now increases. Thank you for your help"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11894283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c03396a2c76a079e433cb7a537a8b?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Jordan", "link": "https://stackoverflow.com/users/11894283/luca-jordan"}, "edited": false, "score": 0, "creation_date": 1565167385, "post_id": 57390184, "comment_id": 101263003, "body": "Is this able to work in newly generated sheets? I probably should have said but forgot, but the importing code I have generates a new sheet based on how many files are in a selected folder. (I would post that code but it is un-formatted and basically illegible right now) Is there anyway I could (vba or otherwise) get this formula onto the brand new sheet automatically?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 11894283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c03396a2c76a079e433cb7a537a8b?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Jordan", "link": "https://stackoverflow.com/users/11894283/luca-jordan"}, "edited": false, "score": 1, "creation_date": 1565167489, "post_id": 57390184, "comment_id": 101263078, "body": "@LucaJordan You can write a formula to a range like <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;B1:B10&quot;).Formula = &quot;=TRIM(LEFT(A:A,FIND(&quot;&quot;=&gt;&quot;&quot;,A:A)-1))&quot;</code>. Note that quotes in the formula itself need to be doubled."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565168459, "post_id": 57390184, "comment_id": 101263617, "body": "This is a much better solution than using VBA"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 3, "last_activity_date": 1565166884, "creation_date": 1565166884, "answer_id": 57390184, "question_id": 57390076, "link": "https://stackoverflow.com/questions/57390076/how-to-advance-a-loop-to-select-and-copy-data-from-column-a/57390184#57390184", "title": "How to advance a loop to select and copy data from column A?", "body": "<p>You can do that with a simple formula. No need for VBA here:</p>\n\n<ul>\n<li><p>Column B (Attribute):<br>\n<code>=TRIM(LEFT(A:A,FIND(\"=&gt;\",A:A)-1))</code></p></li>\n<li><p>Column C (Value):<br>\n<code>=TRIM(RIGHT(A:A,LEN(A:A)-FIND(\"=&gt;\",A:A)-1))</code></p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/T6Dai.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T6Dai.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1565167711, "post_id": 57390375, "comment_id": 101263205, "body": "Note you should check <code>If UBound(ValueArray) &gt; 0</code> before using <code>ValueArray(1)</code> or it will fail on cells that do not contain <code>=&gt;</code>."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "reply_to_user": {"reputation": 3, "user_id": 11894283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c03396a2c76a079e433cb7a537a8b?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Jordan", "link": "https://stackoverflow.com/users/11894283/luca-jordan"}, "edited": false, "score": 0, "creation_date": 1565167951, "post_id": 57390375, "comment_id": 101263334, "body": "No problem at all @LucaJordan. Feel free to upvote all useful answers and accept the correct answer. See <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1565168618, "post_id": 57390375, "comment_id": 101263698, "body": "Would be a good idea to replace <code>ActiveSheet</code> with a fully qualified sheet as activesheet might not always be the sheet you wan to work with"}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": true, "score": 1, "last_activity_date": 1565167838, "last_edit_date": 1565167838, "creation_date": 1565167530, "answer_id": 57390375, "question_id": 57390076, "link": "https://stackoverflow.com/questions/57390076/how-to-advance-a-loop-to-select-and-copy-data-from-column-a/57390375#57390375", "title": "How to advance a loop to select and copy data from column A?", "body": "<p>Adjusted VBA code:</p>\n\n<ul>\n<li>added <code>Len(raw)</code> check instead of <code>Check &lt;&gt; \" \"</code></li>\n<li>added <code>lngCount</code> which will increase by 1 with every successful loop</li>\n</ul>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim raw As String 'Raw imported data\n    Dim ValueArray() As String 'Array for attributes and values\n    Dim lngCount As Long\n\n    With ActiveSheet\n        raw = .Cells(1, 1).Value\n        Do While Len(raw)\n            ValueArray = Split(raw, \"=&gt;\")\n            If UBound(ValueArray) &gt; 0 Then\n                .Cells(1 + lngCount, 2).Value = ValueArray(0)\n                .Cells(1 + lngCount, 3).Value = ValueArray(1)\n            End If\n            lngCount = lngCount + 1\n            raw = .Cells(1, 1).Offset(lngCount, 0).Value\n        Loop 'Continue the loop\n    End With\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zjaH7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zjaH7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1565167731, "creation_date": 1565167731, "answer_id": 57390441, "question_id": 57390076, "link": "https://stackoverflow.com/questions/57390076/how-to-advance-a-loop-to-select-and-copy-data-from-column-a/57390441#57390441", "title": "How to advance a loop to select and copy data from column A?", "body": "<p>If you want to use <code>VBA</code> to do this you might find it easier using a <code>For</code> Loop and a single <code>Index</code> for all of your columns</p>\n\n<pre><code>Dim RowIndex As Long ' Row value used only in the check\nDim RowCount As Long\nDim raw As String ' Raw imported data\nDim ValueArray() As String ' Array for attributes and values\n\nWith ActiveSheet\n    RowCount = Cells(Rows.Count, 1).End(xlUp).Row ' Get last row in Column A\n\n    For RowIndex = 1 To RowCount\n        raw = Cells(RowIndex, 1).Value2 ' The raw data is the row + 1 of A column\n        ValueArray = Split(raw, \"=&gt;\")\n        .Cells(RowIndex, 2).Value2 = WorksheetFunction.Trim(ValueArray(0)) ' The value of the next row\n                                                                           ' in the B column is the\n                                                                           ' first value in the array\n        .Cells(RowIndex, 3).Value = WorksheetFunction.Trim(ValueArray(1)) ' The value of the next row\n                                                                          ' in the C column is the\n                                                                          ' second value in the array\n    Next RowIndex\nEnd With\n</code></pre>\n\n<p>I've also used <code>Worksheetfunction.Trim</code> to remove and leading or trailing whitespace and any double spacing in the string</p>\n"}], "owner": {"reputation": 3, "user_id": 11894283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c03396a2c76a079e433cb7a537a8b?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Jordan", "link": "https://stackoverflow.com/users/11894283/luca-jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 57390375, "answer_count": 3, "score": 0, "last_activity_date": 1570150031, "creation_date": 1565166508, "last_edit_date": 1570150031, "question_id": 57390076, "link": "https://stackoverflow.com/questions/57390076/how-to-advance-a-loop-to-select-and-copy-data-from-column-a", "title": "How to advance a loop to select and copy data from column A?", "body": "<p>I want to split raw data in column A into two strings then copy the first string into column B and the second into C, move to the next row down of A and repeat.</p>\n\n<p>I'm trying to advance the loop to the next row using several integers (Row, Check, x and y) but they do not increase past 0.</p>\n\n<p>I have tried adding to the integers in their own dedicated lines (basically trying to get a line that is \"Row + 1\").</p>\n\n<pre><code>Dim x As Integer 'Row value\nDim y As Integer 'Column Value\nDim Row As Integer 'Row value used only in the check\nDim raw As String 'Raw imported data\nDim ValueArray() As String 'Array for attributes and values\n\nDo While Check &lt;&gt; \" \" 'While the Check value isn't nothing,\n    Check = Cells(Row + 1, 1) 'Check for data in the current row of the A column\n    raw = Cells(x + 1, 1).Value 'The raw data is the row + 1 of A column\n    ValueArray = Split(raw, \"=&gt;\") 'Spilt the raw into an attribute and a value \n                                  'then save in an array\n    ActiveSheet.Cells(y + 1, 2).Value = ValueArray(0) 'The value of the next row \n                                                      'in the B column is the \n                                                      'first value in the array\n    ActiveSheet.Cells(y + 1, 3).Value = ValueArray(1) 'The value of the next row \n                                                      'in the C column is the \n                                                      'second value in the array\nLoop 'Continue the loop\n</code></pre>\n\n<p>There would be a value like <strong>Contact => John Smith</strong> and the code is supposed to separate the attribute (First part) from the value (Second part). The attribute is supposed to be placed in column B and the value in C.</p>\n\n<p>The loop is then supposed to start again but now that the integers have all increased by 1, it should process the next row in column A. It instead loops continuously through the first row and crashes Excel.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "edited": false, "score": 0, "creation_date": 1565167739, "post_id": 57390056, "comment_id": 101263218, "body": "is it possible to provide some dummy data on which you are trying to run this code?"}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "reply_to_user": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "edited": false, "score": 0, "creation_date": 1565168029, "post_id": 57390056, "comment_id": 101263376, "body": "i am afraid, i cant due to limited and restricted access but the size of Row file is around 30 MB and data range in the sheet is A1:BG1018576 if this will help you"}, {"owner": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "edited": false, "score": 0, "creation_date": 1565168706, "post_id": 57390056, "comment_id": 101263754, "body": "Instead of copy paste can you not delete the in the same sheet and rename the sheet. it will save effort of code to copy a single column and paste another sheet then again go back to that sheet and continue. Or you can use MyCopyRange = Array(&quot;AC7:AC&quot; &amp; LR, &quot;D7:DC&quot; &amp; LR, &quot;I7:IC&quot; &amp; LR, &quot;K7:K&quot; &amp; LR, &quot;T7:TC&quot; &amp; LR) &#39;Put ranges in an array     MyPasteRange = Array(&quot;C17&quot;, &quot;D17&quot;, &quot;E17&quot;, &quot;F17&quot;, &quot;G17&quot;)"}, {"owner": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "edited": false, "score": 0, "creation_date": 1565168734, "post_id": 57390056, "comment_id": 101263771, "body": "<a href=\"https://stackoverflow.com/a/31063506/7836662\">stackoverflow.com/a/31063506/7836662</a>"}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "reply_to_user": {"reputation": 61, "user_id": 7836662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Opl-2ERtWZk/AAAAAAAAAAI/AAAAAAAACS8/u8BbyhdJA18/photo.jpg?sz=128", "display_name": "Prakhar Srivastava", "link": "https://stackoverflow.com/users/7836662/prakhar-srivastava"}, "edited": false, "score": 0, "creation_date": 1565168965, "post_id": 57390056, "comment_id": 101263886, "body": "Cool i will try, thank you for the suggestion :)"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1565169808, "post_id": 57390056, "comment_id": 101264333, "body": "I&#39;d also consider using <code>Application.Calculation = xlCalculationManual</code> at the beginning of your code in order to turn off Excel calculations (these are now triggered every time you copy/paste data, apply filters and delete rows). You can then turn it back on with <code>Application.Calculation = xlCalculationAutomatic</code> at the end of your code."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "is_accepted": false, "score": 2, "last_activity_date": 1565212208, "creation_date": 1565212208, "answer_id": 57402323, "question_id": 57390056, "link": "https://stackoverflow.com/questions/57390056/macro-is-running-very-slow-as-source-file-is-too-large/57402323#57402323", "title": "Macro is running very slow as source file is too large", "body": "<p>One thing that I always to do reduce the speed of my macro is change the file extension to a binary file. You can still have macros, and it cuts the file size in half.</p>\n\n<p>At the beginning of my code, I always have:</p>\n\n<pre><code>Sub GettingStarted()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\nEnd Sub\n</code></pre>\n\n<p>At the end of my code, I always have:</p>\n\n<pre><code>Sub BackToNormal()\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>If you do not need your code to do calculations while it is running, you can also include </p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>And when you are finished, be sure to change it back to</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565212208, "creation_date": 1565166431, "last_edit_date": 1565175534, "question_id": 57390056, "link": "https://stackoverflow.com/questions/57390056/macro-is-running-very-slow-as-source-file-is-too-large", "title": "Macro is running very slow as source file is too large", "body": "<p>I have below code which helps me to open file copy data from that file to current workbook. it also filter the data and delete unwanted row. The problem is that source file is too large size of file is up to 30MB it contain data in range of A1:BG1018576</p>\n\n<p>Once file is open the job is to copy specific column and past it also it will filter the data and delete unwanted row. </p>\n\n<pre><code>Sub Position()\n    Dim b1 As Workbook, b2 As Workbook\n    Dim ws As Worksheet\n    Dim src As Worksheet\n    Dim trg As Worksheet\n    Dim Fname As String\n    Dim LR As Long\n    Dim LR1 As Long\n\n    Set b1 = ThisWorkbook \n    Fname = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xls*), *.xls*\", Title:=\"Select a File\")\n\n    If Fname = \"False\" Then Exit Sub\n\n    Set b2 = Workbooks.Open(Fname)\n    Set b2 = ActiveWorkbook\n\n    For Each ws In b2.Sheets\n        If ws.Visible Then\n            ws.Copy after:=b1.Sheets(b1.Sheets.Count)\n        End If\n    Next ws\n\n    b2.Close\n\n    Set src = ThisWorkbook.Worksheets(\"CR\")\n    Set trg = ThisWorkbook.Worksheets(\"Data\")\n    src.Range(\"B:B\").Copy Destination:=trg.Range(\"E1\")\n    src.Range(\"G:G\").Copy Destination:=trg.Range(\"D1\")\n    src.Range(\"T:T\").Copy Destination:=trg.Range(\"F1\")\n    src.Range(\"BB:BB\").Copy Destination:=trg.Range(\"G1\")\n    src.Range(\"BG:BG\").Copy Destination:=trg.Range(\"H1\")        \n    src.Range(\"D:D\").Copy Destination:=trg.Range(\"I1\")        \n    src.Range(\"F:F\").Copy Destination:=trg.Range(\"J1\")                \n    src.Delete\n\n    With Worksheets(\"Data\") '&lt;--| always specify full worksheet reference (change \"MyWantedSheet\" with your actual sheet name)\n        With .Columns(\"D:D\") '.Resize(.Cells(.Rows.Count, \"B\").End(xlUp).Row) '&lt;--| refer to wanted column range down to its last non empty cell\n            .AutoFilter '&lt;--| remove possible preeeding autofilter filtering\n            .AutoFilter Field:=1, Criteria1:=\"=\" '&lt;--| apply current filtering\n                .Resize(.Parent.Cells(.Parent.Rows.Count, \"E\").End(xlUp).Row - 1).Offset(1).SpecialCells(xlCellTypeVisible).Rows.Delete '&lt;--|delete visible rows other than the first (\"headers\") one\n        End With\n        .AutoFilterMode = False '&lt;--| remove drop-down arrows\n    End With\n\n    With Worksheets(\"Data\") '&lt;--| always specify full worksheet reference (change \"MyWantedSheet\" with your actual sheet name)\n        With .Columns(\"H:H\") '.Resize(.Cells(.Rows.Count, \"B\").End(xlUp).Row) '&lt;--| refer to wanted column range down to its last non empty cell\n            .AutoFilter '&lt;--| remove possible preeeding autofilter filtering\n            .AutoFilter Field:=1, Criteria1:=\"N\" '&lt;--| apply current filtering\n                .Resize(.Parent.Cells(.Parent.Rows.Count, \"E\").End(xlUp).Row - 1).Offset(1).SpecialCells(xlCellTypeVisible).Rows.Delete '&lt;--|delete visible rows other than the first (\"headers\") one\n        End With\n        .AutoFilterMode = False '&lt;--| remove drop-down arrows\n    End With\n\n    Sheets(\"Data\").Select\n    Sheets(\"DATA\").Range(\"G1:G\" &amp; Sheets(\"DATA\").UsedRange.Rows.Count).Select\n    Selection.Replace What:=\"-\", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nEnd sub \n</code></pre>\n\n<p>it is taking too much time to process the data, is there any other method to make this process faster</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1565165375, "post_id": 57389685, "comment_id": 101261957, "body": "I assume the additional <code>.</code> after <code>Range</code> and befor <code>(&quot;A:E&quot;)</code> is a typo, right?"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1565166132, "post_id": 57389685, "comment_id": 101262331, "body": "yes, the code was on a non-accessible machine so I copied it manually. sorry"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1565166251, "post_id": 57389685, "comment_id": 101262397, "body": "You will have to provide bit more of your code. Maybe the above line is not executing on your machine because it&#39;s wrapped round some logic.. which would be more of a logical issue. As @Storax pointed, that code will throw the error you have shown"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1565167014, "post_id": 57389685, "comment_id": 101262786, "body": "This error may happen if you have a protected sheet."}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1565177363, "post_id": 57389685, "comment_id": 101268519, "body": "I am sure the code ran, &#39;cause it is triggered by the pression of a button. Effectively the sheet is protected: how that can trigger the error?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1565178506, "post_id": 57389685, "comment_id": 101269185, "body": "FunThomas is right, The line <code>Worksheets(&quot;home&quot;).Range(&quot;A:E&quot;).NumberFormat = &quot;@&quot;</code> will just trigger the error above."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565180895, "post_id": 57389685, "comment_id": 101270500, "body": "@AndreaGiordano Did you even try this <a href=\"https://stackoverflow.com/a/57390969/11167163\">Answer</a> ? It might Answer to your question : Effectively the sheet is protected: how that can trigger the error? . If the Sheet Is protected and you want to format Cell you must Allow it.. So please have a look to my <a href=\"https://stackoverflow.com/a/57390969/11167163\">Answer</a>. If this doesn&#39;t help please give some feedbacks so I can <b>Improve</b> My Answer.."}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565181124, "post_id": 57389685, "comment_id": 101270634, "body": "@Dorian I am testing, It is not easy to find people that allow to test your work on their pc."}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1565181181, "post_id": 57389685, "comment_id": 101270675, "body": "I am puzzled because at the workbook_open I have explicitily set the protection on UserInterfaceOnly:=True"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565181468, "post_id": 57389685, "comment_id": 101270805, "body": "@AndreaGiordano UserInterfaceOnly = true <b>Only</b> allow macro to run it does not allow sheet to be modified..."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1565181582, "post_id": 57389685, "comment_id": 101270877, "body": "@AndreaGiordano Please have a look to The <b>Edit</b> Of my answer I tried to explain what exactly does UserinterfaceOnly, Hope it helps"}], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565181525, "creation_date": 1565165108, "last_edit_date": 1565166142, "question_id": 57389685, "link": "https://stackoverflow.com/questions/57389685/fully-working-vba-doesnt-run-on-other-machines", "title": "fully working vba doesn&#39;t run on other machines", "body": "<p>I developed some vba codes that nicely work on my machine (win7, excel2010-32bit). I tested the same workbook on other machines to ensure compatibility and <strong>sometimes</strong> on machine that match or doesn't my configuration, some functions seems to fail. Even in those case, sometimes a simple restart of the workbook seems to solve the issue.</p>\n\n<p>One of the guilty functions is, as instance:</p>\n\n<pre><code>Worksheets(\"home\").Range(\"A:E\").NumberFormat = \"@\"\n</code></pre>\n\n<p>That raises the error:</p>\n\n<blockquote>\n  <p>unable to set the NumberFormat Property of the Range class: 1004.</p>\n</blockquote>\n\n<p>I am struggling with this hardly replicable issue and I don't know how to handle it, since I don't understand the source of the problem.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565165440, "post_id": 57389646, "comment_id": 101261992, "body": "what would be the reason to not accepting value? it&#39;s a simple text type field."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565165644, "post_id": 57389646, "comment_id": 101262082, "body": "Can&#39;t tell. Perhaps the form as such is read-only. Try from the immediate window: <code>Forms!TenantAssign![Tenant].Value = &quot;Test&quot;</code>."}, {"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565166141, "post_id": 57389646, "comment_id": 101262337, "body": "I tried from the immediate window, the same thing here"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565167581, "post_id": 57389646, "comment_id": 101263127, "body": "OK. Then, for sure, the issue is not related to your code but to the form <i>TenantAssign</i>."}, {"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565186456, "post_id": 57389646, "comment_id": 101274103, "body": "Yes, I&#39;m sure also but it&#39;s a simple form, I checked out that not read-only. Then what else!!??"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1565187507, "post_id": 57389646, "comment_id": 101274772, "body": "Create a new form - as simple as possible - bound to the same table. It should work with your code line (tested here). If so, study the differences between the old form and the test, or simply recreate the old form step by step until failure."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1565164960, "creation_date": 1565164960, "answer_id": 57389646, "question_id": 57389285, "link": "https://stackoverflow.com/questions/57389285/runtime-error-3032-cannot-perform-this-operation-ms-access/57389646#57389646", "title": "Runtime error 3032, cannot perform this operation ms-access", "body": "<p>This indicates, that the field bound to <code>Forms!TenantAssign![Tenant]</code> cannot accept the <em>value</em> or <em>type</em> of <code>sTemp</code>.</p>\n\n<p>Also note, that when you have corrected this and the code will run without an error, <code>Forms!TenantAssign</code> will be left <em>Dirty</em>.</p>\n"}], "owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565164960, "creation_date": 1565163651, "last_edit_date": 1565163687, "question_id": 57389285, "link": "https://stackoverflow.com/questions/57389285/runtime-error-3032-cannot-perform-this-operation-ms-access", "title": "Runtime error 3032, cannot perform this operation ms-access", "body": "<p>Unable to set value <code>on unload</code> to other forms field. If the field is unbound then the value set properly and when I set the filed control property in the form for the specific field then <code>unload</code> event unable to set value in the other form field says </p>\n\n<blockquote>\n  <p>error 3032, cannot perform this operation.</p>\n</blockquote>\n\n<p><code>unload</code> event code below:</p>\n\n<pre><code>Dim oItem As Variant\nDim sTemp As String\nDim iCount As Integer\n\niCount = 0\n\nIf Me![SelectTenant].ItemsSelected.Count &lt;&gt; 0 Then\n    For Each oItem In Me![SelectTenant].ItemsSelected\n        If iCount = 0 Then\n            sTemp = sTemp &amp; Me![SelectTenant].ItemData(oItem)\n            iCount = iCount + 1\n        Else\n            sTemp = sTemp &amp; mstrSep &amp; \" \" &amp; Me![SelectTenant].ItemData(oItem)\n            iCount = iCount + 1\n        End If\n    Next oItem\nElse\n    MsgBox \"Nothing was selected from the list\", vbInformation\n    Exit Sub  'Nothing was selected\nEnd If\n\nForms!TenantAssign![Tenant].Value = sTemp\nEnd Sub\n</code></pre>\n\n<p>Any help would much be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1565164722, "post_id": 57389006, "comment_id": 101261662, "body": "It might be possible but IMO not really recommendable, look <a href=\"https://stackoverflow.com/a/57226240/6600940\">here</a> resp. <a href=\"https://stackoverflow.com/questions/55990057/udf-how-to-turn-a-string-that-contains-a-path-workbook-name-worksheet-name-a/55993127#55993127\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1565164249, "post_id": 57389386, "comment_id": 101261476, "body": "But in this case no other range is changed. If I rework the formula to simply paste, instead of pastespecial it will paste the content of the matched cell, so that part works fine."}, {"owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1565164813, "post_id": 57389386, "comment_id": 101261701, "body": "I&#39;m not sure i understand what you mean, but i&#39;m fairly certain what you&#39;re trying to do isn&#39;t possible in an UDF. All it&#39;s meant to do is calculate some value for &quot;insertIMG&quot; and place that into the cell from which the UDF is called.In the article I shared Microsoft puts it like this: &quot; Functions can perform a calculation that returns either a value or text to the cell that they are entered in&quot;."}], "tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": false, "score": 0, "last_activity_date": 1565164250, "last_edit_date": 1565164250, "creation_date": 1565164000, "answer_id": 57389386, "question_id": 57389006, "link": "https://stackoverflow.com/questions/57389006/inserting-linked-image-by-udf/57389386#57389386", "title": "Inserting linked image by UDF", "body": "<p>You are missing some limitations to UDF's. \nThey cannot change any other range in Excel, only the cell from which they are called. Most methods also aren't available in UDF's.</p>\n\n<p>See the link below for the full Microsoft answer:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel</a></p>\n\n<p>What you could do is use your \"test\" sub, and use it in a Worksheet_Change event on the worksheet from which you wanted to call the function.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1565166200, "creation_date": 1565166200, "answer_id": 57389978, "question_id": 57389006, "link": "https://stackoverflow.com/questions/57389006/inserting-linked-image-by-udf/57389978#57389978", "title": "Inserting linked image by UDF", "body": "<p>Based on my comment you could try something like this</p>\n\n<pre><code>Option Explicit\n\nSub insertIMG(rng As String)\n    Dim rg As Range\n    Set rg = Range(rng)\n    Dim row As Integer\n    row = Application.WorksheetFunction.Match(rg.Value, Sheets(\"PIC\").Range(\"A1:A5\"), 0)\n    Sheets(\"PIC\").Range(\"B\" &amp; row).Copy\n    With Worksheets(\"Blad1\")\n       'adapt worksheet name as appropriate\n       .Pictures.Paste(Link:=True).Select\n    End With\n\nEnd Sub\n\n\nFunction callInsert(rng As Range)\n    Evaluate \"insertIMG( \" &amp; Chr(34) &amp; rng.Address &amp; Chr(34) &amp; \")\"\n    callInsert = \"x\"\nEnd Function\n</code></pre>\n\n<p>You can find more information at this <a href=\"https://wellsr.com/vba/2016/excel/how-to-change-another-cell-with-a-vba-function-udf/\" rel=\"nofollow noreferrer\">website</a></p>\n"}], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565166200, "creation_date": 1565162679, "last_edit_date": 1565163339, "question_id": 57389006, "link": "https://stackoverflow.com/questions/57389006/inserting-linked-image-by-udf", "title": "Inserting linked image by UDF", "body": "<p>In continuation of <a href=\"https://stackoverflow.com/questions/57370553\">this question</a> by <a href=\"https://stackoverflow.com/users/6285207\">Bluesector</a>:</p>\n\n<p>He was looking for a way to basicly do a <code>VLookup()</code> to place an image in a cell below. I was working on <a href=\"https://stackoverflow.com/a/57371110/1481116\">an answer</a> using a user defined function (UDF).</p>\n\n<p>I wrote the following function that:</p>\n\n<ul>\n<li>Takes a range as input variable. That Range should contain the value that is to be looked up. </li>\n<li>Finds a match on the worksheet <code>\"PIC\"</code> and copies that cell.</li>\n<li>Pastespecial a linked picture to the active cell (the cell it has been called from) </li>\n</ul>\n\n<p><br></p>\n\n<pre><code>Function insertIMG(ByVal rng As Range)\n    Dim row As Integer\n    row = Application.WorksheetFunction.Match(rng, Sheets(\"PIC\").Range(\"A1:A5\"), 0)\n    Sheets(\"PIC\").Range(\"B\" &amp; row).Copy\n    With Worksheets(\"Blad1\")\n       'adapt worksheet name as appropriate\n       .Pictures.Paste(Link:=True).Select\n    End With\n    insertIMG = \"\"\nEnd Function\n</code></pre>\n\n<p>Which results in a #Value error when inserted in a cell on a workbook.</p>\n\n<p>When I run this code from within a sub like so:</p>\n\n<pre><code>Sub test()\n    Application.Workbooks(\"Map2\").Worksheets(\"Blad1\").Range(\"D5\").Select\n    insertIMG (Application.Workbooks(\"Map2\").Worksheets(\"Blad1\").Range(\"D4\"))\n    'adapt workbook and worksheet name as appropriate\nEnd Sub\n</code></pre>\n\n<p>it works as expected. In this I explicitly select cell D5, as that would be where the function is called from, and would thus have the active selection when used in an UDF.</p>\n\n<p>Is there any limitation to the UDF's that I'm missing here?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 5, "user_id": 11893470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b19b6aa75018029d71b1801fa1bdb44?s=128&d=identicon&r=PG&f=1", "display_name": "O&#39;dallagher", "link": "https://stackoverflow.com/users/11893470/odallagher"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565156934, "post_id": 57387640, "comment_id": 101258437, "body": "I realized that I do not need to requery cb_capital when the code resets it to null."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1565162456, "post_id": 57387640, "comment_id": 101260633, "body": "Whenever you change RowSource, the control will requery, thus a separate Requery is not needed."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1565311511, "post_id": 57387640, "comment_id": 101323573, "body": "Why are contries and capitals not connect (each country has one capital)? A quiz?"}, {"owner": {"reputation": 5, "user_id": 11893470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b19b6aa75018029d71b1801fa1bdb44?s=128&d=identicon&r=PG&f=1", "display_name": "O&#39;dallagher", "link": "https://stackoverflow.com/users/11893470/odallagher"}, "edited": false, "score": 0, "creation_date": 1565927686, "post_id": 57387640, "comment_id": 101505057, "body": "It was just a test form that I demonstrated to my boss. I will add more controls to the actual form that I will demonstrate to the staff. Thank you, Unhandled Exception. The with end with statement is definitely useful in my actual form."}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1565306896, "post_id": 57388091, "comment_id": 101322761, "body": "<code>tbl_cap1</code>and<code>tbl_cap2</code>strongly indicates a wrong db model, you should mention that."}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 2, "last_activity_date": 1565262365, "last_edit_date": 1565262365, "creation_date": 1565158856, "answer_id": 57388091, "question_id": 57387640, "link": "https://stackoverflow.com/questions/57387640/possible-code-improvement-by-setting-integer-variables/57388091#57388091", "title": "Possible Code Improvement by Setting Integer Variables", "body": "<p>That's how I would do it, expecting the code is being executed in the form itself:</p>\n\n<pre><code>With Me.Controls(\"cb_capital\")\n    .Value = Null\n\n    Select Case Me.Controls(\"cb_country\").Value\n        Case \"China\", \"Japan\", \"Korea\":\n            .RowSource = \"tbl_cap1\"\n        Case \"Malaysia\", \"Philippines\", \"Thailand\":\n            .RowSource = \"tbl_cap2\"\n        Case Else\n            'Raise an error for example.\n    End Select\n\n    .Requery 'I also don't think that it is necessary.\nEnd With\n</code></pre>\n\n<p>Some explanations:</p>\n\n<ul>\n<li><p>Because the code runs in the form which holds the controls, we can use <code>Me</code> to reference it.</p></li>\n<li><p>It's not always necessary to use explicit variables, you can use references in expressions as shown.</p></li>\n<li><p>The <code>With</code> statement holds the reference to the control <code>cb_capital</code> and you can access it by <code>.</code> in the <code>With</code> block.</p></li>\n<li><p>As long as you work with literals (the country names), you can directly use them in a <code>Select Case</code> statement. Regarding to your used logic you also could omit <code>Case \"Malaysia\", \"Philippines\", \"Thailand\":</code> and use just <code>Case Else</code> instead, if you want.</p></li>\n<li><p>Your array definitions <code>n()</code> and <code>c()</code> were not used at all. You used undecladred variables (<code>n1</code>, <code>n2</code>, <code>c1</code> - <code>c6</code>) instead. You should use <code>Option Explicit</code> in your modules to avoid that.</p></li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 11893470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b19b6aa75018029d71b1801fa1bdb44?s=128&d=identicon&r=PG&f=1", "display_name": "O&#39;dallagher", "link": "https://stackoverflow.com/users/11893470/odallagher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1566281998, "accepted_answer_id": 57388091, "answer_count": 1, "score": -1, "last_activity_date": 1594550146, "creation_date": 1565156548, "last_edit_date": 1594550146, "question_id": 57387640, "link": "https://stackoverflow.com/questions/57387640/possible-code-improvement-by-setting-integer-variables", "closed_reason": "Not suitable for this site", "title": "Possible Code Improvement by Setting Integer Variables", "body": "<p>I have a test form with 2 bound combo boxes. I am testing the correct code to use so that the option selected on the first combo box affects the row source of the second combo box.</p>\n\n<p>Combo box 1 is name of country. I assigned the control name as <code>cb_country</code>. I have also created a table <code>tbl_country</code> as row source for <code>cb_country</code>. The options are <code>China</code>, <code>Japan</code>, <code>Korea</code>, <code>Malaysia</code>, <code>Philippines</code>, and <code>Thailand</code>.</p>\n\n<p>Combo box 2 is capital. I assigned the control name as <code>cb_capital</code>. I have created 2 different tables as possible row sources for <code>cb_capital</code> depending on which country was selected on <code>cb_country</code>.</p>\n\n<p>Capital table 1 or <code>tbl_cap1</code> lists <code>Beijing</code>, <code>Tokyo</code>, and <code>Seoul</code> while capital table 2 or <code>tbl_cap2</code> lists <code>Kuala Lumpur</code>, <code>Manila</code>, and <code>Bangkok</code>.</p>\n\n<p>I want the row source of <code>cb_capital</code> to be <code>tbl_cap1</code> whenever <code>China</code>, <code>Japan</code>, or <code>Korea</code> is selected and <code>tbl_cap2</code> whenever <code>Malaysia</code>, <code>Philippines</code>, or <code>Thailand</code> is selected.</p>\n\n<p>Below is the <code>After Update</code> event code for <code>cb_country</code>.</p>\n\n<pre><code>Dim frm As Form\nDim fname As String\nfname = \"frmgeo\"\nSet frm = Forms(fname)\n\nDim n() As String\nDim co As Control\nDim ca As Control\nn1 = \"cb_country\"\nn2 = \"cb_capital\"\nSet co = frm.Controls(n1)\nSet ca = frm.Controls(n2)\n\nDim c() As String\nc1 = \"China\"\nc2 = \"Japan\"\nc3 = \"Korea\"\nc4 = \"Malaysia\"\nc5 = \"Philippines\"\nc6 = \"Thailand\"\n\nIf co = c1 Or co = c2 Or co = c3 Then\n    ca = Null\n    ca.Requery\n    ca.RowSource = \"tbl_cap1\"\nElse\n    ca = Null\n    ca.Requery\n    ca.RowSource = \"tbl_cap2\"\nEnd If\n</code></pre>\n\n<p>The form is working fine as I expected it to be but is there anyway that the code can be improved? Perhaps declaring an integer variable and using for-next statement since I use integers on variable names on this case?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1565139108, "post_id": 57385594, "comment_id": 101255015, "body": "Those are API calls that need to be declared in order to work. <a href=\"https://bettersolutions.com/vba/macros/windows-api.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/macros/windows-api.htm</a>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1565139498, "post_id": 57385594, "comment_id": 101255064, "body": "You use them when you have to call the <code>DLL</code> procedure of Windows. Indicates that the procedure being called has another name in the DLL. This is useful when the external procedure name is the same as a keyword. You can also use Alias when a DLL procedure has the same name as a public variable, constant, or any other procedure in the same scope. Alias is also useful if any characters in the DLL procedure name aren&#39;t allowed by the DLL naming convention. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement\" rel=\"nofollow noreferrer\">Info</a>"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1565146398, "post_id": 57385594, "comment_id": 101256193, "body": "Those are Windows Application Programming Interface (Win API) where you can find the list <a href=\"https://docs.microsoft.com/en-us/windows/win32/apiindex/windows-api-list\" rel=\"nofollow noreferrer\">here</a>. In layman&#39;s term, those are sets of functions built-in to windows. It is simply describe <a href=\"https://stackoverflow.com/a/993478/2685412\">here</a>. How does it work? Simple, it is some sort of <i>default</i> instructions that <i>Windows</i> can understand. When properly declared and executed, <i>Windows</i> recognizes and interacts with the program or platform that calls it (in your case, VBA). Meaning not only VBA can use it."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1565146654, "post_id": 57385594, "comment_id": 101256236, "body": "If you want to know more about these <i>default</i> Win API&#39;s specific to <i>Window</i>, here&#39;s the <a href=\"https://docs.microsoft.com/en-us/windows/win32/winmsg/window-functions\" rel=\"nofollow noreferrer\">list</a>. It is in the same documentation I posted above, but points to the actual list of available window functions."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565147047, "post_id": 57385594, "comment_id": 101256292, "body": "To know how to construct the proper declaration, see @braX &#39;s comment."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1565147658, "post_id": 57385594, "comment_id": 101256373, "body": "If you love APIs then see this... From my <a href=\"http://allapi.mentalis.org/vbtutor/api1.shtml\" rel=\"nofollow noreferrer\">favorite site</a> of all times :)"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565148866, "post_id": 57385594, "comment_id": 101256559, "body": "@SiddharthRout That is my favorite too (although not secured, I wonder why that is). Even included in my browser&#39;s favorites. But if OP want&#39;s to understand how declarations are constructed and how to know the number of arguments, comments above got it covered :D."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1565148910, "post_id": 57385594, "comment_id": 101256568, "body": "@L42: I am sure :) I just shared an extra resource."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565169154, "post_id": 57385594, "comment_id": 101263990, "body": "@SiddharthRout and L42: never heard of this site before. I&#39;ve done fare bit of work with API&#39;s but never come across that site before.. will add it as reading/reference site in my vault :)"}], "owner": {"reputation": 127, "user_id": 11892293, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92zArqVCktE/AAAAAAAAAAI/AAAAAAAABI0/3h5rFe2sq_U/photo.jpg?sz=128", "display_name": "Ramneek Singh", "link": "https://stackoverflow.com/users/11892293/ramneek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565206200, "creation_date": 1565138425, "question_id": 57385594, "link": "https://stackoverflow.com/questions/57385594/trying-to-understand-this-vba-code-about-userforms", "title": "Trying to understand this VBA code about Userforms", "body": "<p>I wanted to make sense of this code I found online about VBA. I've been trying to push my Userform in front of all other apps, and apparently this code helps me do it.</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare Function BringWindowToTop Lib \"user32\" (ByVal Hwnd As Long) As Long\nDim Hwnd As Long\n\n\nPrivate Sub UserForm_Initialize()\n    Hwnd = FindWindow(\"ThunderDFrame\", Me.Caption)\n    BringWindowToTop (Hwnd)\nEnd Sub\n</code></pre>\n\n<p>I understand the second half pretty well; it's an initialization sub when the Userform starts up. However, what does \"Lib 'user32' Alias\" do? How does it know to find window?</p>\n\n<p>Thanks ahead for your help.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1565139679, "post_id": 57385378, "comment_id": 101255087, "body": "I can reproduce your problem. Did this exact formula ever work through VBA?  I&#39;m pretty certain that the 255 character limit relates to the number of characters if the formula was using <b>R1C1</b> notation. If you translate your formula, it then has 268 characters.  If I shorten it (and I did that by shortening the sheet names), so that it has less than 255 in R1C1 notation, then the VBA FormulaArray property works.  So you&#39;ll either have to shorten this further, or split it up as you did with the other."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565148843, "post_id": 57385378, "comment_id": 101256554, "body": "<a href=\"https://stackoverflow.com/questions/32495311/adjusting-the-formula-in-formulaarray/32495582#32495582\" title=\"adjusting the formula in formulaarray\">stackoverflow.com/questions/32495311/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1565149048, "post_id": 57385378, "comment_id": 101256591, "body": "The formula is on sheet &quot;BD MXN&quot; so you can remove that reference from the formula."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1565151601, "post_id": 57385378, "comment_id": 101257130, "body": "Further to what @TimWilliams mentioned, we can create named ranges as well for <code>$X$2:$X$50000</code>, <code>$Q$2:$Q$50000</code> etc"}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1565198002, "post_id": 57385378, "comment_id": 101280301, "body": "@RonRosenfeld I didn&#39;t know it had to be less than 255 chars with R1C1 notation. Now it works like a charm avoiding reference to the same sheet I&#39;m already refering to."}], "owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565136192, "creation_date": 1565136192, "question_id": 57385378, "link": "https://stackoverflow.com/questions/57385378/formulaarray-command-not-working-for-formula-with-less-than-255-characters", "title": "FormulaArray command not working for formula with less than 255 characters", "body": "<p>I already did a similar post with a <code>.FormulaArray</code> command which wasn't working and it turned out I had to replace the formula with some variable because it won't hold more than 255 characters.</p>\n\n<p>All of a sudden, formula doesn't work anymore, and I managed to reduce the length of original formula to 227 characters. I thought it would work fine but it doesn't neither with straight code nor replacement.</p>\n\n<p>The code I have is:</p>\n\n<pre><code>Sheets(\"BD MXN\").Range(\"R2:R\" &amp; last).FormulaArray = \"=SUM(--(FREQUENCY(IF(('BD MXN'!$X$2:$X$50000='Acum MXN'!Q2)*('BD MXN'!$Q$2:$Q$50000='Acum MXN'!O2)*('BD MXN'!$W$2:$W$50000='Acum MXN'!P2)*('BD MXN'!$O$2:$O$50000='Acum MXN'!A2),'BD MXN'!$A$2:$A$50000),'BD MXN'!$A$2:$A$50000)&gt;0))\"\n</code></pre>\n\n<p>What I do is to count unique results considering different criteria, formula works perfect if I copy it and paste it, then hitting Ctrl + Shift + Enter, however nothing would work on VBA code.</p>\n\n<p>Any workaround will be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1565134557, "post_id": 57385128, "comment_id": 101254276, "body": "you should use the User form <code>TextBox112</code> and <code>TextBox113</code> to do all your data validation, before copying that values to <code>sh</code> worksheet"}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1565134919, "post_id": 57385128, "comment_id": 101254326, "body": "I have code that formats the values in 112 and 113 as a number with two decimal places and allows negative numbers.  That only works if the User Form gets input.  If there is input it works just fine.  Without input the format is all wrong.  Thanks for the help!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1565135077, "post_id": 57385128, "comment_id": 101254353, "body": "So add another validation rule that makes sure there is an input"}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1565188759, "post_id": 57385128, "comment_id": 101275542, "body": "My users are not going to want to enter zeros into 30 or 40 fields that do not relate to their purpose."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1565205627, "post_id": 57385336, "comment_id": 101283649, "body": "Some of the textbox are supposed to be empty depending on the User.  Can code be added to what I posted to format when written to the file? Thanks for the help."}, {"owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "reply_to_user": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1565206635, "post_id": 57385336, "comment_id": 101284082, "body": "@Bzltyr, I don&#39;t exactly understand what you mean. Do you mean that some users cannot fill in certain textboxes because they don&#39;t have access? If that&#39;s the case, I still don&#39;t see why you can&#39;t use an <code>If</code> statement"}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1565214743, "post_id": 57385336, "comment_id": 101286968, "body": "Thanks for looking into this for me.  On the user form there are two place to enter a dollar value. If one has a value but the other does not I cannot add them together because one is a number and the other is text or without value.  This happens over and over not in just one area.  Users put in a lot of numbers - I have 80 TextBoxes.  I want to write to the file - the spreadsheet - a number, if one is entered, but if no value is entered I want the code to format the cell to numeric anyway.  Can anything be added to the code I posted to format the cell without any input?"}, {"owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "reply_to_user": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1565231993, "post_id": 57385336, "comment_id": 101290354, "body": "@Bzltyr, can you replace the empty values in columns BL:BM with 0, or they need to stay empty? You could try something like <code>Intersect(UsedRange, Range(&quot;BL:BM&quot;)).SpecialCells(xlCellTypeBlanks).Value = 0</code> after you moved all data from form to worksheet. Also, could you provide an example workbook with the same issue, because I can&#39;t reproduce it myself or may not be understanding what the issue is?"}, {"owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "edited": false, "score": 0, "creation_date": 1565381354, "post_id": 57385336, "comment_id": 101350643, "body": "Would have to remain empty."}], "tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1565135679, "creation_date": 1565135679, "answer_id": 57385336, "question_id": 57385128, "link": "https://stackoverflow.com/questions/57385128/user-form-formats-cell-without-any-input/57385336#57385336", "title": "User Form Formats cell without any input", "body": "<p>If only empty values of the text box are causing issues, I would populate the sheet only if the text box is not empty:</p>\n\n<pre><code>sh.Cells.NumerFormat = \"0.00\" 'make sure that initially all cells are formatted as Number\nIf Me.TextBox112.Value &lt;&gt; \"\" Then\n    sh.Range(\"BL\" &amp; n + 1).Value = Me.TextBox112.Value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11455570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547854e3f79acd2a1ad6791b5bbcbabd?s=128&d=identicon&r=PG&f=1", "display_name": "Bzltyr", "link": "https://stackoverflow.com/users/11455570/bzltyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565135679, "creation_date": 1565133502, "last_edit_date": 1565134956, "question_id": 57385128, "link": "https://stackoverflow.com/questions/57385128/user-form-formats-cell-without-any-input", "title": "User Form Formats cell without any input", "body": "<p>I have a user form that I do math on some cells that user form populates.  If there is no input from user form the cell is formatted as text so when I try to do simple math on it I get the <code>#Value!</code> error on my spreadsheet.</p>\n\n<p>I have tried to format the cells in the underlying spreadsheet that accepts the user form input - did not work.  Once the User Form is opened and nothing is input the cell does not allow math to be done on it.</p>\n\n<pre><code>sh.Range(\"BL\" &amp; n + 1).Value = Me.TextBox112.Value\n\nsh.Range(\"BM\" &amp; n + 1).Value = Me.TextBox113.Value\n</code></pre>\n\n<p>The above code is what I use to write to the spreadsheet.  Can I add something to this to format the cell to NUMBER even though it has no value from the User Form?</p>\n\n<pre><code>.NumberFormat =\"0.00\"\n</code></pre>\n\n<p>When I try to add Column BL to BM in excel I get the <code>#Value!</code> error if the User Form has received no input into <code>TextBox113</code> - or vice versa.</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565169791, "post_id": 57385078, "comment_id": 101264325, "body": ":) Good that you worked out what it was. To close this thread, please either add your answer and accept it as an answer: this could help others (recommended) or remove the post (not recommended)"}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 11892293, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92zArqVCktE/AAAAAAAAAAI/AAAAAAAABI0/3h5rFe2sq_U/photo.jpg?sz=128", "display_name": "Ramneek Singh", "link": "https://stackoverflow.com/users/11892293/ramneek-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1565206011, "creation_date": 1565206011, "answer_id": 57401128, "question_id": 57385078, "link": "https://stackoverflow.com/questions/57385078/opening-a-vba-userform-using-vbscript/57401128#57401128", "title": "Opening a VBA UserForm using VBScript?", "body": "<p>Make sure your userform is modal and run the script as administrator.</p>\n"}], "owner": {"reputation": 127, "user_id": 11892293, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92zArqVCktE/AAAAAAAAAAI/AAAAAAAABI0/3h5rFe2sq_U/photo.jpg?sz=128", "display_name": "Ramneek Singh", "link": "https://stackoverflow.com/users/11892293/ramneek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565206011, "creation_date": 1565132941, "last_edit_date": 1565158462, "question_id": 57385078, "link": "https://stackoverflow.com/questions/57385078/opening-a-vba-userform-using-vbscript", "title": "Opening a VBA UserForm using VBScript?", "body": "<p>So I've been working on a project in Excel that creates a UserForm in order to run three different macros. The Userform has been created but the issue I'm facing right now is that whenever I use a script.vbs to open the macro from outside Excel, it closes instantly. I want the UserForm to stay on the screen. Any ideas on how to do this?</p>\n\n<p>Here is the VBS script I'm using.</p>\n\n<pre><code>Dim xlApp, xlBook\n\nSet xlApp = CreateObject(\"Excel.Application\")\nSet xlBook = xlApp.Workbooks.Open(\"Path~\", True)\nxlApp.Run \"ThisWorkbook.UserForm\"\nxlBook.Close\nxlApp.Quit\n\nSet xlBook = Nothing\nSet xlApp = Nothing\n\nWScript.Quit\n</code></pre>\n\n<p>Here is the Macro code for the Userform.</p>\n\n<pre><code>Sub UserForm()\n\nDim form As New Userform1\n\nform.Show vbModal\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE: Never mind. I'm an idiot. The solution is to make sure your Excel file is readable, then run it from administrator.</p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1565128091, "post_id": 57384211, "comment_id": 101252874, "body": "Userforms AFAIK use points not pixels for their positioning. Also, have you tried arranging the pictures in the initialize sub of the UF?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1565220899, "post_id": 57384211, "comment_id": 101288327, "body": "Are the text below the icons an image? Send them back behind the icon image. Images seem to be zoomed in. Are the <b>PictureSizeMode</b> set to <code>3 - fmPictureSizeModeZoom</code>? Change it and test."}], "owner": {"reputation": 85, "user_id": 9355397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1f409a95833a3e26e151bf5e7883f86d?s=128&d=identicon&r=PG&f=1", "display_name": "papacoolaid666", "link": "https://stackoverflow.com/users/9355397/papacoolaid666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1565126742, "creation_date": 1565126742, "question_id": 57384211, "link": "https://stackoverflow.com/questions/57384211/userform-objects-changing-size-zoom-on-different-monitors", "title": "Userform objects changing size/zoom on different monitors", "body": "<p>A VBA UserForm is displaying its objects with different size/resolution on other people's monitors than what is showing on my current monitor. </p>\n\n<p>I am unable to change any \"User Interface Options\" for dual monitor setups in the Excel options menu (the tab isn't even available in the version of Excel I am using), getting DPI information from the monitor and adjusting, and adjusting the width and height with the application settings but nothing has worked so far.</p>\n\n<p>Please let me know any other potential solutions to this issue.\nThank you!\n<a href=\"https://i.stack.imgur.com/FO6gJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FO6gJ.jpg\" alt=\"This is the version showing on my monitor (what I want everyone to see)\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dTPoa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dTPoa.jpg\" alt=\"This is the version showing on other monitors (not what I want)\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1565126609, "post_id": 57384073, "comment_id": 101252432, "body": "You can disable screen updates, <code>Application.ScreenUpdating = False</code>, copy your data, and then enable screen updates <code>Application.ScreenUpdating = True</code>. This will speed up the copy. See <a href=\"https://stackoverflow.com/questions/12391786/effect-of-screen-updating\">Effect of Screen Updating</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1565127218, "creation_date": 1565127218, "answer_id": 57384290, "question_id": 57384073, "link": "https://stackoverflow.com/questions/57384073/how-to-copy-row-to-another-sheet-if-the-cell-value-of-c-matches-the-sheetname/57384290#57384290", "title": "How to copy row to another sheet if the cell value of C matches the sheetname", "body": "<p>Stop <code>.Activating</code>! Totally unnecessary and updating the UI is taking time. Make sure all calls to ranges are qualified.</p>\n\n<pre><code>Option Explicit '&lt;--- Always at the top of modules!\nSub COPY_DATA()\n\n    Dim bottomD As Long\n    bottomD = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    Dim c As Range\n    Dim ws As Worksheet\n    For Each c In Sheets(\"Data\").Range(\"D2:D\" &amp; bottomD)\n        For Each ws In Sheets\n            With ws\n                If .Name = c.Value And .Name &lt;&gt; \"Userform\" Then\n                    c.EntireRow.copy Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n                End If\n            End With\n        Next ws\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Note also that I explicitly stated <code>c.Value</code> instead of using the implicit/default property (which just happens to be Value).</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1565127379, "creation_date": 1565127379, "answer_id": 57384328, "question_id": 57384073, "link": "https://stackoverflow.com/questions/57384073/how-to-copy-row-to-another-sheet-if-the-cell-value-of-c-matches-the-sheetname/57384328#57384328", "title": "How to copy row to another sheet if the cell value of C matches the sheetname", "body": "<p>This should be faster:</p>\n\n<pre><code>Sub COPY_DATA()\n\n    Dim dict As Object\n    Dim bottomD As Long\n    Dim c As Range\n    Dim ws As Worksheet,wb as workbook, wsData as Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.worksheets(\"Data\")\n\n    'collect the sheet names\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For Each ws In wb.Worksheets\n        If ws.Name &lt;&gt; \"Userform\" Then dict.Add ws.Name, True\n    Next ws\n\n    Application.ScreenUpdating = False\n\n    bottomD = wsData.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    For Each c In wsData.Range(\"D2:D\" &amp; bottomD)\n        If dict.exists(c.Value) Then\n            c.EntireRow.Copy wb.Worksheets(c.Value).Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        End If\n    Next c\n\n    Application.ScreenUpdating = True\n\n    wsData.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11870625, "user_type": "registered", "profile_image": "https://graph.facebook.com/2622180277801722/picture?type=large", "display_name": "Larc Reyes", "link": "https://stackoverflow.com/users/11870625/larc-reyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565127379, "creation_date": 1565125969, "last_edit_date": 1565126237, "question_id": 57384073, "link": "https://stackoverflow.com/questions/57384073/how-to-copy-row-to-another-sheet-if-the-cell-value-of-c-matches-the-sheetname", "title": "How to copy row to another sheet if the cell value of C matches the sheetname", "body": "<p>So I pull data then I have to copy and  paste the rows to their respective sheets basing on the value of Column D. I have a code that does the thing but it takes too slow when there are thousands of rows.</p>\n\n<pre><code>Sub COPY_DATA()\n\n    Dim bottomD As Long\n    bottomD = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    Dim c As Range\n    Dim ws As Worksheet\n    For Each c In Sheets(\"Data\").Range(\"D2:D\" &amp; bottomD)\n        For Each ws In Sheets\n            ws.Activate\n            If ws.Name = c And ws.Name &lt;&gt; \"Userform\" Then\n                c.EntireRow.copy Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n            End If\n        Next ws\n    Next c\n\nWorksheets(\"Data\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>I want to make the process of copy and pasting faster</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565126132, "post_id": 57384049, "comment_id": 101252293, "body": "Where is this code located? What is the rest of if? Are you using the <code>Worksheet_Change</code> event?"}, {"owner": {"reputation": 1, "user_id": 11853639, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bkLhpwLAZ_w/AAAAAAAAAAI/AAAAAAAAAJs/bYr-b3QHMtc/photo.jpg?sz=128", "display_name": "chinni power", "link": "https://stackoverflow.com/users/11853639/chinni-power"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565147645, "post_id": 57384049, "comment_id": 101256370, "body": "Hi,    That&#39;s the only syntax I am using. There is nothing else I am using for that. Actually I am new to VBA. I want to disable a range of cells which are in the same row like if I give some input in A3 then D3 to K3 cells should be disabled. This shouldn&#39;t effect any others cells. That to without protecting entire sheet. Please help me in this."}, {"owner": {"reputation": 1, "user_id": 11853639, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bkLhpwLAZ_w/AAAAAAAAAAI/AAAAAAAAAJs/bYr-b3QHMtc/photo.jpg?sz=128", "display_name": "chinni power", "link": "https://stackoverflow.com/users/11853639/chinni-power"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565605043, "post_id": 57384049, "comment_id": 101392045, "body": "Hi Bigaben,  Can you please help on this. I am not able to proceed with this code...."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565619996, "post_id": 57384049, "comment_id": 101399561, "body": "The posted answer should be helpful for you. You&#39;ll need to make a few modifications but I think it&#39;s what you&#39;re looking for."}], "answers": [{"comments": [{"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1565887703, "post_id": 57384369, "comment_id": 101494520, "body": "@chinni power - Did this answer your question?"}], "tags": [], "owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1565127657, "creation_date": 1565127657, "answer_id": 57384369, "question_id": 57384049, "link": "https://stackoverflow.com/questions/57384049/issue-with-vba-in-excel-for-enabling-disabling-of-cells/57384369#57384369", "title": "Issue with VBA in excel for enabling/disabling of Cells", "body": "<p>Here is an example taken from the <a href=\"https://www.pcreview.co.uk/threads/how-do-i-disable-cell-editing-in-vba.3475819/\" rel=\"nofollow noreferrer\">PCreview</a> website that makes column F read-only. This can be adapted to make any cells read-only.</p>\n\n<pre><code>Dim OldValue As Variant\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 6 Then\n        On Error GoTo Whoops\n        Application.EnableEvents = False\n        MsgBox \"Values in this column cannot be changed!\"\n        Target.Value = OldValue\n    End If\n\nWhoops:\n    Application.EnableEvents = True\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Column = 6 Then OldValue = Target.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11853639, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bkLhpwLAZ_w/AAAAAAAAAAI/AAAAAAAAAJs/bYr-b3QHMtc/photo.jpg?sz=128", "display_name": "chinni power", "link": "https://stackoverflow.com/users/11853639/chinni-power"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565142020, "creation_date": 1565125880, "last_edit_date": 1565142020, "question_id": 57384049, "link": "https://stackoverflow.com/questions/57384049/issue-with-vba-in-excel-for-enabling-disabling-of-cells", "title": "Issue with VBA in excel for enabling/disabling of Cells", "body": "<p>Requirement Explanation :-<br>\nWhenever specific input given in some field/column of excel then the user should be restricted to input for specific range of fields/columns in the same row and same sheet of excel.\nInput is selected from dropdown values in each cell of fields/columns.\nOther than those specific input, those specific range can be allowed for user input.\nThis applies for all the rows of the input column until the last cell.</p>\n\n<p>Example Scenario :-\nIf user selects \"AWB\" from dropdown in the cell C6, then user should not able to provide input from DP6 to ED6 (DP6 - ED6 should be read only/not editable).\nElse DP6 - ED6 cell should be enabled. (Here, we have enabling and disabling in the same row) .\nNote : And no other sheet should be impacted because of this.</p>\n\n<p>My code :-</p>\n\n<pre><code>WorkBook.Sheets(\"SheetName\").Unprotect\n\nWorkBook.Sheets(\"SheetName \").Range(\"A15:A20\").Locked = False\n\nmainworkBook.Sheets(\"SheetName \").Protect\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance", "loops"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1565126018, "post_id": 57383910, "comment_id": 101252252, "body": "Try testing the cell&#39;s <code>Interior.ColorIndex</code> before entering that <code>If</code> statement, so that if it&#39;s already 3 you can skip it."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1565126238, "post_id": 57383910, "comment_id": 101252327, "body": "Can&#39;t you work through a dictionary object? Going through a range of cells and using a worksheetfunction is just slow on its own I suppose."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565129312, "post_id": 57384242, "comment_id": 101253244, "body": "Need some way to get back to the first instance of a value and color it if you find any other instance of it..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565130373, "post_id": 57384242, "comment_id": 101253508, "body": "Did not mean it as a criticism, and I admire your being able to walk away from your computer  ;-)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565130736, "post_id": 57384242, "comment_id": 101253596, "body": "@JvdH aha - only 3:30pm here"}, {"owner": {"reputation": 3, "user_id": 11891765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b575513b1f784f182faa3acb4914d81?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Coder", "link": "https://stackoverflow.com/users/11891765/vba-coder"}, "edited": false, "score": 0, "creation_date": 1565198653, "post_id": 57384242, "comment_id": 101280593, "body": "Thanks for your assistance. I have implemented the above code and it functions for me right around the 6 second run time as you mentioned. However, I am still attempting to get the first instance of the value to be highlighted (as I need all values that are duplicates to be highlighted)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1565201417, "post_id": 57384242, "comment_id": 101281768, "body": "One way is to add the cell reference/x value to the dictionary when adding the value for the first time: if a subsequent instance of that value is found, check the corresponding dictionary value and color that cell as well as the second instance - then set the dictionary value to Nothing/zero."}, {"owner": {"reputation": 3, "user_id": 11891765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b575513b1f784f182faa3acb4914d81?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Coder", "link": "https://stackoverflow.com/users/11891765/vba-coder"}, "edited": false, "score": 0, "creation_date": 1565202527, "post_id": 57384242, "comment_id": 101282227, "body": "@JvdV This updated code utilizing the 2nd dictionary was the key to getting this to work! It took around 1.5 min to run, but it sure beats the hour plus it was taking before. I can now seamlessly run the filters and sort by cell color. Thank you!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565209833, "post_id": 57384242, "comment_id": 101285339, "body": "@TimWilliams, I have updated my code. I ran it again and it only took 2,3 seconds. Im happy with the result. I also compared it to your awesome answer and there was no particular difference at all. Any reason why you would <code>UNION</code> your to color in batches? Please let me know what you think."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11891765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b575513b1f784f182faa3acb4914d81?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Coder", "link": "https://stackoverflow.com/users/11891765/vba-coder"}, "edited": false, "score": 0, "creation_date": 1565210041, "post_id": 57384242, "comment_id": 101285450, "body": "@VBACoder, both Tim Williams his answer and mine are even more optimized now taking only bare seconds :)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565210633, "post_id": 57384242, "comment_id": 101285664, "body": "I&#39;m coloring about 64k cells and without batching that up my run-time was just under a second longer.  Probably not a worthwhile optimization given it already runs relatively quickly."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1565209628, "last_edit_date": 1565209628, "creation_date": 1565126979, "answer_id": 57384242, "question_id": 57383910, "link": "https://stackoverflow.com/questions/57383910/vba-loop-still-running-slowly-after-optimizing/57384242#57384242", "title": "VBA Loop still running slowly after optimizing", "body": "<p>Taken some inspiration from <a href=\"https://stackoverflow.com/questions/44751586/excel-vba-how-to-do-countif-more-efficiently\">here</a>, I pieced together a simple piece of code using a Dictionary object (early binding for speed purpose)</p>\n\n<pre><code>Sub Test()\n\nt = Timer\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nDim Dtr1 As Dictionary, Dtr2 As Dictionary\nDim Lr As Long, x As Long\nDim Arr As Variant\n\nWith ThisWorkbook.Sheets(\"Blad1\") 'Change to your needs\n    Lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Arr = .Range(\"A1:A\" &amp; Lr).Value\n    Set Dtr1 = New Dictionary\n    Set Dtr2 = New Dictionary\n    For x = LBound(Arr, 1) To UBound(Arr, 1)\n        If Not Dtr1.Exists(Arr(x, 1)) Then\n            Dtr1.Add Arr(x, 1), x\n        Else\n            If Not Dtr2.Exists(Dtr1.Item(Arr(x, 1))) Then\n                Dtr2.Add Dtr1.Item(Arr(x, 1)), 1\n            End If\n            Dtr2.Add x, 1\n        End If\n    Next x\n    For Each Key In Dtr2.Keys\n        .Cells(Key, 1).Interior.ColorIndex = 3\n    Next Key\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Timer - t\n\nEnd Sub\n</code></pre>\n\n<p>I hope that would improve the runtime on your code a bit.</p>\n\n<blockquote>\n  <p><strong><em>Note:</strong> Because we used early binding of the Dictionary Object we need to set the right reference VBA Editor > Tools > References >\n  Microsoft Scripting Runtime</em></p>\n</blockquote>\n\n<p>This would only highlight the duplicates.</p>\n\n<p><strong>Edit:</strong> Ran a timer on this procedure with a range of 200.000 rows with tons of duplicates. It processed in 2,3 seconds. :)</p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1565127178, "creation_date": 1565127178, "answer_id": 57384286, "question_id": 57383910, "link": "https://stackoverflow.com/questions/57383910/vba-loop-still-running-slowly-after-optimizing/57384286#57384286", "title": "VBA Loop still running slowly after optimizing", "body": "<p>Here's a quick example of how to use a <code>Dictionary</code> to count the number of duplicates. My solution will add a dictionary entry for every single cell the value appears.</p>\n\n<p>For even more speed, I'm moving the entire range into a memory-based array for processing. This saves the code from having to access the Excel <code>Range</code> object each time.</p>\n\n<pre><code>Sub HighlightDuplicates()\n    Dim valuesRange As Range\n    Set valuesRange = Selection\n\n    '--- capture the data in a memory-based array\n    Dim valuesData As Variant\n    valuesData = valuesRange.value\n\n    Dim values As Dictionary\n    Set values = New Dictionary\n\n    '--- capture a list of rows for each value in the dataset\n    Dim i As Long\n    For i = LBound(valuesData, 1) To UBound(valuesData, 1)\n        If Not values.Exists(valuesData(i, 1)) Then\n            '--- create an entry for this value and add the cell address\n            '    as a reference\n            values.Add valuesData(i, 1), CStr(valuesRange.Cells(i, 1).address)\n        Else\n            '--- append the next cell address to the list\n            Dim rowList As String\n            rowList = values(valuesData(i, 1))\n            rowList = rowList &amp; \",\" &amp; CStr(valuesRange.Cells(i, 1).address)\n            values(valuesData(i, 1)) = rowList\n        End If\n    Next i\n\n    '--- now highlight the rows where the value appears on more than one row\n    Dim totalDupes As Long\n    Dim value As Variant\n    For Each value In values.Keys\n        Dim rows() As String\n        rows = Split(values(value), \",\")\n        If UBound(rows) &gt; 0 Then\n            For i = LBound(rows) To UBound(rows)\n                valuesRange.Parent.Range(rows(i)).Interior.ColorIndex = 3\n                totalDupes = totalDupes + 1\n            Next i\n        End If\n    Next value\n    Debug.Print \"total duplicates highlighted = \" &amp; totalDupes\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1565204906, "post_id": 57400777, "comment_id": 101283373, "body": "Now it has no use for me to update my answer :). Just kidding, will still try to adjust it according to your comments, thanks for the contribution. One thing I wonder. I read that late binding is slower than early binding. Would be interesting to test this while you are using late binding atm."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1565204372, "creation_date": 1565204372, "answer_id": 57400777, "question_id": 57383910, "link": "https://stackoverflow.com/questions/57383910/vba-loop-still-running-slowly-after-optimizing/57400777#57400777", "title": "VBA Loop still running slowly after optimizing", "body": "<p>Late in the game but here's my contribution.</p>\n\n<p>2.7 sec run-time on my PC.</p>\n\n<pre><code>Sub Replicates()\n\n    Dim rng As Range, x As Long, arr, t, dict As Object, v\n    Dim rngColor As Range, i As Long\n\n    'set up spome dummy data\n    ActiveSheet.Range(\"A:A\").Clear\n    Set rng = ActiveSheet.Range(\"A1:A200000\")\n    rng.Formula = \"=ROUND(RAND()*500000,0)\" 'adjust to increase/decrease number of replicates\n    rng.Value = rng.Value\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    Application.ScreenUpdating = False\n\n    t = Timer\n\n    arr = rng.Value\n    For x = 1 To UBound(arr, 1)\n        v = arr(x, 1)\n        If Not dict.exists(v) Then\n            dict.Add v, x\n        Else\n            addrange rngColor, rng.Cells(x), i\n            If dict(v) &lt;&gt; 0 Then\n                addrange rngColor, rng.Cells(dict(v)), i\n                dict(v) = 0\n            End If\n            'We're batching up the coloring by building a range and setting the color\n            '  in one shot\n            'Note: building large ranges is *slow* so don't let this get too large\n            If i &gt; 50 Then\n                rngColor.Interior.Color = vbRed\n                Set rngColor = Nothing\n                i = 0\n            End If\n        End If\n    Next x\n\n    'color any remaining cells\n    If Not rngColor Is Nothing Then rngColor.Interior.Color = vbRed\n\n    Debug.Print Timer - t\nEnd Sub\n\n'utility sub to build up a range from single cells\nSub addrange(rngtot As Range, c As Range, ByRef i As Long)\n    If rngtot Is Nothing Then\n        Set rngtot = c\n    Else\n        Set rngtot = Application.Union(rngtot, c)\n    End If\n    i = i + 1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11891765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b575513b1f784f182faa3acb4914d81?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Coder", "link": "https://stackoverflow.com/users/11891765/vba-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 57384242, "answer_count": 3, "score": 0, "last_activity_date": 1565209628, "creation_date": 1565125083, "question_id": 57383910, "link": "https://stackoverflow.com/questions/57383910/vba-loop-still-running-slowly-after-optimizing", "title": "VBA Loop still running slowly after optimizing", "body": "<p>I am using a Duplicate search by cells selected code, as the excel documents I've been given at work for these are crashing when trying to utilize conditional formatting. I need to highlight all duplicates in a single column with approximately 200,000 cells and it currently is taking around an hour for the code to run, and the document shows \"Excel unresponsive\" after about 10 seconds. I am then forced to wait and hope the code is running or close the document.</p>\n\n<p>After disabling screen updating, automatic calculation, and 'enable events', I noticed faster performance on smaller sections of the document, but it still runs slowly when calculating for the entire column. I have put this into various workbooks and the same slow performance occurs. </p>\n\n<p>I tried to even get the status bar to appear (so I could see if the code was making progress) but had difficulty getting that to work.</p>\n\n<pre><code>Sub DuplicateValuesFromSelection()\nOn Error GoTo EH\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\nDim myRange As Range\nDim i As Integer\nDim j As Integer\nDim myCell As Range\nSet myRange = Selection\nFor Each myCell In myRange\nIf WorksheetFunction.CountIf(myRange, myCell.Value) &gt; 1 Then\n    myCell.Interior.ColorIndex = 3\nEnd If\n    Next\n\nCleanUp:\n On Error Resume Next\n Application.ScreenUpdating = True\n Application.Calculation = xlCalculationAutomatic\n Application.EnableEvents = True\nExit Sub\nEH:\n' Do error Handling\nGoTo CleanUp\nEnd Sub\n</code></pre>\n\n<p>I expect the run time of the code to be much faster than this. The current hour plus wait time seems unnecessary. Does anybody have suggestions?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565123966, "post_id": 57383683, "comment_id": 101251524, "body": "What line throws the error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565137857, "post_id": 57383683, "comment_id": 101254811, "body": "Try using a random number for the folder name, instead of a timestamp (or append a random number to the timestamp)  The will reduce the chance of collisions if multiple mails arrive at the same time."}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1566578861, "post_id": 57383683, "comment_id": 101714137, "body": "What do you mean by this?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1565191261, "post_id": 57384792, "comment_id": 101276909, "body": "How would I go about doing that?"}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1566578808, "post_id": 57384792, "comment_id": 101714115, "body": "How do I make the file path name well formed?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1565130577, "creation_date": 1565130577, "answer_id": 57384792, "question_id": 57383683, "link": "https://stackoverflow.com/questions/57383683/how-to-fix-a-pathway-error-automatically-printing-attachments-when-i-receive-m/57384792#57384792", "title": "How to fix a pathway error, automatically printing attachments, when I receive multiple emails at the same time", "body": "<p>I suppose the following line of code fails:</p>\n\n<pre><code>Set objFolderItem = objFolder.ParseName(FullFile)\n</code></pre>\n\n<p>Make sure the file path string is well-formed and doesn't contain forbidden symbols. Don't forget to specify the filename with an extension. </p>\n"}], "owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57384792, "answer_count": 1, "score": 0, "last_activity_date": 1590663539, "creation_date": 1565123913, "last_edit_date": 1590663539, "question_id": 57383683, "link": "https://stackoverflow.com/questions/57383683/how-to-fix-a-pathway-error-automatically-printing-attachments-when-i-receive-m", "title": "How to fix a pathway error, automatically printing attachments, when I receive multiple emails at the same time", "body": "<p>This code automatically prints emails, that have attachments, as they arrive, based on rules.</p>\n\n<p>When I receive multiple emails at the same time, it gives me a pathway error.</p>\n\n<p>How do I fix this error so I don't miss emails?</p>\n\n<pre><code>Sub LSPrint(Item As Outlook.MailItem)\n    On Error GoTo OError\n\n    Dim oFS As FileSystemObject\n    Dim sTempFolder As String\n    Set oFS = New FileSystemObject\n\n    sTempFolder = oFS.GetSpecialFolder(TemporaryFolder)\n\n    cTmpFld = sTempFolder &amp; \"\\OETMP\" &amp; Format(Now, \"yyyymmddhhmmss\")\n    MkDir (cTmpFld)\n\n    Dim oAtt As Attachment\n    For Each oAtt In Item.Attachments\n        FileName = oAtt.FileName\n        FullFile = cTmpFld &amp; \"\\\" &amp; FileName\n\n        oAtt.SaveAsFile (FullFile)\n\n        Set objShell = CreateObject(\"Shell.Application\")\n        Set objFolder = objShell.NameSpace(0)\n        Set objFolderItem = objFolder.ParseName(FullFile)\n        objFolderItem.InvokeVerbEx (\"print\")\n\n    Next oAtt\n\n    If Not oFS Is Nothing Then Set oFS = Nothing\n    If Not objFolder Is Nothing Then Set objFolder = Nothing\n    If Not objFolderItem Is Nothing Then Set objFolderItem = Nothing\n    If Not objShell Is Nothing Then Set objShell = Nothing\n\nOError:\n    If Err &lt;&gt; 0 Then\n        MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n        Err.Clear\n    End If\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1565127336, "post_id": 57383500, "comment_id": 101252650, "body": "It looks like the target element doesn&#39;t have an inner text.  But it does have an ID.  So try <code>IE.document.getElementById(&quot;B919...&quot;).Click</code>."}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1565140230, "post_id": 57383500, "comment_id": 101255164, "body": "Hello @Domenic, tx for the suggestion.  I believe  I tried that already without success.  I&#39;ll try it first thing in the morning tomorrow and will let you know.  In the meanwhile if someone else has another idea to suggest I&#39;ll also try it in less than 12 hours.  Tx all"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565165967, "post_id": 57383500, "comment_id": 101262242, "body": "Please explain what without success means. Did you get an error when trying Domenic&#39;s suggestion?"}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1565180716, "post_id": 57383500, "comment_id": 101270378, "body": "@Domenic your solution works perfectly well!!  I thought I tried it but it seems I didn&#39;t.  Tx for your help."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1565183267, "post_id": 57383500, "comment_id": 101272003, "body": "You&#39;re very welcome, cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565166492, "post_id": 57386253, "comment_id": 101262507, "body": "Thank you for your reminder. I&#39;ll modify my answer."}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1565182385, "post_id": 57386253, "comment_id": 101271389, "body": "Tx Yu Zhou your 2nd suggestion  (querySelector(\u2026).Click also works"}], "tags": [], "owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "is_accepted": false, "score": 1, "last_activity_date": 1565166560, "last_edit_date": 1565166560, "creation_date": 1565145258, "answer_id": 57386253, "question_id": 57383500, "link": "https://stackoverflow.com/questions/57383500/ie-click-on-a-button-that-has-no-link-associated-to-it-using-excel-vba/57386253#57386253", "title": "IE click on a button that has no link associated to it (using Excel VBA)", "body": "<p><code>getElementsByClassName</code> returns an array-like object of all child elements which have all of the given class names, so I think it should be <code>IE.document.getElementsByClassName(\"rc-content-buttons\")(0).Click</code> if it is the first element with the classname.</p>\n\n<p>You could also try: <code>IE.document.querySelector(\"div.rc-content-buttons input\").Click</code>.</p>\n\n<p>And I think <code>IE.document.getElementById(\"B91938241817236808\").Click</code> is also right.</p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 1, "creation_date": 1565181004, "post_id": 57390083, "comment_id": 101270564, "body": "Thank your very much QHarr!  Indeed the ID method works, but the querySelector is more elegant since code is more self explanatory when reading &quot;value=&#39;Cr&#233;er&quot; then reading &quot;B91...&quot;.   It wasn&#39;t in a frame, but it&#39;s an event so I had to use .FireEvent.    I&#39;ve also modified my load page wait loop.  Gained some seconds there.  Many thanks.  I should have posted this sooner instead of searching by myself for 4 hours.."}, {"owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "edited": false, "score": 0, "creation_date": 1565279798, "post_id": 57390083, "comment_id": 101312914, "body": "I have a related question here <a href=\"https://stackoverflow.com/questions/57416534/internet-explorer-click-an-icon-and-a-button-of-a-specific-line-of-a-table\" title=\"internet explorer click an icon and a button of a specific line of a table\">stackoverflow.com/questions/57416534/&hellip;</a>, anybody (@QHarr maybe) could help?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1565166549, "creation_date": 1565166549, "answer_id": 57390083, "question_id": 57383500, "link": "https://stackoverflow.com/questions/57383500/ie-click-on-a-button-that-has-no-link-associated-to-it-using-excel-vba/57390083#57390083", "title": "IE click on a button that has no link associated to it (using Excel VBA)", "body": "<p>It is within an input not a tag element so gathering a tags will not capture what you want. Using the id, as suggested in comments is one way to go. If you get element not found then check whether your element is within a parent frame or iframe which needs to be negotiated. General syntax for that is </p>\n\n<pre><code>ie.document.getElementsByTagName(\"frame\")(appropriateIndexHere).contentDocument.getElementById(\"B91938241817236808\")\nie.document.getElementsByTagName(\"iframe\")(appropriateIndexHere).contentDocument.getElementById(\"B91938241817236808\")\n</code></pre>\n\n<p>If the id is dynamic you can use the <code>value</code> attribute</p>\n\n<pre><code>ie.document.querySelector(\"[value='Cr\u00e9er']\")\nie.document.getElementsByTagName(\"frame\")(appropriateIndexHere).contentDocument.querySelector(\"[value='Cr\u00e9er']\") 'etc\n</code></pre>\n\n<p>As there is an event, you may need to fire it.</p>\n\n<pre><code>ie.document.querySelector(\"[value='Cr\u00e9er']\").FireEvent \"onclick\"\nie.document.getElementsByTagName(\"frame\")(appropriateIndexHere).contentDocument.querySelector(\"[value='Cr\u00e9er']\").FireEvent \"onclick\"  'etc\n</code></pre>\n\n<p>And use a proper page load wait. So this,</p>\n\n<pre><code>Do While IE.Busy                                                     'loading page\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>While ie.Busy Or ie.ReadyState &lt;&gt; 4: DoEvents:Wend\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57390083, "answer_count": 2, "score": 0, "last_activity_date": 1565181958, "creation_date": 1565123035, "last_edit_date": 1565181958, "question_id": 57383500, "link": "https://stackoverflow.com/questions/57383500/ie-click-on-a-button-that-has-no-link-associated-to-it-using-excel-vba", "title": "IE click on a button that has no link associated to it (using Excel VBA)", "body": "<p>I want to click on a \"button\" on a web page, but my problem is that this button doesn't seem to have link attach to it.  By the way I'm phrasing this you can see I'm not familiar at all with the language of web browser.\nAnyway I most use internet explorer  and here's the code I have so far</p>\n\n<pre><code>Sub click_button_no_hlink()\n\n\nDim i As Long\nDim IE As Object\nDim Doc As Object\nDim objElement As Object\nDim objCollection As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")               'create IE instance\n\nIE.Visible = True\n\nIE.Navigate \"https://apex.xyz.qc.ca/apex/prd1/f?p=135:LOGIN_DESKTOP::::::\"  ' Adress of web page\n\nDo While IE.Busy                                                     'loading page\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n'-------------Usually I would do something like that and it would works well.-----------------\nSet link = IE.document.getElementsByTagName(\"a\")\nFor Each l In link\n    a = l.innerText\n    If l.innerText = \"Cr\u00e9er\" Then                    '\n        l.Click\n        Exit For\n    End If\nNext\n'-------------That method works fine on other type of hlink to the page by the way------------\n\n\n'-----------------------I also tried various methods around this with no luck------------------------------\nSet objCollection = IE.document.getElementsByClassName(\"rc-content-buttons\")                  'recherche du bouton \"Cr\u00e9er\"\n'---------------------------------\n\n'--------------------or this also doesn't work-------------------------------\nFor Each btn In IE.document.getElementsByClassName(\"rc-content-buttons\")\n    If btn.getAttribute(\"id\") = \"B91938241817236808\" Then\n        btn.Click\n        Exit For\n    End If\nNext btn\n\nEnd Sub \n</code></pre>\n\n<p>For sake of clarity here's the code of the web page around the \"button\" I'm trying to interact with.\n<a href=\"https://i.stack.imgur.com/oiGDa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oiGDa.png\" alt=\"javascript code\"></a></p>\n\n<p>I've made many research but I'm in a dead end right now.  Any help will be greatly appreciate.<br>\nTx in advance.</p>\n\n<p>SOLVED FINAL CODE:  With help from DOMENIC and QHARR and Yu Zhou </p>\n\n<pre><code>Sub click_button_no_hlink()\n\n\nDim i As Long\nDim IE As Object\nDim Doc As Object\nDim objElement As Object\nDim objCollection As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")               'create IE instance\n\nIE.Visible = True\n\nIE.Navigate \"https://apex.xyz.qc.ca/apex/prd1/f?p=135:LOGIN_DESKTOP::::::\"  ' Adress of web page\n\nWhile IE.Busy: DoEvents: Wend             'loading page\n\nIE.document.querySelector(\"[value='Cr\u00e9er']\").FireEvent \"onclick\"   'works like a charm\n\n            '  IE.document.querySelector(\"div.rc-content-buttons input\").Click         \n                     'also works but speaks less by itself when reading code\n            '  IE.document.getElementById(\"B91938241817236808\").Click\n                     'also works \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565124035, "post_id": 57383456, "comment_id": 101251544, "body": "If you use the following ie.navigate2 &quot;<a href=\"https://www.filink.cl/Chile/RWeb/Response.ASP?WCI=TMainWelcome&amp;WCU=&amp;WCE=eActivities&amp;WCU\" rel=\"nofollow noreferrer\">filink.cl/Chile/RWeb/&hellip;</a>&quot;  instead of click lines and loop do you end up at the same place?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1565124306, "post_id": 57383456, "comment_id": 101251648, "body": "@QHarr the URI called in the <code>window.showModalDialog()</code> javascript function is different than the <code>href</code> of that element, so I don&#39;t think he ends up on the same place. Felipe, just for info, the <code>window.showModalDialog()</code> is deprecated since years (but I guess you don&#39;t control the website, you just want to scrape it). If my memory works, it opens a pop-up in dialog mode so the browser doesn&#39;t get the thread back until the form is closed. I guess that&#39;s why the code stops in that line (at least until you don&#39;t close the form manually)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565124394, "post_id": 57383456, "comment_id": 101251688, "body": "@MatteoNNZ Thanks. So it is getting a handle on that window then?"}, {"owner": {"reputation": 1, "user_id": 7069875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qpJczk74H3o/AAAAAAAAAAI/AAAAAAAAAJo/PmpFYdUwGEU/photo.jpg?sz=128", "display_name": "Felipe de la Fuente Diaz", "link": "https://stackoverflow.com/users/7069875/felipe-de-la-fuente-diaz"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565124470, "post_id": 57383456, "comment_id": 101251713, "body": "@MatteoNNZ I think the same you mentioned. Do you know any workaround? Indeed I do not control the website."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565126629, "post_id": 57383456, "comment_id": 101252440, "body": "Can you tell us if when you close the form you get the handle back?"}, {"owner": {"reputation": 1, "user_id": 7069875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qpJczk74H3o/AAAAAAAAAAI/AAAAAAAAAJo/PmpFYdUwGEU/photo.jpg?sz=128", "display_name": "Felipe de la Fuente Diaz", "link": "https://stackoverflow.com/users/7069875/felipe-de-la-fuente-diaz"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565127443, "post_id": 57383456, "comment_id": 101252670, "body": "@MatteoNNZ It opens the window so I suppose it does, but it never moves to next line in the VBA unless I close the new window. That&#39;s where I get idea-less."}, {"owner": {"reputation": 1, "user_id": 7069875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qpJczk74H3o/AAAAAAAAAAI/AAAAAAAAAJo/PmpFYdUwGEU/photo.jpg?sz=128", "display_name": "Felipe de la Fuente Diaz", "link": "https://stackoverflow.com/users/7069875/felipe-de-la-fuente-diaz"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565128216, "post_id": 57383456, "comment_id": 101252908, "body": "@MatteoNNZ yep. as soon as I close the window the vba goes to next line and continue"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565128454, "post_id": 57383456, "comment_id": 101252988, "body": "I can&#39;t know it for sure if I don&#39;t test it myself, but I fear that <code>window.showModalDialog()</code> passes the handle to the browser and so, there is nothing you can do with VBA anymore: neither you can fill the form, nor you can close it. VBA will keep on waiting for the browser to give it the handle back. Since you can&#39;t change the website to use this deprecated method, the only thing I can suggest you is you automate this using a language that allows multi-threading (java, python, c++ etc.). Unfortunately VBA has only one thread, and if the browser doesn&#39;t give it back, it&#39;s dead."}], "owner": {"reputation": 1, "user_id": 7069875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qpJczk74H3o/AAAAAAAAAAI/AAAAAAAAAJo/PmpFYdUwGEU/photo.jpg?sz=128", "display_name": "Felipe de la Fuente Diaz", "link": "https://stackoverflow.com/users/7069875/felipe-de-la-fuente-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565124379, "creation_date": 1565122849, "last_edit_date": 1565124379, "question_id": 57383456, "link": "https://stackoverflow.com/questions/57383456/vba-click-on-webpage-open-pop-up-but-then-do-nothing", "title": "VBA click on webpage open pop-up but then do nothing", "body": "<p>I have a code in VBA-Excel in which I navigate into a webpage, login in it and after that, move to another url within the site. Up to there everything is apparently working well, but after all that done, I do need to click on a link in the site (that is in a frame section). I have the following piece of code that do the click, and I think it works because a pop-up/modal window opens with the next page, which is a form I need to complete. </p>\n\n<pre><code>For Each oHTML_Element In HTMLdoc_F.getElementsByTagName(\"a\")\nDebug.Print oHTML_Element.innerText\nIf oHTML_Element.innerText = \"Persona Natural \" Then\n    oHTML_Element.Click\n    Loop Until HTMLdoc_F.readyState = READYSTATE_COMPLETE\n    Exit For\nEnd If \nNext\n</code></pre>\n\n<p>The thing is that when executing the oTHML_Element.click line, it opens the link but stays in the same line forever. I have tried FireEvent onclick an other method and the result is the same. </p>\n\n<p>The html part is this:</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\"&gt;\n&lt;title&gt;Untitled Document&lt;/title&gt;\n\n&lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=7\"&gt;\n\n\n&lt;script language=\"javascript\"&gt;\n\n\nfunction ShowfrmIndividual(){\n    window.showModalDialog(\"Response.ASP?WCI=TIndividual&amp;WCU=&amp;RoleTypeId=1&amp;CustomerTypeId=1&amp;Cached=0\",\"Dialog Arguments Value\",\"dialogHeight: 570px; dialogWidth: 800px; dialogTop: px; dialogLeft: px; edge: Raised; center: Yes; help: No; resizable: Yes; status: No;\");\n    return false;\n}\n\n&lt;/script&gt;&lt;/head&gt;\n\n\n&lt;body bgcolor=\"#efebef\" link=\"#ffffff\" vlink=\"#efebef\" alink=\"#efebef\" ms_positioning=\"GridLayout\"&gt;\n&lt;table border=\"0\" width=\"1359\" bgcolor=\"#ff7908\" height=\"20\" cellspacing=\"0\" cellpadding=\"0\" style=\"left: 0; position: absolute; top: 0; z-index: 6\"&gt;\n  &lt;tbody&gt;&lt;tr&gt;\n    &lt;td width=\"100%\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n\n&lt;a style=\"FONT-SIZE: 10pt; Z-INDEX: 1; LEFT: 210px; MARGIN-LEFT: 0px; WIDTH: 56px;  TEXT-INDENT: 0px; MARGIN-RIGHT: 0px; FONT-FAMILY: MS Serif; POSITION: absolute; TOP: 121px; HEIGHT: 16px; TEXT-ALIGN: left\" onclick=\"return ShowfrmIndividual()\" href=\"https://www.anysite.cl/Chile/RWeb/Response.ASP?WCI=TMainWelcome&amp;amp;amp;WCU=&amp;amp;amp;amp;WCE=eActivities&amp;amp;amp;amp;WCU\"&gt;...para una&lt;/a&gt;\n&lt;a style=\"FONT-SIZE: 10pt; Z-INDEX: 1; LEFT: 210px; MARGIN-LEFT: 0px; WIDTH: 110px; TEXT-INDENT: 0px; MARGIN-RIGHT: 0px; FONT-FAMILY: MS Serif; POSITION: absolute; TOP: 135px; HEIGHT: 16px; TEXT-ALIGN: left\" onclick=\"return ShowfrmIndividual()\" href=\"https://www.anysite.cl/Chile/RWeb/Response.ASP?WCI=TMainWelcome&amp;amp;amp;WCU=&amp;amp;amp;amp;WCE=eActivities&amp;amp;amp;amp;WCU\"&gt; Persona Natural &lt;/a&gt;\n\n&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>I appreciate any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1565123757, "post_id": 57383451, "comment_id": 101251448, "body": "Are you sure the sheet <code>Titre</code> is created in the destination workbook, before you actually call it to set the <code>Range(&quot;B2&quot;)</code>? What is the error you receive and on which line? In the code you show, you&#39;re not creating any sheet in the destination workbook."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11891616, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WY3Tb-VVS-8/AAAAAAAAAAI/AAAAAAAAAAg/s1qZRYJ501U/photo.jpg?sz=128", "display_name": "Mr. Okubura", "link": "https://stackoverflow.com/users/11891616/mr-okubura"}, "is_accepted": false, "score": 0, "last_activity_date": 1565123875, "creation_date": 1565123875, "answer_id": 57383676, "question_id": 57383451, "link": "https://stackoverflow.com/questions/57383451/finding-a-tab-name-using-string/57383676#57383676", "title": "Finding a tab name using string", "body": "<p>Never mind I just found why it's not working. I was not precise enough for my string variable.</p>\n\n<pre><code>Dim Titre As String\n</code></pre>\n\n<p>Titre = Workbooks(\"Menu Automatis\u00e9.xlsm\").Sheets(\"Fiche de cr\u00e9ation de projet\").Range(\"D26\").Value</p>\n"}], "owner": {"reputation": 1, "user_id": 11891616, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WY3Tb-VVS-8/AAAAAAAAAAI/AAAAAAAAAAg/s1qZRYJ501U/photo.jpg?sz=128", "display_name": "Mr. Okubura", "link": "https://stackoverflow.com/users/11891616/mr-okubura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565123875, "creation_date": 1565122834, "last_edit_date": 1565122919, "question_id": 57383451, "link": "https://stackoverflow.com/questions/57383451/finding-a-tab-name-using-string", "title": "Finding a tab name using string", "body": "<p>The problem is that I don't know the exact code to find a tab using a variable.</p>\n\n<p>For now my macro create a new tab in another workbook using the Range D26 as the name of my active workbook and is able to copy my form in the other workbooks but not in the right sheets. In fact it just send me to the debug.</p>\n\n<pre><code>Dim Titre As String\n\nTitre = Range(\"D26\").Value\n\nWorkbooks.Open \"C:\\Users\\charl\\Desktop\\Programe comptable projet\\Menu automatis\u00e9 Test\\Feuille de projet.xlsx\"\n\nWorkbooks(\"Feuille de projet.xlsx\").Worksheets(Titre).Range(\"B2\") = Workbooks(\"Menu Automatis\u00e9.xlsm\").Sheets(\"Fiche de cr\u00e9ation de projet\").Range(\"D8\").Value\n</code></pre>\n\n<p>I expect the program to copy of my form in the other workbooks in the tab I just created using the button. (The tab is created first)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 1, "creation_date": 1565126077, "post_id": 57383261, "comment_id": 101252274, "body": "At what line are you getting the error?"}, {"owner": {"reputation": 1, "user_id": 11891539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d420d491fa8a23635f2937ff7849dbd7?s=128&d=identicon&r=PG&f=1", "display_name": "wolfm", "link": "https://stackoverflow.com/users/11891539/wolfm"}, "reply_to_user": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1565168170, "post_id": 57383261, "comment_id": 101263447, "body": "It freeze out, rather than error, but sometimes I&#39;m able to break the cycle, and get this line error       &#39; Worksheets(&quot;data&quot;).Cells(i, x).Copy&#39; after that I can see in the report sheet 2 columns copied, but thats it."}, {"owner": {"reputation": 1, "user_id": 11891539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d420d491fa8a23635f2937ff7849dbd7?s=128&d=identicon&r=PG&f=1", "display_name": "wolfm", "link": "https://stackoverflow.com/users/11891539/wolfm"}, "reply_to_user": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1565185425, "post_id": 57383261, "comment_id": 101273449, "body": "Now work with .Range .Copy. The data is too big for this method, I think."}], "owner": {"reputation": 1, "user_id": 11891539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d420d491fa8a23635f2937ff7849dbd7?s=128&d=identicon&r=PG&f=1", "display_name": "wolfm", "link": "https://stackoverflow.com/users/11891539/wolfm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565156445, "creation_date": 1565121942, "last_edit_date": 1565156445, "question_id": 57383261, "link": "https://stackoverflow.com/questions/57383261/copying-with-criteria-get-freeze-out-with-big-data", "title": "Copying with criteria, get freeze out with big data", "body": "<p>I have lots of columns (eg. 110) with 3000 rows with ID and an order ID to copy the data.\nThe code is running with 6 column amd 20 rows, but not with bigger sheet.</p>\n\n<p>Tried different copy method, but only cells to cells are working.\nRange.Copy doesn't, gets run-time error 1004: Method 'Range' of object '_Global' failed. </p>\n\n<pre><code>Sub Gomb1()\n    Dim lastrow As Long, erow As Long, lastmh As Long, lastdatacolumn As Long, idmh As Integer, iddata As Integer, y As Integer, x As Integer, i As Integer\n\n    lastrow = Worksheets(\"data\").Cells(Rows.Count, 3).End(xlUp).Row\n    lastmh = Worksheets(\"MH\").Cells(Rows.Count, 1).End(xlUp).Row\n    lastdatacolumn = Worksheets(\"data\").Cells(1, Columns.Count).End(xlToLeft).Column\n\n    For y = 2 To lastmh\n        idmh = Worksheets(\"MH\").Cells(y, 2).Value\n\n        For x = 3 To lastdatacolumn    \n            iddata = Worksheets(\"data\").Cells(4, x).Value\n\n            If idmh = iddata Then\n                For i = 4 To lastrow\n                    Worksheets(\"data\").Cells(i, x).Copy\n                    erow = Worksheets(\"report\").Cells(Rows.Count, y).End(xlUp).Row\n                    Worksheets(\"data\").Paste Destination:=Worksheets(\"report\").Cells(erow + 1, y)\n                Next i \n            End If\n        Next x\n    Next y\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "object", "collections"], "comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1565121161, "post_id": 57382955, "comment_id": 101250495, "body": "Ugh... Ok... So... If I know I am putting 5 workbooks into this array/collection and it will always be these 5 workbooks and that wont change. Should I use an array? or a collection? I will be doing thing like for each workbook in collection/array copy range D1:G1 and paste somewhere... stuff like that"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565121310, "post_id": 57382955, "comment_id": 101250564, "body": "Use whatever is easiest for you."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565121512, "post_id": 57382955, "comment_id": 101250655, "body": "Thank you... I think collection may be easier for me in this situation... but I will try some things tomorrow and see"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1565121206, "post_id": 57383020, "comment_id": 101250519, "body": "Ugh... Ok... So... If I know I am putting 5 workbooks into this array/collection and it will always be these 5 workbooks and that wont change. Should I use an array? or a collection? I will be doing thing like for each workbook in collection/array copy range D1:G1 and paste somewhere... stuff like that"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1565121343, "post_id": 57383020, "comment_id": 101250582, "body": "it is a preference thing."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1565121506, "post_id": 57383020, "comment_id": 101250652, "body": "Thank you... I think collection may be easier for me in this situation... but I will try some things tomorrow and see"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1565120837, "creation_date": 1565120837, "answer_id": 57383020, "question_id": 57382955, "link": "https://stackoverflow.com/questions/57382955/store-workbooks-in-a-collection-or-an-array/57383020#57383020", "title": "Store workbooks in a collection or an array", "body": "<p>to store workbooks in an array we can create an array of workbooks:</p>\n\n<pre><code>Sub kjkj()\n\n    Dim wkbks(1 To 4) As Workbook\n\n    Set wkbks(1) = workbooks.Open(....)\n    Set wkbks(2) = workbooks.Open(....)\n    Set wkbks(3) = workbooks.Open(....)\n    Set wkbks(4) = workbooks.Open(....)\n\n    Dim i As Long\n    For i = 1 To 4\n        With wkbks(i)\n            'do something\n        End With\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 57383020, "answer_count": 1, "score": 0, "last_activity_date": 1565156296, "creation_date": 1565120503, "last_edit_date": 1565156296, "question_id": 57382955, "link": "https://stackoverflow.com/questions/57382955/store-workbooks-in-a-collection-or-an-array", "title": "Store workbooks in a collection or an array", "body": "<p>I recently posted a question about how to \"group\" several open workbooks (not all workbooks). A couple techniques were mentioned, all of which I think I could make work but one technique seemed to stick out at me as being exactly what I needed. Creating a collection and putting the workbooks in the collection. Then I can refer to this collection throughout my program as needed. So... I began reading up on / learning about collections. However, Several articles compared collections to being similar to arrays. Which had me second guessing myself as to which one I should use. I am having trouble understanding if an array can even store \"objects\"? For example can an array store several \"objects\"? i.e: store several \"workbooks\"?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565118946, "post_id": 57382521, "comment_id": 101249514, "body": "Keep in mind that <code>Rows.Count</code> as you are using it is not being fully qualified, so it will be looking at the <code>Rows.Count</code> of the active sheet, not necessarily the one you are specifying."}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565119410, "post_id": 57382521, "comment_id": 101249711, "body": "Is there a way to make it so the workbook(s) I want omitted/not pulled into the master never become active?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1565119497, "post_id": 57382521, "comment_id": 101249756, "body": "<code>If wb &lt;&gt; ThisWorkbook.Name And wb &lt;&gt; &quot;Workbook you want omitted&quot; And wb &lt;&gt; &quot;Workbook2 you want omitted&quot; Then</code>"}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565120028, "post_id": 57382521, "comment_id": 101249983, "body": "@BigBen I&#39;m assuming you meant, &quot;Then no&quot;? But I want to make sure I understand. So, if I want to omit one workbook from the folder, I  have to identify each workbook in the code? I can&#39;t only identify the one I want omitted? Thank you!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565120075, "post_id": 57382521, "comment_id": 101250005, "body": "The <code>&lt;&gt;</code> means not equal - so you&#39;re omitting just those one or two workbooks, which will not get opened."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565122229, "post_id": 57382521, "comment_id": 101250955, "body": "@BigBen while your recommendation will work 100%, she&#39;s looking for a solution that does <i>not</i> require her to edit code every time she changes the list of files to be skipped, which is an admirable goal."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1565122302, "post_id": 57382521, "comment_id": 101250976, "body": "@FreeMan I took it that OP thought a comprehensive list of all the files in the folder, except for the ones to be skipped, was needed, but I could be mistaken."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565122587, "post_id": 57382521, "comment_id": 101251052, "body": "@BigBen that may be the case today, but paragraph 2 explicitly states she doesn&#39;t want to have to edit code when the list changes."}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1565123051, "post_id": 57382521, "comment_id": 101251214, "body": "Both these options were really helpful. BigBen was correct in identifying my thought process but your &quot;outside the box&quot; solution @freeman was what I didn&#39;t know I needed. Thank you both so much!"}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565189630, "post_id": 57382521, "comment_id": 101276012, "body": "@BigBen So, I had a chance to test this out but it&#39;s still opening the And wb &lt;&gt; &quot;Workbook you want omitted&quot;"}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "edited": false, "score": 0, "creation_date": 1565189833, "post_id": 57382521, "comment_id": 101276128, "body": "If wb &lt;&gt; ThisWorkbook.Name And wb &lt;&gt; &quot;Workbook you want omitted&quot; Then &#39;(This is supposed to exclude the open workbook and the \u201comitted\u201d wb from opening but it still opens the \u201cWorkbook you want omitted and then throws an error on this line: ThisWorkbook.Sheets(sh.Name).Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues .  I think it wants me to qualify the wb.open and ranges but I wanted them to be generic so I can reuse this as a template."}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "edited": false, "score": 0, "creation_date": 1565191556, "post_id": 57382521, "comment_id": 101277077, "body": "Never mind, I figured it out! I needed the .xlsm in the title name. ah, so silly."}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1565122163, "creation_date": 1565122163, "answer_id": 57383316, "question_id": 57382521, "link": "https://stackoverflow.com/questions/57382521/when-combining-data-from-multiple-workbooks-into-a-master-with-vba-how-do-i-omi/57383316#57383316", "title": "When Combining data from multiple workbooks into a master with VBA, how do I omit specific files?", "body": "<p>Assuming <code>ThisWorkbook</code> is the one where the code resides, add a worksheet (potentially hidden if other people will look at the workbook and you don't want them to mess with the list) that contains the list of files to skip. Reference that worksheet to populate the list of files not to open.</p>\n\n<p>Note that this is some \"air code\" - it compiles but isn't guaranteed to be 100% perfect. </p>\n\n<ul>\n<li><p>I created a new worksheet and renamed it (via the Project Explorer <code>Right-Click | Rename</code>) to <code>SkipList</code>.</p></li>\n<li><p>I also added a reference to the <code>Microsoft Scripting Runtime</code> (<code>Tools | References</code> scroll down 'til you find that text). </p></li>\n</ul>\n\n<pre><code>Option Explicit\n\nSub MASTERPULL()\n  Dim wb As String, i As Long, sh As Worksheet\n\n  Application.ScreenUpdating = False\n  Application.AskToUpdateLinks = False\n  Application.DisplayAlerts = False\n\n  Dim sourceSheet As Worksheet\n  Set sourceSheet = ActiveSheet\n        '&lt;----omitted some formatting code\n\n  '----------------Change here ----------------------------\n  Dim skipList As Scripting.Dictionary\n  Set skipList = GetFilesToIgnore\n\n  wb = Dir(ThisWorkbook.Path &amp; \"\\*\")\n  Do Until wb = \"\"\n    '----------------Change here ----------------------------\n    If Not skipList.Exists(wb) Then\n      Workbooks.Open ThisWorkbook.Path &amp; \"\\\" &amp; wb\n      For Each sh In Workbooks(wb).Worksheets\n        sh.UsedRange.Offset(1).Copy              '&lt;---- Assumes 1 header row\n        ThisWorkbook.Sheets(sh.Name).Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n        Application.CutCopyMode = False\n      Next sh\n      Workbooks(wb).Close False\n    End If\n    wb = Dir\n    Call sourceSheet.Activate\n  Loop\n\n  Application.ScreenUpdating = True\n  Application.DisplayAlerts = True\n  Application.AskToUpdateLinks = True\n\nEnd Sub\n\n'--------------New Function added here\nPrivate Function GetFilesToIgnore() As Scripting.Dictionary\n\n  Dim theList As Scripting.Dictionary\n  theList.Add ThisWorkbook.Name, 1\n\n  Dim usedCell As Range\n  For Each usedCell In skipList.UsedRange\n    theList.Add usedCell.Value, 1\n  Next\n\n  Set GetFilesToIgnore = theList\n\nEnd Function\n</code></pre>\n\n<p>The code assumes that there is a contiguous list of cells in the <code>SkipList</code> worksheet that contain the names of the files to be ignored. It first adds <em>ThisWorkbook.Name</em> to the dictionary, then  adds the rest of the names from that list into the dictionary. </p>\n\n<p>Now, instead of just skipping <code>ThisWorkbook.Name</code>, you skip if the name exists in the dictionary. This adds the benefit of automatically skipping <code>ThisWorkbook</code> even if its name is changed in addition to having an easily editable list of other files to ignore.</p>\n\n<p>Note that a <code>Dictionary</code> is usually a <code>Key/Value</code> pair - You use it to quickly retrieve a <code>Value</code> by its <code>Key</code>. In this case, we really don't care about a <code>Value</code>, we're just using it because looking the <code>Key</code> up in a <code>Dictionary</code> is very fast. Therefore, I've used a hard-coded <code>1</code> as the value that's tied to all the <code>Key</code>s. It's a throw away number and could be changed to <code>Doesn't matter</code> or anything else that makes you happy.</p>\n\n<p>Also, using <code>SkipList.UsedRange</code> is a quick-n-dirty solution. <code>.UsedRange</code> will return blank cells if you ever remove a name from the list, so it's probably not the best in the long run. </p>\n"}], "owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565122163, "creation_date": 1565118514, "last_edit_date": 1565120728, "question_id": 57382521, "link": "https://stackoverflow.com/questions/57382521/when-combining-data-from-multiple-workbooks-into-a-master-with-vba-how-do-i-omi", "title": "When Combining data from multiple workbooks into a master with VBA, how do I omit specific files?", "body": "<p>I have a folder with a master tracker and multiple workbooks. The code below compiles the workbook data into the master, as expected. </p>\n\n<p>However, I'd like to have one or two wb's in that folder that this code excludes/does not open without having to include the title of every wb in the code (so I can add additional wb's as needed without having to update the script). </p>\n\n<p>I've tried adding a skip like below but I can't seem to get it in the right spot in my code since the file paths and names for the data I want are purposefully designed to not require titles. </p>\n\n<pre><code>FName As String\n\nIf FName = \"Workbook(s) I want omitted\" Then GoTo Skip\n\nSkip:\n    'Find the next file\n    FName = Dir\n  Loop\n  'Done\n\n         Sub MASTERPULL()\n    Dim wb As String, i As Long, sh As Worksheet\n    Application.ScreenUpdating = False\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Dim sourceSheet As Worksheet\n    Set sourceSheet = ActiveSheet\n        '&lt;----omitted some formatting code\n    wb = Dir(ThisWorkbook.Path &amp; \"\\*\")\n    Do Until wb = \"\"\n        If wb &lt;&gt; ThisWorkbook.Name Then\n            Workbooks.Open ThisWorkbook.Path &amp; \"\\\" &amp; wb\n                For Each sh In Workbooks(wb).Worksheets\n                        sh.UsedRange.Offset(1).Copy    '&lt;---- Assumes 1 header row\n                            ThisWorkbook.Sheets(sh.Name).Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n                        Application.CutCopyMode = False\n                Next sh\n            Workbooks(wb).Close False\n        End If\n        wb = Dir\n         Call sourceSheet.Activate\n         Loop\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.AskToUpdateLinks = True\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1565119079, "post_id": 57382505, "comment_id": 101249567, "body": "Does this need to be done in vba?"}, {"owner": {"reputation": 25, "user_id": 11128279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1425968dfc89c224273841be2745a815?s=128&d=identicon&r=PG&f=1", "display_name": "chicken10der", "link": "https://stackoverflow.com/users/11128279/chicken10der"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1565137247, "post_id": 57382505, "comment_id": 101254698, "body": "@Warcupine It doesn\u2019t have to be. If you have suggestions, please let me know. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1565121911, "creation_date": 1565121911, "answer_id": 57383256, "question_id": 57382505, "link": "https://stackoverflow.com/questions/57382505/how-to-copy-corresponding-row-header-and-column-header-if-a-cell-contains-a-numb/57383256#57383256", "title": "How to copy corresponding row header and column header if a cell contains a number in VBA?", "body": "<p>The code below will get you your desired results, see notes in the code for explanation.</p>\n\n<pre><code>Option Explicit\n\n\nSub sample()\n\nDim i As Long, pRow As Long, LastRow As Long, LastCol As Long, Col As Long\nDim Sht As Worksheet, ResSht As Worksheet\n\nSet Sht = ThisWorkbook.Sheets(\"Sheet1\") ' &lt;-- rename worksheet to fit your need\nSet ResSht = ThisWorkbook.Sheets(\"Results\") ' &lt;-- rename worksheet to fit your need\n\nApplication.ScreenUpdating = False\n\nWith Sht\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column ' get last column (Header row of Animals)\n\n    ' add header row in \"Results\"\n    ResSht.Range(\"A1\").Value = \"Colors\"\n    ResSht.Range(\"B1\").Value = \"Animals\"\n    ResSht.Range(\"C1\").Value = \"Value\"\n    pRow = 2\n\n    For i = 2 To LastRow ' loop through rows\n        ' loop through columns\n        For Col = 2 To LastCol\n            ' check if there's a numeric value in cell (and not empty)\n            If IsNumeric(.Cells(i, Col).Value) And Trim(.Cells(i, Col).Value) &lt;&gt; \"\" Then\n                ' add new row to \"Results\"\n                ResSht.Range(\"A\" &amp; pRow).Value = .Range(\"A\" &amp; i).Value ' get the color from column A\n                ResSht.Range(\"B\" &amp; pRow).Value = .Cells(1, Col).Value ' get the Animal from the header row\n                ResSht.Range(\"C\" &amp; pRow).Value = .Cells(i, Col).Value ' get the Value from the cell\n\n                pRow = pRow + 1\n            End If\n        Next Col\n    Next i\n\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11128279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1425968dfc89c224273841be2745a815?s=128&d=identicon&r=PG&f=1", "display_name": "chicken10der", "link": "https://stackoverflow.com/users/11128279/chicken10der"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57383256, "answer_count": 1, "score": 2, "last_activity_date": 1580711031, "creation_date": 1565118414, "last_edit_date": 1580711031, "question_id": 57382505, "link": "https://stackoverflow.com/questions/57382505/how-to-copy-corresponding-row-header-and-column-header-if-a-cell-contains-a-numb", "title": "How to copy corresponding row header and column header if a cell contains a number in VBA?", "body": "<p>I extracted messy, raw data that need to be in a table format.<br>\n<a href=\"https://i.stack.imgur.com/cJXmC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cJXmC.png\" alt=\"raw data\"></a> </p>\n\n<p>This is my goal:<br>\n<a href=\"https://i.stack.imgur.com/N3oBM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N3oBM.png\" alt=\"goal\"></a></p>\n\n<p>The code produces this outcome:<br>\n<a href=\"https://i.stack.imgur.com/VenNC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VenNC.png\" alt=\"outcome\"></a></p>\n\n<pre><code>Sub sample()\n\nDim rnge As Range, erow As Long\n\nlastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastRow\n    If IsNumeric(Worksheets(\"Sheet1\").Cells(i, 2).Value) = True Then\n\n        Worksheets(\"Sheet1\").Cells(i, 1).Copy            \n        erow = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row            \n        Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 1)\n\n        Worksheets(\"Sheet1\").Cells(i, 2).Copy            \n        Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 3)\n\n        Worksheets(\"Sheet1\").Cells(1, 2).Copy            \n        Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Cells(erow + 1, 2)                        \n    End If        \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Based on the outcome, is there any way to remove those data that don't have numeric values? As soon as column B is done, is it possible for the for loop function to move into column C without writing specific code over again?</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 2178, "user_id": 1387701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f5209b17c9efa573f90ab04d476c0936?s=128&d=identicon&r=PG", "display_name": "DMart", "link": "https://stackoverflow.com/users/1387701/dmart"}, "edited": false, "score": 0, "creation_date": 1565116574, "post_id": 57382067, "comment_id": 101248516, "body": "Does this login work manually? It may be an error on your server you&#39;re executing against."}, {"owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "reply_to_user": {"reputation": 2178, "user_id": 1387701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f5209b17c9efa573f90ab04d476c0936?s=128&d=identicon&r=PG", "display_name": "DMart", "link": "https://stackoverflow.com/users/1387701/dmart"}, "edited": false, "score": 0, "creation_date": 1565116742, "post_id": 57382067, "comment_id": 101248591, "body": "yes it works perfectly when i do it manually"}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1565124403, "post_id": 57382067, "comment_id": 101251691, "body": "that&#39;s a server-side error that usually happens when too much data is sent via GET.  Post the HTML for the page of the form."}, {"owner": {"reputation": 1866, "user_id": 1183506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aba83296f9be999e2fab8eab88b4727?s=128&d=identicon&r=PG", "display_name": "mrfreester", "link": "https://stackoverflow.com/users/1183506/mrfreester"}, "edited": false, "score": 0, "creation_date": 1565129203, "post_id": 57382067, "comment_id": 101253213, "body": "Shot in the dark since I&#39;m not familiar with VBA, but is the error different if you <code>Click</code>(Typical) vs send <code>Keys.Enter</code>?   <code>bot.FindElementById(&quot;MainContent_LogOnButton&quot;).Click</code>"}, {"owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "edited": false, "score": 0, "creation_date": 1565164167, "post_id": 57382067, "comment_id": 101261437, "body": "No click produces the same error."}, {"owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "edited": false, "score": 0, "creation_date": 1565164316, "post_id": 57382067, "comment_id": 101261491, "body": "<a href=\"https://www.XXXXXXXX.in/XXXX/(S(cebetkvcfbert45c2h4vu42j))/home.aspx\" rel=\"nofollow noreferrer\">XXXXXXXX.in/XXXX/(S(cebetkvcfbert45c2h4vu42j))/home.aspx</a> i hope its ok to not post the name of the website here"}, {"owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "edited": false, "score": 0, "creation_date": 1565974701, "post_id": 57382067, "comment_id": 101522976, "body": "It was a server side error a shortened url lead me to the same page so the problem was fixed. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "is_accepted": false, "score": 0, "last_activity_date": 1588311896, "creation_date": 1588311896, "answer_id": 61537433, "question_id": 57382067, "link": "https://stackoverflow.com/questions/57382067/automate-website-login-process-using-selenium-webdriver/61537433#61537433", "title": "Automate website login process using selenium webdriver", "body": "<p>It was a server side error a shortened url lead me to the same page so the problem was fixed. Thanks. \u2013</p>\n"}], "owner": {"reputation": 13, "user_id": 11891197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qV-SpcJsSbE/AAAAAAAAAAI/AAAAAAAAADQ/Gc7LDlBYjqk/photo.jpg?sz=128", "display_name": "OB1", "link": "https://stackoverflow.com/users/11891197/ob1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1588311896, "creation_date": 1565116382, "last_edit_date": 1565155962, "question_id": 57382067, "link": "https://stackoverflow.com/questions/57382067/automate-website-login-process-using-selenium-webdriver", "title": "Automate website login process using selenium webdriver", "body": "<p>Im trying to login to a website using selenium webdriver and excel VBA but im getting stuck at the log in page</p>\n\n<p>im using the following code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim bot As New WebDriver\n\nbot.Start \"chrome\", \"myurl\"\nbot.Get \"/\"\n\n'select from drop down\nbot.FindElementById(\"MainContent_ddlRoleType\").AsSelect.SelectByValue \"7\"\n\nbot.FindElementById(\"MainContent_UserName\").SendKeys \"userid\"\nbot.FindElementById(\"MainContent_Password\").SendKeys \"password\"\n\n'select from drop down\nbot.FindElementById(\"MainContent_ddlAuxCentre\").AsSelect.SelectByValue \"1\"\n\nbot.FindElementById(\"MainContent_LogOnButton\").SendKeys bot.Keys.Enter\n</code></pre>\n\n<p>all data is entered properly till the log in button is clicked which produces the following error message:</p>\n\n<blockquote>\n  <p>The length of the URL for this request exceeds the configured maxUrlLength value.</p>\n  \n  <p>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </p>\n  \n  <p>Exception Details: System.Web.HttpException: The length of the URL for this request exceeds the configured maxUrlLength value.</p>\n  \n  <p>Source Error: </p>\n  \n  <p>An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.</p>\n</blockquote>\n\n<p>Stack Trace: </p>\n\n<pre><code>[HttpException (0x80004005): The length of the URL for this request exceeds the configured maxUrlLength value.]\n   System.Web.HttpRequest.ValidateInputIfRequiredByConfig() +11320030\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +371\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1565118027, "creation_date": 1565118027, "answer_id": 57382415, "question_id": 57381679, "link": "https://stackoverflow.com/questions/57381679/assign-one-class-module-sub-to-multiple-optionbuttons-vba/57382415#57382415", "title": "Assign one class module sub to multiple OptionButtons vba", "body": "<p>You need a global collection to hold the instances of <code>clsSectorbtn</code>, and it's easier to use a \"factory\" function to build each instance.</p>\n\n<p>I'd do something like this:</p>\n\n<pre><code>Dim colBtn As Collection    \n\nSub Create_Radios(Radio_Array)\n    Dim RadioArray (0 to 2) As String\n    RadioArray(0) = \"optionbutton1\"\n    RadioArray(1) = \"optionbutton2\"\n    RadioArray(2) = \"optionbutton3\"\n    Set Fm = UserForm1(\"Frame1\")\n\n    Set colBtn = New collection\n    For x = 0 To UBound(Radio_Array)\n        Set opt = Fm.Object.Controls.Add(\"Forms.OptionButton.1\")\n        opt.Caption = Radio_Array(x)\n        colBtn.Add OptObject(opt)\n    Next x\nEnd Sub\n\n'create an instance of clsSectorbtn and assign an option button to it\nFunction OptObject(opt) As clsSectorbtn\n    Dim rv as New clsSectorbtn\n    Set rv.Focus_btn = opt\n    Set OptObject = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 10963024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddd1a787c59942a7afd56298fc5a05f?s=128&d=identicon&r=PG&f=1", "display_name": "stephen.webb", "link": "https://stackoverflow.com/users/10963024/stephen-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 57382415, "answer_count": 1, "score": 0, "last_activity_date": 1582696411, "creation_date": 1565114527, "last_edit_date": 1582696411, "question_id": 57381679, "link": "https://stackoverflow.com/questions/57381679/assign-one-class-module-sub-to-multiple-optionbuttons-vba", "title": "Assign one class module sub to multiple OptionButtons vba", "body": "<p>I'm dynamically creating option buttons on a form in Microsoft Word. I programatically assign the new options buttons a sub by way of the code below, but I can't work out how to assign one class to many buttons. Is this possible?</p>\n\n<p>The code below works, but it only throws the message box up on the last button. I think what my code is doing is reassigning this class to the newest button each time, rather than adding a button to that class if that makes sense? How would I go about doing it the other way around so many buttons call the Focus_btn_Click event?</p>\n\n<p>My Class (called \"clsSectorbtn\"):</p>\n\n<pre><code>Public WithEvents Focus_btn As MSForms.OptionButton\nSub Focus_btn_Click()\n    Msgbox \"Test\"\nEnd Sub\n</code></pre>\n\n<p>Code within my form:</p>\n\n<pre><code>Dim SectorBtn As New clsSectorBtn    \nSub Create_Radios(Radio_Array)\n    Dim RadioArray (0 to 2) As String\n    RadioArray(0) = \"optionbutton1\"\n    RadioArray(1) = \"optionbutton2\"\n    RadioArray(2) = \"optionbutton3\"\n    Set Fm = UserForm1(\"Frame1\")\n\n    For x = 0 To UBound(Radio_Array)\n        Set opt = Fm.Object.Controls.Add(\"Forms.OptionButton.1\")\n        opt.Caption = Radio_Array(x)\n        Set SectorBtn.Focus_btn = opt\n    Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1565115479, "post_id": 57381379, "comment_id": 101248064, "body": "Try the answer below"}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 2, "last_activity_date": 1565114188, "creation_date": 1565114188, "answer_id": 57381605, "question_id": 57381379, "link": "https://stackoverflow.com/questions/57381379/how-to-fix-compile-error-invalid-use-of-property/57381605#57381605", "title": "How to fix compile error: Invalid use of property", "body": "<pre><code>    With wkb_1\n        Set ws_1 = .Worksheets(\"Sheet1\")\n        Set rng_1 = ws_1.Columns(\"A:AQ\")\n        rng_1.EntireColumn.Hidden = False\n    End With\n\n    With wkb_2\n        Set ws_2 = .Worksheets(\"Sheet1\")\n        Set rng_2 = ws_2.Range(\"A1\").CurrentRegion\n    End With\n\n    rng_2.Copy\n    rng_1.PasteSpecial xlPasteValues\n\n    wkb_2.Close SaveChanges:=False\n\n    Dim LastRow As Long\n    With ws_1\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        .Range(\"AQ2:BF\" &amp; LastRow).FillDown\n    End With\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11825910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XTOm11zDA4k/AAAAAAAAAAI/AAAAAAAAAAw/GCptXMtCafg/photo.jpg?sz=128", "display_name": "sati_space", "link": "https://stackoverflow.com/users/11825910/sati-space"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 57381605, "answer_count": 1, "score": 1, "last_activity_date": 1565155935, "creation_date": 1565113141, "last_edit_date": 1565155935, "question_id": 57381379, "link": "https://stackoverflow.com/questions/57381379/how-to-fix-compile-error-invalid-use-of-property", "title": "How to fix compile error: Invalid use of property", "body": "<p>I'm trying to drag all the formulas from a workbook from column AQ2 to BF, but when I'm assisgning the count for the lastrow variable, it keeps giving me an error</p>\n\n<p>Already tried just doing it without the variable lastrow, but it's giving me the same error</p>\n\n<pre><code>Option Explicit\nDim mt_roster As String\nDim roster As String\nDim wkb_1 As Workbook\nDim wkb_2 As Workbook\nDim ws_1 As Worksheet\nDim ws_2 As Worksheet\nDim rng_1 As Range\nDim rng_2 As Range\nDim lastrow As Range\n\nSub mtm_roster()\n\n' mtm_roster Macro\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    open_rosters\n\n    With wkb_1\n        wkb_1.Activate\n        Set ws_1 = Worksheets(\"Sheet1\")\n        Set rng_1 = ws_1.Columns(\"A:AQ\")\n        rng_1.EntireColumn.Hidden = False\n    End With\n\n    With wkb_2\n        wkb_2.Activate\n        Set ws_2 = Worksheets(\"Sheet1\")\n        Set rng_2 = ws_2.Range(\"A1\").CurrentRegion\n        rng_2.Select\n    End With\n\n    rng_2.Copy\n    rng_1.PasteSpecial xlPasteValues\n\n    wkb_2.Close SaveChanges:=False\n\n    With wkb_1\n        wkb_1.Activate\n        ws_1.Activate\n        Set lastrow = Range(\"A1\")\n        lastrow.CurrentRegion.Rows.Count\n        Range(\"AQ2:BF\" &amp; lastrow).FillDown\n\n    End With\n</code></pre>\n\n<p>I'm trying to drag the formulas from AQ:BF all the way down but I'm still missing that part.</p>\n"}, {"tags": ["excel", "vba", "solver"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565113181, "post_id": 57381352, "comment_id": 101247134, "body": "Set a variable to <code>range(&quot;R67&quot;)</code> use its address property in Solver and use the address of that variable , e.g. <code>r.offset(,-2).address</code>?"}, {"owner": {"reputation": 1, "user_id": 11890912, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lO3qFdMfIwo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcg4CmQlz_qkAwBJ6-758isSajXDw/photo.jpg?sz=128", "display_name": "VBAstruggs", "link": "https://stackoverflow.com/users/11890912/vbastruggs"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565270668, "post_id": 57381352, "comment_id": 101307420, "body": "@SJR Thank you! much appreciated"}], "owner": {"reputation": 1, "user_id": 11890912, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lO3qFdMfIwo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcg4CmQlz_qkAwBJ6-758isSajXDw/photo.jpg?sz=128", "display_name": "VBAstruggs", "link": "https://stackoverflow.com/users/11890912/vbastruggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565155899, "creation_date": 1565113005, "last_edit_date": 1565155899, "question_id": 57381352, "link": "https://stackoverflow.com/questions/57381352/excel-solver-macro-offset-and-repeat", "title": "Excel solver macro offset and repeat", "body": "<p>Repeat excel macro solver every xx Rows with new reference</p>\n\n<p>First time macro creator... I made a macro to run a solver. I have a similar solver running every 11 rows in my sheet and would like for the macro to update all solvers, not just the top one. </p>\n\n<p>The one solver that is running off the macro solves for cell Q56 on the \"menu\" such that cell R56 will be set to zero. It sets r56 to 0 by changing q56.</p>\n\n<p>I want to repeat this same process for later cells:\nset r67 to 0 by changing q67,\nset r78 to 0 by changing q78,\nsets r89 to 0 by changing q89\netc., ending with setting r166 to 0 by changing q166</p>\n\n<p>Is there a way to add an offset function that loops / repeats the solver that is in place for later cell references?</p>\n\n<pre><code>Sub AutoSolver1()\n\n' AutoSolver1 Macro\n    'Reset Solver\n    'Solver Reset\n\n    SolverOk SetCell:=\"$R$56\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$Q$56\", Engine _\n        :=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverOk SetCell:=\"$R$56\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$Q$56\", Engine _\n        :=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve userFinish:=True\nEnd Sub\n</code></pre>\n\n<p>The code i pasted will work for the top solver. i tried some variations to make it repeat for a new reference every 11th line but everything i have tried has yielded an error message</p>\n"}]