[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1550748403, "post_id": 54796695, "comment_id": 96388208, "body": "Welcome to SO. Where are you stuck? What problems are you having? You have posted what you are trying to do, but not what error or specific problem you are having. Remember, this website is not a free coding service, but community will gladly answer specific questions about coding, not developing codes."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "is_accepted": false, "score": 0, "last_activity_date": 1550748610, "creation_date": 1550748610, "answer_id": 54806055, "question_id": 54796695, "link": "https://stackoverflow.com/questions/54796695/copy-specific-range-from-multiple-worksheet-to-a-single-worksheet-as-rolling-rep/54806055#54806055", "title": "Copy Specific range from multiple worksheet to a single worksheet as rolling report", "body": "<p>Don't understand the issue, but some tips:</p>\n\n<p>Find the last row used, using:</p>\n\n<pre><code>Dim LastRow As Long\nDim ws as Worksheet\nLastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>Note: column 1 (A) is searched.</p>\n\n<p>Loop through all worksheets using:</p>\n\n<pre><code>Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n         'Your code goes here\n    next ws\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1550752193, "last_edit_date": 1550752193, "creation_date": 1550750509, "answer_id": 54806601, "question_id": 54796695, "link": "https://stackoverflow.com/questions/54796695/copy-specific-range-from-multiple-worksheet-to-a-single-worksheet-as-rolling-rep/54806601#54806601", "title": "Copy Specific range from multiple worksheet to a single worksheet as rolling report", "body": "<pre><code>Take this as base and adjust to your requirement. This program is Untested and may require adjustment for Header Rows. I have commented out Header Rows in program keeping in view you want to start from `Row1`\n\nSub CopyToReport()\n    Dim wrk As Workbook         'Workbook object - Always good to work with object variables\n    Dim sht As Worksheet        'Object for handling worksheets in loop\n    Dim trg As Worksheet        'Master Worksheet\n    Dim rng As Range            'Range object\n    Dim colCount As Integer     'Column count in tables in the worksheets\n\n    'Speed things up\n        Application.ScreenUpdating = False\n        Application.DisplayAlerts = False\n\n    'Working in active workbook\n        Set wrk = ActiveWorkbook\n\n    'Create/Reset the Report sheet\n        If Evaluate(\"ISREF(Report!A1)\") Then\n            wrk.Sheets(\"Report\").Move After:=Worksheets(Worksheets.Count)\n            wrk.Sheets(\"Report\").Cells.Clear\n        Else\n            wrk.Worksheets.Add(After:=wrk.Worksheets(wrk.Worksheets.Count)).Name = \"Report\"\n        End If\n\n        Set trg = wrk.Sheets(\"Report\")\n\n        'Get column headers from the first worksheet\n            'Column count first\n            Set sht = wrk.Worksheets(1)\n           ' colCount = sht.Cells(1, Columns.Count).End(xlToLeft).Column\n             colCount =9\n            'Now retrieve headers, no copy&amp;paste needed\n            'With trg.Cells(1, 1).Resize(1, colCount)\n             '   .Value = sht.Cells(1, 1).Resize(1, colCount).Value\n              '  'Set font as bold\n               ' .Font.Bold = True\n            'End With\n\n        'We can start loop\n        For Each sht In wrk.Worksheets\n            'Execute on every sheet except the Master\n            If sht.Name &lt;&gt; \"Master\" Then\n                'Data range in worksheet - starts from second row as first rows are the header rows in all worksheets\n                'Set rng = sht.Range(sht.Cells(1, 1), sht.Cells(Rows.Count, colCount).End(xlUp))\n                Set rng = sht.Range(\"A1:I14\")\n                'Put data into the Master worksheet\n                trg.Cells(Rows.Count, 1).End(xlUp).Offset(1).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\n            End If\n        Next sht\n\n        'Fit the columns in Master worksheet\n            trg.Columns.AutoFit\n\n        'Screen updating should be activated\n            Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11092808, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iw18RrLkGB4/AAAAAAAAAAI/AAAAAAAAAEc/Sjk9yiE8X6Q/photo.jpg?sz=128", "display_name": "Noslen", "link": "https://stackoverflow.com/users/11092808/noslen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550752193, "creation_date": 1550704078, "last_edit_date": 1550734654, "question_id": 54796695, "link": "https://stackoverflow.com/questions/54796695/copy-specific-range-from-multiple-worksheet-to-a-single-worksheet-as-rolling-rep", "title": "Copy Specific range from multiple worksheet to a single worksheet as rolling report", "body": "<p>This is my first time so sorry in advance.</p>\n\n<p>I have a file with several sheets, I need to copy from A14 to I14 and then do </p>\n\n<pre><code>Range(Selection, Selection.End(xlDown)).Select\n</code></pre>\n\n<p>In order to capture all the data from the original range to the bottom, all sheets have different number of rows thats why I need to do that.</p>\n\n<p>Once the data is selected I need to copy and paste in another tab called \"Report\", and I need to do that for each sheet in the workbook.</p>\n\n<p>Everytime a sheet is paste into the \"Report\" tab next sheet needs to go in the next avialbale row of the \"Report\" tab in other words I can not paste above the last information. Is a rolling report.</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550706063, "post_id": 54796661, "comment_id": 96371797, "body": "What line throws the error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550707193, "post_id": 54796661, "comment_id": 96372054, "body": "<code>rst</code> doesn&#39;t have a Field named &quot;Equipment&quot; Try something like <code>&quot;SELECT DISTINCT TOP 25 [Equipment] as Equipment FROM tblEquipment...</code>  Test your query first, and check the column names in the results are what you expect"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1550727242, "post_id": 54796661, "comment_id": 96376824, "body": "what kind of &quot;combobox&quot; did you place in the Word document? There&#39;s more than one kind. Most likely you didn&#39;t use a form field, but something else. Maybe a content control?"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550762777, "post_id": 54796661, "comment_id": 96397949, "body": "Thank you all so much for the quick replies. Answers below"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550762783, "post_id": 54796661, "comment_id": 96397955, "body": "What line throws the error? -------I do not know. How do I check this?"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550762851, "post_id": 54796661, "comment_id": 96397997, "body": "what kind of &quot;combobox&quot; did you place in the Word document? There&#39;s more than one kind. Most likely you didn&#39;t use a form field, but something else. Maybe a content control? ------------------Yes, I am using a content control, do you recommend another method?"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550762897, "post_id": 54796661, "comment_id": 96398027, "body": "rst doesn&#39;t have a Field named &quot;Equipment&quot; Try something like &quot;SELECT DISTINCT TOP 25 [Equipment] as Equipment FROM tblEquipment... Test your query first, and check the column names in the results are what you expect ----------------I will try this and let you know"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550765115, "post_id": 54796661, "comment_id": 96399519, "body": "Private Sub Document_Open()     On Error GoTo Document_Open_Err          Dim cnn As New ADODB.Connection     Dim rst As New ADODB.Recordset          cnn.Open &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=**;&quot;     rst.Open &quot;SELECT DISTINCT TOP 25 [Field1] as Equipment_List FROM Equipment_List ORDER BY [Field1];&quot;, _         cnn, adOpenStatic     rst.MoveFirst          With ActiveDocument.ContentControl(&quot;Equipment&quot;).DropDown.ListEntr&zwnj;&#8203;ies         .Clear         Do             .Add rst![Field1]             rst.MoveNext         Loop Until rst."}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550765204, "post_id": 54796661, "comment_id": 96399586, "body": "Field: Field1 Table: Equipment_List Dropdown: Content Control Dropdown named &quot;Equipment&quot;  Error: -2147217904 No value for given parameters"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550767784, "post_id": 54796661, "comment_id": 96401228, "body": "Ok I got it to partially work with using a form field rather than a using content control and getting the name right. Now the issue is the dropdown box just fills with the first value, there is no dropdown to select other items."}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1550777838, "post_id": 54796661, "comment_id": 96406269, "body": "Is there any way to use a combo box or a better dropdown? The form field box will only populate the first value and I cannot change it"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1550787936, "post_id": 54796661, "comment_id": 96410639, "body": "To find the error line, change <code>On Error GoTo Document_Open_Err</code> to <code>On Error GoTo 0</code> so it will break on the error line."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550816486, "post_id": 54796661, "comment_id": 96417316, "body": "Some tips for using the site that would have gotten you responses and possibly even answers much sooner: 1) you need to &quot;ping&quot; people by using the<code>@</code> plus their name - @Zed - otherwise there&#39;s no notification. 2) Use the <a href=\"https://stackoverflow.com/posts/54796661/edit\">edit</a> link to put additional, relevant information into the question itself. It&#39;s impossible to keep track or properly read code in comments. Do this, ping me, and I might be able to help as this is a Word problem, not an Access one."}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1552312362, "post_id": 54796661, "comment_id": 96949568, "body": "@Andre - just tagging per cindy&#39;s recomendation"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1552312378, "post_id": 54796661, "comment_id": 96949583, "body": "@TimWilliams- just tagging per cindy&#39;s recomendation"}, {"owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "edited": false, "score": 0, "creation_date": 1552312397, "post_id": 54796661, "comment_id": 96949597, "body": "@ryguy72- just tagging per cindy&#39;s recomendation"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552329953, "post_id": 54796661, "comment_id": 96959795, "body": "Zed, could you click the &quot;flag&quot; next to the comments that are no longer relevant to the question and choose to remove them as &quot;no longer needed&quot;? It&#39;s difficult to tell what is or is not working, at this point."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552330136, "post_id": 54796661, "comment_id": 96959875, "body": "Zed, I notice that <code>.Add rst![Field1]</code> does not specify <i>what</i> should be coming from this field. Should it be <code>Value</code>, as in <code>.Add rst![Field1].Value</code>? I also recommend you remove <code>On Error Resume Next</code> as it&#39;s very important to know whether these objects are closed and correctly released. You might want to put a Break Point at the <code>Do</code> loop then use F8 to step through it. Does it loop more than once?"}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550816537, "post_id": 54818399, "comment_id": 96417332, "body": "This information is irrelevant to the content of the question. The dropdown is in Word, not Access."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550874078, "post_id": 54818399, "comment_id": 96446759, "body": "Oh, I see.  I just updated my original post.  @Zed: try the solution that I just posted.  I did a quick test and it worked fine for me."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550874011, "last_edit_date": 1550874011, "creation_date": 1550796215, "answer_id": 54818399, "question_id": 54796661, "link": "https://stackoverflow.com/questions/54796661/ms-word-drop-down-list-or-combo-box-from-ms-access-database/54818399#54818399", "title": "MS Word Drop down list or combo box from MS Access Database", "body": "<p>I'm updating my last post here.  See the code below; set a reference to DAO and make a couple minor tweaks to suit your needs.</p>\n\n<pre><code>Option Explicit\n'Requires a reference to the '\"Microsoft DAO 3.51 (or 3.6) Object Library.\"\nPrivate Sub Userform_Initialize()\nDim myDataBase As DAO.Database\nDim myActiveRecord As DAO.Recordset\nDim i As Long\n  'Open the database to retrieve data\n  Set myDataBase = OpenDatabase(\"D:\\Data Stores\\sourceAccess.mdb\")\n  'Define the first recordset\n  Set myActiveRecord = myDataBase.OpenRecordset(\"Table1\", dbOpenForwardOnly)\n  'Set the listbox column count\n  ListBox1.ColumnCount = myActiveRecord.Fields.Count\n  i = 0\n  'Loop through all the records in the table until the EOF marker is reached.\n  Do While Not myActiveRecord.EOF\n    'Use .AddItem method to add a new row for each record\n    ListBox1.AddItem\n    ListBox1.List(i, 0) = myActiveRecord.Fields(\"Employee Name\")\n    ListBox1.List(i, 1) = myActiveRecord.Fields(\"Employee DOB\")\n    ListBox1.List(i, 2) = myActiveRecord.Fields(\"Employee ID\")\n    i = i + 1\n    'Get the next record\n    myActiveRecord.MoveNext\n  Loop\n  'Close the database and clean-up\n  myActiveRecord.Close\n  myDataBase.Close\n  Set myActiveRecord = Nothing\n  Set myDataBase = Nothing\nlbl_Exit:\n  Exit Sub\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nDim oRng As Word.Range\nDim oBM As Bookmarks\n  Set oBM = ActiveDocument.Bookmarks\n  Set oRng = oBM(\"EmpName\").Range\n  oRng.Text = ListBox1.Text\n  oBM.Add \"EmpName\", oRng\n  Set oRng = oBM(\"EmpDOB\").Range\n  oRng.Text = ListBox1.List(ListBox1.ListIndex, 1)\n  oBM.Add \"EmpDOB\", oRng\n  Set oRng = oBM(\"EmpID\").Range\n  oRng.Text = ListBox1.List(ListBox1.ListIndex, 2)\n  oBM.Add \"EmpID\", oRng\n  Me.Hide\nlbl_Exit:\n  Exit Sub\nEnd Sub\n</code></pre>\n\n<p>Code Source:</p>\n\n<p><a href=\"https://gregmaxey.com/word_tip_pages/populate_userform_listbox_or_combobox.html\" rel=\"nofollow noreferrer\">https://gregmaxey.com/word_tip_pages/populate_userform_listbox_or_combobox.html</a></p>\n"}], "owner": {"reputation": 19, "user_id": 11092804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635688f4e1024a41e653d3dc7bd3f5c6?s=128&d=identicon&r=PG&f=1", "display_name": "Zed", "link": "https://stackoverflow.com/users/11092804/zed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1550874011, "creation_date": 1550703898, "last_edit_date": 1550787868, "question_id": 54796661, "link": "https://stackoverflow.com/questions/54796661/ms-word-drop-down-list-or-combo-box-from-ms-access-database", "title": "MS Word Drop down list or combo box from MS Access Database", "body": "<p>I'm trying to populate a combo box or drop down list from an access database. I used the following website for code template. I modified it to suit my needs. I keep getting the error: 5941 The requested member of the collection does not exist\"</p>\n\n<p>Source code: <a href=\"http://www.fontstuff.com/mailbag/qword02.htm\" rel=\"nofollow noreferrer\">http://www.fontstuff.com/mailbag/qword02.htm</a></p>\n\n<p>My Code:</p>\n\n<pre><code>Private Sub Document_Open()\n    On Error GoTo Document_Open_Err\n\n    Dim cnn As New ADODB.Connection\n    Dim rst As New ADODB.Recordset\n\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=*path to database removed for post*;\"\n    rst.Open \"SELECT DISTINCT TOP 25 [Equipment] FROM tblEquipment ORDER BY [Equipment];\", _\n        cnn, adOpenStatic\n    rst.MoveFirst\n\n    With ActiveDocument.FormFields(\"Equipment\").DropDown.ListEntries\n        .Clear\n        Do\n            .Add rst![Equipment]\n            rst.MoveNext\n        Loop Until rst.EOF\n    End With\nDocument_Open_Exit:\n    On Error Resume Next\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n    Exit Sub\nDocument_Open_Err:\n    MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n    Resume Document_Open_Exit\nEnd Sub\n</code></pre>\n\n<p>Code that almost works:</p>\n\n<pre><code>Private Sub Document_Open()\n    On Error GoTo Document_Open_Err\n\n    Dim cnn As New ADODB.Connection\n    Dim rst As New ADODB.Recordset\n\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=*removed for post*;\"\n    rst.Open \"SELECT DISTINCT TOP 25 [Field1] FROM Equipment_List ORDER BY [Field1];\", _\n        cnn, adOpenStatic\n    rst.MoveFirst\n\n    With ActiveDocument.FormFields(\"Equipment\").DropDown.ListEntries\n        .Clear\n        Do\n            .Add rst![Field1]\n            rst.MoveNext\n        Loop Until rst.EOF\n    End With\nDocument_Open_Exit:\n    On Error Resume Next\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n    Exit Sub\nDocument_Open_Err:\n    MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n    Resume Document_Open_Exit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "edited": false, "score": 0, "creation_date": 1550748343, "post_id": 54796334, "comment_id": 96388163, "body": "what is the specific question/issue?"}, {"owner": {"reputation": 21, "user_id": 10672706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9QZ5.jpg?s=128&g=1", "display_name": "KBE11416", "link": "https://stackoverflow.com/users/10672706/kbe11416"}, "reply_to_user": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "edited": false, "score": 0, "creation_date": 1550761874, "post_id": 54796334, "comment_id": 96397235, "body": "The formula is only returning zeros, there should be different numbers populating."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1550797788, "last_edit_date": 1550797788, "creation_date": 1550797027, "answer_id": 54818508, "question_id": 54796334, "link": "https://stackoverflow.com/questions/54796334/vba-sumifs-multiple-open-workbooks-criteria/54818508#54818508", "title": "VBA Sumifs multiple open workbooks &amp; criteria", "body": "<p>I think the easiest way to do things like this, at least in the beginning, is to record the steps, as you click through each one.  I just did it, and came up with this, below.</p>\n\n<pre><code>Sub Macro1()\n\n    ActiveCell.FormulaR1C1 = _\n        \"=SUMIF([Book1.xlsx]Sheet1!RC:RC,\"\"A\"\",[Book1.xlsx]Sheet1!RC[1]:RC[5])\"\n    Range(\"A1\").Select\n    Selection.AutoFill Destination:=Range(\"A1:A10\")\n    Range(\"A1:A10\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Using the Sumproduct function, as an alternative, I came up with this.</p>\n\n<pre><code>Sub Macro2()\n\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUMPRODUCT(([Book1.xlsx]Sheet1!RC=\"\"A\"\")*([Book1.xlsx]Sheet1!RC[1]:RC[5]))\"\n    Range(\"A1\").Select\n    Selection.AutoFill Destination:=Range(\"A1:A10\")\n    Range(\"A1:A10\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10672706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9QZ5.jpg?s=128&g=1", "display_name": "KBE11416", "link": "https://stackoverflow.com/users/10672706/kbe11416"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550797788, "creation_date": 1550702147, "last_edit_date": 1550734586, "question_id": 54796334, "link": "https://stackoverflow.com/questions/54796334/vba-sumifs-multiple-open-workbooks-criteria", "title": "VBA Sumifs multiple open workbooks &amp; criteria", "body": "<p>I am trying to sum all data in column from an external workbook, there are no NA values present and my formula returns only zeros.  </p>\n\n<p>Sum range: Global file column EU4:EU\nCriteria 1 Range: Global File column L4:L\nCriteria 1: ForecastBI: Column B\nCriteria 2 Range: Global File column K4:K\nCriteria 2: ForecastBI: Column C\nCriteria 3 Range: Global File column KY4:K\nCriteria 3: ForecastBI: Column D</p>\n\n<pre><code>Dim Master As Excel.Worksheet: Set Master = Application.Workbooks(\" \nGlobal_File.xlsm\").Worksheets(\"data\")\nDim LrHc As Long: LrHc = Master.Cells(Rows.Count, \"A\").End(xlUp).Row\nDim LcHc As Long: LcHc = Master.Cells(5, Columns.Count).End(xlToLeft).Column \n+ 1\n\nDim ForecastBI As Excel.Worksheet: Set ForecastBI = \nApplication.Workbooks(\"Actual.xlsm\").Worksheets(\"Act\")\nDim LrUpload As Long: LrUpload = ForecastBI.Cells(Rows.Count, \n\"A\").End(xlUp).Row\nDim LcUpload As Long: LcUpload = ForecastBI.Cells(2, \nColumns.Count).End(xlToLeft).Column + 1\n\n'''Sum range\nDim Fte1 As Excel.Range: Set Fte1 = Master.Range(\"EU4:EU\" &amp; LrHc)\n\nDim Country As Excel.Range: Set Country = Master.Range(\"L4:L\" &amp; LrHc)\nDim CountryCriteria As Range: Set CountryCriteria = ForecastBI.Range(\"B2:B\" &amp; \nLrUpload)\n\nDim Region As Excel.Range: Set Region = Master.Range(\"K4:K\" &amp; LrHc)\nDim RegionCriteria As Range: Set RegionCriteria = ForecastBI.Range(\"C2:C\" &amp; \nLrUpload)\n\nDim DB As Excel.Range: Set DB = Master.Range(\"KY4:KY\" &amp; LrHc)\nDim DBCriteria As Range: Set DBCriteria = ForecastBI.Range(\"D2:D\" &amp; LrUpload)\n\nFor x = x To LrUpload\n\nIf ForecastBI.Cells(x, 1) = Master.Cells(2, 55) Then\n   Cells(x, 8).Value = Application.Worksheetfunction.SumIfs(Fte1, _\n      Country, CountryCriteria.Cells(x, 2).Value, _\n      Region, RegionCriteria.Cells(x, 3).Value, _\n      DB, DBCriteria.Cells(x, 4).Value)\n\nElse: ForecastBI.Cells(x, 8) = 0\n\nEnd If\n\nNext x\n</code></pre>\n"}, {"tags": ["excel", "vba", "reference"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 2, "creation_date": 1550702094, "post_id": 54796078, "comment_id": 96370550, "body": "Please paste your code in the question as a code snippet, not as an image."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1550702308, "post_id": 54796078, "comment_id": 96370624, "body": "The short answer is: use late-binding."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551282319, "post_id": 54796401, "comment_id": 96585404, "body": "This coding works, but doesn&#39;t allow for the email to sent via the gmail account in the original coding :/ is there a way to specify to be sent via gmail with this coding without having to change the references used?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551282489, "post_id": 54796401, "comment_id": 96585505, "body": "@S.Jarrett You need to just use late-binding to create your CDO object instead - <code>CreateObject(&quot;CDO.Message&quot;)</code> - see <a href=\"https://stackoverflow.com/questions/38032951/use-cdo-send-emails-in-excel-vba-not-working\">here</a> for a better example."}, {"owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551293052, "post_id": 54796401, "comment_id": 96591421, "body": "I have been trying that all morning and am getting an &quot;Automation error&quot; each time I try to run the coding"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 3, "last_activity_date": 1550702453, "creation_date": 1550702453, "answer_id": 54796401, "question_id": 54796078, "link": "https://stackoverflow.com/questions/54796078/including-code-for-library-reference-to-sending-an-email-via-excel/54796401#54796401", "title": "Including code for library reference to sending an email via excel", "body": "<p>Don't use early binding - here is an example of creating an email from Excel without any references:</p>\n\n<pre><code>Sub LateBindingEmailExample()\n\n    Dim mail As Object, msg As Object\n\n    Set mail = CreateObject(\"Outlook.Application\")\n    Set msg = mail.createitem(0)\n\n    With msg\n        .To = \"exampleemail@exampledomain.com\"\n        .Subject = \"Here is the subject\"\n        .htmlBody = \"Here is the body\"\n        .Display\n        '.Send\n    End With\n\n    Set msg = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551282407, "post_id": 54796457, "comment_id": 96585463, "body": "Thank you for your response!  This is a good suggestion, however the men I work with will consider this too much hassle and not want to take the extra steps, which is why I need to create coding that does everything automatically and only requires them to press the button to send the email after report approval."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551283400, "post_id": 54796457, "comment_id": 96586144, "body": "@S.Jarrett in fact, when you do something like this they will still have to click a single button. The difference is that instead of clicking the button on the spreadsheet, they click it on their ribbon and so they can send by email any sheet without necessarily having the code in it."}, {"owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551293114, "post_id": 54796457, "comment_id": 96591450, "body": "I do not need to email any sheets from the excel. I just need to send a pre-generated email stating &quot;New reports have been approved and are available via your client access.&quot;"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551303312, "post_id": 54796457, "comment_id": 96595992, "body": "@S.Jarrett same principle, an Add-In is just an easier way to distribute code. When you distribute it inside an Excel workbook, they need to open <i>that specific</i> Excel workbook and run <i>that specific button</i>. When your code is not dependent on any workbook, then an add-in allows you to run <i>that specific code</i> by <i>any Excel workbook</i> (even if they are working on something else). But I understand it&#39;d be easier for you to just code it into a static workbook :)"}, {"owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "edited": false, "score": 0, "creation_date": 1551725945, "post_id": 54796457, "comment_id": 96737242, "body": "I found a code that works, thank you for your time and input!"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1550702745, "creation_date": 1550702745, "answer_id": 54796457, "question_id": 54796078, "link": "https://stackoverflow.com/questions/54796078/including-code-for-library-reference-to-sending-an-email-via-excel/54796457#54796457", "title": "Including code for library reference to sending an email via excel", "body": "<p>What you're looking for is called a \"VBA Add-in for Microsoft Excel\".\nPasting here the definition from <a href=\"http://www.cpearson.com/excel/CreateAddIn.aspx\" rel=\"nofollow noreferrer\">CPearson website</a>:</p>\n\n<blockquote>\n  <p>An XLA Add-In is a certain type of workbook that provides custom functions and/or tools that extend the basic functionality of Excel. An Add-In may contain User Defined Functions that provide calculation functions specific to your own area of interest or business, functions that extend beyond the normal calculation capability of Excel. An Add-In can also provide tools to manipulate the data in a workbook. Indeed, an Add-In can be written to do nearly anything you want. If it can be done manually, it can be automated with an XLA Add-In.</p>\n</blockquote>\n\n<p>The high level reasoning is the following:</p>\n\n<ul>\n<li>You put the \"send an email\" code you have in your workbook in a new workbook, in which you add all the necessary references and generic code</li>\n<li>Then, you save your workbook as an Add-in instead of a simple Macro-activated Workbook (extension <code>.xlam</code>).</li>\n<li>You ask your user to install the add-in <strong>once</strong> in their Microsoft Excel: since then, they will be able to use that functionality on any workbook they open, without explicitly need to write code in it.</li>\n</ul>\n\n<p>There's a ton of guides on the Internet about how to make cool add-ins, I suggest you the following:</p>\n\n<ul>\n<li>Very basic add-in with Excel ribbon button (useful if you want them to email the <code>ActiveWorkbook</code> as PDF file without that workbook actually have any code in it): <a href=\"https://trumpexcel.com/excel-add-in/\" rel=\"nofollow noreferrer\">find it here</a>.</li>\n<li>More complete list of links about how to create an add-in for Excel: <a href=\"http://www.cpearson.com/excel/CreateAddIn.aspx\" rel=\"nofollow noreferrer\">find it here</a>.</li>\n</ul>\n\n<p>Please note you can write Excel add-ins in <code>VBA</code>, though you might use languages as <code>C#</code> (or <code>VB.NET</code>, though I prefer the first one) to have many more functionalities and flexibility.\nIf you just need to email the workbook and already have a working code for that in VBA, then go on with VBA add-in. But I suggest you don't exclude <code>C#</code> cause it's extremely more powerful.</p>\n"}], "owner": {"reputation": 1, "user_id": 11092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba669a7688bece2906f5e73d7d8e74?s=128&d=identicon&r=PG&f=1", "display_name": "S.Jarrett", "link": "https://stackoverflow.com/users/11092598/s-jarrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550765848, "creation_date": 1550700975, "last_edit_date": 1550765848, "question_id": 54796078, "link": "https://stackoverflow.com/questions/54796078/including-code-for-library-reference-to-sending-an-email-via-excel", "title": "Including code for library reference to sending an email via excel", "body": "<p>For work we have excel files where we create reports that are approved electronically and saved as a PDF via excel module coding.  I have set-up a command button to send an email to the clients when reports have been approved so they know when to get on and look at new ones.  However, I need a way to code excel to include the appropriate references on the project manager's computer when they go to click the \"SendEmail\" command button so they do not have to do it manually each time they are in a different project excel.</p>\n\n<p>Here is the coding I have for sending an email-- \n<strong>is there a way to include coding for excel to select the references I need without having to manually select them each time on each computer? (and without having to include another separate command button)</strong><a href=\"https://i.stack.imgur.com/gS43J.png\" rel=\"nofollow noreferrer\">1</a></p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "edited": false, "score": 0, "creation_date": 1550702466, "post_id": 54796072, "comment_id": 96370678, "body": "This has nothing to do with google-apps-script so I removed the tag."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1550703657, "post_id": 54796072, "comment_id": 96371094, "body": "Use a named range (Eg &quot;MyDataRng&quot;) for the range of cells in the Attribute Group then in a list type data validation enter =MyDataRng"}, {"owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "reply_to_user": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "edited": false, "score": 0, "creation_date": 1550705325, "post_id": 54796072, "comment_id": 96371568, "body": "@Cooper Thanks for the edit. I wasn&#39;t sure if the tag should be used or not but thought it safer to add."}, {"owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "reply_to_user": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1550705388, "post_id": 54796072, "comment_id": 96371586, "body": "@user1302114 I&#39;m not quite sure what you mean with the &quot;... in a list type data validation...&quot;."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1550708067, "post_id": 54796072, "comment_id": 96372250, "body": "In excel you can add data validation to any cell and you can tell it to use a range of cells as the list of valid entries ... it&#39;s on the Data tab/menu ,,, You name the range cos I find that easier to enter in the validation form/window/box/field ... Google Excel Data Validation List"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "edited": false, "score": 0, "creation_date": 1550714508, "post_id": 54797273, "comment_id": 96373690, "body": "So you submit an answer not to answer the question but to prevent it from actually being answered?"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "edited": false, "score": 0, "creation_date": 1550826549, "post_id": 54797273, "comment_id": 96421828, "body": "No, I answered the question via comments initially then added an answer"}, {"owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "edited": false, "score": 0, "creation_date": 1550943532, "post_id": 54797273, "comment_id": 96461653, "body": "You answered &quot;a&quot; question, but it wasn&#39;t mine."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "edited": false, "score": 0, "creation_date": 1550971060, "post_id": 54797273, "comment_id": 96468163, "body": "The question I answered was the very first line of your posting .. &quot;  I am trying to piece together some VBA code that would apply data validation (creating a list to use) to a cell based on the value of the cell next to it&quot;  That is exactly what I described"}], "tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": -1, "last_activity_date": 1550831341, "last_edit_date": 1550831341, "creation_date": 1550708187, "answer_id": 54797273, "question_id": 54796072, "link": "https://stackoverflow.com/questions/54796072/excel-dynamic-data-validation-based-on-adjacent-column/54797273#54797273", "title": "Excel Dynamic Data Validation Based on Adjacent Column", "body": "<p>(Edit Addition - following down vote)\nAnswered in comments but also adding an answer to eliminate this from list of un-answered questions ..... not looking for brownie points\n(End of Edit)</p>\n\n<p>Just so this is removed from un-answered questions ..... Use a named range (Eg \"MyDataRng\") for the range of cells in the Attribute Group then in a list type data validation enter =MyDataRng</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "is_accepted": false, "score": 0, "last_activity_date": 1550770138, "creation_date": 1550770138, "answer_id": 54812963, "question_id": 54796072, "link": "https://stackoverflow.com/questions/54796072/excel-dynamic-data-validation-based-on-adjacent-column/54812963#54812963", "title": "Excel Dynamic Data Validation Based on Adjacent Column", "body": "<p>Unfortunately I don't have time to get this working exactly as I would like.</p>\n\n<p>The solution I have now was to create tables for each column that had data that would correspond with the appropriate \"Attribute Group\".</p>\n\n<blockquote>\n  <p>Insert > Table</p>\n  \n  <p>Rename table to match corresponding \"Attribute Group\" value, removing spaces and special characters</p>\n  \n  <p>Remove duplicates to get rid of most blank cells then Resize Table if needed to get rid of any others</p>\n</blockquote>\n\n<p>Then I added data validation in cell E3 using =indirect() as well as substitute() since my \"Attribute Group\" values had spaces and special characters.</p>\n\n<blockquote>\n  <p>Data > Data Validation</p>\n  \n  <p>Under \"Settings\" I used \"List\" in the Allow section</p>\n  \n  <p>The source was =INDIRECT(SUBSTITUTE(SUBSTITUTE($D3,\" \",\"\"),\"&amp;\",\"And\"))</p>\n</blockquote>\n\n<p>Then I copied cell E3 and pasted all the way down.\nThis method solves my current issue but doesn't allow for the level of flexibility that I was hoping to accomplish.</p>\n"}], "owner": {"reputation": 9, "user_id": 3512011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32d762b2476e2acc5fc11f9f475e887?s=128&d=identicon&r=PG&f=1", "display_name": "User_Undefined", "link": "https://stackoverflow.com/users/3512011/user-undefined"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550831341, "creation_date": 1550700949, "last_edit_date": 1550734578, "question_id": 54796072, "link": "https://stackoverflow.com/questions/54796072/excel-dynamic-data-validation-based-on-adjacent-column", "title": "Excel Dynamic Data Validation Based on Adjacent Column", "body": "<p>I am trying to piece together some VBA code that would apply data validation (creating a list to use) to a cell based on the value of the cell next to it. I have this functionality working in a <a href=\"https://docs.google.com/spreadsheets/d/1EgnW17LjTrecqWQv6bFWgFdoHKbTJJd-vM5uxFfGMSY/edit#gid=664998834\" rel=\"nofollow noreferrer\">Google Spreadsheet</a> which I just linked but I don't know anything about VB so I'm struggling with this.</p>\n\n<p>The layout is a little odd with the spreadsheet since the sheet(s) that need this validation have the headers of the rows starting at row 2. </p>\n\n<p>The basics of what's going on is:</p>\n\n<ul>\n<li>The header of the column that is determining the validation is called \"Attribute Group\". I want to avoid needing a fixed position so I went with the header name instead of a column index</li>\n<li>When a value changes in \"Attribute Group\" the cell adjacent to it to the right will have a dropdown created with values corresponding to the value in \"Attribute Group\"</li>\n</ul>\n\n<p>Please check out the <a href=\"https://docs.google.com/spreadsheets/d/1EgnW17LjTrecqWQv6bFWgFdoHKbTJJd-vM5uxFfGMSY/edit#gid=664998834\" rel=\"nofollow noreferrer\">linked spreadsheet</a> to see this functionality in action. I'm trying to get as close to this as possible in Excel.</p>\n\n<p>Edit: The main question is: how do you create dynamic data validation in Microsoft Excel?</p>\n"}, {"tags": ["excel", "vba", "copy-paste", "offset"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1550701024, "post_id": 54796016, "comment_id": 96370183, "body": "Start by <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoiding activate and select</a>"}, {"owner": {"reputation": 393, "user_id": 1308736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OGz7h.png?s=128&g=1", "display_name": "ajd", "link": "https://stackoverflow.com/users/1308736/ajd"}, "edited": false, "score": 0, "creation_date": 1550702941, "post_id": 54796016, "comment_id": 96370837, "body": "Whs, also every time you ask excel to look up by text that slows it down. Set mysheet=Sheets(&quot;somesheet&quot;) then reuse mysheet. Also dont copy and paste, say somecell.formula = othercell.value"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1550703523, "creation_date": 1550703523, "answer_id": 54796602, "question_id": 54796016, "link": "https://stackoverflow.com/questions/54796016/trouble-developing-vba-code-to-copy-and-certain-cells-and-paste-them-dependent-i/54796602#54796602", "title": "Trouble developing vba code to copy and certain cells and paste them dependent if there is a value in another cell", "body": "<p>Your code should really be condensed down to something like this - a couple loops iterating however many times you need to for your values in column B - although, you'd have to add some tricky stuff with the second array (<code>arr2</code>) because that's not consistent throughout your subroutines - sorry for the short example:</p>\n\n<pre><code>Option Explicit\nDim sht As Worksheet, destsht As Worksheet\nDim i As Long, j As Long\nDim arr As Variant, arr2 As Variant\nSub TransferDeliveryInfoB13()\n\n    Set sht = Sheets(\"Parts In-Out Form\")\n    Set destsht = Sheets(\"Deliveries\")\n\n    arr = Array(3, 9, 10, 4, 5, 2, 8, 12, 1)\n    arr2 = Array(\"B13\", \"C13\", \"C9\", \"D13\", \"F9\", \"H9\", \"F12\", \"H12\", \"B9\")\n\n    Dim LastRow As Long\n    LastRow = destsht.Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n    j = 0\n\n    For i = 13 To 15\n        If sht.Range(\"D9\").Value = \"In\" And sht.Range(\"B\" &amp; i) &gt; 0 Then\n            For j = 0 To UBound(arr)\n                destsht.Cells(LastRow, arr(j)).Value = sht.Range(arr2(j)).Value\n            Next j\n        Else\n            destsht.Protect (\"mustache\")\n            sht.Range(\"B9,D9,F9,H9,C9,F12,B12:B42,C12:C42,D12:D42,H12\").ClearContents\n        End If\n    Next i\n\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11035388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04000e343d7589b312886e36126f58ad?s=128&d=identicon&r=PG&f=1", "display_name": "NYeasin", "link": "https://stackoverflow.com/users/11035388/nyeasin"}, "is_accepted": false, "score": 0, "last_activity_date": 1550777244, "creation_date": 1550777244, "answer_id": 54814736, "question_id": 54796016, "link": "https://stackoverflow.com/questions/54796016/trouble-developing-vba-code-to-copy-and-certain-cells-and-paste-them-dependent-i/54814736#54814736", "title": "Trouble developing vba code to copy and certain cells and paste them dependent if there is a value in another cell", "body": "<p>Figured it out. Here is what I ended up with. </p>\n\n<p>`<br>\n      Sub TransferDeliveryInfo()</p>\n\n<pre><code> Application.EnableEvents = False\n Application.ScreenUpdating = False\n\n'make sure to unlock sheet\n    Sheets(\"Deliveries\").Select\n    ActiveSheet.Unprotect (\"mustache\")\n\n    Dim n As Integer\n    Dim j As Integer\n    n = 11\n    Do Until n = 43\n        n = n + 1\n\n If Sheets(\"Parts In-Out Form\").Range(\"b\" &amp; n) &gt; 0 Then\n\n    'Copy Part Number'\n    Dim LastRow As Long\n    LastRow = Sheets(\"Deliveries\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n    Sheets(\"Deliveries\").Cells(LastRow, 3) = Sheets(\"Parts In-Out Form\").Range(\"b\" &amp; n)\n\n    'Copy Back Ordered Quanity'\n    Sheets(\"Deliveries\").Cells(LastRow, 9) = Sheets(\"Parts In-Out Form\").Range(\"d\" &amp; n)\n\n    'Copy Back Order ETA\n    Sheets(\"Deliveries\").Cells(LastRow, 10) = Sheets(\"Parts In-Out Form\").Range(\"e\" &amp; n)\n\n    'Copy Quanity'\n    Sheets(\"Deliveries\").Cells(LastRow, 4) = Sheets(\"Parts In-Out Form\").Range(\"c\" &amp; n)\n\n    'Copy Employee Number\n    Sheets(\"Deliveries\").Cells(LastRow, 5) = Sheets(\"Parts In-Out Form\").Range(\"g9\")\n\n    'Copy BOL Number\n    Sheets(\"Deliveries\").Cells(LastRow, 2) = Sheets(\"Parts In-Out Form\").Range(\"i9\")\n\n    'Copy PO Number\n    Sheets(\"Deliveries\").Cells(LastRow, 8) = Sheets(\"Parts In-Out Form\").Range(\"g12\")\n\n    'Copying Whether or Not Back Order Delivery\n    Sheets(\"Deliveries\").Cells(LastRow, 12) = Sheets(\"Parts In-Out Form\").Range(\"i12\")\n\n    'Copying Date\n    Sheets(\"Deliveries\").Cells(LastRow, 1) = Sheets(\"Parts In-Out Form\").Range(\"b9\")\n\n    Else\n\n    Sheets(\"Deliveries\").Select\n    ActiveSheet.Protect (\"mustache\")\n\n    Sheets(\"Parts In-Out Form\").Range(\"B9,D9,G9,I9,G12,I12,B12:B42,C12:C42,D12:D42,E12:E42\").ClearContents\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\n    End If\n\n    Loop\n\n End Sub\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 11, "user_id": 11035388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04000e343d7589b312886e36126f58ad?s=128&d=identicon&r=PG&f=1", "display_name": "NYeasin", "link": "https://stackoverflow.com/users/11035388/nyeasin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550777244, "creation_date": 1550700691, "question_id": 54796016, "link": "https://stackoverflow.com/questions/54796016/trouble-developing-vba-code-to-copy-and-certain-cells-and-paste-them-dependent-i", "title": "Trouble developing vba code to copy and certain cells and paste them dependent if there is a value in another cell", "body": "<p>All, I am working on creating a vba code that saves data on a form with a click of a button. I have the code worked out but currently it takes too long to submit so I am working on trying to shorten it up. This is a snippet of the original code.</p>\n\n<pre><code>Sub TransferDeliveryInfoB13()\n\nSheets(\"Parts In-Out Form\").Select\n\nRange(\"d9\").Select\n\nIf ActiveCell.Value = (\"In\") And (Sheets(\"Parts In-Out Form\").Range(\"b13\") &gt; 0) Then\n\n    'Copy Part Number'\n    Dim LastRow As Long\n    LastRow = Sheets(\"Deliveries\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n    Sheets(\"Parts In-Out Form\").Range(\"b13\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 3).PasteSpecial xlPasteValues\n\n    'Copy Back Ordered Quanity'\n    Sheets(\"Parts In-Out Form\").Range(\"c13\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 9).PasteSpecial xlPasteValues\n\n    'Copy Back Order ETA\n    Sheets(\"Parts In-Out Form\").Range(\"c9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 10).PasteSpecial xlPasteValues\n\n    'Copy Quanity'\n    Sheets(\"Parts In-Out Form\").Range(\"d13\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 4).PasteSpecial xlPasteValues\n\n    'Copy Employee Number\n    Sheets(\"Parts In-Out Form\").Range(\"f9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 5).PasteSpecial xlPasteValues\n\n    'Copy BOL Number\n    Sheets(\"Parts In-Out Form\").Range(\"h9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 2).PasteSpecial xlPasteValues\n\n    'Copy PO Number\n    Sheets(\"Parts In-Out Form\").Range(\"f12\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 8).PasteSpecial xlPasteValues\n\n    'Copying Whether or Not Back Order Delivery\n    Sheets(\"Parts In-Out Form\").Range(\"h12\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 12).PasteSpecial xlPasteValues\n\n    'Copying Date\n    Sheets(\"Parts In-Out Form\").Range(\"b9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 1).PasteSpecial xlPasteValues\n\n    Call TransferDeliveryInfoB14\n\n    Else\n\n        Sheets(\"Deliveries\").Select\n        ActiveSheet.Protect (\"mustache\")\n\n        Sheets(\"Parts In-Out Form\").Range(\"B9,D9,F9,H9,C9,F12,B12:B42,C12:C42,D12:D42,H12\").ClearContents\n\n    End If\n\n End Sub\n Sub TransferDeliveryInfoB14()\n\nSheets(\"Parts In-Out Form\").Select\n\nRange(\"d9\").Select\n\nIf ActiveCell.Value = (\"In\") And (Sheets(\"Parts In-Out Form\").Range(\"b14\") &gt; 0) Then\n\n    'Copy Part Number'\n    Dim LastRow As Long\n    LastRow = Sheets(\"Deliveries\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n    Sheets(\"Parts In-Out Form\").Range(\"b14\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 3).PasteSpecial xlPasteValues\n\n    'Copy Back Ordered Quanity'\n    Sheets(\"Parts In-Out Form\").Range(\"c14\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 9).PasteSpecial xlPasteValues\n\n    'Copy Back Order ETA\n    Sheets(\"Parts In-Out Form\").Range(\"c9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 10).PasteSpecial xlPasteValues\n\n    'Copy Quanity'\n    Sheets(\"Parts In-Out Form\").Range(\"d14\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 4).PasteSpecial xlPasteValues\n\n    'Copy Employee Number\n    Sheets(\"Parts In-Out Form\").Range(\"f9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 5).PasteSpecial xlPasteValues\n\n    'Copy BOL Number\n    Sheets(\"Parts In-Out Form\").Range(\"h9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 2).PasteSpecial xlPasteValues\n\n    'Copy PO Number\n    Sheets(\"Parts In-Out Form\").Range(\"f12\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 8).PasteSpecial xlPasteValues\n\n    'Copying Whether or Not Back Order Delivery\n    Sheets(\"Parts In-Out Form\").Range(\"h12\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 12).PasteSpecial xlPasteValues\n\n    'Copying Date\n    Sheets(\"Parts In-Out Form\").Range(\"b9\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 1).PasteSpecial xlPasteValues\n\n    Call TransferDeliveryInfoB15\n\n    Else\n\n        Sheets(\"Deliveries\").Select\n        ActiveSheet.Protect (\"mustache\")\n\n        Sheets(\"Parts In-Out Form\").Range(\"B9,D9,F9,H9,C9,F12,B12:B42,C12:C42,D12:D42,H12\").ClearContents\n\n    End If\n\n End Sub\n</code></pre>\n\n<p>What I am attempting to do is instead of a million if then statements for each cell to compact that into one code where it will copy and paste the parts number, and quanity. and if there is there a value it will copy the bol, date, employee number in the corresponding column in the row. here's what I have so far.</p>\n\n<pre><code>Sub TransferDeliveryInfoB12()\n\n'make sure to unlock sheet\n    Sheets(\"Deliveries\").Select\n    ActiveSheet.Unprotect (\"mustache\")\n\nSheets(\"Parts In-Out Form\").Select\n\nRange(\"d9\").Select\n\nIf ActiveCell.Value = (\"In\") Then\n\n    Dim LastRow As Long\n    LastRow = Sheets(\"Deliveries\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n    'Copy Parts Number\n    Sheets(\"Parts In-Out Form\").Range(\"b12:b42\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 3).PasteSpecial xlPasteValues\n\n    'Copy Back Ordered Quanity\n    Sheets(\"Parts In-Out Form\").Range(\"c12:c42\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 9).PasteSpecial xlPasteValues\n\n    'Copy Parts Quanity\n    Sheets(\"Parts In-Out Form\").Range(\"b12:b42\").Copy\n    Sheets(\"Deliveries\").Cells(LastRow, 4).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>I am not really sure where to go from this point. Thanks in advance for all direction and help given.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10914349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f22d136bfe75b9bdc6cd7f97748a5d?s=128&d=identicon&r=PG&f=1", "display_name": "user10914349", "link": "https://stackoverflow.com/users/10914349/user10914349"}, "edited": false, "score": 1, "creation_date": 1550763841, "post_id": 54796318, "comment_id": 96398662, "body": "Thank you so much! I will give this a try!!"}, {"owner": {"reputation": 1, "user_id": 10914349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f22d136bfe75b9bdc6cd7f97748a5d?s=128&d=identicon&r=PG&f=1", "display_name": "user10914349", "link": "https://stackoverflow.com/users/10914349/user10914349"}, "edited": false, "score": 1, "creation_date": 1550764069, "post_id": 54796318, "comment_id": 96398796, "body": "Did exactly what I needed! Thank you!!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1550702094, "creation_date": 1550702094, "answer_id": 54796318, "question_id": 54795967, "link": "https://stackoverflow.com/questions/54795967/create-function-for-average-of-specified-range-in-vba/54796318#54796318", "title": "Create Function for Average of Specified Range in VBA", "body": "<p>No need to overcomplicate - just use the lower and upper boundary to widen your row values for <code>WorksheetFunction.Average</code>, and use one cell (instead of the whole column) for the reference range:</p>\n\n<pre><code>Function SPECIALAVERAGE(rng As Range, LowerBound As Integer, UpperBound As Integer) As Double\n\n    SPECIALAVERAGE = WorksheetFunction.Average(Range(Cells(rng.Row - LowerBound, rng.Column), Cells(rng.Row + UpperBound, rng.Column)))\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6VnNi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6VnNi.png\" alt=\"img1\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10914349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f22d136bfe75b9bdc6cd7f97748a5d?s=128&d=identicon&r=PG&f=1", "display_name": "user10914349", "link": "https://stackoverflow.com/users/10914349/user10914349"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550734568, "creation_date": 1550700382, "last_edit_date": 1550734568, "question_id": 54795967, "link": "https://stackoverflow.com/questions/54795967/create-function-for-average-of-specified-range-in-vba", "title": "Create Function for Average of Specified Range in VBA", "body": "<p>Please help!</p>\n\n<p>I need to create a function in VBA that allows me to return an average based on a specified range of cells.</p>\n\n<p>For this function, I want to specify the range of cells, have the code ID the active cell within that range, and then average the cells above and below based off of the active cell. The image attached shows what I am trying to do.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kSMoY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kSMoY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the VBA Function I have thus far, but I cannot seem to get it to work at all:</p>\n\n<p>VBA:</p>\n\n<pre><code>Function SpecialAVERAGE(rng As Range, LowerBound As Integer, UpperBound As Integer) As Double\n\nDim Origin As Range\nDim Total As Double\nDim Count As Integer\nDim Lower As Long\nDim Upper As Long\nDim A As Long\nDim B As Long\n\nSet Origin = ActiveCell\n\nFor Each Cell In rng\n    Lower = Range(Cell.Offset(-LowerBound, 0), Cells(Origin.Row, 1))\n    A = wf.Sum(Lower)\n    Upper = Range(Cell.Offset(UpperBound, 0), Cells(Origin.Row, 1))\n    B = wf.Sum(Upper)\n    Total = Total + Cell.Value + A + B\n    Count = Count + 1\n\nNext Cell\n\nSpecialAVERAGE = Total / Count\n\nEnd Function\n</code></pre>\n\n<p>Any direction is greatly appreciated!! \nI understand that =AVERAGE(OFFSET(.... ))) may help with this, but I haven't found the solution there either.</p>\n\n<p>Thank you!! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550702679, "post_id": 54795839, "comment_id": 96370744, "body": "<code>C</code> isn&#39;t publicly declared, it&#39;s local to whatever module this <code>Dim C As String</code> is written in. Use <code>Public</code> to make a variable public. <code>Dim</code> should be used for locals, and <code>Private</code> for module-scope variables."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550702868, "post_id": 54795839, "comment_id": 96370810, "body": "The buttons&#39; event handlers should be <code>Private</code>, in the form&#39;s code-behind."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1550703055, "post_id": 54796484, "comment_id": 96370884, "body": "Personally i would not use <code>Sheet1.Cells(1,1)</code> and use <code>Thisworkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550703272, "post_id": 54796484, "comment_id": 96370960, "body": "If &quot;Sheet1&quot; exists at compile-time in <code>ThisWorkbook</code>, your way breaks as soon as anyone renames that sheet, while OP&#39;s way still works. Also the <code>Sheets</code> collection contains <code>Chart</code> objects and about half a dozen legacy sheet types that aren&#39;t worksheets - use the <code>Worksheets</code> collection to dereference a <code>Worksheet</code> by name or index, but then again there&#39;s never <i>ever</i> a need to do this when the sheet exists in <code>ThisWorkbook</code> at compile time."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550703507, "post_id": 54796484, "comment_id": 96371039, "body": "Good to know.  Thanks."}, {"owner": {"reputation": 1, "user_id": 11092526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E64eEmKbUy4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNtxYQGS3lYWsGOA7sBJv4NtuVn1Q/mo/photo.jpg?sz=128", "display_name": "hans hunter", "link": "https://stackoverflow.com/users/11092526/hans-hunter"}, "edited": false, "score": 0, "creation_date": 1550783072, "post_id": 54796484, "comment_id": 96408662, "body": "Thank you for the clarification of the global declaration, I thought putting Dim outside the Sub would make it public, lol."}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": -1, "last_activity_date": 1550703206, "last_edit_date": 1550703206, "creation_date": 1550702866, "answer_id": 54796484, "question_id": 54795839, "link": "https://stackoverflow.com/questions/54795839/mapping-a-variable-from-an-activex-control-vba/54796484#54796484", "title": "Mapping a variable from an Activex control - [VBA]", "body": "<p>Try this:\nYou will need to tell the control where to place the value after the button is clicked.</p>\n\n<pre><code>Option Explicit\nDim C As String\nPrivate Sub OptionButton1_Click()\n    C = \"Delivery\"\n    Sheet1.Cells(1, 1) = C\n    Userform1.Hide\nEnd Sub\nPrivate Sub OptionButton2_Click()\n    C = \"Holiday\"\n    Sheet1.Cells(1, 1) = C\n    Userform1.Hide\nEnd Sub\nPublic Sub Optionbutton()\nUserform1.Show vbModeless\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1550703321, "creation_date": 1550703321, "answer_id": 54796562, "question_id": 54795839, "link": "https://stackoverflow.com/questions/54795839/mapping-a-variable-from-an-activex-control-vba/54796562#54796562", "title": "Mapping a variable from an Activex control - [VBA]", "body": "<p>If I understand correctly, your form has two option buttons. Thus, your form's code-behind should look like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub OptionButton1_Click()\n    C = \"Delivery\"\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\n    C = \"Holiday\"\nEnd Sub\n</code></pre>\n\n<p>This assumes there's a global variable <code>C</code> declared somewhere, in a standard module:</p>\n\n<pre><code>Option Explicit\nPublic C As String\n\nPublic Sub Optionbutton()\n    Userform1.Show\n    Sheet1.Cells(1, 1).Value = C\nEnd Sub\n</code></pre>\n\n<p>Note that this displays the form <em>modally</em>, which means the next instruction only runs after the form is closed/destroyed. For that reason, there's no need for the subsequent <code>Userform1.Hide</code> call: the form is already gone by then.</p>\n\n<p>Once you're comfortable with manipulating global variables from a form's code-behind, read <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> (I wrote that article) for insight on a vastly more robust way to go about this.</p>\n"}], "owner": {"reputation": 1, "user_id": 11092526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E64eEmKbUy4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNtxYQGS3lYWsGOA7sBJv4NtuVn1Q/mo/photo.jpg?sz=128", "display_name": "hans hunter", "link": "https://stackoverflow.com/users/11092526/hans-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550783753, "creation_date": 1550699673, "last_edit_date": 1550783753, "question_id": 54795839, "link": "https://stackoverflow.com/questions/54795839/mapping-a-variable-from-an-activex-control-vba", "title": "Mapping a variable from an Activex control - [VBA]", "body": "<p>Hi I am trying to use a publicly declared variable that has a value assigned to it upon clicking one of two optionbuttons inside a userform.</p>\n\n<p>The userform does show and I can click either of the two buttons i have in the frame I created, but the variable does not pick up the click or actually I don't know what I'm doing with the userform controls. And i don't think the form hides either, clicking the optionbutton seems to be a dummy click, it highlights but does nothing after that.</p>\n\n<p>Plus i'm not sure if the code itself needs to be placed on the userform' code section or the module code section, does it make a difference? Currently running it on the module code section.</p>\n\n<pre><code>Option Explicit\n\nDim C As String\nPublic Sub OptionButton1_Click()\nC = \"Delivery\"\nEnd Sub\n\nPublic Sub OptionButton2_Click()\nC = \"Holiday\"\nEnd Sub\n\n\nPublic Sub Optionbutton()\nUserform1.Show\nSheet1.Cells(1, 1).Value = C\nUserform1.Hide\n\nEnd Sub\n</code></pre>\n\n<p>********--Edit-*********\nI guess Zack's method gets the job done, printing to Cell A1, but what I was really after is although the event handler needs to be private, running debug points out that the execution stops when the private sub ends, which could be optionbutton1 or optionbutton2's click event, which is what led me to believe the click was a dummy click.</p>\n\n<p>But what I was really after is for the C variable to be available in the public sub that I execute from, is there a way for the execution to divert to the public sub after the C is assigned a value in the optionbutton private sub?</p>\n\n<p>For example if the C was assigned in the private sub but my success criteria were defined by the successful execution of the public Sub defined above, because i have a larger macro where that variable will be used inside the public sub, and this is only part of the problem, or the problem I can't solve.</p>\n"}, {"tags": ["excel", "vba", "before-save"], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "edited": false, "score": 0, "creation_date": 1550701915, "post_id": 54796057, "comment_id": 96370486, "body": "Thanks for the quick response. The <code>Application.SendKeys &quot;{ESC}&quot;, 1</code> worked great for getting off the Save As screen. It solves the UI issue of the user pressing the SAVE button into infinity thinking nothing has happened. Unfortunately <code>Application.DisplayAlerts = False</code> does not get in before Excel&#39;s &quot;Read-Only&quot; warning. I&#39;ll take it as a win. Again, huge thanks!"}, {"owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "edited": false, "score": 0, "creation_date": 1550703173, "post_id": 54796057, "comment_id": 96370917, "body": "response to the edit:  I&#39;m not finding that the issue you mentioned with the <code>{ESC}</code> is opening the Start Menu in my environment. It&#39;s placed right before <code>End Sub</code> and working great."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1550701878, "last_edit_date": 1550701878, "creation_date": 1550700860, "answer_id": 54796057, "question_id": 54795760, "link": "https://stackoverflow.com/questions/54795760/excel-vba-read-only-supersedes-beforesave/54796057#54796057", "title": "Excel VBA Read Only supersedes BeforeSave", "body": "<p>This is not a perfect approach but try this.\nThis will cancel the save completely even after pressing the Save button, you can add your own save code.</p>\n\n<p>Edit: Just realized that the code below does not stop the Read Only Alert, but when you click Save it cancels the Save and Closes the Save As Menu. However, when they use Ctrl+S the Send Keys {ESC} triggers a Ctrl+ESC which opens the Star Menu...</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    'Disable Read Only Alert\n    Application.DisplayAlerts = False\n    'Disable Events\n    Application.EnableEvents = False\n    'Cancel Save\n    Cancel = True\n    'Do whatever code you need in here\n    '\n    'Mark Workbook as Saved, allowing for the file to close without an alert even if not saved\n    ThisWorkbook.Saved = True\n    'Send Escape Key to leave Save As Menu\n    Application.SendKeys \"{ESC}\", 1\n    'Enable Events\n    Application.EnableEvents = True\n    'Enable Alerts\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 54796057, "answer_count": 1, "score": 1, "last_activity_date": 1550734561, "creation_date": 1550699319, "last_edit_date": 1592644375, "question_id": 54795760, "link": "https://stackoverflow.com/questions/54795760/excel-vba-read-only-supersedes-beforesave", "title": "Excel VBA Read Only supersedes BeforeSave", "body": "<p>I have code that incorporates business logic for saving documents (Excel 365) to ensure proper naming convention, file locations etc etc as a Sub Workbook_BeforeSave</p>\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nCancel = True  ''Cancels the Save from the button push or Ctrl+S\nApplication.EnableEvents = False\n'' code code code\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n<p>The problem is that if the file is opened as Read-Only (as most will be) Excel will prompt that &quot;the file is Read-Only&quot; (pic a) and go to the Save As screen in the File Ribbon (pic b). The <code>Workbook_BeforeSave</code> sub won't kick in until the SAVE button is pressed. It also won't move off this screen even after the sub has run.\nIs there any way to either:</p>\n<ol>\n<li>Get in front of the Read-Only prompt ... or</li>\n<li>Write some code to move off the Save As screen?</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/vRSFS.jpg\" rel=\"nofollow noreferrer\">MS Read-Only promt</a> (pic a)\n<a href=\"https://i.stack.imgur.com/HFMWq.jpg\" rel=\"nofollow noreferrer\">Save As Screen</a> (pic b)</p>\n<p>Huge thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550699743, "post_id": 54795746, "comment_id": 96369723, "body": "If <code>DocNum</code> is a <code>Double</code>, use math, not string comparisons (i.e. <code>Fix(DocNum &#47; (10 ^ 5))</code>) . You also need a <i>full expression</i> for each of the <code>Or</code> clauses.  What this is doing now is basically <code>CBool(&quot;1004*&quot;)</code>, which is a type mismatch."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550699879, "post_id": 54795746, "comment_id": 96369773, "body": "The linked duplicate addresses the <code>If DocNum = &quot;abc&quot; Or DocNum = &quot;xyz&quot;</code> vs <code>If DocNum = &quot;abc&quot; Or &quot;xyz&quot;</code> part of the question. Note that the <code>=</code> operator is an <i>equality</i> operator: this operation doesn&#39;t support wildcards. Look into the <code>Like</code> operator if you need wildcards."}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 9754746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7d1f6fc1614f6b5b92bda9aa8b28dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Djemoui", "link": "https://stackoverflow.com/users/9754746/djemoui"}, "is_accepted": false, "score": -2, "last_activity_date": 1550701197, "last_edit_date": 1550701197, "creation_date": 1550700411, "answer_id": 54795972, "question_id": 54795746, "link": "https://stackoverflow.com/questions/54795746/if-statement-condition-error-returns-true-for-all-conditions/54795972#54795972", "title": "If statement condition error - returns true for all conditions", "body": "<p>Tried This solved:</p>\n\n<pre><code>If DocNum = \"1003*\" Or _\n   DocNum = \"1004*\" Or _\n   DocNum = \"1005*\" Then\n 'Some Code\nElseIf\n   DocNum = \"19*\" Or _\n   DocNum = \"17*\" Or _\n   DocNum = \"22*\" Or _\n   DocNum = \"20*\" Then\n 'Some Code\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>Select Case DocNum\n   Case \"1003*\",\"1004*\",\"1005*\"\n   'Some Code\n   Case \"19*\",\"17*\",\"22*\",\"20*\"\n   'Some Code\n   Case Else\n   'Some Code Case None\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1550699722, "answer_count": 1, "score": 0, "last_activity_date": 1550701197, "creation_date": 1550699265, "last_edit_date": 1550699595, "question_id": 54795746, "link": "https://stackoverflow.com/questions/54795746/if-statement-condition-error-returns-true-for-all-conditions", "closed_reason": "Duplicate", "title": "If statement condition error - returns true for all conditions", "body": "<p>DocNum is set as Double, I have numbers that when they fall into these buckets should trigger different code to be used. I'm having trouble identifying why it's only using the if stmt and not the elseif. The stmt returns true everytime...</p>\n\n<p>Example:  1003xxxxx should return true and use the if stmt code, 1900xxxxxx should return false and use the elseif code. But 1900xxxxxx is using the if stmt code...</p>\n\n<p>It's most likely the wildcard, but I was under the assumption that it would need to satisfy the previous numbers before assuming the remaining numbers.</p>\n\n<pre><code>If DocNum = \"1003*\" Or \"1004*\" Or \"1005*\" Then\n'Some Code\nElseIf DocNum = \"19*\" Or \"17*\" Or \"22*\" Or \"20*\" Then\n'Some Code\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 6, "creation_date": 1550699001, "post_id": 54795665, "comment_id": 96369437, "body": "<code>Set selectedRange = (&quot;C4:C20&quot;)</code> is trying to assign a <code>String</code> to a <code>Range</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "is_accepted": true, "score": 3, "last_activity_date": 1550699029, "creation_date": 1550699029, "answer_id": 54795695, "question_id": 54795665, "link": "https://stackoverflow.com/questions/54795665/cannot-identify-source-of-type-mismatch-error/54795695#54795695", "title": "Cannot identify source of &quot;Type Mismatch&quot; Error", "body": "<p>Use <code>Set selectedRange = ActiveSheet.Range(\"C4:C20\")</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 10886669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79293112ce1f80f086946ec05349b20b?s=128&d=identicon&r=PG&f=1", "display_name": "SableDay", "link": "https://stackoverflow.com/users/10886669/sableday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54795695, "answer_count": 1, "score": -2, "last_activity_date": 1550699531, "creation_date": 1550698881, "last_edit_date": 1550699531, "question_id": 54795665, "link": "https://stackoverflow.com/questions/54795665/cannot-identify-source-of-type-mismatch-error", "title": "Cannot identify source of &quot;Type Mismatch&quot; Error", "body": "<p>The following macro gives a type mismatch error when run, and I cannot see where there is one. I would appreciate any advice on this issue:</p>\n\n<pre><code>Sub Add_W()\nDim cel As Range\nDim selectedRange As Range\nDim WCount As Integer\n\nSet selectedRange = (\"C4:C20\")\n\nSet WCount = 0\n\nFor Each cel In selectedRange.Cells\n    Wname = cel.Text\n\n    With ThisWorkbook\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = Wname + \" Table\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = Wname + \" Plots\"\n    End With\n\n    Sheets(Wname + \" Table\").Select\n\n    Sheets(\"Report\").Select\n    If IsEmpty(Range(\"B5\")) Then\n        Rows(5).Insert shift:=xlShiftDown\n    End If\n    Range(\"B5\") = Wname\n    WCount = WCount + 1\n\n    Sheets(\"Input\").Select\n    Range(\"U\" &amp; WCount + 1) = Wname\n\n    Sheets(Wname + \" Plots\").Select\nNext cel\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550699208, "post_id": 54795453, "comment_id": 96369522, "body": "This isn&#39;t transposing, it&#39;s a completely different layout. Start by unpivoting the source data (PowerPivot can do that) so that you get 24 records per date/customer... and then it looks like you&#39;ll be able to pivot it as needed."}], "answers": [{"tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": 0, "last_activity_date": 1550788458, "creation_date": 1550788458, "answer_id": 54817302, "question_id": 54795453, "link": "https://stackoverflow.com/questions/54795453/complex-excel-transpose/54817302#54817302", "title": "Complex Excel Transpose", "body": "<p>I'm sure there's a more elegant solution than this ... but it seems to work\nI haven't put much effort into cleaning up the code - still got Stops in it</p>\n\n<p>The process is;\n .. Sort the data by Date\n .. Read it into an array .. re-arranging as we go\n .. Write the array to a different sheet</p>\n\n<pre><code>Sub ReArrangeMyData()\n    ' First Sort the Raw Data by Date\n      Application.Goto Reference:=\"rawdatarng\"\n      ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Clear\n      ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add2 Key:=Range(\"B11:B14\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n      With ActiveWorkbook.Worksheets(\"Sheet2\").Sort\n        .SetRange Range(\"A10:Z14\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n      End With\n    ' Sorted\n\n    Dim NewData(1 To 99, 1 To 26) As Variant\n\n    ' Now parse each Row and Re-Arrange into new sheet ... via the NewData Array\n      Dim SrcRng As Range, xRow As Range, tgtRow As Long, tgtCol As Long\n      Dim FirstRow As String, dDate As String, dCust As String, i As Long, LastDate As String\n\n      Set SrcRng = ActiveSheet.Range(\"RawDataRng\")\n      tgtRow = 0\n      tgtCol = 0\n      FirstRow = \"Y\"\n      LastDate = \"AnyInvlidRubbish\"\n      For Each xRow In SrcRng.Rows\n         If FirstRow &lt;&gt; \"Y\" Then\n            dDate = CStr(xRow.Cells(1, 2).Value)\n            dCust = CStr(xRow.Cells(1, 1).Value)\n            If dDate &lt;&gt; LastDate Then\n               ' New Date = NewRow\n               tgtRow = IIf(tgtRow = 0, 1, tgtRow + 26) ' Uses 1st Row on 1st Date then Jumps 26 Rows for other dates\n               tgtCol = 0\n               tgtCol = tgtCol + 1\n               NewData(tgtRow, tgtCol) = dDate\n               tgtCol = tgtCol + 1\n               NewData(tgtRow, tgtCol) = dCust\n               For i = 1 To 24\n                  NewData(tgtRow + i, 1) = \"Hour \" &amp; Right(\"00\" &amp; i, 2)\n               Next i\n            Else\n               'tgtCol = tgtCol + 1\n               'NewData(tgtRow, tgtCol) = dDate\n               Stop\n               tgtCol = tgtCol + 1\n               NewData(tgtRow, tgtCol) = dCust\n            End If\n\n            For i = 1 To 24\n               NewData(tgtRow + i, tgtCol) = CStr(xRow.Cells(1, 2 + i).Value)\n            Next i\n            LastDate = dDate\n         End If\n         FirstRow = \"N\"\n      Next xRow\n      Stop\n\n      ' Finally Write the NewData Array into a different sheet\n      For i = 1 To 99\n         For J = 1 To 26\n            ThisWorkbook.Sheets(\"Sheet3\").Cells(5 + i, J).Value = NewData(i, J)\n         Next J\n      Next i\n      Stop\n    ' Done\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9611989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Mgb2XW1FopE/AAAAAAAAAAI/AAAAAAAAADc/dSEPhZ0zSAo/photo.jpg?sz=128", "display_name": "Hasen CH", "link": "https://stackoverflow.com/users/9611989/hasen-ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550788458, "creation_date": 1550697828, "last_edit_date": 1550699020, "question_id": 54795453, "link": "https://stackoverflow.com/questions/54795453/complex-excel-transpose", "title": "Complex Excel Transpose", "body": "<p>I have to transpose some data into a completely different format and nothing seems to be working for me. I have tired Pivot Table, SUMIF, VLOOKUP and Concatenate but problem is not getting resolved. </p>\n\n<p><strong>I have a data in the following format:</strong> </p>\n\n<pre><code>CUSTOMER  Date         HOUR 1 HOUR 2 HOUR 3 HOUR 4.......HOUR 24\nA         2019-02-20    1.5   1.7    1.9   1.10         1.78\nA         2019-02-21    1.1   1.8    1.2   1.10         1.75\nB         2019-02-20    1.0   1.2    1.4   1.29         1.73\nB         2019-02-21    1.5   1.7    1.9   1.10         1.78\n</code></pre>\n\n<p><strong>I want this data to be transposed into the following format:</strong> </p>\n\n<pre><code>DATE            CUSTOMER \n\n2019-02-20     A       B\nHOUR 1        1.5      1.0 \nHOUR 2        1.7      1.2\nHOUR 3        1.9      1.4\nHOUR 4        1.10     1.29\n.\n.\n.\nHOUR 24      1.78      1.73\n\n2019-02-21   \n\nHOUR 1       1.1       1.5  \nHOUR 2       1.8       1.7\nHOUR 3       1.2       1.9\nHOUR 4       1.10      1.10\n.\n.\n.\nHOUR 24      1.75      1.78\n</code></pre>\n\n<p>Please advise how can i achieve this? </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550697812, "post_id": 54795327, "comment_id": 96368942, "body": "&quot;What does &quot;it&#39;s not working well&quot; mean? It would be easier to move the rows to a new sheet."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550697942, "post_id": 54795327, "comment_id": 96369000, "body": "it also won&#39;t work as intended because <code>lastRow</code> will always change with each time rows are copied. So, place the line that sets that variable inside the for loop. Also, if you use the <code>specialcells</code> method and only paste values directly against the range, any hidden columns will be missed"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1550698014, "post_id": 54795327, "comment_id": 96369042, "body": "What is <code>sht</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1550698780, "creation_date": 1550698780, "answer_id": 54795638, "question_id": 54795327, "link": "https://stackoverflow.com/questions/54795327/need-to-loop-copy-each-row-a-set-number-of-times-based-on-cell-value/54795638#54795638", "title": "Need to Loop Copy each row a set number of times based on cell value", "body": "<p>If this is all in the same worksheet ( as the code suggests) the your lastrow is your problem.  You need to recalculate it everytime you paste a new row.</p>\n\n<pre><code>Sub Transfer()\nApplication.ScreenUpdating = False\n\nDim lastrow As Long, lngRows\n\n\nDim wsSource As Worksheet\nDim wsDest As Worksheet\nDim rowCount As Long\n\nSet wsSource = Worksheets(\"Forecasted Movement\")\nWith wsSource\nrowCount = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' &lt;-- modifed this line\n\nOn Error Resume Next\nFor i = 2 To rowCount\n    If .Cells(i, \"BU\").Value &gt; 0 Then\n\n        lngRows = .Cells(i, \"BU\").Value\n\n       Range(Cells(i, 1), Cells(i, 72)).specialcells(xlCellTypeVisible).Copy\n    lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1  ' recalculate this for the next blank row\n        wsSource.Cells(lastrow, 1).Resize(lngRows).PasteSpecial Paste:=xlPasteValues\n\n\n\n    End If\nNext i\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54795638, "answer_count": 1, "score": -1, "last_activity_date": 1550734535, "creation_date": 1550697192, "last_edit_date": 1550734535, "question_id": 54795327, "link": "https://stackoverflow.com/questions/54795327/need-to-loop-copy-each-row-a-set-number-of-times-based-on-cell-value", "title": "Need to Loop Copy each row a set number of times based on cell value", "body": "<p>I have the following code which I am using to loop through a worksheet. Each row needs to be copied a certain number of times and the new rows pasted at the bottom, after the last row that currently has any text. The number of rows to copy for each present row is in the cell for column BU of that row. \nHence, in order to do this, I have created the following loop to move through each row and use the cell value in column BU to copy cells in columns A through BT, then paste after the last active visible row.\nHowever, it's not working well.</p>\n\n<p>Any thought?</p>\n\n<pre><code>Sub Transfer()\nApplication.ScreenUpdating = False\n\nDim lastrow As Long, lngRows\nlastrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row + 1\n\nDim wsSource As Worksheet\nDim wsDest As Worksheet\nDim rowCount As Long\n\nSet wsSource = Worksheets(\"Forecasted Movement\")\nWith wsSource\nrowCount = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' &lt;-- modifed this line\n\nOn Error Resume Next\nFor i = 2 To rowCount\n    If .Cells(i, \"BU\").Value &gt; 0 Then\n\n        lngRows = .Cells(i, \"BU\").Value\n\n       Range(Cells(i, 1), Cells(i, 72)).specialcells(xlCellTypeVisible).Copy\n\n        wsSource.Cells(lastrow, 1).Resize(lngRows).PasteSpecial Paste:=xlPasteValues\n\n\n\n    End If\nNext i\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1550697015, "post_id": 54795255, "comment_id": 96368595, "body": "Please don&#39;t put a wall of declarations at the start of your code. Declare variables close to their usage. It makes code so much easier to read."}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550697071, "post_id": 54795255, "comment_id": 96368621, "body": "thanks for the input"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550697258, "post_id": 54795255, "comment_id": 96368698, "body": "Can  more than one test in these Ifs be True e.g. can  MFA(2) = culstop and also MFB(2) ?"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1550697298, "post_id": 54795255, "comment_id": 96368724, "body": "Yes, or else I would have done a series of if/else. I am tracking when some fermenters have stopped the digital logic controlling their fermentation before sending to next area of our processes. These culture stop events only happen about 5 times a day but may overlap on occasion."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1550697428, "post_id": 54795255, "comment_id": 96368776, "body": "if your code works consider posting on <a href=\"https://codereview.stackexchange.com/\">code review</a> - just be sure to review their rules on posting."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1550698837, "post_id": 54795255, "comment_id": 96369368, "body": "I&#39;d port the entire thing to VBScript (or some other language), then run it from the Windows Task Scheduler. Excel really isn&#39;t intended to be run as a &quot;service&quot;, and it doesn&#39;t really strike me as something that would be horribly stable in the long term."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1550724121, "post_id": 54795255, "comment_id": 96375997, "body": "Looking at all the repetition here, a base review of the logic is called for."}], "owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550699454, "creation_date": 1550696853, "last_edit_date": 1550699454, "question_id": 54795255, "link": "https://stackoverflow.com/questions/54795255/how-can-i-get-this-code-to-run-quietly-in-the-background", "title": "How can I get this code to run quietly in the background?", "body": "<p>My code attempts to loop through a series of data points pulled from a server (PIcurrVal function), and react to the \"random\" input of a certain string into one of these data points by grabbing some related values and placing them into an excel document in the order in which the chosen string is inputted. This process will be overwritten every 24 hours. My code here achieves this goal, but feels clunky and renders the file unusable while running. How can I streamline this operation to run neatly in the background?</p>\n\n<pre><code>Sub culturestop_timestamp()\n\nDim culstop As String\n\nDim MFA As Variant\nDim MFB As Variant\nDim MFC As Variant\nDim MFD As Variant\nDim MFE As Variant\nDim MFF As Variant\nDim MFG As Variant\nDim MFH As Variant\n\nDim MFAR As Variant\nDim MFBR As Variant\nDim MFCR As Variant\nDim MFDR As Variant\nDim MFER As Variant\nDim MFFR As Variant\nDim MFGR As Variant\nDim MFHR As Variant\n\nDim MFAT As String\nDim MFBT As String\nDim MFCT As String\nDim MFDT As String\nDim MFET As String\nDim MFFT As String\nDim MFGT As String\nDim MFHT As String\n\nDim A As Integer\nDim B As Integer\nDim C As Integer\nDim D As Integer\nDim E As Integer\nDim F As Integer\nDim G As Integer\nDim H As Integer\n\nDim start As Date\nDim curtime As Date\n\n\nDim rownum As Integer\n\nApplication.OnTime Now, \"culturestop_timestamp\"\n'reset:\n'Application.OnTime TimeValue(\"07:30:00\", \"culturestop_timestamp\")\nstart = Now()\n\n\nculstop = \"CULSTOP\"\n\nrownum = 30\n\nA = 0\nB = 0\nC = 0\nD = 0\nE = 0\nF = 0\nG = 0\nH = 0\n\n\nDo While curtime &lt;= (start + TimeValue(\"23:59:00\"))\n\n\n\n\n\n    MFA = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMA_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFB = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMB_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFC = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMC_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFD = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMD_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFE = Application.Run(\"PICurrVal\", \"TAPS1.MNFERME_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFF = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMF_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFG = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMG_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    MFH = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMH_UNIT/PHASE_SELECT.CVS\", 1, \"\")\n    If A = 2 Then\n        MFA(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If B = 2 Then\n        MFB(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If C = 2 Then\n        MFC(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If D = 2 Then\n        MFD(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If E = 2 Then\n        MFE(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If F = 2 Then\n        MFF(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If G = 2 Then\n        MFG(2) = \"Already_Brothed_Out_Today\"\n    End If\n    If H = 2 Then\n        MFH(2) = \"Already_Brothed_Out_Today\"\n    End If\n\n    If MFA(2) = culstop Then\n        A = 2\n        MFAR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMA_TYPE.CV\", 1, \"\")\n        'MFAT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFA(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFAR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) = 'batchnumber...\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n\n\n        rownum = rownum + 1\n\n    End If\n\n    If MFB(2) = culstop Then\n        B = 2\n        MFBR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMB_TYPE.CV\", 1, \"\")\n        'MFBT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFB(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFBR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n\n    End If\n\n    If MFC(2) = culstop Then\n        C = 2\n        MFCR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMC_TYPE.CV\", 1, \"\")\n        'MFCT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFC(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFCR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n\n    End If\n\n    If MFD(2) = culstop Then\n        D = 2\n        MFDR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMD_TYPE.CV\", 1, \"\")\n        'MFDT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFD(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFDR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n    End If\n\n    If MFE(2) = culstop Then\n        E = 2\n        MFER = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERME_TYPE.CV\", 1, \"\")\n        'MFET = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFE(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFER(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n    End If\n\n    If MFF(2) = culstop Then\n        F = 2\n        MFFR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMF_TYPE.CV\", 1, \"\")\n        'MFFT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFF(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFFR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n    End If\n\n    If MFG(2) = culstop Then\n        G = 2\n        MFGR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMG_TYPE.CV\", 1, \"\")\n        'MFGT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFG(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFGR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n    End If\n    If MFH(2) = culstop Then\n        H = 2\n        MFHR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE/MNFERMH_TYPE.CV\", 1, \"\")\n        'MFHT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFH(1)\n        Sheet1.Range(\"B\" &amp; rownum) = MFHR(2)\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n    End If\n\n    curtime = Now()\n    'MsgBox (\"loop done dawg\")\n    Loop\n    'GoTo reset\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1550696295, "post_id": 54795004, "comment_id": 96368287, "body": "I can see how you could get errors 6, 9 or 13 on the <code>xcell =</code> line, but not the 1004. Is that the actual code you are running?"}, {"owner": {"reputation": 1, "user_id": 11034186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e5e412e4355b5774ab84246099fb75?s=128&d=identicon&r=PG&f=1", "display_name": "H. Greenland", "link": "https://stackoverflow.com/users/11034186/h-greenland"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1550696945, "post_id": 54795004, "comment_id": 96368566, "body": "Yeah that\u2019s the actual code I\u2019m running"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1550697085, "post_id": 54795004, "comment_id": 96368626, "body": "<code>PrintOut</code> method is also causing my Excel to crash when selecting multiple sheets at once. I am on Win10 XL2016"}, {"owner": {"reputation": 1, "user_id": 11034186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e5e412e4355b5774ab84246099fb75?s=128&d=identicon&r=PG&f=1", "display_name": "H. Greenland", "link": "https://stackoverflow.com/users/11034186/h-greenland"}, "edited": false, "score": 0, "creation_date": 1550697303, "post_id": 54795004, "comment_id": 96368728, "body": "I\u2019m running OS X excel2016"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550699431, "post_id": 54795004, "comment_id": 96369613, "body": "Are multiple sheets selected? If that&#39;s the case, make sure you ungroup them first."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1550710947, "post_id": 54795004, "comment_id": 96372890, "body": "Tried the code as it is, ( and also tried with multiple sheets selected) but found working  without any error. I am using excel 2007. may be issue with printer or that particular file..Regarding cleaner way, <code>if</code> <code>else</code> can be reduced to two by combining with <code>Or</code> etc.."}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1550714421, "creation_date": 1550714421, "answer_id": 54798082, "question_id": 54795004, "link": "https://stackoverflow.com/questions/54795004/print-macro-either-gives-me-error-1004-or-crashes-excel/54798082#54798082", "title": "Print Macro either gives me error 1004 or crashes excel", "body": "<p>Not sure will these work on Mac. Below will keep prompting a value > 0 if that B12 is less than 1. Simplified your worksheet conditions and refers all objects within the workbook the macro is in.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim Wks As Worksheet, xcell As Long, sInput As String\n    With ThisWorkbook\n        With .Worksheets(\"Print Page\").Range(\"B12\")\n            xcell = CLng(.Value)\n            If xcell &lt; 1 Then\n                Do\n                    sInput = InputBox(\"Please Enter the number of pages needed:\", \"Pages to print\", 1)\n                    If Len(sInput) = 0 Then Exit Sub ' Abort if clicked Cancel/left empty and clicked OK\n                    If IsNumeric(sInput) Then xcell = CLng(sInput)\n                Loop Until xcell &gt; 0\n                .Value = xcell\n            End If\n        End With\n        For Each Wks In .Worksheets\n            If Wks.Visible = xlSheetVisible Then\n                Select Case Wks.Name\n                    Case \"Print Page\", \"Specs\" ' Skip!\n                    Case \"Data\"\n                        Wks.PrintOut From:=1, To:=xcell\n                    Case Else\n                        Wks.PrintOut\n                End Select\n            End If\n        Next Wks\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11034186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e5e412e4355b5774ab84246099fb75?s=128&d=identicon&r=PG&f=1", "display_name": "H. Greenland", "link": "https://stackoverflow.com/users/11034186/h-greenland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550714421, "creation_date": 1550695734, "question_id": 54795004, "link": "https://stackoverflow.com/questions/54795004/print-macro-either-gives-me-error-1004-or-crashes-excel", "title": "Print Macro either gives me error 1004 or crashes excel", "body": "<p>I am currently trying to build a a button click print macro to print all but two sheets (currently 5 total sheets). In addition I have a third sheet that I want the user to define how many pages of it to print. When I try to to have it be based off of a cell I get error 1004. To see if the rest of the code works and I make the module have a defined number excel crashes on me after it does the first sheet to print. </p>\n\n<pre><code>Sub Button1_Click()\n\nDim Wks As Worksheet, xcell As Integer\n'The next line is where I get 1004 but when I change it to a fixed number it crashes excel'\nxcell = Sheets(\"Print Page\").Range(\"B12\").Value\nIf xcell &lt; 1 Then\n    MsgBox (\"Please Enter the number of pages needed\")\n    Exit Sub\nElse\n    For Each Wks In ActiveWorkbook.Worksheets\n        If Wks.Visible = xlSheetVisible Then\n            If Wks.Name = \"Print Page\" Then\n            Else\n                If Wks.Name = \"Specs\" Then\n                Else\n                    If Wks.Name = \"Data\" Then\n                    Wks.PrintOut From:=1, To:=xcell\n                    Else\n                    Wks.PrintOut\n                    End If\n                End If\n            End If\n        End If\n    Next Wks\nEnd If\nEnd Sub\n</code></pre>\n\n<p>There is probably a cleaner way to write this that I'm not aware of. </p>\n"}, {"tags": ["excel", "vba", "filter", "datatable"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550717077, "post_id": 54794806, "comment_id": 96374292, "body": "Are there more than 6 columns with data and are there formulas? A faster solution might be to copy the complete data set into an array, manipulate it there and copy it back to the range and delete the last consecutive rows in one go."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1550696487, "post_id": 54795001, "comment_id": 96368386, "body": "This macro works when I step through it but my excel file froze after I actually ran it. The workbook is currently at 13,650 KB... The table is also hooked up to over a dozen pivot tables - do you think that could slow it down?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1550697324, "post_id": 54795001, "comment_id": 96368736, "body": "@BrandonM. Yes, that may make a difference.  Not sure if this would solve that problem with pivot tables but try also changing calculation mode to manual before the loop and back to automatic after the loop.  <code>Application.Calculation = xlCalculationManual</code>"}, {"owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1550699566, "post_id": 54795001, "comment_id": 96369660, "body": "I inserted the calculation mode from manual to automatic after loop like you said. I also deleted a few connections that weren&#39;t necessary and a miscellaneous tab that had unnecessary data. I am now at 3,543 KB but it is still running painfully slow. I let the macro finish its job and it took almost 5 minutes. Any ideas on how to speed it up?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "edited": false, "score": 0, "creation_date": 1550703821, "post_id": 54795001, "comment_id": 96371146, "body": "Not sure my answer deserves the check mark if it&#39;s still too slow for you.  Maybe @DavidZemens can help a bit more.  He has a lot more experience with large files."}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 0, "last_activity_date": 1550697469, "last_edit_date": 1550697469, "creation_date": 1550695724, "answer_id": 54795001, "question_id": 54794806, "link": "https://stackoverflow.com/questions/54794806/vba-macro-to-filter-a-table-by-specific-cell-value-and-delete-all-rows/54795001#54795001", "title": "VBA Macro to filter a table by specific cell value and delete all rows", "body": "<p>A loop should work fine with 75,000 rows. Turning off screen updating to speed it up.  Try this:</p>\n\n<pre><code>Sub DeleteZeroRows()\n    Dim LastRow As Long, n As Long\n    LastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    For n = LastRow To 1 Step -1\n        If Cells(n, 5).Value = 0 Then Cells(n, 5).EntireRow.Delete\n    Next n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Note that I'm stepping backwards (bottom up) so when the row is deleted and shifted up it doesn't change the row number you move to in the next loop iteration.</p>\n\n<p>Also note <code>Cells(n, 5)</code> where <code>5</code> is the column (\"E\") and is where I'm looking for zeros.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1550699499, "creation_date": 1550699499, "answer_id": 54795794, "question_id": 54794806, "link": "https://stackoverflow.com/questions/54794806/vba-macro-to-filter-a-table-by-specific-cell-value-and-delete-all-rows/54795794#54795794", "title": "VBA Macro to filter a table by specific cell value and delete all rows", "body": "<p>If you want to filter on column \u201cD\u201d then it\u2019s the third one when starting from column \u201cB\u201d</p>\n\n<pre><code>Sub Main\n    With ThisWorkbook.Worksheets(\"Status\")\n        .ShowAllData\n        With .Range(\"B1\", .Cells(.Rows.Count, 2).End(xlUp))\n            .AutoFilter Field:=3, Criteria1:=\"0\"\n            On Error Resume Next\n            .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Delete\n           On Error GoTo 0\n        End With \n        .AutofilterMode = False\n    End With \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1550750844, "last_edit_date": 1550750844, "creation_date": 1550750328, "answer_id": 54806546, "question_id": 54794806, "link": "https://stackoverflow.com/questions/54794806/vba-macro-to-filter-a-table-by-specific-cell-value-and-delete-all-rows/54806546#54806546", "title": "VBA Macro to filter a table by specific cell value and delete all rows", "body": "<h1>Modify Range in Array</h1>\n\n<ul>\n<li>The following code only works if there are values in the range, <strong>not\nformulas</strong>. If there are formulas, values will be returned.</li>\n<li><p>The following code will copy the entire range into an array, where it\nwill check each row for the criteria and if not found, will\n(over)write to the same array resulting in a too big array, but will\nthen in 1 of 3 possible ways (<code>cWriteDelete</code>) write back to the\nrange:</p>\n\n<ol>\n<li>It will write empty strings (<strong>\"\"</strong>) to the remainder of the array and\npaste it back to the range.</li>\n<li>It will copy the array as is into the range and delete the\nunnecessary <strong>rows</strong>.</li>\n<li>It will copy the array as is into the range and delete the\nunnecessary <strong>range</strong>.</li>\n</ol></li>\n<li><p><strong>Why not resize the array?</strong></p>\n\n<p>The array is a <strong>2D</strong> array, and we cannot resize its first dimension (<strong>rows</strong>).</p></li>\n</ul>\n\n<h2>The Code</h2>\n\n<pre><code>Sub Delete_Zero_Rows()\n\n    Const cSheet As String = \"Status\"       ' Worksheet Name\n    Const cRange As String = \"A:F\"          ' Source Columns Range Address\n    Const cFR As Long = 4                   ' First Row Number\n    Const cCol As Variant = \"E\"             ' Criteria Column Letter/Number\n    Const cCrit As Long = 0                 ' Criteria\n    Const cWriteDelete As Long = 2          ' 1 - Write \"\" to array\n                                            ' 2 - Delete remaining rows\n                                            ' 3 - Delete remaining range\n\n    Dim Rng As Range      ' Last Used Cell Range In Criteria Column,\n                          ' Source/Target Range\n    Dim vntST As Variant  ' Source/Target Array\n    Dim ACC As Long       ' Array Criteria Column Number\n    Dim i As Long         ' Source Array Row Counter\n    Dim j As Long         ' Source/Target Array Column Counter\n    Dim k As Long         ' Target Array Row Number (Counter)\n\n    ' Speed up.\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    On Error GoTo ProcedureExit   ' Safely exit program.\n\n    With ThisWorkbook.Worksheets(cSheet)\n\n        '************************************************\n        ' Last Used Cell Range in Criteria Column (Rng) '\n        '************************************************\n\n        ' Calculate Last Used Cell Range in Criteria Column.\n        Set Rng = .Columns(cCol).Find(\"*\", , xlFormulas, _\n                xlWhole, xlByColumns, xlPrevious)\n        ' Check if all cells in Criteria Column (cCol) are empty i.e. Last Used\n        ' Cell Range in Criteria Column (Rng) is Nothing.\n        If Rng Is Nothing Then  ' Inform user.\n            MsgBox \"No Data in Column '\" &amp; Split(.Cells(1, cCol).Address, _\n                    \"$\")(1) &amp; \"'.\", vbInformation, \"Empty Column\"\n            GoTo ProcedureExit  ' Safely exit program.\n        End If\n\n        '******************************\n        ' Source (Target) Range (Rng) '\n        '******************************\n\n        ' Calculate Source/Target Range (Rng) from Source Columns Range(cRange).\n        Set Rng = .Columns(cRange).Resize(Rng.Row - cFR + 1).Offset(cFR - 1)\n        ' Copy Source/Target Range (Rng) to Source/Target Array (vntST).\n        vntST = Rng\n\n        '******************************\n        ' Source/Target Array (vntST) '\n        '******************************\n\n        ' Calculate Array Criteria Column Number.\n        ACC = .Columns(cCol).Column\n        ' Loop through rows (i) of Source/Target Array (vntST).\n        For i = 1 To UBound(vntST)\n            ' Check if value of current row (i) in Array Criteria Column (ACC)\n            ' does not equal to Criteria  (cCrit).\n            If vntST(i, ACC) &lt;&gt; cCrit Then\n                ' Count (add 1 to) Target Array Row Number (k).\n                k = k + 1\n                ' Loop through columns(j) of Source/Target Array (vntST).\n                For j = 1 To UBound(vntST, 2)\n                    ' Write from current row(i) in column(j) to current row(k)\n                    ' in column (j) of Source/Target Array (vntST).\n                    ' Note: Data is being overwritten since always k &lt;= j.\n                    vntST(k, j) = vntST(i, j)\n                Next\n            End If\n        Next\n        ' Check if Target Array Row Number is equal to the number of rows in\n        ' Source/Target Array (or in Source/Target Range).\n        If k = UBound(vntST) Then ' or k = Rng.Rows.Count; Inform user.\n            MsgBox \"No cell containing '\" &amp; cCrit &amp; \"' in Column '\" _\n                    &amp; Split(.Cells(1, cCol).Address, \"$\")(1) &amp; \"' found.\", _\n                    vbInformation, \"Nothing Changed\"\n            GoTo ProcedureExit  ' Safely exit program.\n        End If\n\n        Select Case cWriteDelete\n            Case 1  ' Slower version.\n                ' Loop through the remaining rows (i) of Source/Target\n                ' Array (vntST) starting from the current Target Array Row\n                ' Number (k) increased by 1 (next).\n                For i = k + 1 To UBound(vntST)\n                    ' Loop through columns(j) of Source/Target Array (vntST).\n                    For j = 1 To UBound(vntST, 2)\n                        ' Write empty strings (\"\") to current row(i) in\n                        ' column (j) of Source/Target Array (vntST)\n                        vntST(i, j) = \"\"\n                    Next\n                Next\n\n                '******************************\n                ' Target (Source) Range (Rng) '\n                '******************************\n\n                ' Copy completely modified Source/Target Array (vntST)\n                ' to Source/Target Range (Rng).\n                Rng = vntST\n\n            Case 2  ' Faster Version.\n\n                '******************************\n                ' Target (Source) Range (Rng) '\n                '******************************\n\n                ' Copy not completely modified Source/Target Array (vntST)\n                ' to Source/Target Range (Rng).\n                Rng = vntST\n\n                ' Delete remaining (not modified) rows greater than current\n                ' Target Array Row Number (k) increased by First Row (cFR),\n                ' i.e. starting from the calculated row:\n                ' (k + 1) + (cFR - 1) = k + cFR.\n                .Rows(k + cFR &amp; \":\" &amp; Rng.Rows.Count + cFR - 1).Delete\n\n            Case 3  ' Faster Version.\n\n                '******************************\n                ' Target (Source) Range (Rng) '\n                '******************************\n\n                ' Copy not completely modified Source/Target Array (vntST)\n                ' to Source/Target Range (Rng).\n                Rng = vntST\n\n                ' Delete remaining (not modified) range.\n                .Columns(cRange).Resize(Rng.Rows.Count - k) _\n                        .Offset(k + cFR - 1).Delete ' Clear, ClearContents\n            Case Else\n\n        End Select\n\n    End With\n\nProcedureExit:\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9660091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bd4632f8e9a0365ac5c7eaa73ea52a?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon M.", "link": "https://stackoverflow.com/users/9660091/brandon-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 54795001, "answer_count": 3, "score": 0, "last_activity_date": 1550750844, "creation_date": 1550694871, "question_id": 54794806, "link": "https://stackoverflow.com/questions/54794806/vba-macro-to-filter-a-table-by-specific-cell-value-and-delete-all-rows", "title": "VBA Macro to filter a table by specific cell value and delete all rows", "body": "<p>The intention of my macro is to perform the following steps:\n 1: Filter table looking at column D to retrieve all \"0\" values\n 2: Delete all rows with \"0\" values\n 3: Remove filter.</p>\n\n<p>The issue is that my table has 75,000+ rows of data so I keep getting alerts saying I have too much data. I tried a loop macro but it was taking too long to perform the job so I am now working on a macro that performs the above steps. My code keeps getting hung up on the line to delete the range of cells I selected. (my range goes  past the table range because this table will always have a variable amount of rows).</p>\n\n<p>Error: \"Method 'Range' of oject'_Worksheet' failed</p>\n\n<p>I am assuming that I need to specify the exact number of rows in my table. How do I change the code so that I do not have to change the range every time I perform the macro?</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub Delete_Zero_Rows()\n\nDim ws As Worksheet\n  Set ws = ThisWorkbook.Worksheets(\"Status\")\n  ws.Activate\n\n  On Error Resume Next\n    ws.ShowAllData\n  On Error GoTo 0\n  ws.Range(\"B3:F1\").AutoFilter Field:=4, Criteria1:=\"0\"\n\n\n  Application.DisplayAlerts = False\n    ws.Range(\"B4:F\").SpecialCells(xlCellTypeVisible).Delete\n  Application.DisplayAlerts = True\n  On Error Resume Next\n    ws.ShowAllData\n  On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550693651, "post_id": 54794460, "comment_id": 96367093, "body": "My with block is specifically for the ListBox object inside the userform. I don&#39;t think that has the <code>.Show</code> property. As well, I am trying to show the entire <code>GUI_Form</code>, which includes the ListBox. I don&#39;t think putting it in the with would help, do you?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550693787, "post_id": 54794460, "comment_id": 96367155, "body": "Just out of curiosity though, why are you setting the visibility to <code>False</code> before the form is even shown?"}, {"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550694126, "post_id": 54794460, "comment_id": 96367301, "body": "To be honest, this is a code that got passed down from who-knows-when and it has just worked since my team has had it..... I&#39;m relatively OK with taking these <code>.Visible</code> lines out, but maybe there is a reason they are there. I&#39;m more curious why it has worked for probably 2 decades of VBA and now Excel doesn&#39;t like it for some reason."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1550694258, "post_id": 54794460, "comment_id": 96367367, "body": "any <code>on error resume next </code> somewhere in the code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1550695418, "post_id": 54794460, "comment_id": 96367873, "body": "I don&#39;t have 365 to test this code right now, so I&#39;m just going to assume <i>this exact code</i> constitutes a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (if you copy it to a new VBA project and it doesn&#39;t reproduce the problem, please <a href=\"https://stackoverflow.com/posts/54794460/edit\">edit</a> your code with code that does) -- I&#39;d start with avoiding storing state in any class&#39; <i>default instance</i> (see <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a>), i.e. going with <code>With New GUI_Form...End With</code>, with the <code>.Show</code> inside that <code>With</code> block."}], "owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550694211, "creation_date": 1550693279, "last_edit_date": 1550694211, "question_id": 54794460, "link": "https://stackoverflow.com/questions/54794460/excel-vba-userform-listbox-visible-true-does-not-cancel-out-visible-false-office", "title": "Excel VBA Userform ListBox Visible=True does not cancel out Visible=False Office 365", "body": "<p>I am facing an issue that I cannot figure out why my ListBox will not show up in the final userform. This is a new issue when I upgraded to Excel Office 365.</p>\n\n<p>Basically I have a with block which contains a whole bunch of additem, sort, etc. which looks like this;</p>\n\n<pre><code> With GUI_Form.ListBox1\n     .Visible = False\n     'More Code .addItem, Sort, etc. All work fine\n     .Visible = True\n End With\n GUI_Form.Show\n</code></pre>\n\n<p>When it shows, everything works well except the ListBox is not visible. Has anyone seen this? As I said, it just started happening with Office 365, worked for all releases before now.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1550697543, "creation_date": 1550697543, "answer_id": 54795405, "question_id": 54794392, "link": "https://stackoverflow.com/questions/54794392/word-vba-to-remove-all-except-first-character-of-every-selected-word/54795405#54795405", "title": "Word VBA to remove all except first character of every selected word", "body": "<p>You don't need a macro/VBA for that - a simple <em>wildcard</em> Find/Replace will do, where:</p>\n\n<pre><code>Find = (&lt;[! ])*&gt;\nReplace = \\1\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2712885, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/h1RXh.jpg?s=128&g=1", "display_name": "Mark Helmstetter", "link": "https://stackoverflow.com/users/2712885/mark-helmstetter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 54795405, "answer_count": 1, "score": -1, "last_activity_date": 1550697543, "creation_date": 1550692986, "last_edit_date": 1550696279, "question_id": 54794392, "link": "https://stackoverflow.com/questions/54794392/word-vba-to-remove-all-except-first-character-of-every-selected-word", "title": "Word VBA to remove all except first character of every selected word", "body": "<p>Apologies if this has been previously asked, but while somewhat similar problems have been addresses I've not been able to find a working solution to this specific question.</p>\n\n<p>Using VBA in Microsoft Word (currently using 365/16), how can I efficiently remove all but the first character of each word that is currently selected? If it is more simple to assume that all words are wrapped by one space on both sides that is acceptable knowing it would leave words starting and ending sentences, as well as (most commonly) words followed by a comma. I also need the solution to leave all existing formatting in place (including section and page layout, etc.), especially the case sensitivity of the first letter after removing the remaining letters. An example would be:</p>\n\n<hr>\n\n<h3>Original</h3>\n\n<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Tortor dignissim convallis aenean et tortor at Risus Viverra adipiscing. Pellentesque sit amet porttitor eget dolor morbi. Ut placerat orci nulla pellentesque.</p>\n\n<p>Lorem mollis aliquam ut porttitor leo a. Urna duis convallis convallis tellus id Interdum Velit 23 Laoreet. Et leo duis ut diam quam nulla porttitor.</p>\n\n<h3>Becoming</h3>\n\n<p>L i d s a, c a e, s d e t i u l e d m a. T d c a e t a R V a. P s a p e d m. U p o n p.</p>\n\n<p>L m a u p l a. U d c c t i I V 2 L. E l d u d q n p.</p>\n\n<hr>\n\n<p>Any help or guidance would be appreciated.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "answers": [{"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 0, "last_activity_date": 1550693893, "creation_date": 1550693893, "answer_id": 54794603, "question_id": 54794140, "link": "https://stackoverflow.com/questions/54794140/is-it-possible-to-make-a-dynamic-sql-statement-based-on-combobox-value-in-access/54794603#54794603", "title": "Is it possible to make a dynamic sql statement based on combobox.value in access?", "body": "<p>You can't have the table name in the <code>WHERE</code> clause of your query (there might be a hacky way to do it, but it should be discouraged at any case).</p>\n\n<p>If you want to select data from 1 of a number of tables, your best bet is to generate SQL dynamically using VBA. One way to do this (especially if you want/need your query to open in Datasheet View for the end user) is to have a \"dummy\" query whose SQL you can populate using the form selections.</p>\n\n<p>For example, let's say we have 2 tables: <code>tTable1</code> and <code>tTable2</code>. Both of these tables have a single column named <code>Language</code>. You want the user to select data from either the first or second table, with an optional filter.</p>\n\n<ol>\n<li>Create a form with 2 combo boxes: One for the tables, and one with the criteria selections. It sounds like you've already done this step.</li>\n<li><p>Have a button on this form that opens the query. The code for this button's <code>press</code> event should look something like this:</p>\n\n<pre><code>Private Sub cmdRunQuery_Click()\n    Dim sSQL As String\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n\n    If Not IsNull(Me.cboTableName.Value) Then\n        sSQL = \"SELECT * FROM \" &amp; Me.cboTableName.Value\n\n        If Not IsNull(Me.cboFilter.Value) Then\n            sSQL = sSQL &amp; vbNewLine &amp; _\n                    \"WHERE Language=\"\"\" &amp; Me.cboFilter &amp; \"\"\"\"\n        End If\n\n        Set db = CurrentDb\n        Set qdf = db.QueryDefs(\"qDummyQuery\")\n        qdf.SQL = sSQL\n\n        DoCmd.OpenQuery qdf.Name\n    End If\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>Note how the SQL is being generated. Of course, using this method, you need to protect yourself from SQL injection: You should only allow predefined values in the combo box. But this serves as a proof of concept.</p>\n\n<p>If you don't need to show the query results, you don't need to use the dummy query: You could just open a recordset based on the SQL and process that.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11092204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-naVGV6t9lyk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPZblFR0gxPZPcv5veszKmRaFU-ng/mo/photo.jpg?sz=128", "display_name": "Nathan Fisher", "link": "https://stackoverflow.com/users/11092204/nathan-fisher"}, "is_accepted": false, "score": 0, "last_activity_date": 1550694332, "creation_date": 1550694332, "answer_id": 54794697, "question_id": 54794140, "link": "https://stackoverflow.com/questions/54794140/is-it-possible-to-make-a-dynamic-sql-statement-based-on-combobox-value-in-access/54794697#54794697", "title": "Is it possible to make a dynamic sql statement based on combobox.value in access?", "body": "<p>If you run the code in the afterupdate event of the combobox you can set an SQL statement like this:</p>\n\n<pre><code>Private Sub combobox2_AfterUpdate()\n   someGlobalVar = \"Select * FROM \" &amp; me.combobox1.value &amp; \" WHERE language = \" &amp; _\n         me.combobox2.value\nEnd Sub\n</code></pre>\n\n<p>And then call the global with the SQL string wherever you need it.</p>\n"}], "owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1594620270, "creation_date": 1550691831, "last_edit_date": 1594620270, "question_id": 54794140, "link": "https://stackoverflow.com/questions/54794140/is-it-possible-to-make-a-dynamic-sql-statement-based-on-combobox-value-in-access", "title": "Is it possible to make a dynamic sql statement based on combobox.value in access?", "body": "<p>I made a form in access with 2 different comboboxes. The user of\nThis tool can choose in combobox1: the table (which has to be filtered) and the second combobox2 is the criteria to be filtered( for example Language= \u201cEN\u201d) and the output of this query has to be located in tablex. </p>\n\n<p>The problen what I have is that i cant find a solution for passing the value of the combobox1 to the sql statement. The second one is just like: where [language] = forms!form!combo2.value, but the part where i cant find a solution for is: select * from (combobox1 value)? How can i pass the combobox value as table name to be filtered? Can anyone please help me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1550691952, "post_id": 54793944, "comment_id": 96366282, "body": "If cell  <b>B10</b> contains a <i>formula</i>, then you must use the <code>Calculate</code> event rather than the <code>Change</code> event."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550692033, "post_id": 54793944, "comment_id": 96366329, "body": "Also use <code>Me</code> in place of <code>ActiveSheet</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1550692194, "post_id": 54793944, "comment_id": 96366424, "body": "If you have multiple sheets which need this functionality, then use the <code>Workbook_SheetCalculate(ByVal Sh As Object)</code> event in the <code>ThisWorkbook</code> module - then you don&#39;t need code in every sheet"}, {"owner": {"reputation": 11, "user_id": 10902274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812dbfd1bfd8c4494229ca8f67a9fac?s=128&d=identicon&r=PG&f=1", "display_name": "JParsons03", "link": "https://stackoverflow.com/users/10902274/jparsons03"}, "edited": false, "score": 0, "creation_date": 1550693439, "post_id": 54793944, "comment_id": 96366973, "body": "Tim, I have changed it to me thanks for that. As far as the other comment, I do need it for all sheets except for 2 so I think I am screwed and will have to copy and paste it 100 times when I go and copy all the sheets. :("}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550700135, "post_id": 54793944, "comment_id": 96369868, "body": "Using the workbook event you can still filter out the two sheets you want to skip"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10902274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812dbfd1bfd8c4494229ca8f67a9fac?s=128&d=identicon&r=PG&f=1", "display_name": "JParsons03", "link": "https://stackoverflow.com/users/10902274/jparsons03"}, "edited": false, "score": 0, "creation_date": 1550693363, "post_id": 54794354, "comment_id": 96366934, "body": "This code does and is easier than the code I have written but I need it to constantly update. Thank you for your answer!"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1550730274, "post_id": 54794354, "comment_id": 96377966, "body": "You do not need to activate each sheet in order to check a range and change the colour based on that. Using <code>.Activate</code> is hardly ever needed. Since you are already looping through each sheet, you can use <code>ws.</code> instead of <code>ActiveSheet</code>. You will also need to fully qualify the <code>Range...</code> as <code>ws.Range...</code> and you are good to do the same thing, without ever activating the sheets."}], "tags": [], "owner": {"reputation": 99, "user_id": 8328185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534009583b625bb56bc48d4151f35e4d?s=128&d=identicon&r=PG&f=1", "display_name": "abe973t", "link": "https://stackoverflow.com/users/8328185/abe973t"}, "is_accepted": false, "score": -1, "last_activity_date": 1550692821, "creation_date": 1550692821, "answer_id": 54794354, "question_id": 54793944, "link": "https://stackoverflow.com/questions/54793944/trying-to-automatically-change-tab-colors-in-excel/54794354#54794354", "title": "Trying to automatically change tab colors in excel", "body": "<p>This works for me. Loop through each sheet (change the <code>A14</code>) and color code.</p>\n\n<pre><code>    Sub ColorCodeWS()\n\n      ' loop thru each sheet\n      For Each ws In Sheets\n         ws.Activate\n\n         If Range(\"A14\") &gt; 0 Then\n           ActiveSheet.Tab.ColorIndex = 3 'red\n         ElseIf Range(\"A14\") = 0 Then\n           ActiveSheet.Tab.ColorIndex = 4 'green\n         Else\n           ActiveSheet.Tab.ColorIndex = xlNone 'no color\n         End If\n      Next ws    \n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1550731069, "creation_date": 1550731069, "answer_id": 54800726, "question_id": 54793944, "link": "https://stackoverflow.com/questions/54793944/trying-to-automatically-change-tab-colors-in-excel/54800726#54800726", "title": "Trying to automatically change tab colors in excel", "body": "<p>Using the suggestion from Tim, and your logic...I would do something like this:</p>\n\n<pre><code>Sub Workbook_SheetCalculate(ByVal Sh As Object)\n\n If sh.name = \"thatname\" or sh.name = \"anothername\" then exit sub\n\n      Select Case sh.Range(\"B104\").Value\n          Case Is &gt; 0\n                Sh.Tab.ColorIndex = 3 'red\n          Case Is = 0\n                Sh.Tab.ColorIndex = 4 'green\n          Case Else\n                Sh.Tab.ColorIndex = xlNone 'no color\n     End Select\nEnd Sub\n</code></pre>\n\n<p>Apologies for any indentation issues, posting from my phone.</p>\n"}], "owner": {"reputation": 11, "user_id": 10902274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812dbfd1bfd8c4494229ca8f67a9fac?s=128&d=identicon&r=PG&f=1", "display_name": "JParsons03", "link": "https://stackoverflow.com/users/10902274/jparsons03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550731069, "creation_date": 1550691084, "question_id": 54793944, "link": "https://stackoverflow.com/questions/54793944/trying-to-automatically-change-tab-colors-in-excel", "title": "Trying to automatically change tab colors in excel", "body": "<p>Background: I am working on a checklist project that has about 100 similar sheets. I have got it all working down to a summary table. If there is an unchecked box then it shows up on this summary section on the bottom of each sheet. There is a total row at the bottom of the summary section which basically shows the amount of unchecked items on the sheet. </p>\n\n<p>SO, now to my question. If that cell has a value more than 0 then I want the tab color to be red. If it has a value of 0 then I want the tab color to be green for that sheet.</p>\n\n<p>I have seen forums where people say that I should put my code under the Worksheet_Change function in the VBA editor for that sheet. BUT that won't work. I'll put code in there and it doesn't run. I was wondering if anyone knew where I was doing something wrong. </p>\n\n<p>I have also tried to put the code in a module and calling it in the sheet code but that didn't work either. It seems like other people are having success with this kind of thing so I am sure I am just not thinking of something.</p>\n\n<p>For Reference:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n If Not Intersect(Target, Range(\"B104\")) Is Nothing Then\n    Select Case Target.Value\n        Case Is &gt; 0\n            ActiveSheet.Tab.ColorIndex = 3 'red\n        Case Is = 0\n            ActiveSheet.Tab.ColorIndex = 4 'green\n        Case Else\n            ActiveSheet.Tab.ColorIndex = xlNone 'no color\n    End Select\n End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "edited": false, "score": 0, "creation_date": 1550691901, "post_id": 54794093, "comment_id": 96366260, "body": "Oops! It&#39;s been a long day haha. Thanks @Nad None"}], "tags": [], "owner": {"reputation": 140, "user_id": 9565106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a719401bb831db0e6a6f4e1b3bbc45f?s=128&d=identicon&r=PG&f=1", "display_name": "NadAlaba", "link": "https://stackoverflow.com/users/9565106/nadalaba"}, "is_accepted": true, "score": 1, "last_activity_date": 1550691651, "creation_date": 1550691651, "answer_id": 54794093, "question_id": 54793937, "link": "https://stackoverflow.com/questions/54793937/how-to-exit-a-sub-if-the-userform-textbox-value-is-empty-or-if-the-string-can-be/54794093#54794093", "title": "How to exit a sub if the userform textbox value is empty or if the string can be found in a list of ranges", "body": "<blockquote>\n  <p>even when the textbox value appears in that range, the if clause is skipped over.</p>\n</blockquote>\n\n<p>This is because you are exiting the sub when you <strong>don't</strong> find the value in the range.\nI've added a <code>Not</code> to fix that.</p>\n\n<pre><code>Private Sub cmd_nProj_Click()\n    Dim wb As Workbook\n    Dim ws As Worksheet, ws_h As Worksheet\n    Dim i_rc As Long\n    Dim r_home As Range, r_ProdName As Range\n\n\n\n\n    Set wb = Application.ThisWorkbook\n    Set ws_h = wb.Sheets(\"Control\")\n\n    i_rc = ws_h.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Set r_home = ws_h.Range(\"A\" &amp; i_rc + 1)\n    Set r_ProdName = ws_h.Range(\"N2:N30\")\n    If Me.tb_NewProjName = \"\" Or Not (r_ProdName.Find(What:=Me.tb_NewProjName.Value, LookIn:=xlValues) Is Nothing) Then\n        MsgBox (\"Either you have left the projection name blank or the projection name is already being used, please try again!\")\n        Exit Sub\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 54794093, "answer_count": 1, "score": 1, "last_activity_date": 1550695163, "creation_date": 1550691053, "last_edit_date": 1550695163, "question_id": 54793937, "link": "https://stackoverflow.com/questions/54793937/how-to-exit-a-sub-if-the-userform-textbox-value-is-empty-or-if-the-string-can-be", "title": "How to exit a sub if the userform textbox value is empty or if the string can be found in a list of ranges", "body": "<p>I've been struggling to figure this out, despite using many recommendations and variations that I've found online. I want to exit the sub if the user has forgotten to enter a value or if the value can be found in a range of strings, this is pertaining to a userform.</p>\n\n<p>Here is the most recent of many variations i've tried for the <code>IF</code> clause:</p>\n\n<pre><code>Private Sub cmd_nProj_Click()\n    Dim wb As Workbook\n    Dim ws As Worksheet, ws_h As Worksheet\n    Dim i_rc As Long\n    Dim r_home As Range, r_ProdName As Range\n\n\n\n\n    Set wb = Application.ThisWorkbook\n    Set ws_h = wb.Sheets(\"Control\")\n\n    i_rc = ws_h.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Set r_home = ws_h.Range(\"A\" &amp; i_rc + 1)\n    Set r_ProdName = ws_h.Range(\"N2:N30\")\n    If Me.tb_NewProjName = \"\" Or r_ProdName.Find(What:=Me.tb_NewProjName.Value, LookIn:=xlValues) Is Nothing Then\n        MsgBox (\"Either you have left the projection name blank or the projection name is already being used, please try again!\")\n        Exit Sub\n\n    End If\nend sub\n</code></pre>\n\n<p>Other variations I would get an object with block variable not set error, and in this iteration the if clause is not working correctly in that even when the textbox value appears in that range, the if clause is skipped over.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["arrays", "excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1550691432, "post_id": 54793905, "comment_id": 96365998, "body": "Range indexing is 1 based. You&#39;re copying it into a zero based array."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1550692296, "post_id": 54793905, "comment_id": 96366466, "body": "<code>ReDim newrange(1 to g)</code> would fix your problem. <code>ReDim newrange(g)</code> is equivalent to <code>ReDim newrange(0 to g)</code>"}, {"owner": {"reputation": 11, "user_id": 10397558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OBjKw3aECNw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV5Oc_ZD73tt7o_7zi0lkqtfujdgg/mo/photo.jpg?sz=128", "display_name": "Hagen Lendewig", "link": "https://stackoverflow.com/users/10397558/hagen-lendewig"}, "edited": false, "score": 0, "creation_date": 1551718494, "post_id": 54793905, "comment_id": 96733620, "body": "It&#39;s working now, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550694912, "post_id": 54794276, "comment_id": 96367631, "body": "Have an upvote - note that the explicit array bounds are much preferable than setting <code>Option Base</code> and keeping the implicit lower bound."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11087823"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550708318, "post_id": 54794276, "comment_id": 96372319, "body": "Agreed. I never use Option Base 1 myself and honestly don&#39;t see much use for it beyond obfuscating one code sheet among others in a project that will still default to Option Base 0. However, I know others that do use it and prefer it so there it is for those that prefer to complicate things unnecessarily."}, {"owner": {"reputation": 11, "user_id": 10397558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OBjKw3aECNw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV5Oc_ZD73tt7o_7zi0lkqtfujdgg/mo/photo.jpg?sz=128", "display_name": "Hagen Lendewig", "link": "https://stackoverflow.com/users/10397558/hagen-lendewig"}, "edited": false, "score": 0, "creation_date": 1551718480, "post_id": 54794276, "comment_id": 96733611, "body": "Perfect, thank you! I appreciate your explanation; I learned something new today!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11087823"}, "is_accepted": false, "score": 5, "last_activity_date": 1550692430, "creation_date": 1550692430, "answer_id": 54794276, "question_id": 54793905, "link": "https://stackoverflow.com/questions/54793905/excel-vba-mysterious-zero-is-being-added-to-array-created-with-for-loop/54794276#54794276", "title": "Excel VBA: Mysterious Zero is Being Added to Array Created with &quot;For&quot; Loop", "body": "<p>1-D arrays default to a zero-based index structure (e.g. <em>0, 1, 2, 3, ....</em>). You are looping through the ranges with a one based index (e.g. <em>1, 2, 3, 4, ...</em>).</p>\n\n<p>When you declare <code>ReDim newrange(5)</code> you are actually creating an array with six elements, not five (e.g. <em>0, 1, 2, 3, 4, 5</em>)</p>\n\n<p>You can make all arrays on that code sheet default to a one based index by putting this compiler directive at the top of the code sheet.</p>\n\n<pre><code>Option Base 1\n</code></pre>\n\n<p>You can also change the way the array is declared on the fly by specifying the Lower Boundary and the Upper Boundary.</p>\n\n<pre><code>ReDim newrange(1 to g)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10397558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OBjKw3aECNw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV5Oc_ZD73tt7o_7zi0lkqtfujdgg/mo/photo.jpg?sz=128", "display_name": "Hagen Lendewig", "link": "https://stackoverflow.com/users/10397558/hagen-lendewig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550692430, "creation_date": 1550690899, "question_id": 54793905, "link": "https://stackoverflow.com/questions/54793905/excel-vba-mysterious-zero-is-being-added-to-array-created-with-for-loop", "title": "Excel VBA: Mysterious Zero is Being Added to Array Created with &quot;For&quot; Loop", "body": "<p>Hey everyone: I'm trying to make a function that digs through an array and adds values from range2 when the corresponding value from range1 equals criteria1.</p>\n\n<p>I'm relatively new to VBA, so it's not the most elegant function in the world, but here's my code:</p>\n\n<pre><code>Function SingleArray(range1 As Range, range2 As Range, criteria1 As String)\n\nDim newrange() As Double\nDim d As Integer\nDim g As Integer\nDim i As Integer\n\ng = Application.WorksheetFunction.CountIf(range1, criteria1)\n\nReDim newrange(g)\n\nd = 1\n\nFor i = 0 To (range1.Count)\n    If range1(i) = criteria1 Then\n        newrange(d) = range2.Item(i).Value\n        d = d + 1\n        End If\n    Next i\n\n\nSingleArray = newrange\n\nEnd Function\n</code></pre>\n\n<p>Here is my data sample:</p>\n\n<pre><code>range2  range1\n-5000   Bob\n-5000   Jim \n 200    Bob \n 500    Jim \n 5000   Bob \n 200    Bob \n 300    Bob \n 1000   Bob\n</code></pre>\n\n<p>When I set the criteria as \"Bob,\" the array that is returned is as follows:</p>\n\n<pre><code>{0,-5000,200,5000,200,300,1000}\n</code></pre>\n\n<p>I'm genuinely at a loss for how that zero is making it in there. Any thoughts you can provide would be most welcome!</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 1129, "user_id": 2639700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UDUj4.jpg?s=128&g=1", "display_name": "slashCoder", "link": "https://stackoverflow.com/users/2639700/slashcoder"}, "edited": false, "score": 0, "creation_date": 1550694428, "post_id": 54793900, "comment_id": 96367443, "body": "Your question is hard to understand the way it&#39;s currently formulated. Please try to explain your problem in a clearer way so we can help you. Also, make sure your code snippet is complete and correctly formatted."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550695814, "post_id": 54793900, "comment_id": 96368061, "body": "please include your code."}, {"owner": {"reputation": 13, "user_id": 11091903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73DxWgBwCv8/AAAAAAAAAAI/AAAAAAAAAC4/mAgCkkcUokM/photo.jpg?sz=128", "display_name": "DeeTee", "link": "https://stackoverflow.com/users/11091903/deetee"}, "edited": false, "score": 0, "creation_date": 1550699659, "post_id": 54793900, "comment_id": 96369693, "body": "Noted.Thank you for your remarks.I hope the question is clearer"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1550729623, "last_edit_date": 1550729623, "creation_date": 1550701901, "answer_id": 54796282, "question_id": 54793900, "link": "https://stackoverflow.com/questions/54793900/scraping-a-table-from-a-website-using-vba/54796282#54796282", "title": "Scraping a table from a website using VBA", "body": "<p>You can avoid a browser and use xmlhttp to get the page content, then select the table element by its class (there is no id to use and class is the next fastest selector after id) and then loop the rows and columns writing out to sheet.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim html As MSHTML.HTMLDocument, hTable As Object, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set html = New MSHTML.HTMLDocument                  '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"http://www.bkam.ma/Marches/Principaux-indicateurs/Marche-obligataire/Marche-des-bons-de-tresor/Marche-secondaire/Taux-de-reference-des-bons-du-tresor?date=13%2F02%2F2019&amp;block=e1d6b9bbf87f86f8ba53e8518e882982#address-c3367fcefc5f524397748201aee5dab8-e1d6b9bbf87f86f8ba53e8518e882982\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n    Set hTable = html.querySelector(\".dynamic_contents_ref_12\")\n    Dim td As Object, tr As Object, th As Object, r As Long, c As Long\n    For Each tr In hTable.getElementsByTagName(\"tr\")\n        r = r + 1: c = 1\n        For Each th In tr.getElementsByTagName(\"th\")\n            ws.Cells(r, c) = th.innerText\n            c = c + 1\n        Next\n        For Each td In tr.getElementsByTagName(\"td\")\n            ws.Cells(r, c) = td.innerText\n            c = c + 1\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 9133950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e18d68a57147f7851a0ed2f1bc868b?s=128&d=identicon&r=PG&f=1", "display_name": "DarthVlader", "link": "https://stackoverflow.com/users/9133950/darthvlader"}, "is_accepted": false, "score": 0, "last_activity_date": 1550931781, "creation_date": 1550931781, "answer_id": 54842584, "question_id": 54793900, "link": "https://stackoverflow.com/questions/54793900/scraping-a-table-from-a-website-using-vba/54842584#54842584", "title": "Scraping a table from a website using VBA", "body": "<h3>First, you can find the table based on its class attribute</h3>\n\n<pre><code>Set HTMLTable = appIE.document.getElementsByClassName(\"dynamic_contents_ref_12\")(0)\n</code></pre>\n\n<p>This will get the array of HTML elements with the class name <code>dynamic_contents_ref_12</code> and return its first element.</p>\n\n<h3>Then, you can 'crawl' the table using the `.Children` attribute</h3>\n\n<p>This will get you the first row:</p>\n\n<pre><code>Set TBody = HTMLTable.Children(1) 'The &lt;tbody&gt; tag is the second child\nSet Row1 = TBody.Children(0)      'The first &lt;tr&gt; inside the &lt;tbody&gt; tag\n</code></pre>\n\n<p>For each row put a different index in the brackets.</p>\n\n<p>Now the HTML inside <code>Row1</code> looks like</p>\n\n<pre><code>&lt;tr&gt;\n\n  &lt;td&gt;\n    18/03/2019\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    &lt;span class=\"number\"&gt;\n      20,05&amp;nbsp;\n      &lt;span class=\"symbol\"&gt;&lt;/span&gt;\n    &lt;/span&gt;\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    &lt;span class=\"number\"&gt;\n      2,250&amp;nbsp;\n      &lt;span class=\"symbol\"&gt;%&lt;/span&gt;\n    &lt;/span&gt;\n  &lt;/td&gt;\n\n  &lt;td&gt;\n    13/02/2019\n  &lt;/td&gt;\n\n&lt;/tr&gt;\n</code></pre>\n\n<p>(Each <code>&lt;td&gt;</code> is a cell in the row.)</p>\n\n<p>To get the text inside a cell we can use the <code>.innerText</code> method, which returns a string:</p>\n\n<pre><code>CellA1 = Row1.Children(0).innerText ' = \"05/04/2019\"\nCellB1 = Row1.Children(1).innerText ' = \"43,85 \"\n</code></pre>\n\n<h3>Putting it all together</h3>\n\n<p>Using a <code>For Each</code> loop, we can get all the cells from the HTML table and copy them to a sheet - let's assume you want to start from cell <strong>A1</strong>.</p>\n\n<pre><code>'Table Headers\nActiveSheet.Range(\"A1\").Value = \"Date d'\u00e9ch\u00e9ance\"\nActiveSheet.Range(\"B1\").Value = \"Transaction\"\nActiveSheet.Range(\"C1\").Value = \"Taux moyen pond\u00e9r\u00e9\"\nActiveSheet.Range(\"D1\").Value = \"Date de la valeur\"\n\nSet HTMLTable = appIE.document.getElementsByClassName(\"dynamic_contents_ref_12\")(0)\nSet TBody = HTMLTable.Children(1)\nRowIndex = 2\nFor Each Row in TBody.Children\n  ActiveSheet.Cells(RowIndex, 1).Value = Row.Children(0).innerText\n  ActiveSheet.Cells(RowIndex, 2).Value = Row.Children(1).innerText\n  ActiveSheet.Cells(RowIndex, 3).Value = Row.Children(2).innerText\n  ActiveSheet.Cells(RowIndex, 4).Value = Row.Children(3).innerText\n  RowIndex = RowIndex + 1\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11091903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-73DxWgBwCv8/AAAAAAAAAAI/AAAAAAAAAC4/mAgCkkcUokM/photo.jpg?sz=128", "display_name": "DeeTee", "link": "https://stackoverflow.com/users/11091903/deetee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2302, "favorite_count": 1, "accepted_answer_id": 54796282, "answer_count": 2, "score": 1, "last_activity_date": 1550931781, "creation_date": 1550690884, "last_edit_date": 1550733303, "question_id": 54793900, "link": "https://stackoverflow.com/questions/54793900/scraping-a-table-from-a-website-using-vba", "title": "Scraping a table from a website using VBA", "body": "<p>I'm a newbie in VBA and the website.</p>\n\n<p>I'm trying to pull data (table) from the website below to be used in a VBA code.</p>\n\n<p><a href=\"http://www.bkam.ma/Marches/Principaux-indicateurs/Marche-obligataire/Marche-des-bons-de-tresor/Marche-secondaire/Taux-de-reference-des-bons-du-tresor?date=13%2F02%2F2019&amp;block=e1d6b9bbf87f86f8ba53e8518e882982#address-c3367fcefc5f524397748201aee5dab8-e1d6b9bbf87f86f8ba53e8518e882982\" rel=\"nofollow noreferrer\">http://www.bkam.ma/Marches/Principaux-indicateurs/Marche-obligataire/Marche-des-bons-de-tresor/Marche-secondaire/Taux-de-reference-des-bons-du-tresor?date=13%2F02%2F2019&amp;block=e1d6b9bbf87f86f8ba53e8518e882982#address-c3367fcefc5f524397748201aee5dab8-e1d6b9bbf87f86f8ba53e8518e882982</a></p>\n\n<p>I tried to create an Internet Explorer browser :</p>\n\n<pre><code>Dim appIE As Object\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nWith appIE\n    .Navigate \"http://www.bkam.ma/Marches/Principaux-indicateurs/Marche-obligataire/Marche-des-bons-de-tresor/Marche-secondaire/Taux-de-reference-des-bons-du-tresor?date=13%2F02%2F2019&amp;block=e1d6b9bbf87f86f8ba53e8518e882982#address-c3367fcefc5f524397748201aee5dab8-e1d6b9bbf87f86f8ba53e8518e882982\"\n    .Visible = True\nEnd With\n\nDo While appIE.Busy\n    DoEvents\nLoop\n</code></pre>\n\n<p>Then, I tried to use the ID or the tagname properties to get the data</p>\n\n<pre><code>Set val = appIE.document.getElementById()\n</code></pre>\n\n<p>I don't know how to get the elements of the table since they don't have an ID or Tagname that I can use . As you can see in this snippet from the source code</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>                              &lt;/span&gt;\r\n                                           &lt;/div&gt;\r\n                                       &lt;/th&gt;\r\n                                                                                                                                                                                        &lt;/tr&gt;\r\n                            &lt;/thead&gt;\r\n                            &lt;tbody&gt;\r\n                                                \r\n                                                                                         \r\n                                                                                                                                                                                    &lt;tr&gt;\r\n                             \r\n         &lt;td&gt;18/03/2019&lt;/td&gt;\r\n      \r\n         &lt;td&gt;&lt;span class=\"number\"&gt;20,05&lt;/sapn&gt;&amp;nbsp;&lt;span class=\"symbol\"&gt;&lt;/span&gt;&lt;/td&gt;\r\n      \r\n         &lt;td&gt;&lt;span class=\"number\"&gt;2,250&lt;/sapn&gt;&amp;nbsp;&lt;span class=\"symbol\"&gt;%&lt;/span&gt;&lt;/td&gt;\r\n      \r\n         &lt;td&gt;13/02/2019&lt;/td&gt;\r\n      \r\n    \r\n                             &lt;/tr&gt;\r\n                        \r\n                                             </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>this snippet shows the first row of the table that I'm trying to extract.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550850597, "post_id": 54794910, "comment_id": 96436188, "body": "Tim, thank you. This worked well...my only issue is that the workbooks I am opening are password protected. HOw can i insert the password so that it automatically opens all my files without having to input the password for each"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550851122, "post_id": 54794910, "comment_id": 96436472, "body": "Password for opening, or password-protected sheets?"}, {"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550854168, "post_id": 54794910, "comment_id": 96438180, "body": "Hi Tim, each of the files in my array (Admin, Blas, etc) are all password protected workbooks that all have different passwords....how can i include this into the code above so that they will open without me having to input the passwords for each workbook.....thank you again for your help"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550856520, "post_id": 54794910, "comment_id": 96439351, "body": "Is the password required to <i>open</i> the files, or are the worksheets protected with a password?"}, {"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550856952, "post_id": 54794910, "comment_id": 96439539, "body": "Hi Tim, sorry - the password is required to open the files. none of the worksheets are protected, just the whole file"}, {"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550857932, "post_id": 54794910, "comment_id": 96440031, "body": "Hi Tim, I am getting a Compile Error: ByRef argument type mismatch.....could you advise how to move forward? Thank you again for all your help"}, {"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550858333, "post_id": 54794910, "comment_id": 96440233, "body": "it looks like it is happening at this point:   arrData = FileData(ROOT &amp; &quot;Radley Files\\&quot; &amp; arrFiles(i), arrPW(i)) &#39;&lt;&lt; get the data from this file................happening at the arrPW(i))"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550858763, "post_id": 54794910, "comment_id": 96440428, "body": "See my edit above for the <code>FileData</code> function parameters"}, {"owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "edited": false, "score": 0, "creation_date": 1550859108, "post_id": 54794910, "comment_id": 96440605, "body": "THANK YOU, this worked perfectly...Tim, you sir are a gentleman and a scholar. I cant thank you enough...have a great day"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1550858730, "last_edit_date": 1550858730, "creation_date": 1550695278, "answer_id": 54794910, "question_id": 54793811, "link": "https://stackoverflow.com/questions/54793811/specifying-file-names-for-pasted-data-in-vba-showing-which-file-data-came-from/54794910#54794910", "title": "Specifying File Names for Pasted data in VBA...showing which file data came from", "body": "<p>Your code would benefit from extracting the common parts into a stand-alone function which just fetches the data from each file.</p>\n\n<p>Compiled but not tested:</p>\n\n<pre><code>Sub MasterFile_Consolidate()\n    Const ROOT As String = \"C:\\Users\\zk4h90v\\Desktop\\\"\n    Dim lastRow As Long, arrData, wbMaster As Workbook\n    Dim shtMaster As Worksheet, arrPW, arrFiles, i as long\n\n    MsgBox \"This will take a few moments\"\n\n    'Open MF\n    Set wbMaster = Workbooks.Open(Filename:=ROOT &amp; \"MasterFile.xlsm\", _\n                                  UpdateLinks:=False)\n\n    Set shtMaster = wbMaster.Sheets(\"2019\")\n    shtMaster.Range(\"B4:BO65536\").Clear\n\n    arrFiles = Array(\"Admin.xlsm\", \"Blas.xlsm\")'&lt;&lt; add the rest of your filenames here\n    arrPW = Array(\"password1\", \"password2\")'&lt;&lt; and the passwords here\n\n    For i = lbound(arrFiles) to ubound(arrFiles) \n\n        arrData = FileData(ROOT &amp; \"Radley Files\\\" &amp; arrFiles(i), arrPW(i)) '&lt;&lt; get the data from this file\n        With shtMaster.Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0)\n            .Resize(UBound(arrData, 1), UBound(arrData, 2)).Value = arrData '&lt;&lt; add the data\n            .Offset(0, -1).Resize(UBound(arrData, 1), 1).Value = arrFiles(i) '&lt;&lt; add the filename\n        End With\n\n    Next i\n\n    MsgBox \"Done\"\nEnd Sub\n\n'edited parameters...\nFunction FileData(fPath, PW)\n\n    Dim wb As Workbook, sht As Worksheet, lastRow As Long, arrData\n\n    Set wb = Workbooks.Open(Filename:=fPath, UpdateLinks:=False, _\n                            Password:=PW)\n    Set sht = wb.Worksheets(\"Resource Plan\")\n    On Error Resume Next\n    sht.ShowAllData\n    On Error GoTo 0\n    sht.Columns.EntireColumn.Hidden = False\n    sht.Rows.EntireRow.Hidden = False\n\n    lastRow = sht.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    arrData = sht.Range(sht.Range(\"A4\"), sht.Range(\"BO\" &amp; lastRow)) '&lt;&lt; get data as array\n    wb.Close False\n\n    FileData = arrData\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11058906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/483ac9dc6420e1351df4f336715547e1?s=128&d=identicon&r=PG&f=1", "display_name": "zemarshall44", "link": "https://stackoverflow.com/users/11058906/zemarshall44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550858730, "creation_date": 1550690497, "last_edit_date": 1550734494, "question_id": 54793811, "link": "https://stackoverflow.com/questions/54793811/specifying-file-names-for-pasted-data-in-vba-showing-which-file-data-came-from", "title": "Specifying File Names for Pasted data in VBA...showing which file data came from", "body": "<p>I have been working on a Macro that will take data from 6 different files and then paste that data into a Master file on top of eachother to have them all in one consolidated file.</p>\n\n<p>I have written this code but now want to add to it. I am trying to add a column to the left of where all my data is pasted that specifies which file that data came from so we can run pivot tables off the master file.</p>\n\n<p>For example, if File A had 1000 rows of data, I would want column A to have the value \"A\" for every row associated with data from File A. if file B had 2000 rows of data, then for all those rows show \"b\" for all 2000 rows and the first 1000 rows would have \"a\".....</p>\n\n<p>my challenge in inputting values would also be that this is a dynamic range, so it wont be a standard number of rows each time.</p>\n\n<p>Below is the code I have written thus far to pull the information I need from the seperate files and copy and paste to the Master.</p>\n\n<pre><code>Sub MasterFile_Consolidate()\n\nDim LastRow As Long\n\n\n\nMsgBox \"This will take a few moments\"\n\n'Open MF\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\MasterFile.xlsm\", UpdateLinks:=False\n    Worksheets(\"2019\").Range(\"B4:BO65536\").Clear\n\n'Admin\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Admin.xlsm\", UpdateLinks:=False, ReadOnly:=True, Password:=\"VWMTA2019!\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Admin.xlsm\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Admin.xlsm\").Close SaveChanges:=False\n\n'Blas\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Blas.xlsm\", UpdateLinks:=False, ReadOnly:=True, Password:=\"vklf_blas4\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Blas.xlsm\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\n\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Blas.xlsm\").Close SaveChanges:=False\n\n'Epstein\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Epstein.xlsm\", UpdateLinks:=False, ReadOnly:=True, Password:=\"ccce2019\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Epstein.xlsm\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Epstein.xlsm\").Close SaveChanges:=False\n\n'Deir\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Deir.xlsb\", UpdateLinks:=False, ReadOnly:=True, Password:=\"GFCC2019rft\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Deir.xlsb\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Deir.xlsb\").Close SaveChanges:=False\n\n'Palazzotto\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Maria.xlsb\", UpdateLinks:=False, ReadOnly:=True, Password:=\"DATA2019rft\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Maria.xlsb\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Maria.xlsb\").Close SaveChanges:=False\n\n'Thummala\nWorkbooks.Open Filename:=\"C:\\Users\\zk4h90v\\Desktop\\Radley Files\\Mahesh.xlsm\", UpdateLinks:=False, ReadOnly:=True, Password:=\"eit19ccor\"\n    Worksheets(\"Resource Plan\").Activate\n    On Error Resume Next\n     Worksheets(\"Resource Plan\").ShowAllData\n    On Error GoTo 0\n    Columns.EntireColumn.Hidden = False\n    Rows.EntireRow.Hidden = False\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWorkbooks(\"Mahesh.xlsm\").Worksheets(\"Resource Plan\").Range(\"A4:BO\" &amp; LastRow).Copy\n\n\nWorkbooks(\"MasterFile\").Activate\nWorkbooks(\"MasterFile\").Worksheets(\"2019\").Cells(Cells.Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\nWorkbooks(\"Mahesh.xlsm\").Close SaveChanges:=False\n\nMsgBox \"Done\"\nEnd Sub\n</code></pre>\n\n<p>If I could include this line of code to be applicable to every workbook it would be a tremendous help! Thank you again, if I can specify anything further please let me know and I will comment immediately.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1550690514, "post_id": 54793731, "comment_id": 96365587, "body": "Just set the values equal to eachother - <code>Sheets(&quot;New Sheet Name&quot;).Cells.Value = Sheets(&quot;New Sheet Name&quot;).Cells.Value</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11091528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad0c3a23b05919bd899dbc4cf16949c?s=128&d=identicon&r=PG&f=1", "display_name": "Big D", "link": "https://stackoverflow.com/users/11091528/big-d"}, "edited": false, "score": 0, "creation_date": 1550769151, "post_id": 54793791, "comment_id": 96402052, "body": "Dakota: My code copies the Sheet1 to Sheet1(2) which is what I want but I only want to paste values no formulas from Sheet1 to Sheet1(2).  I&#39;ve tried to select a range and paste values but I add a new worksheet which is name Sheet2 or Sheet3...  I want it to be Sheet1(2), look just like Sheet1 except values only.  I&#39;m not quite sure where or even how to use your syntax above.  I&#39;ve now ordered 2 books on Excel vba from Amazon just to learn.  So I&#39;m still struggling with this."}], "tags": [], "owner": {"reputation": 394, "user_id": 2596757, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f68659f60a4c9616c9ed05a3e6e6b718?s=128&d=identicon&r=PG", "display_name": "Dakota", "link": "https://stackoverflow.com/users/2596757/dakota"}, "is_accepted": false, "score": 0, "last_activity_date": 1550690438, "creation_date": 1550690438, "answer_id": 54793791, "question_id": 54793731, "link": "https://stackoverflow.com/questions/54793731/excel-macro-to-copy-worksheet-to-new-worksheet-paste-values-only/54793791#54793791", "title": "Excel Macro to copy worksheet to new worksheet paste values only", "body": "<p>If the data is contiguous, consider creating a new sheet, selecting and copying the range of data, and pasting onto the new sheet using the below code.</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1550691641, "creation_date": 1550691641, "answer_id": 54794090, "question_id": 54793731, "link": "https://stackoverflow.com/questions/54793731/excel-macro-to-copy-worksheet-to-new-worksheet-paste-values-only/54794090#54794090", "title": "Excel Macro to copy worksheet to new worksheet paste values only", "body": "<p>I use something like this:</p>\n\n<pre><code>Sub KopyKat()\nDim s1 As Worksheet, s2 As Worksheet\nDim r As Range, addy As String\n\nSet s1 = Sheets(\"Sheet1\")\nSet s2 = Sheets(\"Sheet2\")\n\nFor Each r In s1.UsedRange\n    If r.Value &lt;&gt; \"\" Then\n        If Not r.HasFormula Then\n            addy = r.Address\n            r.Copy s2.Range(addy)\n        End If\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11091528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad0c3a23b05919bd899dbc4cf16949c?s=128&d=identicon&r=PG&f=1", "display_name": "Big D", "link": "https://stackoverflow.com/users/11091528/big-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1550700530, "creation_date": 1550690154, "last_edit_date": 1550700530, "question_id": 54793731, "link": "https://stackoverflow.com/questions/54793731/excel-macro-to-copy-worksheet-to-new-worksheet-paste-values-only", "title": "Excel Macro to copy worksheet to new worksheet paste values only", "body": "<p>I am working on a Macro in Excel that will make a copy of the current worksheet and paste the values into a new worksheet.  The worksheet name would be the same just with a number after it  [ie Sheet, Sheet1(2)]</p>\n\n<p>My code does this correctly except that it copies and pastes everything to Sheet1(2).  I only want it to paste the values  (not formulas) from Sheet1 to Sheet1(2).  I'm a novice at vba at best so any suggestions are greatly appreciated.</p>\n\n<pre><code>Sub SPACER_Button4_Click()\n' Compile Button to Generate Quote\n'\n'variables definitions\nActiveSheetValue = ActiveSheet.Name\n'\n'This section creates a copy of the active worksheet and names it with the next corresponding number\n    Sheets(ActiveSheetValue).Copy After:=Sheets(ActiveSheetValue)\n\n'This section should look for X value in each row, column 4. If value equals X, it deletes the row on the copied sheet\nDim i As Integer\ni = 26\nDo Until i &gt; 300\n    If ActiveSheet.Cells(i, 11).Value = \"X\" Then\n        Rows(i).Delete\n        Skip = True\n    End If\n    '\n    If Skip = False Then\n        i = i + 1\n    End If\n    '\n    Skip = False\nLoop\n\n'This part hides columns on Right K thru R of new copied sheet\n    Sheets(ActiveSheet.Name).Range(\"K:R\").EntireColumn.Hidden = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550766729, "post_id": 54793397, "comment_id": 96400610, "body": "Can ypu provide me with some of the selections you make."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550767433, "post_id": 54793397, "comment_id": 96401015, "body": "would you consider using IE or selenium basic with Chrome?"}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550857401, "post_id": 54793397, "comment_id": 96439752, "body": "Hi QHarr, Just edited the post, please suggest. I am trying to get the file directly to the current worksheet. I apologize I am new to vba..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551002643, "post_id": 54793397, "comment_id": 96473618, "body": "I have been looking at it. There is one problem I still have to resolve with current solution."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551025293, "post_id": 54793397, "comment_id": 96479339, "body": "Thanks so much @QHarr,  I am also trying from my end. but as a begineer, I am learning from guys like you."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551025558, "post_id": 54793397, "comment_id": 96479431, "body": "Don&#39;t know, why the Question is getting downgraded, but with the above code, I am able to download the file (but its asking for a retry (which I need to do manually). and there after I am having difficulties getting into my current worksheet. (I think because the file itself is 5MB).. But really thanks a lot @QHarr for the help."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551112031, "post_id": 54793397, "comment_id": 96511616, "body": "QHarr, any luck.. :), also I just gone through some of the SO question, @Tim Williams has got similar approach..."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551115898, "post_id": 54793397, "comment_id": 96513709, "body": "kind of @QHarr, here the link <a href=\"https://stackoverflow.com/questions/28899726/vba-handle-javascript-pop-up-with-ie-automation\" title=\"vba handle javascript pop up with ie automation\">stackoverflow.com/questions/28899726/&hellip;</a>. but I am confused how it works in my case. Thanks again for the help"}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551201726, "post_id": 54793397, "comment_id": 96550856, "body": "@QHarr any luck..."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551202605, "post_id": 54793397, "comment_id": 96551332, "body": "@QHarr, yeah I got that pop-up..is it a setting in IE or  something that I need to upgrade or downgrade IE version to get rid of it."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551202981, "post_id": 54793397, "comment_id": 96551520, "body": "Can you post it @Qharr, I can test it from my end"}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551205303, "post_id": 54793397, "comment_id": 96552703, "body": "@QHarr, its not downloading the file from the code, IE is opening and getting closed. we have a download option at top right after we click the submit button. here we need to import it to current worksheet."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551205875, "post_id": 54793397, "comment_id": 96552971, "body": "This time no, I didn&#39;t got that, when I run even above code in question"}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551206163, "post_id": 54793397, "comment_id": 96553131, "body": "ok @QHarr , but getting the option open, save popup, not retry and cancel... thanks a lot, I think we almost got there......."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551206608, "post_id": 54793397, "comment_id": 96553375, "body": "Also, until the code halted at stop command, the file is not getting downloaded... anyway.. I will be waiting for your full code.."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551369452, "post_id": 54793397, "comment_id": 96623777, "body": "@QHarr, did you get into any other issue..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551369561, "post_id": 54793397, "comment_id": 96623859, "body": "I haven&#39;t written yet as busy with work. Will try to remember to have a look tonight."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551381458, "post_id": 54793397, "comment_id": 96629935, "body": "sure, just thought, if you got any other hurdle , thanks for the information, @QHarr"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551387197, "post_id": 54934022, "comment_id": 96632618, "body": "Sorry for the delay. I prefer the selenium method for what should be obvious reasons."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1551517197, "post_id": 54934022, "comment_id": 96675514, "body": "np, thanks so much @QHarr, actually I can&#39;t use internet and can&#39;t browse for couple of days to test the code.Hope the above code also take care of copying the data to current worksheet."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1552768443, "post_id": 54934022, "comment_id": 97139633, "body": "yeah both solutions are working and giving pop up to download the file, but can help me how to copy the downloaded file to the existing workbook. btw sorry for the delayed reply."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1552770359, "post_id": 54934022, "comment_id": 97140110, "body": "I would ask a follow up question. The things I would be considering would be 1) if I can capture the file name before download use that to target the file in downloads, open and transfer data, or 2) do a count of files in download folder and when that increases by 1 (cos new file downloaded) grab the latest file (modified date) and open and transfer data. It is too much to write into the above. I have written similar answers before."}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1552797528, "post_id": 54934022, "comment_id": 97144496, "body": "The filename will always be ListOfScrips.csv, @QHarr  but if we download multiples files it will be like ListofScrips(1).csv ..etc.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1552803093, "post_id": 54934022, "comment_id": 97145217, "body": "My advice would be to consider accepting this answer, have a go at coding the next part using my advice above. Some resources: <a href=\"https://www.google.com/search?safe=strict&amp;rlz=1C1GCEB_enGB815GB815&amp;ei=2mWNXLCLMPXixgOGkaL4DQ&amp;q=vba+find+latest+file+in+folder&amp;oq=vba+find+latest&amp;gs_l=psy-ab.1.0.0l2j0i22i30l5.32445334.32448496..32451250...0.0..0.71.956.15......0....1..gws-wiz.......0i71j0i131j0i131i67j0i67.3Yeyvpt5B1g\" rel=\"nofollow noreferrer\">google.com/&hellip;</a> , <a href=\"https://stackoverflow.com/a/53912638/6241235\">stackoverflow.com/a/53912638/6241235</a>"}, {"owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "edited": false, "score": 0, "creation_date": 1552841957, "post_id": 54934022, "comment_id": 97155198, "body": "sure @Qharr , thanks a lot and I am checking the link"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1551386866, "creation_date": 1551386866, "answer_id": 54934022, "question_id": 54793397, "link": "https://stackoverflow.com/questions/54793397/get-list-of-stocks-from-a-url-with-excel-vba/54934022#54934022", "title": "Get list of stocks from a URL with excel VBA", "body": "<p>I'm not a fan of sendkeys but the following works </p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub GetData()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.bseindia.com/corporates/List_Scrips.aspx#\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n\n            'status\n            .querySelector(\"[value='Active']\").Selected = True 'Suspended,Delisted,Select\n\n            'group\n            .querySelector(\"[value='Select']\").Selected = True ' \"B \", \"C \" etc\n\n            'industry\n            .querySelector(\"[value='Advertising &amp; Media']\").Selected = True 'Agrochemicals etc\n\n            'segment\n\n            .querySelector(\"#ContentPlaceHolder1_ddSegment  [value='Equity']\").Selected = True\n\n            'Submit\n            .querySelector(\"#ContentPlaceHolder1_btnSubmit\").Click\n            Const MAX_WAIT_SEC As Long = 5\n            Dim t As Date\n            While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n\n            Dim download As Object\n            t = Timer\n            Do\n            On Error Resume Next\n            Set download = .querySelector(\"#ContentPlaceHolder1_lnkDownload\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While download Is Nothing\n            If Not download Is Nothing Then\n                download.Click\n            End If\n\n            Application.Wait Now + TimeSerial(0, 0, 10)\n            Application.SendKeys \"%N\", True\n            Application.SendKeys \"%S\", True\n            Application.Wait Now + TimeSerial(0, 0, 10)\n            Application.SendKeys \"%O\", True\n        End With\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>It is a whole lot easier with selenium though you need to change the extension of the downloaded file from <code>.tmp</code> to <code>.csv</code>. After installing <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium basic</a> be sure to go VBE > Tools > References and add a reference to Microsoft Scripting Runtime.</p>\n\n<pre><code>Option Explicit   \nPublic Sub MakeSelections()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const URL = \"https://www.bseindia.com/corporates/List_Scrips.aspx#\"\n    With d\n        .Start \"Chrome\"\n        .get URL\n               'status\n            .FindElementByCss(\"#ContentPlaceHolder1_ddlStatus\").AsSelect.SelectByText \"Suspended\"\n            'group\n            .FindElementByCss(\"#ContentPlaceHolder1_ddlGroup\").AsSelect.SelectByText \"Select\"   ' \"B \", \"C \" etc\n            'industry\n           .FindElementByCss(\"#ContentPlaceHolder1_ddlIndustry\").AsSelect.SelectByText \"Agrochemicals\" 'Agrochemicals etc\n            'segment\n            .FindElementByCss(\"#ContentPlaceHolder1_ddSegment\").AsSelect.SelectByText \"Equity\"\n\n            .FindElementByCss(\"#ContentPlaceHolder1_btnSubmit\").Click\n            .FindElementByCss(\"#ContentPlaceHolder1_lnkDownload\").Click\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 11006549, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QWYb4xQM0bc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQM2CO0ZOg3kIi3zHnTkgQXvcAyb2A/mo/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11006549/kiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 54934022, "answer_count": 1, "score": -3, "last_activity_date": 1551386866, "creation_date": 1550688895, "last_edit_date": 1551002235, "question_id": 54793397, "link": "https://stackoverflow.com/questions/54793397/get-list-of-stocks-from-a-url-with-excel-vba", "title": "Get list of stocks from a URL with excel VBA", "body": "<p>I want to download a file to my local worksheet from the site: <a href=\"https://www.bseindia.com/corporates/List_Scrips.aspx#\" rel=\"nofollow noreferrer\">https://www.bseindia.com/corporates/List_Scrips.aspx#</a>\nbelow is my code which I tried after doing some research.\nchallenge is, how to avoid the page resubmit (retry, cancel warning window)\nsecondly, I need to download the 5mb file and extract to the current localworksheet.</p>\n\n<pre><code>Sub bsecode()\nDim ie As Object\nSet ie = CreateObject(\"InternetExplorer.Application\")\nWith ie\nie.Visible = True\n'To open the website\n.navigate \"https://www.bseindia.com/corporates/List_Scrips.aspx#\"\n Do While ie.readyState &lt;&gt; 4\n       Sleep 1000\n   Loop\n   ie.document.getElementsByName(\"ctl00$ContentPlaceHolder1$btnSubmit\")(0).Click\n   Sleep 1000\n    Do While ie.readyState &lt;&gt; 4\n    Sleep 1000\n   Loop\n  'To download the file\nie.navigate \"javascript:__doPostBack('ctl00$ContentPlaceHolder1$lnkDownload','')\"\n'Do While .Busy: DoEvents: Loop\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550696008, "post_id": 54793145, "comment_id": 96368148, "body": "Please provide some sample text for testing as well as an example of the &quot;good&quot; and &quot;bad&quot; results so that we can understand."}, {"owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550789544, "post_id": 54793145, "comment_id": 96411205, "body": "I have edited the original to include an example. Basically, it is just capitalizing every letter in the replacement text. It seems to be happening only on certain phrases that I have though. Unsure why."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1550790451, "post_id": 54793145, "comment_id": 96411466, "body": "If code uses <code>Selection.Find</code> instead of <code>Range.Find</code> then Find will work with the settings last used in the Find/Replace dialog box. Possibly, ALL CAPS formatting has been used for replacement and is affecting the result? Might be a good idea to stick a <code>Replacement.ClearFormatting</code> in there. And/Or modify the code to use <code>Find</code> with a <code>Range</code> object."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1550809419, "creation_date": 1550809419, "answer_id": 54820033, "question_id": 54793145, "link": "https://stackoverflow.com/questions/54793145/vba-replacing-text-not-keeping-the-replacement-texts-formatting-and-randomly-ap/54820033#54820033", "title": "VBA replacing text not keeping the replacement text&#39;s formatting and randomly applying uppercase formatting", "body": "<p>Try using MatchCase:=False. For example:</p>\n\n<pre><code>.Execute FindText:=search, ReplaceWith:=replace, MatchCase:=False, Replace:=wdReplaceAll\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10945653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a500622f0b474b8c1645b31eafad971f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin J", "link": "https://stackoverflow.com/users/10945653/martin-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1585150871, "creation_date": 1585150871, "answer_id": 60852204, "question_id": 54793145, "link": "https://stackoverflow.com/questions/54793145/vba-replacing-text-not-keeping-the-replacement-texts-formatting-and-randomly-ap/60852204#60852204", "title": "VBA replacing text not keeping the replacement text&#39;s formatting and randomly applying uppercase formatting", "body": "<p>I know this is a old post, but i had the same problem.. \nAfter playing around with it for a while, this helped me.</p>\n\n<p>I tried with both no formatting on the replacement text and with specific formatting not to be all caps - Still came out all caps..</p>\n\n<p>I found out that, if the whole text i search for is upper case, it will change it all to uppercase. If first letter in searched text is uppercase the first in replaced text will be uppercase. No matter which formating you put on.</p>\n\n<p>I had a text called \"C-PTFE CIP\" and wanted in some scenarios to add extra to it, which all came out as all caps. My fix was to add a bit more of the text \"ix C-PTFE CIP\" and just add the \"ix \" to my replacement text. Now everything comes out as i want, not only all lowercase, but as i'd like it.</p>\n\n<p>So for your case, change the \"ID\" to \"id\" if possible, or if you're lucky as me, to be able to add some more of the text.</p>\n\n<p>Hope this can help others in the future. I have no idea why the formattings doesn't overrule the searched text.. Maybe other settings in the document?</p>\n"}], "owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1585150871, "creation_date": 1550687900, "last_edit_date": 1550789498, "question_id": 54793145, "link": "https://stackoverflow.com/questions/54793145/vba-replacing-text-not-keeping-the-replacement-texts-formatting-and-randomly-ap", "title": "VBA replacing text not keeping the replacement text&#39;s formatting and randomly applying uppercase formatting", "body": "<p>I am trying to get this code to work but it keeps randomly uppercasing the entire sentences I am trying to replace the \"ID's\" with. I am using ID00 numbers to replace text. Sometimes the replacement will be all caps. I cannot figure out how to keep the casing that it should be.\nAn example would be: ID001 to be replaced with \"This is an example. I want this.\" It's doing this: \"THIS IS AN EXAMPLE. I WANT THIS.\"</p>\n\n<pre><code>With Selection.Find\n.ClearFormatting\n\n\nchunks = Round(Len(replace) / 250, 0)                   \nIf Len(replace) Mod 250 &gt; 0 Then chunks = chunks + 1      \nIf chunks = 1 Then\n    .Execute FindText:=search, ReplaceWith:=replace, replace:=wdReplaceAll\nElse\n\n    .Execute FindText:=search, ReplaceWith:=\"{1}\", replace:=wdReplaceAll\n\n    ' Replace the text in chunks of less than 255 characters\n    For i = 1 To chunks\n\n\n        chunk = Mid(replace, ((i - 1) * 250) + 1, 250)\n\n\n        If i &lt; chunks Then chunk = chunk &amp; \"{\" &amp; (i + 1) &amp; \"}\"\n\n        .Execute FindText:=\"{\" &amp; i &amp; \"}\", ReplaceWith:=chunk, replace:=wdReplaceAll\n    Next i\n\nEnd If\n</code></pre>\n\n<p>End With</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1550687900, "creation_date": 1550687900, "answer_id": 54793146, "question_id": 54793091, "link": "https://stackoverflow.com/questions/54793091/how-do-i-ignore-no-user-input/54793146#54793146", "title": "How do I ignore no user input?", "body": "<p>First check the value of TextBox2, then proceed if there is a value.</p>\n\n<pre><code>Private Sub CheckIn_Click()\n\n    If TextBox2.Value &lt;&gt; \"\" Then \n\n        Dim FoundRange As Range\n        Dim Status As Range\n        Set FoundRange = Columns(\"C\").Find(What:=TextBox2.Text, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n\n        If Not FoundRange Is Nothing Then\n            Set Status = FoundRange.Offset(ColumnOffset:=1)\n            Status.Value = \"IN\"\n            TextBox2.Value = \"\"\n        Else\n            MsgBox \"Not Found\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 6746833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmc6U.png?s=128&g=1", "display_name": "Red", "link": "https://stackoverflow.com/users/6746833/red"}, "edited": false, "score": 1, "creation_date": 1550688629, "post_id": 54793187, "comment_id": 96364708, "body": "I received the same error until I removed your line 17, it works after that. Do you see that being an issue?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 61, "user_id": 6746833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmc6U.png?s=128&g=1", "display_name": "Red", "link": "https://stackoverflow.com/users/6746833/red"}, "edited": false, "score": 1, "creation_date": 1550688883, "post_id": 54793187, "comment_id": 96364823, "body": "@Red  We only <b>create</b> the <code>Status</code> range in the true part of the <code>If</code>.................. <b>it should be removed from the false part</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1550690625, "last_edit_date": 1550690625, "creation_date": 1550688093, "answer_id": 54793187, "question_id": 54793091, "link": "https://stackoverflow.com/questions/54793091/how-do-i-ignore-no-user-input/54793187#54793187", "title": "How do I ignore no user input?", "body": "<p>Test First:</p>\n\n<pre><code>Private Sub CheckIn_Click()\n\n    Dim FoundRange As Range\n    Dim Status As Range\n\n    If TextBox2.Text = \"\" Then\n        MsgBox \"Test Skipped\"\n    Else\n        Set FoundRange = Columns(\"C\").Find(What:=TextBox2.Text, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n\n        If Not FoundRange Is Nothing Then\n           Set Status = FoundRange.Offset(ColumnOffset:=1)\n           Status.Value = \"IN\"\n           TextBox2 = \"\"\n           ThisWorkbook.Save\n        Else\n            Status.Value = \"\"\n            TextBox2 = \"\"\n            TextBox1.SetFocus\n            MsgBox \"Not Found\"\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6746833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rmc6U.png?s=128&g=1", "display_name": "Red", "link": "https://stackoverflow.com/users/6746833/red"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 54793187, "answer_count": 2, "score": 1, "last_activity_date": 1550690625, "creation_date": 1550687675, "last_edit_date": 1550688746, "question_id": 54793091, "link": "https://stackoverflow.com/questions/54793091/how-do-i-ignore-no-user-input", "title": "How do I ignore no user input?", "body": "<p>My code is supposed to check each column \"C\" cell for whatever input is in TextBox2 then, if found, using the row found in adjust the Column \"D\" intersected cell contents to \"IN\".</p>\n\n<p>All this is happening as desired with one exception. If I click the command button \"Check IN\" with no input in textbox2, it sets the first next empty cell in column \"D\" as \"IN\".</p>\n\n<pre><code>Private Sub CheckIn_Click()\n\nDim FoundRange As Range\nDim Status As Range\n    Set FoundRange = Columns(\"C\").Find(What:=TextBox2.Text, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n\n    If Not FoundRange Is Nothing Then\n    Set Status = FoundRange.Offset(ColumnOffset:=1)\n       Status.Value = \"IN\"\n       TextBox2 = \"\"\n       ThisWorkbook.Save\n    Else\n        Status.Value = \"\"\n        TextBox2 = \"\"\n        TextBox1.SetFocus\n        MsgBox \"Not Found\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>What I attempted to do is use the same script from line 9 at line 13 but with an empty value so that even if something is done the cell is empty. On the other hand, after running the code without TextBox2 input I received this error:<em>\"Object variable or With block variable not set\"</em> at line 13.</p>\n\n<p>I do not understand what variable is not being set. All I am trying to do is mitigate what happens if the button is hit with no input.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 2, "creation_date": 1550685383, "post_id": 54792388, "comment_id": 96363104, "body": "What is not working here? You need to tell us. Please read: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550686195, "post_id": 54792388, "comment_id": 96363473, "body": "It is full of mistakes, and it&#39;s material for a ton of questions and I&#39;ll try to look into it, but I need to see the <b>procent</b> function first."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550747483, "post_id": 54793429, "comment_id": 96387603, "body": "Well this new code is helping quite a lot but i get an error on line dz = vntS(i, 1) , error code: 13 type mismatch. I know what does it means but don&#39;t know what to do with it :(, I would also like to ask you if it is possible to refer to previous cell from the same column e.g. if c3 &gt; c1 then.... ?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550748148, "post_id": 54793429, "comment_id": 96388043, "body": "@Frost23: You have declared <b>dz</b> as <b>Date</b>. If there isn&#39;t a date in the cell it will show this error. You can check if date with <b>If IsDate(vntS(i, 1)) Then</b> but I think you should change the format to a recognizable format in the cells of column <b>A</b>. If you want <b>C3&gt;C1</b> then you use either <b>If vntS(i + 2, 3) &gt; vntS(i, 3)</b> for the cell 2 rows below, or <b>If vntS(i, 3) &gt; vntS(i - 2, 3)</b> for the cell 2 rows above."}, {"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550751407, "post_id": 54793429, "comment_id": 96390051, "body": "Now when i changed the crange from a1 to a2 it just prints one value instead of all and really don&#39;t know what to do with this so it works good"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550752206, "post_id": 54793429, "comment_id": 96390571, "body": "@Frost23: As soon as <b>komz &lt; kom</b> the program will exit, because you use <b>Exit For</b>. In the Answer I wrote that it looks suspicious. Maybe there is the mistake. The program should run the same with <b>A2:A70</b> or <b>A50:A5000</b>, you just have to have appropriate data in the rows. Now I see you haven&#39;t covered <b>komz &gt; kom And dz = dw</b>. Maybe you should change <b>komz &gt; kom And dz &gt; dw</b> to <b>komz &gt; kom And dz &gt;= dw</b>."}, {"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550755268, "post_id": 54793429, "comment_id": 96392568, "body": "Thanks a lot for helping with this problem !!! but if it is possible i would like to ask you for two more things : in my answer to this question above I posted an image what i would like to do with this and when there is no date (so the cell is empty) the &quot;procent&quot; function uses date from today like TODAY() from excel"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550761314, "post_id": 54793429, "comment_id": 96396833, "body": "@Frost23: Something like <b>If vntS(i, 1) = &quot;&quot; Then</b> | <b>dz = Date</b> | <b>Else</b> | <b>dz = vntS(i, 1)</b> | <b>End If</b> |, where | means a new row. <b>Date</b> in VBA is like <b>Today</b> in Excel."}, {"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1550771702, "post_id": 54793429, "comment_id": 96403360, "body": "And how about copying the data from cells above to the table below for e.g from first cell of column to last cell of column to a table below ?"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1550690640, "last_edit_date": 1550690640, "creation_date": 1550689029, "answer_id": 54793429, "question_id": 54792388, "link": "https://stackoverflow.com/questions/54792388/excel-vba-range-array-problem-what-can-i-do-with-it-so-it-does-work/54793429#54793429", "title": "Excel vba range array problem, what can i do with it so it does work?", "body": "<h1>Loop Through Array Instead of Range</h1>\n\n<ul>\n<li>This should work if the <code>procent</code> function and the \"<code>Do your thing</code>\"\nparts are correct.</li>\n<li><code>Exit for</code> looks pretty suspicious.</li>\n<li>NOT tested.</li>\n</ul>\n\n<h2>The Code</h2>\n\n<pre><code>Option Explicit\n\nSub testo()\n\n    Const cSheet As String = \"Procenty\"   ' Source Worksheet Name\n    Const cRange As String = \"A1:D70\"     ' Source Range Address\n    Const cTarget As Long = 5             ' Target Number of Columns\n    Const cCol As Variant = \"A\"           ' Last-Row Column\n\n    Dim vntS As Variant   ' Source Array\n    Dim vntT As Variant   ' Target Array\n    Dim i As Integer      ' Source/Target Array Row Counter\n    Dim emptyRow As Long  ' First Empty Row\n\n    Dim kom As Double, komz As Double, dw As Double\n    Dim roz As Double, komr As Double, komn As Double\n    Dim napis As String\n    Dim dz As Date\n\n    ' Write Source Range to Source Array.\n    vntS = ThisWorkbook.Worksheets(cSheet).Range(cRange)\n\n    ' Resize Target Array to rows of Source Array and columns of Target\n    ' Number of Columns.\n    ReDim vntT(1 To UBound(vntS), 1 To cTarget)\n\n    ' In Source Array\n    For i = 1 To UBound(vntS)\n\n        ' Write values of current row to variables.\n        dz = vntS(i, 1)\n        komz = vntS(i, 2)\n        dw = vntS(i, 3)\n        kom = vntS(i, 4)\n\n        '*******************************\n        ' Start of \"Do your thing\".\n        '*******************************\n\n        komr = komz - kom\n        roz = Abs(dz - dw)\n        komn = kom - komz\n\n        If kom = komz And dw &gt; dz Then\n\n            vntT(i, 1) = procent(kom, roz)\n            vntT(i, 2) = procent(kom, roz) + kom\n\n        ElseIf komz = kom And dz &gt;= dw Then\n\n            vntT(i, 1) = napis\n            vntT(i, 2) = napis\n\n        ElseIf komz &gt; kom And dz &lt; dw Then\n\n            vntT(i, 1) = procent(kom, roz)\n            vntT(i, 2) = procent(kom, roz) + kom\n            vntT(i, 3) = komr\n            vntT(i, 4) = procent(komr, roz)\n            vntT(i, 5) = procent(komr, roz) + komr\n\n        ElseIf komz &gt; kom And dz &gt; dw Then\n            vntT(i, 1) = komr\n\n        ElseIf komz &lt; kom Then\n            vntT(i, 1) = komn\n            Exit For\n        End If\n\n        '*******************************\n        ' End of \"Do your thing\".\n        '*******************************\n\n    Next\n\n    ' In Source Worksheet\n    With ThisWorkbook.Worksheets(cSheet)\n        ' Determine emptyRow (Should be more reliable this way.).\n        emptyRow = .Columns(cCol).Find(\"*\", , xlFormulas,  _\n                xlWhole, xlByColumns, xlPrevious).Row + 1\n        'emptyRow = WorksheetFunction.CountA(.Columns(cCol)) + 1\n        ' Write Target Array to Target Range.\n        .Cells(emptyRow, cCol).Resize(UBound(vntT), UBound(vntT, 2)) = vntT\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 54793429, "answer_count": 1, "score": -1, "last_activity_date": 1550749285, "creation_date": 1550684696, "last_edit_date": 1550686831, "question_id": 54792388, "link": "https://stackoverflow.com/questions/54792388/excel-vba-range-array-problem-what-can-i-do-with-it-so-it-does-work", "title": "Excel vba range array problem, what can i do with it so it does work?", "body": "<pre><code>Public Function procent(fv As Double, time As Double) As Double\n\n    procent = fv* (0.1 / 365) * time'time= diffrence between 2 dates from specific cells , fv= numeric value from cell\n\nEnd Function\n\n\n Sub testo()\n        Dim i As Integer, n As Integer\n        Dim emptyrow As Long\n        Dim kom As Double, komz As Double, dw As Double, roz As Double, komr As Double, komn As Double\n        Dim napis As String\n        Dim dz As Date\n\n        'Make Sheet1 active\n        Sheets(\"procenty\").Select\n        'Determine emptyRow\n        emptyrow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n        dz = Range(\"A1:A70\").Value\n        komz = Range(\"B1: B70\").Value\n        kom = Range(\"D1:D70\").Value\n        dw = Range(\"C1:C70\").Value\n\n        For Each Row In Range(\"A1:D70\")\n            komr = komz - kom\n            roz = Abs(dz - dw)\n            komn = kom - komz\n\n            If kom = komz And dw &gt; dz Then\n\n                Cells(emptyrow, 1).Value = procent(kom, roz)\n                Cells(emptyrow, 2).Value = procent(kom, roz) + kom\n\n            ElseIf komz = kom And dw = dz And dz &gt; dw Then\n\n                Cells(emptyrow, 1).Value = napis\n                Cells(emptyrow, 2).Value = napis\n\n            ElseIf komz &gt; kom And dz &lt; dw Then\n\n                Cells(emptyrow, 1).Value = procent(kom, roz)\n                Cells(emptyrow, 2).Value = procent(kom, roz) + kom\n                Cells(emptyrow, 3).Value = komr\n                Cells(emptyrow, 4).Value = procent(komr, roz)\n                Cells(emptyrow, 5).Value = procent(komr, roz) + komr\n\n            ElseIf komz &gt; kom And dz &gt; dw Then\n                Cells(emptyrow, 1).Value = komr\n\n            ElseIf komz &lt; kom Then\n                Cells(emptyrow, 1).Value = komn\n                Exit For\n            End If\n        Next Row\n    End Sub\n</code></pre>\n\n<p>this whole sub has to get data form this selected range and then make some operations with it in loop  like multiplying,addition,difference,dividing with another specific cells like this A1*C1 then A2*C2 then check if conditions on which one is good and do what's inside if and so on until all of the cells are done.The whole problem about this is that i get a lot of errors here like type mismatch,by ref argument mismatch and also when I use my own function it doesn't do nothing with it.</p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1550684582, "post_id": 54792130, "comment_id": 96362723, "body": "Look into <code>Range.CopyFromRecordset</code>; there is no need to iterate the results or store them in an array."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550685021, "post_id": 54792130, "comment_id": 96362912, "body": "Moreover, <code>GetRows</code> <i>in itself</i> doesn&#39;t require iterating the recordset - it does yield a weirdly-shaped (transposed) array though, as you noticed."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550685294, "post_id": 54792130, "comment_id": 96363055, "body": "Thank you for pointing me in the right direction.  This is now working as expected."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11068129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TysRoIg5BZM/AAAAAAAAAAI/AAAAAAAAABE/txCivs7P8Eg/photo.jpg?sz=128", "display_name": "Nyelthon Refatti", "link": "https://stackoverflow.com/users/11068129/nyelthon-refatti"}, "edited": false, "score": 1, "creation_date": 1550685196, "post_id": 54792460, "comment_id": 96362988, "body": "You are already using MoveNext to get the number of entries, so first you will need to include &quot;rsRecords.MoveFirst&quot; before the loop."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1550685796, "post_id": 54792460, "comment_id": 96363301, "body": "Thanks.  I am going to keep this for future reference as I&#39;m sure I will need it again."}], "tags": [], "owner": {"reputation": 21, "user_id": 11068129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TysRoIg5BZM/AAAAAAAAAAI/AAAAAAAAABE/txCivs7P8Eg/photo.jpg?sz=128", "display_name": "Nyelthon Refatti", "link": "https://stackoverflow.com/users/11068129/nyelthon-refatti"}, "is_accepted": false, "score": 2, "last_activity_date": 1550685333, "last_edit_date": 1550685333, "creation_date": 1550685024, "answer_id": 54792460, "question_id": 54792130, "link": "https://stackoverflow.com/questions/54792130/not-sure-why-results-are-transposing-from-recordset-in-excel-sheet/54792460#54792460", "title": "Not sure why results are transposing from RecordSet in Excel Sheet", "body": "<p>If you want go to another \"entry\" of the recordset you can use \".MoveNext\" method.</p>\n\n<p>It will be something like this: </p>\n\n<pre><code>rsRecords.MoveFirst 'In this line you will back for the first entry\nFor iRow = 0 To intNumReturned - 1\n     For iCol = 0 To intNumColumns - 1\n         Debug.Print rsRecords(iCol)\n     Next iCol\nrsRecords.MoveNext 'In this line you move to the next \"row\" as you want\nNext iRow\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1550685333, "creation_date": 1550683623, "last_edit_date": 1550684538, "question_id": 54792130, "link": "https://stackoverflow.com/questions/54792130/not-sure-why-results-are-transposing-from-recordset-in-excel-sheet", "title": "Not sure why results are transposing from RecordSet in Excel Sheet", "body": "<p>I am a newbie at using <code>Recordsets</code> and need some assistance as to why the data is transposing from the Database to Excel.  I believe its in the following code, but not sure.</p>\n\n<pre><code>For iRow = 0 To intNumReturned - 1\n    For iCol = 0 To intNumColumns - 1\n        Debug.Print rsRecords(iCol, iRow)\n    Next iCol\nNext iRow\n</code></pre>\n\n<p>Result from SQL String, which is expected:</p>\n\n<pre><code>PROCESSOR | ACCOUNT NUMBER | LOAN AMOUNT | ORIGNATION DATE\nZJE         xxxxxxx          XXXXXX.XX      2018-01-01\nZJE         xxxxxxx          XXXXXX.XX      2018-02-06\n</code></pre>\n\n<p>How the data gets placed into the Excel Sheet:</p>\n\n<pre><code>PROCESSOR | ACCOUNT NUMBER | LOAN AMOUNT | ORIGNATION DATE\nZJE         ZJE              ZJE           ZJE\nacct no     acct no          acct no       acct no\nloan amt    loan amt         loan amt      loan amt                               \nOrg Date    Org Date         Org Date      org date\n</code></pre>\n\n<p>Below is the code i am currently using minus the Connection and SQL Strings:</p>\n\n<pre><code>Sub RunSearch()\n    Dim conn As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim connStr As String, strSQL As String\n    Dim begQ1 As String, endQ1 As String, begQ2 As String, endQ2 As String, begQ3 As String, endQ3 As String, begQ4 As String, endQ4 As String\n    Dim ctrl As Control\n    Dim rsRecords As Variant\n    Dim intNumReturned As Long, intNumColumns As Long, iCol As Long, iRow As Long, fldCount As Long, i As Long, rsCount As Long\n\n    Set wb = ThisWorkbook\n    Set wsVol = wb.Sheets(\"Volume By Processor\")\n    Set wsDE = wb.Sheets(\"DE\")\n    Set quarterYear = wsDE.Range(\"Quarter_Year\")\n    Set Q = wsDE.Range(\"Quarter\")\n    Set fDate = wsDE.Range(\"From_Date\")\n    Set tDate = wsDE.Range(\"To_Date\")\n\nDo While Not rs.EOF\n    rs.MoveNext\n    rsRecords = rs.GetRows\n    intNumReturned = UBound(rsRecords, 2) + 1\n    intNumColumns = UBound(rsRecords, 1) + 1\nLoop\n\n    For iRow = 0 To intNumReturned - 1\n        For iCol = 0 To intNumColumns - 1\n            Debug.Print rsRecords(iCol, iRow)\n        Next iCol\n    Next iRow\n\n\n'\\\\\\NEED TO FIGURE OUT NUMBER OF RECORDS TO\n'\\\\\\DEFINE LAST ROW/COLUMN OF RANGE????  PROBABLY A\n'\\\\\\SEPARATE QUESTION ON SO\n    wsVol.Range(\"B3:E1800\") = rsRecords\n\n    rs.Close\n    Set rs = Nothing\n    conn.Close\n    Set conn = Nothing\n</code></pre>\n\n<p>I am expecting the result in the Excel sheet to match the the output from the SQL String any assistance is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "printing"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550734252, "post_id": 54792081, "comment_id": 96379675, "body": "Any reason why to use a complicated VBScript and not perform this in VBA directly?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1550762201, "post_id": 54792081, "comment_id": 96397498, "body": "Due to a combination of things. After opening the dialog with SendKeys, it won&#39;t process inputs using the SendKeys directly from VBA, hence a need to do it externally. Additionally, if you open things, for example with Dialogs.show, you won&#39;t be able to do anything programmatically until you make a selection. It&#39;s annoying, and I wish I could do it directly from Excel instead of needing the external file"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550765463, "post_id": 54792081, "comment_id": 96399751, "body": "No problem, it&#39;s a perfectly reasonable question!"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": true, "score": 0, "last_activity_date": 1550765845, "last_edit_date": 1550765845, "creation_date": 1550683452, "answer_id": 54792081, "question_id": 54792080, "link": "https://stackoverflow.com/questions/54792080/how-to-get-duplex-printing-working-in-excel/54792081#54792081", "title": "How to get Duplex printing working in Excel?", "body": "<p>So Duplex Printing isn't a native option to Excel, and it's fairly hard to do.</p>\n\n<p>There are some posts out there about calling the printer API, but those aren't agnostic to what printer you're using.</p>\n\n<p>I got it working by combining SendKeys with a VBS script. Here we go:</p>\n\n<pre><code>Sub SendKeysDuplex()\n\nApplication.Dialogs(xlDialogPrinterSetup).Show\nShellCall\n\nEnd Sub\n</code></pre>\n\n<p>--  </p>\n\n<pre><code>Sub ShellCall()\n\nShell \"wscript C:\\FileName.vbs\", vbNormalFocus\n\nEnd Sub\n</code></pre>\n\n<p>--</p>\n\n<pre><code>Set WSHShell = WScript.CreateObject(\"WScript.Shell\")\nWSHshell.AppActivate \"Excel.exe\"\nwsh.sleep 1000 ' wait 1 second\nWSHshell.SendKeys \"%psp\"\nWSHshell.SendKeys \"{TAB 9}\"\nWSHshell.SendKeys \"{Enter}\"\nwsh.sleep 3000 ' wait 1 second\nWSHshell.SendKeys \"{TAB 4}\"\nWSHshell.SendKeys \"n\"\nWSHshell.SendKeys \"y\"\nWSHshell.SendKeys \"{Enter}\"\nwsh.sleep 500 ' wait 1 second\n'WSHshell.SendKeys \"{Enter}\"\n'wsh.sleep 500 ' wait 1 second\n'WSHshell.SendKeys \"%psp\"\n'wsh.sleep 1000\nWSHshell.SendKeys \"{TAB 7}\"\nWSHshell.SendKeys \"{Enter}\"\nwsh.sleep 500\nWSHshell.SendKeys \"{Enter}\"\nwsh.sleep 500\n</code></pre>\n\n<p>This just prints the tab that's currently active. To have the script just set things then carry on, I recommend integrating it with <a href=\"https://stackoverflow.com/questions/15951837/wait-for-shell-command-to-complete\">Wait for shell command to complete</a></p>\n\n<p>Or simply have one button be a \"Set-up Printer\" button, and a second button for \"Print things\"</p>\n\n<p>Also note: This has to be executed via a button on the spreadsheet, finding the macro and hitting F5 won't do it. </p>\n\n<p>Edit: This will only setup the printer on one page. If you need, for example, 14 pages, have the button that launches this macro on the first tab, and have the 14 tabs that you need printed after.</p>\n\n<pre><code>Set WSHShell = WScript.CreateObject( \"WScript.Shell\" )\nWSHshell.AppActivate \" Excel.exe \" \nwsh.sleep 1000\nFor i = 1 To 14\nWSHshell.SendKeys  \"^\"&amp;\"{PGDN}\" \nwsh.sleep 500\nWSHshell.SendKeys \"%psp\" \nwsh.sleep 2500\nWSHshell.SendKeys \"{TAB 1}\" \nwsh.sleep 500\nWSHshell.SendKeys \"o\" \nwsh.sleep 3500\nWSHshell.SendKeys \"{TAB 4}\" \nwsh.sleep 500\nWSHshell.SendKeys \"n\" \nWSHshell.SendKeys \"y\" \nwsh.sleep 500\nWSHshell.SendKeys \"{TAB 2}\" \nWSHshell.SendKeys \"l\" \nwsh.sleep 500\nWSHshell.SendKeys \"{Enter}\" \nwsh.sleep 500\nWSHshell.SendKeys \"{Enter}\" \nwsh.sleep 500\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1550762223, "post_id": 54801391, "comment_id": 96397521, "body": "This is a decent option as well, but doesn&#39;t work if the task requests that the entire process is done programmatically"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1550733863, "creation_date": 1550733863, "answer_id": 54801391, "question_id": 54792080, "link": "https://stackoverflow.com/questions/54792080/how-to-get-duplex-printing-working-in-excel/54801391#54801391", "title": "How to get Duplex printing working in Excel?", "body": "<p>Since the duplex option cannot be chosen by VBA directly, you can workaround this by adding the same printer twice to Windows and set the default settings of the second printer to duplex.</p>\n\n<ul>\n<li>Printer A (standard) <em>&lt;-- your already existing printer</em></li>\n<li>Printer A (duplex) <em>&lt;-- install the same printer again and set duplex as default</em></li>\n</ul>\n\n<p>Then you just need to tell Excel to print on the printer named <code>Printer A (duplex)</code>. Which will end up in duplex then (because of its default settings).</p>\n\n<p>I used this technique several times and it works good.</p>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 54792081, "answer_count": 2, "score": 1, "last_activity_date": 1550765845, "creation_date": 1550683452, "last_edit_date": 1550733667, "question_id": 54792080, "link": "https://stackoverflow.com/questions/54792080/how-to-get-duplex-printing-working-in-excel", "title": "How to get Duplex printing working in Excel?", "body": "<p>I'd like to programatically print front and back (Duplex) with Excel. How can I do this, while being agnostic to the type of printer I'm printing to (Assuming it supports duplex printing)</p>\n"}, {"tags": ["excel", "vba", "osisoft"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550685813, "post_id": 54792031, "comment_id": 96363311, "body": "What&#39;s the exact error message, and what&#39;s the value of MFA when it fails?"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550686584, "post_id": 54792031, "comment_id": 96363645, "body": "@TimWilliams Run-time error&#39;13 Type mismatch. MFA has no value when it fails. At one point I was able to yield a string in MFA but I forgot how I did that."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550686812, "post_id": 54792031, "comment_id": 96363764, "body": "When it errors, hit Debug and enter <code>Typename(MFA)</code> in the Immediate pane and hit enter - what output does that give you?"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687018, "post_id": 54792031, "comment_id": 96363877, "body": "@TimWilliams MFA has the intended current value &quot;CULTURE&quot;, My location tag was messed up. still getting the same error, looking at the bottom window, VBA lists my MFA variable as MFA(1) and MFA(2), the first being populated correctly, the second having no value."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1550687317, "post_id": 54792031, "comment_id": 96364046, "body": "If the value of MFA is &quot;CULTURE&quot; then that statement should not throw a type-mismatch error, so something else is going on here.  Not sure I follow the rest of your comment - are you saying that MFA is an array?  If so then that would be a problem..."}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687470, "post_id": 54792031, "comment_id": 96364121, "body": "MFA is not an array, it is just populated with whatever value it pulls from the server at that moment."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687505, "post_id": 54792031, "comment_id": 96364137, "body": "Then I&#39;m not following where you&#39;re seeing MFA(1) and MFA(2). Might help to show the code for <code>PICurrVal</code>"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687581, "post_id": 54792031, "comment_id": 96364181, "body": "PICurrVal is a function owned by OSIsoft. part of an excel add-in"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687883, "post_id": 54792031, "comment_id": 96364342, "body": "It looks like all of my variables interacting with the PICurrVal function are listed as Variant/Variant(1 to 2)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550687959, "post_id": 54792031, "comment_id": 96364370, "body": "So you&#39;d need something like <code>If MFA(1) = &quot;culstop&quot; Then</code> depending on which slot has the value of interest"}, {"owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550688361, "post_id": 54792031, "comment_id": 96364564, "body": "That worked! no idea why it stores the data that way but thank you!"}], "owner": {"reputation": 7, "user_id": 11012879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cU8REEvV2E4/AAAAAAAAAAI/AAAAAAAAAQ4/StmTA3MdbO4/photo.jpg?sz=128", "display_name": "Steve Vitale", "link": "https://stackoverflow.com/users/11012879/steve-vitale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1550733659, "creation_date": 1550683225, "last_edit_date": 1550733659, "question_id": 54792031, "link": "https://stackoverflow.com/questions/54792031/getting-object-mismatch-when-setting-pi-datalink-function-return-equal-to-anothe", "title": "Getting object mismatch when setting PI DataLink function return equal to another variable", "body": "<p>I am attempting to print a series of ordered values to the current sheet based on change to a specific value provided by the PIDataLink current value function. I have bolded the area that is yielding a mismatch error, realizing that the rest of my code will share this error. (If MFA = \"culstop\" Then) \n*some repeat code is missing to save space.</p>\n\n<pre><code>Sub culturestop_timestamp()\n\nDim culstop As String\nDim MFA As Variant\nDim MFA2 As String    \nDim MFB As Variant\nDim MFC As Variant\nDim MFD As Variant\nDim MFE As Variant\nDim MFF As Variant\nDim MFG As Variant\nDim MFH As Variant\nDim start As Date\nDim curtime As Date\nDim rownum As Integer\n\nApplication.OnTime Now, \"culturestop_timestamp\"\nreset:\n    'Application.OnTime TimeValue(\"00:00:00\", \"culturestop_timestamp\")\n    start = Now()\n\nrownum = 30\n\nA = 0\nB = 0\nC = 0\nD = 0\nE = 0\nF = 0\nG = 0\nH = 0\n\n\nDo While curtime &lt;= TimeValue(\"23:59:00\")\n    Application.Wait (Now + TimeValue(\"00:00:30\"))\n\n    MFA = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMA_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFB = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMB_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFC = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMC_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFD = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMD_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFE = Application.Run(\"PICurrVal\", \"TAPS1.MNFERME_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFF = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMF_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFG = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMG_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    MFH = Application.Run(\"PICurrVal\", \"TAPS1.MNFERMH_UNIT / PHASE_SELECT.CVS\", 0, \"\")\n    If A = 2 Then\n        MFA = \"Already_Brothed_Out_Today\"\n    End If\n    If B = 2 Then\n        MFB = \"Already_Brothed_Out_Today\"\n    End If\n    If C = 2 Then\n        MFC = \"Already_Brothed_Out_Today\"\n    End If\n    If D = 2 Then\n        MFD = \"Already_Brothed_Out_Today\"\n    End If\n    If E = 2 Then\n        MFE = \"Already_Brothed_Out_Today\"\n    End If\n    If F = 2 Then\n        MFF = \"Already_Brothed_Out_Today\"\n    End If\n    If G = 2 Then\n        MFG = \"Already_Brothed_Out_Today\"\n    End If\n    If H = 2 Then\n        MFH = \"Already_Brothed_Out_Today\"\n    End If\n\n    ***If MFA = \"culstop\" Then***\n        A = 2\n        MFAR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE / MNFERMA_TYPE.CV\", 0, \"\")\n        MFAT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFAT\n        Sheet1.Range(\"B\" &amp; rownum) = MFAR\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n\n\n        rownum = rownum + 1\n\n    End If\n\n    If MFB = \"culstop\" Then\n        B = 2\n        MFBR = Application.Run(\"PICurrVal\", \"TAPS1.TC02_RECIPE / MNFERMB_TYPE.CV\", 0, \"\")\n        MFBT = Now()\n        Sheet1.Range(\"A\" &amp; rownum) = MFBT\n        Sheet1.Range(\"B\" &amp; rownum) = MFBR\n        'Sheet1.Range(\"C\" &amp; rownum) =\n        'Sheet1.Range(\"D\" &amp; rownum) =\n        'Sheet1.Range(\"E\" &amp; rownum) =\n        'Sheet1.Range(\"F\" &amp; rownum) =\n        rownum = rownum + 1\n\n\n    End If\n\n\n    curtime = Now()\n\nLoop\nGoTo reset\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "syntax"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1550682025, "post_id": 54791463, "comment_id": 96361427, "body": "You can use parenthesis in Data Validation. How are you setting <code>mys</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1550682197, "creation_date": 1550682197, "answer_id": 54791747, "question_id": 54791463, "link": "https://stackoverflow.com/questions/54791463/are-parenthesis-not-allowed-in-a-data-validation-string/54791747#54791747", "title": "Are parenthesis not allowed in a Data Validation string?", "body": "<p>Assuming that <code>mys</code> is a range, do this:</p>\n\n<pre><code>.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlBetween, Formula1:=\"=mys\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1550687579, "post_id": 54791981, "comment_id": 96364180, "body": "You can bypass that limit by placing your entries in a spreadsheet range, and using that range address for the drop down."}, {"owner": {"reputation": 41, "user_id": 11063436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Uo0XcZm_-k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP-DXD-Fo3N1Cza1Xp3uAVZhi5yHA/mo/photo.jpg?sz=128", "display_name": "Christina Madak", "link": "https://stackoverflow.com/users/11063436/christina-madak"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1550690228, "post_id": 54791981, "comment_id": 96365457, "body": "That is what I did. I was unfamiliar with re-referencing named ranges, which is what I needed for the dynamic drop-downs if I used the spreadsheet."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1550690501, "post_id": 54791981, "comment_id": 96365581, "body": "Glad you&#39;ve got it sorted.  <a href=\"https://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">Debra Dagleish Contexture&#39;s website</a> has a lot of information on dynamic drop-down lists, and also dynamic dependent dropdowns, that you may find of use."}], "tags": [], "owner": {"reputation": 41, "user_id": 11063436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Uo0XcZm_-k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP-DXD-Fo3N1Cza1Xp3uAVZhi5yHA/mo/photo.jpg?sz=128", "display_name": "Christina Madak", "link": "https://stackoverflow.com/users/11063436/christina-madak"}, "is_accepted": false, "score": 2, "last_activity_date": 1550683078, "creation_date": 1550683078, "answer_id": 54791981, "question_id": 54791463, "link": "https://stackoverflow.com/questions/54791463/are-parenthesis-not-allowed-in-a-data-validation-string/54791981#54791981", "title": "Are parenthesis not allowed in a Data Validation string?", "body": "<p>It turns out it isn't the parenthesis that are causing problems, it is the length of the string.</p>\n\n<p>Formulas in Excel have a 256 character limit and Excel throws an exception when you exceed that limit.</p>\n"}], "owner": {"reputation": 41, "user_id": 11063436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0Uo0XcZm_-k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP-DXD-Fo3N1Cza1Xp3uAVZhi5yHA/mo/photo.jpg?sz=128", "display_name": "Christina Madak", "link": "https://stackoverflow.com/users/11063436/christina-madak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550683078, "creation_date": 1550681303, "question_id": 54791463, "link": "https://stackoverflow.com/questions/54791463/are-parenthesis-not-allowed-in-a-data-validation-string", "title": "Are parenthesis not allowed in a Data Validation string?", "body": "<p>I am setting a data validation of a field through VBA. Everything runs fine until the point of Adding the validation to the field, and only on some of the validation strings. It is the strings that seem to be causing a problem.</p>\n\n<p>I have the following Data Validation code:</p>\n\n<pre><code>If Not NewTarget Is Nothing Then\n    With NewTarget.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlBetween, Formula1:=mys\n    End With\n\n    NewTarget.Value = MyList(1)\nEnd If\n</code></pre>\n\n<p>The value of mys that fails is:</p>\n\n<pre><code>\"Select One,Trade - Transportation - Utilities(9),Information,Finance -   Insurance - Real Estate,Professional - Business Services,Educational - Health Services,Leisure - Entertainment - Hospitality,Other Services (Except Public Administration),Public Administration\"\n</code></pre>\n\n<p>The one that works is:</p>\n\n<pre><code>\"Select One,Natural Resources - Mining,Construction,Manufacturing\"\n</code></pre>\n\n<p>Do I need to remove the parenthesis from the string in order for the validation string to be accepted?</p>\n\n<p>I have seen that using formulas from VBA do seem to cause problems with parenthesis in strings.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1550681319, "post_id": 54791062, "comment_id": 96360955, "body": "Are you after <code>Range(&quot;D&quot; &amp; lastrow) = &quot;=SUMIF(F2:F&quot; &amp; lastrow &amp; &quot;, &quot;&quot;&gt;0&quot;&quot;)&quot;</code>?"}, {"owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550682275, "post_id": 54791062, "comment_id": 96361577, "body": "Thank you for your reply. This is exactly what I was looking for. I updated my code a little. I now have added in <code>lastrow2 = Range(&quot;A1048576&quot;).End(xlUp).Row</code>, for my other insert. <code>lastrow = Range(&quot;A1048576&quot;).End(xlUp).Offset(1, 0).Row</code>  My final end code reads. <code>Range(&quot;F&quot; &amp; lastrow) = &quot;=SUMIF(F2:F&quot; &amp; lastrow2 &amp; &quot;, &quot;&quot;&gt;0&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1550682816, "post_id": 54791062, "comment_id": 96361870, "body": "You could adopt Ahmed&#39;s approach of just adding 1 to your variable, and maybe use Rows.count rather than hardcoding 1048576 even if unlikely to make much difference in practical terms"}, {"owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550683269, "post_id": 54791062, "comment_id": 96362096, "body": "Thanks ill switch over. To the cleaner version."}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 2, "last_activity_date": 1550682260, "creation_date": 1550682260, "answer_id": 54791769, "question_id": 54791062, "link": "https://stackoverflow.com/questions/54791062/sumifs-sum-of-column-ignoring-n-a/54791769#54791769", "title": "Sumifs - sum of column ignoring N/A", "body": "<p>Try</p>\n\n<pre><code>Lastrow = Range(\"A1048576\").End(xlUp).Row + 1\nRange(\"D\" &amp; Lastrow) = \"=SUMIF(F2:F\" &amp; Lastrow &amp; \",\" &amp; Chr(34) &amp; \"&gt; 0\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1550683362, "creation_date": 1550683362, "answer_id": 54792057, "question_id": 54791062, "link": "https://stackoverflow.com/questions/54791062/sumifs-sum-of-column-ignoring-n-a/54792057#54792057", "title": "Sumifs - sum of column ignoring N/A", "body": "<p>If you want to sum all the rows your last row must be from F column. If your column A has different number of elementos than F, that will not work.</p>\n\n<p>You can also use SUMPRODUCT</p>\n\n<pre><code>lastrow = Range(\"F1048576\").End(xlUp).Row\nmRange = \"F2:F\" &amp; lastrow\nRange(\"D\" &amp; lastrow) = \"=SUMPRODUCT(--(\" &amp; mRange &amp; \" &gt;  0 ), \" &amp; mRange &amp; \" ) \"\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 54791769, "answer_count": 2, "score": 1, "last_activity_date": 1550683362, "creation_date": 1550680065, "last_edit_date": 1550680934, "question_id": 54791062, "link": "https://stackoverflow.com/questions/54791062/sumifs-sum-of-column-ignoring-n-a", "title": "Sumifs - sum of column ignoring N/A", "body": "<p>I am having trouble with an error code 1004. I am attempting to have a SUMIF formula in my VBA code. My objective is to Sum Column F from F2 to the lastrow. the column has Vlookup values that include \"#N/A\". The formula used without VBA is</p>\n\n<p><code>=SUMIF(F2:F3509, \"&gt; 0\")</code></p>\n\n<p>My attempted formula in VBA is </p>\n\n<pre><code>lastRow = Range (\"A1048576\").End(xlup).Row\nRange(\"D\" &amp; lastrow) = \"=SUMIF(F2:F, \"\"&gt; 0\"\"\" &amp; lastrow &amp; \")\"\n</code></pre>\n\n<p>. Any help would be much appreciated. Thank you very much. Matt</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550681000, "post_id": 54790880, "comment_id": 96360779, "body": "maybe you can utilize the findwindow api as well. that may work more smoothly once you have the print dialog box open?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1550681066, "post_id": 54790880, "comment_id": 96360815, "body": "That looks interesting, I&#39;ll take a look into that!"}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1550680392, "post_id": 54791079, "comment_id": 96360400, "body": "Thanks for the help! It seems like Tab doesn&#39;t want to function when the print window is open o_O?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1550680117, "creation_date": 1550680117, "answer_id": 54791079, "question_id": 54790880, "link": "https://stackoverflow.com/questions/54790880/how-do-i-debug-issues-using-sendkeys-in-vba/54791079#54791079", "title": "How do I debug issues using SendKeys in VBA?", "body": "<ol>\n<li>only run the sub when the <strong>Excel</strong> worksheet window is active not the <strong>VBE</strong> window. <em>(in fact, close the <strong>VBE</strong> before running the sub)</em></li>\n<li>replace all <code>Sleep</code> command with <code>DoEvents</code> commands</li>\n</ol>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550683140, "creation_date": 1550679474, "last_edit_date": 1550683140, "question_id": 54790880, "link": "https://stackoverflow.com/questions/54790880/how-do-i-debug-issues-using-sendkeys-in-vba", "title": "How do I debug issues using SendKeys in VBA?", "body": "<p>So I'm trying to set duplex printing in Excel, and the other code posted just doesn't work for me. I tried to debug it, got nowhere, and decided to try and use SendKeys to set the duplex printing option. Code is as follows:</p>\n\n<pre><code>Sub SendKeysDuplex()\nDim I As Long\nApplication.Dialogs(xlDialogPrinterSetup).Show\n\nApplication.SendKeys \"^p\", True\nSleep 5000\n\nFor I = 1 To 3\n    Application.SendKeys \"{TAB}\", True\n    Sleep 500\nNext I\n    Application.SendKeys \"{ENTER}\", True\n    Sleep 500\nFor I = 1 To 4\n    Application.SendKeys \"{TAB}\", True\n    Sleep 500\nNext I\n\n        'First sets the option to no\n    Application.SendKeys \"n\", True\n        'To make sure we get the right yes\n    Application.SendKeys \"y\", True\n    'And confirm the setting\n    Application.SendKeys (\"{ENTER}\")\n    'Sheet1.PrintOut\n\nEnd Sub\n</code></pre>\n\n<p>It opens the print menu just fine - but then the tabs and enters don't seem to do anything. However, if I try to debug the code by stepping through it, it sends the keys to the VBA editor - not to Excel.</p>\n\n<p>How can I debug issues in SendKeys? Is there something else I need to know about opening up menus with Sendkeys?</p>\n\n<p>I managed to get debugging to \"work\" by creating a bunch of macros with individual SendKeys, assigning those macros to keys, and then pressing the keys in order. It looks like Tab doesn't want to function in the print dialog - it does nothing when it's sent with a sendkey, but it works when manually pressing it. (???)</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1550679049, "post_id": 54790464, "comment_id": 96359598, "body": "Upon which line do you get the error?"}, {"owner": {"reputation": 5, "user_id": 6906503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276c4e02010bf027e671a8c68d293e88?s=128&d=identicon&r=PG&f=1", "display_name": "LRSpartan", "link": "https://stackoverflow.com/users/6906503/lrspartan"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1550679567, "post_id": 54790464, "comment_id": 96359928, "body": "Good question!     mrs.Open sSQLSting, Conn"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1550682535, "post_id": 54790464, "comment_id": 96361719, "body": "Why not just open the file and read from the Sheet instead of using SQL?"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1550682867, "post_id": 54790464, "comment_id": 96361901, "body": "Also, you may be having this issue: <a href=\"https://stackoverflow.com/questions/19755396/performing-sql-queries-on-an-excel-table-within-a-workbook-with-vba-macro\" title=\"performing sql queries on an excel table within a workbook with vba macro\">stackoverflow.com/questions/19755396/&hellip;</a> where the SELECT FROM needs to be a SheetName!$Range for it to work properly. You have to convert the table name to a range, the post has an answer on how to do so."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1550685395, "post_id": 54790464, "comment_id": 96363110, "body": "The only thing that I can think of here (and I can&#39;t imagine it would throw an automation error) is that the ODBC driver is making assumptions about the column type. From experience it generally only looks at the top 10 (or so) records in the excel sheet and determines from there. If those top 10 rows are numeric it may decide this is a numeric row and it <i>may</i> throw an error when you filter by a string. I can&#39;t believe that it wouldn&#39;t just cast the row on the fly to do the FILTER but Jet and Ace have always been very fickle drivers."}, {"owner": {"reputation": 5, "user_id": 6906503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276c4e02010bf027e671a8c68d293e88?s=128&d=identicon&r=PG&f=1", "display_name": "LRSpartan", "link": "https://stackoverflow.com/users/6906503/lrspartan"}, "edited": false, "score": 0, "creation_date": 1550762395, "post_id": 54790464, "comment_id": 96397649, "body": "JNevill is right about the column type being an issue. The first 100 rows for that column are integers. I deleted the rows to test, and it works perfectly now. I am going to see if there is a why I can define the column before it is imported in to Excel. Thank you JNevill and the others for your help!"}], "owner": {"reputation": 5, "user_id": 6906503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276c4e02010bf027e671a8c68d293e88?s=128&d=identicon&r=PG&f=1", "display_name": "LRSpartan", "link": "https://stackoverflow.com/users/6906503/lrspartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550733504, "creation_date": 1550678317, "last_edit_date": 1550733504, "question_id": 54790464, "link": "https://stackoverflow.com/questions/54790464/where-oh-where-vba-sql-where-clause-with-variable", "title": "Where oh Where (VBA SQL Where Clause with Variable)", "body": "<p>I am SQL guy trying to help with a VBA project. I get a VBA error when I try to run this sql statement. Run-time error '-2147217913 (80040e07)' Automation error. </p>\n\n<p>I can send a number without issue so I know I am doing something wrong when a string is passed. Thank you for your help! I have spent so much time trying to figure it out.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>sSQLSting = \"SELECT TOP 10 PctTtlAssets, Port_Code FROM [db_detail$] \nWHERE Port_Code  = ' \" &amp; [vbaThisPort] &amp; \" ' \"\n</code></pre>\n\n<p>which looks like this when saved to my variable. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sSQLSting = \"SELECT TOP 10 PctTtlAssets, Port_Code FROM [db_detail$] \nWHERE Port_Code  = 'salmemhs' \"\n</code></pre>\n\n<p>Thank you</p>\n\n<p>PS</p>\n\n<p>Here is the full code the vba guy is using. Again, works fine until I send a string.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub sbADO()\nDim sSQLQry As String\nDim ReturnArray\n\nDim Conn As New ADODB.Connection\nDim mrs As New ADODB.Recordset\n\nDim DBPath As String, sconnect As String, vbaThisPort As String\n\n\nvbaThisPort = Trim(ThisWorkbook.Names(\"ThisPort\").RefersToRange(1, 1))\n\n'MsgBox (vbaThisPort) 'Testing\n\nDBPath = ThisWorkbook.FullName\n\n'You can provide the full path of your external file as shown below\n'DBPath =\"C:\\InputData.xlsx\"\n\nsconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n\n' Your SQL Statemnt (Table Name= Sheet Name=[DataSheet$])\"\n\nConn.Open sconnect\n    sSQLSting = \"SELECT TOP 10 PctTtlAssets, Port_Code FROM [db_detail$] WHERE Port_Code  = '\" &amp; [vbaThisPort] &amp; \"'\"\n\n    mrs.Open sSQLSting, Conn\n        '=&gt;Load the Data into an array\n        'ReturnArray = mrs.GetRows\n                ''OR''\n        '=&gt;Paste the data into a sheet\n        ActiveSheet.Range(\"A2\").CopyFromRecordset mrs\n    'Close Recordset\n    mrs.Close\n\n'Close Connection\nConn.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "background-color", "paste"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550679750, "post_id": 54790549, "comment_id": 96360033, "body": "&quot;You didn&#39;t and therefore your .Copy line does nothing at all&quot; - not exactly true: it did copy the contents to the clipboard, making the content available for a subsequent <code>Paste</code> or <code>PasteSpecial</code> call, and toggling global-state <code>Application.CutCopyMode</code> to <code>True</code>. But yeah, it didn&#39;t copy the contents where the OP meant to paste it."}, {"owner": {"reputation": 57, "user_id": 11014628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85b6868c050c75700e2f0677e7baf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/11014628/tara"}, "edited": false, "score": 0, "creation_date": 1550680372, "post_id": 54790549, "comment_id": 96360387, "body": "Hello, thanks for the fedback and it does work for posting the formatting, however now i have the same values duplicated.  It will post one with formatting and one without.  Any tips on how to fix that?"}, {"owner": {"reputation": 57, "user_id": 11014628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85b6868c050c75700e2f0677e7baf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/11014628/tara"}, "edited": false, "score": 0, "creation_date": 1550680932, "post_id": 54790549, "comment_id": 96360735, "body": "Hello, works great! When I tried it the first time it didnt work, however I saved it and now it works great!  The only thing I did differently was change back the integers because my excel kept freezing."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550689987, "post_id": 54790549, "comment_id": 96365366, "body": "@MathieuGuindon Yes, of course, I should have been more clear about that ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 57, "user_id": 11014628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85b6868c050c75700e2f0677e7baf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/11014628/tara"}, "edited": false, "score": 1, "creation_date": 1550690234, "post_id": 54790549, "comment_id": 96365460, "body": "@Tara <code>Long</code> vs <code>Integer</code> isn&#39;t going to make a difference with Excel &quot;freezing&quot;. However <code>Integer</code> row numbers will absolutely crash with run-time error 6 &quot;Overflow&quot; as soon as you try to assign them a value greater than 32,767. There is no reason whatsoever to ever have an <code>Integer</code> in VBA, unless you&#39;re invoking Win32 API functions that <i>require</i> working with a 16-bit integer and blow up if you give them a 32-bit one (that&#39;s <code>Long</code>)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550690278, "post_id": 54790549, "comment_id": 96365477, "body": "What <i>does</i> make Excel go &quot;(not responding)&quot; though, is repeatedly accessing a worksheet inside a loop body: the UI thread (the only thread available to VBA) is busy running your loop, and thus isn&#39;t updating Excel. Excel isn&#39;t &quot;frozen&quot;, it&#39;s just busy running your loop."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1550690085, "last_edit_date": 1550690085, "creation_date": 1550678545, "answer_id": 54790549, "question_id": 54790439, "link": "https://stackoverflow.com/questions/54790439/color-formatting-when-searching-excel/54790549#54790549", "title": "Color formatting when searching excel", "body": "<p>Note that you if you use</p>\n\n<pre><code>ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 9).Value = msheet.Range(msheet.Cells(i, 1), msheet.Cells(i, 9)).Value\n</code></pre>\n\n<p>it olny transfers the value but no formattings.</p>\n\n<p>And if you use <code>.Copy</code> you need to specify the destination. You didn't and therefore your <code>.Copy</code> line does nothing at all.   * <em>See Mathieu's comment below.</em></p>\n\n<p>Throw out the <code>.Value</code> line and replace the <code>.Copy</code> line with the following:</p>\n\n<pre><code>msheet.Range(msheet.Cells(i, 1), msheet.Cells(i, 9)).Copy Destination:=ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 9)\n</code></pre>\n\n<hr>\n\n<p>Note that row counting variables must be of type <code>Long</code> Excel has more rows than <code>Integer</code> can handle!</p>\n\n<pre><code>Dim finalrow As Long\nDim finalrow2 As Long\nDim i As Long\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11014628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85b6868c050c75700e2f0677e7baf0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/11014628/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 54790549, "answer_count": 1, "score": 1, "last_activity_date": 1550690085, "creation_date": 1550678248, "last_edit_date": 1550678265, "question_id": 54790439, "link": "https://stackoverflow.com/questions/54790439/color-formatting-when-searching-excel", "title": "Color formatting when searching excel", "body": "<p>I currently have a macro that will search an excel spreadsheet and then place the results in a different sheet.  The only issue is is that it wont copy the color formatting when transferring the results. Here is the code.  I have tried paste special but it doesnt work for all the results.</p>\n\n<pre><code>Sub Searchcustomer()    \n    Dim wb As Workbook: Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Set ws = wb.Sheets(\"Search\")\n\n    If ws.Range(\"B3\").Value = \"\" And ws.Range(\"B4\").Value = \"\" And ws.Range(\"B5\").Value = \"\" And ws.Range(\"B6\").Value = \"\" And ws.Range(\"B7\").Value = \"\" And ws.Range(\"B8\").Value = \"\" Then\n                MsgBox \"Please Enter Data into Table\"\n                Exit Sub\n    End If\n\n    Dim msheet As Worksheet\n    Dim ssheet As Worksheet\n    Dim stand  As String\n    Dim number As String\n    Dim customer As String\n    Dim states As String\n    Dim find As String\n    Dim audit As String\n    Dim saudit As String\n    Dim est As String\n    Dim pub As String\n    Dim finalrow As Integer\n    Dim finalrow2 As Integer\n    Dim i As Integer\n\n    Set msheet = Sheet4\n    Set ssheet = Sheet5\n\n    number = ssheet.Range(\"B3\").Value\n    customer = ssheet.Range(\"B4\").Value\n    states = ssheet.Range(\"B5\").Value\n    find = ssheet.Range(\"B6\").Value\n    audit = ssheet.Range(\"B7\").Value\n    saudit = ssheet.Range(\"B8\").Value\n\n    msheet.Select\n    finalrow = msheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To finalrow\n        If IIf(stand &lt;&gt; \"\", msheet.Cells(i, 1) = number, True) And IIf(number &lt;&gt; \"\", msheet.Cells(i, 2) = number, True) And IIf(customer &lt;&gt; \"\", msheet.Cells(i, 3) = customer, True) And IIf(states &lt;&gt; \"\", Cells(i, 4) = states, True) And IIf(find &lt;&gt; \"\", Cells(i, 5) = find, True) And IIf(audit &lt;&gt; \"\", Cells(i, 6) = audit, True) And IIf(saudit &lt;&gt; \"\", Cells(i, 7) = saudit, True) And IIf(est &lt;&gt; \"\", msheet.Cells(i, 8) = number, True) And IIf(pub &lt;&gt; \"\", msheet.Cells(i, 9) = number, True) Then\n            msheet.Range(msheet.Cells(i, 1), msheet.Cells(i, 9)).Copy\n            ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 9).Value = msheet.Range(msheet.Cells(i, 1), msheet.Cells(i, 9)).Value\n\n        End If\n    Next i\n\n    ssheet.Select\n    ssheet.Range(\"B3\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "object", "outlook"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1550686580, "post_id": 54790386, "comment_id": 96363641, "body": "I have not run your code but when it works, what does the target folder resolve to? When it does not work what does the target folder resolve to?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550686725, "post_id": 54790386, "comment_id": 96363719, "body": "Abstract that part out to a standalone function which you can pass something like &quot;Archive|Projekte-Archiv|P03_NetRef&quot;  Within the functon, split the path on &quot;|&quot; and loop over the folders, using each one to get the next."}, {"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1550739589, "post_id": 54790386, "comment_id": 96382637, "body": "@peakpeak  I hope this answers your question: When I run the procedure in the working version, the MoveToFolder gets loaded with all the data of such an object (folder object), including the folder path, here: &quot;\\\\Archive\\Projekte-Archiv\\P03_NetRef&quot;, as one can see in the Locale Window. In the non-working version it does not get there at all because the problem occurs earlier, already during compilation. &quot;Outlook.MAPIFolder&quot; seems not to be an accepted object type in CType(). The question is, how can I then set MoveToFolder to a folder (path) that I provide in form of a string?"}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1550740918, "post_id": 54792974, "comment_id": 96383424, "body": "Works like a charm! - Interestingly, with this you did not actually answer the narrower question: &quot;Can the CType() function made work with the object type &#39;Outlook.MAPIFolders&#39;?&quot; Rather you provided a solution that even saves me the time to develop something like this myself as this was where I wanted to go in the long run without knowing exactly how. Now I know. Very elegant solution!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1550763762, "post_id": 54792974, "comment_id": 96398612, "body": "<code>CType()</code> can&#39;t work because that&#39;s not even part of the VBA language.  That&#39;s .NET I think."}, {"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1550776752, "post_id": 54792974, "comment_id": 96405751, "body": "Hm. Perhaps I got confused because Microsoft mentions it in a Visual Basic guide... somewhere inside of a Dotnet topic: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/functions/ctype-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1550687124, "creation_date": 1550687124, "answer_id": 54792974, "question_id": 54790386, "link": "https://stackoverflow.com/questions/54790386/setting-a-folder-object-through-a-string-describing-its-path/54792974#54792974", "title": "Setting a folder object through a string describing its path", "body": "<p>Untested:</p>\n\n<pre><code>Set MoveToFolder = GetFolder(ns, \"Archive|Projekte-Archiv|P03_NetRef\")\n</code></pre>\n\n<p>A function to parse the path:</p>\n\n<pre><code>Function GetFolder(root, fpath)\n    Dim f As Object\n    Dim arr, i\n    arr = Split(fpath, \"|\")\n    For i = 0 To UBound(arr)\n        If i = 0 Then\n            Set f = root.Folders(arr(i))\n        Else\n            Set f = f.Folders(arr(i))\n        End If\n    Next i\n    Set GetFolder = f\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 54792974, "answer_count": 1, "score": 0, "last_activity_date": 1554772602, "creation_date": 1550678110, "last_edit_date": 1554772602, "question_id": 54790386, "link": "https://stackoverflow.com/questions/54790386/setting-a-folder-object-through-a-string-describing-its-path", "title": "Setting a folder object through a string describing its path", "body": "<p>In MS Outlook (2016) I am working on a VBA procedure to more quickly archive certain, individually selected e-mails into certain folders in my e-mail archive.</p>\n\n<p>I have a procedure that does the trick when I address the target folder manually: </p>\n\n<pre><code>'[...]\nDim MoveToFolder As Outlook.MAPIFolder\n'[...]\nSet MoveToFolder = ns.Folders(\"Archive\").Folders(\"Projekte-Archiv\").Folders(\"P03_NetRef\")\n'[...]\n</code></pre>\n\n<p>With this the procedure knows what folder to move pre-selected e-mail to. </p>\n\n<p><strong>Now my problem:</strong> </p>\n\n<p>I am trying to set the \"MoveToFolder\" folder object <strong>through a string variable</strong> giving it all the necessary data.</p>\n\n<p>Why do I want to do this: Handing over the folder data as a string variable would allow me to use the same procedure for as many folders in as many hierarchy levels I want.</p>\n\n<p>Here is what I came up with, using the CType function: </p>\n\n<pre><code>'[...]\nDim MoveToFolder As Outlook.MAPIFolder\n'[...]\nSet MoveToFolder = CType(\"ns.Folders(\"\"Archive\"\").Folders(\"\"Projekte-Archiv\"\").Folders(\"\"P03_NetRef\"\")\", Outlook.MAPIFolder)\n'[...]\n</code></pre>\n\n<p>(The idea is of course in a next step to insert the string through a variable, not in plain writing like the example.)</p>\n\n<p>This does not work. The object type 'Outlook.MAPIFolder' results in an error on compiling (\"method or data object not found\").</p>\n\n<p><strong>Later insight</strong></p>\n\n<p>As I understood later on, the CType() function is not available in VBA (as opposed to VB.net).</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1550677545, "post_id": 54790142, "comment_id": 96358643, "body": "<i>Not worked on webscraping ...</i> without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it&#39;s hard to help you at all. In general you can create a loop and call the url each time in the loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550735252, "post_id": 54790142, "comment_id": 96380208, "body": "Please include your code so we can see what is going on. There isn&#39;t even a question above. Implicit <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">please help</a> is not a question."}], "owner": {"reputation": 31, "user_id": 8746502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gzVCeam3Iz4/AAAAAAAAAAI/AAAAAAAABXk/3JO0tpmscy0/photo.jpg?sz=128", "display_name": "raj kumar", "link": "https://stackoverflow.com/users/8746502/raj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550733464, "creation_date": 1550677414, "last_edit_date": 1550733464, "question_id": 54790142, "link": "https://stackoverflow.com/questions/54790142/open-and-close-single-websit-multiple-time-in-vba", "title": "Open and close single Websit multiple time in VBA", "body": "<p>I have scenario where I have 12 plant id for which I need to access single Websit 12 times to download the report one by one.</p>\n\n<p>Not worked on webscraping hence seeking help from expert</p>\n"}, {"tags": ["excel", "vba", "merge-file"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550678210, "post_id": 54789833, "comment_id": 96359085, "body": "What is <code>MergePDFs</code>? \u2022 Note your string is wrong and should be <code>bSuccess = MergePDFs(strPDFs, FolderPath &amp; &quot;\\&quot; &amp; Sheets(&quot;An&#225;lise CC&quot;).Range(&quot;O4&quot;))</code> without the extra quotes <code>&quot;</code> in the begining and the end. You should get a compile error in this line. \u2022 If you ask questions always tell which errors you get and where."}, {"owner": {"reputation": 39, "user_id": 10182851, "user_type": "registered", "profile_image": "https://graph.facebook.com/1805303896231226/picture?type=large", "display_name": "Paulo Zoio", "link": "https://stackoverflow.com/users/10182851/paulo-zoio"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550680806, "post_id": 54789833, "comment_id": 96360654, "body": "Hi, Thanks for the comments and correction. MergePDFs is a function to compile 2 or more pdf files. The first argument is a string, which combines the pdf files to compile. In my case, both file names to compile varies with cells D9 and O4 from &quot;An&#225;lise CC&quot; sheet. The second argument of this function is also a string with the location to where the compiled pdf should be saved being the name also cell O4 (this compiled file should replace the former one). the error I get is &#39;Sub or function not defined&#39; for the MergePDFs function...Thanks in advance"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550686572, "post_id": 54789833, "comment_id": 96363638, "body": "If you get &#39;Sub or function not defined&#39; for the <code>MergePDFs</code> function, then it either isn&#39;t defined or doesn&#39;t have the appropriate scope for where you&#39;re calling it from. The error message is fairly clear about that. Is it declared as <code>Private</code> in another module?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550735671, "post_id": 54789833, "comment_id": 96380431, "body": "Put this function <code>MergePDFs</code> into a module and declare it as <code>Public</code>."}, {"owner": {"reputation": 39, "user_id": 10182851, "user_type": "registered", "profile_image": "https://graph.facebook.com/1805303896231226/picture?type=large", "display_name": "Paulo Zoio", "link": "https://stackoverflow.com/users/10182851/paulo-zoio"}, "edited": false, "score": 0, "creation_date": 1550766649, "post_id": 54789833, "comment_id": 96400560, "body": "Thanks, once again. Yes, indeed, the function was declared as private in a different module. Now the routine is working but is giving me the message &#39;Failed to combine all PDFs&#39;. Since I&#39;ve the Adobe Pro DC installed and the &#39;Adobe Acrobat 10.0 type library&#39; is checked in VBA&#39;s references (adobe.tlb) I supose I should change to adobe.dll but VBA don&#39;t allow (message &#39;can&#39;t add a reference to the specified file&#39;)... Once again, thanks for the advice"}], "owner": {"reputation": 39, "user_id": 10182851, "user_type": "registered", "profile_image": "https://graph.facebook.com/1805303896231226/picture?type=large", "display_name": "Paulo Zoio", "link": "https://stackoverflow.com/users/10182851/paulo-zoio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1550676777, "creation_date": 1550676519, "last_edit_date": 1550676777, "question_id": 54789833, "link": "https://stackoverflow.com/questions/54789833/merging-pdf-files-in-vba", "title": "merging pdf files in vba", "body": "<p>I have a sub-routine to print into pdf an \"An\u00e1lise CC\" excel sheet which is saved in a folder with a file name varying according to the print I want to perform. So far so good. </p>\n\n<p>Then, I'm developing another sub-routine to compile that former pdf file with another pdf file which is located in the same folder. I'm not able to make MergePDFs function to work. what am I doing wrong? Code below. Thanks! </p>\n\n<pre><code>Sub ExportAsPDF()\n    Dim FolderPath As String     \n    FolderPath = \"C:\\Users\\DMM\\Certificados\"\n\n    'Sheets(Array(\"An\u00e1lise CC\", \"QR Code\")).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=FolderPath &amp; \"\\\" &amp; Sheets(\"An\u00e1lise CC\").Range(\"O4\"), _\n      openafterpublish:=False, ignoreprintareas:=False\n\n    MsgBox \"All PDF's have been successfully exported.\" \nEnd Sub\n\n\nSub Combine_PDFs()\n    Dim strPDFs(0 To 1) As String\n    Dim bSuccess As Boolean\n    Dim FolderPath As String\n\n    FolderPath = \"C:\\Users\\ITG-0720\\OneDrive - INSTITUTO TECNOLOGICO DO GAS\\ITG\\DMM\\Certificados\"\n\n    strPDFs(0) = FolderPath &amp; \"\\\" &amp; Sheets(\"An\u00e1lise CC\").Range(\"D9\")\n    strPDFs(1) = FolderPath &amp; \"\\\" &amp; Sheets(\"An\u00e1lise CC\").Range(\"O4\")\n\n    bSuccess = MergePDFs(strPDFs, \"FolderPath &amp; \"\\\" &amp; Sheets(\"An\u00e1lise CC\").Range(\"O4\")\")\n\n    If bSuccess = False Then MsgBox \"Failed to combine all PDFs\", vbCritical, \"Failed to Merge PDFs\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "frame"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550706575, "post_id": 54789816, "comment_id": 96371915, "body": "Re the security warning, have you tried adding the folder to your trusted locations?"}, {"owner": {"reputation": 148, "user_id": 10899835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e601b427dec8874fdbaa7738a4926f?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoT", "link": "https://stackoverflow.com/users/10899835/guidot"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550734339, "post_id": 54789816, "comment_id": 96379708, "body": "No I didn&#39;t. But that would work for me only anyway... It&#39;s a document that is used by many of my colleagues so they would get the warning message all the time."}], "owner": {"reputation": 148, "user_id": 10899835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e601b427dec8874fdbaa7738a4926f?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoT", "link": "https://stackoverflow.com/users/10899835/guidot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1606279474, "creation_date": 1550676470, "question_id": 54789816, "link": "https://stackoverflow.com/questions/54789816/excel-vba-add-folder-explorer-to-worksheet", "title": "Excel-VBA: Add Folder-Explorer to Worksheet", "body": "<p>I want to embed an explorer-window into my excel worksheet, to display some folder contents that are related to my workbook.</p>\n\n<p>I use the following code, which works quiet well:</p>\n\n<pre><code>Sub AddOleBrowser()\n    Dim OleBrowser As OleObject\n    Dim Browser As Object\n\n    Set OleBrowser = ActiveSheet.OLEObjects.Add(ClassType:=\"Shell.Explorer.1\", Link:=False, DisplayAsIcon:=False)\n    Set Browser = OleBrowser.Object\n    Browser.Navigate \"X:\\\" 'Actually some network-path related to my workbook-path\n\n    OleBrowser.Activate\nEnd Sub\n</code></pre>\n\n<p>My problem is, that the OleBrowser keeps getting replaced by a low-res image, displaying the contents of the folder instead, whenever I click somewhere into my worksheet. When I double-click it, it returns to the normal browser view until it loses focus again. I want to add multiple browser windows to my worksheet, so they all should stay \"activated\".</p>\n\n<p>I also tried to add a frame instead, which then holds a browserobject:</p>\n\n<pre><code>Sub AddOleFrameWithBrowser()\n    Dim OleFrame As OleObject\n    Dim CtrlBrowser As Control\n    Dim Browser As Object\n    Set OleFrame = ActiveSheet.OLEObjects.Add(\"Forms.Frame.1\", Link:=False, DisplayAsIcon:=False)\n    Set CtrlBrowser = OleFrame.Object.Controls.Add(\"Shell.Explorer.2\", \"Browser\") 'Frame1 is an MSForms.Frame-object that I placed there before.\n\n    CtrlBrowser.Left = 0\n    CtrlBrowser.Top = 0\n    CtrlBrowser.Width = OleFrame.InsideWidth\n    CtrlBrowser.Height = OleFrame.InsideHeight\n\n    Set Browser = CtrlBrowser.Object\n    Browser.Navigate \"X:\\\" 'Actually some network-path related to my workbook-path\n\n    OleFrame.Activate\nEnd Sub\n</code></pre>\n\n<p>The second option works somewhat OK but when I switch to another worksheet and return, my frame is empty and I can't get a valid reference to my \"Browser\" control.</p>\n\n<pre><code>Sub CheckFrame()\n    '\n    Dim CheckBrowser As Object\n    Set CheckBrowser = ActiveSheet.OleObjects(1).Object.Controls(\"Browser\").Object\n    Stop\n    'CheckBrowser now actually contains the correct WebBrowser-object,\n    'but when I run this sub (after I return to my Worksheet\n    'with the Frame-OleObject) all it's properties either\n    'contain falsified data or may not be accessed by the debugger...\n    'Everything is fine, when I run this sub right after\n    'my AddOleFrameWithBrowser()-Sub.\n    ActiveSheet.OleObjects(1).Activate '&lt;- Does not help\nEnd Sub\n</code></pre>\n\n<p>Additionally whenever I try to do something with the folder-items inside my embedded explorer, it displays some security warning because the path is not on my local machine. This warning does not appear when I add the Shell.Explorer-OleObject directly with AddOleBrowser().</p>\n\n<p>Could someone please give me some advice?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550676175, "post_id": 54789668, "comment_id": 96357787, "body": "try using <code>Sheets(&quot;Database&quot;).</code> instead of activesheet.  Not sure, but you are using two different methods to access cell contents, not sure if you get <code>range(&quot;c5&quot;).value</code> to a variable, then check <code>cells(r,&quot;G&quot;)</code> or <code>range(&quot;G&quot; &amp; r)</code> against that."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550676710, "post_id": 54789668, "comment_id": 96358127, "body": "Build a single <code>Range</code> with <code>Union</code>, then do one <code>Delete</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11049063, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157095051509382/picture?type=large", "display_name": "Bob Ketting", "link": "https://stackoverflow.com/users/11049063/bob-ketting"}, "edited": false, "score": 0, "creation_date": 1550678909, "post_id": 54790109, "comment_id": 96359496, "body": "Thanks, this works like a charm. Quick question on the Union method.Does this require that all rows that need to be deleted are adjacent? Or can there also be gaps between them (e.g. different years). This might happen if the database is sorted by anything other than year"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 23, "user_id": 11049063, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157095051509382/picture?type=large", "display_name": "Bob Ketting", "link": "https://stackoverflow.com/users/11049063/bob-ketting"}, "edited": false, "score": 0, "creation_date": 1550680122, "post_id": 54790109, "comment_id": 96360254, "body": "There can be gaps in between, no problem."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1550677343, "creation_date": 1550677343, "answer_id": 54790109, "question_id": 54789668, "link": "https://stackoverflow.com/questions/54789668/delete-rows-sub-very-slow-to-process/54790109#54790109", "title": "Delete rows sub very slow to process", "body": "<p>Deleting something in a Worksheet is a rather slow operation, and depending on how many rows you want to delete (and it seems to be a lot), you should collect everything that should be deleted in a <code>Range</code>-Variable and delete it all at once.</p>\n\n<p>One additional aspect is that <code>UsedRange</code> is not always reliable, and if you are unlucky, the macro checks everything from the very last possible row (=1048576), which could also be an issue. The construct <code>.Cells(.Rows.Count, \"G\").End(xlUp).row</code> will get the row number of the last used row in Col 'G'.</p>\n\n<p>Try the following code </p>\n\n<pre><code>Sub del()\n\n    Dim r As Long\n    Dim deleteRange As Range\n    Set deleteRange = Nothing\n\n    With ThisWorkbook.Sheets(1)\n        For r = .Cells(.Rows.Count, \"G\").End(xlUp).row To 1 Step -1\n            If .Cells(r, \"G\") = .Range(\"C5\") Then\n                If deleteRange Is Nothing Then\n                    Set deleteRange = .Cells(r, \"G\")\n                Else\n                    Set deleteRange = Union(deleteRange, .Cells(r, \"G\"))\n                End If\n            End If\n        Next\n    End With\n\n    If Not deleteRange Is Nothing Then\n        deleteRange.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": -1, "last_activity_date": 1550679007, "creation_date": 1550679007, "answer_id": 54790709, "question_id": 54789668, "link": "https://stackoverflow.com/questions/54789668/delete-rows-sub-very-slow-to-process/54790709#54790709", "title": "Delete rows sub very slow to process", "body": "<p>Hey bob I found that when you work with thousands of rows or hundreds of thousands you may want to try arrays. They are insanely fast to do the same as you would on the sheet</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub DeleteRows()\n\n    Dim arr, arr1, yeartocheck As Integer, yearchecked As Integer, ws As Worksheet, i As Long, j As Long, x As Long\n\n    Set ws = ThisWorkbook.Sheets(\"DataBase\")\n    yeartocheck = ws.Range(\"C5\")\n\n    arr = ws.UsedRange.Value 'the whole sheet allocated on memory\n\n    ReDim arr1(1 To UBound(arr), 1 To UBound(arr, 2)) 'lets define another array as big as the first one\n\n    For i = 1 To UBound(arr1, 2) 'headers for the final array\n        arr1(1, i) = arr(1, i)\n    Next i\n\n    x = 2 'here starts the data on the final array (1 is for the headers)\n\n    For i = 2 To UBound(arr) 'loop the first array looking to match your condition\n        yearchecked = arr(i, 7)\n        If yearchecked &lt;&gt; yeartocheck Then 'if they don't match, the macro will store that row on the final array\n            For j = 1 To UBound(arr, 2)\n                arr1(x, j) = arr(i, j)\n            Next j\n            x = x + 1 'if we store a new row, we need to up the x\n        End If\n    Next i\n\n    With ws\n        .UsedRange.ClearContents 'clear what you have\n        .Range(\"A1\", .Cells(UBound(arr1), UBound(arr, 2))).Value = arr1 'fill the sheet with all the data without the CYear\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11049063, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157095051509382/picture?type=large", "display_name": "Bob Ketting", "link": "https://stackoverflow.com/users/11049063/bob-ketting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1550679007, "creation_date": 1550675972, "question_id": 54789668, "link": "https://stackoverflow.com/questions/54789668/delete-rows-sub-very-slow-to-process", "title": "Delete rows sub very slow to process", "body": "<p>I built a macro in Excel that stores input from multiple input tabs into a database (table format). As part of the macro I included a Sub to delete any previous entries for a given year (CYear) before writing new entries for that year.</p>\n\n<p>This was working fine until the size of the workbook increased to about 10MB. The following part of the code now takes >1 hour to run. Is there any other method which might be faster?</p>\n\n<p>Application.ScreenUpdating = False and Application.Calculation = xlCalculationManual are included as part of the larger Sub, r will approach some thousands of rows.</p>\n\n<pre><code>Dim r As Long\nSheets(\"Database\").Activate\n\nFor r = ActiveSheet.UsedRange.Rows.Count To 1 Step -1\n\n    If Cells(r, \"G\") = Range(\"C5\") Then\n        ActiveSheet.Rows(r).EntireRow.Delete\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550675889, "post_id": 54789597, "comment_id": 96357585, "body": "What&#39;s wrong with just copying data of column <code>Name</code> into <code>Name1</code>? Where is the issue here?"}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550675978, "post_id": 54789597, "comment_id": 96357651, "body": "The problem is that i have tousands of names. Column Name1 may have dulicates, but this is not a problem."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550676023, "post_id": 54789597, "comment_id": 96357680, "body": "you can copy over the whole column from <code>Stefi</code> to <code>Mara</code> at once by just selecting the range, copy it and paste it into the first column"}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550676188, "post_id": 54789597, "comment_id": 96357798, "body": "Yes, but if the order is of the 3 column is different. And the first column (Name 1) has 1000 names, and the column 2 and 3 only 300 because the first column can contain duplicates"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550676365, "post_id": 54789597, "comment_id": 96357917, "body": "Did you try with the <code>Index</code> and <code>Match</code> formulas in combination? they would work to lookup your data."}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550676452, "post_id": 54789597, "comment_id": 96357976, "body": "Yes, something like this but is not working =INDEX($A$31805:$A$32275;MATCH(C2;$C$31805:$C$32275;0);1)"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1550677071, "post_id": 54789877, "comment_id": 96358341, "body": "I get #NAME? Maybe because I have Excel2010?"}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1550677464, "post_id": 54789877, "comment_id": 96358584, "body": "&quot;This formula contains unrecognized text&quot;. It&#39;s identical. If i go by reference: IFNA is underlined"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1550677677, "post_id": 54789877, "comment_id": 96358738, "body": "Meh my bad, <code>IFNA</code> was introduced in Office 2013. See my edit."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1550677645, "last_edit_date": 1550677645, "creation_date": 1550676668, "answer_id": 54789877, "question_id": 54789597, "link": "https://stackoverflow.com/questions/54789597/replace-values-from-a-column-based-on-other-2-columns/54789877#54789877", "title": "Replace values from a column based on other 2 columns", "body": "<p>Use the following combination of <code>INDEX</code> and <code>MATCH</code> to get the result shown in column E <code>Complete</code></p>\n\n<ul>\n<li><p>Office 2013 or later use</p>\n\n<pre><code>=IFNA(INDEX(B:B,MATCH(A:A,C:C,0)),A:A)\n</code></pre></li>\n<li><p>Office 2010 use</p>\n\n<pre><code>=IFERROR(INDEX(B:B,MATCH(A:A,C:C,0)),A:A)\n</code></pre></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/GPf4Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GPf4Z.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54789877, "answer_count": 1, "score": 0, "last_activity_date": 1550677645, "creation_date": 1550675730, "last_edit_date": 1550676393, "question_id": 54789597, "link": "https://stackoverflow.com/questions/54789597/replace-values-from-a-column-based-on-other-2-columns", "title": "Replace values from a column based on other 2 columns", "body": "<p>I have the following table:</p>\n\n<pre><code>Name1    Name   ID\n123      Stefi  123   \nGiorgi   Giorgi 858\n211      Mara   211\nGiorgi   Ana    333\nOtto\nAnna\n</code></pre>\n\n<p>The problem is that on the column Name1 I have both Name and Id and I need to have only the name. Based on the columns Name and Id I have to extract the wrong information from Name1 and replace with the name. Columns \"Name\" and \"Id\" can be seen as a separate table from where to extract information for the first column</p>\n\n<p>At the end, the table should look like this</p>\n\n<pre><code>Name1    Name   ID\nStefi    Stefi  123   \nAna      Ana    333\nGiorgi   Giorgi 858\nMara     Mara   211\nGiorgi   \nOtto\nAnna\n</code></pre>\n\n<p>Any idea how I can fix this problem? Maybe with Index? Thanks! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1550674426, "post_id": 54788934, "comment_id": 96356626, "body": "There is no <code>Background</code> property for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shape\" rel=\"nofollow noreferrer\">Shape</a>, but if you name your shape &quot;Review Start&quot; (and not only text) you should be able to access it with <code>Shapes(&quot;Review Start&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1550674646, "post_id": 54789122, "comment_id": 96356755, "body": "In addition, it&#39;s always good to do this way, then you can look at the locals window also whilst debugging."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1550674999, "post_id": 54789122, "comment_id": 96356975, "body": "Thank you so so much! In addition I&#39;d like to know, how I can change the &quot;Value&quot; / &quot;Caption&quot; of the Button. I don&#39;t see any related properties in the list."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1550675457, "post_id": 54789122, "comment_id": 96357276, "body": "I&#39;ve added to the code above. And remember to use more meaningful procedure and variable names than I have!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 4, "last_activity_date": 1550675639, "last_edit_date": 1550675639, "creation_date": 1550674380, "answer_id": 54789122, "question_id": 54788934, "link": "https://stackoverflow.com/questions/54788934/is-it-possible-to-address-a-shape-with-vba-code/54789122#54789122", "title": "Is it possible to address a shape with VBA code?", "body": "<p>One way is this. Assign a variable to the shape and then you can access its properties and methods easily. I'm not sure there's a way without using RGB.</p>\n\n<p>By declaring the variable as <code>Shape</code> type, Intellisense will show you the properties and methods. Also you can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/use-the-object-browser\" rel=\"nofollow noreferrer\">Object Browser</a> (F2).</p>\n\n<pre><code>Sub x()\n\nDim s As Shape\n\nSet s = ActiveSheet.Shapes(\"Review Start\") 'better to specify a sheet name\n\nWith s\n    .Fill.ForeColor.RGB = RGB(255, 255, 255)\n    .TextFrame.Characters.Font.Color = vbBlack\n    .TextFrame.Characters.Text = \"Fred\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 54789122, "answer_count": 1, "score": 2, "last_activity_date": 1550675639, "creation_date": 1550673846, "last_edit_date": 1550674631, "question_id": 54788934, "link": "https://stackoverflow.com/questions/54788934/is-it-possible-to-address-a-shape-with-vba-code", "title": "Is it possible to address a shape with VBA code?", "body": "<p>I am replacing all my ActiveX controls with Excel shapes, because of this <a href=\"https://stackoverflow.com/questions/1573349/excel-the-incredible-shrinking-and-expanding-controls\">well know problem</a>. Therefore I replaced each ActiveX Button with a rectangular shape assigning a macro to each shape:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pbsxg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pbsxg.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>My question</strong> is if I can address those 'shape buttons' with my vba code. Something simple like <em>change the backgroung color of the \"Review Start\" button</em> should be possible, right?</p>\n\n<p>I'm thinking of something like:</p>\n\n<pre><code>Activesheet.shapes(\"Review Start\").background.colorindex = 1\n</code></pre>\n\n<p>(This code is obviously not working)</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550672758, "post_id": 54788592, "comment_id": 96355543, "body": "Have you tried recording a macro of converting one cell to a hyperlink to itself and then trying to modify the code from there?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550672898, "post_id": 54788592, "comment_id": 96355642, "body": "Although I&#39;m wondering if there is a better event to launch the macro."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550673212, "post_id": 54788592, "comment_id": 96355845, "body": "Can you show the code that you are trying to call?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550674778, "post_id": 54789166, "comment_id": 96356840, "body": "It should enclose the sheet name in apostrophes <code>SubAddress:=&quot;&#39;&quot; &amp; ActiveSheet.Name &amp; &quot;&#39;!&quot; &amp; r.Address(0, 0)</code> just in case the sheet name contains spaces."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1550675108, "last_edit_date": 1550675108, "creation_date": 1550674516, "answer_id": 54789166, "question_id": 54788592, "link": "https://stackoverflow.com/questions/54788592/how-to-populate-cells-in-a-column-with-hyperlinks-to-themselves/54789166#54789166", "title": "How to populate cells in a column with hyperlinks to themselves", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub Macro1()\n\n    Dim AFrange As Range, r As Range, s As String\n\n    Set AFrange = Range(\"AF1:AF\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each r In AFrange\n        ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=\"\", SubAddress:= _\n        ActiveSheet.Name &amp; \"!\" &amp; r.Address(0, 0), TextToDisplay:=\"myself\"\n    Next r\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Based on the comment from <strong><em>P\u1d07\u029c</em></strong>, use this instead:</p>\n\n<pre><code>Sub Macro1()\n\n    Dim AFrange As Range, r As Range, s As String\n\n    Set AFrange = Range(\"AF1:AF\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each r In AFrange\n        ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=\"\", SubAddress:= _\n        \"'\" &amp; ActiveSheet.Name &amp; \"'!\" &amp; r.Address(0, 0), TextToDisplay:=\"myself\"\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1550675021, "creation_date": 1550675021, "answer_id": 54789363, "question_id": 54788592, "link": "https://stackoverflow.com/questions/54788592/how-to-populate-cells-in-a-column-with-hyperlinks-to-themselves/54789363#54789363", "title": "How to populate cells in a column with hyperlinks to themselves", "body": "<p><code>target</code> in your event is of type <code>Hyperlink</code> and has no <code>Range</code> property.  It has a <code>Address</code> and a <code>SubAddress</code>-property - in case a Hyperlink points to a place within the same Workbook, you find the address in <code>target.SubAddress</code> - however, that is a string and not a <code>Range</code>.  </p>\n\n<p>When you set the destination address to the cell itself, you could use <code>ActiveCell.Row</code> to get the row - note that when the address is pointing to a different place, Excel will jump to that place first and executes the code after. </p>\n\n<p>To set the Hyperlinks, use <code>Gary's Student</code> code (I was about to post the same).</p>\n\n<p>Your sentence <em>\"I have later found that functions cannot call other macros and can only return values\"</em> makes no sense to me - you have an event routine that is a <code>Sub</code> (not a <code>Function</code>). Plus you can call any other routine from both a Function or a Sub.</p>\n\n<p>The overall question is if it is not better  to use different Worksheet events like <code>Worksheet_BeforeRightClick</code> or <code>Worksheet_BeforeDoubleClick</code> - there you have a <code>Range</code> as target and no need to blow your worksheet with 60K of Hyperlinks</p>\n"}], "owner": {"reputation": 11, "user_id": 6893569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WLnlRL_aeS0/AAAAAAAAAAI/AAAAAAAAAYE/U1TFDGMblHk/photo.jpg?sz=128", "display_name": "Andrew Whitty", "link": "https://stackoverflow.com/users/6893569/andrew-whitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550675108, "creation_date": 1550672679, "last_edit_date": 1550673114, "question_id": 54788592, "link": "https://stackoverflow.com/questions/54788592/how-to-populate-cells-in-a-column-with-hyperlinks-to-themselves", "title": "How to populate cells in a column with hyperlinks to themselves", "body": "<p>I would like Column AF populated with hyperlinks to themselves up to the last row containing data in column A.</p>\n\n<p>I will then use this link to run the macro that i need and use Target.Cell.Row to get information from this row within the macro.</p>\n\n<p>I have tried to use the code in this answer <a href=\"https://stackoverflow.com/a/33114213/6893569\">https://stackoverflow.com/a/33114213/6893569</a> but i keep getting the error every time i try to run my macro from with this function or call another macro from within it. I have later found that functions cannot call other macros and can only return values.</p>\n\n<p>Any other ideas? I have been looking for over an hour now and trying a different combination of things, including right clicking on the cell, creating hyperlink and using </p>\n\n<p><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)</code> to launch the macro and <code>Target.Range.Row</code> to get the row number of clicked cell. Then only problem is that i need the hyperlinks (Over 60,000 rows worth) to be auto populated and linked to them selves, it would be ridulcous to do this manually and cant see a way to do this automaticaly unless it was pasting the formula hyperlink in but this cant be used to run the macro for some reason.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1550672669, "post_id": 54788490, "comment_id": 96355485, "body": "Do all of the folders in the destination path exist?"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1550672983, "post_id": 54788490, "comment_id": 96355691, "body": "Sorry you are asking for destination path, only one folder is in destination path"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1550672985, "post_id": 54788490, "comment_id": 96355692, "body": "Are you sure the name of the file you want to check ends with the <i>number</i> 566978 ?"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550676053, "post_id": 54788490, "comment_id": 96357713, "body": "there are about many files in the folders and subfolders, I need to find some pdf files starts with the numbers of 6 digit, followed by _PTA, eg 123456_PTA.pdf,123456_AOP.pdf,123456_HUD27011.pdf, i need specifiacaly these there files, but the number may vary every search. but the name after number is that i mentioned above, that the reason i searched by the number."}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550678352, "post_id": 54788490, "comment_id": 96359165, "body": "there are about many files but i need only 3 files starts with the number of 6 digit, eg 123456_PTA.pdf,123456_AOP.pdf,123456_HUD27011.pdf but there are many files with this number but i need only theses there files to copied in destination folder. thankyou for the help"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1550681956, "post_id": 54788490, "comment_id": 96361385, "body": "If there are many files with the number in their file name, then what&#39;s the naming rule for the three files you want? Are they the only ones with an underscore after the number?"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550682685, "post_id": 54788490, "comment_id": 96361798, "body": "Yes there are many files in the same number in different subfolders, among them i only need files eg 123456_PTA.pdf,123456_AOP.pdf,123456_HUD27011.pdf, should be copied to destination folder"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550682744, "post_id": 54788490, "comment_id": 96361826, "body": "these files don&#39;t have same name as they will vary with the name followed by the number"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550676102, "post_id": 54788683, "comment_id": 96357749, "body": "there are about many files in the folders and subfolders, I need to find some pdf files starts with the numbers of 6 digit, followed by _PTA, eg 123456_PTA.pdf,123456_AOP.pdf,123456_HUD27011.pdf, i need specifiacaly these there files, but the number may vary every search. but the name after number is that i mentioned above, that the reason i searched by the number"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550676135, "post_id": 54788683, "comment_id": 96357764, "body": "am searching for pdf files with numbers"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "reply_to_user": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550676987, "post_id": 54788683, "comment_id": 96358288, "body": "@DESA If there&#39;s always max 6 digits in the name of files you&#39;re looking through, you can problably use:   If InStr(1, fsofile, &quot;566978&quot;) &lt;&gt; -1 Then"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "reply_to_user": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550677390, "post_id": 54788683, "comment_id": 96358538, "body": "@DESA I edited my original answer to include the InStr option. Have a look."}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550677568, "post_id": 54788683, "comment_id": 96358658, "body": "I edited the line but it copies all the file available in the subfolders to destination"}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550678246, "post_id": 54788683, "comment_id": 96359110, "body": "there are about many files but i need only 3 files starts with the number of 6 digit, eg 123456_PTA.pdf,123456_AOP.pdf,123456_HUD27011.pdf but there are many files with this number but i need only theses there files to copied in destination folder. thankyou for the help"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "reply_to_user": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550682799, "post_id": 54788683, "comment_id": 96361857, "body": "@DESA Well with the instr-function you could also place the entire name &quot;123456_PTA.pdf&quot; or anywhere in between. How specific you want to be is up to you depending on the probability of false positives."}, {"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550683256, "post_id": 54788683, "comment_id": 96362088, "body": "Yes i mentioned like that the problem is this code copied all available files in the destination path, it not checking for the name"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "reply_to_user": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550766376, "post_id": 54788683, "comment_id": 96400392, "body": "@DESA My bad; The value to compare should be 0 instead of -1. That&#39;s why it&#39;s not checking properly."}], "tags": [], "owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "is_accepted": false, "score": 1, "last_activity_date": 1550766328, "last_edit_date": 1550766328, "creation_date": 1550672996, "answer_id": 54788683, "question_id": 54788490, "link": "https://stackoverflow.com/questions/54788490/search-for-a-file-in-folders-and-sub-folders-using-file-name-if-found-copy-to-an/54788683#54788683", "title": "Search for a file in folders and sub folders using file name if found copy to another folder in vba macros", "body": "<p>You're searching for the number using the Right-function, but this fails to take into account the file-extension that follows it. You could try something like (assuming the extension is the same): </p>\n\n<pre><code>Right(fsofile, 10) = \"566978.txt\" ''change extension to whatever\n</code></pre>\n\n<p>If the file-extensions aren't of the same length, you could determine the position of the dot in the name and use the Mid-function.</p>\n\n<p>Alternatively, you could just check if the numbers you're looking for occur within the filename using, instead of the Right-function:</p>\n\n<pre><code>If InStr(1, fsofile, \"566978\") &lt;&gt; 0 then\n</code></pre>\n\n<p>This should only cause issues if there are files with longer strings of numbers, because for example you could have a file named \"123556978123.pdf\", which would be a false positive.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "edited": false, "score": 0, "creation_date": 1550768049, "post_id": 54812337, "comment_id": 96401376, "body": "But he problem is it is checking only on level of subfolders, can any one tell how to search in all the subfolders, i.e mainfolder-&gt;subfolder-&gt;subfolder like that."}], "tags": [], "owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "is_accepted": false, "score": 0, "last_activity_date": 1550767953, "creation_date": 1550767953, "answer_id": 54812337, "question_id": 54788490, "link": "https://stackoverflow.com/questions/54788490/search-for-a-file-in-folders-and-sub-folders-using-file-name-if-found-copy-to-an/54812337#54812337", "title": "Search for a file in folders and sub folders using file name if found copy to another folder in vba macros", "body": "<p>Here is the answer i found<br>\n  Sub copy_files_from_subfolders()<br>\n        Dim fso As Object\n        Dim fld As Object\n        Dim fsofile As Object\n        Dim fsofol As Object</p>\n\n<pre><code>    sourcepath = \"FINAL CUT\\\"\n    destinationpath = \"Desa\\MECA\\\"\n\n    If Right(sourcepath, 1) &lt;&gt; \"\\\" Then\n    sourcepath = sourcepath &amp; \"\\\"\n    End If\n\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n    Set fld = fso.GetFolder(sourcepath)\n    If fso.FolderExists(fld) Then\n        For Each fsofol In fso.GetFolder(sourcepath).SubFolders\n            For Each fsofile In fsofol.Files\n                If InStr(1, fsofile.Name, 566978 &amp; \"_PTA\") = 1 Then\n            fsofile.Copy destinationpath\n            End If\n            Next\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10729027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d31520e50950b3aa103599bd97d768?s=128&d=identicon&r=PG&f=1", "display_name": "DESA", "link": "https://stackoverflow.com/users/10729027/desa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550767953, "creation_date": 1550672324, "last_edit_date": 1550672457, "question_id": 54788490, "link": "https://stackoverflow.com/questions/54788490/search-for-a-file-in-folders-and-sub-folders-using-file-name-if-found-copy-to-an", "title": "Search for a file in folders and sub folders using file name if found copy to another folder in vba macros", "body": "<p>Search for a file in folders and sub folders using file name if found copy to another folder in vba macros\nThe code shows no error but the file is not copying from the folder, i need to loop through sub folders and find a file.</p>\n\n<pre><code>Sub copy_files_from_subfolders()    \n    Dim fso As Object\n    Dim fld As Object\n    Dim fsofile As Object\n    Dim fsofol As Object\n\n    sourcepath = \"FINAL CUT\\\"\n    destinationpath = \"Desa\\MECA\\\"\n\n    If Right(sourcepath, 1) &lt;&gt; \"\\\" Then\n    sourcepath = sourcepath &amp; \"\\\"\n    End If\n\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n    Set fld = fso.GetFolder(sourcepath)\n    If fso.FolderExists(fld) Then\n        For Each fsofol In fso.GetFolder(sourcepath).SubFolders\n            For Each fsofile In fsofol.Files\n                If Right(fsofile, 6) = 566978 Then\n                fsofile.Copy destinationpath\n            End If\n            Next\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1550672020, "post_id": 54788258, "comment_id": 96355049, "body": "Your VBA-Code had the <code>With theSheet.QueryTables.Add...</code> broken into two lines. To enable the compiler to see this as one statement, you have to put an underscore char <code>_</code> at the end of the line.  However, in your VBS-Code, you have written the statement in one line - remove the underscore"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1550675421, "post_id": 54788258, "comment_id": 96357256, "body": "Also in VBS all of the named enumerations like xlMSDOS / xlDelimited and so on will be undefined and empty unless you either type them out as consts or supply the actual value."}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1550691001, "post_id": 54788258, "comment_id": 96365798, "body": "VBScript only does positional parameters not named ie <code>Connection:=&quot;TEXT</code>"}, {"owner": {"reputation": 1, "user_id": 11090432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8pcL7NuXR2Y/AAAAAAAAAAI/AAAAAAAAA2I/9KzA4boZPKs/photo.jpg?sz=128", "display_name": "Matt Faulkner", "link": "https://stackoverflow.com/users/11090432/matt-faulkner"}, "edited": false, "score": 0, "creation_date": 1550765057, "post_id": 54788258, "comment_id": 96399479, "body": "OK - So it seems like there are more fundamental differences between VBS and VBA that will require changes in the code. OK - I will have to reconsider the approach. Thank you."}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1550815885, "post_id": 54788258, "comment_id": 96417096, "body": "VBScript can be pasted into VBA. VBScript is legal VBA. So you can&#39;t do this in reverse. So no constants from type library (have to type them with keyboard), no named parameters (no one uses them anyway - it is heaps of extra typing) but positional, and no diming variables as anything, just dim them."}], "owner": {"reputation": 1, "user_id": 11090432, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8pcL7NuXR2Y/AAAAAAAAAAI/AAAAAAAAA2I/9KzA4boZPKs/photo.jpg?sz=128", "display_name": "Matt Faulkner", "link": "https://stackoverflow.com/users/11090432/matt-faulkner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550672391, "creation_date": 1550671604, "last_edit_date": 1550672391, "question_id": 54788258, "link": "https://stackoverflow.com/questions/54788258/differences-in-querytables-add-between-vbs-and-macro", "title": "Differences in QueryTables.add between VBS and Macro", "body": "<p>I have a Macro that loads a flat file into the current sheet. It searches a subfolder for a .dat file of the same name as the active sheet and loads in the data. I want to transition this to a vbs script that will loop through all of the sheets in the workbook and import all the data. I cannot use a macro because when the workbook is open and I try to do this, excel runs out of memory. Below is the macro: </p>\n\n<pre><code>Sub LoadData()\nDim xStrPath As String\nDim theSheet As Worksheet\nDim xFile As String\nDim xCount As Long\nDim oneCell As Range\n\n    answer = MsgBox(\"Are you sure you want to reload data? This will remove all existing data.\", vbYesNo + vbQuestion, \"Warning!\")\n    If answer = vbYes Then\n            Set theSheet = Application.ActiveWorkbook.ActiveSheet\n            theSheet.Rows(5 &amp; \":\" &amp; theSheet.Rows.Count).Delete\n            xStrPath = Application.ActiveWorkbook.Path\n            Application.ScreenUpdating = False\n            xFile = xStrPath &amp; \"\\Old_Data\\\" &amp; theSheet.Name &amp; \".dat\"\n                With theSheet.QueryTables.Add(Connection:=\"TEXT;\" _\n                  &amp; xStrPath &amp; \"\\Old_Data\\\" &amp; theSheet.Name &amp; \".dat\", Destination:=theSheet.Range(\"A5\"))\n                    .Name = \"a\" &amp; xCount\n                    .FieldNames = True\n                    .RowNumbers = False\n                    .FillAdjacentFormulas = False\n                    .PreserveFormatting = True\n                    .RefreshOnFileOpen = False\n                    .RefreshStyle = xlInsertDeleteCells\n                    .SavePassword = False\n                    .SaveData = True\n                    .AdjustColumnWidth = True\n                    .RefreshPeriod = 0\n                    .TextFilePromptOnRefresh = False\n                    .TextFilePlatform = xlMSDOS\n                    .TextFileStartRow = 1\n                    .TextFileParseType = xlDelimited\n                    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n                    .TextFileConsecutiveDelimiter = False\n                    .TextFileTabDelimiter = False\n                    .TextFileSemicolonDelimiter = False\n                    .TextFileCommaDelimiter = False\n                    .TextFileSpaceDelimiter = False\n                    .TextFileOtherDelimiter = \",\"\n                    .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)\n                    .TextFileTrailingMinusNumbers = True\n                    .Refresh BackgroundQuery:=False\n                End With\n\n                For Each oneColumn In theSheet.UsedRange.Columns\n                    With oneColumn\n                        .ColumnWidth = 40\n                    End With\n                Next oneColumn\n    Else\n    'do nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>And below is the VBScript I tried to run:</p>\n\n<pre><code>    Dim xStrPath\nDim theSheet\nDim xFile\nDim xCount\nDim oneCell\nDim theFile\nDim WshShell\n\nSet WshShell = CreateObject(\"WScript.Shell\")\nSet xStrPath = WshShell.CurrentDirectory\nSet theFile = GetObject(xStrPath &amp; \"\\Base_Tables_Template.xlsm\")\n\nFor Each theSheet In theFile\n\n    'Set theSheet = Application.ActiveWorkbook.ActiveSheet\n    theSheet.Rows(5 &amp; \":\" &amp; theSheet.Rows.Count).Delete\n    xFile = xStrPath &amp; \"\\Old_Data\\\" &amp; theSheet.Name &amp; \".dat\"\n        With theSheet.QueryTables.Add(Connection:=\"TEXT;\" _ &amp; xStrPath &amp; \"\\Old_Data\\\" &amp; theSheet.Name &amp; \".dat\", Destination:=theSheet.Range(\"A5\"))\n            .Name = \"a\" &amp; xCount\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = xlMSDOS\n            .TextFileStartRow = 1\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = False\n            .TextFileTabDelimiter = False\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileOtherDelimiter = \",\"\n            .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\n\n        For Each oneColumn In theSheet.UsedRange.Columns\n            With oneColumn\n                .ColumnWidth = 40\n            End With\n        Next oneColumn\nNext theSheet\n</code></pre>\n\n<p>The VBScript is giving me an expected ')' error on line 18 char 49:</p>\n\n<p><img src=\"https://i.stack.imgur.com/AFrB4.png\" alt=\"Error\"></p>\n\n<p>This line is </p>\n\n<pre><code>With theSheet.QueryTables.Add(Connection:=\"TEXT;\" _ &amp; xStrPath &amp; \"\\Old_Data\\\" &amp; theSheet.Name &amp; \".dat\", Destination:=theSheet.Range(\"A5\"))\n</code></pre>\n\n<p>This should be behaving the same as the macro. Why would the code expect a parenthesis when the macro executes just fine?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1550683469, "last_edit_date": 1550683469, "creation_date": 1550673770, "answer_id": 54788916, "question_id": 54788103, "link": "https://stackoverflow.com/questions/54788103/outlook-warning-if-email-has-been-sent-before-this-month/54788916#54788916", "title": "Outlook - warning if email has been sent before this month", "body": "<p>You can iterate through all of your sent emails in <code>\"Sent Items\"</code> box and check using <code>InStr()</code> and <code>DateDiff()</code> functions for the content and date since sending each.</p>\n\n<pre><code>Public Sub Application_ItemSend(ByVal thisItem As Object, Cancel As Boolean)\n\n    Dim ns As Outlook.NameSpace\n    Dim folder As MAPIFolder\n    Dim Item As Object\n\n    Set ns = Session.Application.GetNamespace(\"MAPI\")\n    ' set folder to Sent Items box\n    Set folder = ns.GetDefaultFolder(olFolderInbox).Parent.Folders(\"Sent Items\")\n\n    ' iterate thru emails\n    For Each Item In folder.Items\n        ' check subject content &amp; date difference\n        If InStr(Item.subject, \"your string here\") And DateDiff(\"m\", Item.SentOn, Now) &lt; 1 Then\n            ' added this part\n            If MsgBox(\"You have already sent this email this month, do you want to send again?\", vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Message Text Warning\") = vbNo Then\n                ' cancel the email\n                Cancel = True\n            End If\n            Exit For      \n        End If    \n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Also, here is how I have done this before with shared inboxes in my situation:</p>\n\n<pre><code>Set olApp = CreateObject(\"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet firstFolder = olNs.Folders(\"UAT-COE Support Intake Box\") ' name of my shared inbox\nSet olFolder = firstFolder.Folders(\"Inbox\")\n</code></pre>\n\n<p>You may have to do the same, but change <code>\"UAT-COE Support...\"</code> with your shared inbox name. Also will need to change <code>\"Inbox\"</code> with <code>\"Sent Items\"</code> or <code>\"Sent\"</code>.</p>\n\n<p>Once you have <code>olFolder</code> set to the correct Sent box, you can replace it with folder in the above code <code>For each Item in olFolder.Items</code></p>\n"}], "owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54788916, "answer_count": 1, "score": 0, "last_activity_date": 1592691493, "creation_date": 1550671093, "last_edit_date": 1592691493, "question_id": 54788103, "link": "https://stackoverflow.com/questions/54788103/outlook-warning-if-email-has-been-sent-before-this-month", "title": "Outlook - warning if email has been sent before this month", "body": "<p>Is there a way to set up a code so when I send an email from a template to someone (often if I'm contacted with the same over and over again) it automatically checks if I already sent it to them within the last month.</p>\n\n<p>Right now I have made a warning system for myself, that shows a message box when I send the email:</p>\n\n<pre><code>Public Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    On Error Resume Next\n    If InStr(Item.Body, \"A string in my template email\") Then\n        If MsgBox(\"Have you sent this already this month?\", vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Message Text Warning\") = vbNo Then\n            Cancel = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>The downside is that I manually have to check whether or not I already sent it to the specific receiver.\nIs it possible to make it in a way so it sends it if i haven't sent it within the last month and warns me if I already sent it out within the last month? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1550672241, "post_id": 54788010, "comment_id": 96355209, "body": "Are you sure the URL is correct?"}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1550672578, "post_id": 54788010, "comment_id": 96355426, "body": "Yes, because I importet with that URL the XML file in the second table"}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "is_accepted": true, "score": 0, "last_activity_date": 1550672979, "creation_date": 1550672979, "answer_id": 54788680, "question_id": 54788010, "link": "https://stackoverflow.com/questions/54788010/why-does-the-importxml-method-leads-to-a-runtime-error-9/54788680#54788680", "title": "Why does the ImportXML Method leads to a runtime error 9?", "body": "<p>I needed to set the * in the link.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row = [Namensfilter].Row And Target.Column = [Namensfilter].Column Then\n        Dim Displayname As String: Displayname = [Namensfilter].Value\n        Dim Map As XmlMap\n        Set Map = ActiveWorkbook.XmlMaps(1)\n        Dim urlXML As String\n        urlXML = \"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname &amp; \"*\"\n        Map.DataBinding.LoadSettings urlXML\n        Map.DataBinding.Refresh\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 54788680, "answer_count": 1, "score": 0, "last_activity_date": 1550672979, "creation_date": 1550670833, "last_edit_date": 1550672507, "question_id": 54788010, "link": "https://stackoverflow.com/questions/54788010/why-does-the-importxml-method-leads-to-a-runtime-error-9", "title": "Why does the ImportXML Method leads to a runtime error 9?", "body": "<p>The Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row = [Namensfilter].Row And Target.Column = [Namensfilter].Column Then\n        Dim Displayname As String: Displayname = [Namensfilter].Value + \"*\"\n        Dim Map As XmlMap\n        Set Map = ActiveWorkbook.XmlMaps(1)\n        Dim urlXML As String\n        urlXML = \"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname &amp; \"\"\n        ThisWorkbook.XmlMaps(Map).ImportXml urlXML\n        Map.DataBinding.Refresh\n    End If\nEnd Sub\n</code></pre>\n\n<p>I want to make a XML-Parse in an other table, but when I import the XML-file I get a runtime error 9. When I change the </p>\n\n<pre><code>urlXML = \"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname &amp; \"\"\n    ThisWorkbook.XmlMaps(Map).ImportXml urlXML\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Map.DataBinding.LoadSettings \"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname &amp; \"\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Map.DataBinding.LoadSettings (\"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname &amp; \"\")\n</code></pre>\n\n<p>I get a really strange error, which I also found <a href=\"https://stackoverflow.com/questions/19201881/strange-xml-map-run-time-error-with-excel-vba\">here</a>.\nHow can I provide the runtime error 9?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1550670771, "post_id": 54787894, "comment_id": 96354252, "body": "<code>sheets(&quot;name&quot;)</code> not <code>sheet</code>"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 1, "creation_date": 1550670777, "post_id": 54787894, "comment_id": 96354256, "body": "try with Sheets(&quot;MigrationReport&quot;)..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550670796, "post_id": 54787894, "comment_id": 96354270, "body": "And take the extra <code>.</code> out before <code>QueryTables</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1550671096, "creation_date": 1550671096, "answer_id": 54788104, "question_id": 54787894, "link": "https://stackoverflow.com/questions/54787894/run-vba-on-specific-sheet/54788104#54788104", "title": "Run VBA on specific sheet", "body": "<p>Did you try:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"MigrationReport\")\n    With .QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; GetFile, Destination:=Range( _\n        \"$A$2\"))\n        .Name = \"logexportdata\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 2\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(5, 2, 2, 2, 2, 2, 9, 9, 9, 9, 9)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 10519, "user_id": 1738522, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3a080f83adb29fdb018bdf2e69205fca?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/1738522/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 54788104, "answer_count": 1, "score": 0, "last_activity_date": 1550671096, "creation_date": 1550670511, "question_id": 54787894, "link": "https://stackoverflow.com/questions/54787894/run-vba-on-specific-sheet", "title": "Run VBA on specific sheet", "body": "<p>I have some excel code that works but only runs on active sheet. I want to specify exactly the sheet to input the data on. Here is the code:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; GetFile, Destination:=Range( _\n    \"$A$2\"))\n    .Name = \"logexportdata\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 2\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(5, 2, 2, 2, 2, 2, 9, 9, 9, 9, 9)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I tried changing the top line to this: With \n    Sheet(\"MigrationReport\")..QueryTables.Add(Connection:= _</p>\n\n<p>So its not just active sheet, I can run it on a specific sheet. But that gives me a compile error. How do I replace active sheet with the sheet name?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1550675304, "post_id": 54787820, "comment_id": 96357169, "body": "Can you be more specific about what isn&#39;t working? The code looks OK, what problem are you experiencing?"}, {"owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1550675527, "post_id": 54787820, "comment_id": 96357332, "body": "Ah sorry I should have been more specific - currently no rows are being hidden, even when they should be. I&#39;ve set up an example where the columns where it checks for 0&#39;s have plenty present, but for some reason the rows aren&#39;t being hidden."}, {"owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1550675750, "post_id": 54787820, "comment_id": 96357482, "body": "I&#39;m also having an issue where everything is being hidden when checking ColumnTwo, even though there are plenty of cells with values greater than 0."}, {"owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1550676442, "post_id": 54787820, "comment_id": 96357968, "body": "I&#39;m pretty sure the issue is with the check itself, as even when D47:D61 is empty it is still working inside that first if statement. Maybe it&#39;s not referencing the worksheets as I originally wanted? D47:D61 is on ws2, but the check for the 1&#39;s and 0&#39;s (and the row hiding itself) happens on ws1."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 1, "creation_date": 1550680484, "post_id": 54787820, "comment_id": 96360455, "body": "Where does lastColumn get assigned a value (3rd line down)? Add a breakpoint (<a href=\"https://www.wiseowl.co.uk/blog/s196/breakpoints.htm\" rel=\"nofollow noreferrer\">wiseowl.co.uk/blog/s196/breakpoints.htm</a> ) on the 4th line - what is the value of lastRow when you hover your mouse over it? Also if the 2nd part of the IF statement is supposed to check sheet 2 you can&#39;t use .Cells, you need to add the sheet e.g. ws2.Cells"}, {"owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1550680923, "post_id": 54787820, "comment_id": 96360729, "body": "This is just a section of a larger function, the values of lastColumn/lastRow were correct but the check was not working properly. It was checking D47:D61 on ws1, not ws2 as it should have. I&#39;ll add a response to this question separately with what appears to be the answer."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "is_accepted": false, "score": 0, "last_activity_date": 1550681068, "creation_date": 1550681068, "answer_id": 54791391, "question_id": 54787820, "link": "https://stackoverflow.com/questions/54787820/workaround-for-filtering-for-multiple-wildcard-criteria/54791391#54791391", "title": "Workaround for filtering for multiple wildcard criteria", "body": "<p>The code below seems to be working now:</p>\n\n<pre><code>With ws1\n\n    ColumnTwo = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    LastRow = .Cells(.Rows.Count, lastColumn).End(xlUp).Row\n\n    ColumnOne = ColumnTwo - 1\n\n\n    With ws2\n    Set aDataRange = ws2.Range(\"D47:D61\")\n    Set pDataRange = ws2.Range(\"E47:E61\")\n        If Application.WorksheetFunction.CountA(aDataRange) &lt;&gt; 0 Then\n            MsgBox (\"ColumnOne\")\n            With ws1\n                For i = 1 To LastRow\n                    If .Cells(i, ColumnOne).Value = 0 Then\n                        .Rows(i).EntireRow.Hidden = True\n                    End If\n\n                Next i\n            End With\n\n        ElseIf Application.WorksheetFunction.CountA(pDataRange) &lt;&gt; 0 Then\n            MsgBox (\"ColumnTwo\")\n            With ws1\n                For i = 1 To LastRow\n                    If .Cells(i, ColumnTwo).Value = 0 Then\n                        .Rows(i).EntireRow.Hidden = True\n                    End If\n\n                Next i\n            End With\n        Else\n            Exit Sub\n        End If\n    End With\nEnd With\n</code></pre>\n\n<p>Why do I need to define the range areas for D47:D61/E47:E61 on ws2 separately? Why would \"ws2.Application.WorksheetFunction.CountA(\"Range\")\" not apply to the range on ws2, even if this was contained in a \"With ws2\"? </p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "edited": false, "score": 0, "creation_date": 1550684219, "post_id": 54792062, "comment_id": 96362567, "body": "Yeah declaring the range separately seemed to be the issue, I have a modified version of my original code in an answer that I posted earlier this morning. Just a note though I did have all of the variables declared,I just posted a section of the code here since it&#39;s a part of a larger function. If it&#39;s necessary I&#39;ll be sure to include that in future posts as to not cause confusion though."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1550683399, "creation_date": 1550683399, "answer_id": 54792062, "question_id": 54787820, "link": "https://stackoverflow.com/questions/54787820/workaround-for-filtering-for-multiple-wildcard-criteria/54792062#54792062", "title": "Workaround for filtering for multiple wildcard criteria", "body": "<p>I modified your code to ensure all variables are declared.</p>\n\n<pre><code>Sub HideRows()\n'Ensure you declare all your variables\nDim ws1 As Worksheet, ws2 As Worksheet, lRow As Long\nDim ColumnOne As Integer, ColumnTwo As Integer\nDim dRng As Range, eRng As Range\nDim dRngCnt As Long, eRngCnt As Long\n\n'Assign worksheets and variables\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n\n'Identifying the specific range as variable\nSet dRng = ws2.Range(\"D2:D9\")\nSet eRng = ws2.Range(\"E2:E9\")\n\n'Assigning a variable to the countA will simplify your IF and ELSEIF statements\ndRngCnt = Application.WorksheetFunction.CountA(dRng)\neRngCnt = Application.WorksheetFunction.CountA(eRng)\n\n    With ws1\n        ColumnOne = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        'I replaced \"lastColumn\" with \"ColumnOne\", because they are the same value, so you only need to use one\n        lRow = .Cells(.Rows.Count, ColumnOne).End(xlUp).Row\n        ColumnTwo = ColumnOne - 1\n\n        If dRngCnt &lt;&gt; 0 Then 'I use the countA variable for column D Range\n            For i = 1 To lRow\n                If .Cells(i, ColumnTwo).Value = 0 Then 'Any 0s in the second to last columns will hide the row\n                    .Rows(i).EntireRow.Hidden = True\n                End If\n            Next i\n\n        ElseIf eRngCnt &lt;&gt; 0 Then 'I use the countA variable for column E Range\n            For i = 1 To lRow\n                If .Cells(i, ColumnOne).Value = 0 Then\n                    .Rows(i).EntireRow.Hidden = True\n                End If\n\n            Next i\n        Else\n            Exit Sub\n\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10119854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kk7Ogbopt2U/AAAAAAAAAAI/AAAAAAAAAx0/BQq6B7Mkb2U/photo.jpg?sz=128", "display_name": "Valkeif", "link": "https://stackoverflow.com/users/10119854/valkeif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54792062, "answer_count": 2, "score": 0, "last_activity_date": 1550683399, "creation_date": 1550670330, "last_edit_date": 1550676729, "question_id": 54787820, "link": "https://stackoverflow.com/questions/54787820/workaround-for-filtering-for-multiple-wildcard-criteria", "title": "Workaround for filtering for multiple wildcard criteria", "body": "<p>I saw a few different solutions for getting around the 2 wildcard limit for filters in excel (specifically the answer posted <a href=\"http://stackoverflow.com/questions/16602872/set-auto-filtering-multiple-wildcards/34822944#34822944\">here</a>, but I had a hard time understanding what they were doing. The work around I am trying to implement is to just count the number of instances of each criteria in a cell using a basic countif formula, and if it's 0 then the macro will hide the row. </p>\n\n<pre><code>With ws1\n\n    ColumnOne = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    LastRow = .Cells(.Rows.Count, lastColumn).End(xlUp).Row\n\n    ColumnTwo = ColumnOne - 1\n\n\n\n    If ws2.Application.WorksheetFunction.CountA(\"D47:D61\") &lt;&gt; 0 Then\n\n        For i = 1 To LastRow\n            If .Cells(i, ColumnTwo).Value = 0 Then\n                .Rows(i).EntireRow.Hidden = True\n            End If\n\n        Next i\n\n    ElseIf ws2.Application.WorksheetFunction.CountA(\"E47:E61\") &lt;&gt; 0 Then\n\n        For i = 1 To LastRow\n            If .Cells(i, ColumnOne).Value = 0 Then\n                .Rows(i).EntireRow.Hidden = True\n            End If\n\n        Next i\n    Else\n        Exit Sub\n    End If\nEnd With\n</code></pre>\n\n<p>The above code is what I'm using to deal with this. For reference, there are two columns of criteria on a separate worksheet (ws2) that can change/be entirely empty. The code above then checks to see which of these columns it should work with (D on ws2 uses ColumnTwo on ws1, E on ws2 uses ColumnOne on ws1) by seeing which one isn't empty, then begins checking the column on ws1 row by row to see if any of the criteria are present. If none of the criteria are present (cell value = 0) then it should hide that row. </p>\n\n<p>The check to use either D or E does not seem to be working. Even when all of the cells in D47:D61 on ws2 are empty it is still operating within that if statement instead of moving to E47:E61. Any ideas as to what I should try and change here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11090202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Muc0PEbEveg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiJpFTEv8OMi7dR43Em3p7pbQrHA/mo/photo.jpg?sz=128", "display_name": "Nicole", "link": "https://stackoverflow.com/users/11090202/nicole"}, "edited": false, "score": 0, "creation_date": 1550671289, "post_id": 54787615, "comment_id": 96354573, "body": "Is there a way i could do this without a range? I have to calculate 11 columns and I was wondering if there was a way to do it w/o having to do it for column A,B,C,D etc individually."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 11, "user_id": 11090202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Muc0PEbEveg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiJpFTEv8OMi7dR43Em3p7pbQrHA/mo/photo.jpg?sz=128", "display_name": "Nicole", "link": "https://stackoverflow.com/users/11090202/nicole"}, "edited": false, "score": 0, "creation_date": 1550679145, "post_id": 54787615, "comment_id": 96359671, "body": "From your code I&#39;m not entirely sure what your ranges would be but you&#39;d just build them up in your code so you&#39;re not doing them &#39;individually&#39;"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1550669755, "creation_date": 1550669755, "answer_id": 54787615, "question_id": 54787573, "link": "https://stackoverflow.com/questions/54787573/taking-the-mode-of-a-column-vba/54787615#54787615", "title": "Taking the mode of a column VBA", "body": "<p>You need to pass a <code>Range</code> object to the function not a value e.g.</p>\n\n<pre><code>WorksheetFunction.Mode_Sngl(Range(\"A1:A100\"))\n</code></pre>\n\n<p>In your code you are currently passing the value of a cell by the looks of it and not a <code>Range</code></p>\n"}], "owner": {"reputation": 11, "user_id": 11090202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Muc0PEbEveg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiJpFTEv8OMi7dR43Em3p7pbQrHA/mo/photo.jpg?sz=128", "display_name": "Nicole", "link": "https://stackoverflow.com/users/11090202/nicole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550672544, "creation_date": 1550669625, "last_edit_date": 1550672544, "question_id": 54787573, "link": "https://stackoverflow.com/questions/54787573/taking-the-mode-of-a-column-vba", "title": "Taking the mode of a column VBA", "body": "<p>I am new to VBA and am looking for a way to flag values in a column. I have a spreadsheet with 11 columns and 210 rows(each column would have a different mode) and want to highlight the numbers that do not match the mode for each column.</p>\n\n<p>This is what I have now:</p>\n\n<pre><code>For n = 1 To 11\n\n    Dim x As Variant\n    Dim y As Variant\n\n    x = Sheets(\"Sheet3\").Cells(2, n).Value\n    y = Sheets(\"Sheet3\").Cells(211, n).Value\n\n    With Range(Cells(2, n), Cells(211, n)).FormatConditions.Add(xlCellValue, xlNotEqual, WorksheetFunction.Mode(Range(x, y).Value))\n        With .Font\n            .Bold = True\n            ColorIndex = 3\n        End With\n    End With\n\nNext n\n</code></pre>\n\n<p>I am getting an error: </p>\n\n<blockquote>\n  <p>Run-time error '1004': Method 'Range' of object '_Global' failed</p>\n</blockquote>\n\n<p>before I was getting an error on <code>worksheetfunction.mode</code> being undefined. </p>\n"}, {"tags": ["excel", "vba", "windows"], "comments": [{"owner": {"reputation": 1573, "user_id": 6038796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tUBN.png?s=128&g=1", "display_name": "DaggeJ", "link": "https://stackoverflow.com/users/6038796/daggej"}, "edited": false, "score": 2, "creation_date": 1550669370, "post_id": 54787367, "comment_id": 96353336, "body": "Try recording a Macro and edit the resulting code."}, {"owner": {"reputation": 1, "user_id": 11090134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809058d01c304bf3b29b7b469bf6b9ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Watzech", "link": "https://stackoverflow.com/users/11090134/yuri-watzech"}, "reply_to_user": {"reputation": 1573, "user_id": 6038796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tUBN.png?s=128&g=1", "display_name": "DaggeJ", "link": "https://stackoverflow.com/users/6038796/daggej"}, "edited": false, "score": 0, "creation_date": 1550670611, "post_id": 54787367, "comment_id": 96354153, "body": "Ive tryed recording it, but i got problems to detect different cells as Ive mentined (An &lt;&gt;An + 1 ) =/"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1550778985, "creation_date": 1550778985, "answer_id": 54815241, "question_id": 54787367, "link": "https://stackoverflow.com/questions/54787367/copy-columns-to-new-workbook/54815241#54815241", "title": "Copy Columns to new Workbook", "body": "<p>This code should get you in the right direction. Comments are added to the code.</p>\n\n<pre><code>Sub CpyColstoNewWB()\nDim x As Long, i As Long\nDim wb As Workbook\n\nSet wb = Workbooks.Add 'Create new workbook\n\nThisWorkbook.Activate 'Reset the focus\n\n    With Sheets(\"Sheet1\")\n    c = 1 'set the col # in the new workbook sheet1\n        For x = 4 To 6 'used to loop through col #s\n            i = 1 'sets the initial row to start from\n                Do Until Cells(i, x) &lt;&gt; .Cells(i + 1, x) 'test the current cell to the cell below it\n                        i = i + 1 'if the condition is not met, will loop to the next row\n                Loop\n\n            'If the condition is met, will accomplish the below line of code and then start on the next col\n            .Range(.Cells(1, x), .Cells(i, x)).Copy wb.Sheets(\"Sheet1\").Cells(2, c)\n\n            c = c + 1 'adds 1 to the col # to move to the next col\n        Next x 'go to the next col\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11090134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809058d01c304bf3b29b7b469bf6b9ea?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Watzech", "link": "https://stackoverflow.com/users/11090134/yuri-watzech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550778985, "creation_date": 1550668906, "last_edit_date": 1550685773, "question_id": 54787367, "link": "https://stackoverflow.com/questions/54787367/copy-columns-to-new-workbook", "title": "Copy Columns to new Workbook", "body": "<p>I'm trying to code in VBA a system that basically copies columns and paste in another workbook, but I got some particularities.</p>\n\n<p>I will try to explain the logical about how the system must work:</p>\n\n<pre><code>Select A2 Cell\n\nSelect Column A to Cell An #&lt;*different*&gt;# from An+1\n-example      A\n        A1   hey\n        A2   hey\n        A3   hey\n        A4   hey\n        A5   ho\n            So it would select till line 4.\n\nSelect all info from Column \"D\" from Cell \"D2\" to \"Dn\"\n\nCopy\n\nOpen a new workbook\n\nPaste into cell \"A2\" (New Workbook)\n\nSelect all info from Column \"E\" from Cell \"E2\" to \"En\" (First Workbook)\n\nCopy\n\nPaste into cell \"B2\" (New Workbook)\n\nSelect all info from Column \"F\" from Cell \"F2\" to \"Fn\" (First Workbook)\n\nCopy\n\nPaste into cell \"C2\" (New Workbook)\n\nSelect all info from Column \"G\" from Cell \"G2\" to \"Gn\" (First Workbook)\n\nCopy\n\nPaste into cell \"D2\" (New Workbook)\n\nSelect all info from Column \"H\" from Cell \"H2\" to \"Hn\" (First Workbook)\n\nCopy\n\nPaste into cell \"F2\" (New Workbook)\n\nSelect all info from Column \"I\" from Cell \"I2\" to \"In\" (First Workbook)\n\nCopy\n\nPaste into cell \"G2\" (New Workbook)\n\nSave and close the \"New Workbook\"\n\nRepeat the process analyzing from An+1 to the next different Cell.\n</code></pre>\n\n<p>The <code>copy</code> columns will not start in <code>Cell2</code>, it will start in <code>Celln+1</code> instead and so on...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1632, "user_id": 6072648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ2RW.jpg?s=128&g=1", "display_name": "Kerry Jackson", "link": "https://stackoverflow.com/users/6072648/kerry-jackson"}, "edited": false, "score": 0, "creation_date": 1550669305, "post_id": 54786723, "comment_id": 96353288, "body": "If you manually try to copy text from Outlook message header is paste values an option?  If not, then it is probably not an option through code either."}, {"owner": {"reputation": 13, "user_id": 10059733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zgxn1ajvmkU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pOa1pd4UC3IRAoNMM6O3ZLgA0fMw/mo/photo.jpg?sz=128", "display_name": "Adam Kwasny", "link": "https://stackoverflow.com/users/10059733/adam-kwasny"}, "reply_to_user": {"reputation": 1632, "user_id": 6072648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ2RW.jpg?s=128&g=1", "display_name": "Kerry Jackson", "link": "https://stackoverflow.com/users/6072648/kerry-jackson"}, "edited": false, "score": 0, "creation_date": 1550750902, "post_id": 54786723, "comment_id": 96389716, "body": "@KerryJackson No, there is not. There is only paste as text option. Your comment inspire me to modify code and it looks like it works now. Thank you :)"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1550751653, "post_id": 54786723, "comment_id": 96390240, "body": "What is your &quot;selection&quot;? ie  have you a range selected before pasting?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10059733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zgxn1ajvmkU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pOa1pd4UC3IRAoNMM6O3ZLgA0fMw/mo/photo.jpg?sz=128", "display_name": "Adam Kwasny", "link": "https://stackoverflow.com/users/10059733/adam-kwasny"}, "edited": false, "score": 0, "creation_date": 1550751166, "post_id": 54787729, "comment_id": 96389878, "body": "thanks for your answer but I would rather not to use any additional references. I found solution to my problem."}], "tags": [], "owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550670087, "creation_date": 1550670087, "answer_id": 54787729, "question_id": 54786723, "link": "https://stackoverflow.com/questions/54786723/pastespecial-from-outlook-message/54787729#54787729", "title": "PasteSpecial from Outlook message", "body": "<p>If you want better control of the data in the clipboard you could use the code below. You could for instance use this tot test if the header is retrievable as text at all.</p>\n\n<p>You will need to turn on \"MS Forms 2.0 Object Library\" in the VBA references to use the DataObject.</p>\n\n<pre><code>Dim DataObj As MSForms.DataObject, ClipStr as string\n\n    Set DataObj = New MsForms.DataObject 'dataobject with ability to retrieve data from clipboard\n\n    DataObj.GetFromClipboard ''Gets data from clipboard\n    ClipStr = DataObj.GetText(1) ''Get content from dataobj\n\n    msgbox ClipStr\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1550751773, "post_id": 54806884, "comment_id": 96390313, "body": "yes basically what I asked in the comments. Your first attempt fails because you do selection.pastespecial, and you dont have any selection. On the second attempt (err.number&gt;0), you just paste it in the activesheet, so it falls where your cursor was last time, and that works"}], "tags": [], "owner": {"reputation": 13, "user_id": 10059733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zgxn1ajvmkU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pOa1pd4UC3IRAoNMM6O3ZLgA0fMw/mo/photo.jpg?sz=128", "display_name": "Adam Kwasny", "link": "https://stackoverflow.com/users/10059733/adam-kwasny"}, "is_accepted": true, "score": 1, "last_activity_date": 1550751452, "creation_date": 1550751452, "answer_id": 54806884, "question_id": 54786723, "link": "https://stackoverflow.com/questions/54786723/pastespecial-from-outlook-message/54806884#54806884", "title": "PasteSpecial from Outlook message", "body": "<p>I found solution to my problem. There is code:</p>\n\n<pre><code>Sub Paste_As_Value()\nOn Error Resume Next\nSelection.PasteSpecial Paste:=xlPasteValues\nIf Err.Number &gt; 0 Then\n    ActiveSheet.PasteSpecial Format:=\"Tekst Unicode\", Link:=False, _\n        DisplayAsIcon:=False, NoHTMLFormatting:=True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10059733, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zgxn1ajvmkU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pOa1pd4UC3IRAoNMM6O3ZLgA0fMw/mo/photo.jpg?sz=128", "display_name": "Adam Kwasny", "link": "https://stackoverflow.com/users/10059733/adam-kwasny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 54806884, "answer_count": 2, "score": 0, "last_activity_date": 1550751452, "creation_date": 1550666789, "last_edit_date": 1550672552, "question_id": 54786723, "link": "https://stackoverflow.com/questions/54786723/pastespecial-from-outlook-message", "title": "PasteSpecial from Outlook message", "body": "<p>I have macro which pastes values and is assigned to <code>ctrl+v</code>. It works fine to all, except text that is copied from outlook message header. There is a</p>\n\n<blockquote>\n  <p>Run-time error 1004 \"Method 'PasteSpecial' of object 'Range' failed\". </p>\n</blockquote>\n\n<p>Does anyone know why? And how fix it?</p>\n\n<p>I've spent a lot of time to search answer in web but with no result.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub Paste_As_Value()\nSelection.PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 4, "creation_date": 1550666601, "post_id": 54786451, "comment_id": 96351686, "body": "I&#39;m very sorry to tell you that this site is not a free code writing service. Without posting what code you have tried and where you are stuck, we cannot help. --- Read this carefully: Edit your question and provide your code. Do not post that in a comment. Post a comment when you have edited your question."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550675133, "post_id": 54786451, "comment_id": 96357063, "body": "As per comment above. Also, please use the snippet tool via <a href=\"https://stackoverflow.com/posts/54786451/edit\">edit</a> to insert html; Don&#39;t paste as image."}, {"owner": {"reputation": 1, "user_id": 11089970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4c5cfb1b5ebbaab739237f1b51e61b?s=128&d=identicon&r=PG&f=1", "display_name": "Kishore", "link": "https://stackoverflow.com/users/11089970/kishore"}, "edited": false, "score": 0, "creation_date": 1550767424, "post_id": 54786451, "comment_id": 96401013, "body": "Hi Teylyn, Thanks for your response. I have edited my comments as per your instruction. Kindly look into my issue and help me"}], "owner": {"reputation": 1, "user_id": 11089970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4c5cfb1b5ebbaab739237f1b51e61b?s=128&d=identicon&r=PG&f=1", "display_name": "Kishore", "link": "https://stackoverflow.com/users/11089970/kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550767342, "creation_date": 1550665841, "last_edit_date": 1550767342, "question_id": 54786451, "link": "https://stackoverflow.com/questions/54786451/web-automation-stuck-with-drop-down-selection", "title": "Web automation Stuck with drop down selection", "body": "<p><a href=\"https://i.stack.imgur.com/O7xTc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O7xTc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm new to web automation and got stuck at the drop-down selection from the list. Hereby attached source code for reference and help me with the piece of code. Thanks for your help in advance...</p>\n\n<p>I want to select PO Number from the list.</p>\n\n<p>I tried these coding but no luck</p>\n\n<p>tried to select directly.\nie.document.getElementsByClassName(\"twitter-typeahead\").GetElementsByTagNam(\"span\")(0).GetElementsByTagNam(\"pre\").innerText = \"PO NUMBER\"\nie.document.getElementsByClassName(\"tt-suggestion-1-2 tt-suggestion tt-selectable\").Click</p>\n\n<p>ie.document.getElementsByClassName(\"typeahead\")(0).getElementsByClassName(\"tt-input\").Click</p>\n\n<p>Tried to click the dropdown button and then select \"PO number\" from the list\n ie.document.getElementsByTagName(\"svg\").getElementsByClassName(\"dropdown-icon\").getElementsByClassName(\"icon \").Click</p>\n\n<p>when i inspect element it goes to input class=\"tt-input\" reference. Kindly help me</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1550670451, "post_id": 54785892, "comment_id": 96354046, "body": "Please explain what is going wrong.  Does this code give an error?  Does the code appear to work but &quot;the&quot; is not highlighted?  Something else?"}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1550671042, "post_id": 54785892, "comment_id": 96354421, "body": "The code does not give an error. The code appears to be fine but when testing it &quot;the&quot; is not highlighted."}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551440163, "post_id": 54785892, "comment_id": 96650284, "body": "@TonyDallimore the code works great on non-categorized mails. However, the highlighter does not work when there are categorisation rules in the mail. Even though the script rule is on top of the Rules and Alerts function. Could additions be made to the code to make sure the script runs first regardless and then the categorisation rules?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551451465, "post_id": 54785892, "comment_id": 96656627, "body": "One of the options on the &quot;Step1: Select action(s)&quot; window of the Rules wizard is &quot;Stop processing more rules&quot;.  This is the only way I know of limiting the number of rules against which a message is checked.  Could you have this option checked on some of your rules?"}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551453671, "post_id": 54785892, "comment_id": 96657863, "body": "Yes that&#39;s possible. Thanks a lot for your help!"}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551780478, "post_id": 54785892, "comment_id": 96755919, "body": "The code was working well until yesterday as Outlook has slowed down with emails slow to load. Could it be possible that the code is causing Outlook to slow down @TonyDallimore? In order to allow the code to work Notifications for all macros has been enabled so when Outlook is opened up after closing, a notification comes up to enables/disable macros on ThisOutlook Session. A rule was set up to run the code when specific words where in the subject or body."}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551780901, "post_id": 54785892, "comment_id": 96756187, "body": "The updated (current code) has been added above to the original question."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551789940, "post_id": 54785892, "comment_id": 96761518, "body": "I would expect this routine to be slow if it has to process many emails and if it finds many words to highlight. Every time you replace a word with a highlighted word, the VBA interpreter has to find a new block of memory to hold the longer string, move the amended string into that block and release the old block for garbage collection. Every time, the interpreter runs out of free memory, it calls the garbage collector to rearrange its memory so all the released memory is together and available for allocation. Most Html bodies are large so the garbage collector could be called frequently."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551790115, "post_id": 54785892, "comment_id": 96761613, "body": "Since you say the routine has slowed, VBA garbage collection may not be the problem. I suspect a similar issue is occurring with the Outlook store. I do not know how Outlook manages its stores or its memory, but every time you save an amended body, it must face the same problem as the VBA interpreter. Since, Outlook has a Compact routine to be called by the user, I suspect, Outlook does not garbage collect until told to do so by the user. ..."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551790160, "post_id": 54785892, "comment_id": 96761639, "body": "Each run of the macro will have a different number of emails of differing complexity to process so it will be difficult to be sure if it has had an effect but I would try compacting the store holding these emails."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551791199, "post_id": 54785892, "comment_id": 96762259, "body": "I have not timed these two approaches so I cannot be sure if my suggestion will speed things up but it believe it would.  You are looping looking for \u201ctoday\u201d.  For each \u201ctoday\u201d found, your code builds a new string.  A better approach might be to <code>Split</code> the original body by \u201ctoday\u201d and then <code>Join</code> the parts with the \u201chighlighted today\u201d.  This removes the loop and makes the interpreter do most of the work which should save a lot of temporary strings.  I suggest you create a test routine to time these two approaches."}, {"owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551797400, "post_id": 54785892, "comment_id": 96766105, "body": "The Outlook seemed to slow down after the weekend and as you were saying it could be slow if it has to process many emails. It seemed to slow down when the enable macros was selected to run the highlighter when the Outlook was opened after the weekend. I think it may be due to backlog of emails to be processed by highlighter code. Would this be plausible? I will try the Split and Join functions. I am not sure how those functions work. Do I insert; Dim Array as string and x=split(&quot;today&quot;, &quot;tomorrow&quot;) before For x part of code and then after Next x, put x =Join(&quot;today, &quot;tomorrow&quot;)?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551798286, "post_id": 54785892, "comment_id": 96766678, "body": "Having more emails to process on a Monday seems a very plausible reasons for Outlook to open more slowly.  I have had a better look at your code and I no longer think using Split and Join would help."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1550676052, "creation_date": 1550676052, "answer_id": 54789694, "question_id": 54785892, "link": "https://stackoverflow.com/questions/54785892/running-a-script-on-outlook-as-a-word-highlighter/54789694#54789694", "title": "Running a script on Outlook as a Word Highlighter", "body": "<p>Your macro does nothing because the parameter is <code>MyMail</code> but the macro amends the body of <code>objItem</code>.</p>\n\n<p>Delete <code>Dim objItem As Outlook.MailItem</code></p>\n\n<p>Replace <code>objItem</code> by <code>MyMail</code> in:</p>\n\n<pre><code>strHTMLBody = objMail.HTMLBody\nobjMail.HTMLBody = strHTMLBody\nobjMail.Save\n</code></pre>\n\n<p>I assume you have no <code>Option Explicit</code> at the top of your module.  This is good practice because it makes this type of error more difficult to commit.  I get a compile time error with your code.</p>\n\n<p>I assume \"the\" is an substitute for the real word you wish to highlight. If the real word is obscure then there should be no problem.  However, if the string \"the\" is part of a URL or similar, this code will mess up the email.</p>\n\n<p>I did not use a rule to test your code.  I selected an old email I was happy to corrupt and ran this code:</p>\n\n<pre><code>Sub TestHighlight()\n\n  Dim Exp As Explorer\n  Dim ItemCrnt As MailItem\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"Please select one or more emails then try again\", vbOKOnly)\n    Exit Sub\n  Else\n    For Each ItemCrnt In Exp.Selection\n      Call Highlight_AllOccurencesOfSpecificWords(ItemCrnt)\n    Next\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>I recommend this technique which I use to test almost all my Outlook macros.</p>\n"}], "owner": {"reputation": 3, "user_id": 11089823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b7286c3ff298444e3e07f8c0e61134?s=128&d=identicon&r=PG&f=1", "display_name": "Learn", "link": "https://stackoverflow.com/users/11089823/learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54789694, "answer_count": 1, "score": 0, "last_activity_date": 1592691510, "creation_date": 1550663962, "last_edit_date": 1592691510, "question_id": 54785892, "link": "https://stackoverflow.com/questions/54785892/running-a-script-on-outlook-as-a-word-highlighter", "title": "Running a script on Outlook as a Word Highlighter", "body": "<p>Aim is to run a script on Outlook only when a specific rule is met, e.g. when the word \"the\" appears, a script will be run on that email which highlights all occurrences of the word \"the\". Have been attempting the code but do not know where I am going wrong. The code appears to be ready to use but when applied the word specified is not highlighted. A rule identifies a specific word e.g. \"the\" and then the script will highlight this word where applicable in the email identified. The script ideally only activates when a rule identifies this specified word. Any help would be great, thanks. </p>\n\n<pre><code>Sub Highlight_AllOccurencesOfSpecificWords(MyMail As Outlook.MailItem)\n\n    Dim strWord As String\n    Dim strHTMLBody As String\n    Dim ns As Outlook.NameSpace\n    Dim moveToFolder As Outlook.MAPIFolder\n    Dim objItem As Outlook.MailItem\n\n\n    strHTMLBody = objMail.HTMLBody\n    Set ns = Application.GetNamespace(\"MAPI\")\n\n    'Change the word as per your wishes\n    strWord = \"the\"\n    If InStr(strHTMLBody, strWord) &gt; 0 Then\n    strHTMLBody = Replace(strHTMLBody, strWord, \"&lt;font style=\" &amp; Chr(34) &amp; \"background-color: yellow\" &amp; Chr(34) &amp; \"&gt;\" &amp; strWord &amp; \"&lt;/font&gt;\")\n    objMail.HTMLBody = strHTMLBody\n    End If\n\n    objMail.Save\n\nEnd Sub \n\nUpdated Code:\nOption Compare Text\nSub Highlight_AllOccurencesOfSpecificWords(MyMail As Outlook.MailItem)\n\n    Dim strWord As String\n    Dim strHTMLBody As String\n    Dim ns As Outlook.NameSpace\n    Dim moveToFolder As Outlook.MAPIFolder\n    Dim myArray As Variant\n    Dim x As Long\n\n    strHTMLBody = MyMail.HTMLBody\n    Set ns = Application.GetNamespace(\"MAPI\")\n    'Words can be added/removed below in the brackets after Array in (\" \"), words can be typed within quotation marks\n myArray = Array(\"today\", \"tomorrow\")\n\nFor x = LBound(myArray) To UBound(myArray)\n    If InStr(strHTMLBody, myArray(x)) &gt; 0 Then\n    strHTMLBody = Replace(strHTMLBody, myArray(x), \"&lt;font style=\" &amp; Chr(34) &amp; \"background-color: turquoise\" &amp; Chr(34) &amp; \"&gt;\" &amp; myArray(x) &amp; \"&lt;/font&gt;\")\n    MyMail.HTMLBody = strHTMLBody\n    End If\nNext x\n    MyMail.Save\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550663774, "post_id": 54785629, "comment_id": 96349871, "body": "What line has the error? Also -- what is <code>&amp; * &quot;&quot;</code> supposed to do? That <code>*</code> looks out of place. Is that supposed to be <code>&amp; &quot;*&quot;</code>? If so, this question is just a typo and should be closed as such."}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550663943, "post_id": 54785629, "comment_id": 96349976, "body": "The Eror happens on the first Line. The &amp; * &quot;&quot; is the search filter, which should work."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1550664041, "post_id": 54785629, "comment_id": 96350032, "body": "That <code>*</code> is occurring outside of a string literal, but you are trying to concatenate it to a string. That shouldn&#39;t work."}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550664363, "post_id": 54785629, "comment_id": 96350217, "body": "I used a tutorial for it and there it worked. <a href=\"https://www.youtube.com/watch?v=6H7tBL97orE\" rel=\"nofollow noreferrer\">youtube.com/watch?v=6H7tBL97orE</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550664483, "post_id": 54785629, "comment_id": 96350315, "body": "<code>xmlmaps</code> will work (I deleted that comment) -- but the <code>*</code> used outside of the string literal like that won&#39;t."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550664636, "post_id": 54785629, "comment_id": 96350437, "body": "Also -- what is <code>Name</code>? Is this a named range in your worksheet?"}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550664697, "post_id": 54785629, "comment_id": 96350479, "body": "But even when I delete the * it doesn&#39;t work, because the error is in line 1 at Private Sub Worksheet_Change(ByVal Target As Range)"}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550664776, "post_id": 54785629, "comment_id": 96350536, "body": "Yes, Name is a named range in my worksheet"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1550665118, "post_id": 54785629, "comment_id": 96350773, "body": "<i>Where</i> is this code living? If it is in the worksheet code module (where it should be) then [Name] wouldn&#39;t be a valid qualifier. Just create a range variable and set it equal to that named range. Your line with <code>&amp; *</code> had two typos: the <code>*</code> outside of <code>&quot;&quot;</code> but also the lack of space before <code>&amp;</code> in <code>Displayname&amp; </code> I suspect that you needed that line to end <code>Displayname &amp; &quot;*&quot;</code>"}, {"owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1550665633, "post_id": 54785629, "comment_id": 96351091, "body": "Ok, now I fixed that, I couldn&#39;t use Name as you said. But now I have a new Problem. I get at the Dim Map As XmlMap a runtime error 13."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1550665901, "post_id": 54785629, "comment_id": 96351253, "body": "You are trying to set an <code>XmlMap</code> to an <code>XmlMaps</code> -- note the difference. The second is a collection type for the first."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1550667174, "post_id": 54785629, "comment_id": 96352017, "body": "This has become a different question. Perhaps post it as such. A Stack Overflow question shouldn&#39;t be an open thread that keeps mutating as you move through the debugging process."}], "owner": {"reputation": 361, "user_id": 10875110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PuLofI0yHK0/AAAAAAAAAAI/AAAAAAAALOg/upyt6OvyKcI/photo.jpg?sz=128", "display_name": "Gion Rubitschung", "link": "https://stackoverflow.com/users/10875110/gion-rubitschung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550665268, "creation_date": 1550663173, "last_edit_date": 1550665268, "question_id": 54785629, "link": "https://stackoverflow.com/questions/54785629/my-private-sub-in-excel-vba-gets-en-error-when-i-run-it", "title": "My Private Sub in excel-vba gets en error, when I run it", "body": "<p>I have two Tables. One of the Tables is linked to a XML-file. The other Table is here for searching data. The code in the Private Sub should work correctly, but when I want to run it, I get an Error.</p>\n\n<p>Error while compiling:</p>\n\n<p>Invalid identifier</p>\n\n<p>The XML-Map is linked to that XML-File: <a href=\"http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" rel=\"nofollow noreferrer\">http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=</a>*</p>\n\n<p>The Private Sub:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row = [Name].Row And Target.Column = [Name].Column Then\n        Dim Displayname As String: Displayname = [Name].Value\n        Dim Map As XmlMap\n        Set Map = ActiveWorkbook.XmlMaps\n        Map.DataBinding.LoadSettings \"=http://direx.corproot.net/DirExWeb/Scripts/Public/GetXML.aspx?displayname=\" &amp; Displayname&amp; * \"\"\n        Map.DataBinding.Refresh\n    End If\nEnd Sub\n</code></pre>\n\n<p>How can I prevent the error, so that the Sub gets executet?</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1550877486, "post_id": 54816775, "comment_id": 96447704, "body": "Note: you can&#39;t apply formatting within the ProjectBeforeTaskChange event. You are better off starting with a manually-run macro as linked to above. Once you have that running as you like, you can experiment with calling it from the Project_Change event, although likely you would not want to run that at every change in the project. Unfortunately, Project does not have a ProjectAfterTaskChange event. Alternatively, you can tie formatting to the Marked field which is a yes/no field and might work for you (search for Gantt text formatting)."}], "tags": [], "owner": {"reputation": 311, "user_id": 6845666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7121d86d37fa1c7568d6d2ce07d30b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jerred S.", "link": "https://stackoverflow.com/users/6845666/jerred-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1550785860, "creation_date": 1550785860, "answer_id": 54816775, "question_id": 54784135, "link": "https://stackoverflow.com/questions/54784135/run-macro-triggered-by-dropdown-in-ms-project/54816775#54816775", "title": "Run macro triggered by dropdown in MS Project", "body": "<p>Start by listening for a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.application.projectbeforetaskchange\" rel=\"nofollow noreferrer\"><code>Application.ProjectBeforeTaskChange</code></a> event. When your custom field is changed, then you can tweak the format of your task; this may be helpful: <a href=\"https://superuser.com/questions/1117019/ms-project-change-text-color-in-row-based-on-status-field\">https://superuser.com/questions/1117019/ms-project-change-text-color-in-row-based-on-status-field</a></p>\n\n<p>It can be tricky manipulating the cells of the task table based on the task ID, especially if you use subprojects; another helpful reference is: <a href=\"https://stackoverflow.com/questions/44655957/how-to-selectrow-of-a-task-in-sub-project-inside-a-master-project\">How to SelectRow of a Task in Sub-Project (inside a Master-Project)</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7445712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0ec44867b5941e8dfdd01ece9e8ae3?s=128&d=identicon&r=PG&f=1", "display_name": "P. Udge", "link": "https://stackoverflow.com/users/7445712/p-udge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593558028, "creation_date": 1550658639, "last_edit_date": 1593558028, "question_id": 54784135, "link": "https://stackoverflow.com/questions/54784135/run-macro-triggered-by-dropdown-in-ms-project", "title": "Run macro triggered by dropdown in MS Project", "body": "<p>how can I run a macro (formats some cells of a task) <strong>in MS Project</strong> by changing the value of a specific cell via a dropdown menu?</p>\n\n<p>E.g. I want to change the font color to green, if I choose \"done\" from a custom field entry that uses a lookup with the possible entries \"open\"; \"done\".</p>\n\n<p>thank you very much!\nBest,\nAF</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550658279, "post_id": 54783950, "comment_id": 96346458, "body": "Can you show the code you&#39;ve started with please."}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550658805, "post_id": 54783950, "comment_id": 96346827, "body": "This is what I have. Problem is its coping the formula and doing destination - copied cells Option Explicit Public dTime As Date  Sub ValueStore() Dim nr As Long  With Worksheets(&quot;Sheet1&quot;)  .Range(&quot;B1:B98&quot;).Copy  .Range(&quot;C1:C98&quot;).PasteSpecial _   Operation:=xlPasteSpecialOperationSubtract End With          Call StartTimer End Sub   Sub StartTimer()     dTime = Now + TimeValue(&quot;00:05:00&quot;)     Application.OnTime dTime, &quot;ValueStore&quot;, Schedule:=True End Sub  Sub StopTimer()     On Error Resume Next     Application.OnTime dTime, &quot;ValueStore&quot;, Schedule:=False End Sub"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550659020, "post_id": 54783950, "comment_id": 96346986, "body": "So what is the issue here?"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550659192, "post_id": 54783950, "comment_id": 96347088, "body": "It&#39;s copying the formula which is =sheet! O9 instead of value and that keeps updating. Also subtraction is happening destination cells - copied cells giving a negative value which keeps adding up. I need the difference in value every 5 minutes. Here after 5 minutes destination is same as copied cells."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550659567, "post_id": 54783950, "comment_id": 96347335, "body": "Recorded in 5min intervals, or just overwritten with the delta?"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550660996, "post_id": 54783950, "comment_id": 96348249, "body": "It is adding the values if i keep it as Range (&quot;C1:C98&quot;).Value = .Range(&quot;B1:B98).Value"}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1550661562, "post_id": 54783950, "comment_id": 96348633, "body": "I do not recommend copy and paste in vba, but in this case to copy the value and subtract you can use: <code>Range(&quot;C1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:=False, Transpose:=False</code>"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550663663, "post_id": 54783950, "comment_id": 96349817, "body": "Getting a compile error with this, sorry i am a novice   <a href=\"https://drive.google.com/open?id=1VTnVWe5rZoEVDY7zAIrdb6VpuiGZ8HUe\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1VTnVWe5rZoEVDY7zAIrdb6VpuiGZ8HUe</a>"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550663847, "post_id": 54783950, "comment_id": 96349918, "body": "Ok i got this to work but same problem. destination cells - copied cells. i need it the other way around . Copied cells - destination cells"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550660172, "post_id": 54784458, "comment_id": 96347701, "body": "I actually need the difference in values every 5 minutes. So if it cos the values and subtracts copied cells value -  destination cells value then I have a solution"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550660326, "post_id": 54784458, "comment_id": 96347804, "body": "@Kevin So <code>.Range(&quot;C1:C98&quot;).Value = .Range(&quot;B1:B98&quot;).Value - .Range(&quot;C1:C98&quot;).Value</code> ?"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550660851, "post_id": 54784458, "comment_id": 96348152, "body": "Tried this and get an error when i start timer &quot;Runtime error &quot;13&quot; type mismatch                                                                                                        Sub ValueStore() Dim nr As Long  With Worksheets(&quot;Sheet1&quot;)      .Range(&quot;C2:C98&quot;).Value = .Range(&quot;B2:B98&quot;).Value - .Range(&quot;C2:C98&quot;).Value End With"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 1, "creation_date": 1550661166, "post_id": 54784458, "comment_id": 96348373, "body": "Do you understand what the code does, that I posted? Because I don&#39;t actually understand which number you want to subtract from which number, @Kevin The error stems from there not being a number in Column C"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550661493, "post_id": 54784458, "comment_id": 96348590, "body": "ok let make all 0 and try it . in the morning when we start its empty."}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550661509, "post_id": 54784458, "comment_id": 96348599, "body": "ok let make all 0 and try it . in the morning when we start its empty."}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550661799, "post_id": 54784458, "comment_id": 96348775, "body": "Still the same error . Using this                                                                                       .Range(&quot;C2:C98&quot;).Value = .Range(&quot;B2:B98&quot;).Value - .Range(&quot;C2:C98&quot;).Value  have put in 1 in c1:c98 Sorry i am not a programmer but i do understand what your code is doing ."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550662298, "post_id": 54784458, "comment_id": 96349058, "body": "@Kevin I edited my answer, check if this works for your case. I still don&#39;t understand which numbers you want to subtract though"}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 1, "creation_date": 1550662712, "post_id": 54784458, "comment_id": 96349268, "body": "@Nacorid Your edit should work, but it would be worth adding a check on each loop to see if the destination cell contains a number value before proceeding, if there is no number then you can add a warning message box / skip that loop. This will prevent any errors."}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550663178, "post_id": 54784458, "comment_id": 96349551, "body": "See thes pics of the vb script and sheet <a href=\"https://drive.google.com/open?id=1R3RMSzMgZ_gcATAjxQqeAshbQyeqtUQb\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1R3RMSzMgZ_gcATAjxQqeAshbQyeqtUQb</a> and <a href=\"https://drive.google.com/open?id=1SqbdeJSkQzXHYGIAU8ChvvGVNoZHLH6U\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1SqbdeJSkQzXHYGIAU8ChvvGVNoZHLH6U</a>"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1550664374, "post_id": 54784458, "comment_id": 96350222, "body": "You are of course absolutely right @5202456 , added it to my answer"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550664561, "post_id": 54784458, "comment_id": 96350364, "body": "@Kevin it is still unclear which numbers you want to subtract"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550665060, "post_id": 54784458, "comment_id": 96350732, "body": "@Nacroid Column B has streaming numerical data which keeps on increasing. Starts from 0 in the morning .I want to capture the diffirence for every 5 minutes in column C . What i am basically trying to do is capture the number of trades done in a stock every 5 minutes. So basically 5 minutes into the morning it would be in 1000 and end the day in millions or billions."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550665689, "post_id": 54784458, "comment_id": 96351131, "body": "@Kevin So you only want the last 5 minutes of trades in column C? My revised code should do what you want"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550666011, "post_id": 54784458, "comment_id": 96351327, "body": "Here is the file .  <a href=\"https://drive.google.com/open?id=1E-U69ppsiFAnH1TvNOaa0HXA348qPXqx\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1E-U69ppsiFAnH1TvNOaa0HXA348qPXqx</a>"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550666411, "post_id": 54784458, "comment_id": 96351564, "body": "The code is tested and works for me. Are you sure you implemented it correctly, @Kevin ?"}, {"owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "edited": false, "score": 0, "creation_date": 1550670793, "post_id": 54784458, "comment_id": 96354268, "body": "@Nacroid Thanks a ton i got it to work . Mistake i did was i = 1 to 98 changed that to 2 to 98 as first row had text headers."}], "tags": [], "owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "is_accepted": false, "score": 1, "last_activity_date": 1550665721, "last_edit_date": 1550665721, "creation_date": 1550659566, "answer_id": 54784458, "question_id": 54783950, "link": "https://stackoverflow.com/questions/54783950/capture-difference-in-streaming-data-every-5-mins/54784458#54784458", "title": "Capture difference in streaming data every 5 mins", "body": "<p>If I understand you correctly you have a formula in Column B which updates all the time and you want a \"snapshot\" of the values every 5 minutes.</p>\n\n<p>To do that you can simply use <code>range(destinationRange).Value = range(sourceRange).Value</code></p>\n\n<p>To do a calculation a simple loop will do the trick:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\nDim i as Long\n     For i = 1 to 98\n         If IsNumeric(.Cells(i,3).Value) then\n            .Cells(i,3).Value = .Cells(i,2).Value - .Cells(i,3).Value\n         Else\n            .Cells(i,3).Value = .Cells(i,2).Value\n         End If\n     Next\nEnd With\n</code></pre>\n\n<p>Instead of copying the range.</p>\n"}], "owner": {"reputation": 1, "user_id": 11089329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca5fadf88cf39b0c60eccbb86346f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11089329/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551794774, "creation_date": 1550658078, "last_edit_date": 1550658935, "question_id": 54783950, "link": "https://stackoverflow.com/questions/54783950/capture-difference-in-streaming-data-every-5-mins", "title": "Capture difference in streaming data every 5 mins", "body": "<p>I have a streaming sheet which recieves all the data. Made another sheet called Workarea where that data is copied using =Streaming! B1and so on. Now I need one entire column value difference every 5 minutes. The value keeps increasing and starts with 0 every morning. Will want to add another sheet 5mins and get the difference there. Total cells are 98  B1:B98.\nI did try the xlspecialpaste command but it subtracts destination from copied cells and gives the value as negative. Also copies the formula so data keeps changing as per original streaming data. \nThanks</p>\n\n<p>This is what I have. </p>\n\n<pre><code>Option Explicit \nPublic dTime As Date \n\nSub ValueStore() \nDim nr As Long \nWith Worksheets(\"Sheet1\") \n.Range(\"B1:B98\").Copy \n.Range(\"C1:C98\").PasteSpecial _ Operation:=xlPasteSpecialOperationSubtract \nEnd With \n\nCall StartTimer \n\nEnd Sub \n\nSub StartTimer() \ndTime = Now + TimeValue(\"00:05:00\") \nApplication.OnTime dTime, \"ValueStore\", Schedule:=True \nEnd Sub \n\nSub StopTimer() \nOn Error Resume Next \nApplication.OnTime dTime, \"ValueStore\", Schedule:=False \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1550658020, "post_id": 54783857, "comment_id": 96346274, "body": "You are setting a string to the cell, and I assume the cell format is &quot;General&quot;, in which case Excel is free to parse the value. Set the cells format to Date and store an actual date, not a string. If you are adamant you want to store dates as strings and in certain format (which you should not be), change cell format to &quot;Text&quot;."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1550658436, "post_id": 54783857, "comment_id": 96346566, "body": "Try using <code>Dateserial</code> instead, and the <code>month</code> <code>year</code> <code>day</code> functions available"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1550658995, "post_id": 54783857, "comment_id": 96346972, "body": "Could you please share what do you have and what do you want to have please?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1550661602, "post_id": 54783857, "comment_id": 96348661, "body": "What is actually in <code>wbRecFile.Sheets(1).Range(&quot;c2&quot;)</code>? Is it a real date or a string?  How did it get there?  If it is a <code>real date</code>, if you change the format to <code>General</code> you should see a 5 digit number.  What is that number?"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550659937, "last_edit_date": 1550659937, "creation_date": 1550658464, "answer_id": 54784071, "question_id": 54783857, "link": "https://stackoverflow.com/questions/54783857/uk-date-converting-to-us-date/54784071#54784071", "title": "UK Date converting to US date", "body": "<p>Getting the datevalue from the cell usually works for me: </p>\n\n<pre><code>Dim mydate As Date\nDim ws As Variant\n\nmydate = DateValue(wbRecFile.Sheets(1).Range(\"c2\").value )\n\nwbRecFile.Activate\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    With ws\n        lastrow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n    End With\n\nws.Range(\"C1:C\" &amp; lastrow).value = mydate\n\nNext ws\n</code></pre>\n\n<p>Edit: applied my changes to the original code.</p>\n"}, {"tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 1, "last_activity_date": 1550659091, "creation_date": 1550659091, "answer_id": 54784304, "question_id": 54783857, "link": "https://stackoverflow.com/questions/54783857/uk-date-converting-to-us-date/54784304#54784304", "title": "UK Date converting to US date", "body": "<p>You're approaching this the wrong way. Excel stores dates as a numerical value that's independent from its display format, and if you try to sidestep this by storing dates as a string then you break the ability to perform calculations with those dates.</p>\n\n<p>If you want to format a range as <code>dd/mm/yyyy</code>, set its <code>NumberFormat</code> to <code>\"dd\\/mm\\/yyyy\"</code> (if you omit the backslashes, you'll see hyphens instead of slashes). However, you'd be better off using the default date format which displays dates according to the user's system settings, since this will be the preferred format of whoever's interacting with your workbook.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1550659572, "creation_date": 1550659572, "answer_id": 54784461, "question_id": 54783857, "link": "https://stackoverflow.com/questions/54783857/uk-date-converting-to-us-date/54784461#54784461", "title": "UK Date converting to US date", "body": "<p>In my opinion the best approach is to convert the date in text and split it:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Day As String, Month As String, Year As String\n    Dim USFormat As String, UKFormat As String\n\n    USFormat = \"2019/02/20\"\n\n    Day = Right(USFormat, 2)\n    Month = Mid(USFormat, 6, 2)\n    Year = Left(USFormat, 4)\n\n    UKFormat = Day &amp; \"/\" &amp; Month &amp; \"/\" &amp; Year\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1550659977, "creation_date": 1550659977, "answer_id": 54784578, "question_id": 54783857, "link": "https://stackoverflow.com/questions/54783857/uk-date-converting-to-us-date/54784578#54784578", "title": "UK Date converting to US date", "body": "<p>Something like so, I've used in the past.  Prefer not to use any variable names that are close to key words, and use the dateserial.  Simlar in approach to @error 1004's</p>\n\n<pre><code>Function US_TO_UK(dtInput As Variant, Optional strDelim As String = \"/\") As Date\n\nDim aSegements() As String\n\naSegements = Split(dtInput, strDelim)\n\nUS_TO_UK = DateSerial(aSegements(0), aSegements(1), aSegements(2))\n\nErase aSegements\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1550662432, "creation_date": 1550657808, "last_edit_date": 1550662432, "question_id": 54783857, "link": "https://stackoverflow.com/questions/54783857/uk-date-converting-to-us-date", "title": "UK Date converting to US date", "body": "<p>I have a recurring issue where when a date is copied across worksheets it is converted from UK format to US format.  I created the below code which I am retrieving the D/M/Y and placing it into a string in the hope it would hardcode the correct date. However this is still converting into a US date. </p>\n\n<p>Any help in ensuring the UK format date is held would be much appreciated. </p>\n\n<pre><code>Dim mydate As Date\nDim sDay As String\nDim sMonth As String\nDim sYear As String\nDim sYesterdayDate As String\nDim ws As Variant\n\nmydate = wbRecFile.Sheets(1).Range(\"c2\").value **Date in C2 = 07/02/2019\nsDay = Format(mydate, \"DD\")\nsMonth = Format(mydate, \"MM\")\nsYear = Format(mydate, \"YYYY\")\n\nsYesterdayDate = sDay &amp; \"/\" &amp; sMonth &amp; \"/\" &amp; sYear\n\nwbRecFile.Activate\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    With ws\n    lastrow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n    End With\n\nws.Range(\"C1:C\" &amp; lastrow).value = sYesterdayDate\n\nNext ws\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550658665, "post_id": 54783744, "comment_id": 96346728, "body": "Have you done any debugging?  LIke setting the element to an object, see if it&#39;s got the element to click etc?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550659938, "post_id": 54783744, "comment_id": 96347561, "body": "What is happening? Is there an URL? Please provide more of your code and also use the snippet tool via <a href=\"https://stackoverflow.com/posts/54783744/edit\">edit</a> to insert html, not an image."}, {"owner": {"reputation": 3, "user_id": 8738256, "user_type": "registered", "profile_image": "https://graph.facebook.com/1394244930625252/picture?type=large", "display_name": "Akshay Kumar", "link": "https://stackoverflow.com/users/8738256/akshay-kumar"}, "edited": false, "score": 0, "creation_date": 1550660843, "post_id": 54783744, "comment_id": 96348143, "body": "Nathan_Sav : I Am new to VBA, Can you be more specific?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550662402, "post_id": 54783744, "comment_id": 96349117, "body": "you could try adding a readystate check to IE <code>Do While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE     DoEvents Wend</code>   Can you post the URL?"}], "answers": [{"comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1550664052, "post_id": 54785449, "comment_id": 96350037, "body": "May use <code>loop</code> instead of  <code>wend</code>. Also should add <code>Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)</code>  visible etc"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3, "user_id": 8738256, "user_type": "registered", "profile_image": "https://graph.facebook.com/1394244930625252/picture?type=large", "display_name": "Akshay Kumar", "link": "https://stackoverflow.com/users/8738256/akshay-kumar"}, "edited": false, "score": 0, "creation_date": 1550664573, "post_id": 54785449, "comment_id": 96350376, "body": "@AkshayKumar altered code.  You should take these as helping not definite solutions as no one can see your web page nor the data.  Correcting the while error should have been easy for you to do."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1550664486, "last_edit_date": 1550664486, "creation_date": 1550662670, "answer_id": 54785449, "question_id": 54783744, "link": "https://stackoverflow.com/questions/54783744/click-on-the-radio-button-in-a-web-page-with-vba-problem-on-and-off-has-the-s/54785449#54785449", "title": "Click on the radio button in a web page with vba ( Problem: ON and OFF has the same name)", "body": "<p>Not an answer, support to comment.</p>\n\n<p>In relation to debugging, I'd do something like this.  Properly naming elements etc, using <code>Microsoft html object library</code> and <code>Microsoft internet controls</code> references.</p>\n\n<pre><code>Sub x()\n\nDim ie As InternetExplorer\nDim c As HTMLInputElement\nDim c2 As HTMLElementCollection\n\nset ie=new InternetExplorer\n\nie.navigate \"URL\"\n\nWhile ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\nSet c = ie.document.getElementsByName(\"statusToSet\")(0)\nSet c2 = ie.document.getElementsByName(\"statusToSet\")\n\nEnd Sub\n</code></pre>\n\n<p>There are 2 ways there, to get a single element or a collection of elements with that name (<a href=\"https://www.w3schools.com/jsref/met_doc_getelementsbyname.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/jsref/met_doc_getelementsbyname.asp</a>)   This will enable me to see if the input element is being received via the array(0) option (c) and the collection option (c2)</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550678267, "last_edit_date": 1550678267, "creation_date": 1550670029, "answer_id": 54787701, "question_id": 54783744, "link": "https://stackoverflow.com/questions/54783744/click-on-the-radio-button-in-a-web-page-with-vba-problem-on-and-off-has-the-s/54787701#54787701", "title": "Click on the radio button in a web page with vba ( Problem: ON and OFF has the same name)", "body": "<p>You can try </p>\n\n<pre><code>ie.document.querySelector(\"[name=statusToSet]\").checked  = True\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ie.document.querySelector(\"[name=statusToSet]\").click\n</code></pre>\n\n<p>Though you want a check for the second version that it is not currently checked.</p>\n\n<p>And use a proper wait before as already mentioned.</p>\n\n<pre><code>While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents :Wend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8738256, "user_type": "registered", "profile_image": "https://graph.facebook.com/1394244930625252/picture?type=large", "display_name": "Akshay Kumar", "link": "https://stackoverflow.com/users/8738256/akshay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550678267, "creation_date": 1550657436, "last_edit_date": 1550665550, "question_id": 54783744, "link": "https://stackoverflow.com/questions/54783744/click-on-the-radio-button-in-a-web-page-with-vba-problem-on-and-off-has-the-s", "title": "Click on the radio button in a web page with vba ( Problem: ON and OFF has the same name)", "body": "<p>I want to click on the radio button OFF with VBA\nTrying this:</p>\n\n<pre><code>IE.document.getElementByName(\"statusToSet\").Item(1).Checked = True\n</code></pre>\n\n<p>But isn't helping.</p>\n\n<p>Can you please provide with a solution? </p>\n\n<pre><code>&lt;label class=\"a-form-label\"&gt;Turn FC Inbound check\n&lt;div class=\"a-radio a-radio-fancy\" data-a-input-name=\"statusToSet\"&gt;\n&lt;label&gt;\n&lt;input name=\"statusToSet\" type=\"radio\" checked=\"checked\" value=\"INBOUND\"&gt;\n&lt;i class=\"a-icon a-icon-radio\"&gt;&lt;/i&gt;\n&lt;span class=\"a-label a-radio-label\"&gt;On\n&lt;/span&gt;\n&lt;/label&gt;\n&lt;/div&gt;\n&lt;div class=\"a-radio a-radio-fancy\" data-a-input-name=\"statusToSet\"&gt;\n&lt;label&gt;\n&lt;input name=\"statusToSet\" type=\"radio\" value=\"ONBOARDED\"&gt;\n&lt;i class=\"a-icon a-icon-radio\"&gt;&lt;/i&gt;\n&lt;span class=\"a-label a-radio-label\"&gt;Off\n&lt;/span&gt;\n&lt;/label&gt;\n&lt;/div&gt;\n&lt;/label&gt;\n</code></pre>\n\n<p>**</p>\n\n<p><strong>Vba code:</strong> </p>\n\n<pre><code>Sub test()\n Dim IE As Object\n Set IE = CreateObject(\"InternetExplorer.Application\")\n lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n IE.Visible = True\n IE.Navigate \"file:///C:/Users/shanaksh/Documents/My%20Received%20Files/Turn%20On_Off%20Inbound%20Check%20For%20Asins.htm\"\n\n\n Do While IE.Busy\n   Application.Wait DateAdd(\"s\", 1, Now)\n Loop\n\n\n\n\n For Record = 2 To lastrow\n IE.document.getElementByName(\"statusToSet\").Item(1).Checked = True\n Next Record\n\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Y9trV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y9trV.png\" alt=\"HTML CODE OF THE RADIO BUTTON\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550669953, "post_id": 54783700, "comment_id": 96353722, "body": "This is not a duplicate, even if I showed @srihari here <a href=\"https://stackoverflow.com/q/54779261/10908769\">stackoverflow.com/q/54779261/10908769</a>, how to insert the file name below each picture (as wanted!). As srihari now wants it usable for a TOC, I suggested a new question. So here we are ..."}, {"owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550674855, "post_id": 54783700, "comment_id": 96356881, "body": "I need to insert all the labels as table of contents which can be accessed and I have edited the same question."}, {"owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550674920, "post_id": 54783700, "comment_id": 96356923, "body": "@PEH the approach explained  stackoverflow.com/q/54779261/10908769 doesn&#39;t disaplay labels as table of contents."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1550694948, "creation_date": 1550694948, "answer_id": 54794824, "question_id": 54783700, "link": "https://stackoverflow.com/questions/54783700/how-to-insert-multiple-captions-and-hyperlinks-for-multiple-images-present-in-wo/54794824#54794824", "title": "How to insert multiple captions and hyperlinks for multiple images present in word? For example \u201cFigure:1\u201d below image and its hyperlink", "body": "<p>Following code provides this:<br>\n- insert a text \"Table of Figures:\" at the beginning of the document<br>\n- add a table of figures<br>\n- add each picture pof your directory (incl. its name as caption below and a page break)<br>\n- update the table of figures</p>\n\n<pre><code>Sub InsertPicturesAndTheirNames()\n    Dim objWord As Object   ' Word.Application\n    Dim objDoc As Object    ' Word.Document\n    Dim objShape As Object  ' Word.InlineShape\n    Dim objTOF As Object    ' Word.TableOfFigures\n    Dim objFSO As Object    ' Scripting.FileSystemObject\n    Dim strFolderPath As String\n    Dim objFolder As Object ' Scripting.Folder\n    Dim imgpath As String\n    Dim img As Object       ' Scripting.File\n\n    strFolderPath = \"C:\\images\"\n\n    On Error Resume Next\n    If objWord Is Nothing Then\n        Set objWord = GetObject(, \"Word.Application\")\n        If objWord Is Nothing Then\n            Set objWord = CreateObject(\"Word.Application\")\n        End If\n    End If\n    On Error GoTo 0\n    objWord.Visible = True\n\n    Set objDoc = objWord.Documents.Open(\"D:\\myfile.docx\")\n\n    objDoc.Bookmarks(\"\\StartOfDoc\").Select\n    objWord.Selection.Text = \"Table of Figures:\"\n    objWord.Selection.InsertParagraphAfter\n    objWord.Selection.Collapse 0    ' 0 = wdCollapseEnd\n\n    objDoc.TablesOfFigures.Format = 5 ' 5 = wdTOFSimple\n    Set objTOF = objDoc.TablesOfFigures.Add( _\n        Range:=objWord.Selection.Range, _\n        Caption:=-1, _\n        IncludeLabel:=True, _\n        RightAlignPageNumbers:=True, _\n        UseHeadingStyles:=False, _\n        UpperHeadingLevel:=1, _\n        LowerHeadingLevel:=3, _\n        IncludePageNumbers:=True, _\n        AddedStyles:=\"\", _\n        UseHyperlinks:=True, _\n        HidePageNumbersInWeb:=True) ' -1 = wdCaptionFigure\n    objTOF.TabLeader = 1 ' 1 = wdTabLeaderDots\n    objTOF.Range.InsertParagraphAfter\n    objTOF.Range.Next(Unit:=4, Count:=1).InsertBreak Type:=7 ' 4 = wdParagraph, 7 = wdPageBreak\n\n    objDoc.Bookmarks(\"\\EndOfDoc\").Select\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(strFolderPath)\n    For Each img In objFolder.Files\n        imgpath = img.Path\n        Set objShape = objDoc.InlineShapes.AddPicture( _\n            Filename:=imgpath, _\n            LinkToFile:=True, _\n            SaveWithDocument:=False)\n        objShape.Range.InsertCaption _\n                Label:=-1, _\n                TitleAutoText:=\"\", _\n                Title:=\": \" &amp; Mid(imgpath, InStrRev(imgpath, \"\\\") + 1), _\n                Position:=1, _\n                ExcludeLabel:=False ' -1 = wdCaptionFigure, 1 = wdCaptionPositionBelow\n        objDoc.Bookmarks(\"\\EndOfDoc\").Select\n        objWord.Selection.InsertParagraphAfter\n        objDoc.Bookmarks(\"\\EndOfDoc\").Select\n        objWord.Selection.InsertBreak Type:=7 ' 7 = wdPageBreak\n    Next\n\n    objTOF.Update\nEnd Sub\n</code></pre>\n\n<p>If you add a reference to <code>Microsoft Word x.x Object Library</code> you can use early binding. That means you could use the self-explanatory ENUM values I noted as comments.</p>\n\n<p>The pictures are stored as links in the document, as the document my get very large if you store them completely (refer to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.inlineshapes.addpicture\" rel=\"nofollow noreferrer\">AddPicture</a>).</p>\n"}], "owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 54794824, "answer_count": 1, "score": 0, "last_activity_date": 1550694948, "creation_date": 1550657272, "last_edit_date": 1550657932, "question_id": 54783700, "link": "https://stackoverflow.com/questions/54783700/how-to-insert-multiple-captions-and-hyperlinks-for-multiple-images-present-in-wo", "title": "How to insert multiple captions and hyperlinks for multiple images present in word? For example \u201cFigure:1\u201d below image and its hyperlink", "body": "<p>I am able to add multiple images to a word document using VBA, but I am not able to add captions and its hyperlinks for multiple images loaded from the folder path.\nCan you please suggest on this:</p>\n\n<pre><code>Sub checking()\n    Dim strFolderPath\n    strFolderPath = \"C:\\images\"\n    Dim objWord\n    Dim objDoc\n    Dim objSelection\n    Dim objShapes\n    Dim objFSO\n    Dim objFolder\n\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(strFolderPath)\n    Set objDoc = objWord.Documents.Open(\"D:\\myfile.docx\")\n\n    objWord.Visible = True\n\n    Set objSelection = objWord.Selection\n\n    For Each Img In objFolder.Files\n        ImgPath = Img.Path\n        objSelection.InlineShapes.AddPicture (ImgPath)\n        objSelection.InsertBreak\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "missing-data"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1550669598, "post_id": 54783696, "comment_id": 96353483, "body": "Your line <code>Do Until ActiveCell.Offset(1, 0).Value = &quot;&quot;</code> will exit the sub when it identifies an empty cell below the active cell. Your code is only working until it sees a blank cell then shows the message and stops. You need to rethink your logic."}, {"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1550669869, "post_id": 54783696, "comment_id": 96353660, "body": "There are no gaps, it runs until the last entry in the database and extracts only certain items. Thank you for your criticism though. I am learning a lot from members on here and am close to solving my issue."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1550669893, "post_id": 54783696, "comment_id": 96353679, "body": "For your project I would filter using the date as the criteria, then copy the visible cells and paste to the first empty cell in Sheet2 Col A. It would be much quicker."}, {"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1550670711, "post_id": 54783696, "comment_id": 96354209, "body": "GMalc thank you so much, that does seem like a valid option, my concern is that i want to not just get dates from a certain year but all dates from before a selected date. I am close to solving the issue using Error 1004"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550660349, "post_id": 54784601, "comment_id": 96347818, "body": "Thank you JvdV, unfortunately this is bringing up the exact same results as before. although the date in 7,8 is 01/01/2019 and EVERY entry in the database is before that date, it still only selects about 8 out of 354 sheets.(I will try to avoid .select) unfortunately that is a way I understand the code a little better. (At quite a basic level at the moment and trying not to cut/paste without understanding what the code is doing)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550661903, "post_id": 54784601, "comment_id": 96348840, "body": "@SeanHickman, what are the cells formatted like then? Are they not all dates?"}, {"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550662325, "post_id": 54784601, "comment_id": 96349072, "body": "That was my first port of call but they&#39;re all formatted to Date - 01/01/19, thank you for your help as I have now understood the way of using xlup to count rows and add to the bottom which is LOADS faster than my previous way."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550662586, "post_id": 54784601, "comment_id": 96349208, "body": "Iterate through the code using F8. Report back what rownumber it stops working according to what it should do, that is the first row where apparently the value should be lower but really isn&#39;t. Then tell us if you can tell any difference in format/value or otherwise."}, {"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550669966, "post_id": 54784601, "comment_id": 96353732, "body": "It runs throughout the whole workbook until there are no blank cells and even reads values that should be copied, it just doesn&#39;t do them. I&#39;m getting close to my solution with Error 1004&#39;s suggestion. Thank you for your help though. I will be avoiding .select in future."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1550660041, "creation_date": 1550660041, "answer_id": 54784601, "question_id": 54783696, "link": "https://stackoverflow.com/questions/54783696/code-executing-on-only-a-few-entries-and-missing-entries-that-pass-the-rule/54784601#54784601", "title": "Code executing on only a few entries and missing entries that pass the rule?", "body": "<p>You should avoid using select and also reference your sheets better. Something like code below should work better allready:</p>\n\n<pre><code>Sub checkdatasheets2()\n\nFor X = 2 To Sheets(1).Cells(Rows.Count, 5).End(xlUp).Row\n    If Sheets(1).Cells(X, 5).Value &lt; Sheets(1).Cells(7, 8).Value Then\n        Sheets(1).Rows(X).Copy Destination:=Sheets(2).Range(\"A\" &amp; Sheets(2).Cells(Sheets(2).Rows.Count, 5).End(xlUp).Row + 1)\n    End If\nNext X\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "edited": false, "score": 0, "creation_date": 1550675699, "post_id": 54785248, "comment_id": 96357454, "body": "Thank you Error 1004, i have amended this to search via the correct column and it is doing exactly what is needed and pretty quickly too! I&#39;m trying to dissect and fully understand what exactly is happening within the code and think I get it. Thanks once again for your help this will prove very helpful for the admin staff who need to upkeep the database."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1550662076, "creation_date": 1550662076, "answer_id": 54785248, "question_id": 54783696, "link": "https://stackoverflow.com/questions/54783696/code-executing-on-only-a-few-entries-and-missing-entries-that-pass-the-rule/54785248#54785248", "title": "Code executing on only a few entries and missing entries that pass the rule?", "body": "<p>Import the below code in the change event of the sheet which you will import the date.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim sDate As Date\n    Dim LastRow1 As Long, LastRow2 As Long, i As Long\n\n    If Not Intersect(Target, Range(\"A1\")) Is Nothing Then\n\n        If IsDate(Target.Value) Then\n            sDate = CDate(Target.Value)\n            LastRow1 = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n\n            For i = 3 To LastRow1\n                If CDate(Sheet1.Range(\"A\" &amp; i).Value) &lt; sDate Then\n                    LastRow2 = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row\n                    Sheet1.Rows(i).Copy Sheet2.Rows(LastRow2 + 1)\n                End If\n            Next i\n        Else\n            MsgBox \"Please insert a valid date.\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet 1 (includes the date)</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JSZCk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JSZCk.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet 2 (Results)</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/MZvPX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MZvPX.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11088830, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpEC2nGZwUI/AAAAAAAAAAI/AAAAAAAAZMg/hkMBD9nOFmc/photo.jpg?sz=128", "display_name": "Sean Hickman", "link": "https://stackoverflow.com/users/11088830/sean-hickman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54785248, "answer_count": 2, "score": 0, "last_activity_date": 1550662076, "creation_date": 1550657258, "question_id": 54783696, "link": "https://stackoverflow.com/questions/54783696/code-executing-on-only-a-few-entries-and-missing-entries-that-pass-the-rule", "title": "Code executing on only a few entries and missing entries that pass the rule?", "body": "<p>Good Morning, </p>\n\n<p>I have a database of safety data sheets for the benefit of COSHH, i am trying to create a function in which the user can enter a date into \"H7\" and any entried with dates less than that one will have the entire row transferred into sheet2.</p>\n\n<p>the code i have written is as below </p>\n\n<pre><code>Sub checkdatasheets()\nDim datefrom As Variant\n\n'select first entry\nSheet1.Range(\"E2\").Select\n\n'continue until an empty cell is reached\nDo Until ActiveCell.Offset(1, 0).Value = \"\"\n\nIf ActiveCell.Value = \"\" Then GoTo skipto:\n\n'aquire date parameter\n datefrom = Sheet1.Range(\"H7\")\n\n 'if revision date is less than the date parameter copy and add to sheet2\n  If ActiveCell.Value &lt;= datefrom Then\n\n        ActiveCell.Rows.EntireRow.Copy\n        Sheets(\"Sheet2\").Select\n        NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Cells(NextRow, 1).Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n\n End If\n\n'move onto next cell\nActiveCell.Offset(1, 0).Select\n\nLoop\n\nskipto: MsgBox \"Missing Data Sheet\"\n\nEnd Sub\n</code></pre>\n\n<p>The issue i am having is that this code takes certain rows but lots of rows are missed, even though they are less than the datefrom variable?</p>\n\n<p>Thank you in advance for your help, any feedback on the writing of my code would be appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1550662890, "last_edit_date": 1550662890, "creation_date": 1550662058, "answer_id": 54785244, "question_id": 54783516, "link": "https://stackoverflow.com/questions/54783516/how-to-run-vba-script-by-clicking-on-contentcontrol-checkbox-in-word/54785244#54785244", "title": "How to run VBA script by clicking on ContentControl Checkbox in Word", "body": "<p>You can use the doucment events,</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal ContentControl As ContentControl, Cancel As Boolean)\n    If ContentControl.Title = \"a1\" Then\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Or you can add a custom event handler, like so.</p>\n\n<p>In a standard module have the following.  This code will need to be run when the document is opened.</p>\n\n<pre><code>Public cls_CustomEventHandler As clsCustomEventHandler\n\nSub SetUpDocumentContentEventHandler()\n\nSet cls_CustomEventHandler = New clsCustomEventHandler\n\nSet cls_CustomEventHandler.wdDocumnetToListenTo = ActiveDocument\n\nEnd Sub\n</code></pre>\n\n<p>and then have a class module clsCustomEventHandler, with the following code</p>\n\n<pre><code>Public WithEvents wdDocumnetToListenTo As Document\n\nPrivate Sub wdDocumnetToListenTo_ContentControlOnExit( _\n                                ByVal ContentControl As ContentControl, _\n                                Cancel As Boolean)\n\nIf ContentControl.Title = \"a1\" Then\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1550666565, "creation_date": 1550666565, "answer_id": 54786660, "question_id": 54783516, "link": "https://stackoverflow.com/questions/54783516/how-to-run-vba-script-by-clicking-on-contentcontrol-checkbox-in-word/54786660#54786660", "title": "How to run VBA script by clicking on ContentControl Checkbox in Word", "body": "<p>Try adding the following to the 'ThisDocument' code module of the document or its template:</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal CCtrl As ContentControl, Cancel As Boolean)\nWith CCtrl\n  If .Title = \"D1\" Then\n    For i = 1 To 3\n      ActiveDocument.SelectContentControlsByTag(\"D1_M\" &amp; i)(1).Checked = .Checked\n    Next\n  End If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3063474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698a05ccaa042b7bbdbbd73ae987bf5?s=128&d=identicon&r=PG&f=1", "display_name": "user3063474", "link": "https://stackoverflow.com/users/3063474/user3063474"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 54785244, "answer_count": 2, "score": 0, "last_activity_date": 1582888288, "creation_date": 1550656712, "last_edit_date": 1582888288, "question_id": 54783516, "link": "https://stackoverflow.com/questions/54783516/how-to-run-vba-script-by-clicking-on-contentcontrol-checkbox-in-word", "title": "How to run VBA script by clicking on ContentControl Checkbox in Word", "body": "<p>I'm trying to check all contentcontrol checkboxes by clicking contentcontrol checkbox. But how to set event to run this script by clicking on checkbox with Tag D1</p>\n\n<pre><code>If ActiveDocument.SelectContentControlsByTag(\"D1\")(1).Checked = True Then\n   ActiveDocument.SelectContentControlsByTag(\"D1_M1\")(1).Checked = True\n   ActiveDocument.SelectContentControlsByTag(\"D1_M2\")(1).Checked = True\n   ActiveDocument.SelectContentControlsByTag(\"D1_M3\")(1).Checked = True\nEnd If\nIf ActiveDocument.SelectContentControlsByTag(\"D1\")(1).Checked = False Then\n   ActiveDocument.SelectContentControlsByTag(\"D1_M1\")(1).Checked = False\n   ActiveDocument.SelectContentControlsByTag(\"D1_M2\")(1).Checked = False\n   ActiveDocument.SelectContentControlsByTag(\"D1_M3\")(1).Checked = False\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1550656483, "post_id": 54783257, "comment_id": 96345247, "body": "Functions should return something, a number, a range, a string etc. You are just selecting a cell and selecting is never good. Return a range object and then you can reference that in your other code."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1550656773, "post_id": 54783257, "comment_id": 96345426, "body": "@SJR Thank you for the reply. I have tried calling the function in the sub as above, then have the function look like this &#39;find_Header(header As String, fType As String) As Range&#39; and then back in the sub I have the line look like this &#39;Set xRg = find_Header &amp; i)&#39; but I get the error &quot;Arguments not Optional&quot;."}, {"owner": {"reputation": 76, "user_id": 10547491, "user_type": "registered", "profile_image": "https://graph.facebook.com/2499022153458365/picture?type=large", "display_name": "Jimmy M.", "link": "https://stackoverflow.com/users/10547491/jimmy-m"}, "edited": false, "score": 0, "creation_date": 1550656922, "post_id": 54783257, "comment_id": 96345540, "body": "Function find_Header(header As String, fType As String) as Range  and at the end of function add find_Header = rng"}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550657562, "post_id": 54783605, "comment_id": 96345949, "body": "Ahh, making progress!! :) So the issue I am facing now is that it is selecting the range starting in cell A1 up until the correct column&#39;s last cell. For example, I only need to use Column D, Cell D3:D30, but now I am getting A1:D30"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550657683, "post_id": 54783605, "comment_id": 96346037, "body": "To add to this, the next line where this is used {Set xRg = ws2.Range(rngMyRange &amp; i)} I get an error &quot;Type Mismatch&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550657689, "post_id": 54783605, "comment_id": 96346045, "body": "That&#39;s only because I specified A1 in this line <code>Set r = Range(&quot;a1&quot;, find_Header(&quot;one&quot;, &quot;Copy&quot;))</code>. Is D3:D30 the range returned by Find_Header?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550657722, "post_id": 54783605, "comment_id": 96346066, "body": "Yes, in the function, the D3:D30 range is what is found/returned"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1550657829, "post_id": 54783605, "comment_id": 96346146, "body": "OK so you can just refer directly to <code>find_Header(&quot;one&quot;, &quot;Copy&quot;)</code> in your main procedure, e.g. <code>find_Header(&quot;one&quot;, &quot;Copy&quot;).select</code>, because the function returns that range object."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550658361, "post_id": 54783605, "comment_id": 96346510, "body": "Thank you so much, this is working great! :) I&#39;m only still struggling on making it a range object as with this line {Set xRg = ws2.Range(rngMyRange &amp; i)} where &quot;i&quot; is defined as Worksheets(&quot;Run Results&quot;).UsedRange.Rows.count"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550658635, "post_id": 54783605, "comment_id": 96346704, "body": "How is <code>rngMyRange</code> defined?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550658811, "post_id": 54783605, "comment_id": 96346831, "body": "Damn, sorry. I completely spaced out. I was supposed to change it to this Set xRg = ws2.Range(Selection.Address &amp; i). It is working now. Thank you kindly for your help! :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1550659030, "post_id": 54783605, "comment_id": 96346995, "body": "OK, thanks for accepting the answer, but again would advise against using Selection. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1550659449, "post_id": 54783605, "comment_id": 96347252, "body": "Thank you. I will check it out :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1550656965, "creation_date": 1550656965, "answer_id": 54783605, "question_id": 54783257, "link": "https://stackoverflow.com/questions/54783257/vba-using-current-selection-as-range-object/54783605#54783605", "title": "VBA - Using Current Selection As Range Object", "body": "<p>Ok, so here is an illustration just so you can see what I mean. If you put \"one\" somewhere in B2:J2 it will select the range. I am only using Select here so that you can see the range it identifies. (Disclaimer: I don't fully understand what you are doing, and not sure you need all this code to achieve what you want.)</p>\n\n<p>The Function now returns a range variable, and is assigned to <code>r</code>. Run the procedure <code>x</code>.</p>\n\n<pre><code>Sub x()\n\nDim r As Range\n\nSet r = Range(\"a1\", find_Header(\"one\", \"Copy\"))\nr.Select\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Function find_Header(header As String, fType As String) As Range\n\nDim aCell As Range, rng As Range\nDim col As Long, lRow As Long\nDim colName As String\n\nWith ActiveSheet\n    Set aCell = .Range(\"B2:J2\").Find(What:=header, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    'If Found\n    If Not aCell Is Nothing Then\n        col = aCell.Column\n        colName = Split(.Cells(, col).Address, \"$\")(1)\n        lRow = Range(colName &amp; .Rows.Count).End(xlUp).Row + 1\n        Set myCol = Range(colName &amp; \"2\")\n        Select Case fType\n            Case \"Copy\"\n                'This is your range\n                Set find_Header = Range(myCol.Address &amp; \":\" &amp; colName &amp; lRow).Offset(1, 0)\n            End Select\n    'If not found\n    Else\n        Set find_Header = Nothing\n    End If\n\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 54783605, "answer_count": 1, "score": 1, "last_activity_date": 1550656965, "creation_date": 1550656035, "last_edit_date": 1550656405, "question_id": 54783257, "link": "https://stackoverflow.com/questions/54783257/vba-using-current-selection-as-range-object", "title": "VBA - Using Current Selection As Range Object", "body": "<p>I have this function below which does the following:</p>\n\n<ol>\n<li>Takes two parameters (Header Name, Function Needed).</li>\n<li>The Header Name parameter is used to find the heading and subsequently to identify the range of that column up until the last row.</li>\n<li>The Function Needed parameter is used to switch in the select statement for any additional steps needed.</li>\n<li>At the end of most of the statements, I do a <code>Range.Select</code> then I exit my function with a selected range.</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>Function find_Header(header As String, fType As String)\n    Dim aCell As Range, rng As Range\n    Dim col As Long, lRow As Long\n    Dim colName As String\n\n    With ActiveSheet\n        Set aCell = .Range(\"B2:J2\").Find(What:=header, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n\n        'If Found\n        If Not aCell Is Nothing Then\n            col = aCell.Column\n            colName = Split(.Cells(, col).Address, \"$\")(1)\n\n            lRow = Range(colName &amp; .Rows.count).End(xlUp).Row + 1\n\n            Set myCol = Range(colName &amp; \"2\")\n\n            Select Case fType\n                Case \"Copy\"\n                    'This is your range\n                    Set rng = Range(myCol.Address &amp; \":\" &amp; colName &amp; lRow).Offset(1, 0)\n\n                    rng.Select\n            End Select\n\n        'If not found\n        Else\n            MsgBox \"Column Not Found\"\n        End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>As I am trying to clean up my code, I have come across a section where I have specifically hard coded ranges and I am trying to make use of my function instead, however, I am now at a point where I am unable to make use of this function correctly as I cannot \"pass\" the range back to the sub and I cannot seem to make the selection the range object needed for the sub.</p>\n\n<p>Here is what is in the sub:</p>\n\n<pre><code>Sub Copy_Failed()\n    Dim xRg As Range, xCell As Range\n    Dim i As Long, J As Long, count As Long\n    Dim fType As String, colName As String\n    Dim y As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    myarray = Array(\"Defect\", \"System\", \"Script\")\n    myEnv = Array(\"SIT\", \"UAT\")\n    myDefects = Array(\"New\", \"Existing\")\n\n    i = Worksheets(\"Run Results\").UsedRange.Rows.count\n    J = Worksheets(\"Failed\").UsedRange.Rows.count\n\n    Set y = Workbooks(\"Template.xlsm\")\n\n    Set ws1 = y.Sheets(\"Failed\")\n    Set ws2 = y.Sheets(\"Run Results\")\n\n    count = 3\n\n    If J = 1 Then\n\n        If Application.WorksheetFunction.CountA(ws1.UsedRange) = 0 Then J = 0\n\n    End If\n\n    ws2.Activate\n\n    fType = \"Copy\"\n    colName = \"Status\"\n\n    Call find_Header(colName, fType)\nEnd Sub\n</code></pre>\n\n<p>Before I used the function, the code looked like this:</p>\n\n<pre><code>lngLastRow = Cells(Rows.count, \"B\").End(xlUp).Row\n\nSet xRg = ws2.Range(\"E3:E\" &amp; lngLastRow &amp; i)\n</code></pre>\n\n<p>Now these 2 lines are performed in the function, so I don't need it in the sub. I have tried the following:</p>\n\n<pre><code>Set rngMyRange = Selection\n\nSet rngMyRange = ActiveSheet.Range(Selection.Address)\n\nSet xRg = ws2.Range(rngMyRange  &amp; i)\n</code></pre>\n\n<p>But I get the error:</p>\n\n<blockquote>\n  <p>Type mismatch</p>\n</blockquote>\n\n<p>So I am thinking this:</p>\n\n<ol>\n<li>Select the range in the function then use it in the sub - but how?</li>\n<li>Figure out how to pass the actual range object from my function to the sub </li>\n</ol>\n\n<p>Although the second option would require some extra changes in my code, I would think this is the better option to go with.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1550654763, "post_id": 54782404, "comment_id": 96344221, "body": "<code>For i = lbound(data_table2, 1) To ubound(data_table2, 1)</code> and remove the <code>+ 1</code>."}, {"owner": {"reputation": 29, "user_id": 10512886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd04a4b18d798395e783be8ba76a7253?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/10512886/mak"}, "edited": false, "score": 0, "creation_date": 1550661510, "post_id": 54782404, "comment_id": 96348600, "body": "Thanks GSerg it works well"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10547491, "user_type": "registered", "profile_image": "https://graph.facebook.com/2499022153458365/picture?type=large", "display_name": "Jimmy M.", "link": "https://stackoverflow.com/users/10547491/jimmy-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1550656057, "creation_date": 1550656057, "answer_id": 54783269, "question_id": 54782404, "link": "https://stackoverflow.com/questions/54782404/how-to-solve-run-time-error-9-subscript-out-of-range/54783269#54783269", "title": "How to solve run time error &#39;9&#39; subscript out of range?", "body": "<p>Take a look at the values of last_Row.</p>\n\n<p>If you have a region of values for eg. A1:C22, the last_row will be 23, but you assigning to data_table Range(\"A2:C\" &amp; last_row) so you are starting from the second row. </p>\n\n<p>it will be always subscript out of range error on the end, coz on the last itteration assign i = 23, and the array len is 22, so you are out of range</p>\n\n<p>change your for loop to for each loop, or do this this way </p>\n\n<pre><code>For i = 1 to UBound(data_table2)\n    If isDeveloper() = True Then\n        pReference = data_table2(i, 1)\n        pValue = data_table2(i, 2)\n        pdate = data_table2(i, 3)\n    End If\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10512886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd04a4b18d798395e783be8ba76a7253?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/10512886/mak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1550748340, "accepted_answer_id": 54783269, "answer_count": 1, "score": 0, "last_activity_date": 1550656057, "creation_date": 1550653329, "last_edit_date": 1550654478, "question_id": 54782404, "link": "https://stackoverflow.com/questions/54782404/how-to-solve-run-time-error-9-subscript-out-of-range", "closed_reason": "Duplicate", "title": "How to solve run time error &#39;9&#39; subscript out of range?", "body": "<p>I have three columns in my Excel worksheet - Reference, Value and Date. The code goes through all given values and works perfectly but at the end I have run time error at <code>pReference = data_table2(i + 1, 1)</code>.</p>\n\n<pre><code>Set Sheet_data = ThisWorkbook.Worksheets(\"Setup\")\nlast_Row = Sheet_data.Range(\"A1\").CurrentRegion.Rows.Count\n\nSet data_table = Sheet_data.Range(\"A2:C\" &amp; last_Row)\ndata_table2 = data_table.Value2\n\n' New Code for Excel Export\nFor i = 1 To (last_Row - 1)\n    If isDeveloper() = True Then\n        pReference = data_table2(i + 1, 1)\n        pValue = data_table2(i + 1, 2)\n        pdate = data_table2(i + 1, 3)\n    End If\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access", "z-order"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1550653595, "post_id": 54781870, "comment_id": 96343526, "body": "Is what it is. Don&#39;t think this behavior can be altered."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1550654029, "post_id": 54781870, "comment_id": 96343778, "body": "Writing a whole new program outside of access that detects this issue would probably be your sole solution here.."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1550662069, "post_id": 54781870, "comment_id": 96348927, "body": ":-( This is sad, because the behavior is really very annoying..."}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550651924, "creation_date": 1550651416, "last_edit_date": 1550651924, "question_id": 54781870, "link": "https://stackoverflow.com/questions/54781870/how-to-avoid-the-active-form-to-be-moved-to-the-back-when-reaching-a-breakpoint", "title": "How to avoid the active form to be moved to the back when reaching a breakpoint in access-vba?", "body": "<p>There are several non-modal forms in ms-access open layered above each other (with a small offset). Every time my VBA program reaches a breakpoint, a stop command or an error the active form is moved to the background (at the end of the Z-order).</p>\n\n<p>I searched the options for a solution for this but did not find anything.</p>\n\n<p>Why is the active form moved to the back and how can I avoid this strange behavior?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 3, "creation_date": 1550649242, "post_id": 54781165, "comment_id": 96341263, "body": "what did you achieve yet? what is the problem? just use nested loop, and some conditions"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1550658623, "creation_date": 1550658623, "answer_id": 54784129, "question_id": 54781165, "link": "https://stackoverflow.com/questions/54781165/loop-through-an-excel-column-and-check-if-each-values-has-a-match-on-another-exc/54784129#54784129", "title": "Loop Through an excel column and check if each values has a match on another excel", "body": "<p>jishnu welcome to StackOverflow. Below is a good starting point for what you are looking for. Please review and try to modify to get you where you want.</p>\n\n<pre><code>Option Explicit\n\n    Sub Test()\n\n        Dim wbR As Workbook, wbD As Workbook\n        Dim wsR As Worksheet, wsD As Worksheet\n        Dim LastrowR As Long, LastrowD As Long, i As Long, CountTimes As Long\n        Dim PNR As String\n\n        Set wbR = Workbooks(\"Recon.xlsm\")\n        Set wbD = Workbooks(\"DataExt.xlsx\")\n\n        Set wsR = wbR.Worksheets(\"Sheet1\")\n        Set wsD = wbD.Worksheets(\"Sheet1\")\n\n        'Let as assume that PNR column is column A, in Sheet 1, in both workbooks.\n        'Also keep in mind that both workbooks should be open and have the following types (Recon -&gt; .xlsm &amp; DataExt -&gt;  .xlsx)\n\n        'Find the last row of PNR column in Recon File\n        LastrowR = wsR.Cells(wsR.Rows.Count, \"A\").End(xlUp).Row\n        'Find the last row of PNR column in DataExt File\n        LastrowD = wsD.Cells(wsD.Rows.Count, \"A\").End(xlUp).Row\n        'Loop PNR column in Recon File\n        For i = 2 To LastrowR\n            'Assign value to PNR\n            PNR = wsR.Range(\"A\" &amp; i).Value\n                'Count how many times PNR appears in column A DataExt file\n                CountTimes = Application.WorksheetFunction.CountIf(wsD.Range(\"A2:A\" &amp; LastrowD), PNR)\n\n                'If appears 1 time\n                If CountTimes = 1 Then\n                'If appears 2 times\n                ElseIf CountTimes = 2 Then\n                'If appears more than 2 times\n                ElseIf CountTimes &gt; 2 Then\n                End If\n\n        Next i\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9194127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf712e948557be5ed446f1d7a86ffb6?s=128&d=identicon&r=PG&f=1", "display_name": "jishnu", "link": "https://stackoverflow.com/users/9194127/jishnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550658623, "creation_date": 1550648544, "last_edit_date": 1550650520, "question_id": 54781165, "link": "https://stackoverflow.com/questions/54781165/loop-through-an-excel-column-and-check-if-each-values-has-a-match-on-another-exc", "title": "Loop Through an excel column and check if each values has a match on another excel", "body": "<p>I have 2 excel files named Recon File and DataExt File.\nBoth files have a column named PNR. </p>\n\n<p>I need to check whether each value in Pnr column of Recon has a match on Pnr column of DataExt.\nIf match is found, check how many matches are there.</p>\n\n<p>If 0 match found, Leave the Column H in Recon as Blank</p>\n\n<p>If 1 Match if found Copy values from cells of  D,E,F and G columns corresponding to the matched Pnr Cell to the Recon File in D,E,F,and G.</p>\n\n<p>If 2 Matches are found, Then check whether for the first &amp; Second match the Column named Sector in Recon also matches with the Sector Column in DataExt. If it matches Copy values corresponding to that columns else Copy values to the Return column.</p>\n\n<p>If more than 2 matches found Fill the Recon column as More than 2 matches found.</p>\n\n<p>Can anyone help me with VBA code for excel Macros. </p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1550649410, "post_id": 54781123, "comment_id": 96341341, "body": "I know excel take date format from regional / format settings from windows.. how have you set this?"}, {"owner": {"reputation": 33, "user_id": 9976753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f488b8e6ebe365bc7eb4e7d234665fff?s=128&d=identicon&r=PG&f=1", "display_name": "coderH", "link": "https://stackoverflow.com/users/9976753/coderh"}, "reply_to_user": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 1, "creation_date": 1550650873, "post_id": 54781123, "comment_id": 96342103, "body": "Didn&#39;t set anything in windows 7 or excel 2007. All are default settings. When I open the same file in win 10 and excel 2013 and enter date like 20/02/2019 then it doesn&#39;t change to 20-02-2019."}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1550651125, "post_id": 54781123, "comment_id": 96342240, "body": "I don&#39;t understand why it would affect your program. Dates are a data type. Locale only affect how it is displayed."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1550651392, "post_id": 54781123, "comment_id": 96342376, "body": "I guess you have some code to analyze this string and get day, month and/or year of this date. Then, you should store your date in <code>Date</code> variable and use proper methods for this. Check <a href=\"https://stackoverflow.com/questions/45854684/excel-vba-convert-cell-value-in-dd-mm-yyyy/45855556#45855556\">this</a> and <a href=\"https://stackoverflow.com/a/47205562/5722505\">this</a>."}, {"owner": {"reputation": 33, "user_id": 9976753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f488b8e6ebe365bc7eb4e7d234665fff?s=128&d=identicon&r=PG&f=1", "display_name": "coderH", "link": "https://stackoverflow.com/users/9976753/coderh"}, "edited": false, "score": 0, "creation_date": 1550657618, "post_id": 54781123, "comment_id": 96345985, "body": "Thank you everyone for the support. Yes the code break the date in to day, month and year and store in 3 cells. I think I can use methods in Egan Wolf&#39;s links."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12069744, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCMbkocAUefkl3uRgF6Z17QA6pir-vrjDVfiDlKiA=k-s128", "display_name": "Conway Phelps", "link": "https://stackoverflow.com/users/12069744/conway-phelps"}, "is_accepted": false, "score": 0, "last_activity_date": 1589263750, "creation_date": 1589263750, "answer_id": 61744918, "question_id": 54781123, "link": "https://stackoverflow.com/questions/54781123/date-automatically-converted-to-instead-of/61744918#61744918", "title": "date automatically converted to - instead of /", "body": "<p>I don't know if this is the answer your looking for, but what I do when I need to change from the native format is to select the column that the date is entered that I need to format and change it to '<em>Custom</em>' and enter \"<em>mm-dd-yyyy</em>\" or whatever the case may be and can be separated by either \"-\" or \"/\".</p>\n\n<p>The allowed entries for dates are:</p>\n\n<p>Month: m = 1; mm = 01;  mmm = Jan;  mmmm = January </p>\n\n<p>Day:  d = 1;  dd = 01</p>\n\n<p>Year: yy\" = 19;  yyyy = 2019</p>\n"}], "owner": {"reputation": 33, "user_id": 9976753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f488b8e6ebe365bc7eb4e7d234665fff?s=128&d=identicon&r=PG&f=1", "display_name": "coderH", "link": "https://stackoverflow.com/users/9976753/coderh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1589263750, "creation_date": 1550648380, "last_edit_date": 1550650527, "question_id": 54781123, "link": "https://stackoverflow.com/questions/54781123/date-automatically-converted-to-instead-of", "title": "date automatically converted to - instead of /", "body": "<p>I have excel file. When I open this file in excel 2007 in windows 7 and when I enter date like 20/02/2019 then it automatically convert it to 20-02-2019.\nThen this format interfere with vba program inside this file. IS there a way to stop this. Also I tried to convert format of cells to dd/mm/yyyy format. But it is also not available.\nAnd is there a way to set / instead of - control panel or excel options. (may be like regional settings)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1550651730, "post_id": 54781416, "comment_id": 96342529, "body": "Thanks. I did it slightly differently. Instead of using the <code>.CountA</code> function, I count the number of rows in my used range using <code>Worksheets(&quot;Sheet1&quot;).UsedRange.Rows.Count</code> and stored it in a variable just like how you did, once before the removal, and once after. Did a difference between the two variables and we should both have arrived to the same answer. Would there be any problem using <code>.UsedRange</code> to count the number of rows? Hopefully not."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 1, "creation_date": 1550657633, "post_id": 54781416, "comment_id": 96346001, "body": "@DSM yes <code>.UsedRange</code> is not very reliable and could count empty cells too. <code>CountA</code> will only count non empty cells."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1550650493, "last_edit_date": 1550650493, "creation_date": 1550649540, "answer_id": 54781416, "question_id": 54780930, "link": "https://stackoverflow.com/questions/54780930/getting-number-of-duplicates-before-removing-them/54781416#54781416", "title": "Getting number of duplicates before removing them", "body": "<p>Do you need the number of duplicates <strong>before</strong> they get removed or is <strong>after</strong> removal ok too. </p>\n\n<p>As you already found out, it is just counting rows before removal and counting them after removal.</p>\n\n<pre><code>Dim RowCountBefore As Long\nRowCountBefore = Application.WorksheetFunction.CountA(Worksheets(\"Sheet1\").Columns(\"A\"))\n\nDim RowCountAfter As Long\nRowCountAfter = Application.WorksheetFunction.CountA(Worksheets(\"Sheet1\").Columns(\"A\"))\n\nDim RowsRemoved As Long\nRowsRemoved = RowCountBefore - RowCountAfter\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550650493, "creation_date": 1550647649, "last_edit_date": 1550647922, "question_id": 54780930, "link": "https://stackoverflow.com/questions/54780930/getting-number-of-duplicates-before-removing-them", "title": "Getting number of duplicates before removing them", "body": "<p>I just want to get the number of duplicates removed when using the .RemoveDuplicate function in excel vba. Is there anyway to get the precise number of how many duplicates are removed when using the excel function?</p>\n\n<p>Code:</p>\n\n<pre><code>rangeofws.RemoveDuplicates Columns:=1, Header:=xlYes\n</code></pre>\n\n<p>rangeofws is just a range variable that defines the used range of the worksheet. I look at the first column to check for duplicates as its the column that contains my Key which should supposedly be all unique, hence me wanting to remove any duplicates. I just need the number of duplicates before they are removed by the function. </p>\n\n<p>Do I have to just find the number of rows before and after the removal then find the difference between the two?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1550646559, "post_id": 54780636, "comment_id": 96340032, "body": "And which sheet is active when you are running this?"}, {"owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1550647431, "post_id": 54780636, "comment_id": 96340411, "body": "The first one - &quot;Import&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550647902, "post_id": 54780636, "comment_id": 96340645, "body": "Always reference the sheet for your <code>Cells</code> like <code>Sheets(&quot;Import&quot;).Cells</code> or this could fail. Also <code>Dim CopyData As Long</code>. Also <code>DataLength</code> should be declared as <code>Long</code> \u2022 I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>. \u2022 Can you tell the values of <code>CopyData</code> and <code>DataLength</code> please?"}, {"owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "edited": false, "score": 0, "creation_date": 1550648011, "post_id": 54780636, "comment_id": 96340684, "body": "Thank you. And by the way - this worked perfectly, before i run for the first time Clear / ClearContents function."}, {"owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "edited": false, "score": 0, "creation_date": 1550648440, "post_id": 54780636, "comment_id": 96340903, "body": "DataLength in this example is 3713 (but it can reach max ~8000). CopyData is 10 in this example, but it can reach ~3000. The aim is to remove irrelevant data, that usualy are on the first part of csv file."}, {"owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "edited": false, "score": 0, "creation_date": 1550781901, "post_id": 54780636, "comment_id": 96408161, "body": "Your solution works. Thank you for support."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "is_accepted": false, "score": 0, "last_activity_date": 1550781839, "creation_date": 1550781839, "answer_id": 54815914, "question_id": 54780636, "link": "https://stackoverflow.com/questions/54780636/vba-paste-function-causes-1004-error-after-the-paste-range-is-cleared/54815914#54815914", "title": "VBA: Paste function causes 1004 error after the paste range is cleared", "body": "<p>User PEH solved the problem. The problem was with reference to the sheet with line</p>\n\n<pre><code>Sheets(\"Import\").Range(Cells(CopyData + 1, 2), Cells(DataLength, 7)).Copy Sheets(\"TIs\").Range(\"A2\")     'copies it from one sheet to another\n</code></pre>\n\n<p>The correct version is:</p>\n\n<pre><code>Sheets(\"Import\").Range(Sheets(\"Import\").Cells(CopyData + 1, 2), Sheets(\"Import\").Cells(DataLength, 7)).Copy Sheets(\"TIs\").Range(\"A2\")     'copies it from one sheet to another\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4530428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c4f9fbc5918984b93c8899c20b389f?s=128&d=identicon&r=PG&f=1", "display_name": "ketzul", "link": "https://stackoverflow.com/users/4530428/ketzul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579895609, "creation_date": 1550646294, "last_edit_date": 1579895609, "question_id": 54780636, "link": "https://stackoverflow.com/questions/54780636/vba-paste-function-causes-1004-error-after-the-paste-range-is-cleared", "title": "VBA: Paste function causes 1004 error after the paste range is cleared", "body": "<p>I have a problem with my code, when i try copy some piece of data from one sheet (\"Import\") to another (\"TIs\"). There is a range in the second sheet, that is cleared before the data is copied. When I try to paste it, I get a</p>\n\n<blockquote>\n  <p>Error 1004 \"Application-defined or Object-defined error\"</p>\n</blockquote>\n\n<pre><code>Sub Data()\nSheets(\"Import\").Cells.ClearContents\nSheets(\"TIs\").Range(\"A2:F10000\").ClearContents\n\nDim sPath As String 'Input file path\nDim k As Integer\nDim CopyData\n\nCopyData = 10\n\nFor k = 1 To 1 'For now k=1\n    sPath = ThisWorkbook.Path &amp; \"\\InputData\\Data (\" &amp; k &amp; \").csv\"                           'defines a path to csv file\n    copyDataFromCsvFileToSheet sPath, \",\", \"Import\"                                         'imports data from csv file to \"Import\" Sheet (this is another functions, it works perfectly)\n    DataLength = Application.WorksheetFunction.CountA(Sheets(\"Import\").Range(\"B:B\"))        'defines last row where are imported data\n    Sheets(\"Import\").Range(Cells(CopyData + 1, 2), Cells(DataLength, 7)).Copy Sheets(\"TIs\").Range(\"A2\")     'copies it from one sheet to another\nNext k\n\nEnd Sub\n</code></pre>\n\n<p>This worked perfectly, before i run for the first time Clear / ClearContents function. In the first version this range hasn't been cleared and it worked fine. Then i run a macro with Clear function for the first time, and from this time \"paste\" function doesn't work at all - no matter if Clear / ClearContents function is commented or not.</p>\n\n<p>Do you know what the problem is?\nThank you for support.</p>\n"}, {"tags": ["excel", "vba", "vbscript", "add-in", "createobject"], "comments": [{"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1550643956, "post_id": 54779968, "comment_id": 96338993, "body": "<code>application.Addins</code> returns an <code>addins</code> collection."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1550644145, "post_id": 54779968, "comment_id": 96339077, "body": "@Noodles Unless you specify an index: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.addins#example\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1550645426, "post_id": 54779968, "comment_id": 96339559, "body": "Try this <code>Application.AddIns.Add &quot;Filepath to Addin&quot;, False</code>. And then try <code>Application.AddIns(&quot;QzData Excel Addin&quot;).Installed = True</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550652377, "post_id": 54779968, "comment_id": 96342863, "body": "I think you need to prefix your operations on the excel object with <code>Excel.</code> also."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550665956, "post_id": 54779968, "comment_id": 96351291, "body": "@Nathan_Sav When running the code as a VBScript. When running the code as VBA they don&#39;t (but then they also don&#39;t need to create an Excel instance in the first place)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1550666077, "post_id": 54779968, "comment_id": 96351364, "body": "@AnsgarWiechers I read the post as being in VBScript.  And the createobject confirmed this.  They do in VBA as well, as they&#39;ll be working on the active application and not the created one. :)"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1550666451, "post_id": 54779968, "comment_id": 96351589, "body": "@Nathan_Sav They tried both. Check the last paragraph."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1550671238, "post_id": 54779968, "comment_id": 96354536, "body": "@AnsgarWiechers regardless, they will still be creating an excel object and never referencing it.  As they are making the object visible, I assumed that they were trying to open a new instance of excel and install the addins on said instance, if this is not the case, creating the object would be redundant.  I don&#39;t have time to argue the ins and outs of others bad/good coding practices.  Just here to offer guidance when I can :)"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6074050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154658053565021/picture?type=large", "display_name": "Damien Minter", "link": "https://stackoverflow.com/users/6074050/damien-minter"}, "edited": false, "score": 0, "creation_date": 1550707743, "post_id": 54786676, "comment_id": 96372170, "body": "Thanks MacroMark - I had to change what you provided slightly but essentially this and the link got me to the answer"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 1, "last_activity_date": 1550666630, "creation_date": 1550666630, "answer_id": 54786676, "question_id": 54779968, "link": "https://stackoverflow.com/questions/54779968/createobjectexcel-application-and-install-addins/54786676#54786676", "title": "CreateObject(&quot;Excel.Application&quot;) and install Addins", "body": "<p>When using CreateObject, Excel addins are not available by default:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/213489/add-ins-do-not-load-when-using-the-createobject-command-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/213489/add-ins-do-not-load-when-using-the-createobject-command-in-excel</a></p>\n\n<p>So try:</p>\n\n<pre><code>Set Excel = CreateObject(\"Excel.Application\")\nExcel.Visible = True\nExcel.Workbooks.Open (\"Path\\To\\QzData Excel Addin.xlam\")\nAddIns(\"QzData Excel Addin\").Installed = True \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6074050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154658053565021/picture?type=large", "display_name": "Damien Minter", "link": "https://stackoverflow.com/users/6074050/damien-minter"}, "is_accepted": false, "score": 1, "last_activity_date": 1550707646, "creation_date": 1550707646, "answer_id": 54797203, "question_id": 54779968, "link": "https://stackoverflow.com/questions/54779968/createobjectexcel-application-and-install-addins/54797203#54797203", "title": "CreateObject(&quot;Excel.Application&quot;) and install Addins", "body": "<p>So I managed to get this to work with a few tries based on the information provided above with the final code below</p>\n\n<pre><code>Set Excel = CreateObject(\"Excel.Application\")\nExcel.Visible = True\nExcel.Workbooks.Open\"\\\\xxxx\\xx\\xxx\\xxx\\xx\\xxxxxxxxxx\\xxxx\\xxx\\xxxxx\\xxxxx\\Workbooks\\OpalToolbelt_Plex_Combined_2019_Feb.xlsm\"\nExcel.AddIns(\"QzData Excel Addin\").Installed = False\nExcel.AddIns(\"QzData Excel Addin\").Installed = True \n</code></pre>\n\n<p>I had to put the object name \"Excel\" in front of AddIns as it wouldn't work without. Having \"Application\" in front also didn't work. </p>\n\n<p>I also needed to uninstall the addin before reinstalling it else it would only work half the time. </p>\n\n<p>As per the link provided by @MacroMarc, there is a suggestion that you need to use the RegisterXLL function for .xll addins. I found that my code worked fine without, but worth a mention</p>\n\n<p><code>Excel.RegisterXLL \"QzDataAddin.xll\"</code></p>\n\n<p>Thanks all for your help - This seemed to take a while for something quite simple</p>\n"}], "owner": {"reputation": 51, "user_id": 6074050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154658053565021/picture?type=large", "display_name": "Damien Minter", "link": "https://stackoverflow.com/users/6074050/damien-minter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1899, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550707646, "creation_date": 1550643426, "last_edit_date": 1550665864, "question_id": 54779968, "link": "https://stackoverflow.com/questions/54779968/createobjectexcel-application-and-install-addins", "title": "CreateObject(&quot;Excel.Application&quot;) and install Addins", "body": "<p>After spending the last 2 days tying to get this to work, I am finally reaching out to the community. I have tried multiple variations of the code below including many of the examples that have been posted on to here and other sites. To keep it simple, this is what I have: </p>\n\n<pre><code>Dim Excel\n\nSet Excel = CreateObject(\"Excel.Application\")\n\nExcel.Visible = True\n\nAddIns(\"QzData Excel Addin\").Installed = True \n</code></pre>\n\n<p>Essentially I am trying to use a script to open an excel file and run a macro. This macro requires me having the \"QzData Excel Addin\" installed. For simplicity I am just trying to get this working with a new excel sheet as I already have the correct code to open my actual file. </p>\n\n<p>I have tried to run the above as a script (.vbs) and in Excel VBA itself and am getting a \"subscript out of range\" error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550643452, "post_id": 54779940, "comment_id": 96338773, "body": "So what exactly is your question?"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550643531, "post_id": 54779940, "comment_id": 96338802, "body": "Apologies i am stuck as i match Cells with &quot;INC&quot; using range now i am unable to check their priority and i also tried for loop but Left function was giving error"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550643806, "post_id": 54779940, "comment_id": 96338915, "body": "Is there any reason why you can\u2019t use a pivot table to get your result? You may need additional columns to create attributes you can filter in, like a column with SR or INC (although you can filter a pivot table) but would that not work?"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550644220, "post_id": 54779940, "comment_id": 96339107, "body": "We get this data as automated report from a tool and is need to published. in a specific format only (Boss order&#39;s). so i cant use pivot table, is there any way i can use Left function with full address of cells like                                              z = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row           for i = 2 to z and than use left function as Left(Sheet2.Cells(z,1)).value,2 =&quot;inc&quot; then :"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550644489, "post_id": 54779940, "comment_id": 96339199, "body": "What has to be in a specific format? The outputted report of the summarized data you\u2019re wanting to get? Sorry, I have to ask."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550644727, "post_id": 54779940, "comment_id": 96339285, "body": "At the end of the day, I\u2019m sure you can get the result you need with VBA but what if the boss wants to report on a new intersection of data? It won\u2019t be flexible enough. If you can use a pivot table and the copy and paste the key figures into another sheet/workbook manually, I\u2019d do that."}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550644778, "post_id": 54779940, "comment_id": 96339310, "body": "Inflow\tBacklog\tTotal Inflow\tClosed\tBacklog Closed\tTotal Closed\tCarry Forward\t0 - 8\t8 -. 24\t1 - 3 days\t3- 7 Days\t7 - 10 Days\t&gt; 10 Days\t P1\t0\t0\t2\t0\t0\t0\t0\t0\t0\t0\t0\t0\t0\t1 P2\t662\t0\t662\t656\t0\t656\t6\t0\t0\t6\t0\t0\t0\t6 P3\t82\t0\t82\t70\t0\t70\t12\t0\t1\t11\t0\t0\t0\t12 P4\t101\t0\t101\t89\t0\t79\t22\t0\t0\t22\t0\t0\t0\t22 \t845\t0\t847\t815\t0\t805\t40\t0\t1\t39\t0\t0\t0\t40"}, {"owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1550644808, "post_id": 54779940, "comment_id": 96339331, "body": "Something like that sorry for not properly formatted"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1550646319, "post_id": 54779940, "comment_id": 96339928, "body": "don&#39;t use comments if you add clarification. Edit your question to do that."}], "answers": [{"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 1, "last_activity_date": 1550648647, "last_edit_date": 1550648647, "creation_date": 1550646233, "answer_id": 54780617, "question_id": 54779940, "link": "https://stackoverflow.com/questions/54779940/nested-conditions-in-vba/54780617#54780617", "title": "Nested Conditions In VBA", "body": "<pre><code>Sub US_Data()\nDim z As Long\nDim HighCount as Long\nDim ModerCount as Long\nDim LowCount as Long\nDim OpenCount as Long\nDim ClosedCount as Long\nDim C As Range\n\nz = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor Each C In Sheet2.Range(Sheet2.Cells(2, 1), Sheet2.Cells(z, 1))\n    If Left(C.Value, 3) = \"INC\" Then\n        If C.Offset(0,1).Value = \"2 - High\" Then HighCount = HighCount + 1\n        If C.Offset(0,1).Value = \"3 - Moderate\" Then ModerCount = ModerCount + 1\n        If C.Offset(0,1).Value = \"4 - Low\" Then LowCount = LowCount + 1\n        If C.Offset(0,2).Value = \"Closed\" Then ClosedCount = ClosedCount + 1\n        If C.Offset(0,2).Value = \"Open\" Then OpenCount = OpenCount + 1\n    End If\nNext C\n\nMsgBox \"I have counted \" &amp; HighCount &amp; \" times High, \" &amp; ModerCount &amp; \" times Moderate, \" &amp; LowCount &amp; \" times Low, and respectively \" &amp; OpenCount &amp; \" and \" &amp; ClosedCount &amp; \" open and closed instances.\", vbOkOnly, \"FYI\"\n\nSheet1.Cells(8, 6) = HighCount\nEnd Sub\n</code></pre>\n\n<p>This would be one way of doing it, you can fill the cells necessary with those variables.</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1550647219, "creation_date": 1550647219, "answer_id": 54780843, "question_id": 54779940, "link": "https://stackoverflow.com/questions/54779940/nested-conditions-in-vba/54780843#54780843", "title": "Nested Conditions In VBA", "body": "<p>Why use VBA at all? This can be done with simple formulas. If you don't want to use pivot tables, manually create the headings (Blue in the screenshot), then put this formula into cell H3, copy across and down.</p>\n\n<pre><code>=COUNTIFS($A:$A,$G3&amp;\"*\",$B:$B,H$1,$C:$C,H$2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wZMbp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wZMbp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Change the layout if you want. The point is that you don't need VBA for that. Formulas will be a lot faster than re-inventing a CountIfs with VBA.</p>\n"}], "owner": {"reputation": 75, "user_id": 7676397, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f542dd3af6a5cb5d011eb1c26d88e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Singh", "link": "https://stackoverflow.com/users/7676397/ankit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550648647, "creation_date": 1550643274, "last_edit_date": 1550647459, "question_id": 54779940, "link": "https://stackoverflow.com/questions/54779940/nested-conditions-in-vba", "title": "Nested Conditions In VBA", "body": "<p>I am new to excel and VBA so apologies for silly question or mistake. </p>\n\n<p>i have some 2000 excel data in sheet2 and the data req in sheet 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/isFTa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/isFTa.png\" alt=\"Sample image please check this \"></a></p>\n\n<p>I need to know how many ticket which starts with INC and priority P2 P3 are there and same way how many tickets which starts with SR are there. also out of them how many are in closed state and how many are active.</p>\n\n<pre><code>Sub US_Data()\nDim z As Long\nDim C As Range\n\nz = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\nFor Each C In Sheet2.Range(Sheet2.Cells(2, 1), Sheet2.Cells(z, 1))\n  If Left(C.Value, 3) = \"INC\" Then\n    Sheet1.Cells(8, 6) = Sheet1.Cells(8, 6) + 1\n\n  End If\nNext C\nEnd Sub\n</code></pre>\n\n<p>Thank you </p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1550681156, "creation_date": 1550681156, "answer_id": 54791412, "question_id": 54779832, "link": "https://stackoverflow.com/questions/54779832/how-to-add-lag-to-the-predecessor-field-in-ms-project-using-vba/54791412#54791412", "title": "How to add lag to the predecessor field in MS Project using VBA", "body": "<p>It helps to remember that the Predecessor field shows the collection of <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.taskdependencies\" rel=\"nofollow noreferrer\">Task Dependencies</a> strung together (comma-separated). What you want to do is update that particular dependency, and not the whole collection. The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.taskdependency\" rel=\"nofollow noreferrer\">Task Dependency</a> object has several properties including <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.taskdependency.lag\" rel=\"nofollow noreferrer\">Lag</a>.</p>\n\n<p>In your scenario, you have a task with a single dependency and you want to add 2 hours to the lag, where <code>t</code> is your task and lag is represented in minutes:</p>\n\n<pre><code>t.TaskDependencies(1).Lag = t.TaskDependencies(1).Lag + 60 * 2\n</code></pre>\n\n<p>In more complicated scenarios the task will have multiple dependencies and you need to find the correct one. In this case, we set a lag of 2 days for the link to the predecessor task with the UniqueID of 2:</p>\n\n<pre><code>Dim td As TaskDependency\nFor Each td In t.TaskDependencies\n    If td.From.UniqueID = 2 Then\n        td.Lag = 60 * 8 * 2\n    End If\nNext td\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10505498, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160892956530133/picture?type=large", "display_name": "Marko Manenica", "link": "https://stackoverflow.com/users/10505498/marko-manenica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 54791412, "answer_count": 1, "score": 1, "last_activity_date": 1550681156, "creation_date": 1550642785, "question_id": 54779832, "link": "https://stackoverflow.com/questions/54779832/how-to-add-lag-to-the-predecessor-field-in-ms-project-using-vba", "title": "How to add lag to the predecessor field in MS Project using VBA", "body": "<p>I am trying to add a time lag to a predecessor field in MS Project and I am having difficulty when a lag already exists against that predecessor.</p>\n\n<p>For example, when its just a predecessor I just use:  </p>\n\n<pre><code>T.Predecessors + \"FS +\" &amp; Time_lag &amp; \" hrs\"\n</code></pre>\n\n<p>However if there is already a time lag i am struggling to work out how to add say another 2 hr lag when there is already a 3 hr lag associated with that task.</p>\n\n<p>I am sure there is a better way than using my text-based approach to adding the lag.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550643020, "post_id": 54779770, "comment_id": 96338593, "body": "If I have understood you correctly then you do not need VBA for this. A simple Pivot can help you out?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550643387, "post_id": 54779770, "comment_id": 96338747, "body": "@Siddharth Rout Unfortunately I cannot use a pivot table for what I am trying to accomplish. I would need and prefer to use VBA"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550643628, "post_id": 54779770, "comment_id": 96338843, "body": "Can you show a screenshot of your data and how the output should look like?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550644925, "post_id": 54779770, "comment_id": 96339375, "body": "@SiddharthRout created links to the images, cant actually post them on here yet"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550645112, "post_id": 54779770, "comment_id": 96339447, "body": "upload them to any free file uploading site and share the link here. I will upload it for you"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550645606, "post_id": 54779770, "comment_id": 96339638, "body": "@SiddharthRout i edited my post with two dropbox links"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1550651625, "post_id": 54781768, "comment_id": 96342485, "body": "the output was Sheet4 which is different, here is the link <a href=\"https://www.dropbox.com/s/izkvg8h2dgfe8yj/Capture2.PNG?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/izkvg8h2dgfe8yj/Capture2.PNG?dl=0</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1550651668, "post_id": 54781768, "comment_id": 96342510, "body": "if your output sheet is predefined then you do not need vba. You can simply use formulas"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1550651833, "post_id": 54781768, "comment_id": 96342588, "body": "If you put a formula <code>=SUMIFS(Sheet1!C:C,Sheet1!A:A,A2,Sheet1!B:B,B1)</code> in cell B2, you will get 42 :)"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1550652661, "post_id": 54781768, "comment_id": 96343013, "body": "long story short, I&#39;m downloading a WB file from our company site that has the data sheet. I&#39;m opening that downloaded file using VBA, and copying values with the loop. The file changes every day, and cannot be connected to"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1550652881, "post_id": 54781768, "comment_id": 96343132, "body": "Then all you have to do is change the last 2 lines of the code to match the output array with Col A and Row1 of Output sheet and then fill across. Would you like to give it a try?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1550650986, "creation_date": 1550650986, "answer_id": 54781768, "question_id": 54779770, "link": "https://stackoverflow.com/questions/54779770/how-to-use-loop-to-sum-categories/54781768#54781768", "title": "How to use loop to SUM categories?", "body": "<p>In this example, we will use arrays to achieve what you want. I have commented the code so that you shall not have a problem understanding it. However if you still do then simply ask :)</p>\n\n<p><strong>Input</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dPY6X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dPY6X.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/1mnAh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1mnAh.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Logic</strong></p>\n\n<ol>\n<li>Find last row and last column of input sheet</li>\n<li>Store in an array</li>\n<li>Get unique names from Column A and Row 1</li>\n<li>Define output array</li>\n<li>Compare array to store sum</li>\n<li>Create new sheet and output to that sheet</li>\n</ol>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ws As Worksheet, wsNew As Worksheet\n    Dim tempArray As Variant, OutputAr() As Variant\n    Dim officeCol As New Collection\n    Dim productCol As New Collection\n    Dim itm As Variant\n    Dim lrow As Long, lcol As Long, totalsum As Long\n    Dim i As Long, j As Long, k As Long\n\n    '~~&gt; Input sheet\n    Set ws = Sheet1\n\n    With ws\n        '~~&gt; Get Last Row and last column\n        lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        lcol = .Cells(1, Columns.Count).End(xlToLeft).Column\n\n        '~~&gt; Store it in a temp array\n        tempArray = .Range(.Cells(2, 1), .Cells(lrow, lcol)).Value\n\n        '~~&gt; Create a unique collection using On error resume next\n        On Error Resume Next\n        For i = LBound(tempArray) To UBound(tempArray)\n            officeCol.Add tempArray(i, 1), CStr(tempArray(i, 1))\n            productCol.Add tempArray(i, 2), CStr(tempArray(i, 2))\n        Next i\n        On Error GoTo 0\n    End With\n\n    '~~&gt; Define you new array which will hold the desired output\n    ReDim OutputAr(1 To officeCol.Count + 1, 1 To productCol.Count + 1)\n\n    '~~&gt; Store the rows and columns in the array\n    i = 2\n    For Each itm In officeCol\n        OutputAr(i, 1) = itm\n        i = i + 1\n    Next itm\n    i = 2\n    For Each itm In productCol\n        OutputAr(1, i) = itm\n        i = i + 1\n    Next itm\n\n    '~~&gt; Calculate sum by comparing the arrays\n    For i = 2 To officeCol.Count + 1\n        For j = 2 To productCol.Count + 1\n            totalsum = 0\n            For k = LBound(tempArray) To UBound(tempArray)\n                If OutputAr(i, 1) = tempArray(k, 1) And _\n                   OutputAr(1, j) = tempArray(k, 2) Then\n                   totalsum = totalsum + tempArray(k, 3)\n                End If\n            Next k\n\n            OutputAr(i, j) = totalsum\n        Next j\n    Next i\n\n    '~~&gt; Create a new sheet\n    Set wsNew = ThisWorkbook.Sheets.Add\n\n    '~~&gt; Outout the array\n    wsNew.Range(\"A1\").Resize(officeCol.Count + 1, productCol.Count + 1).Value = OutputAr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550651153, "creation_date": 1550642529, "last_edit_date": 1550651153, "question_id": 54779770, "link": "https://stackoverflow.com/questions/54779770/how-to-use-loop-to-sum-categories", "title": "How to use loop to SUM categories?", "body": "<p>I am trying to use a loop with vba to sum values from one worksheet to another. I am struggling with writing my code to match values from <code>Sheet 4</code> and if the value matches then sum the categories from <code>Sheet 1</code>, if not then skip to the next office. I would also like to exclude certain categories from being included in the SUM loop for example, exclude \"Book\". Currently my macro is writing to <code>Sheet3</code>. Here is my code:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim a, i As Long, ii As Long, dic As Object\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    dic.CompareMode = 1\n    a = Sheets(\"sheet1\").Cells(1).CurrentRegion.Value\n    With CreateObject(\"Scripting.Dictionary\")\n        .CompareMode = 1\n        For i = 2 To UBound(a, 1)\n            If Not dic.Exists(a(i, 1)) Then dic(a(i, 2)) = dic.Count + 2\n            If Not .Exists(a(i, 1)) Then\n                Set .Item(a(i, 1)) = CreateObject(\"Scripting.Dictionary\")\n                .Item(a(i, 1)).CompareMode = 1\n            End If\n            .Item(a(i, 1))(a(i, 2)) = .Item(a(i, 1))(a(i, 2)) + a(i, 3)\n        Next\n        ReDim a(1 To .Count + 1, 1 To dic.Count + 1)\n        a(1, 1) = Sheets(\"sheet1\").[a1]\n        For i = 0 To dic.Count - 1\n            a(1, i + 2) = dic.Keys()(i)\n        Next\n        For i = 0 To .Count - 1\n            a(i + 2, 1) = .Keys()(i)\n            For ii = 2 To UBound(a, 2)\n                a(i + 2, ii) = .items()(i)(a(1, ii)) + 0\n            Next\n        Next\n    End With\n    With Sheets(\"sheet3\").Cells(1).Resize(UBound(a, 1), UBound(a, 2))\n        .EntireColumn.ClearContents\n        Sheets(\"sheet1\").[a1].Copy .Rows(1)\n        .Value = a: .Columns.AutoFit: .Parent.Activate\n    End With\nEnd Sub\n</code></pre>\n\n<p>This is how the data looks</p>\n\n<p><a href=\"https://i.stack.imgur.com/ugF9g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ugF9g.png\" alt=\"enter image description here\"></a></p>\n\n<p>and this is the output that is desired</p>\n\n<p><a href=\"https://i.stack.imgur.com/nwh0M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nwh0M.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "edited": false, "score": 0, "creation_date": 1550642600, "post_id": 54779714, "comment_id": 96338406, "body": "Please post what you have done so far. Kindly follow <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1550656011, "post_id": 54779714, "comment_id": 96344993, "body": "You might want to google the &quot;File System Object&quot; - you&#39;ll find lots of examples that will help you"}], "owner": {"reputation": 1, "user_id": 11088114, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RxV0-VldMxI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNS-UWZve31bPNt_5z97GTMQtTSIA/mo/photo.jpg?sz=128", "display_name": "Narendra Patel", "link": "https://stackoverflow.com/users/11088114/narendra-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550642256, "creation_date": 1550642256, "question_id": 54779714, "link": "https://stackoverflow.com/questions/54779714/move-pdf-files-to-specific-folders-as-per-list-in-excel", "title": "Move PDF files to specific folders as per list in excel", "body": "<p>Experts., </p>\n\n<p>I have an Excel file Containing list of Folder names and a list of file names.</p>\n\n<p>Now i have a Folder with all PDF files , with same names as per list in excel., </p>\n\n<p>I need to make new Folders with names as per list of folder names in excel., and then transfer the pdf files in this folder as per the list in excel.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550646601, "post_id": 54779261, "comment_id": 96340055, "body": "Please edit your question and describe, how the captions should be, e. g. file name of each picture as text below it or headline above it?"}, {"owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550647749, "post_id": 54779261, "comment_id": 96340564, "body": "Captions should be inserted in the below of the each imaged loaded in to the word document in VBA. The code shows the loading of all images but not adding the file name of each below it."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550650957, "post_id": 54779261, "comment_id": 96342153, "body": "Where is your code embedded, in Excel?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "edited": false, "score": 0, "creation_date": 1550654731, "post_id": 54781574, "comment_id": 96344200, "body": "Thanks for update and its working. When I am trying to provide crossreference to each Inserted caption with vba, caption is not reflecting as hyperlinks. so that it can prepare the list of figures as index."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "edited": false, "score": 0, "creation_date": 1550654844, "post_id": 54781574, "comment_id": 96344262, "body": "Fine, then please consider to mark it as answer as explained here: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "edited": false, "score": 0, "creation_date": 1550655179, "post_id": 54781574, "comment_id": 96344501, "body": "Image name as a hyper link is not visible in the doc."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "edited": false, "score": 0, "creation_date": 1550655229, "post_id": 54781574, "comment_id": 96344538, "body": "I think that your initial question is answered, but you&#39;ve got a new code-problem now, so please consider asking a new question (<a href=\"https://stackoverflow.com/questions/ask\">stackoverflow.com/questions/ask</a>)"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1550650865, "last_edit_date": 1550650865, "creation_date": 1550650210, "answer_id": 54781574, "question_id": 54779261, "link": "https://stackoverflow.com/questions/54779261/how-to-insert-multiple-captions-for-multiple-images-present-in-word-for-example/54781574#54781574", "title": "How to insert multiple captions for multiple images present in word? For example &quot;Figure:1&quot; below image", "body": "<p>By this you get following order:<br>\n- the picture with a paragraph sign<br>\n- the image path with a paragraph sign<br>\n- a page break</p>\n\n<pre><code>For Each img In objFolder.Files\n    imgpath = img.Path\n    objSelection.InlineShapes.AddPicture (imgpath)\n    objSelection.InsertParagraphAfter\n    objSelection.InsertAfter imgpath\n    objSelection.InsertParagraphAfter\n    objSelection.Collapse wdCollapseEnd\n    objSelection.InsertBreak\nNext\n</code></pre>\n\n<hr>\n\n<p>Additionally I suggest to use <code>Option Explicit</code> at the beginning of each module, which forces a declaration of every variable (e. g. <code>Dim ImgPath as String</code>).</p>\n"}], "owner": {"reputation": 17, "user_id": 3785490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80313d75f959be45ce233147d44ad6a8?s=128&d=identicon&r=PG&f=1", "display_name": "srihari", "link": "https://stackoverflow.com/users/3785490/srihari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 54781574, "answer_count": 1, "score": 0, "last_activity_date": 1550651771, "creation_date": 1550639656, "last_edit_date": 1550651771, "question_id": 54779261, "link": "https://stackoverflow.com/questions/54779261/how-to-insert-multiple-captions-for-multiple-images-present-in-word-for-example", "title": "How to insert multiple captions for multiple images present in word? For example &quot;Figure:1&quot; below image", "body": "<p>I am able to add multiple images to a word document using VBA, but I am not able to add captions for multiple images loaded from folder path.<br>\nCan you please suggest on this:</p>\n\n<pre><code>Sub checking()\n    Dim strFolderPath\n    strFolderPath = \"C:\\images\"\n    Dim objWord\n    Dim objDoc\n    Dim objSelection\n    Dim objShapes\n    Dim objFSO\n    Dim objFolder\n\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(strFolderPath)\n    Set objDoc = objWord.Documents.Open(\"D:\\myfile.docx\")\n\n    objWord.Visible = True\n\n    Set objSelection = objWord.Selection\n\n    For Each Img In objFolder.Files\n        ImgPath = Img.Path\n        objSelection.InlineShapes.AddPicture (ImgPath)\n        objSelection.InsertBreak\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 1, "creation_date": 1550636886, "post_id": 54778751, "comment_id": 96336749, "body": "If you read from a file, that means the file gets open at some point. Even if you try avoiding calling <code>Application.Workbooks.Open(...)</code>, it will still be open."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550637705, "post_id": 54778751, "comment_id": 96336961, "body": "Query it with ADODB."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1550638695, "post_id": 54778751, "comment_id": 96337186, "body": "You can use <code>Microsoft.ACE.OLEDB.12.0</code> to get the data from a closed file. See <a href=\"https://stackoverflow.com/questions/15620080/reading-data-using-oledb-from-opened-excel-file\">THIS</a> example by Tim. The method can be used for both closed and open files"}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1550653613, "post_id": 54778751, "comment_id": 96343539, "body": "There is a function for that: <code>Range(&quot;targetRange&quot;).Value = ExecuteExcel4Macro(&quot;&#39;\\\\Path\\To\\Source\\Workbook\\[Workbook.nam&zwnj;&#8203;e]Sheetname&#39;!&quot; &amp; Range(&quot;SourceRange&quot;).Address(ReferenceStyle:=xlR1C1))</code>"}], "owner": {"reputation": 149, "user_id": 6943356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r749l.png?s=128&g=1", "display_name": "Paul Clarke", "link": "https://stackoverflow.com/users/6943356/paul-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550647451, "creation_date": 1550636147, "last_edit_date": 1550647451, "question_id": 54778751, "link": "https://stackoverflow.com/questions/54778751/vba-copying-values-from-range-in-an-closed-workbook", "title": "VBA - copying values from range in an closed workbook", "body": "<p>I'm trying to extract a range of data from a closed workbook without opening it due to it's size causing lag and the need to do this several times from different data files compounding the lag.</p>\n\n<p>I've tried the following;</p>\n\n<pre><code>Dim ExampleData as \"='C:\\Folder\\[examplefile.xls]Sheet1'!$A$1:$T$500\"\nWith Range(\"ExampleRange\")\n    .Formula = ExampleData\n    .Value = .Value\nEnd With\n</code></pre>\n\n<p>I understand what is going wrong there as it's simply pasting that formula in there, but other than looping through the entire range is there a way to use something similar?</p>\n\n<p>I've also tried doing the below with FileName as either a string, object or workbook but neither works</p>\n\n<pre><code>Dim FileName as String\nFileName = \"C:\\Folder\\examplefile.xls\"\nRange(\"ExampleTargetRange\").Value = FileName.Worksheets.Sheet1.Range(\"A1:T500\").Value\n</code></pre>\n\n<p>Ideally i'd like to be able to do a .Value = .Value scenario but i'm unsure if  it's possible while keeping the data file closed and any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1550636823, "post_id": 54778614, "comment_id": 96336723, "body": "you should also avoid <code>ActiveWorkbook</code> and use <code>ThisWorkbook</code> instead"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1550637220, "post_id": 54778614, "comment_id": 96336841, "body": "@alowflyingpig  I use <code>ThisWorkbook</code> only, It is macro generated code which I have changed to point to <code>Thisworkbook </code> in my actual code. It is not a problem area and has been shown only for reference."}], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550659659, "creation_date": 1550635143, "last_edit_date": 1550659659, "question_id": 54778614, "link": "https://stackoverflow.com/questions/54778614/problem-encountered-while-trying-to-remove-select-in-query-table-refresh-code", "title": "Problem encountered while trying to remove select in query table refresh code", "body": "<p>I have successfully connected to a text file as per given code by using Excel's Get &amp; Transform (Power Query) experience to connect to Text files.\nNext base text file is <code>Axis1.txt</code> which changes periodically.\nNext I went to refresh the query table  with latest data.\nI referred following references to learn about refreshing querytables</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39027286/how-to-reference-and-refresh-a-querytable-in-excel-2016-in-vba\">How to reference and refresh a QueryTable in Excel 2016 in VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/51982136/excel-vba-refresh-data-from-specific-source-without-dialog/51983783#51983783\">Excel VBA / Refresh data from specific source without dialog</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.querytable.refresh\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.querytable.refresh</a></p>\n\n<p><strong>Now my Problem</strong> . </p>\n\n<p>Out of all referred methods I could get success in refreshing table with latest data when one of the query table cell is selected and the following command is given.</p>\n\n<pre><code>Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>Other types of code syntax refereed in various posts encounter an error mentioned against each line.</p>\n\n<pre><code>Sub reresh1()\n'Sheet2.ListObject.QueryTable.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Wr1Q9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wr1Q9.jpg\" alt=\"errorl2\"></a></p>\n\n<pre><code>  'Sheets(\"Sheet2\").QueryTables.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6eIdi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6eIdi.jpg\" alt=\"errorl3\"></a></p>\n\n<pre><code>  Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n   'WORKS FINE\n\n   End Sub\n</code></pre>\n\n<p>Various other code syntax combinations were also tried but could not get success.</p>\n\n<pre><code>Sub TblImpV1()\n' Macro1 Macro\n    ActiveWorkbook.Queries.Add Name:=\"axis1\", Formula:= _but \n        \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Csv.Document(File.Contents(\"\"C:\\mydirb\\axis1.txt\"\"),[Delimiter=\"\"    \"\", Columns=11, Encoding=1252, QuoteStyle=QuoteStyle.None]),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Source,{{\"\"Column1\"\", Int64.Type}, {\"\"Column2\"\", type date}, {\"\"Column3\"\", type text}, {\"\"Column4\"\", type text}, {\"\"Column5\"\", type text}, {\"\"Column6\"\", type number}, {\"\"C\" &amp; _\n        \"olumn7\"\", type number}, {\"\"Column8\"\", type text}, {\"\"Column9\"\", type text}, {\"\"Column10\"\", type text}, {\"\"Column11\"\", type text}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n    ActiveWorkbook.Worksheets.Add\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n        \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=axis1;Extended Properties=\"\"\"\"\" _\n        , Destination:=Range(\"$A$1\")).QueryTable\n        .CommandType = xlCmdSql\n        .CommandText = Array(\"SELECT * FROM [axis1]\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"axis1\"\n        .Refresh BackgroundQuery:=False\n    End With\n    Range(\"B4\").Select\nEnd Sub\n</code></pre>\n\n<p>I Want to avoid Selection. Though procedure suggest that go to query table any cell and press refresh button.  I believe SO Experts posts on related matter must be right and I am doing something silly, due to my elementary knowledge of VBA Coding.\nAny help or guidance in this matter is welcome. Would appreciate full related syntax instead of one liners.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I could workout the solution to avoid the selection. Following code line works fine provided <code>B2</code> is a cell in the Query Table.</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"B2\").ListObject.QueryTable.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>However, If someone has a better solution , it is welcome.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11087712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1979924092076549/picture?type=large", "display_name": "Eduard G Abasula", "link": "https://stackoverflow.com/users/11087712/eduard-g-abasula"}, "edited": false, "score": 0, "creation_date": 1550634134, "post_id": 54778295, "comment_id": 96336127, "body": "where should i put the code sir ? i have no idea sorry im just a newbie hehe"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "reply_to_user": {"reputation": 1, "user_id": 11087712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1979924092076549/picture?type=large", "display_name": "Eduard G Abasula", "link": "https://stackoverflow.com/users/11087712/eduard-g-abasula"}, "edited": false, "score": 0, "creation_date": 1550634318, "post_id": 54778295, "comment_id": 96336164, "body": "That depends on what your code is. You didn&#39;t post anything."}, {"owner": {"reputation": 1, "user_id": 11087712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1979924092076549/picture?type=large", "display_name": "Eduard G Abasula", "link": "https://stackoverflow.com/users/11087712/eduard-g-abasula"}, "edited": false, "score": 0, "creation_date": 1550635010, "post_id": 54778295, "comment_id": 96336323, "body": "can i sen to you my code for command button sir so you can see it ..sorry for taking so much of your time but i really need a help my deadline of my project was these  coming friday"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "reply_to_user": {"reputation": 1, "user_id": 11087712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1979924092076549/picture?type=large", "display_name": "Eduard G Abasula", "link": "https://stackoverflow.com/users/11087712/eduard-g-abasula"}, "edited": false, "score": 1, "creation_date": 1550635098, "post_id": 54778295, "comment_id": 96336342, "body": "What you need to do is to post it in your question, this way more people will be able to help you."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1550653845, "post_id": 54778295, "comment_id": 96343677, "body": "Please also <code>Dim s as String</code> :)"}], "tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": false, "score": 2, "last_activity_date": 1550697884, "last_edit_date": 1550697884, "creation_date": 1550632842, "answer_id": 54778295, "question_id": 54778251, "link": "https://stackoverflow.com/questions/54778251/vb-getting-the-last-3-digit-number-in-textbox/54778295#54778295", "title": "VB getting the last 3 digit number in textbox", "body": "<p>Yes it is. Use <code>Right</code> function eg. </p>\n\n<pre><code>sub test()\n\nDim R3 as String, s as String\n\ns = \"123-234-456\"\nR3 = Right(s,3)\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 11087712, "user_type": "registered", "profile_image": "https://graph.facebook.com/1979924092076549/picture?type=large", "display_name": "Eduard G Abasula", "link": "https://stackoverflow.com/users/11087712/eduard-g-abasula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1550638191, "answer_count": 1, "score": -5, "last_activity_date": 1550697884, "creation_date": 1550632471, "question_id": 54778251, "link": "https://stackoverflow.com/questions/54778251/vb-getting-the-last-3-digit-number-in-textbox", "closed_reason": "Needs more focus", "title": "VB getting the last 3 digit number in textbox", "body": "<p>i have 16textbox and one command button for my userform and the textbox 1 are the one that i use to search for the data and display it from other textbox.</p>\n\n<p>my question is.</p>\n\n<p>it is possible for textbox1 to search only the last 3 digit number instead of 8 digit? wish can some answer my question.</p>\n\n<p>thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1550631846, "post_id": 54778013, "comment_id": 96335649, "body": "What does stepping through the code using the debugger tell you?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1550632314, "post_id": 54778013, "comment_id": 96335749, "body": "If your first <code>if</code> statement is <code>true</code> when <code>j=5</code> then it will count every time your outer <code>i</code> loop increments and <code>j</code> goes back to 5 thus giving you a total of 15.  It appears your double loop is flawed as you are cycling through rows for both <code>i</code> and <code>j</code>"}, {"owner": {"reputation": 1054, "user_id": 4496560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20182668dc86156a19fe0960ad09b244?s=128&d=identicon&r=PG", "display_name": "Gregor y", "link": "https://stackoverflow.com/users/4496560/gregor-y"}, "edited": false, "score": 0, "creation_date": 1550634595, "post_id": 54778013, "comment_id": 96336220, "body": "Does it have to be VBA? <code>=SUMPRODUCT((MONTH(D5:D20)=1)*(I5:I20=&quot;Housekeeping and Other Hazards&quot;))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1550638651, "last_edit_date": 1550638651, "creation_date": 1550633312, "answer_id": 54778362, "question_id": 54778013, "link": "https://stackoverflow.com/questions/54778013/using-a-for-loop-to-create-a-running-total-in-excel/54778362#54778362", "title": "Using a for loop to create a running total in excel", "body": "<p>I think this is what you mean to do although I would opt for the <strong>pivot table</strong> solution since pivots are dynamic by nature which is good in the long run. </p>\n\n<hr>\n\n<ol>\n<li>Your question implies that the criteria needs to be met for a single row but your loop is comparing your first date to all other rows for type. I believe you just want to increment the rows in unison. The easiest way to do that is just use one counter (<code>i</code>) to loop through the rows. </li>\n<li>If the <code>Housekeeping and Other Hazards</code> is a test that must be met for all of your inputs, just test that first outside of the loop. </li>\n<li>If you declare your variables properly, they will default to <code>0</code> and, more importantly, you will have more explicit code</li>\n<li><code>Select Case</code> works nicely here although an array solution would be better and this could be condensed to a shorter code with loop</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Jan\")\nDim i As Long\n\nDim Jan As Long, Feb As Long, Mar As Long, Apr As Long, May As Long, Jun As Long, _\n    Jul As Long, Aug As Long, Sep As Long, Oct As Long, Nov As Long, Dec As Long\n\nFor i = 5 To 20\n    If ws.Range(\"I\" &amp; i) = \"Housekeeping and Other Hazards\" Then\n        Select Case Month(ws.Range(\"D\" &amp; i))\n            Case 1\n                Jan = Jan + 1\n            Case 2\n                Feb = Feb + 1\n            Case 3\n                Mar = Mar + 1\n            Case 4\n                Apr = Apr + 1\n            Case 5\n                May = May + 1\n            Case 6\n                Jun = Jun + 1\n            Case 7\n                Jul = Jul + 1\n            Case 8\n                Aug = Aug + 1\n            Case 9\n                Sep = Sep + 1\n            Case 10\n                Oct = Oct + 1\n            Case 11\n                Nov = Nov + 1\n            Case 12\n                Dec = Dec + 1\n        End Select\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>A pivot table solution would look something like the below photo. If you swap the row fields, you can even filter by type (the current view lets you filter by date). You can use <code>GETPIVOTDATA</code> to set cells equal to certain conditions of the pivot table much like your macro aims to do at the end</p>\n\n<p><a href=\"https://i.stack.imgur.com/COVyc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/COVyc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11087823"}, "is_accepted": false, "score": 0, "last_activity_date": 1550634225, "creation_date": 1550634225, "answer_id": 54778485, "question_id": 54778013, "link": "https://stackoverflow.com/questions/54778013/using-a-for-loop-to-create-a-running-total-in-excel/54778485#54778485", "title": "Using a for loop to create a running total in excel", "body": "<p>You are looping through <em>j</em> but using <em>i</em> to retrieve the date into <em>DateCheckLoop</em>.</p>\n\n<p>You've provided no indication what <em>i</em> could be so determining the value at <code>Worksheets(\"Jan\").Cells(i, 4)</code> is impossible. I can offer that the MONTH of anything between 1 and 31 will be 1.</p>\n\n<p>This is repeated every loop as <em>i</em> is never changed.</p>\n"}], "owner": {"reputation": 5, "user_id": 10813714, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YyjBAiB3Vto/AAAAAAAAAAI/AAAAAAAABLM/4LhZYo2CP7w/photo.jpg?sz=128", "display_name": "Yusuf Tarajia", "link": "https://stackoverflow.com/users/10813714/yusuf-tarajia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 54778362, "answer_count": 2, "score": 0, "last_activity_date": 1550638651, "creation_date": 1550630213, "last_edit_date": 1550631681, "question_id": 54778013, "link": "https://stackoverflow.com/questions/54778013/using-a-for-loop-to-create-a-running-total-in-excel", "title": "Using a for loop to create a running total in excel", "body": "<p>I'm trying to write a code to count the number of instances where a certain date AND a particular string occurs together in a database. I've written the following For Loop. However, the output for \"JanHousekeeping\" returns a value of 15.</p>\n\n<p>The set of sample data that I am using looks like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tchKb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tchKb.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have 3 instances of \"Housekeeping and other Hazards\" but the loop returns a value of 15. Why is this and how could I fix this? Thank you in advance for the help!</p>\n\n<pre><code>Sub SummarySync()\n\n\n  JanHousekeeping = 0\n  FebHousekeeping = 0\n  MarHousekeeping = 0\n  AprHousekeeping = 0\n  MayHousekeeping = 0\n  JunHousekeeping = 0\n  JulHousekeeping = 0\n  AugHousekeeping = 0\n  SepHousekeeping = 0\n  OctHousekeeping = 0\n  NovHousekeeping = 0\n  DecHousekeeping = 0\n\n  For i = 5 To 20\n    For j = 5 To 20\n      DateCheckLoop = Worksheets(\"Jan\").Cells(i, 4)\n      ObsCheck = Worksheets(\"Jan\").Cells(j, 9).Value\n\n       If Month(DateCheckLoop) = 1 And ObsCheck = \"Housekeeping and Other Hazards\" Then\n          JanHousekeeping = JanHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 2 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          FebHousekeeping = FebHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 3 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          MarHousekeeping = MarHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 4 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          AprHousekeeping = AprHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 5 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          MayHousekeeping = MayHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 6 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          JunHousekeeping = JunHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 7 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          JulHousekeeping = JulHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 8 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          AugHousekeeping = AugHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 9 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          SepHousekeeping = SepHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 10 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          OctHousekeeping = OctHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 11 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          NovHousekeeping = NovHousekeeping + 1\n       ElseIf Month(Worksheets(\"Jan\").Cells(i, 4)) = 12 And Worksheets(\"Jan\").Cells(j, 9).Value = \"Housekeeping and Other Hazards\" Then\n          DecHousekeeping = DecHousekeeping + 1\n       Else\n       End If\n     Next j\n   Next i\n\n   Sheets(\"Site Visit Summary\").Range(\"DateJan\").Offset(1, 0) = JanHousekeeping       \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1550633970, "post_id": 54777816, "comment_id": 96336085, "body": "Can you share your code please? Will this always be 3 sheets or is this just an example?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11087532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VNRolpTSdEU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMuO9S2G3M8T00_MuQO5WPyoNNqzA/mo/photo.jpg?sz=128", "display_name": "Paul Lim", "link": "https://stackoverflow.com/users/11087532/paul-lim"}, "edited": false, "score": 0, "creation_date": 1550711786, "post_id": 54788613, "comment_id": 96373071, "body": "The code works well. Now I want to fit each sheet into one PDF page. I tried adding the following code, but it gave me a Run-time error &#39;438&#39;. How would I add these, or is there another approach? &#39;wb.PageSetup .Zoom = False .FitToPagesWide = 1 .FitToPagesTall = 1&#39;"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 15, "user_id": 11087532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VNRolpTSdEU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMuO9S2G3M8T00_MuQO5WPyoNNqzA/mo/photo.jpg?sz=128", "display_name": "Paul Lim", "link": "https://stackoverflow.com/users/11087532/paul-lim"}, "edited": false, "score": 0, "creation_date": 1550713032, "post_id": 54788613, "comment_id": 96373378, "body": "@Paul Lim: I literally know nothing about it. You&#39;ll have to ask another question. Sorry."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1550684696, "last_edit_date": 1550684696, "creation_date": 1550672763, "answer_id": 54788613, "question_id": 54777816, "link": "https://stackoverflow.com/questions/54777816/excel-vba-to-export-specific-sheets-based-on-cell-values-to-pdf/54788613#54788613", "title": "Excel VBA to export specific sheets based on cell values to PDF", "body": "<h1>Sheets As PDF</h1>\n\n<h2>Links</h2>\n\n<p><a href=\"https://stackoverflow.com/questions/22796286/export-multiple-sheets-to-pdf-simultaneously-without-using-activesheet-or-select\">Export multiple sheets to PDF simultaneously without using ActiveSheet or Select</a> (SO)</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.exportasfixedformat\" rel=\"nofollow noreferrer\">Workbook.ExportAsFixedFormat method (Excel)</a> (Microsoft)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/52058318/vba-add-sheets-to-variable-and-move-to-new-workbook\">VBA - Add sheets to variable and move to new workbook</a> (SO)</p>\n\n<p><strong>Short Description (not 100% precise)</strong></p>\n\n<p>The Improved Fast Array Version copies the Source Range into the Range Array. By looping through the elements of the Range Array, it checks for the Criteria and if found, writes the appropriate Sheet name to the Sheet Array. When done, it 'adjusts' the Sheet Array and copies the sheets (in one go) to a new workbook, which is then exported as PDF, before it is closed.</p>\n\n<h2>Improved Fast Array Version</h2>\n\n<pre><code>'*******************************************************************************\n' Purpose:    In a workbook, exports sheets that meet criteria as PDF.\n'*******************************************************************************\nSub SheetsAsPDF()\n\n    Const cSheets As String = \"Sheet1,Sheet2,Sheet3\"    ' Sheet List\n    Const cSheet As String = \"Sheet4\"                   ' Source Worksheet\n    Const cRange As String = \"A1:A3\"                    ' Source Range Address\n    Const cCrit As Long = 1                             ' Criteria\n    Const cExport As String = \"Eport.pdf\"               ' Export Filename\n\n    Dim wb As Workbook    ' Export Workbook\n    Dim Cell As Range     ' Current Cell Range (For Each Control Variable)\n    Dim vntS As Variant   ' Sheet Array\n    Dim vntR As Variant   ' Range Array\n    Dim i As Long         ' Range Array Element (Row) Counter\n    Dim iTarget As Long   ' Target Element (Row) Counter\n\n    ' **********************************\n    ' Copy Sheets to New workbook.\n    ' **********************************\n\n    ' Reset Target Counter.\n    iTarget = -1\n\n    ' Copy (split) sheet names from Sheet List to 1D 0-based Sheet Array.\n    vntS = Split(cSheets, \",\")\n\n    ' Copy Source Range in Source Worksheet to 2D 1-based 1-column Range Array.\n    vntR = ThisWorkbook.Worksheets(cSheet).Range(cRange)\n    ' Loop through elements (rows) of Range Array (in its first (only) column).\n    ' Note: Not obvious, one might say that the elements (rows) of Sheet Array\n    ' are 'also being looped', but the counter is by 1 less.\n    For i = 1 To UBound(vntR)\n        ' Check if current value in Range Array (vntR) is equal to Criteria\n        ' (cCrit). Range Array is 2D (,1).\n        If vntR(i, 1) = cCrit Then  ' Current value is equal to Criteria.\n            ' Counter (add 1 to) Target Counter (iTarget).\n            iTarget = iTarget + 1\n            ' Write value of current element (row) of Sheet Array to the\n            ' 'iTarget-th' element (row). Note: Values are being overwritten.\n            ' Remarks\n              ' Sheet Array is a zero-based array i.e. the index number of its\n              ' first element is 0, NOT 1. Therefore i - 1 has to be used,\n              ' which was previously indicated with 'also being looped'.\n              ' Trim is used to avoid mistakes if the Sheet Name List is not\n              ' properly written e.g. \"Sheet1, Sheet2,Sheet3,  Sheet4\".\n            vntS(iTarget) = Trim(vntS(i - 1))\n          'Else                      ' Current value is NOT equal to Criteria.\n        End If\n    Next ' Element (row) of Range Array (vntR).\n    ' Check if there were any values that were equal to Criteria (cCrit) i.e.\n    ' if there are any worksheets to export.\n    If iTarget = -1 Then Exit Sub\n    ' Resize Sheet Array to the value (number) of Target Counter (iTarget).\n    ReDim Preserve vntS(iTarget) ' Note: Values are being deleted.\n    ' Copy sheets of Sheet Array to New Workbook.\n    ' Remarks\n      ' When Copy (for copying sheets) is used without arguments, it will copy\n      ' a sheet (array) to a NEW workbook.\n    ThisWorkbook.Sheets(vntS).Copy\n\n    ' **********************************\n    ' Export New Workbook to PDF\n    ' **********************************\n\n    ' Create a reference (wb) to New Workbook which became the ActiveWorkbook\n    ' after it had previously been 'created' using the Copy method.\n    Set wb = ActiveWorkbook\n    ' In New Workbook\n    With wb\n        ' Export New Workbook to PDF.\n        wb.ExportAsFixedFormat Type:=xlTypePDF, Filename:=cExport, _\n                Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, OpenAfterPublish:=True\n        ' Close New Workbook. False suppresses the message that asks for\n        ' saving it.\n        wb.Close False\n        ' Remarks:\n        ' Change this if you might want to save this version of New Workbook\n        ' e.g.\n        'wb.SaveAs \"WB\" &amp; Format(Date, \"yyyymmdd\") &amp; \".xls\"\n    End With\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n\n<h2>First Slow Range/Worksheet Version</h2>\n\n<pre><code>'*******************************************************************************\n' Purpose:    In a workbook, exports sheets that meet criteria to PDF.\n'*******************************************************************************\nSub SheetsToPDF()\n\n    Const cESheets As String = \"Sheet1,Sheet2,Sheet3\"   ' Sheet Name List\n    Const cSheet As String = \"Sheet4\"                   ' Source Worksheet\n    Const cRange As String = \"A1:A3\"                    ' Source Range Address\n    Const cCrit As Long = 1                             ' Criteria\n\n    Dim wb As Workbook    ' Export Workbook\n    Dim Cell As Range     ' Current Cell Range (For Each Control Variable)\n    Dim vntS As Variant   ' Sheet Name Array\n    Dim iFound As Long    ' Found Criteria Counter\n\n    ' **********************************\n    ' Copy Sheets to New workbook.\n    ' **********************************\n\n    ' Copy (split) worksheet names from Sheet Name List to Sheet Name Array.\n    vntS = Split(cESheets, \",\")\n\n    ' In Source Workbook (ThisWorkbook)\n    With ThisWorkbook\n        ' Loop through cells (Cell) in Source Range (.Range(cRange)).\n        For Each Cell In .Worksheets(cSheet).Range(cRange)\n            ' Check if Current Cell Range (Cell) meets Criteria (cCrit).\n            If Cell.Value = cCrit Then ' Cell that meets Criteria was found.\n                ' Add 1 to Found Criteria Counter (iFound).\n                iFound = iFound + 1\n                ' Check if New Workbook already exists.\n                If iFound = 1 Then  ' Used only the first time.\n                    ' Copy sheet with the sheet name found in Sheet Name Array\n                    ' to New Workbook.\n                    ' Remarks\n                      ' When Copy (for copying sheets) is used without\n                      ' arguments, it will copy a sheet to a new workbook,\n                      ' where it will be the only sheet.\n                      ' Sheet Name Array is a zero-based array, meaning the\n                      ' index number of its first element is 0, NOT 1.\n                      ' Therefore iFound-1 has to be used.\n                      ' Trim is used to avoid mistakes if the Sheet Name List\n                      ' is not properly written e.g.\n                      ' \"Sheet1, Sheet2,Sheet3,  Sheet4\".\n                    .Sheets(Trim(vntS(iFound - 1))).Copy\n                    ' Create a reference (wb) to New Workbook which became\n                    ' the ActiveWorkbook after the previous Copy method\n                    ' 'had created it'.\n                    Set wb = ActiveWorkbook\n                  Else              ' Used every time, except the first time.\n                    ' Since the New Workbook has already been created (i&gt;1),\n                    ' worksheets can be added to it:\n                    ' Copy current sheet after last sheet\n                    ' (wb.Sheets(wb.Sheets.Count)) in New Workbook.\n                    .Sheets(Trim(vntS(iFound - 1))).Copy _\n                            After:=wb.Sheets(wb.Sheets.Count)\n                End If\n              'Else                     ' Cell that meets Criteria NOT found.\n            End If\n        Next\n    End With\n\n    ' **********************************\n    ' Export New Workbook to PDF\n    ' **********************************\n\n    ' Check if there were any (iFound) cells that met the criteria (cCrit)\n    ' iFound.e. if there are any worksheets to export.\n    If iFound = 0 Then Exit Sub\n\n    ' In New Workbook\n    With wb\n        ' Export New Workbook to PDF.\n        .ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"Exported.pdf\", _\n                Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, OpenAfterPublish:=True\n        ' Close New Workbook. False suppresses the message for saving it.\n        .Close False\n        ' Remarks:\n        ' Change this if you might want to save this version of New Workbook\n        ' e.g.\n        '.SaveAs \"WB\" &amp; Format(Date, \"yyyymmdd\") &amp; \".xls\"\n    End With\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11087532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VNRolpTSdEU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMuO9S2G3M8T00_MuQO5WPyoNNqzA/mo/photo.jpg?sz=128", "display_name": "Paul Lim", "link": "https://stackoverflow.com/users/11087532/paul-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 54788613, "answer_count": 1, "score": 0, "last_activity_date": 1569936879, "creation_date": 1550628634, "last_edit_date": 1550673272, "question_id": 54777816, "link": "https://stackoverflow.com/questions/54777816/excel-vba-to-export-specific-sheets-based-on-cell-values-to-pdf", "title": "Excel VBA to export specific sheets based on cell values to PDF", "body": "<p>I would like to use cell values on <strong>Sheet 4</strong> to select and export <strong>Sheet 1</strong>, <strong>Sheet 2</strong>, and <strong>Sheet 3</strong> as one PDF file.</p>\n\n<p>For example, if <strong>Sheet 4's</strong> A1=1, A2=1, and A3=0, then it would print <strong>Sheet 1</strong> and <strong>Sheet 2</strong>, but not <strong>Sheet 3</strong>.</p>\n\n<p>I tried to use the IF function to create an array of sheets, but I have not been successful. </p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "windows"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550638349, "post_id": 54777582, "comment_id": 96337096, "body": "Why do you have company secrets in your code in the first place? <a href=\"https://stackoverflow.com/q/1026483/4088852\">The password on VBA projects is trivial to break</a>. If you have a back-end, let it handle the credentialing. If queries contain proprietary information, put them in views. The <i>real</i> problem is that your code has put you in a position where this matters. Fix that instead."}, {"owner": {"reputation": 1, "user_id": 5372301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3189f9a69ae60a77c5fb1310d49ce73?s=128&d=identicon&r=PG&f=1", "display_name": "Anima", "link": "https://stackoverflow.com/users/5372301/anima"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1550640786, "post_id": 54777582, "comment_id": 96337761, "body": "That is the idea longer term, but the protection will still be used to ensure no changes are made locally. So the protection is used two-fold."}], "owner": {"reputation": 1, "user_id": 5372301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3189f9a69ae60a77c5fb1310d49ce73?s=128&d=identicon&r=PG&f=1", "display_name": "Anima", "link": "https://stackoverflow.com/users/5372301/anima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550627035, "creation_date": 1550627035, "question_id": 54777582, "link": "https://stackoverflow.com/questions/54777582/excel-stops-running-protected-workbook-runs-fine-if-unlocking-it", "title": "Excel stops running protected workbook, runs fine if unlocking it", "body": "<p>I have a tool, which uses VBA.</p>\n\n<p>As the tool has company secrets, the project is password protected to avoid the info getting into the wrong hands (to some extent). Therefore, as soon as anyone wants to \"view code\", they have to put in the password.</p>\n\n<p>The tool has a simple GUI, which just loads values from various worksheets and displays them with simple VBA controls.</p>\n\n<p>In some version updates of the tool, excel stops running when trying to load the GUI. No error codes are displayed. In others, work just fine. I don't know what causes this. The updates are simple changes to formulas, updating of price structuring and the like. </p>\n\n<p>If i put in the password before loading the GUI, it works just fine. This, however, is not a good workaround if i want to deploy the tool to anyone who is not authorized to view the internal info.</p>\n\n<p>Any ideas how to debug this issue?</p>\n\n<p>Windows 10 64-bit\nExcel 365\nDell Latitude PC</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 7354851, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1c364dad5c8a6aa98d96e20e9369c670?s=128&d=identicon&r=PG&f=1", "display_name": "sql scholar", "link": "https://stackoverflow.com/users/7354851/sql-scholar"}, "edited": false, "score": 0, "creation_date": 1551117013, "post_id": 54777083, "comment_id": 96514190, "body": "Hi! Unfortunately that doesn&#39;t really work for me as expected. It will email the entire table, however there will be some filtering and I only want to email the filtered out data (which xCellTypeVisible does fine).  ListObjects(&quot;Table1&quot;).Range WILL include the header though, but also a lot of rows that are actually filtered out.  I&#39;d want to email only header + result of the filtered rows (and not send out a plain header in case filtering will not result in any matches)."}], "tags": [], "owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "is_accepted": false, "score": 1, "last_activity_date": 1550625508, "last_edit_date": 1550625508, "creation_date": 1550623119, "answer_id": 54777083, "question_id": 54776757, "link": "https://stackoverflow.com/questions/54776757/return-filtered-excel-table-with-headers/54777083#54777083", "title": "Return filtered Excel table with headers", "body": "<p>Instead of using this</p>\n\n<pre><code>Set rng = Sheets(\"Sheet1\").Range(\"Table1\").SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>replace it with</p>\n\n<pre><code>Set rng = Sheets(\"Sheet1\").ListObjects(\"Table1\").Range\n</code></pre>\n\n<p>The 1st one you used only copy the data of the table. The 2nd code I put will get the whole range of the table header + the data on the table</p>\n"}], "owner": {"reputation": 179, "user_id": 7354851, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1c364dad5c8a6aa98d96e20e9369c670?s=128&d=identicon&r=PG&f=1", "display_name": "sql scholar", "link": "https://stackoverflow.com/users/7354851/sql-scholar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607421062, "creation_date": 1550620736, "last_edit_date": 1607421062, "question_id": 54776757, "link": "https://stackoverflow.com/questions/54776757/return-filtered-excel-table-with-headers", "title": "Return filtered Excel table with headers", "body": "<p>I'm using code by Ron de Bruin to e-mail Excel Table with Outlook.</p>\n<p>I'm getting the data range but missing the headers.</p>\n<p>I do some filtering which can result in a blank range and this should not be sent (current code facilitates it nicely with <code>If rng Is Nothing Then</code>)</p>\n<p><em>edit: proposing a potential direction</em></p>\n<p>Could I define a new range <code>Range1</code> which includes Table1 + its header?<br />\nTested it and the code runs + is including the header, however <code>Range1</code> is never empty now, even if filtering provides 0 rows.</p>\n<pre><code>Set rng = Sheets(&quot;Sheet1&quot;).Range(&quot;Range1&quot;).SpecialCells(xlCellTypeVisible)\n</code></pre>\n<p>The header will now provide one row and <code>rng</code> is never <code>Nothing</code>. Can this code be adjusted to exit with one visible row, instead of <code>Nothing</code>?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Mail_Selection_Range_Outlook_Body()\n    'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    'Don't forget to copy the function RangetoHTML in the module.\n    'Working in Excel 2000-2016\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n    \n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    'Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    Set rng = Sheets(&quot;Sheet1&quot;).Range(&quot;Table1&quot;).SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n    \n    If rng Is Nothing Then\n    '    MsgBox &quot;The selection is not a range or the sheet is protected&quot; &amp; _\n    '           vbNewLine &amp; &quot;please correct and try again.&quot;, vbOKOnly\n        Exit Sub\n    End If\n    \n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n    \n    Set OutApp = CreateObject(&quot;Outlook.Application&quot;)\n    Set OutMail = OutApp.CreateItem(0)\n    \n    On Error Resume Next\n    With OutMail\n        .To = &quot;test@mail.com&quot;\n        .CC = &quot;&quot;\n        .BCC = &quot;&quot;\n        .Subject = &quot;This is the Subject line&quot;\n        .HTMLBody = &quot;HARDCODED HEADER?&quot; &amp; RangetoHTML(rng)\n        .Display   'or use .Send\n    End With\n    On Error GoTo 0\n    \n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n    \n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n    \n    \nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n    \n    TempFile = Environ$(&quot;temp&quot;) &amp; &quot;\\&quot; &amp; Format(Now, &quot;dd-mm-yy h-mm-ss&quot;) &amp; &quot;.htm&quot;\n    \n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n    \n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n          SourceType:=xlSourceRange, _\n          Filename:=TempFile, _\n          Sheet:=TempWB.Sheets(1).Name, _\n          Source:=TempWB.Sheets(1).UsedRange.Address, _\n          HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n    \n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, &quot;align=center x:publishsource=&quot;, _\n                          &quot;align=left x:publishsource=&quot;)\n    \n    'Close TempWB\n    TempWB.Close savechanges:=False\n    \n    'Delete the htm file we used in this function\n    Kill TempFile\n    \n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf-generation"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1550620840, "post_id": 54776563, "comment_id": 96333226, "body": "It looks fairly clean code to me (except could not clearly get counter +.6 stuff). May wait for more experienced expert&#39;s to answer or comment."}, {"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 0, "creation_date": 1550621132, "post_id": 54776563, "comment_id": 96333300, "body": "Is it taking an excessive amount of time on any specific line? If it&#39;s on <code>ActiveSheet.ExportAsFixedFormat</code> the that&#39;s the time it takes to export."}, {"owner": {"reputation": 35, "user_id": 10747454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737bc085119dcbcd383c446789e699ae?s=128&d=identicon&r=PG&f=1", "display_name": "A Kapadia", "link": "https://stackoverflow.com/users/10747454/a-kapadia"}, "edited": false, "score": 0, "creation_date": 1550623140, "post_id": 54776563, "comment_id": 96333759, "body": "Yes. That\u2019s what I\u2019m trying to figure out. How do I speed up the export time?"}, {"owner": {"reputation": 35, "user_id": 10747454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737bc085119dcbcd383c446789e699ae?s=128&d=identicon&r=PG&f=1", "display_name": "A Kapadia", "link": "https://stackoverflow.com/users/10747454/a-kapadia"}, "edited": false, "score": 0, "creation_date": 1550623233, "post_id": 54776563, "comment_id": 96333782, "body": "In my export file from which I\u2019m importing data into this excel file the borrower names are every 6 columns, hence + 6"}], "owner": {"reputation": 35, "user_id": 10747454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737bc085119dcbcd383c446789e699ae?s=128&d=identicon&r=PG&f=1", "display_name": "A Kapadia", "link": "https://stackoverflow.com/users/10747454/a-kapadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550619309, "creation_date": 1550619309, "question_id": 54776563, "link": "https://stackoverflow.com/questions/54776563/speed-up-save-to-pdf-excel-2016-vba", "title": "Speed up Save to PDF Excel 2016 VBA", "body": "<p>I'm trying to figure out if there is a quicker way in my program to save to pdf. When I run the following code, it takes about 25 seconds for it to save each pdf file I have. I have narrowed the bottleneck to the save to pdf code by stepping through the code. I tried turning the automatic calculation to manual but that didn't help.</p>\n\n<p>Basically, what this script is doing is checking how many loan borrowers there are (customer packages may be less than but will never be more than 4), then populating some data and then printing a some worksheets.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>`customerpackages = 0\n\nFor counter = 1 To 19\n    If Sheets(\"Loan Data\").Cells(2, counter) &lt;&gt; \"\" Then\n    customerpackages = customerpackages + 1\n    counter = counter + 6\n    End If\nNext counter\n\nFor j = 1 To (customerpackages * 2)\n    Sheets(\"Certification\").Range(\"G43\").Value = ssn_array(j - 1)\n    Sheets(\"Certification\").Range(\"G46\").Value = ssn_array(j)\n    Sheets(\"Anti-steering\").Cells(3, 1).Value = borrower_array(j - 1)\n    Sheets(\"Anti-steering\").Cells(4, 1).Value = borrower_array(j)\n    If borrower_array(j) = \" \" Then\n        Sheets(\"Rate Lock\").Cells(10, 1).Value = \"NAME : \" &amp; borrower_array(j - 1)\n    Else\n        Sheets(\"Rate Lock\").Cells(10, 1).Value = \"NAME : \" &amp; borrower_array(j - 1) &amp; \" and\" &amp; borrower_array(j)\n    End If\n    Worksheets(common_disclosures).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\users\\\" &amp; environ_user &amp; \"\\desktop\\\" &amp; borrower_array(j - 1) &amp; \" \n    disclosures.pdf\" _\n    , Quality:=xlQualityMinimum, IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, OpenAfterPublish:=False\n    j = j + 1\nNext j`\n</code></pre>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1550619063, "post_id": 54776238, "comment_id": 96332770, "body": "Hi, this site is to help those who hav done research and shown they have attempted to write code. Once you do some research, write your code and if it dosn&#39;t work, please then post back and we can review."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1550619068, "post_id": 54776238, "comment_id": 96332772, "body": "Can you show what your expected output would be?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550620421, "post_id": 54776238, "comment_id": 96333139, "body": "Are you open to a pivot table solution? Or excel function solution? This does not have to be VBA"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550620556, "post_id": 54776238, "comment_id": 96333168, "body": "It looks like this is also a function of your <code>Ship</code> <code>No Ship</code> results. Can you confirm more of the logic here? What is your Index column? How is this populated?"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1550666317, "creation_date": 1550666317, "answer_id": 54786583, "question_id": 54776238, "link": "https://stackoverflow.com/questions/54776238/vba-macro-to-sum-by-group/54786583#54786583", "title": "VBA macro to sum by group", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Lastrow As Long, i As Long, CurrentIndex As Long, NextIndex As Long, WholeIndex As Long\n    Dim CurrentKey As String, NextKey As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 2 To Lastrow\n\n            CurrentKey = .Range(\"B\" &amp; i).Value &amp; \"_\" &amp; .Range(\"C\" &amp; i).Value &amp; \"_\" &amp; .Range(\"D\" &amp; i).Value &amp; \"_\" &amp; .Range(\"E\" &amp; i).Value\n            CurrentIndex = .Range(\"D\" &amp; i).Value\n            NextKey = .Range(\"B\" &amp; i + 1).Value &amp; \"_\" &amp; .Range(\"C\" &amp; i + 1).Value &amp; \"_\" &amp; .Range(\"D\" &amp; i + 1).Value &amp; \"_\" &amp; .Range(\"E\" &amp; i + 1).Value\n            NextIndex = .Range(\"D\" &amp; i + 1).Value\n\n            If CurrentKey = NextKey Then\n                    If WholeIndex = 0 Then\n                        WholeIndex = CurrentIndex + NextIndex\n                    Else\n                        WholeIndex = WholeIndex + NextIndex\n                    End If\n            Else\n                If WholeIndex &gt; 1 Then\n                    .Range(\"F\" &amp; i).Value = WholeIndex\n\n                End If\n\n                WholeIndex = 0\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6780387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/918d2ec7a624efe89408ae74d22bc2bb?s=128&d=identicon&r=PG&f=1", "display_name": "JasonFromKY", "link": "https://stackoverflow.com/users/6780387/jasonfromky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550694707, "creation_date": 1550617379, "last_edit_date": 1550694707, "question_id": 54776238, "link": "https://stackoverflow.com/questions/54776238/vba-macro-to-sum-by-group", "title": "VBA macro to sum by group", "body": "<p>suppose I have a table looks like this:\n<a href=\"https://i.stack.imgur.com/eolJb.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/O9Q4W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O9Q4W.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to count the total number by (from to index), the desired output will look like this as in last column:\n <a href=\"https://i.stack.imgur.com/PDhyy.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/yrws2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yrws2.png\" alt=\"enter image description here\"></a></p>\n\n<p>please advise how to achieve this in VBA macro, thanks in advance!!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1550616833, "post_id": 54776135, "comment_id": 96332188, "body": "You need to loop the range and test each cell individually."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1550646765, "post_id": 54776135, "comment_id": 96340127, "body": "Note that you are using invalid quotes <code>\u201c \u201d</code> these arae not allowed in VBA change them to the regular ones <code>&quot; &quot;</code>! The fancy ones you are using do not work."}], "answers": [{"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550623654, "post_id": 54776730, "comment_id": 96333882, "body": "@urdearboy: FE: 11, FN: 13, Y: 22, YFE: 17 and this time ms (mili seconds) of course. As we both knew, nothing unbearable."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550624436, "post_id": 54776730, "comment_id": 96334046, "body": "@urdearboy: I don&#39;t thinks so. You just do your thing, be creative and when an efficiency issue occurs, you&#39;ll know how to solve it anyway. I&#39;ve encountered something similar with <b>CountIf</b> against <b>Match</b> where <b>CountIf</b> does the whole range for each value, but <b>Match</b> stops as soon a value is found."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550624609, "post_id": 54776730, "comment_id": 96334077, "body": "Just so you know, neither of the For Next Loop of For Each Loop solutions above did anything to the cells in column A, so not able to use those as is. A shame, as they add the ability to use multiple formats, like cell and font color"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550624894, "post_id": 54776730, "comment_id": 96334132, "body": "@honkin: I don&#39;t know how you have used them, but for starters you should use <b>Thisworkbook.Worksheets(&quot;Sheet3&quot;).Range</b> (&quot;Sheet3&quot; mentioned in the comments) instead of <b>Range</b> and not forget to change the values for the <b>FA_Win..</b> constants or lose them, but you have to add <b>Const cRange As String = &quot;A2:A70&quot;</b>.."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550625419, "post_id": 54776730, "comment_id": 96334229, "body": "Apologies @Vbasic2008; this is one part of Excel I am extremely new to. I simply copied and pasted your code as is to the code area.   So the Thisworkbook.Worksheets(&quot;Sheet3&quot;).Range would go above the Const cRange As String line or is it just before the &quot;A2:A70&quot;?  Not entirely sure what values to use for the FA_Win.. variables as I don&#39;t know what it is saying. You had =2 and =3 respectively initially  Regards"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550625423, "post_id": 54776730, "comment_id": 96334232, "body": "@honkin: I&#39;ve also noticed that you&#39;re using <b>&quot;True&quot;</b> in your code while it has to be <b>True</b> without the double quotes (<b>&quot;&quot;</b>)."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550625641, "post_id": 54776730, "comment_id": 96334288, "body": "@honkin: What are the values of the <b>FA_Win_2</b> and <b>FA_Win_3</b> variables? I need this to edit my answer with a working solution. You should use the second solution using <b>For Each Cell In ThisWorkbook.Worksheets(&quot;Sheet3&quot;).Range(cRange)</b>."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550625977, "post_id": 54776730, "comment_id": 96334373, "body": "@honkin: If <b>FA_Win_2</b> and <b>FA_Win_3</b> are values that you are searching, then you have to remove the two of the Const lines and replace them in the rest of the code with double quotes versions: <b>&quot;FA_Win_2&quot;</b> and <b>&quot;FA_Win_3&quot;</b>."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550626436, "post_id": 54776730, "comment_id": 96334477, "body": "@Vbasic2009: I&#39;m not sure I understand by values. They are both text input in cells in column A along with many other cells in column A which will have different text. If that text appears, the cells are formatted. Actually, the ultimate aim is if any cell in column B has today&#39;s date and the cell alongside it, so B2 and A2, if A2 has either FA_Win_2 or FA_Win_3, then it is formatted."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550626455, "post_id": 54776730, "comment_id": 96334484, "body": "I had initially written some code which handled it really well using conditional formatting, but it gets messed up after a days when new data is pasted in and old data deleted. The conditional formatting went all over the place, so I turned to VBA.  The format of the cells in column B is d/m/yyyy hh:mm so I used =AND(TEXT($B2,&quot;dd/mm/yyyy&quot;)=TEXT(TODAY(),&quot;dd/mm/yyyy&quot;) in my original conditional formatting formula.  So in essence, when the file is opened, if a cell in column B has today&#39;s date and the cell next to it in column A has that text, then it is formatted."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550626811, "post_id": 54776730, "comment_id": 96334556, "body": "@honkin: I&#39;ve added another solution <b>ForEach2</b>."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550627770, "post_id": 54776730, "comment_id": 96334773, "body": "@Vbasic2008. That is absolutely perfect. Thanks so much for your help. I can just run that daily as data changes and it will indicate which cells are the ones required&gt;  Thanks again"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550628871, "post_id": 54776730, "comment_id": 96335018, "body": "please accept this solution as it best fits your needs. This will give some points to both you and @VBasic2008 and is in the spirit of stack overflow to give credit to those who have helped you solve your task :)"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1550627595, "last_edit_date": 1550627595, "creation_date": 1550620530, "answer_id": 54776730, "question_id": 54776135, "link": "https://stackoverflow.com/questions/54776135/using-if-in-vba/54776730#54776730", "title": "Using IF in VBA", "body": "<h1>Check Range for Values</h1>\n\n<h2>For Next Loop</h2>\n\n<pre><code>Sub ForNext()\n\n    Dim i As Long   ' Source Column Range Cells Counter\n\n    ' In Source Column Range\n    With Range(A2:A70)\n        ' Loop through cells of Source Column Range.\n        For i = 1 To .Cells.Count\n            ' Check for Search Criterias.\n            If .Cells(i) = \"FA_Win_2\" Or .Cells(i) = \"FA_Win_3\" Then\n                ' Apply formatting.\n                .Cells(i).Font.Bold = True\n            End If\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>For Each Loop</h2>\n\n<pre><code>Sub ForEach()\n\n    Dim Cell As Range   ' Current Cell Range (For Each Control Variable)\n\n    ' Loop through cells of Source Column Range.\n    For Each Cell In Range(\"A2:A70\")\n        ' Check for Search Criterias.\n        If Cell = \"FA_Win_2\" Or Cell = \"FA_Win_3\" Then\n            ' Apply formatting.\n            Cell.Font.Bold = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<h1>EDIT</h1>\n\n<h2>For Each Loop 2</h2>\n\n<pre><code>Sub ForEach2()\n\n    Const cSheet As String = \"Sheet3\"   ' Source Worksheet Name\n    Const cRange As String = \"A2:A70\"   ' Source Column Range Address\n    Const cStr1 As String = \"FA_Win_2\"  ' Search Criteria 1\"\n    Const cStr2 As String = \"FA_Win_3\"  ' Search Criteria 2\"\n\n    Dim Cell As Range   ' Current Cell Range (For Each Control Variable)\n\n    ' Loop through cells of Source Column Range in Source Worksheet.\n    For Each Cell In ThisWorkbook.Worksheets(cSheet).Range(cRange)\n        ' Check for Search Criterias.\n        If Cell = cStr1 Or Cell = cStr2 Then\n            ' Apply formatting.\n            With Cell\n                .Font.Bold = True\n                .Font.Color = RGB(255, 255, 255)    ' White\n                .Interior.Color = RGB(255, 0, 255)  ' Pink\n            End With\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550622270, "post_id": 54776779, "comment_id": 96333547, "body": "So to also colour the text and cell, is it just a matter of using AND after .Font.Bold kind of like this AND .Color = RGB(0, 176, 80) AND .Font.Color = RGB(255, 255, 255) or does it need the full .Range statmeent for each?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550622281, "post_id": 54776779, "comment_id": 96333550, "body": "Any idea why this is less efficient (slower) than the For Each approach?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550622313, "post_id": 54776779, "comment_id": 96333560, "body": "<code>For Each</code> loops are faster &amp; would be an improvement to this solution @VBasic2008"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550622383, "post_id": 54776779, "comment_id": 96333582, "body": "@honkin no, you will have to have two different statements to apply multiple formats which kind of renders this solution not ideal since you don&#39;t want to have to repeatedly spam a test when the answer is already known. I&#39;d also like to ask, why not just use <code>conditional formatting</code>?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1550622738, "post_id": 54776779, "comment_id": 96333665, "body": "The problem is you approach, it is doing something (&#39;applying font&#39;) to all cells, while the if approach does it only to the ones that meet the criteria. In A2:A50000, For Each did 3.3 sec, For Next did 4.1, your solution did 10.5 sec, your solution in For Each did 7.7, using &#39;random&#39; values from 1 to 5. All this doesn&#39;t matter, I upvoted anyway, because the approach would have never occurred to me. Might become useful in the future. Thx."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1550622934, "post_id": 54776779, "comment_id": 96333704, "body": "That&#39;s interesting - i&#39;m really applying <code>TRUE&#47;FALSE</code> to the <code>Font.</code> statement. Surprised to see such a jump - I may reconsider using this approach as this is how I implement tasks like this on my own. Although, on data sets as large as your tests, I would never format the raw data in the first place.... So on ranges that are small enough to justify formats (IMO), the gains are likely to be extremely minimal. Thanks for timing! @VBasic2008"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1550623070, "post_id": 54776779, "comment_id": 96333738, "body": "With that being said, I wouldn&#39;t call this approach a problem. If people are formatting data sizes on that scale, they are prob doing analysis wrong in the first place. Would anyone really scroll through 50K rows to find the bold ones? Doubtful. They would work with the aggregated data instead that demands no formatting."}, {"owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "edited": false, "score": 0, "creation_date": 1550623763, "post_id": 54776779, "comment_id": 96333902, "body": "Thanks for all your comments   undearboy, I initially did use conditional formatting.       =AND(TEXT($B2,&quot;dd/mm/yyyy&quot;)=TEXT(TODAY(),&quot;dd/mm/yyyy&quot;), OR($A2=&quot;FA_Win_3&quot;, $A2=&quot;FA_Win_2&quot;))  The issue is the data changes daily; copied and pasted from other sheets. The conditional formatting ends up all over the place. Instead of one rule applying to A2:A70, there might be three or four rules after a week, with each applying to incorrect cells. Data is copied from other sheets and pasted into this one daily. That didn&#39;t work well for more than a day. I can run the macro daily to at least help"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1550620846, "creation_date": 1550620846, "answer_id": 54776779, "question_id": 54776135, "link": "https://stackoverflow.com/questions/54776135/using-if-in-vba/54776779#54776779", "title": "Using IF in VBA", "body": "<p>My approach would be to set the <code>.Font.Bold = TRUE/FALSE</code> equal to your test statement. </p>\n\n<p>I'm not sure if you really only need to loop through this range, but you can easily update to make this more dynamic by swapping the <code>70</code> to a variable last row calc</p>\n\n<hr>\n\n<pre><code>Sub Test()\n\nDim i as Long\n\nWith ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update\n    For i = 2 To 70\n        .Range(\"A\" &amp; i).Font.Bold = .Range(\"A\" &amp; i) = \"FA_Win_2\" Or .Range(\"A\" &amp; i) = \"FA_Win_3\"\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8617194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a887df9171d21ddabc9efb7dd4db2873?s=128&d=identicon&r=PG&f=1", "display_name": "honkin", "link": "https://stackoverflow.com/users/8617194/honkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1550646656, "creation_date": 1550616617, "last_edit_date": 1550646656, "question_id": 54776135, "link": "https://stackoverflow.com/questions/54776135/using-if-in-vba", "title": "Using IF in VBA", "body": "<p>Can anyone tell me if this is the correct way to phrase this VBA macro? </p>\n\n<p>The idea is for it to examine all cells in the range A2:A70 (actually, could be all of column A if it easier) and if the text of FA_Win_2 or FA_Win_3 is there, make the cell bold. </p>\n\n<pre><code>If Range(\u201cA2:A70\u201d) = FA_Win_2 Or _\n   Range(\u201cA2:A70\u201d) = FA_Win_3 Then\n   Range(\u201cA2:A70\u201d).font.Bold = \u201cTrue\u201d\nEnd If\n</code></pre>\n\n<p>I have tried different things like enclosing the FA_Win_2 in \"\", adding .Value after the range, but am always coming up with compile errors.</p>\n\n<p>Any assistance would be much appreciated.</p>\n\n<p>cheers</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 0, "creation_date": 1550616865, "post_id": 54776064, "comment_id": 96332201, "body": "2 things you can try: First, change your query to have <code>... BETWEEN #&quot; &amp; startdt &amp; &quot;# AND #&quot; stopdt &amp; &quot;# ORDER BY ...</code> (maybe needs to format the date like <code>worksheetfunction.text(startdt, &quot;M&#47;D&#47;YYYY&quot;)</code>). If that doesn&#39;t work, try to add a <code>.MoveFirst</code> right after the <code>.Open Source:=...</code> on next line."}, {"owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "reply_to_user": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 0, "creation_date": 1550617518, "post_id": 54776064, "comment_id": 96332351, "body": "@FXD neither of those seemed to do the trick :(. would it have anything to do with my database being a .mdb file instead of a .accdb file?"}, {"owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 0, "creation_date": 1550617666, "post_id": 54776064, "comment_id": 96332392, "body": "No it has nothing to do with the extension. Try ISO format (<code>&quot;YYYY-MM-DD&quot;</code>) maybe. If that still doesn&#39;t work (have you checked <code>Recordset.RecordCount</code> btw?), do you have anything against Excel data connection (i.e. get data in a spreadsheet without using VBA)?"}, {"owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "reply_to_user": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "edited": false, "score": 0, "creation_date": 1550618355, "post_id": 54776064, "comment_id": 96332578, "body": "@FXD nothing against Excel data connection, this isnt for me, its for another team at my place of work."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1583164377, "post_id": 54776064, "comment_id": 107014776, "body": "Note that in the line <code>Range(\u201cA1\u201d).Offset(1, 0).CopyFromRecordset Recordset</code>, the quotes in the <code>Range(\u201cA1\u201d)</code> are the wrong unicode characters. It has to be <code>Range(&quot;A1&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1550617280, "last_edit_date": 1550617280, "creation_date": 1550616911, "answer_id": 54776179, "question_id": 54776064, "link": "https://stackoverflow.com/questions/54776064/get-data-from-access-database-with-excel-vba/54776179#54776179", "title": "Get Data From Access Database with Excel VBA", "body": "<p>The posted code is missing <code>End If</code> line. Perhaps this is just a posting typo because code should not compile and run.</p>\n\n<p>The query SQL needs # delimiters for the date parameters:</p>\n\n<p><code>Source = \"SELECT * FROM Tracking WHERE [Date_Logged] BETWEEN #\" &amp; startdt &amp; \"# AND #\" &amp; stopdt &amp; \"# ORDER BY [Date_Logged]\"</code></p>\n\n<p>Text field would need apostrophe delimiters. Number field does not need delimiters.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "is_accepted": false, "score": 0, "last_activity_date": 1550618525, "creation_date": 1550618525, "answer_id": 54776436, "question_id": 54776064, "link": "https://stackoverflow.com/questions/54776064/get-data-from-access-database-with-excel-vba/54776436#54776436", "title": "Get Data From Access Database with Excel VBA", "body": "<p>I solved the answer to my own question after hours, i found a different set of code that worked fine. Thank you all for your help!</p>\n\n<pre><code>Sub getdatamdb()\n          Dim cn As Object, rs As Object\n          Dim intColIndex As Integer\n          Dim DBFullName As String\n          Dim TargetRange As Range\n\n10        DBFullName = \"X:\\MyDocuments\\CMS\\CMS Database.mdb\"\n\n20        On Error GoTo Whoa\n\n30        Application.ScreenUpdating = False\n\n40        Set TargetRange = Sheets(\"Sheet1\").Range(\"A1\")\n\n50        Set cn = CreateObject(\"ADODB.Connection\")\n60        cn.Open \"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\" &amp; DBFullName &amp; \";\"\n\n70        Set rs = CreateObject(\"ADODB.Recordset\")\n80        rs.Open \"SELECT * FROM Tracking WHERE [Date_Logged] BETWEEN #\" &amp; startdt &amp; \"# AND #\" &amp; stopdt &amp; \"# ORDER BY [Date_Logged]\", cn, , , adCmdText\n\n          ' Write the field names\n90        For intColIndex = 0 To rs.Fields.Count - 1\n100           TargetRange.Offset(1, intColIndex).Value = rs.Fields(intColIndex).Name\n110       Next\n\n          ' Write recordset\n120       TargetRange.Offset(1, 0).CopyFromRecordset rs\n\nLetsContinue:\n130       Application.ScreenUpdating = True\n140       On Error Resume Next\n150       rs.Close\n160       Set rs = Nothing\n170       cn.Close\n180       Set cn = Nothing\n190       On Error GoTo 0\n200       Exit Sub\nWhoa:\n210       MsgBox \"Error Description :\" &amp; Err.Description &amp; vbCrLf &amp; _\n             \"Error at line     :\" &amp; Erl &amp; vbCrLf &amp; _\n             \"Error Number      :\" &amp; Err.Number\n220       Resume LetsContinue\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1744, "user_id": 10600584, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/319eb863cdc0db2dd90b533b742f8738?s=128&d=identicon&r=PG", "display_name": "FXD", "link": "https://stackoverflow.com/users/10600584/fxd"}, "is_accepted": false, "score": 1, "last_activity_date": 1550618802, "creation_date": 1550618802, "answer_id": 54776491, "question_id": 54776064, "link": "https://stackoverflow.com/questions/54776064/get-data-from-access-database-with-excel-vba/54776491#54776491", "title": "Get Data From Access Database with Excel VBA", "body": "<p>An easy way to get data in Excel, especially from Access, is to use the menu \"Data > Access\". This creates a connection to a table, that you can freely edit.<br>\nAt the very least, that is a convenient way to limit your investigations to:</p>\n\n<ul>\n<li>the query you typed (the connection string will always be OK, so if you're getting no values, it comes from the query) </li>\n<li>or the VBA itself (if the table is returning values but not the corresponding VBA <code>Sub</code>, then you know it comes from the VBA itself, not the SQL).</li>\n</ul>\n\n<p>I'm skipping the creation of connection becuse it's really straightforward; it's better to focus on what you can do once the table has been created.</p>\n\n<p><strong>Edit the connection</strong></p>\n\n<p>When you select the table and go to menu \"Data > Properties\", then in the window you click on the top right button \"Connection properties\", you get to the definition of the connection, i.e. some properties in the first tab and the actual definition in the second tab.</p>\n\n<p>If you move the .mdb file, you'll have to change the connection string accordingly. There should be no other events forcing you to alter it.</p>\n\n<p>If you want to type an actual complex query, you'll need to:</p>\n\n<ol>\n<li>Change the command type from \"Table\" to \"SQL\"</li>\n<li>Type the query in the bottom edit box.<br>\nNote if you want to define dynamic parameters in the <code>WHERE</code> clause, you can put question marks (?) instead of hardcoded values. Question marks can be linked to either constants (with a prompt to change their values) or cell.</li>\n</ol>\n\n<p><strong>Use in VBA</strong></p>\n\n<p>Once you checked with the connection that everything works, you have 2 solutions to put that in VBA.</p>\n\n<p>Either use exactly the code you have above; in that case, you can make things easy by simply copying the connection string and the query.</p>\n\n<p>Alternatively and <strong>this is what I would recommend</strong>, the table we have built previously can be updated very easily in VBA.</p>\n\n<p>Use this piece of code:</p>\n\n<pre><code>WorksheetWithTable.ListObjects(1).QueryTable.Refresh \n</code></pre>\n\n<p>You really don't need more than this 1 line of code to do the refresh.<br>\nIf you set your query to automatically refresh when a cell's value is being modified, then you do not even need it at all.</p>\n\n<p>Note #1: Instead of an index in <code>.ListObjects(1)</code>, you can use the table name.<br>\nNode #2: Refresh has an optional parameters to drive if the query is to be refresh in the background. <code>True</code> means the VBA code will not wait for the execution to end before moving to the next instruction. <code>False</code>, obviously, is the opposite.</p>\n"}], "owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5376, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1550646649, "creation_date": 1550616154, "last_edit_date": 1550646649, "question_id": 54776064, "link": "https://stackoverflow.com/questions/54776064/get-data-from-access-database-with-excel-vba", "title": "Get Data From Access Database with Excel VBA", "body": "<p>I am having trouble getting data from an Access Database. I found this code online, and it seems to work (to an extent), but for some reason it will only pull the column headers, and none of the data from the query. I am not too familiar with Access, that is why I pulled one from offline. </p>\n\n<p>Someone had a similar post a while back, where the code they used was the same, and our queries were exactly the same, but we had different issues.\n<a href=\"https://stackoverflow.com/questions/53329264/importing-data-from-access-using-excel-vba\">Importing Data From Access Using Excel VBA</a></p>\n\n<p>Would anyone happen to know why the data won't pull?</p>\n\n<pre><code>Sub getDataFromAccess()   \n\nDim DBFullName As String\nDim Connect As String, Source As String\nDim Connection As ADODB.Connection\nDim Recordset As ADODB.Recordset\nDim Col As Integer\nDim startdt As String\nDim stopdt As String\nDim refresh\n\nrefresh = MsgBox(\"Start New Query?\", vbYesNo)\nIf refresh = vbYes Then\n    Sheet1.Cells.Clear\n    startdt = Application.InputBox(\"Please Input Start Date for Query (MM/DD/YYYY): \", \"Start Date\")\n    stopdt = Application.InputBox(\"Please Input Stop Date for Query (MM/DD/YYYY): \", \"Stop Date\")\n\n    DBFullName = \"X:\\MyDocuments\\CMS\\CMS Database.mdb\"\n    ' Open the connection\n    Set Connection = New ADODB.Connection\n    Connect = \"Provider=Microsoft.ACE.OLEDB.12.0;\"\n    Connect = Connect &amp; \"Data Source=\" &amp; DBFullName &amp; \";\"\n    Connection.Open ConnectionString:=Connect\n\n    Set Recordset = New ADODB.Recordset\n    With Recordset\n        Source = \"SELECT * FROM Tracking WHERE [Date_Logged] BETWEEN \" &amp; startdt &amp; \" AND \" &amp; stopdt &amp; \" ORDER BY [Date_Logged]\"\n        .Open Source:=Source, ActiveConnection:=Connection\n\n        For Col = 0 To Recordset.Fields.Count - 1\n            Range(\u201cA1\u201d).Offset(0, Col).Value = Recordset.Fields(Col).Name\n        Next\n\n        Range(\u201cA1\u201d).Offset(1, 0).CopyFromRecordset Recordset\n    End With\n    ActiveSheet.Columns.AutoFit\n    Set Recordset = Nothing\n    Connection.Close\n    Set Connection = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "printing", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1550614847, "post_id": 54775446, "comment_id": 96331573, "body": "Might have something to do with <code>wdActiveEndAdjustedPageNumber</code> - what value is that returning and is it the value you&#39;d expect? Try the <code>Information</code> option without &quot;adjusted&quot; and see if that^s any better. Also try printing manually with the same range of pages values the code is using."}], "owner": {"reputation": 11, "user_id": 11086849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a5d0e6b570f8f37b46789caa0d36a7?s=128&d=identicon&r=PG&f=1", "display_name": "Farah9424", "link": "https://stackoverflow.com/users/11086849/farah9424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550614689, "creation_date": 1550612833, "last_edit_date": 1550614689, "question_id": 54775446, "link": "https://stackoverflow.com/questions/54775446/vba-printing-code-in-word-stopped-working", "title": "vba printing code in word stopped working", "body": "<p>I am having trouble with this printing code as it was working and all of a sudden stopped. I tried using break mode and figured the issue is in the line with PrintOut. without specifying a range it works and prints two full copies of the document. </p>\n\n<pre><code>ActiveDocument.Range.Select\nSelection.Find.Text = \"Instructions\"\nblnFound = Selection.Find.Execute\nendCount = ActiveDocument.ComputeStatistics(wdStatisticPages)\nstartCount = Selection.Information(wdActiveEndAdjustedPageNumber)\npag1 = startCount &amp; \"-\" &amp; endCount - 1\npag2 = endCount &amp; \"-\" &amp; endCount\nApplication.PrintOut FileName:=\"\", Copies:=2, Range:=wdPrintRangeOfPages, Pages:=pag1\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "conditional-statements"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1550611143, "post_id": 54775019, "comment_id": 96330166, "body": "can you post some test data. I have a feeling you need to do an <code>and</code> instead of an <code>or </code> can you post an image of your workbook , maybe? This could be data related but is hard to tell."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1550611645, "post_id": 54775019, "comment_id": 96330385, "body": "Please <a href=\"https://stackoverflow.com/posts/54775019/edit\">edit your question</a> instead of adding info in comments"}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1550611802, "post_id": 54775019, "comment_id": 96330456, "body": "Added a bit of example data into the question. thanks in advance"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1550611840, "post_id": 54775019, "comment_id": 96330473, "body": "<code>Or Cells(i, 8) &lt;&gt; &quot;&quot;</code> will enter the first condition given any non-empty cell."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550612114, "post_id": 54775019, "comment_id": 96330576, "body": "So how is the code &quot;intended to work&quot;? There&#39;s obviously a business rule here, but without knowing it, it&#39;s going to be difficult to untangle the condition."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1550612265, "post_id": 54775019, "comment_id": 96330632, "body": "if the PROGRAM STATUS is IN PROGRESS or PENDING or PENDING REVIEW, etc. then the CASE STATUS cannot be CANCELLED OR COMPLETED. the intended purpose is that if the above 2 conditions are BOTH true (i.e. it IS pending or pending review, etc. AND the case status IS cancelled or completed, then highlight the PROGRAM STATUS cell)"}, {"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 0, "creation_date": 1550612462, "post_id": 54775019, "comment_id": 96330712, "body": "If it&#39;s supposed to be EQUAL to &#39;Cancelled&#39; or &#39;Completed&#39;, then your code won&#39;t work as is... it should be <code>If Cells(i, 23) = &quot;Cancelled&quot; Or Cells(i, 23) = &quot;Completed&quot;</code>"}, {"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 1, "creation_date": 1550612592, "post_id": 54775019, "comment_id": 96330764, "body": "Not to mention, if you have <code>Cells(i, 8) &lt;&gt; &quot;&quot;</code>, that&#39;s making the first two criteria for  <code>&quot;Cancelled Not Applicable&quot; Or  &quot;Completed&quot;</code> completely irrelevant, because it&#39;s saying &quot;if a cell is not blank, then do something&quot;"}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1550612779, "post_id": 54775019, "comment_id": 96330828, "body": "to sum up. column 8 is CASE STATUS and column 23 is Program Status. the purpose is to highlight situations where the PS is in Progress (or NOT cancelled or Completed) and the CS is completed or cancelled. The point is that there cannot be an active program running if the case id itself is cancelled."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1550614099, "post_id": 54775019, "comment_id": 96331328, "body": "I have this undying hunch that explaining how logical operators and truth tables work would be more beneficial than providing you with code that implements your requirements correctly."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550615446, "post_id": 54775781, "comment_id": 96331764, "body": "About point 2: I like explaining the <code>Or</code> logical operation as an addition, and <code>And</code> as a multiplication -- visualizing <code>True</code> as <code>1</code> and <code>False</code> as <code>0</code>, the truth tables become pretty easy to understand then."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1550615683, "post_id": 54775781, "comment_id": 96331840, "body": "@MathieuGuindon I know I&#39;ve stumbled on some good explainations of this <code>NOT OR NOT</code> gate before and I&#39;m having problems recalling it (or finding it). <code>OR</code> is pretty easy to grasp, but <code>NOT OR NOT</code> as it is here is confusing since it&#39;s differs so much with the english &quot;If my chicken is not orange or my chicken is not green&quot; which would not allow a orange chicken, obviously. But as a logic gate it would allow it as an orange chicken is clearly not green."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550615722, "post_id": 54775781, "comment_id": 96331852, "body": "It&#39;s like <code>WHERE NOT LIKE ALL (1,2,3)</code> vs <code>WHERE NOT LIKE ANY (1,2,3)</code> in SQL. I&#39;ve lost some hair learning that one."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550616744, "post_id": 54775781, "comment_id": 96332161, "body": "Seems parentheses would help clarifying the order of operations in the final expression there - or better, extracting each individual condition into a local variable. &quot;Not empty and equals something&quot; reads very much as still redundant ;-)"}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1550674302, "post_id": 54775781, "comment_id": 96356541, "body": "@JNevill your explanation was fantastic. code aside, thank you for that."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1550615304, "last_edit_date": 1550615304, "creation_date": 1550614644, "answer_id": 54775781, "question_id": 54775019, "link": "https://stackoverflow.com/questions/54775019/multiple-if-statement-conditions-using-or-function-doesnt-work-vba/54775781#54775781", "title": "multiple IF statement conditions using OR function doesn&#39;t work - VBA", "body": "<pre><code>If Cells(i, 8) = \"Cancelled Not Applicable\" Or Cells(i, 8) = \"Completed\" Or Cells(i, 8) &lt;&gt; \"\" Then\n    If Cells(i, 23) &lt;&gt; \"Cancelled\" Or Cells(i, 23) &lt;&gt; \"Completed\" Then\n        Cells(i, 23).Interior.ColorIndex = 4\n    End If\nEnd If\n</code></pre>\n\n<p>This says:</p>\n\n<blockquote>\n  <p>If Your case status is \"Cancelled Not Applicable\" or you case status is \"Completed\" or your case status is any value (not empty) then go ahead and test if your program status is any value (as it can't be both \"Cancelled\" AND \"Completed\" at the same time) then go ahead and highlight it. </p>\n</blockquote>\n\n<p>So really there are two issues here. </p>\n\n<ol>\n<li><p>Your <code>Or Cells(i, 8).value &lt;&gt; \"\"</code> Here you are saying \"Pass this IF line as true if this cell is blank\" because it's an <code>OR</code>. It's like saying \"If this chicken is red or this chicken is black or this chicken exists\" So if you are testing a blue chicken it will pass as it exists.</p></li>\n<li><p>Your <code>Cells(i, 23) &lt;&gt; \"Cancelled\" Or Cells(i, 23) &lt;&gt; \"Completed\"</code>. If the cell contains \"Cancelled\" then your second condition is true since it doesn't say \"Completed\" so this passes. If your cell says \"Completed\" then your first condition passes as it's not \"Cancelled\". If your cell says \"Booger farts\" then both conditions pass as it's not \"Cancelled\" nor is it \"Completed\". So really you want <code>AND</code> here. </p></li>\n</ol>\n\n<p>That second point is difficult to grasp since \"OR\" isn't how we would use it english. It may help to think of it this way:  If we have a test like <code>IF condition1 OR condition2 OR condition3</code> then only one of those conditions needs to be true for this to pass. <code>If TRUE OR FALSE OR FALSE</code> passes. Your conditions here are \"Not equal to\" which adds to the confusion, but you merely have to concentrate on the individual condition and determine if it returns \"TRUE\" or \"FALSE\" and make your statement <code>IF TRUE OR FALSE</code> (passes) or <code>IF TRUE OR TRUE</code> (passes) or <code>IF FALSE OR TRUE</code>(passes) or <code>IF FALSE OR FALSE</code> (finally it fails!). </p>\n\n<p>Instead you wish to say:</p>\n\n<blockquote>\n  <p>If the CASE STATUS is filled in and if the PROGRAM STATUS is IN PROGRESS or PENDING or PENDING REVIEW, etc. then the CASE STATUS cannot be CANCELLED OR COMPLETED</p>\n</blockquote>\n\n<p>So:</p>\n\n<pre><code>If Cells(i,8).value &lt;&gt; \"\" AND (Cells(i, 8).value = \"Cancelled Not Applicable\" OR Cells(i,8).value = \"Completed\") AND (Cells(i, 23).Value &lt;&gt; \"Cancelled\" AND Cells(i, 23).Value &lt;&gt; \"Completed\") Then\n    Cells(i, 23).Interior.ColorIndex = 4\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 1, "accepted_answer_id": 54775781, "answer_count": 1, "score": 0, "last_activity_date": 1550615304, "creation_date": 1550610908, "last_edit_date": 1550611781, "question_id": 54775019, "link": "https://stackoverflow.com/questions/54775019/multiple-if-statement-conditions-using-or-function-doesnt-work-vba", "title": "multiple IF statement conditions using OR function doesn&#39;t work - VBA", "body": "<p>I'm trying to get the code to check if multiple conditions are true and if so, to then change the colour of the cell but this doesn't work and highlights way more than necessary. I'm not sure why the code doesn't work as intended:</p>\n\n<pre><code>Sub ConditionCheck()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim lastrow As Long\nDim rng1 As Range\nDim rng2 As Range\nDim c As Range\nDim d As Range\n\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"Source\")\nlastrow = Sheets(\"Source\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\ni = 2\n\nFor i = 2 To lastrow\n\n    If Cells(i, 8) = \"Cancelled Not Applicable\" Or Cells(i, 8) = \"Completed\" Or Cells(i, 8) &lt;&gt; \"\" Then\n        If Cells(i, 23) &lt;&gt; \"Cancelled\" Or Cells(i, 23) &lt;&gt; \"Completed\" Then\n            Cells(i, 23).Interior.ColorIndex = 4\n        End If\n    End If\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Sample Data:</p>\n\n<pre><code>CASE ID       CASE STATUS                PROGRAM STATUS\n10001         Active                     Pending\n10002         Completed                  Pending Review\n10004         Cancelled Not Applicable   Cancelled\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 6, "creation_date": 1550610418, "post_id": 54774807, "comment_id": 96329888, "body": "You should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid Activate and Select</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1550610549, "post_id": 54774807, "comment_id": 96329937, "body": "That ^^^^... <i>and</i> <code>GoTo</code> jumps. That <code>GoTo DoneFinding2</code> should really just be <code>Exit Do</code>. Also, look into how <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">proper indentation</a> can help highlight the control flow structure and make the code easier to follow."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1550610929, "post_id": 54774807, "comment_id": 96330082, "body": "The <code>.Find</code> call is certainly not helping performance much either. I&#39;d consider using a <code>Dictionary</code> for a lookup instead."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1550613716, "post_id": 54774807, "comment_id": 96331192, "body": "Use a database (MS Access, SQLite for file level DBMS) or data set type program (SAS, Stata, SPSS) or open-source tool (Python pandas, R, Julia). These can hold large amount of data and search without looping"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1550621170, "post_id": 54774807, "comment_id": 96333315, "body": "Would help a lot to show some examples of the data you&#39;re working with.  Also - do you need to find all matches, or just the first/last?  You code overwrites previous matches as each next match is found..."}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1550716386, "post_id": 54774807, "comment_id": 96374123, "body": "@cybernetic.nomad -  I will do that"}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1550716396, "post_id": 54774807, "comment_id": 96374124, "body": "@MathieuGuindon Guindon - Sorry, I just started to develop my skill with vba."}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1550716408, "post_id": 54774807, "comment_id": 96374129, "body": "@Parfait - I Am learning Python, next ones will be unde this language"}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550716417, "post_id": 54774807, "comment_id": 96374133, "body": "@TimWilliams Williams - See Link Bellow. It is an excel with what need to be done. Tks!  <a href=\"https://drive.google.com/open?id=1fwTMra9DsqHm0jgXa34j2U3201Zfi5lT\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1fwTMra9DsqHm0jgXa34j2U3201Zfi5lT</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550722721, "post_id": 54774807, "comment_id": 96375682, "body": "In the longer text , is the server name always surrounded by spaces ?  You can use <code>Like</code> or <code>Instr</code> to check if some text is contained in some other text, but I&#39;m guessing you&#39;d want to be able to distinguish &quot;server3&quot; from &quot;server33&quot; for example."}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550790111, "post_id": 54774807, "comment_id": 96411380, "body": "@TimWilliams Some time they are surrounded by spaces and sometimes no.  See a real comment example and real server names  comment - ITM Agent Offline:nzapie60 Server names - nzapie6 and nzapie60 (same example you gave me)  I did considered it till now. But server33 will not find server3 so if I sort them Server3 will find server33 and it is wrong, but it will be corrected at the time to find of server33"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "edited": false, "score": 0, "creation_date": 1550694569, "post_id": 54775050, "comment_id": 96367493, "body": "Hi Tale!  I tried your code, it was really fast, however it does note brought me any results. See that I have a list with server names and column G has has a text that has the server name, for example :  &quot;Unable to launch ...on <b>server name</b>&quot; See that the server name is among some text, that is why i use the &quot;find&quot; function. I am not familiar with dictionary , but i believe it looks for the exactly same value on G columns, and that is why it did not brought any results. Any other suggestion?"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "edited": false, "score": 0, "creation_date": 1550697522, "post_id": 54775050, "comment_id": 96368811, "body": "You are correct in that the <code>Key</code> must be referenced exactly for this to work. Is the phrasing of the text in Column G consistent such that you could use <code>CStr(Replace(.Range(&quot;G&quot; &amp; i),&quot;Unable to launch ...on &quot;, &quot;&quot;))</code> to return the server name in question by replacing the preceding text with a blank value?"}, {"owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "edited": false, "score": 0, "creation_date": 1550716466, "post_id": 54775050, "comment_id": 96374142, "body": "I have done an example. Please see google drive link bellow  <a href=\"https://drive.google.com/open?id=1fwTMra9DsqHm0jgXa34j2U3201Zfi5lT\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1fwTMra9DsqHm0jgXa34j2U3201Zfi5lT</a>"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "edited": false, "score": 0, "creation_date": 1551214142, "post_id": 54775050, "comment_id": 96556855, "body": "I&#39;ve added to my answer to accommodate a solution based on the data provided."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 2, "last_activity_date": 1551214109, "last_edit_date": 1551214109, "creation_date": 1550611028, "answer_id": 54775050, "question_id": 54774807, "link": "https://stackoverflow.com/questions/54774807/66k-lines-to-analyze-in-excel/54775050#54775050", "title": "66k lines to analyze in Excel", "body": "<p>You could utilize a <code>Dictionary</code> for this and achieve much better performance</p>\n\n<pre><code>Sub t()\n\n    Dim dict As Object\n\n    Dim i As Long\n    Dim endrow As Long\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With Sheets(\"Server List\")\n        endrow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To endrow\n            If .Range(\"A\" &amp; i) &lt;&gt; \"\" Then\n                dict.Add CStr(.Range(\"A\" &amp; i)), .Range(\"A\" &amp; i)\n            End If\n        Next\n\n    End With\n\n    With Sheets(\"Resolved Met\")\n        endrow = .Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To endrow\n            If dict.Exists(CStr(.Range(\"G\" &amp; i))) Then\n                .Range(\"G\" &amp; i).Offset(0, 13) = dict(CStr(.Range(\"G\" &amp; i)))\n            End If\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The code below is based on your comments and the structure of the data you've attached. It assumes that, like the dataset provided, <code>servername</code> will be separated from random text by a space. I tested this with an expansion of the dataset provided (expanded to 66K server names in <code>Server List</code> and 130K Lines in <code>Resolved Met</code>) and achieved correct results in 372.672 seconds. A bit lengthy, but it's about a 98.3% decrease in run-time when compared against the ~6 hours noted in your previous method.</p>\n\n<pre><code>Sub ServerNameLookup()\n    Dim dict As Object\n\n    Dim i As Long\n    Dim endrow As Long\n\n    Dim textArr\n    Dim iText As Long\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With Sheets(\"Server List\")\n        endrow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To endrow\n            If .Range(\"A\" &amp; i) &lt;&gt; \"\" Then\n                dict.Add CStr(.Range(\"A\" &amp; i)), .Range(\"A\" &amp; i)\n            End If\n        Next\n\n    End With\n\n    With Sheets(\"Resolved Met\")\n        endrow = .Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = 2 To endrow\n            textArr = Split(.Range(\"G\" &amp; i), \" \")\n            For iText = LBound(textArr) To UBound(textArr)\n                If dict.Exists(CStr(textArr(iText))) Then\n                    .Range(\"G\" &amp; i).Offset(0, 13) = dict(CStr(textArr(iText)))\n                End If\n            Next iText\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1550609925, "question_id": 1407613}, "owner": {"reputation": 47, "user_id": 8514517, "user_type": "registered", "profile_image": "https://graph.facebook.com/1426708504078981/picture?type=large", "display_name": "Alex DS", "link": "https://stackoverflow.com/users/8514517/alex-ds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551214109, "creation_date": 1550609792, "last_edit_date": 1550610579, "question_id": 54774807, "link": "https://stackoverflow.com/questions/54774807/66k-lines-to-analyze-in-excel", "title": "66k lines to analyze in Excel", "body": "<p>I huge amount of data to analyze!\nI have a table <strong>\"Resolved Met\"</strong> and on column G with some text that contains a server name \nand table <strong>\"Server List\"</strong> with 66k name of servers</p>\n\n<p>I have to analyze if the text contains the server name on table <strong>\"Server List\"</strong> and if yes to write the server name in front of the text ( in another cell)</p>\n\n<p>What I did was to go to first line of table <strong>\"Server List\"</strong> and look for it on column where the text is with a loop </p>\n\n<p>It took more than 6 hours to analyze everything once the I have 66k serves name and 130k lines of text.\nHere is my code. Do you have some better idea to make it faster?</p>\n\n<pre><code>Sub ()\n\ni = 1\nSheets(\"Server List\").Select\nRange(\"A1\").Select\n\nservername = ActiveCell.Offset(i, 0).Value\n\nDo Until IsEmpty(servername)\n\n    Sheets(\"Resolved Met\").Select\n\n    With Worksheets(\"Resolved Met\").Range(\"G:G\")\n        Set server = .find(What:=servername, LookIn:=xlValues)\n        If Not server Is Nothing Then\n            firstAddress = server.Address\n            Range(firstAddress).Select\n            ActiveCell.Offset(0, 13) = servername\n            Do\n                Set server = .FindNext(server)\n                If server Is Nothing Then\n                    GoTo DoneFinding2\n                End If\n                SecondAdress = server.Address\n                Range(SecondAdress).Select\n                ActiveCell.Offset(0, 13) = servername\n\n            Loop While SecondAdress &lt;&gt; firstAddress\n        End If\n        DoneFinding2:\n    End With\n\n\n    Sheets(\"Server List\").Select\n    i = i + 1\n    servername = ActiveCell.Offset(i, 0).Value\n\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba", "row", "delete-row"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1550609460, "post_id": 54774663, "comment_id": 96329486, "body": "Pro tip: delete from the bottom up, not the top down.  Try going from LastRowNum to 2 step -1. it simplifies your loop"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550610025, "post_id": 54774663, "comment_id": 96329737, "body": "While iterating backwards is a great tip, one could also opt to use Find a value in column AN untill value isn&#39;t found nomore. That way you won&#39;t have to iterate through all rows. That becomes handy on larger datasets. And, also avoid using Select. No need for that."}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1550610193, "post_id": 54774663, "comment_id": 96329806, "body": "What is the specific set of values? Do those values also exist in column &quot;AN&quot;?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550610731, "post_id": 54774663, "comment_id": 96330002, "body": "Possibility: You can drop the values you want to search for in an array. Loop through your array, using FindNext to get all rows per value. Use union to combine all found ranges into one so you can delete entire range at once. So you can prevent iterating through all cells and deleting row by row. It should speed up your proces."}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1550778499, "post_id": 54774663, "comment_id": 96406581, "body": "@sous2817 would the code look something like this in order to delete from the bottom up? LastRowNum = Cells(Rows.Count, 1).End(xlUp).Row   AND Range(&quot;AN&quot;   &amp; ReadRow). EntireRow.Delete Shift:=xlUp"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550778746, "post_id": 54774663, "comment_id": 96406708, "body": "@JvdV Why Should I avoid using .Select? I had this in place since the entire Sub is actually switching between different sheets and running the same loop in each"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1550778831, "post_id": 54774663, "comment_id": 96406752, "body": "@TateGarringer Yes column AN contains all the values that I would like to Delete (e.g. CAT, DOG, BAT, etc.)"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550778931, "post_id": 54774663, "comment_id": 96406807, "body": "@JvdV An array would work perfectly! However I am new to VBA and could not figure out how to create an array that worked correctly. Would you mind posting example code?"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1550610155, "post_id": 54774773, "comment_id": 96329789, "body": "Never iterate forward deleting rows. Always backwards. Also you should avoid using integer. There simply isn&#39;t a reason to use a limited variable."}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1550779388, "post_id": 54774773, "comment_id": 96407055, "body": "@JvdV Has a good point and this does not answer my initial question regarding how to delete rows that = CAT not &lt;&gt; CAT"}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "edited": false, "score": 0, "creation_date": 1550779594, "post_id": 54774773, "comment_id": 96407140, "body": "No problem, you can simply swap out <code>&lt;&gt;</code> for <code>=</code>. I&#39;ll edit the answer."}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550848566, "post_id": 54774773, "comment_id": 96435031, "body": "@healey I tried simply replacing &lt;&gt; with = with limited success. I am really not sure why I can not just simply switch the code to delete rows NOT containing CAT to deleting all rows that DO contain CAT with = :("}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "reply_to_user": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1551037654, "post_id": 54774773, "comment_id": 96483169, "body": "@user223522, are you looking for cells where the value contains &quot;CAT&quot;, or equals only &quot;CAT&quot;?"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1551130597, "post_id": 54774773, "comment_id": 96520177, "body": "@healey Equals only &quot;CAT&quot;, however I realized what the issue was...I should be using &quot;Or_&quot; not &quot;And_&quot;"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1551285165, "post_id": 54774773, "comment_id": 96587296, "body": "@healey That issue has been resolved, however now the Sub will not delete rows with empty cells (&quot;&quot;) in column AN..."}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "edited": false, "score": 0, "creation_date": 1551297507, "post_id": 54774773, "comment_id": 96593426, "body": "Use an <code>OR</code> statement to detect blank cells in column AN:  <code>If sht.Range(&quot;AN&quot; &amp; i) = &quot;CAT&quot; Or sht.Range(&quot;AN&quot; &amp; i) = &quot;&quot; Then</code>"}], "tags": [], "owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "is_accepted": false, "score": 0, "last_activity_date": 1550779612, "last_edit_date": 1550779612, "creation_date": 1550609734, "answer_id": 54774773, "question_id": 54774663, "link": "https://stackoverflow.com/questions/54774663/delete-row-if-cells-equal-a-set-of-values/54774773#54774773", "title": "Delete row if cells equal a set of values", "body": "<p>I would tend to do it this way:</p>\n\n<pre><code>Sub DeleteRows()\n    Dim i As Integer\n    Dim sht As Worksheet\n    Set sht = ThisWorkbook.Sheets(\"sample\")\n    i=1\n\n    While sht.(i,1) &lt;&gt; \"\" 'Assuming first column is full of data to the bottom\n        If sht.Range(\"AN\" &amp; i) = \"CAT\" Then\n              sht.Rows(i).EntireRow.Delete\n        Else\n            i=i+1\n        End If\n    Wend\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550779262, "post_id": 54775138, "comment_id": 96406994, "body": "I am not really sure why you would use an Auto filter in VBA? I created the macro to avoid having to filer in order to delete rows"}, {"owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "reply_to_user": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550779582, "post_id": 54775138, "comment_id": 96407135, "body": "I find that using native worksheet functions a lot faster than loops. Normally I create a macro to avoid doing it manually not to avoid doing a specific task. Does it matter that the macro still filters if it gets the job done faster?"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550848949, "post_id": 54775138, "comment_id": 96435259, "body": "You may have a good point. I have not tried many native worksheet functions in my VBA. However I feel as though I will learn more basic programming skills by writing the loops myself.  Plus, this way code can be easily understood/edited in the future by not using too many ws functions."}], "tags": [], "owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "is_accepted": false, "score": 0, "last_activity_date": 1550611445, "creation_date": 1550611445, "answer_id": 54775138, "question_id": 54774663, "link": "https://stackoverflow.com/questions/54774663/delete-row-if-cells-equal-a-set-of-values/54775138#54775138", "title": "Delete row if cells equal a set of values", "body": "<p>A site that might be able to help you be the following. </p>\n\n<p><a href=\"https://www.excelcampus.com/vba/delete-rows-cell-values/\" rel=\"nofollow noreferrer\">https://www.excelcampus.com/vba/delete-rows-cell-values/</a>\nI adjusted the code a little. </p>\n\n<pre><code>Sub Delete_Rows_Based_On_Value()\n'Apply a filter to a Range and delete visible rows\n'Source: https://www.excelcampus.com/vba/delete-rows-cell-values\n\n    Dim ws As Worksheet\n\n      'Set reference to the sheet in the workbook.\n      Set ws = ThisWorkbook.Worksheets(\"sampel\")\n      ws.Activate 'not required but allows user to view sheet if warning message appears\n\n      'Clear any existing filters\n      On Error Resume Next\n        ws.ShowAllData\n      On Error GoTo 0\n\n      '1. Apply Filter\n      ws.Range(\"AN3:BG1000\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;CAT\"\n\n      '2. Delete Rows\n      Application.DisplayAlerts = False\n        ws.Range(\"B1:G1000\").SpecialCells(xlCellTypeVisible).Delete\n      Application.DisplayAlerts = True\n\n      '3. Clear Filter\n      On Error Resume Next\n        ws.ShowAllData\n      On Error GoTo 0\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550779161, "post_id": 54786758, "comment_id": 96406933, "body": "Thank you for the great example for deleting rows from the bottom up. I will try this out to see how it improves. Thanks!"}, {"owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "edited": false, "score": 0, "creation_date": 1550848673, "post_id": 54786758, "comment_id": 96435092, "body": "I edited the question to delete rows from bottom up. It worked great! Thank you for the suggestion!"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1550666905, "creation_date": 1550666905, "answer_id": 54786758, "question_id": 54774663, "link": "https://stackoverflow.com/questions/54774663/delete-row-if-cells-equal-a-set-of-values/54786758#54786758", "title": "Delete row if cells equal a set of values", "body": "<p>Below is a sample how to delete rows based on a criteria in column A. Keep in mind that if we delete rows we go backwards to avoid index errors.</p>\n\n<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Lastrow As Long, i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'Where you delete you go backwards\n        For i = Lastrow To 2 Step -1\n            If .Range(\"A\" &amp; i).Value = \"CAT\" Then\n                .Rows(i).EntireRow.Delete\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "is_accepted": true, "score": 1, "last_activity_date": 1551285920, "creation_date": 1551285920, "answer_id": 54910451, "question_id": 54774663, "link": "https://stackoverflow.com/questions/54774663/delete-row-if-cells-equal-a-set-of-values/54910451#54910451", "title": "Delete row if cells equal a set of values", "body": "<p>Thank you everyone for help resolving this issue. I have found that the root cause of my problem was simply the condition statement at the end of my If/Then line. The \"<strong>And_</strong>\" statement was saying \"If cell equals CAT and BAT and DOG, then delete row\" NOT \"If cell equals CAT or BAT or DOG, then delete row\". Replacing \"<strong>And_</strong>\" with \"<strong>Or_</strong>\" has fixed this issue.</p>\n\n<pre><code>'False screen updating\n  Application.ScreenUpdating = False\n'deleting all other types other than CAT from \"samples\" tab (excluding the header row, row 1)\n  Sheets(\"sample\").Select\n  Lastrow = Cells(Rows.Count, \"AN\").End(xlUp).Row\n'Deleting rows from bottom up\n    For i = Lastrow To 2 Step -1\n        If Range(\"AN\" &amp; i).Value = \"CAT\" Or _\n           Range(\"AN\" &amp; i).Value = \"BAT\" Or _\n           Range(\"AN\" &amp; i).Value = \"DOG\" Or _\n           Range(\"AN\" &amp; i).Value = \"\" Then\n             Rows(i).EntireRow.Delete\n        End If\n    Next i\n</code></pre>\n\n<p>However, I would also like to delete rows if the cells is <strong>Blank \"\"</strong>. Why would the Sub ignore this line?</p>\n\n<pre><code>  Range(\"AN\" &amp; i).Value = \"\" Then\n</code></pre>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 11, "user_id": 10500849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eukh2kOIOiI/AAAAAAAAAAI/AAAAAAAAAAg/JhzaGeCv7LE/photo.jpg?sz=128", "display_name": "Sherbeana", "link": "https://stackoverflow.com/users/10500849/sherbeana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 54910451, "answer_count": 4, "score": 0, "last_activity_date": 1551285920, "creation_date": 1550609263, "last_edit_date": 1550944995, "question_id": 54774663, "link": "https://stackoverflow.com/questions/54774663/delete-row-if-cells-equal-a-set-of-values", "title": "Delete row if cells equal a set of values", "body": "<p>I created a macro to in order to generate a daily report. The portion of the macro that finds a value in column AN and deletes the entire row (code edited to delete rows starting from the last used row), works well. \nThe following example deletes all the rows that <strong>do not</strong> contain the value \"CAT\",\"BAT\", or \"DOG in column AN.</p>\n\n<pre><code>'False screen updating\n  Application.ScreenUpdating = False\n'deleting all other types other than CAT from \"samples\" tab (excluding the header row, row 1)\n  Sheets(\"sample\").Select\n  Lastrow = Cells(Rows.Count, \"AN\").End(xlUp).Row\n'Deleting rows from bottom up\n    For i = Lastrow To 2 Step -1\n        If Range(\"AN\" &amp; i).Value &lt;&gt; \"CAT\" And _\n           Range(\"AN\" &amp; i).Value &lt;&gt; \"BAT\" And _\n           Range(\"AN\" &amp; i).Value &lt;&gt; \"DOG\" Then\n             Rows(i).EntireRow.Delete\n        End If\n    Next i\n</code></pre>\n\n<p>However, would like to create another Sub that deletes all the rows that <strong>do</strong> contain a specific set of values.\nI tried <strong>replacing &lt;></strong> with <strong>=</strong> and <strong>==</strong>, however neither worked and no rows were deleted</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1550609804, "post_id": 54774567, "comment_id": 96329632, "body": "Why are you switching between views?"}, {"owner": {"reputation": 41, "user_id": 10946200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c1085190dba578c87f974bf60d3cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Dair Indy", "link": "https://stackoverflow.com/users/10946200/dair-indy"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1550691972, "post_id": 54774567, "comment_id": 96366288, "body": "User is clicking a button on the Navigation form.  The DoCmd is can&#39;t open the file in Print Preview view without restricting formatting options.  So it has to be opened in normal view.  When the user switches view to print the document, it runs the formatting code again, creating errors because of the formatting restrictions."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10946200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c1085190dba578c87f974bf60d3cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Dair Indy", "link": "https://stackoverflow.com/users/10946200/dair-indy"}, "edited": false, "score": 0, "creation_date": 1550692063, "post_id": 54781331, "comment_id": 96366351, "body": "Ty Gustav. Basic programing: the Global like private variable at the top of the report code.  I am rusty."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1550649210, "creation_date": 1550649210, "answer_id": 54781331, "question_id": 54774567, "link": "https://stackoverflow.com/questions/54774567/vba-how-to-keep-code-from-executing-while-flipping-between-report-views/54781331#54781331", "title": "VBA - How to keep code from executing while flipping between report views", "body": "<p>Instead of a textbox, use a private variable (private to the report) in the top of the report's code module:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate IsFormatted As Boolean\n</code></pre>\n\n<p>It will be <em>False</em> when opening the report.\nThen set this to <em>True</em> as you do now, and check this variable before running the formatting code.</p>\n"}], "owner": {"reputation": 41, "user_id": 10946200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c1085190dba578c87f974bf60d3cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Dair Indy", "link": "https://stackoverflow.com/users/10946200/dair-indy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 54781331, "answer_count": 1, "score": -1, "last_activity_date": 1550649210, "creation_date": 1550608809, "question_id": 54774567, "link": "https://stackoverflow.com/questions/54774567/vba-how-to-keep-code-from-executing-while-flipping-between-report-views", "title": "VBA - How to keep code from executing while flipping between report views", "body": "<p>I'm using a report like a template for similar projects.  I have code formatting it when it opens.  Problem is, the code executes when switching to Print Preview view.  Some formatting the code does is not allowed in that view.</p>\n\n<p>I've got around the problem by putting an invisible textbox, named \"txtFormatted\" in my report.  My code populates it, once done formatting, with \"True\".  The module won't execute while the textbox has that value.</p>\n\n<p>But this solution seems sloppy.  What do people do to have code execute when opening a report but not to run again when flipping through views?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1550608411, "post_id": 54774296, "comment_id": 96329018, "body": "I&#39;ve been trying to do it that way for awhile now, and can&#39;t. I have to navigate to the website to refresh for the most recent file anyway."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 1, "creation_date": 1550615461, "post_id": 54774296, "comment_id": 96331770, "body": "edited my question"}], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1550646423, "answer_count": 0, "score": 1, "last_activity_date": 1550689215, "creation_date": 1550607485, "last_edit_date": 1550689215, "question_id": 54774296, "link": "https://stackoverflow.com/questions/54774296/not-a-duplicate-how-to-set-file-path-in-window-explorer-after-downloading-file", "closed_reason": "Duplicate", "title": "NOT A DUPLICATE - How to Set File Path in Window Explorer After Downloading File From IE", "body": "<p>After VBA clicks save as, and the window appears, I'd like to be able to set the file path. I've tried ChDir() and direct downloads with winhttp, but neither work for this. My source for the code is at: <a href=\"https://www.mrexcel.com/forum/excel-questions/502298-need-help-regarding-ie-automation-using-vba-3.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/502298-need-help-regarding-ie-automation-using-vba-3.html</a></p>\n\n<p>Any help figuring out how to set the file path, I'm assuming in the top window (path window) of the file explorer, would be helpful.</p>\n\n<p>***THIS IS NOT A DUPLICATE QUESTION. WINHTTP DOWNLOAD WILL NOT WORK ON THIS WEBSITE.</p>\n\n<p>Below is what I'm currently trying, but does not change the file path in the file explorer window, but only adds the file path in the File name window, which doesn't change where the file is saved. </p>\n\n<pre><code>Private Sub Save_As_Set_Filename(ByRef ZipfileName)\n    Dim hwnd As Long\n    Dim timeout As Date\n    Dim fullFilename As String\n\n    'Find the Save As window, waiting a maximum of 10 seconds for it to appear\n    timeout = Now + TimeValue(\"00:00:10\")\n    Do\n        hwnd = FindWindow(\"#32770\", \"Save As\")\n        DoEvents\n        Sleep 300\n    Loop Until hwnd Or Now &gt; timeout\n\n    If hwnd Then\n        SetForegroundWindow hwnd\n        'Find the child DUIViewWndClassName window\n       hwnd = FindWindowEx(hwnd, 0, \"DUIViewWndClassName\", vbNullString)\n    End If\n\n    If hwnd Then\n        SetForegroundWindow hwnd\n        'Find the child DirectUIHWND window\n        hwnd = FindWindowEx(hwnd, 0, \"DirectUIHWND\", \"\")\n    End If\n\n    If hwnd Then\n        'Find the child FloatNotifySink window\n        hwnd = FindWindowEx(hwnd, 0, \"FloatNotifySink\", \"\")\n    End If\n\n    If hwnd Then\n        'Find the child ComboBox window\n        hwnd = FindWindowEx(hwnd, 0, \"ComboBox\", \"\")\n    End If\n\n    If hwnd Then\n        'Find the child Edit window\n        hwnd = FindWindowEx(hwnd, 0, \"Edit\", \"\")\n    End If\n\n    If hwnd Then\n        ZipfileName = Get_Window_Text(hwnd)\n\n        'If specified, ensure folder ends with \\\n        folder = Environ(\"USERPROFILE\") &amp; \"\\Downloads\\\"\n        If folder &lt;&gt; \"\" And Right(folder, 1) &lt;&gt; \"\\\" Then folder = folder &amp; \"\\\"\n        fullFilename = folder &amp; ZipfileName \n\n        'Populate the Edit window with the full file name\n        Sleep 300\n        SetForegroundWindow hwnd\n        SendMessageByString hwnd, WM_SETTEXT, Len(fullFilename ), fullFilename \n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1550642664, "creation_date": 1550642664, "answer_id": 54779804, "question_id": 54774075, "link": "https://stackoverflow.com/questions/54774075/change-font-color-for-certain-text-in-ms-word/54779804#54779804", "title": "Change font color for certain text in MS Word", "body": "<p>You can do that with two <em>wildcard</em> Find/Replace operations, without recourse to a macro, using:</p>\n\n<pre><code>Find = +[0-9.%$M]{1,}\nReplace = ^&amp;\n</code></pre>\n\n<p>with the replacement font colour set to green, and</p>\n\n<pre><code>Find = \\-[0-9.%$M]{1,}\nReplace = ^&amp;\n</code></pre>\n\n<p>with the replacement font colour set to red. You could, of course, use the macro recorder to create a single macro containing both operations.</p>\n"}], "owner": {"reputation": 1, "user_id": 11086351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11bc9c84a62d8c9d7499af05781e748?s=128&d=identicon&r=PG&f=1", "display_name": "J. Chan", "link": "https://stackoverflow.com/users/11086351/j-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550642664, "creation_date": 1550606509, "last_edit_date": 1550610579, "question_id": 54774075, "link": "https://stackoverflow.com/questions/54774075/change-font-color-for-certain-text-in-ms-word", "title": "Change font color for certain text in MS Word", "body": "<p>I have very little VBA experience and a have a large document that contains the text similar to below:</p>\n\n<blockquote>\n  <p>\"(+12.3%) which translates to (-$78.9M)\"</p>\n</blockquote>\n\n<p>Kind of similar to <a href=\"https://stackoverflow.com/questions/30567552/change-font-color-for-a-part-of-text-in-cell\">this question</a> I want to change text that follows the symbol \"+\" or \"-\" to green and red respectively, while keeping text black.</p>\n\n<p>Is it possible for a VBA code that can automatically do this?</p>\n"}, {"tags": ["excel", "vba", "selenium", "web-scraping", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550607049, "post_id": 54773779, "comment_id": 96328389, "body": "Is this a login based/internal URL?"}, {"owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550607451, "post_id": 54773779, "comment_id": 96328584, "body": "Yes. I have got it set up to log into the site just fine."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550608200, "post_id": 54773779, "comment_id": 96328913, "body": "And what is the error message you are getting and on which line?"}, {"owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550609006, "post_id": 54773779, "comment_id": 96329281, "body": "I am getting run-time error &#39;438&#39; and it is not returning a list of OrderIds to my spreadsheet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550609043, "post_id": 54773779, "comment_id": 96329303, "body": "on which line does that occur?"}, {"owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550609173, "post_id": 54773779, "comment_id": 96329357, "body": "It occurs on the .Click after ActiveSheet.Cells(FOL, 7) = FOrderID.Text"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550612766, "post_id": 54773779, "comment_id": 96330824, "body": "where is the object the .click refers to? You may need to show more of the surrounding code. Also, more of the source html."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "edited": false, "score": 1, "creation_date": 1550613239, "post_id": 54773779, "comment_id": 96331011, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/188708/discussion-between-qharr-and-daultonb\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1550615608, "creation_date": 1550615608, "answer_id": 54775965, "question_id": 54773779, "link": "https://stackoverflow.com/questions/54773779/in-vba-selenium-how-to-target-and-click-a-class-and-return-values-found-on-the/54775965#54775965", "title": "In VBA Selenium how to target and click &lt;a class&gt; and return values found on the next page to spreadsheet and loop through all results?", "body": "<p>From discussions:</p>\n\n<p>Current page you need</p>\n\n<pre><code>FOrderID.click\n</code></pre>\n\n<p>The click is a method of an object therefore you need to give it an object</p>\n\n<p>Next page</p>\n\n<pre><code>.FindElementByCss(\".status-history\").text\n</code></pre>\n\n<p>As id is dynamic</p>\n"}], "owner": {"reputation": 37, "user_id": 11035065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3d262e60834a0f104b218dde7578c5?s=128&d=identicon&r=PG&f=1", "display_name": "DaultonB", "link": "https://stackoverflow.com/users/11035065/daultonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 54775965, "answer_count": 1, "score": -1, "last_activity_date": 1550681973, "creation_date": 1550605175, "last_edit_date": 1550681973, "question_id": 54773779, "link": "https://stackoverflow.com/questions/54773779/in-vba-selenium-how-to-target-and-click-a-class-and-return-values-found-on-the", "title": "In VBA Selenium how to target and click &lt;a class&gt; and return values found on the next page to spreadsheet and loop through all results?", "body": "<p>I am trying to click a  element on a page and return values found on the next page for each result on the page. The results I want from the next page is who shipped the shipment. </p>\n\n<p>Here is the relevant VBA code:</p>\n\n<pre><code>   Dim FOrderID As Object, FOrderList As Object, FOL As Long\n    FOL = 1\n    t = Timer\n    Do\n        Set FOrderList = driver.FindElementsByXPath(\"//div[3]//div[3]//span/a\")\n        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    Loop While FOrderList.Count = 0\n    If FOrderList.Count &gt; 0 Then\n\n        For Each FOrderID In FOrderList\n            FOL = FOL + 1\n            ActiveSheet.Cells(FOL, 7) = FOrderID.Text\n\n            .Click\n\n            With .FindElementByXPath(\"//a[text()[contains(.,'Shipments')]]\")\n                .Click\n            End With\n\n            ActiveSheet.Cells(FOL, 8) = .FindElementById(\"sc14821\").Text\n        Next\n\n\n    End If\n</code></pre>\n\n<p>Here is a pastebin link to the relevant HTML on the main page. <a href=\"https://pastebin.com/epFSzG8E\" rel=\"nofollow noreferrer\">https://pastebin.com/epFSzG8E</a></p>\n\n<p>Also the page where I want to grab information from. \n<a href=\"https://pastebin.com/xBQnbQza\" rel=\"nofollow noreferrer\">https://pastebin.com/xBQnbQza</a></p>\n\n<p>Please note that on the main page that the header elements also have the same a class.</p>\n\n<p>Also here is the Xpath for the element I am trying to click/use: \n//[@id=\"sc25579\"]/div/div/div/div/div[3]/div/div[1]/div/div[1]/div[3]/div[1]/div/div/div[2]/div/div[4]/span/a</p>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1550610262, "post_id": 54773762, "comment_id": 96329833, "body": "This is a good new contributor post in my opinion +"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1550609658, "last_edit_date": 1550609658, "creation_date": 1550608941, "answer_id": 54774593, "question_id": 54773762, "link": "https://stackoverflow.com/questions/54773762/vba-submit-selected-value-from-dropdown-box/54774593#54774593", "title": "VBA - Submit selected value from dropdown box", "body": "<p><strong>Internet Explorer:</strong></p>\n\n<p>Looking at the event listeners for that <code>select</code> element it monitors an <code>change</code> event. If you add and trigger that it works</p>\n\n<pre><code>Option Explicit\nPublic Sub MakeSelection()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.2dehands.be/plaats/\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\".icon-radiobutton\").Click\n\n        Dim event_onChange As Object\n        Set event_onChange = .document.createEvent(\"HTMLEvents\")\n        event_onChange.initEvent \"change\", True, False\n\n        With .document.querySelector(\"#level1-option\")\n            .selectedIndex = 2\n            .FireEvent \"onchange\"\n            .dispatchEvent event_onChange\n        End With\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Selenium Basic:</strong></p>\n\n<p>I would consider using <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium basic</a> for vba. After installing ensure the ChromeDriver.exe is in the selenium folder and go to VBE > Tools > References > Add a reference to selenium type library.</p>\n\n<pre><code>Option Explicit\nPublic Sub MakeSelection()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const url = \"https://www.2dehands.be/plaats/\"\n    With d\n        .Start \"Chrome\"\n        .get url\n        .FindElementByCss(\"button[data-consent-all]\").Click\n        .FindElementByCss(\".icon-radiobutton\").Click\n        .FindElementById(\"level1-option\").AsSelect.SelectByText \"Antiek &amp; Art\"\n        Stop\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11075191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-72HNXjf5yQw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMkmPmmqRDVYe5J09UVo2P_BxxbIQ/mo/photo.jpg?sz=128", "display_name": "drommels rommel", "link": "https://stackoverflow.com/users/11075191/drommels-rommel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 54774593, "answer_count": 1, "score": 0, "last_activity_date": 1550610211, "creation_date": 1550605122, "last_edit_date": 1550610211, "question_id": 54773762, "link": "https://stackoverflow.com/questions/54773762/vba-submit-selected-value-from-dropdown-box", "title": "VBA - Submit selected value from dropdown box", "body": "<p>I am looking for a way to select a certain option from a drop down list. I am able to highlight the value that I want but I am not able to activate it. Instead, the option from the list just becomes blue. I also cannot click on anything else anymore. </p>\n\n<p>The second drop down list also does not appear as it depends on the option chosen in the first drop down list. </p>\n\n<p>Can anybody point me in the right direction? I assume that I have to submit or activate my choice? But I've been trying multiple different things that I found googling but none seem to work. </p>\n\n<p>Here is my VBA code:</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"https://www.2dehands.be/plaats/\"\n\n\nWhile IE.Busy\n    DoEvents\nWend\n\n\nIE.document.getElementById(\"manual-option\").Click\n\n\nSet Title = IE.document.getElementById(\"level1-option\")\nTitle.selectedIndex = 5\n\n\nIE.Quit\nSet IE = Nothing\n</code></pre>\n\n<p>And here is the HTML code:</p>\n\n<pre><code> &lt;div class=\"categories-wrapper-wrapper\"&gt;\n  &lt;div class=\"suggestion-wrapper\"&gt;\n    &lt;div class=\"custom-radio\"&gt;\n      &lt;input  type=\"radio\" name=\"suggestion\" id=\"manual-option\" class=\"manual-option\" value=\"manual-option\" /&gt;\n      &lt;label for=\"manual-option\"&gt;\n        Manueel selecteren\n      &lt;/label&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"categories-wrapper  \"&gt;\n    &lt;div class=\"custom-select\" data-custom-select&gt;\n      &lt;label for=\"level1-option\" class=\"has-hidden-label\"&gt;Afdeling&lt;/label&gt;\n      &lt;span class=\"btn-select icon-down_thin\"&gt;Kies afdeling&lt;/span&gt;\n      &lt;select class=\"categories-options\" data-level=\"1\" name=\"level1-option\" id=\"level1-option\" &gt;\n        &lt;option value=\"\"&gt;Kies afdeling&lt;/option&gt;\n        &lt;option value=\"kunstantiek\" \n                data-href=\"/callback/discovery/kunstantiek/\"&gt;Antiek &amp;amp; Art&lt;/option&gt;\n        &lt;option value=\"audiovideo\" \n                data-href=\"/callback/discovery/audiovideo/\"&gt;Audio, Video &amp;amp; TV&lt;/option&gt;\n        &lt;option value=\"auto-onderd-access\" \n                data-href=\"/callback/discovery/auto-onderd-access/\"&gt;Auto-onderdelen&lt;/option&gt;\n        &lt;option value=\"auto\" \n                data-href=\"/callback/discovery/auto/\"&gt;Auto's&lt;/option&gt;\n        &lt;option value=\"beauty\" \n                data-href=\"/callback/discovery/beauty/\"&gt;Beauty &amp;amp; Gezondheid&lt;/option&gt;\n        &lt;option value=\"auto-bedrijf\" \n                data-href=\"/callback/discovery/auto-bedrijf/\"&gt;Bestelwagens &amp;amp; Vrachtwagens&lt;/option&gt;\n        &lt;option value=\"sieraden\" \n                data-href=\"/callback/discovery/sieraden/\"&gt;Bijoux &amp;amp; Horloges&lt;/option&gt;\n        &lt;option value=\"boek\" \n                data-href=\"/callback/discovery/boek/\"&gt;Boeken &amp;amp; Strips&lt;/option&gt;\n        &lt;option value=\"boten\" \n                data-href=\"/callback/discovery/boten/\"&gt;Boten&lt;/option&gt;\n        &lt;option value=\"brommerscooter\" \n                data-href=\"/callback/discovery/brommerscooter/\"&gt;Brommers &amp;amp; Scooters&lt;/option&gt;\n        &lt;option value=\"kantoor\" \n                data-href=\"/callback/discovery/kantoor/\"&gt;Business &amp;amp; Industrie&lt;/option&gt;\n        &lt;option value=\"kamperen\" \n                data-href=\"/callback/discovery/kamperen/\"&gt;Caravans &amp;amp; Kamperen&lt;/option&gt;\n        &lt;option value=\"cd\" \n                data-href=\"/callback/discovery/cd/\"&gt;CD &amp;amp; Vinyl&lt;/option&gt;\n        &lt;option value=\"computer\" \n                data-href=\"/callback/discovery/computer/\"&gt;Computer &amp;amp; Game Consoles&lt;/option&gt;\n        &lt;option value=\"dieren\" \n                data-href=\"/callback/discovery/dieren/\"&gt;Dieren &amp;amp; Toebehoren&lt;/option&gt;\n        &lt;option value=\"doe-het-zelf-bouw\" \n                data-href=\"/callback/discovery/doe-het-zelf-bouw/\"&gt;Doe-het-zelf &amp;amp; Bouw&lt;/option&gt;\n        &lt;option value=\"witgoed\" \n                data-href=\"/callback/discovery/witgoed/\"&gt;Elektronische apparatuur&lt;/option&gt;\n        &lt;option value=\"fiets\" \n                data-href=\"/callback/discovery/fiets/\"&gt;Fietsen&lt;/option&gt;\n        &lt;option value=\"films-tv-series\" \n                data-href=\"/callback/discovery/films-tv-series/\"&gt;Films &amp;amp; TV-series&lt;/option&gt;\n        &lt;option value=\"foto\" \n                data-href=\"/callback/discovery/foto/\"&gt;Foto &amp;amp; Camera&lt;/option&gt;\n        &lt;option value=\"vrijetijd\" \n                data-href=\"/callback/discovery/vrijetijd/\"&gt;Hobby&lt;/option&gt;\n        &lt;option value=\"meubel\" \n                data-href=\"/callback/discovery/meubel/\"&gt;Huis &amp;amp; Meubelen&lt;/option&gt;\n        &lt;option value=\"huis\" \n                data-href=\"/callback/discovery/huis/\"&gt;Immo&lt;/option&gt;\n        &lt;option value=\"werk\" \n                data-href=\"/callback/discovery/werk/\"&gt;Jobs &amp;amp; Diensten&lt;/option&gt;\n        &lt;option value=\"keuken\" \n                data-href=\"/callback/discovery/keuken/\"&gt;Keuken&lt;/option&gt;\n        &lt;option value=\"kids\" \n                data-href=\"/callback/discovery/kids/\"&gt;Kinderen &amp;amp; Baby's&lt;/option&gt;\n        &lt;option value=\"kleding\" \n                data-href=\"/callback/discovery/kleding/\"&gt;Kleding &amp;amp; Accessoires&lt;/option&gt;\n        &lt;option value=\"landbouw\" \n                data-href=\"/callback/discovery/landbouw/\"&gt;Landbouw &amp;amp; Tuinbouw&lt;/option&gt;\n        &lt;option value=\"motor\" \n                data-href=\"/callback/discovery/motor/\"&gt;Motoren&lt;/option&gt;\n        &lt;option value=\"muziek\" \n                data-href=\"/callback/discovery/muziek/\"&gt;Muziek&lt;/option&gt;\n        &lt;option value=\"overig\" \n                data-href=\"/callback/discovery/overig/\"&gt;Overig&lt;/option&gt;\n        &lt;option value=\"paardensport\" \n                data-href=\"/callback/discovery/paardensport/\"&gt;Paardensport&lt;/option&gt;\n        &lt;option value=\"revalidatie\" \n                data-href=\"/callback/discovery/revalidatie/\"&gt;Revalidatie &amp;amp; Zorg&lt;/option&gt;\n        &lt;option value=\"speelgoed\" \n                data-href=\"/callback/discovery/speelgoed/\"&gt;Speelgoed &amp;amp; Spelletjes&lt;/option&gt;\n        &lt;option value=\"sport\" \n                data-href=\"/callback/discovery/sport/\"&gt;Sport &amp;amp; Fitness&lt;/option&gt;\n        &lt;option value=\"studie\" \n                data-href=\"/callback/discovery/studie/\"&gt;Studeren&lt;/option&gt;\n        &lt;option value=\"telecom\" \n                data-href=\"/callback/discovery/telecom/\"&gt;Telecommunicatie&lt;/option&gt;\n        &lt;option value=\"tuin\" \n                data-href=\"/callback/discovery/tuin/\"&gt;Tuin&lt;/option&gt;\n        &lt;option value=\"vakantie-toerisme\" \n                data-href=\"/callback/discovery/vakantie-toerisme/\"&gt;Vakantie &amp;amp; Toerisme&lt;/option&gt;\n        &lt;option value=\"verzamel\" \n                data-href=\"/callback/discovery/verzamel/\"&gt;Verzamelen&lt;/option&gt;\n        &lt;option value=\"zendamateur\" \n                data-href=\"/callback/discovery/zendamateur/\"&gt;Zendamateur&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;button type=\"submit\" class=\"category-submit ui-button-secondary \" &gt;Selecteer&lt;/button&gt;\n    &lt;/div&gt;\n    &lt;div class=\"custom-select is-disabled\" data-custom-select&gt;\n      &lt;label for=\"level2-option\" class=\"has-hidden-label\"&gt;Rubriek&lt;/label&gt;\n      &lt;span class=\"btn-select icon-down_thin\"&gt;Kies rubriek&lt;/span&gt;\n      &lt;select class=\"categories-options\" data-level=\"2\" name=\"level2-option\" id=\"level2-option\"  disabled=\"disabled\" &gt;\n        &lt;option value=\"\"&gt;Kies rubriek&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;button type=\"submit\" class=\"category-submit ui-button-secondary is-hidden\"  disabled=\"disabled\" &gt;Selecteer&lt;/button&gt;\n    &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["vba", "class", "variables", "properties"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1550606205, "post_id": 54773602, "comment_id": 96327977, "body": "You&#39;re using the wrong syntax for assignments using CallByName. See  the examples here <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/callbyname-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "edited": false, "score": 0, "creation_date": 1550605606, "post_id": 54773680, "comment_id": 96327676, "body": "Sorry, I must have pasted an older version: I did try both VbLet and VbSet (both gave Error 446: Object doesn&#39;t support named arguments).  I did try your different syntax, though, and got the error: &quot;Run-Time error &#39;450&#39;: Wrong number of arguments or invalid property assignment.  I&#39;ll update the original post with the errors I got with VbLet and VbSet"}, {"owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "edited": false, "score": 0, "creation_date": 1550606732, "post_id": 54773680, "comment_id": 96328246, "body": "If you use the same syntax but with VbLet, it works!  If you change your answer to reflect that I will mark it correct."}, {"owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "reply_to_user": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "edited": false, "score": 0, "creation_date": 1550618174, "post_id": 54773680, "comment_id": 96332531, "body": "Oh, right, <code>Let</code> for a value as opposed to <code>Set</code> for an object. My bad."}], "tags": [], "owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "is_accepted": true, "score": 2, "last_activity_date": 1550609551, "last_edit_date": 1550609551, "creation_date": 1550604822, "answer_id": 54773680, "question_id": 54773602, "link": "https://stackoverflow.com/questions/54773602/callbyname-works-with-msgbox-but-not-when-assigning-a-value-object-required-e/54773680#54773680", "title": "CallByName works with MsgBox but Not When Assigning a Value (&quot;Object Required&quot; Error)", "body": "<blockquote>\n  <p><code>CallByName(oThisInvoice, DataType, VbGet) = 5</code></p>\n</blockquote>\n\n<p>Of course that doesn't work to set a value. You are calling a <code>Get</code> procedure, as evidenced by the use of <code>VbGet</code>. Get doesn't set values, it gets them.</p>\n\n<p>What you need to do instead is use <code>CallByName</code> with <code>VbLet</code>:</p>\n\n<pre><code>CallByName oThisInvoice, DataType, VbLet, 5\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 54773680, "answer_count": 1, "score": 0, "last_activity_date": 1550609565, "creation_date": 1550604478, "last_edit_date": 1550609565, "question_id": 54773602, "link": "https://stackoverflow.com/questions/54773602/callbyname-works-with-msgbox-but-not-when-assigning-a-value-object-required-e", "title": "CallByName works with MsgBox but Not When Assigning a Value (&quot;Object Required&quot; Error)", "body": "<p>Using VBA in excel: </p>\n\n<p>I have a function where I want to access class properties using variables for property names.  I was able to use a variable with CallByName to MsgBox the property value back to me:</p>\n\n<pre><code>MsgBox CallByName(oThisInvoice, DataType, VbGet)\n</code></pre>\n\n<p>Where oThisInvoice is a class object and DataType is the variable that contains the property name I want to access.  This statement works and is a rewrite of:</p>\n\n<pre><code>MsgBox oThisInvoice.InvoiceDate\n</code></pre>\n\n<p>However, using the same method doesn't work when assigning a value to the same property:</p>\n\n<pre><code>CallByName(oThisInvoice, DataType, VbGet) = 5\n</code></pre>\n\n<p>doesn't work, I get an \"Run-time Error 424: Object Required\" error.  Using VbLet and VbSet didn't work either, throwing \"Run-time error 446: Object doesn't support named arguments\".</p>\n\n<p>It is a rewrite of the following:</p>\n\n<pre><code>oThisInvoice.InvoiceDate = 5\n</code></pre>\n\n<p>which does work.</p>\n\n<p>Does anyone know what I can use to assign a value to a class property in VBA when using a variable to reference the property name?</p>\n"}, {"tags": ["excel", "vba", "file-io"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1550605814, "post_id": 54773359, "comment_id": 96327783, "body": "Probably at that last cell&#39;s value in the file, there is a special (unvisible) character included in the cell&#39;s value which is later read as CHR(26) End-Of-File-character (<a href=\"https://en.wikipedia.org/wiki/End-of-file\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/End-of-file</a>). Please try this: Remember that cell&#39;s value, delete it and insert it digit by digit by hand and run it again."}, {"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1550605966, "post_id": 54773359, "comment_id": 96327878, "body": "Does Excel or VBA terminate regularly or is there an error? What is the file-size of \u2019serie1.txt\u2019? And how many rows are missing compared to the Excel sheet?"}, {"owner": {"reputation": 33, "user_id": 10526173, "user_type": "registered", "profile_image": "https://graph.facebook.com/2404510686231764/picture?type=large", "display_name": "Amanda Restom de Castro", "link": "https://stackoverflow.com/users/10526173/amanda-restom-de-castro"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1550611543, "post_id": 54773359, "comment_id": 96330344, "body": "@Asger actually, my cells are all formulas. Do you think maybe that is the problem?"}, {"owner": {"reputation": 33, "user_id": 10526173, "user_type": "registered", "profile_image": "https://graph.facebook.com/2404510686231764/picture?type=large", "display_name": "Amanda Restom de Castro", "link": "https://stackoverflow.com/users/10526173/amanda-restom-de-castro"}, "reply_to_user": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1550611704, "post_id": 54773359, "comment_id": 96330410, "body": "@hc_dev some times it terminates regularly and some times it just breaks my excel! I never get the error message... the file size is 6KB. There are 254 rows, and it writes until row 247."}, {"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1550748791, "post_id": 54773359, "comment_id": 96388454, "body": "Figures seem to be in normal ranges (254 rows should be written fast, file of 6KB should not cause trouble). What happens if you select another sheet or workbook for your macro, what if you move the starting-range? Will it always break at the same cell (in row 247)? <i>Point is: your VBA code looks correct :)</i>"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10526173, "user_type": "registered", "profile_image": "https://graph.facebook.com/2404510686231764/picture?type=large", "display_name": "Amanda Restom de Castro", "link": "https://stackoverflow.com/users/10526173/amanda-restom-de-castro"}, "is_accepted": true, "score": 0, "last_activity_date": 1574798831, "creation_date": 1574798831, "answer_id": 59058637, "question_id": 54773359, "link": "https://stackoverflow.com/questions/54773359/write-txt-file-with-vba-file-is-interrupted/59058637#59058637", "title": "Write TXT file with VBA - File is interrupted", "body": "<p>A follow up (if anyone ever face this problem):</p>\n\n<p>I think the file was too long for my excel, and it some how it got overwhelmed. The solution was to limit the number of decimals before running the code. So I put a =ROUND(xxx, 2) on my excel file! </p>\n\n<p>I hope it helps! </p>\n"}], "owner": {"reputation": 33, "user_id": 10526173, "user_type": "registered", "profile_image": "https://graph.facebook.com/2404510686231764/picture?type=large", "display_name": "Amanda Restom de Castro", "link": "https://stackoverflow.com/users/10526173/amanda-restom-de-castro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 59058637, "answer_count": 1, "score": 1, "last_activity_date": 1574798831, "creation_date": 1550603442, "last_edit_date": 1553535193, "question_id": 54773359, "link": "https://stackoverflow.com/questions/54773359/write-txt-file-with-vba-file-is-interrupted", "title": "Write TXT file with VBA - File is interrupted", "body": "<p>I have a VBA macro that writes a txt file in \"datevalue\" format (that is, year tab month tab data) before running the X13 ARIMA SEATS. </p>\n\n<p>It has always worked, but recently it works only some times. When I looked at the .txt file it generated before seasonally adjusting it, it was interrupted in the middle of a row. For 1998 until July 2018 it writes the file as it has always done, but than it stops in the middle of the decimal place. </p>\n\n<p>This is the part of the code that writes the txt datevalue file. Ano and mes (year and month) are inputs from the beginning of the code. </p>\n\n<pre><code>Private Sub copyData(ByVal mes As Integer, ByVal ano As Integer, rng As Range)\n    Dim sFileText As String\n    Dim iFileNo As Integer\n    Dim i, col As Double\n\n    i = rng.Row\n    col = rng.Column\n    ficar = True\n    iFileNo = FreeFile\n\n    Open \"P:\\Macro\\X12\\Input\\serie1.txt\" For Output As #iFileNo\n\n    'Writes the file with the time series\n    While Cells(i, col) &lt;&gt; \"\"\n        Print #iFileNo, ano &amp; Chr(9) &amp; mes &amp; Chr(9) &amp; Cells(i, col)\n        If (mes + 1) Mod 12 &gt; 0 Then mes = (mes + 1) Mod 12 Else mes = 12\n        If mes = 1 Then ano = ano + 1\n        i = i + 1\n    Wend\n\n    Close #iFileNo\n\nEnd Sub\n</code></pre>\n\n<p>This is the head of the .txt file</p>\n\n<pre><code>1998    1   4641.272855\n1998    2   3943.235604\n1998    3   5167.087047\n1998    4   4629.068494\n1998    5   4736.139222\n1998    6   4703.891762\n1998    7   5394.787069\n1998    8   4155.992635\n1998    9   5741.168184\n1998    10  5460.08048\n</code></pre>\n\n<p>This is the tail, where it stops working. </p>\n\n<pre><code>2018    4   13790.364479\n2018    5   13259.844355\n2018    6   14320.106493\n2018    7   16101.08\n</code></pre>\n\n<p>My guess is that the file now it too long.</p>\n\n<p>UPDATE!!<br>\nI added a MsgBox before Wend (as below) so the code would run slower (I keep pressing enter as it runs) and it worked. So I think it breaks the file-writing because it takes too long. </p>\n\n<pre><code>MsgBox ano &amp; Chr(9) &amp; mes &amp; Chr(9) &amp; Cells(i, col)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1550605566, "post_id": 54773817, "comment_id": 96327654, "body": "was about to paste similar, though i feel that setting the range to use the range is wasteful, given this is a single line occurrence... <i>.Range(.Cells(LR, &quot;B&quot;), .Cells(LR, &quot;M&quot;)).Value = ThisWorkbook.Sheets(&quot;Sheet2&quot;).Range(&quot;C20:N20&quot;)</i>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1550605639, "post_id": 54773817, "comment_id": 96327691, "body": "@Cyril def a valid statement. I started typing it out with intent to copy paste and then changed my mind and didn\u2019t go back"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 3, "last_activity_date": 1550605396, "creation_date": 1550605396, "answer_id": 54773817, "question_id": 54773055, "link": "https://stackoverflow.com/questions/54773055/how-do-i-use-a-button-to-move-a-range-of-cell-contents-to-another-range-in-a-wor/54773817#54773817", "title": "how do i use a button to move a range of cell contents to another range in a worksheet", "body": "<p>Instead of copy/paste, try a <em>Value Transfer</em></p>\n\n<pre><code>Sub Move()\n\nDim cRange As Range, LR As Long\n\nWith ThisWorkbook.Sheets(\"Sheet3\")\n    LR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1).Row\n    Set cRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"C20:N20\")\n    .Range(.Cells(LR, \"B\"), .Cells(LR, \"M\")).Value = cRange.Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1550605554, "creation_date": 1550605554, "answer_id": 54773852, "question_id": 54773055, "link": "https://stackoverflow.com/questions/54773055/how-do-i-use-a-button-to-move-a-range-of-cell-contents-to-another-range-in-a-wor/54773852#54773852", "title": "how do i use a button to move a range of cell contents to another range in a worksheet", "body": "<p>There are kinds of ways to do this.  Here's one option.</p>\n\n<pre><code>Sub CopyRange()\nWorksheets(\"Sheet1\").Range(\"A1:D20\").Copy Worksheets(\"Sheet2\").Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>Now, if the ranges will change dynamically, you would want to do it more like this.</p>\n\n<pre><code>Sub SelectFilledCells()\nRange(\"A1\", Range(\"A1\").End(xlDown).End(xlToRight)).Select\nEnd Sub\n</code></pre>\n\n<p>Take a look at these links as well.</p>\n\n<p><a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a></p>\n\n<p><a href=\"https://www.spreadsheetsmadeeasy.com/assign-button-macro/\" rel=\"nofollow noreferrer\">https://www.spreadsheetsmadeeasy.com/assign-button-macro/</a></p>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1550607440, "creation_date": 1550607440, "answer_id": 54774286, "question_id": 54773055, "link": "https://stackoverflow.com/questions/54773055/how-do-i-use-a-button-to-move-a-range-of-cell-contents-to-another-range-in-a-wor/54774286#54774286", "title": "how do i use a button to move a range of cell contents to another range in a worksheet", "body": "<p>To answer your question. Keep is simple</p>\n\n<p>Create a Button on sheet2</p>\n\n<p>Assign a new macro to the button and place this single line of code between the Sub and End Sub</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"C20:N20\").Copy Destination:=Sheets(\"Sheet3\").Cells(Rows.Count, 2).End(xlUp).Offset(1)\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 5639779, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/gvFHH.png?s=128&g=1", "display_name": "theteague", "link": "https://stackoverflow.com/users/5639779/theteague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 54773817, "answer_count": 3, "score": 0, "last_activity_date": 1550607440, "creation_date": 1550602118, "question_id": 54773055, "link": "https://stackoverflow.com/questions/54773055/how-do-i-use-a-button-to-move-a-range-of-cell-contents-to-another-range-in-a-wor", "title": "how do i use a button to move a range of cell contents to another range in a worksheet", "body": "<p>Every day I run a query that replaces data in an Excel workbook on Sheet1. Sheet2 is a report that uses formulas to summarize the new data on Sheet1. I need to start trending the report data on Sheet3. I want to put a button on Sheet2 that I can click that will move data from C20:N20 on Sheet2 and store it in the next available row in columns B:M on Sheet3. I know I could just record a macro and grab that code and assign it to the button, but I can't figure out how to tell the code to look for the next available row.</p>\n\n<p>This is wrong, but represents what I'm trying to do, how do I fix it?</p>\n\n<pre><code>Sub Apv_Conv_TrendIt()\nDim LastRow As Long\nLastRow = Sheets(\"Sheet3\").Range(\"B1000000\").End(xlUp).Row + 1: Sheets(\"Sheet3\").Range(\"M1000000\").End(xlUp).Row 1\nSheets(\"Sheet3\").Range(\"B\" &amp; LastRow) = Sheets(\"Sheet2\").Range(\"C20:N20\")\n\nEnd Sub\n</code></pre>\n"}]