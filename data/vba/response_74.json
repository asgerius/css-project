[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": true, "score": 1, "last_activity_date": 1465429369, "creation_date": 1465429369, "answer_id": 37714706, "question_id": 37714512, "link": "https://stackoverflow.com/questions/37714512/compare-cell-data-and-copy/37714706#37714706", "title": "Compare Cell Data and Copy", "body": "<p>Quick line by line breakdown</p>\n\n<p>This just takes the entire used range from cells A4 to the last used cell in columnA then offsets it by one column so B4:Bx (x is the last used row in column A)</p>\n\n<pre><code>With Sheets(\"Update\").Range(Cells(4, 1), Cells(Rows.Count, 1).End(xlUp)).Offset(, 1)\n</code></pre>\n\n<p>This puts the formula in all cells so it looks up A4,A5,A6, etc in master sheet, returns the value in the master sheet or an error if its not found.  It then copies the values over so they are hardcoded in</p>\n\n<pre><code>.Formula = \"=VLOOKUP(A4,'New Master Data 6.1'!A:A,1,FALSE)\"\n.Value = .Value\n</code></pre>\n\n<p>Specialcells looks for constants (all cells) and value 16 which means error cells (ie cells don't exist) offsets by -1 (so column A) and copies to new sheet column A at rows.count+1</p>\n\n<pre><code>.SpecialCells(xlCellTypeConstants, 16).Offset(, -1).Copy Sheets(\"New Master Data 6.1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n\n<p>You might also want to do this after you .clearcontents so you don't get all the error cells in column B</p>\n\n<p>to fix it just change the copied range to .entirerow so </p>\n\n<pre><code>.SpecialCells(xlCellTypeConstants, 16).entirerow.Copy Sheets(\"New Master Data 6.1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n\n<p>You will also copy the errors in column B but with this structure there is no getting around that.  Can always erase them from the master sheet after.</p>\n\n<p>Also note this code will overwrite any data you have stored in column B.</p>\n\n<p>One more note this code depends on the sheet update being active, it won't run otherwise since your cells function inside your range needs the worksheet explicitly stated, as does your rows.count.  You would be better wrapping the whole thing in 2 withs, one for the sheet and one with the range (using .cells and .rows.counmt)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6140865"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37714706, "answer_count": 1, "score": 0, "last_activity_date": 1465429369, "creation_date": 1465428101, "last_edit_date": 1465428298, "question_id": 37714512, "link": "https://stackoverflow.com/questions/37714512/compare-cell-data-and-copy", "title": "Compare Cell Data and Copy", "body": "<p>I found this great snip of code and I am trying to manipulate it to work for me, but I just can't seem to get it.  Unfortunately I haven't been able to get my head around it to fully understand it, which doesn't help.  So I turn to you.  I need to evaluate a column of cells and look for either similarities or differences.  If a cell in sheet 1 column 1 is not the same as any of the cells in sheet 2 column 1, I want to copy the entire row into sheet 1 at the bottom of the used area.  I've gotten this to the point where what you see will copy the correct first cell, but I can't manipulate it to copy the entire row.  I think because of how the 'With' is structured but I need to try to stay away from doing loops since there is over 30k cells to evaluate.  </p>\n\n<p>Going down the road I will also be wanting to look for duplicates using the same method above, and if there is a duplicate, compare the adjacent cells for differences and if there is a difference, move the existing data into a comment and move the new data into the existing cell.  </p>\n\n<p>Any and all advice is, as always, very appreciated.</p>\n\n<pre><code>Sub Compare_Function()\n    Call Get_Master_Cell_Info\n    Application.ScreenUpdating = False\n    With Sheets(\"Update\").Range(Cells(4, 1), Cells(Rows.Count, 1).End(xlUp)).Offset(, 1)\n        .Formula = \"=VLOOKUP(A4,'New Master Data 6.1'!A:A,1,FALSE)\"\n        .Value = .Value\n        .SpecialCells(xlCellTypeConstants, 16).Offset(, -1).Copy Sheets(\"New Master Data 6.1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        .ClearContents\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 2, "creation_date": 1465421618, "post_id": 37713243, "comment_id": 62900205, "body": "Seriously, though, this is not a forum for outsourcing code.  What have you tried and what specific question do you have about the code?  See <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> for help in asking a question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465422980, "post_id": 37713243, "comment_id": 62900815, "body": "<a href=\"http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm\" rel=\"nofollow noreferrer\">word.mvps.org/faqs/customization/ReplaceAnywhere.htm</a>"}, {"owner": {"reputation": 65, "user_id": 6442566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a122ba9750d5d24ccd66bebe18718a?s=128&d=identicon&r=PG&f=1", "display_name": "Enis Jasarovic", "link": "https://stackoverflow.com/users/6442566/enis-jasarovic"}, "edited": false, "score": 0, "creation_date": 1465478228, "post_id": 37713243, "comment_id": 62925505, "body": "Ok, thanks for reply. I&#39;m gonna keep in mind your suggestion. Actually, this is my first question in stackoverflow.com and it is possible that I made mistake. I&#39;m gonna provide code next time..."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6442566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a122ba9750d5d24ccd66bebe18718a?s=128&d=identicon&r=PG&f=1", "display_name": "Enis Jasarovic", "link": "https://stackoverflow.com/users/6442566/enis-jasarovic"}, "edited": false, "score": 0, "creation_date": 1465476877, "post_id": 37717529, "comment_id": 62924447, "body": "Thanks for very helpful answer."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 65, "user_id": 6442566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a122ba9750d5d24ccd66bebe18718a?s=128&d=identicon&r=PG&f=1", "display_name": "Enis Jasarovic", "link": "https://stackoverflow.com/users/6442566/enis-jasarovic"}, "edited": false, "score": 0, "creation_date": 1465477117, "post_id": 37717529, "comment_id": 62924625, "body": "@EnisJasarovic I couldn&#39;t given you the answer outright as you hadn&#39;t done any of the code to start (or you hadn&#39;t posted it at least). I have done all I can to answer your question, if you feel if I given you the information to answer please could you mark this as correct."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1542158915, "post_id": 37717529, "comment_id": 93465301, "body": "See, for example: <a href=\"http://www.msofficeforums.com/word/18814-how-find-replace-several-items-once.html\" rel=\"nofollow noreferrer\">msofficeforums.com/word/&hellip;</a>, <a href=\"http://www.msofficeforums.com/word/40666-remove-stacking-fractions.html#post134542\" rel=\"nofollow noreferrer\">msofficeforums.com/word/&hellip;</a>, <a href=\"http://www.msofficeforums.com/word-vba/12803-find-replace.html#post34254\" rel=\"nofollow noreferrer\">msofficeforums.com/word-vba/12803-find-replace.html#post3425&zwnj;&#8203;4</a>. Each example is progressively more elaborate."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1465450221, "creation_date": 1465450221, "answer_id": 37717529, "question_id": 37713243, "link": "https://stackoverflow.com/questions/37713243/how-to-loop-through-document-and-find-words-from-predefined-array-and-replace-ea/37717529#37717529", "title": "How to loop through document and find words from predefined array and replace each word with words from another array", "body": "<p>You have not supplied any code with issues so there is nothing to fix, however you have asked 'How to find words and replace them'</p>\n\n<p>Below are the steps you will need to code to achieve this: -</p>\n\n<ol>\n<li><p>Build your array</p>\n\n<pre><code>Dim AryFNR(1,2) As String\nAryFNR(0,0) = \"john\"\nAryFNR(1,0) = \"ana\"\nAryFNR(0,1) = \"jack\"\nAryFNR(1,1) = \"tanja\"\n...\n</code></pre></li>\n<li><p>Connect to the document</p>\n\n<pre><code>Dim WdDoc As Document\nSet WdDoc = ThisDocument\n    ...\nSet WdDoc = Nothing\n</code></pre></li>\n<li><p>Connect to the selection ensuring it is in the connected document</p>\n\n<pre><code>Dim WdSlct As Selection\nWdDoc.Content.Select\nSet WdSlct = Selection\n    WdSlct.SetRange 0, 0\n    ....\nSet WdSlct = Nothing\n</code></pre></li>\n<li><p>Connect to Find and Replace and clear previous settings</p>\n\n<pre><code>Dim WdFnd As Find\nSet WdFnd = WdSlct.Find\n    WdFnd.ClearAllFuzzyOptions\n    WdFnd.ClearFormatting\n    ...\nSet WdFnd = Nothing\n</code></pre></li>\n<li><p>Process your array using WdFnd on each item</p>\n\n<pre><code>Dim LngCounter As Long\nFor LngCounter = 0 To Ubound(AryFNR,2)\n    With WdFnd\n        .Execute FindText:=AryFNR(0, LngCounter), ReplaceWith:=AryFNR(1, LngCounter)\n    End With\nNext\n</code></pre></li>\n</ol>\n\n<p>Some points you'll want to watch out for: -</p>\n\n<ul>\n<li>Footnotes and Endnotes are not processed unless the selection in the Footnote/Endnote.</li>\n<li>There are extra values on the <code>.Execute</code> command that you will want to set, depending on how you code it <code>.Found</code> may be useful.</li>\n</ul>\n\n<p>That is enough information for you to start your own code to achieve your goal, enjoy!</p>\n"}], "owner": {"reputation": 65, "user_id": 6442566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a122ba9750d5d24ccd66bebe18718a?s=128&d=identicon&r=PG&f=1", "display_name": "Enis Jasarovic", "link": "https://stackoverflow.com/users/6442566/enis-jasarovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 37717529, "answer_count": 1, "score": -1, "last_activity_date": 1541998556, "creation_date": 1465421281, "last_edit_date": 1541998556, "question_id": 37713243, "link": "https://stackoverflow.com/questions/37713243/how-to-loop-through-document-and-find-words-from-predefined-array-and-replace-ea", "title": "How to loop through document and find words from predefined array and replace each word with words from another array", "body": "<p>I want to loop word document and find words from arrayOne.</p>\n\n<p>for example</p>\n\n<pre><code>arrayOne = [\"john\", \"jack\", \"dog\"]\n</code></pre>\n\n<p>and each word that matches to replace with words from arrayTwo</p>\n\n<pre><code>arrayTwo = [\"ana\", \"tanja\", \"cat\"]\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1465421041, "post_id": 37713157, "comment_id": 62899926, "body": "You asked this <a href=\"http://stackoverflow.com/questions/37665649/extract-specific-rows-in-excel-based-on-csv\">already</a> XD Edit: lol 2 days later and still didn&#39;t try anything XD"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465421323, "post_id": 37713157, "comment_id": 62900070, "body": "@findwindow you really keep your eye out for serial askers don&#39;t you?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1465421348, "post_id": 37713157, "comment_id": 62900082, "body": "@gtwebb nope. Just good memory ~_^ Edit: the other guy earlier was because I made a poor comment to an answer that was posted so that stuck with me."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1465421520, "post_id": 37713157, "comment_id": 62900156, "body": "@findwindow is right. There is no need to post the same question over and over again. I&#39;m voting to close it. Besides, I thought that the recommendations were pretty good on the last post (including a link to a working solution)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1465421763, "post_id": 37713157, "comment_id": 62900276, "body": "@gtwebb and the other guy wasn&#39;t asking the same thing. He was literally asking each step of his project."}], "owner": {"reputation": 1, "user_id": 6432094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a25494054d58fb4390d0be58ed5c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Branigan", "link": "https://stackoverflow.com/users/6432094/liam-branigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465421001, "creation_date": 1465421001, "last_edit_date": 1531161705, "question_id": 37713157, "link": "https://stackoverflow.com/questions/37713157/highlight-and-extract-specific-rows-in-excel", "title": "Highlight and extract specific rows in excel", "body": "<p>I have a large sheet with some thousands of rows. I would like to highlight and remove specific rows. </p>\n\n<p>These row #'s are present on a separate CSV file.</p>\n\n<p>If possible, I would like to to reference this CSV file and automatically remove the row #'s that are stated.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["excel", "vba", "performance", "function"], "answers": [{"tags": [], "owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1465421146, "creation_date": 1465421146, "answer_id": 37713200, "question_id": 37712995, "link": "https://stackoverflow.com/questions/37712995/need-help-optimizing-vba-display-function/37713200#37713200", "title": "Need help optimizing vba display function", "body": "<p>use GROUP BY </p>\n\n<p>sql = \"SELECT [TestID], [Status], [PFIBox], [WireType], [StartingDia], [Customer], [numSamples], [Assigned] FROM [Tests$] GROUP BY [TestID]\"</p>\n\n<p>Also some of these drivers  -  Microsoft.ACE.OLEDB.12.0 etc have terrible perfomance in VBA.  sometimes i get better perforamance from OBDC 6.2 than ADO</p>\n"}], "owner": {"reputation": 11, "user_id": 5942496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12783e2633f53765ace45d4aa24426e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5942496/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1465421146, "creation_date": 1465420261, "question_id": 37712995, "link": "https://stackoverflow.com/questions/37712995/need-help-optimizing-vba-display-function", "title": "Need help optimizing vba display function", "body": "<p>I have been doing some database work with excel both as the database and the database driver via macros with vba. I built a function that should parse through a list of database records with testID fields. I wanted to display each test only once based on it's testID, but the way the database is set up means I have to eliminate duplicate testID's. I do this by iterating through the recordset and checking the current test against the previous one before showing in the list. The problem I'm having is that the function is excruciatingly slow. For only 12 tests in the database, it takes about 3 seconds to display them in the view spreadsheet. I'd love to hear some ideas on how to optimize the run-time. Here's the function:</p>\n\n<pre><code>Public Function showAllTests()\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim cstring, sql As String\nDim r, c As Integer\nDim testsAr As Variant\nDim inAr As Boolean\n\ncstring = \"Provider = Microsoft.ACE.OLEDB.12.0; Data Source=I:\\DBtrials.xlsx; Extended Properties=\"\"Excel 12.0 Xml; HDR=YES;ReadOnly=False\"\";\"\n\nsql = \"SELECT [TestID], [Status], [PFIBox], [WireType], [StartingDia], [Customer], [numSamples], [Assigned] FROM [Tests$]\"\n\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\nCall conn.Open(cstring)\nSet rs = conn.Execute(sql)\n\nIf rs.EOF Then\n    Range(\"C6:J1000\").ClearContents\nEnd If\n\nr = 6\ncount = 0\n'Iterates through the recordset, eliminating duplicates and populating cells in the tests sheet\nWhile Not rs.BOF And Not rs.EOF\n        Dim prevID, currID As String\n        Dim currCell As Range\n\n        inAr = False\n\n        If Not count = 0 Then\n            prevID = ActiveWorkbook.Sheets(\"Tests\").Cells(r - 1, 3).Value\n            currID = CStr(rs(0))\n            If prevID = currID Then\n                inAr = True\n            End If\n        End If\n\n        For c = 3 To (rs.Fields.count + 2)\n\n            Set currCell = ActiveWorkbook.Sheets(\"Tests\").Cells(r, c)\n\n            If Not IsNull(rs(c - 3).Value) And inAr = False Then\n                currCell.Value = CStr(rs(c - 3))\n                ElseIf IsNull(rs(c - 3).Value) Then currCell.Value = \"\"\n                    Else:\n                        Exit For\n            End If\n        Next c\n\n        If inAr = False Then\n            r = r + 1\n        End If\n        rs.MoveNext\n\n        count = count + 1\nWend\n\n\n\nconn.Close\nSet conn = Nothing\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1465419934, "post_id": 37712908, "comment_id": 62899437, "body": "Do you need code? <code>sumif</code> formula would suffice."}, {"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465420285, "post_id": 37712908, "comment_id": 62899597, "body": "@findwindow can&#39;t think how it would, i want to sum &quot;line values&quot; from process that have the same number, but each process can have 1 to n lines, it varies"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465420432, "post_id": 37712908, "comment_id": 62899658, "body": "Interesting <a href=\"https://support.office.com/en-us/article/SUMIF-function-169b8c99-c05c-4483-a712-1697a653039b\" rel=\"nofollow noreferrer\">read</a>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1465420694, "post_id": 37712908, "comment_id": 62899768, "body": "<code>=SUMIF(A:A,A4,B:B)</code> put in C4 and copy down."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465420907, "post_id": 37712908, "comment_id": 62899874, "body": "@ScottCraner WHY NO... =P"}, {"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465421026, "post_id": 37712908, "comment_id": 62899919, "body": "@ScottCraner wow that worked, no idea why, confusing... thanks anyway"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465423222, "post_id": 37712908, "comment_id": 62900933, "body": "@findwindow  Its considered impolite to play with your food!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1465423545, "post_id": 37712908, "comment_id": 62901067, "body": "@ForwardEd oh hey, you&#39;re alive^^"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465427107, "post_id": 37712908, "comment_id": 62902235, "body": "@findwindow yeah, my internet is down currently.  piggybacking off a neighbours..with permission...unfortunately it rest my consecutive day log in streak 8("}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1465427159, "post_id": 37712908, "comment_id": 62902251, "body": "@findwindow There is still time for you to throw up an sumproduct option 8)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1465483293, "post_id": 37712908, "comment_id": 62929482, "body": "@ForwardEd permission... uh huh... lol, no sumproduct if sumif will suffice."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1465483508, "post_id": 37712908, "comment_id": 62929642, "body": "@findwindow  Good practice...and no worries, Scott Craner and I are around right now to correct you...I mean educate you...lets to with assist you if needed 8)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1465483813, "post_id": 37712908, "comment_id": 62929878, "body": "@ForwardEd lol I don&#39;t know sumproduct"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465484409, "post_id": 37712908, "comment_id": 62930370, "body": "@findwindow but you know how to spell it and how to use google! 8)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1465484854, "post_id": 37712908, "comment_id": 62930732, "body": "@ForwardEd I need to use it to get it."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465485250, "post_id": 37712908, "comment_id": 62931045, "body": "@findwindow  no time like the present!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1465485294, "post_id": 37712908, "comment_id": 62931073, "body": "@ForwardEd yea too lazy XD"}], "answers": [{"tags": [], "owner": {"reputation": 840, "user_id": 1267945, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4d7013c0c2ff42965193cc2f4219e8e1?s=128&d=identicon&r=PG", "display_name": "chungtinhlakho", "link": "https://stackoverflow.com/users/1267945/chungtinhlakho"}, "is_accepted": false, "score": 0, "last_activity_date": 1465427301, "creation_date": 1465427301, "answer_id": 37714395, "question_id": 37712908, "link": "https://stackoverflow.com/questions/37712908/sum-all-values-from-column-a-that-have-the-same-value-on-column-b/37714395#37714395", "title": "Sum all values from column A that have the same value on column B", "body": "<p>you do not need vba for this.  you can do this a lot easier with build-in functions</p>\n\n<p>assuming that your sum value is on column c, paste this on to cell cs and drag it down.</p>\n\n<pre><code>=SUMIF($A$2:$A$6,A2,$B$2:$B$6)\n</code></pre>\n"}], "owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465427301, "creation_date": 1465419880, "last_edit_date": 1531161705, "question_id": 37712908, "link": "https://stackoverflow.com/questions/37712908/sum-all-values-from-column-a-that-have-the-same-value-on-column-b", "title": "Sum all values from column A that have the same value on column B", "body": "<p>I'm trying to set up a loop macro, but can't quite sketch out the logic here.</p>\n\n<p>Column \"Process\" is always in order</p>\n\n<p>Each process can have more than 1 line value, but only one line value sum</p>\n\n<p>Example of how it is :</p>\n\n<p><a href=\"https://i.stack.imgur.com/zbb2E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zbb2E.png\" alt=\"enter image description here\"></a></p>\n\n<p>And how I want it to be :</p>\n\n<p><a href=\"https://i.stack.imgur.com/RPPkp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RPPkp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example code :</p>\n\n<pre><code>'Looping whole table\nFor j = 4 To s1.ListObjects(\"Tabel1\").ListRows.Count + 3\n\n    process = s1.Cells(j, 2)\n\nNext j\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465420046, "post_id": 37712878, "comment_id": 62899501, "body": "What&#39;s the sorting for?"}, {"owner": {"reputation": 1, "user_id": 6003903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcf44f0026cc36e48f1792787690b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Kaco208", "link": "https://stackoverflow.com/users/6003903/kaco208"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465421189, "post_id": 37712878, "comment_id": 62900004, "body": "its sorting column <b>a</b> of sheet &quot;b&quot; which are numbers after they have been inserted in sheet &quot;b&quot;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465421326, "post_id": 37712878, "comment_id": 62900071, "body": "Oh ok. You didn&#39;t mention that above so got confused. What&#39;s the problem with your code?"}, {"owner": {"reputation": 1, "user_id": 6003903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcf44f0026cc36e48f1792787690b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Kaco208", "link": "https://stackoverflow.com/users/6003903/kaco208"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465421770, "post_id": 37712878, "comment_id": 62900282, "body": "its deleting row 3 column 3 info in sheet a, where as I want it to delete the SELECTED row that I have chosen and cut entire row, from sheet a and insert column a-e and deleting column f &amp; g into sheet b"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465421926, "post_id": 37712878, "comment_id": 62900354, "body": "Well, you did <code>Rows(&quot;3:3&quot;).Select | Selection.Delete Shift:=xlUp</code> so not sure what you expect XD Not sure what you mean by <code>chosen</code> row. You want to start by creating objects for your sheets and ranges. Look up <code>set</code>."}, {"owner": {"reputation": 1, "user_id": 6003903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcf44f0026cc36e48f1792787690b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Kaco208", "link": "https://stackoverflow.com/users/6003903/kaco208"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465422276, "post_id": 37712878, "comment_id": 62900508, "body": "yes I know that I specifically chose row 3, I am new to excel macros and VB and I wanted to see if what I was trying to accomplish worked somewhat...I didn&#39;t know how to code it so that it deletes the selected row that I have highlighted and tested it with deleting row 3-(Rows(&quot;3:3&quot;).Select     Selection.Delete Shift:=xlUp) ..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465422482, "post_id": 37712878, "comment_id": 62900595, "body": "Ok. Well, you&#39;re going to have to study your code to understand what you need to do. Step through it line by line via F8. Edit: I will be here for about another hour so feel free to ask questions if you get stuck on a particular line."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1465433975, "creation_date": 1465433975, "answer_id": 37715297, "question_id": 37712878, "link": "https://stackoverflow.com/questions/37712878/vb-excel-macro-code-to-remove-colum-data-in-sheet-and-insert-to-other-sheet-and/37715297#37715297", "title": "VB excel macro code to remove colum data in sheet and insert to other sheet and list empty column", "body": "<p>From what I gather you have 2 worksheets</p>\n\n<ul>\n<li>Instock</li>\n<li>Checked Out</li>\n</ul>\n\n<p>When you press update you want to:</p>\n\n<ul>\n<li>Add the first 5 column values of the selected row from [Checked Out] to [Instock]</li>\n<li>Clear the values in column 6 and 7 of the selected row from [Checked Out]</li>\n<li>Sort [Instock]</li>\n</ul>\n\n<p>Try this:</p>\n\n<pre><code>Public Sub MoveStockItems()\n    If Not (ActiveSheet.Name = \"Checked Out\") Then Exit Sub\n    Dim newRow As Long, rw As Long\n\n    rw = ActiveCell.Row\n    With Sheets(\"Instock\")\n        newRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(newRow, 1) = Cells(rw, 1)\n        .Cells(newRow, 2) = Cells(rw, 2)\n        .Cells(newRow, 3) = Cells(rw, 3)\n        .Cells(newRow, 4) = Cells(rw, 4)\n        .Cells(newRow, 5) = Cells(rw, 5)\n        Cells(rw, 6) = \"\"\n        Cells(rw, 7) = \"\"\n    End With\n    Call SortInstock\nEnd Sub\n\nPublic Sub SortInstock()\n    Dim rowCount As Long\n    With Worksheets(\"Instock\")\n         rowCount = .UsedRange.Rows.Count\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:=.Range(\"B2:B\" &amp; rowCount), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Sort.SortFields.Add Key:=.Range(\"A2:A\" &amp; rowCount), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n\n    With Worksheets(\"Instock\").Sort\n        .SetRange Worksheets(\"Instock\").UsedRange\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>Paste this code into a code module then assign a shortcut key to MoveStockItems. </p>\n\n<p><b>Usage:</b>Select a cell on [Checked Out] press the shortcut k to run the macro.<br/></p>\n"}], "owner": {"reputation": 1, "user_id": 6003903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcf44f0026cc36e48f1792787690b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Kaco208", "link": "https://stackoverflow.com/users/6003903/kaco208"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465433975, "creation_date": 1465419787, "last_edit_date": 1465421265, "question_id": 37712878, "link": "https://stackoverflow.com/questions/37712878/vb-excel-macro-code-to-remove-colum-data-in-sheet-and-insert-to-other-sheet-and", "title": "VB excel macro code to remove colum data in sheet and insert to other sheet and list empty column", "body": "<p>I am having issues with my code. I have an excel sheet <strong>a</strong> that has 7 columns. I want to copy and add first 5 columns of the selected/highlighted row and add them to sheet <strong>b</strong>'s very first empty row and deleting the remaining 2 columns all while pressing update button: </p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    Range(\"F:G\").Select\n    Range(\"A:E\").Select\n    Selection.Cut\n    Sheets(\"Instock\").Select\n    Range(\"A280\").Select\n    ActiveSheet.Paste\n    Cells.Select\n    Range(\"A256\").Activate\n    ActiveWorkbook.Worksheets(\"Instock\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Instock\").Sort.SortFields.Add Key:=Range( _\n        \"B2:B4096\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    ActiveWorkbook.Worksheets(\"Instock\").Sort.SortFields.Add Key:=Range( _\n        \"A2:A4096\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Instock\").Sort\n        .SetRange Range(\"A1:G4096\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Sheets(\"Checked Out\").Select\n    Rows(\"3:3\").Select\n    Selection.Delete Shift:=xlUp\n    Range(\"H17\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 1, "creation_date": 1465419494, "post_id": 37712740, "comment_id": 62899245, "body": "I&#39;m voting to close this question as off-topic because SO can help you with code you&#39;ve written but SO is not here to write code for you."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1465423012, "post_id": 37712740, "comment_id": 62900826, "body": "Google how to fill a combo box in access vba with a loop"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1465450897, "creation_date": 1465450897, "answer_id": 37717704, "question_id": 37712740, "link": "https://stackoverflow.com/questions/37712740/how-to-make-to-combo-box-display-numbers-from-0-to-a-number-in-a-table/37717704#37717704", "title": "How to make to combo box display numbers from 0 to a number in a table", "body": "<p>When you add the combobox to the form make sure you select I will type in the values that I want radiobutton.</p>\n\n<ul>\n<li>From the Devolper Tab change the view to Design View</li>\n<li>Right click the blank space below the form and click Properties</li>\n<li>The Properties Sheet should have Form selected in the Selection Type Combo near the top</li>\n<li>Click the Event Tab</li>\n<li>Select the On Load event and click the ellipse [...] button</li>\n<li>Choose Code Builder</li>\n</ul>\n\n<p>You can use DLookup, DMax, Or DMin to retrieve the your values from the a query or table.</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim i As Long\n    Dim maxNumber As Long\n    maxNumber = DLookup(\"[StockLevel]\", \"InventoryTable\", \"[SKU] = 'HSC0424PP'\")\n    For i = 0 To maxNumber\n        Combo4.AddItem i\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6205586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a03d9c22197f644ffd799fd0f3fb9f?s=128&d=identicon&r=PG", "display_name": "King of Dragon", "link": "https://stackoverflow.com/users/6205586/king-of-dragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594641967, "creation_date": 1465419293, "last_edit_date": 1594641967, "question_id": 37712740, "link": "https://stackoverflow.com/questions/37712740/how-to-make-to-combo-box-display-numbers-from-0-to-a-number-in-a-table", "title": "How to make to combo box display numbers from 0 to a number in a table", "body": "<p>I have this empty combo box which I would like to fill with numbers from 0 to x. x is a value in a table. </p>\n\n<p>I know almost nothing about VBA so any help will be appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1465421916, "post_id": 37712702, "comment_id": 62900350, "body": "One method is to use a form that is not bound to the table and to manually input the entry into the table when desired.  You&#39;d use a &quot;CurrentDb.Execute&quot; statement to run the SQL required to insert the record after checking for all the conditions you need met before inserting the record."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1465421990, "post_id": 37712702, "comment_id": 62900380, "body": "Another method is to use a &quot;CurrentDb.Execute&quot; statement to DELETE the record if it has problems.  Put this portion in the &quot;If&quot; part of your &quot;If&quot; statement."}], "owner": {"reputation": 1, "user_id": 2308075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b227a00a3df491404085b0e024f7366?s=128&d=identicon&r=PG", "display_name": "user2308075", "link": "https://stackoverflow.com/users/2308075/user2308075"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 956, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593955529, "creation_date": 1465419154, "last_edit_date": 1593955529, "question_id": 37712702, "link": "https://stackoverflow.com/questions/37712702/ms-access-how-to-close-a-form-without-saving-any-changes", "title": "MS Access - How to close a form without saving any changes?", "body": "<p>So I'm relatively new to access and havent worked much in VBA. Im currently designing a project database for users at our office to submit ideas to.</p>\n\n<p>I have a submission form and a few of the fields are required. In the code, I have it looking like this:</p>\n\n<pre><code>If IsNull(SchoolName) Then\n  DoCmd.OpenForm \"MissingInfoForm\"\n\nElse\n  AssignmentStatus = \"Unassigned\"\n  LastEditedBy = apicGetUserName()\n  DoCmd.Save\n  MsgBox \"Submission Accepted\"\n  DoCmd.GoToRecord , , acNewRec\n</code></pre>\n\n<p>(I literally just threw this together. I normally just use macros when doing things, but I feel this issue will require use of VBA.)</p>\n\n<p>The problem I'm facing is that when the user has failed to put anything into the field SchoolName, it will show the MissingInfoForm and revert back to the submission form but Access still saves and creates a new record with all blank fields (or partially completed, I need it to not save at all if the field SchoolName is blank). This is an issue because there is a hub form that lists all the entries and I cannot have a bunch of blank submissions there.</p>\n\n<p>I tried making sure that the form's Close function doesnt save it but it continues to do so.</p>\n\n<p>Ive looked quite a bit online for some help and I've found examples in the form of \"A Better Mouse Trap\" and the Me.Undo command, however I am unable to correctly implement these in the way I'd like.</p>\n\n<p>Can someone lend me some assistance? Im a fairly big noob to this stuff and could use some guidance.. this project database is expected to be done by this Friday (2 days from now).</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465420683, "post_id": 37712628, "comment_id": 62899764, "body": "What happens if you try and print out diaLst.ListIndex? Or diaLst.List(diaLst.ListIndex)?"}, {"owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465469746, "post_id": 37712628, "comment_id": 62919216, "body": "does not work also."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465469885, "post_id": 37712628, "comment_id": 62919306, "body": "Try along with dim dialist as object, instead of list box."}, {"owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465470225, "post_id": 37712628, "comment_id": 62919540, "body": "This does not work too :("}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "edited": false, "score": 0, "creation_date": 1465457224, "post_id": 37718676, "comment_id": 62911285, "body": "yes the function is not returning anything. It is not finished yet.   Actually, I do not know what you mean by &quot;dealing with a From control, not an ActiveX&quot;. But, I am able to get the listbox by the .ListBoxes property of the Worksheet. Nevertheless I am not able to use the Selected property in any way. In contrast I can use the addItem property without any problems."}, {"owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "edited": false, "score": 0, "creation_date": 1465469642, "post_id": 37718676, "comment_id": 62919142, "body": "Unfortunatly no. Before I programmed the sub/function above, I did a Userform with almost the same code. Just wrote instead of diaLst Me.Listbox. That worked fine. I really do not know why this does not work. It seems that diaLst does not have the full property list of a listbox. But why this happens I don&#39;t know."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1465470469, "last_edit_date": 1465470469, "creation_date": 1465454857, "answer_id": 37718676, "question_id": 37712628, "link": "https://stackoverflow.com/questions/37712628/listbox-selected-property-causes-problems/37718676#37718676", "title": "Listbox Selected property causes problems", "body": "<p>first off, you must be dealing with a \"Form\" control (not an \"ActiveX\" one) otherwise you couldn't get it via <code>.ListBoxes</code> property of <code>Worksheet</code> class</p>\n\n<p>I tested it in my environment (W7-Pro and Excel 2013) and found that (quite strangely to me) the <code>Selected()</code> property array is 1-based.</p>\n\n<p>This remained even with <code>Option Base 0</code> at the beginning of the module </p>\n\n<p>Make sure Microsoft Forms 2.0 Object Library reference is added to your project</p>\n\n<pre><code>Function DrawDiagram()\n    Dim x As Long\n    Dim diaLst As MSForms.ListBox\n\n    Set diaLst = ActiveSheet.ListBoxes(\"DiaList\")\n\n    ' find selected trends in List Box\n    For x = 1 To diaLst.ListCount\n        If diaLst.Selected(x) = True Then\n            MsgBox x\n        End If\n    Next x\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "is_accepted": false, "score": 0, "last_activity_date": 1465470022, "creation_date": 1465470022, "answer_id": 37724085, "question_id": 37712628, "link": "https://stackoverflow.com/questions/37712628/listbox-selected-property-causes-problems/37724085#37724085", "title": "Listbox Selected property causes problems", "body": "<p>By the way, this is the code I used to generate the list box in a chart sheet, in a separate function. At the moment when a button is clicked, the DrawDiagram function is called. The aim of the \"DrawDiagram\" function is to plot the selected items of the listbox in the diagram.</p>\n\n<pre><code>Set diaLst = ActiveSheet.ListBoxes.Add(ActiveChart.ChartArea.Width - 110, 5, 105, 150)\nWith diaLst\n    .Name = \"DiaList\"\n    .PrintObject = False\n    .MultiSelect = xlSimple\n\n    i = 2\n    While wTD.Cells(rowVarNames, i) &lt;&gt; \"\"\n        .AddItem wTD.Cells(rowVarNames, i)\n        i = i + 1\n    Wend\n    .Selected(3) = True\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 1683040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb6c21cb3816cc16dac2735c87c9eb2?s=128&d=identicon&r=PG", "display_name": "LeonardoX", "link": "https://stackoverflow.com/users/1683040/leonardox"}, "is_accepted": false, "score": 0, "last_activity_date": 1520693427, "creation_date": 1520693427, "answer_id": 49210383, "question_id": 37712628, "link": "https://stackoverflow.com/questions/37712628/listbox-selected-property-causes-problems/49210383#49210383", "title": "Listbox Selected property causes problems", "body": "<p>use Sheets(\"Sheet1\").Shapes(\"List Box 1\").OLEFormat.Object instead</p>\n"}], "owner": {"reputation": 1, "user_id": 6442412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e00c5c06e6ccc43ade937c238cf327?s=128&d=identicon&r=PG&f=1", "display_name": "natasia", "link": "https://stackoverflow.com/users/6442412/natasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1071, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1520693427, "creation_date": 1465418865, "question_id": 37712628, "link": "https://stackoverflow.com/questions/37712628/listbox-selected-property-causes-problems", "title": "Listbox Selected property causes problems", "body": "<p>I have a listbox in a Diagram, when calling the function \"drawDiagram\" I want to get the selected Items of the listbox. Here is my code to do that:</p>\n\n<pre><code>Function DrawDiagram()\nDim x As Integer\nDim diaLst As ListBox\nSet diaLst = ActiveSheet.ListBoxes(\"DiaList\")\n\n' find selected trends in List Box\nFor x = 0 To diaLst.ListCount - 1\n    If diaLst.Selected(x) = True Then\n        MsgBox x\n    End If\nNext x\nEnd Function\n</code></pre>\n\n<p>diaLst.ListCount correctly returns the number of Items in the list. But diaLst.Selected(x) does not work at all.</p>\n\n<p>The Error message is:\nGerman: \"Die Selected-Eigenschaft des ListBox-Objektes kann nicht zugeordent werden\"\nEnglish: \"The Selected Property of the ListBox Object cannot be assigned\" (or similar) </p>\n\n<p>Does anyone know, what I did wrong?</p>\n\n<p>thanks\nnatasia</p>\n"}, {"tags": ["vba", "ms-access", "listbox", "multi-select"], "answers": [{"comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465419538, "post_id": 37712700, "comment_id": 62899260, "body": "Can you Debug.Print strCriteria before you use it - and post it as an edit in your post above (do same with strSQL)"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420467, "post_id": 37712700, "comment_id": 62899673, "body": "I made the edits you suggested and updated them in the code above. I added the debug.print you requested as well."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420613, "post_id": 37712700, "comment_id": 62899732, "body": "Start with - Change <code>&amp; &quot;OR &quot;</code> to <code>&amp; &quot; OR &quot;</code>"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420926, "post_id": 37712700, "comment_id": 62899883, "body": "This is a problem  <code>[Appointment Query].[Appointment State])=States.States</code> - what are you trying to compare - where did the States.States table/field come from? Is that what you want to use in your criteria - or are you using the [Appointment State] field?"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465421178, "post_id": 37712700, "comment_id": 62899997, "body": "I was just following the example in the second code I posted, which is the one I found and edited. The States.States is the table and field name that houses the states that [Appointment State] references. I need the value(s) selected in that listbox to equal a value in [Appointment Query].[Appointment State]."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465421526, "post_id": 37712700, "comment_id": 62900158, "body": "Is <code>[Appointment Query].</code> a table or a query that is joined to a <code>States</code> table? Does ` [Appointment State]` have abbreviated state names in it?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465421671, "post_id": 37712700, "comment_id": 62900234, "body": "Also important to know - are [SSN] and [Carrier] text fields or numeric? If the&#39;re text, you&#39;re going to have to wrap the Form fields in double quotes as well"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465480710, "post_id": 37712700, "comment_id": 62927556, "body": "[Appointment Query] is a query, there is a field in the query titled [Appointment State] (I realize I need to get away from using the same name in multiple objects) that uses the [States] table as a source, which are abbreviated state names.        [SSN] is numeric, [Carrier] is text. Everything seems to be working fine except that I need the states selected in the [Appointment State] listbox on the form to pull over to the [Appointment Query Update] as &quot;AR&quot; OR &quot;CA&quot;, etc."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1465419689, "last_edit_date": 1465419689, "creation_date": 1465419147, "answer_id": 37712700, "question_id": 37712326, "link": "https://stackoverflow.com/questions/37712326/access-update-query-from-form-values-with-multiselect-listbox-vba/37712700#37712700", "title": "Access - Update Query from Form Values with Multiselect Listbox VBA", "body": "<p>To start with you need spaces between your concatenated strings in SQL - I just added a space before SET and WHERE. Do you get an error message?</p>\n\n<p>Can you Debug.print strSQL?</p>\n\n<pre><code>strSQL = \"UPDATE [Appointment Query]\" _\n&amp; \" SET [Appointment Query].[Appointment Status] = [Forms].[Appointment Update].[Appointment Status], [Appointment Query].[Appt Request Date] = [Forms]![Appointment Update].[Appt Request Date]\" _\n&amp; \" WHERE ((([Appointment Query].SSN)=[Forms]![Appointment Update].[SSN]) AND (([Appointment Query].[Appointment State])=strCriteria) AND (([Appointment Query].Carrier)=[Forms]![Appointment Update].[Carrier]));\"\n</code></pre>\n\n<p>Also it looks like you don't close the qdf before you update the SQL.</p>\n\n<pre><code>qdf.SQL = strSQL\nqdf.Close\nDoCmd.OpenQuery \"Appointment Update Query\"\n</code></pre>\n\n<p>This is also going to break the query with how you've built strCriteria</p>\n\n<pre><code>(([Appointment Query].[Appointment State])=strCriteria) \n</code></pre>\n\n<p>And if any of your individual fields are text fields you're going to need to wrap them in escaped double quotes</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420591, "post_id": 37712799, "comment_id": 62899721, "body": "I changed the code based on your and dbmitch&#39;s advice. When I run the code now it asks me to input the parameters for States.States. I do not get any actual errors other than that."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420744, "post_id": 37712799, "comment_id": 62899794, "body": "Can you do a debug.print of the sql statement? Perhaps seeing the query to be executed will help clarify things."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465420858, "post_id": 37712799, "comment_id": 62899848, "body": "I&#39;ve added it to the bottom of the question."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1465419489, "creation_date": 1465419489, "answer_id": 37712799, "question_id": 37712326, "link": "https://stackoverflow.com/questions/37712326/access-update-query-from-form-values-with-multiselect-listbox-vba/37712799#37712799", "title": "Access - Update Query from Form Values with Multiselect Listbox VBA", "body": "<p>I think it has something with not using the variable <strong>strCriteria</strong>, you are using the literal text.</p>\n\n<p>What you have now:</p>\n\n<pre><code>\"WHERE ((([Appointment Query].SSN)=[Forms]![Appointment Update].[SSN]) AND (([Appointment Query].[Appointment State])=strCriteria) AND (([Appointment Query].Carrier)=[Forms]![Appointment Update].[Carrier]));\"\n</code></pre>\n\n<p>To use the variables contents you need to <strong>escape</strong> it as part of your query, like this:</p>\n\n<pre><code>\"WHERE ((([Appointment Query].SSN)=[Forms]![Appointment Update].[SSN]) AND (([Appointment Query].[Appointment State])=\" &amp; strCriteria &amp; \") AND (([Appointment Query].Carrier)=[Forms]![Appointment Update].[Carrier]));\"\n</code></pre>\n\n<p>Also, as dbmitch noticed you may need a space before your <strong>WHERE</strong> as well.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465484037, "post_id": 37729086, "comment_id": 62930055, "body": "I tried to insert your code, but it did not work. I played around with it and got it to output strCriteria as: &quot;AL&quot; Or &quot;AZ&quot; with:         <code>If Me![Appointment State].ItemsSelected.Count &gt; 0 Then         For Each varItem In Me![Appointment State].ItemsSelected            strCriteria = strCriteria &amp; Chr(34) _                          &amp; Me![Appointment State].ItemData(varItem) &amp; Chr(34) &amp; &quot; OR &quot;         Next varItem         strCriteria = Left(strCriteria, Len(strCriteria) - 3)      Else         strCriteria = &quot;= &quot;&quot;&quot; &amp; Me![Appointment State] &amp; &quot;&quot;&quot;&quot;      End If</code>"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465484551, "post_id": 37729086, "comment_id": 62930493, "body": "I apologize for the jumbled mess, trying to figure out how to properly format comments...       With the edits so far, the code does run and passes the fields to the query criteria. There is an issue though as it is not updating the correct number of rows. If one state value is selected, it appears to pull the correct record(s). If two are used, it is pulling more records than it should be.  I&#39;m assuming it has something to do with the text fields not having quote marks? I&#39;m not sure how to integrate them with a bracketed field... I tried a few different ways but it threw an error each time."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465485556, "post_id": 37729086, "comment_id": 62931276, "body": "Update your code and the resulting Debugs above whenever you make changes so we can see what&#39;s happening. I&#39;ll update the strSQL statement with double quotes in my last answer"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465487368, "post_id": 37729086, "comment_id": 62932610, "body": "Here is what I get now, strCriteria and strSQL respectively:      <code>&quot;AL&quot; Or &quot;AZ&quot;      UPDATE [Appointment Query]     SET [Appointment Query].[Appointment Status] =&quot;Pending&quot;, [Appointment Query].[Appt Request Date] =[Forms]![Appointment Update].[Appt Request Date]     WHERE ((([Appointment Query].SSN)=&quot;999999999&quot;) AND (([Appointment Query].[Appointment State])=&quot;AL&quot; Or &quot;AZ&quot; ) AND (([Appointment Query].Carrier)=&quot;ASI&quot;));</code>   When run with a single state, it correctly pulls 1 record to update. When two states are selected, it pulls 31 records, there is only 2."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465487466, "post_id": 37729086, "comment_id": 62932682, "body": "If you&#39;re still getting &quot;OR&quot; in your strCriteria then you&#39;re not using my new code that uses &quot;IN&quot; clause - also I updated the strSQL clause to remove &quot;=&quot; after Appointment.State"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465487484, "post_id": 37729086, "comment_id": 62932698, "body": "After I run the query with one state value with the form and VBA, I can manually change the state values directly on the query in design mode to &quot;AL&quot; Or &quot;AZ&quot; and it pulls the correct two records."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465488239, "post_id": 37729086, "comment_id": 62933224, "body": "I replaced that my If statement with yours and removed the = sign you removed in the strSQL clause and it worked perfectly! I don&#39;t really understand why the Or statement didn&#39;t work, but that&#39;s beside the point. Thanks for your help!"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465488400, "post_id": 37729086, "comment_id": 62933345, "body": "Excellent. You can use an OR statement but it would have to repeat the whole <code>[Appointment Query].[Appointment State])=&quot;&lt;state&gt;&quot;</code> statement for every State, and then separate them each with &quot;OR&quot;s. Would make for a very long string"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1465488508, "post_id": 37729086, "comment_id": 62933403, "body": "That makes sense. Thanks!"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1465488093, "last_edit_date": 1465488093, "creation_date": 1465483295, "answer_id": 37729086, "question_id": 37712326, "link": "https://stackoverflow.com/questions/37712326/access-update-query-from-form-values-with-multiselect-listbox-vba/37729086#37729086", "title": "Access - Update Query from Form Values with Multiselect Listbox VBA", "body": "<p>You should show us the SQL from your query - I can see no reason why you're trying to use States.State, so I'm suggesting this change but it's really hard to help much more than this right now</p>\n\n<pre><code>If Me![Appointment State].ItemsSelected.Count &gt; 0 Then\n  strCriteria = \"IN (\"\n  For Each varItem In Me![Appointment State].ItemsSelected\n     strCriteria = strCriteria &amp; Chr(34) _\n                   &amp; Me![Appointment State].ItemData(varItem) &amp; Chr(34) &amp;  \",\"\n  Next varItem\n  strCriteria = Left$(strCriteria, Len(strCriteria)-1) &amp; \")\" ' Remove last comma\nElse\n  strCriteria = \"= \"\"\" &amp; Me![Appointment State] &amp; \"\"\"\"\nEnd If\n</code></pre>\n\n<blockquote>\n  <p>EDIT: Updated SQL Statement with double quotes</p>\n</blockquote>\n\n<pre><code>strSQL = \"UPDATE [Appointment Query]\" _\n&amp; \" SET [Appointment Query].[Appointment Status] = [Forms].[Appointment Update].[Appointment Status], [Appointment Query].[Appt Request Date] = [Forms]![Appointment Update].[Appt Request Date]\" _\n&amp; \" WHERE ((([Appointment Query].SSN)=\"\"\" &amp; [Forms]![Appointment Update].[SSN] &amp; \"\"\") AND (([Appointment Query].[Appointment State]) \" &amp; strCriteria &amp; _\n\") AND (([Appointment Query].Carrier)=\"\"\" &amp; [Forms]![Appointment Update].[Carrier] &amp; \"\"\"));\"\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1750, "favorite_count": 0, "accepted_answer_id": 37729086, "answer_count": 3, "score": 0, "last_activity_date": 1593958463, "creation_date": 1465417803, "last_edit_date": 1593958463, "question_id": 37712326, "link": "https://stackoverflow.com/questions/37712326/access-update-query-from-form-values-with-multiselect-listbox-vba", "title": "Access - Update Query from Form Values with Multiselect Listbox VBA", "body": "<p>I have an issue that I feel I'm close to solving, but am missing something. I have an unbound form with five objects.</p>\n\n<p>'SSN' is a standard text box.\n'Appointment State' is a listbox with multiselect enabled. The source is a table named States.\n'Carrier' is a combobox.\n'Appointment Status' is a combobox.\n'Appt Request Date' is a date field.</p>\n\n<p>Once values are in all five objects, I have a button that runs the code below. I want to pass the values to an update query to be used as criteria. </p>\n\n<p>The fields that are being updated are 'Appointment Status' and 'Appt Request Date'. The other fields are to select the correct record(s).</p>\n\n<p>Currently the code runs, and the update query receives most of the criteria. The only field that does not populate correctly is the 'Appointment State', which I thought would pull from strCriteria. </p>\n\n<p>When the code runs, it asks the user to populate the strCriteria value when it needs to pull from the 'Appointment States' listbox.</p>\n\n<p>I found the code from a site that told how to grab the values from a multiselect listbox and then creates the SQL for a one criteria Select query. I've tried to adapt it as best as I can. The main difference is the SQL build. When I use the original, it works.</p>\n\n<p>My modified code to operate the update query:</p>\n\n<pre><code>Private Sub Command35_Click()\n\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim varItem As Variant\nDim strCriteria As String\nDim strSQL As String\nSet db = CurrentDb()\nSet qdf = db.QueryDefs(\"Appointment Update Query\")\n\nIf Me![Appointment State].ItemsSelected.Count &gt; 0 Then\n  For Each varItem In Me![Appointment State].ItemsSelected\n     strCriteria = strCriteria &amp; \"States.States = \" &amp; Chr(34) _\n                   &amp; Me![Appointment State].ItemData(varItem) &amp; Chr(34) &amp;  \" OR \"\n  Next varItem\n  strCriteria = Left(strCriteria, Len(strCriteria) - 3)\nElse\n  strCriteria = \"States.States Like '*'\"\nEnd If\nstrSQL = \"UPDATE [Appointment Query]\" _\n&amp; \" SET [Appointment Query].[Appointment Status] = [Forms].[Appointment Update].[Appointment Status], [Appointment Query].[Appt Request Date] = [Forms]![Appointment Update].[Appt Request Date]\" _\n&amp; \" WHERE ((([Appointment Query].SSN)=[Forms]![Appointment Update].[SSN]) AND (([Appointment Query].[Appointment State])=\" &amp; strCriteria &amp; \") AND (([Appointment Query].Carrier)=[Forms]![Appointment Update].[Carrier]));\"\n\nqdf.SQL = strSQL\nqdf.Close  \n\nDoCmd.OpenQuery \"Appointment Update Query\"\n\nSet db = Nothing\nSet qdf = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The original code:</p>\n\n<pre><code>    Private Sub cmdOK_Click()\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim varItem As Variant\nDim strCriteria As String\nDim strSQL As String\nSet db = CurrentDb()\nSet qdf = db.QueryDefs(\"qryMultiSelect\")\nIf Me!lstRegions.ItemsSelected.Count &gt; 0 Then\n  For Each varItem In Me!lstRegions.ItemsSelected\n     strCriteria = strCriteria &amp; \"tblData.Region = \" &amp; Chr(34) _\n                   &amp; Me!lstRegions.ItemData(varItem) &amp; Chr(34) &amp; \"OR \"\n  Next varItem\n  strCriteria = Left(strCriteria, Len(strCriteria) - 3)\nElse\n  strCriteria = \"tblData.Region Like '*'\"\nEnd If\nstrSQL = \"SELECT * FROM tblData \" &amp; _\n        \"WHERE \" &amp; strCriteria &amp; \";\"\nqdf.SQL = strSQL\nDoCmd.OpenQuery \"qryMultiSelect\"\nSet db = Nothing\nSet qdf = Nothing\nEnd Sub\n</code></pre>\n\n<p>Any ideas on how I could get this to work properly?</p>\n\n<p>Debug.Print strSQL:</p>\n\n<pre><code>    UPDATE [Appointment Query] SET [Appointment Query].[Appointment Status] = [Forms].[Appointment Update].[Appointment Status], [Appointment Query].[Appt Request Date] = [Forms]![Appointment Update].[Appt Request Date] WHERE ((([Appointment Query].SSN)=[Forms]![Appointment Update].[SSN]) AND (([Appointment Query].[Appointment State])=States.States = \"AL\" OR States.States = \"AZ\") AND (([Appointment Query].Carrier)=[Forms]![Appointment Update].[Carrier]));\n</code></pre>\n\n<p>Debug.Print strCriteria:</p>\n\n<pre><code>    States.States = \"AL\" OR States.States = \"AZ\"\n</code></pre>\n\n<p>States is the name of the table the state abbreviations are in, and the second States is the field name.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "edited": false, "score": 0, "creation_date": 1465417606, "post_id": 37712150, "comment_id": 62898285, "body": "why wouldn&#39;t you copy the category down all the rows?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "edited": false, "score": 0, "creation_date": 1465478388, "post_id": 37712783, "comment_id": 62925644, "body": "This works but it&#39;s not updating the category name, so it prints out: A goes from 2 to 4.....A goes from 5 to 7...A goes from 8 to 10, etc"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "edited": false, "score": 0, "creation_date": 1465478645, "post_id": 37712783, "comment_id": 62925862, "body": "Hmm, and in the data you are working with it doesn&#39;t go <code>A</code>, <code>[blank]</code>, <code>[blank]</code>, <code>A</code> does it?"}, {"owner": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "edited": false, "score": 0, "creation_date": 1465478931, "post_id": 37712783, "comment_id": 62926106, "body": "No, the data will always have a value"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "edited": false, "score": 0, "creation_date": 1465479488, "post_id": 37712783, "comment_id": 62926550, "body": "Sorry I mean column A, Category, in your sample data your testing with its not <code>A</code>, <code>[blank]</code>, <code>[blank]</code>, <code>A</code> is it? I&#39;ve added pictures to my answer to show you what I see. You change <code>Debug.print</code> to <code>MsgBox</code> just in case its something odd in the immediate window."}, {"owner": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "edited": false, "score": 0, "creation_date": 1465480934, "post_id": 37712783, "comment_id": 62927728, "body": "Turns out I&#39;m just dense (typo in my code). Thank you so much for your help."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1465479346, "last_edit_date": 1465479346, "creation_date": 1465419426, "answer_id": 37712783, "question_id": 37712150, "link": "https://stackoverflow.com/questions/37712150/excel-vba-logic-get-range-between-two-cells-using-loops/37712783#37712783", "title": "Excel VBA logic: get range between two cells using loops", "body": "<p>The below code get you the row numbers of each category and assumes there is no break in content on column B, your question was to get the content of columns C:D by category, having these row values will enable you to code to get the content of C:D.</p>\n\n<pre><code>Public Sub Sample()\nDim WkSht       As Worksheet\nDim StrCategory As String\nDim LngRow      As Long\nDim LngRowStart As Long\n\nSet WkSht = ThisWorkbook.Worksheets(\"RawData\")\n    'Take note of the category we are one\n    StrCategory = WkSht.Range(\"A\" &amp; 2).Value\n\n    'Take not of the row the category started on\n    LngRowStart = 2\n\n    'Look to the next row\n    LngRow = 3\n\n    'Loop through the data until column B has no value, signifying the end of the dataset\n    Do Until WkSht.Range(\"B\" &amp; LngRow) = \"\"\n\n        'Go to the next row until we are given a new category or make it to the end of the dataset\n        Do Until (WkSht.Range(\"A\" &amp; LngRow) &lt;&gt; \"\") Or (WkSht.Range(\"B\" &amp; LngRow) = \"\")\n            LngRow = LngRow + 1\n        Loop\n\n        'Talk in the immediate pane\n        Debug.Print StrCategory &amp; \" is on rows \" &amp; LngRowStart &amp; \" to \" &amp; LngRow - 1\n\n        'Get the next values\n        StrCategory = WkSht.Range(\"A\" &amp; LngRow)\n        LngRowStart = LngRow\n\n        'Move on\n        LngRow = LngRow + 1\n    Loop\nSet WkSht = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Below is the input data I gave it: -</p>\n\n<p><a href=\"https://i.stack.imgur.com/9K7Re.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9K7Re.png\" alt=\"Input\"></a></p>\n\n<p>Below is the output from the code: -</p>\n\n<p><a href=\"https://i.stack.imgur.com/QzFom.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QzFom.png\" alt=\"Output\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1543, "user_id": 2142248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/F2o9H.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2142248/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1465420813, "creation_date": 1465420813, "answer_id": 37713113, "question_id": 37712150, "link": "https://stackoverflow.com/questions/37712150/excel-vba-logic-get-range-between-two-cells-using-loops/37713113#37713113", "title": "Excel VBA logic: get range between two cells using loops", "body": "<p>You could use some <code>If</code> statements and pull this all into an array, but it seems more direct to just fill in the blanks</p>\n\n<pre><code>Sub FillColA()\n\n    Dim LastRow As Long\n\n    LastRow = Application.WorksheetFunction.CountA(Range(\"B:B\"))\n    Range(\"A2:A\" &amp; LastRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=R[-1]C\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6442303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2bbee8fab6d82341d29d78689f1562?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/6442303/nick-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 37712783, "answer_count": 2, "score": 0, "last_activity_date": 1465479346, "creation_date": 1465417178, "last_edit_date": 1465418866, "question_id": 37712150, "link": "https://stackoverflow.com/questions/37712150/excel-vba-logic-get-range-between-two-cells-using-loops", "title": "Excel VBA logic: get range between two cells using loops", "body": "<p>Forgive me, as this may be very simple. I am trying to create a VBA macro that quickly gets statistics from raw data and puts them in a table. The raw data comes in this format: </p>\n\n<p><a href=\"https://i.stack.imgur.com/i7MXT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i7MXT.png\" alt=\"enter image description here\"></a></p>\n\n<p>(They will not always be in groups of three)</p>\n\n<p>How would I get the range for all of a category, and then use that same range for Columns B and C to get the statistics I need?</p>\n"}, {"tags": ["ms-access", "vba", "onunload"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1465483438, "post_id": 37712052, "comment_id": 62929590, "body": "Since Access saves a record as soon as you go to another one, I would use the <code>BeforeUpdate</code> event rather than an <code>Unload</code> event."}, {"owner": {"reputation": 71, "user_id": 5559715, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96febe87400e4b6c4e74aefc4264bef5?s=128&d=identicon&r=PG&f=1", "display_name": "Cloude", "link": "https://stackoverflow.com/users/5559715/cloude"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1465490671, "post_id": 37712052, "comment_id": 62934678, "body": "I have a button on my form that saves the record manually via a stored procedure with values from unbound text boxes. The unload event catches the fact that changes haven&#39;t been saved and prompts the user."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5559715, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96febe87400e4b6c4e74aefc4264bef5?s=128&d=identicon&r=PG&f=1", "display_name": "Cloude", "link": "https://stackoverflow.com/users/5559715/cloude"}, "edited": false, "score": 0, "creation_date": 1465490676, "post_id": 37728978, "comment_id": 62934682, "body": "That&#39;s all I had in my unload event other than an If statement that checks for unsaved changes (sensitive information involved so I didn&#39;t include it). Using Exit Sub in a form_unload event does not cancel it; your form will unload anyways. The reason the cancel is not working in this case is due to it being a subform on a navigation form. I&#39;ve simply disabled the navigation buttons while there are unsaved changes for now."}], "tags": [], "owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "is_accepted": false, "score": 0, "last_activity_date": 1465483013, "creation_date": 1465483013, "answer_id": 37728978, "question_id": 37712052, "link": "https://stackoverflow.com/questions/37712052/access-navigation-form-cancel-unload-event/37728978#37728978", "title": "Access navigation form, cancel unload event", "body": "<p>Its not clear in what you have outside of your if statement, but seemingly you just have to use the Exit Sub command. This would allow you to completely stop the navigation (if that in itself is a Sub), so: </p>\n\n<pre><code>If MsgBox (\"Changes have not been locked and will be lost. Do you wish to proceed?\", vbYesNo) = vbNo Then\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5559715, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96febe87400e4b6c4e74aefc4264bef5?s=128&d=identicon&r=PG&f=1", "display_name": "Cloude", "link": "https://stackoverflow.com/users/5559715/cloude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594641963, "creation_date": 1465416767, "last_edit_date": 1594641963, "question_id": 37712052, "link": "https://stackoverflow.com/questions/37712052/access-navigation-form-cancel-unload-event", "title": "Access navigation form, cancel unload event", "body": "<p>In the unload event of my Navigation Subform I have the following code.</p>\n\n<pre><code>If MsgBox (\"Changes have not been locked and will be lost. Do you wish to  proceed?\", vbYesNo) = vbNo Then\n    Cancel = True\nEnd If\n</code></pre>\n\n<p>When the user clicks one of the other navigation buttons on the parent form it presents the Yes/No message box but moves on, closing and clearing the active subform, regardless of what you select. Is it possible to cancel the navigation caused by clicking a navigation button?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "edited": false, "score": 0, "creation_date": 1465416948, "post_id": 37712013, "comment_id": 62897928, "body": "Please post code that you have tried. Stack Overflow is not a code writing service."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1465417281, "post_id": 37712013, "comment_id": 62898119, "body": "(Please instead edit that into your OP, it&#39;s hard to read in a comment)"}, {"owner": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "edited": false, "score": 0, "creation_date": 1465417400, "post_id": 37712013, "comment_id": 62898189, "body": "Added, my apologies"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1465417549, "post_id": 37712013, "comment_id": 62898260, "body": "You&#39;re testing the entire cell, not each character. Edit: you want <code>.characters</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465419897, "post_id": 37712013, "comment_id": 62899417, "body": "<code>ActiveCell.Characters([start], [length]).Font.Color = Red</code> and test each character using <code>Mid(ActiveCell.Value, x,1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "edited": false, "score": 0, "creation_date": 1465483029, "post_id": 37713047, "comment_id": 62929279, "body": "Thank you for the help, but this changes all of the characters to green instead of only the 1&#39;s?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "edited": false, "score": 0, "creation_date": 1465483823, "post_id": 37713047, "comment_id": 62929882, "body": "My bad - I edited after posting and didn&#39;t re-test.  Fixed now."}, {"owner": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "edited": false, "score": 0, "creation_date": 1465484242, "post_id": 37713047, "comment_id": 62930242, "body": "Thank you. Whats happening now is the code is taking the first occurrence of the digit, for example, if it is 10101, it will see the first 1 and change it to green, but it also changes every following 0 to green as well"}, {"owner": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "edited": false, "score": 0, "creation_date": 1465485422, "post_id": 37713047, "comment_id": 62931178, "body": "My apologies, works perfectly, thank you so much for your help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1465483788, "last_edit_date": 1465483788, "creation_date": 1465420506, "answer_id": 37713047, "question_id": 37712013, "link": "https://stackoverflow.com/questions/37712013/changing-specific-numeric-values-in-an-excel-cell/37713047#37713047", "title": "Changing specific numeric values in an excel cell", "body": "<p>Something like this:</p>\n\n<pre><code>Sub changeTextColor()\n\n    Dim v, s, clr, rng, x\n\n    Set rng = Range(\"H2\")\n\n\n    Do While rng.Value &lt;&gt; \"\"\n        v = rng.Value\n        For x = 1 To Len(v)\n\n            Select Case Mid(v, x, 1)\n               Case \"1\": clr = vbGreen\n               Case \"0\": clr = vbRed\n               Case Else: clr = vbBlack\n            End Select\n\n            rng.Characters(x, 1).Font.Color = clr\n\n        Next x\n\n        Set rng = rng.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6442299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90cf58f11ac4e882145cd73ea8785493?s=128&d=identicon&r=PG&f=1", "display_name": "user6442299", "link": "https://stackoverflow.com/users/6442299/user6442299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 37713047, "answer_count": 1, "score": 0, "last_activity_date": 1465483788, "creation_date": 1465416618, "last_edit_date": 1465421836, "question_id": 37712013, "link": "https://stackoverflow.com/questions/37712013/changing-specific-numeric-values-in-an-excel-cell", "title": "Changing specific numeric values in an excel cell", "body": "<p>I would like to color, for example, the 1s and 0s in a string such as \"1001001001\" as two different colors using a VBA Macro. Is this possible?\nHere is my attempted code</p>\n\n<pre><code>Sub changeTextColor()\n\n     Green = RGB(0, 255, 0)\n     Red = RGB(255, 0, 0)\n     Black = RGB(0, 0, 0)\n\n     'Select cell\n     Range(\"H2\").Select\n\n     For x = 1 To 10\n         If ActiveCell.Value = \"1\" Then\n\n            'Change the text color if \"1\"\n\n             ActiveCell.Font.Color = Green   \n\n         ElseIf ActiveCell.Value = \"0\" Then\n\n             'Change the text color if \"0\"\n\n             ActiveCell.Font.Color = Red\n\n         End If\n\n         ActiveCell.Offset(1, 0).Select\n     Next\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup", "excel-indirect"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465416624, "post_id": 37711975, "comment_id": 62897744, "body": "Store the argument of <code>indirect</code> into a variable will make it much easier to formulate formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1465417047, "post_id": 37711975, "comment_id": 62897978, "body": "<code>R32473</code> probably should be <code>R247C3</code>"}], "owner": {"reputation": 1, "user_id": 6431259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722b4288f03998b09b248a723b16c0f5?s=128&d=identicon&r=PG&f=1", "display_name": "ddevries", "link": "https://stackoverflow.com/users/6431259/ddevries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465416512, "creation_date": 1465416512, "question_id": 37711975, "link": "https://stackoverflow.com/questions/37711975/path-not-being-recognized-with-variable-folders-vlookup", "title": "Path Not Being Recognized With Variable Folders-VLOOKUP", "body": "<p>So I've gotten this to work in my Excel file, but now it isn't working when I'm trying to set a cell equal to that value in VBA. There are different variable column values in this which is what I'm trying to do in VBA...I got it to work in Excel. Am I typing this wrong into VBA? The first group is what is in my Excel cell, the second group is what I've entered into VBA to try to get it put that value in Excel on its own, and I can't see where I'm wrong. Also, I know the workbook I'm referencing must be open to work, and I have it open. (And don't worry about the i part...I know that works correctly) Thanks guys!</p>\n\n<p><strong>Excel</strong>\n<code>=VLOOKUP($AM14,INDIRECT(\"'U:\\Corp\\Material\\Paper\\White\\Numbers\\Certs\\\"&amp;$C$246&amp;\"\\\"&amp;$C$247&amp;\"\\models\\[EGP_PGBL_\"&amp;$C$249&amp;\" - final - corp.xlsb]\"&amp;C$250&amp;\"'!\"&amp;\"$B:$Q\"),16)</code></p>\n\n<p><strong>VBA</strong></p>\n\n<p><code>Cells(14, (i * 2) + 2).FormulaR1C1 = \"=VLOOKUP(R14C\" &amp; DateColumn &amp; \",INDIRECT(\"\"\"'U:\\Corp\\Material\\Paper\\White\\Numbers\\Certs\\\"\" &amp; R246C3&amp; \"\"\\\"\" &amp; R32473 &amp; \"\"\\models\\[EGP_PGBL_\"\" &amp; R249C3 &amp; \"\" - final - corp.xlsb]\"\" &amp; R250C\" &amp; FirstCell &amp; \"\"'!\"\"&amp;\"\"RC2:RC16\"\"), 16)</code></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 0, "creation_date": 1465415892, "post_id": 37711685, "comment_id": 62897308, "body": "It&#39;s prefereable to use <code>CreateQueryDef</code> so you can pass parameters: <a href=\"https://support.microsoft.com/en-us/kb/142938\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/142938</a>. It also avoids Sql Injection vulnerability"}, {"owner": {"reputation": 23, "user_id": 6316708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb6b384f52ed7dad1b431cea9476c38?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6316708/matt"}, "reply_to_user": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "edited": false, "score": 0, "creation_date": 1465500513, "post_id": 37711685, "comment_id": 62940539, "body": "Thanks. I ended up changing the Time field in the table to a different name and it worked successfully. I will look into CreateQueryDef, however, as well."}], "owner": {"reputation": 23, "user_id": 6316708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb6b384f52ed7dad1b431cea9476c38?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6316708/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593958467, "creation_date": 1465415498, "last_edit_date": 1593958467, "question_id": 37711685, "link": "https://stackoverflow.com/questions/37711685/date-time-syntax-error-3144-on-update", "title": "Date/Time syntax error 3144 on update", "body": "<p>I am building a database with UI forms for employees to use. On several of them I have the date/time written into a table that works without issue. </p>\n\n<pre><code>txtrmopcsgstarttime=Now()\nstrsql = \"UPDATE RMOP_csg_Daily_tbl SET Start_Time = '\" &amp; Me.txtrmopcsgstarttime &amp; \"' WHERE sysacct = [txtrmopcsgsysacct]\"\nDoCmd.RunSQL strsql\n</code></pre>\n\n<p>I am now creating a form where I am trying to create a tracking log with their username and a timestamp. I have tried using INSERT INTO and UPDATE both without success. I can get the username to write into the table just not the date/time.</p>\n\n<pre><code>Dim strsql As String\n txtAMSetup_CurrentDate = Now()\n      strsql = \"INSERT INTO AMSetupLog_tbl1 (User) VALUES ('\" &amp; Me.txtAMSetup_UserName.Value &amp; \"')\"\n      DoCmd.RunSQL strsql\n      strsql = \"UPDATE AMSetupLog_tbl1 SET Time = '\" &amp; Me.txtAMSetup_CurrentDate &amp; \"' WHERE USER = [txtAMSetup_UserName]\"\n      DoCmd.RunSQL strsql\n</code></pre>\n\n<p>The error I am receiving in this format is a 3144 syntax error. \nAny suggestions?</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1465417199, "post_id": 37712070, "comment_id": 62898079, "body": "That did solve my second stated problem. However, It is still not populating a primary axis title box. I&#39;m not getting an error for this, it seem to just be ignoring my code."}], "tags": [], "owner": {"reputation": 98, "user_id": 4966176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6a3cb31f7c6d295b3f781d4c722d2d?s=128&d=identicon&r=PG&f=1", "display_name": "JerryT", "link": "https://stackoverflow.com/users/4966176/jerryt"}, "is_accepted": true, "score": 1, "last_activity_date": 1465416853, "creation_date": 1465416853, "answer_id": 37712070, "question_id": 37711667, "link": "https://stackoverflow.com/questions/37711667/excel-vba-chart-formatting-axis-labels/37712070#37712070", "title": "Excel VBA - Chart Formatting axis labels", "body": "<p>I think this is because you have not created the secondary axis yet. Try putting those 2 lines after you format all of your series</p>\n"}, {"tags": [], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "is_accepted": false, "score": 2, "last_activity_date": 1465418283, "creation_date": 1465418283, "answer_id": 37712451, "question_id": 37711667, "link": "https://stackoverflow.com/questions/37711667/excel-vba-chart-formatting-axis-labels/37712451#37712451", "title": "Excel VBA - Chart Formatting axis labels", "body": "<pre><code>    With .Axes(xlValue, xlPrimary)\n        .HasTitle = True\n        .AxisTitle.Text = \"AHT (s)\"\n    End With\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 37712070, "answer_count": 2, "score": 0, "last_activity_date": 1465418283, "creation_date": 1465415437, "question_id": 37711667, "link": "https://stackoverflow.com/questions/37711667/excel-vba-chart-formatting-axis-labels", "title": "Excel VBA - Chart Formatting axis labels", "body": "<p>I am trying to add axes labels to my chart. Below is a part of my code. </p>\n\n<p>First, my code is not producing an error when it runs the line which adds the primary axis title. Despite not registering an error, my chart still lacks a text box for an axis title.</p>\n\n<p>Second, I am not sure why my code is generating an error when I try to add the secondary axis title. I copied this section of code from the macro recorder, so I am fairly certain that the syntax is correct.</p>\n\n<p>Thanks for all your help!    </p>\n\n<pre><code>Dim myChart As Chart, cht As ChartObject\nDim rngChart As Range, destSht As String\nDim rngData As Range\n\ndestSht = ActiveSheet.Name\nSet myChart = Charts.Add\nSet myChart = myChart.Location(where:=xlLocationAsObject, Name:=destSht)\n\nWith ActiveSheet.ListObjects(\"Table1\").DataBodyRange\nSet rngData = Union(.Columns(2), .Columns(9), .Columns(10), .Columns(11), .Columns(12))\nEnd With\n\nWith myChart\n.SetSourceData Source:=rngData, PlotBy:=xlColumns\n.ChartType = xlColumnClustered\n.ChartStyle = 209\n.FullSeriesCollection(1).Name = \"AHT\"\n.SetElement (msoElementChartTitleAboveChart)\n    .ChartTitle.Text = \"AHT/Transfer Metrics\"\n\n'*****PROBLEM SECTION*****\n.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\n'*****Below is the line of code that is giving me an error*****\n.SetElement (msoElementSecondaryValueAxisTitleAdjacentToAxis)\n'******              *****\n\nWith .FullSeriesCollection(2)\n    .Name = \"Target AHT\"\n    .ChartType = xlLine\n    .AxisGroup = 1\n    .Select\n        With Selection.Format.Line\n            .Weight = 1\n        End With\nEnd With\nWith .FullSeriesCollection(3)\n    .ChartType = xlLineMarkers\n    .AxisGroup = 2\n    .Name = \"Transfers\"\n    .Select\n        With Selection.Format.Line\n            .Weight = 1.75\n        End With\nEnd With\nWith .FullSeriesCollection(4)\n    .ChartType = xlLine\n    .AxisGroup = 2\n    .Name = \"Target Transfers\"\n    .Select\n        With Selection.Format.Line\n            .Weight = 1\n        End With\nEnd With\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "sql-server-2008", "ms-access-2013"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1465416077, "post_id": 37711508, "comment_id": 62897423, "body": "Why not use a temp table or linked table and then have datasheet bound to it?"}, {"owner": {"reputation": 33, "user_id": 3960694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/03adbdbdc0683a301fea110ece9ee203?s=128&d=identicon&r=PG&f=1", "display_name": "Jones James", "link": "https://stackoverflow.com/users/3960694/jones-james"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1465933344, "post_id": 37711508, "comment_id": 63105442, "body": "@Parfait Thank you! Yes I did exactly this."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 3960694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/03adbdbdc0683a301fea110ece9ee203?s=128&d=identicon&r=PG&f=1", "display_name": "Jones James", "link": "https://stackoverflow.com/users/3960694/jones-james"}, "is_accepted": true, "score": 0, "last_activity_date": 1465933232, "creation_date": 1465933232, "answer_id": 37820738, "question_id": 37711508, "link": "https://stackoverflow.com/questions/37711508/setting-recordset-to-stored-procedure-results-attempting-to-sort-filter-results/37820738#37820738", "title": "Setting RecordSet to stored procedure results. Attempting to sort/filter results in Data Provider could not be Initialized", "body": "<p>I ended up answering my own question with a pretty solid solution as suggested by @parfiat</p>\n\n<p>I created a temp table then inserted values from a recordset. I then set the temp table to the DAO.recordset which my datasheet pulls from. Here's my coded solution: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>  \r\n    Set rs = New ADODB.recordset\r\n    Set cn2 = New ADODB.connection\r\n    With cn2\r\n       .Provider = \"Microsoft.Access.OLEDB.10.0\"\r\n       .Properties(\"Data Provider\") = \"SQLNCLI10\"\r\n       .Properties(\"Data Source\") = \"ascsql2012sbox\"\r\n       .Properties(\"Integrated Security\") = \"SSPI\"\r\n       .Properties(\"Initial Catalog\") = \"assetQuality_dev\"\r\n    End With\r\n    cn2.Open\r\n    cn2.CommandTimeout = 0\r\n    rs.CursorLocation = adUseClient\r\n    rs.LockType = adLockOptimistic\r\n    rs.CursorType = adOpenKeyset\r\n    rs.Source = \"SELECT \" &amp; sqlSelect &amp; \" FROM \" &amp; sqlFrom &amp; IIf(sqlWhere &lt;&gt; \"\", \" WHERE \" &amp; sqlWhere, \"\") &amp; IIf(sqlOrder &lt;&gt; \"\", \" ORDER BY \" &amp; sqlOrder, \"\")\r\n    Set rs.ActiveConnection = cn2\r\n    rs.Open\r\n      \r\n    If AccessTableExists(\"ThisTable\") = True Then\r\n    DoCmd.DeleteObject acTable = acDefault, \"ThisTable\"\r\n    End If\r\n    \r\n    ' Create temp table\r\n    Dim dbs As Database\r\n  \r\n    ' on your computer\r\n    Set dbs = CurrentDb\r\n \r\n    ' Create a table with two text fields.\r\n    dbs.Execute \"CREATE TABLE ThisTable \" _\r\n    &amp; \"(accountID int, customerName CHAR, phoneHome VARCHAR(25), taxID VARCHAR(9), address VARCHAR(200), addressState VARCHAR(2), addressCity VARCHAR(2), bank VARCHAR(35), dateReview VARCHAR(200), orderDateReview VARCHAR(100), dateDue VARCHAR(100), balCustomer VARCHAR(200), activityCode VARCHAR(100), dateActivity VARCHAR(100), accountNumber VARCHAR(25));\"\r\n   \r\n    dbs.Close\r\n     \r\n    Dim dbsTemp As DAO.Database\r\n    Dim rstemp As DAO.recordset\r\n \r\n    Set dbsTemp = CurrentDb\r\n    Set rstemp = dbsTemp.OpenRecordset(\"ThisTable\", dbOpenDynaset)\r\n    \r\n    Do While Not rs.EOF\r\n    rstemp.AddNew\r\n    rstemp!accountID.value = rs!accountID.value\r\n    rstemp!customerName.value = rs!customerName.value\r\n    rstemp!balCustomer.value = rs!balCustomer.value\r\n    rstemp!accountNumber.value = rs!accountNumber.value\r\n    rstemp!dateDue.value = rs!dateDue.value\r\n    rstemp!taxID.value = rs!taxID.value\r\n    rstemp!phoneHome.value = rs!phoneHome.value\r\n    rstemp!dateReview.value = rs!dateReview.value\r\n    rstemp!activityCode.value = rs!activityCode.value\r\n    rstemp!dateActivity.value = rs!dateActivity.value\r\n    rstemp.update\r\n    rs.MoveNext\r\nLoop\r\n    Set Me.recordset = rstemp\r\n    rs.Close\r\n    Set rs = Nothing\r\n    cn2.Close\r\n    Set cn2 = Nothing</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 33, "user_id": 3960694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/03adbdbdc0683a301fea110ece9ee203?s=128&d=identicon&r=PG&f=1", "display_name": "Jones James", "link": "https://stackoverflow.com/users/3960694/jones-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 37820738, "answer_count": 1, "score": 2, "last_activity_date": 1465933232, "creation_date": 1465414859, "last_edit_date": 1465418582, "question_id": 37711508, "link": "https://stackoverflow.com/questions/37711508/setting-recordset-to-stored-procedure-results-attempting-to-sort-filter-results", "title": "Setting RecordSet to stored procedure results. Attempting to sort/filter results in Data Provider could not be Initialized", "body": "<p>My team and I support a large network of MS access applications. Recently we upgraded our Microsoft Office from 2010 to 2013. The only thing that broke in this upgrade was our ability to sort/filter datasheets that are populated from an ADO RecordSet. Attempting to filter results in an error</p>\n\n<blockquote>\n  <p>Data Provider could not be initialized</p>\n</blockquote>\n\n<p>From my research I understand that Microsoft considers ADO deprecated and has stopped supporting ADO as a means of populating RecordSets. </p>\n\n<p>I'm however in a specific bind and have been trying every \"fix\" I could find in order to get this datasheet filterable. I am open to all suggestions. </p>\n\n<p>The closest I have gotten is by populating the datasheet via a stored procedure: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> Dim cn As New ADODB.connection\r\n   \r\n   Dim cm As New ADODB.Command\r\n   \r\n  \r\n   Set cn = New ADODB.connection\r\n      With cn\r\n         .Provider = \"Microsoft.Access.OLEDB.10.0\"\r\n         .Properties(\"Data Provider\") = \"SQLNCLI10\"\r\n         .Properties(\"Data Source\") = \"ascsql2012sbox\"\r\n         .Properties(\"Integrated Security\") = \"SSPI\"\r\n         .Properties(\"Initial Catalog\") = \"assetQuality_dev\"\r\n      End With\r\n   \r\n   cn.Open\r\n  \r\n   Dim rs As ADODB.recordset\r\n   Set rs = New ADODB.recordset\r\n   With cm\r\n        .ActiveConnection = cn\r\n        .CommandText = \"dbo.accountIDproc\"\r\n        .CommandType = adCmdStoredProc\r\n        .parameters.Refresh\r\n        End With\r\n        With rs\r\n        .ActiveConnection = cn\r\n        .CursorType = adOpenForwardOnly\r\n        .CursorLocation = adUseClient\r\n        End With\r\n        \r\n    Set rs = cm.Execute\r\n    \r\n    cm.ActiveConnection = Nothing\r\n    \r\n    Set Me.recordset = rs\r\n    \r\n    rs.Close\r\n    Set rs = Nothing\r\n    cn.Close\r\n    Set cn = Nothing\r\n    </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But the same error </p>\n\n<blockquote>\n  <p>Data provider could not be initialized</p>\n</blockquote>\n\n<p>is still showing up whenever I try to sort a column from A-Z or Z-A. For some columns that contain an integer value. It asks me for a value to sort by then tells me \"that's not a valid value\" when it's absolutely a valid value.</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465415398, "post_id": 37711428, "comment_id": 62897032, "body": "Sounds like you have a real problem here, could you expand on what is happening in the code, I follow it up to <code>NoCell</code> and <code>rsrcl</code>."}, {"owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465415946, "post_id": 37711428, "comment_id": 62897338, "body": "@GaryEvans so after rsrcl, the cells are copied from that sheet and pasted in rsrca column D (transposed). After this line is the problem. I need to copy cells A3:C3 cells if (j=3) from &quot;Sheet3&quot; and paste in rsrca A to C columns but paste it multiple times until the end of the pasted column &quot;D&quot; (transposed) in the previous step. I hope you got an idea.  So what i did is I&#39;am copying the cells specifying a range with NoCell as the upperlimit for for loop but seems not to work.  I can send you the ecel file for better understanding. Thanks!"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465417472, "post_id": 37711428, "comment_id": 62898226, "body": "very sorry, there is not enough here for me to understand what you are trying to, hopefully someone else can follow it better than me."}, {"owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465417692, "post_id": 37711428, "comment_id": 62898329, "body": "@GaryEvans   I added the excel sheet. Please have a look at it. I hope it gives an idea."}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1465420262, "post_id": 37711428, "comment_id": 62899586, "body": "What did you set rsrcl and rsrca equal to?"}, {"owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1465420513, "post_id": 37711428, "comment_id": 62899700, "body": "@Rodger rsrcl = sheets(&quot;resourcelib&quot;)                 rsrca = sheets(&quot;resources&quot;) The excel file attached would give a better idea of what i&#39;m trying to achieve.you can see the code as well. Thank you!"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1465420738, "post_id": 37711428, "comment_id": 62899791, "body": "Yep, been looking at that already. Just needed to know what those were in terms of ranges/sheets/etc so that I can use them correctly in the answer"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1465421089, "post_id": 37711428, "comment_id": 62899955, "body": "when you say &quot;range length&quot; range length of what part? this line or a different line/different range? rsrcl.Range(rsrcl.Cells(i, 2), rsrcl.Cells(i, rsrcl.Cells(i, Columns.Count).End(xlToLeft).Column)).Copy"}, {"owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "edited": false, "score": 0, "creation_date": 1465421329, "post_id": 37711428, "comment_id": 62900073, "body": "Yes that is the line for the range length, but when we paste it in the rsca sheet the cells in that range are transposed and pasted in Column &quot;D&quot;."}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1465423030, "post_id": 37711428, "comment_id": 62900834, "body": "Clear resources sheet before you run that and you should have a line for line match"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "edited": false, "score": 0, "creation_date": 1465424214, "post_id": 37713646, "comment_id": 62901316, "body": "you are a genius!!"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "edited": false, "score": 0, "creation_date": 1465433099, "post_id": 37713646, "comment_id": 62903909, "body": "Happy to help! :-) Hopefully the comments will show you how it was done so next time you got it on your own. :-)"}], "tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": true, "score": 0, "last_activity_date": 1465422980, "creation_date": 1465422980, "answer_id": 37713646, "question_id": 37711428, "link": "https://stackoverflow.com/questions/37711428/pasting-a-row-multiple-times-based-on-the-range-in-excel-vba/37713646#37713646", "title": "Pasting a row multiple times based on the range in excel vba", "body": "<p>This should do it for you. </p>\n\n<pre><code>Sub Transfer()\n\nDim i As Long, j As Long, lastrow1 As Long, lastrow2 As Long, Lastcolumn As Long, k As Long, m As Long\nDim Firstrow As Long, Lastrow As Long, NoCell As Long\nDim activity As String, resources As String\nDim rsrcl As Worksheet, rsrca As Worksheet\nDim aRsrclRange\nDim iRangeLength\nDim lastrowtemp As Long\n\nSet rsrcl = Sheets(\"ResourcesLib\")\nSet rsrca = Sheets(\"Resources\")\nk = 2\nm = 1\nNoCell = 2\niRangeLength = 1 ' default to 1 for the lines that only have a single value ... they won't be arrays\n\n'Adding Resources to activities\nlastrow1 = Sheets(\"ResourcesLib\").Range(\"A\" &amp; Rows.Count).End(xlUp).row\n\nFor i = 1 To lastrow1\n    resources = Sheets(\"ResourcesLib\").Cells(i, \"A\").Value\n    Sheets(\"sheet3\").Activate\n    lastrow2 = Sheets(\"sheet3\").Range(\"B\" &amp; Rows.Count).End(xlUp).row\n    For j = 2 To lastrow2\n        If Sheets(\"sheet3\").Cells(j, \"B\").Value = resources Then\n            Sheets(\"ResourcesLib\").Activate\n            NoCell = rsrcl.Cells(i, rsrcl.Columns.Count).End(xlToLeft).Column\n            rsrcl.Range(rsrcl.Cells(i, 2), rsrcl.Cells(i, rsrcl.Cells(i, Columns.Count).End(xlToLeft).Column)).Copy 'put range into clipboard for paste transpose\n            aRsrclRange = rsrcl.Range(rsrcl.Cells(i, 2), rsrcl.Cells(i, rsrcl.Cells(i, Columns.Count).End(xlToLeft).Column)) 'put range into array for ubound calculation\n            If IsArray(aRsrclRange) Then iRangeLength = UBound(aRsrclRange, 2) 'get the length of the range that was copied\n            rsrca.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n            Sheets(\"sheet3\").Activate\n            Sheets(\"sheet3\").Range(Cells(j, \"A\"), Cells(j, \"C\")).Copy 'Copy a through c at the same time since you are pasting them in a row\n            lastrowtemp = Sheets(\"Resources\").Range(\"B\" &amp; Rows.Count).End(xlUp).row 'get current last row on resources\n            While iRangeLength &gt; 0 'paste on last line number of times equal to array length\n                lastrowtemp = lastrowtemp + 1\n                rsrca.Activate\n                If IsArray(aRsrclRange) Then\n                    rsrca.Range(Cells(lastrowtemp, 1), Cells(lastrowtemp, UBound(aRsrclRange, 2))).PasteSpecial\n                Else\n                    rsrca.Range(Cells(lastrowtemp, 1), Cells(lastrowtemp, 1)).PasteSpecial\n                End If\n                iRangeLength = iRangeLength - 1\n            Wend\n            iRangeLength = 1 'back to 1 for the lines with only 1 value\n        End If\n    Next j\n    k = (NoCell - 2) + k\n    m = k\n    Application.CutCopyMode = False\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4745384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ee555d87da120c95be0f82d4190787?s=128&d=identicon&r=PG&f=1", "display_name": "adr0327", "link": "https://stackoverflow.com/users/4745384/adr0327"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 37713646, "answer_count": 1, "score": 0, "last_activity_date": 1465422980, "creation_date": 1465414561, "last_edit_date": 1531164843, "question_id": 37711428, "link": "https://stackoverflow.com/questions/37711428/pasting-a-row-multiple-times-based-on-the-range-in-excel-vba", "title": "Pasting a row multiple times based on the range in excel vba", "body": "<p>I'm not able to get my head around this problem. I am copying the cells in a <code>row</code> <code>A2:C2</code> from one sheet to another sheet but I want to paste them in multiple <code>rows</code> based on the cells filled on the adjacent <code>column</code> <code>D</code>. I am able to populate the <code>column</code> <code>D</code> with the appropriate range.\nMy problem is how to determine the range length and paste the cells <code>A2:C2</code> that many times. Here is the code which i tried to write. I <code>declared</code> all the <code>variables</code> before. This is the part of code where i'm having issues. Thank you all!\n<a href=\"https://drive.google.com/open?id=0BxNW23K23hUGUTc1VjJKbUFTZGs\" rel=\"nofollow\">Excel Sheet Here</a></p>\n\n<pre><code>lastrow1 = Sheets(\"ResourcesLib\").Range(\"A\" &amp; Rows.Count).End(xlUp).row\n\nFor i = 1 To lastrow1\n    resources = Sheets(\"ResourcesLib\").Cells(i, \"A\").Value\n    Sheets(\"sheet3\").Activate\n    lastrow2 = Sheets(\"sheet3\").Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\nFor j = 2 To lastrow2\n    If Sheets(\"sheet3\").Cells(j, \"B\").Value = resources Then\n        Sheets(\"ResourcesLib\").Activate\n        NoCell = rsrcl.Cells(i, rsrcl.Columns.Count).End(xlToLeft).Column\n        rsrcl.Range(rsrcl.Cells(i, 2), rsrcl.Cells(i,rsrcl.Cells(i,Columns.Count).End(xlToLeft).Column)).Copy\n        rsrca.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n        Sheets(\"sheet3\").Activate\n        Sheets(\"sheet3\").Cells(j, \"A\").Copy\n        rsrca.Range(Cells(k, 1), Cells(m + (NoCell - 1), 1)).PasteSpecial\n        Sheets(\"sheet3\").Cells(j, \"B\").Copy\n        rsrca.Range(Cells(k, 2), Cells(m + (NoCell - 1), 2)).PasteSpecial\n        Sheets(\"sheet3\").Cells(j, \"C\").Copy\n        rsrca.Range(Cells(k, 3), Cells(m + (NoCell - 1), 3)).PasteSpecial\n    End If\n\nNext j\nk = (NoCell - 2) + k\nm = k\nApplication.CutCopyMode = False\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465415070, "post_id": 37711363, "comment_id": 62896833, "body": "<code>add rows based on the value of column C</code> please explain."}, {"owner": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465416787, "post_id": 37711363, "comment_id": 62897847, "body": "If for example C4 has a quantity of &#39;4&#39; - I&#39;d like to add 3 empty rows below"}, {"owner": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465417183, "post_id": 37711363, "comment_id": 62898070, "body": "Well the code would hopefully loop down to the next &#39;not empty&#39; cell, so for example if C5 = 2 then I&#39;d want to add 1 empty row below"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465417269, "post_id": 37711363, "comment_id": 62898115, "body": "Ahhh, now I have an idea of what the data looks like..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465418236, "post_id": 37711363, "comment_id": 62898597, "body": "What Abe has below should be close enough."}, {"owner": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465420116, "post_id": 37711363, "comment_id": 62899527, "body": "Im getting an error for &quot;numRows = val(.Cells(R, Col) - 1&quot;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465420251, "post_id": 37711363, "comment_id": 62899583, "body": "You want to respond to Abe below."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "edited": false, "score": 0, "creation_date": 1465421475, "post_id": 37711423, "comment_id": 62900135, "body": "Im getting an error for this - on the row &quot;numRows = val(.Cells(R, Col) - 1&quot;. Could you maybe post the entire code you&#39;d use - thanks!"}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "reply_to_user": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "edited": false, "score": 0, "creation_date": 1465442059, "post_id": 37711423, "comment_id": 62905638, "body": "Oops. Left out a closing parentheses. See above."}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 0, "last_activity_date": 1465442038, "last_edit_date": 1465442038, "creation_date": 1465414544, "answer_id": 37711423, "question_id": 37711363, "link": "https://stackoverflow.com/questions/37711363/vba-deleting-rows-based-on-cell-containing-specific-words-adding-rows-based/37711423#37711423", "title": "VBA - deleting rows based on cell containing specific words + adding rows based on cell value", "body": "<pre><code>If .Cells(R, Col) &gt; 1 Then\n   numRows = val(.Cells(R, Col)) - 1\n   For i = 1 to numRows\n       .Cells(R + 1, Col).EntireRow.Insert Shift:=xlDown\n   Next i\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1465492428, "post_id": 37713722, "comment_id": 62935708, "body": "@bliq did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1465423370, "creation_date": 1465423370, "answer_id": 37713722, "question_id": 37711363, "link": "https://stackoverflow.com/questions/37711363/vba-deleting-rows-based-on-cell-containing-specific-words-adding-rows-based/37713722#37713722", "title": "VBA - deleting rows based on cell containing specific words + adding rows based on cell value", "body": "<p>As for inserting rows</p>\n\n<pre><code>For R = LastRow To StartRow + 1 Step -1\n   With .Cells(R, Col)\n      If .Value &gt; 1 Then .Offset(1).Resize(.Value).EntireRow.Insert\n   End With\nNext R\n</code></pre>\n\n<p>While for filtering and deleting</p>\n\n<pre><code>Sub test()\nWith ActiveSheet\n   .AutoFilterMode = False\n   With .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n      .AutoFilter Field:=1, Criteria1:=Array(\"*Maint*\", \"*APP*\"), Operator:=xlFilterValues\n      If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Offset(1).Resize(.Rows.Count -1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n   End With\n   .AutoFilterMode = False\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6442133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddd69ac9794f4ce5c4ce2031dc5c1ca?s=128&d=identicon&r=PG&f=1", "display_name": "bliq", "link": "https://stackoverflow.com/users/6442133/bliq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1465442038, "creation_date": 1465414375, "question_id": 37711363, "link": "https://stackoverflow.com/questions/37711363/vba-deleting-rows-based-on-cell-containing-specific-words-adding-rows-based", "title": "VBA - deleting rows based on cell containing specific words + adding rows based on cell value", "body": "<p>What I am trying to do:</p>\n\n<p>Exporting excel doc from Salesforce. I am trying to delete some rows based on a condition, then add rows based on a different set of conditions. \nBeing new to VBA, I've browsed the forums and googled some sample codes, but cannot get them to work fully.</p>\n\n<p>Adding rows:</p>\n\n<p>Column C = Quantity. Need to add rows below based on the value in column C. If quantity = 3 - I want to add 2 blank rows below. If quantity = 4 - 3 blank rows below...</p>\n\n<p>Tried:</p>\n\n<pre><code>Sub BlankLine()\n\nDim Col As Variant\nDim BlankRows As Long\nDim LastRow As Long\nDim R As Long\nDim StartRow As Long\n\n    Col = \"C\"\n    StartRow = 15\n    BlankRows = 1\n\n        LastRow = Cells(Rows.Count, Col).End(xlUp).Row\n\n        Application.ScreenUpdating = False\n\n        With ActiveSheet\nFor R = LastRow To StartRow + 1 Step -1\nIf .Cells(R, Col) &gt; 1 Then\n.Cells(R + 1, Col).EntireRow.Insert Shift:=xlDown\nEnd If\nNext R\nEnd With\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This works, but only adds a single row below - I need it to add rows based on the value of column C = 'quantity'. </p>\n\n<p>Deleting Rows:</p>\n\n<p>Column A = Product Names. If any product name contains MAINT or APP, I need to delete that row. Tried:</p>\n\n<pre><code>Sub test()\n\nWith ActiveSheet\n.AutoFilterMode = False\nWith Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    .AutoFilter 1, \"*Maint*\"\n    On Error Resume Next\n    .Offset(1).SpecialCells(12).EntireRow.Delete\nEnd With\n.AutoFilterMode = False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This also works, but deletes the top row once done, so I lose some information. </p>\n\n<p>Any suggestions on how to approach this is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465419909, "post_id": 37711258, "comment_id": 62899424, "body": "show the macro. show the sample data. we can&#39;t guess at what you&#39;ve written or what the data looks like"}, {"owner": {"reputation": 35, "user_id": 4778306, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b3cd0af0b33c9b9b49f2385a7226c7?s=128&d=identicon&r=PG&f=1", "display_name": "mithirich", "link": "https://stackoverflow.com/users/4778306/mithirich"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465475496, "post_id": 37711258, "comment_id": 62923342, "body": "Sorry. Added it above."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 4778306, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b3cd0af0b33c9b9b49f2385a7226c7?s=128&d=identicon&r=PG&f=1", "display_name": "mithirich", "link": "https://stackoverflow.com/users/4778306/mithirich"}, "is_accepted": false, "score": 0, "last_activity_date": 1465561924, "creation_date": 1465561924, "answer_id": 37748385, "question_id": 37711258, "link": "https://stackoverflow.com/questions/37711258/select-tasks-without-activeselection-using-project-vba/37748385#37748385", "title": "Select Tasks without ActiveSelection using Project VBA", "body": "<p>Okay I figured something out. Not the way I initially had in mind but it worked. I used the WBS property of Project to skip any task with outline level \"1\". So it would start at outline level \"2\" which contained what I wanted. Ending the loop was easy sine I just needed an If statement to jump out of the loop when it came across that last task name.</p>\n\n<pre><code>For Each t In ActiveProject.Tasks\nIf t.Name = \"History\" Then\nExit For\nEnd If\nIf t.Name = \"Vacations\" Then\n   TaskA = t.ID\nEnd If\nIf t.Name = \"Buyoffs/Service\" Then\n   TaskB = t.ID\nEnd If\nIf t.Name = \"Buyoffs/Service\" Then GoTo NextIteration\nTaskOffset = TaskB - TaskA + 1\nIf t.Name = \"Vacations\" Then GoTo NextIteration\nIf t.Name = \"Unscheduled\" Then GoTo NextIteration\nIf InStr(1, t.WBS, \"1.\") Then GoTo NextIteration\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 1).Value = t.ID\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 2).Value = t.Name\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 3).Value = t.ResourceNames\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 4).Value = t.Start\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 4).NumberFormat = \"[$-409]mm-dd-yy;@\"\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 5).Value = t.Finish\n    xlSheet.Cells(t.ID + 4 - TaskOffset, 5).NumberFormat = \"[$-409]mm-dd-yy;@\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4778306, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b3cd0af0b33c9b9b49f2385a7226c7?s=128&d=identicon&r=PG&f=1", "display_name": "mithirich", "link": "https://stackoverflow.com/users/4778306/mithirich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561750477, "creation_date": 1465414098, "last_edit_date": 1561750477, "question_id": 37711258, "link": "https://stackoverflow.com/questions/37711258/select-tasks-without-activeselection-using-project-vba", "title": "Select Tasks without ActiveSelection using Project VBA", "body": "<p>I take a project and export selected tasks into a Gantt chart in Excel.</p>\n\n<p>The tasks that end up in the Excel chart are selected by highlighting them in Project and then running the macro. I would like for the macro to select these tasks by looking at the first and last task of that group. What I mean is I'd like to read the task names, find Task Name \"A\" and then process all the tasks afterwards until it hits Task Name \"Z\".</p>\n\n<p>I tried to use the Task ID to set the ID numbers but the task number will change whenever new tasks are added to the project. I also tried using the unique ID but that won't work since there are some tasks between A and Z that have been in the project for a while so setting a specific range for that wouldn't work either.</p>\n\n<p>I feel there is a simple way to do this but I just haven't stumbled upon it yet.</p>\n\n<p>EDIT: Added the code below. The relevant section is just below the comment \"Fill cells with Task information\".</p>\n\n<pre><code>Sub ExportToExcel()\n\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheet As Excel.Worksheet\nDim proj As Project\nDim t As Task\nDim pj As Project\nDim pjDuration As Integer\nDim i As Integer\nDim k As Integer\nDim c As Range\nSet pj = ActiveProject\nSet xlApp = New Excel.Application\n\n'AppActivate \"Excel\"\nxlApp.Visible = False\nSet xlBook = xlApp.Workbooks.Open(\"C:\\Users\\Controls\\Desktop\\ServiceSchedule.xlsx\")\nxlApp.WindowState = xlMaximized\n\n'Set up Project Detail Headers\nSet xlSheet = xlBook.Worksheets(1)\nxlSheet.Application.ScreenUpdating = False\nxlSheet.Application.DisplayAlerts = False\nxlSheet.UsedRange.Delete\nxlSheet.Cells.Clear\nxlSheet.Cells.ClearContents\n'xlSheet.Cells(1, 1).Value = \"Project Name\"\n'xlSheet.Cells(1, 2).Value = pj.Name\n'xlSheet.Cells(2, 1).Value = \"Project Title\"\n'xlSheet.Cells(2, 2).Value = pj.Title\n'xlSheet.Cells(1, 4).Value = \"Project Start\"\n'xlSheet.Cells(1, 5).Value = pj.ProjectStart\n'xlSheet.Cells(2, 4).Value = \"Project Finish\"\n'xlSheet.Cells(2, 5).Value = pj.ProjectFinish\n\n'Set Gantt Chart Timespan\n'xlSheet.Cells(1, 7).Value = \"Project Duration\"\npjDuration = 90\n'xlSheet.Cells(1, 8).Value = pjDuration &amp; \"d\"\n\n'Set up Headers\nxlSheet.Cells(4, 1).Value = \"Task ID\"\nxlSheet.Cells(4, 2).Value = \"Task Name\"\nxlSheet.Cells(4, 3).Value = \"Name\"\nxlSheet.Cells(4, 4).Value = \"Task Start\"\nxlSheet.Cells(4, 5).Value = \"Task Finish\"\nxlSheet.Cells(4, 1).Font.Bold = True\nxlSheet.Cells(4, 2).Font.Bold = True\nxlSheet.Cells(4, 3).Font.Bold = True\nxlSheet.Cells(4, 4).Font.Bold = True\nxlSheet.Cells(4, 5).Font.Bold = True\n\n'Freeze Rows &amp; Columns\nxlSheet.Range(\"F5\").Select\nxlSheet.Application.ActiveWindow.FreezePanes = True\n\n'AutoFit Header columns and Hide blank rows\nxlSheet.Columns(\"A:E\").AutoFit\nxlSheet.Columns(\"A\").Hidden = True\nxlSheet.Rows(\"1:2\").Hidden = True\n\n' Add day of the week headers for the entire Project's duration\n\nFor i = 0 To pjDuration\n'If Today's Date is Sunday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 1 Then\n    xlSheet.Cells(3, i + 6).Value = Now() + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = Now() + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n'If Today's Date is Monday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 2 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 1) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 1) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n 'If Today's Date is Tuesday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 3 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 2) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 2) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n'If Today's Date is Wednesday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 4 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 3) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 3) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n'If Today's Date is Thursday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 5 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 4) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 4) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n'If Today's Date is Friday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 6 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 5) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 5) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n'If Today's Date is Saturday\n    If xlSheet.Application.WorksheetFunction.Weekday(Now()) = 7 Then\n    xlSheet.Cells(3, i + 6).Value = (Now() - 6) + i\n    xlSheet.Cells(3, i + 6).NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n    xlSheet.Cells(4, i + 6).Value = (Now() - 6) + i\n    xlSheet.Cells(4, i + 6).NumberFormat = \"ddd\"\n    End If\n\n'Color Weekend columns\n    xlSheet.Cells(4, i + 6).ColumnWidth = 10\n    If xlSheet.Application.Cells(4, i + 6).Text = \"Sat\" Then\n       For k = 1 To 100\n        xlSheet.Cells(4 + k, i + 6).Interior.ColorIndex = 15\n        Next\n       End If\n    If xlSheet.Application.Cells(4, i + 6).Text = \"Sun\" Then\n        For k = 1 To 100\n        xlSheet.Cells(4 + k, i + 6).Interior.ColorIndex = 15\n       Next\n       End If\nNext\n\n'Merge date cells\n\nFor i = 0 To pjDuration Step 7\n    xlSheet.Cells(3, i + 6).Select\n    xlSheet.Application.ActiveCell.Resize(1, 7).Select\n    With xlSheet.Application.Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    xlSheet.Application.Selection.Merge\nNext i    \n\n'Fill cells with Task information\nDim SearchString1 As String\nDim SearchString2 As String\nSearchString1 = \"Buyoffs/Service\"\nSearchString2 = \"History\"\n\n**For Each t In ActiveSelection.Tasks\n    xlSheet.Cells(t.ID + 4, 1).Value = t.ID\n    xlSheet.Cells(t.ID + 4, 2).Value = t.Name\n    xlSheet.Cells(t.ID + 4, 3).Value = t.ResourceNames\n    xlSheet.Cells(t.ID + 4, 4).Value = t.Start\n    xlSheet.Cells(t.ID + 4, 4).NumberFormat = \"[$-409]mm-dd-yy;@\"\n    xlSheet.Cells(t.ID + 4, 5).Value = t.Finish\n    xlSheet.Cells(t.ID + 4, 5).NumberFormat = \"[$-409]mm-dd-yy;@\"**\n\n'Loop to color cells to mimic Gantt chart\n    For i = 5 To pjDuration + 5\n        If t.Start &lt;= xlSheet.Cells(4, i + 1) And t.Finish &gt;= xlSheet.Cells(4, i + 1) Then\n            xlSheet.Cells(t.ID + 4, i + 1).Interior.ColorIndex = 37\n            With xlSheet.Cells(t.ID + 4, i + 1).Borders(xlEdgeBottom)\n            .LineStyle = xlContinuous\n            .ThemeColor = 1\n            .TintAndShade = 0\n            .Weight = xlThin\n    End With\n        End If\n     Next i\nNext t\n\n'Loop To Change Day Headers to Single Char Format\nFor i = 0 To pjDuration\n With xlSheet.Cells(4, i + 6)\n        If .Text = \"Sun\" Then\n            .Value = \"S\"\n        ElseIf .Text = \"Mon\" Then\n            .Value = \"M\"\n        ElseIf .Text = \"Tue\" Then\n            .Value = \"T\"\n        ElseIf .Text = \"Wed\" Then\n            .Value = \"W\"\n        ElseIf .Text = \"Thu\" Then\n            .Value = \"R\"\n        ElseIf .Text = \"Fri\" Then\n            .Value = \"F\"\n        ElseIf .Text = \"Sat\" Then\n            .Value = \"S\"\n        End If\n    End With\n xlSheet.Cells(4, i + 6).ColumnWidth = 1.5\nNext\n\n'Remove empty rows\n\nxlSheet.Range(\"A5:A10000\").AutoFilter 1, \"&lt;&gt;\", , , False\n\n'Autofit Columns\nxlSheet.Columns(\"B:E\").AutoFit\nxlSheet.Columns(\"B:B\").Select\n    With xlSheet.Application.Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    xlSheet.Application.Selection.ColumnWidth = 50\n    With xlSheet.Application.Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With    \n\n'Format Cells with Borders\n    xlSheet.Rows(\"4:4\").Select\n    xlSheet.Application.Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlEdgeLeft).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlEdgeTop).LineStyle = xlNone\n    With xlSheet.Application.Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    xlSheet.Application.Selection.Borders(xlEdgeRight).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlInsideVertical).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n    xlSheet.Columns(\"E:E\").Select\n    xlSheet.Application.Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlEdgeLeft).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlEdgeTop).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlEdgeBottom).LineStyle = xlNone\n    With xlSheet.Application.Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    xlSheet.Application.Selection.Borders(xlInsideVertical).LineStyle = xlNone\n    xlSheet.Range(\"F4:CR4\").Select\n    With xlSheet.Application.Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    xlSheet.Application.Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    xlSheet.Application.Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With xlSheet.Application.Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    xlSheet.Application.Selection.Borders(xlEdgeTop).LineStyle = xlNone\n    With xlSheet.Application.Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With xlSheet.Application.Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With xlSheet.Application.Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    xlSheet.Application.Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n\nxlApp.Visible = True\nxlBook.Save\nxlSheet.Application.DisplayAlerts = True\nxlSheet.Application.ScreenUpdating = True\nxlSheet.Application.ActiveWindow.Zoom = 100\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1502732418, "post_id": 37711112, "comment_id": 78317725, "body": "WSH JScript global object type is <code>JScriptTypeInfo</code> (that is global <code>this</code> object in other words). BTW, VBScript has the same global object <code>Me</code> of type <code>VBScriptTypeInfo</code>, and it allows dynamically create procedures, functions, classes, and even classes within functions."}], "answers": [{"comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493458944, "post_id": 37711113, "comment_id": 74433631, "body": "Is the type <code>JScriptTypeInfo </code> really defined in <code>JScript.dll</code>? When I opened this dll in OLEVIEW no such type is defined there."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493662500, "post_id": 37711113, "comment_id": 74491909, "body": "@dee: Thanks for question. I think ITypeInfo is a key COM interface <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221442(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> and is relevant not just to type libraries but also exported from IDispatch <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221571(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> Javascript is dynamic and so it would make sense not to place so much in a static type library as members of an object are created &#39;on the fly&#39;.  Perhaps I will revisit text of the answer but I am revisiting COM interfaces at the moment and so will be better place soon to give an updated answer."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493712279, "post_id": 37711113, "comment_id": 74509009, "body": "OK, thank you! The type <code>JScriptTypeInfo</code> is a little mysterious, I was not able to find any reasonable information about it except this answer."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1502203034, "post_id": 37711113, "comment_id": 78101865, "body": "Cool stuff here! One thing to note is that the ability to create a ScriptControl COM object is limited to 32-Bit using <code>CreateObject(&quot;ScriptControl&quot;)</code>. Instead you need to use <a href=\"https://stackoverflow.com/a/38134477/6302131\">mshta x86 host</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1502203250, "post_id": 37711113, "comment_id": 78102024, "body": "@Sancarn: I&#39;m using 64-bit no problem."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1502203970, "post_id": 37711113, "comment_id": 78102616, "body": "@SMeaden I am uncertain how because as Wolfgang Kuehn said in the other forum, scriptcontrol is a 32bit component only and will not run inside a 64bit process. I&#39;ve experienced this issue many times in the past, and thus have always avoided script control. Didn&#39;t know there was this work around though."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1502204721, "post_id": 37711113, "comment_id": 78103235, "body": "@Sancarn: It&#39;s an old problem, there was a 16 vs 32 bit issue twenty years ago <a href=\"https://en.wikipedia.org/wiki/Windows_on_Windows\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Windows_on_Windows</a> and same solution is there for 32 vs 64 bit, <a href=\"https://en.wikipedia.org/wiki/WoW64#Registry_and_file_system\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/WoW64#Registry_and_file_system</a> .  Look for Wow6432Node in your registry."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 6, "last_activity_date": 1465413614, "creation_date": 1465413614, "answer_id": 37711113, "question_id": 37711112, "link": "https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo/37711113#37711113", "title": "In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?", "body": "<p>One possible place to look is in the type library for the ScriptControl as this is the library which emanates this type.</p>\n\n<p>The full details of this type on my machine are </p>\n\n<pre><code>Libary Name:    Microsoft Script Control 1.0 (Ver 1.0)       \nLIBID:          {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}\nLocation:       C:\\wINDOWS\\SysWOW64\\msscript.ocx \n</code></pre>\n\n<p>Using both VBA IDE's Object Browser and OLEVIEW.exe which disassembles type library I can no trace of the interface JScriptTypeInfo or the method hasOwnProperty.</p>\n\n<p>But isn't it the case that the script engine hosts language implementations, such as VBScript and JScript (Microsoft name for Javascript).<br>\nSo perhaps we should hunt for a JScript implementation DLL and indeed there is one here are details</p>\n\n<pre><code>Libary Name:    Microsoft JScript Globals\nLIBID:          {3EEF9759-35FC-11D1-8CE4-00C04FC2B085}\nLocation:       C:\\wINDOWS\\SysWOW64\\jscript.dll \n</code></pre>\n\n<p>which on my machine is not registered and so not in my list of Tools->References libraries or in OLEVIEW.exe.  I was lucky to find whilst poking around.<br>\nHere is some output from OLEVIEW giving an exceprt of the type library</p>\n\n<pre><code>[\n  uuid(3EEF9758-35FC-11D1-8CE4-00C04FC2B097)\n]\ndispinterface ObjectInstance {\n    properties:\n    methods:\n        [id(0x0000044c)]\n        StringInstance* toString();\n        [id(0x0000044d)]\n        StringInstance* toLocaleString();\n        [id(0x0000044e)]\n        VARIANT hasOwnProperty(VARIANT propertyName);\n        [id(0x0000044f)]\n        VARIANT propertyIsEnumerable(VARIANT propertyName);\n        [id(0x00000450)]\n        VARIANT isPrototypeOf(VARIANT obj);\n        [id(0x00000451)]\n        ObjectInstance* valueOf();\n};\n</code></pre>\n\n<p>This above shows the hasOwnProperty to be a method of a IDispatch interface (or dispinterface) necessary to work with VBA object's declared of type Object (e.g. <code>Dim foo as Object</code>)\nRegistering the type library with regsvr32 appears to do nothing.  One must browse to the file in Tools References to view in VBA's object browser.</p>\n\n<p>We can be pretty sure about this JScript.dll file because using Process Explorer we can see the dll being loaded when executing the line <code>oScriptEngine.Language = \"JScript\"</code>\nIn the lack of a registered type library I loaded the file JScript.dll into Notepad++ and searched for .J.S.c.r.i.p.t.T.y.p.e.I.n.f.o as a regular expression and found a hit.  Bingo!</p>\n\n<p>Not only is there an ObjectInstance which would describe most of the variables a VBA program encounters but also there is an ArrayInstance which is intriguing, perhaps we can use Javascript's own array functions\nor at least a subset as documented in JScript.dll's type library.  Here is some sample code</p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\n'and FYI/browsing capabilities       Microsoft JScript Globals;   C:\\wINDOWS\\SysWOW64\\jscript.dll\n\nOption Explicit\n\nPrivate Sub TestJSONParsingWithCallByName5()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = \"JScript\"\n\n    Dim sJsonString(0 To 1) As String\n    sJsonString(0) = \"{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }\"\n    sJsonString(1) = \"[ 1234, 2345, 3456, 4567, 5678, 6789 ]\"\n\n\n\n    Dim objJSON(0 To 1) As Object\n    Set objJSON(0) = oScriptEngine.Eval(\"(\" + sJsonString(0) + \")\")\n    Set objJSON(1) = oScriptEngine.Eval(\"(\" + sJsonString(1) + \")\")\n\n    Debug.Assert objJSON(0).hasOwnProperty(\"key1\")\n    Debug.Assert objJSON(0).hasOwnProperty(\"key2\")\n\n    Debug.Assert CallByName(objJSON(1), \"length\", VbGet) = 6\n    Debug.Assert CallByName(objJSON(1), \"0\", VbGet) = \"1234\"\n\n    '* Is objJSON(1) an ArrayInstance?\n    '* does it support the reverse method of the ArrayInstance object?\n\n    'Call objJSON(1).Reverse  '* reverse gets capitalised into Reverse ... grrrr\n    Call CallByName(objJSON(1), \"reverse\", VbMethod) '* so use CallByName as solution to \"helpful\" capitalisation\n\n    '* Yes, the elements are reversed!\n\n    Debug.Assert CallByName(objJSON(1), \"length\", VbGet) = 6\n    Debug.Assert CallByName(objJSON(1), \"0\", VbGet) = \"6789\"\n\n    Stop\n\n    '** And now we know objJSON(1) is an ArrayInstance we can have some fun with array operations\n\n    Dim objSplice As Object\n    Set objSplice = CallByName(objJSON(1), \"splice\", VbMethod, 2, 1)\n    Debug.Assert CallByName(objJSON(1), \"length\", VbGet) = 5\n    Debug.Assert CallByName(objSplice, \"length\", VbGet) = 1\n\n    Dim objSlice As Object\n    Set objSlice = CallByName(objJSON(1), \"slice\", VbMethod, 2)\n    Debug.Assert CallByName(objJSON(1), \"length\", VbGet) = 5\n    Debug.Assert CallByName(objSlice, \"length\", VbGet) = 3\n\n    Stop\n    Call CallByName(objJSON(1), \"sort\", VbMethod)\n\n\n    Debug.Assert CallByName(objJSON(1), \"join\", VbMethod) = \"1234,2345,3456,5678,6789\"\n    Debug.Assert CallByName(objJSON(1), \"join\", VbMethod, \" \") = \"1234 2345 3456 5678 6789\"\n    Stop\n\n\n    Debug.Assert CallByName(objJSON(1), \"pop\", VbMethod) = \"6789\"\n    Debug.Assert CallByName(objJSON(1), \"length\", VbGet) = 4\n    Stop\nEnd Sub\n</code></pre>\n\n<p>SUMMARY: JScriptTypeInfo is something to show in the VBA IDE watch window and the return of the VBA function TypeName() but which really hides a number of objects that can be found in JScript.dll.<br>\nI suppose it can be described as polymorphic, perhaps better to describe it as late binding.  To view capabilities use Tools-References and browse to JScript.dll.</p>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2187, "favorite_count": 1, "accepted_answer_id": 37711113, "answer_count": 1, "score": 4, "last_activity_date": 1465744455, "creation_date": 1465413614, "last_edit_date": 1610973576, "question_id": 37711112, "link": "https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo", "title": "In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?", "body": "<p>answering my own question here.<br />\nI have done some work with JSON in Excel VBA and lots of findings to post which I will do so in Q &amp; A format\n<a href=\"https://stackoverflow.com/help/self-answer\">https://stackoverflow.com/help/self-answer</a> <a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/</a></p>\n<p>So elsewhere on stackoverflow one can see questions about parsing JSON in VBA but they seem to miss a trick or two.</p>\n<p>To begin with, I resile from using custom JSON parsing libraries and instead use the ScriptControl's Eval method as the basis of all my JSON code.\nAnd also we express a preference from native Microsoft solutions.</p>\n<p>Here is a prior question <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a> upon which this question builds.  It shows how using VBA.CallByName is more robust\nthan using the dot syntax to traverse a parsed JSON object.  Also another prior question <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a> shows how it also can\nbe used to access array elements.  But CallByName returns a curious variable type that appears in Watch window as Object/JScriptTypeInfo\nand if one type Debug.Print in the immediate window (or hovers over the variable) one gets the uninformative &quot;[object Object]&quot;.  In another question\nin the series <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a> I present some debugging &quot;sugar&quot; that allows nice inspection of variables.   In a fourth question <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a>, whilst investigating\nhow to query a JSON object for a member I discover a hasOwnProperty() method that seems attached to a JScriptTypeInfo object.</p>\n<p>So in this question I ask, what exactly is this JScriptTypeInfo anyway?</p>\n<p>This is Question 5 of series of 5.  Here is the full series</p>\n<p>Q1 <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a></p>\n<p>Q2 <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a></p>\n<p>Q3 <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a></p>\n<p>Q4 <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a></p>\n<p>Q5 <a href=\"https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo\">In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?</a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1465425773, "post_id": 37711104, "comment_id": 62901813, "body": "If the data is stored in a table, use a continuous form bound to the table. Every time you complete a line, a new one is created. If the data should not be stored in a table, it&#39; a bit more complicated."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5438532"}, "is_accepted": true, "score": 0, "last_activity_date": 1465492875, "creation_date": 1465492875, "answer_id": 37732471, "question_id": 37711104, "link": "https://stackoverflow.com/questions/37711104/adding-multiple-textboxes-to-a-form-in-ms-access/37732471#37732471", "title": "Adding multiple textboxes to a form in ms-access?", "body": "<p>\"If the data should not be stored in a table, it' a bit more complicated. \"\nYou would have to make the text boxes not visible when the form loads, and then make each text box visible on the After Update event of the previous box. </p>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 37732471, "answer_count": 1, "score": 0, "last_activity_date": 1594022591, "creation_date": 1465413570, "last_edit_date": 1594022591, "question_id": 37711104, "link": "https://stackoverflow.com/questions/37711104/adding-multiple-textboxes-to-a-form-in-ms-access", "title": "Adding multiple textboxes to a form in ms-access?", "body": "<p>I would like to have a line on an <strong>Access</strong> <strong>user-form</strong>. Call it <code>Item #1</code>. I would like <code>Item #1</code> to be a text box where the user can enter any type of information. So for example, say the user entered \"Tutoring\" and then next to this was an additional <code>Textbox</code> that allowed the user to enter the hours spent tutoring and the date in which the hours were logged.</p>\n\n<p>What I would like is to have a <code>button</code> to allow the user to add a second line (or set of <code>textboxes</code>) when needed, or a third line, etc. Is this something that can be set up on the <strong>Access</strong> form? Does this need to be coded in <strong>VBA</strong>? Just looking for some tips to provide me some direction on the best approach.</p>\n"}, {"tags": ["json", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 1384513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNokf.jpg?s=128&g=1", "display_name": "hamish", "link": "https://stackoverflow.com/users/1384513/hamish"}, "edited": false, "score": 0, "creation_date": 1542717601, "post_id": 37711101, "comment_id": 93661622, "body": "perfect for Json check it exists before using it . thank you.              If Movie.hasOwnProperty(&quot;Error&quot;) Then                 MovieError = Movie.Error             End If"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 2, "last_activity_date": 1465413550, "creation_date": 1465413550, "answer_id": 37711101, "question_id": 37711100, "link": "https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj/37711101#37711101", "title": "In Windows Excel VBA,how to get JSON keys to pre-empt &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;?", "body": "<p>Answers to other stack overflow question that relate to working with parsed JSON objects use a mini-script approach and we can use this approach here.\nIf we say we are running a Microsoft Windows edition of Excel VBA then we can use the Scripting Dictionary as found in the library <code>Microsoft Scripting Runtime</code>.</p>\n\n<p>We can create the Scripting.Dictionary in the Javascript, populate it with the keys of JSON object and also use the values as references to the subelements, \nand finallly pass back to VBA.  In VBA, one can then use the Dictionary's Exists method to defend against missing keys.  One can use the Dictionary's Count method \nto dimension other downstream variables.  One can even use Dictionary's Item method to retrieve a subelement (one level down only).</p>\n\n<p>Thus,</p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Scripting Runtime\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nOption Explicit\n\nPrivate Function GetScriptEngine() As ScriptControl\n    Static soScriptEngine As ScriptControl\n    If soScriptEngine Is Nothing Then\n        Set soScriptEngine = New ScriptControl\n        soScriptEngine.Language = \"JScript\"\n\n        soScriptEngine.AddCode \"function getKeyValues(jsonObj) { \" &amp; _\n                              \" var dictionary = new ActiveXObject(\"\"Scripting.Dictionary\"\"); \" &amp; _\n                              \" var keys = new Array(); for (var i in jsonObj) { dictionary.add(i,jsonObj[i]); }; return dictionary; } \"\n\n\n    End If\n    Set GetScriptEngine = soScriptEngine\nEnd Function\n\n\nPrivate Sub TestJSONParsingWithCallByName3()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = GetScriptEngine\n\n    Dim sJsonString As String\n    sJsonString = \"{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }\"\n\n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(\"(\" + sJsonString + \")\")\n\n    Dim dicKeys As Scripting.Dictionary\n    Set dicKeys = oScriptEngine.Run(\"getKeyValues\", objJSON)\n\n    Debug.Assert dicKeys.Count = 2\n\n    Debug.Assert TypeName(dicKeys.Item(dicKeys.Keys()(1))) = \"JScriptTypeInfo\"\n    Stop\n\n    If dicKeys.Exists(\"foobarbaz\") Then\n\n        '*** Next line WOULD throw \"Run-time error '438': Object doesn't support this property or method\" because \"foobarbaz\" is not a key\n        '*** but is skipped because of defensive code.\n        Debug.Assert VBA.CallByName(objJSON, \"foobarbaz\", VbGet)\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>However, I have also discovered a wonderful alternative that requires no miniscript or Scripting.Dictionary.  It will allow pre-empting of missing keys but\nhas no collection class functionality.  It uses a little known property of hasOwnProperty().   Thus,</p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nOption Explicit\n\nPrivate Sub TestJSONParsingWithCallByName4()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = \"JScript\"\n\n    Dim sJsonString As String\n    sJsonString = \"{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }\"\n\n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(\"(\" + sJsonString + \")\")\n\n    Debug.Assert objJSON.hasOwnProperty(\"key1\")\n    Debug.Assert objJSON.hasOwnProperty(\"key2\")\n\n    Dim objKey2 As Object\n    Set objKey2 = VBA.CallByName(objJSON, \"key2\", VbGet)\n\n    Debug.Assert objKey2.hasOwnProperty(\"key3\")\n\n\n    If objJSON.hasOwnProperty(\"foobarbaz\") Then\n\n        '*** Next line WOULD throw \"Run-time error '438': Object doesn't support this property or method\" because \"foobarbaz\" is not a key\n        '*** but is skipped because of defensive code.\n        Debug.Assert VBA.CallByName(objJSON, \"foobarbaz\", VbGet)\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 37711101, "answer_count": 1, "score": 2, "last_activity_date": 1465744869, "creation_date": 1465413550, "last_edit_date": 1610973576, "question_id": 37711100, "link": "https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj", "title": "In Windows Excel VBA,how to get JSON keys to pre-empt &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;?", "body": "<p>answering my own question here.<br />\nI have done some work with JSON in Excel VBA and lots of findings to post which I will do so in Q &amp; A format\n<a href=\"https://stackoverflow.com/help/self-answer\">https://stackoverflow.com/help/self-answer</a> <a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/</a></p>\n<p>So elsewhere on stackoverflow one can see questions about parsing JSON in VBA but they seem to miss a trick or two.</p>\n<p>To begin with, I resile from using custom JSON parsing libraries and instead use the ScriptControl's Eval method as the basis of all my JSON code.\nAnd also we express a preference from native Microsoft solutions.</p>\n<p>Here is a prior question <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a> upon which this question builds.  It shows how using VBA.CallByName is more robust\nthan using the dot syntax to traverse a parsed JSON object.  Also another prior question <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a> shows how it also can\nbe used to access array elements.  But CallByName returns a curious variable type that appears in Watch window as Object/JScriptTypeInfo\nand if one type Debug.Print in the immediate window (or hovers over the variable) one gets the uninformative &quot;[object Object]&quot;.  In another question\nin the series <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a> I present some debugging &quot;sugar&quot; that allows nice inspection of variables.</p>\n<p>In this question I ask how can we programmatically get a list of members with which I can detect presence of a key, this will help to\npre-empt any &quot;Run-time error '438': Object doesn't support this property or method&quot; errors and allow us to write defensive (hopefully &quot;bulletproof&quot;) code ?</p>\n<p>This is Question 4 of series of 5.  Here is the full series</p>\n<p>Q1 <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a></p>\n<p>Q2 <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a></p>\n<p>Q3 <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a></p>\n<p>Q4 <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a></p>\n<p>Q5 <a href=\"https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo\">In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?</a></p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1465414315, "post_id": 37711073, "comment_id": 62896449, "body": "There are lots of issues, so one big question would be inappropriate.  There are in fact five Q &amp; As"}], "answers": [{"comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1471546382, "post_id": 37711074, "comment_id": 65401868, "body": "Thank you for this Excel VBA / JSON mini-series -- I find it very useful as it is really hard to find good info on this topic on SO. There is now &quot;Documentation&quot; section on SO -- I suggest you post these over there as well. One idea that keeps crossing my mind -- is there a way to take JSON and convert or parse it into XML DOM that VBA supports natively? It then allows DOM to be used for convenient manipulation as well as XPath for query. Can this be done efficiently with this approach (i.e. may be even using JScript to convert JSON to XML)?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1471686299, "post_id": 37711074, "comment_id": 65454653, "body": "Thanks.  There is code to convert from JSON to Xml Dom <a href=\"http://stackoverflow.com/questions/1773550/convert-xml-to-json-and-back-using-javascript#answer-1773571\" title=\"convert xml to json and back using javascript%23answer 1773571\">stackoverflow.com/questions/1773550/&hellip;</a> but I could not get it to work with the Microsoft Script Control.  It will work with cscript.exe (which also facilitates debugging in Visual Studio) but that means shelling to another process."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 6, "last_activity_date": 1465413465, "creation_date": 1465413465, "answer_id": 37711074, "question_id": 37711073, "link": "https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of/37711074#37711074", "title": "In Excel VBA on Windows, how to get stringified JSON respresentation instead of &quot;[object Object]&quot; for parsed JSON variables?", "body": "<p>Answers to other stack overflow question that relate to working with parsed JSON objects use a mini-script approach and we can use this approach here.</p>\n\n<p>Firstly we acknowledge that Douglas Crockford is author of 'Javascript: The Good Parts' (<a href=\"http://shop.oreilly.com/product/9780596517748.do\" rel=\"noreferrer\">http://shop.oreilly.com/product/9780596517748.do</a>) \nand is javascript expert.  So we are happy to adopt his code with regard to stringification.  We can get his code with a simple Xml HTTP Request\n(commonly shortened to XHR) and pass the return result to ScriptControl's AddCode method.   Then add some code that allows us to override the default representation\nof \"[object Object]\" by calling into Douglas's library.  AND then make sure we dynamically add that override to all our JScriptTypeInfo variables, \nboth what comes out of ScriptControl's Eval method which we wrap with DecodeJsonString() \nand also what comes out of VBA.CallByName which we wrap with GetJSONObject().</p>\n\n<p>Thus,</p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n'Microsoft Xml, v6.0\n\nOption Explicit\n\nPrivate Function GetScriptEngine() As ScriptControl\n    Static soScriptEngine As ScriptControl\n    If soScriptEngine Is Nothing Then\n        Set soScriptEngine = New ScriptControl\n        soScriptEngine.Language = \"JScript\"\n\n        soScriptEngine.AddCode GetJavaScriptLibrary(\"https://raw.githubusercontent.com/douglascrockford/JSON-js/master/json2.js\")\n        soScriptEngine.AddCode \"function overrideToString(jsonObj) { jsonObj.toString = function() { return JSON.stringify(this); } }\"\n    End If\n    Set GetScriptEngine = soScriptEngine\nEnd Function\n\nPrivate Function GetJavaScriptLibrary(ByVal sURL As String) As String\n\n    Dim xHTTPRequest As MSXML2.XMLHTTP60\n    Set xHTTPRequest = New MSXML2.XMLHTTP60\n    xHTTPRequest.Open \"GET\", sURL, False\n    xHTTPRequest.send\n    GetJavaScriptLibrary = xHTTPRequest.responseText\n\nEnd Function\n\nPrivate Function DecodeJsonString(ByVal JsonString As String) As Object\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = GetScriptEngine\n\n    Set DecodeJsonString = oScriptEngine.Eval(\"(\" + JsonString + \")\")\n\n    Call oScriptEngine.Run(\"overrideToString\", DecodeJsonString) '* this gives JSON rendering instead of \"[object Object]\"\n\nEnd Function\n\nPrivate Function GetJSONObject(ByVal obj As Object, ByVal sKey As String) As Object\n    Dim objReturn As Object\n    Set objReturn = VBA.CallByName(obj, sKey, VbGet)\n    Call GetScriptEngine.Run(\"overrideToString\", objReturn) '* this gives JSON rendering instead of \"[object Object]\"\n    Set GetJSONObject = objReturn\nEnd Function\n\nPrivate Sub TestJSONParsingWithCallByName2()\n\n    Dim sJsonString As String\n    sJsonString = \"{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }\"\n\n\n    Dim objJSON As Object\n    Set objJSON = DecodeJsonString(sJsonString)\n\n    Stop\n\n\n    Dim objKey2 As Object\n    Set objKey2 = GetJSONObject(objJSON, \"key2\")\n    Debug.Print objKey2\n    Stop\n\nEnd Sub\n</code></pre>\n\n<p>Here is a screenshot with the new code which shows a stringification of the JScriptTypeInfo variables </p>\n\n<p><a href=\"https://i.stack.imgur.com/YhYrg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/YhYrg.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 821, "user_id": 509940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2aa7322047023fbc27affb1dd177c22?s=128&d=identicon&r=PG", "display_name": "Chris Strickland", "link": "https://stackoverflow.com/users/509940/chris-strickland"}, "edited": false, "score": 0, "creation_date": 1531769213, "post_id": 46825783, "comment_id": 89709949, "body": "Thx, this way I don&#39;t have to depend on that code to stay maintained."}], "tags": [], "owner": {"reputation": 51, "user_id": 5183070, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153400717140272/picture?type=large", "display_name": "Ali Hussain Al Khawaher", "link": "https://stackoverflow.com/users/5183070/ali-hussain-al-khawaher"}, "is_accepted": false, "score": 2, "last_activity_date": 1508402156, "creation_date": 1508402156, "answer_id": 46825783, "question_id": 37711073, "link": "https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of/46825783#46825783", "title": "In Excel VBA on Windows, how to get stringified JSON respresentation instead of &quot;[object Object]&quot; for parsed JSON variables?", "body": "<p>Thank you S Meaden, this is what I was looking for, a simple way to convert JSON object to string. I used your ideas and merged it with my code, but I did not like the idea of making a connection and downloading the script each time I needed to create a JSON object. so I compressed the JSON2.js code into a function and used it instead which I am pasting next maybe someone will like the idea too.</p>\n\n<pre><code>Private Function JSON2() As String\n    'https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\n    'https://raw.githubusercontent.com/douglascrockford/JSON-js/master/json2.js\n    JSON2 = _\n        \"if(typeof JSON!==\"\"object\"\"){JSON={};}\" _\n        &amp; \"(function(){\"\"use strict\"\";var rx_one=/^[\\],:{}\\s]*$/;var rx_two=/\\\\(?:[\"\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var rx_three=/\"\"[^\"\"\\\\\\n\\r]*\"\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g;var rx_four=/(?:^|:|,)(?:\\s*\\[)+/g;var rx_escapable=/[\\\\\"\"\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;var rx_dangerous=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;function f(n){return n&lt;10?\"\"0\"\"+n:n;}\" _\n        &amp; \"function this_value(){return this.valueOf();}\" _\n        &amp; \"if(typeof Date.prototype.toJSON!==\"\"function\"\"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+\"\"-\"\"+\" _\n        &amp; \"f(this.getUTCMonth()+1)+\"\"-\"\"+\" _\n        &amp; \"f(this.getUTCDate())+\"\"T\"\"+\" _\n        &amp; \"f(this.getUTCHours())+\"\":\"\"+\" _\n        &amp; \"f(this.getUTCMinutes())+\"\":\"\"+\" _\n        &amp; \"f(this.getUTCSeconds())+\"\"Z\"\":null;};Boolean.prototype.toJSON=this_value;Number.prototype.toJSON=this_value;String.prototype.toJSON=this_value;}\" _\n        &amp; \"var gap;var indent;var meta;var rep;function quote(string){rx_escapable.lastIndex=0;return rx_escapable.test(string)?\"\"\\\"\"\"\"+string.replace(rx_escapable,function(a){var c=meta[a];return typeof c===\"\"string\"\"?c:\"\"\\\\u\"\"+(\"\"0000\"\"+a.charCodeAt(0).toString(16)).slice(-4);})+\"\"\\\"\"\"\":\"\"\\\"\"\"\"+string+\"\"\\\"\"\"\";}\" _\n        &amp; \"function str(key,holder){var i;var k;var v;var length;var mind=gap;var partial;var value=holder[key];if(value&amp;&amp;typeof value===\"\"object\"\"&amp;&amp;typeof value.toJSON===\"\"function\"\"){value=value.toJSON(key);}\" _\n        &amp; \"if(typeof rep===\"\"function\"\"){value=rep.call(holder,key,value);}\"\n    JSON2 = JSON2 _\n        &amp; \"switch(typeof value){case\"\"string\"\":return quote(value);case\"\"number\"\":return isFinite(value)?String(value):\"\"null\"\";case\"\"boolean\"\":case\"\"null\"\":return String(value);case\"\"object\"\":if(!value){return\"\"null\"\";}\" _\n        &amp; \"gap+=indent;partial=[];if(Object.prototype.toString.apply(value)===\"\"[object Array]\"\"){length=value.length;for(i=0;i&lt;length;i+=1){partial[i]=str(i,value)||\"\"null\"\";}\" _\n        &amp; \"v=partial.length===0?\"\"[]\"\":gap?\"\"[\\n\"\"+gap+partial.join(\"\",\\n\"\"+gap)+\"\"\\n\"\"+mind+\"\"]\"\":\"\"[\"\"+partial.join(\"\",\"\")+\"\"]\"\";gap=mind;return v;}\" _\n        &amp; \"if(rep&amp;&amp;typeof rep===\"\"object\"\"){length=rep.length;for(i=0;i&lt;length;i+=1){if(typeof rep[i]===\"\"string\"\"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?\"\": \"\":\"\":\"\")+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?\"\": \"\":\"\":\"\")+v);}}}}\" _\n        &amp; \"v=partial.length===0?\"\"{}\"\":gap?\"\"{\\n\"\"+gap+partial.join(\"\",\\n\"\"+gap)+\"\"\\n\"\"+mind+\"\"}\"\":\"\"{\"\"+partial.join(\"\",\"\")+\"\"}\"\";gap=mind;return v;}}\" _\n        &amp; \"if(typeof JSON.stringify!==\"\"function\"\"){meta={\"\"\\b\"\":\"\"\\\\b\"\",\"\"\\t\"\":\"\"\\\\t\"\",\"\"\\n\"\":\"\"\\\\n\"\",\"\"\\f\"\":\"\"\\\\f\"\",\"\"\\r\"\":\"\"\\\\r\"\",\"\"\\\"\"\"\":\"\"\\\\\\\"\"\"\",\"\"\\\\\"\":\"\"\\\\\\\\\"\"};JSON.stringify=function(value,replacer,space){var i;gap=\"\"\"\";indent=\"\"\"\";if(typeof space===\"\"number\"\"){for(i=0;i&lt;space;i+=1){indent+=\"\" \"\";}}else if(typeof space===\"\"string\"\"){indent=space;}\" _\n        &amp; \"rep=replacer;if(replacer&amp;&amp;typeof replacer!==\"\"function\"\"&amp;&amp;(typeof replacer!==\"\"object\"\"||typeof replacer.length!==\"\"number\"\")){throw new Error(\"\"JSON.stringify\"\");}\" _\n        &amp; \"return str(\"\"\"\",{\"\"\"\":value});};}\" _\n        &amp; \"if(typeof JSON.parse!==\"\"function\"\"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k;var v;var value=holder[key];if(value&amp;&amp;typeof value===\"\"object\"\"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}\" _\n        &amp; \"return reviver.call(holder,key,value);}\" _\n        &amp; \"text=String(text);rx_dangerous.lastIndex=0;if(rx_dangerous.test(text)){text=text.replace(rx_dangerous,function(a){return\"\"\\\\u\"\"+\" _\n        &amp; \"(\"\"0000\"\"+a.charCodeAt(0).toString(16)).slice(-4);});}\" _\n        &amp; \"if(rx_one.test(text.replace(rx_two,\"\"@\"\").replace(rx_three,\"\"]\"\").replace(rx_four,\"\"\"\"))){j=eval(\"\"(\"\"+text+\"\")\"\");return(typeof reviver===\"\"function\"\")?walk({\"\"\"\":j},\"\"\"\"):j;}\" _\n        &amp; \"throw new SyntaxError(\"\"JSON.parse\"\");};}}());\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4177, "favorite_count": 3, "accepted_answer_id": 37711074, "answer_count": 2, "score": 6, "last_activity_date": 1508402156, "creation_date": 1465413465, "last_edit_date": 1610973576, "question_id": 37711073, "link": "https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of", "title": "In Excel VBA on Windows, how to get stringified JSON respresentation instead of &quot;[object Object]&quot; for parsed JSON variables?", "body": "<p>answering my own question here.<br />\nI have done some work with JSON in Excel VBA and lots of findings to post which I will do so in Q &amp; A format\n<a href=\"https://stackoverflow.com/help/self-answer\">https://stackoverflow.com/help/self-answer</a> <a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/</a></p>\n<p>So elsewhere on stackoverflow one can see questions about parsing JSON in VBA but they seem to miss a trick or two.</p>\n<p>To begin with, I resile from using custom JSON parsing libraries and instead use the ScriptControl's Eval method as the basis of all my JSON code.\nAnd also we express a preference from native Microsoft solutions.</p>\n<p>Here is a prior question <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a> upon which this question builds.  It shows how using VBA.CallByName is more robust\nthan using the dot syntax to traverse a parsed JSON object.  Also another prior question <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a> shows how it also can\nbe used to access array elements.  But CallByName returns a curious variable type that appears in Watch window as Object/JScriptTypeInfo\nand if one type Debug.Print in the immediate window (or hovers over the variable) one gets the uninformative &quot;[object Object]&quot;.</p>\n<p>How can we improve on this and get a JSON stringified represenation?</p>\n<p>Here is a screenshot of what you see in Immediate windows after a Debug.Print (?) and if you hover over a variable.</p>\n<p><a href=\"https://i.stack.imgur.com/owmwY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/owmwY.png\" alt=\"object Object\" /></a></p>\n<p>This is Question 3 of series of 5.  Here is the full series</p>\n<p>Q1 <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a></p>\n<p>Q2 <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a></p>\n<p>Q3 <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a></p>\n<p>Q4 <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a></p>\n<p>Q5 <a href=\"https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo\">In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?</a></p>\n"}, {"tags": ["json", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1465413348, "creation_date": 1465413348, "answer_id": 37711035, "question_id": 37711034, "link": "https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed/37711035#37711035", "title": "In Excel VBA on Windows, how to loop through a JSON array parsed?", "body": "<p>So VBA.CallByName also accesses elements in an array as well as find the array's length </p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub TestJSONParsingArrayWithCallByName()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = \"JScript\"\n\n    Dim sJsonString As String\n    sJsonString = \"[ 1234, 2345 ]\"\n\n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(\"(\" + sJsonString + \")\")\n\n    '* Using VBA.CallByName we get the length of the array\n\n    Dim lLength As Long\n    lLength = VBA.CallByName(objJSON, \"length\", VbGet)\n\n    Debug.Assert lLength = 2\n\n    '* Believe or not one uses \"0\",\"1\",.... with callbyname to get an element\n    Debug.Assert VBA.CallByName(objJSON, \"0\", VbGet) = 1234\n    Debug.Assert VBA.CallByName(objJSON, \"1\", VbGet) = 2345\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2301, "favorite_count": 0, "accepted_answer_id": 37711035, "answer_count": 1, "score": 0, "last_activity_date": 1465743439, "creation_date": 1465413348, "last_edit_date": 1610973576, "question_id": 37711034, "link": "https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed", "title": "In Excel VBA on Windows, how to loop through a JSON array parsed?", "body": "<p>answering my own question here.<br />\nI have done some work with JSON in Excel VBA and lots of findings to post which I will do so in Q &amp; A format\n<a href=\"https://stackoverflow.com/help/self-answer\">https://stackoverflow.com/help/self-answer</a> <a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/</a></p>\n<p>So elsewhere on stackoverflow one can see questions about parsing JSON in VBA but they seem to miss a trick or two.</p>\n<p>To begin with, I resile from using custom JSON parsing libraries and instead use the ScriptControl's Eval method as the basis of all my JSON code.\nAnd also we express a preference from native Microsoft solutions.</p>\n<p>Here is a prior question <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a> upon which this question builds.  It shows how using VBA.CallByName is more robust\nthan using the dot syntax to traverse a parsed JSON object.</p>\n<p>In this question it is asked how to traverse a parsed JSON array.  Firstly here is a miniscript approach\nwith a hat tip to ozmike  <a href=\"https://stackoverflow.com/users/334106/ozmike\">https://stackoverflow.com/users/334106/ozmike</a></p>\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub TestJSONParsingArrayWithMiniScript()\n    'Hat tip to ozmike  https://stackoverflow.com/users/334106/ozmike\n    'Based on https://stackoverflow.com/questions/5773683/excel-vba-parsed-json-object-loop#19359035\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = &quot;JScript&quot;\n    oScriptEngine.AddCode &quot;Object.prototype.myitem=function( i ) { return this[i] } ; &quot;\n    \n    Dim sJsonString As String\n    sJsonString = &quot;[ 1234, 2345 ]&quot;\n    \n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(&quot;(&quot; + sJsonString + &quot;)&quot;)\n    \n    Debug.Assert objJSON.myitem(0) = 1234\n    Debug.Assert objJSON.myitem(1) = 2345\n    \n\nEnd Sub\n</code></pre>\n<p>But believe it or not VBA.CallByName can be used natively not just to get an array's length but also access elements.  See answer.</p>\n<p>This is Question 2 of series of 5.  Here is the full series</p>\n<p>Q1 <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a></p>\n<p>Q2 <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a></p>\n<p>Q3 <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a></p>\n<p>Q4 <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a></p>\n<p>Q5 <a href=\"https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo\">In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?</a></p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1525292099, "post_id": 37710995, "comment_id": 87303855, "body": "<a href=\"http://exceldevelopmentplatform.blogspot.com/2018/05/vba-bang-syntax-part2-json-parsing.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/05/&hellip;</a> uses the bang syntax to solve this problem."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1465414084, "post_id": 37710996, "comment_id": 62896329, "body": "<code>Debug.Assert</code> calls shouldn&#39;t have side effects. You should extract the results into a local variable and assert in separate instructions, off these local variables. <code>Debug</code> calls should be treated as code that&#39;s only there, well, for debugging purposes; making them run your actual logic just isn&#39;t right."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465414228, "post_id": 37710996, "comment_id": 62896413, "body": "Thanks for looking. I use Debug.Asserts all the time to no ill effect."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465414284, "post_id": 37710996, "comment_id": 62896436, "body": "I&#39;m not saying not to use <code>Debug.Assert</code>. I&#39;m saying you should be able to completely remove <code>Debug.Assert</code> calls from your code without altering its behavior in any way."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465414389, "post_id": 37710996, "comment_id": 62896486, "body": "Ok, I agree one removes them before going to production.  Normally they sit in my test scripts and not in the main code.  I use them here so the reader can see the value of the expressions."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465414794, "post_id": 37710996, "comment_id": 62896703, "body": "I think it would be a pretty nice and welcome contribution to <a href=\"https://codereview.stackexchange.com\">Code Review</a> if you assembled your whole JSON-parsing solution into a CR post (the VBA tag over there has a number of similar &quot;public knowledge&quot; posts) - if you&#39;re open to receive feedback on any &amp; all aspects of your working code anyway (that&#39;s what CR answers do). Got a CR account?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465414981, "post_id": 37710996, "comment_id": 62896789, "body": "I have just now joined.  The whole solution was in fact in response to some Google Maps API stack overflow question.  I spent today breaking my findings into 5 question because I think they are interesting in their own separate ways.  Do I go Ask Question in CodeReview and post the google maps solution?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1465415182, "post_id": 37710996, "comment_id": 62896906, "body": "Take a look at <a href=\"http://meta.codereview.stackexchange.com/q/2436/23788\">how to get the best value of Code Review</a>, and <a href=\"http://meta.codereview.stackexchange.com/a/6429/23788\">Simon&#39;s checklist for writing a good Code Review question</a> - that and of course the site&#39;s <a href=\"http://www.codereview.stackexchange.com/help/on-topic\" rel=\"nofollow noreferrer\">help center</a> should answer most if not all of your questions. Also feel free to hop into <a href=\"http://chat.stackexchange.com/rooms/8595/the-2nd-monitor\">The 2nd Monitor</a> if you want to chat about the site and/or meet the regulars! =)"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 2, "last_activity_date": 1465413191, "creation_date": 1465413191, "answer_id": 37710996, "question_id": 37710995, "link": "https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed/37710996#37710996", "title": "In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE&#39;s capitalisation behaviour?", "body": "<p>In the end I progressed with the following which uses the native VBA.CallByName</p>\n\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub TestJSONParsingWithCallByName()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = \"JScript\"\n\n    Dim sJsonString As String\n    sJsonString = \"{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }\"\n\n\n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(\"(\" + sJsonString + \")\")\n    Debug.Assert VBA.CallByName(objJSON, \"key1\", VbGet) = \"value1\"\n    Debug.Assert VBA.CallByName(VBA.CallByName(objJSON, \"key2\", VbGet), \"key3\", VbGet) = \"value3\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 37710996, "answer_count": 1, "score": 2, "last_activity_date": 1465743547, "creation_date": 1465413191, "last_edit_date": 1610973576, "question_id": 37710995, "link": "https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed", "title": "In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE&#39;s capitalisation behaviour?", "body": "<p>In Excel VBA on Windows, how to mitigate problem of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</p>\n<p>Hi, answering my own question here.  I have done some work with JSON in Excel VBA and lots of findings to post which I will do so in Q &amp; A format\n<a href=\"https://stackoverflow.com/help/self-answer\">https://stackoverflow.com/help/self-answer</a> <a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/</a></p>\n<p>So elsewhere on stackoverflow one can see questions about parsing JSON in VBA but they seem to miss a trick or two.</p>\n<p>To begin with, I resile from using custom JSON parsing libraries and instead use the ScriptControl's Eval method as the basis of all my JSON code.\nAnd also we express a preference from native Microsoft solutions.</p>\n<p>In this first question I will show that in Excel VBA one can in fact use the dot syntax to traverse a JSON structure but that unfortunately this is\nbroken by the VBA IDE's &quot;helpfulness&quot; with regards to capitalisation.</p>\n<p>Below is some sample code where on the line labelled 1: we can see the text &quot;objJSON.key1&quot; and this code works until one uncomments</p>\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nOption Explicit\nOption Private Module\n\nPrivate Sub TestJSONParsingWithVBACallByName()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = &quot;JScript&quot;\n    \n    Dim sJsonString As String\n    sJsonString = &quot;{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }&quot;\n    \n    \n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(&quot;(&quot; + sJsonString + &quot;)&quot;)\n1:  Debug.Assert objJSON.key1 = &quot;value1&quot;\n    Debug.Assert objJSON.key2.key3 = &quot;value3&quot;\n    \n    '**** BUT IF UNCOMMENT NEXT LINE THIS AFFECTS ALL CAPITALISATION INSTANCES OF KEY1 INCLUDING LINE 1 WHICH THENCE BREAKS\n2:  'Dim Key1 as Long\n\nEnd Sub\n</code></pre>\n<p>Here is a screenshot before\n<a href=\"https://i.stack.imgur.com/3zbkz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3zbkz.png\" alt=\"BeforeUncommentedAnnotated\" /></a>\nAnd after uncommenting Line 2 then Line1 is rewritten with the symbol 'key1' now given a capital 'K'.</p>\n<p><a href=\"https://i.stack.imgur.com/pFzwo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pFzwo.png\" alt=\"AfterCommentedAnnoted\" /></a></p>\n<p>Now after some experimenting it seems that rewriting effect is limited to project scope, so other projects are not affected.\nThis means one could isolate the issue by always using a separate project but then how would one marshall the object to the consuming project and\nthence access it, surely one hits the same issue again.  So, project isolation is not really a solution.</p>\n<p>One way is to ensure that the symbols do not clash and give the JSON keys some kind of prefix so here is an example</p>\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub TestJSONParsingWithDotSyntaxAndKeyPrefixesToAvoidNameClash()\n\n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = &quot;JScript&quot;\n    \n    Dim sJsonString As String\n    sJsonString = &quot;{'kKey1': 'value1'  ,'kKey2': { 'kKey3': 'value3' } }&quot;\n    \n    \n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(&quot;(&quot; + sJsonString + &quot;)&quot;)\n1:  Debug.Assert objJSON.kKey1 = &quot;value1&quot;\n    Debug.Assert objJSON.kKey2.kKey3 = &quot;value3&quot;\n    \n    '**** SAFE TO UNCOMMENT AS SYMBOLS DO NOT CLASH NOW\n2:  'Dim Key1 As Long\nEnd Sub\n</code></pre>\n<p>Somehow I do not like this, seems odd to have to change the JSON just so that VBA can access it.  Besides, one may not have control of the source JSON.</p>\n<p>There are other methods such as adding some javscript to the script engine to allow Javascript to do the accessing.  With a hat-tip to user Codo <a href=\"https://stackoverflow.com/users/413337/codo\">https://stackoverflow.com/users/413337/codo</a> here is a sample based on this approach...</p>\n<pre><code>'Tools-&gt;References-&gt;\n'Microsoft Script Control 1.0;  {0E59F1D2-1FBE-11D0-8FF2-00A0D10038BC}; C:\\Windows\\SysWOW64\\msscript.ocx\n\nPrivate Sub TestJSONParsingWithMiniScript()\n    'hat tip to Codo https://stackoverflow.com/users/413337/codo\n    'Based on https://stackoverflow.com/questions/5773683/excel-vba-parsed-json-object-loop#7300963  \n    Dim oScriptEngine As ScriptControl\n    Set oScriptEngine = New ScriptControl\n    oScriptEngine.Language = &quot;JScript&quot;\n    oScriptEngine.AddCode &quot;function getProperty(jsonObj, propertyName) { return jsonObj[propertyName]; } &quot;\n\n\n    Dim sJsonString As String\n    sJsonString = &quot;{'key1': 'value1'  ,'key2': { 'key3': 'value3' } }&quot;\n    \n    Dim objJSON As Object\n    Set objJSON = oScriptEngine.Eval(&quot;(&quot; + sJsonString + &quot;)&quot;)\n    Debug.Assert oScriptEngine.Run(&quot;getProperty&quot;, objJSON, &quot;key1&quot;) = &quot;value1&quot;\n    Debug.Assert oScriptEngine.Run(&quot;getProperty&quot;, oScriptEngine.Run(&quot;getProperty&quot;, objJSON, &quot;key2&quot;), &quot;key3&quot;) = &quot;value3&quot;\n\nEnd Sub\n</code></pre>\n<p>I like the technique of adding a script to the script engine however, I discovered a more native technique and that is to use VBA.CallByName\nand this is the technique shown in my answer.</p>\n<p>I have not selected my own answer as definitive because I think\n(1) it seems the community can continue to improve our knowledge on JSON parsing in Excel VBA and\n(2) if someone discovers how to stop the capitalisation then that is an obvious winner.</p>\n<p>This is Question 1 of series of 5.  Here is the full series</p>\n<p>Q1 <a href=\"https://stackoverflow.com/questions/37710995/in-excel-vba-on-windows-how-to-mitigate-issue-of-dot-syntax-traversal-of-parsed\">In Excel VBA on Windows, how to mitigate issue of dot syntax traversal of parsed JSON broken by IDE's capitalisation behaviour?</a></p>\n<p>Q2 <a href=\"https://stackoverflow.com/questions/37711034/in-excel-vba-on-windows-how-to-loop-through-a-json-array-parsed\">In Excel VBA on Windows, how to loop through a JSON array parsed?</a></p>\n<p>Q3 <a href=\"https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\">In Excel VBA on Windows, how to get stringified JSON respresentation instead of \u201c[object Object]\u201d for parsed JSON variables?</a></p>\n<p>Q4 <a href=\"https://stackoverflow.com/questions/37711100/in-windows-excel-vba-how-to-get-json-keys-to-pre-empt-run-time-error-438-obj\">In Windows Excel VBA,how to get JSON keys to pre-empt \u201cRun-time error '438': Object doesn't support this property or method\u201d?</a></p>\n<p>Q5 <a href=\"https://stackoverflow.com/questions/37711112/in-excel-vba-on-windows-for-parsed-json-variables-what-is-this-jscripttypeinfo\">In Excel VBA on Windows, for parsed JSON variables what is this JScriptTypeInfo anyway?</a></p>\n"}, {"tags": ["vba", "forms", "ms-access", "controls", "instance"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465420236, "post_id": 37710986, "comment_id": 62899579, "body": "What is the code you&#39;ve tried?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1465460052, "creation_date": 1465460052, "answer_id": 37720356, "question_id": 37710986, "link": "https://stackoverflow.com/questions/37710986/access-2007-vba-multiple-instances-of-form-update-controls-on-specific-inst/37720356#37720356", "title": "Access 2007 / VBA - Multiple Instances of Form, Update controls on specific instance from Module", "body": "<p>Pass a reference to the calling form:</p>\n\n<pre><code>Result = MyExternalFunction(Me)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Public Function MyExternalFunction(ByRef frm As Form) As Boolean\n\n    ' Do stuff with object frm.\n\n    MyExternalFunction = Result\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 2241716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd8f6baa522fb08319dfb5a8adcc979?s=128&d=identicon&r=PG&f=1", "display_name": "GeekInOhio", "link": "https://stackoverflow.com/users/2241716/geekinohio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 37720356, "answer_count": 1, "score": 0, "last_activity_date": 1594460588, "creation_date": 1465413158, "last_edit_date": 1594460588, "question_id": 37710986, "link": "https://stackoverflow.com/questions/37710986/access-2007-vba-multiple-instances-of-form-update-controls-on-specific-inst", "title": "Access 2007 / VBA - Multiple Instances of Form, Update controls on specific instance from Module", "body": "<p>I am using Allen Browne's method for creating and managing multiple instances of a form. I am stuck on how to reference controls or properties on a specific instance of the form from a VBA Module. Here is how I open a new instance:</p>\n\n<pre><code>'Purpose:    Open an independent instance of form frmMasterRecord.\nDim frm As Form\n\n'Housekeeping\nmyFilter = Trim(\"\" &amp; myFilter)\n\n'Open a new instance, show it, and set a caption.\nSet frm = New Form_frmMasterRecord\nfrm.ServerFilter = myFilter\nfrm.ServerFilterByForm = True\nfrm.Requery\nfrm.Visible = True\n\n'Append it to our collection.\nclnMasterRecord.Add Item:=frm, Key:=CStr(frm.hwnd)\n\nSet frm = Nothing\n</code></pre>\n\n<p>Assume I have three instances of the frmMasterRecord open. How do I call a sub/function in a Module and have it manipulate controls only on the calling instance of the form?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465412766, "post_id": 37710817, "comment_id": 62895637, "body": "Error On which line ?"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465412894, "post_id": 37710817, "comment_id": 62895718, "body": "I&#39;m assuming it&#39;s somewhere in the CheckInputs() function, but nothing specifically is showing up in the debugger. When all the input fields are empty, it happily accepts the upload, but when I have them all filled in (the way they&#39;re supposed to be), I get this error."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1465413083, "post_id": 37710817, "comment_id": 62895811, "body": "Add a break point on &quot;If Me.SANumber.Value or....&quot;.  When the code pauses, check the value of all of those fields in the Immediate window and see if any give you specific errors.  If they do, that info would be helpful for us to diagnose the issue."}], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465413234, "post_id": 37710926, "comment_id": 62895897, "body": "I just changed it to: Me.SANumber.value = Null Or Me.SerialNumber.value = Null Or Me.CustomerName.value = Null Or Me.LyoSize.value = Null ... I no longer get the error now, but the code totally glances over the function (it still accepts the import if none of the values are filled in)"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465413698, "post_id": 37710926, "comment_id": 62896136, "body": "This works perfectly. Was the issue maybe because I had Me.*.value ? I also changed the function name. Thank you!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 1, "creation_date": 1465415708, "post_id": 37710926, "comment_id": 62897208, "body": "Your code only tested the <i>last</i> field for Null - all of the other fields were just effectively tested for &quot;truthiness&quot; (I&#39;m not that familiar with Access so I couldn&#39;t say exactly what that would mean in practice)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1465412946, "creation_date": 1465412946, "answer_id": 37710926, "question_id": 37710817, "link": "https://stackoverflow.com/questions/37710817/make-all-fields-mandatory-to-be-filled-in/37710926#37710926", "title": "Make all fields mandatory to be filled in", "body": "<p>You need to specifically check each field for null - you cannot do it this way:</p>\n\n<pre><code>If Me.SANumber.value Or Me.SerialNumber.value Or _\n   Me.CustomerName.value Or Me.LyoSize.value = Null Then\n</code></pre>\n\n<p>Something like</p>\n\n<pre><code>If IsNull(Me.SANumber) Or IsNull(SerialNumber) Or _\n   IsNull(Me.CustomerName) Or IsNull(Me.LyoSize) = Null Then\n</code></pre>\n\n<p>You should rename your function to something like \"EmptyInputs\" to make your code a little more self-documenting. \"CheckInputs\" is a little non-descriptive.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1465414851, "creation_date": 1465414851, "answer_id": 37711505, "question_id": 37710817, "link": "https://stackoverflow.com/questions/37710817/make-all-fields-mandatory-to-be-filled-in/37711505#37711505", "title": "Make all fields mandatory to be filled in", "body": "<p>You CheckInputs() functions logic is incorrect.  Or will return true if any one condition is meet.  <br/>To get your desired result you can either ask does: <br/>\nIf Condition1 = true AND Condition2 = true AND ....<br/> \nOtherwise you can ask If Condition1 = false OR Condition2 = false OR ....<br/>\nTry this....</p>\n\n<pre><code>Function isFormValid() As Boolean\n\n    If isTextFieldInvalid(Me.SANumber) Or isTextFieldInvalid(Me.SerialNumber) Or isTextFieldInvalid(Me.CustomerName.Value) Or Me.LyoSize.Value = Null Then\n        isFormValid = False\n    Else\n        isFormValid = True\n    End If\n\nEnd Function\n\nFunction isTextFieldInvalid(FieldControl) As Boolean\n    If Not IsNull(FieldControl) Then\n        If Len(Trim(FieldControl.Value)) Then\n            isFieldValid = True\n        End If\n    End If\nEnd Function\n\n'Import MCL Files Code\nPrivate Sub ImportMCL_Click()\n\n    On Error GoTo ErrorHandler\n    'disable ms access warnings\n    DoCmd.SetWarnings False\n\n    If isFormValid Then\n        MsgBox \"All inputs must be entered!\"\n        Exit Sub\n    Else\n\n        'load spreadsheet in .xls format\n        DoCmd.TransferSpreadsheet acImport, 8, \"_MCL_UPLOAD\", selectFile(), True\n        DoCmd.OpenQuery \"UpdateMCL\"\n        Call InsertInto_MASTER_UPLOAD\n        Call Delete_MCL_UPLOAD\n        MsgBox \"MCL Imported Successfully!\"\n        're-enable ms access warnings\n        DoCmd.SetWarnings True\n    End If\n\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"There was an Error: \" &amp; Err &amp; \": \" &amp; Error(Err)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5438532"}, "is_accepted": false, "score": 1, "last_activity_date": 1465506668, "last_edit_date": 1465506668, "creation_date": 1465500390, "answer_id": 37734594, "question_id": 37710817, "link": "https://stackoverflow.com/questions/37710817/make-all-fields-mandatory-to-be-filled-in/37734594#37734594", "title": "Make all fields mandatory to be filled in", "body": "<p>Also, if you're clearing out afterwards by going something like SANumber = \"\" then testing for Nulls might not work.  I'd check for both nulls and blanks.  This is a general template you could use.  </p>\n\n<pre><code>Dim LResponse As Integer\nIf (Nz(Me.SANumber.Value) = \"\") Then\n    MsgBox \"Please enter a SA Number.\", vbCritical + vbOKOnly, \"Error\"\nElseIf (Nz(Me.SerialNumber.Value) = \"\") Then\n   MsgBox \"Please enter a Serial Number.\", vbCritical + vbOKOnly, \"Error\"\n\n'All criteria met\nElse\n    LResponse = MsgBox(\"Would you like to submit? \", vbQuestion + vbYesNo, \"Question\")\n    If LResponse = vbYes Then\n        'enter code here\n    ElseIf LResponse = vbNo Then\n        MsgBox (\"Not submitted.\")\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 37710926, "answer_count": 3, "score": 0, "last_activity_date": 1465506668, "creation_date": 1465412590, "last_edit_date": 1495539860, "question_id": 37710817, "link": "https://stackoverflow.com/questions/37710817/make-all-fields-mandatory-to-be-filled-in", "title": "Make all fields mandatory to be filled in", "body": "<p>This question is continued from here: <a href=\"https://stackoverflow.com/questions/37659495/add-user-input-to-excel-table-upon-upload-to-access-database\">Add user input to Excel table upon upload to Access database</a></p>\n\n<p>Now that I have my fields connected to a table in my database, I want to make sure that everyone fills them in. Upon clicking the Import button, I want to check the fields (SANumber, SerialNumber, CustomerName, and LyoSize) to make sure it will be a 'valid upload'. </p>\n\n<p>I have this code so far:</p>\n\n<pre><code>Function CheckInputs() As Boolean\n\nIf Me.SANumber.value Or Me.SerialNumber.value Or Me.CustomerName.value Or Me.LyoSize.value = Null Then\n CheckInputs = True\nElse\n CheckInputs = False\nEnd If\n\n End Function\n\n'Import MCL Files Code\nPrivate Sub ImportMCL_Click()\n\nOn Error GoTo ErrorHandler\n'disable ms access warnings\nDoCmd.SetWarnings False\n\nCall CheckInputs\nIf CheckInputs = True Then\nMsgBox \"All inputs must be entered!\"\nExit Sub\nElse\n\n'load spreadsheet in .xls format\nDoCmd.TransferSpreadsheet acImport, 8, \"_MCL_UPLOAD\", selectFile(), True\nDoCmd.OpenQuery \"UpdateMCL\"\nCall InsertInto_MASTER_UPLOAD\nCall Delete_MCL_UPLOAD\nMsgBox \"MCL Imported Successfully!\"\n're-enable ms access warnings\nDoCmd.SetWarnings True    \nEnd If\n\nExit Sub\n\nErrorHandler:\nMsgBox \"There was an Error: \" &amp; Err &amp; \": \" &amp; Error(Err)\n\nEnd Sub\n</code></pre>\n\n<p>It should work, but keeps on giving me the </p>\n\n<blockquote>\n  <p>ERROR: 13. Type Mismatch</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1465412019, "last_edit_date": 1465412019, "creation_date": 1465411656, "answer_id": 37710551, "question_id": 37710467, "link": "https://stackoverflow.com/questions/37710467/find-range-of-current-calculations-cell/37710551#37710551", "title": "Find Range of Current Calculation&#39;s Cell", "body": "<p>You want <code>Application.Caller</code>:</p>\n\n<pre><code>Function AddStuff(Val As Integer)\n    AddStuff = Val + 5\n    If AddStuff &gt; 10 Then AddStuff = Application.Caller.Address\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HXyB7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HXyB7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37710551, "answer_count": 1, "score": 0, "last_activity_date": 1465412019, "creation_date": 1465411453, "last_edit_date": 1531164843, "question_id": 37710467, "link": "https://stackoverflow.com/questions/37710467/find-range-of-current-calculations-cell", "title": "Find Range of Current Calculation&#39;s Cell", "body": "<p>Excel 2013</p>\n\n<p>Goal: Without a string search, is it possible to find the cell address of the cell currently being calculated</p>\n\n<pre><code>Function AddStuff(Val as integer)\n    AddStuff = Val + 5\n    if AddStuff &gt; 10 then AddStuff = Active.Address\nEnd Function\n</code></pre>\n\n<p>Lets say we have a table that we fill with formula AddStuff() how do we make <strong>Active.Address</strong> a real thing? The address of the current cell that's being calculated, not the cell that's being referenced in the formula.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1465412180, "post_id": 37710590, "comment_id": 62895316, "body": "Thank you! This works for me for now. Appreciate it!"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1465412324, "post_id": 37710590, "comment_id": 62895389, "body": "Glad I could help :)"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1465918223, "post_id": 37710590, "comment_id": 63096880, "body": "This seems to be breaking if the cell starts with an equals sign. Do you have any ideas on how to fix this?"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 1, "last_activity_date": 1465412117, "last_edit_date": 1465412117, "creation_date": 1465411773, "answer_id": 37710590, "question_id": 37710271, "link": "https://stackoverflow.com/questions/37710271/how-to-move-all-active-cells-to-the-first-column/37710590#37710590", "title": "How to Move All Active Cells to the First Column", "body": "<p>There are faster and better ways to do what you need but for now I think this should do what you need.</p>\n\n<pre><code>Dim cel As Range, rng As Range\nDim wk As Worksheet\n\nSet wk=Sheet1\nSet rng =  wk.Usedrange\n\nFor each cel in rng\n     if cel.Value &lt;&gt; \"\" and cel.Column &lt;&gt; 1 then\n         wk.Cells(cel.Row,1) = cel.Value\n         cel.Value = \"\"\n     End if\nNext cel\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 37710590, "answer_count": 1, "score": 0, "last_activity_date": 1465412117, "creation_date": 1465410749, "question_id": 37710271, "link": "https://stackoverflow.com/questions/37710271/how-to-move-all-active-cells-to-the-first-column", "title": "How to Move All Active Cells to the First Column", "body": "<p>I currently have a Macro that imports text into Excel. My problem is the text is in all different columns. There is only one cell populated per column and my ideal state would move all cells to the column A. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465412167, "post_id": 37710191, "comment_id": 62895310, "body": "<code>for i=3 to 9 | with thisworkbook.sheets(i)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6442019, "user_type": "registered", "profile_image": "https://graph.facebook.com/717406005067522/picture?type=large", "display_name": "Brando", "link": "https://stackoverflow.com/users/6442019/brando"}, "is_accepted": false, "score": 0, "last_activity_date": 1465413368, "last_edit_date": 1465413368, "creation_date": 1465413051, "answer_id": 37710952, "question_id": 37710191, "link": "https://stackoverflow.com/questions/37710191/loop-and-set-value-for-coulmns/37710952#37710952", "title": "Loop and set value for coulmns", "body": "<p>I'm not entirely sure if this is what you're asking, but I think the range.copy is what you want.</p>\n\n<p>To get the entire worksheet 3-9 you can use</p>\n\n<pre><code>' A2:C57 = Cells (2,1),Cells(57,3)\nFor Sheetindex= 3 to ThisWorkbook.Worksheets.Count\n'Copy Worksheet 3 A2:C57\n\nSet SourceRange = ThisWorkbook.WorkSheets(Sheetindex).Range(Cells(2,1),Cells(57,3)) \n\n' Paste it in Columns G,H,I starting in Row 1.  \n\n\nSourceRange.Copy (ThisWorkbook.Worksheets(\"Sheet1\").Cells(\"G1\")) \n\nNext Sheetindex\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465413368, "creation_date": 1465410490, "question_id": 37710191, "link": "https://stackoverflow.com/questions/37710191/loop-and-set-value-for-coulmns", "title": "Loop and set value for coulmns", "body": "<p>I am currently using the set value method to copy data from multiple workbooks. I can currently loop through all workbooks and set the values from one sheet, worksheet2(Title) as seen below, and copy them to \"thisWorkbook\" on \"sheet1\", my destination. How can I loop through worksheets 3 to 9 and copy the range A2:C57 into columns G,H,I using the same set value method? </p>\n\n<pre><code>Sub GetData()\nDim MyPath As String\nDim FileName As String\nDim SheetName As String\nDim NewRow As Long\n\nMyPath = \"C:\\attach\"\nSheetName = \"Title\"\n\nFileName = Dir(MyPath &amp; \"\\*.xlsx\")\nDo While FileName &lt;&gt; \"\"\n If FileName &lt;&gt; ThisWorkbook.Name Then\n With ThisWorkbook.Sheets(\"Sheet1\")\n NewRow = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n With .Range(\"A\" &amp; NewRow)\n .Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!B4\"\n .Value = .Value\nEnd With\nWith .Range(\"B\" &amp; NewRow)\n .Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!B5\"\n .Value = .Value\nEnd With\nWith .Range(\"C\" &amp; NewRow)\n.Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!B6\"\n.Value = .Value\nEnd With\nWith .Range(\"D\" &amp; NewRow)\n.Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!B7\"\n.Value = .Value\nEnd With\nWith .Range(\"E\" &amp; NewRow)\n.Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!A1\"\n.Value = .Value\nEnd With\nWith .Range(\"F\" &amp; NewRow)\n.Formula = \"='\" &amp; MyPath &amp; \"\\[\" &amp; FileName &amp; \"]\" &amp; SheetName &amp; \"'!A2\"\n.Value = .Value\nEnd With\n\n'Copy the range A2:C57 from workheets (3 to 9) and past into columns G,H,I in thisworkbook from every workbook in folder.\n'For sheets 3 to 9 set the value range A2:C57 to G,H,I in thisworkbook. This would be done for every workbook in the folder\n\nEnd With\nEnd If\nFileName = Dir\n\nLoop\nThisWorkbook.Sheets(\"Sheet1\").Columns.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "vba", "ms-access", "database-design"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465411762, "post_id": 37710005, "comment_id": 62895045, "body": "Generally speaking, it&#39;s bad practice to store a calculation in a table. All of the pieces are there to make the calculation, so wherever you want it to appear is where the calculation should be done. For example if you need it on a report, do the calculation in the query used as the control source of your report. If you must, there should be a &quot;calculated&quot; data type which would allow you to store the calculation in the table."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1465412278, "creation_date": 1465412278, "answer_id": 37710738, "question_id": 37710005, "link": "https://stackoverflow.com/questions/37710005/how-can-i-get-a-second-field-to-auto-populate-based-on-the-selection-of-the-firs/37710738#37710738", "title": "How can I get a second field to auto populate based on the selection of the first field in Access 2013?", "body": "<p>You need the <code>DateAdd</code> function like this:</p>\n\n<pre><code>DateAdd(\"d\",[NoOfdays],[TrainingDate])\n</code></pre>\n\n<p>How you will use that depends on what you are trying to do. If you just want to have it somewhere create a query that links the two tables together based on employee and add the above as a field.</p>\n\n<p>If you don't want to link the tables you can use <code>DLookup</code> to read the <code>[NoOfDays]</code> field like this:</p>\n\n<pre><code>DLookup(\"[NoOfdays]\",\"[TrainingTable]\",\"[TrainingCourse]=\" &amp; [TrainingCourse])\n</code></pre>\n\n<p>Since you don't provide the table or field names, or whether your tables are properly structured with IDs or not that's as far as I can get you.</p>\n"}], "owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023217, "creation_date": 1465409904, "last_edit_date": 1594023217, "question_id": 37710005, "link": "https://stackoverflow.com/questions/37710005/how-can-i-get-a-second-field-to-auto-populate-based-on-the-selection-of-the-firs", "title": "How can I get a second field to auto populate based on the selection of the first field in Access 2013?", "body": "<p>I am trying to build a training record database. In our company, employees have to take a variety of different training and each certification has a different expiry timeline.</p>\n\n<p>My first table lists out ALL the training along with the number of days they are valid for like so:</p>\n\n<ol>\n<li>WHMIS    365 Days</li>\n<li>Fall Protection   1095 Days</li>\n</ol>\n\n<p>My second table will simply list out all the employees and each of their training and the date they took it. </p>\n\n<p>For ex:</p>\n\n<ol>\n<li>John Doe   WHMIS  Dec 12 2015</li>\n<li>John Doe   Fall Protection   Jan 3 2014</li>\n<li>Jane Doe   WHMIS  Feb 3 2016</li>\n</ol>\n\n<p>How can I get a forth field, to automatically calculate the Expiry date, based off of the number of days the certification is valid in the first table?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465410410, "post_id": 37709910, "comment_id": 62894256, "body": "What&#39;s the error of the text message?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465412760, "post_id": 37709910, "comment_id": 62895632, "body": "Are you sure the named range is in the worksheet scope and not the workbook scope?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6442507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/---Lm97M-vCY/AAAAAAAAAAI/AAAAAAAAACM/TkJjVuT84hw/photo.jpg?sz=128", "display_name": "Rodrigo Couto", "link": "https://stackoverflow.com/users/6442507/rodrigo-couto"}, "is_accepted": false, "score": 0, "last_activity_date": 1466533027, "last_edit_date": 1466533027, "creation_date": 1465420738, "answer_id": 37713101, "question_id": 37709910, "link": "https://stackoverflow.com/questions/37709910/error-in-vba-excel-in-simple-command/37713101#37713101", "title": "Error in VBA/Excel in simple command", "body": "<p>'make sure you have named the cell as: start; and the tab as: Output</p>\n\n<pre><code>Sub simple()\n\n    Dim under_unit As Range\n    Set under_unit = ThisWorkbook.Sheets(\"Output\").Range(\"start\")\n\n    under_unit.Value = \"solved\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6441863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf1fb40b74a6f91b1b34f3cb8d19788?s=128&d=identicon&r=PG&f=1", "display_name": "jejejeje", "link": "https://stackoverflow.com/users/6441863/jejejeje"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466533027, "creation_date": 1465409544, "last_edit_date": 1465409952, "question_id": 37709910, "link": "https://stackoverflow.com/questions/37709910/error-in-vba-excel-in-simple-command", "title": "Error in VBA/Excel in simple command", "body": "<p>I did not use VBA for a while and I have an error 1004 when using this very simple command. I don't know what I have wrong there as it is very basic. (the range \"start\" is defined in the sheet \"Output\")</p>\n\n<p>thanks a lot for your help</p>\n\n<pre><code>Sub simple()\n    Dim under_unit As Variant\n    under_unit = ThisWorkbook.Worksheets(\"Output\").Range(\"start\").Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1465409654, "post_id": 37709803, "comment_id": 62893812, "body": "check this out: <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/e04b3af9-f26d-40bf-9622-f3a232201f59/minimise-access-application?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6441789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04d9e9b95ca564b57c7ea098e5b707d?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Nayak", "link": "https://stackoverflow.com/users/6441789/bharath-nayak"}, "reply_to_user": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1465411049, "post_id": 37709803, "comment_id": 62894638, "body": "Hey Brino, Thanks for a quick reply...  However what I need is a little different than the link you quoted..  The link says docmd.minimize and docmd.runcommand acappminimize... That would be right if I have a button in my form to minimize... But what I want is the minimize button of the form (not created by me, but by enabling minmax buttons) to work as minimize button of the application..  Whenever user clicks to minimize the form, the form should stay as it is but the application as a whole should be minimized..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1465452369, "post_id": 37717943, "comment_id": 62908809, "body": "Sorry about that I didn&#39;t read your comment about wanting to control the forms minimize button.  It&#39;s not impossible but it&#39;s not easy either.  You&#39;ll have to Hook the Form&#39;s Window using Windows API Calls. Start here: <a href=\"http://www.devhut.net/2011/02/15/ms-access-vba-minimizemaximize-access-application/\" rel=\"nofollow noreferrer\">Completely Hide the MS Access Application Window</a>"}, {"owner": {"reputation": 1, "user_id": 6441789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04d9e9b95ca564b57c7ea098e5b707d?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Nayak", "link": "https://stackoverflow.com/users/6441789/bharath-nayak"}, "edited": false, "score": 0, "creation_date": 1465505902, "post_id": 37717943, "comment_id": 62943322, "body": "Thank you very much Thomas.. That really helped...  I would quote an improvement that solved my problem...  1. Whenever a form is minimized, it&#39;s width comes to 2400 (in my pc, may differ in others) 2. So I wrote code in Resize event &quot;If Me.WindowWidth = 2400 then call fSetAccessWindow(SW_SHOWMINIMIZED) end If&quot;  Now whenever form is minimized, it checks width, and minimizes whole application using the code in the link you provided..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1465505541, "last_edit_date": 1465505541, "creation_date": 1465451976, "answer_id": 37717943, "question_id": 37709803, "link": "https://stackoverflow.com/questions/37709803/access-vba-how-to-minimize-application-when-user-clicks-minimize-button-in-a-f/37717943#37717943", "title": "Access vba : How to minimize application when user clicks minimize button in a form", "body": "<p>Using VBA</p>\n\n<p>Application.DoCmd.RunCommand acCmdAppMinimize</p>\n\n<p>Check below comment for answer..</p>\n"}], "owner": {"reputation": 1, "user_id": 6441789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04d9e9b95ca564b57c7ea098e5b707d?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Nayak", "link": "https://stackoverflow.com/users/6441789/bharath-nayak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1676, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1594641959, "creation_date": 1465409155, "last_edit_date": 1594641959, "question_id": 37709803, "link": "https://stackoverflow.com/questions/37709803/access-vba-how-to-minimize-application-when-user-clicks-minimize-button-in-a-f", "title": "Access vba : How to minimize application when user clicks minimize button in a form", "body": "<p>What exactly I want is, </p>\n\n<p>Whenever user clicks minimize button in a form, I want the form, Not to minimize itself but to minimize the whole application.</p>\n\n<p>Details:\n1. I have an access form which runs maximised\n2. I enabled minimize and maximize button of that form\n3. I made it a modal and popup form\n3. Users will click minimize button whenever they want to minimize.\n4. But only form is minimized and main access window is visible</p>\n\n<p>Now here's what I want..\nI want that minimize button, do nothing to the form, but minimize the whole access application..</p>\n\n<p>My wish is to make it feel like a customized app..</p>\n\n<p>Thanks in advance...</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465410401, "post_id": 37709713, "comment_id": 62894250, "body": "Did you tried recording macro ?"}, {"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465411435, "post_id": 37709713, "comment_id": 62894852, "body": "So here is what I found out, and it kind of answers my question: Inside one of my nested <code>with</code> sections, I can add a <code>.select</code>, followed by an additionally nested with section, <code>with selection.format.line</code>. From there I can simply place the code <code>.weight = 1</code> and it works fine...so I am curious as to why i have to include this additional code, it seems inefficient to have that many nested with statements."}], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1465416008, "post_id": 37711765, "comment_id": 62897382, "body": "Yeah that worked...I think I was writing in <code>width =</code> instead of <code>weight</code>"}, {"owner": {"reputation": 98, "user_id": 4966176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6a3cb31f7c6d295b3f781d4c722d2d?s=128&d=identicon&r=PG&f=1", "display_name": "JerryT", "link": "https://stackoverflow.com/users/4966176/jerryt"}, "reply_to_user": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "edited": false, "score": 0, "creation_date": 1465416285, "post_id": 37711765, "comment_id": 62897552, "body": "I did the same thing when I first tried it... Glad I  could help!"}], "tags": [], "owner": {"reputation": 98, "user_id": 4966176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6a3cb31f7c6d295b3f781d4c722d2d?s=128&d=identicon&r=PG&f=1", "display_name": "JerryT", "link": "https://stackoverflow.com/users/4966176/jerryt"}, "is_accepted": true, "score": 1, "last_activity_date": 1465415772, "creation_date": 1465415772, "answer_id": 37711765, "question_id": 37709713, "link": "https://stackoverflow.com/questions/37709713/excel-vba-chart-formatting-need-to-change-the-width-of-a-line/37711765#37711765", "title": "excel VBA Chart Formatting - need to change the width of a line", "body": "<pre><code>With .FullSeriesCollection(2)\n    .ChartType = xlLine\n    .AxisGroup = 1\n    .Format.Line.Weight = 5\nEnd With\n</code></pre>\n\n<p>Worked fine for me in Office 2016. </p>\n\n<p>I would have commented, but I do not have a high enough reputation yet</p>\n"}], "owner": {"reputation": 409, "user_id": 5781265, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/84a5d506a5de0db8541322b811634966?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/5781265/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2881, "favorite_count": 0, "accepted_answer_id": 37711765, "answer_count": 1, "score": 0, "last_activity_date": 1465415772, "creation_date": 1465408871, "last_edit_date": 1465410261, "question_id": 37709713, "link": "https://stackoverflow.com/questions/37709713/excel-vba-chart-formatting-need-to-change-the-width-of-a-line", "title": "excel VBA Chart Formatting - need to change the width of a line", "body": "<p>I am trying to write code that will format a chart (myChart). Series line 2 and 4 are the 2 that I need to format so their weight = 1. I have tried following with no luck.</p>\n\n<pre><code>myChart.fullseriescollection(2).format.line.weigth = 1\n</code></pre>\n\n<p>I am pretty new to VBA, and I have never tried to reference chart object before, so I am unfamiliar with the proper syntax. </p>\n\n<p>Thanks! See my code below. </p>\n\n<pre><code>Sub myChart()\n\nDim myChart As Chart, cht As ChartObject\nDim rngChart As Range, destSht As String\nDim rngData As Range\n\ndestSht = ActiveSheet.Name\nSet myChart = Charts.Add\nSet myChart = myChart.Location(where:=xlLocationAsObject, Name:=destSht)\n\nWith ActiveSheet.ListObjects(\"Table1\").DataBodyRange\n    Set rngData = Union(.Columns(2), .Columns(9), .Columns(10), .Columns(11), .Columns(12))\nEnd With\n\nWith myChart\n.SetSourceData Source:=rngData, PlotBy:=xlColumns\n.ChartType = xlColumnClustered\n.ChartStyle = 209\n\n*****Below is the first series line that I want to format*****\nWith .FullSeriesCollection(2)\n    .ChartType = xlLine\n    .AxisGroup = 1\nEnd With\n\nWith .FullSeriesCollection(3)\n    .ChartType = xlLineMarkers\n    .AxisGroup = 2\nEnd With\n\n*****2nd line I want to format*****\nWith .FullSeriesCollection(4)\n    .ChartType = xlLine\n    .AxisGroup = 2\nEnd With\nEnd With\n\nActiveSheet.ChartObjects(1).Activate\n\nSet cht = ActiveChart.Parent\nSet rngChart = Range(\"A1100:K1115\")\n\ncht.Left = rngChart.Left\ncht.Top = rngChart.Top\ncht.Width = rngChart.Width\ncht.Height = rngChart.Height\n\nRange(\"A2\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "search", "find"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1465408456, "post_id": 37709564, "comment_id": 62893092, "body": "<code>LookAt:=xlWhole,</code> to <code>LookAt:=xlPart,</code>"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465410960, "post_id": 37709564, "comment_id": 62894590, "body": "I feel stupid, I should have looked at that more closely...LOL...works like a champ...thanks"}], "owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4864, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465408350, "creation_date": 1465408350, "question_id": 37709564, "link": "https://stackoverflow.com/questions/37709564/vba-find-in-a-column-a-partial-match", "title": "VBA find in a column a partial match", "body": "<p>Hello I wanted to adapt this code to find a serial number in column 1, it works great when SN= is in one cell and the Serial number is always on the next cell below. However, I have a new case where the \"SN= serialNumberHere\" are in the same cell. These two instances in my case will always be this way, either \n\"SN= withserialnumber\" in Same cell or\n\"SN= \" \n\"serialNumberHere\" where the serial number is in the next cell</p>\n\n<pre><code>        snRow = Columns(1).Find(What:=\"SN= \", _\n                                After:=ActiveCell, _\n                                LookIn:=xlValues, _\n                                LookAt:=xlWhole, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlNext, _\n                                MatchCase:=False, _\n                                SearchFormat:=False).Row\n    Range(\"A\" &amp; (snRow + 1)).Select 'select serial number cell in Temp WorkBook\n    Selection.Copy\n    wrksht.Activate\n    Range(\"B1\").Select\n    wrksht.Paste\n    wbImport.Activate\n</code></pre>\n\n<p>So I want to change the above code too something like snRow + 0</p>\n\n<pre><code>        snRow = Columns(1).Find(What:=\"SN= \", _\n                                After:=ActiveCell, _\n                                LookIn:=xlValues, _\n                                LookAt:=xlWhole, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlNext, _\n                                MatchCase:=False, _\n                                SearchFormat:=False).Row\n    Range(\"A\" &amp; (snRow + 0)).Select 'select serial number cell in Temp WorkBook\n    Selection.Copy\n    wrksht.Activate\n    Range(\"B1\").Select\n    wrksht.Paste\n    wbImport.Activate\n</code></pre>\n\n<p>However, it doesn't seem to find the \"SN= \" if the serial number is in the same cell as SN=</p>\n"}, {"tags": ["vba", "email", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1465407926, "post_id": 37709270, "comment_id": 62892759, "body": ".body is plain text, and plain text doesn&#39;t have formatting. Formatting requires HTML, which is why .htmlbody works."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1465417778, "post_id": 37709270, "comment_id": 62898371, "body": "You can add line spacing with the html marker: <code>&lt;br&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1465483508, "post_id": 37712734, "comment_id": 62929643, "body": "They both worked perfect. I was not too sure on how to work with html. Thanks a lot for your help. Much props"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1465495240, "post_id": 37712734, "comment_id": 62937435, "body": "Great! Glad I could help. Thanks, bro."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 5, "last_activity_date": 1465419280, "creation_date": 1465419280, "answer_id": 37712734, "question_id": 37709270, "link": "https://stackoverflow.com/questions/37709270/make-a-part-of-my-email-body-text-bold-with-using-body-instead-of-htmlbody-in/37712734#37712734", "title": "Make a part of my email body text bold with using .body instead of .htmlbody in Word VBA", "body": "<p>You can continue to use HTML, simply replace the carriage returns with html's <code>&lt;br&gt;</code> for line break. Remember every inline markup (no css) to style html content is valid. So you have free range of fonts, colors, sizes, even web images!</p>\n\n<pre><code>msg = \"Attached QDR Request form is for the following: &lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt; JOB NUMBER:&lt;/b&gt;&lt;br&gt;\" _\n      &amp; TextBox21.Value &amp; \"&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt; QDR NUMBER: &lt;/b&gt;&lt;br&gt;\" _\n      &amp; TextBox22.Value &amp; \"&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt; CONDITION: &lt;/b&gt;&lt;br&gt;\" _\n      &amp; combobox1.Value &amp; \"&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt; HARTNESS PART NUMBER: &lt;br&gt;\" _\n      &amp; TextBox23.Value &amp; \"&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt; REQUIRED DATE: &lt;/b&gt;&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"PART REQUIRED SOONER THAN SET LEAD TIME: &lt;br&gt;\" _\n      &amp; TextBox30.Value &amp; \"&lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;b&gt;BRIEF DESCRIPTION OF REQUEST: &lt;/b&gt;&lt;br&gt;\" _\n      &amp; TextBox25.Value\n\n...\n.HTMLBody = msg    \n</code></pre>\n\n<p>Alternatively, use an html table for better alignment:</p>\n\n<pre><code>msg = \"Attached QDR Request form is for the following: &lt;br&gt;&lt;br&gt;\" _\n      &amp; \"&lt;table&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt;&lt;b&gt; JOB NUMBER: &lt;/b&gt;&lt;/td&gt;&lt;td&gt;\" &amp; TextBox21.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt;&lt;b&gt; QDR NUMBER: &lt;/b&gt;&lt;/td&gt;&lt;td&gt;\" &amp; TextBox22.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt;&lt;b&gt; CONDITION: &lt;/b&gt;&lt;/td&gt;&lt;td&gt;\" &amp; combobox1.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt;&lt;b&gt; HARTNESS PART NUMBER: &lt;b&gt;&lt;/td&gt;&lt;td&gt;\" &amp; TextBox23.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt;&lt;b&gt; REQUIRED DATE: &lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt; PART REQUIRED SOONER THAN SET LEAD TIME: &lt;/td&gt;&lt;td&gt;\" &amp; TextBox30.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;tr&gt;&lt;td&gt; BRIEF DESCRIPTION OF REQUEST: &lt;/td&gt;&lt;td&gt;\" &amp; TextBox25.Value &amp; \"&lt;/td&gt;&lt;/tr&gt;\" _\n      &amp; \"&lt;/table&gt;\"\n\n...\n.HTMLBody = msg\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10328, "favorite_count": 0, "accepted_answer_id": 37712734, "answer_count": 1, "score": 3, "last_activity_date": 1592994703, "creation_date": 1465407451, "last_edit_date": 1592994703, "question_id": 37709270, "link": "https://stackoverflow.com/questions/37709270/make-a-part-of-my-email-body-text-bold-with-using-body-instead-of-htmlbody-in", "title": "Make a part of my email body text bold with using .body instead of .htmlbody in Word VBA", "body": "<p>I am trying to bold specific text within the body of my email VBA. In it's current state, I am unable to format any text under <code>.body</code>. </p>\n\n<p>However, when I change to <code>.html body</code>, I am able to bold text. For example, if I use \"&lt; b>JOB NUMBER\", the text \"JOB NUMBER\" is in bold, but the entire body of my email loses all line spaces. </p>\n\n<p>Your help will be much appreciated. Thanks</p>\n\n<pre><code>    Private Sub sendemail_Click()\n\n\nDim OL              As Object\nDim EmailItem       As Object\nDim Doc             As Document\n\nApplication.ScreenUpdating = False\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\nDoc.Save\n\nWith EmailItem\n    .Subject = \"QDR\" &amp; \" \" &amp; TextBox22.Value &amp; \"_\" &amp; TextBox21.Value &amp; \"_\" &amp;    ComboBox2.Value &amp; \"_\" &amp; combobox1.Value\n    **.Body** = \"Attached QDR Request form is for the following: \" &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"JOB NUMBER: \" &amp; vbCrLf &amp; _\n    TextBox21.Value &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"QDR NUMBER: \" &amp; vbCrLf &amp; _\n    TextBox22.Value &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"CONDITION: \" &amp; vbCrLf &amp; _\n    combobox1.Value &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"HARTNESS PART NUMBER: \" &amp; vbCrLf &amp; _\n    TextBox23.Value &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"REQUIRED DATE: \" &amp; vbCrLf &amp; _\n    TextBox31.Value &amp; vbCrLf &amp; _\n    \"PART REQUIRED SOONER THAN SET LEAD TIME: \" &amp; vbCrLf &amp; _\n    TextBox30.Value &amp; vbCrLf &amp; _\n    \"\" &amp; vbCrLf &amp; _\n    \"BRIEF DESCRIPTION OF REQUEST: \" &amp; vbCrLf &amp; _\n    TextBox25.Value\n\n\n    .To = \"XXXXX@XXXXX.com;\"\n    .CC = \"XXXXX@XXXXX.com;\" &amp; \"XXXXX@XXXXX.com;\"\n    .Importance = olImportanceNormal 'Or olImportanceHigh Or olImportanceLow\n    .Attachments.Add Doc.FullName\n    .Display\nEnd With\n\nApplication.ScreenUpdating = True\n\nSet Doc = Nothing\nSet OL = Nothing\nSet EmailItem = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Wm8GV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wm8GV.jpg\" alt=\"EXAMPLE PICTURE\"></a></p>\n"}, {"tags": ["excel", "vba", "ms-word", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1465409495, "post_id": 37709465, "comment_id": 62893738, "body": "Oops --- the above code snippet runs from within Word, but not from Excel. See below for the Excel version."}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465412731, "post_id": 37709465, "comment_id": 62895610, "body": "How is VBA code different when switching between Excel and Word?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465416463, "post_id": 37709465, "comment_id": 62897637, "body": "If the VBA code is running from Word, you can access the <code>Selection</code> object in Word; if running from Excel, there&#39;s no access to Word&#39;s <code>Selection</code> (at least I don&#39;t know how to do it). That&#39;s why I used a <code>Word.Range</code> object."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1465408069, "creation_date": 1465408069, "answer_id": 37709465, "question_id": 37708781, "link": "https://stackoverflow.com/questions/37708781/opening-word-document-copying-specific-text-paste-into-excel-spreadsheet/37709465#37709465", "title": "Opening word document, copying specific text, paste into excel spreadsheet", "body": "<p>This might get you started:</p>\n\n<pre><code>Selection.Find.ClearFormatting\nWith Selection.Find\n    .Text = \"TP[0-9]{4}\"\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = True\n    .Execute\nEnd With\nSelection.Copy\n</code></pre>\n\n<p>I've used wildcard matching <code>.MatchWildcards = True</code>. The pattern to match is specified by <code>.Text = \"TP[0-9]{4}\"</code> --- match \"TP\" followed by <em>exactly</em> four digits. If the number of digits varies in your application, replace <code>{4}</code> with say <code>{3,5}</code>.</p>\n\n<p>Hope that helps</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465411502, "post_id": 37709955, "comment_id": 62894894, "body": "That works perfect! Do you know how I would go about creating a loop for it to find all TP numbers?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465416797, "post_id": 37709955, "comment_id": 62897850, "body": "Instead of <code>.Execute</code> you can do a loop: <code>Do While .Execute</code>. See <a href=\"http://superuser.com/questions/1009085/find-all-instances-of-a-text-and-make-it-a-hyperlink-with-a-macro\">here</a> for an example."}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465496039, "post_id": 37709955, "comment_id": 62937900, "body": "One more thing, how would I stop the loop if there are no more TPXXXX numbers anymore? The amount of TP numbers varies from each document I have to copy them from, and the only thing I can think of is maybe counting the amount of TP numbers and then using a For loop to iterate that many times."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465499406, "post_id": 37709955, "comment_id": 62939931, "body": "When there are no more matches, <code>Find.Execute</code> will return a <code>False</code>, so the <code>Do While .Execute</code> loop will terminate. The loop should execute once for each successful find. All the actions you want to occur on each Find match should be inside the <code>Do While ...</code> loop."}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465565187, "post_id": 37709955, "comment_id": 62968498, "body": "What would the condition look like? Would it be: Do While .Execute(.Text = &quot;TP[0-9]{4}&quot; .......) = true?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1465572836, "post_id": 37709955, "comment_id": 62973655, "body": "You should be able to call Do While .Execute with no parameters. All parameters for Find can be set before the Do While loop. So replace .Execute in the code in the proposed answer with (a) a <code>Do While .Execute</code> statement, (b) statements inside the loop that carry out the copy/paste of data, (c) a <code>Loop</code> statement to terminate the loop."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1465409702, "creation_date": 1465409702, "answer_id": 37709955, "question_id": 37708781, "link": "https://stackoverflow.com/questions/37708781/opening-word-document-copying-specific-text-paste-into-excel-spreadsheet/37709955#37709955", "title": "Opening word document, copying specific text, paste into excel spreadsheet", "body": "<p>Here's the Excel version:</p>\n\n<pre><code>Sub CopyTPNumber()\n\n    'Create variables\n    Dim Word As New Word.Application\n    Dim WordDoc As New Word.Document\n    Dim r As Word.Range\n    Dim Doc_Path As String\n    Dim WB As Excel.Workbook\n    Dim WB_Name As String\n\n    Doc_Path = \"C:\\temp\\TestFind.docx\"\n    Set WordDoc = Word.Documents.Open(Doc_Path)\n    ' Set WordDoc = ActiveDocument\n\n    ' Create a range to search.\n    ' All of content is being search here\n    Set r = WordDoc.Content\n\n    'Find text and copy it (part that I am having trouble with)\n    With r\n        .Find.ClearFormatting\n        With .Find\n            .Text = \"TP[0-9]{4}\"\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = True\n            .Execute\n        End With\n        .Copy\n        ' Debug.Print r.Text\n    End With\n\n\n    'Open excel workbook and paste\n    WB_Name = Excel.Application.GetOpenFilename(\",*.xlsx\")\n    Set WB = Workbooks.Open(WB_Name)\n\n    WB.Sheets(\"Sheet1\").Select\n    Range(\"AB2\").Select\n    ActiveSheet.Paste\n    WordDoc.Close\n    Word.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5660, "favorite_count": 0, "accepted_answer_id": 37709955, "answer_count": 2, "score": 0, "last_activity_date": 1465409702, "creation_date": 1465405696, "question_id": 37708781, "link": "https://stackoverflow.com/questions/37708781/opening-word-document-copying-specific-text-paste-into-excel-spreadsheet", "title": "Opening word document, copying specific text, paste into excel spreadsheet", "body": "<p>I am trying to make a VBA script that opens a word document, looks for a word that looks like \"TPXXXX\" where \"X\" are numbers, and then pastes that text into an excel spreadsheet. I can open up the word document, but I am having trouble selecting and finding the text I need. So far for that part I have:</p>\n\n<pre><code>Sub Copy()\n\n'Create variables\nDim Word As New Word.Application\nDim WordDoc As New Word.Document\nDim Doc_Path As String\nDim WB As Workbook\nDim WB_Name As String\n\nDoc_Path = \"C:\\Path\\To\\File.docx\"\nSet WordDoc = Word.Documents.Open(Doc_Path)\n\n'Find text and copy it (part that I am having trouble with)\nSelection.Find.ClearFormatting\nWith Selection.Find\n    .Text = \"TP\"\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\nEnd With\nSelection.Find.Execute\nSelection.EscapeKey\nSelection.MoveLeft Unit: wdCharacter , Count:=2\nSelection.MoveRight Unit: wdCharacter , Count:=4\nSelection.Copy\n\n'Open excel workbook and paste\nWB_Name = Application.GetOpenFilename(\",*.xlsx\")\nSet WB = Workbooks.Open(WB_Name)\n\nWB.Sheets(\"Sheet1\").Select\nRange(\"AB2\").Select\nActiveSheet.Paste\nWordDoc.Close\nWord.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone give me some pointers?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1465404951, "post_id": 37708522, "comment_id": 62891093, "body": "Create a range that includes all the rows to the second to last.  Lets call it <code>rng</code> then you would use <code>rng.Value = .rng.Value</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1465405076, "post_id": 37708522, "comment_id": 62891176, "body": "If you post your existing code someone may suggest an addition which would do what you want.  Much harder to start with nothing."}, {"owner": {"reputation": 31, "user_id": 6382321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1213600545325323/picture?type=large", "display_name": "Collin", "link": "https://stackoverflow.com/users/6382321/collin"}, "edited": false, "score": 0, "creation_date": 1465405490, "post_id": 37708522, "comment_id": 62891443, "body": "Sorry i don&#39; t know how to set it up good. This is my copy/Insert new row copying the formulas from the row above, now i just need to add a step that will change the row that it copied the formula from back to a value instead of formula"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1465406120, "post_id": 37708766, "comment_id": 62891801, "body": "@ScottCraner  Updated as per your suggestion."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1465406087, "last_edit_date": 1465406087, "creation_date": 1465405640, "answer_id": 37708766, "question_id": 37708522, "link": "https://stackoverflow.com/questions/37708522/vba-code-to-convert-all-formulas-in-a-spreadsheet-to-values-except-last-active-r/37708766#37708766", "title": "VBA code to convert all formulas in a spreadsheet to values except last active row", "body": "<p>Let's say we used column <strong>A</strong> and that the last value in column <strong>A</strong> marks the last row entered.  This will remove formulas from all but the bottom row:</p>\n\n<pre><code>Sub FormulaKiller()\n    Dim N As Long, rng As Range\n\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(Cells(1, 1), Cells(N - 1, Columns.Count))\n\n    rng.Copy\n    rng.PasteSpecial (xlPasteValues)\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As <em>Scott Craner</em> points out, we can replace:</p>\n\n<pre><code>rng.Copy\nrng.PasteSpecial (xlPasteValues)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>rng.value=rng.value\n</code></pre>\n\n<p>This avoids using the clipboard and also does not disturb the Selection state of the worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1465405669, "creation_date": 1465405669, "answer_id": 37708773, "question_id": 37708522, "link": "https://stackoverflow.com/questions/37708522/vba-code-to-convert-all-formulas-in-a-spreadsheet-to-values-except-last-active-r/37708773#37708773", "title": "VBA code to convert all formulas in a spreadsheet to values except last active row", "body": "<pre><code>With Cells(Rows.Count, 2).End(xlUp).Offset(-1, 0)\n    .Copy\n    .PasteSpecial Paste:=xlPasteValues\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6382321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1213600545325323/picture?type=large", "display_name": "Collin", "link": "https://stackoverflow.com/users/6382321/collin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1465406087, "creation_date": 1465404814, "last_edit_date": 1465405869, "question_id": 37708522, "link": "https://stackoverflow.com/questions/37708522/vba-code-to-convert-all-formulas-in-a-spreadsheet-to-values-except-last-active-r", "title": "VBA code to convert all formulas in a spreadsheet to values except last active row", "body": "<p>Since I input a new row of data every week in my workbook, I need Excel to recognize what the last active row is, and everything above that needs to be changed from formulas to values. This is because I don't want my previous weeks data to change to the most recent data when the reference sheet is updated each week. I Use a macro that will Copy/Insert a new row with the same formula as the row above it, so the last row of data contains all of the formulas which is why i don't want that changed. Any help or suggestions would be appreciated!\nHere is what I have for my copy/insert formula below last active row:</p>\n\n<pre><code>Sub RunAll()\n\n Dim ws As Worksheet\n For Each ws In Sheets\n    ws.Activate\n\n    ' Go to last cell\n    Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Select\n\n    ' Copy formula from cell above\n    Rows(Selection.Row - 1).Copy\n    Rows(Selection.Row).Insert Shift:=xlDown\nNext ws\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["xml", "excel", "soap", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465407266, "post_id": 37708505, "comment_id": 62892426, "body": "So you have something like &lt;soap&gt;&lt;response&gt;&lt;value&gt;123&lt;/value&gt;&lt;/response&gt;&lt;/soap&gt; and you&#39;re having trouble selecting 123?  Please post a sample response so that people can help you find the xpath of the element you require."}, {"owner": {"reputation": 11, "user_id": 4916703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c42d31911af889e2e95b172f0892fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ami Khan", "link": "https://stackoverflow.com/users/4916703/ami-khan"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465478212, "post_id": 37708505, "comment_id": 62925484, "body": "Hi Cody - I have added a sample response to the original question"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465496538, "post_id": 37708505, "comment_id": 62938207, "body": "Error on line 6: The element type &quot;CustomFieldNames&quot; must be terminated by the matching end-tag &quot;&lt;/CustomFieldNames&gt;&quot;.  From an XML schema standpoint I don&#39;t think this is allowed and could be why you&#39;re finding it hard to work with the repsonse."}, {"owner": {"reputation": 11, "user_id": 4916703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c42d31911af889e2e95b172f0892fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ami Khan", "link": "https://stackoverflow.com/users/4916703/ami-khan"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465551145, "post_id": 37708505, "comment_id": 62959457, "body": "My fault - I shortened the response because the actual one is considerably long and I hoped the above would serve as an example.  To clarify - I want to use VBA to populate a spreadsheet based on the nodes values provided in the XML response. Are there any useful examples or suggestions to help me with that?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465563311, "post_id": 37708505, "comment_id": 62967249, "body": "See <a href=\"https://community.spiceworks.com/topic/478128-soap-request-via-vba-in-excel\" rel=\"nofollow noreferrer\">community.spiceworks.com/topic/&hellip;</a>  EChacko2016 Apr 28, 2014 at 12:06 PM --- this is pretty much what I would try.  Otherwise, <a href=\"https://msdn.microsoft.com/en-us/library/aa468547.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa468547.aspx</a> is a great starting point for a fully developed program, except your soap response will be the DOMDocument (in Particular, look at How Do I Traverse a Document?)"}, {"owner": {"reputation": 11, "user_id": 4916703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c42d31911af889e2e95b172f0892fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ami Khan", "link": "https://stackoverflow.com/users/4916703/ami-khan"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465908165, "post_id": 37708505, "comment_id": 63088784, "body": "Thanks Cody I have worked it out. In my ignorance I was of the impression extracting node values from a SOAP response would differ to extracting node values from a REST response in VBA. Code above updated in case anyone needs an example"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1465991655, "post_id": 37708505, "comment_id": 63130593, "body": "SOAP generally uses a WSDL (basically a &#39;functions definitions&#39; file) that you would use, but if you&#39;re not after implementing the full functionality then it doesn&#39;t matter!"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529347535, "post_id": 50915679, "comment_id": 88831305, "body": "@amikhan I have moved your answer here i.e. edited out of the question. If you wish to potentially gain rep by posting your own answer here in the answer section  leave a note and this will be deleted."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1529347480, "creation_date": 1529347480, "answer_id": 50915679, "question_id": 37708505, "link": "https://stackoverflow.com/questions/37708505/get-node-values-from-soap-response-using-vba/50915679#50915679", "title": "Get node values from SOAP response using VBA", "body": "<p>Answer by @AmiKhan moved from question to answer.</p>\n\n<pre><code>Option Explicit\n\n'Set Reference to Microsoft XML, v6.0\nDim DefectsCount As Integer\nDim wsDefects As Worksheet\nDim varTargetCycle As String\nDim list As IXMLDOMNodeList\nDim responseText As String\nDim sURL As String\nDim sEnv As String\nDim xmlhtp As New MSXML2.xmlHttp\nDim xmlDoc As New DOMDocument\nDim webserviceSOAPActionNameSpace\n\nSub GetDefects(PNum, PSize)\n\n    sURL = \"http://soap.qacomplete.smartbear.com/psWS.asmx?wsdl\"\n    varTargetCycle = Range(\"TargetCycle\").Value\n\n    sEnv = \"&lt;?xml version =\"\"1.0\"\" encoding=\"\"utf-8\"\"?&gt;\"\n    sEnv = sEnv &amp; \"&lt;soap:Envelope xmlns:soap=\"\"http://www.w3.org/2003/05/soap-envelope\"\" xmlns:prag=\"\"http://www.pragmaticsw.com/\"\"&gt;\"\n    sEnv = sEnv &amp; \"&lt;soap:Body&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:Bugs_LoadByCriteria&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:AuthenticationData&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:AppCode&gt;agSP&lt;/prag:AppCode&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:DeptId&gt;81842&lt;/prag:DeptId&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:ProjId&gt;92553&lt;/prag:ProjId&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:UserId&gt;\" &amp; V1USER &amp; \"&lt;/prag:UserId&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:PassCode&gt;\" &amp; V1PASS &amp; \"&lt;/prag:PassCode&gt;\"\n    sEnv = sEnv &amp; \"&lt;/prag:AuthenticationData&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:Condition&gt;&lt;![CDATA[&lt;Conditions xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'\"\n    sEnv = sEnv &amp; \" xmlns:xsd='http://www.w3.org/2001/XMLSchema' Operation='opEQU'&gt;\"\n    sEnv = sEnv &amp; \"&lt;Items Type='tField'&gt;\"\n    sEnv = sEnv &amp; \"&lt;Value xsi:type='xsd:string'&gt;Custom17&lt;/Value&gt;\"\n    sEnv = sEnv &amp; \"&lt;/Items&gt;\"\n    sEnv = sEnv &amp; \"&lt;Items Type='tString'&gt;\"\n    sEnv = sEnv &amp; \"&lt;Value xsi:type='xsd:string'&gt;\" &amp; varTargetCycle &amp; \"&lt;/Value&gt;\"\n    sEnv = sEnv &amp; \"&lt;/Items&gt;\"\n    sEnv = sEnv &amp; \"&lt;/Conditions&gt;]]&gt;&lt;/prag:Condition&gt;\"\n\n    sEnv = sEnv &amp; \"&lt;prag:Sorting&gt;Title&lt;/prag:Sorting&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:PageSize&gt;\" &amp; PSize &amp; \"&lt;/prag:PageSize&gt;\"\n    sEnv = sEnv &amp; \"&lt;prag:PageNumber&gt;\" &amp; PNum &amp; \"&lt;/prag:PageNumber&gt;\"\n\n    sEnv = sEnv &amp; \"&lt;/prag:Bugs_LoadByCriteria&gt;\"\n    sEnv = sEnv &amp; \"&lt;/soap:Body&gt;\"\n    sEnv = sEnv &amp; \"&lt;/soap:Envelope&gt;\"\n\n    With xmlhtp\n\n        webserviceSOAPActionNameSpace = \"http://www.pragmaticsw.com/\"\n\n        .Open \"POST\", sURL, False\n\n        .setRequestHeader \"POST\", \"http://soap.qacomplete.smartbear.com/psWS.asmx HTTP/1.1\"\n        .setRequestHeader \"Content-Type\", \"application/soap+xml; charset=UTF-8\"\n        .setRequestHeader \"SOAPAction\", webserviceSOAPActionNameSpace &amp; \"Bugs_LoadByCriteria\"\n        .setRequestHeader \"Accept-encoding\", \"zip\"\n\n        .send sEnv\n\n        xmlDoc.LoadXML .responseText\n        'MsgBox .responseText\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Dim Node As IXMLDOMNode\n        Dim LRow As Integer\n\n        Set list = xmlDoc.SelectNodes(\"//Bugs_LoadByCriteriaResponse/Bugs_LoadByCriteriaResult/Bug\")\n\n        Set wsDefects = Sheet2\n\n        Dim xmlnodelist As MSXML2.IXMLDOMNodeList\n        Dim xnode As MSXML2.IXMLDOMNode\n\n        DefectsCount = list.Length\n\n        With wsDefects\n\n            LRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n\n            For Each Node In list\n                Dim strBugValue As String\n                Dim strStatusCode As String\n                Dim strSeverity As String\n                Dim strPriority As String\n                Dim strIssue As String\n                Dim strReso As String\n\n                On Error Resume Next             'if null\n                strBugValue = Node.SelectSingleNode(\"BugId\").Text\n                strStatusCode = Node.SelectSingleNode(\"StatusCode\").Text\n                strSeverity = Node.SelectSingleNode(\"SeverityCode\").Text\n                strPriority = Node.SelectSingleNode(\"PriorityCode\").Text\n                strIssue = Node.SelectSingleNode(\"IssueCode\").Text\n                strReso = Node.SelectSingleNode(\"ResolutionCode\").Text\n\n                .Cells(LRow, 1).Value = strBugValue\n                .Cells(LRow, 2).Value = strStatusCode\n                .Cells(LRow, 3).Value = strSeverity\n                .Cells(LRow, 4).Value = strPriority\n                .Cells(LRow, 5).Value = strIssue\n                .Cells(LRow, 6).Value = strReso\n\n                LRow = LRow + 1\n            Next Node\n        End With\n        Set xmlhtp = Nothing\n        Set xmlDoc = Nothing\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4916703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c42d31911af889e2e95b172f0892fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ami Khan", "link": "https://stackoverflow.com/users/4916703/ami-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2297, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529347480, "creation_date": 1465404760, "last_edit_date": 1531164843, "question_id": 37708505, "link": "https://stackoverflow.com/questions/37708505/get-node-values-from-soap-response-using-vba", "title": "Get node values from SOAP response using VBA", "body": "<p>I have returned a response from SOAP web services using VBA code. I want to obtain the node values from the response. I have looked across forums for examples but none appear to do exactly what I want. The closest thread which is similar to my situation is the one below:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36456388/vba-excel-macro-selectsinglenode-returns-nothing\">VBA Excel Macro SelectSingleNode returns nothing</a></p>\n\n<p>Any examples or assistance on how to get started would be appreciated.</p>\n\n<p>Sample XML Request in VBA:</p>\n\n<pre><code>'Set Reference to Microsoft XML, v6.0\nOption Explicit\n\nDim responseText As String\nDim sURL As String\nDim sEnv As String\nDim xmlhtp As New MSXML2.XMLHTTP\nDim xmlDoc As New DOMDocument\nDim webserviceSOAPActionNameSpace\n\nSub test()\n\nsURL = \"http://soap.qacomplete.smartbear.com/psWS.asmx?wsdl\"\n\nsEnv = \"&lt;?xml version =\"\"1.0\"\" encoding=\"\"utf-8\"\"?&gt;\"\nsEnv = sEnv &amp; \"&lt;soap:Envelope xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\" xmlns:xsd=\"\"http://www.w3.org/2001/XMLSchema\"\" xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"&gt;\"\nsEnv = sEnv &amp; \"&lt;soap:Body&gt;\"\nsEnv = sEnv &amp; \"&lt;Bugs_LoadByCriteria xmlns=\"\"http://www.pragmaticsw.com/\"\"&gt;\"\nsEnv = sEnv &amp; \"&lt;AuthenticationData&gt;\"\nsEnv = sEnv &amp; \"&lt;AppCode&gt;agSP&lt;/AppCode&gt;\"\nsEnv = sEnv &amp; \"&lt;DeptId&gt;81842&lt;/DeptId&gt;\"\nsEnv = sEnv &amp; \"&lt;ProjId&gt;92553&lt;/ProjId&gt;\"\nsEnv = sEnv &amp; \"&lt;UserId&gt;147280&lt;/UserId&gt;\"\nsEnv = sEnv &amp; \"&lt;PassCode&gt;Password1&lt;/PassCode&gt;\"\nsEnv = sEnv &amp; \"&lt;/AuthenticationData&gt;\"\nsEnv = sEnv &amp; \"&lt;Condition&gt;&lt;![CDATA[&lt;Conditions xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'\"\nsEnv = sEnv &amp; \" xmlns:xsd='http://www.w3.org/2001/XMLSchema' Operation='opEQU'&gt;\"\nsEnv = sEnv &amp; \"&lt;Items Type='tField'&gt;\"\nsEnv = sEnv &amp; \"&lt;Value xsi:type='xsd:string'&gt;Custom11&lt;/Value&gt;\"\nsEnv = sEnv &amp; \"&lt;/Items&gt;\"\nsEnv = sEnv &amp; \"&lt;Items Type='tString'&gt;\"\nsEnv = sEnv &amp; \"&lt;Value xsi:type='xsd:string'&gt;Finance&lt;/Value&gt;\"\nsEnv = sEnv &amp; \"&lt;/Items&gt;\"\nsEnv = sEnv &amp; \"&lt;/Conditions&gt;]]&gt;\"\nsEnv = sEnv &amp; \"&lt;/Condition&gt;\"\nsEnv = sEnv &amp; \"&lt;/Bugs_LoadByCriteria&gt;\"\nsEnv = sEnv &amp; \"&lt;/soap:Body&gt;\"\nsEnv = sEnv &amp; \"&lt;/soap:Envelope&gt;\"\n\n    With xmlhtp\n\n    webserviceSOAPActionNameSpace = \"http://www.pragmaticsw.com/\"\n\n        .Open \"POST\", sURL, False\n\n        .setRequestHeader \"POST\", \"http://soap.qacomplete.smartbear.com/psWS.asmx HTTP/1.1\"\n        .setRequestHeader \"Content-Type\", \"application/soap+xml; charset=UTF-8\"\n        .setRequestHeader \"SOAPAction\", webserviceSOAPActionNameSpace &amp; \"Bugs_LoadByCriteria\"\n        .setRequestHeader \"Accept-encoding\", \"zip\"\n\n        .send sEnv\n\n        xmlDoc.LoadXML .responseText\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Sample Response XML:</p>\n\n<pre><code>&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n   &lt;soap:Body&gt;\n      &lt;Bugs_LoadByCriteriaResponse xmlns=\"http://www.pragmaticsw.com/\"&gt;\n         &lt;Bugs_LoadByCriteriaResult&gt;\n            &lt;Bug&gt;\n               &lt;CustomFieldNames&gt;\n               &lt;BugId&gt;3253017&lt;/BugId&gt;\n               &lt;Title&gt;DM78 Customer and DM25 Vendor Master Data - default criteria&lt;/Title&gt;\n               &lt;StatusCode&gt;Closed&lt;/StatusCode&gt;\n               &lt;SeverityCode&gt;Minor&lt;/SeverityCode&gt;\n               &lt;PriorityCode&gt;P3&lt;/PriorityCode&gt;\n               &lt;IssueCode&gt;Data&lt;/IssueCode&gt;\n               &lt;ResolutionCode&gt;Fixed&lt;/ResolutionCode&gt;\n               &lt;AssigneeUserId&gt;137784&lt;/AssigneeUserId&gt;\n               &lt;OpenedBy&gt;136840&lt;/OpenedBy&gt;\n               &lt;ClosedBy&gt;137748&lt;/ClosedBy&gt;\n               &lt;ResolvedBy&gt;137748&lt;/ResolvedBy&gt;\n            &lt;/Bug&gt;\n         &lt;/Bugs_LoadByCriteriaResult&gt;\n      &lt;/Bugs_LoadByCriteriaResponse&gt;\n   &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "autofilter"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465404634, "post_id": 37708410, "comment_id": 62890917, "body": "You know this can be done with formulas?  Is the VBA necessary?"}, {"owner": {"reputation": 1, "user_id": 6405117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UP2L9.jpg?s=128&g=1", "display_name": "WannaBeMathGeek", "link": "https://stackoverflow.com/users/6405117/wannabemathgeek"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465427177, "post_id": 37708410, "comment_id": 62902257, "body": "My workbook generates a report to filter pivot tables based on user input (my data table is not static). I have vba code that will change the filters to the data table, and I need to count the results of what is filtered."}, {"owner": {"reputation": 1, "user_id": 6405117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UP2L9.jpg?s=128&g=1", "display_name": "WannaBeMathGeek", "link": "https://stackoverflow.com/users/6405117/wannabemathgeek"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465434404, "post_id": 37708410, "comment_id": 62904175, "body": "also how would you do this without a formula? how would the left function work? you can only reference one cell when doing so. Ex countif(range(left(&quot;text&quot; you would be stuck here because you cannot reference the range, only one cell"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 9148999, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6b5a8f1a95dddd6a0d464b1ace9f51df?s=128&d=identicon&r=PG", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9148999/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1515085163, "creation_date": 1515085163, "answer_id": 48100089, "question_id": 37708410, "link": "https://stackoverflow.com/questions/37708410/counting-characters-in-filtered-cells-vba/48100089#48100089", "title": "Counting characters in filtered cells vba", "body": "<p>If you don't want do do this directly in Excel with an ArrayFormula, then VBA would want to use Range Areas:\n<code></p>\n\n<pre><code>Dim rToCheck As Range, rArea As Range, rCell AS Range\nDim count4u AS Long, count4 AS Long\n\ncount4u = 0\ncount4g = 0\n\nSet rToCheck = Application.Intersect(ThisWorkbook.Worksheets(\"data\").UsedRange,ThisWorkbook.Worksheets(\"data\").Columns(3).SpecialCells(xlCellTypeVisible))\n\nIf Not(rToCheck Is Nothing) Then 'Make sure we have visible cells!\n    For Each rArea In rToCheck\n        For Each rCell In rArea\n            Select Case Left(rCell.Value,4)\n                Case \"CP1U\"\n                    count4u = count4u + 1\n                Case \"CP1G\"\n                    count4g = count4g + 1\n            End Select\n        Next rCell\n    Next rArea\nEnd If\n\nWorksheets(\"Base\").Cells(6,24) = count4u 'Cells(6,24) is Range(\"X6\")\n\nSet rToCheck = Nothing\nSet rArea = Nothing\nSet rCell = Nothing\n</code></pre>\n\n<p></code></p>\n"}], "owner": {"reputation": 1, "user_id": 6405117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UP2L9.jpg?s=128&g=1", "display_name": "WannaBeMathGeek", "link": "https://stackoverflow.com/users/6405117/wannabemathgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515085163, "creation_date": 1465404482, "question_id": 37708410, "link": "https://stackoverflow.com/questions/37708410/counting-characters-in-filtered-cells-vba", "title": "Counting characters in filtered cells vba", "body": "<pre><code>Sub Auto_Open()\nApplication.ScreenUpdating = False\n\nDim count4u As Long  \nDim count4g As Long  \n...\n\nDim i As Double\ni = 4\n\n count4u = 0\n count4g = 0\n count4t = 0\n...\n\nSheets(\"data\").Select\n\n\n\nDo While Cells(i, 3).Value &lt;&gt; \"\"\n Cells(i, 3).Activate\n\n If Left(ActiveCell.Value, 3) = \"CP1\" Then\n\n\n        If Mid(ActiveCell.Value, 4, 1) = \"U\" Then\n    count4u = count4u + 1\n\n     ElseIf Mid(ActiveCell.Value, 4, 1) = \"G\" Then\n        count4g = count4g + 1\n\n    ElseIf Mid(ActiveCell.Value, 4, 1) = \"T\" Then\n    count4t = count4t + 1\n\n    ElseIf Mid(ActiveCell.Value, 4, 1) = \"B\" Then\n    count4b = count4b + 1\n\n    ElseIf Mid(ActiveCell.Value, 4, 1) = \"F\" Then\n    count4f = count4f + 1\n\n  ElseIf Mid(ActiveCell.Value, 4, 1) = \"C\" Then\n    count4c = count4c + 1\nEnd If\n\n ...\n\n\n\n\n\ni = i + 1\nLoop\n\nWorksheets(\"Base\").Activate\nRange(\"X6\") = count4u\n...\nCall cp2count\n\n\nEnd Sub\n</code></pre>\n\n<p>I have tried a couple of different solutions, one trying to use a for each loop and Range(\"C4\", Range(\"C4\").End(xldown)).SpecialCells(xlCellTypeVisible). The other time i just tried selecting the cells with specialcells(xlcelltypevisible) and loop through it the way I have it. I am having a problem being able to count the character in the 4th/5th position without using the activecell function. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465413276, "post_id": 37708316, "comment_id": 62895913, "body": "Let&#39;s talk in these comment and not ping Sgdva every time.  Give me an example of one of the formulas you use to color the cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465419142, "post_id": 37708316, "comment_id": 62899070, "body": "I need to see what formula you use for one of the conditional formatting if I am to help in any way, there is not silver bullet.  I need to use that formula to help modify another formula to get what you want."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465420993, "post_id": 37708316, "comment_id": 62899913, "body": "Sure thing. The spreadsheet comes from a sharepoint list, so the formatting is from the dashboard it creates. I have two basic conditions, they both look almost the same:&lt;DIV style=&#39;font-weight:bold; font-size:24px; font-size:24px; color:green;&#39;&gt;\u2022&lt;/DIV&gt; and &lt;DIV style=&#39;font-weight:bold; font-size:24px; font-size:24px; color:red;&#39;&gt;\u2022&lt;/DIV&gt;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465421426, "post_id": 37708316, "comment_id": 62900109, "body": "No, why does one get set to red and the other to green?  Not the code itself but why.  Under what conditions does it set the color?"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465423143, "post_id": 37708316, "comment_id": 62900900, "body": "@Scott Craner, the color is determined by a number of things, being what the other fields are set to at the time. So if next review date = today, then it will be set to red, otherwise, green."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465423252, "post_id": 37708316, "comment_id": 62900951, "body": "okay so we do <code>SUMIFS(columnToSum,NextReviewDateColumn,INT(TODAY()))</code> for sum."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465423346, "post_id": 37708316, "comment_id": 62900989, "body": "For Count: <code>COUNTIF(NextReviewDateColumn,INT(TODAY()))</code> and for average <code>AVERAGEIFS(columnToAverage,NextReviewDateColumn,INT(TODAY())&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465424422, "post_id": 37708316, "comment_id": 62901396, "body": "Ok, so I might be doing something wrong here, but I added the formula that you told me to for the countif: =COUNTIF(L5:L300,INT(TODAY())) and it is giving me 10, though there are only 9 green cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465425270, "post_id": 37708316, "comment_id": 62901666, "body": "Then the criteria is wrong somehow.  See if you can find the tenth one that has today&#39;s date and see why it is not green."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465425714, "post_id": 37708316, "comment_id": 62901793, "body": "I only have 9 visible rows, and all the dates are today or greater than today, Not sure what is going on, but thanks for trying to help."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465404829, "post_id": 37708486, "comment_id": 62891026, "body": "If you read the code, OP has <code>Set rng = ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible)</code>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465405062, "post_id": 37708486, "comment_id": 62891162, "body": "My bad, didn&#39;t read the first line, just read those: If f = &quot;&quot; Then         f = &quot;&lt;DIV style=&#39;font-weight:bold; font-size:24px; font-size:24px; <b>color:orange</b>;&#39;&gt;\u2022&lt;/DIV&gt;&quot; The color here is never going to be solved, however and yet again, if the filter already filtered by oranges for example, why to check color again?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1465405256, "post_id": 37708486, "comment_id": 62891295, "body": "Color given by conditional formatting <b>can</b> be read through VBA using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838814.aspx\" rel=\"nofollow noreferrer\">Range.DisplayFormat property</a>."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1465407154, "post_id": 37708486, "comment_id": 62892380, "body": "So I am using this SpecialCells(xlCellTypeVisible) in my code, as you can see above."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1465408482, "post_id": 37708486, "comment_id": 62893110, "body": "Hi Sgdva, the reason I am looking at the colors of the cells is to get an average of the green vs red or orange."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 1, "creation_date": 1465408818, "post_id": 37708486, "comment_id": 62893308, "body": "@Mike You can do this with formulas based on the condition that sets the color instead of the color itself."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465409254, "post_id": 37708486, "comment_id": 62893586, "body": "@Jeeped As an OT: Holly where you were when I asked that years ago? I couldn&#39;t find it anywhere and had to do a workaround for those scenarios. However, I tried to set an argument to the function and returns value, though, as warned in the site, it doesn&#39;t work for UDF. Mike, either Jeeped or Scott approach should work, IMHO: I&#39;d go with the Display format to avoid a second check for the thing that colored the cells in the first place."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465413184, "post_id": 37708486, "comment_id": 62895865, "body": "@Scott Craner, Hi Scott, this sounds interesting, how would I do this? I don&#39;t really need a step by step, just something to get me started."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1465414996, "post_id": 37708486, "comment_id": 62896799, "body": "@Mike did you see my comment above from 28 minutes ago?"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465418973, "post_id": 37708486, "comment_id": 62898982, "body": "@Scott Crane So it would appear that this doesn&#39;t work. I did the Formulas --&gt; more functions, statistical averageif(A6:A300,A6,E3) and it gives me back the same results regardless of which filter is being used."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1465419075, "post_id": 37708486, "comment_id": 62899034, "body": "@mike let&#39;s move this conversation to the comments under you question."}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1465404699, "creation_date": 1465404699, "answer_id": 37708486, "question_id": 37708316, "link": "https://stackoverflow.com/questions/37708316/counting-only-visible-cells-that-have-been-condtionally-formatted/37708486#37708486", "title": "Counting only visible cells that have been condtionally formatted", "body": "<p>Color given by conditional formatting can't be read through VBA. <br>\nHowever, if you filter the data prior to it, why don't you try:</p>\n\n<pre><code>SpecialCells(xlCellTypeVisible)\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465404699, "creation_date": 1465404158, "last_edit_date": 1531161705, "question_id": 37708316, "link": "https://stackoverflow.com/questions/37708316/counting-only-visible-cells-that-have-been-condtionally-formatted", "title": "Counting only visible cells that have been condtionally formatted", "body": "<p>So I am starting to think this just can't be done, here is to hoping that someone here will be able to help me out.</p>\n\n<p>The jist of it is that I have an excel 2013 application that I am working on, it gets data from a sharepoint list, which I filter. The deal is that I apply conditional formatting to a couple of columns in this list, simply to fill in the background color to green or red, based on the text in the cell. Next, I need to get the average of the visible cells, not all the cells that have been formatted, just the ones that are showing up via the filter that I have applied.</p>\n\n<p>Anyway, my code:</p>\n\n<pre><code>Dim rng As Range\nDim i As Integer\nDim row As Range\n\nSet rng = ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible)\n'Set rng = Range(\"A5:A150\")\n'For i = 1 To rng.Areas.count\n\nFor i = 1 To rng.Areas.Count\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp)(1).Resize(rng.Areas(i).Rows.Count, rng.Areas(i).Columns.Count) _\n    = rng.Areas(i).Value\n\n    f = ActiveSheet.Cells(i, i).Value\n    If f = \"\" Then\n        f = \"&lt;DIV style='font-weight:bold; font-size:24px; font-size:24px; color:orange;'&gt;\u2022&lt;/DIV&gt;\"\n    End If\n\n    c = (\"&lt;DIV style='font-weight:bold; font-size:24px; font-size:24px; color:green;'&gt;\u2022&lt;/DIV&gt;\")\n    s = f\n\n    If s = c Then\n        Count = Count + 1\n    Else\n        count2 = count2 + 1\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465404047, "post_id": 37708222, "comment_id": 62890551, "body": "I never understand why people know they need a loop then proceed not to google loop XD"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465404121, "post_id": 37708222, "comment_id": 62890594, "body": "I did google loop, the main thing i dont understand is how to change the copy/paste statement so that they dont just copy the same cell however many times the loop is run"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465404151, "post_id": 37708222, "comment_id": 62890610, "body": "Then please put the code for your loop in your OP so we can help you."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465405065, "post_id": 37708222, "comment_id": 62891166, "body": "I updated what ive tried so far, like i said, what i dont understand is how to get the data to copy from each new row"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465405493, "post_id": 37708508, "comment_id": 62891445, "body": "i updated the code with the stuff i tried for looping now it just doesnt copy any data at all"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465405988, "post_id": 37708508, "comment_id": 62891728, "body": "also i get an error that just says &quot;400&quot; and the solution i used to fix it before is already in place"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 1, "creation_date": 1465406622, "post_id": 37708508, "comment_id": 62892073, "body": "Your loop looks fine, a bit unconventional in that the if statement is only doing something that can be defined directly in the loop statement.  But it shouldn&#39;t be giving you any errors and should break when the cell is equal to &quot;&quot; like you want."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465406983, "post_id": 37708508, "comment_id": 62892287, "body": "what about in that long list of copy/pastes where i define the row number as the value of x? when i run the macro step by step it give me an error that says &quot;application defined or object defined error&quot;"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 1, "creation_date": 1465407894, "post_id": 37708508, "comment_id": 62892747, "body": "You don&#39;t define the row number as the value of x. In the source sheet row values are hardcoded.  In destsheet they are defined by lMaxRows+2.  Try going through a walkthrough on loops.  It will probably take you less then an hour and will give you a couple working examples on how to use variables in loops"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465408087, "post_id": 37708508, "comment_id": 62892849, "body": "sorry i forgot to update the code when i updated my comment, ill see what i can figure out, thanks for the help"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 1, "creation_date": 1465409666, "post_id": 37708508, "comment_id": 62893819, "body": "use range(&quot;B&quot; &amp; x) for using a variable."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": true, "score": 1, "last_activity_date": 1465404763, "creation_date": 1465404763, "answer_id": 37708508, "question_id": 37708222, "link": "https://stackoverflow.com/questions/37708222/excel-macro-to-copy-data-on-a-loop-until-a-blank-row-is-hit-error/37708508#37708508", "title": "excel macro to copy data on a loop until a blank row is hit error", "body": "<p>I would do it the same way you found your next cell to paste in. </p>\n\n<p><code>LastRow = sourceSheet.range(\"E8\").end(xldown).row</code>  Then </p>\n\n<p><code>For curRow = 8 to LastRow</code></p>\n\n<p>Or to check for actual blanks something like <code>Do while sourcesheet.range(\"E\" &amp; curRow).value&lt;&gt;\"\"</code></p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 37708508, "answer_count": 1, "score": 0, "last_activity_date": 1465407931, "creation_date": 1465403885, "last_edit_date": 1465407931, "question_id": 37708222, "link": "https://stackoverflow.com/questions/37708222/excel-macro-to-copy-data-on-a-loop-until-a-blank-row-is-hit-error", "title": "excel macro to copy data on a loop until a blank row is hit error", "body": "<p>I am trying to write a macro with VBA that will copy the data from my table in a sheet tiled \"Front End\" to a table on another sheet called \"Raw Data\". these two table are picture below </p>\n\n<p><a href=\"https://i.stack.imgur.com/AEtNL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AEtNL.png\" alt=\"enter image description here\"></a></p>\n\n<p>for now I am only dealing with the green table above</p>\n\n<p><a href=\"https://i.stack.imgur.com/j0pOF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j0pOF.png\" alt=\"enter image description here\"></a></p>\n\n<p>here is my code so far for the copying and pasting into the other sheet in the next empty row:</p>\n\n<pre><code>Sub transfer()\n    Dim x As Long\n'set starting point at row 8\n    x = 8\n    Dim BlankFound As Boolean\n'defines the sheet the data is being coppied from\n    Dim sourceSheet As Worksheet: Set sourceSheet = ThisWorkbook.Worksheets(\"Front End\")\n'defines the sheet the data is being pasted into\n    Dim destSheet As Worksheet: Set destSheet = ThisWorkbook.Worksheets(\"Raw Data\")\n\n    Do While BlankFound = False\n\n'selects the next row where the 1st column is empty\n        lMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n'pastes the data from the specified cells into the next empty row\n            'destSheet.range(\"A\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"C2\").Value\n destSheet.range(\"M\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"E2\").Value\n destSheet.range(\"N\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"E4\").Value\n destSheet.range(\"P\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"G4\").Value\n destSheet.range(\"Q\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"C4\").Value\n destSheet.range(\"O\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"I3\").Value\n destSheet.range(\"B\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Bx\").Value\n destSheet.range(\"L\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Cx\").Value\n destSheet.range(\"F\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Dx\").Value\n destSheet.range(\"G\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Ex\").Value\n destSheet.range(\"I\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Gx\").Value\n destSheet.range(\"K\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Hx\").Value\n destSheet.range(\"H\" &amp; lMaxRows + 2).Value = sourceSheet.range(\"Nx\").Value\n\n        x = x + 1\n        If Cells(x, \"E\").Value = \"\" Then\n        BlankFound = True\n        end if\n    Loop\nEnd sub\n</code></pre>\n\n<p>I need to have the macro copy each row from the green table to the next empty row in the \"Raw Data\" sheet until the macro hits an \"actual cycles\", column E, that is empty.</p>\n\n<p>Any help is appreciated, thank you! </p>\n"}, {"tags": ["javascript", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1465414900, "post_id": 37711243, "comment_id": 62896744, "body": "Your first statement can&#39;t be true because I&#39;ve had a message box fire in that event when testing this. Are you saying that it won&#39;t <i>consistently/reliably</i> fire? That would make a lot of sense as to why I&#39;d be having this issue then. Could you help me out with an example of what you&#39;re talking about doing?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1465415741, "post_id": 37711243, "comment_id": 62897223, "body": "Correction: it looks like mailto: links AND sending from Word does fire the event.  But right-clicking a file and choosing Send To -&gt; Mail recipient does not fire the event (that uses the SendMail.dll, which breaks a lot of things; which Word use to use). Otherwise the event should always fire. However, I seem to recall that closing an Inspector during the Activate event may be problematic.  A timer could still be a workaround."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1465416034, "post_id": 37711243, "comment_id": 62897397, "body": "how or where would I implement a timer for this situation though? In what event? Can you provide an example?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1465423879, "post_id": 37711243, "comment_id": 62901193, "body": "You can declare a System.Windows.Forms.Timer object in your current class and handle the Tick event.  Create the object variable at the point when your class is created or any other time you want (maybe in Initialize_handler).  Set the Interval to 60000 to check every minute or less"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 1, "last_activity_date": 1465414060, "creation_date": 1465414060, "answer_id": 37711243, "question_id": 37707663, "link": "https://stackoverflow.com/questions/37707663/outlook-inspector-window-not-consistently-closing-automatically-when-triggered-v/37711243#37711243", "title": "Outlook Inspector Window not consistently closing automatically when triggered via Javascript Mailto code on webpage", "body": "<p>The problem is that emails that are created from an external process (eg. mailto: links, send from Word, etc.) do not fire the NewInspector event.  You'll have to use a timer to detect when Inspectors.Count change and set a hook into the newly added Inspector.  Then you can trap its events.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1465562417, "creation_date": 1465562417, "answer_id": 37748552, "question_id": 37707663, "link": "https://stackoverflow.com/questions/37707663/outlook-inspector-window-not-consistently-closing-automatically-when-triggered-v/37748552#37748552", "title": "Outlook Inspector Window not consistently closing automatically when triggered via Javascript Mailto code on webpage", "body": "<p>In addition to Eric's answer, you also need to make sure that you have a list of inspectors and hence mail items - there can be more than one item open at the same time.</p>\n"}], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593468351, "creation_date": 1465402177, "last_edit_date": 1593468351, "question_id": 37707663, "link": "https://stackoverflow.com/questions/37707663/outlook-inspector-window-not-consistently-closing-automatically-when-triggered-v", "title": "Outlook Inspector Window not consistently closing automatically when triggered via Javascript Mailto code on webpage", "body": "<p>I'm attempting to automatically close an Outlook Inspector Window that is automatically opened after clicking on a button that has a Javascript <code>mailto:</code> call linked to it (injected). I thought I was using the right Outlook events, but maybe not. What I'm currently doing is subscribing to the <code>Inspectors_NewInspector</code> and <code>Inspector_Activate</code> events in order to detect when the window opens/becomes visible, then I'm trying to close it from within the <code>Inspector_Activate</code> event. The only reason I need the email at all is in order to trigger other VBA code to execute upon the specific button in the web browser being clicked, as well as reading the subject of the email. Since there appear(s/ed) to be no direct way to control Outlook from Javascript that doesn't involve using Internet Explorer (I'm using Chrome) or the Microsoft Office API I came to the conclusion that this is the best way for me to go about it. </p>\n\n<p><strong>My current problem:</strong></p>\n\n<p>I can read data from the new email/Inspector window, but can't consistently get the window to close automatically. It'll only close automatically intermittently. Other times I'm left with a frozen Inspector window in which I can only close by clicking the red X of the window. Nothing else is even clickable in the window.</p>\n\n<p><img src=\"https://i.imgur.com/oZ5hqDG.jpg\" alt=\"Inspector Window\"> </p>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>I've attempted to place calls to close the window in various spots throughout the code; some errored and others did nothing. I've tried putt <code>DoEvents</code> Loops in various spots throughout the code; all waiting for different things to load, but they either had no effect or got stuck in infinite loops. I can't even tell you how many times I've made Outlook crash while trying to figure this out. What's more, is while attempting to debug the issue I receive the same readings for a successful case as I do an unsuccessful case. The first portion below is a successful execution where the code automatically closes the window and the second one the window was still open after the code was done.</p>\n\n<p>Output in Immediate Window:</p>\n\n<pre><code>m_Inspectors_NewInspector Event: 1\nBeginning m_Inspectors_Activate Event: 1\nClosing\nShould be closed\nEnd m_Inspectors_Activate Event: 0\n------------------------------------------------------\nm_Inspectors_NewInspector Event: 1\nBeginning m_Inspectors_Activate Event: 1\nClosing\nShould be closed\nEnd m_Inspectors_Activate Event: 0\n------------------------------------------------------\n</code></pre>\n\n<p><strong>What I currently have:</strong></p>\n\n<p>Below is my code in the <code>ThisOutlookSession</code>:</p>\n\n<pre><code>Private WithEvents m_Inspectors As Inspectors\nPrivate WithEvents m_Inspector As Inspector\nPrivate WithEvents Mail As MailItem\n\nPublic Sub Initialize_handler()\n    Set m_Inspectors = Application.Inspectors\nEnd Sub\n\nPrivate Sub m_Inspectors_NewInspector(ByVal Inspector As Inspector)\n    If TypeOf Inspector.CurrentItem Is Outlook.MailItem Then\n        'Handle emails only\n        Set m_Inspector = Inspector\n        Debug.Print \"m_Inspectors_NewInspector Event: \" &amp; m_Inspectors.Count\n    End If\nEnd Sub\n\nPrivate Sub m_Inspector_Activate()\n    Debug.Print \"Beginning m_Inspectors_Activate Event: \" &amp; m_Inspectors.Count\n    Dim Mail As Object\n    DoEvents\n    Set Mail = m_Inspector.CurrentItem\n    If Mail Is Nothing Then Debug.Print \"Mail is Nothing\": Exit Sub\n\n    If Mail.To = \"velo@automated.com\" Then\n        Dim clipB As String, DataObj As MsForms.DataObject\n        Select Case Mail.Subject\n            Case \"Import\", \"Export\"\n                Set DataObj = New MsForms.DataObject\n                DataObj.GetFromClipboard\n                clipB = DataObj.GetText(1)\n                'MsgBox (IIf(Mail.Subject = \"Import\", \"Import for \", \"Export for \") &amp; clipB)\n                Mail.Close olDiscard\n                Set Mail = Nothing\n                'Set m_Inspector = Nothing\n            Case Else\n                MsgBox (\"Hmm\")\n                Exit Sub\n        End Select\n    End If\n    Debug.Print \"End m_Inspectors_Activate Event: \" &amp; m_Inspectors.Count\n    Debug.Print \"------------------------------------------------------\"\n    Set m_Inspector = Nothing\nEnd Sub\n\nPrivate Sub Mail_Close(Cancel As Boolean)\n    Cancel = False\nEnd Sub\n\nPrivate Sub m_Inspector_Close()\n    'MsgBox (\"Close!\")\n    Debug.Print \"Closing\"\n    'Set m_Inspector = Nothing\n    Debug.Print \"Should be closed\"\nEnd Sub\n</code></pre>\n\n<p>And for sake of completeness, here is the relevant part of my injected Javascript code:</p>\n\n<pre><code>$(document).on('click', 'button.btn-large:nth-child(3)', function(){\n    var fullsupplier;\n    fullsupplier = document.getElementById(\"asinum\").innerHTML + \" \" + document.getElementById(\"supplierName\").innerHTML;\n    //alert(fullsupplier);\n    copyTextToClipboard(fullsupplier);\n    window.location.href = \"mailto:velo@automated.com?subject=Import\";\n});\n\n$(document).on('click', 'button.btn-large:nth-child(1)', function(){\n    var fullsupplier;\n    fullsupplier = document.getElementById(\"asinum\").innerHTML + \" \" + document.getElementById(\"supplierName\").innerHTML;\n    //alert(fullsupplier);\n    copyTextToClipboard(fullsupplier);\n    window.location.href = \"mailto:velo@automated.com?subject=Export\";\n});\n</code></pre>\n\n<p><strong>My Question:</strong></p>\n\n<p>What am I doing wrong? How can I make the Inspector Window <em>always</em> close automatically instead of intermittently?</p>\n"}, {"tags": ["html", "vba", "class", "internet-explorer", "href"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465405239, "post_id": 37707429, "comment_id": 62891283, "body": "<code>getElementByClass</code> is not a thing - did you mean <code>getElementsByClassName</code> ?  Also - the actual method returns a collection, not a single element, so you&#39;d need something like <code>btnObject(0).FireEvent (&quot;onclick&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 6431987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd8dcd99e67e964f8ea116b44d0c7c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sega", "link": "https://stackoverflow.com/users/6431987/sega"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465406291, "post_id": 37707429, "comment_id": 62891885, "body": "Actually  i just give a shot for the <code>getElementByClass</code>, and now i change the code to: <code>Set elems = </code> <code>.document.getElementsByClassName(&quot;bt-acessar-login radius&quot;)</code>            ` For Each e In elems`            <code>If (e.getAttribute(&quot;onclick&quot;) = &quot;validarFornecedor()&quot;) Then</code>                 <code>e.SetFocus</code>                 <code>e.Click</code>                 <code>Exit For</code>             <code>End If</code>             <code>Next e</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6431987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd8dcd99e67e964f8ea116b44d0c7c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sega", "link": "https://stackoverflow.com/users/6431987/sega"}, "is_accepted": true, "score": 0, "last_activity_date": 1465407403, "creation_date": 1465407403, "answer_id": 37709261, "question_id": 37707429, "link": "https://stackoverflow.com/questions/37707429/can-i-click-on-a-button-by-de-href-or-the-class/37709261#37709261", "title": "Can i click on a button by de href or the class?", "body": "<p>i search some more and find this code who works for me !</p>\n\n<pre><code>Set elems = .document.getElementsByClassName(\"bt-acessar-login radius\")\n        For Each e In elems\n        If (e.getAttribute(\"onclick\") = \"validarFornecedor()\") Then\n            e.Focus\n            e.Click\n            Exit For\n        End If\n        Next e\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6431987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd8dcd99e67e964f8ea116b44d0c7c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sega", "link": "https://stackoverflow.com/users/6431987/sega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 37709261, "answer_count": 1, "score": 0, "last_activity_date": 1465580308, "creation_date": 1465401475, "last_edit_date": 1465580308, "question_id": 37707429, "link": "https://stackoverflow.com/questions/37707429/can-i-click-on-a-button-by-de-href-or-the-class", "title": "Can i click on a button by de href or the class?", "body": "<p>I'm current trying to click on a button but it has no id or class name, just class and href.</p>\n\n<p>The html code is:</p>\n\n<pre><code>&lt;a href=\"#\" class=\"bt-acessar-login radius\" onclick=\"validarFornecedor()\" ;=\"\"&gt;\n  &lt;i&gt;&lt;/i&gt;\n  &lt;span&gt;Acessar sistema&lt;/span&gt;\n  &lt;div class=\"clear\"&gt;&lt;/div&gt;\n &lt;/a&gt;\n</code></pre>\n\n<p>And the vba code I tried is:</p>\n\n<pre><code>Set btnObject = .document.getElementByClass(\"bt-acessar-login radius\")\nbtnObject.FireEvent (\"onclick\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1465399302, "post_id": 37706632, "comment_id": 62887174, "body": "<code>Set rngTest = [M5]</code> because you qualified <code>M5</code> to the active sheet at the time of that line. Edit: you want <code>Set rngTest = shtTest.range(&quot;M5&quot;)</code> inside the loop."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465399810, "post_id": 37706632, "comment_id": 62887574, "body": "Ah ok. I wasn&#39;t aware that Active Sheet was assumed like that. I tried doing your suggestion of setting <code>rngTest</code> inside the loop but neglected to use the <code>shtTest</code> so I will try that."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465399839, "post_id": 37706632, "comment_id": 62887593, "body": "As a follow-up to what @findwindow said I would like to add that your first code will work if you <code>Activate</code> the sheet first: <code>shtTest .Activate</code> or <code>rngTest.Parent.Activate</code>. You can only select a cell on the currently active sheet."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "edited": false, "score": 0, "creation_date": 1465399930, "post_id": 37706632, "comment_id": 62887660, "body": "Why isn&#39;t <code>[M5]</code> qualified in the same way?"}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1465400110, "post_id": 37706632, "comment_id": 62887822, "body": "@ralph that gives me the same 1004 error once it reaches <code>rngTest.Select</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465400287, "post_id": 37706632, "comment_id": 62887964, "body": "Your second code isn&#39;t any different to the first. It would only select M5 on each sheet if the code activated each sheet."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465401016, "post_id": 37706632, "comment_id": 62888527, "body": "@Rory you are quite correct. I could swear when I was trying it before creating this post it worked."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465401092, "post_id": 37706632, "comment_id": 62888592, "body": "Perhaps you had selected multiple sheets inadvertently before running it? Or you had run it on each sheet so M5 was already selected? ;)"}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465404921, "post_id": 37706632, "comment_id": 62891073, "body": "@Rory either way, slightly embarrassing :)"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1465400602, "last_edit_date": 1465400602, "creation_date": 1465400294, "answer_id": 37707043, "question_id": 37706632, "link": "https://stackoverflow.com/questions/37706632/in-avoiding-select-declared-range-variable-works-on-the-activesheet-but-m5-w/37707043#37707043", "title": "In avoiding .Select, Declared Range variable works on the activesheet but [M5] works on all sheets. Why?", "body": "<p>Just for clarification:</p>\n\n<pre><code>Dim rngTest As Range\nDim shtTest As Worksheet\n\nFor Each shtTest In ThisWorkbook.Sheets\n    With shtTest\n        .Range(\"m10\").Value = \"hello\"\n    End With\n    shtTest.Activate\n    Set rngTest = [M5]\n    rngTest.Select\nNext shtTest\n</code></pre>\n\n<p>Yet, I'd recommend not to use <code>[M5]</code> to refer to a particular cell / range. I would also prefer to use <code>Range(\"M5\")</code> or <code>Cells(5, \"M\")</code> or <code>Cells(5, 13)</code> instead.</p>\n"}], "owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 37707043, "answer_count": 1, "score": 1, "last_activity_date": 1465400602, "creation_date": 1465399190, "last_edit_date": 1531161705, "question_id": 37706632, "link": "https://stackoverflow.com/questions/37706632/in-avoiding-select-declared-range-variable-works-on-the-activesheet-but-m5-w", "title": "In avoiding .Select, Declared Range variable works on the activesheet but [M5] works on all sheets. Why?", "body": "<p>I've been working through some of the ideas in <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How To Avoid Using Select in Excel VBA Macros</a>. I have 3 sheets in my test workbook and want to move the cursor to a specific cell on each sheet after other actions have been carried out. The following enters the cell value but only moves the activecell to M5 on the initial sheet:</p>\n\n<pre><code>Dim rngTest As Range\nDim shtTest As Worksheet\n\nSet rngTest = [M5]\n\nFor Each shtTest In ThisWorkbook.Sheets\n    With shtTest\n        .Range(\"m10\").Value = \"hello\"\n    End With\n    rngTest.Select\nNext shtTest\n</code></pre>\n\n<p>Where as this does what I want (enters the cell value then move to M5 on each sheet):</p>\n\n<pre><code>Dim rngTest As Range\nDim shtTest As Worksheet\n\nSet rngTest = [M5]\n\nFor Each shtTest In ThisWorkbook.Sheets\n    With shtTest\n        .Range(\"m10\").Value = \"hello\"\n    End With\n    [M5].Select\nNext shtTest\n</code></pre>\n\n<p>In the top sample I tried making each sheet active first before moving to rngTest but that created the 1004 error.</p>\n\n<p>So, why does [M5].select work whereas rngTest.Select fails?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465400432, "post_id": 37706543, "comment_id": 62888083, "body": "Posting the vba code giving the error would help."}, {"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465400564, "post_id": 37706543, "comment_id": 62888186, "body": "@ChristopherD. I edited my post. That&#39;s for one of the buttons"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465400872, "post_id": 37706543, "comment_id": 62888410, "body": "Try putting <code>Option Explicit</code> at the top of each function and running the code. It should at least get more specific about which variable isn&#39;t being defined."}, {"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465401169, "post_id": 37706543, "comment_id": 62888634, "body": "I had that at the top of my module before, but I added it in above every function but still got the same error message"}, {"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1465401266, "post_id": 37706543, "comment_id": 62888698, "body": "Also @ChristopherD. when it gives me that error and I click OK, it doesn&#39;t bring me to the vba editor with any line selected. I just figured it was referring to one of my OnClick() functions but it was very vague as to what the actual problem was"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465401362, "creation_date": 1465398920, "last_edit_date": 1592644375, "question_id": 37706543, "link": "https://stackoverflow.com/questions/37706543/exporting-form-from-one-ms-access-2013-database-to-another-loses-button-function", "title": "Exporting form from one ms access 2013 database to another loses button functionality", "body": "<p>I exported a form from one database to another. The table names and queries are the exact same, so my combo box which lets me select a table still works properly and shows all the tables. I had a button which lets me select a folder location by opening windows explorer. This worked on my original db, but in the new one I get this error:</p>\n<blockquote>\n<p>The expression On Click you entered as the event property setting produced the following error: Variable not defined.</p>\n<p>*The expression may not result in the name of a macro, the name of a user-defined function, or [Event Procedure].</p>\n<p>*There may have been an error evaluating the function, event, or macro.</p>\n</blockquote>\n<p>When I clicked OK however it did not bring me to a line in the VBA code that caused the problem. I am thinking that it's not the code, but somewhere I had to do some configuring but I don't know for sure. This happens for all my buttons. I have an event for each button which is an on click event. I went to the vba editor and checked out if I needed to add in the code but it was already there.</p>\n<p>In the properties sheet of my form, all the events are set up, names of each component are the same so I don't see what could be the problem. How do I get the functionality back without completely redesigning my form?</p>\n<p><strong>Edit:</strong> I don't know much about privacy with respect to VBA coding, but could it have something to do with the fact that all of my button_Click() functions are public in both databases? I feel like it wouldn't but I thought it was worth asking.</p>\n<p><strong>Edit 2:</strong> Here is the code for the button that opens up windows explorer:</p>\n<pre><code>Public Sub pathButton1_Click()\n\n    Dim strPath As String\n    With Me\n        strPath = Left(.pathLabel1.Caption, InStrRev(.pathLabel1.Caption, &quot;/&quot;))\n        strPath = FSBrowse(strStart:=strPath, _\n                           lngType:=msoFileDialogFolderPicker, _\n                           strPattern:=&quot;MS Access Databases,*.ACCDB; *.MDB~&quot; &amp; _\n                                       &quot;All Files,*.*&quot;)\n        If strPath &gt; &quot;&quot; Then .pathLabel1.Caption = strPath\n    End With\n\nEnd Sub\n\nPublic Function FSBrowse(Optional strStart As String = &quot;&quot;, _\n                         Optional lngType As MsoFileDialogType = _\n                             msoFileDialogFolderPicker, _\n                         Optional strPattern As String = &quot;All Files,*.*&quot; _\n                         ) As String\n    Dim varEntry As Variant\n\n    FSBrowse = &quot;&quot;\n    With Application.FileDialog(DialogType:=lngType)\n        'Set the title to match the type used from the list\n        .Title = &quot;Browse for &quot;\n        Select Case lngType\n        Case msoFileDialogOpen\n            .Title = .Title &amp; &quot;File to open&quot;\n        Case msoFileDialogSaveAs\n            .Title = .Title &amp; &quot;File to SaveAs&quot;\n        Case msoFileDialogFilePicker\n            .Title = .Title &amp; &quot;File&quot;\n        Case msoFileDialogFolderPicker\n            .Title = .Title &amp; &quot;Folder&quot;\n        End Select\n        If lngType &lt;&gt; msoFileDialogFolderPicker Then\n            Call .Filters.Clear\n            For Each varEntry In Split(strPattern, &quot;~&quot;)\n                Call .Filters.Add(Description:=Split(varEntry, &quot;,&quot;)(0), _\n                                  Extensions:=Split(varEntry, &quot;,&quot;)(1))\n            Next varEntry\n        End If\n        'Set some default settings\n        .InitialFileName = strStart\n        .AllowMultiSelect = False\n        .InitialView = msoFileDialogViewDetails\n        'Only return a value from the FileDialog if not cancelled.\n        If .Show Then FSBrowse = .SelectedItems(1)\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465398497, "post_id": 37706235, "comment_id": 62886539, "body": "I find the simplest solution to be: Move the file out of the directory once you&#39;ve processed it.  That way the only files in there are the unprocessed ones and when there are none left..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465398626, "post_id": 37706235, "comment_id": 62886638, "body": "For the second code block, why not just add <code>wb.close true</code> after <code>Call ListWorkSheetAndUpdate</code>?"}, {"owner": {"reputation": 19, "user_id": 6429685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b9bef95d58a48641ba0e0694949ce4?s=128&d=identicon&r=PG&f=1", "display_name": "xanadu", "link": "https://stackoverflow.com/users/6429685/xanadu"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465399889, "post_id": 37706235, "comment_id": 62887635, "body": "@Dave Yes, it would be the simplest solution, but i cannot move the files (are shared); saving the processed files somewhere else won&#39;t solve it either, as the code would keep &quot;fishing&quot; xls from the folder I selected."}, {"owner": {"reputation": 19, "user_id": 6429685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b9bef95d58a48641ba0e0694949ce4?s=128&d=identicon&r=PG&f=1", "display_name": "xanadu", "link": "https://stackoverflow.com/users/6429685/xanadu"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465400062, "post_id": 37706235, "comment_id": 62887781, "body": "@findwindow If I add the close&amp;save statement to the second code block it acts like the first one - looping ad infinitum"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465400141, "post_id": 37706235, "comment_id": 62887846, "body": "Then <code>ListWorkSheetAndUpdate</code> is doing something funky because I use the same code and have no problem."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465402333, "post_id": 37706235, "comment_id": 62889390, "body": "Beats me :/ As an side, consider using <code>with</code>."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1465409975, "post_id": 37706235, "comment_id": 62894010, "body": "Should be able to shorten to <code>Worksheets(&quot;Master&quot;).Columns(&quot;A:L&quot;).EntireColumn.AutoFit</code> as well, instead of a line for every column."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 7072445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7LD0.jpg?s=128&g=1", "display_name": "Joel Underwood", "link": "https://stackoverflow.com/users/7072445/joel-underwood"}, "is_accepted": false, "score": 0, "last_activity_date": 1478286031, "creation_date": 1478286031, "answer_id": 40430027, "question_id": 37706235, "link": "https://stackoverflow.com/questions/37706235/open-run-macro-save-close/40430027#40430027", "title": "Open/Run Macro/Save &amp; Close", "body": "<p>Whenever I dealt with a situation where I'm looping through files in a directory, I create a separate worksheet for a log of file paths that have already been iterated through. You can then program your script to only process files that are not yet in the index. It's extra processing, but an easy solution. Once all the files are present in the log, you can wrap up execution.</p>\n"}], "owner": {"reputation": 19, "user_id": 6429685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b9bef95d58a48641ba0e0694949ce4?s=128&d=identicon&r=PG&f=1", "display_name": "xanadu", "link": "https://stackoverflow.com/users/6429685/xanadu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1478286031, "creation_date": 1465398124, "last_edit_date": 1465401719, "question_id": 37706235, "link": "https://stackoverflow.com/questions/37706235/open-run-macro-save-close", "title": "Open/Run Macro/Save &amp; Close", "body": "<p>I'm trying to automate the execution of a macro once on all files in a folder, using this code:</p>\n\n<pre><code>Sub LoopFile()\nDim fso as Object  'Scritping.FileSystemObject\nDim fldr as Object 'Scripting.Folder\nDim file as Object 'Scripting.File\nDim wb as Workbook\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet fldr = fso.GetFolder(\"C:\\DataBanks001\\TEST\\\")\n\nFor Each file In fldr.Files\n    Set wb = Workbooks.Open(file.Path)\n    Call ListWorkSheetAndUpdate\n\n    wb.Close (True)\nNext\n\nSet file = Nothing\nSet fldr = Nothing\nSet fso = Nothing\nEnd Sub\n</code></pre>\n\n<p>The problem is that once all files have been processed it loops back to the beginning and starts again - basically running the same macro on each workbook more than once; a patchwork solution was to use this other code:</p>\n\n<pre><code>Sub AllFiles()\nDim folderPath As String\nDim filename As String\nDim wb As Workbook\n\nfolderPath = \"C:\\DataBanks001\\TEST\\\" \n\nIf Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath + \"\\\"\n\nfilename = Dir(folderPath &amp; \"*.xls\")\nDo While filename &lt;&gt; \"\"\n  Application.ScreenUpdating = False\n    Set wb = Workbooks.Open(folderPath &amp; filename)\n\n    Call ListWorkSheetAndUpdate\n\n    filename = Dir\nLoop\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>which does not close&amp;save, but processes the workbooks only once - however leaving them opened causes excel to crash after their cumulative size gets too big.<br>\nIs there a way to stop the code after the last file in a folder has been processed?</p>\n\n<p>Since my macro creates a new summary sheet in the workbooks, I was thinking a possible workaround was to count the sheets in each opened workbook, and if the number were to be >(n+1) stop the sub. Could this be a possible solution?</p>\n\n<p>@findwindow - The code is the following less some formulas:</p>\n\n<pre><code>Sub ListWorkSheetAndUpdate()\nDim xWs As Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\n\nSheets.Add.Name = \"Master\"\n\nxTitleId = \"KutoolsforExcel\"\nApplication.Sheets(xTitleId).Delete\nApplication.Sheets.Add Application.Sheets(1)\nSet xWs = Application.ActiveSheet\nxWs.Name = xTitleId\nFor I = 2 To Application.Sheets.Count\n    xWs.Range(\"A\" &amp; (I - 1)) = Application.Sheets(I).Name\nNext\nApplication.DisplayAlerts = True\n\nWorksheets(\"Master\").Range(\"A1\").Value = \"Sheet\"\nWorksheets(\"Master\").Range(\"B1\").Value = \"SAE\"\nWorksheets(\"Master\").Range(\"C1\").Value = \"CODE\"\nWorksheets(\"Master\").Range(\"D1\").Value = \"COD_TRX\"\nWorksheets(\"Master\").Range(\"E1\").Value = \"Add Index\"\nWorksheets(\"Master\").Range(\"F1\").Value = \"Add Match\"\nWorksheets(\"Master\").Range(\"G1\").Value = \"Add SIC\"\nWorksheets(\"Master\").Range(\"H1\").Value = \"GRID\"   \nWorksheets(\"Master\").Range(\"J1\").Value = \"VART\"\nWorksheets(\"Master\").Range(\"K1\").Value = \"OP.R\"\n\nWorksheets(\"Master\").Range(\"A2:A101\").Formula = \"=KutoolsforExcel!RC\"\nWorksheets(\"Master\").Range(\"B2:B101\").Formula = \"=INDIRECT(CONCATENATE(RC[-1],\"\"!A1\"\"))\"\nWorksheets(\"Master\").Range(\"C2:C101\").Formula = \"=RIGHT(LEFT(RC[9],LEN(RC[9])-14),5)\"\nWorksheets(\"Master\").Range(\"D2:D101\").Formula = \"=RIGHT(LEFT(LEFT(RC[8],LEN(RC[8])-14),LEN(LEFT(RC[8],LEN(RC[8])-14))-5),LEN(LEFT(LEFT(RC[8],LEN(RC[8])-14),LEN(LEFT(RC[8],LEN(RC[8])-14))-5))-(FIND(\"\"~\"\",SUBSTITUTE(LEFT(LEFT(RC[8],LEN(RC[8])-14),LEN(LEFT(RC[8],LEN(RC[8])-14))-5),\"\",\"\",\"\"~\"\",(LEN(LEFT(LEFT(RC[8],LEN(RC[8])-14),LEN(LEFT(RC[8],LEN(RC[8])-14))-5))-LEN(SUBSTITUTE(LEFT(LEFT(RC[8],LEN(RC[8])-14),LEN(LEFT(RC[8],LEN(RC[8])-14))-5),\"\",\"\",\"\"\"\"))))))-1)\"\nWorksheets(\"Master\").Range(\"E2:E101\").Value = \"!A:D\"\nWorksheets(\"Master\").Range(\"F2:F101\").Value = \"!C:C\"\nWorksheets(\"Master\").Range(\"G2:G101\").Value = \"!A:A\"\nWorksheets(\"Master\").Range(\"H2:H101\").Formula = \"=INDEX(INDIRECT(CONCATENATE(RC[-7],RC[-3])),MATCH(R1C8,INDIRECT(CONCATENATE(RC[-7],RC[-2])),0),4)\"   \nWorksheets(\"Master\").Range(\"J2:J101\").Formula = \"=INDEX(INDIRECT(CONCATENATE(RC[-9],RC[-5])),MATCH(R1C10,INDIRECT(CONCATENATE(RC[-9],RC[-3])),0),2)\"\nWorksheets(\"Master\").Range(\"K2:K101\").Formula = \"=INDEX(INDIRECT(CONCATENATE(RC[-10],RC[-6])),MATCH(R1C11,INDIRECT(CONCATENATE(RC[-10],RC[-4])),0),2)\"\n\n\nWorksheets(\"Master\").Columns(\"A:A\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"B:B\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"C:C\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"D:D\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"E:E\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"F:F\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"G:G\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"H:H\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"I:I\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"J:J\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"K:K\").EntireColumn.AutoFit\nWorksheets(\"Master\").Columns(\"L:L\").EntireColumn.AutoFit\n\nSheets(\"KutoolsforExcel\").Visible = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1465398330, "post_id": 37706229, "comment_id": 62886394, "body": "<code>GetSUM</code> isn&#39;t returning anything and what&#39;s the point of the function if you don&#39;t pass anything in and are hardcoding the month within?"}, {"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1465398556, "post_id": 37706229, "comment_id": 62886583, "body": "From what I can see, your syntax for referencing the other sheet is 100%"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1465498925, "post_id": 37708583, "comment_id": 62939663, "body": "@daba did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1465404999, "creation_date": 1465404999, "answer_id": 37708583, "question_id": 37706229, "link": "https://stackoverflow.com/questions/37706229/excel-vba-function-get-data-form-another-workbook/37708583#37708583", "title": "Excel VBA function get data form another workbook", "body": "<p>you miss a \"\\\" before the first \"[\"</p>\n\n<pre><code>strRef = \"'\" &amp; strPath &amp; \"\\[\" &amp; strFile &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 2729412, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79acd7b870c49585a414a9ba4e3d2446?s=128&d=identicon&r=PG&f=1", "display_name": "daba", "link": "https://stackoverflow.com/users/2729412/daba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1465562553, "creation_date": 1465398108, "question_id": 37706229, "link": "https://stackoverflow.com/questions/37706229/excel-vba-function-get-data-form-another-workbook", "title": "Excel VBA function get data form another workbook", "body": "<p>Need to get data corresponding for specific client from a cell from another workbook for corresponding month, every month new sheet is added, for example, \"01.2016\", \"02.2016\", \"03.2016\"</p>\n\n<p>Can I automate with VBA function?</p>\n\n<pre><code>  Function GetSUM()\n\n  Dim strPath, strFile, strSheet, strRng, strRef, Result As String\n\n  strPath = \"\\\\Report_2016\"\n  strFile = \"File_name_2016.xls\"  \n  strSheet = \"06.2016\"\n  strRng = Range(\"C59\").Address(3, 59, xlR1C1)\n\n  strRef = \"'\" &amp; strPath &amp; \"[\" &amp; strFile &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\n\n  End Function\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465399433, "post_id": 37705837, "comment_id": 62887265, "body": "How do you trigger <code>ShowForm1</code> - from a ribbon button?"}], "answers": [{"tags": [], "owner": {"reputation": 4741, "user_id": 6405587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tJdlv.jpg?s=128&g=1", "display_name": "Sudharsan Selvaraj", "link": "https://stackoverflow.com/users/6405587/sudharsan-selvaraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1465397979, "creation_date": 1465397979, "answer_id": 37706166, "question_id": 37705837, "link": "https://stackoverflow.com/questions/37705837/unable-to-click-excels-button-after-running-a-form/37706166#37706166", "title": "Unable to click Excel&#39;s button after running a form", "body": "<p>Try adding below line after unloading the form.</p>\n\n<p>Application.ScreenUpdating = False </p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 4330383, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0ce202cbbb6abd0f6f2a1d9518d38f3?s=128&d=identicon&r=PG", "display_name": "Chris Newman", "link": "https://stackoverflow.com/users/4330383/chris-newman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536804539, "creation_date": 1536804539, "answer_id": 52305691, "question_id": 37705837, "link": "https://stackoverflow.com/questions/37705837/unable-to-click-excels-button-after-running-a-form/52305691#52305691", "title": "Unable to click Excel&#39;s button after running a form", "body": "<p>Have you tried placing a debug stopper on the unload me and stepping through with key F8 to see what happens when you reach this point in the code? </p>\n\n<p>The reason I ask is I had the exact same problem and forgot that I had some code tied to the <strong>UserForm_Terminate()</strong> event that was causing the userform to still appear in the background (invisible). I was messing around with \"<strong>EnableWindow Application.hWnd</strong>\" and I needed to make sure I shut the userform down a specific way in order not to \"freeze\" the screen.</p>\n"}], "owner": {"reputation": 379, "user_id": 6134241, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7145cec770657cc6c03eb2b91f5f6798?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/6134241/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544849892, "creation_date": 1465397222, "last_edit_date": 1544849892, "question_id": 37705837, "link": "https://stackoverflow.com/questions/37705837/unable-to-click-excels-button-after-running-a-form", "title": "Unable to click Excel&#39;s button after running a form", "body": "<p>First I run:</p>\n\n<pre><code>Sub ShowForm1()\n   form1.Show\nend sub\n</code></pre>\n\n<p>then form1 pops up</p>\n\n<p>After that, I click at image1 (on form1) so the following code is run:</p>\n\n<pre><code>Private Sub image1_Click()\n    Unload Me\n    form2.Show\nEnd Sub\n</code></pre>\n\n<p>then form2 pops up</p>\n\n<p>On form2 I click on cancelButton so the following code is run:</p>\n\n<pre><code>Private Sub cancelButton_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>After that, I am unable to click on any cell of the worksheet. Actually, after running this code I am unable to click at any excel button at all (Save, File, Home)</p>\n\n<p>Does anyone knows why this is happening?</p>\n\n<p>I am using Excel 2013 and this code is running on an add-in.</p>\n\n<p>Note: Running the below code</p>\n\n<pre><code>Sub ShowForm2()\n   form2.Show\nend sub\n</code></pre>\n\n<p>and clicking on the cancelButton afterward doesn't cause this problem to happen.</p>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5485923, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/897e21c551bb30b2909b577e6613b225?s=128&d=identicon&r=PG&f=1", "display_name": "Dler Ari", "link": "https://stackoverflow.com/users/5485923/dler-ari"}, "edited": false, "score": 0, "creation_date": 1465457432, "post_id": 37706130, "comment_id": 62911428, "body": "This is good, is it possible to clear filter only on one column?"}, {"owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "reply_to_user": {"reputation": 21, "user_id": 5485923, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/897e21c551bb30b2909b577e6613b225?s=128&d=identicon&r=PG&f=1", "display_name": "Dler Ari", "link": "https://stackoverflow.com/users/5485923/dler-ari"}, "edited": false, "score": 0, "creation_date": 1465463677, "post_id": 37706130, "comment_id": 62915244, "body": "You can clear the filter for columns that you apply the filter."}], "tags": [], "owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "is_accepted": false, "score": 0, "last_activity_date": 1465397880, "creation_date": 1465397880, "answer_id": 37706130, "question_id": 37705781, "link": "https://stackoverflow.com/questions/37705781/clear-filter-when-there-is-no-text-in-textfield/37706130#37706130", "title": "Clear filter when there is no text in TextField", "body": "<p>Try this :</p>\n\n<pre><code>Private Sub TextBox2_Change()\n    Sheet1.Range(\"A2:CM\" &amp; Rows.Count).AutoFilter Field:=2, Criteria1:=\"*\" &amp; TextBox2.Value &amp; \"*\"\n    If TextBox2.Value = Empty Then Sheet1.Range(\"A2:CM\" &amp; Rows.Count).AutoFilter\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5485923, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/897e21c551bb30b2909b577e6613b225?s=128&d=identicon&r=PG&f=1", "display_name": "Dler Ari", "link": "https://stackoverflow.com/users/5485923/dler-ari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465397880, "creation_date": 1465397086, "question_id": 37705781, "link": "https://stackoverflow.com/questions/37705781/clear-filter-when-there-is-no-text-in-textfield", "title": "Clear filter when there is no text in TextField", "body": "<p>I have a textfield which I use to search inside a spesific column. The problem is that after I am done searching and deleted the text from the textfield. The \"filter symbol\" does not go away? </p>\n\n<p><a href=\"https://i.stack.imgur.com/dFLW5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dFLW5.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want an simple VBA code that allows me to remove this filter when there is no more text inside the textfield. Here is the code for textfield searching: </p>\n\n<pre><code>Private Sub TextBox2_Change()\n        Sheet1.Range(\"A2:CM\" &amp; Rows.Count).AutoFilter Field:=2, Criteria1:=\"*\" &amp; TextBox2.Value &amp; \"*\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy"], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465397042, "post_id": 37705604, "comment_id": 62885428, "body": "ok so i did this and used F8 to step through the code, everything was fine and dandy until it tried to do the last step &quot;selection.paste&quot;  I did it again and in the same place it gave me a box saying &quot;run-time error &#39;1004&#39;: application-defined or object-defined error&quot;"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1465397129, "post_id": 37705604, "comment_id": 62885490, "body": "There&#39;s no <code>Selection.Paste</code> in the above code... I posted too soon and had to edit it to correct it, you may have gotten the info before my edit was submitted"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1465397180, "last_edit_date": 1465397180, "creation_date": 1465396642, "answer_id": 37705604, "question_id": 37705426, "link": "https://stackoverflow.com/questions/37705426/excel-error-400-when-copying-to-a-different-sheet/37705604#37705604", "title": "Excel error 400 when copying to a different sheet", "body": "<p>VBA will use whatever the active sheet is if you have not fully qualified the workbook/worksheet you want it to use.  Try something like this:</p>\n\n<pre><code>Sub transfer()\nDim sourceSheet as Worksheet : Set sourceSheet = ThisWorkbook.Worksheets(\"Front End\")\nDim destSheet as Worksheet : Set destSheet = ThisWorkbook.Worksheets(\"Raw Data\")\nlMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n\ndestSheet.Range(\"A\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"C2\").Value\n\nEnd Sub\n</code></pre>\n\n<p>For copying a value directly from one place to another you don't need to use copy, paste or select; you can just set the value of one to be the value from another.</p>\n"}, {"tags": [], "owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1465397202, "last_edit_date": 1495540353, "creation_date": 1465397202, "answer_id": 37705830, "question_id": 37705426, "link": "https://stackoverflow.com/questions/37705426/excel-error-400-when-copying-to-a-different-sheet/37705830#37705830", "title": "Excel error 400 when copying to a different sheet", "body": "<p>Change <code>Selection.Paste</code> to <code>Selection.PasteSpecial Paste:=xlPasteValues</code> seems working for me :</p>\n\n<pre><code>Sub transfer()\n\nRange(\"C2\").Select\nSelection.Copy\nWorksheets(\"Raw Data\").Select\nlMaxRows = Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"A\" &amp; lMaxRows + 1).Select\n'Selection.Paste\nSelection.PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n\n<p>Reference : <a href=\"https://stackoverflow.com/questions/6778759/copying-and-pasting-data-using-vba-code\">Copying and pasting data using VBA code</a></p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1698, "favorite_count": 0, "accepted_answer_id": 37705604, "answer_count": 2, "score": 0, "last_activity_date": 1465397202, "creation_date": 1465396248, "question_id": 37705426, "link": "https://stackoverflow.com/questions/37705426/excel-error-400-when-copying-to-a-different-sheet", "title": "Excel error 400 when copying to a different sheet", "body": "<p>I have looked at 100 different solutions for fixing this error that keeps showing up. its a pop up box with only the number \"400\" and an OK button.</p>\n\n<p>the sheet im copying from is called \"Front End\"</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>Sub transfer()\n\nrange(\"C2\").Select\nSelection.Copy\nWorksheets(\"Raw Data\").Select\nlMaxRows = Cells(Rows.Count, \"A\").End(xlUp).Row\nrange(\"A\" &amp; lMaxRows + 1).Select\nSelection.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Im just trying to get the hang of moving data from one sheet to the next empty row in another sheet but keep getting this error. any help would be greatly appreciated as I am extremely new to VBA</p>\n"}, {"tags": ["arrays", "excel", "dictionary", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1465398496, "post_id": 37705421, "comment_id": 62886537, "body": "Where are you reading that? I would think with the inordinate number of posts online about how to sort a dictionary or collection, that the sort order is maintained, otherwise why bother sorting it. It also seems unreasonable that the order would be changed by some mysterious activity happening on the dictionary object."}, {"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1465401716, "post_id": 37705421, "comment_id": 62889025, "body": "Thanks for your reply, but I&#39;m not doing any sorting of items. I simply want to know that if I add items 1, 2, 3, 4 (in that order), then read the items in a For.. Each loop, I don&#39;t get 1, 4, 3, 2."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1465401889, "post_id": 37705421, "comment_id": 62889137, "body": "That&#39;s my point though. If so many folks have gone through the trouble of writing dictionary sorting logic then it makes sense that a dictionary order is maintained. Otherwise the sorting logic would be pointless. I&#39;m with you. I don&#39;t believe that a dictionary can have it&#39;s items reordered arbitrarily."}, {"owner": {"reputation": 99, "user_id": 14797724, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c45029add57e94cbc9938064caea72ac?s=128&d=identicon&r=PG", "display_name": "user14797724", "link": "https://stackoverflow.com/users/14797724/user14797724"}, "edited": false, "score": 0, "creation_date": 1610649253, "post_id": 37705421, "comment_id": 116206159, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> is the contractual docs. It makes no mention of order so don&#39;t assume one."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465481121, "post_id": 37709620, "comment_id": 62927851, "body": "Thanks for your info - I&#39;m curious what you mean by the &quot;indexed enumeration unreliable when the dictionary&#39;s .Count exceeds a signed integer (32,767)&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465501140, "post_id": 37709620, "comment_id": 62940909, "body": "I was putting together a rewrite of dictionary documentation and discovered &#39;unreliable results&#39; with a large number of dictionary keys. Until I complete testing under a wider number of conditions, I cannot pinpoint the problem so I used the term &#39;unreliable&#39;."}, {"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465582783, "post_id": 37709620, "comment_id": 62979058, "body": "Can you provide any case that you found unreliable?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465584155, "post_id": 37709620, "comment_id": 62979806, "body": "Well, you could test this yourself by seeding a large number of rows and building a dictionary of keys and items from that then regurgitating them back to the same worksheet and comparing them. As far as my own experience goes, until I can reproduce empirical trials that show bad results in several versions of Excel (in both 32-bit and 64-bit) I will simply use the term &#39;unreliable&#39;. To state unevivocaly that something does not work with a smaller test bench would be &#39;unresponsible&#39;. My original rogue results could have been nothing more than a corrupt environment."}, {"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465586325, "post_id": 37709620, "comment_id": 62980818, "body": "I&#39;ve already done what you suggested (up to 1M items) with no bad results."}, {"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465586524, "post_id": 37709620, "comment_id": 62980902, "body": "You probably know this, but all items can be returned into an array by using Array()=dict.items. Same for keys. Using For Each k In dict.Items causes the items array to be generated only one, then iterated over by the For..Each statement. This is very fast. I have noticed that using a"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 2, "creation_date": 1465586954, "post_id": 37709620, "comment_id": 62981121, "body": "... and all keys or items can be used in a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow noreferrer\">Range.AutoFilter Method</a> like <code>.AutoFilter Field:=2, Criteria1:=dict.Keys, Operator:=xlFilterValues</code>. Yes a dictionary is a powerful tool."}, {"owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1465587174, "post_id": 37709620, "comment_id": 62981226, "body": "Sorry - did not finish comment above. You probably know this, but all items can be returned into an array by using Array()=dict.items. Same for keys. Using For Each k In dict.Items causes the items array to be generated only one, then iterated over by the For..Each statement. This is very fast. I have noticed that referencing an item or key by index is very slow in a loop because each time dic.Items(a) or dic.Keys(a) appears, the whole array is extracted again just to get the one item or key."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "edited": false, "score": 0, "creation_date": 1478207066, "post_id": 37709620, "comment_id": 68072657, "body": "@JohnM Is the direct lookup faster than accessing the key or item by index? e.g. <code>dict(key)</code> vs <code>dict.Items(i)</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 7, "last_activity_date": 1465408525, "creation_date": 1465408525, "answer_id": 37709620, "question_id": 37705421, "link": "https://stackoverflow.com/questions/37705421/prove-that-excel-vba-scripting-dictionary-does-not-preserve-order-of-item-insert/37709620#37709620", "title": "Prove that Excel VBA Scripting.Dictionary does not preserve order of item insertion", "body": "<p>No one can provide an example of a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"noreferrer\">Scripting.Dictionary</a> object returning keys/items in a different order than they were added because a Scripting.Dictionary <strong>does not do that</strong>. Never. If you add the following key/item pairs in a progressive order then that is the ways they are returned.</p>\n\n<pre><code>key  item\n 1    A\n 2    B\n 3    C\n 4    D\n\n'enumerate by key\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndict.Add Key:=1, Item:=\"A\"\ndict.Add Key:=2, Item:=\"B\"\ndict.Add Key:=3, Item:=\"C\"\ndict.Add Key:=4, Item:=\"D\"\n\nDim k As Variant\nFor Each k In dict.Keys\n    Debug.Print k &amp; \" - \" &amp; dict.Item(k)\nNext k\n</code></pre>\n\n<p>You might be referring to the shorthand 'overwrite' method of adding keys without checking to see it they exist. If you try to <a href=\"https://msdn.microsoft.com/en-us/library/5h92h863.aspx\" rel=\"noreferrer\">.Add</a> a key that exists error 457 is thrown. However, if you simply write <a href=\"https://msdn.microsoft.com/en-us/library/etzd1tzc.aspx\" rel=\"noreferrer\">Keys</a> and <a href=\"https://msdn.microsoft.com/en-us/library/8aet97f2.aspx\" rel=\"noreferrer\">Items</a> into the dictionary a new key and item will be created if the key does not exist but if the key exists the key remains the same and the item is overwritten.</p>\n\n<pre><code>key  item\n 1    A\n 2    B\n 3    C\n 4    D\n 2    E\n\n'enumerate by key\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndict.Item(1) = \"A\"\ndict.Item(2) = \"B\"\ndict.Item(3) = \"C\"\ndict.Item(4) = \"D\"\ndict.Item(2) = \"E\"     'the second entry's item is overwritten\n\nDim k As Variant\nFor Each k In dict.Keys\n    Debug.Print k &amp; \" - \" &amp; dict.Item(k)\nNext k\n</code></pre>\n\n<p>The overwrite method is a little faster than checking if a key <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251562.aspx\" rel=\"noreferrer\">.Exists</a> but the behavior should be understood. I've used the overwrite to intentionally retrieve the last item for any key in a list with duplicate keys but that was a special case. Note that the <strong>2</strong> <a href=\"https://msdn.microsoft.com/en-us/library/1ex01tte.aspx\" rel=\"noreferrer\">.Key</a> is not out of original order; it has merely had its <a href=\"https://msdn.microsoft.com/en-us/library/84k9x471.aspx\" rel=\"noreferrer\">.Item</a> replaced with the later one.</p>\n\n<p>If you have added the Microsoft Scripting Runtime reference library you can use <a href=\"https://msdn.microsoft.com/en-us/library/0tcf61s1.aspx\" rel=\"noreferrer\">Early Binding</a> in your variable declaration. This has the benefit of creating a slightly faster dictionary object and exposing other methods of indexed enumeration.</p>\n\n<pre><code>Dim dict As New Scripting.Dictionary\n\n'enumerate by index position (zero-based index)\nDim i As Long\nFor i = 0 To dict.Count - 1\n    Debug.Print dict.Keys(i) &amp; \" - \" &amp; dict.Items(i)\nNext i\n\n'enumerate as elements of an array\nDim a As Long\nFor a = LBound(dict.Keys) To UBound(dict.Keys)\n    Debug.Print dict.Keys(a) &amp; \" - \" &amp; dict.Items(a)\nNext a\n</code></pre>\n\n<p>fwiw, I've found this indexed enumeration unreliable when the dictionary's <a href=\"https://msdn.microsoft.com/en-us/library/5t9h9579.aspx\" rel=\"noreferrer\">.Count</a> exceeds a signed integer (32,767).</p>\n\n<p>Finally, key/item pairs can be removed one at a time or all at once.</p>\n\n<pre><code>dict.Remove 2                              'remove by key\n\ndict.Remove dict.Keys(0)                   'remove first key/item by index position\ndict.Remove dict.Keys(UBound(dict.Keys))   'remove last key/item by index position\n\ndict.RemoveAll                             'remove all\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 1968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556507f1ca115d243295dd50f80372d3?s=128&d=identicon&r=PG", "display_name": "JohnM", "link": "https://stackoverflow.com/users/1968225/johnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3247, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1465501292, "creation_date": 1465396244, "last_edit_date": 1531164843, "question_id": 37705421, "link": "https://stackoverflow.com/questions/37705421/prove-that-excel-vba-scripting-dictionary-does-not-preserve-order-of-item-insert", "title": "Prove that Excel VBA Scripting.Dictionary does not preserve order of item insertion", "body": "<p>I'm trying to decide whether to use Excel VBA Collection or Dictionary for my project. For several reasons, I lean toward dictionary, but I keep reading that when using a <code>For.. Each</code> loop to retrieve dictionary items or when reading items from the dictionary Items() array, the order of retrieval may not be the order in which items were added. This would be a serious problem for my application, so I have tried many test cases trying to prove this order mismatch actually occurs. So far, I have not been able to create a scenario where this happens, including adding and removing items in random order.</p>\n\n<p>Can anyone provide an example that proves the retrieval order does not match the order of insertion for the Excel VBA Scripting.Dictionary?</p>\n"}, {"tags": ["vba", "excel", "for-loop", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465395726, "post_id": 37705118, "comment_id": 62884372, "body": "You mean make this work in VBA? use range(&quot;a1&quot;) and replace FIND with instr  Mid(range(a1).value, instr(1,range(&quot;a1&quot;).value,&quot;:&quot;)....."}, {"owner": {"reputation": 712, "user_id": 6430027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f78a373cd59d67005e32407d8b0663e?s=128&d=identicon&r=PG&f=1", "display_name": "Mono", "link": "https://stackoverflow.com/users/6430027/mono"}, "edited": false, "score": 0, "creation_date": 1465395871, "post_id": 37705118, "comment_id": 62884503, "body": "Your title says VB Script, your text says VBA. What do you need?"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1465396449, "post_id": 37705118, "comment_id": 62884947, "body": "VBA, sorry about the confusion!"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1465397537, "post_id": 37705527, "comment_id": 62885812, "body": "Hey Dave, so probably a dumb question, but as that code parses through the cells in column A, I need the output of the code to be in B1, B2, etc. Do I use the offset function after &quot;Next&quot; in the above code?"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1465397826, "post_id": 37705527, "comment_id": 62886026, "body": "Amazing! Thanks Dave! I definitely wouldn&#39;t have been able to get that on my own. I really appreciate it."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1465397662, "last_edit_date": 1465397662, "creation_date": 1465396452, "answer_id": 37705527, "question_id": 37705118, "link": "https://stackoverflow.com/questions/37705118/converting-excel-formula-to-vba-for-mid-and-find-functions/37705527#37705527", "title": "Converting Excel formula to VBA for Mid and Find functions", "body": "<p>You can get the column length (or last row) dynamically using the following:</p>\n\n<pre><code>dim ws as Worksheet\nSet ws = Thisworkbook.Worksheets(\"mySheetNameHere\")\ndim lastRow, myLoop, semicolPos, bracketPos\nlastRow = ws.Cells(ws.rows.count, \"A\").End(xlUp).Row ' this gets last row in col A\n\nFor myLoop = 1 to lastRow\n    ' Find the position of the \";\"  and the \"(\" \n    semicolPos = InStr(ws.Range(\"A\" &amp; myLoop).Value, \":\") + 1\n    bracketPos = InStr(ws.Range(\"A\" &amp; myLoop).Value, \"(\")\n    newValue = Mid(ws.Range(\"A\" &amp; myLoop).Value, semicolPos, bracketPos - semicolPos)\n    ' Put newValue into column B, one cell over from column A\n    ws.Range(\"B\" &amp; myLoop).Value = newValue\nNext\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "accepted_answer_id": 37705527, "answer_count": 1, "score": -1, "last_activity_date": 1465397662, "creation_date": 1465395537, "last_edit_date": 1531164843, "question_id": 37705118, "link": "https://stackoverflow.com/questions/37705118/converting-excel-formula-to-vba-for-mid-and-find-functions", "title": "Converting Excel formula to VBA for Mid and Find functions", "body": "<p>I'm really struggling on converting the excel formula below to VBA. The function below I would assume need to be within a for loop, and needs to descend down a dynamic column length. I've searched around trying to write the script myself, but I just can't seem to get it to run without an error.</p>\n\n<p>=MID(A1,FIND(\":\",A1)+1,FIND(\"(\",A1)-FIND(\":\",A1)-1)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 6440803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D98yT5PT4e0/AAAAAAAAAAI/AAAAAAAAK-Y/ZMTbdx4Br7M/photo.jpg?sz=128", "display_name": "Mark Buege", "link": "https://stackoverflow.com/users/6440803/mark-buege"}, "edited": false, "score": 0, "creation_date": 1465414248, "post_id": 37705079, "comment_id": 62896422, "body": "Works Great!! Thanks for your help"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1465403899, "creation_date": 1465403899, "answer_id": 37708228, "question_id": 37705079, "link": "https://stackoverflow.com/questions/37705079/loop-data-validation-list-and-print-to-pdf-in-current-folder/37708228#37708228", "title": "Loop data validation list and print to PDF in current folder", "body": "<p>Only a couple minor changes to get what you want. It was easier to add my example code to your post to show you.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Loop_Through_List()\n    Dim cell                  As Excel.Range\n    Dim rgDV                  As Excel.Range\n    Dim DV_Cell               As Excel.Range\n    Dim folderPath            As String\n\n    folderPath = \"c:\\hardcodedPathOrCallGetFolderOnceHere\"\n    'folderPath = GetFolder()\n\n    Set DV_Cell = Range(\"B1\")\n\n    Set rgDV = Application.Range(Mid$(DV_Cell.Validation.Formula1, 2))\n    For Each cell In rgDV.Cells\n        DV_Cell.Value = cell.Value\n        PDFActiveSheet folderPath\n    Next\nEnd Sub\n\nSub PDFActiveSheet(Optional ByVal folderPath As String = \"\")\n    Dim ws                    As Worksheet\n    Dim myFile                As Variant\n    Dim strFile               As String\n    Dim sFolder               As String\n    On Error GoTo errHandler\n\n    Set ws = ActiveSheet\n\n    'enter name and select folder for file\n    ' start in current workbook folder\n    strFile = ws.Range(\"B1\").Value &amp; \" Period \" &amp; ws.Range(\"J1\").Value\n\n    If folderPath = \"\" Then\n        '--- if no folder path is specified, then default to\n        '    the same path as the active workbook\n        folderPath = ActiveWorkbook.Path\n        If Len(folderPath) = 0 Then\n            '--- to force Excel to have a path (instead of no\n            '    path at all), use the current directory\n            '    notation\n            folderPath = \".\"\n        End If\n    End If\n    myFile = folderPath &amp; \"\\\" &amp; strFile\n\n    ws.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=myFile, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False, _\n            From:=1, _\n            To:=2\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n\nFunction GetFolder() As String\n    Dim dlg                   As FileDialog\n    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)\n    dlg.InitialFileName = ThisWorkbook.Path &amp; \"\\\"\n    dlg.Title = \"Select folder to save PDFs\"\n    If dlg.Show = -1 Then\n        GetFolder = dlg.SelectedItems(1)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6440803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D98yT5PT4e0/AAAAAAAAAAI/AAAAAAAAK-Y/ZMTbdx4Br7M/photo.jpg?sz=128", "display_name": "Mark Buege", "link": "https://stackoverflow.com/users/6440803/mark-buege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 986, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1465403899, "creation_date": 1465395439, "last_edit_date": 1531161705, "question_id": 37705079, "link": "https://stackoverflow.com/questions/37705079/loop-data-validation-list-and-print-to-pdf-in-current-folder", "title": "Loop data validation list and print to PDF in current folder", "body": "<p>I was able to get code to loop through my validation list and have it print to PDF for each of the items in the list.  Is there a way for me to have it print to the current folder so it doesn't ask me every time which folder I want to use?  I just wasn't sure exactly how to adjust the code or even if it could be done.</p>\n\n<pre><code>Sub Loop_Through_List()\n    Dim cell                  As Excel.Range\n    Dim rgDV                  As Excel.Range\n    Dim DV_Cell               As Excel.Range\n\n    Set DV_Cell = Range(\"B1\")\n\n    Set rgDV = Application.Range(Mid$(DV_Cell.Validation.Formula1, 2))\n    For Each cell In rgDV.Cells\n        DV_Cell.Value = cell.Value\n        Call PDFActiveSheet\n    Next\nEnd Sub\n\nSub PDFActiveSheet()\n    Dim ws                    As Worksheet\n    Dim myFile                As Variant\n    Dim strFile               As String\n    Dim sFolder               As String\n    On Error GoTo errHandler\n\n    Set ws = ActiveSheet\n\n    'enter name and select folder for file\n    ' start in current workbook folder\n    strFile = ws.Range(\"B1\").Value &amp; \" Period \" &amp; ws.Range(\"J1\").Value\n\n    sFolder = GetFolder()\n    If sFolder = \"\" Then\n        MsgBox \"No folder selected. Code will terminate.\"\n        Exit Sub\n    End If\n    myFile = sFolder &amp; \"\\\" &amp; strFile\n\n    ws.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=myFile, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False, _\n            From:=1, _\n            To:=2\n\n    exitHandler:\n        Exit Sub\n    errHandler:\n        MsgBox \"Could not create PDF file\"\n        Resume exitHandler\nEnd Sub\n\nFunction GetFolder() As String\n    Dim dlg                   As FileDialog\n    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)\n    dlg.InitialFileName = ThisWorkbook.Path &amp; \"\\\"\n    dlg.Title = \"Select folder to save PDFs\"\n    If dlg.Show = -1 Then\n        GetFolder = dlg.SelectedItems(1)\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465399639, "post_id": 37704946, "comment_id": 62887427, "body": "Calculated fields are specific to a pivot cache, so no. You&#39;d need to store them in say a Collection/Dictionary, create the new cache and PT, then add the calculated fields again. Then set the cache for the other PTs."}, {"owner": {"reputation": 43, "user_id": 5991658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432d0b2fee5775a7b9b30e879f2757bc?s=128&d=identicon&r=PG&f=1", "display_name": "tee dubbayou", "link": "https://stackoverflow.com/users/5991658/tee-dubbayou"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465492190, "post_id": 37704946, "comment_id": 62935574, "body": "Ah ok thank you. I was hoping there was an easier way. I think my best best is to actually just do the calculations in the sql server table and then have the pivot table pointing to those calculations. Thanks for your help on this"}], "owner": {"reputation": 43, "user_id": 5991658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432d0b2fee5775a7b9b30e879f2757bc?s=128&d=identicon&r=PG&f=1", "display_name": "tee dubbayou", "link": "https://stackoverflow.com/users/5991658/tee-dubbayou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465395032, "creation_date": 1465395032, "question_id": 37704946, "link": "https://stackoverflow.com/questions/37704946/can-i-preserve-calculated-pivot-table-fields-when-setting-pivot-cache-in-vba", "title": "Can I preserve calculated pivot table fields when setting pivot cache in VBA?", "body": "<p>I have a bunch of monthly reports with a sql server connection. Each month I have to refresh the reports and then remove the connection while preserving the pivot tables.</p>\n\n<p>I'm using the following code which works but only for pivot tables with fields that are not calculated fields. The calculated ones are lost when setting the CacheIndex.</p>\n\n<p>I have a lot more code than this, but here's where the problem comes up:</p>\n\n<pre><code>Set PTCache = Wb.PivotCaches.Create( _\n        SourceType:=xlDatabase, _\n        SourceData:=\"Table_ExternalData_15\")\n\nSet pt = PTCache.CreatePivotTable( _\n        TableDestination:=wsTemp.Range(\"A3\"), _\n        TableName:=\"PivotTable1\")\n\nFor Each pt In ws.PivotTables\n                pt.CacheIndex = wsTemp.PivotTables(\"PivotTable1\").CacheIndex\n            Next pt\n</code></pre>\n\n<p>I know I can recalculate the fields in VBA, but I have a lot of reports and I'm not sure how many of them contain pivot tables with calculated fields so being able to preserve them without have to code them would be ideal.</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 6429734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-454pBua4nCA/AAAAAAAAAAI/AAAAAAAAAJY/1u1mDlNwtMk/photo.jpg?sz=128", "display_name": "lonestorm", "link": "https://stackoverflow.com/users/6429734/lonestorm"}, "is_accepted": false, "score": 0, "last_activity_date": 1465398510, "last_edit_date": 1465398510, "creation_date": 1465396420, "answer_id": 37705512, "question_id": 37704859, "link": "https://stackoverflow.com/questions/37704859/how-to-hide-only-some-selected-labels-in-vba/37705512#37705512", "title": "How to hide only some selected labels in vba", "body": "<p>Use <code>.BackColor = 14737632</code> to grey out the disabled text boxes.</p>\n\n<p>It will probably be most efficient to call a separate procedure to toggle textbox properties, such as:</p>\n\n<pre><code>Private Const bgEnabled As Long = -2147483643\nPrivate Const bgDisabled As Long = 14737632\n\nPrivate Sub enableTB(tb As MSForms.TextBox, blEnable As Boolean)\n    If (blEnable) Then\n        With tb\n            .Enabled = True\n            .BackColor = bgEnabled\n        End With\n    Else\n        With tb\n            .Enabled = False\n            .Text = \"\"\n            .BackColor = bgDisabled\n        End With\n    End If\nEnd Sub\n\nPrivate Sub dd_Change()\n' Example code for calling separate procedure to toggle textbox properties based on combobox value\n    Select Case (dd.ListIndex)\n    Case 0\n        enableTB tb1, True\n        enableTB tb2, False\n    Case 1\n        enableTB tb1, False\n        enableTB tb2, True\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5674824, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh4.googleusercontent.com/-ClFB35B2MjE/AAAAAAAAAAI/AAAAAAAAAVY/UacWX6sv8Z8/photo.jpg?sz=128", "display_name": "Prudhvi Charan", "link": "https://stackoverflow.com/users/5674824/prudhvi-charan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465398510, "creation_date": 1465394804, "question_id": 37704859, "link": "https://stackoverflow.com/questions/37704859/how-to-hide-only-some-selected-labels-in-vba", "title": "How to hide only some selected labels in vba", "body": "<p>I have 20 labels and 20 textboxes in my userform. If i select one option from the drop down menu of combobox then 3 labels and 3 textboxes should be locked and If i select another option from the combobox then another 3 labels and 3 textboxes should be locked and so on</p>\n\n<p>I need to show in my userform that when one option is selected from the combobox some textboxes are locked (I accept that we can find that by clicking on the userform and the textbox doesn't accept any inputs) just by looking at the userform. Labels get automatically blurred when they are locked but not textboxes</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1465396351, "post_id": 37704794, "comment_id": 62884876, "body": "How were these worksheets created in the first place? Are they actually very large csv files?"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1465399511, "post_id": 37704794, "comment_id": 62887330, "body": "I&#39;m not sure, I got them as .xlsx files - but it&#39;s evident that they contain more information then they&#39;re presenting."}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1465399599, "post_id": 37705236, "comment_id": 62887401, "body": "I did take the value prior to converting - I was just curious if I could find the range in the xml, once I did I began looking for a method of extracting the range from the xml via vba."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1465399703, "post_id": 37705236, "comment_id": 62887480, "body": "I&#39;ll try your way - there&#39;s a million ways to skin this cat, I just prefer the method I&#39;m using.  If your way will count the truncated rows then that&#39;s awesome - but seeing the &quot;xlCellTypeLastCell&quot; I&#39;d wager it&#39;ll return the same thing mine does - the excel limit."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1465401723, "post_id": 37705236, "comment_id": 62889029, "body": "To get it from the xml, try to open it in a workbook, then look for the text dimension ref=&quot; and do lefts and right to get the text between the &quot;&quot;"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1465406757, "post_id": 37705236, "comment_id": 62892160, "body": "I can&#39;t find how to read the xml from inside the workbook via vba"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1465409744, "post_id": 37705236, "comment_id": 62893882, "body": "You can&#39;t, you need to open it as a workbook, like so:  Workbooks.Open (&quot;&#39;webadress&#39;htp://google.com&quot;) could be local paths or so"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1465395791, "creation_date": 1465395791, "answer_id": 37705236, "question_id": 37704794, "link": "https://stackoverflow.com/questions/37704794/excel-vba-scope-large-files/37705236#37705236", "title": "Excel VBA Scope Large Files", "body": "<p>Why don't you try last cell instead? <br>\nAlso, why don't you take this value prior to turning the .xls to .zip?</p>\n\n<pre><code>Dim LastRow As Long\nDim LastColumn As Long\n\nLastRow = sh.Cells.SpecialCells(xlCellTypeLastCell).Row\nLastColumn = sh.Cells.SpecialCells(xlCellTypeLastCell).Column \n</code></pre>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465395791, "creation_date": 1465394658, "last_edit_date": 1531164843, "question_id": 37704794, "link": "https://stackoverflow.com/questions/37704794/excel-vba-scope-large-files", "title": "Excel VBA Scope Large Files", "body": "<p>Excel 2013 / Win7</p>\n\n<p>Goal: To determine the size: #Rows/#Cols for worksheets too large for excel.</p>\n\n<p>I tried using:</p>\n\n<pre><code>Dim sh as worksheet\nFor each sh in ActiveWorkbook.Sheets\n    'These are just my preferred ways of finding the ending points.\n    LastRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    LastCol = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n    BlahBlah 'code that prints LastRow and LastCol to my userform\nNext sh\n</code></pre>\n\n<p>This works fine, but it only gives me stats for sheets &lt;= the max excel row count</p>\n\n<p>So playing with the files changing the extension from .xlsx to .zip and going to xl/Worksheets/sheet1.xml I noticed this line: <code>\"&lt;dimension ref=\"A3:C178\"/&gt;'</code>What I'm hoping for is a way to grab this for each sheet via vba to scope the sheet that way, but I can't fin a way to grab this ref.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2003"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465401493, "post_id": 37704551, "comment_id": 62888856, "body": "As this is described right now, it&#39;s too confusing to help you right now.. I think there could be a lookup table for User3 / Report Name that would help you a lot - but I really don&#39;t know what the problem looks like. Maybe showing (and labelling)  the other tables and related fields would help"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465405887, "post_id": 37704551, "comment_id": 62891672, "body": "@dbmitch I added some more pictures and tried to describe them as best I could. Hope that helps, thank you again"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465413169, "post_id": 37704551, "comment_id": 62895855, "body": "When you say <code>the correct report</code> do you mean just filter the report appropriately or do you actually have different report objects?"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465413461, "post_id": 37704551, "comment_id": 62896015, "body": "@SunKnight0 I mean just to filter through all of the possible reports (for all of the components) to choose the EDF#&#39;s report. They are all in different Reports though based on their component type. Does that make sense?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465414527, "post_id": 37704551, "comment_id": 62896563, "body": "That means you need two additional tables. One will be a table of all the reports and the second will be a component to report link table. I assume each component needs to be linked to more than one report, if that is not the case then you just need a link field in your components table instead of a separate link table."}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465414911, "post_id": 37704551, "comment_id": 62896750, "body": "@SunKnight0 Each component is only in ONE table and ONE report, it&#39;s just that the collection of components/reports will come from multiple tables. The tables that the components are located in are in the USER3 column. I&#39;m confused about what you mean by <code>link table</code>"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465415642, "post_id": 37704551, "comment_id": 62897167, "body": "If each component is in a separate table/report (so no two components in the same serial number share the same table/report) then you already seem to have what you need. You can open all the relevant reports simultaneously with code similar to what you have in your question. If the possibility exists that you can have two or more components that are from the same table/report, then you cannot do what you want using Preview you can only print (or print to PDF) unless your reports are set up so that by filtering for both/all components that use the same report, you get the result you want."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465415760, "post_id": 37704551, "comment_id": 62897233, "body": "All that of course assumes that you know how to iterate through the components of the selected serial number and extract the table/report for each."}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465416031, "post_id": 37704551, "comment_id": 62897395, "body": "@SunKnight0 Two or more components will definitely be from the same table/report, just not in the example I posed. The only reason I put it in Preview mode was to save on paper if/when the code doesn&#39;t work the way I want it to. In the end, they will all just be printed. All the information is in the table above, it&#39;s just a matter of linking it to all the components with  a specific serial number that I&#39;m having a problem with. I can extract them individually without a problem."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1465416932, "post_id": 37704551, "comment_id": 62897922, "body": "I added some sample code for you. See if it makes sense to give you a place to start. You are a bit unclear on the names of the main table and your combo boxes so I added &#39;placeholder&#39; names."}], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465472892, "post_id": 37712079, "comment_id": 62921367, "body": "Thank you, this looks promising. What do I put in the Rem Print ... section?  <code>DoCmd.OpenReport &quot;RPTManualValve&quot; for d!CATALOG</code>?"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465484169, "post_id": 37712079, "comment_id": 62930175, "body": "The correct reports open up, but the filter isn&#39;t working (it&#39;s showing all of the components in the MV table instead of just the ones selected). The database name is &quot;default_cat&quot;, the main table is &quot;_MASTER_UPLOAD&quot;, and the combobox names are &quot;CustomerSelection&quot; and &quot;SerialNumberSelection&quot; respectively."}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465488163, "post_id": 37712079, "comment_id": 62933183, "body": "Also, no matter how many ways I try to make it work, it doesn&#39;t like that <code>for</code>, it&#39;s expecting a comparative condition like <code>for d!CATALOG = Something </code>. Thank you for all your help thus far. My statement now looks like this: <code>Case &quot;MV&quot;          DoCmd.OpenReport &quot;RPTManualValve&quot;, acViewPreview, , &quot;CATALOG = &#39;&quot; &amp; d!CATALOG &amp; &quot;&#39;&quot;</code>. This opens the correct reports with the FIRST catalog number of that type. Now, we just need all of the rest of the reports of that type to show up. Maybe with a counter?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465490052, "post_id": 37712079, "comment_id": 62934334, "body": "That is because you are still using <code>acViewPreview</code>. If you print they will all print, but you can&#39;t open the same report preview more than once. If you want to test you will have to install a PDF printer or other &quot;print to file&quot; solution, or risk wasting some paper! Or right after DoCmd.OpenReport add a message box and a close command so each report will come up and then close when you click ok on the message box, opening the way for the next report to open."}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465491561, "post_id": 37712079, "comment_id": 62935218, "body": "Perfect. Thank you!"}, {"owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465493424, "post_id": 37712079, "comment_id": 62936321, "body": "I promise just one more thing that I just remembered. We only want 1 of each catalog report though. So for instance, if EDF50-00159 is used 4 times in 1 project, I only want 1 data sheet for that component to print out, not 4. Thank you again for your help"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "edited": false, "score": 0, "creation_date": 1465493743, "post_id": 37712079, "comment_id": 62936528, "body": "Add the keyword <code>DISTINCT</code> to your query, like this: <code>SELECT DISTINCT CATALOG, User3 FROM ...</code> that will only give you the distinct pairs of CATALOG and User3, you will not get repeats."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1465490484, "last_edit_date": 1465490484, "creation_date": 1465416895, "answer_id": 37712079, "question_id": 37704551, "link": "https://stackoverflow.com/questions/37704551/open-correct-reports-based-off-of-combobox-selections/37712079#37712079", "title": "Open correct reports based off of combobox selections", "body": "<pre><code>Dim ThisDB As DAO.Database\nDim d As DAO.Recordset\nDim q As String\n\nSet ThisDB = CurrentDb\nq = \"SELECT CATALOG, User3 FROM [mainSourceTableName] WHERE SerialNumber='\" &amp; Me.[SerialNumberSelected] &amp; \"'\"\nSet d = ThisDB.OpenRecordset(q, dbOpenDynaset)\nd.MoveFirst\nDo While Not d.EOF\n    Select Case d!User3\n        Case \"MV\"\n            Rem Print MV Report for d!CATALOG\n        Case \"FV\"\n            Rem Print FV Report for d!CATALOG\n        Rem same for other tables/reports\n        End Select\n    d.MoveNext\n  Loop  \nd.Close\n</code></pre>\n\n<p>Example for preview with message box:</p>\n\n<pre><code>DoCmd.OpenReport \"RPTManualValve\", acViewPreview, , \"CATALOG = '\" &amp; d!CATALOG &amp; \"'\"\nMsgBox \"Test\"\nDoCmD.Close acReport,\"RPTManualValve\"\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 5103445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cea694324823c1c70c302c2f5626b5ab?s=128&d=identicon&r=PG&f=1", "display_name": "cdomination", "link": "https://stackoverflow.com/users/5103445/cdomination"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 37712079, "answer_count": 1, "score": 0, "last_activity_date": 1465490484, "creation_date": 1465394055, "last_edit_date": 1465405604, "question_id": 37704551, "link": "https://stackoverflow.com/questions/37704551/open-correct-reports-based-off-of-combobox-selections", "title": "Open correct reports based off of combobox selections", "body": "<p>I'm using an Access database in order to store/organize all of the parts for each project. I have 2 comboboxes set up and working correctly: The first is the Customer Name, and once that is selected, the second populates the list of Serial Numbers (project ID numbers) from that Customer. Each project has several components associated with it, in which the reports need to be printed out.</p>\n\n<p>The problem is that most of the component's details are listed in another separate table, so the component number will have to be cross referenced with the table in which it is located and then that report has to be pulled.</p>\n\n<p>This is the table where the comboboxes pull their information from. First the Customer Name, and then the Serial Number associated with that Customer. From there, I want the report from the USER3 table with the associated CATALOG numbers. </p>\n\n<p><a href=\"https://i.stack.imgur.com/mQ116.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mQ116.png\" alt=\"enter image description here\"></a></p>\n\n<p>For example, here are my combobox selections:</p>\n\n<p>CustomerName - choosing CIPLA would give me SerialNumbers of either EF-1092,96, or 99</p>\n\n<p>I pick Serial Number EF-1096 next - which has CATALOG numbers EDF50-00170 (in the MV table from USER3),EDF12-01114 (in the FIL table), and EDF12-00532 (isn't assigned a table).</p>\n\n<p>So, for EDF50-00170, <strong><em>here's the MV Table</em></strong> with all of the information I want out of it (which the MV report automatically includes):\n<a href=\"https://i.stack.imgur.com/nu2MZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nu2MZ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>And here's the corresponding report:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/i1HtB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i1HtB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now is the tricky part where the EDF50-00170, EDF12-01114, and EDF12-00532 reports need to be automatically pulled from the system instead of me having to go find everything manually. This would be the Manual Valve (shown above), Filter, and Misc reports respectively, that have ALL of the Catalog numbers for the category in them. </p>\n\n<p>I already have all of the tables connected to their respective reports, such as this from a previous combobox setup, and I'm assuming this new one will have to be similar:</p>\n\n<pre><code> If partnumberselect.RowSource = \"MV\" Then\n     DoCmd.OpenReport \"RPTManualValve\", acViewPreview, , \"CATALOG = '\" &amp; Me.partnumberselect.value &amp; \"'\"\n</code></pre>\n\n<p>To summarize, I need a group of reports that are associated with a specific Serial Number. Thank you in advance! I'm sorry this is quite the long winded question. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2037567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92dbc55fee3655f79b0e3c42faaac36?s=128&d=identicon&r=PG", "display_name": "SusanMiller", "link": "https://stackoverflow.com/users/2037567/susanmiller"}, "edited": false, "score": 0, "creation_date": 1465454811, "post_id": 37704823, "comment_id": 62909960, "body": "Thank you XOR LX, it seems it can serve my purpose. The following is the formula I am using. =SUMPRODUCT(--(MONTH($&#39;FQ Incidents&#39;.$F$3:$F$32)=C$2);--(YEAR($&#39;FQ Incidents&#39;.$F$3:$F$32)=2016);--(($&#39;FQ Incidents&#39;.$D$3:$D$32=$A$8))). So inorder to have dynamic selection, can i just replace the SUMPRODUCT with COUNTIF ?"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "reply_to_user": {"reputation": 55, "user_id": 2037567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92dbc55fee3655f79b0e3c42faaac36?s=128&d=identicon&r=PG", "display_name": "SusanMiller", "link": "https://stackoverflow.com/users/2037567/susanmiller"}, "edited": false, "score": 0, "creation_date": 1465458825, "post_id": 37704823, "comment_id": 62912304, "body": "Your references look wrong here. Why does &#39;FQ Incidents&#39; have a dollar-sign ($) before it? And why a period (.) after it? And also no exclamation marks (!) anywhere? Surely this syntax will be rejected by Excel, no matter which version you are using? I would&#39;ve thought: SUMPRODUCT(--(MONTH(&#39;FQ Incidents&#39;!$F$3:$F$32)=C$2);--(YEAR(&#39;FQ Incidents&#39;!$F$3:$F$32)=2016);--((&#39;FQ Incidents&#39;!$D$3:$D$32=$A$8))) would be correct."}, {"owner": {"reputation": 55, "user_id": 2037567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92dbc55fee3655f79b0e3c42faaac36?s=128&d=identicon&r=PG", "display_name": "SusanMiller", "link": "https://stackoverflow.com/users/2037567/susanmiller"}, "edited": false, "score": 0, "creation_date": 1465459514, "post_id": 37704823, "comment_id": 62912733, "body": "XOR LX, Workseet 1 contains the columns F and D etc which I use. And I am using worksheet 2 for Summary and this is where I am using the formula referring the worksheet 1. So I am not seeing any errors. Possibly maybe because I am using open office..(i guess). Anyways can I use something like $F:$F for the dynamic selection of column?"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "reply_to_user": {"reputation": 55, "user_id": 2037567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92dbc55fee3655f79b0e3c42faaac36?s=128&d=identicon&r=PG", "display_name": "SusanMiller", "link": "https://stackoverflow.com/users/2037567/susanmiller"}, "edited": false, "score": 0, "creation_date": 1465459798, "post_id": 37704823, "comment_id": 62912911, "body": "Using entire column references within SUMPRODUCT would not at all be a good idea. Try: =COUNTIFS(&#39;FQ Incidents&#39;!$F:$F,&quot;&gt;=&quot;&amp;DATE(2016,C$2,1),&#39;FQ Incidents&#39;!$F:$F,&quot;&lt;&quot;&amp;DATE(2016,C$2+1,1),&#39;FQ Incidents&#39;!$D:$D,$A$8), which is correct for Excel, though I have no idea of how you arrive at the syntax you give, and would not know how to &#39;translate&#39; the above for you if it doesn&#39;t work in Open Office."}], "tags": [], "owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "is_accepted": false, "score": 1, "last_activity_date": 1465394709, "creation_date": 1465394709, "answer_id": 37704823, "question_id": 37704517, "link": "https://stackoverflow.com/questions/37704517/how-to-select-cell-range-dynamically-in-sumproduct-in-excel/37704823#37704823", "title": "How to select cell range dynamically in sumproduct in excel", "body": "<p>Yes, you could define the range dynamically. However, given your current formula, I see no reason why you should not switch to <code>COUNTIF</code> here, i.e.:</p>\n\n<p><code>=COUNTIF(A:A,\"TX\")</code></p>\n\n<p>a function for which the use of entire column referencing (<code>A:A</code> here) has no detriment to performance (which is not at all the case with <code>SUMPRODUCT</code>).</p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 2800413, "user_type": "registered", "profile_image": "https://graph.facebook.com/1402980896/picture?type=large", "display_name": "Fel&#237;cio", "link": "https://stackoverflow.com/users/2800413/fel%c3%adcio"}, "is_accepted": false, "score": 0, "last_activity_date": 1465482630, "creation_date": 1465482630, "answer_id": 37728829, "question_id": 37704517, "link": "https://stackoverflow.com/questions/37704517/how-to-select-cell-range-dynamically-in-sumproduct-in-excel/37728829#37728829", "title": "How to select cell range dynamically in sumproduct in excel", "body": "<p>Shitty recommendations guy, here.</p>\n\n<p>Can you insert a new line above all in your sheet? You could put it really wherever you want and you can even hide it, the first line just works for me.</p>\n\n<p>If you can, just make it an \"count.values\" function on the entire column with an appropriated subtraction to adjust the count to the right length of your data. E.g. Removing this auxiliary cell value plus a header would be \"=count.values(A:A)-2\".</p>\n\n<p>Later, on your VBA, you could retrieve this value to a variable and concatenate it to your main function. Lets say you made the auxiliary on cell A1 (coordinates 1, 1)</p>\n\n<p><code>Dim auxLine As Integer\nauxLine = cells(1, 1).value\nwhatever.formular1c1 = \"=SUMPRODUCT(--(A2:A\" &amp; auxLine &amp; =\"TX\"))\"</code> </p>\n"}], "owner": {"reputation": 55, "user_id": 2037567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92dbc55fee3655f79b0e3c42faaac36?s=128&d=identicon&r=PG", "display_name": "SusanMiller", "link": "https://stackoverflow.com/users/2037567/susanmiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465482630, "creation_date": 1465393979, "last_edit_date": 1531161705, "question_id": 37704517, "link": "https://stackoverflow.com/questions/37704517/how-to-select-cell-range-dynamically-in-sumproduct-in-excel", "title": "How to select cell range dynamically in sumproduct in excel", "body": "<p>I am trying to use Sumproduct dynamically on a sheet that will be updated regularly. </p>\n\n<p>My motive is to not manually select the columns ( i.e. not to use the shift key and down key to select the range A2:A6 as seen in the attached snapshot)</p>\n\n<p>I want to have the formula \"=SUMPRODUCT(--(A2:A6=\"TX\"))\" pick up the A2:A6 dynamically since my data in worksheet say A is everchanging. So that when the data has grown to A8, it can be somehow picked up dynamically than manually using the keys.</p>\n\n<p>Can this be done? Please let me know if my question is not clear.</p>\n\n<p><a href=\"http://i.stack.imgur.com/mmQVj.png\" rel=\"nofollow\">Screenshot of my xls</a></p>\n\n<p>Regards\nSM</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1465560408, "post_id": 37704834, "comment_id": 62965208, "body": "the date format is working fine for me. If I use the date data type its not showing the exact date format ."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1465394737, "creation_date": 1465394737, "answer_id": 37704834, "question_id": 37704335, "link": "https://stackoverflow.com/questions/37704335/how-to-replace-text-based-on-date-in-columns-in-vba-excel/37704834#37704834", "title": "how to replace text based on date in columns in vba excel", "body": "<p>I think a part of your problem lies in this line: <code>Fdate = Format(DateAdd(\"m\", 3, uiResult), \"dd.mm.yyyy\")</code></p>\n\n<p>The <code>Format</code> function returns a string value, not a date, so when you compare it the value in the cell, it is doing a string comparison. Strings compare based on stepping from left to right. As an example, the following test would result in false: <code>\"01.01.2016\" &gt; 02.01.1999\"</code> Clearly, year 2016 is greater than year 1999, but string don't recognize the year, and only recognize that 2 is greater than 1. </p>\n\n<p>A quick workaround is to parse through the date fields in your loop, using code similar to the following:</p>\n\n<pre><code>Sub TestDate()\n    Dim a As Variant\n    Dim dDate As Date\n\n    a = Split(ActiveCell, \".\")\n    dDate = DateSerial(a(2), a(1), a(0))\n\n    MsgBox dDate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465394737, "creation_date": 1465393526, "last_edit_date": 1531164843, "question_id": 37704335, "link": "https://stackoverflow.com/questions/37704335/how-to-replace-text-based-on-date-in-columns-in-vba-excel", "title": "how to replace text based on date in columns in vba excel", "body": "<p>I have a basic data which comprises 16000 rows and 40 columns. Among them i have to compare a column(A) that has dates with the date(Today's date plus 3months) and replace the text in the other column(B). </p>\n\n<p>If the Today's date plus 3months is greater than column(A), it should be replace  <code>90 days</code> with <code>180 days</code>, where we have <code>180 days</code> in the column(B). I have attached a picture with two columns in it.</p>\n\n<p>Problem: Its replacing the text only for few cells and also not deleting the rows that is less than the <code>Today's date plus 3months</code>.</p>\n\n<p>Im taking the date from the userform. Here is code for the userform</p>\n\n<p>userform code:</p>\n\n<pre><code>Option Explicit\n\nPublic Function UserEnteredValue(Optional Prompt As String = \"Please choose current date\", Optional Default As String) As String\n    With Me        \n        .DTPicker1.Value = Date\n        .DTPicker1.SetFocus        \n        .Show\n    End With\n    With UserForm1\n        If .Tag = \"Ok\" Then\n            UserEnteredValue = .DTPicker1.Value\n        End If\n    End With\n    Load UserForm1\nEnd Function\n\nPrivate Sub Cancel_Click()\nUnload UserForm1.DTPicker1.Value\nEnd Sub\n\nPrivate Sub Label1_Click()\nWith Label1\n   'to display text\n    .caption.Text = \"Date is for folder\"\n    'text alignment set to center\n    .TextAlign = fmTextAlignCenter\nEnd With\nEnd Sub\n\nPrivate Sub Ok_Click()\n    Me.Tag = \"Ok\"\n    Me.Hide\nEnd Sub\n\nPrivate Sub userform_initialize()\nMe.DTPicker1.Value = Date\nEnd Sub\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>sub vba()\n\nDim wkb as workbook\nDim p as integer\nDim Fdate as string\nDim uiResult As String \n\nUserForm1.Show                      \n\n uiResult = UserForm1.DTPicker1.Value\n If uiResult = vbNullString Then\n       MsgBox \"canceled\"\n  Els\nEnd If\n\nFdate = Format(DateAdd(\"m\", 3, uiResult), \"dd.mm.yyyy\")\n\nWith wkb.Worksheets(\"abc\").Cells(1, 1)\n\n     For p = .Cells(Rows.Count, \"A\").End(xlUp).row To 2 Step -1\n\n      If Fdate &gt; .Cells(p, \"A\").Value Then\n\n.Cells(p, \"B\").Replace What:=\"(c)  &lt;= 180 Days\", Replacement:=\"(c)  &lt;= 90 Days\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\n\n  Else\n  If Future_date &lt; .Cells(p, \"A\").Value Then\n  .Rows(p).EntireRow.Delete\n\n  End If\n  End If\n Next p\n End With\n\nend sub\n</code></pre>\n\n<p>The problem is. its not showing the exact results what i want. All i need the the macro must replace <code>90 days</code>  with  <code>180 days</code> if <code>Fdate</code> is greater than column(A) dates. if <code>Fdate</code> is less than must delete the entire row.</p>\n\n<p>As i'm getting problem that , replacing the text for all the cell values where we have <code>180 days</code> and deleting only some columns. </p>\n\n<p><a href=\"https://i.stack.imgur.com/dJaUm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dJaUm.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/gKgZP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gKgZP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please someone help me out.\nNote: In the picture you cannot find the <code>180 days</code> because its located somewhere in the 16000 rows. </p>\n"}, {"tags": ["vba", "excel", "dynamic-values"], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465399174, "post_id": 37703963, "comment_id": 62887072, "body": "It seems to update the <code>UsedRange</code> when you use it in a macro. After a bit of testing I found it to be unreliable though. At some point it would adjust the column but not the row and kept including cells that were never filled."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1465392651, "creation_date": 1465392651, "answer_id": 37703963, "question_id": 37703845, "link": "https://stackoverflow.com/questions/37703845/defining-dynamic-ranges-in-vba/37703963#37703963", "title": "Defining dynamic ranges in vba", "body": "<p>You can make use of the <code>UsedRange</code> property that's available on a <code>Worksheet</code> object.</p>\n\n<p>But note that that gives you a <em>watermark</em> used range as opposed to the currently used range; i.e. if you write a value in a cell then remove it, that still comprises the <code>UsedRange</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465398028, "post_id": 37704019, "comment_id": 62886172, "body": "Note that <code>CurrentRegion</code> stops at empty lines/columns which might lead to  undesired behavior if you have sparse data."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": true, "score": 1, "last_activity_date": 1465457433, "last_edit_date": 1465457433, "creation_date": 1465392793, "answer_id": 37704019, "question_id": 37703845, "link": "https://stackoverflow.com/questions/37703845/defining-dynamic-ranges-in-vba/37704019#37704019", "title": "Defining dynamic ranges in vba", "body": "<p><code>Range(Cells(1,1), Cells(lastRow, lastColumn)).offset(,1)</code></p>\n\n<p>or</p>\n\n<p><code>Range(\"A1\").currentregion.offset(,1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1465393046, "creation_date": 1465393046, "answer_id": 37704116, "question_id": 37703845, "link": "https://stackoverflow.com/questions/37703845/defining-dynamic-ranges-in-vba/37704116#37704116", "title": "Defining dynamic ranges in vba", "body": "<pre><code>sub find_last()\n\n    Dim LastRow As Integer\n    Dim LastCol As Integer\n    Dim WS as Worksheet\n\n    Set WS = ThisWorkbook.Worksheets(\"MySheet\")\n\n\n    LastRow = WS.Cells.Find(What:=\"*\", After:=WS.Range(\"A1\"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False, MatchByte:=False).row\n    LastCol = WS.Cells.Find(What:=\"*\", After:=WS.Range(\"A1\"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False, MatchByte:=False).Column\n\n\n    WS.Cells(LastRow, LastCol + 1) = \"MyData\"\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6420722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099afcc4bc62dc82e66727499de454cb?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/6420722/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 0, "accepted_answer_id": 37704019, "answer_count": 3, "score": 0, "last_activity_date": 1465457433, "creation_date": 1465392361, "last_edit_date": 1465393599, "question_id": 37703845, "link": "https://stackoverflow.com/questions/37703845/defining-dynamic-ranges-in-vba", "title": "Defining dynamic ranges in vba", "body": "<p>How do I specify the cell in the column next to the very last cell with data in a spreadsheet e.g. if I have data in</p>\n\n<pre><code>Range(Cells(1, 1), Cells(lastRow, lastColumn))\n</code></pre>\n\n<p>How do I dynamically define</p>\n\n<pre><code>Range(Cells(1, 2), Cells(lastRow, n_lastColumn))\n</code></pre>\n\n<p>In a function such that <code>n_lastColumn</code> refers to the next column after <code>lastColumn</code>?</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465393873, "post_id": 37704191, "comment_id": 62882835, "body": "And then for example in my macro above would i replace all of my current &quot;E&quot; s with rColumn?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465394026, "post_id": 37704191, "comment_id": 62882957, "body": "@Uriahfb In the <code>.Cells</code> method, you can supply either a letter or a number for the column. If the user selected the entire column, the range address would be <code>E:E</code>, which doesn&#39;t work. Instead, convert it to a number by using <code>rColumn.Column</code>. The end result is something similar to: <code>.Cells(2, rColumn.Column).Value</code>. Let me know if more assistance is needed."}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465395273, "post_id": 37704191, "comment_id": 62883984, "body": "Okay so i just changed all of my code over to the rColumn.column but am getting an error saying the reference you typed is not valid or you did not provide a reference where one was required. i tried entering a number and letters and got the same error.@user3561813"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465395951, "post_id": 37704191, "comment_id": 62884575, "body": "Can you quickly debug to make sure that it&#39;s being read correctly? After setting <code>rColumn</code>, type a line such as <code>MsgBox rColumn.Address</code>. Make sure the message box contains the range you selected (&quot;$E:$E&quot; for example). If this works correctly, can you point to the specific line of code that throws the error?"}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465396246, "post_id": 37704191, "comment_id": 62884811, "body": "It does not seem to be setting rColumn at all, it says the reference typed is not valid and does not give me anything in the message box. I have separated the piece of code u supplied above into its own macro to test it, and am getting the same error."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465396401, "post_id": 37704191, "comment_id": 62884911, "body": "For the sake of completeness, can you post the separated piece of code for our review (it might be easiest to edit the original post and supply it in there)."}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465396691, "post_id": 37704191, "comment_id": 62885140, "body": "Okay i updated the original post to where I have it now, when the user input box pops up and you enter a number or a letter into the box it does not accept it, saying reference you typed is not valid or you did not provide a reference where one was required"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465396915, "post_id": 37704191, "comment_id": 62885317, "body": "Ok, I understand the issue. When you supply type <code>8</code> as the last parameter to the <code>InputBox</code> function, the code is looking for a range object. You can set that in one of two way. (1) Physically select the cell or column by clicking on the cell or column header while the input box is open, or (2) typing in a valid cell or column reference (such as <code>E1</code> for cell <code>E1</code> or <code>E:E</code> for the entire column). Note, since we are interested in the column number, either of these options will return the same column number."}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465397631, "post_id": 37704191, "comment_id": 62885892, "body": "Okay we are close now im sure this is a quick fix but i am getting the error method &#39;range&#39; of object &#39;_global&#39; failed on lines ActiveWorkbook.Worksheets(&quot;Sheet1&quot;).Sort.SortFields.Add Key:=Range(&quot;rColumn.Column&quot;) _         , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465398141, "post_id": 37704191, "comment_id": 62886249, "body": "<code>rColumn.Column</code> returns a number (the column of the range). And we also know that <code>Range(...)</code> takes a cell/group of cells. Typing <code>Range(5)</code> throws an error. We have to fix this by enforcing some type of business rule that you&#39;d have to define. For example, in this circumstance, you can reference <code>rColumn</code> directly. But what if the user only selected one cell. You can take <code>rColumn.EntireColumn</code>. What if you don&#39;t want the whole column, but only a range... Determine your need, and we can help from there."}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465398376, "post_id": 37704191, "comment_id": 62886434, "body": "It will always be an entire column that they select. I have changed my user input box to ask them to click on the column they would like to find matches in. After changing it to Range(rColumn.EntireColumn) i am getting the same error."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465398540, "post_id": 37704191, "comment_id": 62886571, "body": "That&#39;s because <code>rColumn.EntireColumn</code> is already a <code>Range</code> object, so you don&#39;t have to wrap it with <code>Range()</code>. Simply type <code>rColumn.EntireColumn</code>."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465398847, "post_id": 37704191, "comment_id": 62886798, "body": "Actually, since it&#39;s always an entire column, it would be a better practice to set the entire column into the <code>rColumn</code> variable from the start. Amend the <code>InputBox</code> code to read: <code>Set rColumn = Application.InputBox(&quot;Pick Col&quot;, , , , , , , 8).EntireColumn</code> . Now, <code>rColumn</code> is a Range object to refers to the entire column. When you need to use the numeric value of the column, you can still use <code>rColumn.Column</code>"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465400282, "post_id": 37704191, "comment_id": 62887962, "body": "No problem. Consider marking the question as answered so that future users know that we have a working solution."}, {"owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465403154, "post_id": 37704191, "comment_id": 62889944, "body": "How would one go about doing that?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "edited": false, "score": 0, "creation_date": 1465406746, "post_id": 37704191, "comment_id": 62892152, "body": "The community standards are pretty well covered here: <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1465393212, "creation_date": 1465393212, "answer_id": 37704191, "question_id": 37703808, "link": "https://stackoverflow.com/questions/37703808/user-input-box-to-pick-column-to-perform-action/37704191#37704191", "title": "User input box to pick column to perform action", "body": "<p>If you want to select a range variable using an <code>InputBox</code>, you can supply the value <code>8</code> to its last argument. Then, you can select a Range (or an entire column) upon which to work.</p>\n\n<p>For example:</p>\n\n<pre><code>Sub Test()\n    Dim rColumn As Range\n\n    Set rColumn = Application.InputBox(\"Pick Col\", , , , , , , 8)\n\n    MsgBox rColumn.Address\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6440529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c730d52b1ea35ffc34a6fa01ded3540?s=128&d=identicon&r=PG&f=1", "display_name": "Uriahfb", "link": "https://stackoverflow.com/users/6440529/uriahfb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "accepted_answer_id": 37704191, "answer_count": 1, "score": 0, "last_activity_date": 1465396566, "creation_date": 1465392278, "last_edit_date": 1465396566, "question_id": 37703808, "link": "https://stackoverflow.com/questions/37703808/user-input-box-to-pick-column-to-perform-action", "title": "User input box to pick column to perform action", "body": "<p>Okay i am very new to VBA coding.</p>\n\n<p>I am working on a program that finds matches within a column and cuts and pastes them onto a separate sheet. I have working code that does this however i would like to broaden it so that there is an input box where user can pick which column for the program to search through, find matches, and cut and paste these onto sheet 2. Here is what I have, any help would be awesome. I know the code is a little clunky as well so any help cleaning it up would be awesome.</p>\n\n<p>Thanks guys.</p>\n\n<pre><code> Sub removedup()\nDim y As Integer\nDim x As Integer\nDim z As Integer\nDim unique() As String\nReDim unique(0)\nDim dups() As String\nReDim dups(0)\nDim dupFlag As Boolean\nDim dupCount As Integer\nDim rowcount As Integer\nDim sheet2indexer As Integer\nDim rColumn As Range\n\n\n\n    Set rColumn = Application.InputBox(\"Pick Column\", , , , , , , 8)\n\n    MsgBox rColumn.Address\n\n\n\n\n'Pre Sort\n\nCells.Select\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(rColumn.Column)_\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n        .SetRange Range(\"A1:Z20000\")\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n'get array of all unique names\ndupFlag = False\nx = 1\nDo While Sheets(1).Cells(x, rColumn.Column).Value &lt;&gt; \"\"\n    For y = 0 To UBound(unique)\n        If Sheets(1).Cells(x, \"E\").Value = unique(y) Then\n            dupFlag = True\n        End If\n    Next y\n    If dupFlag = False Then\n        ReDim Preserve unique(UBound(unique) + 1)\n        unique(UBound(unique)) = Sheets(1).Cells(x, rColumn.Column).Value\n    Else\n        dupFlag = False\n    End If\n\nx = x + 1\n\nLoop\n\nrowcount = x - 1\n\n'unique(1 to unbound(unique)) now contains one of each entry\n'check which values are duplicates, and record\n\ndupCount = 0\n\nFor y = 1 To UBound(unique)\n    x = 1\n    Do While Sheets(1).Cells(x, rColumn.Column).Value &lt;&gt; \"\"\n        If unique(y) = Sheets(1).Cells(x, rColumn.Column).Value Then\n            dupCount = dupCount + 1\n        End If\n        x = x + 1\n    Loop\n    If dupCount &gt; 1 Then\n        'unique(y) is found more than once\n        ReDim Preserve dups(UBound(dups) + 1)\n        dups(UBound(dups)) = unique(y)\n    End If\n        dupCount = 0\nNext y\n\nsheet2indexer = 0\n'now we have a list of all duplicate entries, time to start moving rows\nFor z = rowcount To 1 Step -1\n    For y = 1 To UBound(dups)\n        If Sheets(1).Cells(z, rColumn.Column).Value = dups(y) Then\n            'current row z is a duplicate\n            sheet2indexer = sheet2indexer + 1\n            Sheets(1).Rows(z).Cut Sheets(2).Rows(sheet2indexer)\n            Sheets(1).Rows(z).Delete\n        End If\n    Next y\nNext z\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1465392340, "post_id": 37703395, "comment_id": 62881592, "body": "Can you provide at least a sample of the input? Like, what is in <code>A1</code> through <code>A10</code> in sheet &quot;MD with ID&quot; and what is in <code>B2</code> through <code>B10</code> in sheet &quot;D with ID&quot;? Other inputs will likely be useful, too."}, {"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1465392845, "post_id": 37703395, "comment_id": 62882006, "body": "Try using the Value2 property instead of Value when accessing the data in the cells. Depending on what the data looks like it might fix it. <a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1465393397, "post_id": 37703395, "comment_id": 62882428, "body": "Also try inserting a couple debug statements to see what comparisons your code is making and how the logic is working. I&#39;d put one after your first <code>If</code> statement: <code>Debug.Print &quot;e.Cells(&quot; &amp; j &amp; &quot;,3) equals i.Cells(&quot; &amp; d &amp; &quot;,4) --&gt; &quot; &amp; e.Cells(j,3).value &amp; &quot; = &quot; &amp; i.Cells(d,4).value</code>. Then probably another debug print after the next <code>If</code> statement as well. If you can visually inspect where you know there is am equivalence that should be copied, then adjust your loop parameters to focus on that area when you&#39;re testing."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465396349, "post_id": 37703395, "comment_id": 62884873, "body": "Why do you have this?  If e.Cells(j, 3).Value = i.Cells(d, 4).Value Then             If e.Cells(j, 13).Value = i.Cells(d, 10).Value Then . Why not to change it to If (e.Cells(j, 3).Value = i.Cells(d, 4).Value) And  (e.Cells(j, 13).Value = i.Cells(d, 10).Value) Then saves you an if and possibly time execution. Also, why are there 2 do until? Shouldn&#39;t be faster determine which one is the longest of both and then do the cycle based on that?"}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "edited": false, "score": 0, "creation_date": 1465419354, "post_id": 37703395, "comment_id": 62899170, "body": "I did add a sample of the sheets at the end,"}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1465419720, "post_id": 37703395, "comment_id": 62899333, "body": "I did add a sample of the sheets at the end  @MattCremeens"}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1465419743, "post_id": 37703395, "comment_id": 62899344, "body": "I will try what you suggested and see what happen @PeterT"}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465419749, "post_id": 37703395, "comment_id": 62899349, "body": "@Sgdva you are right about the nested ifs are not necessary here, but the nested loop is because I&#39;m not sure if the data are in the same sort in both sheets so I need to loop the shortest sheet for each record in the large sheet."}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "reply_to_user": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1465419767, "post_id": 37703395, "comment_id": 62899358, "body": "I will try what you suggested and see what happen @Danny"}, {"owner": {"reputation": 624, "user_id": 4694665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdBma.jpg?s=128&g=1", "display_name": "Chewy", "link": "https://stackoverflow.com/users/4694665/chewy"}, "edited": false, "score": 0, "creation_date": 1465420250, "post_id": 37703395, "comment_id": 62899582, "body": "I can say that nothing happens with your data in this sample because there are no matching case numbers or &quot;other ids&quot;, so there is nothing to copy over."}, {"owner": {"reputation": 624, "user_id": 4694665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdBma.jpg?s=128&g=1", "display_name": "Chewy", "link": "https://stackoverflow.com/users/4694665/chewy"}, "edited": false, "score": 0, "creation_date": 1465421050, "post_id": 37703395, "comment_id": 62899933, "body": "I&#39;ve added an answer to reflect the comment above and help to display to you what I think is your issue.  Once I made the changes below I could see updates to your sheet."}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465423143, "post_id": 37713105, "comment_id": 62900898, "body": "What about if there are blank among rows? It would exit before desired"}, {"owner": {"reputation": 624, "user_id": 4694665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdBma.jpg?s=128&g=1", "display_name": "Chewy", "link": "https://stackoverflow.com/users/4694665/chewy"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465426018, "post_id": 37713105, "comment_id": 62901886, "body": "Of course it would. It depends on her data set. She has two versions of the code.  One goes through thousands of rows and the other is designed to exit on the first blank.  The underlying code in both is essentially the same. So both treated the same should work the same.  Just depends on her intentions.  Same edit would just need to apply to the second script although I did not verify that one.  Just looks like she wanted at least one to work by the question."}, {"owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "edited": false, "score": 0, "creation_date": 1465471629, "post_id": 37713105, "comment_id": 62920483, "body": "I have tried to fix it  but it does not work apparently the if condition is always false even when the value is supposed to be true! thankfully I was able to make the changes by python  thank you all for your help :)"}, {"owner": {"reputation": 624, "user_id": 4694665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdBma.jpg?s=128&g=1", "display_name": "Chewy", "link": "https://stackoverflow.com/users/4694665/chewy"}, "edited": false, "score": 0, "creation_date": 1465472593, "post_id": 37713105, "comment_id": 62921141, "body": "Yeah, that is weird.  It worked just fine with your test data.  I am wondering if your sheet names have an extra space somewhere...."}], "tags": [], "owner": {"reputation": 624, "user_id": 4694665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vdBma.jpg?s=128&g=1", "display_name": "Chewy", "link": "https://stackoverflow.com/users/4694665/chewy"}, "is_accepted": false, "score": 1, "last_activity_date": 1465420775, "creation_date": 1465420775, "answer_id": 37713105, "question_id": 37703395, "link": "https://stackoverflow.com/questions/37703395/excel-vba-copy-paste-values-with-conditions/37713105#37713105", "title": "Excel VBA Copy Paste Values with conditions", "body": "<p>So looking at your first CopyIdCells method, there is only one fix I would make to this - make variable d=2.  This has headers at the top of your sample data and you need to start on row 2 just like the other sheet.</p>\n\n<pre><code>Sub CopyIDCells()\n\nSet i = Sheets(\"MD with ID\")\nSet e = Sheets(\"D with ID\")\nDim d\nDim j\nd = 2\nj = 2\n\nDo Until IsEmpty(e.Range(\"B\" &amp; j))\n    d = 2\n    Do Until IsEmpty(i.Range(\"A\" &amp; d))\n        If e.Range(\"C\" &amp; j).Value = i.Range(\"D\" &amp; d).Value Then\n            If e.Range(\"M\" &amp; j).Value = i.Range(\"J\" &amp; d).Value Then\n                e.Range(\"A\" &amp; j).Value = i.Range(\"B\" &amp; d).Value\n            End If\n        End If\n        d = d + 1\n    Loop\n    j = j + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Other than that your formulas look good, you just do not have any data that meets your requirements.  Add this column to the bottom of \"MD with ID\" and you will see your code match.</p>\n\n<pre><code>mouse   10  08  11267   A/J M   823 1/11/2008   1   SC-807  LONG    10/10/2005\n</code></pre>\n\n<p>Since you are matching on \"Case Number\" AND \"Other ID\" there are no items in both sheets that meet this criteria.  When you add the row above to \"MD with ID\", you will see the appropriate ID added to your second sheet on several rows.</p>\n"}], "owner": {"reputation": 41, "user_id": 6440443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d156f13d2718c9cf400901b4b687bc7?s=128&d=identicon&r=PG&f=1", "display_name": "SarahM.", "link": "https://stackoverflow.com/users/6440443/sarahm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1493036993, "creation_date": 1465391211, "last_edit_date": 1465471674, "question_id": 37703395, "link": "https://stackoverflow.com/questions/37703395/excel-vba-copy-paste-values-with-conditions", "title": "Excel VBA Copy Paste Values with conditions", "body": "<p>I'm trying to copy values from one small sheet \"MD with ID\" to A Larger sheet \"D with ID\" if 2 fields are identical (consider those two as keys that identify each record).</p>\n\n<p>Here is my first try:</p>\n\n<pre><code>Sub CopyIDCells()\n\nSet i = Sheets(\"MD with ID\")\nSet e = Sheets(\"D with ID\")\nDim d\nDim j\nd = 1\nj = 2\n\nDo Until IsEmpty(e.Range(\"B\" &amp; j))\n    d = 2\n    Do Until IsEmpty(i.Range(\"A\" &amp; d))\n        If e.Range(\"C\" &amp; j).Value = i.Range(\"D\" &amp; d).Value Then\n            If e.Range(\"M\" &amp; j).Value = i.Range(\"J\" &amp; d).Value Then\n                e.Range(\"A\" &amp; j).Value = i.Range(\"B\" &amp; d).Value\n            End If\n        End If\n        d = d + 1\n    Loop\n    j = j + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Here is my second try:</p>\n\n<pre><code>Sub CopyIDCells2()\n\nSet i = Sheets(\"MD with ID\")\nSet e = Sheets(\"D with ID\")\nDim d\nDim j\nd = 1\nj = 2\n\nDo Until j = 20886\n    d = 2\n    Do Until d = 1742\n        If e.Cells(j, 3).Value = i.Cells(d, 4).Value Then\n            If e.Cells(j, 13).Value = i.Cells(d, 10).Value Then\n                e.Cells(j, 1).Value = i.Cells(d, 2).Value\n            End If\n        End If\n        d = d + 1\n    Loop\n    j = j + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Nothing changes in the excel sheet when this code runs, although it takes few minutes to run -_-\".</p>\n\n<p>.. sample was removed</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1465393663, "post_id": 37703371, "comment_id": 62882630, "body": "Check out these excellent answers from <a href=\"http://peltiertech.com/Excel/ChartsHowTo/ResizeAndMoveAChart.html\" rel=\"nofollow noreferrer\">Jon Peltier</a> and this one <a href=\"http://stackoverflow.com/a/21028840/4717755\">http://stackoverflow.com/a/21028840/4717755</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3770133"}, "edited": false, "score": 0, "creation_date": 1465392165, "post_id": 37703644, "comment_id": 62881446, "body": "I have tried  - getting &quot;method or data member not found&quot;"}, {"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "edited": false, "score": 0, "creation_date": 1465394348, "post_id": 37703644, "comment_id": 62883214, "body": "Ok. do you only have the one graph on the sheet or are you going to have multiple?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3770133"}, "edited": false, "score": 0, "creation_date": 1465409895, "post_id": 37703644, "comment_id": 62893969, "body": "I will have multiple."}, {"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "edited": false, "score": 0, "creation_date": 1465462369, "post_id": 37703644, "comment_id": 62914412, "body": "Have a look again at my answer. I have updated it. This will move all chars to the cell a1. If you want to move you different graphs to different places then change the <code>ChartObjects</code> to <code>ChartObjects(&quot;NAME OF YOUR GRAPH&quot;)</code>, and move to to where ever you want."}], "tags": [], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "is_accepted": false, "score": 1, "last_activity_date": 1465396234, "last_edit_date": 1465396234, "creation_date": 1465391833, "answer_id": 37703644, "question_id": 37703371, "link": "https://stackoverflow.com/questions/37703371/defining-new-chart-a-location-in-excel/37703644#37703644", "title": "Defining new chart a location in excel", "body": "<p>you can use this to set the cell that you want to move your chart to. Just add this outside your loop</p>\n\n<pre><code>sh.ChartObjects.Left = sh.Range(\"A1\")\nsh.ChartObjects.Top = sh.Range(\"A1\")\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3770133"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465396234, "creation_date": 1465391167, "last_edit_date": 1531164843, "question_id": 37703371, "link": "https://stackoverflow.com/questions/37703371/defining-new-chart-a-location-in-excel", "title": "Defining new chart a location in excel", "body": "<p>I am adding a new chart and would like to define its location.\nI hav tried several approaches with top and left, but with no success.\nthis is my code:</p>\n\n<pre><code>Set sh = ActiveWorkbook.Worksheets(unit)\nSet chrt = sh.Shapes.AddChart.Chart\n\nWith chrt\n    'Data?\n    .ChartType = xlXYScatterLines\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).name = \"=\"\"Scatter Chart\"\"\"\n    .SeriesCollection(1).XValues = x\n    .SeriesCollection(1).Values = y\n\n\n    'Location\n    'DON'T KNOW WHAT TO PUT HERE\n    '.location xlLocationAsObject doesn't work!\n    'Titles\n    .HasTitle = True\n    .ChartTitle.Characters.Text = name\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"X values\"\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Y values\"\n    .Axes(xlCategory).HasMajorGridlines = True\n\n    'Formatting\n    .Axes(xlCategory).HasMinorGridlines = False\n    .Axes(xlValue).HasMajorGridlines = True\n    .Axes(xlValue).HasMinorGridlines = False\n    .Axes(xlValue).MinimumScaleIsAuto = True\n    .Axes(xlValue).MaximumScaleIsAuto = True\n    .HasLegend = False\nEnd With\n</code></pre>\n"}, {"tags": ["algorithm", "vba", "excel", "time"], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465405023, "post_id": 37708160, "comment_id": 62891132, "body": "No it&#39;s not about just taking the names of the person in ascending order of their times. Did you see the I/O of this <a href=\"http://www.swimcoachtools.com/Relays.aspx\" rel=\"nofollow noreferrer\">swimcoachtools.com/Relays.aspx</a> website ?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465405388, "post_id": 37708160, "comment_id": 62891378, "body": "Could you care to explain what&#39;s the logic behind the relay then?"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 1, "last_activity_date": 1465425845, "last_edit_date": 1465425845, "creation_date": 1465403651, "answer_id": 37708160, "question_id": 37703177, "link": "https://stackoverflow.com/questions/37703177/swimming-medley-relay-time-simulation-algorithm/37708160#37708160", "title": "Swimming Medley Relay Time Simulation Algorithm", "body": "<p><strong>EDIT:</strong><br>\n<br> 4. Relay Logic premise: <strong><em>Get all the combinations possible without 2 identical strings. And then sort them lowest to largest.</em></strong> I'd do the following: Get all the possible combinations and their sum with the following: *Combinations may still be buggy, since it may be variable to how many numbers you may have. This is just a guide to describe the process<br>\n<a href=\"https://i.stack.imgur.com/6pHVU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6pHVU.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/UwAl2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UwAl2.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Combinations()\n    Dim i As Long, j As Long, k As Long, l As Long, m As Long, n As Long, o As Long, p As Long, q As Long\n    Dim CountComb As Long, lastrow As Long\n\n    Range(\"K2\").Value = Now - 5\n\n    Application.ScreenUpdating = False\n\n    CountComb = 0: lastrow = 6\n\n    For i = 1 To 6: For j = 1 To 5\n    For k = 1 To 6: For l = 1 To 6\n    If Not (i = j Or i = k Or i = l Or j = k Or j = l Or k = l) Then\n\n              Range(\"K\" &amp; lastrow).Value = Range(\"A\" &amp; i).Value &amp; \"/\" &amp; _\n                                     Range(\"B\" &amp; j).Value &amp; \"/\" &amp; _\n                                     Range(\"C\" &amp; k).Value &amp; \"/\" &amp; _\n                                     Range(\"D\" &amp; l).Value\n        lastrow = lastrow + 1\n        CountComb = CountComb + 1\n        End If\n    Next: Next\n    Next: Next\n\n    Range(\"K1\").Value = CountComb\n    Range(\"K3\").Value = Now + 21\n\n    Application.ScreenUpdating = True\nEnd Sub\nFunction TimeSum(Persons As String, Chr As String) As Double\nDim ArrayPersons() As String: ArrayPersons = Split(Persons, Chr)\nDim SumOfTime As Double\nDim ItemPerson As Variant\nDim NumberRoutines As Long: NumberRoutines = 2\nConst SheetData = \"Sheet1\"\nFor Each ItemPerson In ArrayPersons\nSumOfTime = Sheets(SheetData).Columns(NumberRoutines).Find(ItemPerson).Offset(0, -1).Value + SumOfTime\nNumberRoutines = NumberRoutines + 2\nNext ItemPerson\nTimeSum = SumOfTime\nEnd Function\n</code></pre>\n\n<p>Maybe you could define better the sub to do what you desire for, but, the last coding could guide you in the right path. In a second thought, you could get combinations in a dictionary instead. <br>\n[<img src=\"https://i.stack.imgur.com/INchW.png\" alt=\"3]\">\n[<img src=\"https://i.stack.imgur.com/Es1oM.png\" alt=\"2]\"></p>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 37708160, "answer_count": 1, "score": 1, "last_activity_date": 1465425845, "creation_date": 1465390627, "last_edit_date": 1465395585, "question_id": 37703177, "link": "https://stackoverflow.com/questions/37703177/swimming-medley-relay-time-simulation-algorithm", "title": "Swimming Medley Relay Time Simulation Algorithm", "body": "<p>I am trying to simulate the I/O of this <a href=\"http://www.swimcoachtools.com/Relays.aspx\" rel=\"nofollow noreferrer\">website page</a></p>\n\n<p>My Input sheet looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GcsAY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GcsAY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now after taking the values from input sheet and arranging them in ascending order I got this in a temp worksheet :</p>\n\n<p><a href=\"https://i.stack.imgur.com/f65nX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f65nX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is what my results sheet looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HqoNr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HqoNr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now I have tried this after sorting process(didn't add code for sorting since it's not the problem):</p>\n\n<pre><code>Set rng = Union(wTime.Range(\"D6:D25\"), wTime.Range(\"F6:F25\"), wTime.Range(\"H6:H25\"), wTime.Range(\"J6:J25\"))\ncnt1 = 1: cnt2 = 1: cnt3 = 1: cnt4 = 1\n\nwTime.Range(\"A6:A25\") = Empty   'Ticker\n\nFor i = 1 To 20\n\nbckStroke(i) = wTemp.Range(\"A\" &amp; i + 1).Value\nbrstStroke(i) = wTemp.Range(\"C\" &amp; i + 1).Value\nbtrFly(i) = wTemp.Range(\"E\" &amp; i + 1).Value\nfrStyle(i) = wTemp.Range(\"G\" &amp; i + 1).Value\n\nwTime.Range(\"A6:A25\") = Empty\n\nFor Each cel In rng\n\nIf cel.Column = 4 And cel.Value = bckStroke(i) And cel.Value &lt;&gt; 0 And Trim(wTime.Cells(cel.Row, 1)) &lt;&gt; \"Y\" And cnt1 &lt; 6 Then\n    wRes.Cells((cnt1 + 5 + (cnt1 - 1) * 2) - 1, 4) = wTime.Cells(cel.Row, 2)    'Athlete Name\n    wRes.Cells(cnt1 + 5 + (cnt1 - 1) * 2, 4) = bckStroke(i)                     'Time\n    cnt1 = cnt1 + 1\n    wTime.Cells(cel.Row, 1) = \"Y\"\nEnd If\n\nIf cel.Column = 6 And cel.Value = brstStroke(i) And cel.Value &lt;&gt; 0 And Trim(wTime.Cells(cel.Row, 1)) &lt;&gt; \"Y\" And cnt2 &lt; 6 Then\n    wRes.Cells((cnt2 + 5 + (cnt2 - 1) * 2) - 1, 6) = wTime.Cells(cel.Row, 2)    'Athlete Name\n    wRes.Cells(cnt2 + 5 + (cnt2 - 1) * 2, 6) = brstStroke(i)                    'Time\n    cnt2 = cnt2 + 1\n    wTime.Cells(cel.Row, 1) = \"Y\"\nEnd If\n\nIf cel.Column = 8 And cel.Value = btrFly(i) And cel.Value &lt;&gt; 0 And Trim(wTime.Cells(cel.Row, 1)) &lt;&gt; \"Y\" And cnt3 &lt; 6 Then\n    wRes.Cells((cnt3 + 5 + (cnt3 - 1) * 2) - 1, 8) = wTime.Cells(cel.Row, 2)    'Athlete Name\n    wRes.Cells(cnt3 + 5 + (cnt3 - 1) * 2, 8) = btrFly(i)                        'Time\n    cnt3 = cnt3 + 1\n    wTime.Cells(cel.Row, 1) = \"Y\"\nEnd If\n\nIf cel.Column = 10 And cel.Value = frStyle(i) And cel.Value &lt;&gt; 0 And Trim(wTime.Cells(cel.Row, 1)) &lt;&gt; \"Y\" And cnt4 &lt; 6 Then\n    wRes.Cells((cnt4 + 5 + (cnt4 - 1) * 2) - 1, 10) = wTime.Cells(cel.Row, 2)   'Athlete Name\n    wRes.Cells(cnt4 + 5 + (cnt4 - 1) * 2, 10) = frStyle(i)                      'Time\n    cnt4 = cnt4 + 1\n    wTime.Cells(cel.Row, 1) = \"Y\"\nEnd If\n\nNext cel\n\nNext i\n</code></pre>\n\n<blockquote>\n  <p>I just want to know the simplest logic to get the desired result after arranging them in ascending order (refer temp sheet) it should be easy but I can't seem to understand it.</p>\n</blockquote>\n\n<p>Conditions that I know of for now:</p>\n\n<ol>\n<li><p>Each team should have unique swimmers (i.e 4 Unique names in each team)</p></li>\n<li><p>A swimmer can appear in other team as well if he has best time in other category as well. (E.g. Marcelo will appear in top 4 team since he has the best time in all 4 categories)</p></li>\n<li><p>Teams with shortest time should be placed 1st in the list on result sheet. I think sorting in ascending order takes care of this it's matter of selecting right swimmer from the temp sheet list.</p></li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1465393199, "post_id": 37703170, "comment_id": 62882267, "body": "Can you post some code that you are using?"}, {"owner": {"reputation": 31, "user_id": 5638428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0c10c15b9e5cbf12b084cbd1f34306a?s=128&d=identicon&r=PG&f=1", "display_name": "R3G1", "link": "https://stackoverflow.com/users/5638428/r3g1"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1465394617, "post_id": 37703170, "comment_id": 62883449, "body": "Hi Robin I have found the above code  but as I am not a vb vba guy don&#39;t have much of an idea"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1465405986, "post_id": 37703170, "comment_id": 62891723, "body": "<a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2011/11/13/use-powershell-to-quickly-find-installed-software/\" rel=\"nofollow noreferrer\">blogs.technet.microsoft.com/heyscriptingguy/2011/11/13/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 5638428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0c10c15b9e5cbf12b084cbd1f34306a?s=128&d=identicon&r=PG&f=1", "display_name": "R3G1", "link": "https://stackoverflow.com/users/5638428/r3g1"}, "edited": false, "score": 0, "creation_date": 1465456948, "post_id": 37703170, "comment_id": 62911121, "body": "Cheers tim, not sure how to call powershell in excel and write a new tab display info etc in a new tab .  I have to be able to run the script from excel the reason being we are not giving the user the rights to run any complicated scripts, they asked for a simple push button in excel and get info (love how users says just push the button out pops the info) .   My dilemma is that I have to give them the excel spread sheet so the site administrator can run the excel sheet to obtain the required results for there domain"}, {"owner": {"reputation": 31, "user_id": 5638428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0c10c15b9e5cbf12b084cbd1f34306a?s=128&d=identicon&r=PG&f=1", "display_name": "R3G1", "link": "https://stackoverflow.com/users/5638428/r3g1"}, "edited": false, "score": 0, "creation_date": 1465560505, "post_id": 37703170, "comment_id": 62965265, "body": "so update the post and advised we cant use powershell so back to vba it is"}], "owner": {"reputation": 31, "user_id": 5638428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0c10c15b9e5cbf12b084cbd1f34306a?s=128&d=identicon&r=PG&f=1", "display_name": "R3G1", "link": "https://stackoverflow.com/users/5638428/r3g1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465560468, "creation_date": 1465390621, "last_edit_date": 1531164843, "question_id": 37703170, "link": "https://stackoverflow.com/questions/37703170/searchnetwork-machine-registry-for-key", "title": "searchnetwork machine registry for key", "body": "<p>rewording the task at hand, Today I was given a weird task (weird to me). I need to create a spread sheet with a button that will be embedded and perform the following functions</p>\n\n<p>1 scan the domain for computers servers all machines etc get their names and</p>\n\n<p>2 populate a excel sheet with the month it was scanned  also  with the names of the machines it has found ( I assumn it would look to AD for this and populate column B) (COMPLETED)</p>\n\n<p>3 scan each machine for a specific version of software (installed) the version is in hkey_local_machines\\software\\wow6432node\\Microsoft\\windows\\currentversion\\specific key   (tbh any registry key will do as I can edit this anytime)</p>\n\n<p>4 update the spread sheet column (ie C) with the version it finds \nnow to this I have 20 domains all airgapped and all machines and ips are different so this will be run individually with domain admin rights</p>\n\n<p>I have found the code below but as I don't use vba etc on a daily basis have no idea how to edit it to reflect what I am asking</p>\n\n<pre><code>    Sub Macro1()\n'SearchAD.vbs\nOn Error Resume Next\n ' Connect to the LDAP server's root object\n 'Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n Set objRootDSE = GetObject(\"LDAP://RootDSE\")\n strDNSDomain = objRootDSE.Get(\"defaultNamingContext\")\n strTarget = \"LDAP://\" &amp; strDNSDomain\n wscript.Echo \"Starting search from \" &amp; strTarget\n Dim x As Long\n 'outFile = \"C:\\Users\\name\\Desktop\\Computers.csv\"\n 'Set objFile = objFSO.CreateTextFile(outFile, True)\n\n ' Connect to Ad Provider\n Set objConnection = CreateObject(\"ADODB.Connection\")\n objConnection.Provider = \"ADsDSOObject\"\n objConnection.Open \"Active Directory Provider\"\n\n Set objCmd = CreateObject(\"ADODB.Command\")\n Set objCmd.ActiveConnection = objConnection\n\n' Show only computers\n objCmd.CommandText = \"SELECT Name, ADsPath FROM '\" &amp; strTarget &amp; \"' WHERE      objectCategory = 'computer'\"\n\n' or show only users\n 'objCmd.CommandText = \"SELECT Name, ADsPath FROM '\" &amp; strTarget &amp; \"' WHERE    objectCategory = 'user'\"\n\n' or show only groups\n'objCmd.CommandText = \"SELECT Name, ADsPath FROM '\" &amp; strTarget &amp; \"'        WHERE           objectCategory = 'group'\"\n\n Const ADS_SCOPE_SUBTREE = 2\n objCmd.Properties(\"Page Size\") = 100\n objCmd.Properties(\"Timeout\") = 30\n objCmd.Properties(\"Searchscope\") = ADS_SCOPE_SUBTREE\n objCmd.Properties(\"Cache Results\") = False\n\n Set objRecordSet = objCmd.Execute\n\n ' Iterate through the results\nobjRecordSet.MoveFirst\n x = 4\n Do Until objRecordSet.EOF\n    scomputername = objRecordSet.Fields(\"Name\")\n    'wscript.Echo sComputerName\n    'objFile.Write sComputerName &amp; vbCrLf\n    Range(\"A\" &amp; x).Value = scomputername\n    x = x + 1\n    objRecordSet.MoveNext\n Loop\n\n ActiveSheet.Name = Format(Now(), \"mmm-yyyy\")\n 'objFile.Close\n\nEnd Sub\n</code></pre>\n\n<p>At present I cant seem to find any method of searching a network of machines to find registry keys so any help greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 1, "creation_date": 1465390650, "post_id": 37703121, "comment_id": 62880323, "body": "If you explain what <code>it does not allow me to execute it</code> means you would greatly increase your chances of getting answers."}, {"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 0, "creation_date": 1465391099, "post_id": 37703121, "comment_id": 62880647, "body": "Does the <code>fileName = Dir(directory &amp; &quot;*.xl??&quot;)</code> actually return a non-empty string ? Does the value of <code>path</code> argument end with a backslash ? You might want to print the result of <code>directory &amp; &quot;*.xl??&quot;</code> to make sure it is a value that when used as the argument of <code>Dir()</code> should return what you expect."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465393368, "post_id": 37703121, "comment_id": 62882402, "body": "Be aware that the <code>path</code> when received in LoopFiles doesn&#39;t have a trailing backslash so your <code>filename = Dir(directory &amp; &quot;*.xl??&quot;)</code> won&#39;t produce a proper path, which means that Dir will return an empty string"}], "answers": [{"comments": [{"owner": {"reputation": 4044, "user_id": 1276534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HJYi3.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/1276534/george"}, "edited": false, "score": 0, "creation_date": 1465391617, "post_id": 37703406, "comment_id": 62881030, "body": "Thanks, this solved the opening problem, and now I have an out of range error right after the first file is opened. Ultimately I am trying to read a field of each file, and retrieve that value back to my main worksheet."}, {"owner": {"reputation": 4044, "user_id": 1276534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HJYi3.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/1276534/george"}, "edited": false, "score": 0, "creation_date": 1465392010, "post_id": 37703406, "comment_id": 62881335, "body": "I suspect it is in my loop For each sheets...?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 4044, "user_id": 1276534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HJYi3.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/1276534/george"}, "edited": false, "score": 1, "creation_date": 1465392916, "post_id": 37703406, "comment_id": 62882051, "body": "@George If it&#39;s one of the workbooks that is opened by looping through the directory, you have to recognize that the workbook is closed before looping to the next file. So, when you explicitly reference <code>Testing.xlsm</code> the second time through the loop, it doesn&#39;t exist in the scope of the procedure. Without knowing what you would actually like to happen here, I can&#39;t give perfect results. If you can&#39;t figure it out based on the info, follow up with more details about that specific chunk of code and I&#39;ll try to help."}, {"owner": {"reputation": 4044, "user_id": 1276534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HJYi3.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/1276534/george"}, "edited": false, "score": 0, "creation_date": 1465393874, "post_id": 37703406, "comment_id": 62882837, "body": "Thanks, I will look more into it, if needed I will open another question... I really appreciated your patient and suggestion. Thanks!!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 2, "last_activity_date": 1465391251, "creation_date": 1465391251, "answer_id": 37703406, "question_id": 37703121, "link": "https://stackoverflow.com/questions/37703121/open-and-read-from-excel-file/37703406#37703406", "title": "Open and read from excel file", "body": "<p>In your code, the <code>path</code> variable may not contain a trailing backslash. This causes the following code in your <code>LoopFiles(&lt;&gt;)</code> SubRoutine to be inaccurate:</p>\n\n<pre><code>directory = path\nfileName = Dir(directory &amp; \"*.xl??\")\n</code></pre>\n\n<p>Filename would look something like: <code>c:\\users\\name\\documentshello.xlsx</code></p>\n\n<p>Try changing the above code to:</p>\n\n<pre><code>directory = path &amp; \"\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n</code></pre>\n\n<p>Does that fix the problem?</p>\n"}, {"comments": [{"owner": {"reputation": 275, "user_id": 14148145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13e86ece75f106fe3df061705c12edd?s=128&d=identicon&r=PG", "display_name": "LuckyFr", "link": "https://stackoverflow.com/users/14148145/luckyfr"}, "edited": false, "score": 0, "creation_date": 1616757049, "post_id": 37757993, "comment_id": 118108781, "body": "Perfect Answer."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 3, "last_activity_date": 1465597784, "creation_date": 1465597784, "answer_id": 37757993, "question_id": 37703121, "link": "https://stackoverflow.com/questions/37703121/open-and-read-from-excel-file/37757993#37757993", "title": "Open and read from excel file", "body": "<p>Interesting question!  This should do it for you.  Modify as needed.</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xlsx\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n  Row = 1\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Change First Worksheet's Background Fill Blue\n      ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; Row).Value = Worksheets(1).Range(\"A1\").Value\n      Row = Row + 1\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4044, "user_id": 1276534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HJYi3.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/1276534/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20318, "favorite_count": 3, "accepted_answer_id": 37703406, "answer_count": 2, "score": 4, "last_activity_date": 1593967429, "creation_date": 1465390487, "last_edit_date": 1593967429, "question_id": 37703121, "link": "https://stackoverflow.com/questions/37703121/open-and-read-from-excel-file", "title": "Open and read from excel file", "body": "<p><strong>Edit:</strong> After <code>user3561813</code> the suggestion of adding <code>\"/\"</code>, it now read the first file. I have an out of range error message <code>\"9\"</code>. It does read the first file correctly. Ultimately I am trying to open each file, and read the name and age (this is a testing not the real production form). And retrieve the values back to my main worksheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/u5l4n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u5l4n.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Original question</strong></p>\n\n<p>I am trying to read hundred of excel forms in a folder, read a particular cell position, and record them into my testing worksheet. I googled this tutorial and tried to write my code. But when I execute the Getting Folder function, selected a folder path, it does not loop the excel files I have. (or record their names)</p>\n\n<pre><code>'Source: https://www.youtube.com/watch?v=7x1T4s8DVc0\nSub GettingFolder()\nDim SelectedFolder As String\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Select folder\"\n    .ButtonName = \"Confirm\"\n    .InitialFileName = \"U:\\\"\n\n    If .Show = -1 Then\n        'ok clicked\n        SelectedFolder = .SelectedItems(1)\n        MsgBox SelectedFolder\n        ' This is where I want to call my function\n        LoopFiles (SelectedFolder)\n    Else\n        'cancel clicked\n    End If\nEnd With\nEnd Sub\n\n' Source: http://www.excel-easy.com/vba/examples/files-in-a-directory.html\nSub LoopFiles(path As String)\nDim directory As String, fileName As String, sheet As Worksheet\nDim i As Integer, j As Integer\n\n' Avoid Screen flicker and improve performance\nApplication.ScreenUpdating = False\n' Fixed per suggestion below..\ndirectory = path &amp; \"\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n\nDo While fileName &lt;&gt; \"\"\n    i = i + 1\n    j = 2\n    Cells(i, 1) = fileName\n    Workbooks.Open (directory &amp; fileName)\n    For Each sheet In Workbooks(fileName).Worksheets\n        Workbooks(\"Testing.xlsm\").Worksheets(1).Cells(i, j).Value = sheet.Name\n        j = j + 1\n    Next sheet\n    Workbooks(fileName).Close\n    fileName = Dir()\nLoop\n\n' Reset the screen update setting\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "google-docs-api"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465390297, "post_id": 37703028, "comment_id": 62880075, "body": "One can integrate Google Drive into one&#39;s file system I&#39;m sure.  Then it becomes just another file one an access with Workbooks.Open"}, {"owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465390486, "post_id": 37703028, "comment_id": 62880196, "body": "The files I want to download are PDF instructions to the Excel product I sell. I want a button in the spreadsheet that downloads the instructions file for that spreadsheet. The PDF is housed in a shared Google Drive folder."}, {"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 1, "creation_date": 1465391927, "post_id": 37703028, "comment_id": 62881267, "body": "If you control the file you are downloading, then you can get a public link from google docs and use this solution: <a href=\"http://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer#17877390\" title=\"how do i download a file using vba without internet explorer%2317877390\">stackoverflow.com/questions/17877389/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "is_accepted": false, "score": 0, "last_activity_date": 1465391777, "creation_date": 1465391777, "answer_id": 37703620, "question_id": 37703028, "link": "https://stackoverflow.com/questions/37703028/vba-code-to-automatically-download-a-file-from-google-drive/37703620#37703620", "title": "VBA Code to automatically download a file from Google Drive", "body": "<p>One option would be to launch the users default web browser with a direct link to download your file from Google Drive, this would prompt the user to Save As / Open your user guide in the same way that it would if they clicked to download a PDF from a website and so might be sufficient.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/224816\" rel=\"nofollow\">This question's answer</a> details how to open a url in browser, and you can use <a href=\"https://sites.google.com/site/gdocs2direct/\" rel=\"nofollow\">this website</a> to create direct download links from Google Drive share links.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6159984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZULaH.png?s=128&g=1", "display_name": "Dan Elgaard", "link": "https://stackoverflow.com/users/6159984/dan-elgaard"}, "is_accepted": false, "score": 0, "last_activity_date": 1476426919, "creation_date": 1476426919, "answer_id": 40036466, "question_id": 37703028, "link": "https://stackoverflow.com/questions/37703028/vba-code-to-automatically-download-a-file-from-google-drive/40036466#40036466", "title": "VBA Code to automatically download a file from Google Drive", "body": "<p>Using the 'GetspecialFolder' UDF, you can download files from any cloud drive as simple as:</p>\n\n<p>FileCopy GetSpecialFolder(vbDirGoogleDrive) &amp; \"MyFile.DOC\", GetSpecialFolder(vbDirDownloads) &amp; \"MyFile.DOC\"</p>\n\n<p><a href=\"http://www.EXCELGAARD.dk/Lib/GetSpecialFolder/\" rel=\"nofollow\">http://www.EXCELGAARD.dk/Lib/GetSpecialFolder/</a> </p>\n"}], "owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4492, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476426919, "creation_date": 1465390246, "question_id": 37703028, "link": "https://stackoverflow.com/questions/37703028/vba-code-to-automatically-download-a-file-from-google-drive", "title": "VBA Code to automatically download a file from Google Drive", "body": "<p>Does anyone have an example of VBA code to automatically download a file from Google Drive. I can get to viewing the file in Chrome but then I have to manually select 'Download'. I would like to press a button and then pick the downloaded file from my default 'Download' folder. No in-between intervention.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1465402667, "creation_date": 1465402667, "answer_id": 37707819, "question_id": 37703022, "link": "https://stackoverflow.com/questions/37703022/vba-code-to-open-vbs-file-as-another-user/37707819#37707819", "title": "VBA code to Open .vbs file as another user", "body": "<p>I think you need to run an executable when you use RunAs\nMaybe try prefacing vbs file with \"Wscript \"</p>\n"}], "owner": {"reputation": 1, "user_id": 6436675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a4474a000f450cd57f149a0da8d4484?s=128&d=identicon&r=PG&f=1", "display_name": "James125", "link": "https://stackoverflow.com/users/6436675/james125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958487, "creation_date": 1465390228, "last_edit_date": 1593958487, "question_id": 37703022, "link": "https://stackoverflow.com/questions/37703022/vba-code-to-open-vbs-file-as-another-user", "title": "VBA code to Open .vbs file as another user", "body": "<p>I have searched thoroughly and have yet to find the right answer to this question.  Seems the methods below may be dated?</p>\n\n<p>Here is the situation, I have an Access 2010 form with a button that executes a .vbs file that updates Active Directory user logon hours.  This file has to be run with my administrative account which uses an eToken cert and pin for authentication.  Therefore, I need to a windows user logon interface prompt.  Please provide a VBA code sample to if this is possible.</p>\n\n<p>I've tried the following methods without success:</p>\n\n<pre><code>Shell \"runas.exe /user:administrator \"\"scriptname.vbs\"\"\", vbNormalFocus\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ShellExecute 0, \"runas\", \"c:\\folder\\scriptname.vbs\", Command, vbNullString, SW_SHOWNORMAL\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4386136, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-kkUzddXPbsk/AAAAAAAAAAI/AAAAAAAAA4c/9qi1rNdWLts/photo.jpg?sz=128", "display_name": "Laura Walker", "link": "https://stackoverflow.com/users/4386136/laura-walker"}, "edited": false, "score": 0, "creation_date": 1465412620, "post_id": 37706740, "comment_id": 62895539, "body": "Thank you so much liam! but now there&#39;s a Run-Time Erro 7874 saying it can&#39;t find z_Basis_QSReport5_Proposal Details_For_Report"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 0, "last_activity_date": 1465455027, "last_edit_date": 1465455027, "creation_date": 1465399477, "answer_id": 37706740, "question_id": 37702989, "link": "https://stackoverflow.com/questions/37702989/error-3075-run-query-after-multi-select-listbox-is-utilized/37706740#37706740", "title": "Error 3075-Run Query after multi select listbox is utilized", "body": "<p>When creating query, table, and field names; it is best practice to avoid spaces. However, there is a solution.</p>\n\n<p>When you use SQL and you have a table name with spaces you need to encapsulate it in square brackets. like so:</p>\n\n<pre><code>\"SELECT * FROM [z_Basis_QSReport5_Proposal Details] &amp; _\n        \"WHERE [z_Basis_QSReport5_Proposal Details].CriteriaFY .....\n</code></pre>\n\n<blockquote>\n  <p>EDIT</p>\n</blockquote>\n\n<p>Before, I mentioned that you should maybe put square brackets around the query name, but if you look at the example <a href=\"https://msdn.microsoft.com/en-us/library/bb238028(office.12).aspx\" rel=\"nofollow\">here</a> you will see that spaces are acceptable in this instance. </p>\n\n<p>If we go back to your query, <code>strcriteria</code> is a string and therefore you need to put single quotes around it:</p>\n\n<pre><code> strSQL = \"SELECT * FROM [z_Basis_QSReport5_Proposal Details] \" &amp; _\n          \"WHERE [z_Basis_QSReport5_Proposal Details].CriteriaFY IN('\" &amp; strCriteria &amp; \"');\"\n</code></pre>\n\n<p>Also, you will need to close your query before you can run it. So <code>qdf.close</code> is required before the <code>docmd.openquery()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1465403175, "creation_date": 1465403175, "answer_id": 37708004, "question_id": 37702989, "link": "https://stackoverflow.com/questions/37702989/error-3075-run-query-after-multi-select-listbox-is-utilized/37708004#37708004", "title": "Error 3075-Run Query after multi select listbox is utilized", "body": "<p>I agree with @LiamH that you need to surround your query names with square brackets.</p>\n\n<p>Also it looks like you're trying to change the SQL of a query on the fly - and then call the query before you've saved the changes</p>\n\n<pre><code>   qdf.SQL = strSQL\n   **qdf.close**\n   DoCmd.OpenQuery \"z_Basis_QSReport5_Proposal Details_For_Report\"\n</code></pre>\n\n<p>That being said I think you should be looking at parameter queries or just opening the SQL directly.</p>\n"}], "owner": {"reputation": 197, "user_id": 4386136, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-kkUzddXPbsk/AAAAAAAAAAI/AAAAAAAAA4c/9qi1rNdWLts/photo.jpg?sz=128", "display_name": "Laura Walker", "link": "https://stackoverflow.com/users/4386136/laura-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594023210, "creation_date": 1465390132, "last_edit_date": 1594023210, "question_id": 37702989, "link": "https://stackoverflow.com/questions/37702989/error-3075-run-query-after-multi-select-listbox-is-utilized", "title": "Error 3075-Run Query after multi select listbox is utilized", "body": "<p>have a search form in Access 2010 that filters FYs and Quarters based on certain criteria and opens them in a query. One of the criteria is an unbound multi-select list box, SelectTime (Where a person selects \"FY15-Q1 and FY15 Q2, for example. The data are stored in a query, z_Basis_QSReport5_Proposal Details. I keep getting an error 3075. Can someone help me with the code? </p>\n\n<pre><code>Private Sub Command56_Click()\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim varItem As Variant\nDim strCriteria As String\nDim strSQL As String\nSet db = CurrentDb()\n   Set qdf = db.QueryDefs(\"z_Basis_QSReport5_Proposal Details_For_Report\")\nFor Each varItem In Me!SelectTime.ItemsSelected\n  strCriteria = strCriteria &amp; \",'\" &amp; Me!SelectTime.ItemData(varItem) &amp; \"'\"\nNext varItem\nIf Len(strCriteria) = 0 Then\n  MsgBox \"You did not select anything from the list\" _\n         , vbExclamation, \"Nothing to find!\"\n  Exit Sub\n   End If\n   strCriteria = Right(strCriteria, Len(strCriteria) - 1)\n   strSQL = \"SELECT * FROM z_Basis_QSReport5_Proposal Details \" &amp; _\n            \"WHERE z_Basis_QSReport5_Proposal Details.CriteriaFY IN(\" &amp;           strCriteria &amp; \");\"\n   qdf.SQL = strSQL\n   DoCmd.OpenQuery \"z_Basis_QSReport5_Proposal Details_For_Report\"\n   Set db = Nothing\n   Set qdf = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "text-parsing", "vba"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1465389815, "post_id": 37702688, "comment_id": 62879716, "body": "Please show what you&#39;ve done so far to solve this."}, {"owner": {"reputation": 1, "user_id": 5717217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd91d8a8b12843a4538548d087a02b25?s=128&d=identicon&r=PG&f=1", "display_name": "Stat_95", "link": "https://stackoverflow.com/users/5717217/stat-95"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1465395858, "post_id": 37702688, "comment_id": 62884493, "body": "just edited it, I hope it answers your question ..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1465402182, "post_id": 37702688, "comment_id": 62889305, "body": "You need to show some examples of data and expected output.  It is hard to understand what you want."}, {"owner": {"reputation": 1, "user_id": 5717217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd91d8a8b12843a4538548d087a02b25?s=128&d=identicon&r=PG&f=1", "display_name": "Stat_95", "link": "https://stackoverflow.com/users/5717217/stat-95"}, "edited": false, "score": 0, "creation_date": 1465410443, "post_id": 37702688, "comment_id": 62894274, "body": "added images ... I hope it helps ..."}], "answers": [{"comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1465935196, "post_id": 37794936, "comment_id": 63106332, "body": "@DataEnthusiast_95 - Did this help?"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1465835734, "creation_date": 1465835734, "answer_id": 37794936, "question_id": 37702688, "link": "https://stackoverflow.com/questions/37702688/mapping-columns-in-excel-with-text-based-entries/37794936#37794936", "title": "Mapping columns in excel with text based entries?", "body": "<p>The syntax of <code>VLOOKUP</code> function is:</p>\n\n<p><strong><em>VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])</em></strong></p>\n\n<p>where <code>[range_lookup]</code> is an optional parameter which accepts TRUE or FALSE. <code>FALSE</code> is to find an exact match where as <code>TRUE</code> is for approximate match.</p>\n\n<p>Your formula <code>=VLOOKUP(C2:C1666,Carwale!G:H,2,False)</code> gives you the result when exact match is found and gives error <code>#NA</code> when no match is found. </p>\n\n<p>So in that case when no match is found you can use function for approximate matches <code>=VLOOKUP(C2:C1666,Carwale!G:H,2,TRUE)</code></p>\n\n<p>In case you want to club these two condition use following formula which will first look for exact match and if not found will give you approximate result:</p>\n\n<pre><code>=IFERROR(VLOOKUP(C2:C1666,Carwale!G:H,2,FALSE),VLOOKUP(C2:C1666,Carwale!G:H,2,TRUE))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5717217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd91d8a8b12843a4538548d087a02b25?s=128&d=identicon&r=PG&f=1", "display_name": "Stat_95", "link": "https://stackoverflow.com/users/5717217/stat-95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1465835734, "creation_date": 1465389361, "last_edit_date": 1531161705, "question_id": 37702688, "link": "https://stackoverflow.com/questions/37702688/mapping-columns-in-excel-with-text-based-entries", "title": "Mapping columns in excel with text based entries?", "body": "<p>First Spreadsheet <a href=\"http://i.stack.imgur.com/UY2Rx.jpg\" rel=\"nofollow\">1</a> (\"carwale\" in the formula is the second spreadsheet) </p>\n\n<p>I have two spreadsheets, one column in first one and a second one in other needs to be mapped on the basis of the entries which are in text format and this mapping is needed to be done on the basis that the entries are exactly the same or approximately same. Few of the entries are mapped which were easy to find(i.e exactly the same using vlookup) and the rest are still unmapped. Can someone please help me with this ? </p>\n\n<p>Second spreadsheet <a href=\"http://i.stack.imgur.com/SJQLZ.jpg\" rel=\"nofollow\">2</a></p>\n\n<p>I have added images of the two spreadsheets .. I hope it will help !!</p>\n\n<p>And it's my first question here !! Any suggestions for improving the way of asking questions would be great ..</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465389380, "post_id": 37702601, "comment_id": 62879352, "body": "You could do this with formula, then just use row() or rows() to get the number  something like sheet5.range(&quot;Z:Z&quot;),row(z1)  or just use i"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "edited": false, "score": 0, "creation_date": 1465390027, "post_id": 37702785, "comment_id": 62879862, "body": "Can you clearify your answer, I&#39;m not an expert in VBA. You do no have a formula that I can place on the <b>????</b>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "edited": false, "score": 0, "creation_date": 1465390325, "post_id": 37702785, "comment_id": 62880096, "body": "Just use I, as this is going from 1 to 12.  I&#39;ve also put month(z:z),I in my answer"}, {"owner": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "edited": false, "score": 0, "creation_date": 1465390631, "post_id": 37702785, "comment_id": 62880311, "body": "But when I use only i, I get an error  Unable to get the AverageIfs property of the Worksheetfunction class&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "edited": false, "score": 0, "creation_date": 1465391708, "post_id": 37702785, "comment_id": 62881095, "body": "You&#39;ll need to add a helper column with month(z) in so AA1=month(z1) or you can use an array.  This would be easier in static formula"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "edited": false, "score": 0, "creation_date": 1465394558, "post_id": 37702785, "comment_id": 62883401, "body": "something like this <code>(SUM(--(MONTH($A$1:$A$7)=2)*($C$1:$C$7)))&#47;SUM(--(MONTH($A$1:&zwnj;&#8203;$A$7)=2))</code> could be used as a formula no need for code, my dates are in a1:a7 and my values in c1:c7"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1465389593, "creation_date": 1465389593, "answer_id": 37702785, "question_id": 37702601, "link": "https://stackoverflow.com/questions/37702601/vba-averageifs-loop/37702785#37702785", "title": "VBA Averageifs loop", "body": "<p>You can use row() or rows() to get the number something like <code>sheet5.range(\"Z:Z\"),row(z1)</code> or just use i you'll also need to use month, if you are comparing to dates, so <code>month(z:z),i</code>  It can also be done with static formula</p>\n"}], "owner": {"reputation": 95, "user_id": 5424264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/103d7f698a12e770ae84476be1a856c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5424264", "link": "https://stackoverflow.com/users/5424264/user5424264"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 37702785, "answer_count": 1, "score": 0, "last_activity_date": 1465390494, "creation_date": 1465389121, "last_edit_date": 1531164843, "question_id": 37702601, "link": "https://stackoverflow.com/questions/37702601/vba-averageifs-loop", "title": "VBA Averageifs loop", "body": "<p>I want to loop my averageifs in VBA:</p>\n\n<p>1a</p>\n\n<pre><code>i = 1 To 12\n\nSheet5.Cells(i + 1, 10) = WorksheetFunction.AverageIfs(Sheet5.Range(\"B:B\"), Sheet5.Range(\"Z:Z\"), ????, Sheet5.Range(\"AA:AA\"), \"=2015\")\n\nNext i\n</code></pre>\n\n<p>So For the <strong>????</strong> I'm looking for a code that loops over 1 to 12, I already tried a lot of things and googled for hours. </p>\n\n<p>Thanks for Your help. </p>\n\n<hr>\n\n<p>Maybe this clarifies my problem:</p>\n\n<p>1b</p>\n\n<p>ps: first I was looking for a code that took the average over a month a and year, I already subdivided the dates into months and years and now I'm taking the average over a month in a certain year (e.g. february, 2016). </p>\n\n<pre><code>10/10/2015 ----- 13 \n\n11/10/2015 ----- 9  \n\n01/01/2016 ----- 2 \n\n31/01/2016 ----- 3 \n\n31/02/2016 ----- 4\n</code></pre>\n\n<p>So in this example if I want the average over January 2016, that should be 2,5. And I want to make a code that loops from 01/2015 till 12/2020 and puts the average in each cell. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 1, "creation_date": 1465388406, "post_id": 37702262, "comment_id": 62878625, "body": "Two more <code>Application</code> related tips to help performance are <code>Application.Calculation = xlCalculationManual</code> and <code>Application.DisplayAlerts = False</code>.  But in your case I&#39;m not sure those would help a whole lot"}, {"owner": {"reputation": 187, "user_id": 4462614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/AXEEx.jpg?s=128&g=1", "display_name": "tulanejosh", "link": "https://stackoverflow.com/users/4462614/tulanejosh"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1465388663, "post_id": 37702262, "comment_id": 62878808, "body": "Dude! Application.Calculation = xlCalculationManual worked. Took it from 5+ minutes to &lt;10 seconds. Why is that??? I hadn&#39;t added that because I thought looping through an Array only looked at values, not formulas, so preventing calculations would be meaningless."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1465388747, "post_id": 37702262, "comment_id": 62878875, "body": "every time you write a change the workbook recalculates"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1465388778, "post_id": 37702262, "comment_id": 62878910, "body": "Combine your <code>If</code> statements with <code>And</code> and use a <code>For Each</code> loop to loop through the rows you want to evaluate."}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 1, "creation_date": 1465388923, "post_id": 37702262, "comment_id": 62879025, "body": "Just be sure to put at the end <code>Application.Calculation = xlCalculationAutomatic</code>, otherwise whenever you manually enter a formula and copy it, it will paste the original result each time. Same with <code>DisplayAlerts</code> (<code>=True</code>)"}, {"owner": {"reputation": 187, "user_id": 4462614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/AXEEx.jpg?s=128&g=1", "display_name": "tulanejosh", "link": "https://stackoverflow.com/users/4462614/tulanejosh"}, "edited": false, "score": 0, "creation_date": 1465389401, "post_id": 37702262, "comment_id": 62879370, "body": "Could you put that as the answer? Because it answers my question. :) Thanks GuyThatReallyKnowsStuff."}], "answers": [{"tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": true, "score": 2, "last_activity_date": 1465389732, "creation_date": 1465389732, "answer_id": 37702836, "question_id": 37702262, "link": "https://stackoverflow.com/questions/37702262/loop-through-array-with-nested-ifs-faster/37702836#37702836", "title": "Loop through Array with Nested Ifs Faster", "body": "<p>As per my comment, try using <code>Application.Calculation = xlCalculationManual</code> and <code>Application.DisplayAlerts = False</code> to speed things up.</p>\n\n<p>Just be sure to put <code>Application.Calculation = xlCalculationAutomatic</code> and <code>Application.DisplayAlerts = True</code> at the end :)</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 2, "last_activity_date": 1465391522, "creation_date": 1465391522, "answer_id": 37703516, "question_id": 37702262, "link": "https://stackoverflow.com/questions/37702262/loop-through-array-with-nested-ifs-faster/37703516#37703516", "title": "Loop through Array with Nested Ifs Faster", "body": "<p>Also - you're losing a lot of the time saving array functionality by making frequent calls back to the api.  Example: </p>\n\n<pre><code> if sh3.Cells(R, \"G\").Value  \n</code></pre>\n\n<p>should be the same thing as </p>\n\n<pre><code> if vData(R,7)  \n</code></pre>\n\n<p>You probably don't need the loop</p>\n\n<pre><code> For C = 1 to ubound(vData,2)\n Next C\n</code></pre>\n\n<p>You're not referencing it anywhere and it's gonna exponentially increase the number of instructions.</p>\n\n<p>Try stepping through your code using f8 with your locals window open and watch what happens to the variables that you've declared for further detail.</p>\n\n<p>You should manipulate the values inside of the array versus on the worksheet, just at the end of the procedure you can replace the activesheet values in one instruction versus doing that within the loop </p>\n\n<p>Just be cautious that your formats will not carry into your array \"vData\", it's only setting the .value of the usedrange, hence formatting will drop, and variant data type vData will grab the closest apparent data type.  What this means is when something looks like a number if it has leading zeros even if it is text after you drop it into the worksheet you lose those leading zeros a way around that is to format the cells prior to setting the values within the api otherwise excel just does what it does best, I like to use something like</p>\n\n<pre><code> sh5.cells.NumberFormat = \"@\" \n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4462614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/AXEEx.jpg?s=128&g=1", "display_name": "tulanejosh", "link": "https://stackoverflow.com/users/4462614/tulanejosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 37702836, "answer_count": 2, "score": 4, "last_activity_date": 1465391522, "creation_date": 1465388243, "last_edit_date": 1495542158, "question_id": 37702262, "link": "https://stackoverflow.com/questions/37702262/loop-through-array-with-nested-ifs-faster", "title": "Loop through Array with Nested Ifs Faster", "body": "<p>I have an array of data on one worksheet. I need to loop through the array, evaluate each row based on certain criteria, and then take the criteria matched rows and copy them over to another worksheet. I wrote the following code to do this process. </p>\n\n<p>However, the loop takes too long. It takes about 5 minutes to run. I need it to run in less than 30 seconds. I read the following q on SO: <a href=\"https://stackoverflow.com/questions/8178161/what-is-the-most-efficient-quickest-way-to-loop-through-rows-in-vba-excel\">What is the most efficient/quickest way to loop through rows in VBA (excel)?</a> and that lead me to create the array. I also tried to keep the code simple. I turn off screenupdating and enableevents.</p>\n\n<p>What can I do to make this process faster? Thank you for your help.</p>\n\n<pre><code>Sub tester()\n\nDim vData() As Variant\nDim R As Long\nDim C As Long\nDim LastRow1 As Long\nDim rng1 As Range, rng2 As Range\n\nSet sh3 = Sheets(\"ABC\")\nSet sh5 = Sheets(\"XYZ\")\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nLastRow1 = sh3.Cells(Rows.Count, \"A\").End(xlUp).Row\nvData = Range(\"A1:N\" &amp; LastRow1).Value\n\nsh5.Range(\"B3:AV10000\").ClearContents\n\nFor R = 1 To UBound(vData, 1)\n    For C = 1 To UBound(vData, 2)\n        If sh3.Cells(R, \"G\").Value &lt;= Date Then 'if date is prior to today then\n            If sh3.Cells(R, \"J\").Value = \"C\" Then\n                If sh3.Cells(R, \"D\").Value &gt; 0 Then\n                    If sh3.Cells(R, \"I\").Value &gt;= sh3.Cells(R, \"H\").Value Then\n                        Set rng1 = sh3.Range(\"A\" &amp; R &amp; \":N\" &amp; R)\n                        Set rng2 = sh5.Range(\"B\" &amp; R &amp; \":O\" &amp; R)\n                        rng1.Copy rng2\n                    Else\n                        Set rng3 = sh3.Range(\"A\" &amp; R &amp; \":N\" &amp; R)\n                        Set rng4 = sh5.Range(\"B\" &amp; R &amp; \":O\" &amp; R)\n                        rng3.Copy rng4\n                    End If\n                ElseIf sh3.Cells(R, \"D\").Value &lt; 0 Then\n                    If sh3.Cells(R, \"I\").Value &gt;= sh3.Cells(R, \"H\").Value Then\n                        Set rng5 = sh3.Range(\"A\" &amp; R &amp; \":N\" &amp; R)\n                        Set rng6 = sh5.Range(\"B\" &amp; R &amp; \":O\" &amp; R)\n                        rng5.Copy rng6\n                    Else\n                        Set rng7 = sh3.Range(\"A\" &amp; R &amp; \":N\" &amp; R)\n                        Set rng8 = sh5.Range(\"B\" &amp; R &amp; \":O\" &amp; R)\n                        rng7.Copy rng8\n                    End If\n                End If\n            End If\n        End If\n    Next C\nNext R\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 5884437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ffd6a59df3179dcabf261ce6b9b7880?s=128&d=identicon&r=PG&f=1", "display_name": "TimJ", "link": "https://stackoverflow.com/users/5884437/timj"}, "edited": false, "score": 0, "creation_date": 1465466699, "post_id": 37706522, "comment_id": 62917264, "body": "Succinct and effective! Thanks kismert!  Sometimes you just need someone to point out something obvious that you&#39;ve been too close to see!"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 5, "last_activity_date": 1465398867, "creation_date": 1465398867, "answer_id": 37706522, "question_id": 37702120, "link": "https://stackoverflow.com/questions/37702120/ms-access-report-based-on-table-raises-query-is-too-complex-error/37706522#37706522", "title": "MS Access report based on table raises &quot;query is too complex&quot; error", "body": "<p>OK, wow. You have built quite a lot of complexity into your code, and I'm not at all surprised that Access is complaining. Now, you can spend a lot of time tinkering, and eventually find exactly what is throwing the error. </p>\n\n<p>But what you really need to do is simplify.</p>\n\n<p>Take your problem code. Do you really need to sum that complex <code>IIf()</code> statement 72 times over the whole underlying recordset to get your answer? No.</p>\n\n<p>My fix: add a numeric field called <code>ProjectType</code> to your table. As part of your refresh, run a query like so:</p>\n\n<pre><code>UPDATE MyLocalTable \nSET [ProjectType] = IIf([Project] Like 'AS#*' Or [Project] Like 'ABG#*' \n    Or [Project] Like 'ADG#*'  Or [Project] Like 'AE#*' Or [Project] Like 'AI#*' \n    Or [Project] Like 'AIN#*' Or [Project] Like 'AM#*' Or [Project] Like 'IMP#*',1, 0)\n</code></pre>\n\n<p>Now, you've done two significant things:</p>\n\n<ul>\n<li>You have typed that awful <code>IIf()</code> statement just once, making your code easier to understand and maintain</li>\n<li>You have calculated the ProjectType for each row exactly once, not 72 times.</li>\n</ul>\n\n<p>Now your problem code looks more like this:</p>\n\n<pre><code>For i = 1 To 18\n    Me.Controls(\"TotalPHrsPDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([ProjectType]=1,[\" &amp; Dates(i) &amp; \" P]), 0)\"\n    Me.Controls(\"TotalPHrsTSDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([ProjectType]=1,[\" &amp; Dates(i) &amp; \" TS], 0)\"\n    Me.Controls(\"TotalNPHrsPDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([ProjectType]=0,[\" &amp; Dates(i) &amp; \" P],0))\"\n    Me.Controls(\"TotalNPHrsTSDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([ProjectType]=0,[\" &amp; Dates(i) &amp; \" TS],0))\"\nNext i\n</code></pre>\n\n<p>Much more succinct. And much more likely not to throw an error. You can take this idea and eliminate a lot more complexity from this code.</p>\n"}], "owner": {"reputation": 347, "user_id": 5884437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ffd6a59df3179dcabf261ce6b9b7880?s=128&d=identicon&r=PG&f=1", "display_name": "TimJ", "link": "https://stackoverflow.com/users/5884437/timj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 37706522, "answer_count": 1, "score": 1, "last_activity_date": 1465398867, "creation_date": 1465387858, "last_edit_date": 1465391412, "question_id": 37702120, "link": "https://stackoverflow.com/questions/37702120/ms-access-report-based-on-table-raises-query-is-too-complex-error", "title": "MS Access report based on table raises &quot;query is too complex&quot; error", "body": "<p><strong>Problem:</strong> I have a grouped MS Access 2010 report directly linked to a local table. It has 40 'bound' fields per record, and 152 calculated fields per group. When my vba script tries to automatically update the control source of the last few calculated fields (at runtime) it throws a \"Query is too complex\" error!</p>\n\n<p><strong>Background:</strong>\nI'm creating an MS Access report directly linked to a local table, which contains a Person field/column, a Project field/column and 38 numeric fields/columns for each record.</p>\n\n<p>The report is grouped on Person, and each person has multiple project records.</p>\n\n<p>In the group footer for each person I have 4 calculated controls beneath each of the 38 numeric fields/columns. </p>\n\n<p>So to recap, I have a total of 40 'bound' / directly linked fields per record and 152 calculated fields per group.</p>\n\n<p>The report is tied directly to a local table that is periodically dropped and recreated by a maketable query that is tied to a dynamic SQL query that outputs different columns depending on today's date. In order to account for the different field names that will be provided by the dynamic query I have some VBA script that does the same calculation as happens on the server (calculates all months between today's date -11 months and +6 months and formats to match expected column names), then changes the control sources of the relevant report fields and column label captions to match what is expected to come through from the table, which comes from the dynamic query. </p>\n\n<p>It all seems to work great, apart from my last few lines of code to update some of the calculated fields in the group footer. Here's the <strong>working</strong> section of the script (from the On Open event of the report) that all seems to be working fine, just for context:</p>\n\n<pre><code>Dim NowDate As Date\nDim i, monthcalc As Integer\nDim Dates(1 To 18) As String\n\nNowDate = Now()\n\nmonthcalc = -11\n\n'The below creates variables of formatted dates to be used as control sources for the expected fields incoming from SQL\nFor i = 1 To 18\n    Dates(i) = Year(DateAdd(\"m\", monthcalc, NowDate)) &amp; Format(month(DateAdd(\"m\", monthcalc, NowDate)), \"00\")\n    monthcalc = monthcalc + 1\nNext i\n\n\nmonthcalc = -11\n\n'The below sets the column captions to match the expected fields incoming from SQL\nFor i = 1 To 18\n    Me.Controls(\"Date\" &amp; Trim(Str(i))).Caption = MonthName(month(DateAdd(\"m\", monthcalc, NowDate))) &amp; \" \" &amp; Year(DateAdd(\"m\", monthcalc, NowDate))\n    monthcalc = monthcalc + 1\nNext i\n\n'The below sets the dynamic 'bound' numeric fields to match the expected fields incoming from SQL\nFor i = 1 To 18\n    Me.Controls(\"Date\" &amp; Trim(Str(i)) &amp; \"P\").ControlSource = Dates(i) &amp; \" P\"\n    Me.Controls(\"Date\" &amp; Trim(Str(i)) &amp; \"TS\").ControlSource = Dates(i) &amp; \" TS\"\nNext i\n\n'The below sets the first calculated column beneath each numeric field\nFor i = 1 To 18\n    Me.Controls(\"TotalDate\" &amp; Trim(Str(i)) &amp; \"P\").ControlSource = \"=Sum([\" &amp; Dates(i) &amp; \" P])\"\n    Me.Controls(\"TotalDate\" &amp; Trim(Str(i)) &amp; \"TS\").ControlSource = \"=Sum([\" &amp; Dates(i) &amp; \" TS])\"\nNext i\n</code></pre>\n\n<p>Now the code that is problematic (note three of the lines within the loop are commented out):</p>\n\n<pre><code>For i = 1 To 18\n    Me.Controls(\"TotalPHrsPDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([Project] Like 'AS#*' Or [Project] Like 'ABG#*' Or [Project] Like 'ADG#*' Or [Project] Like 'AE#*' Or [Project] Like 'AI#*' Or [Project] Like 'AIN#*' Or [Project] Like 'AM#*' Or [Project] Like 'IMP#*',[\" &amp; Dates(i) &amp; \" P]), 0))\"\n    ' Me.Controls(\"TotalPHrsTSDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([Project] Like 'AS#*' Or [Project] Like 'ABG#*' Or [Project] Like 'ADG#*' Or [Project] Like 'AE#*' Or [Project] Like 'AI#*' Or [Project] Like 'AIN#*' Or [Project] Like 'AM#*' Or [Project] Like 'IMP#*',[\" &amp; Dates(i) &amp; \" TS], 0))\"\n    ' Me.Controls(\"TotalNPHrsPDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([Project] Not Like 'AS#*' And [Project] Not Like 'ABG#*' And [Project] Not Like 'ADG#*' And [Project] Not Like 'AE#*' And [Project] Not Like 'AI#*' And [Project] Not Like 'AIN#*' And [Project] Not Like 'AM#*' And [Project] Not Like 'IMP#*',[\" &amp; Dates(i) &amp; \" P],0))\"\n    ' Me.Controls(\"TotalNPHrsTSDate\" &amp; Trim(Str(i))).ControlSource = \"=Sum(IIf([Project] Not Like 'AS#*' And [Project] Not Like 'ABG#*' And [Project] Not Like 'ADG#*' And [Project] Not Like 'AE#*' And [Project] Not Like 'AI#*' And [Project] Not Like 'AIN#*' And [Project] Not Like 'AM#*' And [Project] Not Like 'IMP#*',[\" &amp; Dates(i) &amp; \" TS],0))\"\nNext i\n</code></pre>\n\n<p>I can only have any one of the above lines within the loop uncommented, as soon as I try to run two or more of them it throws a \"query is too complex\" error when I attempt to open the report.</p>\n\n<p>I have tried running them in separate loops, but the same error is raised. These are the last few lines of code, so it is possible I have hit some kind of limit after one line runs.</p>\n\n<p>Any any suggestions as to a fix? </p>\n\n<p>I have considered moving the group totals &amp; calculations to a subreport, but could I have this included in the main report group footers to only show totals for that group? Would whatever limit that I'm hitting be affected by a subreport? </p>\n"}, {"tags": ["database", "image", "vba", "url", "imageurl"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 2, "creation_date": 1465388292, "post_id": 37702111, "comment_id": 62878531, "body": "Hi Alper, welcome to SO. What went wrong when you adapt it to MSAccess? You must describe better."}, {"owner": {"reputation": 11, "user_id": 6440216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308665253856/picture?type=large", "display_name": "Alper \u015eahin", "link": "https://stackoverflow.com/users/6440216/alper-%c5%9eahin"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1465388930, "post_id": 37702111, "comment_id": 62879031, "body": "Thank you! The problem is that, it says &quot;objects required&quot; when I use this code because it uses &quot;activecell&quot; which is an excel method. But I need the object to be taken from a specific column. Since I am so new to VBA and MS Access, I just cannot take the object (URLs) from each rows of that column."}, {"owner": {"reputation": 11, "user_id": 6440216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308665253856/picture?type=large", "display_name": "Alper \u015eahin", "link": "https://stackoverflow.com/users/6440216/alper-%c5%9eahin"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1465575018, "post_id": 37702111, "comment_id": 62974988, "body": "3 days, I am still searching.. :D"}], "owner": {"reputation": 11, "user_id": 6440216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308665253856/picture?type=large", "display_name": "Alper \u015eahin", "link": "https://stackoverflow.com/users/6440216/alper-%c5%9eahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465394012, "creation_date": 1465387839, "last_edit_date": 1465394012, "question_id": 37702111, "link": "https://stackoverflow.com/questions/37702111/ms-access-downloading-image-from-table-url", "title": "MS Access Downloading Image From Table (URL)", "body": "<p>I have been creating a database for my stock system and I have a column that has the image URL of each product. But I wish to have a vba module that downloads the images from the URLs from each row of the \"Image_Url\" column and save them in a folder. I have found a code for excel but I could not implement it on access. </p>\n\n<p>Thanks for helps.</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" (ByVal pCaller As Long, _\nByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nDim Ret As Long\n\n'~~&gt; This is where the images will be saved. Change as applicable\nConst FolderName As String = \"C:\\Temp\\\"\n\nSub Sample()\nDim ws As Worksheet\nDim LastRow As Long, i As Long\nDim strPath As String\n\n'~~&gt; Name of the sheet which has the list\nSet ws = Sheets(\"Sheet1\")\n\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To LastRow '&lt;~~ 2 because row 1 has headers\n    strPath = FolderName &amp; ws.Range(\"A\" &amp; i).Value &amp; \".jpg\"\n\n    Ret = URLDownloadToFile(0, ws.Range(\"B\" &amp; i).Value, strPath, 0, 0)\n\n    If Ret = 0 Then\n        ws.Range(\"C\" &amp; i).Value = \"File successfully downloaded\"\n    Else\n        ws.Range(\"C\" &amp; i).Value = \"Unable to download the file\"\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "scrollbar"], "comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1465386567, "post_id": 37701597, "comment_id": 62877302, "body": "Try <code>....    .Fill.Backcolour.RGB = RGB(0, 0, 0)</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1465386815, "post_id": 37701597, "comment_id": 62877498, "body": "Did you mean <b><i>Backcolour</i></b> or <b><i>Backcolor</i></b> ??"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1465386993, "post_id": 37701597, "comment_id": 62877640, "body": "Its should be <b>Backcolor</b>."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465387122, "post_id": 37701597, "comment_id": 62877729, "body": "i&#39;m making a guess, i think the scroll bar color depends on your windows theme setting, so it cannot be changed in Excel."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465388311, "post_id": 37701597, "comment_id": 62878545, "body": "Also, that should be <code>Activesheet</code> not <code>Active</code> and I doubt that is your Scrollbar name."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1465393316, "post_id": 37701597, "comment_id": 62882353, "body": "Unfortunately looks like a job for <code>Private Declare Function SetSysColors Lib &quot;user32&quot; (ByVal nChanges As Long, lpSysColor As Long, lpColorValues As Long) As Long</code>"}], "owner": {"reputation": 1, "user_id": 6430043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NJkqvWgXfRA/AAAAAAAAAAI/AAAAAAAAF5c/OAhwqmCCY4A/photo.jpg?sz=128", "display_name": "ca.deepak sharma", "link": "https://stackoverflow.com/users/6430043/ca-deepak-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1673, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465388066, "creation_date": 1465386286, "question_id": 37701597, "link": "https://stackoverflow.com/questions/37701597/change-scroll-bar-colour-excel-vba", "title": "Change Scroll Bar Colour excel-vba", "body": "<p>I am trying to change the colour of scroll bar <a href=\"http://i.stack.imgur.com/JDYMp.png\" rel=\"nofollow\">Curves</a> however it matches with my background. I have tried to assign a macro to change the colour however i am getting error 424 \"Object Required\". I am a newbie and sure that i am missing something in the code. Pls help</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Active.Shapes(\"ScrollBar2_Change\").Fill.Backcolour = RGB(0, 0, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1465385862, "post_id": 37701329, "comment_id": 62876802, "body": "Have you looked at the many other questions and answers here for this error message? <a href=\"http://stackoverflow.com/search?q=method+Range+of+object+_worksheet\">stackoverflow.com/search?q=method+Range+of+object+_worksheet</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3623042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96dd6f52f50525691bfec569b18162c4?s=128&d=identicon&r=PG&f=1", "display_name": "user3623042", "link": "https://stackoverflow.com/users/3623042/user3623042"}, "edited": false, "score": 0, "creation_date": 1465386907, "post_id": 37701730, "comment_id": 62877572, "body": "Thank you! I don&#39;t know how it fixed it"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1465386736, "creation_date": 1465386736, "answer_id": 37701730, "question_id": 37701329, "link": "https://stackoverflow.com/questions/37701329/excel-macro-method-range-of-object-worksheet-failed/37701730#37701730", "title": "Excel macro: method range of object _worksheet failed", "body": "<p>All of that selecting and activating is quite unnecessary. I'm not sure exactly why it would trigger that bug on occasion, though I think that it does.</p>\n\n<p>Try:</p>\n\n<pre><code>For Each ws In Worksheets\n    If ws.ChartObjects.Count &gt; 0 Then\n        If ws.Cells(1, \"I\").Value &lt;&gt; 1 Then\n            ws.ChartObjects(\"Chart 1\").Chart.SetSourceData Source:=ws.Range(\"A17:B20\")\n            ws.Cells(1, \"I\").Value = 1\n        End If\n    End If\nNext\n</code></pre>\n\n<p>I also changed <code>Sheets</code> to <code>Worksheets</code> to guard against accidentally iterating over a chart sheet.</p>\n"}], "owner": {"reputation": 25, "user_id": 3623042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96dd6f52f50525691bfec569b18162c4?s=128&d=identicon&r=PG&f=1", "display_name": "user3623042", "link": "https://stackoverflow.com/users/3623042/user3623042"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 37701730, "answer_count": 1, "score": 1, "last_activity_date": 1465387155, "creation_date": 1465385571, "last_edit_date": 1465387155, "question_id": 37701329, "link": "https://stackoverflow.com/questions/37701329/excel-macro-method-range-of-object-worksheet-failed", "title": "Excel macro: method range of object _worksheet failed", "body": "<p>I've written a macro for an Excel template. \nThe macro has to run on all sheets and change the source of each chart(each sheet has the same template and only one chart).\nWhen I run the following code it works fine but doesn't when there are many sheets(50 or more), at some point it gets the exception in the title. It didn't happen on the sheets before and it indeed changed the source.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>For Each ws In Sheets\n    If ws.ChartObjects.Count &gt; 0 Then\n        If ws.Cells(1, \"I\").Value &lt;&gt; 1 Then\n            ws.ChartObjects(\"Chart 1\").Activate\n            ws.Activate    \n            ActiveChart.SetSourceData Source:=ws.Range(\"A17:B20\")    \n            ws.Cells(1, \"I\").Value = 1    \n            ActiveCell.Select\n        End If\n    End If\nNext\n</code></pre>\n\n<p>I've tried activating ws and using Activesheet\nI've also tried using With like this:</p>\n\n<pre><code>Dim rng as Range\nWith ws\n    rng = .Range(\"A17:B20\")\nEnd With\n</code></pre>\n\n<p>No luck so far though.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "edited": false, "score": 0, "creation_date": 1465385960, "post_id": 37701287, "comment_id": 62876868, "body": "i want to copy Sheets(&quot;Sheet2&quot;).Range(&quot;A22:A40&quot;) to Sheets(&quot;Sheet3&quot;).Range(&quot;A22:A40&quot;) and then add two lines before the second copy (i want to separate the two copy in Sheet3 by 2 rows)"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "edited": false, "score": 0, "creation_date": 1465387429, "post_id": 37701287, "comment_id": 62877930, "body": "Oops, My mistake, I&#39;ve got the wrong range. That what you get for staying up till 5am :P I&#39;ve updated my answer"}], "tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1465387373, "last_edit_date": 1465387373, "creation_date": 1465385431, "answer_id": 37701287, "question_id": 37701003, "link": "https://stackoverflow.com/questions/37701003/copy-cells-and-insert-2-lines-between-data/37701287#37701287", "title": "copy cells and insert 2 lines between data", "body": "<p>Since both of the destination is set as <strong>Sheets(\"Sheet3\").Range(\"A22:A40\")</strong></p>\n\n<p>You are writing over First one with second one.</p>\n\n<p>Try changing second destination to <strong>Sheets(\"Sheet3\").Range(\"A43:A61\")</strong></p>\n\n<p>which will leave two rows between them</p>\n"}], "owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465387373, "creation_date": 1465384706, "last_edit_date": 1531164843, "question_id": 37701003, "link": "https://stackoverflow.com/questions/37701003/copy-cells-and-insert-2-lines-between-data", "title": "copy cells and insert 2 lines between data", "body": "<p>I have to copy Range(\"A22:A40\") form Sheet1 to Sheet3 and Range(\"A22:A40\") from \nSheet2 to Sheet3. Each data must be separated by two lines in Sheet3\nthis is what i did :</p>\n\n<pre><code>With Sheets(\"Sheet1\").Range(\"A22:A40\") 'A40 because i can have maximum 40 data\n    Application.Intersect(.SpecialCells(xlCellTypeVisible), _\n          .SpecialCells(xlCellTypeConstants)).Copy _\n               Destination:=Sheets(\"Sheet3\").Range(\"A22:A40\")\nEnd With\n\nWith Sheets(\"Sheet2\").Range(\"A22:A40\") 'A40 because i can have maximum 40 data\n    Application.Intersect(.SpecialCells(xlCellTypeVisible), _\n          .SpecialCells(xlCellTypeConstants)).Copy _\n               Destination:=Sheets(\"Sheet3\").Range(\"A22:A40\")\nEnd With\n</code></pre>\n\n<p>but Sheets(\"Sheet3\").Range(\"A22:A40\") contains only Sheets\n(\"Sheet2\").Range(\"A22:A40\") value .</p>\n\n<p>i want to insert two lines just after and then make the second copy to Sheet3 </p>\n\n<p>How can i separeted them by 2 rows ?</p>\n"}, {"tags": ["vba", "loops", "filter", "functional-programming", "subroutine"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465383751, "post_id": 37700543, "comment_id": 62875446, "body": "Thanks for the help. I left out the part where i copy and paste into a sheet. I was mainly looking for a way to have 1 filter by each team and paste the data into a sheet for each team. The sheet is called Team A and the data is filtered by Team A"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465571367, "post_id": 37700543, "comment_id": 62972751, "body": "Hi @user3018495 Did I answer the question?"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465799320, "post_id": 37700543, "comment_id": 63033201, "body": "Hi, Yes this helped"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1465383364, "creation_date": 1465383364, "answer_id": 37700543, "question_id": 37699786, "link": "https://stackoverflow.com/questions/37699786/sub-function-vba/37700543#37700543", "title": "Sub Function VBA", "body": "<p>Yes it is possible to create a subroutine like you mention, I may have not understood correctly but like your code was not copying the correct team data to the sheets, the below example counters this but you can always places yours back.</p>\n\n<pre><code>Public Sub Sample()\nSample2 \"Team A\"\nSample2 \"Team B\"\nSample2 \"Team C\"\nSample2 \"Team D\"\nSample2 \"Team E\"\nSample2 \"Team F\"\nSample2 \"Team G\"\nSample2 \"Team H\"\nEnd Sub\n\nPrivate Sub Sample2(ByVal StrTeam As String)\nSheets(\"Data\").Range(\"R:R\").AutoFilter Field:=1, Criteria1:=StrTeam\nSheets(\"Data\").Range(\"A:X\").Copy Destination:=Sheets(StrTeam).Range(\"A1\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465384210, "post_id": 37700666, "comment_id": 62875708, "body": "Thanks Darren, this seems to do the trick with a few adjustments! I need to to skip a few more sheets than Data"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465387406, "post_id": 37700666, "comment_id": 62877910, "body": "How would i exclude more than &quot;Data&quot;?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465387690, "post_id": 37700666, "comment_id": 62878109, "body": "You could use a <code>Select Case</code> statement.  I&#39;ll add that code to the bottom of my post."}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465387960, "post_id": 37700666, "comment_id": 62878275, "body": "Hi, Thanks thats brilliant! sorry I am learning as i go with VBA!. next up is making pivot tables with vba for each team!!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465391816, "post_id": 37700666, "comment_id": 62881184, "body": "That&#39;s weird.  Does it crash if you step through the code row by row (pressing F8) - and if so, on what line?"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465392578, "post_id": 37700666, "comment_id": 62881801, "body": "I think its cos i have too much data, i have to restart each time so can&#39;t really say which line. I have 9 teams to loop through, put into separate sheets and make pivots tables from them so i might need a sub routine and then call it i think"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1465392857, "post_id": 37700666, "comment_id": 62882011, "body": "Try @user3598756 answer - the extra code may stop the crashing."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1465387725, "last_edit_date": 1465387725, "creation_date": 1465383662, "answer_id": 37700666, "question_id": 37699786, "link": "https://stackoverflow.com/questions/37699786/sub-function-vba/37700666#37700666", "title": "Sub Function VBA", "body": "<p>A similar answer to Gary's - this will do all sheets except 'Data' and doesn't require a separate procedure:</p>\n\n<pre><code>Sub Test()\n\n    Dim wrkSht As Worksheet\n\n    For Each wrkSht In ThisWorkbook.Worksheets\n        If wrkSht.Name &lt;&gt; \"Data\" Then\n            With ThisWorkbook.Worksheets(\"Data\")\n                .Columns(\"R:R\").AutoFilter Field:=1, Criteria1:=wrkSht.Name\n                .Range(\"A:X\").Copy Destination:=wrkSht.Range(\"A1\")\n            End With\n        End If\n    Next wrkSht\n\nEnd Sub\n</code></pre>\n\n<p>To exclude more than the <code>Data</code> sheet you could use:</p>\n\n<pre><code>Sub Test()\n\n    Dim wrkSht As Worksheet\n\n    For Each wrkSht In ThisWorkbook.Worksheets\n        Select Case wrkSht.Name\n            Case \"Data\", \"SomeOtherSheet\"\n                'Do nothing.\n            Case Else\n                With ThisWorkbook.Worksheets(\"Data\")\n                    .Columns(\"R:R\").AutoFilter Field:=1, Criteria1:=wrkSht.Name\n                    .Range(\"A:X\").Copy Destination:=wrkSht.Range(\"A1\")\n                End With\n        End Select\n    Next wrkSht\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1465385486, "creation_date": 1465385486, "answer_id": 37701309, "question_id": 37699786, "link": "https://stackoverflow.com/questions/37699786/sub-function-vba/37701309#37701309", "title": "Sub Function VBA", "body": "<p>try this</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub Test()\n    Dim ws As Worksheet\n\n    With ThisWorkbook.Worksheets(\"Data\").Range(\"A:X\")\n        For Each ws In ThisWorkbook.Worksheets\n            If InStr(ws.Name, \"Team\") &gt; 0 Then\n                .AutoFilter\n                .Columns(\"R:R\").AutoFilter Field:=18, Criteria1:=ws.Name\n                If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then .SpecialCells(xlCellTypeVisible).Copy Destination:=ws.Range(\"A1\")\n                .AutoFilter\n            End If\n        Next ws\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 37700666, "answer_count": 3, "score": 1, "last_activity_date": 1465387725, "creation_date": 1465381324, "last_edit_date": 1465381764, "question_id": 37699786, "link": "https://stackoverflow.com/questions/37699786/sub-function-vba", "title": "Sub Function VBA", "body": "<p>I have a filter based on Team A which looks like this </p>\n\n<pre><code>Sheets(\"Data\").Range(\"A:X\").copy  Destination:=Sheets(\"Team A\").Range(\"A1\")\n\nColumns(\"R:R\").Select\nSelection.AutoFilter\nActiveSheet.Range(\"$R$1:$R$1048576\").AutoFilter Field:=1, Criteria1:= _\n\"Team A\"\n</code></pre>\n\n<p>I want to filter the data by the other 8 teams and paste the data into a sheet each.</p>\n\n<p>Is this possible to use a sub routine with parameters so instead of putting team A i can jut put a variable name like R which will loop through the team names that i can reference?</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["asp.net", "excel", "vba", "internet-explorer", "download"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465467222, "post_id": 37702025, "comment_id": 62917587, "body": "Thanks Meaden for your help.  Just wondering whether your code requires to know the file extension beforehand?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465470142, "post_id": 37702025, "comment_id": 62919489, "body": "No, I don&#39;t think so.  Did you try it?"}, {"owner": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465555513, "post_id": 37702025, "comment_id": 62962154, "body": "Just tried it for a ppt file. Turned out it downloaded as a 3kb file and cannot be opened by PowerPoint.  Then I changed the extension to txt and opened successfully, but the content was the source code of the webpage instead."}, {"owner": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465569210, "post_id": 37702025, "comment_id": 62971275, "body": "Yes it is. It ends with  &quot;.aspx?id=(a random number)&quot;"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465572091, "post_id": 37702025, "comment_id": 62973214, "body": "so why issue a second request to the address referenced in the response to the first?"}, {"owner": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465604570, "post_id": 37702025, "comment_id": 62986889, "body": "Sorry but I don&#39;t quite get your question. What do you mean by a second request?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "edited": false, "score": 0, "creation_date": 1465667120, "post_id": 37702025, "comment_id": 63002027, "body": "Ok, sorry let me try again...  so if you are redirected I think you get a redirect status code (300-303, 307-308) and if so then you ought to be able to inspect the redirect URL.  I have changed my code samples."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1465666477, "last_edit_date": 1465666477, "creation_date": 1465387590, "answer_id": 37702025, "question_id": 37699241, "link": "https://stackoverflow.com/questions/37699241/excel-vba-download-file-with-random-file-extension/37702025#37702025", "title": "Excel vba download file with random file extension", "body": "<p>Ok, editing answer to fold in feedback, three different ways to make an HTTP request and it seems you are looking to trap a redirect which is status codes 300-303, 307-308.  Try this and provide feedback as to whether or not you are redirected.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TestGetFileFromWeb()\n     Call SaveTextToFile(GetFileFromWeb2(\"http://www.wikipedia.com\"), \"c:\\temp\\wikipedia2.txt\")\n     Call SaveTextToFile(GetFileFromWeb3(\"http://www.wikipedia.com\"), \"c:\\temp\\wikipedia3.txt\")\n\n     '* placed last because it gives \"Access Denied\" Run-time error '-2147024891   &amp;h80070005\n     'Call SaveTextToFile(GetFileFromWeb1(\"http://www.wikipedia.com\"), \"c:\\temp\\wikipedia1.txt\")\n     Call SaveTextToFile(GetFileFromWeb1(\"http://www.bbc.com\"), \"c:\\temp\\bbc.txt\")\n\nEnd Sub\n\nPrivate Function SaveTextToFile(ByRef sText As String, ByVal sFileName As String) As Boolean\n\n\n    '* Requires Tools -&gt;References -&gt; Microsoft Scripting Runtime\n\n    Dim fso As Scripting.FileSystemObject\n    Set fso = New Scripting.FileSystemObject\n\n    Dim txtOut As Scripting.TextStream\n    Set txtOut = fso.CreateTextFile(sFileName, , True)\n    txtOut.Write sText\n    txtOut.Close\n    Set txtOut = Nothing\n    Set fso = Nothing\n\n    SaveTextToFile = True\n\nEnd Function\n\nPrivate Function GetFileFromWeb1(ByVal sURL As String) As String\n\n    '* Requires Tools-&gt;References-&gt;Microsoft Xml, v.6.0\n\n    Dim xHTTPRequest As MSXML2.XMLHTTP60\n    Set xHTTPRequest = New MSXML2.XMLHTTP60\n\n    xHTTPRequest.Open \"GET\", sURL, False\n    xHTTPRequest.Send\n    Debug.Assert WasRedirected(xHTTPRequest.Status)\n\n    GetFileFromWeb1 = xHTTPRequest.ResponseText\n\nEnd Function\n\n\nPrivate Function GetFileFromWeb2(ByVal sURL As String) As String\n\n    '* Requires Tools-&gt;References-&gt;Microsoft WinHTTP Services, version 5.1\n\n    Dim oWinHttp As WinHttp.WinHttpRequest\n    Set oWinHttp = New WinHttp.WinHttpRequest\n\n    oWinHttp.Open \"GET\", sURL, False\n    oWinHttp.Send\n    Debug.Assert WasRedirected(oWinHttp.Status)\n    GetFileFromWeb2 = oWinHttp.ResponseText\n\nEnd Function\n\n\nPrivate Function WasRedirected(ByVal lStatus As Long) As Boolean\n\n    'http://qnimate.com/redirection-and-duplicate-content-in-websites/\n    'There are many types of HTTP redirection.\n    '\n    '300 Redirect or Multiple Choices\n    '301 Redirect or permanent redirect\n    '302 Redirect or Found or Temporary Redirect\n    '303 Redirect or See Other\n    '307 Redirect or Temporary Redirect\n    '308 Redirect or Permanent Redirect\n    'HTTP refresh header\n\n    WasRedirected = (lStatus = 300 Or lStatus = 301 Or lStatus = 302 Or lStatus = 303 Or lStatus = 307 Or lStatus = 308)\n\nEnd Function\n\n\nPrivate Function GetFileFromWeb3(ByVal sURL As String) As String\n\n    '* Requires Tools-&gt;References-&gt;Microsoft Xml, v.6.0\n\n    Dim xHTTPRequest As MSXML2.ServerXMLHTTP60\n    Set xHTTPRequest = New MSXML2.ServerXMLHTTP60\n    xHTTPRequest.Open \"GET\", sURL, False\n    xHTTPRequest.Send\n    Debug.Assert WasRedirected(xHTTPRequest.Status)\n    GetFileFromWeb3 = xHTTPRequest.ResponseText\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2829644, "user_type": "registered", "profile_image": "https://graph.facebook.com/649615675194495/picture?type=large", "display_name": "Andrew Lee", "link": "https://stackoverflow.com/users/2829644/andrew-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1465666477, "creation_date": 1465379864, "question_id": 37699241, "link": "https://stackoverflow.com/questions/37699241/excel-vba-download-file-with-random-file-extension", "title": "Excel vba download file with random file extension", "body": "<p>I am trying to write a code to automatically download files from a website by Excel vba.  I know there are plenty of posts regarding this topic but no luck so far. The first few lines of code go like this:</p>\n\n<pre><code>Sub testing()\n\nDim ie as object\n\nUrl _base = \"http://www..../download.aspx?id=\"\nNum = cells(1,1).value\nSet ie = createobject (\"internetexplorer.application\")\nIe.visible = true\n\nFor i = 1 to num\n   Url = url _base &amp; i\n    ....\n</code></pre>\n\n<p>Then I become clueless.  The problem is that winhttp seems to only download csv files, and urldownloadtofile requires a solid url path ending with the file extension. However, my case is the link is redirecting to the actual file location (no extension shown), and also the file could be any extension such as pdf, jpg, and doc.</p>\n\n<p>Thanks all in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6289785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dca42bbfeba4c161542e678ebc0c249?s=128&d=identicon&r=PG&f=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/6289785/mehrdad"}, "edited": false, "score": 0, "creation_date": 1465390895, "post_id": 37700073, "comment_id": 62880504, "body": "Hi Dave. Thank&#39;s for the quick responce. You have understood what I want it to do, but it doesn&#39;t return any results. I forgot to mention, that it should start counting rows for wb1 from G7. Any suggestions? Thanks"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 15, "user_id": 6289785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dca42bbfeba4c161542e678ebc0c249?s=128&d=identicon&r=PG&f=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/6289785/mehrdad"}, "edited": false, "score": 0, "creation_date": 1465394609, "post_id": 37700073, "comment_id": 62883445, "body": "I&#39;ve amended the range to search; if it&#39;s not finding the value, check the data types match (i.e. both are Number for example) and confirm that the value you are looking for from wb1 definitely exists in wb2"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1465394536, "last_edit_date": 1465394536, "creation_date": 1465382158, "answer_id": 37700073, "question_id": 37699134, "link": "https://stackoverflow.com/questions/37699134/use-value-from-column-in-one-workbook-to-search-column-in-another-workbook/37700073#37700073", "title": "Use value from column in one workbook to search column in another workbook", "body": "<p>Here's how I would look to carry out your requirement (assuming I understood it clearly enough anyway!).  This code loops through all rows in column A in wb2, and performs a Find operation against column G in wb1.  Where it's found, it sets AF column in wb2 for that row to be the value from wb1's Z column on the same row.</p>\n\n<pre><code>Sub ROAC()\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim y As Integer\nDim sht As Worksheet\n\nSet wb1 = Workbooks(\"EP_BB_DK_ny.xlsm\")\nSet wb2 = Workbooks(\"Laaneoversigt.xlsm\")\nSet wb1sht = wb1.Worksheets(\"Period\")\nSet wb2sht = wb2.Worksheets(\"oversigt\")\n\nLastRowWb1 = wb1sht.Cells(wb1sht.Rows.Count, \"G\").End(xlUp).Row\nLastRowWb2 = wb2sht.Cells(wb2sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor y = 1 To LastRowWb2\n    findMe = wb2sht.Range(\"A\" &amp; y).Value\n    With wb1sht.Range(\"G7:G\" &amp; LastRowWb1)\n        Set oFound = .Find(findMe)\n        If Not oFound Is Nothing Then\n            ' Found number - set AF in wb2 on this row to Z on the same row from wb1\n            wb2sht.Range(\"AF\" &amp; oFound.Row).Value = wb1sht.Range(\"Z\" &amp; oFound.Row).Value\n        Else\n            ' Didn't find number, so do whatever you might need to do to handle this in here...\n        End If\n    End With\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1465382515, "creation_date": 1465382515, "answer_id": 37700225, "question_id": 37699134, "link": "https://stackoverflow.com/questions/37699134/use-value-from-column-in-one-workbook-to-search-column-in-another-workbook/37700225#37700225", "title": "Use value from column in one workbook to search column in another workbook", "body": "<p>This should fix your issue ( I've not wrote this in VBA so there might be the odd syntax issue).</p>\n\n<p>Essentially, you can 'Find' your value in wb1 and if its there paste that value into wb2.</p>\n\n<pre><code>Sub ROAC()\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim y As Integer\nDim sht As Worksheet\nDim fndRange as Range\nDim wb1Value as variant       \n\nSet wb1 = Workbooks(\"EP_BB_DK_ny.xlsm\")\nSet wb2 = Workbooks(\"Laaneoversigt.xlsm\")\nSet sht = wb2.Worksheets(\"oversigt\")\n\nLastRow = sht.Cells(sht.Rows.Count, \"AF\").End(xlUp).Row\nLastRowWb1 = wb2.Sheets(\"Period\").Range(\"G\" &amp; Rows.Count).End(xlUp).Row\nLastRowWb2 = wb2.Sheets(\"Oversigt\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor y = 7 To LastRowWb1\n\n    wb1Value = wb1.Sheets(\"Period\").Range(\"G\" &amp; y).Value\n\n    Set fndRange = wb2.Sheets(\"Oversigt\").Range(\"A1:A\" &amp; LastRowWb2).Find(What:= wb1Value)\n\n    If Not fndRange is Nothing Then\n        wb2.Sheets(\"Oversigt\").Range(\"AF\" &amp; LastRow).Offset(1, 0).Value = wb1.Sheets(\"Period\").Range(\"G\" &amp; fndRange.Row)\n    End If\n\nNext y\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1465382789, "creation_date": 1465382789, "answer_id": 37700324, "question_id": 37699134, "link": "https://stackoverflow.com/questions/37699134/use-value-from-column-in-one-workbook-to-search-column-in-another-workbook/37700324#37700324", "title": "Use value from column in one workbook to search column in another workbook", "body": "<pre><code>Sub ROAC()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim Target_Data As Range\nDim y As Integer\n\n'Since you were using same sheets over and over, I just set ws1 and ws2 \n'instead of writing Wb1.Sheets(\"Period\") wb2.Sheets(\"Oversigt\") everytime\nSet ws1 = Workbooks(\"EP_BB_DK_ny.xlsm\").SHEETS(\"Period\")\nSet ws2 = Workbooks(\"Laaneoversigt.xlsm\").SHEETS(\"Oversigt\")\n\nlastrow = ws2.Cells(ws2.Rows.Count, \"AF\").End(xlUp).Row\nLastRowWb1 = ws1.Range(ws1.Range(\"G1\"), ws1.Range(\"G1\").End(xlDown)).Rows.Count\n\nFor y = 7 To LastRowWb1\n\n''''This compares ws1.Range(\"G\" &amp; y) with ws2.Column A and set Target_Data as matching range \n    Set Target_Data = ws2.Columns(\"A\").Find(ws1.Range(\"G\" &amp; y).Value)\n\n''''This check if the Target_data found data or not (Find method will return Nothing if it doesn't find it.)\n    If Not (Target_Data Is Nothing) Then\n\n''''''''This will write ws1. Column Z's data to ws2. Column AF on same row as where the data is found\n        ws2.Range(\"AF\" &amp; Target_Data.Row) = ws1.Range(\"Z\" &amp; y)\n\n    End If\nNext y\n\nEnd Sub\n</code></pre>\n\n<p>I might be little off on getting source data and target data.</p>\n\n<p>It's really confusing</p>\n\n<p>Anyway, You can play around with it to make it work :)</p>\n"}], "owner": {"reputation": 15, "user_id": 6289785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dca42bbfeba4c161542e678ebc0c249?s=128&d=identicon&r=PG&f=1", "display_name": "Mehrdad", "link": "https://stackoverflow.com/users/6289785/mehrdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 37700073, "answer_count": 3, "score": 1, "last_activity_date": 1465394536, "creation_date": 1465379598, "question_id": 37699134, "link": "https://stackoverflow.com/questions/37699134/use-value-from-column-in-one-workbook-to-search-column-in-another-workbook", "title": "Use value from column in one workbook to search column in another workbook", "body": "<p>I'm having trouble with the code below.</p>\n\n<p>I'm trying to use the values from column \"A\" in wb2 to search in column \"G\" in wb1. </p>\n\n<p>Column \"A\" in wb2 contains a long list of numbers and I'm trying to search a exact match of that number in column \"G\" in wb1. </p>\n\n<p>When there's a match I need it to set the value of column \"AF\" at the correct row in wb2 to the corresponding match from wb1, but from another column, maybe column \"Z\" instead of \"G\".</p>\n\n<p>The to workbooks are already open, when running the macro.</p>\n\n<p>Hope you can help me out.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub ROAC()\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim y As Integer\nDim sht As Worksheet\n\n\nSet wb1 = Workbooks(\"EP_BB_DK_ny.xlsm\")\nSet wb2 = Workbooks(\"Laaneoversigt.xlsm\")\nSet sht = wb2.Worksheets(\"oversigt\")\n\nLastRow = sht.Cells(sht.Rows.Count, \"AF\").End(xlUp).Row\nLastRowWb1 = wb1.Sheets(\"Period\").Range(wb1.Sheets(\"Period\").Range(\"G1\"), wb1.Sheets(\"Period\").Range(\"G1\").End(xlDown)).Rows.Count\nLastRowWb2 = wb2.Sheets(\"Oversigt\").Range(wb2.Sheets(\"Oversigt\").Range(\"A1\"), wb2.Sheets(\"Oversigt\").Range(\"A1\").End(xlDown)).Rows.Count\n\nFor y = 7 To LastRowWb1\nFor x = 1 To LastRowWb2\n\n\nIf wb1.Sheets(\"Period\").Range(\"G\" &amp; y).Value = wb2.Sheets(\"Oversigt\").Range(\"A\" &amp; x).Value Then\n\nwb2.Sheets(\"Oversigt\").Range(\"AF\" &amp; LastRow).Offset(1, 0).Value = wb1.Sheets(\"Period\").Range(\"G\" &amp; y)\n\nEnd If\n\nNext x\nNext y\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1465379750, "post_id": 37699065, "comment_id": 62872843, "body": "See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for methods on getting away from relying on select and activate to accomplish your goals."}], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1465381487, "creation_date": 1465381487, "answer_id": 37699849, "question_id": 37699065, "link": "https://stackoverflow.com/questions/37699065/worksheet-select-switching-screens-excel-vba/37699849#37699849", "title": "Worksheet.Select switching screens excel VBA", "body": "<p>As @Jeeped stated and referenced, avoid using <code>Select</code> and <code>Activate</code>, in addition it is safer to qualify references.</p>\n\n<p>For example you can use <code>Range(\"A1\").Value</code> to get a value of the cell A1 in the currently active worksheet, but what if the user didn't have that sheet active at the time or another proc had moved the view? you could get the value of cell A1 from potentially any worksheet.</p>\n\n<p>It would be best to create a reference to the worksheet and then send all your work through it, this way you do not need to change the active worksheet and there is no ambiguity about where the range values are coming from. </p>\n\n<p>For example: -</p>\n\n<pre><code>Option Explicit\nDim WkSht_I As Worksheet 'Input\nDim WkSht_P As Worksheet 'Process\nDim WkSht_O As Worksheet 'Output\n\nPublic Sub Sample()\nSet WkSht_I = ThisWorkbook.Worksheets(\"Input\")\nSet WkSht_P = ThisWorkbook.Worksheets(\"Process\")\nSet WkSht_O = ThisWorkbook.Worksheets(\"Output\")\n\nMsgBox \"Input A1 = \" &amp; WkSht_I.Range(\"A1\").Value\nMsgBox \"Process A1 = \" &amp; WkSht_P.Range(\"A1\").Value\nMsgBox \"Output  A1 = \" &amp; WkSht_O.Range(\"A1\").Value\n\nSet WkSht_O = Nothing\nSet WkSht_P = Nothing\nSet WkSht_I = Nothing\nEnd Sub\n</code></pre>\n\n<p>Converting your procedures to this method should be safer and clearer and you can set the active sheet just once for it to show content while the others or being worked on.</p>\n"}, {"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1465385010, "creation_date": 1465385010, "answer_id": 37701114, "question_id": 37699065, "link": "https://stackoverflow.com/questions/37699065/worksheet-select-switching-screens-excel-vba/37701114#37701114", "title": "Worksheet.Select switching screens excel VBA", "body": "<p>@Gary's method is the best method to go with when you are working with multiple worksheets.</p>\n\n<p>If you are working with only two sheets, (Considering you have activesheet and target sheet) I am going to recommend</p>\n\n<pre><code>With Worksheets(\"Process\")\n    Debug.Print .Range(\"A1\")\n    Debug.Print Range(\"A1\")\nEnd With\n</code></pre>\n\n<p>Notice <strong>\".\"</strong> infront of Range.</p>\n\n<p>The <strong>\".\"</strong> indicates that it is part of <strong>With</strong></p>\n\n<p>In other words, .Range(\"A1\") is same as <strong>Worksheets(\"Process\").Range(\"A1\")</strong></p>\n\n<p>Because second Range(\"A1\") does not have <strong>\".\"</strong> it is same as <strong>Activesheet.Range(\"B1\")</strong> even it's inside of the <strong>With-End</strong></p>\n\n<p>If the activesheet is <strong>Process</strong> Then the out put will be same</p>\n\n<p>But when you select worksheet other than <strong>Process</strong>, because activesheet changed, the output will be different.</p>\n\n<p>This will avoide using <strong>Select</strong> which changes the activesheet</p>\n"}], "owner": {"reputation": 321, "user_id": 2183786, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36e2751c8af5977fc1cfe24ced9413e1?s=128&d=identicon&r=PG", "display_name": "James Baker", "link": "https://stackoverflow.com/users/2183786/james-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465385010, "creation_date": 1465379436, "last_edit_date": 1531164843, "question_id": 37699065, "link": "https://stackoverflow.com/questions/37699065/worksheet-select-switching-screens-excel-vba", "title": "Worksheet.Select switching screens excel VBA", "body": "<p>I currently have 3 sheets: Input, Process, Output and a macro that uses values displayed on the input sheet and various stores on the process sheet. The problem is when the user presses a submit button linked to the macro on the input page the sheet switches to the Process sheet before displaying the Output sheet. I understand that this is because of this line of code:</p>\n\n<pre><code>Worksheets(\"Process\").Select\n</code></pre>\n\n<p>However whenever I remove it from the macro everything goes madly out of range. Is there any way of selecting a sheet without actually visually moving to it? I need the macro to do its thing and then simply display the output sheet. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6439465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7f13d5534ffeef306356da49d408aa8a?s=128&d=identicon&r=PG&f=1", "display_name": "charrrrrrrr", "link": "https://stackoverflow.com/users/6439465/charrrrrrrr"}, "edited": false, "score": 0, "creation_date": 1465519872, "post_id": 37698924, "comment_id": 62947476, "body": "Oh thank you so much! That completely slipped my mind."}], "tags": [], "owner": {"reputation": 121247, "user_id": 133802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/033db611465c8752e372f0a21c220f66?s=128&d=identicon&r=PG", "display_name": "David Hedlund", "link": "https://stackoverflow.com/users/133802/david-hedlund"}, "is_accepted": true, "score": 5, "last_activity_date": 1465379113, "creation_date": 1465379113, "answer_id": 37698924, "question_id": 37698622, "link": "https://stackoverflow.com/questions/37698622/else-case-running-even-if-true-if-else/37698924#37698924", "title": "Else case running even if true (If/Else)", "body": "<p>If, say <code>Cells(2, 10)</code> matches your condition, <code>Cells(2, 25)</code> will be set to <code>1</code>, but then it immediately proceeds to test if <code>Cells(2, 11)</code> matches your condition, and if it doesn't, <code>Cells(2, 25)</code> will be overwritten with <code>0</code>.</p>\n\n<p>The end result will always depend on what's in column 20.</p>\n\n<p>You need to break out of your inner loop if the condition ever evaluates to true.</p>\n"}], "owner": {"reputation": 19, "user_id": 6439465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7f13d5534ffeef306356da49d408aa8a?s=128&d=identicon&r=PG&f=1", "display_name": "charrrrrrrr", "link": "https://stackoverflow.com/users/6439465/charrrrrrrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37698924, "answer_count": 1, "score": 0, "last_activity_date": 1465520733, "creation_date": 1465378339, "last_edit_date": 1465520733, "question_id": 37698622, "link": "https://stackoverflow.com/questions/37698622/else-case-running-even-if-true-if-else", "title": "Else case running even if true (If/Else)", "body": "<p>I am currently working with <code>VBA</code> on excel and I really need some help.</p>\n\n<p>As shown below, I'm essentially trying to check all the cells for a specific value (2090) &amp; output \"1\" if 2090 is found in that row, \"0\" otherwise. This output will be on 25th column &amp; be in the same row as where the number is.</p>\n\n<p>I did some tests &amp; I know that my code does indeed output \"1\" when met with 2090 and outputs in the right place etc. However, right after outputting the \"1\", it'll immediately be overlapped by a \"0\" again. Therefore, I believe the else case is running even when the If statement is true. At the end of the execution, my whole column just produces a a bunch of \"1\"s and nothing else.</p>\n\n<p>I would appreciate any kind of help on this! Thank you.</p>\n\n<pre><code>Sub New()\nDim i As Integer, j As Integer, Needed As Integer\nNeeded = 2090\nFor i = 1 To 10\nFor j = 1 To 20\n    If Cells(i, j).Value = Needed Then\n       Cells(i, 25).Value = \"1\"\n    Else\n       Cells(i, 25).Value = \"0\"\n\n    End If\nNext j\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1465378281, "post_id": 37698364, "comment_id": 62871781, "body": "|=Sheet1!C3 for Tom in Sheet4 ,C3 | |=Sheet2!C3 for Peter in Sheet4 ,C4 | |=Sheet3!C3 for Mark in Sheet4 ,C5 | Assuming Sheet1 C3 contains Tom, Sheet2 C3 contains Peter and Sheet3 C3 contains Mark."}], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": true, "score": 0, "last_activity_date": 1465383738, "creation_date": 1465383738, "answer_id": 37700690, "question_id": 37698364, "link": "https://stackoverflow.com/questions/37698364/collecting-a-specific-cell-value-in-multiple-worksheets-and-display-those-values/37700690#37700690", "title": "Collecting a specific cell value in multiple worksheets and display those values in a master sheet", "body": "<p>This will loop through and grab Range(\"C3\") from each sheet except the target sheet.</p>\n\n<p>Make sure you change <strong>Target_sheet_name</strong> to your actual target sheet name.</p>\n\n<pre><code>Sub Grab_Names_From_Each_Sheet()\n    Target_sheet_name = \"Sheet1\"\n    Column_Num = 2\n    For Each Sh In ActiveWorkbook\n        If Sh.Name &lt;&gt; Target_sheet_name Then\n            Column_Num = Column_Num + 1\n            SHEETS(Target_sheet_name).Cells(3, Column_Num) = Sh.Range(\"C3\")\n        End If\n    Next Sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6405690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/489895391203226/picture?type=large", "display_name": "Ph\u1ee5 Ki\u1ec7n Tiffany", "link": "https://stackoverflow.com/users/6405690/ph%e1%bb%a5-ki%e1%bb%87n-tiffany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 37700690, "answer_count": 1, "score": 0, "last_activity_date": 1465383738, "creation_date": 1465377766, "last_edit_date": 1531161705, "question_id": 37698364, "link": "https://stackoverflow.com/questions/37698364/collecting-a-specific-cell-value-in-multiple-worksheets-and-display-those-values", "title": "Collecting a specific cell value in multiple worksheets and display those values in a master sheet", "body": "<p>I would like to collect value from cell C3 of all worksheets. And display those values in vertical order of a master worksheet.</p>\n\n<p><strong>Example:</strong> There are values Tom, Peter, Mark in cell C3 of 3 worksheet. I would like to collect those values and display in C3 -> Tom, C4 -> Peter, C5 -> Mark in the 4th worksheet.</p>\n\n<p>What function in excel should I use? Please help.</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "edited": false, "score": 0, "creation_date": 1465377859, "post_id": 37698200, "comment_id": 62871487, "body": "The code you put on every single sheet, can you put that on the question? so I can have better understanding what you are trying to do"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465380765, "post_id": 37698200, "comment_id": 62873567, "body": "Please put code in body of question.  Someone downvoted you (not me) probably because of that.  To format the code use an indentation, best to indent whilst still in VBA IDE rather than StackOverflow question editing box."}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465381382, "post_id": 37698200, "comment_id": 62874004, "body": "No problem, Im learning and new to this site so prepared to take a few hits :)"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465381694, "post_id": 37698200, "comment_id": 62874212, "body": "Are all the files to be found in one folder?"}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465382046, "post_id": 37698200, "comment_id": 62874445, "body": "Yeah that is correct. but this file path will change as the months do. So all June file will be in June folder and when we move to July they will all be in a separate folder marked July. all the workbooks are distinguished by two alphabetical characters. e.g aa,ab,ah,de etc.."}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465382309, "post_id": 37698200, "comment_id": 62874590, "body": "The master folder they will be n will be under 2015. H:\\Departments\\01 GPPD Department - New\\VV Customers\\&quot;2016&quot;\\&quot;June&quot; - &quot;&quot;changeable by month and year"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465387191, "post_id": 37698200, "comment_id": 62877774, "body": "I&#39;ve edited answer, added some code to demonstrate how to cycle through files in a folder.  You&#39;ll need to add reference Microsoft Scripting Runtime."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465389646, "post_id": 37698200, "comment_id": 62879572, "body": "And edited again, .... the code now takes into account some of the business logic you have mentioned, so moveable month and year and also two character filenames."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465380196, "post_id": 37698435, "comment_id": 62873158, "body": "Thank you for commenting @S Meaden, I need all the help I can get as fairly new to me. This is the macro I use in each work book at present;"}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465394015, "post_id": 37698435, "comment_id": 62882950, "body": "Thank you for your help and patience. Would I paste this in the first work book in order to run for all? or should I paste this in a separate workbook? Do I place the macro I have already created in &quot;*Do your stuff here&quot; If so how would I get it to send to different email address for each file or would It mean running the individual macro in each file. Thanks"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1465389585, "last_edit_date": 1465389585, "creation_date": 1465377925, "answer_id": 37698435, "question_id": 37698200, "link": "https://stackoverflow.com/questions/37698200/macro-to-send-multiple-files-to-multiple-address/37698435#37698435", "title": "Macro to send multiple files to multiple address", "body": "<p>(Better information given) ... sounds like you need to step up from VBA Macro Recorder code.  You'll need to master referencing workbooks and worksheets with variables instead of relying upon ActiveWorkbook and ActiveSheet which come from macro recorder.</p>\n\n<p>Try this</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Test()\n\n    '* Specify wb instead of ActiveWorkbook\n    '* Here's how to open a file\n\n    Dim wb As Excel.Workbook\n    Set wb = Workbooks.Open(\"c:\\temp\\bbc.txt\")\n\n    '* Specify sheet instead of activesheet\n\n    Dim ws As Excel.Worksheet\n    Set ws = wb.Worksheets(1)\n\n    '* in your macro code replace activeworkbook with wb\n    '* in your macro code replace activesheet with ws\n\nEnd Sub\n\n'* Tools -&gt;References -&gt; Microsoft Sscripting Runtime\n\nPrivate Sub ToCycleThroughFiles()\n\n    Dim fso As Scripting.FileSystemObject\n    Set fso = New Scripting.FileSystemObject\n\n    Dim sTodaysYear As String\n    sTodaysYear = Format(Now(), \"yyyy\")\n\n    Dim sTodaysMonth As String\n    sTodaysMonth = Format(Now(), \"mmmm\")\n\n    Dim sFolder As String\n    sFolder = \"H:\\Departments\\01 GPPD Department - New\\VV Customers\\\" &amp; sTodaysYear &amp; \"\\\" &amp; sTodaysMonth\n\n\n    Dim fld As Scripting.Folder\n    Set fld = fso.GetFolder(sFolder)\n\n    Dim filLoop As Scripting.File\n    For Each filLoop In fld.Files\n\n        If InStr(1, filLoop.Name, \".xls\", vbTextCompare) &gt; 0 Then\n            '* only interested in excel files,  xls, xlsm etc.\n\n            Dim vSplitFileName As Variant\n            vSplitFileName = VBA.Split(filLoop.Name, \".\")\n            If Len(vSplitFileName(0)) = 2 Then\n                '* two character named workbook, e.g. aa.xls, ab.xls,  ah.xls,  de.xls\n                Call SubRoutine(filLoop.Path)\n            End If\n\n        End If\n\n    Next filLoop\n\nEnd Sub\n\nPrivate Sub SubRoutine(ByVal sWorkbookFullFileName As String)\n\n    '* Do your stuff for each workbook here\n    Dim wb As Excel.Workbook\n    Set wb = Workbooks.Open(sWorkbookFullFileName)\n\n    '....\n    wb.Close\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465399540, "post_id": 37703738, "comment_id": 62887350, "body": "Thank you!! I nearly seem to have this working, however its sending the email to cusomerbradlejohns@xxx.net. I am just trying to figure out how to remove the customer part of the email address and from where."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465412875, "post_id": 37703738, "comment_id": 62895707, "body": "I had an typo in emailTo = getFileName(.Cells(i, 1)).  It should read  emailTo = .Cells(i, 1).  Sorry about that I couldn&#39;t test the send email I don&#39;t have Outlook setup."}, {"owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 1, "creation_date": 1465465903, "post_id": 37703738, "comment_id": 62916752, "body": "That works great now. Thank you very much for your time. If there is anyway I can help you by giving feedback please let me know. Like I said I&#39;m new to this site and its requirements."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "edited": false, "score": 0, "creation_date": 1465467360, "post_id": 37703738, "comment_id": 62917678, "body": "Accepting my answer was enough it helps me build my reputation.  I just joined yesterday and I can&#39;t use many of the features because my reputation isn&#39;t high enough."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1465412680, "last_edit_date": 1465412680, "creation_date": 1465392084, "answer_id": 37703738, "question_id": 37698200, "link": "https://stackoverflow.com/questions/37698200/macro-to-send-multiple-files-to-multiple-address/37703738#37703738", "title": "Macro to send multiple files to multiple address", "body": "<p>It would be better to create a Master.xlsm file to process the emails.<br>\nIt should contain two worksheets, [Settings] and [Email List].</p>\n\n<p>Worksheet [Settings]:</p>\n\n<pre><code>+--------------------------------------------------------------------------------------+\n\u00a6   \u00a6 A              \u00a6 B                                                               \u00a6\n\u00a6---+----------------+-----------------------------------------------------------------\u00a6\n\u00a6 1 \u00a6 Folder Path    \u00a6 C:\\Report\\2016\\June                                             \u00a6\n\u00a6---+----------------+-----------------------------------------------------------------\u00a6\n\u00a6 2 \u00a6 File Extension \u00a6 xls                                                             \u00a6\n\u00a6---+----------------+-----------------------------------------------------------------\u00a6\n\u00a6 3 \u00a6 Subject        \u00a6 Monthly Japan Order                                             \u00a6\n\u00a6---+----------------+-----------------------------------------------------------------\u00a6\n\u00a6 4 \u00a6 Body           \u00a6 Good Morning,Please find this month's JPN order sheet attached. \u00a6\n+--------------------------------------------------------------------------------------+\n</code></pre>\n\n<p>Worksheet [Email List]: Column A should have no blank entries</p>\n\n<pre><code>+----------------------------------------------+\n\u00a6   \u00a6 A                       \u00a6 B              \u00a6\n\u00a6---+-------------------------+----------------\u00a6\n\u00a6 1 \u00a6 To                      \u00a6 File Base Name \u00a6\n\u00a6---+-------------------------+----------------\u00a6\n\u00a6 2 \u00a6 bradley.johns@xxxx.net  \u00a6 bj             \u00a6\n\u00a6---+-------------------------+----------------\u00a6\n\u00a6 3 \u00a6 bradley.adrian@xxxx.net \u00a6 aa             \u00a6\n\u00a6---+-------------------------+----------------\u00a6\n\u00a6 4 \u00a6 frank.johns@xxxx.net    \u00a6 ab             \u00a6\n\u00a6---+-------------------------+----------------\u00a6\n\u00a6 5 \u00a6 trump.donals@xxxx.net   \u00a6 ac             \u00a6\n+----------------------------------------------+\n</code></pre>\n\n<p>Paste this code in a public module.  When your run ProcessFiles() it should iterate through your email list and send out your emails. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub ProcessFiles()\n    'Setup Outlook\n    Dim OutApp As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    Dim rowCount As Integer, i As Integer\n    Dim fileName As String, emailTo As String\n    With Worksheets(\"Email List\")\n        rowCount = Application.WorksheetFunction.CountA(.Columns(1))\n\n        For i = 2 To rowCount\n            emailTo = .Cells(i, 1)\n            fileName = getFileName(.Cells(i, 2))\n            If Len(Dir(fileName)) Then SendMail emailTo, fileName, OutApp\n        Next\n    End With\n\n    Set OutApp = Nothing\nEnd Sub\n\nPublic Function getFileName(fileBaseName As String)\n    Dim folderPath As String, fileExtension As String, fileName As String\n    folderPath = Range(\"Settings!B1\")\n    fileExtension = Range(\"Settings!B2\")\n\n    If Left(fileExtension, 1) &lt;&gt; \".\" Then fileExtension = \".\" &amp; fileExtension\n    If Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\n\n    getFileName = folderPath &amp; fileBaseName &amp; fileExtension\n\nEnd Function\n\nPublic Sub SendMail(emailTo As String, fileName As String, OutApp As Object)\n    Dim OutMail As Object\n    Set OutMail = OutApp.CreateItem(0)\n    On Error Resume Next\n    With OutMail\n        .to = emailTo\n        .CC = \"\"\n        .subject = Range(\"Settings!B3\")\n        .body = Range(\"Settings!B4\")\n        .Attachments.Add fileName\n        .Send\n    End With\n    On Error GoTo 0\n    Set OutMail = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6439373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7311cf81ad959f4073756618245a727d?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/6439373/bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 37703738, "answer_count": 2, "score": 1, "last_activity_date": 1466230464, "creation_date": 1465377300, "last_edit_date": 1466230464, "question_id": 37698200, "link": "https://stackoverflow.com/questions/37698200/macro-to-send-multiple-files-to-multiple-address", "title": "Macro to send multiple files to multiple address", "body": "<p>Please help!! I need advice or info to help me complete this time consuming task.</p>\n\n<p>Every month I have to download 30 files from an internal database, saving them in that months file path. e.g. June files in June's file path. I then have to send these to the 30 different customers to who they relate on a generic email.</p>\n\n<p>e.g AA customers workbook to AA email address. All customer information and codes are saved on another workbook.</p>\n\n<p>I want to do this by a macro but only have the skills to install a macro on each spread sheet and then have to enter the workbook and run them individually (still time consuming). I was hoping somebody would be able to point me in the direction of being able to run one macro that send all the files in one folder to the relevant customer or would point me to something similar which can help me get started.</p>\n\n<p>Thanks</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Mail_Workbook_1()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    On Error Resume Next\n    With OutMail\n        .to = \"bradley.johns@xxxx.net\"\n        .CC = \"\"\n        .Subject = \"Monthly Japan Order\"\n        .Body = \"Good Morning,Please find this month's JPN order sheet attached.\"\n        .Attachments.Add ActiveWorkbook.FullName\n        .Send\n    End With\n    On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "css", "vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3392475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8e4ad24ad77ca7a5055fb21e376a84?s=128&d=identicon&r=PG&f=1", "display_name": "user3392475", "link": "https://stackoverflow.com/users/3392475/user3392475"}, "edited": false, "score": 0, "creation_date": 1465388529, "post_id": 37701885, "comment_id": 62878709, "body": "Hi MuljayLee Thanks for the code but unfortuntely, it doesnt work. It just shifts the first column down to the end of the sheet and highlights the dups which I dont actually need in the end. Its a 15k row document with lots to compare so hoping a code will sort this out for me! Thank you though"}], "tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1465387187, "creation_date": 1465387187, "answer_id": 37701885, "question_id": 37698165, "link": "https://stackoverflow.com/questions/37698165/how-to-align-duplicates-on-same-row-in-excel-for-a-certain-amount-of-columns/37701885#37701885", "title": "How to align duplicates on same row in excel for a certain amount of columns", "body": "<p>Try below code</p>\n\n<pre><code>Sub TEST()\n    I = 1\n    While I &lt;= Cells(Rows.Count, 1).End(xlUp).Row And I &lt;= Cells(Rows.Count, 2).End(xlUp).Row\n        If Range(\"A\" &amp; I) &gt; Range(\"B\" &amp; I) Then\n            Range(\"A\" &amp; I).Insert xlShiftDown\n        ElseIf Range(\"A\" &amp; I) &lt; Range(\"B\" &amp; I) Then\n            Range(\"B\" &amp; I).Insert xlShiftDown\n        Else\n            If I &gt; 1 Then\n                If Range(\"A\" &amp; I - 1) &lt;&gt; Range(\"A\" &amp; I) And Range(\"B\" &amp; I - 1) &lt;&gt; Range(\"B\" &amp; I) Then\n                    Range(\"A\" &amp; I, \"B\" &amp; I).Insert xlShiftDown\n                    I = I + 1\n                End If\n            End If\n        End If\n        I = I + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>And about the color, you can use <strong>Conditional format</strong> to color only the ones that is not blank</p>\n"}], "owner": {"reputation": 1, "user_id": 3392475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8e4ad24ad77ca7a5055fb21e376a84?s=128&d=identicon&r=PG&f=1", "display_name": "user3392475", "link": "https://stackoverflow.com/users/3392475/user3392475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1465387187, "creation_date": 1465377209, "last_edit_date": 1465378067, "question_id": 37698165, "link": "https://stackoverflow.com/questions/37698165/how-to-align-duplicates-on-same-row-in-excel-for-a-certain-amount-of-columns", "title": "How to align duplicates on same row in excel for a certain amount of columns", "body": "<p><a href=\"http://i.stack.imgur.com/8UuKD.png\" rel=\"nofollow\">Picture example of aligning needed</a></p>\n\n<p>Hello, I need help to align duplicates on the same row but extend it over a few columns on each side of these main columns. So for example A and K must be compared to align on the same row BUT columns on each side of A &amp; K must be moved with it e.g column A-I and K- Q must move together to align together based on duplicates in col A and K. Example of what I want is shown in picture attached. </p>\n\n<p>The code below does not included code to insert a line after each realigned duplicate group...please can you help with what code to use to insert a blank line after after each group of duplicates? - Represented in pic above.</p>\n\n<p>The code is below: Will this work?</p>\n\n<pre><code>Sub HighlightDups()\n    Dim i, LastRowA, LastRowB\n    LastRowA = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    LastRowB = Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n    Columns(\"A:I\").Interior.ColorIndex = xlNone\n    Columns(\"K:Q\").Interior.ColorIndex = xlNone\n    For i = 1 To LastRowA\n        If Application.CountIf(Range(\"K:Q\"), Cells(i, \"A\")) &gt; 0 Then\n            Cells(i, \"A\").Interior.ColorIndex = 36\n        End If\n    Next\n    For i = 1 To LastRowB\n        If Application.CountIf(Range(\"A:I\"), Cells(i, \"K\")) &gt; 0 Then\n            Cells(i, \"K\").Interior.ColorIndex = 36\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465376904, "post_id": 37697562, "comment_id": 62870874, "body": "Have you actually set <code>currentWB</code> to be anything?  Excel doesn&#39;t act like Access does with CurrentDB, you would have to have the line somewhere to <code>Set currentWb = ThisWorkbook</code> for example."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465378181, "post_id": 37697562, "comment_id": 62871697, "body": "I would break the line up into separate variables so that one can tell which expression is buggy."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465380205, "post_id": 37697562, "comment_id": 62873169, "body": "@Dave          Sorry for not Writing that out in the code snippet. currentWb is initialized and set. Will update OP soon."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465380302, "post_id": 37697562, "comment_id": 62873250, "body": "@SMeaden       That sounds like a good idea. Will try that! So, from first glance there does not seem to be any obvious misinterpretation of the function? Asking since I&#39;ve had some other trouble with VLookup as well.. <a href=\"http://stackoverflow.com/questions/37678650/changing-worksheet-while-using-vlookup-causes-problems/37679960#37679960\" title=\"changing worksheet while using vlookup causes problems\">stackoverflow.com/questions/37678650/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1465381537, "post_id": 37697562, "comment_id": 62874109, "body": "At first glance it is too complicated for me to parse.  I never write such long lines of code.  Your Locals window in the VBA IDE is your friend, every variable you define is inspect-able in the Locals window."}], "owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465380933, "creation_date": 1465375617, "last_edit_date": 1465380933, "question_id": 37697562, "link": "https://stackoverflow.com/questions/37697562/vlookup-and-range-issue", "title": "VLookup and range issue", "body": "<p>I'm intending to copy a value from an external workbook. I want to import the value corresponding to a specific date and a specific column header. The row headers are dates. Specifically we have:</p>\n\n<pre><code>            Cost     Quantity\n   Date1    2        3\n   Date2    4        5\n</code></pre>\n\n<p>In order to import the value corresponding to (Date1,Cost) I have tried:</p>\n\n<pre><code>   Set currentWb = ActiveWorkbook\n   Set openWb = Workbooks.Open(filepath &amp; Path)\n   Set openWs = openWb.Sheets(6)\n   vary = 175 + MonthNo + YearNo mod 2016\n   currentWb.Sheets(\"Sheet1\").Cells(19 + MonthNo + 12 * (YearNo Mod 2016), 2).Value = Application.VLookup(CLng(CDate(openWs.Range(\"A:\" &amp; vary))), openWs.Range(\"A164:B187\"), Application.Match(\"Cost\", openWs.Range(\"b7:g7\")))\n</code></pre>\n\n<p>There are no issues with finding the correct files. MonthNo and YearNo are just variables which offset the current date with some prespecified months. I omit these for better overview. </p>\n\n<p>The issue I am having is the line where I want to import the data. I get <code>Object or With variable not specified</code> in that line. </p>\n\n<p>Why I use <code>CLng(CDate())</code> is due to the way data is written. In the column with Date headers, these are represented as actual dates and from my understanding this conversion is essential in order to prevent VLookup from looking up the Date Values (integers). </p>\n\n<p>What I have tried thus far is simply Writing \"april-16\" instead of <code>openWs.Range()</code>. Same error, so I'm assuming I have not fully understood VLookup even though I feel certain that this ought to be possible by Reading the documentation. What have I missed? </p>\n\n<p>EDIT: Following @smeaden 's advice, I split up the function into smaller variables. </p>\n\n<p>Using</p>\n\n<pre><code> Dim range1, range2 as integer\n range1 = openWs.Range(\"A164:B187\")\n range2 = Application.Match(\"Cost\", openWs.Range(\"A7:G7\"))\n MsgBox range1\n MsgBox range2\n</code></pre>\n\n<p>caused error <code>Object or With variable not specified</code> in both MsgBoxes (I commented out the MsgBox for range1 and its intitialization and only tried to print MsgBox after the first MsgBox error). </p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 712, "user_id": 6430027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f78a373cd59d67005e32407d8b0663e?s=128&d=identicon&r=PG&f=1", "display_name": "Mono", "link": "https://stackoverflow.com/users/6430027/mono"}, "edited": false, "score": 0, "creation_date": 1465375461, "post_id": 37697327, "comment_id": 62869893, "body": "Do you only care about the values of the cells or do you also need to copy the formatting?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465376180, "post_id": 37697327, "comment_id": 62870415, "body": "You will save a fair bit of time and effort if you drop the <code>Select</code> and <code>Activate</code> commands from your code as they&#39;re not necessary if you fully qualify the workbook and worksheets.  For example you could use <code>Set wSheet = wbk.Worksheets(&quot;Sheet2&quot;)</code> and have no need to <code>Select</code> it.  Similarly use <code>Range(&quot;a2:aa2&quot;).Copy</code> instead of <code>select</code>ing it and then using <code>Selection.copy</code>.  Since the code is working, you might find it better to post it to codereview.stackexchange.com which is the site for discussing improvements in efficiency in working code"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "reply_to_user": {"reputation": 712, "user_id": 6430027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f78a373cd59d67005e32407d8b0663e?s=128&d=identicon&r=PG&f=1", "display_name": "Mono", "link": "https://stackoverflow.com/users/6430027/mono"}, "edited": false, "score": 0, "creation_date": 1465376491, "post_id": 37697327, "comment_id": 62870623, "body": "@Mono I only care about values."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465376560, "post_id": 37697327, "comment_id": 62870666, "body": "@Dave I will give it a shot. Also I will redirect my question to codereview.  Thank you."}, {"owner": {"reputation": 712, "user_id": 6430027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f78a373cd59d67005e32407d8b0663e?s=128&d=identicon&r=PG&f=1", "display_name": "Mono", "link": "https://stackoverflow.com/users/6430027/mono"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465376740, "post_id": 37697327, "comment_id": 62870785, "body": "Then throw away all the Select and copy stuff and you will only need one Loop for everything. You can do it like @Dave suggest. Reference the worksheet you need and then do something like this wSheetTarget.Range(&quot;A1:AA1).value = wSheet.Range(&quot;A1:AA1&quot;).value"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465454435, "post_id": 37697327, "comment_id": 62909770, "body": "I might not have explained it properly. Since each work file has 11 sheets I had to hardcode the select sheet because I dont want to have to make sure that everytime i close one of the work files its on the proper tab. Also replacing the <code>selection.copy</code> with <code>range.copy</code> works nicely."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465453384, "post_id": 37698140, "comment_id": 62909258, "body": "So here is the layout. The 40 workfiles each have 11 sheets. Sheet1, Sheet2 etc. The consolidation file has 2 sheets(one consolidates generated info from SQL the other my calculations that confirm the sql stuff). That is why I have hardcoded the sheets in there. And I use the active cell thing so I can offset it by one cell down. Currently I cant run the snippet you gave me @MutjayLee because it pastes everything on the same row. Im still trying to figure out why it doesnt offset it but 1.5 hours have passed and Im no closer to finding out why. Also apart from the loops everything is recorded."}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465459764, "post_id": 37698140, "comment_id": 62912893, "body": "You used Activecell.Select to get the next row of what you saved last time...is that correct? if that&#39;s the case, from <b>.Range(&quot;a2:aa2&quot;).Copy Workbooks(&quot;example.xlsx&quot;).Sheets(&quot;test&quot;).Range(&quot;A1&quot;)</b>, you can change <b>Range(&quot;A1&quot;)</b> to <b>Range(&quot;A1&quot;).End(xlDown).Offset(1, 0)</b> This will paste it at the end of data. Did I understand your problem right???"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465460538, "post_id": 37698140, "comment_id": 62913322, "body": "I think you understood me however this line <code>.Range(&quot;a2:aa2&quot;).Copy Workbooks(&quot;example.xlsx&quot;).Sheets(&quot;test&quot;).Range(&quot;A1&quot;).End(xlD&zwnj;&#8203;own).Offset(1, 0)</code> throws up an error - <code>Run-time error &#39;1004&#39;: Application-defined or object-defined error</code>. Tried changing a few things(even though ive no clue what im doing) but doesnt seem to want to work."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465461189, "post_id": 37698140, "comment_id": 62913719, "body": "Basically the consolidation file has to have information from the source files on a new row for each source file. If i have 40 source files i need 40 rows in the consolidation file that hold info"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465461664, "post_id": 37698140, "comment_id": 62914011, "body": "What am I thinking...sorry It should be <b>Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0)</b>"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465462093, "post_id": 37698140, "comment_id": 62914249, "body": "Awesome! @MutjayLee Works like a charm. Now I just have to apply my Dr Frankenstein powers to make it work with the 6 other loops. Make it all work from within this one. Thanks again :)"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465465296, "post_id": 37698140, "comment_id": 62916322, "body": "Dang... @ MutjayLee It only works for the one thing. When i tried to apply the same system but a bit modified I mustve screwed it up royaly. What i do is copy a2:aa2 and paste it. WORKS! I copy a3:aa3 and paste it. Doesnt work. Pastes all the formulas and not just the values. Then i try to apply this technique to weird ranges with an offset of 8 cells down and thats when everything went downhill. Data gets copied in the wrong place, gets merged wrongly and erased. I think I shouldnt have tried to fix something that wasnt broken :D"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465465742, "post_id": 37698140, "comment_id": 62916665, "body": "Copy will make target exactly same as source. if the source is formula, it will copy formula, if the target is colored, it will copy color. If you want to copy only value, you can do <b>Workbooks(&quot;example.xlsx&quot;).Sheets(&quot;test&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0) = .Range(&quot;A2:AA2&quot;).Value</b> Instead. This you can change to A3 or A4 or whatever, it will grab the value, and it won&#39;t mess up your output"}, {"owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465465861, "post_id": 37698140, "comment_id": 62916726, "body": "And what do you mean by offset 8 cells..offset 8 from source? or target?"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465545672, "post_id": 37698140, "comment_id": 62956158, "body": "I copy 8 cells high and 4 cells wide into a target sheet and I need to offset the target cell by 8 down so it doesn&#39;t overlap the data. Also I get an error - error 13 type mismatch. Seems I haven&#39;t declared something and is bugging out the macro. Problematic code is the newest snippet. What I&#39;m copying from the source contains only numbers and 2 cells that contain dates. I figure since its all numbers it wont be an issue but it is. I cant figure out what to declare."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1465546135, "post_id": 37698140, "comment_id": 62956419, "body": "Sorry for double posting. Cant figure out this comments system... Here is what I&#39;m working with(edited to hide confidential info). !<a href=\"http://i.imgur.com/JuboxoQ.jpg\" rel=\"nofollow noreferrer\">Source 1</a>. !<a href=\"http://i.stack.imgur.com/5j4Q1.jpg\" rel=\"nofollow noreferrer\">Source 2</a>. From source 1 I take rows 2(2 goes on sheet1 in consolidation file 1) and 3(3 goes on sheet2 in con file). From source 2 I take A2 and paste it and after that A17:G23 and after that I take D5:F11 and paste it next to the other paste from source2 in con file 2."}], "tags": [], "owner": {"reputation": 568, "user_id": 6400782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe167e179a81f8db8067bccc2f224df?s=128&d=identicon&r=PG&f=1", "display_name": "MutjayLee", "link": "https://stackoverflow.com/users/6400782/mutjaylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1465377487, "last_edit_date": 1465377487, "creation_date": 1465377157, "answer_id": 37698140, "question_id": 37697327, "link": "https://stackoverflow.com/questions/37697327/increase-efficiency-with-vba-loops/37698140#37698140", "title": "Increase efficiency with VBA loops", "body": "<p>Try avoiding <strong>Select</strong>. </p>\n\n<p>Unless you want to see the actual data copied. but it will be really hard to see because it will be just blink :)</p>\n\n<p>So instead of </p>\n\n<pre><code>Sheets(\"Sheet2\").Select\nIf ActiveSheet.AutoFilterMode = True Then\n    ActiveSheet.AutoFilterMode = False\nEnd If\nLastRow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\nRange(\"a2:aa2\").Select\nSelection.Copy\n\nWindows(\"example.xlsx\").Activate\n\n\n'Chooses the tab from the consolidation file and copies the data there\nSheets(\"test\").Select\nActiveCell.Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n :=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Try this</p>\n\n<pre><code>with Workbooks(\"Your source workbook\").Sheets(\"Sheet2\")\n     If .AutoFilterMode = True Then .AutoFilterMode = False\n\n     LastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row\n    .Range(\"a2:aa2\").Copy Workbooks(\"example.xlsx\").Sheets(\"test\").Range(\"A1\")\nEnd With\n</code></pre>\n\n<p>By the way, I didn't really get the part ActiveCell.Select. </p>\n\n<p>because that must be target location, but you are selecting the sheets(\"test\") with code.</p>\n\n<p>That means either you have the cells selected on the other code, or it was just recorded macro...I don't know...</p>\n\n<p>I just put Range(\"A1\"), which you can change later</p>\n\n<hr>\n\n<p>In addition, if you have lots of formula, it better to turn off calculation by</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>Because excel will try to calculate every formula whenever there is change, </p>\n\n<p>and it will go much faster without calculation untill you are finished.</p>\n\n<p>And at the end of the loop, make sure you add</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>to turn the calculation back on. </p>\n\n<hr>\n\n<p>One more thing I want to add is</p>\n\n<p>Open 40 files beginning of the all loops you mentioned.</p>\n\n<p>and Close 40 files after you are done copying everything, not just once.</p>\n\n<p>Opening 40 files and saving 40 files 7~8 times will take alot longer than just open and close 40 times :)</p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "is_accepted": true, "score": 0, "last_activity_date": 1466061265, "creation_date": 1466061265, "answer_id": 37852288, "question_id": 37697327, "link": "https://stackoverflow.com/questions/37697327/increase-efficiency-with-vba-loops/37852288#37852288", "title": "Increase efficiency with VBA loops", "body": "<p>First off a huge thank you to @Dave, @Mono and @MutjayLee for the help. They pointed me in the direction I needed. I found a better way of doing the loops and here is the whole macro I use. It now runs only 1 loop instead of 8. And runtime has been lowered from ~2 minutes to ~30 seconds. Which is what I wanted. </p>\n\n<p>If someone thinks this can be made better, please share with us. I would love to make this even better.</p>\n\n<p>I removed the parts of the code that were just formatting since those were just recorded within excel and were WAY too long.</p>\n\n<pre><code>Sub Consolidate_ALL()\n\n'Created on: 11.05.2016\n'by Shakdun\n'Change Log:\n'Date - Change made\n'06.06.2016 - Added new formulas to cells A2, B2 and H2 in tab \"Sheet2\" that are added to each file.\n'06.06.2016 - Added macro optimization. DisplayAlerts.\n'08.06.2016 - Changed some comments.\n'09.06.2016 - Changed the way the macro selects the source sheets and the way it copies the data from them.\n'10.06.2016 - Added macro optimization. Calculation.\n'15.06.2016 - Changed the way LOOPs work. Now instead of 7 or 8 loops it only has 1. Meaning it wont open each file 8 times, but only once. It copies all the information and then it makes adjustments outside of the loop. Speed increase! Run time: ~32 seconds. (run time before this update: ~2 minutes)\n'16.06.2016 - Changed some comments. Changed the filtration of example2. Reviewed the code and removed redundant parts.\n'16.06.2016 - Changed some formating that kept switching between the sheets several times. Now it just switches once and all formating is done a sheet at a time.\n'End Of Change Log   \n\n'Macro optimization\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlCalculationManual\n\nWindows(\"example.xlsx\").Activate\n    Sheets(\"test\").Select\n    Range(\"A2\").Select\n\n'Declare and set variables\nDim wbk As Workbook\nDim Filename As String\nDim Path As String\nDim LastRow As Long\nDim r As Long, endRow As Long, pasteRowIndex As Long\n\n'Path to source files\nPath = \"D:\\work\\\"  'Change path here\nFilename = Dir(Path &amp; \"*.xls\") 'file format has to be the same as source files\n\n'Start of loop. This opens the source files\n Do While Len(Filename) &gt; 0  \n    Set wbk = Workbooks.Open(Path &amp; Filename)\n    Set wSheet = wbk.Worksheets(\"Sheet2\")\n    Set wSheets = wbk.Worksheets(\"LNum\")\n    Set wSheet1 = wbk.Worksheets(\"PS\")\n\n'This is what copies the data\nwSheet.Range(\"a2:aa2\").Copy\nWindows(\"example.xlsx\").Activate\nSheets(\"test\").Select\nActiveCell.PasteSpecial Paste:=xlPasteValues\n   ActiveCell.Offset(1, 0).Select\n\nwSheet.Range(\"a3:aa3\").Copy\nWindows(\"example.xlsx\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues\n    ActiveCell.Offset(1, 0).Select\n\nwSheets.Range(\"C6,C7,C17\").Copy\nWindows(\"example.xlsx\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n    ActiveCell.Offset(1, 0).Select\n\nwSheets.Range(\"C1\").Copy\nWindows(\"example2.xlsm\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues\n    ActiveCell.Offset(1, 0).Select\n\nwSheet.Range(\"C14:D14\").Copy\nWindows(\"example2.xlsm\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues\n    ActiveCell.Offset(1, 0).Select\n\nwSheet1.Range(\"D5:F11\").Copy\nWindows(\"example2.xlsm\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues\n    ActiveCell.Offset(7, 0).Select\n\nwSheet1.Range(\"A17:G23\").Copy\nWindows(\"example2.xlsm\").Activate\nActiveCell.PasteSpecial Paste:=xlPasteValues\n    ActiveCell.Offset(7, 0).Select\n\n     wbk.Close True\n     Filename = Dir\n\nLoop\n\nWindows(\"example.xlsx\").Activate\nSheets(\"test\").Select\n\n'this creates a new first column and fills it with 1, 2, 3 patern\n    Columns(\"A:A\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A2\").FormulaR1C1 = \"1\"\n    Range(\"A3\").FormulaR1C1 = \"2\"\n    Range(\"A4\").FormulaR1C1 = \"3\"\n    Range(\"A5\").FormulaR1C1 = \"1\"\n    Range(\"A6\").FormulaR1C1 = \"2\"\n    Range(\"A7\").FormulaR1C1 = \"3\"\n    Range(\"A2:A7.Copy\n    Range(\"A8:A649\").Select\n    ActiveSheet.Paste\n    Sheets(\"test2\").Select\n    Columns(\"A:A\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A2\").Select\n    Sheets(\"test\").Select\n    Range(\"A2\").Select\n\n'This cuts a specific row and pastes it on sheet test2\nendRow = 1000 'probably not the best way to get the last row but it gets the job done\npasteRowIndex = 2\n\nFor r = 1 To endRow 'Loop through sheet1 and search for your criteria\n\n    If Cells(r, Columns(\"A\").Column).Value = \"2\" Then 'Found\n\n            'Cut the current row\n            Rows(r).Cut\n\n            'Switch to the sheet where you want to paste it &amp; paste\n            Sheets(\"test2\").Select\n            Rows(pasteRowIndex).Select\n            ActiveSheet.Paste\n\n            'Next time you find a match, it will be pasted in a new row\n            pasteRowIndex = pasteRowIndex + 1\n\n\n           'Switch back to the main sheet &amp; continue to search for your criteria\n            Sheets(\"test\").Select\n    End If\nNext r\n\n'This cuts a specific row and pastes it on sheet test2\nendRow = 1000 \npasteRowIndex = 1\n\nFor r = 1 To endRow \n\n    If Cells(r, Columns(\"A\").Column).Value = \"3\" Then 'Found\n\n            'Copy the current row\n            Rows(r).Cut\n\n            'Switch the sheet\n            Sheets(\"test3\").Select\n            Rows(pasteRowIndex).Select\n            ActiveSheet.Paste\n\n            'Next time you find a match, it will be pasted in a new row\n            pasteRowIndex = pasteRowIndex + 1\n\n            Sheets(\"test\").Select\n    End If\nNext r\n\n'This deletes empty rows\nActiveSheet.UsedRange.SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp\nRange(\"A1\").Select\n\n'This deletes the first row in all 3 sheets\n    Sheets(\"test\").Select\n    Columns(\"A:A\").Delete Shift:=xlToLeft\n    Sheets(\"test2\").Select\n    Columns(\"A:A\").Delete Shift:=xlToLeft\n    Sheets(\"test3\").Select\n    Columns(\"A:A\").Delete Shift:=xlToLeft\n\n'Random formatting that was recorded\n\n'More random formatting\n\n'Moving data to appropriate places\n    Sheets(\"test3\").Select\n    Range(\"A1:C10000\").Copy\n    Sheets(\"test2\").Select\n    Range(\"B2:D10001\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Sheets(\"test3\").Select\n    Range(\"A1:C10000\").Copy\n    Sheets(\"test\").Select\n    Range(\"B2:D10001\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Range(\"A2\").Select\n\n 'Even more formating\n\n    Windows(\"example2.xlsm\").Activate\n    Sheets(\"Web\").Select\n\n    'this creates a new first column and fills it with 2,7 3's and 7 4's like before\n\n'This cuts a specific row and pastes it on sheet test2 like before\n'This cuts a specific row and pastes it on sheet test2 again\n\n'This deletes empty rows\nActiveSheet.UsedRange.SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp\nRange(\"A1\").Select\n\n'More formating\n'Coloring cells and more formatting. Like several hundred rows of formatting code.\n\n'Removing macro optimization\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.Calculation = xlCalculationAutomatic\n\n    MsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 37852288, "answer_count": 2, "score": 0, "last_activity_date": 1466061265, "creation_date": 1465375036, "question_id": 37697327, "link": "https://stackoverflow.com/questions/37697327/increase-efficiency-with-vba-loops", "title": "Increase efficiency with VBA loops", "body": "<p>I'm brand new to this site. I've got no coding skills but I decided to tackle Excel VBA because I want to make my work flow more automated. Here is my problem. I made my macro out of stuff I dug out of the web(sorry I cant add proper credit to the creator). It consolidates information from 40 files. These 40 files have the same basic layout but different info. What I need to do is copy several different ranges to a single worksheet. I've got it working but I'm pretty certain its done the hard way. </p>\n\n<p><a href=\"http://i.stack.imgur.com/5j4Q1.jpg\" rel=\"nofollow\">My worksheet I pull data from</a></p>\n\n<p>What I currently do is copy cell A1 to my consolidate sheet with a loop which opens each of the 40 files and closes them. Then I copy cells A17:G23 to the consolidate sheet with a loop which opens each of the 40 files and closes them. Then I copy cells D5:G11 to the consolidate sheet with a loop which opens each of the 40 files and closes them.</p>\n\n<p>Basically I open each file a total of 7 or 8 times with loops. Now I've taken down my work time down from 2 hours to ~3 minutes. But I think this isnt quite as efficient as it could be. Should I try to fix it or should I leave it be since it works?</p>\n\n<p>All the loops look like this one with just different target cells to copy and paste. Thank you in advance.</p>\n\n<pre><code>'DECLARE AND SET VARIABLES\nDim wbk As Workbook\nDim Filename As String\nDim Path As String\nDim LastRow As Long\n\n'This is the path to the files\nPath = \"D:\\work\\\"  'Change this path\nFilename = Dir(Path &amp; \"*.xls\")\n\n'Opens the files\n Do While Len(Filename) &gt; 0  'If the next file exists then\n    Set wbk = Workbooks.Open(Path &amp; Filename)\n\n'Below this is the code I use to edit each file\n\n'Copies from the work files\nSheets(\"Sheet2\").Select\n If ActiveSheet.AutoFilterMode = True Then\n ActiveSheet.AutoFilterMode = False\n End If\n LastRow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n Range(\"a2:aa2\").Select\n Selection.Copy\n\n Windows(\"example.xlsx\").Activate\n\n\n 'Chooses the tab from the consolidation file and copies the data there\n Sheets(\"test\").Select\n    ActiveCell.Select\n Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n :=False, Transpose:=False\n Application.CutCopyMode = False\n    '\n   ActiveCell.Offset(1, 0).Select\n    wbk.Close True\n    Filename = Dir\nLoop\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6370141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6606d18c09677e083910fb4c48efafc0?s=128&d=identicon&r=PG&f=1", "display_name": "f.omari", "link": "https://stackoverflow.com/users/6370141/f-omari"}, "edited": false, "score": 0, "creation_date": 1465381354, "post_id": 37698920, "comment_id": 62873986, "body": "thank you that is why i got permission error ...now i have to learn how to create shortcut script"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1465384229, "post_id": 37698920, "comment_id": 62875720, "body": "Cool Trick to Create backup"}, {"owner": {"reputation": 19, "user_id": 6370141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6606d18c09677e083910fb4c48efafc0?s=128&d=identicon&r=PG&f=1", "display_name": "f.omari", "link": "https://stackoverflow.com/users/6370141/f-omari"}, "edited": false, "score": 0, "creation_date": 1466068914, "post_id": 37698920, "comment_id": 63168195, "body": "i have done what you told me and it work perfectly! 100% good however i am getting a message each time i am opening database that script might be a virus and if i do trust this file  i tried setting warnings to false but didnt work any idea how to stop this message from showing?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1466072225, "post_id": 37698920, "comment_id": 63170513, "body": "It may depend on how your <i>trusted locations</i> are defined under Access&#39; options. Also, try to copy the file to <i>%localappdata%</i> (the user&#39;s local folder) and run it from there."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1466693861, "last_edit_date": 1466693861, "creation_date": 1465379094, "answer_id": 37698920, "question_id": 37697295, "link": "https://stackoverflow.com/questions/37697295/automatic-backup-on-opening-database/37698920#37698920", "title": "Automatic backup on Opening database", "body": "<p>That command could be:</p>\n\n<pre><code>FileCopy CurrentDb.Name, Replace(CurrentDb.Name, \".accdb\", Format(Now(), \" yyyymmdd hhnnss\") &amp; \".accdb\")\n</code></pre>\n\n<p>but you can't do that for the database file itself from inside the application.</p>\n\n<p>Your best option would be to create a shortcut that runs a script that copies the file first, then opens it.</p>\n\n<p><strong>Addendum</strong></p>\n\n<p>I located a function that will create a zipped backup of the current project:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n' API call for sleep function.\nPrivate Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPublic Function ZipCurrentProject() As Long\n\n    Dim ShellApplication    As Object\n\n    Dim CurrentProjectFile  As String\n    Dim ZipPath             As String\n    Dim ZipName             As String\n    Dim ZipFile             As String\n    Dim FileNumber          As Integer\n\n    ' File and folder names.\n    CurrentProjectFile = CurrentProject.Path &amp; \"\\\" &amp; CurrentProject.Name\n    ' The path must exist.\n    ZipPath = CurrentProject.Path &amp; \"\\@dbase_bk\" &amp; Format(Now, \" yyyy-mm-dd hh.nn.ss\") &amp; \"\\\"\n    ZipName = \"CCOLearningHub.zip\"\n    ZipFile = ZipPath &amp; ZipName\n\n    ' Create sub folder if missing.\n    If Dir(ZipPath, vbDirectory) = \"\" Then\n        MkDir ZipPath\n    End If\n\n    ' Create empty zip folder.\n    FileNumber = FreeFile\n    Open ZipFile For Output As #FileNumber\n    Print #FileNumber, Chr(80) &amp; Chr(75) &amp; Chr(5) &amp; Chr(6) &amp; String(18, vbNullChar)\n    Close #FileNumber\n\n    Set ShellApplication = CreateObject(\"Shell.Application\")\n    ' Copy the project file into the zip file.\n    With ShellApplication\n        Debug.Print Timer, \"zipping started ...\"\n        .Namespace(CVar(ZipFile)).CopyHere CVar(CurrentProjectFile)\n        ' Ignore error while looking up the zipped file before is has been added.\n        On Error Resume Next\n        ' Wait for the file to created.\n        Do Until .Namespace(CVar(ZipFile)).Items.Count = 1\n            ' Wait a little ...\n            'DoEvents\n            Sleep 100\n            Debug.Print \" .\";\n        Loop\n        Debug.Print\n        ' Resume normal error handling.\n        On Error GoTo 0\n        Debug.Print Timer, \"zipping finished.\"\n    End With\n\n    Set ShellApplication = Nothing\n\n    ZipCurrentProject = Err.Number\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6370141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6606d18c09677e083910fb4c48efafc0?s=128&d=identicon&r=PG&f=1", "display_name": "f.omari", "link": "https://stackoverflow.com/users/6370141/f-omari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 37698920, "answer_count": 1, "score": 1, "last_activity_date": 1594651398, "creation_date": 1465374965, "last_edit_date": 1594651398, "question_id": 37697295, "link": "https://stackoverflow.com/questions/37697295/automatic-backup-on-opening-database", "title": "Automatic backup on Opening database", "body": "<p>Can anyone give me the code to create a backup/copy of the Database when opening? it I know how to use autoexec macro i just need the code. The database name is Datenbank and the back to have the time of back in its name</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1465381115, "creation_date": 1465381115, "answer_id": 37699701, "question_id": 37697011, "link": "https://stackoverflow.com/questions/37697011/vba-copy-and-paste-columns-to-a-single-column-then-copy-the-according-headin/37699701#37699701", "title": "VBA - Copy and paste columns to a single column &amp; then copy the according heading x times", "body": "<p>Assuming your data is in <code>Sheet1</code> and you want result in <code>Sheet2</code> try the following code:</p>\n\n<pre><code>Sub RangetoColumn()\n    Dim lastRow As Long, lastColumn As Long\n    Dim CurrentSheet As Worksheet, TargetSheet As Worksheet\n    Dim i As Long, j As Long, Count As Long\n    Dim colHeader As String\n\n    Set CurrentSheet = ThisWorkbook.Worksheets(\"Sheet1\")    '--&gt;sheet with data\n    Set TargetSheet = ThisWorkbook.Worksheets(\"Sheet2\")     '--&gt;sheet to display result\n    lastColumn = CurrentSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Count = 1\n    For i = 1 To lastColumn\n        lastRow = CurrentSheet.Cells(Rows.Count, i).End(xlUp).Row\n        If lastRow &gt; 1 Then    '--&gt;check for data below header\n            colHeader = CurrentSheet.Cells(1, i).Value\n            For j = 1 To lastRow - 1\n                TargetSheet.Range(\"A\" &amp; Count).Value = colHeader\n                TargetSheet.Range(\"B\" &amp; Count).Value = CurrentSheet.Cells(j + 1, i).Value\n                Count = Count + 1\n            Next j\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6439129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f5f924b58b5328e7c3f9f7c2d47ecb?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago", "link": "https://stackoverflow.com/users/6439129/tiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37699701, "answer_count": 1, "score": 1, "last_activity_date": 1465381115, "creation_date": 1465374184, "last_edit_date": 1465377345, "question_id": 37697011, "link": "https://stackoverflow.com/questions/37697011/vba-copy-and-paste-columns-to-a-single-column-then-copy-the-according-headin", "title": "VBA - Copy and paste columns to a single column &amp; then copy the according heading x times", "body": "<p>My VBA skills are fresh as this is something I've been working on to improve.</p>\n\n<p>I've searched and got some parts of coding, however, I cannot do what I need.\n(Each bar represents a cell on excel sheet  </p>\n\n<ul>\n<li><p>I have a file with headings in Row 1, these headings are dynamic;<br>\n<a href=\"http://i.stack.imgur.com/cA8ew.jpg\" rel=\"nofollow\">Example of Raw Data</a></p></li>\n<li><p>As you can see, each heading has a random number of rows below it.</p></li>\n<li>Goal is to have it like this: <a href=\"http://i.stack.imgur.com/WHQVH.jpg\" rel=\"nofollow\">Example of end excel file</a>  </li>\n</ul>\n\n<p>I understand this is not complicated, but I'm struggling when I need to count, copy and paste the headings according to the numbers of rows each of them has.</p>\n\n<p>Regards.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1465390435, "post_id": 37696871, "comment_id": 62880162, "body": "I am working on your question and suitably modifying the code."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1465401332, "post_id": 37696871, "comment_id": 62888740, "body": "I have modified the program. I have included a function incorporating Application.FileDialog Method which gives a option to user for selecting the folder. This program works for me. One point is worth mentioning that I normally work with Option Explicit incorporated in the VBE, which invariably requires that all variables are explicitly mentioned. Please tweak picture parameters as per your requirements."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1465548642, "post_id": 37696871, "comment_id": 62957995, "body": "Please take care of your health and take your own time to work it out as per your convenience."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 0, "creation_date": 1465387229, "post_id": 37697649, "comment_id": 62877797, "body": "I not able to set the folder using above code and use that for importing images... as am i novice to programming the method of using the code and placement of code would be wrong. please help me in understanding it"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 1, "creation_date": 1465387888, "post_id": 37697649, "comment_id": 62878227, "body": "@sandeep please mention in simple words what you want to do. As I understand you are picking pictures from a directory. Then you want to add these pictures to cells of a worksheet. Please describe fully your objective. I will then simulate that situation on my PC and send you the fully working code."}, {"owner": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 0, "creation_date": 1465391510, "post_id": 37697649, "comment_id": 62880951, "body": "@skkakar I want to import picture from a directory to excel cells, So i have written code, in that code i am setting the directory location manually, instead i want to have a option to set the directory location rather than changing in code."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 1, "creation_date": 1465392653, "post_id": 37697649, "comment_id": 62881857, "body": "@sandeep I have tested your code on standalone basis, it is giving many errors. No. of variables are not declared. Syntax of this line seems to be faulty ~Set listfiles = fso.GetFolder(Folderpath).Files~. Compiler is not accepting it. Have you checked your program working even with hard coded path."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 1, "creation_date": 1465395175, "post_id": 37697649, "comment_id": 62883893, "body": "@sandeep I have made some changes in your program routine as the program routine posted by you was not working for me. I have uploaded the <a href=\"https://dl.dropboxusercontent.com/u/65565270/stackoverflow/Jun_2016/Insert_pic.zip\" rel=\"nofollow noreferrer\">zipped file along with pictures to dropbox</a>. Please tweak with it to make it working as per your requirement and once you are satisfied . Please upload the amended file. In case you have problem in uploading then I will share my email with you. In a simpler way directory location can also be taken from any of the worksheet cell where you can change any time."}, {"owner": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 0, "creation_date": 1465536319, "post_id": 37697649, "comment_id": 62951398, "body": "@skkakar, thanks, i was sick yest so could not look and respond to it thanks, i will use the code now and let you know"}, {"owner": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 0, "creation_date": 1465549042, "post_id": 37697649, "comment_id": 62958224, "body": "Perfect sir It worked like a charm.. thanks a lot... lot more to learn.. thanks once again accepted as answer."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "edited": false, "score": 1, "creation_date": 1465549895, "post_id": 37697649, "comment_id": 62958745, "body": "@sandeep I am glad that it worked for you. Please note that where option explicit is used all variables are to be declared explicitly that is the reason some of your code fragments gave problem to me. Later on I did not use option explicit to avoid conflicts in building up a workable code collected from very different situations."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 2, "last_activity_date": 1465401691, "last_edit_date": 1465401691, "creation_date": 1465375855, "answer_id": 37697649, "question_id": 37696871, "link": "https://stackoverflow.com/questions/37696871/selecting-a-folder-using-msofiledialogfolderpicker/37697649#37697649", "title": "Selecting a folder using msoFileDialogFolderPicker", "body": "<p>Please incorporate following code in your routine and it shall enable you to do what you want to do.</p>\n\n<pre><code>    Dim myPath As String\n    Dim myFile As String\n    Dim myExtension As String\n    Dim FldrPicker As FileDialog\n    Dim myPath As String\n    Dim wb1 As Workbook\n    Dim sht As Worksheet\n    'Optimize Macro Speed\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    'Retrieve Target Folder Path From User\n    Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n    .Title = \"Select A Target Folder\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n    'In Case of Cancel\nNextCode:\n    myPath = myPath\n    If myPath = \"\" Then GoTo ResetSettings\n\n    'Target File Extension (must include wildcard \"*\")\n    myExtension = \"*.xls\" 'change extension as per your requirement\n\n    'Target Path with Ending Extension\n    myFile = Dir(myPath &amp; myExtension)\n    'Loop through each Excel file in folder\n    Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n    Set wb1 = Workbooks.Open(Filename:=myPath &amp; myFile)\n    Set sht = wb1.Worksheets(\"Your_Sheet\")\n\n    '.....do something here......\n\n    'Save and Close Workbook\n     wb1.Close SaveChanges:=True\n\n    'Get next file name\n     myFile = Dir\n    Loop\n\n\n\nResetSettings:\n    'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    'Message Box when tasks are completed\n    MsgBox \"Job done!\"\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nI have modified the program. I have included a function incorporating Application.FileDialog Method which gives a option to user for selecting the folder. This program works for me. One point is worth mentioning that I normally work with Option Explicit incorporated in the VBE, which invariably requires that all variables are explicitly mentioned. Please tweak picture parameters as per your requirements.</p>\n\n<pre><code> Sub Picinsert()\n\n    Dim mainWorkBook As Workbook\n\n    Set mainWorkBook = ActiveWorkbook\n    Sheets(\"Sheet1\").Activate\n    Folderpath = GetFolder()\n    'Folderpath = \"C:\\Excelvba_exp\" 'change as per your requirement\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    NoOfFiles = fso.GetFolder(Folderpath).Files.Count\n    Set listfiles = fso.GetFolder(Folderpath).Files\n    For Each fls In listfiles\n       strCompFilePath = Folderpath &amp; \"\\\" &amp; Trim(fls.Name)\n        If strCompFilePath &lt;&gt; \"\" Then\n            If (InStr(1, strCompFilePath, \"jpg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"jpeg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"png\", vbTextCompare) &gt; 1) Then\n                 counter = counter + 1\n                  Sheets(\"Sheet1\").Range(\"A\" &amp; counter).Value = fls.Name\n                  Sheets(\"Sheet1\").Range(\"B\" &amp; counter).ColumnWidth = 25\n                Sheets(\"Sheet1\").Range(\"B\" &amp; counter).RowHeight = 100\n                Sheets(\"Sheet1\").Range(\"B\" &amp; counter).Activate\n                Call insert(strCompFilePath, counter)\n                Sheets(\"Sheet1\").Activate\n            End If\n        End If\n    Next\n    mainWorkBook.Save\nEnd Sub\n\nFunction insert(PicPath, counter)\n'MsgBox PicPath\n    With ActiveSheet.Pictures.insert(PicPath)\n        With .ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = 50\n            .Height = 70\n        End With\n        .Left = ActiveSheet.Range(\"B\" &amp; counter).Left\n        .Top = ActiveSheet.Range(\"B\" &amp; counter).Top\n        .Placement = 1\n        .PrintObject = True\n    End With\nEnd Function\nFunction GetFolder() As String\n    Dim dlg                   As FileDialog\n    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)\n    If dlg.Show = -1 Then\n        GetFolder = dlg.SelectedItems(1)\n    End If\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Yrx0c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yrx0c.png\" alt=\"snapshot showing program results\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 3236857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c22077d0953a030a3c1cc011a2832d8f?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/3236857/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2378, "favorite_count": 0, "accepted_answer_id": 37697649, "answer_count": 1, "score": 0, "last_activity_date": 1465401691, "creation_date": 1465373711, "last_edit_date": 1531164843, "question_id": 37696871, "link": "https://stackoverflow.com/questions/37696871/selecting-a-folder-using-msofiledialogfolderpicker", "title": "Selecting a folder using msoFileDialogFolderPicker", "body": "<p>To copy a Pictures/Images a code is written, To copy images i have to set the folder path, now i am currently manually setting the folder path, As the code is to be used by many user i want to give a option for user to select the folder. </p>\n\n<p><strong>Application.FileDialog(msoFileDialogFolderPicker)</strong> Vba has got this method to set folder path, correct me if am wrong.</p>\n\n<p>Now i have to implement the above method to select folder by user for below code.</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n\nDim rgTarget As Range\nDim RowI As Long, ColumnI As Long\n\n    Folderpath = \"C:\\Users\\sandeep.hc\\Pics\"\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    NoOfFiles = fso.GetFolder(Folderpath).Files.Count\n    Set listfiles = fso.GetFolder(Folderpath).Files\n    For Each fls In listfiles\n       strCompFilePath = Folderpath &amp; \"\\\" &amp; Trim(fls.Name)\n        If strCompFilePath &lt;&gt; \"\" Then\n            If (InStr(1, strCompFilePath, \"jpg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"jpeg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"png\", vbTextCompare) &gt; 1) Then\n    RowI = 29\n    ColumnI = ColumnI + 1\n    Set rgTarget = Cells(RowI, ColumnI)\n    Application.ActiveSheet.Shapes.Addpicture strCompFilePath, False, True, rgTarget.Left, rgTarget.Top, 875, 400\n    ColumnI = ColumnI + 17\n    End If\n\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>In above code am setting folder path manually in code.</p>\n\n<p><strong>Folderpath = \"C:\\Users\\sandeep.hc\\Pics\"</strong></p>\n\n<p>Instead i want it by user like below part of code,</p>\n\n<p><strong>Application.FileDialog(msoFileDialogFolderPicker)</strong></p>\n\n<p>help is needed to implement msoFileDialogFolderPicker to above code.</p>\n"}, {"tags": ["excel", "class", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1465373780, "post_id": 37696726, "comment_id": 62868845, "body": "Please edit your question to include actual code. Usage of code does not serve the desired purpose. This community is to help you in overcoming problems faced in execution of code. So you have to mention what problem has been encountered while executing the code."}], "answers": [{"tags": [], "owner": {"reputation": 983, "user_id": 4632606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VsoxX.jpg?s=128&g=1", "display_name": "ZwoRmi", "link": "https://stackoverflow.com/users/4632606/zwormi"}, "is_accepted": false, "score": 0, "last_activity_date": 1465385817, "creation_date": 1465385817, "answer_id": 37701432, "question_id": 37696726, "link": "https://stackoverflow.com/questions/37696726/classmodule-beforeclose/37701432#37701432", "title": "ClassModule BeforeClose", "body": "<p>To create an object, you only have to do :</p>\n\n<pre><code>Dim C As Class1 'where Class1 is your module class name\nSet C = New Class1\n</code></pre>\n\n<p>You can do this in the initialization of your userForm :</p>\n\n<pre><code>Private Sub userForm_Initialize()\n    Dim C As Class1\n    Set C = New Class1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 42, "user_id": 6429594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e39626c6769b76e72b7f626d1987af?s=128&d=identicon&r=PG&f=1", "display_name": "Makab", "link": "https://stackoverflow.com/users/6429594/makab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465385817, "creation_date": 1465373258, "last_edit_date": 1531164843, "question_id": 37696726, "link": "https://stackoverflow.com/questions/37696726/classmodule-beforeclose", "title": "ClassModule BeforeClose", "body": "<p>I had a problem that I found the answer for, but it says \"This code needs to be posted in a class module and an instance of the class needs to be created before it will work\".\nI am very familiar with \"Modules\" but never used Class Modules before, and can't seem to be able to figure out how to get this thing to run. Below is the code I'm using, and some of my random attempts to get it to run. There is this (A) and (WorkbookBeforeClose), and in \"ThisWorkbook\" another (BeforeClose), it's confusing me.</p>\n\n<p>Usage of the code; I have a userform that when displayed, hides the window/application based on whether other Workbooks are open, this code is to resolve when closing other books both try to close.</p>\n\n<p>Your help is very much appreciated</p>\n\n<p>Code:</p>\n\n<pre><code>Public WithEvents A As Excel.Application\n\nPrivate Sub A_WorkbookBeforeClose(ByVal Wb As Workbook, Cancel As Boolean)\n\nDim VIS As Boolean, myAW As Workbook\n\nIf Workbooks.Count &gt; 1 Then 'if there is more than one workbook open...\n    If Windows(ThisWorkbook.Name).Visible = False Then 'and if Client is invisible...\n        If ActiveWorkbook.Name = ThisWorkbook.Name Then 'and if the workbook being closed is the Client.\n            Windows(ThisWorkbook.Name).Visible = True\n        Else 'more than one wb open, Client is invisible, and the workbook being closed is NOT the Client.\n            Set myAW = ActiveWorkbook\n            Cancel = True\n            Windows(ThisWorkbook.Name).Visible = True\n            Application.EnableEvents = False\n            myAW.Close\n            Application.EnableEvents = True\n            If ServiceEntry.ExcelB.Tag = \"False\" Then 'a tag on the button on the UserForm to store whether the workbook should be hidden or not\n                If Workbooks.Count &gt; 1 Then\n                    Windows(ThisWorkbook.Name).Visible = False\n                Else\n                    ThisWorkbook.Application.Visible = False\n                End If\n            End If\n            Exit Sub\n        End If\n\n    ElseIf ActiveWorkbook.Name &lt;&gt; ThisWorkbook.Name Then\n        'more than one workbook open and the Client is visible and the workbook being closed is NOT the Client\n\n        Exit Sub\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1465373426, "post_id": 37696587, "comment_id": 62868663, "body": "Your provider should be <code>Microsoft.ACE.OLEDB.12.0</code> and the extended properties should not use <code>Excel 8.0</code>. If it&#39;s an xlsb you should use &#39;Excel 12.0` or <code>Excel 12 Macro</code> for an xlsm."}, {"owner": {"reputation": 11, "user_id": 6439054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed04062a119ca1e7e2db481f6c187a8?s=128&d=identicon&r=PG&f=1", "display_name": "Janet Davison", "link": "https://stackoverflow.com/users/6439054/janet-davison"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465375101, "post_id": 37696587, "comment_id": 62869654, "body": "Thanks Rory, that worked.  Your help very much appreciated."}, {"owner": {"reputation": 111, "user_id": 5245855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03da1707d4de36b951db700fc116805?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5245855/patrick"}, "edited": false, "score": 0, "creation_date": 1497186624, "post_id": 37696587, "comment_id": 75962409, "body": "I&#39;m using Provider=Microsoft.ACE.OLEDB.12.0, Extended Properties= Excel 12.0  and am observing a limit of 65535 rows.   This seems like a silly limitation - is there a way around this?"}, {"owner": {"reputation": 111, "user_id": 5245855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03da1707d4de36b951db700fc116805?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5245855/patrick"}, "edited": false, "score": 1, "creation_date": 1497188987, "post_id": 37696587, "comment_id": 75963137, "body": "Found it.   Don&#39;t index at all, just include the $ sign: [Sheet1$]"}], "owner": {"reputation": 11, "user_id": 6439054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed04062a119ca1e7e2db481f6c187a8?s=128&d=identicon&r=PG&f=1", "display_name": "Janet Davison", "link": "https://stackoverflow.com/users/6439054/janet-davison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1704, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465372831, "creation_date": 1465372831, "last_edit_date": 1531161705, "question_id": 37696587, "link": "https://stackoverflow.com/questions/37696587/excel-vba-sql-is-there-a-limit-on-rows-which-can-be-queried-or-on-recordset-co", "title": "Excel VBA SQL. Is there a limit on rows which can be queried, or on recordset contents?", "body": "<p>I'm using VBA in Windows 7 Excel 2016 to query an Excel table with SQL.  The worksheet containing the data has over 200,000 rows.</p>\n\n<p>I'm using the ActiveX Data Objects 6.1 library.  Here's the code:</p>\n\n<pre><code>    Private Sub TestADO()\n\n    Dim objConnection As ADODB.Connection\n    Dim objRecordset As ADODB.Recordset\n    Dim strCon As String\n    Dim strSQL As String\n    Dim strPath As String\n    Dim strSource As String\n\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    Set objRecordset = CreateObject(\"ADODB.Recordset\")\n\n    Sheet2.UsedRange.Clear\n\n    strPath = ThisWorkbook.Path &amp; \"\\\"\n    strSource = ThisWorkbook.Name\n    strCon = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source='\" &amp; strPath &amp; strSource &amp; \"';\" &amp; _\n             \"Extended Properties=\"\"Excel 8.0;HDR=Yes;\"\";\"\n    strSQL = \"Select * FROM [Sheet1$] \" 'I've tried many queries, all have same problem\n\n    objConnection.Open strCon\n    objRecordset.Open strSQL, objConnection, adOpenStatic, adLockOptimistic, adCmdText\n\n    If Not objRecordset.EOF Then\n        Sheet2.Range(\"A1\").CopyFromRecordset objRecordset\n    End If\n\n    End Sub\n</code></pre>\n\n<p>This works OK, except that any SQL query only searches in the first 36,201 rows of the data sheet.  Is there a limit on the number of rows which can be searched, or on recordset contents, or am I doing something wrong?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 25, "user_id": 2646207, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1d920a610c91752de056165bc2cb012c?s=128&d=identicon&r=PG", "display_name": "user2646207", "link": "https://stackoverflow.com/users/2646207/user2646207"}, "edited": false, "score": 0, "creation_date": 1465372771, "post_id": 37696385, "comment_id": 62868260, "body": "Erro 91 for below code:"}, {"owner": {"reputation": 25, "user_id": 2646207, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1d920a610c91752de056165bc2cb012c?s=128&d=identicon&r=PG", "display_name": "user2646207", "link": "https://stackoverflow.com/users/2646207/user2646207"}, "edited": false, "score": 0, "creation_date": 1465372775, "post_id": 37696385, "comment_id": 62868265, "body": "Public Sub Application_Startup()   Dim objNS As NameSpace   Set objNS = Application.Session   Set olInboxItems = GetFolderPath(&quot;Fulfilment.qatar\\Inbox\\Team Helpdesk May 2016&quot;).Items Set objNS = Nothing End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1465389890, "creation_date": 1465389890, "answer_id": 37702886, "question_id": 37696385, "link": "https://stackoverflow.com/questions/37696385/object-variable-or-with-block-variable-not-set-while-running-macro/37702886#37702886", "title": "object variable or with block variable not set while running macro", "body": "<p>Looks like the following folder path doesn't exist:</p>\n\n<pre><code> GetFolderPath(\"Fulfilment.qatar\\Inbox\\Team Helpdesk May 2016\").\n</code></pre>\n\n<p>Make sure the specified folder exists in Outlook. </p>\n\n<p>Also I'd recommend using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866724.aspx\" rel=\"nofollow\">GetDefaultFolder</a> method of the Namespace class which returns a Folder object that represents the default folder of the requested type for the current profile; for example, obtains the default Calendar folder for the user who is currently logged on. To return a specific non-default folder, use the Folders collection.</p>\n\n<pre><code> Sub ChangeCurrentFolder()  \n  Dim myNamespace As Outlook.NameSpace \n  Set myNamespace = Application.GetNamespace(\"MAPI\")  \n  Set Application.ActiveExplorer.CurrentFolder = _  \n  myNamespace.GetDefaultFolder(olFolderCalendar)  \n End Sub\n</code></pre>\n\n<p>You may find also the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869924.aspx\" rel=\"nofollow\">GetDefaultFolder</a> method of the Store class helpful. This method is similar to the <code>GetDefaultFolder</code> method of the <code>NameSpace</code> object. The difference is that this method gets the default folder on the delivery store that is associated with the account, whereas <code>NameSpace.GetDefaultFolder</code> returns the default folder on the default store for the current profile.</p>\n"}], "owner": {"reputation": 25, "user_id": 2646207, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1d920a610c91752de056165bc2cb012c?s=128&d=identicon&r=PG", "display_name": "user2646207", "link": "https://stackoverflow.com/users/2646207/user2646207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593327312, "creation_date": 1465372195, "last_edit_date": 1593327312, "question_id": 37696385, "link": "https://stackoverflow.com/questions/37696385/object-variable-or-with-block-variable-not-set-while-running-macro", "title": "object variable or with block variable not set while running macro", "body": "<p>I am trying to run below macro while doing so it gives me error\"object variable or with block variable not set\".</p>\n\n<p>My Code:</p>\n\n<pre><code>    Dim i As Long\nPublic WithEvents olInboxItems As Items\n\nPublic Sub Application_Startup()\n  Dim objNS As NameSpace\n  Set objNS = Application.Session\n  Set olInboxItems = GetFolderPath(\"Fulfilment.qatar\\Inbox\\Team Helpdesk May 2016\").Items\nSet objNS = Nothing\nEnd Sub\n\nPublic Sub olInboxItems_ItemAdd(ByVal Item As Object)\n    Dim strCat As String\n\n    If Item.Class = olMail Then\n\n    Select Case i\n     Case 0\n          strCat = \"Case 0\"\n     Case 1\n          strCat = \"Case 1\"\n     Case 2\n          strCat = \"Case 2\"\n     Case 3\n          strCat = \"Case 3\"\n     Case 4\n          strCat = \"Case 4\"\n    End Select\n\n    Item.Categories = strCat\n            Item.Save\n        Err.Clear\n     End If\n     i = i + 1\n     Debug.Print i\n     If i = 5 Then i = 0\n End Sub\n\n\n' Use the GetFolderPath function to find a folder in non-default mailboxes\nFunction GetFolderPath(ByVal FolderPath As String) As Outlook.Folder\n    Dim oFolder As Outlook.Folder\n    Dim FoldersArray As Variant\n    Dim i As Integer\n\n    On Error GoTo GetFolderPath_Error\n    If Left(FolderPath, 2) = \"\\\\\" Then\n        FolderPath = Right(FolderPath, Len(FolderPath) - 2)\n    End If\n    'Convert folderpath to array\n    FoldersArray = Split(FolderPath, \"\\\")\n    Set oFolder = Application.Session.Folders.Item(FoldersArray(0))\n    If Not oFolder Is Nothing Then\n        For i = 1 To UBound(FoldersArray, 1)\n            Dim SubFolders As Outlook.Folders\n            Set SubFolders = oFolder.Folders\n            Set oFolder = SubFolders.Item(FoldersArray(i))\n            If oFolder Is Nothing Then\n                Set GetFolderPath = Nothing\n            End If\n        Next\n    End If\n    'Return the oFolder\n    Set GetFolderPath = oFolder\n    Exit Function\n\n    GetFolderPath_Error:\n        Set GetFolderPath = Nothing\n        Exit Function\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 460, "user_id": 5605307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153411479543422/picture?type=large", "display_name": "Kenneth Chan", "link": "https://stackoverflow.com/users/5605307/kenneth-chan"}, "is_accepted": false, "score": 0, "last_activity_date": 1465371819, "last_edit_date": 1592644375, "creation_date": 1465371819, "answer_id": 37696260, "question_id": 37695959, "link": "https://stackoverflow.com/questions/37695959/vba-macro-http-request/37696260#37696260", "title": "VBA macro HTTP request", "body": "<p>For Q1,\nthe details you can read <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384106(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Microsoft tutorial</a></p>\n<blockquote>\n<p>The SetTimeouts method specifies the individual time-out components of a send/receive operation, in milliseconds.</p>\n<p>The WaitForResponse method waits for an asynchronous Send method to complete, with optional time-out value, in seconds.</p>\n</blockquote>\n<p>For Q2, It depend on many thing like your computer's network and the website's network.</p>\n"}], "owner": {"reputation": 9864, "user_id": 2693545, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jxhDd.jpg?s=128&g=1", "display_name": "refactor", "link": "https://stackoverflow.com/users/2693545/refactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1246, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1465371819, "creation_date": 1465371004, "question_id": 37695959, "link": "https://stackoverflow.com/questions/37695959/vba-macro-http-request", "title": "VBA macro HTTP request", "body": "<p>I am using below method to make HTTP request in my VBA macro(copied from one\nof the copied sites).</p>\n\n<pre><code>Function GetURLStatus(ByVal URL As String, Optional AllowRedirects As Boolean)\n\n    Const WinHttpRequestOption_EnableRedirects = 6\n\n\n    If httpRequest Is Nothing Then\n        On Error Resume Next\n        Set httpRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n           If httpRequest Is Nothing Then\n              Set httpRequest = CreateObject(\"WinHttp.WinHttpRequest.5\")\n           End If\n        err.Clear\n        On Error GoTo 0\n    End If\n\n   ' Control if the URL being queried is allowed to redirect.\n   httpRequest.Option(WinHttpRequestOption_EnableRedirects) = AllowRedirects       \n\n  ' Launch the HTTP httpRequest synchronously\n  On Error Resume Next\n  httpRequest.Open \"GET\", URL + \"x\", False\n\n  If err.Number &lt;&gt; 0 Then\n\n    MsgBox err.Number\n    ' Handle connection errors\n    GetURLStatus = err.Description\n    err.Clear\n    Exit Function\n End If\n\n On Error GoTo 0\n\n' Send the http httpRequest for server status\nOn Error Resume Next\nhttpRequest.SetTimeouts\nhttpRequest.Send\nhttpRequest.WaitForResponse\nIf err.Number &lt;&gt; 0 Then\n    ' Handle server errors\n    'PageSource = \"Error\"\n    GetURLStatus = err.Description\n    err.Clear\nElse\n    ' Show HTTP response info\n    GetURLStatus = httpRequest.Status &amp; \" - \" &amp; httpRequest.StatusText\n    ' Save the web page text\n    'PageSource = httpRequest.ResponseText\nEnd If\n\n On Error GoTo 0\n\n End Function\n</code></pre>\n\n<ol>\n<li><p>Can someone please explain what is the purpose of httpRequest.SetTimeouts and \nhttpRequest.WaitForResponse.</p></li>\n<li><p>By default how much time will it wait for HTTP response, and what needs to\nmodified to increase this waiting time</p></li>\n</ol>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1465373768, "post_id": 37695817, "comment_id": 62868840, "body": "I believe the issue lies with the <code>Cells</code> property you are using. If no worksheet is specified, <code>Cells</code> will use the <code>Activesheet</code> meaning when you are recalculating within Sheet 2, the formulas in Sheet 1 will now take the referenced cell in Sheet 2 (the <code>Activesheet</code>) as opposed to the referenced cell in Sheet 1."}, {"owner": {"reputation": 21, "user_id": 6438768, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206950310984501/picture?type=large", "display_name": "Dylan Wang", "link": "https://stackoverflow.com/users/6438768/dylan-wang"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1465375061, "post_id": 37695817, "comment_id": 62869630, "body": "I found a method of solving the problem. Instead of using <code>Cells</code> with row/column position, I used <code>Application.Caller.Offset()</code> and made all values relative to the cell that calls the function. It works without a problem, but I still wonder if there is a way to use absolute cell position to do the job."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1465377035, "creation_date": 1465377035, "answer_id": 37698094, "question_id": 37695817, "link": "https://stackoverflow.com/questions/37695817/recalculating-excel-vba-function-on-one-sheet-disrupts-other-sheets/37698094#37698094", "title": "Recalculating Excel VBA Function on one sheet disrupts other sheets", "body": "<p>it's because there's a \"time-space shift\" between the range passed to the function and the range \"felt\" as the \"caller\" one by the function</p>\n\n<p>you can see this behavior by modifying the function code as follows</p>\n\n<pre><code>Function countItems(month)\n    Application.Volatile\n    Dim count As Integer\n\n    Dim r As Range\n    Dim p As Variant, a As Variant\n\n    Set r = Application.Caller '&lt;~~ retrieve the actual \"calling cell\" of the current function \"instance\"\n    p = r.Parent.Name\n    a = r.Address\n\n    MsgBox p &amp; \" vs \" &amp; month.Parent.Name &amp; vbCrLf &amp; a &amp; \" vs \" &amp; month.Address '&lt;~~ compare the function \"calling cell\" vs the \"passed cell\"\n\n    If Not (month = 0) Then\n        count = 0\n        Do While Not (Cells(month.Row + count + 1, 3) = 0)\n            count = count + 1\n        Loop\n        countItems = count\n    Else\n        countItems = \"\"\n    End If\nEnd Function\n</code></pre>\n\n<p>and you'll see msgboxs prompts showing you differences between the function \"calling cell\" and \"passed cell\" addresses and/or sheets</p>\n\n<p>so to avoid this behavior you could rely on the \"calling range only\", like follows:</p>\n\n<pre><code>Option Explicit\n\nFunction countItems(month)\n    Application.Volatile\n    Dim r As Range\n\n    Set r = Application.Caller '&lt;~~ retrieve the actual \"calling cell\" of the current function \"instance\"\n\n    'the \"calling cell\" is the one with the called function in its formula, i.e. in column \"B\" as per your data structure. then ...\n    If Not IsEmpty(r.Offset(, -1)) Then '&lt;~~ ... the column with dates are one column to the left, and  ...\n        Do While Not IsEmpty(r.Offset(countItems + 1, 1)) '&lt;~~ ...  the values to be checked for are one column to the right\n            countItems = countItems + 1\n        Loop\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6438768, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206950310984501/picture?type=large", "display_name": "Dylan Wang", "link": "https://stackoverflow.com/users/6438768/dylan-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1465384603, "creation_date": 1465370634, "last_edit_date": 1465384603, "question_id": 37695817, "link": "https://stackoverflow.com/questions/37695817/recalculating-excel-vba-function-on-one-sheet-disrupts-other-sheets", "title": "Recalculating Excel VBA Function on one sheet disrupts other sheets", "body": "<p>I made a function that counts the number of items in a given month.  </p>\n\n<p>Column A is the month, and Column B is the number of items in that month.  </p>\n\n<p>Cell B1 has:  </p>\n\n<pre><code>=countItems(A1)\n</code></pre>\n\n<p>Excel data: </p>\n\n<p><img src=\"https://i.stack.imgur.com/XN4wT.png\" alt=\"Excel data\"></p>\n\n<p>Code:</p>\n\n<pre><code>Function countItems(month)\n    Application.Volatile\n    Dim count As Integer\n    If Not (month = 0) Then\n        count = 0\n        Do While Not (Cells(month.row + count + 1, 3) = 0)\n            count = count + 1\n        Loop\n        countItems = count\n    Else\n        countItems = \"\"\n    End If\nEnd Function\n</code></pre>\n\n<p>I dragged the formula down from B1 to B500 and it works properly for every month. The formula returns nothing if there is no month in the corresponding A cell.</p>\n\n<p>I have multiple sheets using the same formula on similarly-structured data sets.\nWhenever the values in column B update for this Sheet 1, the other sheets will change too. However, Sheet 2 will update <strong>using Column C from Sheet 1</strong>.</p>\n\n<p>If I have Sheet 2 recalculate, Sheet 1 will update using Column C from Sheet 2.</p>\n\n<p>The function counts the number of items in a given month by checking how far down it can read in Column C before it finds the blank cell, indicating that the month is over.\nSheet 2 has 1 item in the first month, but it will still return 3 due to Sheet 1 having 3 items (counts Row 1 through 3 and stops at Row 4).\nThe second month of Sheet 2 begins on Row 3. But since the function is reading Column C from Sheet 1, <strong>it will run into the blank cell after counting 1 more item (counts Row 3 and stops at Row 4)</strong>. Therefore no matter how many items are in Sheet 2 Month 2, it will return 1.</p>\n\n<p>The function always uses the correct Column A, and only displays a number in Column B where there is date in Column A.</p>\n\n<p>The consequence is that only 1 sheet can have the correct values, and doing that disrupts the other sheets.</p>\n\n<p>I cannot solve this at the moment because I am new to VBA.  </p>\n\n<p>I have thought of making all of the function's cell references include a self-reference to the current cell's sheet, but I don't know how to do that and I don't know if it would work.</p>\n\n<p>Edit: I couldn't make it work this way, but <code>Application.Caller.Offset()</code> with relative cell position worked as a solution. I am still wondering if there is a way to use absolute cell position though.</p>\n\n<p><strong>The sheets are not grouped together.</strong></p>\n"}, {"tags": ["excel", "vba", "colors", "vlookup"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465367869, "post_id": 37694785, "comment_id": 62865389, "body": "Post the code you got! Ideally, it&#39;d be a working Sub or Function with irrelevant parts removed. Now for your question, have you thought about conditional formatting?"}, {"owner": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "edited": false, "score": 1, "creation_date": 1501888009, "post_id": 37694785, "comment_id": 77994475, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22151426/vlookup-to-copy-color-of-a-cell-excel-vba\">Vlookup to copy color of a cell - Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1465376193, "last_edit_date": 1495535641, "creation_date": 1465374701, "answer_id": 37697189, "question_id": 37694785, "link": "https://stackoverflow.com/questions/37694785/excel-vba-using-vlookup-to-copy-color-of-a-cell/37697189#37697189", "title": "Excel vba using vlookup to copy color of a cell", "body": "<p>If you are unable to understand the solution at: <a href=\"https://stackoverflow.com/questions/22151426/vlookup-to-copy-color-of-a-cell-excel-vba\">Vlookup to copy color of a cell - Excel VBA</a>, you could try this one instead:</p>\n\n<p>It simply uses <code>Match</code> to find and copies the cells with values and format by default.</p>\n\n<p>FirstTab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zlio0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zlio0.png\" alt=\"FirstTab\"></a></p>\n\n<p>SecondTab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GlFl0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GlFl0.png\" alt=\"SecondTab\"></a></p>\n\n<p>SecondTab after running the macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5YNe8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5YNe8.png\" alt=\"SecondTab after running the macro\"></a></p>\n\n<pre><code>Sub copy_paste_with_format()\n\n    Dim i As Long\n    Dim var As Variant\n\n    Dim FirstTab As Worksheet\n    Dim SecondTab As Worksheet\n\n    Set FirstTab = Application.Worksheets(\"FirstTab\")\n    Set SecondTab = Application.Worksheets(\"SecondTab\")\n\n    For i = 2 To 3\n        var = Application.Match(SecondTab.Range(\"A\" &amp; i), FirstTab.Range(\"A:A\"), 0)\n        If Not IsError(var) Then\n            FirstTab.Range(\"B\" &amp; var).Copy SecondTab.Range(\"B\" &amp; i)\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6438626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c7ea167643552ba7de66482c0143a5?s=128&d=identicon&r=PG&f=1", "display_name": "S Strickland", "link": "https://stackoverflow.com/users/6438626/s-strickland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2578, "favorite_count": 0, "protected_date": 1598535825, "answer_count": 1, "score": -1, "last_activity_date": 1598532997, "creation_date": 1465367268, "last_edit_date": 1593645503, "question_id": 37694785, "link": "https://stackoverflow.com/questions/37694785/excel-vba-using-vlookup-to-copy-color-of-a-cell", "title": "Excel vba using vlookup to copy color of a cell", "body": "<p>I am in need of using VLOOKUP to copy the color of a cell (that is not CF).  I tried to follow the vba code that is posted in the thread by LondonRob at\n<a href=\"https://stackoverflow.com/questions/22151426/vlookup-to-copy-color-of-a-cell-excel-vba\">Vlookup to copy color of a cell - Excel VBA</a>\nbut am having trouble since not proficient in vba.  Vlookup is needed because Names can be in different order.</p>\n\n<p>I have a sample worksheet where the cell colors need to be copied from the 1st tab to the 2nd tab based on a vlookup of name and column numbers.  I set up srcCell and destCell named ranges and copy into a module the posted vba.</p>\n\n<p>1st Tab</p>\n\n<p>Name     Amt1</p>\n\n<p>Kathy    $500 (cell color red)</p>\n\n<p>Mark     $350 (cell color green)</p>\n\n<p>2nd Tab</p>\n\n<p>Name     Amt1     Amt2</p>\n\n<p>Mark     $350     $200  (need $350 in green cell color)</p>\n\n<p>Kathy    $500     $400  (need $500 in red cell color)</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1465368928, "post_id": 37694569, "comment_id": 62865973, "body": "What&#39;s the error you encounter and which line throws it? Where&#39;s located the sub with the offending line?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1465372300, "post_id": 37694569, "comment_id": 62867977, "body": "I do have a suitable code in my library for inserting an image into the specific cell of worksheet from image control on the userForm. If it helps and can be adapted to your situation, I can post it as an Answer as it would not be covered in the comments."}, {"owner": {"reputation": 21, "user_id": 6438631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1ec6fed130a65a6c293664855262a3?s=128&d=identicon&r=PG&f=1", "display_name": "LHasha", "link": "https://stackoverflow.com/users/6438631/lhasha"}, "edited": false, "score": 0, "creation_date": 1465406103, "post_id": 37694569, "comment_id": 62891794, "body": "It is just not populating the other image controls on the other pages. Simply, I just want to select the desired image on the first sheet (which works fine) and the have it update all the other image sheets on the various pages with same picture."}, {"owner": {"reputation": 21, "user_id": 6438631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1ec6fed130a65a6c293664855262a3?s=128&d=identicon&r=PG&f=1", "display_name": "LHasha", "link": "https://stackoverflow.com/users/6438631/lhasha"}, "edited": false, "score": 0, "creation_date": 1465406178, "post_id": 37694569, "comment_id": 62891823, "body": "If you can imagine, the first sheet is a dashboard of sorts and the image selected is a transparent image of a signature which is being applied several times throughout the workbook.  The only error I am getting is when I double click the first image control on the first sheet, the file picker opens but if I click &#39;CANCEL&#39; it was throwing an error."}], "owner": {"reputation": 21, "user_id": 6438631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1ec6fed130a65a6c293664855262a3?s=128&d=identicon&r=PG&f=1", "display_name": "LHasha", "link": "https://stackoverflow.com/users/6438631/lhasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1465366405, "creation_date": 1465366405, "question_id": 37694569, "link": "https://stackoverflow.com/questions/37694569/excel-vba-copy-image-controls-picture-to-an-image-control-on-a-different-shee", "title": "Excel, VBA: Copy image control&#39;s picture to an image control on a different sheet", "body": "<p>I am using the following to populate an image control on the first sheet of the workbook:</p>\n\n<pre><code> Private Sub Image1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n Application.ScreenUpdating = False\n     On Error GoTo ErrHandler\n     Image1.Picture = LoadPicture(Application.GetOpenFilename)\n     Image2.Picture = Image1.Picture\n ErrHandler:\n ActiveSheet.Range(\"C8\").Select\n Application.ScreenUpdating = True\n End Sub\n</code></pre>\n\n<p>I have several other sheets in the workbook and I want to change all of the images to the same as on the first sheet. These images will be transparent gif files. Further, all pages are protected.</p>\n\n<p>I have tried to do it this way, with no success:</p>\n\n<pre><code> Dim WS as Worksheet\n Set WS = Sheets(2)\n With WS\n    .OLEObjects(\"Image1\").Object.Picture = Image1.Picture\n End With\n</code></pre>\n\n<p>Can anyone advise me how to make this happen?</p>\n\n<p><strong><em>Thank you very much in advance!</em></strong></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1465357652, "post_id": 37692854, "comment_id": 62861784, "body": "Was going to suggest this as well, but there could be javascript function attached to the button&#39;s click event."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1465357817, "post_id": 37692854, "comment_id": 62861835, "body": "Ran for me when I tested it"}, {"owner": {"reputation": 439, "user_id": 6331185, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c5f3a82cf0fcde0890d44e5732addac?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/6331185/shank"}, "edited": false, "score": 0, "creation_date": 1465359148, "post_id": 37692854, "comment_id": 62862207, "body": "What does Form represent here??"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465362866, "post_id": 37692854, "comment_id": 62863294, "body": "What? Look at the document source - how did you find the userid/password elements? They&#39;re part of the same form that gets submitted (look for form name=&quot;loginFormBean&quot;). Every document has a Forms element so that individual forms can be retrieved by index or name"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1465363028, "post_id": 37692854, "comment_id": 62863357, "body": "You can see it in your own picture at the top - 10 lines up from your highlighted text"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1465357431, "creation_date": 1465357431, "answer_id": 37692854, "question_id": 37692538, "link": "https://stackoverflow.com/questions/37692538/unable-to-access-the-login-button-vba-code/37692854#37692854", "title": "Unable to access the login Button ..VBA code", "body": "<p>The form has a name - you can submit it directly after you fill in the username and password</p>\n\n<pre><code>HTMLDoc.Forms(\"loginFormBean\").submit\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 6331185, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5c5f3a82cf0fcde0890d44e5732addac?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/6331185/shank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 37692854, "answer_count": 1, "score": 1, "last_activity_date": 1466104197, "creation_date": 1465355018, "last_edit_date": 1466104197, "question_id": 37692538, "link": "https://stackoverflow.com/questions/37692538/unable-to-access-the-login-button-vba-code", "title": "Unable to access the login Button ..VBA code", "body": "<pre><code>Sub login()\n  Dim IE As Object\n  Dim HTMLDoc As Object, HTMLDoc2 As Object\n  Dim objCollection As Object\n\n  Const navOpenInNewTab = &amp;H800\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n  IE.Visible = True\n  IE.Navigate \"https:///CWRWeb/displayMemberLogin.do\"\n\n  Do While IE.Busy Or IE.ReadyState &lt;&gt; 4: Loop\n\n  Set HTMLDoc = IE.Document\n\n  With HTMLDoc\n  HTMLDoc.getElementByID(\"userID\").Value = \"yyyy\"    'Entering credential\n  HTMLDoc.getElementByID(\"passwd\").Value = \"xxxxx\"\n  End With\n\n\n  Set objCollection = IE.Document.getElementByID(\"login-s\")\n  objCollection.Click\n\nEnd Sub\n</code></pre>\n\n<p>I am unable to automate the login click. The login button does not have an ID for input. I am not sure what to use to get the handle <strong>.getElementBy....</strong></p>\n"}]