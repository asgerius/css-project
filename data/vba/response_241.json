[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566433377, "post_id": 57600347, "comment_id": 101658342, "body": "A somehow digressive tip: use indentation in your code, it makes it much more readable than what you posted"}, {"owner": {"reputation": 1, "user_id": 11622976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326520fc5306ed3da56abfb580652d4a?s=128&d=identicon&r=PG&f=1", "display_name": "SlightlyUnsure", "link": "https://stackoverflow.com/users/11622976/slightlyunsure"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566514407, "post_id": 57600347, "comment_id": 101690563, "body": "How can I copy and paste code in here with the indents? in my code it is indented, but when I paste here and indent to show as code I just didn&#39;t take the time to indent it all as is in program"}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566515249, "post_id": 57600347, "comment_id": 101690741, "body": "That is weird, when I copy code from standard VBA Excel editor it translates the indentation here."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1566437955, "last_edit_date": 1566437955, "creation_date": 1566433092, "answer_id": 57600592, "question_id": 57600347, "link": "https://stackoverflow.com/questions/57600347/how-would-i-convert-this-code-to-something-shorter-potentially-through-an-array/57600592#57600592", "title": "How would I convert this code to something shorter? Potentially through an Array?", "body": "<p>If you always run these together then you only need a single loop and inside that loop test for each condition.</p>\n\n<pre><code>Sub CheckForColors()\n    Dim r As Range, sht As Worksheet, v\n\n    Set sht = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    For Each r In Intersect(sht.Range(\"AQ:AQ\"), sht.UsedRange)\n        v = r.Value\n        If InStr(v, \"Red\") = 0 Then\n            If InStr(v, \"Green\") &gt; 0 Then r.EntireRow.columns(\"M\").Value = \"x\"\n            If InStr(v, \"Blue\") &gt; 0 Or InStr(v, \"Teal\") &gt; 0 Then _\n                             r.EntireRow.columns(\"O\").Value = \"x\"\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11622976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326520fc5306ed3da56abfb580652d4a?s=128&d=identicon&r=PG&f=1", "display_name": "SlightlyUnsure", "link": "https://stackoverflow.com/users/11622976/slightlyunsure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566437955, "creation_date": 1566430398, "last_edit_date": 1566431400, "question_id": 57600347, "link": "https://stackoverflow.com/questions/57600347/how-would-i-convert-this-code-to-something-shorter-potentially-through-an-array", "title": "How would I convert this code to something shorter? Potentially through an Array?", "body": "<p>I have working code for my need, however now that I have learned this much, I want to go back and make it more streamlined.  </p>\n\n<p>I have attempted arrays, but apparently do not understand them..</p>\n\n<pre><code>Sub addGreenx(newbook)\nSet newbook = ActiveWorkbook\n\n myrow = 1\n mycolumn = \"M\"\n For Each r In Intersect(newbook.Sheets(\"Sheet1\").Range(\"AQ:AQ\"),     newbook.Sheets(\"Sheet1\").UsedRange)\nIf InStr(r, \"Green\") And InStr(r, \"red\") = 0 Then\n    newbook.Sheets(\"Sheet1\").Range(mycolumn + Mid(Str(myrow), 2)) = \"X\"\nEnd If\nmyrow = myrow + 1\nNext r\n\nEnd Sub\n\nSub addBluex(newbook)\nSet newbook = ActiveWorkbook\n\nmyrow = 1\nmycolumn = \"O\"\nFor Each r In Intersect(newbook.Sheets(\"Sheet1\").Range(\"AQ:AQ\"),     newbook.Sheets(\"Sheet1\").UsedRange)\nIf InStr(r, \"Blue\") And InStr(r, \"Red\") = 0 Then\n    newbook.Sheets(\"Sheet1\").Range(mycolumn + Mid(Str(myrow), 2)) = \"X\"\nEnd If\nmyrow = myrow + 1\nNext r\n\nEnd Sub\n\nSub addTealx(newboox)\n\nSet newbook = ActiveWorkbook\nmyrow = 1\nmycolumn = \"O\"\nFor Each r In Intersect(newbook.Sheets(\"Sheet1\").Range(\"AQ:AQ\"), newbook.Sheets(\"Sheet1\").UsedRange)\nIf InStr(r, \"Teal\") And InStr(r, \"Red\") = 0 Then\n    newbook.Sheets(\"Sheet1\").Range(mycolumn + Mid(Str(myrow), 2)) = \"X\"\nEnd If\nmyrow = myrow + 1\nNext r\n\nEnd Sub\n</code></pre>\n\n<p>This can be made shorter I'm sure, the item in \"mycolumn\" may have both blue and green, or just one or the other, however if it is blue the x goes in one column, if green in another, and if both in both.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1566447279, "post_id": 57600141, "comment_id": 101660536, "body": "where is <code>test.controls</code> in the above? Also you do realise that <code>BoxNo</code> is declared as a variant..."}, {"owner": {"reputation": 1, "user_id": 11959406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/765a340c80958d196a5cc408b6629020?s=128&d=identicon&r=PG&f=1", "display_name": "Musab", "link": "https://stackoverflow.com/users/11959406/musab"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1566460948, "post_id": 57600141, "comment_id": 101665505, "body": "Thank you for your note. I just edit the post again. I was mean ReportForm.Controls and I edit BoxNo as well."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1566516235, "post_id": 57600141, "comment_id": 101690914, "body": "<code>Dim BoxNo, inspNo As Long</code> here you have declared <code>BoxNo</code> as a <code>Variant</code> and <code>inspNo</code> as <code>Long</code>.. You need to write it like this <code>Dim BoxNo As Long, inspNo As Long</code> if you want them both to be <code>Long</code>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1566516333, "post_id": 57600141, "comment_id": 101690938, "body": "before <code>tot</code> can you debug <code>m1</code> <code>m2</code> <code>m3</code>.. Also what is the actual error?"}], "owner": {"reputation": 1, "user_id": 11959406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/765a340c80958d196a5cc408b6629020?s=128&d=identicon&r=PG&f=1", "display_name": "Musab", "link": "https://stackoverflow.com/users/11959406/musab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566460470, "creation_date": 1566428510, "last_edit_date": 1566460470, "question_id": 57600141, "link": "https://stackoverflow.com/questions/57600141/nested-for-to-create-report", "title": "nested for to create report", "body": "<p>I trying to create report that summarize data in the table by using nested for</p>\n\n<p>First this is how my table look</p>\n\n<pre><code>--------B------------------C------------------D-----------------E------\n\n----inspector_1----inspector_2----inspector_3--------date \n\n-------Mark------------ Jhon----------- sare------------ 8/21/2019\n\nJhon---------------------------------------------------- 8/22/2019\n\nsare--------------------Mark-----------------------------8/27/2019\n\nJho---------------------Mark------------sare-------------8/29/2019\n</code></pre>\n\n<p>user will enter the start and end date of report then i will show a form that count how many  time Mark, Jhon and sara visited the factories.</p>\n\n<p>I will show the summary in userform named ReportForm \nthe ReportForm  has three texbox in text box1 i will show how many Mark viseted the factories,  the other two boxes are for  Jhon and sara. </p>\n\n<p>I listed the inspector names in sheet2 the range is F1:F3\nhere is my code but it did not work and it is seem that ReportForm.Controls is throwing error.</p>\n\n<pre><code>Dim BoxNo, inspNo As Long\nFor inspNo = 1 To 3\ninspector  = Sheets(\"sheet2\").Cells(inspNo , \"F\").Value\nFor BoxNo = 1 To 3\nm1= Application.WorksheetFunction.CountIfs(Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&lt;=\" &amp; enddate, Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&gt;=\" &amp; startdate, Worksheets(\"sheet1\").Range(\"b8:b2333\"), inspector)\nm2=Application.WorksheetFunction.CountIfs(Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&lt;=\" &amp; enddate, Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&gt;=\" &amp; startdate, Worksheets(\"sheet1\").Range(\"c8:c2333\"), inspector )\nm3 = Application.WorksheetFunction.CountIfs(Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&lt;=\" &amp; enddate, Worksheets(\"sheet1\").Range(\"e8:e2333\"), \"&gt;=\" &amp; startdate, Worksheets(\"sheet1\").Range(\"d8:d2333\"), inspector  )\ntot = m1 + m2 + m3\nReportForm.Controls(\"TextBox\" &amp; BoxNo).Value = tot\nNext BoxNo\nNext inspNo \nEnd\nshow ReportForm\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-statements", "divide"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1566427739, "post_id": 57599899, "comment_id": 101657288, "body": "<code>If WorkRng &gt; 150</code> should be <code>If cell.Value &gt; 150</code> etc for the other tests"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1566427880, "creation_date": 1566427880, "answer_id": 57600066, "question_id": 57599899, "link": "https://stackoverflow.com/questions/57599899/i-need-to-concatenate-a-letter-while-dividing-selected-cells-by-a-constant/57600066#57600066", "title": "I need to CONCATENATE a letter while dividing selected cells by a constant", "body": "<p>Something like this should work  </p>\n\n<pre><code>For Each cell In WorkRng.Cells\n  With cell\n     If (.Value &gt; 150 And .Value &lt; 1000) Or _\n        (.Value &gt; 20000 And .Value &lt; 250000) Then\n\n             .Value = \"A\" &amp; .Value / CL\n     End If\n  End with\nNext\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11854598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145125a03ac1d6e82cd6999220af2c4b?s=128&d=identicon&r=PG&f=1", "display_name": "dcole204", "link": "https://stackoverflow.com/users/11854598/dcole204"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57600066, "answer_count": 1, "score": 0, "last_activity_date": 1566427880, "creation_date": 1566426480, "question_id": 57599899, "link": "https://stackoverflow.com/questions/57599899/i-need-to-concatenate-a-letter-while-dividing-selected-cells-by-a-constant", "title": "I need to CONCATENATE a letter while dividing selected cells by a constant", "body": "<p>I have blocks of data where some of he data in the block has a multiple of 10 applied. I need to remove the multiple of 10 and add an \"A\" to the same cells. There is two sets of ranges where the data lies between.</p>\n\n<p>Code that was recorded</p>\n\n<pre><code>Sub FixShaded()\n'\n' FixShaded Macro\n\n    Range(\"H2766\").Select\n    ActiveCell.FormulaR1C1 = \"=\"\"A\"\"&amp;(RC[-6]/10)\"\n    Range(\"H2766\").Select\n    Selection.AutoFill Destination:=Range(\"H2766:H2770\"), \nType:=xlFillDefault\n    Range(\"H2766:H2770\").Select\n    Selection.Copy\n    Range(\"B2766\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, \nSkipBlanks _\n        :=False, Transpose:=False\n    Range(\"H2766:H2770\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\nEnd Sub\n</code></pre>\n\n<p>Code that I am trying to get to work</p>\n\n<pre><code>Sub findRange()\n\n  Dim WorkRng As Range\n  Dim cell As Range\n  Const CL As Long = 10\n  Dim sht As Worksheet\n  Set sht = ActiveSheet\n  Dim i As Long\n  Set WorkRng = Application.Intersect(Selection, ActiveSheet.UsedRange)\n\n   For Each cell In WorkRng\n      If WorkRng &gt; 150 And WorkRng &lt; 1000 Then\n          WorkRng.Value = WorkRng.Value / CL\n      End If\n      If WorkRng &gt; 20000 And WorkRng &lt; 250000 Then\n          WorkRng.Value = WorkRng.Value / CL\n      End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Sorry I am only 3 months into VBA and trying Thank you</p>\n"}, {"tags": ["vba", "wix"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1566440819, "post_id": 57599861, "comment_id": 101659529, "body": "Exactly what are the requirements for installing those MSI packages? Do they have to be defined by the users, or would you be able to automatically calculate what is correct packages to install based on the environment at the installer&#39;s runtime? You might want to look at <a href=\"https://github.com/oleg-shilo/wixsharp\" rel=\"nofollow noreferrer\">WixSharp</a> if you&#39;d rather customize the actions you want to perform."}, {"owner": {"reputation": 1, "user_id": 9761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65661897a694eaf61c81166756deb7ac?s=128&d=identicon&r=PG&f=1", "display_name": "fidelisoris", "link": "https://stackoverflow.com/users/9761712/fidelisoris"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1566497205, "post_id": 57599861, "comment_id": 101684776, "body": "Depending on the customization of features and other options during the UI portion of the install, I will need to adjust which MSI packages are installed."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1566502838, "post_id": 57599861, "comment_id": 101687105, "body": "I suspect you might need to use WixSharp then. As noted, WiX is declarative-based which is difficult to work with when you need to support user interaction or complex environment checks at install time."}], "owner": {"reputation": 1, "user_id": 9761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65661897a694eaf61c81166756deb7ac?s=128&d=identicon&r=PG&f=1", "display_name": "fidelisoris", "link": "https://stackoverflow.com/users/9761712/fidelisoris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566427584, "creation_date": 1566426199, "last_edit_date": 1566427584, "question_id": 57599861, "link": "https://stackoverflow.com/questions/57599861/how-do-i-run-the-vba-msi-installer-dependencies-based-on-install-options-using-w", "title": "How do I run the VBA msi installer dependencies based on install options using WiX?", "body": "<p>I am in the process of creating a new WiX 3.x installer project for our older integration product that depends on the VBA SDK in Visual Studio 2017.</p>\n\n<p>Our product currently uses an extremely outdated InstallShield project that I've determined isn't really salvageable and selected WiX for various reasons. One of the many reasons is that (Unlike the VBA 6.3 Redist) the VBA 7.1 redistributables do not come with any installation wrapper and the SDK only includes some VS2010 project code written in C to generate a setup.exe file.</p>\n\n<p>Originally I was going to convert/re-write the C code to C# and create a custom action. Then as I heard about Burn.exe I thought that may be an option, but it seems that does not have the ability to act dynamically based off installer dialog options from my main install project. (Am I wrong here?)</p>\n\n<p>Ideally, I wish there were merge modules for the VBA 7.1 runtimes. However, since MS stopped offering new SDK licenses years ago (we're grandfathered in) all developer support for the SDK has disappeared from their site. All my searching for a merge module set has been futile.</p>\n\n<p>So for VBA 7.1, I have a main MSI and a dozen or so optional MSI packages depending on environment and localization. </p>\n\n<p>How best should I incorporate these into an installer package for our integration product with the prerequisites mentioned above?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566425768, "post_id": 57599778, "comment_id": 101656796, "body": "Are you saving the book before sending? I&#39;m guessing not as this seems too obvious of a solution"}, {"owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1566426132, "post_id": 57599778, "comment_id": 101656910, "body": "Unfortunately, I&#39;m not saving. I know that saving will open the workbook on the &#39;selected&#39; cell just before the save though."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1568968778, "post_id": 57599778, "comment_id": 102451992, "body": "Did you find any answer useful? Please post feedack."}], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 1, "creation_date": 1566428361, "post_id": 57599972, "comment_id": 101657410, "body": "Without SELECT I suppose there is theoretically another option: 1) unzip xlsx file, 2) modify xml file of last modified sheet: line &quot;&lt;selection sqref=&quot;K34&quot; activeCell=&quot;K34&quot;/&gt;&quot; (my last modified cell was K34 in my sample unzipped excel file), there are some solutions for these operations, but it seems to be overcomplicated and select is better"}, {"owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "edited": false, "score": 0, "creation_date": 1566429209, "post_id": 57599972, "comment_id": 101657592, "body": "I will try this tomorrow and provide an update, thanks!"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1566430826, "post_id": 57599972, "comment_id": 101657944, "body": "@Rafa\u0142B. - As you said, it may work, but it seems an overkill."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "edited": false, "score": 0, "creation_date": 1566981653, "post_id": 57599972, "comment_id": 101821440, "body": "@Aiyuni - Did you have a chance of testing the proposed solution?"}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": true, "score": 1, "last_activity_date": 1566428201, "last_edit_date": 1566428201, "creation_date": 1566427009, "answer_id": 57599972, "question_id": 57599778, "link": "https://stackoverflow.com/questions/57599778/how-to-open-workbook-on-a-certain-row-without-using-workbook-open/57599972#57599972", "title": "How to open workbook on a certain row without using Workbook_Open?", "body": "<p>If you have your VBA code select a given <code>Range</code> and make it visible on screen prior to sending, it should be the selected range and visible when opening directly from the attachment.\nAs intended in the OP, you do not need your workbook to contain any VBA code.</p>\n\n<p>I did this with the code below to create the workbook\nThen I manually selected <em>Send by email</em> (it should be irrelevant if this is done via VBA), sent it to myself, and opened it from the attachment.</p>\n\n<pre><code>Sub create_wb_select_range()\n    Dim wb As Workbook\n    Set wb = Workbooks.Add\n    Dim ws As Worksheet\n    Set ws = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))\n    Dim wsname As String\n    wsname = \"MySheet\"\n    ws.Name = wsname\n    Dim rngname As String\n    rngname = \"J68\"\n    ws.Range(rngname).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57599972, "answer_count": 1, "score": 0, "last_activity_date": 1569633282, "creation_date": 1566425650, "last_edit_date": 1569633282, "question_id": 57599778, "link": "https://stackoverflow.com/questions/57599778/how-to-open-workbook-on-a-certain-row-without-using-workbook-open", "title": "How to open workbook on a certain row without using Workbook_Open?", "body": "<p>I have a working macro that creates a new workbook, writes to it, and emails it to a client.</p>\n\n<p>The workbook opens on the first row of the workbook, and the client needs to scroll down to find the data they need.  I would like the Excel file to open in the middle row of the file.</p>\n\n<p>The workbook cannot contain macros due to security reasons.  Thus writing code on the <code>Workbook_Open()</code> method to go to a certain row is not feasible.</p>\n"}, {"tags": ["arrays", "excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566425430, "post_id": 57599453, "comment_id": 101656700, "body": "I would debug this by checking the values of your final array before filtering. There is likely something wrong with the way you have loaded it"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566425120, "post_id": 57599635, "comment_id": 101656604, "body": "I removed the filter clear at beginning just for solution."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1566426464, "post_id": 57599635, "comment_id": 101656984, "body": "@Saladsamurai you may also add one condition e.g.  &quot;And Len(Target.Value) &gt; 0&quot; after &quot;If Not Intersect...&quot; to prevent error if someone will click empty cell, or add more advanced check for proper Target values"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1566426585, "post_id": 57599635, "comment_id": 101657013, "body": "True @Rafa\u0142B - if OP limits the intersect to a range rather an entire column, the check may not be necessary but it def doesn\u2019t hurt to have it!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1566424777, "creation_date": 1566424777, "answer_id": 57599635, "question_id": 57599453, "link": "https://stackoverflow.com/questions/57599453/excel-vba-autofilter-using-array-multiple-values-in-same-column/57599635#57599635", "title": "Excel VBA Autofilter using array - multiple values in same column", "body": "<p>On my setup: </p>\n\n<ul>\n<li>The comma separated values correspond to <code>Range(\"J1:J3\")</code></li>\n<li>The range to filter correspond to <code>Range(\"A1:A18\")</code></li>\n</ul>\n\n<p>Please see correct way to appropriately size (<code>ReDim</code>) an array and how to add values to it below</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nDim Arr          'Array to SPLIT string\nDim i As Long    'Index to loop through Arr\nDim Filt         'Array to filter range\n\nIf Not Intersect(Target, Range(\"J1:J3\")) Is Nothing Then\n    Arr = Split(Target, \",\")\n    ReDim Filt(LBound(Arr) To UBound(Arr))\n        For i = LBound(Arr) To UBound(Arr)\n            Filt(i) = CStr(Arr(i))\n        Next i\n    Range(\"A1:A18\").AutoFilter 1, Filt, xlFilterValues\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 1125663, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af96000115315214022f55112b9dc4d9?s=128&d=identicon&r=PG", "display_name": "Saladsamurai", "link": "https://stackoverflow.com/users/1125663/saladsamurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 1, "accepted_answer_id": 57599635, "answer_count": 1, "score": 1, "last_activity_date": 1566442257, "creation_date": 1566423598, "last_edit_date": 1566442257, "question_id": 57599453, "link": "https://stackoverflow.com/questions/57599453/excel-vba-autofilter-using-array-multiple-values-in-same-column", "title": "Excel VBA Autofilter using array - multiple values in same column", "body": "<p>I feel like the answer is out there, but after lots of searching and experimenting, I am still coming up short.</p>\n\n<p>So can see in the first image that column O had a comma separated list of values.  I would like my routine to filter the data on column A using the entire list when the user double click on the cell containing the list.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8jbSu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8jbSu.png\" alt=\"before running routine\"></a></p>\n\n<p>My code reads:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Not Intersect(Target, Range(\"O:O\")) Is Nothing Then\n    Sheet1.Cells.AutoFilter 'clear existing filters\n    Dim idArray() As String\n    idArray = Split(Target.Value, \",\") 'store cell contents in array\n    Dim newIDArray(0 To 100) As String\n    Dim i As Long\n    For i = 0 To UBound(idArray)\n     newIDArray(i) = \"\"\"\" &amp; CStr(idArray(i)) &amp; \"\"\"\"   'wrap elements with quotes ... not sure if needed\n    Next\n    Sheet1.Range(\"$A$8\").AutoFilter Field:=1, Criteria1:=newIDArray\nEnd If\n\nCancel = False\nEnd Sub\n</code></pre>\n\n<p>However the result is the following image.  I looks like it is taking the filter in column A, deselecting All and showing results .... it is not using the values from the comma delimited list at all.</p>\n\n<p>Any thoughts on what is happening?  Thanks for reading.</p>\n\n<p><a href=\"https://i.stack.imgur.com/L5ncv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L5ncv.png\" alt=\"after running double clicking cell\"></a></p>\n"}, {"tags": ["excel", "vba", "loops", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "edited": false, "score": 0, "creation_date": 1566423702, "post_id": 57599395, "comment_id": 101656222, "body": "Thank you Tim! I think this worked! I really really appreciate your quick help. I was trying to find a way to do a Do While loop until the column was empty because it seemed like the best thing to do, but I hadn&#39;t quite figured out how to add 10 to the range. This is so helpful seriously thank you"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1566423162, "creation_date": 1566423162, "answer_id": 57599395, "question_id": 57599327, "link": "https://stackoverflow.com/questions/57599327/creating-a-copy-paste-vba-loop/57599395#57599395", "title": "Creating a Copy/Paste VBA loop", "body": "<p>You can do something like this:</p>\n\n<pre><code>Sub CopyCells()\n    Const NUM_ROWS As Long = 10  'size of block to copy\n    Dim rngCopy As range, col As Long\n\n    Set rngCopy = Worksheets(\"Sheet1\").Range(\"A3\").Resize(NUM_ROWS, 1)\n    col = 2\n    'copy while rngCopy has any data\n    Do While Application.Counta(rngCopy) &gt; 0\n        rngCopy.Copy Worksheets(\"Sheet2\").Cells(2, col)\n        col = col + 1                       'increment destination column\n        Set rngCopy = rngCopy.Offset(NUM_ROWS, 0) 'move copy range down 10\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566423162, "creation_date": 1566422630, "last_edit_date": 1566422910, "question_id": 57599327, "link": "https://stackoverflow.com/questions/57599327/creating-a-copy-paste-vba-loop", "title": "Creating a Copy/Paste VBA loop", "body": "<p>I have a massive data set (1000s of values) in a large spreadsheet, and I need to copy and paste these values into a new sheet in sets of 10. Essentially I need to copy the first 10 cells in a column and paste them into their own column in a new sheet. I then need to repeat this with cells 11-20 and paste them into their own column in a new sheet. So: copy 1-10, paste into new sheet in column A. Then copy 11-20 and paste into same new sheet, column B. 21-30 in column C, and so on. </p>\n\n<p>I have already tried some basic code, I am really new to this but find it interesting. I have figured out how to copy a range of 10 and paste to a new sheet, but I do not know how to set the loop up so I can continue this process into new columns with increasing sets of 10. I also have tried recording a macro, however it just recreates literally the keystrokes I input which isn't useful to me. </p>\n\n<p>I wrote this to copy first 10 in my source column and paste to my new sheet in their new column. </p>\n\n<pre><code>Option Explicit\nSub CopyCells()\nWorksheets(\"Sheet1\").Range(\"A3:A12\").Copy Worksheets(\"Sheet2\").Range(\"B2:B11\")\nEnd Sub\n</code></pre>\n\n<p>I need it to loop and continuously cut and paste sets of 10 cells from one target column into a new sheet, and each set of 10 into their own new column. If you post an answer could you please add explanations as well? I really like this stuff and am trying to learn, not just copy paste some code. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566423277, "post_id": 57599214, "comment_id": 101656097, "body": "Your assumption re: a &quot;turning point&quot; between linear and quadratic curves is, IMO, wrong. It is a well know fact that quadratic equations may be approximated by a linear one for relatively small values of X. You would be better off iterating through possible equations (using regression) and choosing the one with the smallest error when compared to the data. If you insist on using a linear equation, you could try to generate equations using linear regression with the first two points, then the first three, and so on in a loop until you reach an error greater than some arbitrary value."}, {"owner": {"reputation": 65, "user_id": 11952686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd2efb743193bb8e97eec40c702f51?s=128&d=identicon&r=PG&f=1", "display_name": "under267", "link": "https://stackoverflow.com/users/11952686/under267"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566513457, "post_id": 57599214, "comment_id": 101690367, "body": "It&#39;s not really an assumption, rather it&#39;s a necessary distinction to make for the application of this code. Without going into too much detail, if the plot goes from linear to quadratic it indicates that the object being analyzed is something, and if it doesn&#39;t the object is not something - the example plot is a great example of an object that is something. I tried the linear regression approach, and had a hard time defining those arbitrary values hahaha"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566565809, "post_id": 57599214, "comment_id": 101707479, "body": "How do you determine the jump between the two? Looking at your plot, (i.e. &quot;eyeballing&quot; it) it would not be unreasonable to assign the first orange dot to the linear region, or conversely the last blue dot tot he quadratic one. Can you post sample data and your criteria?"}, {"owner": {"reputation": 65, "user_id": 11952686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd2efb743193bb8e97eec40c702f51?s=128&d=identicon&r=PG&f=1", "display_name": "under267", "link": "https://stackoverflow.com/users/11952686/under267"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566595699, "post_id": 57599214, "comment_id": 101719641, "body": "I have no real criteria other than &quot;just look for when the plot goes from linear to quadratic&quot;, and I don&#39;t think too much thought was given towards providing mathematical validation as this is only to return a boolean value. I can&#39;t post sample data beyond the given plot unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11952686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd2efb743193bb8e97eec40c702f51?s=128&d=identicon&r=PG&f=1", "display_name": "under267", "link": "https://stackoverflow.com/users/11952686/under267"}, "edited": false, "score": 0, "creation_date": 1567019605, "post_id": 57680194, "comment_id": 101841428, "body": "You are an actual god! I&#39;ll try and apply this to my code later today. Thank you!"}], "tags": [], "owner": {"reputation": 637, "user_id": 6819132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64907d86c85d2f6f9618d15f2b46916?s=128&d=identicon&r=PG&f=1", "display_name": "JJacquelin", "link": "https://stackoverflow.com/users/6819132/jjacquelin"}, "is_accepted": true, "score": 1, "last_activity_date": 1566930029, "last_edit_date": 1566930029, "creation_date": 1566929583, "answer_id": 57680194, "question_id": 57599214, "link": "https://stackoverflow.com/questions/57599214/how-to-distinguish-between-a-linear-region-and-a-quadratic-region/57680194#57680194", "title": "How to distinguish between a linear region and a quadratic region", "body": "<p>For a same data one can run and compare quadratic and linear least square regressions.</p>\n\n<p>The respective root mean square error (RMSE) are different. RMSE(linear) is higher than RMSE(quadratic), but more or less different depending on the scatter and on the difference of shapes.</p>\n\n<p>In case of quadratic shape, figure 1, RMSE(linear) is much higher than RMSE(quadratic) due to the bad fitting of a linear curve to a quadratic curve. The ratio 10 is far to 1.</p>\n\n<p>In case of almost linear shape, figure 2, the quadratic regression leads to a low value of the coefficient c. Even being quadratic, the curve is almost linear. So both RMSE(linear) and RMSE(quadratic) remain on the same order of magnitude. The ratio  is close to 1. </p>\n\n<p><a href=\"https://i.stack.imgur.com/3Gg4c.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Gg4c.gif\" alt=\"enter image description here\"></a> </p>\n\n<p>The ratio between RMSE(linear) and RMSE(quadratic) appears a good indicator of the shape :</p>\n\n<ul>\n<li><p>Ratio close to 1 : The shape is said \"of linear kind\".</p></li>\n<li><p>Ratio significantly higher than 1 : The shape is said \"of quadratic kind\".</p></li>\n</ul>\n\n<p>One can object that the scatter might make less significant this indicator. That is partly true. The more the scatter is large the less the coefficient c becomes relatively small. But even with an high scatter as on figures 3 and 4 the ratio continue to be significant. </p>\n\n<p><a href=\"https://i.stack.imgur.com/j66gU.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j66gU.gif\" alt=\"enter image description here\"></a> </p>\n\n<p>Again the shape on figure 3 is said \"of quadratic kind\" and the shape on figure 4 is said \"of linear kind\".</p>\n\n<p>Nevertheless the ratio (slightly higher than 1) which defines the limit between \"of linear kind\" and \"of quadratic kind\" remains subjective (or empirical).</p>\n"}], "owner": {"reputation": 65, "user_id": 11952686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd2efb743193bb8e97eec40c702f51?s=128&d=identicon&r=PG&f=1", "display_name": "under267", "link": "https://stackoverflow.com/users/11952686/under267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 57680194, "answer_count": 1, "score": 3, "last_activity_date": 1566930029, "creation_date": 1566421862, "last_edit_date": 1566422345, "question_id": 57599214, "link": "https://stackoverflow.com/questions/57599214/how-to-distinguish-between-a-linear-region-and-a-quadratic-region", "title": "How to distinguish between a linear region and a quadratic region", "body": "<p>I'm looking to write a vba code that would be able to take in 2 arrays of x and y points which form a scatter plot, and analyze the plot to determine the point at which it goes from linear to quadratic. I'll discuss my approach I've tried below, but the problem is there is no real way to do this other than \"eyeball it\" that I'm able to come up with. </p>\n\n<p>My approach to this was to iteratively compare the slope between the first point and second point, then the first point and third point, etc, and see when this value would start to deviate. Problem with that was this is a  scatter plot, so the slope value between all of the points deviate quite a bit. I then tried to compare the y-values, and see when a square relation might pop up between y_i and y_i+1. That didn't really work out, because the y value of a point in a scatter plot doesn't necessarily speak of its nature. I've also thought about iteratively creating fits to the curve, but I can't see how that would yield any different results from the previous two attempts. Below is my current attempt with the last method described. Avg is the Y-value and P2 is the X-value. tp is the \"turning point\" which is where the graph goes from linear to quadratic. </p>\n\n<pre><code>'Look for turning point where trend becomes nonlinear'\nslp(1) = (Avg(2) - Avg(1)) '/ (P2(2) - P2(1))\nDim delta As Variant\nReDim delta(1 To UBound(slp))\n\nFor i = 2 To UBound(LP) 'Looks for turning point by comparing current slopes'\n    'slp(i) = WorksheetFunction.Slope(P2(i), Avg(i))\n    slp(i) = (Avg(i) - Avg(i - 1)) ' / (P2(i) - P2(i - 1))\n    delta(i) = slp(i) - slp(i - 1)\nNext i\nFor i = 1 To UBound(delta)\n    If delta(i) &gt;= 4000 Then\n        tpx(1) = P2(i)\n        tpy(1) = Avg(i)\n        'tp(1) = slp(i)\n        Exit For\n    End If\nNext i\nFor i = 1 To UBound(LP) 'Collects points before and after turning point'\n    If P2(i) &lt; tpx(1) Then\n        x1(i) = P2(i)\n        y1(i) = Avg(i)\n    ElseIf P2(i) &gt;= tpx(1) Then\n        x2(i) = P2(i)\n        y2(i) = Avg(i)\n    End If\nNext i\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DlgkW.png\" rel=\"nofollow noreferrer\">Plot</a>\nI've attached a screencap of the plot to give a better idea of the problem. The blue region is the eyeballed linear region, and the orange is the eyeballed quadratic region.</p>\n"}, {"tags": ["excel", "vba", "date", "time", "data-conversion"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566421759, "post_id": 57599089, "comment_id": 101655632, "body": "I assume the only issue is that the format is coming out incorrect?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "edited": false, "score": 0, "creation_date": 1566423117, "post_id": 57599163, "comment_id": 101656038, "body": "That works but is always missing the forward slashes in the date, if i use something else like a dash it&#39;s fine, 11-11-19 15:54G"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1566421880, "last_edit_date": 1566421880, "creation_date": 1566421544, "answer_id": 57599163, "question_id": 57599089, "link": "https://stackoverflow.com/questions/57599089/vba-turn-column-with-date-and-time-to-24hrs-excel/57599163#57599163", "title": "VBA Turn Column with Date and Time to 24hrs (Excel)", "body": "<p>Close: <code>Format(Now(), \"dd/mm/yyyy h:mm\") &amp; \"G\"</code></p>\n\n<p>You could use <code>h:mmG</code> in the format, but that is less clear for others looking in the future.</p>\n"}], "owner": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 57599163, "answer_count": 1, "score": 0, "last_activity_date": 1566421880, "creation_date": 1566421058, "question_id": 57599089, "link": "https://stackoverflow.com/questions/57599089/vba-turn-column-with-date-and-time-to-24hrs-excel", "title": "VBA Turn Column with Date and Time to 24hrs (Excel)", "body": "<p>I have a date &amp; time column with many rows that look like this:</p>\n\n<p>11/11/19 3:54PM</p>\n\n<p>11/11/19 5:33AM</p>\n\n<p>I would like to basically leave the dates alone but just change the times in place to 24 hour and deleting the am or pm and add G at the end. Like this:</p>\n\n<p>11/11/19 15:54G</p>\n\n<p>11/11/19 05:33G</p>\n\n<p>Is there a simple way to do this or do i have to split date and time over 2 columns, do the conversion then concatenate. </p>\n\n<p>Thanks.</p>\n\n<p>I tried to do this thru cell formatting</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nSub Converter()\n\nDim Focus As String\n\nWith ActiveSheet\nRange(\"A3:A100\").Select\n\nDo\nFocus = Format$(ActiveCell, \"dd/mm/yyyy hh:mm\")\n\nActiveCell.Value = Focus\nActiveCell.Offset(1, 0).Select\n\nLoop Until IsEmpty(ActiveCell.Offset(0, 0))\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>I would like to achieve this in vb</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1566425106, "creation_date": 1566425106, "answer_id": 57599691, "question_id": 57598998, "link": "https://stackoverflow.com/questions/57598998/copying-pasting-multiple-pictures-with-vba-excel-to-outlook/57599691#57599691", "title": "Copying/Pasting Multiple Pictures with VBA (Excel to Outlook)", "body": "<p>I got this to work using paragraphs:</p>\n\n<pre><code>        picRng2.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n\n\n    With Email\n\n        With wdDoc.Paragraphs(4)\n            .Range.InsertParagraphAfter\n            .Range.PasteAndFormat Type:=wdChartPicture\n            .Range.ParagraphFormat.LineSpacingRule = wdLineSpaceDouble\n            With wdDoc\n                .InlineShapes(1).Height = 700\n            End With\n         End With\n\n         '.Body = \"Hello\"\n\n        .Subject = \"Daily Ops Report\"\n        .To = sTo\n        .Display\n\n    End With\n\n    picRng1.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    With Email\n            With wdDoc.Paragraphs(2)\n            .Range.InsertParagraphAfter\n            .Range.PasteAndFormat Type:=wdChartPicture\n            .Range.ParagraphFormat.LineSpacingRule = wdLineSpaceDouble\n            With wdDoc\n                .InlineShapes(1).Height = 700\n            End With\n         End With\n\n    End With\n\n    With Email\n            With wdDoc.Paragraphs(1)\n            .Range.InsertParagraphAfter\n            .Range.ParagraphFormat.LineSpacingRule = wdLineSpaceDouble\n         End With\n\n    End With\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566425106, "creation_date": 1566420486, "last_edit_date": 1566422232, "question_id": 57598998, "link": "https://stackoverflow.com/questions/57598998/copying-pasting-multiple-pictures-with-vba-excel-to-outlook", "title": "Copying/Pasting Multiple Pictures with VBA (Excel to Outlook)", "body": "<p>I'm trying to export multiple screenshots from Excel to Outlook but am having trouble reactivating the Outlook window for the 2nd screenshot.  What can I do after copying <code>picRng1</code> and pasting it, to reactivate the Outlook window to paste <code>picRng2</code> with a break inbetween ?  Can I use <code>.HTMLBody = \"\"&lt;br&gt;\"</code> to separate the 2 pictures ?</p>\n\n<pre><code>picRng1.CopyPicture Appearance:=xlScreen, Format:=xlPicture\npicRng2.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n\nWith Email\n\n\n    wdDoc.Range.PasteAndFormat Type:=wdChartPicture\n\n\n     With wdDoc\n          .InlineShapes(1).Height = 700\n     End With\n\n    .Subject = \"Daily Ops Report\"\n    .To = sTo\n    .Display\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1566420387, "post_id": 57598931, "comment_id": 101655142, "body": "at which line you get the error?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566420449, "post_id": 57598931, "comment_id": 101655180, "body": "When you get the error, press control-break to see what line it is on, then add that to your question. it probably has something to do with a misuse of double quotes on the formulaarray line."}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "edited": false, "score": 0, "creation_date": 1566420505, "post_id": 57598931, "comment_id": 101655200, "body": "I can&#39;t tell. It&#39;s a systems dialogue box, not the standard Microsoft Visual Basic dialogue box."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 1, "creation_date": 1566420804, "post_id": 57598931, "comment_id": 101655323, "body": "The code works ok. Try reboot excel &amp; machine and try again. Also check if there is any other code executed before or during this code execution period"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566421368, "post_id": 57598931, "comment_id": 101655498, "body": "Any <code>Event</code> based codes present on worksheet?"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "edited": false, "score": 0, "creation_date": 1566421376, "post_id": 57598931, "comment_id": 101655500, "body": "Tried rebooting- didn&#39;t help. Nothing else is running..."}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566421400, "post_id": 57598931, "comment_id": 101655514, "body": "@urdearboy the above code is all there is"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1566422213, "post_id": 57598931, "comment_id": 101655778, "body": "What is the purpose of this line <code>ws.Columns(27).Value = ws.Columns(27).Value</code>? you just overwrite"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1566422502, "post_id": 57598931, "comment_id": 101655855, "body": "@Error 1004 - I believe the purpose is to convert the formulas to their resulting values"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566423208, "post_id": 57598931, "comment_id": 101656073, "body": "@cybernetic.nomad correct."}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "edited": false, "score": 0, "creation_date": 1566490012, "post_id": 57598931, "comment_id": 101681713, "body": "If I revise the above code to <code>If ws.Index &gt; 3 And ws.Index &lt; 26 Then</code> it works fine. I just don&#39;t want to lock it into a specific sheet, I want to go til the last sheet."}], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566487636, "creation_date": 1566420031, "last_edit_date": 1566487636, "question_id": 57598931, "link": "https://stackoverflow.com/questions/57598931/when-looping-code-through-worksheet-automation-error-exception-occurs", "title": "When Looping Code through Worksheet Automation Error Exception Occurs", "body": "<p>I'm looping the below code through a worksheet with 30-50 tabs. I keep on getting the error \"Automation Error, Exception Occurred\". As soon as I click \"ok\" excel becomes unresponsive and the program closes out. Any thoughts as to why this could be happening?</p>\n\n<pre><code>Sub Step19MatchStrike()\n    Dim ws As Worksheet\n    Dim LastRowColumnA As Long\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Index &gt; 3 Then\n            LastRowColumnA = ws.Cells(Rows.Count, 1).End(xlUp).Row\n            ws.Range(\"AA1\").Value = \"Strike Determination\"\n            ws.Range(\"AA2\").FormulaArray = \"=IF((MATCH(E2,INDEX(Sheet3,(MATCH(A2,INDEX(Sheet3,,1),0)),5),0))&gt;0,\"\"To Keep\"\",\"\"To Delete\"\")\"\n            ws.Range(\"AA2\").Copy ws.Range(\"AA3:AA\" &amp; LastRowColumnA)\n            ws.Columns(27).Value = ws.Columns(27).Value\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hide"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1566422321, "post_id": 57598914, "comment_id": 101655810, "body": "What happens if you step through with F8? What happens when it gets to the HideTermsAndConditions macro? Does it return properly from TurnOnFunctions?"}, {"owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1566425537, "post_id": 57598914, "comment_id": 101656733, "body": "Hey @teylyn. When I step through it, it jumps to the TurnOffFunctions macro. Not sure why it would do this since just about every macro in this workbooks contains the TurnOffFunctions and TurnOnFunctions and I haven&#39;t had a problem with them yet."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1566425941, "post_id": 57598914, "comment_id": 101656848, "body": "Well, you tell it to jump to the TurnoffFunctions macro, so that does not surprise. When happens when you continue with F8 and it returns to the calling macro?"}, {"owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1566427788, "post_id": 57598914, "comment_id": 101657299, "body": "I&#39;m on a mac so I&#39;m pressing debug -&gt; step into which I believe is the same thing but wanted to check. It steps through the macro as usual without finding any error which is why I&#39;m having such a hard time fixing this."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "is_accepted": false, "score": 0, "last_activity_date": 1566436611, "creation_date": 1566436611, "answer_id": 57600900, "question_id": 57598914, "link": "https://stackoverflow.com/questions/57598914/unsure-how-to-troubleshoot/57600900#57600900", "title": "Unsure how to troubleshoot", "body": "<p>I have no idea why it made a difference but I tried moving the sub HideTermsAndConditions around in the sequence of called macros in the drop down macro Main_Budget_Without (moved it to the end right before TurnOnFunctions instead of being 2nd after TurnOffFunctions) and for some reason, that fixed it. Not necessary since the drop down macro is now working but would appreciate it if anyone can explain why this happened so I can know if this might happen again in the future.</p>\n"}], "owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576150694, "creation_date": 1566419972, "last_edit_date": 1576150694, "question_id": 57598914, "link": "https://stackoverflow.com/questions/57598914/unsure-how-to-troubleshoot", "title": "Unsure how to troubleshoot", "body": "<p>I have a drop down menu in the first tab of my workbook that calls macros with each selection. The problem is that one of the nested macros (HideTermsAndConditions macro nested in the Main_Budget_Without macro) from the drop down menu is no longer working even though it works by itself and in a different macro selection from the drop down menu. The HideTermsAndConditions macro also used to work in this Main_Budget_Without macro. The workbook is protected but all the other macros don't seem to be having an issue. The worst part is that no error is shown in the VBA editor when I run the Main_Budget_Without macro. While I know it is the HideTermsAndConditions macro that is the problem (since the terms and conditions aren't hidden when the Main_Budget_Without macro is run) I don't know how to fix the problem in this scenario.</p>\n\n<p>I tried running the Main-Budget_Without macro in the VBA editor. Every macro that Main_Budget_Without calls works except the HideTermsAndConditions macro. And yet at the same time, HideTermsAndConditions macro works when run by itself in the VBA editor. Not only that, it works when called in a similar macro selection from the drop down menu. </p>\n\n<pre><code>Sub Main_Budget_Without()\nCall TurnOffFunctions\n\nCall HideTermsAndConditions\nCall MakeManagementFee10\nCall HideDiscountColumn\nCall HideTotalDiscount\nCall ComA_UndoUnitRatesForRolesInServicesTab\nCall ComA_UndoDayRates\nCall ComA_UnhideRows19And20InSOW\nCall ComA_AddDanielleRolestoRolesColumnInServicesTab\nCall ComA_UnhideAllRowsBelowThirdPartyTableInSOW\n\nCall TurnOnFunctions\nEnd Sub```\n</code></pre>\n\n<p>The only macro in the nested macro above that isn't working is the first one - HideTermsAndConditions.</p>\n\n<pre><code>Call TurnOffFunctions\nSheets(\"SOW\").Range(\"723:813\").EntireRow.Hidden = True\nCall TurnOnFunctions\nEnd Sub```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566420969, "post_id": 57598631, "comment_id": 101655376, "body": "You need another <code>End If</code> for the second <code>If</code> statement"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1566421195, "post_id": 57598631, "comment_id": 101655448, "body": "@MilesFett that is not an issue that second if shows repeat of same code above for Combobox value B"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1566425965, "post_id": 57599361, "comment_id": 101656857, "body": "I try this way but error on this line Range(&quot;A1&quot;).End(xlDown).Offset(1, 0).Value = TBox.Value"}], "tags": [], "owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "is_accepted": false, "score": 1, "last_activity_date": 1566422858, "creation_date": 1566422858, "answer_id": 57599361, "question_id": 57598631, "link": "https://stackoverflow.com/questions/57598631/excel-vba-combo-box-value-condition/57599361#57599361", "title": "Excel VBA Combo Box value condition", "body": "<p>In this case that would keep placing your info into row 2 and the else would be catching if it was \"B\". You could try handling both scenarios back to back like this:</p>\n\n<pre><code>Private Sub CmdButtSave_Click()\nWorksheets(\"Sheet1\").Activate\n\nIf CBitem.Value = \"A\" Then\n    Range(\"A1\").End(xlDown).Offset(1, 0).Value = TBox.Value\n    Range(\"B1\").End(xlDown).Offset(1, 0).Value = Me.DTPicker.Value\n    Range(\"C1\").End(xlDown).Offset(1, 0).Value = TBquan.Value\nElseIf CBitem.Value = \"B\" Then\n    Range(\"D1\").End(xlDown).Offset(1, 0).Value = TBox.Value\n    Range(\"E1\").End(xlDown).Offset(1, 0).Value = Me.DTPicker.Value\n    Range(\"F1\").End(xlDown).Offset(1, 0).Value = TBquan.Value\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "is_accepted": true, "score": 0, "last_activity_date": 1566430268, "creation_date": 1566430268, "answer_id": 57600333, "question_id": 57598631, "link": "https://stackoverflow.com/questions/57598631/excel-vba-combo-box-value-condition/57600333#57600333", "title": "Excel VBA Combo Box value condition", "body": "<p>I make function to get next empty row that works well</p>\n\n<pre><code>  Private Sub CmdButtSave_Click()\n\n     Dim rw As Long\n\n     With Worksheets(\"Sheet1\")\n\n     If CBitem.value = \"A\" Then\n\n     rw = GetLastRow(\"A\")\n     .Range(\"A\" &amp; rw).value = TBox.value\n     .Range(\"B\" &amp; rw).value = Format(Me.DTPicker.value, \"long date\")\n     .Range(\"C\" &amp; rw).value = TBquan.value\n\n\n     End If\n\n       If CBitem.value = \"B\" Then\n\n     rw = GetLastRow(\"E\")\n     .Range(\"E\" &amp; rw).value = TBox.value\n     .Range(\"F\" &amp; rw).value = Format(Me.DTPicker.value, \"long date\")\n     .Range(\"G\" &amp; rw).value = TBquan.value\n\n       End If\n\n      End With\n\n     End Sub\n    Function GetLastRow(ByVal col As String) As Long\n   With Worksheets(\"Sheet1\")\n    GetLastRow = .Range(col &amp; .Rows.Count).End(xlUp).Row + 1\n   End With\n  End Function\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57600333, "answer_count": 2, "score": 0, "last_activity_date": 1566442315, "creation_date": 1566418449, "last_edit_date": 1566442315, "question_id": 57598631, "link": "https://stackoverflow.com/questions/57598631/excel-vba-combo-box-value-condition", "title": "Excel VBA Combo Box value condition", "body": "<p>I am trying to save data to Excel sheet \ncombo box text box and date picker\nif Combo box value is A\nData from textbox and date should be saved in Column A B and C\nevery time Combo box value is A it should save in next empty row in Col A B and C\nIf Combo Box value is B\nText box value and date should go to column E, F, and G  </p>\n\n<pre><code> Private Sub CmdButtSave_Click()\n     Worksheets(\"Sheet1\").Activate\n         If CBitem.Value = \"A\" Then\n             Range(\"A2\").Value = TBox.Value\n             Range(\"B2\").Value =Me.DTPicker.Value\n             Range(\"C2\").Value = TBquan.Value\n         Else\n             Range(\"A1\").End(xlDown).Offset(1, 0).Value = TBox.Value\n             Range(\"B1\").End(xlDown).Offset(1, 0).Value = Me.DTPicker.Value\n             Range(\"C1\").End(xlDown).Offset(1, 0).Value = TBquan.Value\n         End If \n         If CBitem.value = \"B\" Then\n End sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566418087, "post_id": 57598533, "comment_id": 101654288, "body": "You don&#39;t need to use ChDir if you always supply the complete path to (eg) <code>MkDir</code>.  ChDir is problemmatic if there are multiple drives present.  Same goes for providing full pathto <code>SaveAs</code>"}, {"owner": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566418841, "post_id": 57598533, "comment_id": 101654568, "body": "i did that to prevent it from saving to the documents folder which it was doing on my coworkers workstation when i asked her to test the app for me. i will remove it and see if that makes any difference. how should i save the file if i shouldnt provide the full path to saveas? should i just use &quot;\\OneDrive - CompanyName\\Desktop&quot; and &quot;\\Desktop&quot; or is there a better way?"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "edited": false, "score": 0, "creation_date": 1566421194, "post_id": 57598797, "comment_id": 101655447, "body": "You could try using something like <code>CreateObject(&quot;Wscript.Shell&quot;).specialfolders(&quot;Desktop&quot;)</code> to find the user&#39;s Desktop folder."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "edited": false, "score": 0, "creation_date": 1566422820, "post_id": 57598797, "comment_id": 101655946, "body": "OK as long as you don&#39;t need to save it in the file when you close it..."}, {"owner": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "edited": false, "score": 0, "creation_date": 1566424260, "post_id": 57598797, "comment_id": 101656354, "body": "Ok your code works great for finding the desktop location which is one of the biggest hurdles ive been dealing with on this. Thanks for that. I do need to save the file within the newly created folder but im sure i can figure that out."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1566422766, "last_edit_date": 1566422766, "creation_date": 1566419280, "answer_id": 57598797, "question_id": 57598533, "link": "https://stackoverflow.com/questions/57598533/error-when-creating-directory-and-new-workbook/57598797#57598797", "title": "Error When Creating Directory And New Workbook", "body": "<p>Instead of this:</p>\n\n<pre><code>ChDir WBpath 'change the directory to WBPath\n\nIf Dir(WBpath &amp; \"\\BulkUploadFiles\\\", vbDirectory) = \"\" Then\n    MkDir \"BulkUploadFiles\" 'create the output folder\nEnd If\n</code></pre>\n\n<p>You can skip the <code>ChDir</code> and just use something like this:</p>\n\n<pre><code>fPath = WBpath &amp; \"\\BulkUploadFiles\"\nIf Dir(fPath, vbDirectory) = \"\" Then\n    MkDir fPath \nEnd If\n</code></pre>\n\n<p><code>ChDir</code> does not set the working folder if the user's current working folder is on a different drive</p>\n\n<p><strong>EDIT</strong>: this worked for me but I'm not sure what you want to do when adding multiple sheets to a CSV-format file, since a CSV can have only one \"sheet\"</p>\n\n<pre><code>Dim deskTop, wbName As String, folderName As String, newBook As Workbook\nDim txtVal As String\n\ntxtVal = UserForm1.TextBox5.Value\n\ndeskTop = CreateObject(\"Wscript.Shell\").specialfolders(\"Desktop\")\n\nwbName = \"BulkUpload\" &amp; txtVal &amp; \".csv\" 'the name of the file\n\n'close the workbook if it's open\nOn Error Resume Next 'ignore error if the file is not open\nWorkbooks(wbName).Close\nOn Error GoTo 0      'stop ignoring errors\n\nfolderName = deskTop &amp; \"\\BulkUploadFiles\\\"\nIf Len(Dir(folderName, vbDirectory)) = 0 Then MkDir folderName\n\nSet newBook = Workbooks.Add 'create the output workbook\n\nWith newBook\n    .Title = wbName\n    .Subject = wbName\n    .SaveAs Filename:=folderName &amp; wbName, FileFormat:=xlCSV, local:=True\n    .Sheets(1).Name = \"Sheet1\"\n    '??? a csv file can't have multiple sheets...\n    '.Sheets.Add(After:=.Worksheets(.Worksheets.Count)).Name = \"Sheet3\"\n    '.Worksheets(.Worksheets.Count).Visible = xlSheetHidden\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566421263, "post_id": 57599085, "comment_id": 101655467, "body": "&quot;failing&quot; is not a really useful description of what happens when your code runs - exactly <i>how</i> (error message?) and <i>where</i> (which specific line or lines) does it fail?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566422411, "post_id": 57599085, "comment_id": 101655831, "body": "See the edit in my answer - that code worked for me with the one question about having multiple sheets in a CSV."}], "tags": [], "owner": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "is_accepted": false, "score": 0, "last_activity_date": 1566421040, "creation_date": 1566421040, "answer_id": 57599085, "question_id": 57598533, "link": "https://stackoverflow.com/questions/57598533/error-when-creating-directory-and-new-workbook/57599085#57599085", "title": "Error When Creating Directory And New Workbook", "body": "<p>Here is my updated code. I tried using if statements to validate the path but this is still failing on every workstation except mine. </p>\n\n<pre><code>Dim NewBook As Variant\nDim WBpath, WBpath2, WBName, WBFile, WBFile2, WBDir, WBDir2, Fpath, Fpath2 As String\nDim User As String\nDim WS As Worksheet\nDim wb As Workbook\n\nUser = Environ(\"Username\") 'set the current users username to the User variable\n\nWBpath = \"C:\\Users\\\" &amp; User &amp; \"\\OneDrive - CompanyName\\Desktop\" 'windows directory where the file will go\nWBpath2 = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\" 'windows directory where the file will go\n\nWBName = \"BulkUpload\" &amp; UserForm1.TextBox5.value &amp; \".csv\" 'the name of the file\n\nWBFile = WBpath &amp; \"\\BulkUploadFiles\\\" &amp; WBName 'full file path we will be saving the file in\nWBFile2 = WBpath2 &amp; \"\\BulkUploadFiles\\\" &amp; WBName 'full file path we will be saving the file in\n\nFor Each wb In Workbooks 'loop through each open excel workbook and perform the below action\n    If wb.Name = WBName Then 'perform the below action only if the currently selected workbook has the same name as the output workbook\n        Workbooks(WBName).Close 'close the selected excel workbook\n    End If 'done checking if the file is already open\nNext 'go to the next open excel workbook\n\n'make the directory to save the bulkupload file to. create it if it doesnt already exist.\n\nFpath = WBpath &amp; \"\\BulkUploadFiles\\\"\n\nIf Dir(WBpath2, vbDirectory) &lt;&gt; \"\" Then\n\n     If Dir(Fpath, vbDirectory) = \"\" Then\n\n         MkDir Fpath\n\n         Set NewBook = Workbooks.Add 'create the output workbook\n\n         With NewBook 'set the properties for the output workbook\n             .Title = WBName 'add the workbook title\n             .Subject = WBName 'add the workbook subject\n             .SaveAs filename:=WBFile, FileFormat:=xlCSV, local:=True 'save the output workbook to the assigned directory as a CSV file\n         End With 'done setting file properties\n\n    End If\n</code></pre>\n\n<p>End If</p>\n\n<p>Fpath2 = WBpath2 &amp; \"\\BulkUploadFiles\\\"</p>\n\n<pre><code>If Dir(WBpath2, vbDirectory) &lt;&gt; \"\" Then\n\n    If Dir(Fpath2, vbDirectory) = \"\" Then\n\n        MkDir Fpath\n\n        Set NewBook = Workbooks.Add 'create the output workbook\n\n        With NewBook 'set the properties for the output workbook\n            .Title = WBName 'add the workbook title\n            .Subject = WBName 'add the workbook subject\n            .SaveAs filename:=WBFile2, FileFormat:=xlCSV, local:=True 'save the output workbook to the assigned directory as a CSV file\n        End With 'done setting file properties\n\n    End If\n</code></pre>\n\n<p>End If\n    Workbooks(WBName).Sheets(\"BulkUpload\" &amp; UserForm1.TextBox5.value).Name = \"Sheet1\" 'rename the first sheet in the output workbook back to Sheet1 so we can reference it correctly later</p>\n\n<pre><code>Workbooks(WBName).Sheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"Sheet3\" 'add a new sheet to the output workbook\n\nWorkbooks(WBName).Sheets(\"Sheet3\").Visible = xlSheetHidden 'hide the new sheet we just made (Sheet3)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11870779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52395fbc862d9c81bafca663c0dfad2?s=128&d=identicon&r=PG&f=1", "display_name": "chunklafunk", "link": "https://stackoverflow.com/users/11870779/chunklafunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57598797, "answer_count": 2, "score": -1, "last_activity_date": 1566424261, "creation_date": 1566417887, "last_edit_date": 1566424261, "question_id": 57598533, "link": "https://stackoverflow.com/questions/57598533/error-when-creating-directory-and-new-workbook", "title": "Error When Creating Directory And New Workbook", "body": "<p>So i have a VBA script that takes user input via userform then creates an output workbook to contain the data and saves it as a .csv. The issue im having is when i want to create the folder that the files will be saved into the directory is not the same for each workstation because my company uses Microsoft One Drive which changes the file path for the desktop. I have gotten this to work on my machine but every time i send my form to a user for testing they receive a runtime error and the application cannot create the folder on the desktop. on one occasion the folder was saved in \"My Documents\" when that is nowhere in my code. Hope you can help.</p>\n\n<p>i have changed my code several times using if statements to verify the file path but i still see the same issue</p>\n\n<pre><code>User = Environ(\"Username\") 'set the current users username to the User variable\n\nWBpath = \"C:\\Users\\\" &amp; User &amp; \"\\OneDrive - CompanyName\\Desktop\" 'windows directory where the file will go\nWBpath2 = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\" 'windows directory where the file will go\n\nWBName = \"BulkUpload\" &amp; UserForm1.TextBox5.value &amp; \".csv\" 'the name of the file\n\nWBFile = WBpath &amp; \"\\BulkUploadFiles\\\" &amp; WBName 'full file path we will be saving the file in\nWBFile2 = WBpath2 &amp; \"\\BulkUploadFiles\\\" &amp; WBName 'full file path we will be saving the file in\n\nFor Each wb In Workbooks 'loop through each open excel workbook and perform the below action\n    If wb.Name = WBName Then 'perform the below action only if the currently selected workbook has the same name as the output workbook\n        Workbooks(WBName).Close 'close the selected excel workbook\n    End If 'done checking if the file is already open\nNext 'go to the next open excel workbook\n\n'make the directory to save the bulkupload file to. create it if it doesnt already exist.\n\nIf Dir(WBpath, vbDirectory) &lt;&gt; \"\" Then 'check is the folder already exists\n\n    ChDir WBpath 'change the directory to WBPath\n\n    If Dir(WBpath &amp; \"\\BulkUploadFiles\\\", vbDirectory) = \"\" Then\n        MkDir \"BulkUploadFiles\" 'create the output folder\n    End If\n\n    Set NewBook = Workbooks.Add 'create the output workbook\n\n    With NewBook 'set the properties for the output workbook\n        .Title = WBName 'add the workbook title\n        .Subject = WBName 'add the workbook subject\n        .SaveAs filename:=WBFile, FileFormat:=xlCSV, local:=True 'save the output workbook to the assigned directory as a CSV file\n    End With 'done setting file properties\n\nEnd If\n\nIf Dir(WBpath2, vbDirectory) &lt;&gt; \"\" Then 'check is the folder already exists\n\n    ChDir WBpath2 'change the directory to WBPath2\n\n    If Dir(WBpath2 &amp; \"\\BulkUploadFiles\\\", vbDirectory) = \"\" Then\n        MkDir \"BulkUploadFiles\" 'create the output folder\n    End If\n\n    Set NewBook = Workbooks.Add 'create the output workbook\n\n    With NewBook 'set the properties for the output workbook\n        .Title = WBName 'add the workbook title\n        .Subject = WBName 'add the workbook subject\n        .SaveAs filename:=WBFile2, FileFormat:=xlCSV, local:=True 'save the output workbook to the assigned directory as a CSV file\n    End With 'done setting file properties\n\nEnd If\n\nWorkbooks(WBName).Sheets(\"BulkUpload\" &amp; UserForm1.TextBox5.value).Name = \"Sheet1\" 'rename the first sheet in the output workbook back to Sheet1 so we can reference it correctly later\n\nWorkbooks(WBName).Sheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"Sheet3\" 'add a new sheet to the output workbook\n\nWorkbooks(WBName).Sheets(\"Sheet3\").Visible = xlSheetHidden 'hide the new sheet we just made (Sheet3)\n</code></pre>\n\n<p>on my workstation (with one drive installed) this works fine but on other users pcs i receive an error when attempting to create the folder and fil</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1566417492, "post_id": 57598421, "comment_id": 101654065, "body": "make each macro a function that returns a value instead of a subroutine, and then check the value each returns after it is run to see if you want to continue."}, {"owner": {"reputation": 17, "user_id": 11805193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182fcd068dc40358c3f406d526990b43?s=128&d=identicon&r=PG&f=1", "display_name": "TristB", "link": "https://stackoverflow.com/users/11805193/tristb"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566417809, "post_id": 57598421, "comment_id": 101654194, "body": "would the code stop after each macro? The reason why I call the macros in one code is that the macros are very long to run, so I want the next macro to automatically start when one finishes"}, {"owner": {"reputation": 17, "user_id": 11805193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182fcd068dc40358c3f406d526990b43?s=128&d=identicon&r=PG&f=1", "display_name": "TristB", "link": "https://stackoverflow.com/users/11805193/tristb"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566417832, "post_id": 57598421, "comment_id": 101654201, "body": "Also, I do not know of the make a macro into a function"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566418548, "post_id": 57598421, "comment_id": 101654464, "body": "<a href=\"https://stackoverflow.com/questions/32621065/converting-a-subroutine-into-a-function\" title=\"converting a subroutine into a function\">stackoverflow.com/questions/32621065/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11805193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182fcd068dc40358c3f406d526990b43?s=128&d=identicon&r=PG&f=1", "display_name": "TristB", "link": "https://stackoverflow.com/users/11805193/tristb"}, "edited": false, "score": 0, "creation_date": 1566418973, "post_id": 57598669, "comment_id": 101654625, "body": "Thank you! I will try this!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1566418942, "last_edit_date": 1566418942, "creation_date": 1566418630, "answer_id": 57598669, "question_id": 57598421, "link": "https://stackoverflow.com/questions/57598421/how-to-display-a-changing-message-box-on-error-and-then-continue-code/57598669#57598669", "title": "How to display a changing message box on error and then continue code", "body": "<p>Change your \"macros\" to handle and re-throw errors, specifying an argument for the error's <code>Source</code> in the call to <code>Err.Raise</code>:</p>\n\n<pre><code>Public Sub Macro_1()\n    On Error GoTo CleanFail\n    '...original code here...\n    Exit Sub\nCleanFail:\n    Err.Raise Err.Number, \"Macro_1\", Err.Description\nEnd Sub\n</code></pre>\n\n<p>If an error occurs while executing <code>Macro_1</code>, the <code>Err.Source</code> will be \"Macro_1\".</p>\n\n<p>Now in the \"main\" procedure, you need to handle these errors bubbling up - pop a <code>MsgBox</code> and use <code>Err.Source</code> as e.g. the title (or as you please), and then <code>Resume Next</code> to clear the error state and move on to the next macro:</p>\n\n<pre><code>Public Sub Update_All()\n    On Error GoTo CleanFail\n    Macro_1\n    Macro_2\n    '...\n    Macro_8\n    Exit Sub\nCleanFail:\n    MsgBox Err.Description, vbExclamation, Err.Source\n    Resume Next\nEnd Sub\n</code></pre>\n\n<p>Consider renaming your procedures using meaningful names, e.g. <code>FormatSummarySheet</code>, or <code>UpdateOrdersTable</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 11805193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182fcd068dc40358c3f406d526990b43?s=128&d=identicon&r=PG&f=1", "display_name": "TristB", "link": "https://stackoverflow.com/users/11805193/tristb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 57598669, "answer_count": 1, "score": 1, "last_activity_date": 1566441961, "creation_date": 1566417349, "last_edit_date": 1566441961, "question_id": 57598421, "link": "https://stackoverflow.com/questions/57598421/how-to-display-a-changing-message-box-on-error-and-then-continue-code", "title": "How to display a changing message box on error and then continue code", "body": "<p>I have a macro that runs multiple other macros. I would like for the code to skip to the next macro if there is an error with one of the macros it calls. I would also like that a message box appears when an error occurs so that I know in which macro the error occured. So, I would like that the message box that appears if an error occurs changes so that it tells me the name of that macro.</p>\n\n<pre><code>\nSub Update_ALL()\n\n                ' Run All the macros\n\n                    Call Macro_1\n\n                    Call Macro_2\n\n                    Call Macro_3\n\n                    Call Macro_4  \n\n                    Call Macro_5  \n\n                    Call Macro_6 \n\n                    Call Macro_7 \n\n                    Call Macro_8                    \n\nEnd Sub\n\n</code></pre>\n\n<p>The code is very simple but I can't figure out how to skip to the next macro on error and have a changing message box.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1566417210, "post_id": 57598346, "comment_id": 101653971, "body": "oh boy. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a> to get rid of all the <code>.Select</code> &amp; <code>.ActiveCell</code> in your code. The length of this can prob be shrunk 4 fold by just doing that. After, debugging is much more bearable"}, {"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566417583, "post_id": 57598346, "comment_id": 101654096, "body": "I&#39;m not lying when I&#39;m saying I &quot;Inherited&quot; this Macro, I just need it to work now. I&#39;ll take a crack at reducing it as much as possible but I can&#39;t honestly say I know what i&#39;m doing, I&#39;m not acquainted with VBA well enough but I&#39;ll take a crack at it nonetheless."}, {"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566480943, "post_id": 57598346, "comment_id": 101676513, "body": "Err, okay. So I&#39;ve been attempting to make heads or tails of getting rid of the <code>.Select</code> &amp;  <code>.ActiveCell</code> this but I&#39;ve just broken the code repeatedly.. I&#39;m not sure I&#39;m succeeding in any step other than making the problem bigger."}, {"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566484555, "post_id": 57598346, "comment_id": 101678757, "body": "@urdearboy okay, So bear with me here. I &quot;finished&#39; trying to remove the bits, I guarantee it probably isn&#39;t good.. but I added it to the post."}], "owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566484609, "creation_date": 1566416999, "last_edit_date": 1566484609, "question_id": 57598346, "link": "https://stackoverflow.com/questions/57598346/is-there-a-way-to-replace-append-cell-data-over-cell-data-from-a-data-source", "title": "Is there a way to replace/append cell data over cell data from a Data Source", "body": "<p>I have an excel Macro that I've \"Inherited\" I'm not very familiar with VBA so the exact specifics of figuring out what is wrong with this code has become a slight problem, There's a Column (Column F) in a Table that has a Comments section. This comment section is suppose to be persistent through the data refreshes being performed. (If I add a comment to an entry despite the data source's comment section being empty it should keep the comments I added previously) According to my Supervisor this used to work but in the past 6 months has stopped working and I believe it may've been due to a bad edit or modification of the macro</p>\n\n<p>I've already edited the code to work with my new Data Connection, and I've corrected it some to properly handle the data now but this comment function is missing and I can tell there is a section of the code that handles the column and section but I can't tell what's wrong with it. </p>\n\n<pre><code>Sub RefreshAndDelete()\n'\n'\n'\n'\n\n    Dim sht as Sheets\n    Dim rng as Range\n    Dim col as Columns\n    Dim row as Rows\n    Application.ScreenUpdating = False\n    Set sht = Sheets(\"Ready Board\")\n    sht.Visible = True\n    sht.Cells.Select\n    If (sht.AutoFilterMode And sht.FilterMode) or sht.FilterMode Then\n    sht.ShowAllData\n    End If\n    set col = Columns(\"A:F\")\n    set rng = Range(\"IE_Testing_Board[[#Headers],[Comments]]\")\n    col.Copy\n    Sheets.Add, Worksheets(Worksheets.Count)\n    ActiveSheet.Name = \"Raw Data\"\n    ActivateSheet.Paste\n    Selection.NumberFormat = \"General\"\n    set col = Columns(\"A:A\")\n    Application.CutCopyMode = False\n    col.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    set rng = Range(\"A2\")\n    rng.FormulaR1C1 = \"=RC[4]&amp;RC[3]&amp;RC[2]\"\n    rng.Offset(0, 1).Select\n    rng.End(xlDown).Select\n    rng.Offset(0,-1).Select\n    set rng =  Range(Selection, Selection.End(xlUp))\n    rng.FillDown\n    set rng = Range(\"F1\")\n    set rng = rng.Offset(1,0)\n    Selection.Offset(1, 0).Select\n    ActiveCell.Offset(0, -2).Select\n    set rng = Range(Selection, Selection.End(xlDown))\n    rng.Offset(0,2)\n    rng.ClearContents\n    ActiveWorkbook.RefreshAll\n    sht.ListObjectsListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=11, Criteria1:=\"Yes\"\n    If Criteria1 &lt;&gt; \"\" Then\n    set row = Rows(\"1:1\")\n    row.Offset(1,0)\n    set rng = Range(Selection, Selection.End(xlDown))\n    rng.EntireRow.RefreshAndDelete\n    sht.ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=11\n    Else\n    sht..ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=11\n    End If\n    set rng = Range(\"F1\").Offset(1,0)\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP([@[Part '#]]&amp;[@[Operation '#]]&amp;[@[Machine '#]],'Raw Data'!C[-5]:C[1],7,FALSE),\"\"\"\")\"\n    set rng = Range(\"E1\").Offset(1,0)\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP([@[Part '#]]&amp;[@[Operation '#]]&amp;[@[Machine '#]],'Raw Data'!C[-4]:C[1],6,FALSE),\"\"\"\")\"\n    set rng = Range(\"F2\")\n    rng.AutoFill Destination:=Range(\"IE_Testing_Board[Comments]\")\n    sht.ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=6, _\n        Criteria1:=\"0\"\n    set rng = Range(\"F1\").Offset(1,0)\n    set rng = Range(rng, rng.End(xlDown))\n    rng.ClearContents\n    sht.ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=6\n    set rng = Range(\"E2\")\n    rng.AutoFill Destination:=Range(\"IE_Testing_Board[Part Program]\")\n    sht.ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=5, _\n        Criteria1:=\"0\"\n    set rng = Range(\"E1\").Offset(1,0)\n    set rng = Range(rng, rng.End(xlDown))\n    rng.ClearContents\n    sht.ListObjects(\"IE_Testing_Board\").Range.AutoFilter field:=5\n    set rng = Range(\"IE_Testing_Board[Comments]\")\n    rng.Copy\n    set rng = Range(\"F2\")\n    rng.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    set rng = Range(\"IE_Testing_Board[Part Program]\")\n    rng.Copy\n    set rng = Range(\"E2\")\n    rng.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    set rng = Range(\"E2\")\n    sht.Visible = False\n    set sht = Sheets(\"Raw Data\")\n    Application.DisplayAlerts = False\n    sht.Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    set sht = Sheets(\"Home\")\n\nEnd Sub\n\n</code></pre>\n\n<p>My Expected Result is that the Table Column: \"Comments\" (Which is column F) keeps whatever is entered into it despite the information pulled from the data source on our SharePoint. </p>\n\n<p>So, If on my SharePoint the Comment cell it has \"ID-0001\" but in my Excel file it has the Comment - \"Needs Approval\" when the data is refreshed via the Macro it should somehow keep the \"Needs Approval\" comment that is in the file. Appending the File's Comment to the SharePoint Data's comment. (Even if they're blank it should still keep the File's comment).</p>\n\n<p>If any more clarification is needed I'll do my best to Provide it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1566415576, "post_id": 57598043, "comment_id": 101653274, "body": "That means the find was unsuccessful."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1566415754, "post_id": 57598043, "comment_id": 101653353, "body": "Side note: you want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using select</a> in your code. In this case <code>Range(&quot;O252&quot;).Formula = ...</code> would do the job just fine (if the find is successful)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566415960, "post_id": 57598043, "comment_id": 101653440, "body": "<code>Cells.Find</code> will look on the ActiveSheet - if you want to look on some other sheet then you need to specify that explicitly.  eg <code>Sheet1.Cells.Find(...)</code>"}, {"owner": {"reputation": 11, "user_id": 11952038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fdb5a085c474dbf33c8faff839e2a4e?s=128&d=identicon&r=PG&f=1", "display_name": "OfficeNoob007", "link": "https://stackoverflow.com/users/11952038/officenoob007"}, "edited": false, "score": 0, "creation_date": 1566416533, "post_id": 57598043, "comment_id": 101653716, "body": "Thank you for tips. They help me fix my formula to work just had to add sheets.cells you mention."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1566416232, "creation_date": 1566416232, "answer_id": 57598203, "question_id": 57598043, "link": "https://stackoverflow.com/questions/57598043/trying-to-get-a-cell-to-equal-to-a-variable-location/57598203#57598203", "title": "Trying to get a cell to equal to a variable location", "body": "<p>You're cramming too many things into a single executable statement. Split. Things. Up.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveSheet 'TODO: get the actual sheet you want to work with.\n\nDim searchResult As Range\nSet searchResult = ws.Cells.Find(What:=\"InsertC\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n'TODO: reconsider whether ActiveCell needs to be involved in the search.\n\nIf searchResult Is Nothing Then Exit Sub 'couldn't find what we're looking for; bail out!\n\nDim offsetCell As Range\nOn Error Resume Next 'next instruction may raise an error - ignore it\nSet offsetCell = searchResult.Offset(-2, 8)\nIf offsetCell Is Nothing Then Exit Sub 'couldn't legally offset negative rows; bail out!\nOn Error GoTo 0 'resume raising runtime errors\n\nws.Range(\"O252\").Formula = \"=\" &amp; offsetCell.Address(External:=True)\n</code></pre>\n\n<p>Note the sheet's name doesn't need to be hard-coded in the formula - <code>offsetCell.Address</code>  can work it out for you if you specify <code>True</code> for the <code>External</code> parameter.</p>\n\n<p>That will make the formula be e.g. <code>=[Book1]Sheet1!$A$1</code>, but the <code>[Book1]</code> part will be optimized away by Excel after the formula is successfully assigned.</p>\n"}], "owner": {"reputation": 11, "user_id": 11952038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fdb5a085c474dbf33c8faff839e2a4e?s=128&d=identicon&r=PG&f=1", "display_name": "OfficeNoob007", "link": "https://stackoverflow.com/users/11952038/officenoob007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566442356, "creation_date": 1566415429, "last_edit_date": 1566442356, "question_id": 57598043, "link": "https://stackoverflow.com/questions/57598043/trying-to-get-a-cell-to-equal-to-a-variable-location", "title": "Trying to get a cell to equal to a variable location", "body": "<p>Ok noob at vba here. I am trying to update a cells formula on sheet 2 to equal to another cell on sheet 1. The location of the cell sheet can and will change. The only constant is the cell with \"InsertC' in relation to the cell I need.</p>\n\n<pre><code>Range(\"O252\").Select\nActiveCell.Formula = \"=Sheet1!\" &amp; Cells.Find(What:=\"InsertC\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Offset(-2, 8).Address\n</code></pre>\n\n<p>Current error is </p>\n\n<blockquote>\n  <p>run time error '91' Object variable or with block variable not set</p>\n</blockquote>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 11558, "user_id": 11897007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IoZiJ.png?s=128&g=1", "display_name": "Celius Stingher", "link": "https://stackoverflow.com/users/11897007/celius-stingher"}, "edited": false, "score": 0, "creation_date": 1566415130, "post_id": 57597854, "comment_id": 101653074, "body": "Can you convert these dates to integers? If so, given the format, the filter you are thinking for dates should work the same for integers too."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 3, "creation_date": 1566415422, "post_id": 57597854, "comment_id": 101653210, "body": "<code>Where Date_Added between &#39;20190101&#39; and 20190501&#39;</code>  why do you need to convert.  You can filter on the string dates as is so long as what you&#39;re using to filter is in a YYYYMMDD format and string data type.."}, {"owner": {"reputation": 32, "user_id": 11593786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d0da358989327ebdddb6c9caef8c2?s=128&d=identicon&r=PG&f=1", "display_name": "Keenan Grassby", "link": "https://stackoverflow.com/users/11593786/keenan-grassby"}, "edited": false, "score": 0, "creation_date": 1566474139, "post_id": 57597854, "comment_id": 101672464, "body": "The problem is the start date and end date are both inputs with the date format"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1566585121, "post_id": 57597854, "comment_id": 101716475, "body": "Ask yourself is it more work for the system to cast every record&#39;s value to a date and lose index use (if they exist) , or convert the inputs to strings for comparison once.  Just food for thought."}], "answers": [{"tags": [], "owner": {"reputation": 2369, "user_id": 11948610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7369157d6c65253cc08bdd8ad7d1661?s=128&d=identicon&r=PG&f=1", "display_name": "CR7SMS", "link": "https://stackoverflow.com/users/11948610/cr7sms"}, "is_accepted": false, "score": 0, "last_activity_date": 1566415281, "creation_date": 1566415281, "answer_id": 57598009, "question_id": 57597854, "link": "https://stackoverflow.com/questions/57597854/finding-a-range-of-data-between-dates-formatted-as-strings/57598009#57598009", "title": "Finding a range of data between dates formatted as strings", "body": "<p>You can convert the string into date by splitting into parts and then apply the filter:</p>\n\n<pre><code>datefromparts(substring(Date_Added,1,4),substring(Date_Added,5,2),substring(Date_Added,7,2)) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1566419802, "creation_date": 1566419802, "answer_id": 57598883, "question_id": 57597854, "link": "https://stackoverflow.com/questions/57597854/finding-a-range-of-data-between-dates-formatted-as-strings/57598883#57598883", "title": "Finding a range of data between dates formatted as strings", "body": "<p>Create simple select queries like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n  Work_Orders.Work_order_num, \n  (CDate(Format([Date_added],\"@@@@\\/@@\\/@@\") AS TrueDate_added, \n  Work_Orders.sysnum, \n  Work_Orders.Information\nFROM Work_Orders\n</code></pre>\n\n<p>to replace your tables. Then, from these, you can build the queries needed filtering on dates the usual way.</p>\n"}], "owner": {"reputation": 32, "user_id": 11593786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0d0da358989327ebdddb6c9caef8c2?s=128&d=identicon&r=PG&f=1", "display_name": "Keenan Grassby", "link": "https://stackoverflow.com/users/11593786/keenan-grassby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57598883, "answer_count": 2, "score": 0, "last_activity_date": 1594549510, "creation_date": 1566414503, "last_edit_date": 1594549510, "question_id": 57597854, "link": "https://stackoverflow.com/questions/57597854/finding-a-range-of-data-between-dates-formatted-as-strings", "title": "Finding a range of data between dates formatted as strings", "body": "<p>I have an older database that has the structure has been linked to and accessed through MS-ACCESS, When this database was created the date was added as short text instead of date format, this brings up problems when trying to query items between two dates.</p>\n\n<p>I cannot edit the format of this table, due to it being linked from an external database through ms-access</p>\n\n<p>The table looks approximately like this.</p>\n\n<pre><code>Work_Orders\n---\nWork_order_num Date_added sysnum Information\n10000000       19981212   1      foo\n10000001       19991213   2      bar\n10000002       19991214   3      Beep\n10000003       19991214   3      Boop\n10000004       19991215   2      fooo\n10000005       19991216   5      barr\n10000006       19991216   1      beop\n\n</code></pre>\n\n<p>I need query all specific work orders within a specific date range. I currently have tried to convert the column into date format using ((CDate(Format([Date_added],\"@@@@/@@/@@\")). However, I also need to select multiple system numbers from another table, this makes the query too complex and I have yet to find a different method to make this query work.</p>\n\n<p>the system table looks like this:</p>\n\n<pre><code>System_Select \nSysnum Selected\n1      True\n2      False\n3      True\n4      False\n5      True\n</code></pre>\n\n<p>the query looks like this</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>DECLARE\n  @START_DATE,\n  @END_DATE\n\nSELECT \n  Work_Orders.Work_order_num, \n  (CDate(Format([Date_added],\"@@@@\\/@@\\/@@\") AS WO_DATE, \n  Work_Orders.sysnum, \n  Work_Orders.Information\n\nFROM \n  table \n  INNER JOIN System_Select ON \n    Work_Orders.sysnum = System_Select.Sysnum\nWHERE\n  System_Select.Selected = True\n  AND\n  ((CDate(Format([Date_added],\"@@@@\\/@@\\/@@\")&gt;=START_DATE) \n  AND\n  ((CDate(Format([Date_added],\"@@@@\\/@@\\/@@\")&lt;=END_DATE)\n\n</code></pre>\n\n<p>So in short, how will I go about getting a specific range of dates when all the dates are formatted as short strings?</p>\n"}, {"tags": ["vba", "ms-word", "full-text-search", "wildcard"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566414313, "post_id": 57597665, "comment_id": 101652699, "body": "How about <code>&quot;Height {1,}-[0-9.]*(mm)&gt;&quot;</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566415790, "post_id": 57597665, "comment_id": 101653367, "body": "...or without the <code>*</code> even"}, {"owner": {"reputation": 1, "user_id": 11958435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3740fb4cbdca671eebfd33baae341f1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/11958435/chrisc"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566416065, "post_id": 57597665, "comment_id": 101653497, "body": "Tim, It has to be only an excluded zero (want all results but the 0mm) to be highlighted . Looks like what is happening is that it sees the exclusion [!0] and this disregards the rest of the pattern *(mm)&gt;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566416378, "post_id": 57597665, "comment_id": 101653651, "body": "That pattern worked for me with the examples you provided.  It would also detect (eg) <code>Height -0.0.1mm</code> though.  Not having a &quot;zero or one instance&quot; flag is a bit of a problem.  EDIT - I only just saw you explicitly didn&#39;t want to match <code>Height -0mm</code>"}, {"owner": {"reputation": 1, "user_id": 11958435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3740fb4cbdca671eebfd33baae341f1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/11958435/chrisc"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566416837, "post_id": 57597665, "comment_id": 101653836, "body": "Not sure what it is, but the period/dot after the exclusion [!0] seems to make the find function disregard the rest of the pattern, so it doesn&#39;t flag the result."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566417031, "post_id": 57597665, "comment_id": 101653912, "body": "Without a more fully-functional wildcard system I guess you&#39;re stuck with running the find/replace in a loop and checking each hit to see if it needs to be highlighted."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1566464165, "post_id": 57597665, "comment_id": 101667001, "body": "Try &quot;(Height)( {1,})(-)([0-9]{1,})(.)([0-9m]{1,})&quot;.  If you need units other than mm then add the appropriate characters to the [0-9m]"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11958435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3740fb4cbdca671eebfd33baae341f1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/11958435/chrisc"}, "is_accepted": false, "score": 0, "last_activity_date": 1566479753, "creation_date": 1566479753, "answer_id": 57610245, "question_id": 57597665, "link": "https://stackoverflow.com/questions/57597665/use-wildcards-to-find-all-excluded-matching-strings/57610245#57610245", "title": "Use wildcards to find all excluded matching strings", "body": "<p>Thanks Freeflow, I was able to include this to catch the decimal point finds. See working code below</p>\n\n<p>I ended up having to loop thru the find twice. The first time to catch everything that wasn't \"Height -0mm\" (95% of the results). Then the second time to catch the remaining results that contained a decimal point.</p>\n\n<pre><code>' Use to search and highlight all matching from the phrase \".Text =\" line below\n'\n' Explane the \".Text = \"Height {1,}-[!0]{1,}\" wildcard pattern match\n' Height - (just the begining text string to search for)\n' [!0] (telling to find anything except the number zero)\n' {1,} ( telling the find that there may be one or more in a row)\n\nSub Find_Highlight_Height()\n\nDim loopTimes As Integer\nApplication.ScreenUpdating = False\nOptions.DefaultHighlightColorIndex = wdYellow\n'Options.DefaultHighlightColorIndex = wdRed\n\n' Looping thru twice so can capture find's with and without decimal points\n' Discovered an issue with VBA in that the decimal point halts the find pattern when present\n' right after a exclude \"!\" pattern element this case the \"[!0]\"\nFor loopTimes = 1 To 2\n\n    With ActiveDocument.Content.Find\n    .ClearFormatting\n\n    If loopTimes = 1 Then\n       .Text = \"Height {1,}-[!0]{1,}*mm\" 'Works when decimal point is NOT present\n    Else\n        .Text = \"(Height)( {1,})(-)([0-9]{1,})(.)([0-9m]{1,})\" 'Works when decimal is present\n    End If\n\n    With .Replacement\n        .Text = \"^&amp;\"\n        .ClearFormatting\n        .Highlight = True\n    End With\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchWildcards = True\n    .Execute Replace:=wdReplaceAll\n    End With\n\nNext loopTimes\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I am still baffeled at why VBA stops the wildcard pattern when a decimal follows an exclusion in the pattern.</p>\n"}], "owner": {"reputation": 1, "user_id": 11958435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3740fb4cbdca671eebfd33baae341f1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/11958435/chrisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566479753, "creation_date": 1566413444, "last_edit_date": 1566415738, "question_id": 57597665, "link": "https://stackoverflow.com/questions/57597665/use-wildcards-to-find-all-excluded-matching-strings", "title": "Use wildcards to find all excluded matching strings", "body": "<p>I am trying to improve a VBA macro that I have used with some success. What the macro is intended to do is search a Word document find and highlight specific text strings that do NOT match the given find criteria.</p>\n\n<p>This macro works quite well when the search results are whole numbers. But when a leading zero is involved it will not find and highlight.</p>\n\n<pre><code>Sub Find_Highlight_Height()\n    Application.ScreenUpdating = False\n    Options.DefaultHighlightColorIndex = wdYellow\n    'Options.DefaultHighlightColorIndex = wdRed\n    With ActiveDocument.Content.Find\n      .ClearFormatting\n    '  .Text = \"Height {1,}-[!0]{1,}*mm\"\n      .Text = \"Height {1,}-[!0]*(mm)&gt;\"\n      With .Replacement\n        .Text = \"^&amp;\"\n        .ClearFormatting\n        .Highlight = True\n      End With\n      .Forward = True\n      .Wrap = wdFindContinue\n      .Format = True\n      .MatchWildcards = True\n      .Execute Replace:=wdReplaceAll\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>By this I mean the following:\nA text string that I do not want to match. \"Height -0mm\" (yes there is one or more spaces between the \"t\" and \"-\")</p>\n\n<p>So all other strings I want to match (for a few examples) \"Height -1mm\", \"Height -1.0mm\", \"Height -10.5mm\", and \"Height -0.5mm\". </p>\n\n<p>The above wildcard <code>.Text = \"Height {1,}-[!0]*(mm)&gt;\"</code> works as expected for all results except the one with the leading zero (last one). I have tried so many combinations of the wildcard string I have lost count</p>\n\n<p>What am I missing? And is there a better way to go about this \"inverse find\" and highlight?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566415380, "post_id": 57597636, "comment_id": 101653191, "body": "As the function name implies, <code>getElementsByClassName</code> can return multiple elements that you will have to parse in order to find the one you want."}, {"owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566419274, "post_id": 57597636, "comment_id": 101654734, "body": "Okay so now with Set ieTable = ieDoc.getElementsByClassName(&quot;Reports-Area&quot;)(0) I am able to pull everything except the title - is there a way to edit selection this to remove the first row before I paste to excel?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1566421651, "post_id": 57598837, "comment_id": 101655595, "body": "If you can supply properly formed table html I can write something better."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1566423033, "last_edit_date": 1566423033, "creation_date": 1566419520, "answer_id": 57598837, "question_id": 57597636, "link": "https://stackoverflow.com/questions/57597636/vba-how-to-select-a-specific-webpage-div-based-on-class/57598837#57598837", "title": "VBA: How to select a specific webpage div based on class", "body": "<p>There are several methods you can use. I will show 3 for now.</p>\n\n<hr>\n\n<p><strong>Filter with CSS selectors:</strong></p>\n\n<p>You could start with simply using an <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\">attribute = value css selector</a> with starts with operator (^) to target the classes of interest. I can't see the rest of the html so unsure if this will pick up additional rows.</p>\n\n<pre><code>Dim rows As Object\nSet rows =  ieDoc.querySelectorAll(\"[class^='Reports-Line']\")\n</code></pre>\n\n<p>An example reading your html (Slighly amended for parsing).... I isolate the rows of interest and combine their <code>outerHTML</code>. I add <code>&lt;table&gt;&lt;/table&gt;</code> tags either end and use clipboard to paste table to sheet</p>\n\n<p>Requires reference to Microsoft HTML Object Library.</p>\n\n<pre><code>Option Explicit\nPublic Sub Test()\n    Dim html As HTMLDocument, rows As Object, i As Long, clipboard As Object, s As String\n\n    Set html = GetHTMLFileContent(\"C:\\Users\\User\\Desktop\\test.html\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set rows = html.querySelectorAll(\"[class^='Reports-Line']\")\n\n    For i = 0 To rows.Length - 1\n        s = s &amp; rows.item(i).outerHTML\n    Next\n\n    s = \"&lt;table&gt;\" &amp; s &amp; \"&lt;/table&gt;\"\n    clipboard.SetText s\n    clipboard.PutInClipboard\n    ActiveSheet.Range(\"A1\").PasteSpecial\nEnd Sub\n\nPublic Function GetHTMLFileContent(ByVal filePath As String) As HTMLDocument\n    Dim fso As Object, hFile As Object, hString As String, html As HTMLDocument\n    Set html = New HTMLDocument\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set hFile = fso.OpenTextFile(filePath)\n\n    Do Until hFile.AtEndOfStream\n        hString = hFile.ReadAll()\n    Loop\n\n    html.body.innerHTML = hString\n    Set GetHTMLFileContent = html\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>HTML sample (needs tweaking but sufficient for demo):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;head&gt;&lt;/head&gt;\r\n &lt;body&gt;\r\n  &lt;table id=\"mainContent\" class=\"MainContent-Report\" cellspacing=\"0\" cellpadding=\"0\" ... &lt;div class=\"reports-area\"&gt; \r\n  &lt;/table&gt;\r\n  &lt;table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"&gt; \r\n   &lt;tbody&gt; \r\n    &lt;tr class=\"reports-heading\"&gt;\r\n     don't want\r\n    &lt;/tr&gt; \r\n    &lt;tr id=\"R211\" class=\"Reports-LineOne\"&gt;\r\n     do want 1\r\n    &lt;/tr&gt; \r\n    &lt;tr id=\"R212\" class=\"Reports-LineTwo\"&gt;\r\n     do want 2.\r\n    &lt;/tr&gt;\r\n   &lt;/tbody&gt;\r\n  &lt;/table&gt;\r\n &lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<hr>\n\n<p><strong>Remove offending item with javascript</strong> </p>\n\n<p>The following shows using javascript to remove first row (header row) from a table:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AlterTable()\n    Dim ie As Object, html As HTMLDocument, clipboard As Object, hTable As HTMLTable\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.w3schools.com/html/html_tables.asp\"\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With .document\n            .parentWindow.execScript \"var child = document.querySelector('#customers tr:nth-of-type(1)'); child.parentNode.removeChild(child);\"\n            'in your case .parentWindow.execScript \"var child = document.querySelector('.reports-area table tr:nth-of-type(1)'); child.parentNode.removeChild(child);\"\n            Set hTable = .querySelector(\"#customers\")  ' in your case use:  .querySelector(\".reports-area table\")\n        End With\n\n        clipboard.SetText hTable.outerHTML\n        clipboard.PutInClipboard\n        ActiveSheet.Range(\"A1\").PasteSpecial\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Remove offending item with HTMLDocument methods:</strong></p>\n\n<p>Same thing but without javascript i.e. using methods of HTMLDocument direct</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AlterTable()\n    Dim ie As Object, html As HTMLDocument, clipboard As Object, hTable As HTMLTable\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.w3schools.com/html/html_tables.asp\"\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#customers tr:nth-of-type(1)\").ParentNode.RemoveChild .querySelector(\"#customers tr:nth-of-type(1)\")  'in your case use  querySelector(\".reports-area table tr:nth-of-type(1)\").ParentNode.RemoveChild .querySelector(\".reports-area table tr:nth-of-type(1)\")\n            Set hTable = .querySelector(\"#customers\")  ' in your case use:  .querySelector(\".reports-area table\")\n        End With\n\n        clipboard.SetText hTable.outerHTML\n        clipboard.PutInClipboard\n        ActiveSheet.Range(\"A1\").PasteSpecial\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 57598837, "answer_count": 1, "score": 3, "last_activity_date": 1566423033, "creation_date": 1566413309, "last_edit_date": 1566420118, "question_id": 57597636, "link": "https://stackoverflow.com/questions/57597636/vba-how-to-select-a-specific-webpage-div-based-on-class", "title": "VBA: How to select a specific webpage div based on class", "body": "<p>I'm looking to select part of a table (basically don't want the title, would prefer to leave off headers row too) I can't seem to get it to work.</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;table id=\"mainContent\" Class=\"MainContent-Report\" cellspacing=\"0\" cellpadding=\"0\"\n...\n&lt;div class=\"reports-area\"&gt;\n&lt;table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"&gt;\n&lt;tbody&gt;\n&lt;tr class=\"reports-heading\"&gt;...&lt;/tr&gt;\n&lt;tr id=\"R211\" class=\"Reports-LineOne\"&gt;...&lt;/tr&gt;\n&lt;tr id=\"R212\" class=\"Reports-LineTwo\"&gt;...&lt;/tr&gt;\n</code></pre>\n\n<p>VBA:</p>\n\n<p>this grabs the entire table, including title and column headers, and works fine: </p>\n\n<pre><code>Set ieTable = ieDoc.all.Item(\"mainContent\")\n</code></pre>\n\n<p>but what I want to do is something like this, excluding the title and column headers: </p>\n\n<pre><code>Set ieTable = ieDoc.getElementsByClassName(\"Reports-Area\")\n</code></pre>\n\n<p>For what its worth, The number of rows in the report is dynamic.</p>\n\n<p>I get this error: </p>\n\n<blockquote>\n  <p>\"Object Variable or With Block not set\"</p>\n</blockquote>\n"}, {"tags": ["python", "vba", "io-redirection"], "answers": [{"tags": [], "owner": {"reputation": 1149, "user_id": 4231985, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10203705295985572/picture?type=large", "display_name": "kkawabat", "link": "https://stackoverflow.com/users/4231985/kkawabat"}, "is_accepted": false, "score": 0, "last_activity_date": 1566413231, "creation_date": 1566413231, "answer_id": 57597613, "question_id": 57597481, "link": "https://stackoverflow.com/questions/57597481/redirecting-out-err-of-a-bash-script-run-from-python/57597613#57597613", "title": "redirecting out/err of a bash script run from python", "body": "<p>You can try <code>Popen</code>:</p>\n\n<pre><code>import subprocess\nwith open(my_file, 'w') as f:\n    subprocess.Popen('./my_script.sh', stdout=f, shell=True)\n</code></pre>\n\n<p>if you want to view the output in python first then save it to a file you can do:</p>\n\n<pre><code>with open(my_file, 'w') as f:\n    output = subprocess.check_output('./my_script.sh', shell=True)\n    print(output)\n    f.write(str(output))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7260609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/97y8f.jpg?s=128&g=1", "display_name": "Faka", "link": "https://stackoverflow.com/users/7260609/faka"}, "is_accepted": false, "score": 0, "last_activity_date": 1566413427, "creation_date": 1566413427, "answer_id": 57597658, "question_id": 57597481, "link": "https://stackoverflow.com/questions/57597481/redirecting-out-err-of-a-bash-script-run-from-python/57597658#57597658", "title": "redirecting out/err of a bash script run from python", "body": "<p>It seems won't work, as in the <a href=\"https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout\" rel=\"nofollow noreferrer\">document</a>:</p>\n\n<blockquote>\n  <p>Note that the global side effect on sys.stdout means that this context manager is not suitable for use in library code and most threaded applications. It also has no effect on the output of subprocesses.</p>\n</blockquote>\n\n<p>Just try subprocess instead.</p>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566413427, "creation_date": 1566412566, "question_id": 57597481, "link": "https://stackoverflow.com/questions/57597481/redirecting-out-err-of-a-bash-script-run-from-python", "title": "redirecting out/err of a bash script run from python", "body": "<p>I'm trying to use <code>contextlib.redirect...</code> to redirect err/out of my function:</p>\n\n<pre><code>with open(my_file, 'w') as f:\n    with contextlib.redirect_stdout(f):\n        print(1)\n</code></pre>\n\n<p>This works fine.</p>\n\n<p>However, I want to run a script:</p>\n\n<pre><code>with open(my_file, 'w') as f:\n    with contextlib.redirect_stdout(f):\n        os.system('./my_script.sh')\n</code></pre>\n\n<p>and here the out/err is not redirected.</p>\n\n<ol>\n<li>Is this because the script is run with its own file descriptors,\nthus, the redirect is not affecting the correct files?</li>\n<li>Can this be solved from Python rather than redirecting it from the\nBash script? (<code>subprocess.checkoutput</code> maybe? I'm not sure this achieves the same)</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1566412311, "post_id": 57597379, "comment_id": 101651878, "body": "Instead of <code>&quot;A &amp; n&quot;</code> use <code>&quot;A&quot; &amp; n</code> - <code>n</code> is a variable, so do not include it in quotes."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1566412353, "post_id": 57597379, "comment_id": 101651896, "body": "Variables should be outside of quotes: <code>&quot;E&quot; &amp; ii &amp; &quot;:E&quot; &amp; j</code>. Well you&#39;ve got tons of instances of this as @braX has pointed out too."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 2, "creation_date": 1566412412, "post_id": 57597379, "comment_id": 101651928, "body": "You say <code>i = 3</code>, then go on to say from <code>i = 1 to LastRow</code>"}, {"owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "edited": false, "score": 0, "creation_date": 1566412834, "post_id": 57597379, "comment_id": 101652103, "body": "Thank you for your comments you are correct, I have fixed the quote error and the i= 3 error. However, now I am getting the error code &quot;Unable to get the Average property of the WorksheetFunction class&quot;"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1566414421, "post_id": 57597379, "comment_id": 101652751, "body": "@RachelRoberts Can you edit your post with your updated code?"}, {"owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "edited": false, "score": 0, "creation_date": 1566416575, "post_id": 57597379, "comment_id": 101653733, "body": "I have updated the code with edits"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "edited": false, "score": 1, "creation_date": 1566416852, "post_id": 57598176, "comment_id": 101653843, "body": "This worked great thank you! And was much simpler than how I was originally trying."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "edited": false, "score": 0, "creation_date": 1566416914, "post_id": 57598176, "comment_id": 101653866, "body": "If this will be a running list you may need to modify the <code>x</code> variable to be a last row count on your <code>FilteredData</code> sheet. If so, just mimic the <code>LR</code> calc used above"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1566417526, "last_edit_date": 1566417526, "creation_date": 1566416128, "answer_id": 57598176, "question_id": 57597379, "link": "https://stackoverflow.com/questions/57597379/average-ten-values-and-then-loop-through-to-the-next-ten-values-until-there-are/57598176#57598176", "title": "Average ten values and then loop through to the next ten values until there are no more values", "body": "<p>Here is a potential alternative that may be a little easier to follow by making use of nested loops. This way you do not have to complete the average for each column one by one, instead you can just have your action line written once situated inside a row &amp; column loop. </p>\n\n<p>Simplifying variables will also make this easier to update / debug in the future.</p>\n\n<pre><code>Sub Jeeped()\n\nDim rd As Worksheet: Set rd = ThisWorkbook.Sheets(\"RawData\")\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"FilteredData\")\n\nDim LR As Long\nLR = rd.Range(\"A\" &amp; rd.Rows.Count).End(xlUp).Row\n\nDim c As Long 'Column Loop\nDim r As Long 'Row Loop\nDim x As Long 'Paste counter\nx = 2\n\nDim TempAverage As Range\n\nFor r = 2 To LR Step 10\n    For i = 1 To 5                                                      '&lt;-- (Columns A - D)\n        Set TempAverage = rd.Range(rd.Cells(r, i), rd.Cells(r + 9, i))\n        ws.Cells(x, i).Value = Application.WorksheetFunction.Average(TempAverage)\n    Next i\n  x = x + 1\nNext r\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>assumes your variables span Columns A:D on <code>RawData</code> and that the values will be pasted on <code>FilterdData</code> on <code>Columns A:D</code> as well. You can modify the loops to place them in the correct location</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/RKcpe.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/RKcpe.png</a></p>\n"}], "owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57598176, "answer_count": 1, "score": 0, "last_activity_date": 1569461837, "creation_date": 1566412144, "last_edit_date": 1569461837, "question_id": 57597379, "link": "https://stackoverflow.com/questions/57597379/average-ten-values-and-then-loop-through-to-the-next-ten-values-until-there-are", "title": "Average ten values and then loop through to the next ten values until there are no more values", "body": "<p>I have a dataset that consists of 5 different variables. As shown below.</p>\n\n<pre><code>Value1          Value 2     Value 3        Value 4          Value 5\n1200.08031  104.9940186  28.05707932    23.90201187      1198.955811\n1200.01948  105.0005951  28.05075455    23.88057899      1198.984619\n1199.9152   105.0007782  28.04256058    23.86779976      1199.18042\n1199.90651  105.0114594  28.05139923    23.90410423      1199.148926\n1200.01079  104.9975433  28.05404663    23.89129448      1198.660034\n1199.97603  104.9940186  28.0475502     23.91586685      1198.932129\n1199.89782  105.0007782  28.04875183    23.87851715      1198.928833\n1200.01948  105.0056458  28.04198837    23.91583633      1199.087524\n1199.87175  105.0026855  28.04278946    23.91485214      1198.896851\n1199.97603  105.0054626  28.04265976    23.9235096       1199.426514\n</code></pre>\n\n<p>Each of these variables has around 15,000 data points. To reduce the number of data points I want to average every ten data points into one data point and assign this value to a cell on another sheet. I want it to look like: </p>\n\n<pre><code>Value1Avg       Value 2Avg     Value 3Avg     Value 4Avg     Value 5Avg\n1200.08031     104.9940186  28.05707932    23.90201187     1198.955811 \n</code></pre>\n\n<p>I cannot get the average function to loop through every ten data points.</p>\n\n<p>I have tried to run a loop that goes through each column and averages the values and places them on a different sheet, but I am not incrementing the variables correctly I believe. </p>\n\n<pre><code>Set wb = ThisWorkbook\nSet sht1 = wb.Sheets(\"RawData\")\nSet sht2 = wb.Sheets(\"FilteredData\")\n\nii = 2\nj = 11\ndd = 2\nk = 20\nn = 1\n\nLastRow = sht1.Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\n\nFor i = 1 To LastRow\n    Set Myrange = sht1.Range(\"E\" &amp; ii, \"E\" &amp; j)\n    sht2.Range(\"A\" &amp; n).Value =Application.WorksheetFunction.Average(Myrange)\n    Set Myrange = sht1.Range(\"B\" &amp; ii, \"B\" &amp; j)\n    sht2.Range(\"B\" &amp; n).Value = Application.WorksheetFunction.Average(Myrange)\n    Set Myrange = sht1.Range(\"C\" &amp; ii, \"C\" &amp; j)\n    sht2.Range(\"C\" &amp; n).Value = Application.WorksheetFunction.Average(Myrange)\n    Set Myrange = sht1.Range(\"H\" &amp; ii, \"H\" &amp; j)\n    sht2.Range(\"E\" &amp; n).Value = Application.WorksheetFunction.Average(Myrange)\n    Set Myrange = sht1.Range(\"D\" &amp; ii, \"D\" &amp; j)\n    sht2.Range(\"D\" &amp; n).Value = Application.WorksheetFunction.Average(Myrange)\n    ii = ii + 10\n    j = j + 10\n    n = n + 1\nNext i\n</code></pre>\n\n<p>I expect to go to sheet 2 and see the averages, but I get: </p>\n\n<blockquote>\n  <p>\"Run-time error '1004': Method 'Range' of object '_Worksheet' failed\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566410791, "post_id": 57597026, "comment_id": 101651260, "body": "Instead of <code>sCell.Delete</code> try <code>sCell.Value = &quot;&quot;</code> if that&#39;s what you are trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1566414011, "last_edit_date": 1566414011, "creation_date": 1566411302, "answer_id": 57597182, "question_id": 57597026, "link": "https://stackoverflow.com/questions/57597026/how-to-delete-highlighted-cells-without-indexing-up/57597182#57597182", "title": "How to delete highlighted cells without indexing up?", "body": "<p>Use this if you want to clear the formatting too. If you don't instead of <code>ClearContents</code> use <code>Clear</code></p>\n\n<pre><code>Sub DeleteColoredCells()\n\n    Dim Rng As Range\n    Dim sCell As Range\n    Set Rng = Range(\"A1:E4\")\n        For Each sCell In Rng\n            If sCell.Interior.color = vbYellow Then\n                sCell.ClearContents\n            End If\n        Next sCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57597182, "answer_count": 1, "score": 1, "last_activity_date": 1566414011, "creation_date": 1566410571, "question_id": 57597026, "link": "https://stackoverflow.com/questions/57597026/how-to-delete-highlighted-cells-without-indexing-up", "title": "How to delete highlighted cells without indexing up?", "body": "<p>I'm trying to delete all cells that are highlighted yellow, leaving only the values that are not highlighted. However, every time I delete a highlighted cell, the cell directly below it indexes up into its place, because the value moves up into a different cell it is missed in the loop. Can I prevent cells below highlighted cells from indexing up?</p>\n\n<pre><code>Sub DeleteColoredCells()\n\n    Dim Rng As Range\n    Dim sCell As Range\n    Set Rng = Range(\"A1:E4\")\n        For Each sCell In Rng\n            If sCell.Interior.color = vbYellow Then\n                sCell.Delete\n            End If\n        Next sCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566410740, "post_id": 57597025, "comment_id": 101651240, "body": "Instead of using <code>UsedRange</code>, why not <code>Selection</code>? Or get the range from an input box."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566411487, "post_id": 57597025, "comment_id": 101651564, "body": "<b>OR</b> Find the last row and the last column and then construct your range"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1566415082, "post_id": 57597025, "comment_id": 101653047, "body": "If you really want to speed this up, you may want to capture your range as a variant array, make your adjustments to the array, then transpose the array back to your sheet."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1566415471, "post_id": 57597025, "comment_id": 101653227, "body": "If you don&#39;t mind using an add-in instead of coding this yourself, I can recommend <a href=\"https://www.asap-utilities.com/\" rel=\"nofollow noreferrer\">asap-utilities.com</a> It is an indispensable tool for me."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1566415327, "creation_date": 1566415327, "answer_id": 57598018, "question_id": 57597025, "link": "https://stackoverflow.com/questions/57597025/remove-trim-spaces-from-cells-in-excel-sheet-using-vba/57598018#57598018", "title": "Remove/Trim spaces from cells in excel sheet using vba", "body": "<p>perhaps:</p>\n\n<pre><code>Option Explicit\nSub trimConstants()\n    Dim R As Range, C As Range\n    Dim WS As Worksheet\n\nSet WS = Worksheets(\"sheet2\") 'better than using `ActiveSheet`\nSet R = WS.Cells.SpecialCells(xlCellTypeConstants)\n\nFor Each C In R\n    C = Trim(C)\nNext C\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11958443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22b7f21a94a50b69a87bace06666890?s=128&d=identicon&r=PG&f=1", "display_name": "Migs", "link": "https://stackoverflow.com/users/11958443/migs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57598018, "answer_count": 1, "score": 0, "last_activity_date": 1566415327, "creation_date": 1566410563, "last_edit_date": 1566414721, "question_id": 57597025, "link": "https://stackoverflow.com/questions/57597025/remove-trim-spaces-from-cells-in-excel-sheet-using-vba", "title": "Remove/Trim spaces from cells in excel sheet using vba", "body": "<p>I am trying to remove the leading and trailing spaces in an excel sheet. I have a code that is currently doing that but it is running through the entire sheet. I would like to select a range, instead of the whole sheet to save time.</p>\n\n<p>I tried using a code already but i need to simplify to make the process faster.</p>\n\n<pre><code>Dim r As Range\nFor Each r In ActiveSheet.UsedRange\nv = r.Value\nIf v &lt;&gt; \"\" Then\nIf Not r.HasFormula Then\nr.Value = Trim(v)\nEnd If\nEnd If\nNext r\n</code></pre>\n\n<p>This code will remove spaces from the entire sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 1, "creation_date": 1566413520, "post_id": 57597024, "comment_id": 101652382, "body": "You&#39;re using Public Function so probably it would be UDF function. Notice, if you want to recalculate value of your UDF function you must use some workarounds. If you know your table name and it is static and you are sure every row contains data then you can use excel-built function subtotal &quot;=SUBTOTAL(103,Table)=0&quot; which will be better solution. Otherwise use BigBen&#39;s answer."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1566413753, "post_id": 57597024, "comment_id": 101652476, "body": "@Rafa\u0142B. feel free to add that as a solution, SUBTOTAL is a good idea and you could easily translate that to VBA. If you add I will upvote."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566416042, "post_id": 57597804, "comment_id": 101653490, "body": "You could simplify to <code>TestFilterResult = (Application.WorksheetFunction.Subtotal(103, tbl.DataBodyRange) = 0)</code> instead of using <code>Evaluate</code>, but yep."}], "tags": [], "owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1566414876, "last_edit_date": 1566414876, "creation_date": 1566414183, "answer_id": 57597804, "question_id": 57597024, "link": "https://stackoverflow.com/questions/57597024/check-if-listobject-filter-returns-any-results/57597804#57597804", "title": "Check if Listobject Filter Returns any results", "body": "<p>Encouraged by BigBen's comment I would post another solution. If you're sure each of your table row always contains data you can use excel-built SUBTOTAL function</p>\n\n<pre><code> Public Function TestFilterResult() As Boolean\n   Dim tbl As ListObject\n   Dim check As Boolean\n\n   Set tbl = ActiveSheet.ListObjects(1)\n   check = Application.Evaluate(\"SUBTOTAL(103,\" &amp; tbl.Name &amp; \")\") = 0\n\n     If check Then\n       TestFilterResult = True\n     End If\n\n End Function\n</code></pre>\n\n<p>But if your table is static better way will be to add column e.g. \"Ordinal number\" with function ROWS what will make you sure there are not empty rows in your table and then use \"=SUBTOTAL(103,YourTableName)\" just in Excel cell, there is no need using UDF and VBA in this case.</p>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57597804, "answer_count": 1, "score": 0, "last_activity_date": 1566414876, "creation_date": 1566410557, "question_id": 57597024, "link": "https://stackoverflow.com/questions/57597024/check-if-listobject-filter-returns-any-results", "title": "Check if Listobject Filter Returns any results", "body": "<p>I am trying to check whether a filtered listobject returns no results.</p>\n\n<pre><code>Public Function TestFilterResult() As Boolean\nDim filterArea As Range\nDim cellsCount As Long\n\nSet filterArea = ActiveSheet.ListObjects(1).Range\n\ncellsCount = filterArea.SpecialCells(xlCellTypeVisible).Count\n\nIf cellsCount = 0 Then\n    TestFilterResult = True\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>However, the function incorrectly returns <code>TRUE</code> because it accounts for the header row which is always visible. Is there a way around this or perhaps a different approach altogether in checking this?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1566490854, "last_edit_date": 1566490854, "creation_date": 1566420018, "answer_id": 57598927, "question_id": 57596594, "link": "https://stackoverflow.com/questions/57596594/using-sql-in-vba-to-join-data-from-two-excel-workbooks-read-only-error/57598927#57598927", "title": "Using SQL in VBA to Join Data from two Excel Workbooks (Read-Only error)", "body": "<p>Admittedly, the error is not too informative as issue may be due to file path issue. However, this simple typographic fix may be helpful for future readers who make same subtle mistake. By the way, for long names, consider separate variables and concatenate into connection and SQL strings.</p>\n\n<ol>\n<li><p>Include full path including extension, <code>.xlsx</code> or <code>.xlsm</code> in source file.</p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>meta_file = \"T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\State Data\\\" _\n             &amp; state &amp; \" - biological metadata multiple cont.xlsx\"\n\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .connectionstring = \"Data Source=\" &amp; meta_file &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;Readonly=false;IMEX=0\"\";\"\n    .Open\nEnd With\n</code></pre></li>\n<li><p>Remove space before and after the <em>Database</em> argument inside the bracket namespace: <code>...Database=T:\\Marketing\\...</code>. Otherwise, engine interprets space as part of name. Even consider removing spaces between all arguments <em>IMEX</em>, <em>HDR</em>, <em>Readonly</em>, etc.</p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>site_file = \"T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\State Data\\\" _\n             &amp; state &amp; \" - Site data only multiple cont.xlsx\"\n\n'---Run the SQL SELECT Query---\nsql = \"SELECT b.OrganizationIdentifier, b.OrganizationFormalName, \" &amp; _\n      \"       b.MonitoringLocationIdentifier, s.LatitudeMeasure, \" &amp; _ \n      \"       s.LongitudeMeasure, b.ActivityIdentifier, b.ActivityTypeCode, \" &amp; _ \n      \"       b.ActivityMediaName, b.ActivityMediaSubdivisionName, \" &amp; _\n      \"       b.ActivityStartDate, b.ProjectIdentifier, b.CharacteristicName, \" &amp;  _\n      \"       b.ResultSampleFractionText, b.ResultMeasureValue, \" &amp; _\n      \"       b.[ResultMeasure/MeasureUnitCode] \" &amp; _\n      \"FROM [biologicalresult$] b \" &amp; _\n      \"INNER JOIN (SELECT * FROM [Excel 12.0 Xml;IMEX=0;HDR=Yes;\" &amp; _\n      \"                           Database=\" &amp; site_file &amp; \";Readonly=False].[station$]) s \" &amp; _\n      \"ON b.MonitoringLocationIdentifier = s.MonitoringLocationIdentifier;\"\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 57598927, "answer_count": 1, "score": 1, "last_activity_date": 1594549480, "creation_date": 1566408615, "last_edit_date": 1594549480, "question_id": 57596594, "link": "https://stackoverflow.com/questions/57596594/using-sql-in-vba-to-join-data-from-two-excel-workbooks-read-only-error", "title": "Using SQL in VBA to Join Data from two Excel Workbooks (Read-Only error)", "body": "<p>I am seeking to join specific data from two very large excel workbooks, then save this to another workbook. In order to do this, I was using ADODB Objects to use SQL commands, which make performing the join much easier than doing hundreds of thousands of VLookups. My setup prompts the name of a state, and the data source is formatted to depend this state. Let's say you entered \"Nevada\". It would connect to a file named \"Nevada - biological metadata multiple cont\" and join this to another file named \"Nevada - Site data only multiple cont\" and select certain fields from this.</p>\n\n<p>When I am debugging, I can see that the connection is working just fine, and where I change the string variable 'sql' to equal \"SELECT * FROM [biologicalresult$]\", it will work correctly. The problem seems to be tied to the fact that I am joining it to another workbook through ADODB queries, and I get the error: \"Cannot update. Database or object is read-only\"</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub RunSELECT()\n\n    On Error GoTo ErrorHandling\n\n    Dim cn As Object, rs As Object, output As String, sql As String, state As String\n    state = InputBox(\"Please insert the state name with the first letter being capital\")\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n\n    '---Connecting to the Data Source---\n    With cn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        .connectionstring = \"Data Source=T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\State Data\\\" &amp; state &amp; _\n                            \" - biological metadata multiple cont;Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;Readonly = false;IMEX = 0\"\";\"\n        .Open\n    End With\n\n    '---Run the SQL SELECT Query---\n    sql = \"SELECT b.OrganizationIdentifier, b.OrganizationFormalName, b.MonitoringLocationIdentifier, s.LatitudeMeasure, s.LongitudeMeasure, \" &amp; _\n        \"b.ActivityIdentifier , b.ActivityTypeCode, b.ActivityMediaName, b.ActivityMediaSubdivisionName, \" &amp; _\n        \"b.ActivityStartDate, b.ProjectIdentifier, b.CharacteristicName, b.ResultSampleFractionText, b.ResultMeasureValue, b.[ResultMeasure/MeasureUnitCode] \" &amp; _\n        \"FROM [biologicalresult$] b INNER JOIN (SELECT * FROM [Excel 12.0 Xml; IMEX = 0; HDR = Yes; Database = T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\\" &amp; _\n        \"State Data\\\" &amp; state &amp; \" - Site data only multiple cont;Readonly = False].[station$]) s \" &amp; _\n        \"ON b.MonitoringLocationIdentifier = s.MonitoringLocationIdentifier;\"\n\n    Set rs = cn.Execute(sql)\n\n    '---Clean up---\n    rs.Close\n    cn.Close\n    Set cn = Nothing\n    Set rs = Nothing\n\nExit Sub\n\nErrorHandling:\n    MsgBox (\"Source: \" &amp; Err.Source &amp; vbNewLine &amp; \"Number: \" &amp; Err.Number &amp; vbNewLine &amp; \"Description: \" &amp; Err.Description &amp; vbNewLine &amp; \"Help Context: \" &amp; Err.HelpContext)\ndone:\n    End Sub\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 411, "user_id": 3750276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38efc81024d5f963ea5c4ef740a3e028?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Yan", "link": "https://stackoverflow.com/users/3750276/adam-yan"}, "edited": false, "score": 1, "creation_date": 1566409310, "post_id": 57596581, "comment_id": 101650666, "body": "How about save your query to a .sql file and then execute it with sqlcmd utilily? You can also save the command to a *.bat file and autorun it from scheduled task."}, {"owner": {"reputation": 411, "user_id": 3750276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38efc81024d5f963ea5c4ef740a3e028?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Yan", "link": "https://stackoverflow.com/users/3750276/adam-yan"}, "edited": false, "score": 0, "creation_date": 1566409598, "post_id": 57596581, "comment_id": 101650788, "body": "<a href=\"https://stackoverflow.com/questions/18004258/\">Here</a> is how to execute sql file with sqlcmd"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1566413791, "post_id": 57596581, "comment_id": 101652491, "body": "You also should read about how to use parameters with your queries. This code is wide open to sql injection."}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 2, "last_activity_date": 1566418061, "last_edit_date": 1566418061, "creation_date": 1566415236, "answer_id": 57598002, "question_id": 57596581, "link": "https://stackoverflow.com/questions/57596581/i-created-some-vba-that-turns-excel-data-into-sql-inserts-is-there-a-way-to-upd/57598002#57598002", "title": "I created some VBA that turns Excel data into SQL INSERTS. Is there a way to update SQL Server directly?", "body": "<p>Here's a generic ADO execute template I pulled out of my library for you. I suggest researching the topic.</p>\n\n<p>also worth pointing out that youre looping through the sheet. Learn to dump to array and process that way.</p>\n\n<p>This requires the correct reference to Microsoft Data Objects Lirbary</p>\n\n<pre><code>Private Sub zzz()\n    Dim vbSql As String, cnnstr as string\n    Dim cnn As ADODB.Connection\n\n    vbSql = \"sql statement; \"\n\n    Set cnn = New Connection\n    cnnstr = \"Provider=SQLOLEDB;Data Source=yourserver;Initial Catalog=yourDB;User ID=UserName;Password=PassWord; Trusted_Connection=No\"\n    cnn.Open cnnstr\n    cnn.Execute vbSql\n    cnn.Close\n    Set cnn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 11584051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca21cd6595d5baad82015d72c3c69875?s=128&d=identicon&r=PG&f=1", "display_name": "MelanieLauzon", "link": "https://stackoverflow.com/users/11584051/melanielauzon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57598002, "answer_count": 1, "score": 2, "last_activity_date": 1566442419, "creation_date": 1566408573, "last_edit_date": 1566442419, "question_id": 57596581, "link": "https://stackoverflow.com/questions/57596581/i-created-some-vba-that-turns-excel-data-into-sql-inserts-is-there-a-way-to-upd", "title": "I created some VBA that turns Excel data into SQL INSERTS. Is there a way to update SQL Server directly?", "body": "<p>Currently, I take the copied SQL and paste into SQL Server Management Studio and then Execute. This is fine as it only takes a few seconds. However, I would like to know if there is a way to take my INSERTS or UPDATES and automatically apply them to SQL Server. </p>\n\n<p>I've tried using Power Query but really I don't want to reinvent something if I can just add a line or two to automatically update. I can't find anything online to tie into what I already developed. </p>\n\n<p>The code below is what I use to turn the columns into SQL INSERTs.  I would like to replace the copy to the Clipboard at the end of the code to something that will  INSERT directly into the SQL SERVER database Table. </p>\n\n<pre><code>Set Lad = NewFormat.Range(\"A2:A\" &amp; LastRow)\n\nFor Each cell In Lad\n cell.Value = \"INSERT INTO GeoChem1(OrderID,SampleNumber,Matrix,Method,WellID,Site,DateCollected,DateReceived,CustomerName,Param,\" &amp; _\n  \"ParamResults,Units,Dilution,Qualifier,RepLimit,AnalysisDate) VALUES(\" &amp; cell.Offset(0, 1).Value &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 2).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; _\n  cell.Offset(0, 3).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 4).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 5).Value &amp; \"'\" &amp; \",\" &amp; cell.Offset(0, 6).Value &amp; \",\" &amp; _\n  \"'\" &amp; cell.Offset(0, 7).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 8).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 9).Value &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; _\n   cell.Offset(0, 10).Value &amp; \"'\" &amp; \",\" &amp; cell.Offset(0, 11).Value &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 12).Value &amp; \"'\" &amp; \",\" &amp; cell.Offset(0, 13).Value &amp; _\n   \",\" &amp; \"'\" &amp; cell.Offset(0, 14).Value &amp; \"'\" &amp; \",\" &amp; cell.Offset(0, 15).Value &amp; \",\" &amp; \"'\" &amp; cell.Offset(0, 16).Value &amp; \"'\" &amp; \");\"\n  Next cell\n\n ''COPY TO CLIPBOard''\n Set Lad = NewFormat.Range(\"A2:A\" &amp; LastRow)\nLad.Copy\n</code></pre>\n"}, {"tags": ["vba", "winapi", "timer", "message-queue"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1566408199, "post_id": 57595916, "comment_id": 101650188, "body": "They only build up if you request them and don&#39;t remove them. It seems likely to me that you have misdiagnosed your problem."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1566408783, "post_id": 57595916, "comment_id": 101650448, "body": "The only way for a <code>WM_TIMER</code> message to wind up in the message queue is a call to <code>PeekMessage</code> with <code>PM_NOREMOVE</code>. Looks like your fix created the problem in the first place."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1566461019, "post_id": 57595916, "comment_id": 101665535, "body": "@IInspectable Are you sure, the way I understood <a href=\"https://devblogs.microsoft.com/oldnewthing/20160624-00/?p=93745\" rel=\"nofollow noreferrer\">this article</a> I linked was that my host application (Excel) was peeking at WM_SYSTIMER messages and that generates the WM_TIMER messages. Although I must admit I assumed that the word COM meant that article was relevant to me, is it not? I&#39;m using a Userform to generate the hWnd for my timers, but Excel is the one managing the thread and hosting whatever weird and wonderful <i>modal message loop</i> that may lead to the issue."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1566479261, "post_id": 57595916, "comment_id": 101675447, "body": "That sounds implausible. It seems very likely that you have completely misdiagnosed the problem. Perhaps you could tell us about the actual problem rather than your proposed solution."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1566489006, "post_id": 57595916, "comment_id": 101681190, "body": "I&#39;m sure there&#39;s COM involved, somewhere. Office&#39;s automation interface is exposed as COM interfaces. I don&#39;t know, whether COM is involved in your particular situation. To understand what&#39;s really going on, it&#39;s probably best if you produced a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566405982, "creation_date": 1566405199, "last_edit_date": 1566405982, "question_id": 57595916, "link": "https://stackoverflow.com/questions/57595916/remove-messages-by-their-wparam", "title": "Remove messages by their wparam", "body": "<p>I am trying to remove <code>WM_TIMER</code> messages from the message queue according to the <code>wparam</code> (timerId) they are associated with. This is because when you destroy a timer, <a href=\"https://devblogs.microsoft.com/oldnewthing/20141205-00/?p=43463\" rel=\"nofollow noreferrer\">the messages already in the queue aren't removed</a>. This isn't a problem for timers with an <code>lparam (TIMERPROC)</code> specified, as for some reason <a href=\"https://stackoverflow.com/q/57134016/6609896\">they are just ignored</a>. However some of my messages are generated with no <code>TIMERPROC</code>, and these continue to fire even when their parent timers are dead - <a href=\"https://devblogs.microsoft.com/oldnewthing/20160624-00/?p=93745\" rel=\"nofollow noreferrer\">as sometimes they build up in the message queue</a></p>\n\n<p>So is this a sensible approach:</p>\n\n<pre><code>targetID = ...\nDo While WinAPI.PeekMessage(MSG, myHWnd, WM_TIMER, WM_TIMER, PM_REMOVE) &lt;&gt; 0\n    If MSG.wparam = targetID Then\n        'do nothing\n    Else\n         WinAPI.DispatchMessage MSG 'send it back to the window\n    End If\nLoop\n</code></pre>\n\n<p>It doesn't feel like a sensible approach but I couldn't work out a way to do this with <code>PM_NOREMOVE</code></p>\n"}, {"tags": ["vba", "ms-access", "decimal", "separator"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "edited": false, "score": 1, "creation_date": 1566464450, "post_id": 57596412, "comment_id": 101667150, "body": "Thanks, I guessed this is the only way around the problem. To minimize the impact on speed, I implemented it by first retrieving once the system decimal separator DecSep=Right((Format(0, &quot;0.&quot;), 1) then calling a formatting function BankSum(Amount,DecSep) each time necessary: If DecSep = &quot;.&quot; Then BankSum = Format(Amount, &quot;#0.00&quot;) Else BankSum = Replace(Format(Amount, &quot;#0.00&quot;), DecSep, &quot;.&quot;) End If As formatting is done in a single step, the effect on speed is negligible. NB: in Switzerland both &quot;.&quot; or &quot;,&quot; are usual - but for internet banking XML files this must always be &quot;.&quot; !"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "edited": false, "score": 0, "creation_date": 1566476435, "post_id": 57596412, "comment_id": 101673719, "body": "@Bughater - well, if it works for you, then its ok. Still, think of some input, using thausands separator like <code>100.000,32</code>. This may really hit the fan."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1566407787, "creation_date": 1566407787, "answer_id": 57596412, "question_id": 57595896, "link": "https://stackoverflow.com/questions/57595896/how-to-set-decimal-separator-in-ms-access-using-vba/57596412#57596412", "title": "How to set decimal separator in MS Access using VBA?", "body": "<p>I guess the problem is not solveable with the decimal separator <code>Application.DecimalSeparator = \".\"</code>, even if it was supported by the Access library. It is a rather complicated issue, for the non-US users, as we are used to have <code>,</code> as a decimal separator.</p>\n\n<p>In general, VBA considers only <code>.</code> as a decimal separator. Without taking care of the application default separator, the location of the user and their settings. Thus, some interesting cases could happen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/60KfC.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/60KfC.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestMe()\n    Dim myText As String\n    myText = \"123,42\"\n    Debug.Print Replace(Format(myText, \"#0.00\"), \",\", \".\")\nEnd Sub\n</code></pre>\n\n<p>A possible solution, that I have implemented some time ago was to use <code>Replace()</code> and to replace as in the gif above. It could be a bit slow indeed, but taking into account the usage of VBA and Access, extreme speed is not something the app could achieve anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "edited": false, "score": 0, "creation_date": 1566462803, "post_id": 57596823, "comment_id": 101666370, "body": "Thanks, but this doesn&#39;t resolve the question because when making text from numbers, Access always uses the default decimal separator. This is also the case when using MyText=Format(123, &quot;#0.00&quot;): the &quot;.&quot; is not interpreted as dot, but as decimal separator - that is, MyText is 123,00 when the decimal separator is &quot;,&quot; !"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "edited": false, "score": 1, "creation_date": 1566463468, "post_id": 57596823, "comment_id": 101666681, "body": "It certainly does answer your original question. Of course, it doesn&#39;t answer your new question. And your assumption, that Access (VBA) always uses the default decimal separator, is not correct. See edited answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1566463465, "last_edit_date": 1566463465, "creation_date": 1566409713, "answer_id": 57596823, "question_id": 57595896, "link": "https://stackoverflow.com/questions/57595896/how-to-set-decimal-separator-in-ms-access-using-vba/57596823#57596823", "title": "How to set decimal separator in MS Access using VBA?", "body": "<blockquote>\n  <p>The decimal separator must always be a dot.</p>\n</blockquote>\n\n<p>Then use <strong>Str</strong>:</p>\n\n<pre><code>MyText = Str(MyNumber)\n</code></pre>\n\n<p>To convert such a string to a number use <strong>Val</strong>:</p>\n\n<pre><code>MyNumber = Val(MyText)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6527605, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e598dcda0c952ef1f6a4e7fb612a7cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Bughater", "link": "https://stackoverflow.com/users/6527605/bughater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1856, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1566463465, "creation_date": 1566405115, "question_id": 57595896, "link": "https://stackoverflow.com/questions/57595896/how-to-set-decimal-separator-in-ms-access-using-vba", "title": "How to set decimal separator in MS Access using VBA?", "body": "<p>My software creates PAIN001.XML files directly from an Access financial database. The decimal separator must always be a dot. The numbers are formatted with:</p>\n\n<pre><code>MyText = Format(MyNumber, \"#0.00\")\n</code></pre>\n\n<p>However, the format string's dot is automatically replaced by the system decimal separator, which might be \",\" instead of \".\" !</p>\n\n<p>In Excel there are easy solutions, for example:</p>\n\n<pre><code>Application.DecimalSeparator = \".\"\n...\n</code></pre>\n\n<p>However, MS Access doesn't recognize this application property.\n<strong>Is there a simple way to define a decimal separator within Access vba code ?</strong></p>\n\n<p>Of course, one can create a function which scans each MyText number for wrong decimal separators and replaces them with a dot, but this function would have to be called separately for each number, slowing down the code quite a lot\u2026</p>\n"}, {"tags": ["vba", "format", "pivot-table", "copy-paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566404719, "post_id": 57595775, "comment_id": 101648809, "body": "Comment out the <code>On Error Resume Next</code> and rerun. Do you get an error message?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566405674, "post_id": 57595775, "comment_id": 101649246, "body": "Also consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to have more consistent indenting."}, {"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566407095, "post_id": 57595775, "comment_id": 101649807, "body": "@BigBen Yes I get run-time error 9 - Subscript out of range"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566407261, "post_id": 57595775, "comment_id": 101649861, "body": "On what line do you get that error? Please <a href=\"https://stackoverflow.com/posts/57595775/edit\">edit</a> your question with the error description and the line that throws it, thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566409391, "post_id": 57595775, "comment_id": 101650705, "body": "If you add a new workbook, it probably won&#39;t have a sheet named with the same name as the original <code>sh</code>, right?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566410051, "post_id": 57595775, "comment_id": 101650951, "body": "^ though this is a side issue and not related to the Pivot Table formatting."}, {"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566465997, "post_id": 57595775, "comment_id": 101667953, "body": "@BigBen I removed that line and it is throwing another error that could be possibly related to it. Run time error 91: Object variable or With block variable not set and it refers to this line of code: ```Set CopiedRange = Range(.Cells(1, 1), .Cells(lastcell.Row, lastcell.Column))"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566482522, "post_id": 57595775, "comment_id": 101677507, "body": "It sounds like the <code>Find</code> was unsuccessful and <code>lastcell</code> is <code>Nothing</code>."}, {"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "edited": false, "score": 0, "creation_date": 1566484081, "post_id": 57595775, "comment_id": 101678476, "body": "Well if last cell is Nothing then I should get nothing pasted on the new page. On the other hand I get exactly the range I want. The only thing missing is the Pivot Table format."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1566493211, "post_id": 57595775, "comment_id": 101683103, "body": "Please see <a href=\"https://stackoverflow.com/a/56602988/10908769\">here</a> how to copy a pivot table with formatting."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1566493256, "post_id": 57595775, "comment_id": 101683123, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56596120/vba-copy-and-paste-pivot-values-and-format\">VBA copy and paste pivot values and format</a>"}, {"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "edited": false, "score": 0, "creation_date": 1566547244, "post_id": 57595775, "comment_id": 101698115, "body": "Thank you Asger. My problem is that I have multiple pivot tables on each page and other pages that I need to copy to a new file only contains regular data. Does it mean I can&#39;t use the same copy and paste routine for the regular data and the pivot tables? Also with tabs with multiple pivot tables I have to copy and paste them one by one?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "edited": false, "score": 0, "creation_date": 1567011923, "post_id": 57688028, "comment_id": 101838373, "body": "Using Pivot Table object is a solution I already explored, but the funny thing is that if I use TableRange2 (as I need to copy and paste the filters of the pivot) it does not paste the formats. It only works with TableRange1. I can use the Pivot Table object only if I can paste the filters"}, {"owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "reply_to_user": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "edited": false, "score": 0, "creation_date": 1567064590, "post_id": 57688028, "comment_id": 101853209, "body": "So what you are trying to do is just to copy the pivot table with all its functionalities and formatting?"}, {"owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "edited": false, "score": 0, "creation_date": 1567088723, "post_id": 57688028, "comment_id": 101866877, "body": "I do not want the functionalities, only values and formats. If I am not able to copy an entire page with the values and the formatting then, the only possibility that I have is to copy and paste the values and the formatting of all the pivot tables in the sheet."}], "tags": [], "owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "is_accepted": false, "score": 0, "last_activity_date": 1566980774, "creation_date": 1566980774, "answer_id": 57688028, "question_id": 57595775, "link": "https://stackoverflow.com/questions/57595775/i-cant-paste-pivot-table-formats-to-another-page/57688028#57688028", "title": "I can&#39;t paste pivot table formats to another page", "body": "<p>Try to copy the whole table range as below (you might need to change the range the pivot table belongs to):</p>\n\n<pre><code>Sub TestPivotPaste()\n\nDim wb As Workbook\nDim sh As Worksheet\nDim sh1 As Worksheet\nDim copyrange As Range\n\nSet wb = ActiveWorkbook\nSet sh = wb.Worksheets(8)\nSet pt = sh.Range(\"A3\").PivotTable\nSet sh1 = wb.Worksheets(9)\nSet copyrange = pt.TableRange1\n\ncopyrange.Copy\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteValues\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteFormats\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteColumnWidths\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6650562, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153778832844786/picture?type=large", "display_name": "Eliseo Di Folco", "link": "https://stackoverflow.com/users/6650562/eliseo-di-folco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1566980774, "creation_date": 1566404577, "last_edit_date": 1566488808, "question_id": 57595775, "link": "https://stackoverflow.com/questions/57595775/i-cant-paste-pivot-table-formats-to-another-page", "title": "I can&#39;t paste pivot table formats to another page", "body": "<p>Trying to copy and paste a Pivot Table on Excel from one page to the other.\nCode works but it does not paste the formats.</p>\n\n<pre><code>Sub TestPivotPaste()\nDim wb As Workbook\nDim sh As Worksheet\nDim sh1 As Worksheet\nDim copyrange As Range\n\nSet wb = ActiveWorkbook\nSet sh = wb.Worksheets(8)\nSet copyrange = sh.Range(\"A1:Z50\")\nSet sh1 = wb.Worksheets(9)\n\n\ncopyrange.Copy\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteValues\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteFormats\nsh1.Range(\"B50\").PasteSpecial Paste:=xlPasteColumnWidths\n\nEnd Sub\n</code></pre>\n\n<p>I tried to do it on the same page</p>\n\n<pre><code>Sub TestPivotPaste()\nDim wb As Workbook\nDim sh As Worksheet\nDim copyrange As Range\nSet wb = ActiveWorkbook\nSet sh = wb.Worksheets(8)\nSet copyrange = sh.Range(\"A1:Z50\")\ncopyrange.Copy\nsh.Range(\"B50\").PasteSpecial Paste:=xlPasteValues\nsh.Range(\"B50\").PasteSpecial Paste:=xlPasteFormats\nsh.Range(\"B50\").PasteSpecial Paste:=xlPasteColumnWidths\nEnd Sub\n</code></pre>\n\n<p>It still gets copied without formats and I get\nRun-time error 1004: PasteSpecial method of Range class failed and the guilty line is </p>\n\n<pre><code>sh.Range(\"B50\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p>I can't figure out where the problem is by looking at similar answer on this website</p>\n"}, {"tags": ["vba", "runtime-error", "pivot-table"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1566403602, "post_id": 57595468, "comment_id": 101648324, "body": "<code>Legx.CurrentPage</code> I think is an object type, so you need to <code>Set Legx.CurrentPage = cp</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1566404040, "post_id": 57595468, "comment_id": 101648495, "body": "FYI <code>Dim Legx, DepDtex As PivotField</code> is declaring <code>DtpDtex</code> as a <code>PivotField</code> object, and leaves <code>Legx</code> as an implicit <code>Variant</code> - ditto for <code>cp</code>. Both <code>cp</code> and <code>dep</code> should be declared <code>As Range</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1566404196, "post_id": 57595468, "comment_id": 101648560, "body": "@DavidZemens I&#39;m not sure about <code>Set</code> here. In testing, <code>CurrentPage</code> did not expect a <code>Range</code> object. Works fine with a string or value of a range."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1566405212, "post_id": 57595468, "comment_id": 101649060, "body": "@DavidZemens and now I can&#39;t repro the error, seeing as my answer is functionally equivalent to OP, except for fixing variable types and explicitly stating <code>.Value</code>... hmmm."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 0, "creation_date": 1566406635, "post_id": 57595764, "comment_id": 101649640, "body": "Thank You, the error is gone, however I have a question. From the new code I am using I have removed the &#39;set =&#39; for &quot;cp&quot; and &quot;dep&quot; but I kept the &quot;with&quot; block. While your new code has kept the &#39;set=&#39; and removed the &quot;with&quot; block. What&#39;s the difference and what makes one option better than the other?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 0, "creation_date": 1566406693, "post_id": 57595764, "comment_id": 101649663, "body": "Sure, feel free to ask!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 1, "creation_date": 1566407223, "post_id": 57595764, "comment_id": 101649849, "body": "<code>Set</code> is for a <code>Range</code> variable. I assume you have not changed the variable declaration to <code>As Range</code> for <code>cp</code> and <code>dep</code>? As far as the <code>With...End With</code>, this is a different issue. I removed it because you are not actually using it. If you were, there would be a reference to a property/method of the <i>pivot table</i> within the <code>With...End With</code> block, and that reference would begin with the period <code>.</code>. You don&#39;t have that going on."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 1, "creation_date": 1566407379, "post_id": 57595764, "comment_id": 101649897, "body": "See the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\"><code>With</code> statement</a> documentation for more detail."}, {"owner": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 0, "creation_date": 1566409047, "post_id": 57595764, "comment_id": 101650552, "body": "Understood. Thank for your time and patience."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "edited": false, "score": 0, "creation_date": 1566409139, "post_id": 57595764, "comment_id": 101650593, "body": "Oh no problem, glad to help out!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 4, "last_activity_date": 1566407024, "last_edit_date": 1566407024, "creation_date": 1566404540, "answer_id": 57595764, "question_id": 57595468, "link": "https://stackoverflow.com/questions/57595468/run-time-error-5-invalid-procedure-call-or-argument-when-updating-report-filt/57595764#57595764", "title": "Run-time error &#39;5&#39;: Invalid procedure call or argument when updating report filter through VBA", "body": "<p>In testing, something like this worked for me. I don't believe that <code>CurrentPage</code> expects a <code>Range</code> object. </p>\n\n<p>Note that you should declare the type for each variable, as already pointed out in the comments. Also, the <code>With...End With</code> block is not actually being used.</p>\n\n<pre><code>Sub test \n    Dim pt As PivotTable\n    Dim cp As Range, dep As Range\n    Dim Legx as PivotField, DepDtex As PivotField\n\n    Set pt = ActiveSheet.PivotTables(\"Main\")\n    Set cp = Sheets(\"LEGDETAILS\").Range(\"E3\")\n    Set dep = Sheets(\"LEGDETAILS\").Range(\"AX2\")\n    Set Legx = pt.PivotFields(\"Leg\")\n    Set DepDtex = pt.PivotFields(\"DepDte\")\n\n    Legx.CurrentPage = cp.Value\n    DepDtex.CurrentPage = dep.Value\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>No longer able to reproduce your error, seeing as this code is functionally equivalent to your original code, with the exception of declaring all variable types and adding the explicit <code>.Value</code> (which are all good improvements still).</p>\n\n<p><strong>EDIT 2:</strong>\nAble to reproduce your error, albeit sporadically, by not specifically adding the <code>.Value</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 7416754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d8b3f0935c5d39704a52ef03df7fca?s=128&d=identicon&r=PG&f=1", "display_name": "fedone", "link": "https://stackoverflow.com/users/7416754/fedone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57595764, "answer_count": 1, "score": 1, "last_activity_date": 1566407024, "creation_date": 1566403333, "question_id": 57595468, "link": "https://stackoverflow.com/questions/57595468/run-time-error-5-invalid-procedure-call-or-argument-when-updating-report-filt", "title": "Run-time error &#39;5&#39;: Invalid procedure call or argument when updating report filter through VBA", "body": "<p>I am facing the VBA error the subject of this post mention on the following code:</p>\n\n<pre><code>Sub test \nDim pt As PivotTable\nDim cp, dep As Variant\nDim Legx, DepDtex As PivotField\n\n    Set pt = ActiveSheet.PivotTables(\"Main\")\n    Set cp = Sheets(\"LEGDETAILS\").Range(\"E3\")\n    Set dep = Sheets(\"LEGDETAILS\").Range(\"AX2\")\n    Set Legx = pt.PivotFields(\"Leg\")\n    Set DepDtex = pt.PivotFields(\"DepDte\")\n\n    With pt\n    Legx.CurrentPage = cp\n    DepDtex.CurrentPage = dep\n    End With\n        End Sub\n</code></pre>\n\n<p>the error appears after \"with PT\".\nThe code should change 2 Report filters of the same pivot-table.\nCould you be so kind to explain me why the error and how to solve it? \nThank you</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1566399387, "post_id": 57594297, "comment_id": 101646088, "body": "Yes, <code>Selection.Type</code> is how to determine it."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566399509, "post_id": 57594297, "comment_id": 101646168, "body": "Ok. What is the purpose of <code>wdNoSelection</code>..? I have not been able to determine when this type becomes active."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1566399866, "post_id": 57594297, "comment_id": 101646359, "body": "I can&#39;t recall that I&#39;ve ever been able to trigger that one, either. There&#39;s this discussion that indicates it <i>can</i> happen: <a href=\"http://computer-programming-forum.com/1-vba/25604fea56504b16.htm\" rel=\"nofollow noreferrer\">computer-programming-forum.com/1-vba/25604fea56504b16.htm</a> The discussion leads one to think it can happen when Word is in a &quot;unstable state&quot; - it can&#39;t &quot;know&quot; where the selection is, at the particular moment the line executes."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566400196, "post_id": 57594297, "comment_id": 101646574, "body": "Ahhh. My experiences mirror those of the participants in that discussion. I tried a variety of similar ways to trigger, got it only once, and could not repeat it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566401005, "post_id": 57594297, "comment_id": 101647020, "body": "I &quot;know&quot; Steve Hudson (never met him, personally, but lots of contact years ago, on the newsgroups) and if he couldn&#39;t reproduced it reliably, then it can&#39;t be done reliably :-) A genius..."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566418263, "post_id": 57594297, "comment_id": 101654350, "body": "Sounds like he has one of those flashy swords like He-Man, lol."}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566399549, "creation_date": 1566399154, "last_edit_date": 1566399549, "question_id": 57594297, "link": "https://stackoverflow.com/questions/57594297/how-to-determine-if-text-is-selected-in-microsoft-word-vba", "title": "How to determine if text is selected in Microsoft Word VBA..?", "body": "<p>In Word VBA, I would like to know the proper method to determine if text is selected. I may have the answer (shown below), but I want to ask if it's correct.</p>\n\n<p>This is confusing, because most of the properties show no difference between <em>nothing</em> selected and <em>one character</em> selected. </p>\n\n<p>An obvious possibility is <code>If Selection.End - Selection.Start &gt; 0</code>, but this seems unnecessary. Is there not a specific property that is <code>True</code> or <code>False</code>..?</p>\n\n<p>I see the property <code>Selection.Type</code>, but the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdselectiontype\" rel=\"nofollow noreferrer\">documentation</a> is very thin and unhelpful. It does not explain any details, such as the definitions of Normal, Inline, Block or any of the others. And searching Google for these answers was not helpful.</p>\n\n<p>Through experimentation, I may have found the answer:</p>\n\n<ul>\n<li><code>Selection.Type=wdSelectionIP</code> seems to be when nothing is selected.</li>\n<li><code>Selection.Type=wdSelectionNormal</code> seems to be when any text is selected.</li>\n</ul>\n\n<p>Is this the correct &amp; reliable way to do it..?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1566398286, "post_id": 57593816, "comment_id": 101645481, "body": "If I am not wrong, you will need a reverse loop? <code>For i = Sheets.Count To 1 Step -1: For j = Sheets.Count To i Step -1</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566398492, "post_id": 57593816, "comment_id": 101645590, "body": "Plz do - or post your own and i&#39;ll delete mine lo;"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566400150, "post_id": 57593816, "comment_id": 101646539, "body": "you can also ignore empty cells by using the <code>Range.SpecialCells</code> method"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 4, "last_activity_date": 1566398515, "last_edit_date": 1566398515, "creation_date": 1566397289, "answer_id": 57593816, "question_id": 57593689, "link": "https://stackoverflow.com/questions/57593689/how-can-i-fix-this-excel-vba-code-to-ingore-empty-cells/57593816#57593816", "title": "How can I fix this Excel VBA code to ingore empty cells", "body": "<p>Add an <code>Else If</code> to test to see if the range is an empty string. If so, move it to the end. Also you need to use a reverse loop else you will miss worksheets.</p>\n\n<pre><code>Sub SortWksByCell()\n    Dim i As Long, j As Long\n\n    For i = Sheets.Count To 1 Step -1\n        For j = Sheets.Count To i Step -1\n            If UCase(Sheets(j).Range(\"A260\")) &lt; UCase(Sheets(i).Range(\"A260\")) Then\n                Sheets(j).Move before:=Sheets(i)\n            ElseIf Sheets(j).Range(\"A260\") = \"\" Then\n                Sheets(j).Move after:=Sheets(Sheets.Count)\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11957549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafcd46c8a91ee623aab92ffea2779e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rozz", "link": "https://stackoverflow.com/users/11957549/rozz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566398515, "creation_date": 1566396840, "last_edit_date": 1566397167, "question_id": 57593689, "link": "https://stackoverflow.com/questions/57593689/how-can-i-fix-this-excel-vba-code-to-ingore-empty-cells", "title": "How can I fix this Excel VBA code to ingore empty cells", "body": "<p>I use this to alphabetize my Excel worksheets by a cell. Can someone help me fix this code to ignore empty cells or sort them to the end?</p>\n\n<p>Here is the code i am using to do this but i don't know how to add a string to ingore the empty cells or put them at the end.</p>\n\n<pre><code>Sub SortWksByCell()\n    Dim i As Integer\n    Dim j As Integer\n\n    For i = 1 To Worksheets.Count\n        For j = i To Worksheets.Count\n            If UCase(Worksheets(j).Range(\"A260\")) &lt; _\n              UCase(Worksheets(i).Range(\"A260\")) Then\n                Worksheets(j).Move before:=Worksheets(i)\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>it puts all the worksheet with empty <code>A260</code> range at the first of the sort i want it at the last</p>\n"}, {"tags": ["excel", "vba", "ms-word", "pdf-generation"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "is_accepted": false, "score": 0, "last_activity_date": 1566397223, "creation_date": 1566397223, "answer_id": 57593795, "question_id": 57593602, "link": "https://stackoverflow.com/questions/57593602/creating-a-pdf-from-a-word-with-excel-document-exportasfixedformat-not-creating/57593795#57593795", "title": "Creating a pdf from a Word with excel: document.exportasfixedformat not creating the extension of the file", "body": "<p>The line</p>\n\n<p>.InitialFileName = nom_complet</p>\n\n<p>Contains the variable \"nom_complet\".  That variable needs to ends with \".pdf\".  Although it's a pdf type the name of the file, if passed as a variable in the \".initialFileName\" , must ends with \".pdf\".</p>\n\n<p>Okay, it was obvious, but maybe someone else will run into this problem, so I'll leave the answer here.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11957586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5879155506a8b47c0d920e3c9eb9926?s=128&d=identicon&r=PG&f=1", "display_name": "kubakuba", "link": "https://stackoverflow.com/users/11957586/kubakuba"}, "is_accepted": false, "score": 0, "last_activity_date": 1566397481, "creation_date": 1566397481, "answer_id": 57593884, "question_id": 57593602, "link": "https://stackoverflow.com/questions/57593602/creating-a-pdf-from-a-word-with-excel-document-exportasfixedformat-not-creating/57593884#57593884", "title": "Creating a pdf from a Word with excel: document.exportasfixedformat not creating the extension of the file", "body": "<p>add .pdf as a suffix to your filename and enclose in speech marks ie -</p>\n\n<p>OutputFileName:=\"nom_complet.pdf\"</p>\n\n<p>your code amended below:</p>\n\n<pre><code>Dim saved_successfull As Boolean\nsaved_successfull = False\nDim fenetre_saveas As Object\nSet fenetre_saveas = Application.FileDialog(msoFileDialogSaveAs)\n\nWith fenetre_saveas                     'save as pdf\n  .InitialFileName = nom_complet\n  .Title = \"Confirmer le r\u00e9pertoire o\u00f9 le pdf sera sauvegard\u00e9\"\n  .InitialView = msoFileDialogViewList\n  .FilterIndex = 25\n  If .Show &lt;&gt; 0 Then\n    worddoc.ExportAsFixedFormat _\n    OutputFileName:=\"nom_complet.pdf\", _\n    ExportFormat:=wdExportFormatPDF, Openafterexport:=False\n    saved_successfull = True\n  End If\nEnd With\n\nIf saved_successfull = True Then\n    worddoc.Close savechanges:=False                                    'fermeture du doc word\n    WordApp.Quit\n    MsgBox (\"Saved successfull\")\n    Exit Sub\nElse\n    MsgBox (\"Couldn't convert in pdf\")\nEnd If\n\nExit Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3945849, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7833ac512170914014b5022f877dd94a?s=128&d=identicon&r=PG&f=1", "display_name": "excelguigui11", "link": "https://stackoverflow.com/users/3945849/excelguigui11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566397481, "creation_date": 1566396551, "question_id": 57593602, "link": "https://stackoverflow.com/questions/57593602/creating-a-pdf-from-a-word-with-excel-document-exportasfixedformat-not-creating", "title": "Creating a pdf from a Word with excel: document.exportasfixedformat not creating the extension of the file", "body": "<p>I'm using Excel vba, to modify a Word document and then save it as a pdf.  It runs smoothly, and it will create a pdf file, but it won't create the extension. So basically the problem is that the file is not recognize as a pdf (the icon is not a pdf icon)  and on open, it will ask for the application to use to open the file. On Windows explorer under \"extension\"  for this file there's a blank.<br>\nThe portion of the code used to convert to pdf is:</p>\n\n<pre><code>Dim saved_successfull As Boolean\nsaved_successfull = False\nDim fenetre_saveas As Object\nSet fenetre_saveas = Application.FileDialog(msoFileDialogSaveAs)\n\nWith fenetre_saveas                     'save as pdf\n  .InitialFileName = nom_complet\n  .Title = \"Confirmer le r\u00e9pertoire o\u00f9 le pdf sera sauvegard\u00e9\"\n  .InitialView = msoFileDialogViewList\n  .FilterIndex = 25\n  If .Show &lt;&gt; 0 Then\n    worddoc.ExportAsFixedFormat _\n    OutputFileName:=nom_complet, _\n    ExportFormat:=wdExportFormatPDF, Openafterexport:=False\n    saved_successfull = True\n  End If\nEnd With\n\nIf saved_successfull = True Then\n    worddoc.Close savechanges:=False                                    'fermeture du doc word\n    WordApp.Quit\n    MsgBox (\"Saved successfull\")\n    Exit Sub\nElse\n    MsgBox (\"Couldn't convert in pdf\")\nEnd If\n\nExit Sub\n</code></pre>\n\n<p>So basically there's no error message generated.  I get the message box (\"Saved succesfull\"), the file is saved at the desired path with the right name.  But the extension of the file is not there.<br>\nSo it's a pdf but it won't be automatically recognize as one.  If I use a pdf reader to open it, it will be read.\nAny ideas, what am I missing?<br>\nThank you very much in advance.</p>\n"}, {"tags": ["excel", "vba", "autocad"], "answers": [{"comments": [{"owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "edited": false, "score": 0, "creation_date": 1566404536, "post_id": 57595704, "comment_id": 101648723, "body": "you should also declare grpCode(0) as String in your code. Use the following code <code>Dim grpCode(0) as String</code>"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "edited": false, "score": 0, "creation_date": 1566424523, "post_id": 57595704, "comment_id": 101656438, "body": "@Gangula <code>grpCode(0)</code> is correctly declared as an array containing integer values."}], "tags": [], "owner": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1566404229, "creation_date": 1566404229, "answer_id": 57595704, "question_id": 57593476, "link": "https://stackoverflow.com/questions/57593476/vba-filter-more-than-one-autocad-block/57595704#57595704", "title": "VBA - filter more than one AutoCAD block", "body": "<p>found it, really simple</p>\n\n<pre><code>grpValue(0) = \"testBlock1,testBlock2,testBlock3\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "edited": false, "score": 1, "creation_date": 1566464820, "post_id": 57599682, "comment_id": 101667319, "body": "woah, answered by Lee Mac himself :D  Thanks for the [123] tip, may come in handy"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1566425038, "creation_date": 1566425038, "answer_id": 57599682, "question_id": 57593476, "link": "https://stackoverflow.com/questions/57593476/vba-filter-more-than-one-autocad-block/57599682#57599682", "title": "VBA - filter more than one AutoCAD block", "body": "<p>You can approach this in one of two ways:</p>\n\n<h3>1. Wildcard Operators</h3>\n\n<p>You can exploit the fact that the filter list argument for the <code>Select</code> method will accept <a href=\"https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-ActiveX/files/GUID-E9CDCF5E-0E9F-4072-8A1D-099764B0A19E-htm.html\" rel=\"nofollow noreferrer\">wildcard operators</a> when comparing string values, and therefore, you can use the comma (<code>,</code>) to separate each \"pattern\", e.g.:</p>\n\n<pre><code>grpValue(0) = \"testBlock1,testBlock2,testBlock3\"\n</code></pre>\n\n<p>Or, if your block names genuinely adhere to the above naming convention, you could use the following equivalent wildcard pattern:</p>\n\n<pre><code>grpValue(0) = \"testBlock[123]\"\n</code></pre>\n\n<h3>2. Logical Operators</h3>\n\n<p>Alternatively, you can use the <a href=\"https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-ActiveX/files/GUID-A1A6DB80-A730-45D1-B035-331F549E9667-htm.html\" rel=\"nofollow noreferrer\">logical operators</a> <code>&lt;OR</code> and <code>OR&gt;</code> to implement <code>OR</code> logic between multiple DXF group 2 entries in the filter list, e.g.:</p>\n\n<pre><code>grpCode(0) = -4\ngrpValue(0) = \"&lt;OR\"\nDim i As Integer: i = 1\nDim b\nFor Each b In Split(\"testBlock1 testBlock2 testBlock3\")\n    grpCode(i) = 2\n    grpValue(i) = b\n    i = i + 1\nNext b\ngrpCode(i) = -4\ngrpValue(i) = \"OR&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 57599682, "answer_count": 2, "score": 1, "last_activity_date": 1566425038, "creation_date": 1566396147, "question_id": 57593476, "link": "https://stackoverflow.com/questions/57593476/vba-filter-more-than-one-autocad-block", "title": "VBA - filter more than one AutoCAD block", "body": "<p>I have recently started coding VBA and I have question about an example I found online. \nthe following example is for filtering an AutoCAD block by name.</p>\n\n<p>What do I do if I wish to insert more that one type of block to the selection?</p>\n\n<p>Any help would be deeply apreciated</p>\n\n<p>I have tried </p>\n\n<pre><code>grpValue(0) = \"testBlock1\" &amp; \"testBlock2\" &amp; \"testBlock3\"\n</code></pre>\n\n<p>but to no avail. </p>\n\n<p>The example:</p>\n\n<pre><code>\n   Dim sset As AcadSelectionSet \n   Set sset = ThisDrawing.SelectionSets.Add(\"TestSet2\") \n\n   Dim filterType As Variant \n   Dim filterData As Variant \n   Dim p1(0 To 2) As Double \n   Dim p2(0 To 2) As Double \n\n   Dim grpCode(0) As Integer \n   grpCode(0) = 2 \n   filterType = grpCode \n   Dim grpValue(0) As Variant \n   grpValue(0) = \"testBlock\" \n   filterData = grpValue \n\n   sset.Select acSelectionSetAll, p1, p2, filterType, filterData \n\n   Debug.Print \"Entities: \" &amp; str(sset.count) \n\n   sset.Delete \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "variables", "range"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566396430, "post_id": 57593434, "comment_id": 101644532, "body": "You can do this with a <code>Select Case</code>, or a bunch of other ways really"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566397883, "post_id": 57593434, "comment_id": 101645303, "body": "You don&#39;t normally include the <code>&quot;Sheet2!&quot;</code> part in the address string, because you qualify <code>Range</code> with a <code>Worksheet</code> object - e.g. <code>mySheet.Range(&quot;A2:A3&quot;)</code>. Use logic to determine what worksheet object to use - keeping <code>Range</code> unqualified and parameterizing it with a sheet name in the address string is asking for trouble IMO."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1566806449, "post_id": 57593434, "comment_id": 101757690, "body": "If you received a valid answer, please mark it accordingly"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1566397319, "last_edit_date": 1566397319, "creation_date": 1566396712, "answer_id": 57593650, "question_id": 57593434, "link": "https://stackoverflow.com/questions/57593434/is-there-a-way-to-change-vba-range-declarations-based-on-user-input/57593650#57593650", "title": "Is there a way to change vba range declarations based on user input?", "body": "<p>You can use <code>Application.InputBox()</code> to ask the user to select a range:  </p>\n\n<pre><code>Dim r As Range, ws as worksheet\nSet r = Application.InputBox(\"Pls select a range\", , , , , , , 8)\nSet ws = r.Parent\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1566396720, "creation_date": 1566396720, "answer_id": 57593651, "question_id": 57593434, "link": "https://stackoverflow.com/questions/57593434/is-there-a-way-to-change-vba-range-declarations-based-on-user-input/57593651#57593651", "title": "Is there a way to change vba range declarations based on user input?", "body": "<p>Depending on how many values will be available in your drop down you have, <code>Select Case</code> may be a clean way to assign user input to some sheet. If you have a lot, this option becomes less flattering. </p>\n\n<p>I'm assuming that <code>Sheet(\"Sheet?\").Range(\"A1\")</code> is where the value of your drop down box will be. You can also have this fire automatically when that cell changes, but idk if that is applicable here</p>\n\n<hr>\n\n<pre><code>Sub Jeeped()\n\nDim Version As String\nDim Bank As String\n\nVersion = Sheet(\"Sheet?\").Range(\"A1\")\n\nSelect Case Version\n    Case \"Version 1\"\n        Bank = \"Sheet1\"\n    Case \"Version 2\"\n        Bank = \"Sheet2\"\n    Case \"Version 3\"\n        Bank = \"Sheet3\"\n    Case Else\n        Exit Sub\nEnd Select\n\nFor Each Ans In Sheets(Bank).Range(\"A2:A3\")\n    '......\n    '......\nNext Ans\n\nEnd Sub\n</code></pre>\n\n<p><em>I can also see an array of versions mapped to arrays working here as well as a simple <code>VLOOKUP</code></em></p>\n"}], "owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 57593651, "answer_count": 2, "score": 0, "last_activity_date": 1566397319, "creation_date": 1566396003, "last_edit_date": 1566396277, "question_id": 57593434, "link": "https://stackoverflow.com/questions/57593434/is-there-a-way-to-change-vba-range-declarations-based-on-user-input", "title": "Is there a way to change vba range declarations based on user input?", "body": "<p>I have built an auto grading utility for the school I work for. I am working to build the various versions of our tests. I wanted to know if instead of writing new functions for each question pointing to specific ranges in my answer key, I could have the first portion of the range declaration change based on a drop down from my GUI sheet. example below</p>\n\n<pre><code>Function q1(i as range) as Integer\n''''For each ans in range.(\"Sheet2!A2:A3\").cells \n\n'is there a way to make the Sheet2! portion a variable that I can change based on user input???\n\n''''''''if (userinput.Value = ans.Value) then\n\n''''''''''''j = j + 1 and so on\n</code></pre>\n\n<p>I would hope that the user could pick version 1 and the value of my variable would change to \"Sheet2!A2:A3\" (I only want the Sheet2! portion to change, not the cell references)</p>\n\n<p>Any help is greatly appreciated :D</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566395900, "post_id": 57593306, "comment_id": 101644189, "body": "what line throws the error?"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566395949, "post_id": 57593306, "comment_id": 101644229, "body": "@MilesFett If dateB = dateA + 1 Then"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11956836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDwwKSky2sCx5kjNzr98UVIJ_jFv5HD7sr58dX9MQ=k-s128", "display_name": "Scarovese", "link": "https://stackoverflow.com/users/11956836/scarovese"}, "is_accepted": false, "score": 1, "last_activity_date": 1566396291, "creation_date": 1566396291, "answer_id": 57593523, "question_id": 57593306, "link": "https://stackoverflow.com/questions/57593306/compare-date-values-between-cells/57593523#57593523", "title": "Compare date values between cells", "body": "<p>You are declaring dateA and dateB as strings and then trying to add a value to them and compare them, this won't work. Instead, try declaring them as dates:</p>\n\n<pre><code>Dim dateA As Date\nDim dateB As Date\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1566999324, "last_edit_date": 1566999324, "creation_date": 1566398076, "answer_id": 57593997, "question_id": 57593306, "link": "https://stackoverflow.com/questions/57593306/compare-date-values-between-cells/57593997#57593997", "title": "Compare date values between cells", "body": "<p>First declare your dates as Date. Try using the DateAdd Function. Trying to Add <code>1</code> to a string or a date isn't going to find what you're looking for. </p>\n\n<p>Here's an example:</p>\n\n<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim dateA As Date\nDim dateB As Date\n\n\nSet wbkA = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\2G.xlsx\")\nSet varSheetA = wbkA.Worksheets(\"2G Data\")\n\nSet wbkB = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\2G Data Traffic.xlsx\")\nSet varSheetB = wbkB.Worksheets(\"Sheet1\")\n\ndateA = wbkA.Worksheets(\"2G Data\").Range(\"A\" &amp; Rows.Count).End(xlUp)\ndateB = wbkB.Worksheets(\"Sheet1\").Range(\"A9\")\n\n    If dateB = DateAdd(\"d\", 1, dateA) Then\n        MsgBox \"good\"\n    Else\n        MsgBox \"badd\"\n        Exit Sub\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566999324, "creation_date": 1566395612, "last_edit_date": 1566396711, "question_id": 57593306, "link": "https://stackoverflow.com/questions/57593306/compare-date-values-between-cells", "title": "Compare date values between cells", "body": "<ul>\n<li>I'm trying to compare cell dates between two workbooks (the last cell in column A for wbkA, and cell A9 for wbkB). </li>\n<li>Display \"good\" if date for wbkB is = wbkA-1</li>\n<li>Format of cells containing date: 08/13/2019 00:00:00</li>\n<li>the script seems to find the date but I get a type mismatch error when it runs. What am I doing wrong?</li>\n</ul>\n\n<p>Below is the scrip:</p>\n\n<pre><code>Sub CompareWorkbooks()\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim dateA As String\nDim dateB As String\n\n\nSet wbkA = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\2G.xlsx\")\nSet varSheetA = wbkA.Worksheets(\"2G Data\")\n\nSet wbkB = Workbooks.Open(Filename:=\"C:\\Users\\xxx\\2G Data Traffic.xlsx\")\nSet varSheetB = wbkB.Worksheets(\"Sheet1\")\n\ndateA = wbkA.Worksheets(\"2G Data\").Range(\"A\" &amp; Rows.Count).End(xlUp)\ndateB = wbkB.Worksheets(\"Sheet1\").Range(\"A9\")\n\nIf dateB = dateA + 1 Then\nMsgBox \"good\"\nElse\nMsgBox \"badd\"\nExit Sub\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "out-of-memory", "shapes"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566395400, "post_id": 57593125, "comment_id": 101643829, "body": "What happens when you add <code>DoEvents</code> after <code>temp = CDKSmilesImageToClipboard(SMILES, 150, 115)</code> and after <code>Sheets(&quot;Table&quot;).Paste Destination:=Sheets(&quot;Table&quot;).Cells(i, 7)</code>?"}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566396237, "post_id": 57593125, "comment_id": 101644422, "body": "Thank you Siddharth, it does make the 35 list work! But not when I add the list size to 500. n"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566396331, "post_id": 57593125, "comment_id": 101644475, "body": "Then you need to share what <code>CDKSmilesImageToClipboard(SMILES, 150, 115)</code> does. The thing is, we need to give excel enough time to process things. We can do that by using <code>DoEvents</code> at necessary places..."}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566396552, "post_id": 57593125, "comment_id": 101644611, "body": "Thanks again, I&#39;ll dig for that function but it&#39;s from an external library... Thanks!"}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566399090, "post_id": 57593125, "comment_id": 101645920, "body": "What&#39;s so perplexing about this for me is that it throws the error at different points each time. How can it make it to shape 100 one iteration, 12 the next iteration, 47 the next iteration when everything is exactly the same?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566399288, "post_id": 57593125, "comment_id": 101646041, "body": "The code may be the same but there is lot of things happening in the background. I need to see specifically how is the image being stored in the clipboard. Any chance I can see the code for <code>CDKSmilesImageToClipboard</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566399436, "post_id": 57593125, "comment_id": 101646116, "body": "Are you shelling out to CDK to produce your images?  That&#39;s likely the issue here - timing can be a problem when you leave the immediate VBA environment.  Also if you&#39;re willing to share that Sub I&#39;d be interested to see how you do that..."}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1566402478, "post_id": 57593125, "comment_id": 101647798, "body": "Hi Tim, yes I am using the CDK API to draw the images. I&#39;ve been trying to find where the code is for the sub, it links to a DLL I installed on my computer called cdkInterfaceDll.dll but I cant find the function on github. I have updated the way I call the function in my code above. Hope this helps, sorry I cannot provide the explicit code of the CDK sub. If I find it I will provide it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566404693, "post_id": 57593125, "comment_id": 101648792, "body": "Do you have the GitHub link?"}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1566404967, "post_id": 57593125, "comment_id": 101648942, "body": "Sure <a href=\"https://github.com/cdk/cdk\" rel=\"nofollow noreferrer\">github.com/cdk/cdk</a> I&#39;m very unfamiliar with this depth of code, thank you for helping. Happy to help you any way I can."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566450413, "post_id": 57593125, "comment_id": 101661204, "body": "Thanks I will find some time for that - a bit more involved though..."}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1566480488, "post_id": 57593125, "comment_id": 101676217, "body": "Very much appreciated Tim, thank you!"}, {"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1567088048, "post_id": 57593125, "comment_id": 101866430, "body": "So I did some more digging. I &#39;think&#39; this is the Java code for the relevant ImageToClipboard: <a href=\"https://github.com/CDK-R/cdkr/blob/master/rcdkjar/src/org/guha/rcdk/view/MoleculeImageToClipboard.java\" rel=\"nofollow noreferrer\">github.com/CDK-R/cdkr/blob/master/rcdkjar/src/org/guha/rcdk/&zwnj;&#8203;&hellip;</a>    Im trying to use VBA.CreateObject(&quot;WScript.Shell&quot;) and run with wait on return option active. The issue I run into is that I dont know where the code really is, and its not a *.exe (I&#39;m very unfamiliar with this code)"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "is_accepted": true, "score": 0, "last_activity_date": 1567519541, "creation_date": 1567519541, "answer_id": 57773400, "question_id": 57593125, "link": "https://stackoverflow.com/questions/57593125/excel-vba-error-400-when-sub-is-ran-but-no-error-in-debug-step-through/57773400#57773400", "title": "Excel VBA Error 400 when sub is ran, but no error in debug step through?", "body": "<p>I was able to create a, less than 100% ideal, workaround for the problem I was having. It's posted below for completeness and for reference in the future.</p>\n\n<p>Adding the error handling structure below, I was able to prevent the sub from crashing or skipping error draws (would draw a blank pic when I used On Error Resume Next).</p>\n\n<pre><code>Declare Function CDKSmilesImageToClipboard Lib \"cdkInterfaceDll.dll\" Alias \"_smilesToClipboardCdkInterfaceDll@12\" (ByVal smiles As String, ByVal width As Long, ByVal height As Long) As Long\n\nDim i As Integer, LastRow As Long, SMILES As String, temp As Long\n\nFor i = 6 To LastRow\nReDo:\n    On Error GoTo ErrCatch\n    SMILES = Sheets(\"Table\").Cells(i, 7).Value2\n    temp = CDKSmilesImageToClipboard(SMILES, 150, 115)\nErrCatch:\n    If Err.Number &lt;&gt; 0 Then\n        On Error GoTo -1   'Resets the Err Catcher\n        On Error GoTo ErrCatch   'Recalibrates the Err Catcher\n        GoTo ReDo    'Redoes the image draw/paste\n    End If\n    Sheets(\"Table\").Paste Destination:=Sheets(\"Table\").Cells(i, 7)\n    DoEvents\n    Sheets(\"Table\").Shapes(Sheets(\"Table\").Shapes.Count).Name = \"Structure \" &amp; i\n    Sheets(\"Table\").Cells(i, 2).Value2 = \"Structure \" &amp; i\nNext i\n</code></pre>\n\n<p>Adding the error handling prevents the 400 errors by redoing the draw/paste loop. I wish I could directly prevent the error from occurring in the first place, but this results in an acceptable outcome 100% of the time :) Thanks guys for your help!</p>\n"}], "owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 57773400, "answer_count": 1, "score": 0, "last_activity_date": 1567519541, "creation_date": 1566395098, "last_edit_date": 1566402368, "question_id": 57593125, "link": "https://stackoverflow.com/questions/57593125/excel-vba-error-400-when-sub-is-ran-but-no-error-in-debug-step-through", "title": "Excel VBA Error 400 when sub is ran, but no error in debug step through?", "body": "<p>This is more of a thought question, I have a sub that draws pictures and saves them as a shape object in an excel workbook. It usually handles less than 15 or so shapes well, but when I start to get above 15 it throws error 400, presumably out of memory? Other times I have had over 300 work fine.</p>\n\n<p>I have a list of 35 shapes I needed to draw, I tried it three times each time it crashed so I stepped through the code line by line. What baffled me was that stepping through allowed the program to draw every shape and not crash out like it had the past three times. I'm at a loss why this works in debug mode but not in 'normal' run mode.</p>\n\n<pre><code>Declare Function CDKSmilesImageToClipboard Lib \"cdkInterfaceDll.dll\" Alias \"_smilesToClipboardCdkInterfaceDll@12\" (ByVal smiles As String, ByVal width As Long, ByVal height As Long) As Long\n\nDim i As Integer, LastRow As Long, SMILES As String, temp As Long\n\nFor i = 6 To LastRow\n    SMILES = Sheets(\"Table\").Cells(i, 7).Value2\n    temp = CDKSmilesImageToClipboard(SMILES, 150, 115)\n    Sheets(\"Table\").Paste Destination:=Sheets(\"Table\").Cells(i, 7)\n    Sheets(\"Table\").Shapes(Sheets(\"Table\").Shapes.Count).Name = \"Structure \" &amp; i\n    Sheets(\"Table\").Cells(i, 2).Value2 = \"Structure \" &amp; i\nNext i\n</code></pre>\n\n<p>I expect the error that is occurring at run-time should also occur when I step through the code. But its not. The 400 error is as equivocal as can be, so I'm not even sure its an OOM error. So I'm turning to the Stack for guidance. Has anyone ever seen this before? Is there anything I can add to my code to slow down or walk through the shape drawing?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566395139, "post_id": 57592892, "comment_id": 101643636, "body": "change your last line to <code>dateVariable = dateVariable.Text</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566396576, "post_id": 57592892, "comment_id": 101644626, "body": "When having problems with code, it&#39;s important to mention the <b>error messages</b> and <b>which line</b> triggers what message. It&#39;s also important to think about what a variable (<code>dateVariable</code>) should contain. That means to explicilty <code>Dim As</code>, not leaving it up to chance. The sample code first assigns a <code>Date</code> to the variable, then it tries to set it to a <code>Range</code> object. It&#39;s not possible for both to be the case. For the code in the question <b>two</b> variables are needed: one for the date, the other for the <code>Range</code>. <i>Then</i> you can assign the one to the other."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11957053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60aefc8d8d5dcf609e0620636caf03a2?s=128&d=identicon&r=PG&f=1", "display_name": "Small.Fish", "link": "https://stackoverflow.com/users/11957053/small-fish"}, "is_accepted": true, "score": 0, "last_activity_date": 1566837635, "creation_date": 1566837635, "answer_id": 57661829, "question_id": 57592892, "link": "https://stackoverflow.com/questions/57592892/how-to-convert-from-date-object-into-a-range-to-display-at-bookmark-in-word-vba/57661829#57661829", "title": "How to Convert from Date Object into a Range to Display at Bookmark in Word VBA?", "body": "<p>So I did some searching on the net, and I came up with a solution.  Cindy Meister was right that I need to declare some objects into existence.  I didn't realized that the bookmark object \"bmkDate\" needed to come into existence as well. </p>\n\n<pre><code>Sub TodayDate()\nDim bmkDate As Bookmark\n\nSet bmkDate = ActiveDocument.Bookmarks(\"Date\")\nbmkDate.Range.Text = Date\n</code></pre>\n\n<p>Things to note: First, thank you Miles Flatt for your input. What I found that works for me is that \"Date\" is an actual posted/inserted bookmark within the Word document; the today variable Date is in the default format, so it will display mm/dd/yyyy at the location; and finally, the modifier/suffixes .Range.Text is what really helped. The Range.Text returns or sets the text in the specified range or selection. </p>\n"}], "owner": {"reputation": 3, "user_id": 11957053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60aefc8d8d5dcf609e0620636caf03a2?s=128&d=identicon&r=PG&f=1", "display_name": "Small.Fish", "link": "https://stackoverflow.com/users/11957053/small-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57661829, "answer_count": 1, "score": 0, "last_activity_date": 1566837635, "creation_date": 1566394390, "last_edit_date": 1566396175, "question_id": 57592892, "link": "https://stackoverflow.com/questions/57592892/how-to-convert-from-date-object-into-a-range-to-display-at-bookmark-in-word-vba", "title": "How to Convert from Date Object into a Range to Display at Bookmark in Word VBA?", "body": "<p>Context:  I am trying to create a document to where the document prompts the user for information.  Right now, I just trying to understand the reason I cannot get the date turned into a range to be able to display at the bookmark. </p>\n\n<p>I have tried creating different types of objects to associate with Date but I just do not understand the reason I am getting a compile error. </p>\n\n<pre><code>Sub TodayDate()\n\nDim dateVariable \ndateVariable = Date\n\nSet dateVariable = ActiveDocument.Bookmarks(\"bmkTodayDate\").Range\ndateVariable.Text = dateVariable.value\n</code></pre>\n\n<p>I am wanting to display the date at the posted bookmark location (\"bmkTodayDate\"), but I keep getting error messages.  What is the correct object or the correct code that I should have used?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566394610, "post_id": 57592841, "comment_id": 101643285, "body": "You can refer to a Named Range, exactly the same way as a cell . <code>Range(&quot;D7&quot;)</code> would be <code>Range(&quot;Name&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 11957335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0280750c9b33d36e6c02ed9ec84cbb?s=128&d=identicon&r=PG&f=1", "display_name": "AIA", "link": "https://stackoverflow.com/users/11957335/aia"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566394826, "post_id": 57592841, "comment_id": 101643428, "body": "Unfortunately when I replace the file path with a named range, it doesn&#39;t work - I am wondering if this is because it&#39;s a file path it is trying to pick up?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566394869, "post_id": 57592841, "comment_id": 101643452, "body": "No that can&#39;t be the case. Something else must be the problem"}, {"owner": {"reputation": 1, "user_id": 11957335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0280750c9b33d36e6c02ed9ec84cbb?s=128&d=identicon&r=PG&f=1", "display_name": "AIA", "link": "https://stackoverflow.com/users/11957335/aia"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566395156, "post_id": 57592841, "comment_id": 101643648, "body": "Below is the full code - do you (or anyone else) think you could help on how to incorporate the file path as a named range instead?"}, {"owner": {"reputation": 1, "user_id": 11957335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0280750c9b33d36e6c02ed9ec84cbb?s=128&d=identicon&r=PG&f=1", "display_name": "AIA", "link": "https://stackoverflow.com/users/11957335/aia"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566395162, "post_id": 57592841, "comment_id": 101643651, "body": "Sub Extract() &#39;Specify workbook, sheet and range to copy from  Workbooks(&quot;201819 MASTER Consol Tool AA TEST.xlsb&quot;).Sheets(&quot;Summary&quot;).Range(&quot;K1&quot;).Copy               &#39;Specify workbook, sheet and range to copy into                 Workbooks(&quot;Macro.xlsm&quot;).Sheets(&quot;Key info&quot;).Range(&quot;D9&quot;).PasteSpecial xlPasteValues End Sub"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566395204, "post_id": 57592841, "comment_id": 101643687, "body": "Add it in the Question. It&#39;s not readable in a Comment"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566395327, "post_id": 57592841, "comment_id": 101643771, "body": "you want to read this <code>201819 MASTER Consol Tool AA TEST.xlsb</code> from a cell  ?"}, {"owner": {"reputation": 1, "user_id": 11957335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0280750c9b33d36e6c02ed9ec84cbb?s=128&d=identicon&r=PG&f=1", "display_name": "AIA", "link": "https://stackoverflow.com/users/11957335/aia"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566395513, "post_id": 57592841, "comment_id": 101643911, "body": "Yeah - so I have tried adding in a cell reference or a named range, but it says &quot;Run time error 9, subscript out of range&quot; even though the named range is the exact same as the file path that is above."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1566396216, "creation_date": 1566396216, "answer_id": 57593496, "question_id": 57592841, "link": "https://stackoverflow.com/questions/57592841/how-to-refer-to-a-filepath-that-is-a-named-range-in-a-cell-in-a-macro-code/57593496#57593496", "title": "How to refer to a filepath that is a named range in a cell in a macro code?", "body": "<p><strong>See this way you can refer to a Named Range.</strong></p>\n\n<pre><code>Range(\"name\").Value\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/iO9lD.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iO9lD.gif\" alt=\"enter image description here\"></a></p>\n\n<p><strong>So your line:</strong></p>\n\n<pre><code>Workbooks(\"201819 MASTER Consol Tool AA TEST.xlsb\").Sheets(\"Summary\").Range(\"I1\").Copy\n</code></pre>\n\n<p><strong>Will Become:</strong></p>\n\n<pre><code>Workbooks(Range(\"name\").Value).Sheets(\"Summary\").Range(\"I1\").Copy\n</code></pre>\n\n<p>if you use the named range</p>\n"}], "owner": {"reputation": 1, "user_id": 11957335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0280750c9b33d36e6c02ed9ec84cbb?s=128&d=identicon&r=PG&f=1", "display_name": "AIA", "link": "https://stackoverflow.com/users/11957335/aia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566396700, "creation_date": 1566394225, "last_edit_date": 1566396700, "question_id": 57592841, "link": "https://stackoverflow.com/questions/57592841/how-to-refer-to-a-filepath-that-is-a-named-range-in-a-cell-in-a-macro-code", "title": "How to refer to a filepath that is a named range in a cell in a macro code?", "body": "<p>I am wondering if anyone knows how to correctly reference a named ranged that contains a file path to a workbook? I am wanting to refer to a named range as the filepath will change often, and I don't want to manually keep changing the code. </p>\n\n<p>'Number of CCGs yet to have data:</p>\n\n<pre><code>    'Specify workbook, sheet and range to copy from\n            Workbooks(\"201819 MASTER Consol Tool AA TEST.xlsb\").Sheets(\"Summary\").Range(\"I1\").Copy\n\n        'Specify workbook, sheet and range to copy into\n         Workbooks(\"Macro.xlsm\").Sheets(\"Key info\").Range(\"D7\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>So instead of providing the hard coded file path, I'd like to refer to a named range in the current workbook.</p>\n\n<p>The named range for the first file path is: Consol\nThe named range for the second file path is: Current</p>\n\n<p>Any help will be much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566395831, "post_id": 57592645, "comment_id": 101644132, "body": "You have <code>x</code> elements and you are again redimming to <code>x</code>? If the two x&#39;s are different then <code>msgbox exp2(x) - this message shows 0</code> will show <code>0</code> because after <code>Redim preserve exp2(0 to x)</code>, you have to store the value at <code>x</code> position to fetch it&#39;s value?"}, {"owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566399896, "post_id": 57592645, "comment_id": 101646375, "body": "Jen i dont redim, i get VBA error 9 (subscript i guess). For me it looks like that when calling sub2 procedure, the variable loses its scope."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "edited": false, "score": 0, "creation_date": 1566395814, "post_id": 57592870, "comment_id": 101644127, "body": "Yeah, thats exactly what I need. The ONLY diference from my code And yours Is that you use redim preserve in hh1 And I use just redim."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "edited": false, "score": 0, "creation_date": 1566396040, "post_id": 57592870, "comment_id": 101644297, "body": "I think in hh1 you can use Redim also. Won&#39;t make a Difference"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "edited": false, "score": 0, "creation_date": 1566396330, "post_id": 57592870, "comment_id": 101644472, "body": "@Sniper_of_Chess .. Remove the Preserve from 1st Sub and it will still work. :)"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1566396301, "last_edit_date": 1566396301, "creation_date": 1566394293, "answer_id": 57592870, "question_id": 57592645, "link": "https://stackoverflow.com/questions/57592645/element-of-array-doesnt-pass-into-another-sub/57592870#57592870", "title": "element of array doesnt pass into another sub", "body": "<p><strong>Are you trying to achieve something like this ?</strong></p>\n\n<ul>\n<li>Here you can access the originally assigned values in the other Sub.</li>\n</ul>\n\n<hr>\n\n<pre><code>Private exp2() As Double\nPrivate Sub hh()\n\nReDim exp2(0 To 1)\n\n    exp2(0) = 1    \n    MsgBox exp2(0) ' Prints 1\n\n    hh2\n\nEnd Sub\n\nPrivate Sub hh2()\nReDim Preserve exp2(0 To 2)\nMsgBox exp2(0) ' also prints 1\nEnd Sub\n</code></pre>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/HtrJF.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HtrJF.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "edited": false, "score": 0, "creation_date": 1566396156, "post_id": 57592957, "comment_id": 101644372, "body": "Indexing Is correct in my case. What really confuses me Is that first message box shows correct numbers And then next msgbox which Is called right after the first ( but in sub2) shows 0. ( In sub2 before msgbox there Is some variable declarations but nothing in relation with exp2() )"}], "tags": [], "owner": {"reputation": 11, "user_id": 11956836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDwwKSky2sCx5kjNzr98UVIJ_jFv5HD7sr58dX9MQ=k-s128", "display_name": "Scarovese", "link": "https://stackoverflow.com/users/11956836/scarovese"}, "is_accepted": false, "score": 0, "last_activity_date": 1566396437, "last_edit_date": 1566396437, "creation_date": 1566394598, "answer_id": 57592957, "question_id": 57592645, "link": "https://stackoverflow.com/questions/57592645/element-of-array-doesnt-pass-into-another-sub/57592957#57592957", "title": "element of array doesnt pass into another sub", "body": "<p>I think the answer really depends on what's happening in your \"//'some code which fills array exp2()\" section. I tested this out as follows and it worked fine:</p>\n\n<pre><code>Private exp2() As Double 'declaration of module array variable\nPrivate Sub sub1()\nReDim exp2(1 To 2)\nexp2(1) = 2\nexp2(2) = 4\nMsgBox exp2(2) '- this message box shows correct information stored in variable exp2(x)\nsub2\nEnd Sub\nPrivate Sub sub2()\nReDim Preserve exp2(1 To 3)\nMsgBox exp2(2)\nEnd Sub\n</code></pre>\n\n<p>So if you're dimensioning the array initial from an index of 1, the redimension would throw an error. But if you're only adding 'rows' to the array beyond what was there initially, it looks like it works. When I tried this, it failed:</p>\n\n<pre><code>ReDim Preserve exp2(0 To 2)\nMsgBox exp2(2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "is_accepted": false, "score": 0, "last_activity_date": 1566456123, "creation_date": 1566456123, "answer_id": 57603384, "question_id": 57592645, "link": "https://stackoverflow.com/questions/57592645/element-of-array-doesnt-pass-into-another-sub/57603384#57603384", "title": "element of array doesnt pass into another sub", "body": "<p>Okay, this was really stupid from me. I had double declared array exp2()\nOne in module level and one in sub1 level. problem solved :)\nThanks all for giving some advices</p>\n"}], "owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 57592870, "answer_count": 3, "score": 0, "last_activity_date": 1566456123, "creation_date": 1566393571, "last_edit_date": 1566394497, "question_id": 57592645, "link": "https://stackoverflow.com/questions/57592645/element-of-array-doesnt-pass-into-another-sub", "title": "element of array doesnt pass into another sub", "body": "<p>I have some troubles with arrays.</p>\n\n<p>I have standard module which contains some subs and private variable.\nWhen this module gets called via <code>userform_initialize</code> it does some procedures and then it should store array variable and wait until button is clicked to do another procedures..\nProblem is that this array variable doesn't hold its elements when I call other procedure.\nSimplified example is this:</p>\n\n<pre><code>Private exp2() as double 'declaration of module array variable\n\nPrivate sub1()\n\n//'some code which fills array exp2()\n\nmsgbox exp2(x) '- this message box shows correct information stored in variable exp2(x)\nsub2\nEnd sub\n\nPrivate sub2()\nRedim preserve exp2(0 to x)\nmsgbox exp2(x) - this message shows 0\nEnd sub\n</code></pre>\n\n<p>Keep in mind that this is not exactly the flow of my program. Important is to store array variable exp2() for later use.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 2, "creation_date": 1566395990, "post_id": 57592637, "comment_id": 101644261, "body": "Welcome to SO. Please share the code that you have written so far as well as either the snippet of the HTML code that you are interested in, or the url of the corresponding web page. Also please keep in mind that not all elements in an HTML document have an ID. You might need to use a different approach."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566452288, "post_id": 57602423, "comment_id": 101661708, "body": "Thank you. Now he writes me An error. Object variable Or With Black variable not set."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566454128, "post_id": 57602423, "comment_id": 101662329, "body": "Please try to provide detailed information like on which line your got this error and did you made necessary changes in this code to run it on your side? If possible than please try to edit the original post with the sample code you tested on your site."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566459951, "post_id": 57602423, "comment_id": 101665003, "body": "You have spelling mistake in this line.  OBJIE.doxument.getElementsByName. It should be OBJIE.document"}, {"owner": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566463901, "post_id": 57602423, "comment_id": 101666874, "body": "In My Real code I spelled It right. I didnt copy and paste It because I wrote this from My Phone and not from My pc."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566464120, "post_id": 57602423, "comment_id": 101666985, "body": "Can you post the full error message may help to understand it properly?"}, {"owner": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566473534, "post_id": 57602423, "comment_id": 101672147, "body": "I cant Post A photo because Im new here buy I will right It down:"}, {"owner": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566473584, "post_id": 57602423, "comment_id": 101672170, "body": "Run-time error &#39;-2147467259 (80004005)&#39;:                                                   Automation Error                                                                   ?????????? ??? ??????"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "edited": false, "score": 0, "creation_date": 1566530687, "post_id": 57602423, "comment_id": 101693359, "body": "Try to use IE.Quit in the last line may help to solve this error."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1566450702, "creation_date": 1566450702, "answer_id": 57602423, "question_id": 57592637, "link": "https://stackoverflow.com/questions/57592637/search-site-with-getelementbyid-using-excel-vba/57602423#57602423", "title": "Search site with getElementById using Excel VBA", "body": "<p>You said that you are able to find the <strong>Name</strong> of that Search Box. So you should try to access it with it's name from VBA code.</p>\n\n<p>Below is the sample VBA code:</p>\n\n<pre><code>Sub demo()\n    Dim IE As Object\n    Dim ws As Worksheet\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    IE.Visible = True\n    IE.Navigate (\"C:\\Users\\Administrator\\Desktop\\search_demo1.html\")\n     Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    IE.document.getElementsByName(\"search2\")(0).Value = ws.Range(\"A1\").Value2\n    IE.document.getElementById(\"submit\").Click\n\nEnd Sub\n</code></pre>\n\n<p>Sample HTML code:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"&gt;\n&lt;style&gt;\nbody {\n  font-family: Arial;\n}\n\n* {\n  box-sizing: border-box;\n}\n\nform.example input[type=text] {\n  padding: 10px;\n  font-size: 17px;\n  border: 1px solid grey;\n  float: left;\n  width: 80%;\n  background: #f1f1f1;\n}\n\nform.example button {\n  float: left;\n  width: 20%;\n  padding: 10px;\n  background: #2196F3;\n  color: white;\n  font-size: 17px;\n  border: 1px solid grey;\n  border-left: none;\n  cursor: pointer;\n}\n\nform.example button:hover {\n  background: #0b7dda;\n}\n\nform.example::after {\n  content: \"\";\n  clear: both;\n  display: table;\n}\n#lbl\n{\n    color: red;\n}\n&lt;/style&gt;\n&lt;script&gt;\nfunction search()\n{\n    var div = document.getElementById('lbl');\n    var div1 = document.getElementsByName('search2')[0].value;\n\ndiv.innerHTML += 'Searching the results for '+ div1;\n}\n&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h2&gt;Sample Test&lt;/h2&gt;\n  &lt;input type=\"text\" placeholder=\"Search..\" name=\"search2\" value=\"\"&gt;\n  &lt;button type=\"submit\" onclick=\"search()\"&gt;&lt;i class=\"fa fa-search\"&gt;&lt;/i&gt;&lt;/button&gt;&lt;br&gt;\n  &lt;div id=lbl&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EHfsg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EHfsg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11957298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211514873705936/picture?type=large", "display_name": "Noam Shnarch", "link": "https://stackoverflow.com/users/11957298/noam-shnarch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1574191640, "creation_date": 1566393544, "last_edit_date": 1574191640, "question_id": 57592637, "link": "https://stackoverflow.com/questions/57592637/search-site-with-getelementbyid-using-excel-vba", "title": "Search site with getElementById using Excel VBA", "body": "<p>I'm trying to search some site by writing what I want to search on a cell.</p>\n\n<p>I can't find the ID of the search box for getElementById.</p>\n\n<p>When I press F12 and go to this search box I can get the name, tile, align, class, style, onkeyup, onproperychange, type and Size.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Dim objIE as Object\nSet objIE = CreateObject(\"internetexplorer.application\")\nobjIE.Visible = True\nobjIE.navigate \"https://.......\"\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nOBJIE.doxument.getElementsByName(\"txtNumber\")(0).Value = \"ajwh\"\n</code></pre>\n\n<p>The error is in the getElement line.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566393592, "post_id": 57592548, "comment_id": 101642577, "body": "<code>the value is formula driven and is not getting picked up by my VBA code</code> - <a href=\"https://stackoverflow.com/a/48028941/11683\">correct</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566393767, "post_id": 57592548, "comment_id": 101642695, "body": "Unrelated to your problem, but you <a href=\"https://stackoverflow.com/questions/53453611/vba-excel-how-do-i-use-a-function-as-a-parameter#comment93779918_53453611\">don&#39;t have to unprotect</a> each time."}, {"owner": {"reputation": 25, "user_id": 11926446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6103f75e606e5bee2b4c47e2905afd35?s=128&d=identicon&r=PG&f=1", "display_name": "Basics B", "link": "https://stackoverflow.com/users/11926446/basics-b"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566393919, "post_id": 57592548, "comment_id": 101642796, "body": "@GSerg Thanks for the advice."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566397079, "post_id": 57593692, "comment_id": 101644974, "body": "The point of the question is that this code, which is in <code>Worksheet_Change</code>, does not trigger when the formula in K20 recalculates. <code>Worksheet_Change</code> does not fire on formula calculations."}], "tags": [], "owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "is_accepted": false, "score": -1, "last_activity_date": 1566396854, "creation_date": 1566396854, "answer_id": 57593692, "question_id": 57592548, "link": "https://stackoverflow.com/questions/57592548/reading-a-formula-output/57593692#57593692", "title": "Reading a formula output", "body": "<p>I tried the code with K20 generated by formula and it worked for me. My suggestion would be to change it to </p>\n\n<pre><code>If Target.Address(False, False) = \"K20\" Then\n    If Target.Value = \"Yes\" Then\n            ShowxxxResults\n        ElseIf Target.Value = \"No\" Then\n            HidexxxResults\n    End If\nEnd If\n</code></pre>\n\n<p>and step through it to see where it breaks down. Put a watch on Target.Value and see if indeed the expression value is \"Yes\" or \"No\". </p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 11926446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6103f75e606e5bee2b4c47e2905afd35?s=128&d=identicon&r=PG&f=1", "display_name": "Basics B", "link": "https://stackoverflow.com/users/11926446/basics-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1566399709, "creation_date": 1566399709, "answer_id": 57594446, "question_id": 57592548, "link": "https://stackoverflow.com/questions/57592548/reading-a-formula-output/57594446#57594446", "title": "Reading a formula output", "body": "<p>I used a different method, Instead of trying to pick up the formula value I instead calculated the result in VBA</p>\n\n<pre><code>If Range(\"K44\") = \"Yes\" And Range(\"K46\") = \"Yes\" And Range(\"K50\") = \"No\" And Range(\"K52\") = \"No\" And Range(\"K54\") = \"No\" And Range(\"K56\") = \"No\" And Range(\"K58\") = \"No\" And Range(\"K60\") = \"No\" And Range(\"K62\") = \"No\" Or Range(\"K44\") = \"Yes\" And Range(\"K48\") = \"Yes\" And Range(\"K50\") = \"No\" And Range(\"K52\") = \"No\" And Range(\"K54\") = \"No\" And Range(\"K56\") = \"No\" And Range(\"K58\") = \"No\" And Range(\"K60\") = \"No\" And Range(\"K62\") = \"No\" Then\n\n        Call ShowEBAResult\n\n      Else\nEnd If\n</code></pre>\n\n<p>Thanks for all the help :)</p>\n"}], "owner": {"reputation": 25, "user_id": 11926446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6103f75e606e5bee2b4c47e2905afd35?s=128&d=identicon&r=PG&f=1", "display_name": "Basics B", "link": "https://stackoverflow.com/users/11926446/basics-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57594446, "answer_count": 2, "score": 0, "last_activity_date": 1566399709, "creation_date": 1566393280, "last_edit_date": 1566393833, "question_id": 57592548, "link": "https://stackoverflow.com/questions/57592548/reading-a-formula-output", "title": "Reading a formula output", "body": "<p>New to VBA</p>\n\n<p>I need to unhide/hide a row on a different page depending on a value. The issue I'm having is the value is formula driven and is not getting picked up by my VBA code. What changes need to be made so it will read the formula value?</p>\n\n<p>Any guidance or advise would be greatly appreciated.</p>\n\n<p>This is what is meant to trigger the Macro:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Target.Address(False, False) = \"K20\" And Target.Value = \"Yes\" Then\n    Call ShowxxxResults\nElse\nEnd If\n\nIf Target.Address(False, False) = \"K20\" And Target.Value = \"No\" Then\n    Call HidexxxResults\nElse\nEnd If\n</code></pre>\n\n<p>Here is the Macros they call to:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ShowxxxResults()\n    With Sheets(\"Results\")\n        Sheets(\"Results\").Unprotect (\"xxx\")\n        .Range(\"A44\", \"A45\").EntireRow.Hidden = False\n        Sheets(\"Results\").Protect (\"xxx\")\n    End With\nEnd Sub\n\nSub HidexxxResults()\n    With Sheets(\"Results\")\n        Sheets(\"Results\").Unprotect (\"xxx\")\n        .Range(\"A44\", \"A45\").EntireRow.Hidden = True        \n        Sheets(\"Results\").Protect (\"xxx\")\n    End With    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf", "sendkeys", "save-as"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566393877, "post_id": 57592535, "comment_id": 101642770, "body": "You could use <code>Application.GetSaveAsFilename</code> instead of <code>SendKeys</code>?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566394102, "post_id": 57592535, "comment_id": 101642923, "body": "Where is the <code>SaveAs</code> in excel or in Adobe?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566394126, "post_id": 57592535, "comment_id": 101642946, "body": "This is all VBA code"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566394352, "post_id": 57592535, "comment_id": 101643106, "body": "I understand that but <code>Application.SendKeys</code> is for Excel or for Adobe? What I mean is, are you saving the file from Excel or automating Adobe from Excel and doing a saveas from there? Perhaps you can share your <code>For Loop</code> Code?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566394653, "post_id": 57592535, "comment_id": 101643310, "body": "Bob, you need to make it clear in your question that you&#39;re trying to do something <i>in the Acrobat interface</i>. It reads like you&#39;re trying to have Excel &quot;Save As&quot; to PDF format."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1566395848, "post_id": 57592535, "comment_id": 101644143, "body": "Could you add more code including the loop and how you are opening up the pdf form. Currently the question is not easily reproducable"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566396092, "post_id": 57592535, "comment_id": 101644334, "body": "Please also specify the <i>application</i> involved, Bob..."}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566399401, "post_id": 57592535, "comment_id": 101646099, "body": "@Siddharthrout code has been added"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1566399408, "post_id": 57592535, "comment_id": 101646109, "body": "@Tragamor code has been added"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566405209, "post_id": 57592535, "comment_id": 101649058, "body": "Bob lot of things can go wrong with SendKeys. I could have recommended itextsharp but that will not work in VBA like it does in <a href=\"http://www.siddharthrout.com/index.php/2018/08/28/fillretrieve-data-from-pdf-form-fields-using-vb-net-from-an-excel-file/\" rel=\"nofollow noreferrer\">VB.Net</a> Still, may I see the pdf file that you are using? I would like to experiment with it."}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 1, "last_activity_date": 1566561845, "creation_date": 1566561845, "answer_id": 57625996, "question_id": 57592535, "link": "https://stackoverflow.com/questions/57592535/how-to-continue-a-loop-after-a-user-operation/57625996#57625996", "title": "How to continue a loop after a User Operation?", "body": "<p>So - this was quite interesting to solve. </p>\n\n<p>Essentially the sub opens a pdf using Shell rather than FollowHyperlink (initial thoughts were to use the processID but to date I haven't got that to work properly) then triggers the 'Save As' dialogue using SendKeys (as in the question). </p>\n\n<p>While the 'Save As' dialogue is open, the macro is delayed using the macro here:\n<a href=\"https://stackoverflow.com/questions/49389093/delay-macro-to-allow-events-to-finish\">Delay macro to allow events to finish</a></p>\n\n<p>Once closed, the window is no longer visible so the macro resumes.</p>\n\n<blockquote>\n  <p>Caveat: currently it will only progress once no windows with \"Save As\" are present. I would like to implement parent/child checks to ensure it is the Adobe Reader windows that are being checked but to date again haven't quite got it working.</p>\n</blockquote>\n\n<pre><code>Private Declare Function IsWindowVisible Lib \"User32\" (ByVal hWnd As Long) As Long\nPrivate Declare Function FindWindow Lib \"User32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nSub TestPDFForm()\n\n    Dim pdfFilePath As String: pdfFilePath = GetFilePath(\"Select the empty PDF form\")\n    'Dim outputPath As String: outputPath = GetFolderPath(\"Select the folder to save the completed DD1144 forms\")\n    'If pdfFilePath = \"-\" Or outputPath = \"-\" Then Exit Sub\n\n    Dim ProcID As Long\n\n    Dim sh As Object: Set sh = CreateObject(\"WScript.Shell\")\n    Dim AdobeExe As String: AdobeExe = sh.RegRead(\"HKCR\\Software\\Adobe\\Acrobat\\Exe\\\")\n\n    ProcID = RunShell(AdobeExe, pdfFilePath)\n\n    Application.SendKeys \"+^(s)\", True\n    Delay (2.5) ' Delay until \"Save As\" dialog has opened\n\n    Debug.Print Timer\n    Do     ' Delay until window has been closed\n        Delay (0.5)\n    Loop While IsWindowVisible(FindSaveAs) &lt;&gt; 0\n    Debug.Print Timer\n\nEnd Sub\n\nFunction FindSaveAs() As Long\n    FindSaveAs = FindWindow(vbNullString, \"Save As\")\nEnd Function\n\nFunction RunShell(path As String, Optional arguments As String, Optional windowstyle As VbAppWinStyle = vbNormalFocus) As Long\n    If arguments &lt;&gt; \"\" Then path = path &amp; \" \"\"\" &amp; arguments &amp; \"\"\"\"\n    RunShell = Shell(path, windowstyle)\nEnd Function\n\nFunction GetFilePath(caption As String) As String\n    Dim sItem As String: sItem = \"-\"\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .Title = caption\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show = -1 Then sItem = .SelectedItems(1)\n    End With\n    GetFilePath = sItem\nEnd Function\n\nFunction GetFolderPath(caption As String) As String\n    Dim sItem As String: sItem = \"-\"\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = caption\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show = -1 Then sItem = .SelectedItems(1)\n    End With\n    GetFolderPath = sItem\nEnd Function\n\nFunction Delay(Seconds As Single) ' Millisecond precision\n    Dim StopTime As Single: StopTime = Timer + Seconds\n    Do While Timer &lt; StopTime\n        DoEvents\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566561845, "creation_date": 1566393237, "last_edit_date": 1566399363, "question_id": 57592535, "link": "https://stackoverflow.com/questions/57592535/how-to-continue-a-loop-after-a-user-operation", "title": "How to continue a loop after a User Operation?", "body": "<p>I am trying to find a way to have the system pause a <code>For</code> loop until after a User is done saving a PDF. I am using <code>SendKeys</code> for this program, and have the following line of code that opens up the <code>SaveAs</code> menu where a user can name a file and choose a file path.</p>\n\n<pre><code>Application.SendKeys \"+^(s)\", True\n</code></pre>\n\n<p>My problem is the for loop just continues and doesn't let the user have time to save the file. I know one way is toe use a <code>Application.Wait Now</code>, but the time it takes for a user to find a path and name their file will vary. Is there anyway to wait until the dialogbox is closed?</p>\n\n<p>Edit: I am Sending Keys to a PDF Form and trying to save the PDF form.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub testingThis()\n\n    Dim aFieldName As String\n    Dim pdfFilePath As String\n    Dim outputFolderPath As String\n    Dim WasSaved As Variant\n    Dim nonFormattedFolderPath As String\n    Dim i As Long\n\n\n    Dim wb As Workbook\n    Dim WS As Excel.Worksheet\n\n    Set wb = ActiveWorkbook\n    Set WS = wb.Sheets(\"Entry Form Test\")\n\n    Dim lastRowUsed As Long\n    lastRowUsed = LastRow\n    Dim pdfCounter As Long\n    pdfCounter = 1\n\n\n\n    pdfFilePath = GetPDFPath(\"Select the Empty PDF Form\")\n    outputFolderPath = GetFolder\n    nonFormattedFolderPath = outputFolderPath\n\n\n    ThisWorkbook.FollowHyperlink pdfFilePath\n\n       For i = 3 To 3 'lastRowUsed\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"D\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"E\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"G\" &amp; i).Text, True\n            Application.Wait Now + 0.00005\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"H\" &amp; i).Value, True\n            Application.Wait Now + 0.000001\n\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"J\" &amp; i).Text, True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"K\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"I\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"M\" &amp; i).Text, True\n            Application.SendKeys \"{Return}\", True\n            MsgBox WS.Range(\"N\" &amp; i).Text\n            Application.SendKeys WS.Range(\"N\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"L\" &amp; i).Text, True\n            Application.Wait Now + 0.000001\n\n            Application.SendKeys \"{Tab}\", True\n\n            Application.SendKeys \"{Tab}\", True\n            Application.SendKeys WS.Range(\"O\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"p\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"q\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"r\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"s\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"t\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"u\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"v\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"w\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"x\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"y\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"z\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"aa\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ab\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ac\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ad\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ae\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"af\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ag\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ah\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ai\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"aj\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"ak\" &amp; 2).Text &amp; \":\", True\n            Application.SendKeys \"{Return}\", True\n            Application.SendKeys WS.Range(\"al\" &amp; 2).Text &amp; \":\", True\n            Application.Wait Now + 0.000001\n\n            'SAVE AND LOOP BACK HERE\n\nEnd Sub\n\nFunction GetPDFPath(theText As String) As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFilePicker)\n    With fldr\n        .Title = theText\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetPDFPath = sItem\n    Set fldr = Nothing\nEnd Function\n\nFunction GetFolder() As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select the Folder to Place the Completed DD1144 Forms\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n\n\nFunction LastRow()\n    LastRow = Range(\"a65536\").End(xlUp).Row\nEnd Function\n\nPrivate Sub FlowchartProcess1_Click()\n    Call WriteToAdobeFields\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1566393369, "post_id": 57592525, "comment_id": 101642414, "body": "Why not just return <code>2^(n+1) - 1</code>?"}, {"owner": {"reputation": 3, "user_id": 11957239, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6cmWX9ViT4I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9v3ww2SJf4B96RnQnomLaKRB8Lg/photo.jpg?sz=128", "display_name": "Cian", "link": "https://stackoverflow.com/users/11957239/cian"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1566394786, "post_id": 57592525, "comment_id": 101643401, "body": "In that case if you entered n=2 then it would return 2^2 = 4.  I want it to return 2^0 + 2^1 + 2^2"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1566395638, "post_id": 57592525, "comment_id": 101644002, "body": "I said return <code>2^(n+1) - 1</code>, not just <code>2^(n+1)</code>. This is a standard formula, which corresponds to the fact that a binary number which is all 1&#39;s is 1 less than a power of 2. For example, <code>1111</code> in base 2 is 16-1 = 15 in base 10."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1566395165, "creation_date": 1566395165, "answer_id": 57593147, "question_id": 57592525, "link": "https://stackoverflow.com/questions/57592525/computing-sums-on-vba/57593147#57593147", "title": "Computing sums on VBA", "body": "<p><strong>Maybe try this loop:</strong></p>\n\n<pre><code>Sub Button1()\n\nDim n As Single\n\nn = InputBox(\"Enter a value for n\")\n\nDim val As Long\n\n    val = 0\n    For i = 0 To n\n\n        val = val + 2 ^ i\n\n    Next\n\nActiveCell.Value = val\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1566419023, "creation_date": 1566419023, "answer_id": 57598755, "question_id": 57592525, "link": "https://stackoverflow.com/questions/57592525/computing-sums-on-vba/57598755#57598755", "title": "Computing sums on VBA", "body": "<p>In addition to the loop-based approach, you can use the fact that the series </p>\n\n<pre><code>1 + 2 + 2^2 + ... + 2^n + ...\n</code></pre>\n\n<p>is a <a href=\"https://en.wikipedia.org/wiki/Geometric_series\" rel=\"nofollow noreferrer\">geometric series</a> whose partial sums can be expressed in closed-form. In this case the partial sum that you are evaluating is equal to <code>2^(n+1)-1</code>. For example, if <code>n = 3</code>, it is easy to verify that </p>\n\n<pre><code>1 + 2 + 4 + 8 = 15 = 16-1 = 2^4 - 1\n</code></pre>\n\n<p>This leads to the following code:</p>\n\n<pre><code>Sub Button1()\n    Dim n As Long\n    n = InputBox(\"Enter a value for n\")\n    ActiveCell.Value = 2 ^ (n + 1) - 1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11957239, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6cmWX9ViT4I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9v3ww2SJf4B96RnQnomLaKRB8Lg/photo.jpg?sz=128", "display_name": "Cian", "link": "https://stackoverflow.com/users/11957239/cian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 57593147, "answer_count": 2, "score": 0, "last_activity_date": 1566419023, "creation_date": 1566393199, "last_edit_date": 1566396691, "question_id": 57592525, "link": "https://stackoverflow.com/questions/57592525/computing-sums-on-vba", "title": "Computing sums on VBA", "body": "<p>Trying to sum 2^i from i=0 to i=n on VBA. Where n is an entered value by the user each time</p>\n\n<p>I can get it to do each term individually but its not summing.</p>\n\n<pre><code>Sub Button1()\nDim n As Single\n\nn = InputBox(\"Enter a value for n\")\n\nDim array as\n\nDim CSeriesSum As Double\n\nActiveCell.Value = WorksheetFunction.SeriesSum(Arg1:=2, Arg2:=n, Arg3:=1, Arg4:=1:n)\n\nEnd Sub\n</code></pre>\n\n<p>I expect it to return for eg. 1 if n=0, 3 if n=1, 7 if n=2 etc.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566393613, "post_id": 57592370, "comment_id": 101642594, "body": "<code>I have tried the sumproduct method, but it doesn&#39;t apply well to tables with a variable number of inputs</code> Can you explain this please? I have worked with sumproduct + tables and it works well? For example <code>=SUMPRODUCT((Table1[HeadinaA])*(Table1[HeadingB]=&quot;SomeValue&quot;&zwnj;&#8203;))</code>"}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566394003, "post_id": 57592370, "comment_id": 101642851, "body": "I think the issue here is that it doesn&#39;t like the potential Zeros that are in it. I&#39;ll try amending this method to see if I can come up with the same entries as my manual code."}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566394976, "post_id": 57592370, "comment_id": 101643527, "body": "Yeah, this isnt working in right - just tried to apply this and coming in much higher than the manual formula. I don&#39;t think its applying the weighting in expectation the correct way. Column 1 is basically a ranking number whilst the second column is a %."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566395276, "post_id": 57592370, "comment_id": 101643745, "body": "Can you post a sample data of ay 5 rows. Show what are you expecting and what are you actually getting using Sumproduct?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566394735, "post_id": 57592877, "comment_id": 101643370, "body": "This Seems to be returning Zero on any range I use it on. How is it meant to work?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566395154, "post_id": 57592877, "comment_id": 101643647, "body": "Scott Scotty Scott! Congrats :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566395235, "post_id": 57592877, "comment_id": 101643713, "body": "@Toaster86 I get the same as with your formula.  You would call it like this:<code>=lkjlkj(R11:R20)</code>"}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566395790, "post_id": 57592877, "comment_id": 101644109, "body": "@ScottCraner thats what I thought but I&#39;m doing exactly this and getting a zero return. Ill try re-adding the formula as I could have broken somthing"}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566395920, "post_id": 57592877, "comment_id": 101644205, "body": "@ScottCraner looks like I somehow messed up copying in the VBA - works an absolute charm"}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566396175, "post_id": 57592877, "comment_id": 101644382, "body": "@ScottCraner - This is a great approach, and I&#39;ve accepted it, the only issue is that I will have blank values in this table. Is there any way to get it to ignore 0/Null values"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566396353, "post_id": 57592877, "comment_id": 101644491, "body": "You would need to add a few IFs into the code to skip that iteration of the loop if the value is 0 or blank.  Try doing it on your own.  If you are unable then come back and ask a new question showing how you tried to add the code and refer back to this question to help with clarity.  I am going into a meeting and will not have time to manipulate this, but there are others that are quite capable. @Toaster86"}, {"owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "edited": false, "score": 0, "creation_date": 1566401571, "post_id": 57592877, "comment_id": 101647320, "body": "@ScottCraner it was simpler to adjust the inputs to show 0 rather than a blank - solution works perfectly."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1566394327, "creation_date": 1566394327, "answer_id": 57592877, "question_id": 57592370, "link": "https://stackoverflow.com/questions/57592370/calculating-expectation-in-table-with-variable-number-of-entries/57592877#57592877", "title": "Calculating expectation in table - With variable number of entries", "body": "<p>You can use this:</p>\n\n<pre><code>Function lkjlkj(rng As Range) As Double\n    Dim arr()\n    arr = rng.Value2\n    Dim i As Long\n    For i = 1 To UBound(arr, 1)\n        Dim temp As Double\n        temp = arr(i, 1)\n        Dim j As Long\n        For j = 1 To i - 1\n            temp = temp * (1 - arr(j, 1))\n        Next j\n        lkjlkj = lkjlkj + temp\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11630473, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sXt3JprkjiQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfmZD3EVvuXF_VJiZTLlQhmLwrHoQ/mo/photo.jpg?sz=128", "display_name": "Toaster86", "link": "https://stackoverflow.com/users/11630473/toaster86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 57592877, "answer_count": 1, "score": 0, "last_activity_date": 1566394327, "creation_date": 1566392776, "last_edit_date": 1566392831, "question_id": 57592370, "link": "https://stackoverflow.com/questions/57592370/calculating-expectation-in-table-with-variable-number-of-entries", "title": "Calculating expectation in table - With variable number of entries", "body": "<p>Whilst I can correctly calculate Expectation in Excel, I am unsure of how to do so across a table when the number of entries is an unknown. </p>\n\n<p>Currently, I am using the following formula which works: This is the example for 3 Entries, </p>\n\n<pre><code>=R11+(1-R11)*R12+((1-R11)*(1-R12)*R13).\n</code></pre>\n\n<p>I am using the large formula, to rank my percentages which go into R column but I am having to manually create the code for each subsequent entry  and it is getting rather large. For example, the formula for 10 entries is :</p>\n\n<pre><code>=R11+(1-R11)*R12+((1-R11)*(1-R12)*R13)+((1-R11)*(1-R12)*(1-R13)*R14)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*R15)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*(1-R15)*R16)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*(1-R15)*(1-(R16))*R17)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*(1-R15)*(1-(R16))*(1-R17)*R18)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*(1-R15)*(1-(R16))*(1-R17)*(1-R18)*R19)+((1-R11)*(1-R12)*(1-R13)*(1-R14)*(1-R15)*(1-(R16))*(1-R17)*(1-R18)*(1-R19)*R20)\n</code></pre>\n\n<p>Now, this is actually working. the issue is I would like to find a way to apply this in a table without re-ranking (or ranking this formulaically) </p>\n\n<p>However, I'm not sure how this could be done. I have tried the sumproduct method, but it doesn't apply well to tables with a variable number of inputs, and I am well aware that I am running out of room past 10 entries.</p>\n\n<p>I'm usually a dab hand with Excel - but this has truly got me stumped.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566392495, "post_id": 57591922, "comment_id": 101641864, "body": "What exactly are you trying to achieve? The reason why I ask is because I don&#39;t think you need to call a function inside a function in this case... I have a feeling that you may not know (no offence meant) what a <code>Procedure</code> and a <code>Function</code> does.. So do let us know what exactly are you trying to achieve..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11957029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220554469234075/picture?type=large", "display_name": "Noa Ben Nathan", "link": "https://stackoverflow.com/users/11957029/noa-ben-nathan"}, "edited": false, "score": 0, "creation_date": 1566391788, "post_id": 57591996, "comment_id": 101641376, "body": "ther is still an eror: &quot;Type mismatch&quot;"}, {"owner": {"reputation": 1, "user_id": 11957029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220554469234075/picture?type=large", "display_name": "Noa Ben Nathan", "link": "https://stackoverflow.com/users/11957029/noa-ben-nathan"}, "edited": false, "score": 0, "creation_date": 1566391882, "post_id": 57591996, "comment_id": 101641433, "body": "Type mismatch @Mikku"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11957029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220554469234075/picture?type=large", "display_name": "Noa Ben Nathan", "link": "https://stackoverflow.com/users/11957029/noa-ben-nathan"}, "edited": false, "score": 0, "creation_date": 1566392131, "post_id": 57591996, "comment_id": 101641596, "body": "@NoaBenNathan .. I have changed the Sheet reference to Active sheet. Try now."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1566419966, "post_id": 57591996, "comment_id": 101654990, "body": "The dreaded unnecessary <code>Call</code>? Why not use idiomatic VBA: <code>AlreadySigned ActiveSheet.Cells(i, 2)</code> instead of some anachronistic throwback to the days of <code>GoSub</code>?"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1566392024, "last_edit_date": 1566392024, "creation_date": 1566391611, "answer_id": 57591996, "question_id": 57591922, "link": "https://stackoverflow.com/questions/57591922/how-to-call-a-function-i-created-in-vba-in-onther-function-in-vba/57591996#57591996", "title": "how to call a function I created in VBA in onther function in VBA?", "body": "<p>Not exactly sure what you are trying to do, but that is not the way to call a function. </p>\n\n<p>From what I understood, I think the below would work for you.</p>\n\n<p>You should pass a <code>Range</code> object and use that Range object in the Function instead of <code>Activecell</code></p>\n\n<pre><code>Function AlreadySigned(rn As Range)\nDim i As Integer\nDim j As Long\nj = rn.row - 1\nDim tmp As String\ntmp = rn.Value\nFor i = 3 To j\n    If ActiveSheet.Cells(i, 2).Value = tmp Then\n        rn.Interior.ColorIndex = 3\n    End If\nNext i\nEnd Function\n\n\nFunction AlreadyRegisterLoop()\nDim i As Integer\nDim j As Integer\nj = ActiveSheet.Cells(Rows.count, 1).End(xlUp).row\nFor i = 3 To j\n    Call AlreadySigned(ActiveSheet.Cells(i, 2))\nNext i\nEnd Function\n</code></pre>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/fDG6E.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fDG6E.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11957029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220554469234075/picture?type=large", "display_name": "Noa Ben Nathan", "link": "https://stackoverflow.com/users/11957029/noa-ben-nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566392024, "creation_date": 1566391410, "last_edit_date": 1566391770, "question_id": 57591922, "link": "https://stackoverflow.com/questions/57591922/how-to-call-a-function-i-created-in-vba-in-onther-function-in-vba", "title": "how to call a function I created in VBA in onther function in VBA?", "body": "<p>I created a function in VBA and I want to call it in onther function I created in VBA. what is the correct syntax to do this?</p>\n\n<p>this is the function i want to call:</p>\n\n<pre><code>Function AlreadySigned()\nDim i As Integer\nDim j As Long\nj = ActiveCell.Row - 1\nDim tmp As String\ntmp = ActiveCell.Value\nFor i = 3 To j\n    If Cells(i, 2).Value = tmp Then\n        ActiveCell.Interior.ColorIndex = 3\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p>in this function:</p>\n\n<pre><code>Function AlreadyRegisterLoop()\nDim i As Integer\nDim j As Integer\nj = Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 3 To j\n    Cells(i, 2).AlreadySigned()\nNext i\nEnd Function\n</code></pre>\n\n<p>but there is an <code>eror: syntax eror</code> in the 6th line.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1566393080, "creation_date": 1566393080, "answer_id": 57592482, "question_id": 57591667, "link": "https://stackoverflow.com/questions/57591667/is-there-ability-to-split-cells-while-retaining-the-values-of-adjacent-columns/57592482#57592482", "title": "Is there ability to split cells while retaining the values of adjacent columns?", "body": "<p>It's a bit more involved than your solution because you have to insert the correct number of rows below the targeted cell and then copy the IDs and the other data into the new rows. Here's an example to help you along.</p>\n\n<p>There's a little \"trickery\" I'm using when I calculate the <code>offset</code> value. I'm doing this because you can <strong>assume</strong> that all arrays from the <code>Split</code> function will begin indexing at 0, but my personal habit is to write code that can work with either a 0 or 1 lower bound. Calculating and using an <code>offset</code> makes it all work for the loops and indexes.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    SplitText ActiveCell\nEnd Sub\n\nSub SplitText(ByRef idCell As Range)\n    Dim splitVals As Variant\n    Dim totalVals As Long\n    splitVals = Split(idCell.Value, Chr(10))\n    If LBound(splitVals) = -1 Then\n        '--- the split character wasn't found, so exit\n        Exit Sub\n    End If\n\n    Dim offset As Long\n    offset = IIf(LBound(splitVals) = 0, 1, 0)\n    totalVals = UBound(splitVals) + offset\n\n    Dim idSheet As Worksheet\n    Set idSheet = idCell.Parent\n\n    Dim idRow As Long\n    idRow = idCell.Row\n\n    '--- insert the number of rows BELOW the idCell to hold all\n    '    the split values\n    Dim i As Long\n    For i = 1 To totalVals - 1\n        idSheet.Rows(idRow + 1).Insert\n    Next i\n\n    '--- now add the IDs to all the rows and copy the other columns down\n    Const TOTAL_COLUMNS As Long = 3\n    Dim j As Long\n\n    Dim startIndex As Long\n    startIndex = LBound(splitVals) + offset\n    For i = startIndex To totalVals\n        idCell.Cells(i, 1) = splitVals(i - offset)\n        For j = 2 To TOTAL_COLUMNS\n            idCell.Cells(i, j) = idCell.Cells(1, j)\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": true, "score": 2, "last_activity_date": 1566393276, "creation_date": 1566393276, "answer_id": 57592544, "question_id": 57591667, "link": "https://stackoverflow.com/questions/57591667/is-there-ability-to-split-cells-while-retaining-the-values-of-adjacent-columns/57592544#57592544", "title": "Is there ability to split cells while retaining the values of adjacent columns?", "body": "<p>Maybe this will help:</p>\n\n<pre><code>Sub splitText()\n    'splits Text active cell using ALT+10 char as separator\n    Dim splitVals As Variant\n    Dim lngRow As Long, lngEl As Long\n\n    With Sheet2\n        'Range A2:A5\n        For lngRow = 5 To 2 Step -1\n            splitVals = Split(.Range(\"A\" &amp; lngRow).Value, Chr(10))\n            'the first value\n            .Range(\"A\" &amp; lngRow).Value = splitVals(0)\n            'remaining values\n            For lngEl = 1 To UBound(splitVals)\n                .Rows(lngRow + lngEl).Insert\n                .Range(\"A\" &amp; lngRow + lngEl).Value = splitVals(lngEl)\n                .Range(\"B\" &amp; lngRow + lngEl &amp; \":C\" &amp; lngRow + lngEl).Value = .Range(\"B\" &amp; lngRow &amp; \":C\" &amp; lngRow).Value\n            Next lngEl\n        Next lngRow\n    End With\nEnd Sub\n</code></pre>\n\n<p>Change Sheet Code/Name and Range as necessary.</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2lfU9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2lfU9.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TVqMj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TVqMj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 57592544, "answer_count": 2, "score": 3, "last_activity_date": 1566393511, "creation_date": 1566390565, "last_edit_date": 1566393511, "question_id": 57591667, "link": "https://stackoverflow.com/questions/57591667/is-there-ability-to-split-cells-while-retaining-the-values-of-adjacent-columns", "title": "Is there ability to split cells while retaining the values of adjacent columns?", "body": "<h3>The IDs column in the first table contains multiple values in each cell that needs to be split. However, the unique issue is to retain both [name] and [description] info by ID into a new table.</h3>\n\n<p><img src=\"https://i.paste.pics/50b9f5605014682ecdaa37f4aa7b2d1a.png\" alt=\"excel image\">\n.</p>\n\n<p>The following VBA code performs the transpose paste option. This is what I am starting with to split cells with Chr(10), or new line as the delimiter:</p>\n\n<pre><code>Sub splitText()\n'splits Text active cell using ALT+10 char as separator\nDim splitVals As Variant\nDim totalVals As Long\n\nsplitVals = Split(ActiveCell.Value, Chr(10))\ntotalVals = UBound(splitVals)\nRange(Cells(ActiveCell.Row, ActiveCell.Column + 1), Cells(ActiveCell.Row, ActiveCell.Column + 1 + totalVals)).Value = splitVals\n\nEnd Sub\n</code></pre>\n\n<p>Other than this, I am still searching for ideas. </p>\n"}, {"tags": ["vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": false, "score": 0, "last_activity_date": 1566417221, "creation_date": 1566417221, "answer_id": 57598401, "question_id": 57591663, "link": "https://stackoverflow.com/questions/57591663/how-to-resize-a-shape-using-cellssrc/57598401#57598401", "title": "How to resize a shape using CellsSRC?", "body": "<p>I don't know what you mean by 'change the size of a line', as a line has begin and end points in Visio, and are considered one dimensional. There's a thickness, which is controlled separately.</p>\n\n<p>You can use CellsU to control the begin and end points, which is just easier than knowing the SRC address.  So there are four cells: BeginX, BeginY, EndX, EndY, which specify the x and y coordinates of the begin and end points.</p>\n\n<p>So to move the begin point to 1,2:</p>\n\n<pre><code> element.cellsU(\"BeginX\").formula = \"1\"\n element.cellsu(\"BeginY\").formula = \"2\"\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8596146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd6a52f0424215811b9b666d0ae8885?s=128&d=identicon&r=PG&f=1", "display_name": "GG24", "link": "https://stackoverflow.com/users/8596146/gg24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566417221, "creation_date": 1566390559, "question_id": 57591663, "link": "https://stackoverflow.com/questions/57591663/how-to-resize-a-shape-using-cellssrc", "title": "How to resize a shape using CellsSRC?", "body": "<p>I'd like to resize a shape (a line to be specific), I know it's possible to move a line with cellsSRC using the following line : </p>\n\n<pre><code>element.CellsSRC(visSectionObject, visRowXFormOut, visXFormBeginX).result(\"in\") = 0.1\n</code></pre>\n\n<p>but is it possible to change the size of a line using cellsSRC ? and how to do so ? Thank you very much in advance </p>\n"}, {"tags": ["sql", "excel", "vba", "sharepoint-2010"], "comments": [{"owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1566391599, "post_id": 57591652, "comment_id": 101641238, "body": "give a try to this ... sSQL = &quot;SELECT [fullname] FROM [listname] WHERE [Holiday Date]&gt;= &#39;1/1/2019&#39;&quot;"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1566391880, "post_id": 57591652, "comment_id": 101641432, "body": "@KubaDo nope! that didn&#39;t work too :("}, {"owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1566392270, "post_id": 57591652, "comment_id": 101641695, "body": "can You simply, select one record, and paste here Your datetime format ?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1566393455, "post_id": 57591652, "comment_id": 101642481, "body": "when I query one record, I get the date returned in my cell in this format &quot;m/d/yyyy&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566393403, "post_id": 57592387, "comment_id": 101642434, "body": "I get an undefined function on &#39;convert&#39; lol. I truly appreciate your time and effort in trying to assist me"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394268, "post_id": 57592387, "comment_id": 101643043, "body": "Alright,, with you pointing me in the right direction, I managed to get it to work with this statement:"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394333, "post_id": 57592387, "comment_id": 101643095, "body": "where [holiday date] &gt;= CDate(&#39;1/1/2019&quot;"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394408, "post_id": 57592387, "comment_id": 101643145, "body": "However, the whole point was also to ensure this is dynamic so I was looking to pick up the start date of the current year. I tried the working sql and back to the original error. Any ideas?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394419, "post_id": 57592387, "comment_id": 101643152, "body": "&gt;= CDate(&#39;DateSerial(Year(Date), 1, 1)&#39;)&quot;"}, {"owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394800, "post_id": 57592387, "comment_id": 101643413, "body": "You wrote that format is &quot;m/d/yyyy&quot; so meaby : CDate(&#39;DateSerial(1,1,Year(Date))&#39;)&quot;"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566394969, "post_id": 57592387, "comment_id": 101643521, "body": "Yikes, that didn&#39;t work :(. shucks I am so desperate!"}, {"owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "reply_to_user": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566395191, "post_id": 57592387, "comment_id": 101643682, "body": "&gt;= CDate(&quot;1/1/&quot;&amp; Year(Now))        - try this"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1566396239, "post_id": 57592387, "comment_id": 101644424, "body": "I see it as &quot;M/d/yyyy&quot; under regional and language settings. Is there a way I can format the CDate to this?"}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "reply_to_user": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1566396530, "post_id": 57592387, "comment_id": 101644601, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/198246/discussion-between-marv-and-kuba-do\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "is_accepted": true, "score": 0, "last_activity_date": 1566456970, "last_edit_date": 1566456970, "creation_date": 1566392802, "answer_id": 57592387, "question_id": 57591652, "link": "https://stackoverflow.com/questions/57591652/vba-datatype-mismatch-in-query-expression-when-querying-sharepoint-list/57592387#57592387", "title": "VBA &#39;Datatype Mismatch in query expression&#39; when querying SharePoint List", "body": "<p>This should work :)</p>\n\n<pre><code>sSQL = \"SELECT [fullname] FROM [listname] WHERE [Holiday Date] &gt;=\"&amp;\"1/1/\"&amp; Year(Now);\n</code></pre>\n"}], "owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57592387, "answer_count": 1, "score": 0, "last_activity_date": 1566456970, "creation_date": 1566390527, "last_edit_date": 1566396630, "question_id": 57591652, "link": "https://stackoverflow.com/questions/57591652/vba-datatype-mismatch-in-query-expression-when-querying-sharepoint-list", "title": "VBA &#39;Datatype Mismatch in query expression&#39; when querying SharePoint List", "body": "<p>I am able to successfully query my sharepoint list using VBA. However, I get a datatype mismatch error when adding a date condition.\nI am trying to query all dates that are greater than or equal to the current year.</p>\n\n<p>The sharepoint list has a date column and formatted as \"short date\" and the VBA code is below.</p>\n\n<p>Appreciate someone helping me with the correct syntax.</p>\n\n<p>I have tried the following queries that don't work:</p>\n\n<pre><code>'r = DateSerial(Year(Date), 1, 1)\nsSQL = \"SELECT [fullname] FROM [listname] WHERE [Holiday Date] &gt;= '\" &amp; Format(DateValue(r), \"m/d/yyy\") &amp; \"'\"\n\nsSQL = \"SELECT [fullname] FROM [listname] WHERE [Holiday Date] &gt;= '\" &amp; DateValue(\"1/1/2019\")\") &amp; \"'\"\n\nsSQL = \"SELECT [fullname] FROM [listname] WHERE [Holiday Date] &gt;= '\" &amp; DateSerial(Year(Date), 1, 1) &amp; \"'\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566391118, "post_id": 57591174, "comment_id": 101640939, "body": "You have declared <code>myitems</code> as a <code>MailItem</code> and you are trying to assign multiple items at once to it. Try using <code>Dim myitems As Object</code> instead of <code>Dim myitems As Outlook.Mailitem</code>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566391225, "post_id": 57591174, "comment_id": 101641011, "body": "Also you should mention in question what the Error Says! will be easier to understand why you are getting the error."}, {"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566392663, "post_id": 57591174, "comment_id": 101641963, "body": "Hi Miku, i have declared <code>Dim i As Object</code>     <code>Dim myitems As Outlook.Mailitem</code>       . it is a type mismatch error im getting for now as well i though of using ` if i.class =olmail then ` instead of  <code>If TypeOf i Is Mailitem  Then </code> so i figure that i as an object is needed"}, {"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566392892, "post_id": 57591174, "comment_id": 101642094, "body": "Ok, sure. i did add it now there seems to be no error! :) but i am getting an error now for the code ` Set myrestrictitem = myitems.Restrict(MS)` and the error type i have is that the condition is not valid"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566393052, "post_id": 57591174, "comment_id": 101642183, "body": "Maybe that&#39;s not how <code>Restrict</code> is used.. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.restrict\" rel=\"nofollow noreferrer\">Read here about it</a>.. Restrict is used as a Filter, what are you trying to filter ?"}, {"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566394107, "post_id": 57591174, "comment_id": 101642928, "body": "i am trying to filter the subject title of the email, MS - i used DASL Method instead of Jet, this  the code <code>MS = &quot;urn:schemas:mailheader:subject LIKE \\&#39;%&quot; &amp; Mailsubject &amp; &quot;%\\&#39;&quot;</code> In the excel column 3 i have written the exact subject title of the email in the code <code>Mailsubject = Application.WorksheetFunction.Index(Listmails, Rowcount, 3)</code> I place mailsubject as the condition for DASL and when there is a next rowcount it will move to the next cell"}, {"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566394230, "post_id": 57591174, "comment_id": 101643020, "body": "As well i am refering to sample code from the page you sent me, its the 3rd last code on this page, this is what i would like to do just with arrays,cause my list will be reused and it is dynamic --------This Visual Basic for Applications (VBA) example uses the Restrict method to get all Inbox items of Business category and moves them to the Business folder. To run this example, create or make sure a subfolder called &#39;Business&#39; exists under Inbox-------"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "edited": false, "score": 0, "creation_date": 1566485511, "post_id": 57595688, "comment_id": 101679342, "body": "Hi thanks for the response. I got an error type mismatch error? is there a step that i missed"}, {"owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "edited": false, "score": 0, "creation_date": 1566487916, "post_id": 57595688, "comment_id": 101680640, "body": "i have also added a new question, possibly more practical as you have suggested <a href=\"https://stackoverflow.com/questions/57612681/error-while-looping-through-conditions-for-outlook-vba-code\" title=\"error while looping through conditions for outlook vba code\">stackoverflow.com/questions/57612681/&hellip;</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "edited": false, "score": 0, "creation_date": 1566487950, "post_id": 57595688, "comment_id": 101680657, "body": "Where? Which line of the code? What is the complete error? &quot;i&quot; probably needs to be declared as Integer."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1566404148, "creation_date": 1566404148, "answer_id": 57595688, "question_id": 57591174, "link": "https://stackoverflow.com/questions/57591174/looping-through-arrays-with-vba-to-move-outlook-emails-from-one-folder-to-anoth/57595688#57595688", "title": "Looping through Arrays with VBA, to Move outlook emails from one folder to another?", "body": "<p>You condition must include the <code>@SQL=</code> prefix. It is also a good idea to double quote the DASL property names:</p>\n\n<pre><code>@SQL=\"urn:schemas:mailheader:subject\" LIKE '%test%'\n</code></pre>\n\n<p>You also should not use \"<code>for each</code>\" when you are changing the collection (by calling Move). Use a down loop:</p>\n\n<pre><code>for i = myrestrictitem.Count to 1 step -1\n  set item =  myrestrictitem.Item(i)\n  ..\n  item.Move subfolder\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11956776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04890f3b9352201f96807b0ffa837c78?s=128&d=identicon&r=PG&f=1", "display_name": "pedro_91", "link": "https://stackoverflow.com/users/11956776/pedro-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586980887, "creation_date": 1566388941, "last_edit_date": 1586980887, "question_id": 57591174, "link": "https://stackoverflow.com/questions/57591174/looping-through-arrays-with-vba-to-move-outlook-emails-from-one-folder-to-anoth", "title": "Looping through Arrays with VBA, to Move outlook emails from one folder to another?", "body": "<p>I want to move emails of invoices from a main folder to a different folder.</p>\n\n<p>I extracted the subject of the emails with VBA from outlook in the first module, they are in column 3. Then I manually write out the folder I would like the emails to move to, in column 8. (The names of the folder is a subfolder)</p>\n\n<p>Column 3 is the subject of the email which I extracted, I used the <code>restrict</code> method for outlook to return the email with the specific tittle</p>\n\n<p>Column 8 is the folder I would like the email to move too.</p>\n\n<p>Example is like below\nThe code has to place email in the main folder with subject'A' to Folder '1'</p>\n\n<pre><code>Column 3      columnn 8\n\nA                 1\nB                 2\nC                 2\nD                 1\nE                 1\n</code></pre>\n\n<p>The reason I use arrays is because, every time I make an extract, the list changes, hence it is dynamic. Therefore, I used LBound and UBound to include the whole list of invoices.</p>\n\n<p>I have declared all variables  here in the first module as 'public'. Only left the relevant ones here to the code</p>\n\n<pre><code>Sub MovingEmails_Invoices()\n\n  'Declare your Variables\n    Dim i As Object\n    Dim myitems As Object\n    Dim subfolder As Outlook.Folder \n\n\n    'Set Outlook Inbox Reference\n    Set OP = New Outlook.Application\n    Set NS = OP.GetNamespace(\"MAPI\")\n\n    'To loop through subfolder and its folders\n    Set rootfol = NS.Folders(\"SYNTHES-JNJCZ-GBS.DE.AT.CH@ITS.JNJ.com\")\n    Set Folder = rootfol.Folders(\"Austria\")\n\n'The list for invoice numbers and folders is dynamic\n'Each subject being searched is different\n\nDim Listmails() As Variant\nDim Rowcount As Long\nDim Mailsubject As Variant\nDim FolderName As Variant\nDim MS As String\nDim myrestrictitem As Outlook.items\n\n 'Establish the array based on the mailbox extract\n  Sheets(\"files\").Activate\n  Listmails = Range(\"A2\").CurrentRegion\n\n\n'Ititerate through the array which is dynamic (One-dimensional)\nFor Rowcount = LBound(Listmails) To UBound(Listmails)\n\n'3rd row for email subject 'used DASL Filter\nMailsubject = Application.WorksheetFunction.Index(Listmails, Rowcount, 3)\nMS = \"urn:schemas:mailheader:subject LIKE \\'%\" &amp; Mailsubject &amp; \"%\\'\"\n\n    'Find the email based on the array for email subject\n    Set myitems = Folder.items\n    Set myrestrictitem = myitems.Restrict(MS)\n\n        For each i in myrestrictitem\n        If i.class = olmail then\n\n         '8th row for folder name\n         FolderName = Application.WorksheetFunction.Index(Listmails, Rowcount,8) \n         Set subfolder = rootfol.Folders(FolderName) ' i have an error here\n\n         'If email found then mark it as read\n         i.UnRead = False\n\n         'Move it to the subfolder based on the array for folder name\n         i.Move subfolder\n\nNext Rowcount\n\nEnd Sub\n</code></pre>\n\n<p>Now, I used the example I got from Microsoft Office Center to construct the restrict part, the last example on this page: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.restrict\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/outlook.items.restrict</a></p>\n\n<p>when I try to do the same way, it doesn't work for my code.</p>\n\n<p>The error message comes from; </p>\n\n<pre><code>Set myrestrictitem = myitems.Restrict(MS)\n</code></pre>\n\n<p>and \n?</p>\n\n<pre><code>Set subfolder = rootfol.Folders(FolderName)\n\n</code></pre>\n\n<p>The error message is the condition is not correct. Also it could be because I am doing the loop incorrectly.</p>\n\n<p>Could there be another way of doing this, without arrays maybe? do i need IF condition?</p>\n"}, {"tags": ["excel", "xml", "vba", "sax"], "comments": [{"owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1566403591, "post_id": 57590971, "comment_id": 101648318, "body": "Is the reference to &quot;Saxon&quot; library to the Saxon 9 XSLT 2/3 processor by Saxonica? Are you using XSLT to try to create a CDATA section in the <code>Id</code> element? On the XSLT side you would need <code>&lt;xsl:output cdata-section-elements=&quot;Id&quot;&#47;&gt;</code> to achieve that, if the XSLT processor is in charge of the serialization."}, {"owner": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "reply_to_user": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1566448270, "post_id": 57590971, "comment_id": 101660732, "body": "@MartinHonnen, XML file is such huge that I cannot load in memory as XML &amp; fire XQuery/use XSLT for modifying Source XML. Hence, I am using SAXONReader of <b>MSXML2</b> for reading XML line by line &amp; writing XML using MXXMLWriter of same library."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "edited": false, "score": 0, "creation_date": 1566448767, "post_id": 57595040, "comment_id": 101660826, "body": "thanks for sharing Lib info. but currently, I am processing data using VBA(Visual Basic Application). &amp; I don&#39;t know whether LEXEV can be directly handled with VBA / I need to preprocess XML outside VBA."}, {"owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "reply_to_user": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "edited": false, "score": 0, "creation_date": 1566470131, "post_id": 57595040, "comment_id": 101670233, "body": "You tagged the question &quot;saxon&quot; which confused me."}], "tags": [], "owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "is_accepted": false, "score": 0, "last_activity_date": 1566401672, "creation_date": 1566401672, "answer_id": 57595040, "question_id": 57590971, "link": "https://stackoverflow.com/questions/57590971/lexical-cdata-is-not-getting-detected-by-mxxml2-ivbsaxlexicalhandler-star/57595040#57595040", "title": "Lexical &lt;![CDATA[]]&gt; is not getting detected by MXXML2.IVBSAXLexicalHandler_startCDATA", "body": "<p>CDATA is not part of the XDM data model used by XSLT: <code>&lt;![CDATA[IPMS_TEST_DS_2 &amp; 13]]&gt;</code> and <code>IPMS_TEST_DS_2 &amp;amp; 13</code> are different, but completely synonymous, representations of a text node with string value <code>IPMS_TEST_DS_2 &amp; 13</code>. An XSLT stylesheet cannot distinguish them.</p>\n\n<p>There's a processor called LEXEV from Andrew Welch that allows CDATA to be represented in the XDM data model. I've forgotten the details but it uses something like a processing instruction <code>&lt;?CDATA IPMS_TEST_DS_2 &amp; 13?&gt;</code>. You could use a similar technique in your SAX filter. Of course that wouldn't be distinguishable from an actual processing instruction named \"CDATA\".</p>\n"}, {"tags": [], "owner": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "is_accepted": true, "score": 0, "last_activity_date": 1566449794, "creation_date": 1566449794, "answer_id": 57602281, "question_id": 57590971, "link": "https://stackoverflow.com/questions/57590971/lexical-cdata-is-not-getting-detected-by-mxxml2-ivbsaxlexicalhandler-star/57602281#57602281", "title": "Lexical &lt;![CDATA[]]&gt; is not getting detected by MXXML2.IVBSAXLexicalHandler_startCDATA", "body": "<p>After many iterations over various options, I got to know the correct method of calling <em>SAXReader.putProperty</em></p>\n\n<p>It catches CDATA for writing into destination XML</p>\n\n<p><strong>Main Code Block</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Main()\n     Dim saxRdr As New SAXXMLReader60\n     Dim evntHndlr As New SAXEventHandlerClass\n\n     Set saxRdr.contentHandler = evntHndlr\n     Call saxRdr.putProperty(\"http://xml.org/sax/properties/lexical-handler\", evntHndlr.wrt)\n     '......above line makes event IVBSAXContentHandler_characters(strChars As String) to catch CDATA tag as it is......\n\n     saxRdr.parseURL \"test.xml\"\n\n     Set saxRdr = Nothing\nEnd sub\n</code></pre>\n\n<p><strong>SAXEventHandlerClass</strong>: <em>characters</em> event catches CDATA Lexical automatically into <em>strChars</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub IVBSAXContentHandler_characters(strChars As String)\n     'content writer logic goes here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57602281, "answer_count": 2, "score": 0, "last_activity_date": 1566469991, "creation_date": 1566388166, "last_edit_date": 1566469991, "question_id": 57590971, "link": "https://stackoverflow.com/questions/57590971/lexical-cdata-is-not-getting-detected-by-mxxml2-ivbsaxlexicalhandler-star", "title": "Lexical &lt;![CDATA[]]&gt; is not getting detected by MXXML2.IVBSAXLexicalHandler_startCDATA", "body": "<p>I am trying to handle Large XML file thru SAXON library in VBA </p>\n\n<p><strong>Source XML</strong> has following tag</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Id&gt;&lt;![CDATA[IPMS_TEST_DS_2 &amp; 13]]&gt;&lt;/Id&gt;\n</code></pre>\n\n<p><strong>Destination XML</strong> while writing into a destination file if am getting following xml tag</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Id&gt;IPMS_TEST_DS_2 &amp;amp; 13&lt;/Id&gt; &lt;!--- This should be as same as parent XML --&gt;\n</code></pre>\n\n<p>by implementing <strong>SAXXMLReader60</strong> as reader &amp; <strong>MXXMLWriter60</strong> as writer\n(Source : <a href=\"https://flylib.com/books/en/2.378.1.61/1/\" rel=\"nofollow noreferrer\">FlyLib.com</a>, <a href=\"https://docs.microsoft.com/en-us/previous-versions/aa926344%28v%3Dmsdn.10%29\" rel=\"nofollow noreferrer\">docs.microsoft.com</a> )</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Implements IVBSAXContentHandler\nImplements SAXXMLReader60\nImplements IVBSAXLexicalHandler\nImplements IVBSAXDTDHandler\n\nPrivate rdr As New SAXXMLReader60\nPrivate wrt As New MXXMLWriter60\n\nPrivate ch As IVBSAXContentHandler\nPrivate dtdh As IVBSAXDTDHandler\nPrivate lexh As IVBSAXLexicalHandler\n\nPrivate Sub Class_Initialize()\n\n    Set ch = wrt \n    Set dtdh = wrt\n\n    Call rdr.putProperty(\"http://xml.org/sax/properties/lexical-handler\", wrt)\n    Set lexh = wrt\n\nEnd Sub\n\n'....Following Event handlers are not getting triggered...\n\nPrivate Sub IVBSAXLexicalHandler_comment(strChars As String)\nEnd Sub\n\nPrivate Sub IVBSAXLexicalHandler_endCDATA()\n    lexh.endCDATA\nEnd Sub\n\nPrivate Sub IVBSAXLexicalHandler_endDTD()\nEnd Sub\n\nPrivate Sub IVBSAXLexicalHandler_endEntity(strName As String)\nEnd Sub\n\nPrivate Sub IVBSAXLexicalHandler_startCDATA()\n    lexh.startCDATA\nEnd Sub\n\n</code></pre>\n\n<p>Please suggest way to detect <em>&lt; ![CDATA[]]></em> while reading</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1566387954, "post_id": 57590841, "comment_id": 101639055, "body": "Use <code>Public Const</code> in your declaration statement."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1566388442, "post_id": 57590841, "comment_id": 101639335, "body": "@Dean - Does it work on your PC? I got a compilation error, when I try  <code>Public Const a = Worksheets(1).Range(&quot;A1&quot;)</code>?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1566388509, "post_id": 57590841, "comment_id": 101639363, "body": "Yes, this does not seem to be working... I have tried as well"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 1, "creation_date": 1566388674, "post_id": 57590841, "comment_id": 101639453, "body": "@Viyata I tested on <code>Public Const myStr = &quot;My String text&quot;</code>, that compiles.. But see above does not compile. Noted, thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1566387966, "creation_date": 1566387966, "answer_id": 57590915, "question_id": 57590841, "link": "https://stackoverflow.com/questions/57590841/set-variable-that-is-constant-for-all-subs/57590915#57590915", "title": "Set variable that is constant for all Subs", "body": "<p>A constant means it cannot be changed. For a variable, taking data from a cell, accessible from everywhere a public function without arguments would do the job:</p>\n\n<pre><code>Public Function FileNameINVREQ() As Variant\n    FileNameINVREQ = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"E1\").Value\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11956836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDwwKSky2sCx5kjNzr98UVIJ_jFv5HD7sr58dX9MQ=k-s128", "display_name": "Scarovese", "link": "https://stackoverflow.com/users/11956836/scarovese"}, "is_accepted": false, "score": 0, "last_activity_date": 1566388861, "creation_date": 1566388861, "answer_id": 57591151, "question_id": 57590841, "link": "https://stackoverflow.com/questions/57590841/set-variable-that-is-constant-for-all-subs/57591151#57591151", "title": "Set variable that is constant for all Subs", "body": "<p>Pulling a value from a worksheet is technically not a constant (since the value could change) so you'll need to use a variable instead. However, while you can declare variables as global, you can't set them outside of a sub or function.</p>\n\n<p>My suggestion would be to move both the declaration and setting the value to its own subroutine that you reference when you need to know the value.</p>\n\n<pre><code>Global FileNameINVREQ as string\n\nSub FileName()\n  FileNameINVREQ = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"E1\").Value\nEnd Sub\n</code></pre>\n\n<p>Going a step further, you could scrap it as a variable entirely and just change that FileName sub to a function! Hopefully one of these solutions works for you!</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 57590915, "answer_count": 2, "score": 0, "last_activity_date": 1566388861, "creation_date": 1566387735, "question_id": 57590841, "link": "https://stackoverflow.com/questions/57590841/set-variable-that-is-constant-for-all-subs", "title": "Set variable that is constant for all Subs", "body": "<p>I have several Sub's in my Module. I would like to set variable that I can use in all Subs below. How to do that? </p>\n\n<p>Let's say variable is a text from <code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"E1\").Value</code> and its name should be <code>FileNameINVREQ</code></p>\n\n<p>How to implement that in the code? I have tried:</p>\n\n<pre><code>Option Explicit\n\nConst FileNameINVREQ As String = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"E1\").Value\n\nPrivate Sub CreateNewINVREQtoMFiles()\n\n            ...\n            ' PD Name Or title.\n            oPVNew.PropertyDef = 0\n            oPVNew.TypedValue.SetValue MFDatatypeText, FileNameINVREQ\n            oPVsNew.Add -1, oPVNew\n            ...\nEnd Sub\nPrivate Sub CreateINVREQtoMFiles()\n\n        ...\n        oFile.SourceFilePath = Environ(\"Temp\") &amp; \"\\\" &amp; FileNameINVREQ &amp; \".docx\"\n        oFile.Title = FileNameINVREQ\n        oFile.extension = \"docx\"\n        oFiles.Add 0, oFile\n        ...\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566387914, "post_id": 57590820, "comment_id": 101639031, "body": "<code>&quot;=COUNTIF(base_valid!$B$6:$B$10|M2)&gt;0&quot;)</code> should it not be something like <code>&quot;=COUNTIF(base_valid!$B$6:$B$10;M2)&gt;0&quot;)</code> You typed <code>|</code> instead of <code>;</code> (or <code>,</code> if you got english version of Excel)"}, {"owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566388043, "post_id": 57590820, "comment_id": 101639110, "body": "Tried with , and ; and I get the same message! :("}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566388402, "post_id": 57590820, "comment_id": 101639313, "body": "What about <code>Set cond1 = rg.FormatConditions.Add(xlExpression, , &quot;=COUNTIF(base_valid!$B$6:$B$10;M2)&gt;0&quot;)</code> ? Replace COUNTIF with the name of the function on whatever language you are using Excel"}, {"owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566388514, "post_id": 57590820, "comment_id": 101639366, "body": "That way I get &quot;Argument not optional&quot;"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566388763, "post_id": 57590820, "comment_id": 101639506, "body": "It works perfect for me, what is the language of your excel? Also, what is the separator for arguments in functions in your excel? is it the <code>;</code> or the <code>,</code>? And make sure the sheet <code>base_valid</code> exists and make sure range <code>base_valid!$B$6:$B$10</code> is not merged and it does not contains any errors"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566389139, "post_id": 57590820, "comment_id": 101639695, "body": "Ok, It worked for me because i was adding references to SAME worksheet. In CF rules you cannot add references to ranges from other worksheets! so <code>base_valid!$B$6:$B$10</code> it&#39;s raising that error. Try it manually and a pop up alert will tell you"}], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "edited": false, "score": 0, "creation_date": 1566394250, "post_id": 57591426, "comment_id": 101643033, "body": "I added -&gt; Set cond1 = rg.FormatConditions.Add(xlExpression, , &quot;=CONTAR.SE(INDIRECTO(&quot;&quot;base_valid!$B$2:$B$6&quot;&quot;)|M2)&gt;0&quot;) and still no sucess... and if I use that same formula without the &quot;&quot; I get true in a cell"}, {"owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "edited": false, "score": 0, "creation_date": 1566394828, "post_id": 57591426, "comment_id": 101643432, "body": "Also added a watch to cond1 and I get the following in &quot;formula1&quot; --&gt; Formula1 : &quot;=CONTAR.SE(INDIRECTO(&quot;base_valid!$B$2:$B$6&quot;)|L1048571)&gt;0&quot;"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "edited": false, "score": 0, "creation_date": 1566455164, "post_id": 57591426, "comment_id": 101662683, "body": "why in <code>&quot;=CONTAR.SE(INDIRECTO(&quot;&quot;base_valid!$B$2:$B$6&quot;&quot;)|M2)&gt;0&quot;)</code> do you use <code>|</code>?"}, {"owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "edited": false, "score": 1, "creation_date": 1566545843, "post_id": 57591426, "comment_id": 101697512, "body": "because the separator I use is configured that way in Excel"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "edited": false, "score": 1, "creation_date": 1575459422, "post_id": 57591426, "comment_id": 104571859, "body": "@BigBen, edited this original answer to show also the option about using global scoped named ranges instead of INDIRECT :)"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 3, "last_activity_date": 1575459383, "last_edit_date": 1575459383, "creation_date": 1566389732, "answer_id": 57591426, "question_id": 57590820, "link": "https://stackoverflow.com/questions/57590820/conditional-formating-based-on-formula-in-another-sheet/57591426#57591426", "title": "Conditional formating based on formula in another sheet", "body": "<p>You have to be tricky here. Conditional formatting rules don't allow to add references to ranges on other worksheets, not even manually! An alert will pop up!</p>\n\n<p><a href=\"https://i.stack.imgur.com/5rb8I.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5rb8I.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The pop up alert says <em>can't use references to other workbooks or worksheets for criterias in conditional formatting</em></p>\n\n<p>But Excel got another function that can help, called INDIRECT</p>\n\n<blockquote>\n  <p><strong><a href=\"https://support.office.com/en-us/article/indirect-function-474b3a3a-8a26-4f44-b491-92b6306fa261\" rel=\"nofollow noreferrer\">INDIRECT function</a></strong></p>\n</blockquote>\n\n<p>This wonderful function will allow us to reference a range in a different worksheet but as it where on same worksheet. To reference a range, use the reference name as string (as text)</p>\n\n<p>So the formula we will be using as criteria is:</p>\n\n<p><code>=COUNTIF(INDIRECT(\"base_valid!$B$6:$B$10\");M2)</code></p>\n\n<p>So your VBA code needs to be fixed like this:</p>\n\n<pre><code>Dim rg As Range\nDim cond1 As FormatCondition, cond2 As FormatCondition, cond3 As FormatCondition\nSet rg = Range(\"M2\", Range(\"M2\").End(xlDown))\n\nSet cond1 = rg.FormatConditions.Add(xlExpression, , \"=COUNTIF(INDIRECT(\"\"base_valid!$B$6:$B$10\"\");M2)\")\n\nWith cond1\n    .Interior.Color = vbGreen\n    .Font.Color = vbWhite\nEnd With\n</code></pre>\n\n<p>This worked for me perfectly! After applying macro, I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dYCW4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dYCW4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>oh, my data in <code>base_valid</code> worksheet is like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Es7GO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Es7GO.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope you can adapt this to your needs.</p>\n\n<p><strong>UPDATE DECEMBER 2019:</strong></p>\n\n<p>Thanks to @BigBen, another option is using a global-scoped named range, instead of indirect. In this case, you can create a name, let's say, <code>MyValuesList</code>, which references range <code>base_valid!$B$6:$B$10</code>.</p>\n\n<p>Then, the CF rule would be <code>=COUNTIF(MyValuesList;M2)</code> and it would work properly.</p>\n\n<p>So if you use a named range, there is no need of using <code>INDIRECT</code>.</p>\n\n<p>Your code could be:</p>\n\n<pre><code>Set cond1 = rg.FormatConditions.Add(xlExpression, , \"=COUNTIF(MyValuesList;M2)\")\n</code></pre>\n"}], "owner": {"reputation": 334, "user_id": 4191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I06rh.png?s=128&g=1", "display_name": "Eunito", "link": "https://stackoverflow.com/users/4191849/eunito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 57591426, "answer_count": 1, "score": 3, "last_activity_date": 1575459383, "creation_date": 1566387661, "last_edit_date": 1566396536, "question_id": 57590820, "link": "https://stackoverflow.com/questions/57590820/conditional-formating-based-on-formula-in-another-sheet", "title": "Conditional formating based on formula in another sheet", "body": "<p>I have 2 Excel 2007 PT-PT sheets:\nOne (sheet1) has multiple columns to be validated.\nThe other (base_valid) has 5 columns to be validated.\nI'm trying to validate the \"regioes\" (M2) column using a macro:</p>\n\n<pre><code>Sub Validar_Regioes()\n    Dim rg As Range\n    Dim cond1 As FormatCondition, cond2 As FormatCondition, cond3 As FormatCondition\n    Set rg = Range(\"M2\", Range(\"M2\").End(xlDown))\n\n    'clear any existing conditional formatting\n    rg.FormatConditions.Delete\n\n    'define the rule for each conditional format\n    Set cond1 = rg.FormatConditions.Add(xlCellValue, xlExpression, \"=COUNTIF(base_valid!$B$6:$B$10|M2)&gt;0\")\n\n    'define the format applied for each conditional format\n    With cond1\n    .Interior.Color = vbGreen\n    .Font.Color = vbWhite\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The idea is to check if the region in M2 column matches any of the values in the base_valid regions range (base_valid!$B$6:$B$10)\nI keep getting \"invalid procedure call or argument\" message when I call the macro.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1566386837, "post_id": 57590561, "comment_id": 101638474, "body": "Why not explicitly reference the worksheets, instead of their relative position?"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 3, "creation_date": 1566387626, "post_id": 57590561, "comment_id": 101638882, "body": "This sounds like an XY problem (<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-probl&zwnj;&#8203;em</a>). Can you explain exactly what the issue is? There may be a better solution, along the lines @Luuklag alludes to."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1566388287, "post_id": 57590561, "comment_id": 101639242, "body": "@Luuklag I think that&#39;s covered in the paragraph &quot;The reason is: ...&quot;. The OP wants to dynamically update the &quot;menu bar&quot; (whatever it is) to match the order of the worksheets."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566388428, "post_id": 57590561, "comment_id": 101639329, "body": "There are 2 things that we need to consider here. <b>[1.]</b> Sheet1 is active and you move this sheet. This cannot be captured. <b>[2.]</b> Sheet1 is active and you move say Sheet2. This can be captured using the <code>Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566388594, "post_id": 57590561, "comment_id": 101639407, "body": "<b>[3.]</b> Workaround: Save the sheet tab order in a hidden sheet. In <code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)</code> and <code>Private Sub Workbook_BeforeClose(Cancel As Boolean)</code> check if the order of the sheets is same."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1566388636, "post_id": 57590561, "comment_id": 101639431, "body": "@CindyMeister I know what the reason is, that is why I commented. Instead of referencing the relative sheet positions in his button codes, he should use an explicit reference. Which would make capturing any change in order irrelevant."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1566388946, "post_id": 57590561, "comment_id": 101639600, "body": "Denny, I agree with @Luuklag. If you are referencing the sheet position then your code could behave unexpectedly. Use <code>Code Names</code> to work with them."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566390169, "post_id": 57590561, "comment_id": 101640316, "body": "When you drag a sheet, it becomes active, which means the menu sheet deactivates. So don&#39;t track the order of sheets, just regenerate the menu from the menu sheet&#39;s <code>Worksheet_Activate</code> each time."}, {"owner": {"reputation": 29, "user_id": 10451723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K4ZCiCax-mQ/AAAAAAAAAAI/AAAAAAAACwA/MqKkw-0sNG4/photo.jpg?sz=128", "display_name": "Dennys Lopes", "link": "https://stackoverflow.com/users/10451723/dennys-lopes"}, "edited": false, "score": 0, "creation_date": 1566392118, "post_id": 57590561, "comment_id": 101641585, "body": "<code>Workbook_SheetDeactivate</code> It&#39;s as close as I could get. But I&#39;m concerned about the performance since if the user changes tabs several times just to consult something, there may be a delay due to menu ordering (they are 15 to 20 tabs).  I don&#39;t know how many times the user would do this, and I wouldn&#39;t want to create a &quot;Refresh Menu&quot; button for that. The idea is, only when the user moves the tabs, the menu will be rearranged.  <code>Worksheet_Activate</code> and <code>Workbook_SheetDeactivate</code> will be called every time the user flips to another tab."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1566395270, "post_id": 57590561, "comment_id": 101643741, "body": "@DennysLopes what prevents you from explicitly referencing worksheets by name, rather then by index?"}, {"owner": {"reputation": 29, "user_id": 10451723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K4ZCiCax-mQ/AAAAAAAAAAI/AAAAAAAACwA/MqKkw-0sNG4/photo.jpg?sz=128", "display_name": "Dennys Lopes", "link": "https://stackoverflow.com/users/10451723/dennys-lopes"}, "edited": false, "score": 0, "creation_date": 1566400436, "post_id": 57590561, "comment_id": 101646716, "body": "The problem is not how to call the sheets. And to be honest I know it does not make sense .. but it is a client needed. We have a menu bar on the top of the tool. Each button calls one tab and it works properly regardless of the order of the tabs. I had done the menu following the order of the tabs just to make easier for the user. The point is, for some reason, the client requested this magical item. If he changes the order of the tabs (put the TAB 1 in the last), he would like to see the button (in menu bar) in the last as well."}, {"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1566475531, "post_id": 57590561, "comment_id": 101673222, "body": "If calculation is set to automatic, the <code>Worksheet_Calculate</code> event is triggered if the sheet is moved manually. You can check the order each time the event is triggered."}, {"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1566476936, "post_id": 57590561, "comment_id": 101674002, "body": "To limit the amount of checking, create a hidden sheet and call the <code>SHEET</code> function within the hidden sheet for each other sheet. Then just check the recalculation in the hidden sheet."}], "owner": {"reputation": 29, "user_id": 10451723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K4ZCiCax-mQ/AAAAAAAAAAI/AAAAAAAACwA/MqKkw-0sNG4/photo.jpg?sz=128", "display_name": "Dennys Lopes", "link": "https://stackoverflow.com/users/10451723/dennys-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566396615, "creation_date": 1566386701, "last_edit_date": 1566396615, "question_id": 57590561, "link": "https://stackoverflow.com/questions/57590561/is-there-any-way-event-in-vba-to-know-when-the-tab-order-is-manually-changed", "title": "Is there any way (event in VBA) to know when the tab order is manually changed?", "body": "<p>I have a workbook with 15 tabs.\nIs there any way to know when the tab order is manually changed?</p>\n\n<p>For example, the current scenario:\n<strong>TAB 1 | TAB 2 | TAB 3 | TAB 4 | TAB 5 | TAB 6 |...</strong></p>\n\n<p>If the user manually change the order of the tabs for:\n<strong>TAB 6 | TAB 2 | TAB 3 | TAB 4 | TAB 5 | TAB 1 |...</strong></p>\n\n<p>is there any event that captures this moment?\nIf someone adds a new Tab I can use:\n<em>Private Sub Workbook_NewSheet(ByVal Sh As Object)</em></p>\n\n<p>And for the change in order?</p>\n\n<p><strong>The reason is</strong>: there is a set of buttons, like a menu bar, following the order of the tabs. If someone changes the order, the tool needs to update the order of the buttons.</p>\n\n<p><em>PS: I cannot lock/protect the workbook.</em></p>\n\n<p>Tks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1566383516, "post_id": 57589607, "comment_id": 101636708, "body": "You are not assigning any value to <code>RowData</code>. What is it&#39;s value ?"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1566383918, "creation_date": 1566383918, "answer_id": 57589772, "question_id": 57589607, "link": "https://stackoverflow.com/questions/57589607/run-time-error-1004-application-defined-or-object-defined-error-cells/57589772#57589772", "title": "Run-time error &#39;1004&#39;: Application-defined or object-defined error .Cells", "body": "<p><strong>Problem:</strong> You are not assigning any value to <code>RowData</code></p>\n\n<p><strong>Try changing this loop</strong></p>\n\n<pre><code>'DELETE ANY 'IN' ROWS\nWith Worksheets(\"Movers_detail\")\n    If .Cells(rowData, 1).Value = \"IN\" Then\n        .Rows(rowData).EntireRow.Delete\n    End If\n    End With\n</code></pre>\n\n<p><strong>With:</strong></p>\n\n<pre><code>With Worksheets(\"Movers_detail\")\n    For rowData = 1 To .Cells(.Rows.count, \"A\").End(xlUp).row\n        If .Cells(rowData, 1).Value = \"IN\" Then\n            .Rows(rowData).EntireRow.Delete\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>Now we are looping through column A and checking for <code>IN</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9829408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57589772, "answer_count": 1, "score": 0, "last_activity_date": 1566383918, "creation_date": 1566383407, "question_id": 57589607, "link": "https://stackoverflow.com/questions/57589607/run-time-error-1004-application-defined-or-object-defined-error-cells", "title": "Run-time error &#39;1004&#39;: Application-defined or object-defined error .Cells", "body": "<p>I'm just trying to code a macro to delete certain rows where the cells in Column A equal specific text, but I'm receiving a 1004 error which highlights the line <strong>'If .Cells(rowData, 1).Value = \"IN\" Then'</strong></p>\n\n<p>I had a few issues prior to this that I managed to correct thanks to VBA's errors giving explanations of the problems but I've gotten a bit stuck on this one - sorry for my inexperience</p>\n\n<pre><code>Option Explicit\n\nSub Test()\nDim csvWorksheet As Worksheet\nDim rowData As Long\nDim rData As Range\n\n    'DELETE ANY 'IN' ROWS\n    With Worksheets(\"Movers_detail\")\n        If .Cells(rowData, 1).Value = \"IN\" Then\n            .Rows(rowData).EntireRow.Delete\n        End If\n        End With\n\n\nSet rData = csvWorksheet.Cells(1, 1).CurrentRegion\nWith rData\n    .EntireColumn.AutoFit\n\n    'draw border\n    .Borders(xlDiagonalDown).LineStyle = xlNone\n    .Borders(xlDiagonalUp).LineStyle = xlNone\n    With .Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With .Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With .Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With .Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With .Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With .Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd With\n\n'formatting the cell alignment\nColumns(\"A:C\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\n\n'formatting the page scaling for printing\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .PrintTitleRows = \"\"\n    .PrintTitleColumns = \"\"\nEnd With\nApplication.PrintCommunication = True\nActiveSheet.PageSetup.PrintArea = \"\"\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .LeftHeader = \"\"\n    .CenterHeader = \"\"\n    .RightHeader = \"\"\n    .LeftFooter = \"\"\n    .CenterFooter = \"\"\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0.7)\n    .RightMargin = Application.InchesToPoints(0.7)\n    .TopMargin = Application.InchesToPoints(0.75)\n    .BottomMargin = Application.InchesToPoints(0.75)\n    .HeaderMargin = Application.InchesToPoints(0.3)\n    .FooterMargin = Application.InchesToPoints(0.3)\n    .PrintHeadings = False\n    .PrintGridlines = False\n    .PrintComments = xlPrintNoComments\n    .PrintQuality = 600\n    .CenterHorizontally = True\n    .CenterVertically = False\n    .Orientation = xlPortrait\n    .Draft = False\n    .PaperSize = xlPaperA4\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 20\n    .PrintErrors = xlPrintErrorsDisplayed\n    .OddAndEvenPagesHeaderFooter = False\n    .DifferentFirstPageHeaderFooter = False\n    .ScaleWithDocHeaderFooter = True\n    .AlignMarginsHeaderFooter = True\n    .EvenPage.LeftHeader.Text = \"\"\n    .EvenPage.CenterHeader.Text = \"\"\n    .EvenPage.RightHeader.Text = \"\"\n    .EvenPage.LeftFooter.Text = \"\"\n    .EvenPage.CenterFooter.Text = \"\"\n    .EvenPage.RightFooter.Text = \"\"\n    .FirstPage.LeftHeader.Text = \"\"\n    .FirstPage.CenterHeader.Text = \"\"\n    .FirstPage.RightHeader.Text = \"\"\n    .FirstPage.LeftFooter.Text = \"\"\n    .FirstPage.CenterFooter.Text = \"\"\n    .FirstPage.RightFooter.Text = \"\"\nEnd With\nApplication.PrintCommunication = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1566384131, "post_id": 57589390, "comment_id": 101637011, "body": "What is the value of <code>strPath</code>? The reason I ask is because in one you are not using &quot;\\&quot; <code>strPath &amp; strFile</code> and in the other you are using it. <code>strPath &amp; &quot;\\&quot; &amp; strSave &amp; &quot;.pptx&quot;</code>"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1566386110, "post_id": 57589390, "comment_id": 101638073, "body": "You have <code>GoTo SaveAgain</code> but the only label in the code (apart from the error handling block) is called <code>tryAgain</code>. Is this a typo or is there more code that isn&#39;t shown here?"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566389147, "post_id": 57589390, "comment_id": 101639698, "body": "I added what <code>strPath</code>, <code>strFile</code> and <code>strSave</code> look like. Also <code>GoTo SaveAgain</code> is indeed <code>GoTo TryAgain</code>. I edited my question. Yes there is more code, a lot more than shown here. I fill diagrams, tables and textframes with data from my Excel workbook. As well as adding some pictures. But the code may not work at a point in the loop but if i rerun it the error does not appear at the same point in the loop."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566389500, "post_id": 57589390, "comment_id": 101639894, "body": "<code>strPath = &quot;S\\Folderxy&quot;</code> This is not a valid path"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566390063, "post_id": 57589390, "comment_id": 101640246, "body": "Sorry I fixed it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566390509, "post_id": 57589390, "comment_id": 101640515, "body": "Try this <code>pptPres.SaveAs strPath &amp; strSave &amp; &quot;.pptx&quot;,1</code> and then add one line <code>DoEvents</code> and finally add this <code>pptPres.Close(False)</code>"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566391041, "post_id": 57589390, "comment_id": 101640877, "body": "I will try it thanks :) It takes a long while for my macro to run. So I will probably only be able to tell you by tomorrow if it worked or not ;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566391134, "post_id": 57589390, "comment_id": 101640949, "body": "Whenever you are commenting, add &quot;@&quot; and then the name so that I can get an alert :)"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566458312, "post_id": 57589390, "comment_id": 101664107, "body": "@SiddharthRout The error did not occur again tonight. However all files are now saved in the <code>.ppt</code> file format. Checking with the docs I will try to save it as <code>.pptx</code> and then I will run it again tonight.  Also <code>pptPres.Close(False)</code> returned &quot;Wrong amount of arguments&quot;. So I went back to <code>pptPres.Close</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566459151, "post_id": 57589390, "comment_id": 101664582, "body": "For parameters see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation.saveas\" rel=\"nofollow noreferrer\">Presentation.SaveAs method (PowerPoint)</a>"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566459238, "post_id": 57589390, "comment_id": 101664631, "body": "@SiddharthRout you sure? I used <code>ppSaveAsOpenXMLPresentation</code> which is 24? Yea thanks for the link :) Also I deleted the <code>&amp; &quot;.pptx&quot;</code> as it would save it as <code>&quot;.pptx.pptx&quot;</code> ;)"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566459358, "post_id": 57589390, "comment_id": 101664686, "body": "Thanks a lot for your help, I will see if it will still work or if the error will reoccur. I will keep you updated."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566459407, "post_id": 57589390, "comment_id": 101664718, "body": "<code>Also I deleted the &amp; &quot;.pptx&quot; as it would save it as &quot;.pptx.pptx&quot;</code> I went with <code>strSave = &quot;newFilename&quot;</code> which did not have &quot;pptx&quot; ;)"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566806343, "post_id": 57589390, "comment_id": 101757645, "body": "@SiddharthRout I tested it again and it fixed the problem. If you want you can write it to an answer so that I can accept it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566818554, "post_id": 57589390, "comment_id": 101763469, "body": "Glad it was fixed. posted it."}, {"owner": {"reputation": 561, "user_id": 2043349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8PeD.png?s=128&g=1", "display_name": "Thierry Dalon", "link": "https://stackoverflow.com/users/2043349/thierry-dalon"}, "edited": false, "score": 0, "creation_date": 1612344190, "post_id": 57589390, "comment_id": 116734545, "body": "I have the same issue Permission denied error and Error Handling does not catch it"}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566547053, "post_id": 57612534, "comment_id": 101698017, "body": "As mentioned in my question, the Errorhandler <b>does not</b> pick up the error. Therefore I can not use an Errorhandler to solve my problem."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1566580769, "post_id": 57612534, "comment_id": 101714929, "body": "Your code has 2 problems: the use of Wait, which halts Excel, and the lack of error handling resetting, which means the error handler can only run once."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1566580647, "last_edit_date": 1566580647, "creation_date": 1566487059, "answer_id": 57612534, "question_id": 57589390, "link": "https://stackoverflow.com/questions/57589390/insuppressible-error-when-saving-powerpoint-file-in-excel-vba/57612534#57612534", "title": "Insuppressible Error when saving PowerPoint file in Excel VBA", "body": "<p>Application.Wait suspends all Excel activity including execution of your macro. It's not so useful for fixing timing problems. When I want to add a little time so that the program can finish I/O or clipboard tasks, Sleep is a better option. First add a declaration:</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n</code></pre>\n\n<p>Add error-trapping before the problem statement, including a statement to reset error handling after the problem:</p>\n\n<pre><code>TryCut1:\n  On Error GoTo TooFast1\n  objShape.TextFrame2.TextRange.Cut\n  On Error GoTo -1\n</code></pre>\n\n<p>Then add this for error handling. It waits for 10 milliseconds, then tries again:</p>\n\n<pre><code>TooFast1:\n  Sleep 10\n  Resume TryCut1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1566818514, "creation_date": 1566818514, "answer_id": 57656947, "question_id": 57589390, "link": "https://stackoverflow.com/questions/57589390/insuppressible-error-when-saving-powerpoint-file-in-excel-vba/57656947#57656947", "title": "Insuppressible Error when saving PowerPoint file in Excel VBA", "body": "<p>Follow these two things and you should be ok...</p>\n\n<ol>\n<li><p>Mention the File Format while saving. For example <code>pptPres.SaveAs strPath &amp; strSave &amp; \".pptx\",24 '&lt;~~ ppSaveAsOpenXMLPresentation</code>. Also ensure the <code>strPath &amp; strSave &amp; \".pptx\"</code> is the extact name of the fiel as you wanted it. Else tweak the variables accordingly.</p></li>\n<li><p>Always add <code>DoEvents</code> after you issue the save(or save as) statement and before the <code>.Close</code> statement so Excel can get enough time to finish it's tasks.</p></li>\n</ol>\n"}], "owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 57656947, "answer_count": 2, "score": 2, "last_activity_date": 1566818514, "creation_date": 1566382604, "last_edit_date": 1566390053, "question_id": 57589390, "link": "https://stackoverflow.com/questions/57589390/insuppressible-error-when-saving-powerpoint-file-in-excel-vba", "title": "Insuppressible Error when saving PowerPoint file in Excel VBA", "body": "<p><strong>Before this gets marked as a duplicate:</strong> It is not, as all the other saving errors seem to get a different <code>MsgBox</code>. </p>\n\n<p>I am writing a macro that opens and closes a PowerPoint Presentation from Excel. Now I have the issue that when I am trying to save the PowerPoint file I get a pop up Message Box:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k5lwD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k5lwD.png\" alt=\"ErrorMessage\"></a></p>\n\n<p>It says: \"PowerPoint-Error while saving the file.\"\nMy code:</p>\n\n<pre><code>Dim pptPres As PowerPoint.Presentation\nDim pptApp As PowerPoint.Application\n\nSet pptApp = New PowerPoint.Application\n\nstrPath = \"S:\\Folderxy\\\"\nstrFile = \"filename.pptm\"\nstrSave = \"newFilename\"\n\nSet pptPres = pptApp.Presentations.Open(strPath &amp; strFile, False, True, True)\n\nApplication.DisplayAlerts = False\n\n\nOn Error GoTo Errorhandler_tryAgain\n\ntryAgain:\n    pptApp.DisplayAlerts = ppAlertsNone\n    strSave = \"Test123\"\n    pptPres.SaveAs strPath &amp; strSave &amp; \".pptx\"\n    pptPres.Close\n\nExit Sub\n\nErrorhandler_tryAgain:\n      Debug.Print \"Errorhandler_tryAgain was opened!\"\n      Application.Wait DateAdd(\"s\", 1, Now) 'delay in seconds\n      GoTo TryAgain\n</code></pre>\n\n<blockquote>\n  <p><strong>First:</strong></p>\n  \n  <p>Even though I turned the <code>DisplayAlerts</code> off this one keeps popping up. However I can not easily reproduce this error. It occurs sometimes. Openening, closing and saving <code>*.pptx</code> files is part of a loop and surprisingly this error does not reoccur at the same file but it reoccurs about 2 times in a loop with 70 >files. </p>\n  \n  <p><strong>Second:</strong>\n  When I manually click enter the <code>RuntimeError 70: Permission Denied</code> is thrown. But then the VBE goes into the debug mode and my Errorhandler is not handling it. The Errohandler is an infinitive loop as I am saving the file on a server and sometimes it fails to save. However when I manually tried to save the document (both, on the server and on the desktop) I got the same \"PowerPoint-Error while saving the file.\" <code>MsgBox</code>. </p>\n</blockquote>\n\n<p>Now my question is how do I either get rid of the saving error (which seems to be impossible) or how to surppress that error so that my macro does not stop everytime it occurs. As I would like to run the macro overnight. </p>\n\n<p>In case anyone has experienced such a thing before and can help me out I would be very happy. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 5, "creation_date": 1566382685, "post_id": 57589330, "comment_id": 101636281, "body": "Use parenthesys only if you are getting the return value, if not remove them. <code>x = MsgBox(...)</code> or <code>MsgBox ...</code> or <code>Call MsgBox(...)</code> are valid calling syntax, but not <code>MsgBox(...)</code>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566382750, "post_id": 57589330, "comment_id": 101636312, "body": "You are not setting the return value from it to any variable."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566385491, "post_id": 57589330, "comment_id": 101637737, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/30962795/11683\">Title of Message box not setting up</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566385563, "post_id": 57589330, "comment_id": 101637770, "body": "Your last example is VB.NET. It is a different language."}], "answers": [{"tags": [], "owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "is_accepted": true, "score": 1, "last_activity_date": 1566384503, "creation_date": 1566384503, "answer_id": 57589950, "question_id": 57589330, "link": "https://stackoverflow.com/questions/57589330/how-to-use-msgbox/57589950#57589950", "title": "How to use Msgbox", "body": "<p>If you just want the message box to appear, you can do it like this:</p>\n\n<pre><code>Sub message()\nx = MsgBox(\"Do you want to continue?\", vbYesNo + vbCritical + vbDefaultButton2,\"MsgBox Demostration \")\nEnd Sub\n</code></pre>\n\n<p>In the Microsoft Official example you also have this part:</p>\n\n<pre><code>If Response = vbYes Then    ' User chose Yes.\n    MyString = \"Yes\"    ' Perform some action.\nElse    ' User chose No.\n    MyString = \"No\"    ' Perform some action.\nEnd If\n</code></pre>\n\n<p>If you want anything to happen when somebody clicks \"yes\" or \"no\", you need to include it here. </p>\n\n<p>So for example, in your case:</p>\n\n<pre><code>Sub message()\nIf MsgBox(\"Do you want to continue?\", vbYesNo + vbCritical + vbDefaultButton2,\"MsgBox Demostration \") = vbYes Then\n'any action you would like it to perform if yes\nElse\n'any action you would like it to perform if no\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 57589950, "answer_count": 1, "score": 0, "last_activity_date": 1566396607, "creation_date": 1566382375, "last_edit_date": 1566396607, "question_id": 57589330, "link": "https://stackoverflow.com/questions/57589330/how-to-use-msgbox", "title": "How to use Msgbox", "body": "<p>I've seen a lot of ways to do this but how I'm starting with vba I'd like to know all the ways to do this for after I can choose the way I liked the most.</p>\n\n<p>I saw this example of code in Microsoft Oficcial page:</p>\n\n<pre><code>Dim Msg, Style, Title, Help, Ctxt, Response, MyString\nMsg = \"Do you want to continue ?\"    ' Define message.\nStyle = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.\nTitle = \"MsgBox Demonstration\"    ' Define title.\nHelp = \"DEMO.HLP\"    ' Define Help file.\nCtxt = 1000    ' Define topic context. \n        ' Display message.\nResponse = MsgBox(Msg, Style, Title, Help, Ctxt)\n\n</code></pre>\n\n<p>I wanted to do the same but without variables, i mean, this:</p>\n\n<pre><code>MsgBox(\"Do you want to continue?\", vbYesNo + vbCritical + vbDefaultButton2,\"MsgBox Demostration \")\n</code></pre>\n\n<p>but this returns me an error, I think the example is doing exactly the same than me but without variables so I dont know why this doesn't work. </p>\n\n<p>I saw another people doing this:</p>\n\n<pre><code>MsgBox(\"Do you want to continue?\",msgboxstyle.vbYesNo,\"tittle\")\n\n</code></pre>\n\n<p>But this doesn't work for me either. </p>\n"}, {"tags": ["excel", "vba", "indexing", "match", "offset"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1566385194, "post_id": 57589174, "comment_id": 101637569, "body": "It might be helpful if you <a href=\"https://stackoverflow.com/posts/57589174/edit\">efit your question</a> to provide sample data and expected result. You can upload screencaps to <a href=\"http://imgur.com\" rel=\"nofollow noreferrer\">imgur.com</a> and link to them here"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566385423, "post_id": 57589174, "comment_id": 101637698, "body": "You mean that, given a cell in a row, you want to check if the next 5 rows got data or not? And if rows containing data are more than 5, then return <i>you cannot do this bla bla bla</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "edited": false, "score": 0, "creation_date": 1566409441, "post_id": 57592540, "comment_id": 101650725, "body": "You&#39;ve nailed it, home my explanation was not too complicated, Thank you so much!"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "edited": false, "score": 0, "creation_date": 1566409518, "post_id": 57592540, "comment_id": 101650758, "body": "That&#39;s great, glad I could help.  Cheers!"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 1, "last_activity_date": 1566393256, "creation_date": 1566393256, "answer_id": 57592540, "question_id": 57589174, "link": "https://stackoverflow.com/questions/57589174/offset-data-down-a-cell-if-cell-contains-data/57592540#57592540", "title": "Offset data down a cell if cell contains data", "body": "<p>The Evaluate method in this context returns a Range object.  So, we can assign the resulting range to an object variable, and then we can set up a For/Next loop to check the first five cells for an empty cell in which to enter the desired value.</p>\n\n<pre><code>Dim targetCell As Range\nSet targetCell = Evaluate(\"OFFSET(INDEX(A$6:A$72,MATCH(\"\"\" &amp; Me.ComboBox1.Value &amp; \"\"\",B$6:B$72,0)),1,0)\")\n\nDim emptyCellFound As Boolean\nemptyCellFound = False\n\nDim i As Long\nFor i = 0 To 4\n    If Len(targetCell.Offset(i, 0).Value) = 0 Then\n        targetCell.Offset(i, 0).Value = Change_Pool.Value\n        emptyCellFound = True\n        Exit For\n    End If\nNext i\n\nIf Not emptyCellFound Then\n    MsgBox \"No empty cell found!\", vbExclamation\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57592540, "answer_count": 1, "score": 0, "last_activity_date": 1566393256, "creation_date": 1566381892, "question_id": 57589174, "link": "https://stackoverflow.com/questions/57589174/offset-data-down-a-cell-if-cell-contains-data", "title": "Offset data down a cell if cell contains data", "body": "<p>I need to modify the below code to offset dynamically depending on if the cell contains data to a maximum of 5.</p>\n\n<p>Then if past 5, I want it to display a msg box to display a error.</p>\n\n<p>I have this working VB code:</p>\n\n<pre><code>Evaluate(\"OFFSET(INDEX(B$6:B$72,MATCH(\"\"\" &amp; Me.Pool_Numbers.Value &amp; \"\"\",A$6:A$72,0)),1,0)\") = Change_Pool.Value\n</code></pre>\n\n<p>I want it to look something like this, but I don't know how to implement it. </p>\n\n<pre><code>for every cell that contains data, \nset offset value +1 \n\nEvaluate(\"OFFSET(INDEX(B$6:B$72,MATCH(\"\"\" &amp; Me.Pool_Numbers.Value &amp; \"\"\",A$6:A$72,0)), * OFFSET AMOUNT * ,0)\") = Change_Pool.Value\n\nIf offset &gt; 5\nmsgbox \"You cannot do this blablabla\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566379984, "post_id": 57588535, "comment_id": 101634634, "body": "Try <code>Debug.Print path</code> and see if the correct path is printed or not. Also you will benefit by correctly indenting your code.Makes it easier to spot errors and understand."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1566380149, "post_id": 57588535, "comment_id": 101634757, "body": "You are using <code>Cells(i, 4)</code> on the path to the file before you defined what the variable <code>i</code> actually is! Maybe move the path inside your For Loop?"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1566380961, "post_id": 57588535, "comment_id": 101635267, "body": "I&#39;ve found the error, I&#39;d missed part of the file path rather stupidly."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1566380340, "creation_date": 1566380340, "answer_id": 57588716, "question_id": 57588535, "link": "https://stackoverflow.com/questions/57588535/attach-file-with-path-based-on-cell-value-to-email/57588716#57588716", "title": "Attach file with path based on cell value to email", "body": "<p>You are using Cells(i, 4) on the path to the file before you defined what the variable i actually is! Maybe move the path inside your For Loop?</p>\n\n<pre><code>Option Explicit\nOption Compare Text 'ignore case sensitivity when comparing strings\n\nSub SendEmail()\nDim objOutlook As Object\nDim objMail As Object\nDim OL As Outlook.Application, ES As Worksheet, r As Long, i As Long\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\nDim path As String\n\nr = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 5 To r\n    path = \"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 13) &amp; \").docx\"\n\n    With Cells(i, 7)\n        If .Value &lt;&gt; \"\" And Cells(i, 5) = \"Mobile Plant\" Then\n            With objMail\n                .To = Cells(i, 11).Value\n                .Subject = \"Your \" &amp; Cells(i, 5).Value &amp; \" licence - \" &amp; Cells(i, 4).Value\n                .Body = \"abc\"\n                .Attachments.Add path\n                .Display\n            End With\n        End If\n    End With\nNext i\n\nSet objOutlook = Nothing\nSet objMail = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566380340, "creation_date": 1566379722, "question_id": 57588535, "link": "https://stackoverflow.com/questions/57588535/attach-file-with-path-based-on-cell-value-to-email", "title": "Attach file with path based on cell value to email", "body": "<p>I am trying to send an email with the below code from my workbook. It works fine but only until I try to attach a file.</p>\n\n<p>The file is created by another VBA code and the file name is defined by the cell values specified below, but I get a debug error when I try to run the code and it won't attach. I've tested with a named path eg <code>C:test\\test.docx</code> and it works fine.</p>\n\n<p>How can I get it to accept the path based on the cell values? I've set it to <code>.Display</code> whilst testing rather than send.</p>\n\n<pre><code>Option Explicit\nOption Compare Text 'ignore case sensitivity when comparing strings\n\nSub SendEmail()\n\nDim objOutlook As Object\nDim objMail As Object\nDim OL As Outlook.Application, ES As Worksheet, r As Long, i As Long\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\nDim path As String\n\n\npath = \"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 13) &amp; \").docx\"\n\n\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 5 To r\n        With Cells(i, 7)\n\n            If .Value &lt;&gt; \"\" And Cells(i, 5) = \"Mobile Plant\" Then\n                With objMail\n                    .To = Cells(i, 11).Value\n                    .Subject = \"Your \" &amp; Cells(i, 5).Value &amp; \" licence - \" &amp; Cells(i, 4).Value\n                    .Body = \"abc\"\n                    .Attachments.Add path\n                    .Display\n\nEnd With\nEnd If\nEnd With\n\nNext i\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 2, "creation_date": 1566379777, "post_id": 57588420, "comment_id": 101634495, "body": "I think after <code>AutoFilter</code> your boss is <i>trying to select the blank cell in <code>20th</code> column</i>. That is leave the cursor at that cell. But in your case the cursor will be at the cell it was initially at before running the code."}, {"owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566380148, "post_id": 57588420, "comment_id": 101634756, "body": "Yeah, you are right. It was so simple! But I just could not have captured it. I knew it was looking for an empty cell but was kind of expecting a &quot;bigger&quot; difference between two approaches. Cheers!"}], "owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566379347, "creation_date": 1566379347, "question_id": 57588420, "link": "https://stackoverflow.com/questions/57588420/vba-auto-filter-the-difference-between-two-approaches", "title": "VBA auto filter - the difference between two approaches", "body": "<p>I try to understand the difference between this approach (the way my boss wanted me to do it):</p>\n\n<pre><code>Private Sub CommandButton_Click()\n    ActiveSheet.ListObjects(\"Table\").Range.AutoFilter Field:=20, Criteria1:= _\n        \"=some*\", Operator:=xlAnd\n    ActiveSheet.ListObjects(\"Table\").Range.AutoFilter Field:=30, Criteria1:= _\n        \"=else*\", Operator:=xlOr, Criteria2:=\"=else2\", Operator:=xlAnd\n\nDim i As Long\ni = 0\nDo\ni = i + 1\nLoop While Cells(i, 20) &lt;&gt; \"\"\nCells(i, 20).Select\nEnd Sub\n</code></pre>\n\n<p>and the way I wanted to auto filter it:</p>\n\n<pre><code>Private Sub CommandButton_Click()\n    ActiveSheet.ListObjects(\"Table\").Range.AutoFilter Field:=20, Criteria1:= _\n        \"=some*\", Operator:=xlAnd\n    ActiveSheet.ListObjects(\"Table\").Range.AutoFilter Field:=30, Criteria1:= _\n        \"=else*\", Operator:=xlOr, Criteria2:=\"=else2\", Operator:=xlAnd\n\nEnd Sub\n</code></pre>\n\n<p>When running a macro I do not see any change, so I guess I do not really understand what this lines do...</p>\n\n<pre><code>Dim i As Long\ni = 0\nDo\ni = i + 1\nLoop While Cells(i, 20) &lt;&gt; \"\"\nCells(i, 20).Select\n</code></pre>\n\n<p>Any suggestions on this matter?</p>\n"}, {"tags": ["excel", "vba", "csv"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 11947569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392352d3e446ed9204d0658aca1eade3?s=128&d=identicon&r=PG&f=1", "display_name": "samrb", "link": "https://stackoverflow.com/users/11947569/samrb"}, "edited": false, "score": 0, "creation_date": 1566381426, "post_id": 57588564, "comment_id": 101635536, "body": "Worked! Thanks! Any idea why the refreshing of the imported data would be adding spaces? I&#39;m puzzled"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 179, "user_id": 11947569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392352d3e446ed9204d0658aca1eade3?s=128&d=identicon&r=PG&f=1", "display_name": "samrb", "link": "https://stackoverflow.com/users/11947569/samrb"}, "edited": false, "score": 0, "creation_date": 1566381499, "post_id": 57588564, "comment_id": 101635578, "body": "@samrb that would really depend on how you are importing the data, not sure though to be honest..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1566379823, "creation_date": 1566379823, "answer_id": 57588564, "question_id": 57588389, "link": "https://stackoverflow.com/questions/57588389/how-to-remove-spaces-at-start-and-end-of-a-cell/57588564#57588564", "title": "How to remove spaces at start and end of a cell?", "body": "<p>How about the following, just took your code and simplified it, as you declared <code>db_range</code> as a Range and then tried to use it to specify the range using <code>Sheet1.Range(db_range)</code> which would take a string instead of a Range:</p>\n\n<pre><code>Sub Trim_Range()\nDim ws As Worksheet: Set ws = Sheet1\nDim LastRow As Long\nDim c As Range\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\nFor Each c In ws.Range(\"A6:J\" &amp; LastRow)\n    c.Value = Trim(c.Value)\nNext c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 11947569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392352d3e446ed9204d0658aca1eade3?s=128&d=identicon&r=PG&f=1", "display_name": "samrb", "link": "https://stackoverflow.com/users/11947569/samrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57588564, "answer_count": 1, "score": 0, "last_activity_date": 1569013614, "creation_date": 1566379265, "last_edit_date": 1569013614, "question_id": 57588389, "link": "https://stackoverflow.com/questions/57588389/how-to-remove-spaces-at-start-and-end-of-a-cell", "title": "How to remove spaces at start and end of a cell?", "body": "<p>I have an imported CSV in my spreadsheet. When I run a refresh macro it adds a space to the beginning and end of each cell.</p>\n\n<p>I'm trying to remedy it by having the same macro trim all the spaces at the start and end of a cell (not in between).</p>\n\n<p>Doing it on a single cell works without issue</p>\n\n<pre><code>Range(\"F10\").Value = Trim(Range(\"F10\").Value)\n</code></pre>\n\n<p>In a range it doesn't do anything, no error message, just no reaction</p>\n\n<pre><code>Dim cell As Range, areaToTrim As Range\nSet areaToTrim = Sheet1.Range(\"A6:J10\")\nFor Each cell In areaToTrim\n    cell.Value = Trim(cell.Value)\nNext cell\n</code></pre>\n\n<p>In reality, I don't want it to be A6 to J10, I just put this in to see if it worked with a range. I want it to be A6 to J last row. So I wanted my final code to be </p>\n\n<pre><code>Dim lastrowindex As Long\nlastrowindex = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n\nDim db_range_start As String\nDim db_range_end As String\n\ndb_range_start = \"A6\"\ndb_range_end = \"J\" &amp; lastrowindex\ndb_range_region = db_range_start &amp; \":\" &amp; db_range_end\n\nDim db_range As Range\nSet db_range = Range(db_range_region)\n\nDim cell As Range, areaToTrim As Range\nSet areaToTrim = Sheet1.Range(db_range)\nFor Each cell In areaToTrim\n    cell.Value = Trim(cell.Value)\nNext cell\n</code></pre>\n\n<p>But this throws a </p>\n\n<blockquote>\n  <p>Method Value of object Range failed.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1566379487, "post_id": 57588342, "comment_id": 101634308, "body": "Thank You for Your comment. Now by the line : Set rng2 = Sheetstarybpm.Range(myrange) I get the error Run time errror 21004, Method Range of object _Worksheet failed"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1566379645, "post_id": 57588342, "comment_id": 101634408, "body": "@Marc Oh yes, I see. What are you trying to set <code>rng2</code> to? You cannot pass a <code>Range</code> object through a <code>.Range</code> method. Is there a difference between <code>myrange</code> and <code>rng2</code>?"}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1566380794, "post_id": 57588342, "comment_id": 101635166, "body": "Oh Yes, You are right. It is the same. Thank You for your help!"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1566381628, "post_id": 57588342, "comment_id": 101635649, "body": "@Marc great. Please mark (no pun intended) this as your answer to close the ticket."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 0, "last_activity_date": 1566381584, "last_edit_date": 1566381584, "creation_date": 1566379100, "answer_id": 57588342, "question_id": 57588155, "link": "https://stackoverflow.com/questions/57588155/how-to-reffer-to-workbooks-worksheet-and-range-as-variables/57588342#57588342", "title": "How to reffer to workbooks-worksheet and range as variables", "body": "<p>You are using the object methods incorrectly. Once you have stored the <code>Sheetstarybpm</code> you can use this further... So when opening the workbook store this as a workbook object so you can reference it later on, if needed. Additionally, when setting your worksheet object you can now explicitly reference your workbook because you have stored it (much better coding practice). It is also recommended to explicitly define your sheet object references when setting your ranges. Please see amended code below.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Sheetstarybpm As Worksheet\nDim countrowsoldbpm1 As Long\nDim myWB As Workbook\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select BPM Report for previous month\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        oldbpm = .SelectedItems.Item(1)\nEnd With\n\nSet myWB = Workbooks.Open(oldbpm)\n\nSet Sheetstarybpm = myWB.ActiveSheet\n\ncountrowsoldbpm1 = Sheetstarybpm.Range(\"a10\", Range(\"a10\").End(xlDown)).Rows.Count\n\nSet myrange = Sheetstarybpm.Range(\"A10:CW\" &amp; countrowsoldbpm1)\n\n</code></pre>\n\n<p><strong>Edit</strong>: Removed <code>rng2</code> from the code because it is the same as <code>myrange</code>, as noted by OP in comments. </p>\n"}], "owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57588342, "answer_count": 1, "score": 0, "last_activity_date": 1566381823, "creation_date": 1566378466, "last_edit_date": 1566381823, "question_id": 57588155, "link": "https://stackoverflow.com/questions/57588155/how-to-reffer-to-workbooks-worksheet-and-range-as-variables", "title": "How to reffer to workbooks-worksheet and range as variables", "body": "<p>I get all the time runtime error 9, \u201csubscript out of range\u201d . Dont know how to do this. I get the error by the last line of code below.</p>\n\n<pre><code>Dim Sheetstarybpm As Worksheet\nDim countrowsoldbpm1 As Long\nDim rng2 As Range\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select BPM Report for previous month\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        oldbpm = .SelectedItems.Item(1)\nEnd With\n\nWorkbooks.Open oldbpm\n\nSet Sheetstarybpm = ActiveSheet\n\ncountrowsoldbpm1 = Range(\"a10\", Range(\"a10\").End(xlDown)).Rows.Count\n\nSet myrange = Range(\"A10:CW\" &amp; countrowsoldbpm1)\n\nSet rng2 = Workbooks(oldbpm).Worksheets(Sheetstarybpm).Range(myrange)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1566381877, "post_id": 57587961, "comment_id": 101635817, "body": "What&#39;s the error <i>message</i>? No one memorizes the numbers... And what line of code causes it?"}, {"owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566399063, "post_id": 57587961, "comment_id": 101645904, "body": "The error message is simply &quot;Error 400&quot;. I am unable to narrow down what line of code generates it as the error does not happen when the macro is executed from the VBA editor (neither by stepping into it, by running it with breakpoints or by just executing it in its entirety)."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566399281, "post_id": 57587961, "comment_id": 101646034, "body": "Put some <code>Debug.Print</code> lines in the code every few lines to narrow it down."}, {"owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566400872, "post_id": 57587961, "comment_id": 101646948, "body": "Doesn&#39;t Debug.Print send stuff to the immediate window? The macro runs without any problem from the VBA editor."}, {"owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566401031, "post_id": 57587961, "comment_id": 101647034, "body": "I added an &quot;On Error GoTo ErrorHandler&quot;, with an handler consisting of &quot;MsgBox Err.Description &amp; &quot; - &quot; &amp; Err.Number &amp; &quot; - &quot; &amp; Erl&quot;. Weirdly enough the goto works fine if I intentionally introduce an error in the code (to catch THAT error at least), but the error 400 is not affected in any way."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566401173, "post_id": 57587961, "comment_id": 101647109, "body": "Debug.Print prints to the Immediate Window, but it will do that even if the VBA Editor is behind the Excel window while the code is running. It doesn&#39;t change the focus at all. In some search &quot;hits&quot; I found the suggestion was to use &quot;On Error Resume Next&quot;, but you don&#39;t want that for the entire code, so locating the lines or block would be important."}, {"owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566402043, "post_id": 57587961, "comment_id": 101647557, "body": "So, apparently the error pops up before the first line of code is executed. after &quot;Sub refresh()&quot; and two line of comments, I added a Debug.Print &quot;1&quot;. this is not recorded when the execution fails with error 400"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566408733, "post_id": 57587961, "comment_id": 101650419, "body": "What is calling <code>sub refresh()</code>? If you put <code>On Error Resume Next</code> before the first line of code and <code>On Error GoTo 0</code> (or some other error handler label` after the first line of code, does that help?"}, {"owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566459645, "post_id": 57587961, "comment_id": 101664833, "body": "<code>sub refresh()</code> is the codeblock posted above.     Even with <code>On Error Resume Next</code> the issues still occurs at random."}], "owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566381946, "creation_date": 1566377846, "last_edit_date": 1566381946, "question_id": 57587961, "link": "https://stackoverflow.com/questions/57587961/elusive-error-400-in-excel-vba-macro-unable-to-understand-cause", "title": "Elusive &quot;Error 400&quot; in Excel VBA macro - unable to understand cause", "body": "<p>I have been bashing my head against an Error 400 that my VBA macro is throwing up seemingly at random, and I could really use some help.</p>\n\n<p>Info collected so far:</p>\n\n<ul>\n<li>The macro run flawlessly from the VBA editor, either by steeping into it, by running it with breakpoints or by just executing it in its entirety.</li>\n<li>When launched from a button it seems to have a random (I would estimate 50%) chance of popping up with error 400</li>\n<li>Same random error chance happens if the macro is launched from \"Macros > View Macro > Run\"</li>\n<li>The errors do not follow any obvious pattern (Like OK > error > Ok > error), sometimes the macro executes correctly 5 times in a row, sometimes I get good runs alternated by errors, sometimes several tries in a row turn up with errors</li>\n<li><p>When an error happens, it appears that none of the macro has been executed (for example, if I manually unprotected a sheet, it stays unprotected after a failed attempt)</p>\n\n<pre><code>ThisWorkbook.Activate\nThisWorkbook.Unprotect \"abc123\"\nApplication.Calculation = xlCalculateManual\nApplication.ScreenUpdating = False\n\nThisWorkbook.Sheets(\"Cyclades Data\").Unprotect \"abc123\"\nThisWorkbook.Sheets(\"Cyclades Data\").Activate\nThisWorkbook.Connections(\"Cyclades\").Refresh\n    DoEvents\nCalculate\n    DoEvents\nThisWorkbook.Sheets(\"Cyclades Data\").Protect Password:=\"abc123\", UserInterFaceOnly:=True\n\nThisWorkbook.Sheets(\"Shifts labour entry\").Protect Password:=\"abc123\", UserInterFaceOnly:=True\n\nThisWorkbook.Sheets(\"Daily Meeting Sheet\").Unprotect \"abc123\"\nThisWorkbook.Sheets(\"Daily Meeting Sheet\").Activate\nThisWorkbook.PivotCaches(1).Refresh\n    DoEvents\nCalculate\n    DoEvents\nThisWorkbook.Sheets(\"Daily Meeting Sheet\").Protect Password:=\"abc123\", AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True, UserInterFaceOnly:=True\n\nThisWorkbook.Connections(\"Query - Cyclades\").OLEDBConnection.Refresh\n    DoEvents\nThisWorkbook.Connections(\"Query - Shifts\").OLEDBConnection.Refresh\n    DoEvents\nCalculate\n    DoEvents\n\nThisWorkbook.Sheets(\"Utilization\").Unprotect \"abc123\"\nThisWorkbook.Sheets(\"Utilization\").Activate\nThisWorkbook.Connections(\"Query - Utilization(1)\").Refresh\n    DoEvents\nCalculate\n    DoEvents\nThisWorkbook.Sheets(\"Utilization\").Protect Password:=\"abc123\", UserInterFaceOnly:=True\n\nThisWorkbook.Sheets(\"Pivot chart data\").Protect Password:=\"abc123\", UserInterFaceOnly:=True\n\nThisWorkbook.Sheets(\"Daily Meeting Sheet\").Activate\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nThisWorkbook.Protect \"abc123\"\n</code></pre></li>\n</ul>\n\n<p>Important notes:<br>\nOffice 365 - Excel version 1907<br>\nAll connections have \"enable background refresh\" unchecked.</p>\n\n<p>Expected result:<br>\nEverything is refreshed in the correct order and everything is protected after the execution</p>\n"}, {"tags": ["vba", "spell-checking"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9375893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5168a85ffaa7f5fbfe668a9149e7a47b?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/9375893/ken"}, "edited": false, "score": 0, "creation_date": 1566428681, "post_id": 57588187, "comment_id": 101657465, "body": "The reference documentation does not explain why the Count property differs from the number of items in the CustomDictionaries collection or how an active custom dictionary can be identified.except to say that active custom dictionaries are marked with a check in the dialog box."}], "tags": [], "owner": {"reputation": 1319, "user_id": 1017121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iVW1t.jpg?s=128&g=1", "display_name": "Christiaan Nieuwlaat", "link": "https://stackoverflow.com/users/1017121/christiaan-nieuwlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1566378569, "creation_date": 1566378569, "answer_id": 57588187, "question_id": 57587945, "link": "https://stackoverflow.com/questions/57587945/how-do-i-determine-in-vba-if-a-custom-spelling-dictionary-is-active/57588187#57588187", "title": "How do I determine in VBA if a custom spelling dictionary is active?", "body": "<p>As per the API documentation on the Office Dev Center for Microsoft Word VBA, the <code>Application.CustomDictionaries</code> property <em>returns a Dictionaries object that represents the collection of <strong>active</strong> custom dictionaries</em></p>\n\n<p>The reference documentation for <code>Application.CustomDictionaries</code> on the Office Dev Center can be found <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.application.customdictionaries\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Hope it helps :-).</p>\n"}], "owner": {"reputation": 13, "user_id": 9375893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5168a85ffaa7f5fbfe668a9149e7a47b?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/9375893/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566378569, "creation_date": 1566377769, "question_id": 57587945, "link": "https://stackoverflow.com/questions/57587945/how-do-i-determine-in-vba-if-a-custom-spelling-dictionary-is-active", "title": "How do I determine in VBA if a custom spelling dictionary is active?", "body": "<p>How do I determine in VBA if a custom spelling dictionary is active?</p>\n\n<p>I have 4 custom spelling dictionaries Dict1, Dict2, Dict3 and Dict4. </p>\n\n<p>Dict2 and Dict3 have clear tick boxes alongside their entries in the Custom Dictionary dialog box so that they are inactive (File > Options > Proofing > Custom Dictionaries). I am trying to determine in VBA what custom dictionaries are activated. </p>\n\n<p>Method 1 lists all active and inactive custom dictionaries:\nDict1\nDict2\nDict3\nDict4</p>\n\n<p>Method 2. I would expect that the Count property would give 4 which is the total number of dictionaries in the collection, but it actually gives the number of active custom dictionaries which in this example is 2. The result is:\nDict1\nDict2</p>\n\n<pre><code>Dim D As Dictionary\nDim k As Long\nDim s As String  \n\n' **** method 1 ****\ns = \"\"\nFor Each D In Application.CustomDictionaries\n   s = s &amp; D.Name &amp; vbCrLf\nNext D\nMsgBox s\n\n' **** method 2 ****\ns = \"\"\nFor k = 1 To Application.CustomDictionaries.Count\n    s = s &amp; Application.CustomDictionaries(k).Name &amp; vbCrLf\nNext k\nMsgBox s\n</code></pre>\n\n<p>What I want is a list of only the active dictionaries which in the example should be Dict1 and Dict4. How can I achieve this? Is there an undocumented property that flags a dictionary as being active \u2013 as per the tick boxes in the dialog box?</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11955589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1b9f070d3b8ce2ec1c3cc6a9181d1f?s=128&d=identicon&r=PG&f=1", "display_name": "BossHard", "link": "https://stackoverflow.com/users/11955589/bosshard"}, "edited": false, "score": 0, "creation_date": 1566452623, "post_id": 57587003, "comment_id": 101661784, "body": "Hi Aucuparia,   The code is working well. The issue that I&#39;m having now is that in cell U13, I have it referencing another cell (from another sheet), which is in turn, referencing an indexed list. I found that the sheet only changes when I manually enter the text &quot;NPS&quot;, &quot;Brand Health&quot;, etc, but NOT when I have a formula in it (=&#39;anothercell&#39;!c21).  So basically, CellU13 is referencing (=&#39;Lists and Code&#39;!C21) and that cell has =INDEX(&#39;Lists and Code&#39;!E1:E8,&#39;Lists and Code&#39;!F1) in it.   Any ideas why it doesn&#39;t like the formula in the cell and prefers typed text?"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "reply_to_user": {"reputation": 17, "user_id": 11955589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1b9f070d3b8ce2ec1c3cc6a9181d1f?s=128&d=identicon&r=PG&f=1", "display_name": "BossHard", "link": "https://stackoverflow.com/users/11955589/bosshard"}, "edited": false, "score": 0, "creation_date": 1566460716, "post_id": 57587003, "comment_id": 101665394, "body": "See the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">documentation for Worksheet_Change</a> - &quot;This event does not occur when cells change during a recalculation. Use the Calculate event to trap a sheet recalculation.&quot;"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "reply_to_user": {"reputation": 17, "user_id": 11955589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1b9f070d3b8ce2ec1c3cc6a9181d1f?s=128&d=identicon&r=PG&f=1", "display_name": "BossHard", "link": "https://stackoverflow.com/users/11955589/bosshard"}, "edited": false, "score": 0, "creation_date": 1566460775, "post_id": 57587003, "comment_id": 101665427, "body": "Note that the <code>Calculate</code> event doesn&#39;t return a target, so you either need to store the previous value of your cell, or run every time (could be slow).  but this is turning into another question..."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 0, "last_activity_date": 1566374475, "creation_date": 1566374475, "answer_id": 57587003, "question_id": 57586726, "link": "https://stackoverflow.com/questions/57586726/how-to-hide-cell-rows-in-excel/57587003#57587003", "title": "How to hide cell rows in Excel", "body": "<p>You are almost there - your guess was right.  You just need to unhide all the rows before you hide the right ones based on the selection.</p>\n\n<p>The first sub you posted is trying to do some unhiding, but it's only unhiding a few rows - and as you can't control what order the user selects the values in, it's probably trying to unhide the wrong ones.  (Work through what happens if a user selects \"Brand Health\" followed by \"Shows\").</p>\n\n<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim ws As Worksheet\n\n    On Error GoTo errHandler\n\n    Application.ScreenUpdating = False\n\n    Set ws = Target.Worksheet\n    If Not Application.Intersect(ws.Range(\"U13\"), Range(Target.Address)) Is Nothing Then\n        ws.Rows(\"19:148\").Hidden = False                'edit this to include all the rows that could be hidden\n        Select Case Range(\"U13\").Value\n            Case Is = \"Brand Health\"\n                ws.Rows(\"19:39\").Hidden = True\n            Case Is = \"Brand Imagery\"\n                ws.Rows(\"38:60\").Hidden = True\n            Case Is = \"NPS\"\n                ws.Rows(\"30:82\").Hidden = True\n            Case Is = \"Talent\"\n                ws.Rows(\"35:103\").Hidden = True\n            Case Is = \"Shows\"\n                ws.Rows(\"37:127\").Hidden = True\n        End Select\n    End If\n    Application.ScreenUpdating = True\n    Exit Sub\n\nerrHandler:\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I've made a few other improvements:</p>\n\n<ul>\n<li><code>ActiveSheet.Activate</code> wasn't doing anything</li>\n<li>You shouldn't rely on a particular sheet being the active one - what if the user changes it halfway through your macro?  So I get the right worksheet at the start and use that throughout (make sure we are always working on the correct sheet)</li>\n<li><code>Target</code> could be a range of cells; you are only interested in the value of <code>U13</code> so make that the condition for the <code>Select Case</code></li>\n<li>it's neater and faster to turn off screen updating - making sure it always gets turned on afterwards (even if there's an error).</li>\n<li><code>Rows(\"xx:yy\")</code> returns whole rows so there's no need for <code>EntireRow</code></li>\n</ul>\n"}], "owner": {"reputation": 17, "user_id": 11955589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1b9f070d3b8ce2ec1c3cc6a9181d1f?s=128&d=identicon&r=PG&f=1", "display_name": "BossHard", "link": "https://stackoverflow.com/users/11955589/bosshard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57587003, "answer_count": 1, "score": 0, "last_activity_date": 1566374475, "creation_date": 1566373231, "last_edit_date": 1566373308, "question_id": 57586726, "link": "https://stackoverflow.com/questions/57586726/how-to-hide-cell-rows-in-excel", "title": "How to hide cell rows in Excel", "body": "<p>Thanks in advance for your help. I have been working on this for a few days now and have tried a few different options. What I need done is to hide specific rows of an excel sheet based on the contents of an active X dropdown. I have indexed the dropdown to a cell and every time the user changes the dropdown selection, the indexed cell contains their selection as either text or number (whichever makes it easiest to code - I've been trying both). I want to keep the code as close to how it is at the moment if possible. I'm sure there are shorter/ more convenient methods, but I just want this over. I think the issue is that when the user selects a new option from the dropdown, the macro isnt refreshing and showing ALL rows again before it begins to hide the new rows. As a result, I just end up with a whole bunch of hidden rows based on what was originally selected. I hope that makes sense.  </p>\n\n<p>See the code below for what I've already tried. I also tried this one too, but had the same issue (that the macro wasnt refreshing and showing ALL rows before applying another Hide function)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nActiveSheet.Activate\nIf Not Application.Intersect(Range(\"U13\"), Range(Target.Address)) Is Nothing Then\n    Select Case Target.Value\n    Case Is = \"Brand Health\": Rows(\"19:39\").EntireRow.Hidden = True\n                                  Rows(\"40:60\").EntireRow.Hidden = False\n    Case Is = \"Brand Imagery\": Rows(\"38:60\").EntireRow.Hidden = True\n                                   Rows(\"61:81\").EntireRow.Hidden = False\n    Case Is = \"NPS\": Rows(\"30:82\").EntireRow.Hidden = True\n                         Rows(\"83:102\").EntireRow.Hidden = False\n    Case Is = \"Talent\": Rows(\"35:103\").EntireRow.Hidden = True\n                            Rows(\"104:126\").EntireRow.Hidden = False\n    Case Is = \"Shows\": Rows(\"37:127\").EntireRow.Hidden = True\n                           Rows(\"128:148\").EntireRow.Hidden = False\n\n\n    End Select\n\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target`enter code here` As Range)\n Sheets(\"Brand Tracking Dashboard\").Rows(\"1:1000\").EntireRow.Hidden = False ' Move this to the top\n If Target.Address = (\"$U$13\") And Target.Value = 1 Then\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"19:39\").EntireRow.Hidden = True\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"59:1000\").EntireRow.Hidden = True\n ElseIf Target.Address = (\"$u$13\") And Target.Value = 2 Then\n    Sheets(\"Brand Tracking Dashboard\").Rows(\"43:63\").EntireRow.Hidden = True\n    Sheets(\"Brand Tracking Dashboard\").Rows(\"80:1000\").EntireRow.Hidden = True\n ElseIf Target.Address = (\"$u$13\") And Target.Value = 3 Then\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"32:84\").EntireRow.Hidden = True\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"101:1000\").EntireRow.Hidden = True\n ElseIf Target.Address = (\"$u$13\") And Target.Value = 4 Then\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"37:106\").EntireRow.Hidden = True\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"121:1000\").EntireRow.Hidden = True\n ElseIf Target.Address = (\"$u$13\") And Target.Value = 5 Then\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"37:129\").EntireRow.Hidden = True\n     Sheets(\"Brand Tracking Dashboard\").Rows(\"145:1000\").EntireRow.Hidden = True\n     End If\nEnd Sub\n</code></pre>\n\n<p>What should happen is that after the user makes a selection, I guess the logic should be that the sheet is told to show ALL rows before applying the hide line command.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1566373136, "post_id": 57586558, "comment_id": 101631066, "body": "meaning <code>CONTADOR2</code> ?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 1, "creation_date": 1566375164, "post_id": 57586558, "comment_id": 101631995, "body": "@Dean in your code you use <code>CONTADOR</code> &amp; <code>CONTADOR2</code> without declaring and assigning values to these variables."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1566375724, "post_id": 57586558, "comment_id": 101632245, "body": "@Error1004 this is purely a copy of the OP original post. The procedure is aimed at giving the OP the needed structure to correct and implement the understanding to their code. If you still deem it absolutely necessary for me to include these declarations I will."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1566376583, "post_id": 57586558, "comment_id": 101632669, "body": "@Dean no need to take any action."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 2, "last_activity_date": 1566375929, "last_edit_date": 1566375929, "creation_date": 1566372544, "answer_id": 57586558, "question_id": 57586497, "link": "https://stackoverflow.com/questions/57586497/column-values-2-by-2/57586558#57586558", "title": "Column values 2 by 2", "body": "<p>You are declaring <code>fila</code> in your <code>For</code> loop each time, hence each time you are looping, <code>fila</code> = 2. You just need to restructure your code a bit. Note, declare outside of the <code>For</code> loop and set to 1 before entering the <code>For</code> loop. Also, increment <em>after</em> inserting the value. See below.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Contar2()\n\n    Dim fila As Integer\n    Dim CONTADOR2 as Long\n\n    fila = 1\n\n    For CONTADOR2 = 2 To 10 Step 2\n        Application.ActiveSheet.Cells(fila, 5) = CONTADOR2\n        fila = fila + 1\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>: Requested to declare <code>CONTADOR2</code>, and corrected setting value to <code>CONTADOR2</code></p>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": false, "score": 1, "last_activity_date": 1566372550, "creation_date": 1566372550, "answer_id": 57586560, "question_id": 57586497, "link": "https://stackoverflow.com/questions/57586497/column-values-2-by-2/57586560#57586560", "title": "Column values 2 by 2", "body": "<p>Set <code>fila</code> to 1 before loop, move <code>fila = fila + 1</code> to the end of the loop like this:</p>\n\n<pre><code>Sub Contar2()\n    Dim fila As Integer\n    fila = 1\n    For CONTADOR2 = 2 To 10 Step 2\n        Application.ActiveSheet.Cells(fila, 5) = CONTADOR2\n        fila = fila + 1\n    Next CONTADOR2\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1566375422, "last_edit_date": 1566375422, "creation_date": 1566375080, "answer_id": 57587185, "question_id": 57586497, "link": "https://stackoverflow.com/questions/57586497/column-values-2-by-2/57587185#57587185", "title": "Column values 2 by 2", "body": "<p>You could use <code>Do until</code> method which is easier to read (in my opinion).</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Value As Long, i As Long\n\n    'i represent the starting row\n    i = 1\n    Value = 2\n\n    Do Until Value &gt; 10\n\n        With ActiveSheet\n            .Cells(i, 5) = Value\n            Value = Value + 2\n            i = i + 1\n        End With\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<ul>\n<li>In your answer you dont declare <code>CONTADOR2</code> &amp; <code>CONTADOR</code> and assign values to then</li>\n<li>It s better to use <code>Option Explicit</code> at the top of your code to avoid such mistakes</li>\n<li>It s better to avoid <code>ActiveSheet</code> and refer to the sheet you want using it s name</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1566377549, "last_edit_date": 1566377549, "creation_date": 1566377224, "answer_id": 57587771, "question_id": 57586497, "link": "https://stackoverflow.com/questions/57586497/column-values-2-by-2/57587771#57587771", "title": "Column values 2 by 2", "body": "<p>You can achieve the same <strong>WITHOUT</strong> using a loop...</p>\n\n<pre><code>With Sheet1 '&lt;~~ Change this to the relevant sheet\n    .Range(\"E1\").Value = 2\n    .Columns(5).DataSeries Rowcol:=xlColumns, Type:=xlLinear, _\n                           Step:=2, Stop:=10, Trend:=False\nEnd With\n</code></pre>\n\n<p>If you have to do this manually, you would do the following</p>\n\n<ol>\n<li>Type <code>2</code> in cell E1</li>\n<li>Select the Entire E column.</li>\n<li>Go to Home Tab \u2013 Fill, and click on Series</li>\n<li>Series in \u2013 select Columns.</li>\n<li>Type \u2013 select Linear.</li>\n<li>Step Value \u2013 2</li>\n<li>Stop Value \u2013 10</li>\n<li>Press Ok.</li>\n</ol>\n"}], "owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57586558, "answer_count": 4, "score": 2, "last_activity_date": 1566381979, "creation_date": 1566372313, "last_edit_date": 1566381979, "question_id": 57586497, "link": "https://stackoverflow.com/questions/57586497/column-values-2-by-2", "title": "Column values 2 by 2", "body": "<p>I want to get a column with values 2 to 10 but 2 by 2, I mean, with values (2,4,6,8,10).</p>\n\n<p>I made this code:</p>\n\n<pre><code>Sub Contar2()\n    For CONTADOR2 = 2 To 10 Step 2\n        Dim fila As Integer\n        fila = 1\n        fila = fila + 1\n        Application.ActiveSheet.Cells(fila, 5) = CONTADOR\n    Next\nEnd Sub\n</code></pre>\n\n<p>But this returns me the value of 10 in cell(2,5). I don\u00b4t know how's reading this code. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 3, "last_activity_date": 1566373947, "creation_date": 1566373947, "answer_id": 57586880, "question_id": 57586442, "link": "https://stackoverflow.com/questions/57586442/find-value-in-row-by-column-names/57586880#57586880", "title": "Find value in row by column names", "body": "<p>Let s assume that:</p>\n\n<ul>\n<li><code>Headers</code> appears in the first row</li>\n</ul>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastColumn As Long, LastRow As Long\n    Dim IDColumnNo As Range, DateColumnNo As Range, IDposition As Range\n    Dim strID As String\n    Dim dtDate As Date\n\n    'Set the ID you want to search for. Change to fullfil you needs\n    strID = \"w\"\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find the last row of the first column\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        'Find the last column of the first row\n        LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        'Find which is the column with the IDs searching for the Header \"ID\"\n        Set IDColumnNo = .Range(.Cells(1, 1), .Cells(LastRow, LastColumn)).Find(\"ID\", LookIn:=xlValues, Lookat:=xlWhole)\n\n        'Find which is the column with the Dates searching for the Header \"Date\"\n        Set DateColumnNo = .Range(.Cells(1, 1), .Cells(LastRow, LastColumn)).Find(\"Date\", LookIn:=xlValues, Lookat:=xlWhole)\n\n        If Not IDColumnNo Is Nothing And Not DateColumnNo Is Nothing Then\n\n            'Find which the Id we want\"\n            Set IDposition = .Range(.Cells(2, IDColumnNo.Column), .Cells(LastRow, IDColumnNo.Column)).Find(strID, LookIn:=xlValues, Lookat:=xlWhole)\n\n            If Not IDposition Is Nothing Then\n                dtDate = .Cells(IDposition.Row, DateColumnNo.Column).Value\n            Else\n                MsgBox \"ID is missing!\"\n            End If\n\n        Else\n\n            MsgBox \"ID, Date or both headers are missing!\"\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 9573838, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MKXwU2R80e0/AAAAAAAAAAI/AAAAAAAAADM/La93Mvo0dnE/photo.jpg?sz=128", "display_name": "Rishi Mehta", "link": "https://stackoverflow.com/users/9573838/rishi-mehta"}, "is_accepted": false, "score": 1, "last_activity_date": 1566374720, "creation_date": 1566374720, "answer_id": 57587079, "question_id": 57586442, "link": "https://stackoverflow.com/questions/57586442/find-value-in-row-by-column-names/57587079#57587079", "title": "Find value in row by column names", "body": "<p>Assuming you need to lookup the column named \"ID\" and return the value from column \"Status\", you may use the following formula</p>\n\n<pre><code>=OFFSET(INDIRECT(ADDRESS(1,MATCH(\"ID\",A1:E1,0))),MATCH(K1,OFFSET(INDIRECT(ADDRESS(1,MATCH(\"ID\",A1:E1,0))),1,0,100,1),0),MATCH(\"Status\",A1:E1,0)-MATCH(\"ID\",A1:E1,0),1,1)\n</code></pre>\n\n<p>Here the value to be looked up is in cell <code>K1</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/ncgh8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ncgh8.png\" alt=\"enter image description here\"></a></p>\n\n<p>You would see that if status column is moved to say column D in above screenshot, the Status value returned in K2 is different</p>\n\n<p><a href=\"https://i.stack.imgur.com/hOYbD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hOYbD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just for fun, I changed the name of column A to Status and the formula now returned the value from that column</p>\n\n<p><a href=\"https://i.stack.imgur.com/GbR8d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GbR8d.png\" alt=\"enter image description here\"></a></p>\n\n<p>So it seems to be pretty generic :)</p>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1566375444, "creation_date": 1566375444, "answer_id": 57587275, "question_id": 57586442, "link": "https://stackoverflow.com/questions/57586442/find-value-in-row-by-column-names/57587275#57587275", "title": "Find value in row by column names", "body": "<p>Convert your data to a table. Your data right now is kind of like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w8FwC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w8FwC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To quickly create a table in Excel, do the following:</p>\n\n<ol>\n<li>Select the cell or the range in the data.</li>\n<li>Select Home > Format as Table.</li>\n<li>Pick a table style.</li>\n<li>In the Format as Table dialog box, select the checkbox next to My table as headers if you want the first row of the range to be the header row, and then click OK</li>\n</ol>\n\n<blockquote>\n  <p><strong><a href=\"https://support.office.com/en-us/article/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">More info about tables</a></strong></p>\n</blockquote>\n\n<p>The trick about using tables is that even if you add/remove columns, the column ID will be associated to a specific name. The name of each column range is the header itself.</p>\n\n<p>So after doing this, to obtain the date associated to given ID, you can use this formula in a cell (out of the table). I got this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/X8NZ7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X8NZ7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The formula I've used to get the date of given ID is:\n<code>=INDEX(Table1[Date];MATCH(I2;Table1[ID];0))</code></p>\n\n<p>The good thing about using tables is that even if you add or remove columns, the formula will work, and even if you change the name of the header, it will work!</p>\n\n<p><a href=\"https://i.stack.imgur.com/cODAC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cODAC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in the image above, the formula works perfectly, even changing everything.</p>\n\n<p><strong>NOTE:</strong> The formula will work as long as it finds an ID. If it can't find an ID, it will return an error. Also, it will find the first coincidence, so if the given ID it's a duplicate, it will return the date of the first coincidence.</p>\n"}], "owner": {"reputation": 183, "user_id": 7878083, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211187949127745/picture?type=large", "display_name": "Ray Bond", "link": "https://stackoverflow.com/users/7878083/ray-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 57586880, "answer_count": 3, "score": 0, "last_activity_date": 1566382007, "creation_date": 1566372075, "last_edit_date": 1592644375, "question_id": 57586442, "link": "https://stackoverflow.com/questions/57586442/find-value-in-row-by-column-names", "title": "Find value in row by column names", "body": "<p>I want to find a given ID in the ID column, then return the Date value from the same row.</p>\n<p>This needs to be done using header row names since users will add and remove columns.</p>\n<p>A example spreadsheet</p>\n<p><a href=\"https://i.stack.imgur.com/8KMHY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8KMHY.jpg\" alt=\"enter image description here\" /></a></p>\n<p>The headers will always be in row 1, but the number of header columns will vary.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 2, "last_activity_date": 1566399934, "creation_date": 1566399934, "answer_id": 57594511, "question_id": 57586299, "link": "https://stackoverflow.com/questions/57586299/excel-vba-macro-how-to-combine-2-sheets-the-most-efficient-way/57594511#57594511", "title": "Excel VBA macro - how to combine 2 sheets the most efficient way", "body": "<p>What you actually do is to issue ~150K^2/2 comparisons (~1E10), so I think there is no computer that could make it fast. You should approach it in a more scientific way like employing more efficient searching methods. </p>\n\n<p>So if you are sure that <code>Name+Version</code> pairs are unique throughout all sheets, and you want to find the matching pairs, you can do the following: </p>\n\n<ol>\n<li>Make an array of the pairs (=name+version) of sheet A and the row numbers by Dimming Idx(1 to 150000, 1 to 2) and put cstr(name+version) to (,1) and excel row number to (,2). Then sort this array with e.g. quicksort to make a unique sorted list. </li>\n<li>Take each row in sheet B, make the key, and find it with e.g. binary search in the index.</li>\n<li>Now you know the matching rows in sheet A and sheet B. </li>\n</ol>\n\n<p>Alternatively, you can sort one of the sheets on name+version keys in order to use binary search. \nGood luck. </p>\n"}], "owner": {"reputation": 143, "user_id": 11825017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188958a167ef271972ae7fbe33f0d8d9?s=128&d=identicon&r=PG&f=1", "display_name": "TakeAMinute", "link": "https://stackoverflow.com/users/11825017/takeaminute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57594511, "answer_count": 1, "score": 1, "last_activity_date": 1566399934, "creation_date": 1566371527, "last_edit_date": 1566382045, "question_id": 57586299, "link": "https://stackoverflow.com/questions/57586299/excel-vba-macro-how-to-combine-2-sheets-the-most-efficient-way", "title": "Excel VBA macro - how to combine 2 sheets the most efficient way", "body": "<p>Currently I have three sheets. Two of them contain data to be written into the third one.</p>\n\n<p>Sheet A has the following structure:</p>\n\n<pre>\n|    A    |   B  |  C |  D |  E |   F   |\n| Version | Name | XX | XY | XZ | DATA  |\n|   5.0   | Test | XX | XY | XZ | test1 |\n|   5.1   | Tree | XX | XY | XZ |  100  |\n|   5.1   | Test | XX | XY | XZ | test  |\n|   5.0   | Tree | XX | XY | XZ |  50   |\n...\n</pre>\n\n<p>Sheet B has this:</p>\n\n<pre>\n|    A    |   B  |  C |  D |  E   |\n| Version | Name | XX | XY | DATA |\n|   5.1   | Test | XX | XY | test |\n|   5.0   | tree | XX | XY | 300  |\n|   5.1   | tree | XX | XY | 400  |\n|   5.0   | Test | XX | XY | test |\n...\n</pre>\n\n<p>And Sheet C has this:</p>\n\n<pre>\n|   A  |  B |       C      |       D      |  E |       F      |      G       | H  | ..\n| Name | XX | SheetA - 5.0 | SheetB - 5.0 | XX | SheetA - 5.1 | SheetB - 5.1 | XX | ..\n...\n</pre>\n\n<p>XX/XY/XZ = random data. Versions are strings and from 5.0 - 5.9. (actual the versions are years, but I think its more simple this way)</p>\n\n<hr>\n\n<p><br></p>\n\n<p>Now I want to combine Sheet A and Sheet B into Sheet C. It should look like this:</p>\n\n<pre>\n|   A  |  B |       C      |       D      |  E |       F      |      G       | H  | ..\n| Name | XX | SheetA - 5.0 | SheetB - 5.0 | XX | SheetA - 5.1 | SheetB - 5.1 | XX | ..\n| test | XX |    test1     |     test     | XX |     test     |     test     | XX | ..\n| Tree | XX |      50      |      300     | XX |      100     |      400     | XX | ..\n\u2026\n</pre>\n\n<p>Currently I just take Sheet A and put it in the Right spot in Sheet C.<br>\nThis doesn't take too much time but now I want to get Sheet B also into Sheet C so my current solution is to loop each row from Sheet B, find the row with the same name in Column \"A\" and fill the gaps.<br>\nThe problem is, that each Sheet has 150k+ rows and this takes way too much time. And also there are names in Sheet B that aren't in Sheet C so the \".find\" function search the whole 150k+ rows, the speed of this is like ~3 rows per second. Is there a quicker way?</p>\n\n<p>Code example how I fill Sheet B into Sheet C: (Code from A to C is nearly the same)</p>\n\n<pre><code>For Each Row In DataFromSheetB.Rows\n    With Selection\n        Set FindRow = Sheets(\"C\").Range(\"A:A\").Find(What:=Row.Cells(2), LookIn:=xlValues, LookAt:=xlWhole)\n    End With\n    If FindRow Is Nothing Then\n        GoTo Skip2\n    Else\n        Select Case Row.Cells(1)\n        Case \"5.0\"\n            FindRow.EntireRow.Cells(4).Value = Row.Cells(5)\n        Case \"5.1\"\n            FindRow.EntireRow.Cells(7).Value = Row.Cells(5)\n        Case \"5.2\"\n            FindRow.EntireRow.Cells(10).Value = Row.Cells(5)\n        Case \"5.3\"\n            FindRow.EntireRow.Cells(13).Value = Row.Cells(5)\n        Case \"5.4\"\n            FindRow.EntireRow.Cells(16).Value = Row.Cells(5)\n        Case \"5.5\"\n            FindRow.EntireRow.Cells(19).Value = Row.Cells(5)\n        Case \"5.6\"\n            FindRow.EntireRow.Cells(21).Value = Row.Cells(5)\n        Case \"5.7\"\n            FindRow.EntireRow.Cells(24).Value = Row.Cells(5)\n        Case \"5.8\"\n            FindRow.EntireRow.Cells(27).Value = Row.Cells(5)\n        Case \"5.9\"\n            FindRow.EntireRow.Cells(30).Value = Row.Cells(5)\n        End Select\n    End If\nSkip2:\nNext Row\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566375307, "post_id": 57586134, "comment_id": 101632057, "body": "Besides the answer given below, change <code>Format(Form_Simulation.Land_Prob1.Value &#47; 100, &quot;Percent&quot;)</code> to <code>Format(Val(Form_Simulation.Land_Prob1.Value) &#47; 100, &quot;0.00%&quot;)</code> BTW you also may want to check if a &quot;number&quot; was entered in the textbox and not some random text..."}, {"owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566404728, "post_id": 57586134, "comment_id": 101648816, "body": "@SiddharthRout: thank you. Can you please clarify the last point &quot;may want to check if a &quot;number&quot; ... &quot; I am not really get your point."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566405011, "post_id": 57586134, "comment_id": 101648968, "body": "What would happen if you type <code>PTQuoc</code> in <code>Land_Prob1</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "edited": false, "score": 0, "creation_date": 1566373650, "post_id": 57586331, "comment_id": 101631332, "body": "So format(value, &quot;percent&quot;) does not convert the value into percent? It just leave it as string with % sign at the end? OMG"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1566371670, "creation_date": 1566371670, "answer_id": 57586331, "question_id": 57586134, "link": "https://stackoverflow.com/questions/57586134/vba-textbox-value-format/57586331#57586331", "title": "VBA - Textbox value format", "body": "<p>So you are trying to convert them to numbers without the percent sign?</p>\n\n<p>Try it like this instead:</p>\n\n<pre><code>x1 = CDbl(Replace(x1, \"%\", \"\"))\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566382060, "creation_date": 1566370899, "last_edit_date": 1566382060, "question_id": 57586134, "link": "https://stackoverflow.com/questions/57586134/vba-textbox-value-format", "title": "VBA - Textbox value format", "body": "<p>I have some problem with formatting in Textbox value and checking condition</p>\n\n<p><a href=\"https://i.stack.imgur.com/kcK9R.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kcK9R.jpg\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li><p>Each textbox after entering will auto format in percent.</p></li>\n<li><p>When finishing entering the last textbox, it will check if total sum is equal to 1. </p></li>\n</ol>\n\n<p>I can work on the 1st one. However, when checking sum of three somehow I cannot format the value as in value/double. Value I obtain from the 3 textboxes are still in string. I tried to convert but not success.</p>\n\n<p>Please see if there is anything wrong with my code</p>\n\n<pre><code>Private Sub Land_Prob1_AfterUpdate()\nOn Error Resume Next\nIf Form_Simulation.Land_Prob1 &lt;= 100 Then\n    Form_Simulation.Land_Prob1.Value = Format(Form_Simulation.Land_Prob1.Value / 100, \"Percent\")\nElseIf Form_Simulation.Land_Prob1 &gt; 100 Or Form_Simulation.Land_Prob1 &lt; 0 Then\n    Form_Simulation.Land_Prob1 = \"0.00%\"\nEnd If\nEnd Sub\n\nPrivate Sub Land_Prob2_AfterUpdate()\nOn Error Resume Next\nIf Form_Simulation.Land_Prob2 &lt;= 100 Then\n    Form_Simulation.Land_Prob2.Value = Format(Form_Simulation.Land_Prob2.Value / 100, \"Percent\")\nElseIf Form_Simulation.Land_Prob2 &gt; 100 Or Form_Simulation.Land_Prob2 &lt; 0 Then\n    Form_Simulation.Land_Prob2 = \"0.00%\"\nEnd If\nEnd Sub\n\nPrivate Sub Land_Prob3_AfterUpdate()\nDim x1, x2, x3\nOn Error Resume Next\nIf Form_Simulation.Land_Prob3 &lt;= 100 Then\n    Form_Simulation.Land_Prob3.Value = Format(Form_Simulation.Land_Prob3.Value / 100, \"Percent\")\nElseIf Form_Simulation.Land_Prob3 &gt; 100 Or Form_Simulation.Land_Prob3 &lt; 0 Then\n    Form_Simulation.Land_Prob3 = \"0.00%\"\nEnd If\n\n'Check if total probability equal 100\nIf Form_Simulation.Land_Prob1.Value &lt;&gt; \"\" And Form_Simulation.Land_Prob2.Value &lt;&gt; \"\" Then\n    x1 = Form_Simulation.Land_Prob1.Value\n    x1 = CDbl(x1)\n    x2 = Form_Simulation.Land_Prob2.Value\n    x2 = CDbl(x2)\n    x3 = Form_Simulation.Land_Prob3.Value\n    x3 = CDbl(x3)\n    If x1 + x2 + x3 &lt;&gt; 1 Then\n        MsgBox \"Total probability must be equal 100%. Please enter again\"\n        Form_Simulation.Land_Prob3 = \"\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>No matter how I tried to convert, the value is still in string hence I cannot sum them up for condition checking</p>\n\n<p>Thank you for reading</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566394403, "post_id": 57585932, "comment_id": 101643140, "body": "Could you be more specific about what&#39;s &quot;not working&quot;?  Are you getting an error?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11955090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f95d7f5b3fe03879b78849805ff088c?s=128&d=identicon&r=PG&f=1", "display_name": "londonstats", "link": "https://stackoverflow.com/users/11955090/londonstats"}, "edited": false, "score": 0, "creation_date": 1566474391, "post_id": 57593148, "comment_id": 101672619, "body": "Hi Marc. Thanks for the quick reply. I&#39;m running some computations based on the inputs in T11:T16 which change each time I&#39;m going down a row in my &quot;data&quot; table. I&#39;d like to copy paste the 1st row from my &quot;data&quot; table in the 1st column of the &quot;computations&quot; table which populate another table called the &quot;results&quot; table. I then extract 1 particular row from the &quot;results&quot; table and store it in another table, called &quot;report&quot; table. Then I move on to the 2nd row of the &quot;data&quot; table still using the 1st column of the &quot;computations&quot; table (T11:T16) and etc. Hope this clarifies a bit."}], "tags": [], "owner": {"reputation": 1, "user_id": 7851456, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z0DZXeVjjDs/AAAAAAAAAAI/AAAAAAAAAIY/L2TjV36ALpI/photo.jpg?sz=128", "display_name": "marc mason", "link": "https://stackoverflow.com/users/7851456/marc-mason"}, "is_accepted": false, "score": 0, "last_activity_date": 1566395168, "creation_date": 1566395168, "answer_id": 57593148, "question_id": 57585932, "link": "https://stackoverflow.com/questions/57585932/loop-to-copy-paste-row-into-column-perform-calculations-and-store-results/57593148#57593148", "title": "Loop to copy paste row into column, perform calculations and store results", "body": "<p>I'm confused at to what you want to achieve with your VBA, is it simply changing the values in the range T11:T16 or do you need it to run the calculations in your \"Results\" table and save them somewhere?</p>\n\n<p>If you're switching between data sources I might suggest doing something like this and attaching each macro to a toggle button;</p>\n\n<pre><code>Sub sim1()\nDim i As Integer\nDim c As Integer\nr = 11 'row of data to move\ni = 12 'starting row of data destination\nc = 2 'starting column of data to move\nt = 20 'destination column number\n    Do While c &lt;= 7\n        Sheets(\"Sheet1\").Cells(i, t).Value = Sheets(\"Sheet1\").Cells(r, c).Value\n        c = c + 1\n        i = i + 1\n    Loop\nEnd Sub\n\nSub sim2()\nDim i As Integer\nDim c As Integer\nr = 12 'row of data to move\ni = 12 'starting row of data destination\nc = 2 'starting column of data to move\nt = 20 'destination column number\n    Do While c &lt;= 7\n        Sheets(\"Sheet1\").Cells(i, t).Value = Sheets(\"Sheet1\").Cells(12, c).Value\n        c = c + 1\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11955090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f95d7f5b3fe03879b78849805ff088c?s=128&d=identicon&r=PG&f=1", "display_name": "londonstats", "link": "https://stackoverflow.com/users/11955090/londonstats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566395168, "creation_date": 1566370183, "last_edit_date": 1566382079, "question_id": 57585932, "link": "https://stackoverflow.com/questions/57585932/loop-to-copy-paste-row-into-column-perform-calculations-and-store-results", "title": "Loop to copy paste row into column, perform calculations and store results", "body": "<p>I'm trying to write a macro that will copy a range (6 different numbers in cells <code>B11:G11</code> in cells <code>T11:T16</code>, then perform some computations using these cells <code>T11:T16</code> in a table next to it which results are displayed in another table \"results\" in cells <code>AJ11:AP47</code>. That's simulation #1. Next, I'd like to move to the next row and copy <code>B12:G12</code> into <code>T11:T16</code> again in order to run the same computations with a different input range and stored the results in the \"results\" table. </p>\n\n<p>I've tried to record the macro and mixed with other pieces of code I found here but it's still not working.</p>\n\n<pre><code>Sub Macro5()\n'\n' Macro5 Macro\n'\n\n    Range(\"B11:G11\").Select\n    Selection.Copy\n    Range(\"T11\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n\n    Range(\"B12:G12\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"T11\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n\n    Range(\"B13:G13\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"T11\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot for your help or pieces of advice!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566368761, "post_id": 57585430, "comment_id": 101629118, "body": "Does it give you any error ?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1566369101, "post_id": 57585430, "comment_id": 101629240, "body": "You may want to include your <code>sht</code> variable in this line to fully qualify the range. <code>Set rngToAbs = sht.Range(&quot;U5:U&quot; &amp; LastRow)</code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1566369484, "post_id": 57585430, "comment_id": 101629410, "body": "Depending on your data, you might get a problem with the <code>Abs</code>-Function. You get an Runtime error 13 (type mismatch) if one of your cell contains a string. Use the <code>IsNumeric</code>-function to check."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 3, "last_activity_date": 1566369169, "creation_date": 1566369169, "answer_id": 57585683, "question_id": 57585430, "link": "https://stackoverflow.com/questions/57585430/make-all-active-cells-in-a-specific-column-to-its-absolute-value/57585683#57585683", "title": "Make all active cells in a specific Column to its Absolute Value", "body": "<p>Problem with line <code>LastRow = sht.Cells(sht.Rows, Count, \"U\").End(xlUp).Row</code></p>\n\n<p>Use of <code>,</code> instead of <code>.</code> and not specifying the sheet reference in <code>rngToAbs</code></p>\n\n<p><strong>Try:</strong></p>\n\n<pre><code>Sub MakeColumnsAbsoluteValue()\n\n    Dim sht As Worksheet\n    Dim rngToAbs As Range\n    Dim LastRow As Long\n    Dim c As Range\n\n    Set sht = ThisWorkbook.Sheets(\"FF\")\n    LastRow = sht.Cells(sht.Rows.count, \"U\").End(xlUp).row\n    Set rngToAbs = sht.Range(\"U5:U\" &amp; LastRow)\n\n    For Each c In rngToAbs\n        c.Value = Abs(c.Value)\n\n    Next c\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1566374711, "last_edit_date": 1566374711, "creation_date": 1566371355, "answer_id": 57586264, "question_id": 57585430, "link": "https://stackoverflow.com/questions/57585430/make-all-active-cells-in-a-specific-column-to-its-absolute-value/57586264#57586264", "title": "Make all active cells in a specific Column to its Absolute Value", "body": "<p>You may try:</p>\n\n<pre><code>Sub MakeColumnsAbsoluteValue()\n\nDim sht As Worksheet\nDim rngToAbs As Range\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Sheets(\"MJEBlackline\")\nWith sht\n    LastRow = .Cells(.Rows.Count, \"U\").End(xlUp).Row\n    Set rngToAbs = .Range(\"U5:U\" &amp; LastRow)\n    rngToAbs.Value = .Evaluate(\"=abs(\" &amp; rngToAbs.Address &amp; \")\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Or even (<a href=\"https://stackoverflow.com/a/31746549/9758194\">inspired through @GarysStudent</a>):</p>\n\n<pre><code>Sub MakeColumnsAbsoluteValue()\n\nDim sht As Worksheet\nDim rngToAbs As Range\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Sheets(\"MJEBlackline\")\nWith sht\n    LastRow = .Cells(.Rows.Count, \"U\").End(xlUp).Row\n    Set rngToAbs = .Range(\"U5:U\" &amp; LastRow)\n    rngToAbs.Replace what:=\"-\", lookat:=xlPart, replacement:=\"\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This would both convert the whole range in one go. Assuming that's what you meant with:</p>\n\n<blockquote>\n  <p><em>\"I want to convert the values of Column U until the active row...\"</em></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1566376471, "creation_date": 1566376471, "answer_id": 57587539, "question_id": 57585430, "link": "https://stackoverflow.com/questions/57585430/make-all-active-cells-in-a-specific-column-to-its-absolute-value/57587539#57587539", "title": "Make all active cells in a specific Column to its Absolute Value", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub MakeColumnsAbsoluteValue()\n\n    Dim sht As Worksheet\n    Dim rngToAbs As Range, c As Range\n    Dim LastRow As Long, x As Long\n    Dim arr() As Variant\n\n    Set sht = ThisWorkbook.Sheets(\"MJEBlackline\")\n    x = 0\n\n    With sht\n\n        LastRow = .Cells(.Rows.Count, \"U\").End(xlUp).Row\n\n        Set rngToAbs = .Range(\"U5:U\" &amp; LastRow)\n\n        'Loop range and create an array including all abs values\n        For Each c In rngToAbs\n            ReDim Preserve arr(x)\n            arr(x) = Abs(c.Value)\n            x = x + 1\n        Next c\n\n        'Paste the values of the array at once instead of pasting values one by one\n        .Range(\"U5:U\" &amp; LastRow).Value = Application.WorksheetFunction.Transpose(arr)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11953265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d464b656ff2b58bdb0df2b3ce02ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Memo", "link": "https://stackoverflow.com/users/11953265/memo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 1, "accepted_answer_id": 57586264, "answer_count": 3, "score": 2, "last_activity_date": 1566376471, "creation_date": 1566367923, "last_edit_date": 1566368735, "question_id": 57585430, "link": "https://stackoverflow.com/questions/57585430/make-all-active-cells-in-a-specific-column-to-its-absolute-value", "title": "Make all active cells in a specific Column to its Absolute Value", "body": "<p>Can you help me correct my VBA codes. I want to convert the values of Column U until the active row to Absolute Values meaning to remove the negative amounts.<br>\nHere is my VBA code:</p>\n\n<pre><code>Sub MakeColumnsAbsoluteValue()\n\n    Dim sht As Worksheet\n    Dim rngToAbs As Range\n    Dim LastRow As Long\n    Dim c As Range\n\n    Set sht = ThisWorkbook.Sheets(\"MJEBlackline\")\n    LastRow = sht.Cells(sht.Rows, Count, \"U\").End(xlUp).Row\n    Set rngToAbs = Range(\"U5:U\" &amp; LastRow)\n\n    For Each c In rngToAbs\n        c.Value = Abs(c.Value)\n\n    Next c\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566366332, "post_id": 57584887, "comment_id": 101628277, "body": "Your string is too long. With some careful testing, it seems the limit is 255 characters. You will have to find an alternative."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1566366496, "post_id": 57584887, "comment_id": 101628322, "body": "Seeing as how your range string is exceeding 255 chars, it would be of use to tell us how you construct this range. If it is done dynamically through code, you might be better off using another method with variables or something such."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566366611, "post_id": 57584887, "comment_id": 101628356, "body": "I tried breaking it in two parts and using <code>Union</code> to join the both, it works but the second part is only added till the total join instances are 18. Not sure what is with that number, maybe the total length of 255."}, {"owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1566366710, "post_id": 57584887, "comment_id": 101628387, "body": "Thanks @Tim Stack. That&#39;s what it started to seem like so I divided this macro up into two since this hides blank rows in two tables in the SOW tab. Using the same syntax but for each table separately and then using a macro which calls both as the one to assign to the macro button worked for me. If there is a better way to write such a macro with such a large range, I&#39;d really appreciate it but will put solved in the title."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1566366837, "post_id": 57584887, "comment_id": 101628426, "body": "Also you can use <code>r.SpecialCells(xlCellTypeBlanks)</code> instead of a check using a if condition if a cell is blank."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566367269, "post_id": 57584887, "comment_id": 101628575, "body": "You know you can use autofilter to hilde blank rows in Col H? Better than looping :)"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1566367277, "post_id": 57584887, "comment_id": 101628580, "body": "I don&#39;t understand why some rows are excluded from your range. Having said that, a quick and dirty fix would be to loop through the entire column (or a large part of it) and then use <code>If IsError(Application.Match(c.Row, Array(47, 68, 131....), False)) Then</code> to exclude these rows from the loop"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566382215, "post_id": 57584887, "comment_id": 101636008, "body": "I&#39;m voting to close this question as off-topic because [SOLVED] has been edited into the Title, but no solution or indication from the OP how it was solved is provided. This is not useful to future site visitors."}, {"owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566388587, "post_id": 57584887, "comment_id": 101639402, "body": "@Cindy Meister, I&#39;m sorry it&#39;s in the comment section instead of a typical answer but I did provide how I was able to get around my issue in the 4th comment when I responded to Tim Stack which is why I put SOLVED in the title. I can remove the SOLVED but don&#39;t understand why if I commented how to solve this issue."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566389257, "post_id": 57584887, "comment_id": 101639761, "body": "CTEAGUE212: I agree with @CindyMeister here. Just putting &quot;Solved&quot; in your queston title will not be of value to any other user. I happen to be online so I was able to put together an answer. In the future if there is no answer provided, either delete the question or answer your own question :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566389304, "post_id": 57584887, "comment_id": 101639791, "body": "BTW if you wish that you have a different answer, feel free to put that and aacept it (i.e if you want it) :)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1566389682, "post_id": 57584887, "comment_id": 101639994, "body": "Well, for one things comments are &quot;volatile&quot; on Stack Overflow: they can be and are often deleted, especially on older posts. In addition, the purpose of the site is a repository of information &quot;for everyone&quot;, in a Question &amp; Answer format - so questions and answers need to be in the right place. This isn&#39;t a &quot;free help desk&quot; providing support just for you :-) Luckily, Siddharth has helped us all out with a quick and thorough Answer :-)"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1566368050, "creation_date": 1566368050, "answer_id": 57585453, "question_id": 57584887, "link": "https://stackoverflow.com/questions/57584887/how-to-hide-all-rows-which-have-blank-cells-in-a-certain-column/57585453#57585453", "title": "How to hide all rows which have blank cells in a certain column?", "body": "<p>Your code may not be working for the relevant sheet as the range is not fully qualified. <code>Set r = Range(\"H27:H46,...</code>. The range is referring to the activesheet.</p>\n\n<p>Here is one way using <code>AutoFilter</code> which will hide the blank rows in a column. This is much faster than looping in a huge dataset.</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long\n    Dim rngColH As Range\n    Dim rngToHide As Range\n\n    '~~&gt; Chage this to the relevant sheet\n    Set ws = Sheet1\n\n    With ws\n        '~~&gt; Remove any autofilter if any\n        .AutoFilterMode = False\n\n        '~~&gt; Find last row in Col H\n        lRow = .Range(\"H\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Construct your range\n        Set rngColH = .Range(\"H1:H\" &amp; lRow)\n\n        '~~&gt; Filter on blanks\n        With rngColH\n            .AutoFilter Field:=1, Criteria1:=\"=\"\n            '~~&gt; These are your blank rows (i.e if there are any)\n            Set rngToHide = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n        End With\n\n        .AutoFilterMode = False\n\n        '~~&gt; Hide the rows\n        If Not rngToHide Is Nothing Then rngToHide.Hidden = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here is how it works...</p>\n\n<p><a href=\"https://i.stack.imgur.com/lqpJE.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lqpJE.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Using <code>.SpecialCells(xlCellTypeBlanks)</code> as @Mikku suggested is also a good approach :)</p>\n"}], "owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 57585453, "answer_count": 1, "score": 1, "last_activity_date": 1566401462, "creation_date": 1566364829, "last_edit_date": 1566401462, "question_id": 57584887, "link": "https://stackoverflow.com/questions/57584887/how-to-hide-all-rows-which-have-blank-cells-in-a-certain-column", "title": "How to hide all rows which have blank cells in a certain column?", "body": "<p>I am trying to hide all rows which have blank cells in a certain column (Column H in the SOW tab).</p>\n\n<p>This same macro (different rows but same syntax) worked on the third tab in this workbook. I checked, each row in the range is correct. Could it be that the range is too long?</p>\n\n<pre><code>Sub HideRowsInSOW_LOOP()\nDim r As Range, c As Range\nSet r = Range(\"H27:H46,H48:H67,H69:H88,H90:H109,H111:H130,H132:H151,H153:H172,H174:H193,H195:H214,H216:H235,H237:H256,H258:H277,H279:H298,H300:H319,H321:H340,H342:H361,H369:H388,H390:H409,H411:H430,H432:H451,H453:H472,H474:H493,H495:H514,H516:H535,H537:H556,H558:H577,H579:H598,H600:H619,H621:H640,H642:H661,H663:H682,H684:H703\")\nApplication.ScreenUpdating = False\nFor Each c In r\n    If c.Value = 0 Then\n        c.EntireRow.Hidden = True\n    Else\n        c.EntireRow.Hidden = False\n    End If\nNext c\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>When running this, I get the following error:</p>\n\n<blockquote>\n  <p>run-time error '1004' error message: Method 'Range' of object\n  '_Global' failed</p>\n</blockquote>\n\n<p>I have a much longer macro which serves the same purpose successfully and am worried about it slowing down my workbook/keep hearing that loop is better anyway.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566364869, "post_id": 57584831, "comment_id": 101627831, "body": "I don&#39;t think so. It will sort the first by column 1 then by column 3 and then by column  6 , but while sorting by column 3, it will disrupt the sort by column 1. So basically it will not work in addition of sort with column 1, rather it will sort individually."}, {"owner": {"reputation": 3, "user_id": 10643455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d4dcee31e0c05fb732eff83522a3d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/10643455/jimmy"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566365110, "post_id": 57584831, "comment_id": 101627896, "body": "Is there a way to get around using QuickSortArray sub-procedure?  What if I make QuickSortArray a function? In Excel sorting one column then second and then third is a very common practice.  There should be a simpler and straight-forward way."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566365465, "post_id": 57584831, "comment_id": 101627994, "body": "Maybe you can write a function to print that array on a new workbook and then do the Sorting and reassign to a Array and delete the Temp workbook."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1566371615, "post_id": 57584831, "comment_id": 101630371, "body": "<code>Call QuickSortArray(QuickSortArray(QuickSortArray(StatFcstData, , , 6), , , 3), , , 1)</code>  will give you a sort order of 1,3, 6"}, {"owner": {"reputation": 3, "user_id": 10643455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d4dcee31e0c05fb732eff83522a3d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/10643455/jimmy"}, "edited": false, "score": 0, "creation_date": 1566543759, "post_id": 57584831, "comment_id": 101696611, "body": "I tried this and it didn&#39;t work Call QuickSortArray(QuickSortArray(QuickSortArray(StatFcstData, , , 1), , , 3), , , 6)"}], "owner": {"reputation": 3, "user_id": 10643455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d4dcee31e0c05fb732eff83522a3d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/10643455/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566382128, "creation_date": 1566364537, "last_edit_date": 1566382128, "question_id": 57584831, "link": "https://stackoverflow.com/questions/57584831/how-to-sort-2d-array-with-multiple-columns-vba", "title": "How to sort 2d array with multiple columns vba?", "body": "<p>I want to sort a 2-D array with 3 different columns.  The 1st column, 3rd column and then 6th column.\nI am using the subprocedure provided here <a href=\"https://stackoverflow.com/questions/4873182/sorting-a-multidimensionnal-array-in-vba\">Sorting a multidimensionnal array in VBA</a></p>\n\n<p>I have tried nested calling but getting an error</p>\n\n<blockquote>\n  <p>Call \n  QuickSortArray(QuickSortArray(QuickSortArray(StatFcstData, , , 1), , , 3), , , 6)</p>\n</blockquote>\n\n<p>and also tried one column after another but I am not getting correct sort order in the result.</p>\n\n<pre><code>QuickSortArray(StatFcstData, , , 1)\nQuickSortArray(StatFcstData, , , 3)\nQuickSortArray(StatFcstData, , , 6)\n</code></pre>\n\n<p>It should ideally sort the whole data set within the array sorted first by column 1 and then column 3 and then column 6.  But, what it currently does is it applies the sort column 6 and overrides sorting of column 1 and 3 as per the code what I already tried</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566353189, "post_id": 57583518, "comment_id": 101625881, "body": "You also need to actually figure out what the last row is. <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">This question</a> explains how to."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566363571, "post_id": 57583518, "comment_id": 101627549, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/11631363/how-to-copy-a-line-in-excel-using-a-specific-word-and-pasting-to-another-excel-s/11633207#11633207\">THIS</a> This doesn&#39;t use loops..."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566357606, "post_id": 57583749, "comment_id": 101626576, "body": "<code>Sub Jeeped</code> - haha. I always wonder why he nuked his SO account."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566357755, "post_id": 57583749, "comment_id": 101626592, "body": "Same - I pretty much learned VBA from scratch studying his and Craners solutions. He will be backed.... one day"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566358131, "post_id": 57583749, "comment_id": 101626644, "body": "Or if you want to see the good old times: <a href=\"http://web.archive.org/web/20190203105458/https://stackoverflow.com/users/4039065/jeeped\" rel=\"nofollow noreferrer\">web.archive.org/web/20190203105458/https://stackoverflow.com&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566358820, "post_id": 57583749, "comment_id": 101626734, "body": "This is gold! Good share"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566362759, "post_id": 57583749, "comment_id": 101627393, "body": "Yeah I hope he comes back one day! Good Guy!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1566354998, "creation_date": 1566354998, "answer_id": 57583749, "question_id": 57583518, "link": "https://stackoverflow.com/questions/57583518/how-to-edit-vba-code-to-paste-in-a-different-location/57583749#57583749", "title": "How to edit VBA code to paste in a different location", "body": "<pre><code>Sub Jeeped()\n\n'Declare &amp; Set relevant Sheets\nDim wsC As Worksheet: Set wsC = ThisWorkbook.Sheets(\"Data All\")\nDim wsP As Worksheet: Set wsP = ThisWorkbook.Sheets(\"Data X\")\n\n'Declare LR variables and range variables\nDim C As Range, CopyMe As Range\nDim cLR As Long, pLR As Long\n\n'Determine last rows on both sheets\ncLR = wsC.Range(\"Y\" &amp; wsC.Rows.Count).End(xlUp).Row\npLR = wsP.Range(\"A\" &amp; wsP.Rows.Count).End(xlUp).Row\n\n'Loop through range and create collection (UNION) of cells\nFor Each C In wsC.Range(\"Y1:Y\" &amp; wsC)\n    If C = \"X\" Then\n        If Not CopyMe Is Nothing Then\n            Set CopyMe = Union(CopyMe, C)\n        Else\n            Set CopyMe = C\n        End If\n    End If\nEnd If\n\n'If any cells are found, paste them all at once here\nIf Not CopyMe Is Nothing Then\n    CopyMe.EntireRow.Copy\n    wsP.Range(\"A\" &amp; pLR).PasteSpecial xlPasteValues\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11954435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e18404ea09b3d317d83de38668224a?s=128&d=identicon&r=PG&f=1", "display_name": "AstralOmega", "link": "https://stackoverflow.com/users/11954435/astralomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566354998, "creation_date": 1566353016, "question_id": 57583518, "link": "https://stackoverflow.com/questions/57583518/how-to-edit-vba-code-to-paste-in-a-different-location", "title": "How to edit VBA code to paste in a different location", "body": "<p>I am working on separating out data according to the value of a cell in a row. In this example I have it so that if any cells in Column Y = \"X\" then it will paste the entire row into the correct tab.</p>\n\n<p>I am using some code that I found on here that works perfectly to take the data and dump it into the new tab. This is good for generating new data weekly, but I also want a tab that will paste the data on the end of existing data to keep a yearly tally.</p>\n\n<p>This is the code I'm working with.</p>\n\n<pre><code>Sub Paste()\n\nDim c As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\nSet Source = ActiveWorkbook.Worksheets(\"Data All\")\nSet Target = ActiveWorkbook.Worksheets(\"Data X\")\n\nj = 2\nFor Each c In Source.Range(\"Y1:Y300\")\n    If c = \"X\" Then\n       Source.Rows(c.Row).Copy Target.Rows(j)\n       j = j + 1\n    End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>With my limited understanding, it seems that the \"j = 2\" part means that it begins pasting on the 2nd row.</p>\n\n<p>I tried using this similar code that pastes it to the next available row: <a href=\"https://stackoverflow.com/questions/44391535/last-row-paste-to-different-worksheet-vba\">Last Row Paste to different Worksheet VBA</a> </p>\n\n<p>I used the \"dim lRow As Long\" and removed the references to j and just tried to make it </p>\n\n<pre><code>Source.Rows(c.Row).Copy Target.Rows(lRow)\n</code></pre>\n\n<p>but that doesn't seem to work. Does anybody have an insight? I want to keep it as simple as possible.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566351182, "post_id": 57583336, "comment_id": 101625558, "body": "Sorry, did not see your post... Deleted my answer"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1566351629, "last_edit_date": 1566351629, "creation_date": 1566350990, "answer_id": 57583336, "question_id": 57583325, "link": "https://stackoverflow.com/questions/57583325/macro-to-hide-unhide-sheets-based-on-button/57583336#57583336", "title": "Macro to hide / unhide sheets based on button", "body": "<p>Use <code>Not</code> and the current <code>Visible</code> state to toggle:</p>\n\n<pre><code>Sub CheckBox1_Click()   \n    Sheets(\"A\").Visible = Not Sheets(\"A\").Visible \nEnd Sub\n</code></pre>\n\n<p>If you specifically want to guarantee that <em>checked</em> = <em>visible</em> and <em>unchecked</em> = <em>hidden</em>, then use this:</p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    Sheets(\"A\").Visible = CheckBox1.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 57583336, "answer_count": 1, "score": 2, "last_activity_date": 1566351629, "creation_date": 1566350808, "question_id": 57583325, "link": "https://stackoverflow.com/questions/57583325/macro-to-hide-unhide-sheets-based-on-button", "title": "Macro to hide / unhide sheets based on button", "body": "<p>I would like to have a button hide/unhide sheets when clicked.</p>\n\n<p>The code I have will make a worksheet visible when the worksheet is hidden when button is given a ticked.  However, it will not make the worksheet invisible when it is unselected.</p>\n\n<pre><code>Sub CheckBox1_Click()\n\nDim i As Integer\n    Sheets(\"A\").Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>I would like the sheet to be invisible when unclicked.</p>\n"}, {"tags": ["excel", "vba", "select", "range"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566349697, "post_id": 57583073, "comment_id": 101625306, "body": "Normally you don&#39;t need to <code>Select</code>, and probably should avoid it. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select</a> for more detail."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566349952, "post_id": 57583073, "comment_id": 101625342, "body": "Do you have a sheet named &quot;Sheet1&quot; in your workbook? Also - a sheet must be active before you can select cell(s) on it - but as mentioned, you probably don&#39;t need to <code>Select</code> at all."}, {"owner": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566351094, "post_id": 57583073, "comment_id": 101625544, "body": "It is specifically called &quot;Affected APAC Truck Pop&quot;, I though the sheets name would be Sheet1 as shown in the properties and the name I assigned in the excel workbook would not be reference. However, changing it to the name I assigned resolved my issue. Thanks Ben, I will also look at the link to avoid using Select. Many Thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566351111, "post_id": 57583073, "comment_id": 101625546, "body": "That is the codename. It is different from the actual sheet name. To use it, you would do <code>Sheet1.Range(theAddressA &amp; &quot;:&quot; &amp; theAddressL).Select</code>. But no problem, happy coding."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "edited": false, "score": 0, "creation_date": 1566349530, "post_id": 57583084, "comment_id": 101625283, "body": "Thanks braX. However, I have tried this however, I am still getting the same &quot;9&quot; Subscript Error."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "edited": false, "score": 0, "creation_date": 1566349849, "post_id": 57583084, "comment_id": 101625326, "body": "What does <code>MsgBox theAddressA &amp; &quot;:&quot; &amp; theAddressL</code> give you? Is there a sheet called &quot;Sheet1&quot; or is it called &quot;Sheet 1&quot;?"}, {"owner": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "edited": false, "score": 0, "creation_date": 1566350952, "post_id": 57583084, "comment_id": 101625517, "body": "&#39;code&#39; MsgBox theAddressA &amp; &quot;:&quot; &amp; theAddressL gives &quot;A2:L2&quot;. the sheet is called Sheet1, more specifically &quot;Affected APAC Truck Pop&quot;, changing it from Sheet1 to this resolved my issue! Thanks braX!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1566348124, "creation_date": 1566348124, "answer_id": 57583084, "question_id": 57583073, "link": "https://stackoverflow.com/questions/57583073/cant-idenify-where-subscript-out-of-range-error-is-originating/57583084#57583084", "title": "Can&#39;t idenify where Subscript out of range error is originating", "body": "<p>Dont put your variables in quotes... they are not literal strings. Instead, concatenate them like this.</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Range(theAddressA &amp; \":\" &amp; theAddressL).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566353380, "post_id": 57583371, "comment_id": 101625915, "body": "If you wanted to address the worksheet by index, you would do it like this: <code>ThisWorkbook.Worksheets(1)</code>"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1566361174, "post_id": 57583371, "comment_id": 101627098, "body": "<code>(Name)</code> is the name of VBA object and can be changed only in VBA editor. <code>Name</code> is the label displayed on sheet&#39;s tab. Instead of <code>ThisWorkbook.Worksheets(&quot;Affected APAC Truck Pop&quot;).Range(...</code> you can use <code>Sheet1.Range(...</code>."}], "tags": [], "owner": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1566351290, "creation_date": 1566351290, "answer_id": 57583371, "question_id": 57583073, "link": "https://stackoverflow.com/questions/57583073/cant-idenify-where-subscript-out-of-range-error-is-originating/57583371#57583371", "title": "Can&#39;t idenify where Subscript out of range error is originating", "body": "<p>I was referencing the name of the worksheet incorrectly, I thought that the name Sheet1 shown in the image would be what VBA references. However, it is the actual name which has been assigned that should be referenced. Thanks everyone</p>\n\n<p><a href=\"https://i.stack.imgur.com/180Ge.png\" rel=\"nofollow noreferrer\">Name should be referenced not (Name)</a></p>\n"}], "owner": {"reputation": 11, "user_id": 2775145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498409792a83aa8b7225d7a100d3acfb?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2775145/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57583084, "answer_count": 2, "score": 0, "last_activity_date": 1566382163, "creation_date": 1566347953, "last_edit_date": 1566382163, "question_id": 57583073, "link": "https://stackoverflow.com/questions/57583073/cant-idenify-where-subscript-out-of-range-error-is-originating", "title": "Can&#39;t idenify where Subscript out of range error is originating", "body": "<p>Whenever trying to select a variable range using a subroutine with parameters, I will also receive the error 9 Subscript out of range. If I remove the \"ThisWorkBook.Worksheets(\"Sheet1\")\" I then receive a Gobal error.</p>\n\n<p>I have tried using different routines such as Cells(x,y)</p>\n\n<pre><code>Sub Trail()\n\n    Call SelectRow(2)\n\nEnd Sub\n\nSub SelectRow(i As String)\n\n    Dim theAddressA As String\n    Dim theAddressL As String\n    theAddressA = \"A\" &amp; i\n    theAddressL = \"L\" &amp; i\n    MsgBox (theAddressA) 'Prints \"A2\".\n    MsgBox (theAddressL) 'Prints \"L2\".    \n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"theAddressA:theAddressL\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I want to be able to select a row based on a variable input, as shown by the subroutine with the argument parameters. Ultimately once I can do this I'd like to compare individual rows with another table to then identify differences and similarities.\n<a href=\"https://i.stack.imgur.com/J9VS3.png\" rel=\"nofollow noreferrer\">Debug display image</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1566341007, "post_id": 57582372, "comment_id": 101623964, "body": "You have three instances of <code>If</code> but only two <code>End If</code>, and you&#39;re using the multiline style of <code>If</code>. Indentation would help."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1566341468, "post_id": 57582372, "comment_id": 101624039, "body": "Indeed. Indent your code and the problem shows up like a flag."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11954081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cff92a86308bbfa6aa4038d00eee4dc?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/11954081/meghan"}, "edited": false, "score": 0, "creation_date": 1566399049, "post_id": 57582475, "comment_id": 101645889, "body": "Thank you so much I really appreciate your help! Have an awesome day"}], "tags": [], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "is_accepted": false, "score": 0, "last_activity_date": 1566341815, "creation_date": 1566341815, "answer_id": 57582475, "question_id": 57582372, "link": "https://stackoverflow.com/questions/57582372/next-without-for-error-if-else-statement/57582475#57582475", "title": "Next Without For Error, If Else Statement", "body": "<p>You are missing one more <code>Else...End If</code> clause here:</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 7 to Last_Row\n\n    If Cells(i,Phase).Value = \"3\" Then\n      If Cells(i,PSEDate).Value &gt; Date Then\n        If Cells(i,P3S).Value = \"Requested\" Then\n          Cells(i,RAG).Value = \"Green\"\n\n        Else\n           Cells(i,RAG).Value = \"Gray\"\n       End If\n      Else\n        Cells(i,RAG).Value = \"Red\"\n      End if\n    //Missing one more Else...End If clause here...\n\n    Next i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11954081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cff92a86308bbfa6aa4038d00eee4dc?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/11954081/meghan"}, "edited": false, "score": 0, "creation_date": 1566398989, "post_id": 57582550, "comment_id": 101645859, "body": "Thank you so much for the tip! Pretty new to VBA and coding so I really appreciate the tip about formatting. Have a nice day"}], "tags": [], "owner": {"reputation": 1, "user_id": 11954090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34aa9b6dcf73f1648f20c9ed2dd160f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kasi", "link": "https://stackoverflow.com/users/11954090/kasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1566342386, "creation_date": 1566342386, "answer_id": 57582550, "question_id": 57582372, "link": "https://stackoverflow.com/questions/57582372/next-without-for-error-if-else-statement/57582550#57582550", "title": "Next Without For Error, If Else Statement", "body": "<p>As mentioned by BigBen you are missing one \"End If\" statement. Also try to work with indents to spot such erros.</p>\n\n<pre><code>Dim i As Integer\nWith Sheet1\nFor i = 7 To 17\n'First condition\n  If .Cells(i, 1).Value = \"3\" Then\n\n    'Second condition  \n    If .Cells(i, 2).Value &gt; Date Then\n\n      'Third condition\n      If .Cells(i, 3).Value = \"Requested\" Then\n        .Cells(i, 4).Value = \"Green\"\n      Else\n        .Cells(i, 4).Value = \"Gray\"\n      'Third condition end\n      End If\n\n    Else\n      .Cells(i, 4).Value = \"Red\"\n\n    'Second condition end\n    End If\n\n  'First condition end\n  End If       \n\nNext i\nEnd With\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11954081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cff92a86308bbfa6aa4038d00eee4dc?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/11954081/meghan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1566382192, "creation_date": 1566340948, "last_edit_date": 1566382192, "question_id": 57582372, "link": "https://stackoverflow.com/questions/57582372/next-without-for-error-if-else-statement", "title": "Next Without For Error, If Else Statement", "body": "<p>I am writing a VBA code to automatically update a scorecard sheet according to some conditions. \nSet to Green if date is past today, and status is requested\nSet to Gray if date is past today and status is anything else\nSet to Red if date is anything before today</p>\n\n<p>Already tried running a conditional if else and the code is shown below. Keep getting a compile error saying \"Next Without For\" although both are included in the code below</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 7 to Last_Row\n\n    If Cells(i,Phase).Value = \"3\" Then\n    If Cells(i,PSEDate).Value &gt; Date Then\n    If Cells(i,P3S).Value = \"Requested\" Then\n    Cells(i,RAG).Value = \"Green\"\n\n    Else\n    Cells(i,RAG).Value = \"Gray\"\n    End If\n    Else\n    Cells(i,RAG).Value = \"Red\"\n    End if\n\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11954031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5b4b0d5b99f55058409116d4eba05f?s=128&d=identicon&r=PG&f=1", "display_name": "JDaws", "link": "https://stackoverflow.com/users/11954031/jdaws"}, "edited": false, "score": 0, "creation_date": 1566420333, "post_id": 57583074, "comment_id": 101655126, "body": "Thank you for your quick answer, that&#39;s exactly what I was after."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1566347965, "creation_date": 1566347965, "answer_id": 57583074, "question_id": 57582166, "link": "https://stackoverflow.com/questions/57582166/change-schedule-date-format/57583074#57583074", "title": "Change schedule date format", "body": "<p>The setting you are looking for is the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa679906(v%3Doffice.11)\" rel=\"nofollow noreferrer\">DefaultDateFormat</a> property of the Application object. This is the equivalent of going to File: Options, General tab: Date format. </p>\n\n<pre><code>Application.DefaultDateFormat = pjDate_hh_mmAM\n</code></pre>\n\n<p>You might consider capturing the current setting and restoring it later as it is an application-level setting and all projects opened will reflect this date format.</p>\n"}], "owner": {"reputation": 11, "user_id": 11954031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5b4b0d5b99f55058409116d4eba05f?s=128&d=identicon&r=PG&f=1", "display_name": "JDaws", "link": "https://stackoverflow.com/users/11954031/jdaws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57583074, "answer_count": 1, "score": 0, "last_activity_date": 1597827196, "creation_date": 1566339399, "last_edit_date": 1597827196, "question_id": 57582166, "link": "https://stackoverflow.com/questions/57582166/change-schedule-date-format", "title": "Change schedule date format", "body": "<p>I'm working in MS Project where the entire project duration is one hour.</p>\n<p>My goal is to run a VBA sub when the program opens, to format the project schedule date to the &quot;12.33 pm&quot; style.</p>\n<p>I've searched <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.application.dateformat\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/project.application.dateformat</a> to find a solution, but can't figure out the right syntax.</p>\n<pre><code>DateFormat(ActiveProject.Tasks) = pjDate_pjDate_hh_mmAM\n</code></pre>\n<p>I'd like to call this macro from my &quot;open on macro&quot; so the schedule date format changes to &quot;pjDate_hh_mmAM&quot;.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11540431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1UaCWnfxRM4/AAAAAAAAAAI/AAAAAAAAAb4/RRrsFtihSQ8/photo.jpg?sz=128", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/11540431/steven-l"}, "edited": false, "score": 0, "creation_date": 1566338180, "post_id": 57581948, "comment_id": 101623405, "body": "Nailed it, thanks! I&#39;ll mark your answer correct when it lets me."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3, "user_id": 11540431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1UaCWnfxRM4/AAAAAAAAAAI/AAAAAAAAAb4/RRrsFtihSQ8/photo.jpg?sz=128", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/11540431/steven-l"}, "edited": false, "score": 0, "creation_date": 1566338212, "post_id": 57581948, "comment_id": 101623413, "body": "@StevenL. thanks. Note the last sentence... up to you, but just an FYI on a potential issue. You may have to recalc manually. You might as well get rid of <code>Application.Volatile</code>."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1566338163, "last_edit_date": 1566338163, "creation_date": 1566337726, "answer_id": 57581948, "question_id": 57581911, "link": "https://stackoverflow.com/questions/57581911/user-defined-function-to-sum-by-fontstyle-error/57581948#57581948", "title": "User Defined Function to Sum by FontStyle Error", "body": "<p>A <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.font.fontstyle\" rel=\"nofollow noreferrer\"><code>FontStyle</code></a> is a <code>String</code>, not a <code>Long</code>.</p>\n\n<p>Change <code>Dim indRefFont As Long</code> to <code>Dim indRefFont As String</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fWITG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWITG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Though to be honest, I don't think <code>Application.Volatile</code> will work here - the UDF will not be recalculated when you change the font of the cell(s). That might be a design flaw in this approach.</p>\n"}], "owner": {"reputation": 3, "user_id": 11540431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1UaCWnfxRM4/AAAAAAAAAAI/AAAAAAAAAb4/RRrsFtihSQ8/photo.jpg?sz=128", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/11540431/steven-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 57581948, "answer_count": 1, "score": 0, "last_activity_date": 1566382214, "creation_date": 1566337503, "last_edit_date": 1566382214, "question_id": 57581911, "link": "https://stackoverflow.com/questions/57581911/user-defined-function-to-sum-by-fontstyle-error", "title": "User Defined Function to Sum by FontStyle Error", "body": "<p>I'm trying to develop a user-defined code that automatically sums any number in a referenced font. </p>\n\n<p>I've used a very similar code multiple times for interior color that worked without a hitch. I've tried font.name and font.fontstyle, is this even possible? If so, what's breaking this function?</p>\n\n<pre><code>Function SumCellsbyFont(rData As Range, cellRefFont As Range)\n    Dim indRefFont As Long\n    Dim cellCurrent As Range\n    Dim sumRes\n\n    Application.Volatile\n    sumRes = 0\n    indRefFont = cellRefFont.Cells(1, 1).Font.FontStyle\n    For Each cellCurrent In rData\n        If indRefFont = cellCurrent.Font.FontStyle Then\n            sumRes = WorksheetFunction.Sum(cellCurrent, sumRes)\n        End If\n    Next cellCurrent\n\n    SumCellsbyFont = sumRes\n\nEnd Function\n</code></pre>\n\n<p>I expected it to reference the cell that I designate and look for numbers with the same font style one at a time. If it has the same font style I want it to add it to the variable <code>sumRes</code> until it has gone through all the cells in the designated range. The only output it gives me is #value.</p>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1566336188, "post_id": 57581660, "comment_id": 101622829, "body": "You&#39;re trying to use an array as a single worksheet? Perhaps you mean to do <code>ThisWorkbook.Worksheeets(printSheets(0))...</code>?  Also, as far as I can tell, both <code>arr</code> and therefore <code>printSheets</code> are empty...Add <code>printSheets = arr</code> after the <code>arr</code> is updated in that <code>For M</code> loop."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566336208, "post_id": 57581660, "comment_id": 101622836, "body": "<code>printsheets(?)</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566336287, "post_id": 57581660, "comment_id": 101622860, "body": "To fix the lowercase <code>s</code> in <code>sheets</code> - add a new variable - <code>Dim Sheets</code>, and then delete it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1566336452, "post_id": 57581660, "comment_id": 101622911, "body": "@BruceWayne each element of <code>arr</code> is an array: <code>arr(cnt) = Worksheets(M).Range(&quot;A1:K43&quot;)</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566336581, "post_id": 57581660, "comment_id": 101622949, "body": "@BigBen - Yeah, but he declares <code>printSheets = arr</code> before <code>arr</code> is assigned anything as far as I can tell."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1566336613, "post_id": 57581660, "comment_id": 101622957, "body": "@BruceWayne I agree with that problem, it&#39;s just that <code>arr</code> is problematic too..."}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "edited": false, "score": 0, "creation_date": 1566337084, "post_id": 57581660, "comment_id": 101623100, "body": "Welcome to SO.  You need to put the &#39;printSheets = arr&#39; statement after your &#39;For, Next&#39; loop or it will always be empty.  If you step through the code, does arr(cnt) actually get any values inserted?"}, {"owner": {"reputation": 31, "user_id": 11941477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549afd55d7bfc430da3f4947585e53a?s=128&d=identicon&r=PG&f=1", "display_name": "j22", "link": "https://stackoverflow.com/users/11941477/j22"}, "edited": false, "score": 0, "creation_date": 1566406239, "post_id": 57581660, "comment_id": 101649452, "body": "Thank you for your comments. I tried to edit the posting but the editor keeps throwing up error that it&#39;s code &amp; to indent 4 spaces - can&#39;t figure out how to get around it.  Lower case &#39;s&#39; fixed, thanks.  Moving printSheets=arr after loop did not help.  See <a href=\"https://stackoverflow.com/questions/14404650\">stackoverflow.com/questions/14404650</a>.  This works but I have to code in the specific sheets in the array which I can&#39;t do in practice.  Question is How do I dynamically list the sheets in the array?  If I can do that I can solve the problem.  Thank you - j22"}], "owner": {"reputation": 31, "user_id": 11941477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549afd55d7bfc430da3f4947585e53a?s=128&d=identicon&r=PG&f=1", "display_name": "j22", "link": "https://stackoverflow.com/users/11941477/j22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1566438417, "creation_date": 1566335953, "last_edit_date": 1566438417, "question_id": 57581660, "link": "https://stackoverflow.com/questions/57581660/type-mismatch-on-excel-vba-export-sheets-to-pdf", "title": "Type mismatch on excel vba export sheets to pdf", "body": "<p>I get a type mismatch error when selecting multiple excel sheets (in an array) for export to a single pdf.  </p>\n\n<p>I have multiple sheets in a single excel workbook that I want to export to a single pdf for review and printing. I can export single sheets, each to its own pdf. To handle multiple, varying sheets I have tried to set up a dynamic array with the intent to export the sheets in the array. After the array is defined the sheets(array) are selected and at this point, a type mismatch error occurs.  The code below is adapted from an example I found online.  Additionally, I have tried to view the contents of the array in lieu of select/export to pdf.  Type mismatch occurs with this code as well.  This code is shown below the '@@@@ line below.</p>\n\n<p>I have reviewed 3 or 4 posts on VBA export multiple sheets to pdf and on type mismatch but could not identify any applicable solutions (but could not understand much of what I read either).  </p>\n\n<p>And also, \"ThisWorkbook.Sheets\" code is shown in all the examples I've seen as having a capital 'S' in Sheets.  Every time I try to capitalize the 'S', it is automatically reverted back to a lowercase 's'. ????</p>\n\n<p>Any help is greatly appreciated; thank you.</p>\n\n<pre><code>Option Explicit\n\nLastRowRoutes = VV  'LastRowRoutes &amp; VV are Variant\nDim M As Variant\nDim arr() As Variant\nDim cnt As Variant\nDim strFilename As String, strFilepath As String\nDim wksSheet1 As Worksheet\nDim printSheets As Variant\nprintSheets = arr\nSet wksSheet1 = ThisWorkbook.sheets(\"Sheet1\")\nSet wksSheet1 = Worksheets(\"Sheet1\")\nstrFilepath = \"E:\\\"\nWith wksSheet1\n   strFilename = strFilepath &amp; \"TripSheets_Print.pdf\"\nEnd With\ncnt = 0\nFor M = 22 To LastRowRoutes\n    If Worksheets(M).Range(\"B4\").Value &lt;&gt; \"\" Then\n        ReDim Preserve arr(0 To cnt)\n        arr(cnt) = Worksheets(M).Range(\"A1:K43\")\n        cnt = cnt + 1\n    Else\n    End If\nNext\nThisWorkbook.sheets(printSheets).Select  '*Type Mismatch here\nwksSheet1.ExportAsFixedFormat Type:=xlTypePDF, Filename:=strFilename, Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n'@@@@@@@@ code below to view array contents in lieu of select &amp; export\nFor M = LBound(arr) To UBound(arr) 'type mismatch here as well\n    msg = msg &amp; arr(M) &amp; vbNewLine\nNext M\nMsgBox \"the values of my array are: \" &amp; vbNewLine &amp; msg\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1566333470, "post_id": 57581157, "comment_id": 101621887, "body": "activeworkbooks code is for hiding the sheets. that part works without any runtime error  The problem is with the thisworkbook.save  Also there are palces in my module where their is no activeworkbook refrence.  sample from another procedure   Cells(rowselect, 2) = Me.txtdate.Value Cells(rowselect, 3) = Me.txtname.Value Cells(rowselect, 20) = Now() ThisWorkbook.Save  this also throws an error &lt;&lt; RUNTIME &gt;&gt;"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 2, "creation_date": 1566333554, "post_id": 57581157, "comment_id": 101621917, "body": "@ShanmugamArumugam but he does have a point. If the code runs when another workbook is active then the code will error out. Always use ThisWorkbook."}, {"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1566333887, "post_id": 57581157, "comment_id": 101622017, "body": "Done. I changed the code in my routine to thisworkbook from activeworkbook.  But why does the runtime error occur on another procedure with no activebook. reference"}, {"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1566339675, "post_id": 57581157, "comment_id": 101623715, "body": "Thanks to aiyuni and Andreas for your valuable insights."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1566356121, "post_id": 57581157, "comment_id": 101626350, "body": "Just to be clear, I&#39;m not saying the activeworkbook is related to the error. But it can cause another error"}], "tags": [], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "is_accepted": false, "score": 1, "last_activity_date": 1566333133, "creation_date": 1566333133, "answer_id": 57581157, "question_id": 57581124, "link": "https://stackoverflow.com/questions/57581124/runtime-error-1004-on-save-thisworkbook-save-works-on-one-machine-and-not-on-a/57581157#57581157", "title": "Runtime error 1004 on Save (Thisworkbook.save) Works on one machine and not on another", "body": "<p>You want to avoid using <code>ActiveWorkbook</code>. Create a variable to store your workbook(s) and use that variable. Your problem is probably due to the fact that your <code>ActiveWorkbook</code>is pointing to a different workbook than the one you wanted. </p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1566334520, "post_id": 57581201, "comment_id": 101622246, "body": "Yes the user dowloads from gmail in to the downloads folder.  Tried moving the file to desktop and still got the same error - very strange.  THe user has full admin rights (workgroup user no domain or anything) on this computer"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566336030, "post_id": 57581201, "comment_id": 101622775, "body": "Or better - save [a copy of] the file on a network share, and email a link to the file instead of an attachment. Files opened straight-from-email attachment, modified, and then re-sent, are a PITA - especially when links to external files are involved: expect them to break all the time."}, {"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1566339636, "post_id": 57581201, "comment_id": 101623705, "body": "I copied the file from downloads folder to the desktop. All was well. Did not check on the file attributes (Read only). Will check tomorrow and get back with my outcomes.   Thanks to tim-williams / mathieu-guindon for your valuable insights."}, {"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 1, "creation_date": 1566379141, "post_id": 57581201, "comment_id": 101634091, "body": "Update:  IT did windows update and did some cleanup. and the file with no changes to the code started working without any errors.   I am not sure what the issue was but it is resolved now."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 3, "last_activity_date": 1566333386, "creation_date": 1566333386, "answer_id": 57581201, "question_id": 57581124, "link": "https://stackoverflow.com/questions/57581124/runtime-error-1004-on-save-thisworkbook-save-works-on-one-machine-and-not-on-a/57581201#57581201", "title": "Runtime error 1004 on Save (Thisworkbook.save) Works on one machine and not on another", "body": "<p>I believe the problem is how you distribute the file.<br>\nMy guess is that you email it to them and they open it from the email?<br>\nWhat happens is the file is in a position where you can't save it.  </p>\n\n<p>Ask your colleagues to save as the file on the desktop or documents folder where you know for sure they have full read and write capabilities.<br>\nThen open the file.</p>\n\n<p>This has bugged me also a few times.\nIt's easy to forget.</p>\n"}], "owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566333386, "creation_date": 1566332969, "question_id": 57581124, "link": "https://stackoverflow.com/questions/57581124/runtime-error-1004-on-save-thisworkbook-save-works-on-one-machine-and-not-on-a", "title": "Runtime error 1004 on Save (Thisworkbook.save) Works on one machine and not on another", "body": "<p>I have a data entry userform and when user saves data to sheet. I want to save the Excel file - to achieve this I use     ThisWorkbook.Save and this works like a charm on my machine.</p>\n\n<p>The file is created and saved as a .XLSM file in Excel 2016 (windows 64 bit).</p>\n\n<p>Now when I distribute the same to my peers at office - some machines work fine.</p>\n\n<p>Some machines throw a runtime 1004 error save method of worksheet class failed.</p>\n\n<pre><code>Application.DisplayAlerts = False\nDim xWs As Worksheet\n\nDim xName As String\nxName = \"data\"\nFor Each xWs In Application.ActiveWorkbook.Worksheets\n        If xWs.Name &lt;&gt; xName Then\n            xWs.Visible = False\n        End If\nNext\nThisWorkbook.Save        '&lt;&lt;&lt;&lt; Runtime 1004 Error on this line\nUnload Me\nApplication.Quit\n</code></pre>\n\n<p>On checking the file, the data is saved to the sheet but the error throws up.</p>\n\n<p>What could be the potential reason for this? </p>\n\n<p>Just something that came to my mind based on \n      \"<a href=\"https://www.rondebruin.nl/win/s5/win001.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s5/win001.htm</a>\" \nUsers can open my file (type .xlsm) in any version of excel excel 2007 / excel  2003 ? Is that the root cause? If yes what is my way around?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1566333417, "post_id": 57581086, "comment_id": 101621871, "body": "This works for me: <code>IE.document.getElementsByClassName(&quot;Input-sc-7nzn9k-0&quot;)(0).V&zwnj;&#8203;alue = &quot;hello world&quot;</code>"}, {"owner": {"reputation": 21, "user_id": 11852342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KNQD_87tHHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdte_CapQYn6JNjVCBjkQ_OtuOghA/photo.jpg?sz=128", "display_name": "Jimmy Walker", "link": "https://stackoverflow.com/users/11852342/jimmy-walker"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1566333895, "post_id": 57581086, "comment_id": 101622021, "body": "Thank you!  I see where &quot;Input-sc-7nzn9k-0&quot; is, but for future reference, how would I know that is what I am looking for?  Additional question:  How do I give you points for helping me?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1566334354, "post_id": 57581086, "comment_id": 101622181, "body": "You&#39;re welcome! I added this as an answer and expanded on how I came up with the class name"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1566336898, "post_id": 57581086, "comment_id": 101623045, "body": "You might want to check out the <a href=\"https://www.zillow.com/howto/api/faq.htm\" rel=\"nofollow noreferrer\">Zillow API FAQ&#39;s</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11852342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KNQD_87tHHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdte_CapQYn6JNjVCBjkQ_OtuOghA/photo.jpg?sz=128", "display_name": "Jimmy Walker", "link": "https://stackoverflow.com/users/11852342/jimmy-walker"}, "edited": false, "score": 0, "creation_date": 1566334577, "post_id": 57581377, "comment_id": 101622269, "body": "Thank you!  Your answer is very helpful.  Gave you a thumbs up (doesn&#39;t register publicly for new people with 15 or less).  Thanks again!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 21, "user_id": 11852342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KNQD_87tHHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdte_CapQYn6JNjVCBjkQ_OtuOghA/photo.jpg?sz=128", "display_name": "Jimmy Walker", "link": "https://stackoverflow.com/users/11852342/jimmy-walker"}, "edited": false, "score": 0, "creation_date": 1566334773, "post_id": 57581377, "comment_id": 101622328, "body": "My pleasure. No worries on the not registering. I&#39;m just happy to help."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1566334333, "creation_date": 1566334333, "answer_id": 57581377, "question_id": 57581086, "link": "https://stackoverflow.com/questions/57581086/filling-zillow-searchbox-using-vba-zillow-is-react-based-website/57581377#57581377", "title": "Filling Zillow Searchbox using VBA (Zillow is react-based website)", "body": "<p>To see which class or id to go after in your DOM you'll need to pull up zillow in a browser. In chrome and newer versions of IE, you can hit <code>F12</code> and it will bring up a developer panel where you can select elements on the page and see all of their attributes. </p>\n\n<p><a href=\"https://i.stack.imgur.com/bnpAZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bnpAZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>There are 3 classes for that search box that you can use <code>react-autosuggest__input</code>, <code>Input-sc-7nzn9k-0</code>, and <code>dIKGyt</code> so:</p>\n\n<pre><code>IE.document.getElementsByClassName(\"Input-sc-7nzn9k-0\")(0).Value = \"hello world\"\n</code></pre>\n\n<p>I put that <code>(0)</code> after value because <code>getElementsByClassName</code> returns an array of elements that match that class. Here we just want \"The first element that has this class\", so <code>(0)</code> which works out here as there is only one element on that page that has that particular class. </p>\n"}], "owner": {"reputation": 21, "user_id": 11852342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KNQD_87tHHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdte_CapQYn6JNjVCBjkQ_OtuOghA/photo.jpg?sz=128", "display_name": "Jimmy Walker", "link": "https://stackoverflow.com/users/11852342/jimmy-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566382326, "creation_date": 1566332760, "last_edit_date": 1566382326, "question_id": 57581086, "link": "https://stackoverflow.com/questions/57581086/filling-zillow-searchbox-using-vba-zillow-is-react-based-website", "title": "Filling Zillow Searchbox using VBA (Zillow is react-based website)", "body": "<p>I am trying to identify the element for the search box, so that I can change the value of the search box to an address.  I was able to do this with redfin and pellago, but zillow is written with react, and I am having trouble.</p>\n\n<p>I have already tried just about every element in \"\" I can see when I inspect element, but there is no real \"name\" or \"id\" like I am used to.</p>\n\n<pre><code>Sub WebscrapeZillow()\n\n    Dim IE As New SHDocVw.InternetExplorer\n    Set IE = New SHDocVw.InternetExplorer\n\n    IE.Visible = True\n    IE.navigate \"https://zillow.com./\"\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n\n    Loop\n\n    IE.document.getElementById(\"__next\").Value = \"hello world\"\n\nEnd Sub\n</code></pre>\n\n<p>I get a debug message every time.  I would like to enter an address in the search box.  I'm not sure I am \"getting\" the correct type of element or the correct item in \"\".  I have tried about 25 different element names, so \"__next\" is just the last I tried.  I have searched stackoverflow, and could not find what I thought was the answer (although I may not know exactly what I am looking for).  Thank you for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1566332192, "post_id": 57580966, "comment_id": 101621467, "body": "Don&#39;t rely on <code>ActiveChart</code> and <code>Activate</code>-ing. You&#39;ve identified the chart to use based on its name, work with that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566333270, "post_id": 57580966, "comment_id": 101621819, "body": "If a member was added to the object model in Excel 2013, that member/feature does not exist in Excel 2010 then there&#39;s little you can do about it, other than explicitly verify what version is running your code, and <i>conditionally</i> use the new member. @BigBen given the error, if <code>IsFiltered</code> isn&#39;t a member of <code>SeriesCollection</code> in Excel 2010, then the late-binding incurred by working off an <code>Object</code> is <i>exactly</i> why the code is able to compile &amp; run in Excel 2010. But yeah setting a <code>Chart</code> local variable would be preferrable."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566333528, "post_id": 57580966, "comment_id": 101621904, "body": "@Matthieu Guindon Yep agreed thanks for adding the longer comment..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566333613, "post_id": 57580966, "comment_id": 101621936, "body": "You are trying to use a feature that didn&#39;t exist in Excel 2010. The linked post <i>is</i> your answer. You can only use filtered series collections in 2013+, so yes, you have to explicitly verify what version is running your code before you can invoke that member. Error 438 means &quot;I can&#39;t find that member, it doesn&#39;t exist&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566334159, "post_id": 57580966, "comment_id": 101622119, "body": "Use <code>Application.Version</code> to perform the check: <code>Application.Version &gt; 14</code> will only be <code>True</code> in 2013+. Also make sure to use late-binding (i.e. make the version-dependent member calls against <code>Object</code> or <code>Variant</code>) for the 2013+ code, so that the code can still compile when hosted in Excel 2010."}, {"owner": {"reputation": 1, "user_id": 8015177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wDHb533ycWU/AAAAAAAAAAI/AAAAAAAADlU/vJH7WppgymQ/photo.jpg?sz=128", "display_name": "Scott Remington", "link": "https://stackoverflow.com/users/8015177/scott-remington"}, "edited": false, "score": 0, "creation_date": 1566427395, "post_id": 57580966, "comment_id": 101657219, "body": "Sorry, no.  What I am asking is NOT a duplicate.  If you happen to look at the original thread, they are changing formats of existing chart objects.  I am trying to actively add/delete chart objects (plots).  The OP said the posted code worked for them.  The code I posted generates errors as I have described so the linked post is NOT my answer.  If what I am trying to do is simply not possible in 2010, so be it.  That&#39;s why I asked.  Thank you."}], "owner": {"reputation": 1, "user_id": 8015177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wDHb533ycWU/AAAAAAAAAAI/AAAAAAAADlU/vJH7WppgymQ/photo.jpg?sz=128", "display_name": "Scott Remington", "link": "https://stackoverflow.com/users/8015177/scott-remington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "closed_date": 1566333451, "answer_count": 0, "score": 0, "last_activity_date": 1566332059, "creation_date": 1566332059, "question_id": 57580966, "link": "https://stackoverflow.com/questions/57580966/fullseriescollection-generates-compile-error-method-or-data-member-not-found", "closed_reason": "Duplicate", "title": "FullSeriesCollection generates \u201cCompile Error: Method or Data Member not found\u201d in Excel 2010", "body": "<p>Created several macros to automate the displaying of several plots within multiple graphs in Excel 2013.  I created ActiveX checkboxes to toggle five plots within a single graph on and off using code obtained in the mrexcel hyperlink.  When using the spreadsheet in Excel 2010 I get the error listed in this thread's title.</p>\n\n<p>I found this thread showing the exact same issue...\n<a href=\"https://stackoverflow.com/questions/32482558/fullseriescollection-generates-compile-error-method-or-data-member-not-found\">FullSeriesCollection generates &quot;Compile Error: Method or Data Member not found&quot; in Excel 2010</a></p>\n\n<p>However, changing \"fullseriescollection\" to \"seriescollection\" does not work in Excel 2010 AND causes problems in 2013 too!  In 2010, I now get the error \"Run-time error '438: Object doesn't support this property or method\" with the offending code:</p>\n\n<p><code>ActiveChart.SeriesCollection(n).IsFiltered = False/True</code> where n is an integer representing one of the five checkboxes and the property can be true or false.  The actual code is shown below and the hyperlinks are references to my source examples.</p>\n\n<p><a href=\"https://www.mrexcel.com/forum/excel-questions/1086201-macro-enable-disable-chart-series.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/1086201-macro-enable-disable-chart-series.html</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/292779/setting-selection-to-nothing-when-programming-excel\">Setting selection to Nothing when programming Excel</a></p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Chart Purple\").Activate\nIf Series1_purple.Value = True Then\n        ActiveChart.SeriesCollection(1).IsFiltered = False 'series is shown\n    Else\n        ActiveChart.SeriesCollection(1).IsFiltered = True 'series is not shown(filtered)\n    End If\nSendKeys \"{ESC}\"\n</code></pre>\n\n<p>When I open the modified spreadsheet in 2013 and click on one of the (already checked) checkboxes, the selected graph is disabled.  Clicking on the same checkbox (to show the graph again) does nothing, just re-checks the checkbox.  Clicking on the checkbox again unchecks the checkbox and hides the <em>next</em> graph.  Following this procedure of checking and un-checking the same checkbox will sequentially remove each plot from the graph until the entire graph is gone.  Then, clicking on it again gives a \"Run-time error '1004': Invalid Parameter\" error with the <code>ActiveChart.SeriesCollection(n).IsFiltered</code> line highlighted.</p>\n\n<p>Is there a way for this behavior to work in both Excel 2010 and 2013 without having separate files for 2010 and 2013?  Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1566331721, "post_id": 57580508, "comment_id": 101621289, "body": "You could continue to use the subfolder + rule system and set up vba macros to automatically run at a specified time which utilitze <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.rule.execute\" rel=\"nofollow noreferrer\"><code>Rule.Execute()</code></a> to run that rule on the whole folder"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1566331826, "post_id": 57580508, "comment_id": 101621322, "body": "Scheduling macros isn&#39;t always a manageable option but I bet someone else could come up with a more simple method to run this anyways haha"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1566335409, "post_id": 57580508, "comment_id": 101622547, "body": "Can you not build this as an add-in?"}, {"owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "reply_to_user": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 1, "creation_date": 1566339650, "post_id": 57580508, "comment_id": 101623708, "body": "@EricLegault That would definitely fit a niche demand -- I&#39;m not the only one who wants to use inbox zero principles in outlook using this function. The mock-up and theory is almost trivial, but I&#39;m struggling to implement it in code because I&#39;m not familiar with form and syntax for outlook VBA. All I need to at least get limping forward at this point is code that allows running of a macro on a regular, time-based schedule.  I&#39;d pay a nominal fee for a quality plugin that allows snoozing mail in outlook."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1566344388, "post_id": 57580508, "comment_id": 101624579, "body": "Here&#39;s a question with some good advice <a href=\"https://stackoverflow.com/a/22773677/2727437\">stackoverflow.com/a/22773677/2727437</a>"}, {"owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "edited": false, "score": 0, "creation_date": 1566396011, "post_id": 57580508, "comment_id": 101644275, "body": "Ah Task Scheduler+VBA, good idea. <a href=\"https://stackoverflow.com/questions/43435188/runing-vbscript-code-for-outlook-through-a-scheduler\">This post explains that this is very bad idea but does offer a possible solution for those with access to O 365.</a> See also <a href=\"https://stackoverflow.com/questions/40610636/windows-task-manager-schedule-vba-macro-to-send-an-email-using-outlook-daily-run\">this post, which does this despite the risks.</a>"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1566402435, "post_id": 57580508, "comment_id": 101647775, "body": "Using Task Scheduler will create problems - it&#39;s not supported for a reason. It may work for other Office apps, but in most cases (esp. Exchange on-premises) Outlook relies on the context of the logged in Windows user, while Task Scheduler processes use the System account (I think) as the context for running Outlook, which may not have the appropriate premissions"}, {"owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "reply_to_user": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 1, "creation_date": 1566418424, "post_id": 57580508, "comment_id": 101654423, "body": "@EricLegault It seems <a href=\"https://www.techhit.com/SnoozeIt/\" rel=\"nofollow noreferrer\">snooze</a> does exactly this, but I can&#39;t use plugins at my work."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 1, "creation_date": 1566419643, "post_id": 57580508, "comment_id": 101654875, "body": "@Zediiiii I was going to mention ClearContext - the only add-in I&#39;ve been using regularly for years"}, {"owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "edited": false, "score": 0, "creation_date": 1566503997, "post_id": 57580508, "comment_id": 101687565, "body": "I made a janky sort of solution at <a href=\"https://superuser.com/questions/1474184/schedule-run-outlook-vba-script-at-time/1474222#1474222\">this post</a>"}], "owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587079274, "creation_date": 1566329948, "last_edit_date": 1587079274, "question_id": 57580508, "link": "https://stackoverflow.com/questions/57580508/outlook-snooze-email-until-time-in-same-day", "title": "Outlook &quot;Snooze&quot; Email Until Time In Same Day", "body": "<p>I am currently using a view filter to \"snooze\" email -- which means the email is hidden from view when a followup flag is placed on it until the flag is set for followup on \"today.\" This is the basic view filter setup in the advanced tab of view filter in Outlook:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sTLCn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sTLCn.png\" alt=\"Outlook view filter setup\"></a></p>\n\n<p>I often have email I want to hide until it is actionable later in the day. Ideally, I would be able to use a nice UI (eg Gmail) such as this one:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XmYHT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XmYHT.png\" alt=\"Gmail Snooze Example\"></a></p>\n\n<p>I have attempted to leverage the view-hide method to manage this by categorizing emails, running a rule to hide the email when categorized, then removing the categorization at a particular time, but I couldn't find a nice way to 1-run a rule on categorization that already exists (1- is outline in the comments), and 2-run a rule on the whole folder at a particular time (2-is now outlined below).</p>\n\n<p>The other approach I tried was to move emails to a particular folder (ie, snooze until 2 PM, snooze until 4 pm, etc) and then have them move back to inbox at a particular time via a rule or a script. Unfortunately, the rule would run but only on incoming emails -- it didn't automatically process the emails that were already in the folder. I attempted adapting a few scripts, but I was unsuccessful enough that I won't include them here.</p>\n\n<p>Suggestions on a better approach or fleshing out the approaches I tried?</p>\n\n<p>UPDATE\nThe only thing I need to finish this project is VBA code that runs on a schedule, and possibly syntax to run a rule correctly. eg, if the rule is Snoozetill3, then how does one run <code>Snoozetill3.execute()</code> correctly (that doesn't work)?</p>\n\n<p>This code, <a href=\"https://stackoverflow.com/questions/56990440/move-emails-from-one-outlook-folder-to-another\">per this SO post</a>, will move all the Files from folder TODO to folder Test:</p>\n\n<pre><code>Sub MoveItems()\n\n Dim myNameSpace As Outlook.NameSpace\n Dim myInbox As Outlook.Folder\n Dim myDestFolder As Outlook.Folder\n Dim myItems As Outlook.Items\n Dim myItem As Object\n\n Set myNameSpace = Application.GetNamespace(\"MAPI\")\n Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n Set myItems = myInbox.Items\n Set myDestFolder = myInbox.Folders(\"test\")\n\n Set myItems = myInbox.Folders(\"TODO\").Items\n\n 'Debug.Print myItems.Count\n\n For i = myItems.Count To 1 Step -1 'Iterates from the end backwards\n    myItems.Item(i).Move myDestFolder\n\n Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566329405, "post_id": 57580347, "comment_id": 101620418, "body": "<code>Range(&quot;A2:J&quot;)</code> - <code>&quot;A2:J&quot;</code> is not a valid range reference. You need a row number for J."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566329451, "post_id": 57580347, "comment_id": 101620435, "body": "Also, it&#39;s <code>Workbook.Close</code>, not <code>Workbooks.Close</code>, so you need a valid <code>Workbook</code> object."}, {"owner": {"reputation": 25, "user_id": 11953265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d464b656ff2b58bdb0df2b3ce02ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Memo", "link": "https://stackoverflow.com/users/11953265/memo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566330214, "post_id": 57580347, "comment_id": 101620740, "body": "Hi BigBen Thank you for your help. I&#39;ve tried to update the Range to (&quot;A2:J2&quot;) but still having an error. Can you please help recommend what can use. Can I use Col instead of Range?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566330305, "post_id": 57580347, "comment_id": 101620774, "body": "Oh my bad. Ignore part of my previous comment. You just need to remove the <code>J</code>. You can pastespecial into one cell, namely <code>A2</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566330385, "post_id": 57580347, "comment_id": 101620796, "body": "But your real issue is that you&#39;re copying entire rows -  <code>Worksheets(&quot;Report&quot;).Rows(&quot;5:1000&quot;)</code> - and you probably don&#39;t need to do that. Why not <code>Range(&quot;A5:J1000&quot;)</code> instead of <code>Rows(&quot;5:1000&quot;)</code>?"}, {"owner": {"reputation": 25, "user_id": 11953265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d464b656ff2b58bdb0df2b3ce02ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Memo", "link": "https://stackoverflow.com/users/11953265/memo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566331480, "post_id": 57580347, "comment_id": 101621189, "body": "Thank a lot @BigBen. It worked!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1566331019, "creation_date": 1566331019, "answer_id": 57580746, "question_id": 57580347, "link": "https://stackoverflow.com/questions/57580347/how-to-fix-the-error-in-my-browse-for-file-copy-paste-formula-for-vba/57580746#57580746", "title": "How to fix the error in my Browse for file &amp; Copy Paste Formula for VBA", "body": "<p>To summarize the back-and-forth in comments:</p>\n\n<p>1) You can <code>PasteSpecial</code> into a single cell, <code>A2</code>. Your problem is that you are copying entire rows: <code>Set range_to_copy = Worksheets(\"Report\").Rows(\"5:1000\")</code> when you probably only need <code>Range(\"A5:J1000\")</code>. Pasting an entire row will overwrite any formulas you have in columns to the right of J.</p>\n\n<p>2) It is <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.close\" rel=\"nofollow noreferrer\"><code>Workbook.Close</code></a>, not <code>Workbooks</code>. So you need to work with a valid <code>Workbook</code> object. Something like this:</p>\n\n<pre><code>Dim wb as Workbook    \nSet wb = Workbooks.Open(FileName:=fileNameAndPath)\n\nwb.Close ' no need for FileName, the workbook already has a fileName\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11953265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d464b656ff2b58bdb0df2b3ce02ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Memo", "link": "https://stackoverflow.com/users/11953265/memo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57580746, "answer_count": 1, "score": 0, "last_activity_date": 1566331019, "creation_date": 1566329160, "last_edit_date": 1566329931, "question_id": 57580347, "link": "https://stackoverflow.com/questions/57580347/how-to-fix-the-error-in-my-browse-for-file-copy-paste-formula-for-vba", "title": "How to fix the error in my Browse for file &amp; Copy Paste Formula for VBA", "body": "<p>I am new to VBA, I was able to find separate codes and put them together but I am having some difficulties on finding a code that will help me get my expected results. \nBasically, I wanted a Macro tool that will allow me to browse for the filename of an excel file and copy all active rows starting Row 5 and paste values on Col A:J except for the header so paste will start in Row 2. </p>\n\n<p>I have found separate VBA codes for the functions/ requirements based on my requirement but the problem is everytime I try to add them on my existing code it results to an error. </p>\n\n<pre><code>Sub GetFile()\n\n'Browse for File\n\nDim fileNameAndPath As Variant\nfileNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLS), *.XLS\", Title:=\"Select File To Be Opened\")\nIf fileNameAndPath = False Then Exit Sub\n\n'Open the File\n\nWorkbooks.Open Filename:=fileNameAndPath\n\n'Close the File\n\nWorkbooks.Close Filename:=fileNameAndPath\n\n'Copy Data\n\nSet range_to_copy = Worksheets(\"Report\").Rows(\"5:1000\")\n\n'Paste Data\n\nSet range_for_pasting = Workbooks(\"Macro Manual IHB.xlsm\").Worksheets(\"CashPositionReport\").Range(\"A2:J\")\n\nrange_to_copy.Copy\nrange_for_pasting.PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n\nEnd Sub\n\nErrors are on these codes:\n\n'Close the File\n\nWorkbooks.Close Filename:=fileNameAndPath\n\n'Paste Data\n\nSet range_for_pasting = Workbooks(\"Macro Manual IHB.xlsm\").Worksheets(\"CashPositionReport\").Range(\"A2:J\")\n</code></pre>\n\n<p>The close the File code doesn't work at all\nBut the Paste data works if I try to use .Range(\"A2\") instead of the above but it  overrides the formula that I have in Col K:Q</p>\n\n<p>Hope you can help me with this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566329079, "post_id": 57580273, "comment_id": 101620288, "body": "Will you be changing more than 1 cell at a time or will it always be one cell?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566329228, "post_id": 57580273, "comment_id": 101620347, "body": "<code>If IsEmpty(r) Then r.Offset(,1).ClearContents</code>?"}, {"owner": {"reputation": 1, "user_id": 11952556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dkXsl4L6CmA/AAAAAAAAAAI/AAAAAAAAEeY/uPrornSCgBE/photo.jpg?sz=128", "display_name": "Matt Cash", "link": "https://stackoverflow.com/users/11952556/matt-cash"}, "edited": false, "score": 0, "creation_date": 1566329944, "post_id": 57580273, "comment_id": 101620637, "body": "Could be changing just 1 cell, but often it would be multiple cells in column L that will be getting cleared"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1566329297, "creation_date": 1566329297, "answer_id": 57580372, "question_id": 57580273, "link": "https://stackoverflow.com/questions/57580273/vba-how-to-clear-a-cell-after-another-cell-is-cleared-that-is-part-of-an-existi/57580372#57580372", "title": "VBA, how to clear a cell after another cell is cleared that is part of an existing macro", "body": "<p>Use an If to determine:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim L As Range, M As Range, Inte As Range, r As Range\n    Set L = Range(\"L:L\")\n    Set Inte = Intersect(L, Target)\n    If Inte Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        For Each r In Inte\n            If r.Value = \"\" Then\n                r.Offset(0, 1).Value = \"\"\n            Else\n                r.Offset(0, 1).Value = Range(\"B4\")\n            End If\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11952556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dkXsl4L6CmA/AAAAAAAAAAI/AAAAAAAAEeY/uPrornSCgBE/photo.jpg?sz=128", "display_name": "Matt Cash", "link": "https://stackoverflow.com/users/11952556/matt-cash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 57580372, "answer_count": 1, "score": 0, "last_activity_date": 1566330236, "creation_date": 1566328840, "last_edit_date": 1566330236, "question_id": 57580273, "link": "https://stackoverflow.com/questions/57580273/vba-how-to-clear-a-cell-after-another-cell-is-cleared-that-is-part-of-an-existi", "title": "VBA, how to clear a cell after another cell is cleared that is part of an existing macro", "body": "<p>I have a macro I am using that fills in cell, \"M\", whenever data is entered in the adjacent cell in column \"L\".. I want to be able to have the data in cell \"M\" be cleared if the data in the adjacent \"L\" cell is deleted. </p>\n\n<p>I have tried to review through stack for ideas but nothing is clicking with me.. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim L As Range, M As Range, Inte As Range, r As Range\n    Set L = Range(\"L:L\")\n    Set Inte = Intersect(L, Target)\n    If Inte Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        For Each r In Inte\n            r.Offset(0, 1).Value = Range(\"B4\")\n\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I just need to know what I can add to this in order for this task to be completed.</p>\n"}, {"tags": ["excel", "vba", "pdf", "save"], "answers": [{"tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1566362230, "last_edit_date": 1566362230, "creation_date": 1566359398, "answer_id": 57584198, "question_id": 57580250, "link": "https://stackoverflow.com/questions/57580250/vba-sendkey-saving-a-pdf/57584198#57584198", "title": "VBA: SendKey Saving a PDF", "body": "<p>First, there seems to be a typo in the line <code>Application.SendKeys \"New File Name\",</code>. Either you meant <code>Application.SendKeys \"New File Name\", True</code> or there is an extra comma at the end.</p>\n\n<p>After typing the name you would normally have to press the save button or press enter to submit the saving dialog. If you quit the PDF application before that, it won't get submitted and the file won't be saved.</p>\n\n<p>To do that you can add <code>Application.SendKeys \"~\", True</code> after the line where you type the file name (or <code>Application.SendKeys \"{ENTER}\", True</code> which is equivalent to press Enter on the numeric keypad).</p>\n\n<p><strong>Side note</strong>: I would advise not to use SendKeys if you can find another way to make this work. SendKeys isn't reliable and sometimes keys won't get registered properly, so it's to use with caution.</p>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 57584198, "answer_count": 1, "score": 0, "last_activity_date": 1566362230, "creation_date": 1566328709, "last_edit_date": 1566330390, "question_id": 57580250, "link": "https://stackoverflow.com/questions/57580250/vba-sendkey-saving-a-pdf", "title": "VBA: SendKey Saving a PDF", "body": "<p>I am trying to open, enter data, save, and close a PDF Form without the use of Acrobat. I have figured out how to open, and enter data, but am having trouble figuring out how to save. I would like to be able to navigate using SendKeys to change the path and name of the file, but can't figure out how to get to either of them.<a href=\"https://i.stack.imgur.com/BopRY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BopRY.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Code:</p>\n\n<pre><code>        Application.SendKeys \"+^(s)\", True 'Saves\n        'Application.Wait Now + 0.00001\n        Application.SendKeys \"New File Name\", 'Attempts to send new file name but doesn't.\n        'Application.Wait Now + 0.00001\n\n        Application.SendKeys \"^(q)\", True 'closes the PDF reader.\n</code></pre>\n\n<p>When I \"Save As\" manually, the \"File Name\" is highlighted, which made me think I could just SendKeys a new file name and then SendKeys an Enter to save, but the new file name never gets to where it's supposed to go.</p>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566328900, "post_id": 57580237, "comment_id": 101620203, "body": "This looks like a better fit for REGEX"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566328974, "post_id": 57580237, "comment_id": 101620236, "body": "I get a type mismatch error... but I don&#39;t know if that means I can&#39;t do this or if it means that I just have some small syntax error"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566329087, "post_id": 57580237, "comment_id": 101620292, "body": "<code>If &quot;tag:(1001)FEXFFF&quot; Like i Then</code> - you&#39;re using a <code>For Each</code> loop."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1566329307, "post_id": 57580237, "comment_id": 101620382, "body": "Does that mean you can not use an array with Like? Also... Why is REGEX a better fit? I am asking because I am not very familiar with REGEX (I just learned about it earlier today) and it looks as though the like operator is simpler to use."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1566329423, "post_id": 57580237, "comment_id": 101620427, "body": "BigBen!! Thank you!!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1566329491, "post_id": 57580237, "comment_id": 101620452, "body": "REGEX lets you search for explicitly defined patterns and thus will generate less false positives"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "is_accepted": true, "score": 0, "last_activity_date": 1575989284, "creation_date": 1575989284, "answer_id": 59269848, "question_id": 57580237, "link": "https://stackoverflow.com/questions/57580237/can-the-like-operator-be-used-with-an-array/59269848#59269848", "title": "Can the &quot;Like Operator&quot; be used with an array?", "body": "<p>Here is an example using \"Like\" with an array... the array in this case is called \"TagForms\"</p>\n\n<pre><code>If wkbCompiledData_Table(1).Sheets(1).Cells(r, 2).Value Like TagForms(i) Then\n    wkbCompiledData_Table.Add Workbooks.Open(FileName:=wkbCompiledData_Table(1).Sheets(1).Cells(r, 1).Value, WriteResPassword:=\"x\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59269848, "answer_count": 1, "score": 0, "last_activity_date": 1575989284, "creation_date": 1566328623, "last_edit_date": 1566382369, "question_id": 57580237, "link": "https://stackoverflow.com/questions/57580237/can-the-like-operator-be-used-with-an-array", "title": "Can the &quot;Like Operator&quot; be used with an array?", "body": "<p>Can I do something like this:</p>\n\n<pre><code>Sub RTtest2()\n\n    Dim i As Variant\n    Dim ArrTest As Variant\n\n    ArrTest = Array(\"tag:(1???)?EX???\", \"tag:(3???)?EX???\", \"tag:(5???)?EX???\")\n\n    For Each i In ArrTest\n        If \"tag:(1001)FEXFFF\" Like ArrTest(i) Then\n            'Do something\n        Else\n            'Do something\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Specifically, can I use an array with the like operator?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566328746, "post_id": 57580226, "comment_id": 101620146, "body": "What is <code>b</code>? And what line throws the error?"}, {"owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "edited": false, "score": 0, "creation_date": 1566328797, "post_id": 57580226, "comment_id": 101620165, "body": "Slightly confused: are you actually transposing the data, or just copying and pasting the data without any transformation done to that data?"}, {"owner": {"reputation": 3, "user_id": 11953411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xYGqxg8VZMs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdKKL5c79AWGmnk58QVfXX5x0CG2A/photo.jpg?sz=128", "display_name": "Mary B.", "link": "https://stackoverflow.com/users/11953411/mary-b"}, "edited": false, "score": 0, "creation_date": 1566329381, "post_id": 57580226, "comment_id": 101620408, "body": "Good point, I am just trying to copy and paste the data... not really transpose anything. I adjusted the phrasing."}, {"owner": {"reputation": 3, "user_id": 11953411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xYGqxg8VZMs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdKKL5c79AWGmnk58QVfXX5x0CG2A/photo.jpg?sz=128", "display_name": "Mary B.", "link": "https://stackoverflow.com/users/11953411/mary-b"}, "edited": false, "score": 0, "creation_date": 1566329563, "post_id": 57580226, "comment_id": 101620480, "body": "BigBen; b was intended to be the range, so it would start pasting at A13 and then the +1 should return it to the next available open line.   It shows the error:  Run-time error &#39;1004&#39;: Application-defined or object defined error&quot;  In line: &quot;Worksheets(&quot;Formulary&quot;).Paste Destination:=Worksheets(&quot;Billing Sheet&quot;).Range(b + 1, 1)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11953411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xYGqxg8VZMs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdKKL5c79AWGmnk58QVfXX5x0CG2A/photo.jpg?sz=128", "display_name": "Mary B.", "link": "https://stackoverflow.com/users/11953411/mary-b"}, "edited": false, "score": 1, "creation_date": 1566389830, "post_id": 57581084, "comment_id": 101640088, "body": "You are amazing! I see what you mean about the errors that I made. Thank you very much!"}], "tags": [], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1566332755, "creation_date": 1566332755, "answer_id": 57581084, "question_id": 57580226, "link": "https://stackoverflow.com/questions/57580226/vba-copy-and-paste-data-from-page-1-with-command-button-to-a-specified-range-on/57581084#57581084", "title": "VBA copy and paste data from page 1 with Command Button to a specified range on page 2", "body": "<p>VBA does not like how you are referencing the cells. For Range, you need the column letter and a number in quotation marks. The way that you are referencing your cells is using the Cells notation. Also, you need to start the reference point for b, otherwise VBA does not know where to start.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\na = Worksheets(\"Formulary\").Cells(Rows.Count, 2).End(xlUp).Row\n'Dim rng As Range\n'Set rng = Worksheets(\"Billing Sheet\").Range(\"A13\")\nb = 13\n\nFor i = 2 To a\n\n    If Worksheets(\"Formulary\").Cells(i, 4).Value &lt;&gt; \"\" Then\n     'Change # to be the number column of Item Number\n         Worksheets(\"Formulary\").Cells(i, 1).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Billing Sheet\").Cells(b + 1, 1).PasteSpecial xlPasteValues\n'Change ,# to be the number column of product name\n        Worksheets(\"Formulary\").Cells(i, 2).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Cells(b + 1, 2)\n'Change ,# to be the number column of Quantity\n        Worksheets(\"Formulary\").Cells(i, 4).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Cells(b + 1, 3)\n'Change ,# to be the number column of UOM\n        Worksheets(\"Formulary\").Cells(i, 5).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Cells(b + 1, 4)\n'Change # to be the number column of Supply Type\n        Worksheets(\"Formulary\").Cells(i, 8).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Cells(b + 1, 5)\n        b = b + 1\n    End If\nNext\nApplication.CutCopyMode = False\n\nThisWorkbook.Worksheets(\"Formulary\").Cells(1, 1).Select\n\n\nEnd Sub\n</code></pre>\n\n<p>I commented out where you declared rng because it didn't seem to be used in this code.</p>\n"}], "owner": {"reputation": 3, "user_id": 11953411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xYGqxg8VZMs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdKKL5c79AWGmnk58QVfXX5x0CG2A/photo.jpg?sz=128", "display_name": "Mary B.", "link": "https://stackoverflow.com/users/11953411/mary-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 57581084, "answer_count": 1, "score": 0, "last_activity_date": 1566332755, "creation_date": 1566328553, "last_edit_date": 1566328958, "question_id": 57580226, "link": "https://stackoverflow.com/questions/57580226/vba-copy-and-paste-data-from-page-1-with-command-button-to-a-specified-range-on", "title": "VBA copy and paste data from page 1 with Command Button to a specified range on page 2", "body": "<p>I would like copy and paste certain cells in a line based on a value in one cell (can be any value, the criteria is that cell is not empty) into a specific range on a second spreadsheet. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\na = Worksheets(\"Formulary\").Cells(Rows.Count, 1).End(xlUp).Row\nDim rng As Range\nSet rng = Worksheets(\"Billing Sheet\").Range(\"A13\")\n\n\nFor i = 2 To a\n\n    If Worksheets(\"Formulary\").Cells(i, 4).Value &lt;&gt; \"\" Then\n     'Change # to be the number column of Item Number\n         Worksheets(\"Formulary\").Cells(i, 1).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Range(b + 1, 1)\n'Change ,# to be the number column of product name\n        Worksheets(\"Formulary\").Cells(i, 2).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Range(b + 1, 2)\n'Change ,# to be the number column of Quantity\n        Worksheets(\"Formulary\").Cells(i, 4).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Range(b + 1, 3)\n'Change ,# to be the number column of UOM\n        Worksheets(\"Formulary\").Cells(i, 5).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Range(b + 1, 4)\n'Change # to be the number column of Supply Type\n        Worksheets(\"Formulary\").Cells(i, 8).Copy\n'Change ,# to be the number column of where you want it pasted.\n        Worksheets(\"Formulary\").Paste Destination:=Worksheets(\"Billing Sheet\").Range(b + 1, 5)\n\n    End If\nNext\nApplication.CutCopyMode = False\n\nThisWorkbook.Worksheets(\"Formulary\").Cells(1, 1).Select\n\n\nEnd Sub\n</code></pre>\n\n<p>Here is the situation: I have two pages, Formulary and Billing Sheet. The quantity will be entered into Column D on Formulary. After all of the lines with a needed quantity have been entered, the Command Button (ActiveX Controls) will be clicked, transposing Column A, B, D, E, and H (based on if Column D has a quantity entered in any given line) from Formulary into range A13:G29 on the Billing Sheet.</p>\n\n<p>It is just returning with an error every time. In my code example I have written out each execution line I am trying to get because that is what I found online. Any help would be greatly appreciated!</p>\n"}, {"tags": ["c#", "excel", "vba", "dll", "com"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1566328641, "post_id": 57580117, "comment_id": 101620101, "body": "You are using <code>Task.Result</code> in <code>GetG</code>. You <a href=\"https://blog.stephencleary.com/2012/07/dont-block-on-async-code.html\" rel=\"nofollow noreferrer\">should not</a>. That will bite your later though, when you fix the SSL issue which is mostly likely <a href=\"https://stackoverflow.com/a/33091871/11683\">this</a>."}, {"owner": {"reputation": 1594, "user_id": 2762516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f4d804f3374a750732ccaa7c92b1a36?s=128&d=identicon&r=PG", "display_name": "Casey", "link": "https://stackoverflow.com/users/2762516/casey"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566330010, "post_id": 57580117, "comment_id": 101620662, "body": "Awesome thanks. Should i just use a regular method call and not the await task style?"}], "answers": [{"tags": [], "owner": {"reputation": 1594, "user_id": 2762516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f4d804f3374a750732ccaa7c92b1a36?s=128&d=identicon&r=PG", "display_name": "Casey", "link": "https://stackoverflow.com/users/2762516/casey"}, "is_accepted": false, "score": 0, "last_activity_date": 1566357756, "creation_date": 1566357756, "answer_id": 57584042, "question_id": 57580117, "link": "https://stackoverflow.com/questions/57580117/c-dll-com-that-calls-web-service-not-working-in-excel-vb/57584042#57584042", "title": "C# DLL COM that calls web service not working in Excel VB", "body": "<p>I would like to note that prior to posting my code above in the sample, I also had tried it first pointing directly to the url in the context \"https://\" it was till throwing the error. I was able to find out I had to add the following settings to get it to run by adding the code lines for ServicePointManager below:</p>\n\n<pre><code>public static async Task&lt;string&gt; TestGravApi(float lat, float lon, float eht)\n    {\n        GravityObjResult gResult = new GravityObjResult();\n\n   ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls\n   | SecurityProtocolType.Tls11\n   | SecurityProtocolType.Tls12\n   | SecurityProtocolType.Ssl3;\n\n        using (var httpClient = new HttpClient())\n        {\n            string url = String.Format(\"https://{my-url-here}/api/gravd/gp?lat={0}&amp;lon={1}&amp;eht={2}\", lat, lon, eht);\n            var json = await httpClient.GetStringAsync(url);\n\n            //sends from object to string json\n            //string output = JsonConvert.SerializeObject(product);\n            if (json != null)\n            {\n                gResult = JsonConvert.DeserializeObject&lt;GravityObjResult&gt;(json);\n                // Now parse with JSON.Net\n                return gResult.predictedGravity;\n            }\n        }\n\n        return String.Empty;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1594, "user_id": 2762516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f4d804f3374a750732ccaa7c92b1a36?s=128&d=identicon&r=PG", "display_name": "Casey", "link": "https://stackoverflow.com/users/2762516/casey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566357756, "creation_date": 1566327985, "last_edit_date": 1566328371, "question_id": 57580117, "link": "https://stackoverflow.com/questions/57580117/c-dll-com-that-calls-web-service-not-working-in-excel-vb", "title": "C# DLL COM that calls web service not working in Excel VB", "body": "<p>I currently have a project guideline to try to make C# DLL as a COM to be usable in Excel as well as other platforms. Currently it calls web services and does calculations such as getting a gravity prediction from a web service. Everything is working fine except for when I need to use class methods that are utilizing web services. I get an error in Excel stating it could not establish a SSL/TSL connection to the service and I cannot seem to find a way around this. Any help forward would be greatly appreciated as I am a life long developer, but working it into Excel is brand new to me. Below is how I am handling it in the code.</p>\n\n<p>GravityResultObject.cs</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class GravityObjResult\n{\n    public string lat { get; set; }\n    public string latDms { get; set; }\n    public string lon { get; set; }\n    public string lonDms { get; set; }\n    public string eht { get; set; }\n\n    public string predictedGravity { get; set; }\n}\n\nstatic void Main(string[] args)\n{\n}\n\npublic static async Task&lt;string&gt; TestGravApi(float lat, float lon, float eht)\n{\n    GravityObjResult gResult = new GravityObjResult();\n\n    using (var httpClient = new HttpClient())\n    {\n        string url = String.Format(\"my-api-here-gp?lat={0}&amp;lon={1}&amp;eht={2}\", lat, lon, eht);\n        var json = await httpClient.GetStringAsync(url);\n\n        if (json != null)\n        {\n                gResult = JsonConvert.DeserializeObject&lt;GravityObjResult&gt;(json);\n                // Now parse with JSON.Net\n                return gResult.predictedGravity;\n            }\n        }\n        return String.Empty;\n    }\n}\n</code></pre>\n\n<p>GPredict.cs</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class GPredict\n{\n    public float Lon { get; set; }\n    public float Lat { get; set; }\n    public float Elip { get; set; }\n\n    public float Grav { get; set; }\n\n    public GPredict(float lon, float lat, float elip)\n    {\n        Lon = lon;\n        Lat = lat;\n        Elip = elip;\n    }\n\n    public GPredict()\n    {\n    }\n\n    public float SetLON(float a)\n    {\n        Lon = a;\n        return Lon;\n    }\n\n    public float SetLAT(float a)\n    {\n        Lat = a;\n        return Lat;\n    }\n\n    public float SetELIP(float a)\n    {\n        Elip = a;\n        return Elip;\n    }\n\n    public string GetG()\n    {\n        string gReturn = String.Empty;\n        try\n        {\n            var task = WebRequestCall.TestGravApi(Lat, Lon, Elip);\n            gReturn = float.Parse(task.Result).ToString();\n        }\n        catch (Exception e)\n        {\n            gReturn = e.ToString();\n        }\n\n        return gReturn;\n    }\n}\n</code></pre>\n\n<p>DynamicCalcWrapper.cs</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class DynamicCalcWrapper : DynamicObject\n{\n    Calculator calc;\n\n    GPredict gPredict;\n\n    public DynamicCalcWrapper()\n    {\n        calc = new Calculator();\n        gPredict = new GPredict();\n    }\n\n    public override bool TryGetMember(GetMemberBinder binder, out object result)\n    {\n        result = null;\n\n        switch (binder.Name)\n        {\n            case \"add\":\n                result = (Func&lt;double, double, double&gt;)((double a, double b) =&gt; calc.add(a, b));\n                return true; \n            case \"sub\":\n                result = (Func&lt;double, double, double&gt;)((double a, double b) =&gt; calc.sub(a, b));\n                return true; \n            case \"SetLON\":\n                result = (Func&lt;float, float&gt;)((float a) =&gt; gPredict.SetLON(a));\n                return true;\n            case \"SetLAT\":\n                result = (Func&lt;float, float&gt;)((float a) =&gt; gPredict.SetLAT(a));\n                return true;\n            case \"SetELIP\":\n                result = (Func&lt;float, float&gt;)((float a) =&gt; gPredict.SetELIP(a));\n                return true;\n            case \"GetG\":\n                result = (Func&lt;float, string&gt;)((float a) =&gt; gPredict.GetG().ToString());\n                return true;\n        }\n        return false; \n    }\n}\n</code></pre>\n\n<p>Testing the result in Excel VB:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub T()\n    Dim getG As New GPredict\n    getG.Lon = 145#\n    getG.Lat = 41.11\n    getG.Elip = 33\n\n    Dim result As String\n    result = getG.getG()\n    MsgBox result\nEnd Sub\n</code></pre>\n\n<p>Note that I have the regular getter / setter for the properties, but also have a secondary way to set it since I have to allow Fortran based code to work with this and there are some restrictions on how long param settings are and such.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1566324390, "post_id": 57579276, "comment_id": 101618433, "body": "You can&#39;t do that comparison on a multi-cell range. Perhaps use <code>WorksheetFunction.CountIf</code> on that range, with 0 as the criterion."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1566324662, "post_id": 57579276, "comment_id": 101618528, "body": "So your goal is to determine if you either throw an error or you have <code>.find() is nothing</code>?  What is your ctrl+f macro?  that may be the key here... <code>set f = .find()</code> then <code>if f is nothing then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1566327804, "creation_date": 1566327804, "answer_id": 57580069, "question_id": 57579276, "link": "https://stackoverflow.com/questions/57579276/vba-code-to-display-message-based-on-cell-value-in-a-range-of-cells/57580069#57580069", "title": "VBA code to display message based on cell value in a range of cells", "body": "<p>The <code>Worksheet_Calculate</code> handler (which should be <code>Private</code>) will execute <em>every single time</em> anything is calculated on that worksheet.</p>\n\n<blockquote>\n  <p><em>the goal is that when that ID number is entered this new macro will...</em></p>\n</blockquote>\n\n<p>Use the <code>Worksheet_Change</code> handler for that. You'll get a <code>ByVal Target As Range</code> parameter that tells you which cell(s) was/were modified; you can use <code>Application.Intersect</code> to determine whether <code>Target</code> intersects with a particular range of cells, and act accordingly - there are plenty of examples on this site.</p>\n\n<p>Now, this code:</p>\n\n<blockquote>\n<pre><code>If Worksheets(\"BLD Id List To Be Searched\").Range(\"B2:B200\") &gt; 0 Then\n</code></pre>\n</blockquote>\n\n<p>Is implicitly taking the <code>Value</code> of a multi-cell <code>Range</code> object, which is a 2D variant array - and then comparing it to <code>0</code>. That's a guaranteed <em>type mismatch</em> run-time error, because you can't compare a whole array with a single value like this.</p>\n\n<p>Take @BigBen's advice here:</p>\n\n<pre><code>If Application.WorksheetFunction.CountIf([ActiveWorkbook.]Worksheets(\"name\").Range(\"B2:B200\"), \"&gt;0\") &gt; 0 Then\n</code></pre>\n\n<p>Note that if you mean to work with <code>ThisWorkbook</code> (i.e. the Excel document that contains the VBA code), and the worksheet \"BLD ID list to be searched\" exists at compile-time in <code>ThisWorkbook</code>, then the code would be more robust / user-proof if you used the sheet's code name instead of dereferencing it from the <code>Worksheets</code> collection of whatever workbook happens to be active at the time, using its user-modifiable \"tab name\".</p>\n\n<p>Change the worksheet module's <code>(Name)</code> property to e.g. <code>BLDListSheet</code>, and then you can do this:</p>\n\n<pre><code>If Application.WorksheetFunction.CountIf(BLDListSheet.Range(\"B2:B200\"), \"&gt;0\") &gt; 0 Then\n</code></pre>\n\n<p>And never need to worry about keeping the code in sync with the sheet's \"tab name\".</p>\n\n<p>Now, if the macro runs <em>every time</em> a cell is modified, it doesn't make much sense to show a message and ignore which particular cell was modified, does it?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Application.Intersect(BLDListSheet.Range(\"B2:B200\"), Target) Is Nothing Then Exit Sub\n    If IsNumeric(Target.Value) Then\n        If Target.Value &gt; 0 Then\n            ' modified cell has a new value greater than 0\n        Else\n            ' modified cell has a new value less than or equal to 0\n        End If\n    Else\n        ' Target.Value may not be safe to compare with anything here.\n        If IsError(Target.Value) Then Debug.Print Target.Address &amp; \" contains an error!\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11953117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1321c407e345491e1e083fb7377d05fb?s=128&d=identicon&r=PG&f=1", "display_name": "sircapalot", "link": "https://stackoverflow.com/users/11953117/sircapalot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566419249, "creation_date": 1566324129, "last_edit_date": 1566419249, "question_id": 57579276, "link": "https://stackoverflow.com/questions/57579276/vba-code-to-display-message-based-on-cell-value-in-a-range-of-cells", "title": "VBA code to display message based on cell value in a range of cells", "body": "<p>I am very new to VBA. I am trying to create a macro that will display a message based on cell value from a range of cells on a different sheet.I already have a macro that essentially is a ctlr + F and the goal is that when that ID number is entered this new macro will display a desired message.</p>\n\n<p>This is what I have and as you can tell I'm very new and probably isn't even close to what I need:</p>\n\n<pre><code>Sub Worksheet_Calculate()\n    If Worksheets(\"worksheet\").range(\"B2:B200\") &gt; 0 Then\n        MsgBox \"message needed\"\n    Else\n        MsgBox \"other message needed\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n\n<p>In theory if there is a 0 in the cell that was searched from the range of cells in the first macro, then it will display a message, otherwise it will display an alternative message.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566323822, "post_id": 57579178, "comment_id": 101618202, "body": "Are the different PC&#39;s using the same versions of Excel?"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1566324019, "post_id": 57579178, "comment_id": 101618276, "body": "Yes, they are.."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 4, "creation_date": 1566324131, "post_id": 57579178, "comment_id": 101618325, "body": "I suspect the problem is with unqualified objects (workbooks, worksheets, ranges) or with that <code>ActiveSheet</code>. Both are not ideal - especially when multiple books are in play"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "edited": false, "score": 0, "creation_date": 1566324198, "post_id": 57579178, "comment_id": 101618357, "body": "In my experience, importing a new sheet will always turn it into the activesheet. Do you think that&#39;s not the case here? What I find most intriguing is that it only happens sporadically, not with every workbook...."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1566324224, "post_id": 57579178, "comment_id": 101618366, "body": "If you don&#39;t end up determining why it&#39;s throwing an error for <code>Activeworkbook.Worksheets.Count</code>, you can try defining the sheets by name, set as a variable, e.g., <code>set ws = workbooks(&quot;NAME&quot;).sheets(&quot;name&quot;)</code>.  additionally,"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1566324303, "post_id": 57579178, "comment_id": 101618400, "body": "@Cyril, I&#39;m running the code on hundreds of workbooks. I always use the sheet index, as names vary by workbook, but the placement of the sheet is what defines its purpose."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1566324430, "post_id": 57579178, "comment_id": 101618451, "body": "Have you tried to use a variable like <code>wscount = worksheets.count</code> and <code>debug.print wscount</code> to see if you are getting the appropriate count?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 4, "creation_date": 1566324450, "post_id": 57579178, "comment_id": 101618457, "body": "I would start by qualifying those objects. I see <code>Sheets</code>, <code>Columns</code>, &amp; <code>Range</code> that are error prone."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566326491, "post_id": 57579485, "comment_id": 101619253, "body": "Note that <code>Sheets.Add</code> will be adding the sheet to whatever workbook happens to be active at that time. A better solution would be to have a <code>ByVal book As Workbook</code> parameter, then you can do <code>Set ws = book.Worksheets.Add</code> (I doubt this <code>Type:={path string}</code> is doing what you think it does) and move it <code>After:=book.Worksheets(2)</code>, making everything much more robust."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566326553, "post_id": 57579485, "comment_id": 101619275, "body": "Also note the inconsistency between <code>Sheets</code> and <code>Worksheets</code> usage. Pick one, stick to it... keeping in mind that <code>Sheets</code> collection can contain <code>Chart</code> and about half a dozen legacy non-worksheet sheet types. If you are working with <code>Worksheets</code>, use the <code>Worksheets</code> collection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566326656, "post_id": 57579485, "comment_id": 101619312, "body": "FYI the <code>Type</code> named argument to <code>Sheets.Add</code> can take one of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlsheettype\" rel=\"nofollow noreferrer\">XlSheetType</a> enum values. This file/path argument is definitely not doing what you think it does."}], "tags": [], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "is_accepted": true, "score": 1, "last_activity_date": 1566325189, "creation_date": 1566325189, "answer_id": 57579485, "question_id": 57579178, "link": "https://stackoverflow.com/questions/57579178/imported-worksheet-randomly-inserted-as-first-sheet-instead-of-last/57579485#57579485", "title": "Imported Worksheet Randomly Inserted as First Sheet Instead of Last", "body": "<p>This seems to do the job:</p>\n\n<pre><code>Sub Step2Importsheet()\n\nSheets.Add Type:= _\n\"D:\\Users\\Desktop\\Macro Data\\Test\\\" &amp; Range(\"E2\").Text &amp; \".csv\"\n\nDim ws As Worksheet\nSet ws = Worksheets(1)\n\nws.Move After:=Worksheets(2)\n\n\nws.Columns(\"A\").Replace \"^\", vbNullString, xlPart, xlByRows, True\nws.Range(\"AA1\").Value = \"Function\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57579485, "answer_count": 1, "score": 0, "last_activity_date": 1566325189, "creation_date": 1566323721, "question_id": 57579178, "link": "https://stackoverflow.com/questions/57579178/imported-worksheet-randomly-inserted-as-first-sheet-instead-of-last", "title": "Imported Worksheet Randomly Inserted as First Sheet Instead of Last", "body": "<p>I'm looping some code through many workbooks, on 2 separate PC's. On one PC, I keep on getting an error- not on every loop, but randomly every 3rd or 4th loop. My code is supposed to find and import a worksheet from a different workbook, and the imported sheet is supposed to be placed last. For some reason, on this one PC, it sometimes places the sheet first, which throws off all the subsequent code. Any ideas why this could be happening?</p>\n\n<p>Here is the code that is importing the worksheet:</p>\n\n<pre><code>Sub Step2Importsheet()\n\nSheets.Add Type:= _\n\"D:\\Users\\Desktop\\Macro Data\\Test\\\" &amp; Range(\"E2\").Text &amp; \".csv\"\nActiveSheet.Move After:=Worksheets(Worksheets.Count)\n\nColumns(\"A\").Replace \"^\", vbNullString, xlPart, xlByRows, True\nRange(\"AA1\").Value = \"Function\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1566332481, "post_id": 57578851, "comment_id": 101621559, "body": "You&#39;ll need to get the .SlideIndex of the slide you are deleting.  That will let you insert the new slide into the same position."}, {"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "edited": false, "score": 0, "creation_date": 1566348223, "post_id": 57578851, "comment_id": 101625125, "body": "I&#39;ll stand corrected, but I believe that when copying a Slide with a specific SlideID from one presentation to another presentation, the original SlideID is not retained, and a new one is allocated. Which means you&#39;re going to find another method of matching slides between presentations."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "edited": false, "score": 0, "creation_date": 1566485325, "post_id": 57578851, "comment_id": 101679240, "body": "@TechnoDabbler, that&#39;s correct. SlideID is guaranteed to be unique, so when a new slide is created/copied/pasted in/whatever, it gets a new and unique SlideID. This is a repeat of the same question asked elsewhere, btw. Paul, it&#39;d be better to follow up in the original thread rather than starting over here.  <a href=\"https://stackoverflow.com/questions/57501968/replacing-one-slide-in-several-open-presentations\" title=\"replacing one slide in several open presentations\">stackoverflow.com/questions/57501968/&hellip;</a>"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1566496297, "post_id": 57578851, "comment_id": 101684380, "body": "Try naming the slides and using that to find, delete and paste the slides.  Although once pasted you would have to name the slide, since PPT will rename automatically when you paste it."}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1566499719, "post_id": 57578851, "comment_id": 101685834, "body": "Gents, Thank you. I crafted a solution using SlideID. If I Cut/Paste a slide using keyboard commands from one presentation to another, the sames SlideID is retained in both. My macro specifies the SlideID in the source file, copies it, goes to the ActivePresentation, finds the same slide, deletes it, then pastes the updated slide from the source file. The key is to delete the slide being replaced, go back one slide so that it is selected, then paste. In this way, you avoid pasting in a slide &quot;that already exists&quot; and takes on a new ID. Here&#39;s my code. Not pretty but works."}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1566500023, "post_id": 57578851, "comment_id": 101685961, "body": "Sub SlideReplateTest1(); Dim sourcePresentation As Presentation; On Error Resume Next; Set sourcePresentation = Application.Presentations(&quot;X:\\Marketing Presentations (Final) \\Slide Library\\Slide Library.pptm&quot;) ; If sourcePresentation Is Nothing Then; MsgBox &quot;Source presentation not found!&quot;, vbExclamation;  Exit Sub; End If; On Error GoTo 0; Dim vSlideIDs As Variant; vSlideIDs = Array(1854);    Dim i As Long; Dim I_ID As Integer; I_ID = ActivePresentation.Slides.FindBySlideID(1854).SlideIndex; For i = LBound(vSlideIDs) To UBound(vSlideIDs) [see next comment]"}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1566500068, "post_id": 57578851, "comment_id": 101685978, "body": "sourcePresentation.Slides.FindBySlideID(vSlideIDs(i)).Copy     ActivePresentation.Slides.FindBySlideID(vSlideIDs(i)).Select     ActiveWindow.View.Slide.Delete     With ActiveWindow     With .View       lCurSlide = .Slide.SlideIndex       If lCurSlide &lt; ActivePresentation.Slides.Count Then .GotoSlide (lCurSlide - 1) Else .GotoSlide (1)     End With     If .ViewType = ppViewNormal Then .Panes(ppViewNotesPage).Activate   End With        ActiveWindow.View.Paste                     Next i  End Sub"}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1566500207, "post_id": 57578851, "comment_id": 101686039, "body": "I am now trying to figure out how to save and close the active presentation and automatically run the macro in any other open presentation except the source file-- so that I can, for example, open five presentations, run the macro, and replace the relevant slide in each one, saving each presentation as I go."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1566576291, "post_id": 57578851, "comment_id": 101712959, "body": "&gt;&gt; If I Cut/Paste a slide using keyboard commands from one presentation to another, the sames SlideID is retained in both. &lt;&lt;  Not necessarily.  If the source SlideID doesn&#39;t exist in the destination presentation, then yes. If there&#39;s already a slide with SlideID=X in the destination presentation, the source slide will get a new SlideID when you paste it in.  So unless you can be utterly certain that your SlideIDs are not duplicated anywhere, it&#39;s best not to rely on them not changing."}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1566583442, "post_id": 57578851, "comment_id": 101715913, "body": "Thanks for your help, Steve. I think I&#39;m going to have to rely on the Title/Name of the slide and just make sure they are all unique. Unfortunately, they are not currently but I can fix that. I&#39;ll have to figure out how to go to / select a slide by title/name. I&#39;ll research that."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569615681, "post_id": 57629768, "comment_id": 102668037, "body": "Hey Steve, thanks for the email reply - I&#39;ve put it up <a href=\"https://stackoverflow.com/a/58140807/1188513\">here</a> as a CW answer crediting you, but feel free to post your own (I&#39;ll upvote it)"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1566576538, "creation_date": 1566576538, "answer_id": 57629768, "question_id": 57578851, "link": "https://stackoverflow.com/questions/57578851/how-to-replace-a-slide-by-slideid-in-open-presentation/57629768#57629768", "title": "How to replace a slide by SlideID in open presentation", "body": "<p>Re \"how to save and close the active presentation and automatically run the macro in any other open presentation except the source file\", off top of head:</p>\n\n<pre><code>Dim oPres as Presentation\nDim sMyName as String\n\nsMyName = \"BlahBlah\" ' fill in the name of the pres with macros here\n\nFor Each oPres in ActivePresentations\n  If Not Ucase(oPres.Name) = Ucase(sMyName) Then\n     ' do whatever's needed to oPres here\n     oPres.Save\n     oPres.Close\n  End if\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593681695, "creation_date": 1566322340, "last_edit_date": 1593681695, "question_id": 57578851, "link": "https://stackoverflow.com/questions/57578851/how-to-replace-a-slide-by-slideid-in-open-presentation", "title": "How to replace a slide by SlideID in open presentation", "body": "<p>I want to grab an updated slide from my library of slides (source file) and use a macro to find the same slide in the open presentation and replace it with the updated slide. But I need to define slides by SlideID, not page number. So the action is: find slide (by SlideID) in open presentation, delete it, insert AT THE VERY SAME LOCATION the updated slide (with SAME SlideID) in the source file.</p>\n\n<p>I tried the code below but it deletes the bad slide in open presentation then pastes the good slide AT THE END instead of IN THE SAME LOCATION. THANKS for any help fixing this.</p>\n\n<pre><code>Sub ReplaceOneSlide()\nActivePresentation.Slides.FindBySlideID(1854).Delete\nDim sourcePresentation As Presentation\n    On Error Resume Next\n    Set sourcePresentation = Application.Presentations(\"X:\\Marketing Presentations (Final) \\Slide Library\\Slide Library.pptm\") 'change the name accordingly\n    If sourcePresentation Is Nothing Then\n        MsgBox \"Source presentation not found!\", vbExclamation\n        Exit Sub\n    End If\n    On Error GoTo 0\n\n    Dim vSlideIDs As Variant\n    vSlideIDs = Array(1854) 'change the slide IDs accordingly\n\n    Dim i As Long\n    For i = LBound(vSlideIDs) To UBound(vSlideIDs)\n        sourcePresentation.Slides.FindBySlideID(vSlideIDs(i)).Copy\n        ActivePresentation.Slides.Paste\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1566326554, "post_id": 57578804, "comment_id": 101619279, "body": "Do you keep the footer and the date aligned differently on the same line using multiple tabs? Or should they actually be different lines or even a multi-column table?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1566326698, "post_id": 57578804, "comment_id": 101619327, "body": "I&#39;d think you&#39;d have to have a different section for each page because you effectively have four different header/footer combinations. Also, how do you decide when section 2 starts?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1566335680, "post_id": 57578804, "comment_id": 101622638, "body": "If I understand correctly, yes, it&#39;s possible... But certainly does not need VBA. Try asking on Super User. Hint: it&#39;s a question of which headers/footers you unlink / leave linked."}], "owner": {"reputation": 9, "user_id": 11952994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d503ab7339486b7cb6f4dd6598a5f71?s=128&d=identicon&r=PG&f=1", "display_name": "NR13", "link": "https://stackoverflow.com/users/11952994/nr13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566335536, "creation_date": 1566322173, "last_edit_date": 1566335536, "question_id": 57578804, "link": "https://stackoverflow.com/questions/57578804/different-odd-even-header-footer-by-section-in-word", "title": "Different odd &amp; even Header / Footer by Section in Word", "body": "<p>I'm trying to figure out how to code headers and footers by sections and different even and odd pages, with a different cover. I'm looking to create something like this format:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M7nY1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7nY1.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Cover</p>\n\n<pre><code>No header or footer\n</code></pre>\n\n<p>Section 1</p>\n\n<pre><code>Odd Pages:\n                         Header 1\n    Body\n    Footer 1             Date\n    File name, Page #\n\nEven Pages:\n    Header 1\n    Body\n    Date                 Footer 1\n    File name, Page #\n</code></pre>\n\n<p>Section 2</p>\n\n<pre><code>Use the header and footer alternating pattern from Section 1 but with different Header text\n</code></pre>\n\n<hr>\n\n<p>Is this possible? Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "binary", "hex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566322667, "post_id": 57578776, "comment_id": 101617711, "body": "Why is the parameter optional, and why is there a <code>HexNum</code> module-scope variable? That makes the <code>HexNum</code> parameter hide the <code>HexNum</code> field, which makes debugging much more complicated than it needs to be."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566322751, "post_id": 57578776, "comment_id": 101617755, "body": "You want the <code>HexToBin (HexNum)</code> line to capture the returned value in a local variable, instead of re-invoking the function to show its output (very indirectly) in a msgbox."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566323007, "post_id": 57578776, "comment_id": 101617868, "body": "Something is wrong with your algorithm. <code>&quot;FFFF&quot;</code>(-1) yields <code>1</code>."}, {"owner": {"reputation": 1, "user_id": 11952845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c7523ae0574164fb73098cc4e97535?s=128&d=identicon&r=PG&f=1", "display_name": "chavesbreno", "link": "https://stackoverflow.com/users/11952845/chavesbreno"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566323165, "post_id": 57578776, "comment_id": 101617935, "body": "I&#39;m noob, sorry. I&#39;m just starting with programming language in my internship experience. I just wanna convert a ten carachters hexa to bin number. It was my first try."}, {"owner": {"reputation": 1, "user_id": 11952845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c7523ae0574164fb73098cc4e97535?s=128&d=identicon&r=PG&f=1", "display_name": "chavesbreno", "link": "https://stackoverflow.com/users/11952845/chavesbreno"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566323380, "post_id": 57578776, "comment_id": 101618020, "body": "You&#39;re right. I haven&#39;t tried with FFFF.  I was using A1, B23, etc.."}, {"owner": {"reputation": 1, "user_id": 11952845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c7523ae0574164fb73098cc4e97535?s=128&d=identicon&r=PG&f=1", "display_name": "chavesbreno", "link": "https://stackoverflow.com/users/11952845/chavesbreno"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566323422, "post_id": 57578776, "comment_id": 101618034, "body": "Do you have some tip for me to get what I want to do?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566323799, "post_id": 57578776, "comment_id": 101618191, "body": "You could declare <code>Dim ptr As LongPtr</code> and output <code>BinNum = String(LenB(ptr) * 8, &quot;1&quot;)</code> when <code>lHexNum &lt; 0</code> to handle <code>-1</code> and that&#39;ll output 64x&quot;1&quot; or 32x&quot;1&quot;, depending on pointer size on the machine running the code... but it kinda falls apart given other negatives - consider just bailing out if <code>lHexNum</code> is negative."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566323959, "post_id": 57578776, "comment_id": 101618253, "body": "use the function here: <a href=\"https://stackoverflow.com/questions/9741003/how-can-you-convert-hex-to-bin-one-character-at-a-time-in-excel-2010\" title=\"how can you convert hex to bin one character at a time in excel 2010\">stackoverflow.com/questions/9741003/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566324264, "post_id": 57578776, "comment_id": 101618384, "body": "@ScottCraner ah, nice find!"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1566324502, "last_edit_date": 1566324502, "creation_date": 1566324286, "answer_id": 57579305, "question_id": 57578776, "link": "https://stackoverflow.com/questions/57578776/code-to-convert-from-hexa-to-binary-excel-vba-a-large-number/57579305#57579305", "title": "Code to convert from Hexa to Binary Excel VBA a large number", "body": "<p>Function from <a href=\"https://stackoverflow.com/questions/9741003/how-can-you-convert-hex-to-bin-one-character-at-a-time-in-excel-2010\">HERE</a></p>\n\n<p>Included only to help with the call of the function which OP had issues.</p>\n\n<pre><code>Public Sub Test()\n\n    Dim HexNum As String\n    HexNum = \"6E29210100\"\n\n    Dim BinNum As String\n    BinNum = HEXtoBIN(HexNum)\n\n    MsgBox BinNum\n\nEnd Sub\n\nPublic Function HEXtoBIN(ByVal strHex As String) As String\n    Dim c As Long, i As Long, b As String * 4, j As Long\n    For c = 1 To Len(strHex)\n        b = \"0000\"\n        j = 0\n        i = Val(\"&amp;H\" &amp; Mid$(strHex, c, 1))\n        While i &gt; 0\n            Mid$(b, 4 - j, 1) = i Mod 2\n            i = i \\ 2\n            j = j + 1\n        Wend\n        HEXtoBIN = HEXtoBIN &amp; b\n    Next\n    HEXtoBIN = RTrim$(HEXtoBIN)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dpZIg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dpZIg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11952845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c7523ae0574164fb73098cc4e97535?s=128&d=identicon&r=PG&f=1", "display_name": "chavesbreno", "link": "https://stackoverflow.com/users/11952845/chavesbreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "closed_date": 1566324269, "accepted_answer_id": 57579305, "answer_count": 1, "score": 0, "last_activity_date": 1566324502, "creation_date": 1566322043, "last_edit_date": 1566322471, "question_id": 57578776, "link": "https://stackoverflow.com/questions/57578776/code-to-convert-from-hexa-to-binary-excel-vba-a-large-number", "closed_reason": "Duplicate", "title": "Code to convert from Hexa to Binary Excel VBA a large number", "body": "<p>I'm trying to convert 6E29210100 (hexa) to binary. \nWith smaller hexa numbers, the code works fine. and I don't know why.\nI would like it was working to 10 characters at least.</p>\n\n<pre><code>Dim HexNum As String\nDim BinNum As String\nDim lHexNum As Long\nDim i As Integer\n\nPublic Sub Teste()\n\n    HexNum = \"6E29210100\"\n\n    HexToBin (HexNum)\n\n    MsgBox \"Bin: \" &amp; HexToBin\n    BinNum = vbNullString\n\nEnd Sub\n\nPublic Function HexToBin(Optional HexNum As String) As String\n\n   On Error GoTo ErrorHandler\n\n   i = 0\n\n   lHexNum = Val(\"&amp;h\" &amp; HexNum)\n\n   Do\n      If lHexNum And 2 ^ i Then\n         BinNum = \"1\" &amp; BinNum\n      Else\n         BinNum = \"0\" &amp; BinNum\n      End If\n      i = i + 1\n   Loop Until 2 ^ i &gt; lHexNum\n\n   HexToBin = BinNum\n\nErrorHandler:\n\nEnd Function\n</code></pre>\n\n<p>Code returns:       00101001001000010000000100000000</p>\n\n<p>Right answer: \u202d0110111000101001001000010000000100000000\u202c</p>\n"}, {"tags": ["vba", "vb.net", "dll", "wsdl", "svcutil.exe"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566324089, "post_id": 57578764, "comment_id": 101618307, "body": "...the COM type you&#39;re generating adheres to and implements the interface you&#39;re telling it - <i>that is your public API</i>. If you need that API to be different, define it differently."}, {"owner": {"reputation": 33, "user_id": 150982, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/768b7864d091ba81b34fa45436ed420f?s=128&d=identicon&r=PG", "display_name": "Deano", "link": "https://stackoverflow.com/users/150982/deano"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566369494, "post_id": 57578764, "comment_id": 101629416, "body": "Thanks @MathieuGuindon. What I don&#39;t understand is why the public function defined in the class is not available (Will only methods defined in the interface be exposed?) And, if that is the case why is the tool generating the code this way?"}, {"owner": {"reputation": 33, "user_id": 150982, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/768b7864d091ba81b34fa45436ed420f?s=128&d=identicon&r=PG", "display_name": "Deano", "link": "https://stackoverflow.com/users/150982/deano"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566370830, "post_id": 57578764, "comment_id": 101630009, "body": "Missed I was getting a (probably helpful!) error from regasm. Added above."}], "owner": {"reputation": 33, "user_id": 150982, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/768b7864d091ba81b34fa45436ed420f?s=128&d=identicon&r=PG", "display_name": "Deano", "link": "https://stackoverflow.com/users/150982/deano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566370783, "creation_date": 1566321971, "last_edit_date": 1566370783, "question_id": 57578764, "link": "https://stackoverflow.com/questions/57578764/unable-to-access-methods-in-dll-generated-from-wsdl-using-svcutil", "title": "Unable to access methods in dll generated from WSDL using SVCUtil", "body": "<p>I am attempting to create a dll from a WSDL file for accessing a web service within a VBA application. When using the compiled library I can't call the class methods i need, only the methods with similar names which are built in the proxy to build the main request/response.</p>\n\n<p>This is the procedure I have tried:</p>\n\n<ul>\n<li>Generate proxy classes in vb.net using svcutil.exe</li>\n<li>Compile proxy classes to dll library using vbc.exe</li>\n<li>Register dll using regasm.exe</li>\n<li>Add reference to tlb file from within VBA (Excel)</li>\n<li>call method from within VBA after defining an instance of the class</li>\n</ul>\n\n<p>Svcutil \"<a href=\"https://deltek.XXXXXX.com/Vision/visionws.asmx?wsdl\" rel=\"nofollow noreferrer\">https://deltek.XXXXXX.com/Vision/visionws.asmx?wsdl</a>\" /language:vb /syncOnly</p>\n\n<p>vbc /t:library /out:DeltekVisionOpenAPIWebService.dll DeltekVisionOpenAPIWebService.vb</p>\n\n<p>regasm /codebase /tlb DeltekVisionOpenAPIWebService.dll</p>\n\n<p>An extract of the generated vb file:</p>\n\n<pre><code>Option Strict Off\nOption Explicit On\n\n\n\n&lt;System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.ServiceModel\", \"4.0.0.0\"),  _\n System.ServiceModel.ServiceContractAttribute([Namespace]:=\"http://tempuri.org/Deltek.Vision.WebServiceAPI.Server/DeltekVisionOpenAPIWebServi\"&amp; _ \n    \"ce\", ConfigurationName:=\"DeltekVisionOpenAPIWebServiceSoap\")&gt;  _\nPublic Interface DeltekVisionOpenAPIWebServiceSoap\n\n'CODEGEN: Generating message contract since element name ConnInfoXML from namespace http://tempuri.org/Deltek.Vision.WebServiceAPI.Server/DeltekVisionOpenAPIWebService is not marked nillable\n    &lt;System.ServiceModel.OperationContractAttribute(Action:=\"http://tempuri.org/Deltek.Vision.WebServiceAPI.Server/DeltekVisionOpenAPIWebServi\"&amp; _ \n        \"ce/UpdateOpportunity\", ReplyAction:=\"*\")&gt;  _\n    Function UpdateOpportunity(ByVal request As UpdateOpportunityRequest) As UpdateOpportunityResponse\n\nEnd Interface\n\nPartial Public Class DeltekVisionOpenAPIWebServiceSoapClient\n    Inherits System.ServiceModel.ClientBase(Of DeltekVisionOpenAPIWebServiceSoap)\n    Implements DeltekVisionOpenAPIWebServiceSoap\n\n    &lt;System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)&gt;  _\n    Function DeltekVisionOpenAPIWebServiceSoap_UpdateOpportunity(ByVal request As UpdateOpportunityRequest) As UpdateOpportunityResponse Implements DeltekVisionOpenAPIWebServiceSoap.UpdateOpportunity\n        Return MyBase.Channel.UpdateOpportunity(request)\n    End Function\n\n    Public Function UpdateOpportunity(ByVal ConnInfoXML As String, ByVal DataXML As String) As String\n        Dim inValue As UpdateOpportunityRequest = New UpdateOpportunityRequest()\n        inValue.Body = New UpdateOpportunityRequestBody()\n        inValue.Body.ConnInfoXML = ConnInfoXML\n        inValue.Body.DataXML = DataXML\n        Dim retVal As UpdateOpportunityResponse = CType(Me,DeltekVisionOpenAPIWebServiceSoap).UpdateOpportunity(inValue)\n        Return retVal.Body.UpdateOpportunityResult\n    End Function\n\nEnd Class\n</code></pre>\n\n<p>I expect to be able to call the class methods that relate to the web service calls, but the only methods that are available (returned by autocomplete/don't error as not defined when called) are the methods used to build the request and response as defined in the interface.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qVcK6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qVcK6.png\" alt=\"VBA method error\"></a></p>\n\n<p>Edit:\nSomehow missed that regasm was reporting this error, but not sure how to address it:</p>\n\n<p>Type library exporter warning processing 'DeltekWebAPI.DeltekVisionOpenAPIWebServiceSoapClient, DeltekVisionOpenAPIWebService'. Warning: Type library exporter encountered a type that derives from a generic class and is not marked as [ClassInterface(ClassInterfaceType.None)]. Class interfaces cannot be exposed for such types. Consider marking the type with [ClassInterface(ClassInterfaceType.None)] and exposing an explicit interface as the default interface to COM using the ComDefaultInterface attribute.</p>\n"}, {"tags": ["excel", "vba", "api", "google-maps"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1566320805, "post_id": 57578325, "comment_id": 101616958, "body": "<i>sorry for the wall of code i wasn&#39;t sure what to include so i copy and pasted everything</i> - the idea of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is that you <i>don&#39;t</i> post your full code, just an example that reproduces the problem with minimal code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1566329712, "post_id": 57578325, "comment_id": 101620543, "body": "I&#39;m not sure if things have moved on but IIRC the beta release required you to display maps along with using the service.  That aside.... the documentation seems pretty clear on where you put your API key: <a href=\"https://developers.google.com/maps/documentation/directions/start\" rel=\"nofollow noreferrer\">developers.google.com/maps/documentation/directions/start</a>   ( example is json but I think it likely xml will have same construct as it is querystring.) I suggest you try implementing just that part as a simple GET request and see what happens."}], "answers": [{"tags": [], "owner": {"reputation": 4385, "user_id": 11742502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/krquL.jpg?s=128&g=1", "display_name": "evan", "link": "https://stackoverflow.com/users/11742502/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1566543969, "creation_date": 1566543969, "answer_id": 57621355, "question_id": 57578325, "link": "https://stackoverflow.com/questions/57578325/how-to-update-this-vba-code-to-include-a-google-maps-api-key/57621355#57621355", "title": "How to update this VBA code to include a google maps API key", "body": "<p>You need to add your API key to a <code>key</code> parameter in your Directions API request. Also note that the <code>sensor</code> parameter is deprecated. So what you can easily do here is replace it with the key. As an additional side-note, the call should always be made over HTTPS if possible.</p>\n\n<p>See below:</p>\n\n<pre><code>If NoCache Or Requery Then ' if no cached file exists then query Google\n    ' Read the XML data from the Google Maps API\n    myRequest.Open \"GET\", \"https://maps.googleapis.com/maps/api/directions/xml?origin=\" _\n        &amp; Origin &amp; \"&amp;destination=\" &amp; Destination &amp; \"&amp;key=AIza...\", False\n    myRequest.send\nElse ' otherwise query the temp file\n</code></pre>\n\n<p>Where \"AIza...\" should be your own project's API key (which I suggest you add as a previously defined variable). For your reference take a look at <a href=\"https://developers.google.com/maps/documentation/directions/get-api-key#add_key\" rel=\"nofollow noreferrer\">Google's documentation</a>.</p>\n\n<p>Make sure that both Billing and Directions API are enabled on your project.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 11952853, "user_type": "registered", "profile_image": "https://graph.facebook.com/892226017825684/picture?type=large", "display_name": "Ben Katahri Swan", "link": "https://stackoverflow.com/users/11952853/ben-katahri-swan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1566543969, "creation_date": 1566320011, "last_edit_date": 1566320848, "question_id": 57578325, "link": "https://stackoverflow.com/questions/57578325/how-to-update-this-vba-code-to-include-a-google-maps-api-key", "title": "How to update this VBA code to include a google maps API key", "body": "<p>I am new to VBA but I am trying to update an Excel spreadsheet that calculates distances between two points. this code used to work (as far as I know) but now requires a  Google API key. I have my API key ready to go but not sure how to implement it into this code. I could use a little guidance.</p>\n\n<p>(sorry for the wall of code I wasn't sure what to include so I copy/pasted everything)</p>\n\n<pre><code>Option Explicit\n\nFunction G_DISTANCE( _\n    Origin As String, _\n    Destination As String, _\n    Optional Requery As Boolean = False _\n    ) As Variant\n' Requires a reference to Microsoft XML, v6.0\n\nDim myRequest As XMLHTTP60\nDim myDomDoc As DOMDocument60\nDim distanceNode As IXMLDOMNode\nDim statusNode As IXMLDOMNode\nDim CachedFile As String\nDim NoCache As Boolean\n    On Error GoTo exitRoute\n    G_DISTANCE = CVErr(xlErrNA) ' Return an #N/A error in the case of any errors\n\n    ' Check and clean inputs\n    If WorksheetFunction.IsNumber(Origin) _\n        Or IsEmpty(Origin) _\n        Or Origin = \"\" Then GoTo exitRoute\n    If WorksheetFunction.IsNumber(Destination) _\n        Or IsEmpty(Destination) _\n        Or Destination = \"\" Then GoTo exitRoute\n    Origin = URLEncode(CStr(Origin), True)\n    Destination = URLEncode(CStr(Destination), True)\n\n    ' Check for existence of cached file\n    CachedFile = Environ(\"temp\") &amp; \"\\\" &amp; Origin &amp; \"_\" &amp; Destination &amp; \"_Dist.xml\"\n    NoCache = (Len(Dir(CachedFile)) = 0)\n\n    Set myRequest = New XMLHTTP60\n\n    If NoCache Or Requery Then ' if no cached file exists then query Google\n        ' Read the XML data from the Google Maps API\n        myRequest.Open \"GET\", \"http://maps.googleapis.com/maps/api/directions/xml?origin=\" _\n            &amp; Origin &amp; \"&amp;destination=\" &amp; Destination &amp; \"&amp;sensor=false\", False\n        myRequest.send\n\n\n    Else ' otherwise query the temp file\n        myRequest.Open \"GET\", CachedFile\n        myRequest.send\n        Set myDomDoc = New DOMDocument60\n        myDomDoc.LoadXML myRequest.responseText\n        ' Get the status code of the cached XML file in case of previously cached errors\n        Set statusNode = myDomDoc.SelectSingleNode(\"//status\")\n        If Not statusNode.Text = \"OK\" Then\n            Call G_DISTANCE(Origin, Destination, True) ' Recursive way to try to remove cached errors\n        End If\n    End If\n\n    ' Make the XML readable using XPath\n    Set myDomDoc = New DOMDocument60\n    myDomDoc.LoadXML myRequest.responseText\n\n    ' If statusNode is \"OK\" then get the values to return\n    Set statusNode = myDomDoc.SelectSingleNode(\"//status\")\n    If statusNode.Text = \"OK\" Then\n        If NoCache Then: Call CreateFile(CachedFile, myRequest.responseText) ' Cache API response if required\n        ' Get the distance\n        Set distanceNode = myDomDoc.SelectSingleNode(\"//leg/distance/value\")\n        If Not distanceNode Is Nothing Then G_DISTANCE = val(distanceNode.Text) / 1000 ' Now works with comma as decimal separator\n    Else\n        G_DISTANCE = statusNode.Text\n    End If\nexitRoute:\n    ' Tidy up\n    Set statusNode = Nothing\n    Set distanceNode = Nothing\n    Set myDomDoc = Nothing\n    Set myRequest = Nothing\nEnd Function\n```\n\n```vba\nFunction G_DURATION( _\n    Origin As String, _\n    Destination As String, _\n    Optional Requery As Boolean = False _\n    ) As Variant\n' Requires a reference to Microsoft XML, v6.0\n' Dependencies:\n' Encode_URL\n' Utilities_Files.Create_File\n\n' Updated 30/10/2012 to\n'   - return an #N/A error if an error occurs\n'   - cache if necessary\n'   - check for and attempt to correct cached errors\n'   - work on systems with comma as decimal separator\n\nDim myRequest As XMLHTTP60\nDim myDomDoc As DOMDocument60\nDim durationNode As IXMLDOMNode\nDim statusNode As IXMLDOMNode\nDim CachedFile As String\nDim NoCache As Boolean\n    On Error GoTo exitRoute\n    G_DURATION = CVErr(xlErrNA) ' Return an #N/A error in the case of any errors\n\n    ' Check and clean inputs\n    If WorksheetFunction.IsNumber(Origin) _\n        Or IsEmpty(Origin) _\n        Or Origin = \"\" Then GoTo exitRoute\n    If WorksheetFunction.IsNumber(Destination) _\n        Or IsEmpty(Destination) _\n        Or Destination = \"\" Then GoTo exitRoute\n    Origin = ConvertAccent(URLEncode(CStr(Origin), True))\n    Destination = ConvertAccent(URLEncode(CStr(Destination), True))\n\n    ' Check for existence of cached file\n    CachedFile = Environ(\"temp\") &amp; \"\\\" &amp; Origin &amp; \"_\" &amp; Destination &amp; \"_Dist.xml\"\n    NoCache = (Len(Dir(CachedFile)) = 0)\n\n    Set myRequest = New XMLHTTP60\n\n    If NoCache Or Requery Then ' if no cached file exists then query Google\n        ' Read the XML data from the Google Maps API\n        myRequest.Open \"GET\", \"http://maps.googleapis.com/maps/api/directions/xml?origin=\" _\n            &amp; Origin &amp; \"&amp;destination=\" &amp; Destination &amp; \"&amp;sensor=false\", False\n        myRequest.send\n    Else ' otherwise query the temp file\n        myRequest.Open \"GET\", CachedFile\n        myRequest.send\n        Set myDomDoc = New DOMDocument60\n        myDomDoc.LoadXML myRequest.responseText\n        ' Get the status code of the cached XML file in case of previously cached errors\n        Set statusNode = myDomDoc.SelectSingleNode(\"//status\")\n        If Not statusNode.Text = \"OK\" Then\n            Call G_DURATION(Origin, Destination, True) ' Recursive way to try to remove cached errors\n        End If\n    End If\n\n    ' Make the XML readable using XPath\n    Set myDomDoc = New DOMDocument60\n    myDomDoc.LoadXML myRequest.responseText\n\n    ' If statusNode is \"OK\" then get the values to return\n    Set statusNode = myDomDoc.SelectSingleNode(\"//status\")\n    If statusNode.Text = \"OK\" Then\n        If NoCache Then: Call CreateFile(CachedFile, myRequest.responseText) ' Cache API response if required\n        ' Get the duration\n        Set durationNode = myDomDoc.SelectSingleNode(\"//leg/duration/value\")\n        If Not durationNode Is Nothing Then G_DURATION = val(durationNode.Text) / 60 ' Now works with comma as decimal separator\n    End If\n\nexitRoute:\n    ' Tidy up\n    Set statusNode = Nothing\n    Set durationNode = Nothing\n    Set myDomDoc = Nothing\n    Set myRequest = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1566320999, "post_id": 57578090, "comment_id": 101617059, "body": "You want to invoke <code>Worksheet.Evaluate</code>, not <code>Application.Evaluate</code> - otherwise <code>Evaluate</code> is operating in the context of whatever worksheet is currently active... and you <i>don&#39;t</i> want to be activating sheets just for that."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1566320256, "creation_date": 1566320256, "answer_id": 57578397, "question_id": 57578090, "link": "https://stackoverflow.com/questions/57578090/converting-a-index-match-offset-function-to-work-with-userform/57578397#57578397", "title": "Converting a Index &amp; Match &amp; Offset function to work with userform", "body": "<p>You can do this:</p>\n\n<pre><code>Evaluate(\"INDEX(A$6:A$72,MATCH(\" &amp; Edit_pool.Change_Pool.value &amp; \",B$6:B$72,0))\")\n</code></pre>\n\n<p>Note if your value is not numeric you'll need to add quotes around it:</p>\n\n<pre><code>Evaluate(\"INDEX(A$6:A$72,MATCH(\"\"\" &amp; Edit_pool.Change_Pool.value &amp; \"\"\",B$6:B$72,0))\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1566320365, "creation_date": 1566320365, "answer_id": 57578426, "question_id": 57578090, "link": "https://stackoverflow.com/questions/57578090/converting-a-index-match-offset-function-to-work-with-userform/57578426#57578426", "title": "Converting a Index &amp; Match &amp; Offset function to work with userform", "body": "<p>To match text values, try...</p>\n\n<pre><code>Evaluate(\"OFFSET(INDEX(A$6:A$72,MATCH(\"\"\" &amp; Edit_pool.Change_Pool.value &amp; \"\"\",B$6:B$72,0)),1,0)\") = Change_Pool.Value\n</code></pre>\n\n<p>To match numerical values, try...</p>\n\n<pre><code>Evaluate(\"OFFSET(INDEX(A$6:A$72,MATCH(\" &amp; Edit_pool.Change_Pool.value &amp; \",B$6:B$72,0)),1,0)\") = Change_Pool.Value\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57578426, "answer_count": 2, "score": 0, "last_activity_date": 1566320365, "creation_date": 1566319065, "question_id": 57578090, "link": "https://stackoverflow.com/questions/57578090/converting-a-index-match-offset-function-to-work-with-userform", "title": "Converting a Index &amp; Match &amp; Offset function to work with userform", "body": "<p>I have a working VBA code here:</p>\n\n<pre><code>Evaluate(\"INDEX(A$6:A$72,MATCH(J5,B$6:B$72,0))\") = Change_Pool.Value\n</code></pre>\n\n<p>What it does, is takes a index and matches it with a userform linked cell (J5).</p>\n\n<hr>\n\n<p>What I want it to do is:\n1. Make the VBA code use the combobox on the userform (Edit_pool.Change_Pool) instead of the linked cell. ie:</p>\n\n<pre><code>Evaluate(\"INDEX(A$6:A$72,MATCH(  *Edit_pool.Change_Pool.value*  ,B$6:B$72,0))\")\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Then I want it to offset the result down a cell.\nSo It would look like</p>\n\n<p>Offset (\"INDEX(A$6:A$72,MATCH(  <em>Edit_pool.Change_Pool.value</em>  ,B$6:B$72,0))\") 1</p></li>\n</ol>\n\n<p>or something ^^</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1566319957, "post_id": 57578089, "comment_id": 101616598, "body": "How could you have &gt;1 file with the same name though?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 3, "creation_date": 1566320128, "post_id": 57578089, "comment_id": 101616658, "body": "Why don&#39;t you change your <code>Report</code> procedure to a <code>Boolean Function</code> and have it return true/ false if there is a missing file. You can then use that in your <code>CheckFiles</code> procedure."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566320703, "post_id": 57578089, "comment_id": 101616908, "body": "@TimWilliams the file names are different."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1566320803, "post_id": 57578089, "comment_id": 101616956, "body": "@Dean I have other code in the <code>Report</code>, it is the main module. I don&#39;t want it to affect the rest of the code on the module. Will it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1566320971, "post_id": 57578089, "comment_id": 101617044, "body": "But doesn&#39;t <code>CheckFiles(&quot;&quot;, &quot;File4.xlsx&quot;, 24)</code> check for 24 copies of File4.xlsx ?  Not a big deal - just pointing that out."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566321045, "post_id": 57578089, "comment_id": 101617073, "body": "@TimWilliams My mistake it&#39;s supposed to be <code>CheckFiles(&quot;&quot;, &quot;File4*.xlsx&quot;, 24)</code>."}, {"owner": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566321185, "post_id": 57578089, "comment_id": 101617128, "body": "first, you have to decide where you want to exit if only one of the files is missing. do you want to skip all the calls to check? or only the one regarding the missing file? is it relevant to check file 1 if file 2 is missing? do you want to check file 3 if file 2 is missing?"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566321819, "post_id": 57578089, "comment_id": 101617366, "body": "@Tuckbros l don&#39;t want to skip any call to check. What if want if to check if file 1 is missing and if it is write to txt file, then check if file 2 is missing and if it is write to txt file, etc. then exit sub if any of the files is missing."}, {"owner": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566323972, "post_id": 57578089, "comment_id": 101618257, "body": "If that is &quot;only&quot; this, the answer is there : <a href=\"https://stackoverflow.com/questions/16351249/vba-check-if-file-exists\" title=\"vba check if file exists\">stackoverflow.com/questions/16351249/vba-check-if-file-exist&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566331861, "post_id": 57578089, "comment_id": 101621334, "body": "@Tuckbros I&#39;ve tried that but it isn&#39;t working for me"}, {"owner": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566365781, "post_id": 57578089, "comment_id": 101628099, "body": "I don&#39;t understand the issue. does the checkFiles do what you want ? if you want to return a result from <code>CheckFiles</code> to the <code>Report</code> you can turn your <code>Sub CheckFiles</code>to a <code>function</code> and return whatever you want, true or false or the number of missing files or pass to <code>Sub CheckFiles</code> a 4th argument by reference, to value it as for the function with true, false or the number of missing files. Based on the result of the function or on the value of the retrieved argument you will be able to set a <code>if</code> condtion as you want in the <code>Report</code>"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566367434, "post_id": 57578089, "comment_id": 101628644, "body": "@Tuckbros the <code>CheckFiles</code> does what I want it to (check files and write number of missing files to the <code>txt</code> file if any are missing). My main issue is I&#39;m trying to exit to the <code>report</code> sub if <code>CheckFiles</code> writes to the <code>txt</code> file (i.e. stop the running the script is files are missing). <code>CheckFiles</code> works on its own but when i try to run it with the <code>Report</code> module it does not write to the <code>txt</code> file, I&#39;ve also tried it with the excamples in the link."}, {"owner": {"reputation": 357, "user_id": 5535331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341a7b9aa67a02c2f67484770cff194?s=128&d=identicon&r=PG", "display_name": "Tuckbros", "link": "https://stackoverflow.com/users/5535331/tuckbros"}, "edited": false, "score": 0, "creation_date": 1566373353, "post_id": 57578089, "comment_id": 101631168, "body": "make sure the path are rigth. called from Report you can give a value to the first argument."}], "owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566321077, "creation_date": 1566319060, "last_edit_date": 1566321077, "question_id": 57578089, "link": "https://stackoverflow.com/questions/57578089/excel-vba-exit-sub-after-writing-to-txt-file", "title": "Excel vba exit sub after writing to txt file", "body": "<p>I've got the following module checks for the number of files and writes to a .txt file when files are missing:</p>\n\n<pre><code>Sub CheckFiles(strDir As String, strType As String, chknum As Integer)\n\n    Dim file As Variant, i As Integer\n    Dim sFilename As String\n    strDir = ThisWorkbook.Path &amp; \"\\Source\\\"\n    sFilename = ThisWorkbook.Path &amp; \"\\Logs.txt\"\n\n\n    If Right(strDir, 1) &lt;&gt; \"\\\" Then strDir = strDir &amp; \"\\\"\n    file = Dir(strDir &amp; strType)\n    While (file &lt;&gt; \"\")\n        i = i + 1\n        file = Dir\n    Wend\n\n    If i &lt;&gt; chknum Then\n\n    ' Archive file at certain size\n    If FileLen(sFilename) &gt; 20000 Then\n        FileCopy sFilename _\n            , Replace(sFilename, \".txt\", Format(Now, \"ddmmyyyy hhmmss.txt\"))\n        Kill sFilename\n    End If\n\n    ' Open the file to write\n    Dim filenumber As Variant\n    filenumber = FreeFile\n    Open sFilename For Append As #filenumber\n\n    Print #filenumber, CStr(Now) &amp; \", \" &amp; \"Source file: \" &amp; strType &amp; \" is missing \" &amp; chknm - i &amp; \" file(s)\"\n\n    Close #filenumber\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>The CheckFiles sub is called from this module:</p>\n\n<pre><code>Sub Report()\n\n'other code\nCall CheckFiles(\"\", \"File1.xlsx\", 1)\nCall CheckFiles(\"\", \"File2.xlsx\", 1)\nCall CheckFiles(\"\", \"File3.xlsx\", 1)\nCall CheckFiles(\"\", \"File4*.xlsx\", 24)\n'other code\n\n\nEnd Sub\n</code></pre>\n\n<p>What I'm trying to do is to exit the <code>Report</code> sub if files are missing.</p>\n\n<p>I've tried adding On <code>Error Goto EH</code> at the beginning of <code>CheckFiles</code> and adding the following at the end of the <code>Report</code> sub when error is detected but it doesn't work.</p>\n\n<pre><code>Done:\n    Exit Sub\nEH:\n    Call EmailError\nEnd Sub\n</code></pre>\n\n<p>How can I achieve this?</p>\n"}]