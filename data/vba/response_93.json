[{"tags": ["vba", "powerpoint", "object-model"], "comments": [{"owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "edited": false, "score": 1, "creation_date": 1492688713, "post_id": 40142082, "comment_id": 74090302, "body": "This is a genuine question and shows research effort. Shouldn&#39;t have been downvoted."}], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1109164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a4e5a61b5eead817f51ab3cb9de8eb9?s=128&d=identicon&r=PG&f=1", "display_name": "Alan K", "link": "https://stackoverflow.com/users/1109164/alan-k"}, "edited": false, "score": 1, "creation_date": 1476939314, "post_id": 40144745, "comment_id": 67560964, "body": "Bingo. It&#39;s not on that page but on a page that it links to; this one: <a href=\"http://skp.mvps.org/designs.htm\" rel=\"nofollow noreferrer\">skp.mvps.org/designs.htm</a> Naturally; you insert a new Slide Master so it makes sense for MS to call them &quot;Designs&quot; (eyeroll). Many thanks, you have demystified it greatly."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 2, "creation_date": 1476947501, "post_id": 40144745, "comment_id": 67564697, "body": "Microsoft&#39;s terminology in this area of PowerPoint is quite frankly a mess! The UI refers to Slide Master in the View tab and Designs elsewhere. Once in slide master view there are multiple masters each of which contain a &#39;parent&#39; (no one seems to know what to call it!) and one or more Custom Layouts. I think it probably went off the rails when multiple masters were introduced and backwards compatibility had to be retained."}, {"owner": {"reputation": 1767, "user_id": 1109164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a4e5a61b5eead817f51ab3cb9de8eb9?s=128&d=identicon&r=PG&f=1", "display_name": "Alan K", "link": "https://stackoverflow.com/users/1109164/alan-k"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1476992963, "post_id": 40144745, "comment_id": 67595471, "body": "@JamieG; yes, I was thinking the same thing. It wouldn&#39;t be so bad if the hierarchy was better explained in the CustomLayouts documentation on MSDN, but as of the time of writing it&#39;s not explained at all. ( <a href=\"https://msdn.microsoft.com/en-us/library/office/ff745764.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff745764.aspx</a> ) It seems that you can manipulate CustomLayout objects in the same way via either the Presentation&#39;s SlideMaster object OR a Design&#39;s SlideMaster object... BUT first you have to know that the Design object (a) exists and (b) actually means &quot;what we call a slide master when you add it in the GUI&quot;."}], "tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1476932885, "creation_date": 1476932885, "answer_id": 40144745, "question_id": 40142082, "link": "https://stackoverflow.com/questions/40142082/does-anyone-understand-the-slidemaster-property-of-the-powerpoint-presentation-o/40144745#40144745", "title": "Does anyone understand the SlideMaster property of the Powerpoint Presentation object?", "body": "<p>Perhaps this page will be helpful in understanding it better - <a href=\"http://skp.mvps.org/2007/ppt003.htm\" rel=\"nofollow\">http://skp.mvps.org/2007/ppt003.htm</a></p>\n"}], "owner": {"reputation": 1767, "user_id": 1109164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a4e5a61b5eead817f51ab3cb9de8eb9?s=128&d=identicon&r=PG&f=1", "display_name": "Alan K", "link": "https://stackoverflow.com/users/1109164/alan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2424, "favorite_count": 0, "accepted_answer_id": 40144745, "answer_count": 1, "score": 2, "last_activity_date": 1476932885, "creation_date": 1476913759, "question_id": 40142082, "link": "https://stackoverflow.com/questions/40142082/does-anyone-understand-the-slidemaster-property-of-the-powerpoint-presentation-o", "title": "Does anyone understand the SlideMaster property of the Powerpoint Presentation object?", "body": "<p>I refer specifically to the 2016 version, but this should also apply to 2013 and 2010. </p>\n\n<p>----- TLDR Summary</p>\n\n<ul>\n<li>Is it possible to use VBA to add a new Slide Master using a method\nthat I haven't found? </li>\n<li>Is it possible to use VBA to access or manipulate the Layouts of\nSlide Masters other than the first one in a Presentation object?</li>\n<li>I suspect that the answer to both is \"No\" and that MS has merely\nscrewed up the exposure of the underlying objects, but others may\nknow more about programming PPT than me.</li>\n</ul>\n\n<p>------ The Whole Question</p>\n\n<p>Microsoft has deemed PowerPoint unworthy of a macro recorder for lo these many versions (I think it was dropped in either 2003 or 2007 from memory), so no help can be obtained from there.</p>\n\n<p>The linked MSDN \"help\" <a href=\"https://msdn.microsoft.com/en-us/library/ff745484.aspx\" rel=\"nofollow\">item</a> is woeful. It states that the property returns a Master object, though that isn't relevant for the moment.</p>\n\n<p>An Office support page describes a slide master <a href=\"https://support.office.com/en-us/article/What-is-a-slide-master-b9abb2a0-7aef-4257-a14e-4329c904da54\" rel=\"nofollow\">here</a>. A Slide Master seems to be where the presentation's Slide Layouts live, presumably in the SlideMaster's CustomLayouts property, though it's interesting to note that only the first 9 of those CustomLayouts correspond to what you see in the GUI. (I count 11 CustomLayout objects in the SlideMaster in a new, blank presentation.) The numbers change if you add new layouts though the two vertical text layouts never seem to appear in the GUI list. This too is not the problem.</p>\n\n<p>The problem is that you can in fact have more than one Slide Master per presentation by going to the View menu, Slide Master, and then selecting Insert Slide Master. Having multiple Slide Masters is discussed on the Office Support site <a href=\"https://support.office.com/en-us/article/Use-multiple-slide-masters-in-one-presentation-09174b1b-04a3-41b8-bc22-2e21636d9e7f\" rel=\"nofollow\">here</a>.</p>\n\n<p>Frankly I regard this functionality as slightly broken because if you do that, then apply a Theme to the new Slide Master, you end up with a <strong><em>third</em></strong> Slide Master; the original under \"Office Theme\", a second under \"Custom Design\", and a third under the name of the Theme that you applied. This too is not in itself a problem. (Though it's worth noting that a Presentation does not have an AddSlideMaster method, which means that it does not seem to be possible to do this by VBA. Not that you necessarily <strong><em>want</em></strong> to, but if you did, you can't. There is only an .AddTitleMaster method which seems to be useless since all presentations have a TitleMaster as far as I can see and if a presentation has one then that method will error out according to <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.powerpoint._presentation.addtitlemaster(v=office.14).aspx\" rel=\"nofollow\">the documentation</a>.)</p>\n\n<p>The problem is that the Presentation object does not have a <strong><em>collection</em></strong> of Slide Masters. It has only that one property, SlideMaster, which returns a single Slide Master / Master object. </p>\n\n<p>Accordingly I can't see any way that you can programmatically add a new Slide Master. And even if you used one that is added through the GUI you can't seem to <strong><em>access</em></strong> any Slide Master except for the first one. And therefore you don't seem to be able to access, manipulate or assign any Layout from any Slide Master other than the first one to an individual slide. </p>\n\n<p>Am I correct in this assumption, or am I missing something?</p>\n\n<p>I shall offer thanks in advance even though that is often deleted from questions. Not that this one is likely to attract much attention; I suspect that there may be another Tumbleweed badge in my future.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37, "user_id": 3050550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701fd30d482695298c9f00f71b216c7a?s=128&d=identicon&r=PG&f=1", "display_name": "mrbusto71", "link": "https://stackoverflow.com/users/3050550/mrbusto71"}, "edited": false, "score": 0, "creation_date": 1476912826, "post_id": 40141765, "comment_id": 67553742, "body": "Also, for the record, this isn&#39;t all of the code, just a bit past where the error is occurring."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1476912928, "post_id": 40141765, "comment_id": 67553786, "body": "What does <code>debug.print mypath</code> show at that point (look in the Immediate window with [ctrl]+G)? Why use a &#39;helper&#39; function like <code>MonthName</code> when you can just use <code>Format(date, &quot;mmm&quot;)</code> or  <code>Format(date, &quot;mmmm&quot;)</code> ? I seem to remember problems with workbook names containing periods; can you run a test without them?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1476913015, "post_id": 40141765, "comment_id": 67553819, "body": "<code>lastrow = Worksheets(1).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> here the <code>Worksheets(1)</code> is not tied to wb1 since you&#39;re missing the leading period.  Unless you meant it that way."}, {"owner": {"reputation": 37, "user_id": 3050550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701fd30d482695298c9f00f71b216c7a?s=128&d=identicon&r=PG&f=1", "display_name": "mrbusto71", "link": "https://stackoverflow.com/users/3050550/mrbusto71"}, "edited": false, "score": 0, "creation_date": 1476913711, "post_id": 40141765, "comment_id": 67554119, "body": "Heya @Jeeped! Do I type the debug.print mypath IN the immediate window, or is it supposed to go somewhere in the code? The short answer to the why question is simply that I&#39;m fairly new to this and learning best practices as I go. Lastly, this is for my company and the destination workbooks are all formatted with periods for each week of the year, otherwise I&#39;d name &#39;em something else. @Tim Williams would that cause the error in question? I see the hole in my logic and I&#39;m gonna change it, just wondering if that might be the problem."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1476915754, "post_id": 40141765, "comment_id": 67554887, "body": "Under the <code>Set wb2 = ...</code> line, enter <code>Debug.print mypath</code>. Copy the line from the immediate window and paste it into the address bar of a Windows Explorer window. This will validate is the path you are building is to a file that exists. IF it fails to open copy the two paths (yours and the actual one) into notepad to see what might be missing."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3050550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701fd30d482695298c9f00f71b216c7a?s=128&d=identicon&r=PG&f=1", "display_name": "mrbusto71", "link": "https://stackoverflow.com/users/3050550/mrbusto71"}, "edited": false, "score": 0, "creation_date": 1476918250, "post_id": 40142443, "comment_id": 67555708, "body": "Looks like I&#39;m naming my child Thomas. Thanks for the help, I can rest easy now!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1476929645, "last_edit_date": 1476929645, "creation_date": 1476915556, "answer_id": 40142443, "question_id": 40141765, "link": "https://stackoverflow.com/questions/40141765/run-time-error-438-object-doesnt-support-this-property-or-method-vba/40142443#40142443", "title": "Run-time error 438: Object doesn&#39;t support this property or method (VBA)", "body": "<p>Your error if caused by this line <code>mystring = .Range(\"A\" &amp; x)</code>.  <code>Workbook</code> does not have a <code>Range</code> method.  You need to change it to <code>wb1.Worksheets(1)</code>.</p>\n\n<p>You should also test if the file exists before opening it.  </p>\n\n<p>I included an alternate method of creating your file string using the backslash to escape characters in the <code>Format</code> functions <code>Format</code> parameter.  </p>\n\n<pre><code>Sub MasterXfer()\n    Dim wb2 As Workbook\n    Dim mypath As String\n\n    mypath = Format(Sheet1.Range(\"B1\").Value, \"\\S:\\\\YYYY\\\\MM_MMMM_YYYY\\\\Pro\\du\\ctivit\\y MM.DD.YY.xl\\sx\")\n\n    If Len(Dir(mypath)) = 0 Then\n        MsgBox \"File not found\" &amp; vbCrLf &amp; mypath\n        Stop\n        Exit Sub\n    End If\n\n    Set wb2 = Workbooks.Open(mypath)\n\n    With ThisWorkbook.Worksheets(1)\n\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For x = 2 To LastRow Step 16\n            mystring = .Range(\"A\" &amp; x)\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3050550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701fd30d482695298c9f00f71b216c7a?s=128&d=identicon&r=PG&f=1", "display_name": "mrbusto71", "link": "https://stackoverflow.com/users/3050550/mrbusto71"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6664, "favorite_count": 0, "accepted_answer_id": 40142443, "answer_count": 1, "score": 0, "last_activity_date": 1476929645, "creation_date": 1476912362, "question_id": 40141765, "link": "https://stackoverflow.com/questions/40141765/run-time-error-438-object-doesnt-support-this-property-or-method-vba", "title": "Run-time error 438: Object doesn&#39;t support this property or method (VBA)", "body": "<p>This is driving me absolutely insane. \nI'm new to VBA and I compiled code line by line, adding more and more verifying it all worked within the same workbook using F8. The last bit I have to add is just opening a separate workbook, and now it's giving me errors each time. Here's my code:</p>\n\n<pre><code>Sub MasterXfer()\nDim mystring As String, wbName As String, dt As String, sdt As String, ldt As String\nDim wb1 As Workbook, wb2 As Workbook, mypath As String\n\nwbNam = \"Productivity \"\ndt = Sheet1.Range(\"B1\").Value\nsdt = Format(CStr(dt), \"m.d.yy\") &amp; \".xlsx\"\nldt = Format(CStr(dt), \"yyyy\") &amp; \"\\\" &amp; Format(CStr(dt), \"mm\") &amp; \"_\" &amp; MonthName(Month(dt)) &amp; \"_\" &amp; Year(dt)\n\nmypath = \"S:\\\" &amp; ldt &amp; \"\\\" &amp; wbNam &amp; sdt\n\nSet wb1 = ThisWorkbook\nSet wb2 = Workbooks.Open(mypath) 'HERE'S WHERE IT ERRORS OUT\n\nWith wb1\nlastrow = Worksheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor x = 2 To lastrow Step 16\nmystring = .Range(\"A\" &amp; x)\n</code></pre>\n\n<p>Stepping through this, it works fine. Then I get to the <code>Set wb2 = Workbooks.Open</code> line, and it successfully opens the target workbook, however immediately upon opening it the code stops and the error in question comes up. </p>\n\n<p>If anyone at all can tell me what mistake I'm making I will name my firstborn after you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1476912043, "post_id": 40141462, "comment_id": 67553404, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>.  And include the code you are trying to work through."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4781405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4cfaf5e65cef6b9d7e5ec30519e26a?s=128&d=identicon&r=PG&f=1", "display_name": "Matzunaga", "link": "https://stackoverflow.com/users/4781405/matzunaga"}, "is_accepted": false, "score": 0, "last_activity_date": 1476915335, "creation_date": 1476915335, "answer_id": 40142401, "question_id": 40141462, "link": "https://stackoverflow.com/questions/40141462/copy-and-paste-vba/40142401#40142401", "title": "Copy and paste VBA", "body": "<p>you could use an excel formula to copy from one sheet to another</p>\n\n<p>follow the instructions on this site</p>\n\n<p><a href=\"http://ccm.net/faq/9795-transfer-data-between-excel-spreadsheets\" rel=\"nofollow\">http://ccm.net/faq/9795-transfer-data-between-excel-spreadsheets</a></p>\n\n<p>it basically says to</p>\n\n<p>in the target cell type +\nthen select the source worksheet\nclick on the source cell\nthen hit enter</p>\n\n<p>these steps will make a copy of, for example, work sheet 1, cell A1 into work sheet 2 cell A1</p>\n\n<p>the formula is as follows =+Sheet1!A1</p>\n\n<p>I hope this is of some help to you</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7044585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bd1f897cfdf44be1f3977aa1b98727?s=128&d=identicon&r=PG&f=1", "display_name": "mike4766", "link": "https://stackoverflow.com/users/7044585/mike4766"}, "edited": false, "score": 0, "creation_date": 1476971433, "post_id": 40143668, "comment_id": 67581313, "body": "Thanks for your help.This works but my problem is data is not even it is all over the place which i need to organize in another sheet."}], "tags": [], "owner": {"reputation": 433, "user_id": 5452099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93413cc31f6a86d6bfcb5ab44de5168?s=128&d=identicon&r=PG&f=1", "display_name": "Realitybites", "link": "https://stackoverflow.com/users/5452099/realitybites"}, "is_accepted": false, "score": 0, "last_activity_date": 1476923775, "creation_date": 1476923775, "answer_id": 40143668, "question_id": 40141462, "link": "https://stackoverflow.com/questions/40141462/copy-and-paste-vba/40143668#40143668", "title": "Copy and paste VBA", "body": "<p>You have a few options here, but let me first explain one thing to you.</p>\n\n<p>When you are copying and pasting cells, you are actually using the Microsoft clipboard which is rather memory intensive process, and while this is the go to default option you could just as easily just assign value to value which doesn't use the clip board.</p>\n\n<p>No frills option:</p>\n\n<pre><code>Sub Copy_and_Paste()\nSheets(\"Your Sheet Name\").Range(\"Your Range\").Copy\nSheets(\"Your Destination Sheet Name\").Range(\"Your Destination Range\").Paste\nEnd sub\n</code></pre>\n\n<p>Example No frills</p>\n\n<pre><code>Sub Copy_and_Paste()\nSheets(\"Sheet 1\").Range(\"A1:A10\").Copy\nSheets(\"Sheet 2\").Range(\"B1:B10\").Paste\n' You don't have to paste them in the exact same range.\n' Just make sure they are the same size.\nEnd sub\n</code></pre>\n\n<p>Values option</p>\n\n<pre><code>Sub Value_to_Value()\nSheets(\"Your Destination Sheet Name\").Range(\"Your Destination Range\").value = Sheets(\"Your Sheet Name\").Range(\"Your Range\").value\nEnd sub\n</code></pre>\n\n<p>Example Values</p>\n\n<pre><code>Sub Value_to_Value\nSheets(\"Sheet 2\").Range(\"B1:B10\").value = Sheets(\"Sheet 1\").Range(\"A1:A10\").value\nEnd sub\n</code></pre>\n\n<p>Experiment with both to come up with the version you prefer.</p>\n"}], "owner": {"reputation": 1, "user_id": 7044585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bd1f897cfdf44be1f3977aa1b98727?s=128&d=identicon&r=PG&f=1", "display_name": "mike4766", "link": "https://stackoverflow.com/users/7044585/mike4766"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1476923775, "creation_date": 1476910860, "last_edit_date": 1531161705, "question_id": 40141462, "link": "https://stackoverflow.com/questions/40141462/copy-and-paste-vba", "title": "Copy and paste VBA", "body": "<p>I am working on a project which needs a lot of copy and paste cells between work sheets in excel which are not in order .I could barely program VBA . I am thinking that if i can write a program (click or right click to copy to clip board  and double click to paste in different work sheet) that could make my work faster .Please suggest me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476911226, "post_id": 40141275, "comment_id": 67553010, "body": "Providing some screenshots of the input data and desired output might be helpful here..."}, {"owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476911869, "post_id": 40141275, "comment_id": 67553322, "body": "@DavidZemens I have updated to add sample input data with the desired output."}], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1476912592, "creation_date": 1476912592, "answer_id": 40141821, "question_id": 40141275, "link": "https://stackoverflow.com/questions/40141275/excel-vba-loop-to-next-available-blank-cell/40141821#40141821", "title": "Excel VBA - Loop to next available blank cell", "body": "<p>Try this...you actually need two Row values, one for data, one for output:</p>\n\n<pre><code>Sub SAX()\nDim wsSource As Worksheet, wsData As Worksheet\nDim lDataRow As Long, lCol As Long, lOut as Long\n\nSet wsData = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\nwsData.Name = \"Data\"\nSet wsSource = ThisWorkbook.Worksheets(\"Header\")\n\nApplication.DisplayAlerts = False\nlDataRow = 2\nlOut = 1\nDo \n  For lCol = 1 To 4\n    wsData.Cells(lOut, 1) = wsSource.Cells(lDataRow, lCol)\n  Next lCol\n  lDataRow = lDataRow + 1\n  lOut = lOut + 1\nLoop Until Len(Trim(wsSource.Cells(lDataRow, 1))) = 0\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "edited": false, "score": 0, "creation_date": 1476914306, "post_id": 40141823, "comment_id": 67554341, "body": "Works great and explained perfectly. Thanks!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1476913267, "last_edit_date": 1476913267, "creation_date": 1476912606, "answer_id": 40141823, "question_id": 40141275, "link": "https://stackoverflow.com/questions/40141275/excel-vba-loop-to-next-available-blank-cell/40141823#40141823", "title": "Excel VBA - Loop to next available blank cell", "body": "<p>What you want is this, assuming (from screenshot) that you're working with a structured <code>ListObject</code> table:</p>\n\n<pre><code>Sub SAX()\n\nDim wsSource As Excel.Worksheet, wsData As Excel.Worksheet\nDim i as Long\nDim tbl As ListObject\nDim vals As Variant\n\nWith ThisWorkbook\n    Set wsData = Sheets.Add(After:=.Sheets(.Sheets.Count))\n    Set wsSource = .Worksheets(\"Header\")\nEnd With\nwsData.Name = \"Data\"\n\n'## Get a handle on the Table object\nSet tbl = wsSource.ListObjects(1) 'Modify if needed\n\nApplication.DisplayAlerts = False\n\ni = 1  'which row we start putting data on wsData\n'## Iterate each row of data in the Table\nFor Each rng In tbl.DataBodyRange.Rows\n    '## Dump this row's values in to an array, and transpose it\n    vals = Application.Transpose(rng.Value)\n    '## Put the array's values in an appropriately sized range on the wsData sheet:\n    wsData.Cells(i, 1).Resize(UBound(vals)).Value = vals\n    '## Increment the destination row number:\n    i = i + UBound(vals)\nNext\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Here we transpose the <code>rng.Value</code> so that we can drop it in a column. We store this in the <code>vals</code> array.  We then use the <code>vals</code> array to determine the size of the range where the values will be placed on \"Data\" sheet, and also use the size of the <code>vals</code> array to increment our <code>i</code> variable, which tells us where to put the <em>next</em> row's data.</p>\n\n<p>Or, maybe even more simply:</p>\n\n<pre><code>For i = 1 to tbl.DataBodyRange.Cells.Count\n    wsData.Cells(i, 1).Value = tbl.DataBodyRange.Cells(i).Value\nNext\n</code></pre>\n\n<p>This works because a range is indexed by row/column, so we begin counting cell #1 at the top/left, and then wrap to the second row and resume counting, for example, the \"cell index\" is in this example table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/70Ds7.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/70Ds7.png\" alt=\"enter image description here\"></a></p>\n\n<p>This can easily be put into a single row or column, just by iterating over the <code>Cells.Count</code>!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1476913875, "creation_date": 1476913875, "answer_id": 40142102, "question_id": 40141275, "link": "https://stackoverflow.com/questions/40141275/excel-vba-loop-to-next-available-blank-cell/40142102#40142102", "title": "Excel VBA - Loop to next available blank cell", "body": "<p>It would be more efficient to create an array and write all the data at one time.</p>\n\n<pre><code>Sub SAX()\n    Dim Data, v\n    Dim x As Long, y As Long\n\n    With ThisWorkbook.Worksheets(\"Header\")\n        With .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            x = WorksheetFunction.RoundUp(.Cells.Count / 4, 0)\n            ReDim Data(1 To x, 1 To 4)\n            x = 1\n            For Each v In .Cells\n\n                If y = 4 Then\n                    x = x + 1\n                    y = 1\n                Else\n                    y = y + 1\n                End If\n                Data(x, y) = v\n            Next\n        End With\n    End With\n\n    With ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n        .Name = \"Data\"\n        .Range(\"A1:D1\") = Array(1, 2, 3, 4)\n        .Range(\"A2:D2\").Resize(UBound(Data, 1)).Value = Data\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 40141823, "answer_count": 3, "score": 1, "last_activity_date": 1476913875, "creation_date": 1476910147, "last_edit_date": 1531164843, "question_id": 40141275, "link": "https://stackoverflow.com/questions/40141275/excel-vba-loop-to-next-available-blank-cell", "title": "Excel VBA - Loop to next available blank cell", "body": "<p>I am attempting to write a small section of code to create a new worksheet and insert values from a table in a source worksheet starting at row 2, column 1 thru column 4. Once it reaches the end, I need it to loop to the next row and start over.</p>\n\n<p>The issue I have is that the below code loops back to row 1 of the new worksheet and data is overridden. Is there a simple way to have my loop start on the first blank row down?</p>\n\n<p><a href=\"https://i.stack.imgur.com/6w1PD.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/6w1PD.jpg\" alt=\"Input Data\"></a></p>\n\n<p>[<img src=\"https://i.stack.imgur.com/8okXS.jpg\" alt=\"Desired Output\"><a href=\"https://i.stack.imgur.com/8okXS.jpg\" rel=\"nofollow\">2</a></p>\n\n<pre><code>Sub SAX()\n\nDim wsSource As Excel.Worksheet, wsData As Excel.Worksheet\nDim r As Long, c As Long\n\nSet wsData = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\nwsData.Name = \"Data\"\nSet wsSource = ThisWorkbook.Worksheets(\"Header\")\n\nApplication.DisplayAlerts = False\n\nr = 2\nDo Until Len(Trim(wsSource.Cells(r, 1).Value)) = 0\n    For c = 1 To 4\n        wsData.Cells(c * 1, 1).Value = wsSource.Cells(r, c).Value\n    Next c\n\n    ThisWorkbook.Activate\n    r = r + 1\nLoop\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "image", "center", "visible"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1476910359, "post_id": 40141088, "comment_id": 67552569, "body": "well you didn&#39;t really say how off it was but my Guess is that you are not accounting for the scrollbar&#39;s width.  See: <a href=\"http://stackoverflow.com/questions/37491755/find-width-of-excel-scroll-bar\" title=\"find width of excel scroll bar\">stackoverflow.com/questions/37491755/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 3423636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938eaa1c484b2c3ff925d77df5c535d2?s=128&d=identicon&r=PG&f=1", "display_name": "Gnerffed", "link": "https://stackoverflow.com/users/3423636/gnerffed"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1476911239, "post_id": 40141088, "comment_id": 67553018, "body": "It seems positioned inline with the cell cursor."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1476917907, "post_id": 40141088, "comment_id": 67555598, "body": "From the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197987.aspx\" rel=\"nofollow noreferrer\">Shape.Left documentation</a> (my emphasis): &quot;Returns or sets a Single value that represents the distance, in points, from the left edge of the object <b><i>to the left edge of column A</i></b>&quot; From the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198311.aspx\" rel=\"nofollow noreferrer\">Window.VisibleRange documentation</a> (my emphasis): &quot;Returns a Range object that represents <b><i>the range of cells that are visible in the window or pane.</i></b>&quot;.  You need to calculate and add the distance from column A to the left-most column of the <code>VisibleRange</code>."}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "edited": false, "score": 0, "creation_date": 1476928202, "post_id": 40141088, "comment_id": 67558151, "body": "So in light of Comintern&#39;s comment, your second line should look something like this: <code>ActiveSheet.Shapes(&quot;Picture 1&quot;).Left = ActiveWindow.VisibleRange(1, 1).Left + (ActiveWindow.VisibleRange.Width &#47; 2) - (ActiveSheet.Shapes(&quot;Picture 1&quot;).Width &#47; 2)</code>"}, {"owner": {"reputation": 13, "user_id": 3423636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938eaa1c484b2c3ff925d77df5c535d2?s=128&d=identicon&r=PG&f=1", "display_name": "Gnerffed", "link": "https://stackoverflow.com/users/3423636/gnerffed"}, "edited": false, "score": 0, "creation_date": 1476971092, "post_id": 40141088, "comment_id": 67580975, "body": "Thanks Comintrn &amp; DaveU, but it&#39;s still not working (updated to Dave&#39;s code).  Some more details about the sheet:  We have a five column freeze pane at the left and the sheet is actually 300-ish columns wide.  We commonly re-center about 20 columns on the right of that pane (visible area).  Once we do, we click a button on the freeze pain that performs a few operations, and then trys to re-center this image.  It seems to position the image, somehow, relative to which ever cell has focus.  I don&#39;t get this, any other thoughts, guys?"}], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493299554, "creation_date": 1493299554, "answer_id": 43659226, "question_id": 40141088, "link": "https://stackoverflow.com/questions/40141088/center-an-image-on-the-visible-screen/43659226#43659226", "title": "Center an Image on the Visible Screen", "body": "<p>old post but here is something that wrks exceptionally well for me...\nI have columns A1:T1 that I need my picture to be centered across.\nI am dynamically hiding some of those cells depending upon user selections.\nThis code is placed after the code to hide those columns</p>\n\n<pre><code>ActiveSheet.Shapes(\"Image1\").Left = ActiveSheet.Range(\"A1:T1\").Left\nActiveSheet.Shapes(\"Image1\").Width = ActiveSheet.Range(\"A1:T1\").Width\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3423636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938eaa1c484b2c3ff925d77df5c535d2?s=128&d=identicon&r=PG&f=1", "display_name": "Gnerffed", "link": "https://stackoverflow.com/users/3423636/gnerffed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544589079, "creation_date": 1476909460, "last_edit_date": 1544589079, "question_id": 40141088, "link": "https://stackoverflow.com/questions/40141088/center-an-image-on-the-visible-screen", "title": "Center an Image on the Visible Screen", "body": "<p>In Excel 2013, I want to center an image, horizontally, on the visible area of the screen regardless of where the mouse or cell cursors are also irrespective of what range of cells are visible.</p>\n\n<p>I've got this, so far:</p>\n\n<pre><code>ActiveSheet.Shapes(\"Picture 1\").Top = 13 'Fixed position vertically\nActiveSheet.Shapes(\"Picture 1\").Left = (ActiveWindow.VisibleRange.Width / 2) -_\n    (ActiveSheet.Shapes(\"Picture 1\").Width / 2) 'Centered horizontally\nActiveSheet.Shapes(\"Picture 1\").Visible = True\n</code></pre>\n\n<p>The first and last lines work. The middle bit doesn't.</p>\n\n<p>Vertically it's where I want it, horizontally it positions the image, seemingly, at random; perhaps based on cell cursor?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1476909546, "post_id": 40141054, "comment_id": 67552178, "body": "I forgot to add that the data range varies by each month so I need the codes to loop through the data set in order to add the border and delete the values accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1476928897, "creation_date": 1476928897, "answer_id": 40144263, "question_id": 40141054, "link": "https://stackoverflow.com/questions/40141054/add-border-and-delete-values-after-the-total-row-vba-codes/40144263#40144263", "title": "add border and delete values after the total row vba codes", "body": "<p><strong>You had a few mistakes in your code (syntax errors, logic errors). I have corrected them for you.</strong></p>\n\n<pre><code>Sub Test()\n    Dim dat As Range: Set dat = Sheets(\"Table F Agencies Combined\").Range(\"M:N\")\n    Dim LastRow As Long, x As Long\n    Dim myCell As Variant\n\n    LastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n    x = 2\n    Rows(LastRow - x + 1 &amp; \":\" &amp; LastRow).Delete\n\n    For Each myCell In dat\n        myCell.Value = Replace(UCase(myCell.Value), \"TRUE\", \"\")\n    Next myCell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1476973163, "post_id": 40144471, "comment_id": 67582735, "body": "thank you, it takes out the 4 values beautifully, is there a way you can incorporate the border around second data set column R? somehow it&#39;s not showing. Thank you again,"}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1476993421, "post_id": 40144471, "comment_id": 67595736, "body": "Ok, I&#39;ve modified my answer to include adding the border.  Quick and dirty, but works with your existing data layout."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1476995246, "post_id": 40144471, "comment_id": 67596669, "body": "Hi Dave, I think the revised worked partially since I want to have the border up to LR cell if you see the second picture, it only has border around the numbers. I can fix the xlThick to xlMedium so its no biggie there"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1476995631, "post_id": 40144471, "comment_id": 67596870, "body": "I included in the third picture how I want to present it and hopefully this is a quick fix"}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1477003753, "post_id": 40144471, "comment_id": 67600266, "body": "Oh, I see the merged cell in column B was throwing things off.  Try the modification."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1477053249, "post_id": 40144471, "comment_id": 67620679, "body": "sweet, it works like a charm!! thank you again Dave! You save the day"}], "tags": [], "owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "is_accepted": true, "score": 1, "last_activity_date": 1477003693, "last_edit_date": 1477003693, "creation_date": 1476930748, "answer_id": 40144471, "question_id": 40141054, "link": "https://stackoverflow.com/questions/40141054/add-border-and-delete-values-after-the-total-row-vba-codes/40144471#40144471", "title": "add border and delete values after the total row vba codes", "body": "<p>I think you're better off to treat each block of data separately.  You can run this code repeatedly without losing data.</p>\n\n<pre><code>Sub Test2()\n\n  Dim c As Range, r As Range\n' 1st block\n  Set c = Range(\"B:B\").Find(\"total\", Range(\"B1\"), xlValues, xlWhole, , , False)\n'c.Select\n  c.Offset(1).Resize(2).EntireRow.ClearContents\n\n' 2nd block\n  Set c = Range(\"B:B\").Find(\"total\", c, xlValues, xlWhole, , , False)\n'c.Select\n  c.Offset(1).Resize(2).EntireRow.ClearContents\n\n  Set r = Intersect(c.EntireRow, Columns(\"R\"))\n  Set r = Range(r, r.End(xlUp))\n  r.BorderAround xlContinuous, xlThick\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 40144471, "answer_count": 2, "score": -1, "last_activity_date": 1477003693, "creation_date": 1476909315, "last_edit_date": 1531161705, "question_id": 40141054, "link": "https://stackoverflow.com/questions/40141054/add-border-and-delete-values-after-the-total-row-vba-codes", "title": "add border and delete values after the total row vba codes", "body": "<p>Need help with vba codes. I want to have vba codes to add border to the second data sets (in column R) and delete the 2 values after the total row (4 total)\nHere is what I got so far,</p>\n\n<pre><code>Sub Test()\nDim LastRow As Long, x As Long\nLastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\nx = 2\nRows(LastRow - x + 1 &amp; \":\" &amp; LastRow).Delete\nSet dat = Sheets(\"Table F Agencies Combined\").Range(\"M:N\")\ndat.Replace What:=\"TRUE\", Replacement:=\"\"\nEnd Sub\n</code></pre>\n\n<p>Now I can delete the last 2 rows and replace TRUE with nothing but I dont know how to delete the 2 values after the first set and add the border to the column R for the second data set.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ode9p.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Ode9p.png\" alt=\"Data sets\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/47pug.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/47pug.png\" alt=\"revised data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Rby4Z.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Rby4Z.png\" alt=\"final data\"></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7044435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1827e2fc249fa22382b230bbf3df9393?s=128&d=identicon&r=PG&f=1", "display_name": "John Adams", "link": "https://stackoverflow.com/users/7044435/john-adams"}, "edited": false, "score": 0, "creation_date": 1476912390, "post_id": 40141216, "comment_id": 67553554, "body": "So I tried this and I am getting an error saying that the property is not found."}, {"owner": {"reputation": 3, "user_id": 7044435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1827e2fc249fa22382b230bbf3df9393?s=128&d=identicon&r=PG&f=1", "display_name": "John Adams", "link": "https://stackoverflow.com/users/7044435/john-adams"}, "edited": false, "score": 0, "creation_date": 1476912496, "post_id": 40141216, "comment_id": 67553593, "body": "I did &#39;propName = <a href=\"http://schemas.microsoft.com/mapi/proptag/0x3A44001F\" rel=\"nofollow noreferrer\">schemas.microsoft.com/mapi/proptag/0x3A44001F</a>&#39; and &#39;middleName = exchangeUser.GetExchangeUser.PropertyyAccessor.GetProperty(p&zwnj;&#8203;ropName)&#39; and the property was not found"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 3, "user_id": 7044435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1827e2fc249fa22382b230bbf3df9393?s=128&d=identicon&r=PG&f=1", "display_name": "John Adams", "link": "https://stackoverflow.com/users/7044435/john-adams"}, "edited": false, "score": 0, "creation_date": 1476913479, "post_id": 40141216, "comment_id": 67554026, "body": "That means it does not exist for that particular GAL entry. Take a look at GAL in OutlookSpy - click IAddrBook | Open Root Container | GetHierarchyTable | GetContentsTable, etc. Or if oy uhave the GAL entry as a recipient in a message, select the message, click IMessage, go to the GetRecipeintTable, double click on the recipient."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1476909926, "creation_date": 1476909926, "answer_id": 40141216, "question_id": 40140870, "link": "https://stackoverflow.com/questions/40140870/how-do-i-get-the-initials-of-a-contacts-middle-name/40141216#40141216", "title": "How do I get the &#39;initials&#39; of a contact&#39;s middle name?", "body": "<p>Retrieve the <code>PR_MIDDLE_NAME</code> MAPI property using AddressEntry.PropertyAccessor.GetProperty. The DALS property name is <code>http://schemas.microsoft.com/mapi/proptag/0x3A44001F</code> </p>\n"}], "owner": {"reputation": 3, "user_id": 7044435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1827e2fc249fa22382b230bbf3df9393?s=128&d=identicon&r=PG&f=1", "display_name": "John Adams", "link": "https://stackoverflow.com/users/7044435/john-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 40141216, "answer_count": 1, "score": 0, "last_activity_date": 1604562327, "creation_date": 1476908631, "last_edit_date": 1604562327, "question_id": 40140870, "link": "https://stackoverflow.com/questions/40140870/how-do-i-get-the-initials-of-a-contacts-middle-name", "title": "How do I get the &#39;initials&#39; of a contact&#39;s middle name?", "body": "<p>I want to get the exchange user's middle name initials.</p>\n<p><a href=\"https://i.stack.imgur.com/rErXE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rErXE.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>Function getFullName(exchangeUser As ExchangeUser) As String\n    Dim firstName, middleName, lastName, As String\n    firstName = exchangeUser.GetExchangeUser.firstName\n    middleName = exchangeUser.GetExchangeUser.{somehow retrieve middle name}\n    lastName = exchangeUser.GetExchangeUser.lastName\n    getFullName = firstName &amp; &quot; &quot; &amp; middleName &amp; &quot; &quot; &amp; lastName\nEnd Function\n</code></pre>\n<p>I tried <code>GetExchangeUser.fullName</code> but that does not return the middle initials.</p>\n<p>I tried:</p>\n<pre><code>Function getFullName(exchangeUser As ExchangeUser) As String\n    Dim firstName, middleName, lastName, As String\n    Dim propName As String\n    propName = &quot;http://schemas.microsoft.com/mapi/proptag/0x3A44001F&quot;\n    firstName = exchangeUser.GetExchangeUser.firstName\n    middleName = exchangeUser.GetExchangeUser.PropertyAccessor.GetProperty(propName)\n    lastName = exchangeUser.GetExchangeUser.lastName\n    getFullName = firstName &amp; &quot; &quot; &amp; middleName &amp; &quot; &quot; &amp; lastName\nEnd Function\n</code></pre>\n<p>I get an error that the property is not found.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476909736, "post_id": 40140779, "comment_id": 67552276, "body": "You don&#39;t have that macro saved in the workbook/module most likely. What kind of error is thrown? Do you have that sub?"}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1476909762, "post_id": 40140779, "comment_id": 67552289, "body": "try to find ConnectChartEvents macro in your colleague&#39;s PC. if it is not there copy to PC."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476911492, "post_id": 40140779, "comment_id": 67553127, "body": "If the macro to be run is in the file which was just opened then try <code>Application.Run &quot;&#39;INTL_SWAPMTM_UBS.xlsm&#39;!ConnectChartEvents&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8358089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gJna0lL0cBw/AAAAAAAAAAI/AAAAAAAAALA/J3bsuhSQuK0/photo.jpg?sz=128", "display_name": "Fryin&#39; Ryan", "link": "https://stackoverflow.com/users/8358089/fryin-ryan"}, "is_accepted": false, "score": 2, "last_activity_date": 1500903288, "creation_date": 1500903288, "answer_id": 45282088, "question_id": 40140779, "link": "https://stackoverflow.com/questions/40140779/macro-opening-other-worksheets-not-working-for-other-user/45282088#45282088", "title": "macro opening other worksheets not working for other User", "body": "<p>This is the error message you would get if the Bloomberg add-in was disabled or if you recorded the macro on a machine with the add-in and tried to run it on a machine without the add-in.</p>\n"}], "owner": {"reputation": 1, "user_id": 7044441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05a0a1257333a703be5dd250e7e1b29?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/7044441/gaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500903288, "creation_date": 1476908329, "last_edit_date": 1476924918, "question_id": 40140779, "link": "https://stackoverflow.com/questions/40140779/macro-opening-other-worksheets-not-working-for-other-user", "title": "macro opening other worksheets not working for other User", "body": "<p>I have recorded a macro that basically opens up other worksheets and copy and pastes data into them before saving and closing them. It works perfectly for me but when a colleague tries to run the same macro with the same files it fails. </p>\n\n<p>It opens up the first worksheet but then stops at the first command of - Application.Run \"ConnectChartEvents. Any ideas why? </p>\n\n<pre><code>ChDir \"\\\\dstm8307vpfs\\EQData\\EQUITYSWAPS\\Client Folders\\Proshares\"\n    Workbooks.Open Filename:= _\n        \"\\\\dstm8307vpfs\\EQData\\EQUITYSWAPS\\Client Folders\\Proshares\\INTL_SWAPMTM_UBS.xlsm\" _\n        , UpdateLinks:=0\n    Application.Run \"ConnectChartEvents\"\n    ActiveWindow.ScrollWorkbookTabs Position:=xlLast\n    Sheets(\"Allocations\").Select\n    Range(\"D3:D38\").Select\n    Selection.ClearContents\n    ActiveWindow.ScrollWorkbookTabs Position:=xlFirst\n    Sheets(\"UltraShort FTSE Xinhua China 50\").Select\n    Range(\"G1048576\").Select\n    Selection.End(xlUp).Select\n    ActiveCell.Offset(1, 0).Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"='[DIVS - test.xlsm]Sheet1'!R13C2\"\n    ActiveCell.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Sheets(\"Execution Commissions\").Select\n    ActiveWorkbook.Save\n    ActiveWindow.Closesheet\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1476908828, "post_id": 40140777, "comment_id": 67551833, "body": "What is the purpose of this? Wouldn&#39;t you just reference the worksheet table where the data is stored?  Why not store the lookup and value in an array instead of using strings?  There&#39;s so much here that doesn&#39;t make sense."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1476909380, "post_id": 40140777, "comment_id": 67552099, "body": "<code>VLOOKUP</code> (which can be used from VBA) is the natural way to retrieve values in a spreadsheet which correspond to keys in an adjacent column. Alternatively, if the data is large enough, it would pay to load it into a dictionary. It really isn&#39;t clear what you are trying to do. Column A contains two types of strings, some with 4 characters and some with 9, and you are using strings extracted from the 9 character strings to serve as keys (which are the 4-character strings)? Seems odd, but if so -- what are you planning to do with the retrieved values? Please clarify."}, {"owner": {"reputation": 1, "user_id": 7044394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4b37df6692ce57b20af3d52c4883e1?s=128&d=identicon&r=PG&f=1", "display_name": "mach08ag", "link": "https://stackoverflow.com/users/7044394/mach08ag"}, "edited": false, "score": 0, "creation_date": 1476953106, "post_id": 40140777, "comment_id": 67568219, "body": "Hi, What i am trying to do, is to make a function that will add all values to based on the string with 9 characters. So that it would be DK12_DK13 + DK12 + DK13, and then have the 4 character strings deleted.  But out of pure curiosity, is it posible to have to extend my funtion with an extra loop?"}], "owner": {"reputation": 1, "user_id": 7044394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4b37df6692ce57b20af3d52c4883e1?s=128&d=identicon&r=PG&f=1", "display_name": "mach08ag", "link": "https://stackoverflow.com/users/7044394/mach08ag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476908327, "creation_date": 1476908327, "question_id": 40140777, "link": "https://stackoverflow.com/questions/40140777/loop-within-loop-vba", "title": "loop within loop vba", "body": "<p>I have the following issue i can't get my head around.</p>\n\n<p>I have the following list of data:</p>\n\n<pre><code>Row           Value \n\nDK12_DK13       2   \nDK12            4\nDK15            3\nDK11            3\nDK13            5\n</code></pre>\n\n<p>What i want my function to do, is to loop through the rows column, to select the first 4 (and last 4) characters and save them in a string. Next i then want to store the value of column b (values) that correponds to to the 4 first characters in a new string. </p>\n\n<p>To Clarify, the first string would be DK12 i would then use this string to look for the 4 character DK12 in column A which has the value 4, and then have the value 4 stored in another string. I quess this wuld require me to have a loop within a loop. Right now i have the following code, but i am kinda stuck here, when i want to loop over the data i have stored in the strings from the first loop. Hope my explanation makes sense:</p>\n\n<pre><code>Sub Test()\nDim I As Integer\nDim L_text As String\nDim R_text As String\nDim Full_text As String\nDim L_Value As String\n\nFor I = 5 To 9\n\nL_text = Left(Range(\"A\" &amp; I), 4)\nR_text = Right(Range(\"A\" &amp; I), 4)\n\n If Len(Range(\"A\" &amp; I)) = 9 Then\n\n L_text = Left(Range(\"A\" &amp; I), 4)\n R_text = Right(Range(\"A\" &amp; I), 4)\n Full_text = Left(Range(\"A\" &amp; I), 9)\n\n     End If\n   Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1476915117, "post_id": 40140755, "comment_id": 67554645, "body": "Please read about <b>bound</b> vs. <b>unbound</b> forms."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1476969993, "post_id": 40140755, "comment_id": 67580064, "body": "Okay awesome. So what I got from that is this --- make the fields unbound, because they&#39;re currently bound, then write a macro on the button to append the data to its appropriate field in the table? Is that the most efficient way of doing that?"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476908209, "creation_date": 1476908209, "question_id": 40140755, "link": "https://stackoverflow.com/questions/40140755/i-need-to-prevent-the-fields-in-my-form-from-automatically-appending-data-to-the", "title": "I need to prevent the fields in my form from automatically appending data to the record", "body": "<p>So I have a data entry platform that I've basically created in Access. Upon entry, each field will append to the backend table. So if someone types Sally in the First Name field, it'll append each keystroke. I can't have that.</p>\n\n<p>I want to prevent that from happening and instead add a \"Save Record\" button which appends all of the data in one fell swoop. I'm using a tab control which has two subforms, one for address data and another for misc. data. The main form and these two subforms are all related to the same record.</p>\n\n<p>So having a save record button alongside a refresh fields and next record button are critical.</p>\n"}, {"tags": ["vba", "selenium-webdriver", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 25741, "user_id": 374693, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/03c70489237ec9fc2e571af68b2dcaae?s=128&d=identicon&r=PG", "display_name": "JimEvans", "link": "https://stackoverflow.com/users/374693/jimevans"}, "edited": false, "score": 0, "creation_date": 1476918498, "post_id": 40140683, "comment_id": 67555788, "body": "Chrome was updated to version 54. Have you updated your chromedriver executable to <a href=\"http://chromedriver.storage.googleapis.com/index.html?path=2.24/\" rel=\"nofollow noreferrer\">2.24</a>?"}, {"owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "reply_to_user": {"reputation": 25741, "user_id": 374693, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/03c70489237ec9fc2e571af68b2dcaae?s=128&d=identicon&r=PG", "display_name": "JimEvans", "link": "https://stackoverflow.com/users/374693/jimevans"}, "edited": false, "score": 0, "creation_date": 1476921508, "post_id": 40140683, "comment_id": 67556651, "body": "Ah, I have not. I&#39;ll give that a go :)"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "is_accepted": true, "score": 1, "last_activity_date": 1477077954, "creation_date": 1477077954, "answer_id": 40184146, "question_id": 40140683, "link": "https://stackoverflow.com/questions/40140683/selenium-chrome-driver-sessionnotcreatederror/40184146#40184146", "title": "Selenium Chrome Driver &quot;SessionNotCreatedError&quot;", "body": "<p>When I downloaded the 2.24 version from:</p>\n\n<p><a href=\"http://chromedriver.storage.googleapis.com/index.html?path=2.24/\" rel=\"nofollow\">http://chromedriver.storage.googleapis.com/index.html?path=2.24/</a></p>\n\n<p>Once unzipped and ran, it opened the command prompt and displayed \"Only local connections are allowed.\"  However, my code was still throwing an error.  Turns out that it is functioning as intended.</p>\n\n<p>What I ended up doing that solved the problem is going to \"C:\\Program Files\\SeleniumBasic\" and renaming the current \"chromedriver.exe\" to \"chromedriver21.exe\" and then copying and pasting the \"chromedriver.exe\" that I downloaded from the above link into that folder.</p>\n\n<p>Now when my code execute, it is using the 2.24 executable and works absolutely fine.</p>\n\n<p>I'm sure this is a no-brainer easy solution for most, if not everyone else.  But it seems that updating this driver should be a bit more straight forward, and maybe it is and I just missed it.</p>\n\n<p>I didn't read through this before I figured out a solution, but this may be a better resource for people like me:</p>\n\n<p><a href=\"https://sites.google.com/a/chromium.org/chromedriver/getting-started\" rel=\"nofollow\">https://sites.google.com/a/chromium.org/chromedriver/getting-started</a></p>\n\n<p>Also, this is where I started that didn't point me in the right direction very well, and I'm adding it to summarize my journey:</p>\n\n<p><a href=\"http://www.seleniumhq.org/download/\" rel=\"nofollow\">http://www.seleniumhq.org/download/</a></p>\n"}], "owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2212, "favorite_count": 0, "accepted_answer_id": 40184146, "answer_count": 1, "score": 0, "last_activity_date": 1477077954, "creation_date": 1476907970, "question_id": 40140683, "link": "https://stackoverflow.com/questions/40140683/selenium-chrome-driver-sessionnotcreatederror", "title": "Selenium Chrome Driver &quot;SessionNotCreatedError&quot;", "body": "<p>I've ran this script daily for the last few months, and for some reason, today when it tries to to start, it throws this error:</p>\n\n<pre><code>There was an error while the code was executing.\nSessionNotCreatedError session not created exception from unknown error:\nRuntime.executioncontextCreated has invalid 'context':{\"auxData\":{frameId\":\"4120.1\",\"isDefault\":true, \"id\":1,\"name\":\"\",\"origin\":\"://\"}\n(Session info: chrome=54.0.2840.59)\n(Driver info: chromedriver=2.21371459\n(36d3d07f660ff2bc1bf28a75d1cdabed0983e7c4, platform=Windows NT 6.1 SP1 x86_64)\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>Dim drvSelenium As New Selenium.ChromeDriver\n\ndrvSelenium.SetPreference \"download.default_directory\", MyFilePathHere\ndrvSelenium.SetPreference \"download.directory_upgrade\", True\ndrvSelenium.SetPreference \"download.extensions_to_open\", \"\"\ndrvSelenium.SetPreference \"download.prompt_for_download\", False\n\ndrvSelenium.Start \"chrome\", \"http://www.google.com\"\n</code></pre>\n\n<p>And it throws that error when it gets to the last line, and I'm not sure what changed.  I may have had some windows updates run over night, but I can't put my finger on what would cause this to not work all of a sudden :(</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1476905981, "post_id": 40140120, "comment_id": 67550180, "body": "Instead of <code>sht.Cells.Replace</code> use <code>sht.Rows(30).Replace</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 1, "last_activity_date": 1476906136, "creation_date": 1476906136, "answer_id": 40140206, "question_id": 40140120, "link": "https://stackoverflow.com/questions/40140120/find-replace-across-entire-workbook-in-specific-row/40140206#40140206", "title": "Find &amp; Replace across entire workbook in specific row", "body": "<p>Two things.</p>\n\n<p>First, don't use variants for fnd and rplc; use Strings.</p>\n\n<p>Second, specify the range you want to do the replace on, rather than just using \"Cells\".</p>\n\n<pre><code>Sub Replacer()\n    Const csFnd As String = \"April\"\n    Const csRpl As String = \"May\"\n    Const csRow As String = \"A30\"\n\n    Dim sht As Worksheet\n\n    For Each sht In ActiveWorkbook.Worksheets\n        sht.Range(csRow).EntireRow.Replace _\n            what:=csFnd, _\n            Replacement:=csRpl\n    Next sht\nEnd Sub\n</code></pre>\n\n<p>It's also good practice to use constants at the top of your code to hold unchanging text, rather than putting <code>variable = \"String\"</code> in the body of the code. It's easier to maintain with the constants at the top.</p>\n"}], "owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 40140206, "answer_count": 1, "score": 0, "last_activity_date": 1476906136, "creation_date": 1476905823, "question_id": 40140120, "link": "https://stackoverflow.com/questions/40140120/find-replace-across-entire-workbook-in-specific-row", "title": "Find &amp; Replace across entire workbook in specific row", "body": "<pre><code>    Dim sht As Worksheet\n    Dim fnd As Variant\n    Dim rplc As Variant\n\n    fnd = \"April\"\n    rplc = \"May\"\n\n    For Each sht In ActiveWorkbook.Worksheets\n    \u00a0\u00a0sht.Cells.Replace what:=fnd, Replacement:=rplc, _\n    \u00a0\u00a0\u00a0\u00a0LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n    \u00a0\u00a0\u00a0\u00a0SearchFormat:=False, ReplaceFormat:=False\n    Next sht\n\nEnd Sub\n</code></pre>\n\n<p>I have the follow code, I need it to find and replace across the entireworkbook but only in the row 30. How would I edit the code to do this?</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476905238, "post_id": 40139865, "comment_id": 67549721, "body": "What&#39;s in the first 15 rows? Are the headers in row 1, or row 15?"}, {"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476905743, "post_id": 40139865, "comment_id": 67550031, "body": "Headers on row 15 - First 14 have some KPIs regarding the data below (standard for every file)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476905986, "post_id": 40139865, "comment_id": 67550181, "body": "AFAIK to query Excel worksheets like this they need to be formatted as data tables, i.e. with column headings in row 1 and the data starting in row 2, and consistent data types throughout a column; these 14 rows of KPIs are possibly going to throw off column type inference. I don&#39;t think you can do this."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1476906133, "post_id": 40139865, "comment_id": 67550263, "body": "Depending on what comes in the intervening rows, you could set the HDR property in the connection string to <code>NO</code>, and add a WHERE clause that would catch the rows above the header. It would mainly depend on the structure of the header and the data though."}, {"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "edited": false, "score": 0, "creation_date": 1476907922, "post_id": 40139865, "comment_id": 67551291, "body": "Could you kindly help me out with the where clause?  I&#39;ve used it in the context of column...eg: Where [Customer Name] = &quot;Max&quot;  But to capture 14 rows using where is bit confusing! Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "edited": false, "score": 0, "creation_date": 1476909101, "post_id": 40140828, "comment_id": 67551980, "body": "Appreciate your help :)"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1476908484, "creation_date": 1476908484, "answer_id": 40140828, "question_id": 40139865, "link": "https://stackoverflow.com/questions/40139865/recordset-query-excel/40140828#40140828", "title": "Recordset Query - Excel", "body": "<p>With Excel workbook SQL queries via ADO or DAO, you can specify the regions of a worksheet by setting a range in the fashion: <code>[Sheet$A1:Z2]</code>. First find the last named column (recall for <code>UNION</code> they must be same lengths and types) and add rows sufficient for valid querying. Below uses <em>Z999</em>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strQuery = _\n    \"SELECT * FROM [Sheet1$A15:Z999] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source1.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n    \"UNION \" &amp; _\n    \"SELECT * FROM [Sheet1$A15:Z999] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source2.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n    \"UNION \" &amp; _\n    \"SELECT * FROM [Sheet1$A15:Z999] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source3.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n     \"ORDER BY A;\"\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2483822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pqo3T.jpg?s=128&g=1", "display_name": "Dingo", "link": "https://stackoverflow.com/users/2483822/dingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 40140828, "answer_count": 1, "score": 1, "last_activity_date": 1476908484, "creation_date": 1476904883, "last_edit_date": 1495535549, "question_id": 40139865, "link": "https://stackoverflow.com/questions/40139865/recordset-query-excel", "title": "Recordset Query - Excel", "body": "<pre><code>strQuery = _\n    \"SELECT * FROM [Sheet1$] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source1.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n    \"UNION \" &amp; _\n    \"SELECT * FROM [Sheet1$] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source2.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n    \"UNION \" &amp; _\n    \"SELECT * FROM [Sheet1$] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source3.xlsx' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n    \"ORDER BY A;\"\n</code></pre>\n\n<p>Hi,</p>\n\n<p>I have the above inside a Module in VBA (the code itself is <a href=\"https://stackoverflow.com/a/34376642/445425\">sourced from here</a> ). My question is, my columns in each file starts from row 15 and data goes down from row 16. How do I make it so that each file, it would look to UNION from row 15?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "powerquery", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13436, "user_id": 1787137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bdtdu.jpg?s=128&g=1", "display_name": "Mike Honey", "link": "https://stackoverflow.com/users/1787137/mike-honey"}, "is_accepted": true, "score": 0, "last_activity_date": 1477346180, "creation_date": 1477346180, "answer_id": 40228170, "question_id": 40139364, "link": "https://stackoverflow.com/questions/40139364/power-query-connection-refresh-excel-2010/40228170#40228170", "title": "Power Query connection refresh, Excel 2010", "body": "<p>I would just use the Refresh All button on the Data ribbon.  The Append steps in Query 4 will control the execution sequence, Queries 1-3 dont need to be refreshed.</p>\n"}], "owner": {"reputation": 28, "user_id": 6723376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b532a2612db3a5e93f2b2710125640?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wheeler", "link": "https://stackoverflow.com/users/6723376/andrew-wheeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 40228170, "answer_count": 1, "score": 0, "last_activity_date": 1477346180, "creation_date": 1476903103, "last_edit_date": 1531164843, "question_id": 40139364, "link": "https://stackoverflow.com/questions/40139364/power-query-connection-refresh-excel-2010", "title": "Power Query connection refresh, Excel 2010", "body": "<p>I've assigned a macro to the ribbon to update 4 PQs. This is done via VBA because I need the refresh to be ordered; Query 4 Appends the other three into a single query that is then used as the PowerPivot connection. This is Excel 2010 so the load options are set to \"connection only\" as there is no direct data model option. Background refresh is disabled and the macro executes with no errors however, I can't tell that anything is actually being done. The query panel still reflects that the PQs have not been refreshed recently and the query editor indicates the same. All PQs (except the 4th) are connected to external workbooks. I would really like to make this refresh macro work so I don't have to instruct users to go into the PQ editor and refresh, load each query each time; this will inevitably create an issue. Macro aside, simply clicking refresh connection for each query name doesn't seem to do anything either. I'm starting to suspect that this might be due to the fact that none of the queries are loaded to worksheets and connection only. Any work around for this? I've searched extensively and can't find anything related to this, I thought this would be a common issue for sure. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905174, "post_id": 40139103, "comment_id": 67549689, "body": "Use a <code>Dictionary</code> where the key is the employee name and the value is an array, collection or delimited string containing the &quot;Stmnt of no Export from Aug 16&quot;, &quot;Stmnt of no Export from Sep 16&quot;, etc., process the dictionary and use the values stored per employee in the email body."}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905296, "post_id": 40139103, "comment_id": 67549768, "body": "I think you overread the part where I said I am very new to VBA :D Maybe you know why I get an Type Mismatch error in my second Image? That seems to be much easier - exporting the sheet as an attachment."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905646, "post_id": 40139103, "comment_id": 67549979, "body": "It would be much better if you paste actual code instead of a screenshot of the code..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905782, "post_id": 40139103, "comment_id": 67550049, "body": "I&#39;m guessing there is some problem with your loop, the <code>DateValue</code> function will return that error if it receives an empty string. What value of <code>Employee.Row</code> and <code>DocsInMonth.Column</code> when the error raises?"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905955, "post_id": 40139103, "comment_id": 67550168, "body": "My apologies. I added it. The weird thing is that in the other code, which uses exactly the same line, no error occurs. And both cells are in the Date Format..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476905988, "post_id": 40139103, "comment_id": 67550187, "body": "What&#39;s the value of <code>Employee.Row</code> and <code>DocsInMonth.Column</code> when the error raises?"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906011, "post_id": 40139103, "comment_id": 67550203, "body": "<code>Employee.Row = 12</code> and <code>DocsInMonth.Column = 5</code> - <a href=\"http://imgur.com/a/F6yzZ\" rel=\"nofollow noreferrer\">imgur.com/a/F6yzZ</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906239, "post_id": 40139103, "comment_id": 67550315, "body": "OK, well that <code>If</code> statement is composed of three separate expressions. Can you debug each to identify which one is causing the error? I&#39;m guessing it&#39;s the DocsInMonth.Column but unsure why you wouldn&#39;t have same error in the other script..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906302, "post_id": 40139103, "comment_id": 67550361, "body": "When the error raises, type this in the Immediate pane in the VBE: <code>?DateValue(ws.Cells(10, DocsInMonth.Column))</code> and then press the Return key.  Repeate for the other <code>DateValue</code> expression.  See if either of those are giving an error."}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906526, "post_id": 40139103, "comment_id": 67550493, "body": "It is indeed the <code>DateValue(ws.Cells(10, DocsInMonth.Column))</code> that Returns a runtime error 13 &quot;Type mismatch&quot;. What can I do?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476906614, "post_id": 40139103, "comment_id": 67550549, "body": "Try <code>DateValue(ws.Cells(10, DocsInMonth.Column).MergeArea.Cells(1).Value)</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906680, "post_id": 40139103, "comment_id": 67550587, "body": "This happens because <code>ws.Cells(10,5)</code> is part of a merged range, and actually the value in that cell (&quot;E5&quot;) is empty, the value exists only in &quot;D5&quot;."}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476906777, "post_id": 40139103, "comment_id": 67550637, "body": "That did it, thank you very much for all your help. If you make an answer out of this, I will gladly give you the 10 Points. If you care."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1476907075, "creation_date": 1476907075, "answer_id": 40140440, "question_id": 40139103, "link": "https://stackoverflow.com/questions/40139103/vba-send-email-to-employee-based-on-worksheet-input/40140440#40140440", "title": "VBA Send Email to Employee based on Worksheet input", "body": "<p>In your second attempt, there is a potential problem with using merged cells, and this line will likely throw an error when <code>DocsInMonth.Column</code> is an odd number column (such as Column E, G, etc.). This part of your <code>If</code> statement will raise an error:</p>\n\n<pre><code>DateValue(ws.Cells(10, DocsInMonth.Column))\n</code></pre>\n\n<p>The reason being, when <code>DocsInMonth.Column</code> = 5, for example, then <code>ws.Cells(10,5)</code> is part of a merged range, and actually the value in that cell <strong>E5</strong> is empty, the value exists only in <strong>D5</strong>.</p>\n\n<p>This should resolve it, by forcing the code to look at the <em>first</em> cell in the <code>MergeArea</code>:</p>\n\n<pre><code>DateValue(ws.Cells(10, DocsInMonth.Column).MergeArea.Cells(1).Value)\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 40140440, "answer_count": 1, "score": 0, "last_activity_date": 1476907075, "creation_date": 1476902107, "last_edit_date": 1476905929, "question_id": 40139103, "link": "https://stackoverflow.com/questions/40139103/vba-send-email-to-employee-based-on-worksheet-input", "title": "VBA Send Email to Employee based on Worksheet input", "body": "<p>In my Worksheet, a Master-User is putting in Information for every Employee - more precisely whether the Employees handed in two forms in the end of the month.</p>\n\n<p>What I am trying to achieve is that a reminder-Email is send to everyone listed on Sheet1 who has the answer \"No\" in his row - so he/she did not hand in the form.</p>\n\n<p>However, I do not know how to <strong>store the Information for all missing documents</strong> for one Employee <strong>before sending an Email</strong> to this Person. So in my current Loop, if an Employee forgot to Hand in 2-3 documents over the course of a few months, he/she would get 2-3 different Emails.</p>\n\n<p>So looking at the picture below, Maxime Musterman would get an Email saying:</p>\n\n<hr>\n\n<p>\"Hey Maxime,</p>\n\n<p>I am still missing your: </p>\n\n<ul>\n<li><p>Stmnt of no Export from Aug 16 </p></li>\n<li><p>Stmnt of no Export from Sep 16</p></li>\n</ul>\n\n<p>Thanks\"</p>\n\n<hr>\n\n<p>Maybe one of you could help?</p>\n\n<p>I am new to VBA and got the Email-sending-Code from another Website.</p>\n\n<p>Thanks in advance!</p>\n\n<p><a href=\"https://i.stack.imgur.com/9vwMs.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/9vwMs.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>'----------------------------------------------------------------------------------------------------------------\n'#################Set Email Conditions#################\n'----------------------------------------------------------------------------------------------------------------\n\nDim CDO_Mail As Object\nDim CDO_Config As Object\nDim SMTP_Config As Variant\nDim strSubject As String\nDim strFrom As String\nDim strTo As String\nDim strCc As String\nDim strBcc As String\nDim strBody As String\n\nSet CDO_Mail = CreateObject(\"CDO.Message\")\n\nSet CDO_Config = CreateObject(\"CDO.Configuration\")\nCDO_Config.Load -1\n\nSet SMTP_Config = CDO_Config.Fields\n\nWith SMTP_Config\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.metrocast.net\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n    .Update\nEnd With\n\n'----------------------------------------------------------------------------------------------------------------\n'#################Find who needs a Reminder-Email#################\n'----------------------------------------------------------------------------------------------------------------\n\nDim ws As Worksheet, wsOutput As Worksheet\nSet ws = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet wsOutput = ActiveWorkbook.Worksheets(\"Sheet2\")\nDim MonthYearInput As String, recipientName As String, recipientEmail As String\nDim Employee As Range, DocsInMonth As Range\nDim lRow As Long, lcol As Long, NextRow As Long\n\nlRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlcol = ws.Cells(11, Columns.Count).End(xlToLeft).Column\n\n\nFor Each Employee In ws.Range(Cells(12, 1), Cells(lRow, 1))\n    For Each DocsInMonth In ws.Range(Cells(Employee.Row, 4), Cells(Employee.Row, lcol))\n\n        If ws.Cells(Employee.Row, DocsInMonth.Column) = \"No\" And _\n        DateValue(ws.Cells(10, DocsInMonth.Column)) &gt;= DateValue(ws.Cells(Employee.Row, 3)) Then\n\n            recipientName = ws.Cells(Employee.Row, 1)\n            recipientEmail = ws.Cells(Employee.Row, 2)\n\n            'How to store the information regarding all missing infos before sending it\n            'to avoid sending 2-3 Emails to the same person?\n\n            strSubject = \"Results from Excel Spreadsheet\"\n            strFrom = \"me@gmail.com\"\n            strTo = recipientEmail\n            strCc = \"\"\n            strBcc = \"\"\n            strBody = \"Hey \" &amp; recipientName &amp; vbNewLine &amp; vbNewLine &amp; vbNewLine &amp; _\n                      \"I am still missing INFO INFO INFO\"\n\n            With CDO_Mail\n                Set .Configuration = CDO_Config\n            End With\n\n            CDO_Mail.Subject = strSubject\n            CDO_Mail.From = strFrom\n            CDO_Mail.To = strTo\n            CDO_Mail.TextBody = strBody\n            CDO_Mail.CC = strCc\n            CDO_Mail.BCC = strBcc\n            CDO_Mail.Send\n\n        End If\n    Next DocsInMonth\nNext Employee\n</code></pre>\n\n<h2>--------------------------------------------------------------------------------------------------------</h2>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I tried another approach by copying all Entries with a \"No\" for an Employee onto the second Sheet and then attaching the Sheet2 to the Email. However, I am getting a Runtime Error 13 \"Type Mismatch\" at this statement:</p>\n\n<pre><code>If ws.Cells(Employee.Row, DocsInMonth.Column) = \"No\" And _\n        DateValue(ws.Cells(10, DocsInMonth.Column)) &gt;= DateValue(ws.Cells(Employee.Row, 3)) Then\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Dim ws As Worksheet, wsOutput As Worksheet\nSet ws = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet wsOutput = ActiveWorkbook.Worksheets(\"Sheet2\")\nDim recipientName As String, recipientEmail As String\nDim Employee As Range, DocsInMonth As Range\nDim lRow As Long, lcol As Long, NextRow As Long\n\nlRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlcol = ws.Cells(11, Columns.Count).End(xlToLeft).Column\n\n\nFor Each Employee In ws.Range(Cells(12, 1), Cells(lRow, 1))\n    For Each DocsInMonth In ws.Range(Cells(Employee.Row, 4), Cells(Employee.Row, lcol))\n        If ws.Cells(Employee.Row, DocsInMonth.Column) = \"No\" And _\n        DateValue(ws.Cells(10, DocsInMonth.Column)) &gt;= DateValue(ws.Cells(Employee.Row, 3)) Then\n\n            NextRow = wsOutput.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n            ws.Cells(Employee.Row, 1).Copy Destination:=wsOutput.Cells(NextRow, 1) 'Name\n            ws.Cells(10, DocsInMonth.Column).Copy Destination:=wsOutput.Cells(NextRow, 2) 'Month\n            ws.Cells(11, DocsInMonth.Column).Copy Destination:=wsOutput.Cells(NextRow, 3) 'What\n\n\n        End If\n    Next DocsInMonth\nNext Employee\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 10308566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61e3d133a7c7cb63d1167e4fae4024b3?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/10308566/sam"}, "is_accepted": false, "score": 2, "last_activity_date": 1535950240, "creation_date": 1535950240, "answer_id": 52143310, "question_id": 40138524, "link": "https://stackoverflow.com/questions/40138524/vba-to-add-measure-to-powerpivot-pivot-table/52143310#52143310", "title": "VBA to Add Measure to PowerPivot Pivot Table", "body": "<p>Hacked this together to load from an Excel worksheet (will need to change ranges etc)\nWill overwrite existing measure's formula so can iterate through and not have to deal with error messages (apart from last with the error handler).</p>\n\n<p>Best part is that can load measure out of sequence so that a measure that depends on another measure can be loaded.</p>\n\n<pre><code>Sub AddMeasures()\nDim Mdl As Model\nDim tbl As ModelTable\nSet Mdl = ActiveWorkbook.Model\nSet tbl = Mdl.ModelTables(1)\nDim rng As Range\nSet rng = Worksheets(\"Sheet2\").Range(\"A2:A75\")\n\nDim measure_name As String\nDim measure_formula As String\n\nDim cell As Range\nDim item As Integer\n\nFor Each cell In rng\n    measure_name = cell.Value\n    measure_formula = cell.Offset(0, 1).Value\n    item = GetItemNumber(measure_name)\n    If item &gt; 0 Then\n        Mdl.ModelMeasures.item(item).formula = measure_formula  'replace the existing formula\n    Else\n        On Error GoTo errhandler\n        If cell.Offset(0, 2).Value = 1 Then\n            Mdl.ModelMeasures.Add measure_name, tbl, measure_formula, Mdl.ModelFormatWholeNumber(1)\n        Else\n            Mdl.ModelMeasures.Add measure_name, tbl, measure_formula, Mdl.ModelFormatPercentageNumber(False, 1)\n        End If\n    End If\nNext cell\n\nerrhandler:\n    Debug.Print cell.Address, \"Now we have a real problem\"\nEnd Sub\n\nFunction GetItemNumber(measure_name As String) As Integer\nDim cnt As Integer\nDim Mdl As Model\nDim tbl As ModelTable\nSet Mdl = ActiveWorkbook.Model\nSet tbl = Mdl.ModelTables(1)\n\nFor cnt = 1 To Mdl.ModelMeasures.Count\n    If Mdl.ModelMeasures.item(cnt).Name = measure_name Then\n        Debug.Print \"Have a duplicate measure name\"\n        Exit For\n    End If\nNext cnt\n\nIf cnt &gt; 0 And cnt &lt;= Mdl.ModelMeasures.Count Then\n    GetItemNumber = cnt\nElse\n    GetItemNumber = 0\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 5834574, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MjKPW.gif?s=128&g=1", "display_name": "Krusaderjake", "link": "https://stackoverflow.com/users/5834574/krusaderjake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3492, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535950240, "creation_date": 1476900077, "last_edit_date": 1476938251, "question_id": 40138524, "link": "https://stackoverflow.com/questions/40138524/vba-to-add-measure-to-powerpivot-pivot-table", "title": "VBA to Add Measure to PowerPivot Pivot Table", "body": "<p><strong>UPDATE:</strong> I think I found the answer but I have not been able to see if there is a way to do this in Excel 2013.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/mt574976.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/mt574976.aspx</a></p>\n\n<p>That link has documentation on ModelMeasures.Add Method but there are no real great examples I can find out there right now. If anyone has a good example that works in Excel 2013 to add a measure to a model using VBA, please share as the answer.</p>\n\n<p>Best Example I could find, but not able to accomplish in Excel 2013:\n<a href=\"https://social.msdn.microsoft.com/Forums/en-US/c7d5f69d-b8e3-4823-bbde-61253b64b80e/vba-powerpivot-object-model-adding-measures-with-modelmeasuresadd?forum=isvvba\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/en-US/c7d5f69d-b8e3-4823-bbde-61253b64b80e/vba-powerpivot-object-model-adding-measures-with-modelmeasuresadd?forum=isvvba</a></p>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<p><strong>ORIGINAL POST:</strong></p>\n\n<p>I am trying to automate the adding of calculated fields to a powerpivot pivot table using VBA. I am not experienced in VBA.</p>\n\n<p>When I manually add a Calculated Field using the below formula I am able to see the Calculated Field added. What is wrong with this VBA code?</p>\n\n<p><strong>Here is my code:</strong></p>\n\n<pre><code>Sub Macro5()\nDim PvtTbl As PivotTable\nSet PvtTbl = Worksheets(\"Sheet4\").PivotTables(\"PivotTable6\")\n\n'Table1 is part of the PowerPivot data model and I have created a pivot table from Table1\nPvtTbl.CalculatedFields.Add \"column\", \"=IF(HASONEVALUE(Table1[TEXT1]), VALUES(Table1[TEXT1]), BLANK())\"\n\n'Selecting the pivot table and adding the new calculated field\n    Range(\"D7\").Select\n    ActiveSheet.PivotTables(\"PivotTable6\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable6\").CubeFields(\"[Measures].[column]\")\nEnd Sub\n</code></pre>\n\n<p><strong>The Error I get:</strong></p>\n\n<p>Run-time error '1004': Application-defined or object-defined error</p>\n"}, {"tags": ["arrays", "regex", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 1, "user_id": 7043725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTeLUv2qWqM/AAAAAAAAAAI/AAAAAAAAABw/I9sprsyRcwA/photo.jpg?sz=128", "display_name": "Bmathfun", "link": "https://stackoverflow.com/users/7043725/bmathfun"}, "edited": false, "score": 0, "creation_date": 1476899344, "post_id": 40138286, "comment_id": 67546218, "body": "Function RegexReplace(ByVal text As String, _ ByVal replace_what As String, _ ByVal replace_with As String) As String  Dim RE As Object Set RE = CreateObject(&quot;vbscript.regexp&quot;)  RE.Pattern = replace_what RE.Global = True RegexReplace = RE.Replace(text, replace_with)  End Function"}, {"owner": {"reputation": 1, "user_id": 7043725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTeLUv2qWqM/AAAAAAAAAAI/AAAAAAAAABw/I9sprsyRcwA/photo.jpg?sz=128", "display_name": "Bmathfun", "link": "https://stackoverflow.com/users/7043725/bmathfun"}, "edited": false, "score": 0, "creation_date": 1476899367, "post_id": 40138286, "comment_id": 67546235, "body": "Comment added below with function because website crashed on me."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1476899390, "post_id": 40138286, "comment_id": 67546251, "body": "Please do not put code in the comments.  Edit your original post to include it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476902885, "post_id": 40138286, "comment_id": 67548373, "body": "Do your cells contain dates (i.e. double precision numbers where, for instance, 42663.2395391204 represents 5:44:56am on 20 October 2016) or do they contain text (for instance &quot;20/10/2016  05:44:56&quot;, or possibly just &quot;20/10/2016&quot;)?"}, {"owner": {"reputation": 1, "user_id": 7043725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTeLUv2qWqM/AAAAAAAAAAI/AAAAAAAAABw/I9sprsyRcwA/photo.jpg?sz=128", "display_name": "Bmathfun", "link": "https://stackoverflow.com/users/7043725/bmathfun"}, "edited": false, "score": 0, "creation_date": 1476904712, "post_id": 40138286, "comment_id": 67549438, "body": "My cells are dates all in the same format. My only question is how to use the union method in this problem."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476906611, "post_id": 40138286, "comment_id": 67550545, "body": "If your cells are dates, why do you need to use code to reformat them?   Just change the cell format to display them however you would like them displayed."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476909254, "post_id": 40138286, "comment_id": 67552040, "body": "As far as your question re using <code>Union</code> goes, just replace your <code>Range</code> (I assume you are talking about the bit which says <code>Range (&quot;Q2:@&quot; &amp; lastRow)</code>, although I hope the <code>@</code> is a typo) with your union, i.e. <code>Union(first range, second range)</code> (so perhaps <code>Union(Range(&quot;Q2:Q&quot; &amp; lastRow), Range(&quot;X2:X&quot; &amp; lastRow))</code>).  But I don&#39;t know what using a Union of, for instance, two fixed columns has to do with &quot;dynamically expand the range of the current range to include multiple (non touching columns)&quot;.  You need to give more info in your question before we can help you with that &quot;dynamic&quot; part."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476909796, "post_id": 40138286, "comment_id": 67552301, "body": "Just looking at your code - does it actually run for the single range?  In fact, does it even <b>compile</b>?  e.g. the space in the middle of a variable name in <code>Dim Last Row As Long</code>, <code>RegexReplace</code> v <code>RegexRepalce</code>, the extraneous period in <code>&quot;Run the Program&quot;.</code>, the &quot;@&quot; in <code>Range (&quot;Q2:@&quot; &amp; lastRow)</code>, the period instead of a comma in <code>&quot;(\\d{2})&#47;(\\d{2})&#47;(\\d{4})&quot;. &quot;$3-$1=$2&quot;</code> (and should the &quot;=&quot; be &quot;-&quot;?)"}, {"owner": {"reputation": 1, "user_id": 7043725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTeLUv2qWqM/AAAAAAAAAAI/AAAAAAAAABw/I9sprsyRcwA/photo.jpg?sz=128", "display_name": "Bmathfun", "link": "https://stackoverflow.com/users/7043725/bmathfun"}, "edited": false, "score": 0, "creation_date": 1476923495, "post_id": 40138286, "comment_id": 67557096, "body": "The code compiles. The funky characters caused the code to error out in the edit box when typing and pasting the code. Therefore, I had to manually type it in. I noticed the typos."}], "answers": [{"tags": [], "owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "is_accepted": false, "score": 0, "last_activity_date": 1476952681, "creation_date": 1476952681, "answer_id": 40149416, "question_id": 40138286, "link": "https://stackoverflow.com/questions/40138286/expand-the-current-range-to-include-multiple-non-touching-columns/40149416#40149416", "title": "Expand the current range to include multiple non touching columns", "body": "<p>Yeah thats a nice complex way to do it. or you could just</p>\n\n<p>Range(Range(\"A1\"), ActiveCell.SpecialCells(xlLastCell)).address</p>\n"}], "owner": {"reputation": 1, "user_id": 7043725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTeLUv2qWqM/AAAAAAAAAAI/AAAAAAAAABw/I9sprsyRcwA/photo.jpg?sz=128", "display_name": "Bmathfun", "link": "https://stackoverflow.com/users/7043725/bmathfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549574498, "creation_date": 1476899309, "last_edit_date": 1549574498, "question_id": 40138286, "link": "https://stackoverflow.com/questions/40138286/expand-the-current-range-to-include-multiple-non-touching-columns", "title": "Expand the current range to include multiple non touching columns", "body": "<p>How do I dynamically expand the current range to include multiple non touching columns?</p>\n\n<p>I'm thinking there needs to be the inclusion of a dynamic multi-dimensional array set to complete this task. </p>\n\n<pre><code>Sub Convert Dates()\n\nDim Answer As String\nDim Cell As Range\nDim Last Row As Long\n\nAnswer = MsgBox(\"Are you sure you want to run the macro\",vbYesno,\"Run the Program\".)\n\nIf Answer = vbYes Then\n\n    lastRow = Range (\"Q\" &amp; Rows.Count).End(xlUp).Row\n\n    For Each cell In Range (\"Q2:@\" &amp; lastRow)\n\n        If Instr(cell.value, \".\") &lt;&gt; 0 Then\n            Cell.value = RegexReplace(cell.Value, _\n              \"(\\d{2})\\.(\\d{2})\\.(\\d{4})\", \"$3-$2-$1\")\n        End  if \n\n        If Instr (cell.value, \"/\") &lt;&gt; 0 Then\n            cell.Value = RegexRepalce(Cell.Value,_\n              \"(\\d{2})/(\\d{2})/(\\d{4})\". \"$3-$1=$2\")\n        End if  \n\n        cell.NumberFormat = \"yyyy-mm-d;@\"\n\n    Next\nEnd if\nEnd Sub\n\nFunction RegexReplace(ByVal text As String, _ \n                ByVal replace_what As String, _ \n                ByVal replace_with As String) As String\n    Dim RE As Object \n    Set RE = CreateObject(\"vbscript.regexp\") \n    RE.Pattern = replace_what \n    RE.Global = True \n    RegexReplace = RE.Replace(text, replace_with)  \nEnd Function \n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1476899445, "post_id": 40138222, "comment_id": 67546294, "body": "Using Select Case is an option, or just adjust these to ElseIF and then you can lose all of the extra End IFs at the bottom."}, {"owner": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476899650, "post_id": 40138222, "comment_id": 67546417, "body": "Thanks. The code does work, so I will inquire at codereview section as well.  Just looking to speed up the workbook."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 1730494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab93cb94c890cc9eb72dc63b0719fb3?s=128&d=identicon&r=PG", "display_name": "Andrew Bell", "link": "https://stackoverflow.com/users/1730494/andrew-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1476899538, "creation_date": 1476899538, "answer_id": 40138364, "question_id": 40138222, "link": "https://stackoverflow.com/questions/40138222/vba-macro-for-hiding-rows-based-on-cell-value/40138364#40138364", "title": "VBA macro for hiding rows based on cell value", "body": "<p>I might try a case statement.</p>\n\n<p>Oh, or even use the ElseIf option which would reduce the amount of EndIf statements at the very least.</p>\n\n<p>I think the case code looks something like this:</p>\n\n<p>Select Range(\"B87\").value</p>\n\n<pre><code>Case \"1\"\n\nCase \"2\"\n\n...\n</code></pre>\n\n<p>End Select</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476902428, "post_id": 40138756, "comment_id": 67548124, "body": "Yes - thank you!  This works well, and am now implementing across the workbook."}, {"owner": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476907138, "post_id": 40138756, "comment_id": 67550828, "body": "How would I go about calling this Sub as a Worksheet Change if I have multiple places where I would like this to apply?  Thanks."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476908152, "post_id": 40138756, "comment_id": 67551435, "body": "@zanzibar why a worksheet change event? If you want to run this over multiple ranges, you could pass those into the sub first."}, {"owner": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476910225, "post_id": 40138756, "comment_id": 67552505, "body": "I admit my VBA knowledge is very slim, so my assumption was this had be placed in a Worksheet Change to dynamically adjust the sheet based on the values I input.  Any advice would be super helpful."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "edited": false, "score": 0, "creation_date": 1476910624, "post_id": 40138756, "comment_id": 67552706, "body": "@zanzibar Yes, I was just checking if you knew that. Worksheet change event is ran each time a cell value in a sheet changes. If, instead, you just have other ranges to run this on, you don&#39;t necessarily need the change event...just add more ranges. I suggest looking up the worksheet change event, as well as how to pass variables to a subroutine in VBA. Play around and try some code out. When you have a question, start a new one here as it&#39;s starting to be a different issue than tour original one.  Good hunting!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1476900912, "creation_date": 1476900912, "answer_id": 40138756, "question_id": 40138222, "link": "https://stackoverflow.com/questions/40138222/vba-macro-for-hiding-rows-based-on-cell-value/40138756#40138756", "title": "VBA macro for hiding rows based on cell value", "body": "<p>You have a whole lot of basically the same code. I took a look and tried to make it more arithmetical, which shortens the code. See if this works:</p>\n\n<pre><code>Sub t()\nDim myVal   As String\nDim mainRow As Long, tweakRow As Long\nDim hideRange As Range, showRange As Range\nDim row1 As Long, row2 As Long\n\nmainRow = 98\nmyVal = Range(\"B87\").Value\n\nIf myVal = 10 Then\n    Rows(mainRow - 10 &amp; \":\" &amp; mainRow - 10 + myVal).EntireRow.Hidden = False\nElseIf myVal &gt;= 1 And myVal &lt;= 9 Then\n    tweakRow = mainRow - 10\n    row1 = (mainRow - (9 - myVal))\n    row2 = (mainRow - (10 - myVal))\n    Set hideRange = Rows(row1 &amp; \":\" &amp; mainRow).EntireRow\n    Set showRange = Rows(tweakRow &amp; \":\" &amp; row2).EntireRow\n\n    Debug.Print \"For a value of \" &amp; myVal &amp; \", we will hide range: \" &amp; hideRange.Address &amp; \", and show range: \" &amp; showRange.Address\n\n    hideRange.Hidden = True\n    showRange.Hidden = False\nElseIf myVal = 0 Then\n    Rows(mainRow - 10 &amp; \":\" &amp; mainRow).EntireRow.Hidden = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1476901904, "creation_date": 1476901904, "answer_id": 40139052, "question_id": 40138222, "link": "https://stackoverflow.com/questions/40138222/vba-macro-for-hiding-rows-based-on-cell-value/40139052#40139052", "title": "VBA macro for hiding rows based on cell value", "body": "<p>You don't need to use <code>EntireRow</code> when using <code>Rows</code> or 'EntireColumn<code>when using</code>Columns`. </p>\n\n<pre><code>Rows(\"88:98\").Hidden = True\n\nIf Range(\"B87\").Value &gt; 0 Then\n    Rows(88).Resize(1 + Range(\"B87\").Value).Hidden = False\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7043650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac4f44b52b7839dfd0f972ea090fe8b?s=128&d=identicon&r=PG&f=1", "display_name": "zanzibar", "link": "https://stackoverflow.com/users/7043650/zanzibar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3573, "favorite_count": 0, "accepted_answer_id": 40138756, "answer_count": 3, "score": 0, "last_activity_date": 1495732853, "creation_date": 1476899116, "question_id": 40138222, "link": "https://stackoverflow.com/questions/40138222/vba-macro-for-hiding-rows-based-on-cell-value", "title": "VBA macro for hiding rows based on cell value", "body": "<p>I am working on a sheet that has sections which hides/shows a number of rows based on a cell value (between 1-10).  At the moment, I have a handful of nested if statements.  This has made my workbook painfully slow.  Is there a way to shrink this code? Thanks.</p>\n\n<pre><code>If Range(\"B87\").Value = 10 Then\n        Rows(\"88:98\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 9 Then\n        Rows(\"98\").EntireRow.Hidden = True\n        Rows(\"88:97\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 8 Then\n        Rows(\"97:98\").EntireRow.Hidden = True\n        Rows(\"88:96\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 7 Then\n        Rows(\"96:98\").EntireRow.Hidden = True\n        Rows(\"88:95\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 6 Then\n        Rows(\"95:98\").EntireRow.Hidden = True\n        Rows(\"88:94\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 5 Then\n        Rows(\"94:98\").EntireRow.Hidden = True\n        Rows(\"88:93\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 4 Then\n        Rows(\"93:98\").EntireRow.Hidden = True\n        Rows(\"88:92\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 3 Then\n        Rows(\"92:98\").EntireRow.Hidden = True\n        Rows(\"88:91\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 2 Then\n        Rows(\"91:98\").EntireRow.Hidden = True\n        Rows(\"88:90\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 1 Then\n        Rows(\"90:98\").EntireRow.Hidden = True\n        Rows(\"88:89\").EntireRow.Hidden = False\n    Else\n    If Range(\"B87\").Value = 0 Then\n        Rows(\"88:98\").EntireRow.Hidden = True\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1476898263, "post_id": 40136980, "comment_id": 67545549, "body": "This will be difficult to figure out without the actual workbook to look at..."}], "owner": {"reputation": 11, "user_id": 7043456, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154568160756866/picture?type=large", "display_name": "Ever Calzada", "link": "https://stackoverflow.com/users/7043456/ever-calzada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476894704, "creation_date": 1476894704, "last_edit_date": 1531164843, "question_id": 40136980, "link": "https://stackoverflow.com/questions/40136980/pivot-table-returns-wrong-value-on-one-row", "title": "Pivot Table returns wrong value on one row", "body": "<p>I have a very strange problem. I built a macro that refreshes several PivotTables. Everything is fine except for one PivotTable where one value \"AGHF21A#BFF\" in the source gets changed into \"54r\" in the Pivot Table. Other PivotTables also get data from this source and they all get the correct value. This only happens with this specific case from a list of 30 products, this is the only one that changes the value in the Pivot Table. \nI tried everything Excel would allow me do. I changed the format to string/general. I tried to do a calculated field. The strange thing is that if in the source data I add let's say any character, remove any character or change any character then the pivot table does recognize the code and does not change it to the strange code \"54r.\" I have never seen any Pivot table do this before.\nThe Macro downloads different reports into Excel and then it refreshes the PivotTables. Any help would be very appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2659, "user_id": 2291363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VXEHL.jpg?s=128&g=1", "display_name": "zbMax", "link": "https://stackoverflow.com/users/2291363/zbmax"}, "edited": false, "score": 0, "creation_date": 1477300466, "post_id": 40138934, "comment_id": 67693351, "body": "Works great. Thanks a lot"}], "tags": [], "owner": {"reputation": 61, "user_id": 7043384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kEiiQwcbE3M/AAAAAAAAAAI/AAAAAAAAGpc/oNccSOSOsGw/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/7043384/benjamin"}, "is_accepted": true, "score": 1, "last_activity_date": 1476902209, "last_edit_date": 1476902209, "creation_date": 1476901517, "answer_id": 40138934, "question_id": 40136856, "link": "https://stackoverflow.com/questions/40136856/excel-updating-series-data-erase-chart-styles/40138934#40138934", "title": "Excel : Updating series data erase chart styles", "body": "<p>I misread your problem, and thought you were losing formatting on your cells. Now I see it's your chart. I have a number of charts that I am doing the same thing as you. I update the Chart Series with VBA and I never lose formatting. Before I clear data, I set all chart series values ={1}. Then I have another macro that sets the series values after I load the data.</p>\n\n<p>Here's a sub I wrote to clear the series before clearing the data:</p>\n\n<pre><code>Sub clearChart(chartWs As Worksheet, chartName As String)\n  Dim cObj As ChartObject\n  Dim i As Integer\n  Set cObj = chartWs.ChartObjects(chartName)\n  For i = 1 To cObj.Chart.SeriesCollection.count\n     cObj.Chart.SeriesCollection(i).Values = \"{1}\"\n     cObj.Chart.SeriesCollection(i).XValues = \"{1}\"\n  Next i\nEnd Sub\n</code></pre>\n\n<p>Example:\n    clearChart Sheet2, \"Chart1\"</p>\n\n<p>Hope that helps...</p>\n"}], "owner": {"reputation": 2659, "user_id": 2291363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VXEHL.jpg?s=128&g=1", "display_name": "zbMax", "link": "https://stackoverflow.com/users/2291363/zbmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 40138934, "answer_count": 1, "score": 0, "last_activity_date": 1476902209, "creation_date": 1476894258, "last_edit_date": 1531161705, "question_id": 40136856, "link": "https://stackoverflow.com/questions/40136856/excel-updating-series-data-erase-chart-styles", "title": "Excel : Updating series data erase chart styles", "body": "<p>I'm retrieving in a worksheet data formatted as a csv from a php file on my server.<br>\nAs I consider I don't know how many lines I will receive, It pushes the data in this worksheet with the options replacing the content of cells if necessary, and deleting the unused ones.<br><br>\nI run a procedure to parse the data of this worksheet to fill another worksheet.<br>\nFor the same reason as above, I clear the columns of this second worksheet before filling it.</p>\n\n<p>Here is a sample of my procedure :</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nWorksheets(\"data2\").Activate\nRange(\"A:B:C:D\").Clear\n\nWorksheets(\"data\").Activate\nSet my_range = Range(\"A:A\")\n\nFor i = 1 To my_range.Rows.Count\n    'calculations saved in some vars : var1, var2, ...\n    Cells(i, 1).Value = var1\n    Cells(i, 2).Value = var2\n    '...\nNext i\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>On the second worksheet, I've inserted a chart using data from the two worksheets.<br>\nAs the number of rows is dynamic, I've declared names to refer to my column. They are set like : <code>=OFFSET(data!$A$1;0;0;COUNT(data!$A:$A))</code></p>\n\n<p>My problem is when I run my procedure, I lose all the styles set for my chart.\nAm I doing something wrong ? Is there an option to keep the styles of my chart ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1476893998, "post_id": 40136520, "comment_id": 67543190, "body": "You don&#39;t need to use <code>Activate</code>. I <b><i>highly</i></b> suggest reading, and applying, <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1476894068, "post_id": 40136613, "comment_id": 67543225, "body": "Note that since the sheets (<code>&quot;BigMaster&quot;</code>) is the same name in both workbooks. You may want to avoid <code>ActiveWorkbook.Sheets(&quot;BigMaster&quot;)...</code> just in case the <code>&quot;SheetsForConstructionandIMportingIntoViewPoint- FROZEN.XLSM&quot;</code> is the activesheet."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1476893439, "creation_date": 1476893439, "answer_id": 40136613, "question_id": 40136520, "link": "https://stackoverflow.com/questions/40136520/how-to-make-my-initial-workbook-activate-based-on-a-full-pathname/40136613#40136613", "title": "how to make my initial workbook activate based on a full pathname", "body": "<p>Assuming the destination workbook is open - if it's not then you first need to open it</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"BigMaster\").Range(\"A1:z999\").Copy _\n  Workbooks(\"SheetsForConstructionAndImportingIntoViewpoint - FROZEN.XLSM\"). _\n    Sheets(\"BigMaster\").Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 40136613, "answer_count": 1, "score": 0, "last_activity_date": 1476896925, "creation_date": 1476893117, "last_edit_date": 1476896925, "question_id": 40136520, "link": "https://stackoverflow.com/questions/40136520/how-to-make-my-initial-workbook-activate-based-on-a-full-pathname", "title": "how to make my initial workbook activate based on a full pathname", "body": "<p>i have the following code, need it to work:</p>\n\n<pre><code>Sheets(\"BigMaster\").Range(\"A1:z999\").Copy\nWindows(\"Z:\\Viewpoint\\Viewpoint Import\\Programs\\SheetsForConstructionAndImportingIntoViewpoint - FROZEN.XLSM\").Activate\nSheets(\"BigMaster\").Range(\"A1\").Paste\n</code></pre>\n\n<p>its failing on the activate command. how come?</p>\n\n<p>i have tried to shorten the workbook name but it is still not working. i definitely have the right path though, i took it with windows explorer.</p>\n\n<p>basically i need to copy from bigmaster on my current book to the bigmaster on the activate clause. but i get an error 9 subscript out of range.</p>\n\n<p>what am i doing wrong and how can i fix this macro</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "edited": false, "score": 0, "creation_date": 1476894682, "post_id": 40136551, "comment_id": 67543573, "body": "It says type mismatch then highlights     hl.ScreenTip = CStr(hl.Range.Value)"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "edited": false, "score": 0, "creation_date": 1476895045, "post_id": 40136551, "comment_id": 67543760, "body": "@MichaelDowney I couldn&#39;t tell you why, it works just fine for me. Did you try walking through it with the debugger one step at a time? Also to note, I didn&#39;t change that line of code throwing the error any, that was from your original post."}, {"owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "edited": false, "score": 0, "creation_date": 1476895265, "post_id": 40136551, "comment_id": 67543892, "body": "Had another excel file open that was causing the issue."}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 3, "last_activity_date": 1476893203, "creation_date": 1476893203, "answer_id": 40136551, "question_id": 40136499, "link": "https://stackoverflow.com/questions/40136499/applying-macro-from-worksheet-to-workbook/40136551#40136551", "title": "Applying macro from worksheet to workbook", "body": "<p>change your <code>For Each</code> and add a new variable</p>\n\n<pre><code>Sub ScreenTip()\n    Dim hl As Hyperlink\n    Dim ws as WorkSheet\n\n    For Each ws in ActiveWorkbook.Worksheets\n        For Each hl In ws.Hyperlinks\n            hl.ScreenTip = CStr(hl.Range.Value)\n        Next hl\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1476893418, "post_id": 40136597, "comment_id": 67542853, "body": "LOL coke&#39;s on you!"}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 2, "last_activity_date": 1476893388, "creation_date": 1476893388, "answer_id": 40136597, "question_id": 40136499, "link": "https://stackoverflow.com/questions/40136499/applying-macro-from-worksheet-to-workbook/40136597#40136597", "title": "Applying macro from worksheet to workbook", "body": "<pre><code>Sub ScreenTip()\nDim hl As Hyperlink\ndim sh as worksheet\ndim bk as workbook\nset bk = whateverbook\nfor each sh in bk.sheets\n    For Each hl In sh.Hyperlinks\n        hl.ScreenTip = CStr(hl.Range.Value)\n    Next hl\nnext sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 40136551, "answer_count": 2, "score": 0, "last_activity_date": 1476896882, "creation_date": 1476893063, "last_edit_date": 1476896882, "question_id": 40136499, "link": "https://stackoverflow.com/questions/40136499/applying-macro-from-worksheet-to-workbook", "title": "Applying macro from worksheet to workbook", "body": "<pre><code>Sub ScreenTip()\n    Dim hl As Hyperlink\n\n    For Each hl In ActiveSheet.Hyperlinks\n        hl.ScreenTip = CStr(hl.Range.Value)\n    Next\nEnd Sub\n</code></pre>\n\n<p>I have this code but it only runs on the Worksheet that you are currently on. I would like it to run over the whole workbook. How would I change this to do that?</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476891749, "post_id": 40135984, "comment_id": 67541704, "body": "Not quite sure of the details, but wouldn&#39;t <code>=&quot;Row&quot;&amp;row()&quot;_Column&quot;&amp;Column()</code> work? By &quot;name&quot;, do you mean create a named range?  Can you please clarify what you mean, perhaps show your table as it is now, and what you expect it to look like after?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1476891783, "post_id": 40135984, "comment_id": 67541737, "body": "The cells are already named like that, no need to do it manually. If you use <code>Range(&quot;A1&quot;).Value</code> it will return the value in range A1."}, {"owner": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "edited": false, "score": 0, "creation_date": 1476891891, "post_id": 40135984, "comment_id": 67541811, "body": "Sorry if I am not clear. what I meant was lets say the row left cell is named sales and the coulmn top cell is named Oct. I want the cell name to be &quot;sales_Oct&quot; instead of B2"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476892051, "post_id": 40135984, "comment_id": 67541914, "body": "If you want to reference cells by row &amp; column number then use <code>Cells(1,2)</code> (cell B1)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476893575, "post_id": 40135984, "comment_id": 67542937, "body": "It&#39;s not possible to change the notation used for cells (other than A1 or R1C1 built-in options). If you want to create a <code>Name</code> (named range) in Excel, this is possible, using the <b>Name Manager</b> from the Formula ribbon. If this is ultimately what you want, you should record a macro while doing this assignment on one cell, and then if you have trouble modifying it to your purposes (applying to entire selected range) please revise your question."}, {"owner": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "edited": false, "score": 0, "creation_date": 1476893826, "post_id": 40135984, "comment_id": 67543092, "body": "Yes what I want is to create a Name, I know how to do this through Name manager but the problem is the name manager allows only for the &quot;name&quot; to be text and not a reference from other cell value. I tried recording macro and modifying but failed to do it through Activecell.name or anything like that."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "edited": false, "score": 0, "creation_date": 1476899465, "post_id": 40136914, "comment_id": 67546312, "body": "Thanks for your reply. Sorry for my ignorance but I don&#39;t have a &quot;main code&quot; to start with."}, {"owner": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "edited": false, "score": 0, "creation_date": 1476899622, "post_id": 40136914, "comment_id": 67546399, "body": "From what I understand, this will allow me to call for the cell values by the names of the column and row headings. this is not exactly what I want. I am using this file to import to a costing software that requires the cells to be renamed from the standard to a specific name. so the target is to change the cell name not to be able to recall it in a different way."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "edited": false, "score": 0, "creation_date": 1476944934, "post_id": 40136914, "comment_id": 67563287, "body": "then you&#39;re after <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839264(v=office.15).aspx\" rel=\"nofollow noreferrer\">Names</a>, see edited answer"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476944888, "last_edit_date": 1476944888, "creation_date": 1476894490, "answer_id": 40136914, "question_id": 40135984, "link": "https://stackoverflow.com/questions/40135984/naming-cells-with-row-and-column-heading-using-vba/40136914#40136914", "title": "Naming Cells with Row and Column heading using vba", "body": "<p>edited after OP's clarifications</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range\n\n    With Worksheets(\"MyTable\").UsedRange '&lt;-- change \"MyTable\" to actual name of the worksheet with cells to be renamed\n        For Each cell In .Offset(1, 1).Resize(.Rows.Count - 1, .Columns.Count - 1)\n            cell.name = Intersect(.Columns(1), cell.EntireRow) &amp; \"_\" &amp; Intersect(.Rows(1), cell.EntireColumn)\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5808001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b54897a36e5a383d023d69c9bf9b93?s=128&d=identicon&r=PG&f=1", "display_name": "ISM", "link": "https://stackoverflow.com/users/5808001/ism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1476944888, "creation_date": 1476891587, "last_edit_date": 1476894206, "question_id": 40135984, "link": "https://stackoverflow.com/questions/40135984/naming-cells-with-row-and-column-heading-using-vba", "title": "Naming Cells with Row and Column heading using vba", "body": "<p>I don't know much about vba but I am stuck a task that I can't do manually.</p>\n\n<p>I have a table (huge one) that I need to rename the cells from the standard RC name format.</p>\n\n<p>example:</p>\n\n<pre><code>OCT NOV DEC\nSales   B2    C2    D2\nRevnue  B3    C3    D3\nTotal   B4    C4    D4\nRow4    B5    C5    D5\nRow5    B6    C6    D6\n</code></pre>\n\n<p>I want to program something to rename the cell name (Not values) to be Sales_Oct instead of B2 and to do this to a selected range and choosing the Row and Column to read the name from.</p>\n\n<p>what I want is to create a Name, I know how to do this through Name manager but the problem is the name manager allows only for the \"name\" to be text and not a reference from other cell value. I tried recording macro and modifying but failed to do it through Activecell.name or anything like that.</p>\n\n<p>any help would be appreciated</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1476890485, "post_id": 40135472, "comment_id": 67540878, "body": "I don&#39;t know if this will fix it, but you definitely want to edit your last row line: <code>lastRow = Worksheets(&quot;USA&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code>. Otherwise it is capturing the value of the last cell in column A, not the number of the last row."}], "answers": [{"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 2, "last_activity_date": 1476893267, "last_edit_date": 1476893267, "creation_date": 1476890786, "answer_id": 40135690, "question_id": 40135472, "link": "https://stackoverflow.com/questions/40135472/vba-dynamic-range-to-extend-rows/40135690#40135690", "title": "VBA Dynamic Range to Extend Rows", "body": "<p>Instead of trying to dynamically adjust your range, place the data in an Excel table and let Excel do the work for you.  Select your data and press <kbd>CTRL</kbd> + <kbd>T</kbd> to turn the range into a table.  Excel automatically creates named ranges representing the entire data set, individual columns, and even for the data set without the header row.</p>\n\n<p>So if the table created is called \"Table1\" then use the reference \"Table1\" to refer to all cells in the table except the header row.</p>\n\n<p>Referencing individual columns is also easier as Excel creates named ranges based on the column headers you create.  For example, if your first column in \"Table1\" is called \"MyFirstColumn\" then use \"Table1[MyFirstColumn]\" to reference the table entire column (excluding the header).</p>\n\n<p>If you want to know what named range to use for any part of a table, just go to a cell at least two rows or two columns outside the table.  Type the equal sign and then select a range in the table.  You will see for example that when you select multiple adjacent columns (data only, no headers) the range name looks like \"Table1[[MyFirstColumn]:[MySecondColumn]]\".</p>\n"}, {"comments": [{"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1476895852, "post_id": 40137146, "comment_id": 67544220, "body": "that worked perfectly! I see what I should&#39;ve changed in my code, thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1476895301, "creation_date": 1476895301, "answer_id": 40137146, "question_id": 40135472, "link": "https://stackoverflow.com/questions/40135472/vba-dynamic-range-to-extend-rows/40137146#40137146", "title": "VBA Dynamic Range to Extend Rows", "body": "<p>you could try this:</p>\n\n<pre><code>Option Explicit\n\nSub extendrows()\n    Dim nDataRows As Long\n\n    With Worksheets(\"USA\")\n        nDataRows = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row - 2 ' assuming data start from row 3 in \"USA\"\n    End With\n\n    With Worksheets(\"USA defprob\").Range(\"A9:W9\")\n        .AutoFill Destination:=.Resize(nDataRows)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2033, "favorite_count": 1, "accepted_answer_id": 40137146, "answer_count": 2, "score": 1, "last_activity_date": 1476895301, "creation_date": 1476890162, "question_id": 40135472, "link": "https://stackoverflow.com/questions/40135472/vba-dynamic-range-to-extend-rows", "title": "VBA Dynamic Range to Extend Rows", "body": "<p>I am trying to do what seems like a simple dynamic range task in VBA. </p>\n\n<p><a href=\"https://i.stack.imgur.com/dB0c3.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/dB0c3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The above table has data downloaded from an external website. New rows will be added to it every day. </p>\n\n<p><a href=\"https://i.stack.imgur.com/x1mN7.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/x1mN7.png\" alt=\"enter image description here\"></a></p>\n\n<p>This second table references the first. So for example the Date column in this table will be =USA!A18.</p>\n\n<p>I want to write a VBA script so that whenever new data is added to the first table, I can run the macro to extend down the rows/formulas of the second table to add the new data. </p>\n\n<p>So if 5 new rows are added to the first table, the macro will extend the existing rows and formulas from columns A to W  in the second table down five. It cannot have any blank rows or #VALUE errors without breaking some other code in the spreadsheet. The data starts in A9 and extends to W9. </p>\n\n<p>I tried implementing the following:</p>\n\n<pre><code>Sub extendrows()\n\nDim lastRow As Long\n\nlastRow = Worksheets(\"USA\").Range(\"A\" &amp; Rows.Count).End(xlUp)\n\nWorksheets(\"USA defprob\").Range(\"A9:W9\").AutoFill Destination:=Range(\"A9:W\" &amp; lastRow)\n\nEnd Sub\n</code></pre>\n\n<p>but I get a memory error, which I suspect is because it's pasting several thousand blank rows instead of stopping. How can I adjust this code to do what I need the macro to do?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476889841, "post_id": 40135288, "comment_id": 67540437, "body": "I would recommend to edit the code you provided to use indentation and to only provide the absolute most relevant code to reproduce your problem. (i.e. - get rid of all the error checking for an actual email)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1476889851, "post_id": 40135288, "comment_id": 67540445, "body": "use the split function by vbCrLf as delimiter, then put the array in the range.  something like <code>a=split(strEmail,vbcrlf):range(&quot;a1:a&quot; &amp; ubound(a)).value=a</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1476894711, "last_edit_date": 1476894711, "creation_date": 1476892169, "answer_id": 40136197, "question_id": 40135288, "link": "https://stackoverflow.com/questions/40135288/outlook-email-body-to-excel/40136197#40136197", "title": "Outlook Email Body to Excel", "body": "<p>An example is the 'SplitEmByLine' function below, I left the ReturnString and PrintArray functions in for some clarity, but these can essentially be ignored.</p>\n\n<pre><code>Sub callSplitFunction()\nDim FileFull As String, a() As String, s As Long\nFileFull = \"C:\\Users\\thomas.preston\\Desktop\\ThisBookOfMine.txt\"\n'The below line calls function\na = SplitEmByLine(ReturnString(FileFull))\nPrintArray a\nEnd Sub\n\n'*****The below function is what you need*****\nFunction SplitEmByLine(ByVal Body As String) As String()\nDim x As Variant\nx = Split(Body, vbCrLf)\nSplitEmByLine = x\nEnd Function\n\n\nSub PrintArray(ByRef Arr() As String)\nWith Sheets(\"Sheet1\")\n   For i = 0 To UBound(Arr)\n      .Cells(i + 1, 1).Value = Arr(i)\n   Next i\nEnd With\nEnd Sub\n\n\nFunction ReturnString(FilePath As String) As String\n    Dim TextFile As Integer\n    Dim FileContent As String\n\n    TextFile = FreeFile\n    Open FilePath For Input As TextFile\n    FileContent = Input(LOF(TextFile), TextFile)\n    Close TextFile\n    ReturnString = FileContent\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 904, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593154966, "creation_date": 1476889668, "last_edit_date": 1593154966, "question_id": 40135288, "link": "https://stackoverflow.com/questions/40135288/outlook-email-body-to-excel", "title": "Outlook Email Body to Excel", "body": "<p>I am trying to have the body of all emails in a folder output to an excel file. The below code is what I am using:</p>\n\n<pre><code>Dim appExcel As Excel.Application\nDim wkb As Excel.Workbook\nDim wks As Excel.Worksheet\nDim rng As Excel.Range\nDim strSheet As String\nDim strPath As String\nDim intRowCounter As Integer\nDim intColumnCounter As Integer\nDim msg As Outlook.MailItem\nDim nms As Outlook.NameSpace\nDim fld As Outlook.MAPIFolder\nDim itm As Object\nstrSheet = \"Test.xlsm\" \nstrPath = \"C:user\\Documents\\Action Items\\\" \nstrSheet = strPath &amp; strSheet\nDebug.Print strSheet\n'Select export folder\nSet nms = Application.GetNamespace(\"MAPI\")\nSet fld = nms.PickFolder\n\n'Open and activate Excel workbook.\nSet appExcel = CreateObject(\"Excel.Application\")\nappExcel.Workbooks.Open (strSheet)\nSet wkb = appExcel.ActiveWorkbook\nSet wks = wkb.Sheets(1)\nwks.Activate\nappExcel.Application.Visible = True\n'Copy field items in mail folder.\nFor Each itm In fld.Items\nintColumnCounter = 1\nSet msg = itm\nintRowCounter = intRowCounter + 1\nSet rng = wks.Cells(intRowCounter, intColumnCounter)\nrng.Value = msg.Body\nintColumnCounter = intColumnCounter + 1\nNext itm\n</code></pre>\n\n<p>The issue is that each message is being put into a single cell when I want each line in outlook to have its own line in excel as if I were to copy and paste the body from outlook to excel manually (using ctrl+a, ctrl+c, ctrl+v, for example). </p>\n\n<p>I feel like I need to use Split() to parse the body, but I've had no experience with that function and can't seem to get it to work. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I was able to solve this by using the below:</p>\n\n<pre><code>Sub SplitTextColumn()\n\nDim i As Long\nDim vA As Variant\n\n\n[A1].Select\nRange(Selection, Selection.End(xlDown)).Select\nFor i = 1 To Selection.Rows.Count\nvA = Split(Selection.Resize(1).Offset(i - 1), vbLf)\nSelection.Offset(i - 1).Resize(1, UBound(vA) + 1).Offset(, 1) = vA\nNext\n\n[A1].CurrentRegion.Offset(0, 1).Select\n    Selection.Copy\n    Sheets.Add After:=ActiveSheet\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\n\nEnd Sub\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Sub MakeOneColumn()\n\nDim vaCells As Variant\nDim vOutput() As Variant\nDim i As Long, j As Long\nDim lRow As Long\n\nIf TypeName(Selection) = \"Range\" Then\n    If Selection.Count &gt; 1 Then\n        If Selection.Count &lt;= Selection.Parent.Rows.Count Then\n            vaCells = Selection.Value\n\n            ReDim vOutput(1 To UBound(vaCells, 1) * UBound(vaCells, 2), 1 To 1)\n\n            For j = LBound(vaCells, 2) To UBound(vaCells, 2)\n                For i = LBound(vaCells, 1) To UBound(vaCells, 1)\n                    If Len(vaCells(i, j)) &gt; 0 Then\n                        lRow = lRow + 1\n                        vOutput(lRow, 1) = vaCells(i, j)\n                    End If\n                Next i\n            Next j\n\n            Selection.ClearContents\n            Selection.Cells(1).Resize(lRow).Value = vOutput\n        End If\n    End If\nEnd If\n\nDim c As Range\nSet rng = ActiveSheet.Range(\"A1:A5000\")\nFor dblCounter = rng.Cells.Count To 1 Step -1\n    Set c = rng(dblCounter)\n    If c.Value Like \"*MEADWESTVACO SUMMARY 856*\" Then\n    c.EntireRow.Insert\nEnd If\nNext dblCounter\n</code></pre>\n\n<p>But I don't feel like I have the excel objects referenced quite right as those subs are being called from outlook VBA. I get an error exactly every other time I run it. That is to say I can run it once, it will work, but then the second time it will break, then the third it will work again. Any suggestions?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1476889530, "post_id": 40135048, "comment_id": 67540198, "body": "Add <code>ws.</code> in front of <code>Rows(2)</code>. Assigning parentage to an object ensures that the call acts on the desired specified object. The other thing is to make sure &quot;Nome commerciale&quot; exists where you are looking for it."}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476891590, "post_id": 40135048, "comment_id": 67541611, "body": "I tried with the ws. but nothing changed...and yes I&#39;ve checked the row 2"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476892782, "post_id": 40135048, "comment_id": 67542419, "body": "what if you do add <code>debug.print </code> in front of the command and change <code>.Select</code> to <code>.Value</code>. Does the error persist? Or does it return a value in the immediate window?"}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476894102, "post_id": 40135048, "comment_id": 67543251, "body": "the error persist and nothing is written on the immediate window"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476890722, "post_id": 40135263, "comment_id": 67541030, "body": "Could you expand on that, please - maybe an example of how to correct it (probably the Select statement and checking the reference <i>is not nothing</i>)..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476891342, "post_id": 40135263, "comment_id": 67541454, "body": "Yes, see above."}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "edited": false, "score": 0, "creation_date": 1476892616, "post_id": 40135263, "comment_id": 67542305, "body": "I used the strategy laid out bu now I&#39;m getting error 448 named argument not found, but in row 2 and column 1 of the Sheet &quot;pistoia&quot; there&#39;s just the text &quot;Nome commerciale&quot;..."}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "edited": false, "score": 0, "creation_date": 1476893365, "post_id": 40135263, "comment_id": 67542819, "body": "solved the error 448...Mac version doesn&#39;t support Searchformat...now I&#39;m getting &quot;Value not found&quot; but in A2 there&#39;s the label that I search...no idea why it doesn&#39;t find the match."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1476893711, "post_id": 40135263, "comment_id": 67543017, "body": "Is it definitely on the right sheet? Check there are no leading or trailing spaces as you are looking at the whole cell contents."}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "edited": false, "score": 0, "creation_date": 1476894729, "post_id": 40135263, "comment_id": 67543605, "body": "yes is in A2 in the active sheet, there are no spaces"}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "edited": false, "score": 0, "creation_date": 1476895191, "post_id": 40135263, "comment_id": 67543847, "body": "ok, i started a new Sheet and rename in the same way and copy and now it works...I don&#39;t understand the reason but ok :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1476891316, "last_edit_date": 1476891316, "creation_date": 1476889628, "answer_id": 40135263, "question_id": 40135048, "link": "https://stackoverflow.com/questions/40135048/object-variable-or-with-block-variable-not-set-91-vba/40135263#40135263", "title": "object variable or with block variable not set 91 VBA", "body": "<p>That suggests to me that the value is not being found so that it is trying to select something doesn't exist. E.g. set a range variable to check the value is found. With Find, it's also worth specifying some of other parameters in case they are not what you expect.</p>\n\n<pre><code>    Sub SetCounter(ByVal counter As Double, ByVal product As String)\n\n    Dim ws As Worksheet, index_destRow As Integer, index_destColumn As Integer, search_product As Range\n    Dim rFind As Range\n\n    On Error Resume Next\n    Sheets(\"pistoia\").Activate\n    Set ws = ActiveWorkbook.Sheets(\"pistoia\")\n    On Error GoTo 0\n\n    If ws Is Nothing Then\n        MsgBox \"pistoia sheet not found\"\n    Else\n        If ws.Name = ActiveWorkbook.ActiveSheet.Name Then\n            Set rFind = ws.Rows(2).Find(What:=\"Nome commerciale\", LookAt:=xlWhole, LookIn:=xlValues, MatchCase:=False, SearchFormat:=False)\n            If Not rFind Is Nothing Then\n                rFind.Offset(2).Select\n            Else\n                msgbox \"Value not found\"\n            End If\n        Else\n            MsgBox \"pistoia sheet found but is inactive\"\n        End If\n    End If\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476891316, "creation_date": 1476889139, "question_id": 40135048, "link": "https://stackoverflow.com/questions/40135048/object-variable-or-with-block-variable-not-set-91-vba", "title": "object variable or with block variable not set 91 VBA", "body": "<p>I'm working on a macro that should transfer a data into a different sheet named \"pistoia\" and this is the code:</p>\n\n<pre><code>Sub SetCounter(ByVal counter As Double, ByVal product As String)\nDim ws As Worksheet\nOn Error Resume Next\nSheets(\"pistoia\").Activate\nSet ws = ActiveWorkbook.Sheets(\"pistoia\")\nOn Error GoTo 0\n    If ws Is Nothing Then\n        MsgBox \"pistoia sheet not found\"\n    Else\n        If ws.Name = ActiveWorkbook.ActiveSheet.Name Then\n            Dim index_destRow As Integer, index_destColumn As Integer, search_product As Range\n            Rows(2).Find(What:=\"Nome commerciale\", LookAt:=xlWhole, LookIn:=xlValues).Offset(2).Select\n        Else\n            MsgBox \"pistoia sheet found but is inactive\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>The error raises at the line: \"Rows(2).Find(What:=\"Nome commerciale\", LookAt:=xlWhole, LookIn:=xlValues).Offset(2).Select\", I think that the error is due to the activation of the new sheet because in a previous macro made \"on the starting sheet\" I run this same operation in the row that caused the error. Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 0, "last_activity_date": 1476889597, "creation_date": 1476889597, "answer_id": 40135234, "question_id": 40134872, "link": "https://stackoverflow.com/questions/40134872/compare-cells-in-vba-for-conditional-formatting/40135234#40135234", "title": "Compare cells in VBA for conditional formatting", "body": "<p>I'm not 100% sure with what you are trying to achieve with your code, but to answer your question</p>\n\n<blockquote>\n  <p>How may I pick up the values from a cell range and insert them into a variable for comparison?</p>\n</blockquote>\n\n<p>you can use a <code>For Each</code> loop, something akin to:</p>\n\n<pre><code>dim myCell as range, myRange as range\nset myRange = Worksheets(\"Config sheet\").Range(\"I2:I11\")\n\nFor Each myCell in myRange\n    sshDevice = myCell.Value\n    'do stuff you need with sshDevice\nNext myCell\n</code></pre>\n\n<p>If you want to keep the sshDevices array, you can do that, and use the <code>For Each</code> loop to add each item individually.</p>\n\n<pre><code>dim counter as int\ncounter = 0\nFor Each myCell in myRange\n    sshDevice(counter) = myCell.Value\n    counter = counter + 1\nnext myCell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "edited": false, "score": 0, "creation_date": 1477013984, "post_id": 40137367, "comment_id": 67602546, "body": "Neither suggestion is working people. The conditional formatting is not taking place. Not sure if the array is being imported correctly or if the code chunk used for the comparison is compatible with the array types Im using"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "edited": false, "score": 0, "creation_date": 1477041376, "post_id": 40137367, "comment_id": 67612993, "body": "Well, your post was about how to store values in <code>sshDevices</code>  array from a range instead of hard coding them with the <code>Array() </code>function, complaining your attempt (<code>sshDevices = Worksheets(&quot;Config sheet&quot;).Range(&quot;I2:I11&quot;).Value</code>) didn&#39;t work since it stopped some conditional formatting you didn&#39;t post any information about. My answer  told you why your way of array range-filling wouldn&#39;t work as the &quot;good&quot; one and gave you the correct syntax to have an array returned from a &quot;vertical&quot; range working as your original <code>Array(&quot;linux&quot;, &quot;vmw&quot;, &quot;docker&quot;, &quot;unix&quot;)</code> one. I think I answered your question"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476896080, "creation_date": 1476896080, "answer_id": 40137367, "question_id": 40134872, "link": "https://stackoverflow.com/questions/40134872/compare-cells-in-vba-for-conditional-formatting/40137367#40137367", "title": "Compare cells in VBA for conditional formatting", "body": "<p>use</p>\n\n<pre><code>sshDevices = Application.Transpose(Worksheets(\"Config sheet\").Range(\"I2:I11\").Value)\n</code></pre>\n\n<p>just be informed that this way you'll have a <em>1-based</em> array regardless of any <code>Option Base</code> which however affects the returned array form <code>Array()</code> function</p>\n"}], "owner": {"reputation": 43, "user_id": 2824936, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/78a62b27b3dffaf55cf0d7070c3df25a?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Mendez", "link": "https://stackoverflow.com/users/2824936/jose-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 40135234, "answer_count": 2, "score": 1, "last_activity_date": 1476896080, "creation_date": 1476888738, "question_id": 40134872, "link": "https://stackoverflow.com/questions/40134872/compare-cells-in-vba-for-conditional-formatting", "title": "Compare cells in VBA for conditional formatting", "body": "<p>I have this chunk of code that works just fine:</p>\n\n<pre><code>Function sshProblem(rng As Range) As Boolean\n   Dim portStatus As String\n   portStatus = rng.Value\n\n   Dim deviceType As String\n   deviceType = Cells(Application.Caller.Row, 3).Value\n\n   Dim sshDevices As Variant\n   sshDevices = Array(\"linux\", \"vmw\", \"docker\", \"unix\")\n\n   If StrComp(portStatus, \"No\") = 0 Then\n      sshProblem = Not IsError(Application.Match(deviceType, sshDevices, 0))\n   End If\nEnd Function\n</code></pre>\n\n<p>Now the code needs to scale, and instead of storing values inside the sshDevices array, these values need to reside in a column in another sheet, so I tried to replace</p>\n\n<pre><code>sshDevices = Array(\"linux\", \"vmw\", \"docker\", \"unix\")\n</code></pre>\n\n<p>with</p>\n\n<pre><code>sshDevices = Worksheets(\"Config sheet\").Range(\"I2:I11\").Value\n</code></pre>\n\n<p>at that point the conditional formatting stopped working. How may I pick up the values from a cell range and insert them into a variable for comparison?</p>\n"}, {"tags": ["vba", "email", "outlook", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3618213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e81353c11a48e8f46ec0a6ef6f3b3?s=128&d=identicon&r=PG&f=1", "display_name": "jwalker3312", "link": "https://stackoverflow.com/users/3618213/jwalker3312"}, "edited": false, "score": 1, "creation_date": 1476900373, "post_id": 40138213, "comment_id": 67546838, "body": "I changed &#39;.Text = &quot;<i>@</i>.*&quot;&#39; to &#39;.Text = [A-z,0-9]{1,}\\@[A-z,0-9,\\.]{1,}&#39; because with the original, I was getting the entire contents of the letter leading up to the email address, and then the email address itself.  Now with the change I&#39;m getting only the email address, but if there&#39;s a special character (such as a period) in the first part of the address, I only get what&#39;s after the period."}, {"owner": {"reputation": 3, "user_id": 3618213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e81353c11a48e8f46ec0a6ef6f3b3?s=128&d=identicon&r=PG&f=1", "display_name": "jwalker3312", "link": "https://stackoverflow.com/users/3618213/jwalker3312"}, "edited": false, "score": 1, "creation_date": 1476901516, "post_id": 40138213, "comment_id": 67547531, "body": "` With rng.Find         .Text = &quot;&lt;[0-9A-&#255;.\\-]{1,}\\@[0-9A-&#255;\\-.]{1,}([^13 -/\\:-\\@\\\\-<code>\\{-&#191;])&quot;         .Wrap = wdFindAsk         .Forward = True         .MatchWildcards = True          If .Execute Then            EmAdr = rng.Text         Else           MsgBox &quot;Email not found&quot;         End If     End With</code>"}, {"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "reply_to_user": {"reputation": 3, "user_id": 3618213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e81353c11a48e8f46ec0a6ef6f3b3?s=128&d=identicon&r=PG&f=1", "display_name": "jwalker3312", "link": "https://stackoverflow.com/users/3618213/jwalker3312"}, "edited": false, "score": 1, "creation_date": 1476903824, "post_id": 40138213, "comment_id": 67548922, "body": "&lt;<a href=\"http://regexlib.com/Search.aspx?k=email&amp;AspxAutoDetectCookieSupport=1\" rel=\"nofollow noreferrer\">regexlib.com/&hellip;</a>&gt; this might help"}], "tags": [], "owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "is_accepted": true, "score": 0, "last_activity_date": 1476899091, "creation_date": 1476899091, "answer_id": 40138213, "question_id": 40134840, "link": "https://stackoverflow.com/questions/40134840/extract-a-single-email-address-from-word-doc-and-apply-it-to-the-to-field-of-an/40138213#40138213", "title": "Extract a single email address from Word doc and apply it to the TO: field of an Outlook email", "body": "<p>Try adding the following block to your code (preferrably in the beginning after you define <code>SourceDoc</code>) - it looks for the email using wildcards and returns a full string to the <code>EmAdr</code> variable, which you can use in the <code>.To</code> line of your outlook sender code</p>\n\n<pre><code>Dim rng as Range\nDim EmAdr as String\n\nSet rng = SourceDoc.Content\n\n    With Rng.Find\n        .Text = \"*@*.*\"\n        .Wrap = wdFindAsk\n        .Forward = True\n        .MatchWildcards = True\n\n        If .Execute Then\n           EmAdr = rng.Text\n        Else\n          MsgBox \"Email not found\"\n        End If\n    End With\n</code></pre>\n\n<p>If this helps, please mark the answer as accepted.</p>\n"}], "owner": {"reputation": 3, "user_id": 3618213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e81353c11a48e8f46ec0a6ef6f3b3?s=128&d=identicon&r=PG&f=1", "display_name": "jwalker3312", "link": "https://stackoverflow.com/users/3618213/jwalker3312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 40138213, "answer_count": 1, "score": 0, "last_activity_date": 1532962841, "creation_date": 1476888658, "question_id": 40134840, "link": "https://stackoverflow.com/questions/40134840/extract-a-single-email-address-from-word-doc-and-apply-it-to-the-to-field-of-an", "title": "Extract a single email address from Word doc and apply it to the TO: field of an Outlook email", "body": "<p>The company I work for emails letters to hundreds of people a day.  The letter templates vary, as does the location in the letter of the data that I want.  I already have VBA code that handles most of the steps for the user, including attaching the letter as PDF to an Outlook email and populating the subject and body.  Currently, the issue is that human error is causing typos and misdirection when the users type in the email address that the letter is going TO.  So I'm trying to add a section in this code that searches the document for an email address (there will always only be one email address in the doc, but might be in different place), and then copies that email and puts it in the TO line of the Outlook email.  Here is the code I'm using:</p>\n\n<pre><code>Sub EmailDocumentAsPDFfinal()\n\n\nDim SourceDoc As Document\nDim OutlookApp As Object\nDim OutlookMessage As Object\nDim TempFileName As Variant\nDim TempFilePath As String\nDim DefaultName As String\nDim UserAnswer As Long\nDim x As Long\n\n  Set SourceDoc = ActiveDocument\n\n  TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n\n  If SourceDoc.Path &lt;&gt; \"\" Then\n    DefaultName = Left(SourceDoc.Name, InStrRev(SourceDoc.Name, \".\") - 1)\n  Else\n    DefaultName = SourceDoc.Name\n  End If\n\nTempFileName = \"DocName\"\n\n  ActiveDocument.ExportAsFixedFormat _\n   OutputFileName:=TempFilePath &amp; TempFileName &amp; \".pdf\", _\n   ExportFormat:=wdExportFormatPDF\n\n  On Error Resume Next\n    Set OutlookApp = GetObject(class:=\"Outlook.Application\") 'Handles if Outlook is already open\n  Err.Clear\n    If OutlookApp Is Nothing Then Set OutlookApp = CreateObject(class:=\"Outlook.Application\") 'If not, open Outlook\n\n    If Err.Number = 429 Then\n      MsgBox \"Outlook could not be found, aborting.\", 16, \"Outlook Not Found\"\n      Exit Sub\n    End If\n  On Error GoTo 0\n\n  Set OutlookMessage = OutlookApp.CreateItem(0)\n\n  On Error Resume Next\n    With OutlookMessage\n     .To = \"\"\n     .CC = \"\"\n     .BCC = \"\"\n     .Subject = \"This is the letter you requested\"\n     .Body = \"Please let us know if you have any questions.\"\n     .Attachments.Add TempFilePath &amp; TempFileName &amp; \".pdf\"\n     .Display\n    End With\n  On Error GoTo 0\n\n  Kill TempFilePath &amp; TempFileName &amp; \".pdf\"\n\n  Set OutlookMessage = Nothing\n  Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "edited": false, "score": 0, "creation_date": 1476888777, "post_id": 40134775, "comment_id": 67539567, "body": "Thanks- works perfectly, I will tick this as soon as I can!"}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 4, "last_activity_date": 1476888497, "creation_date": 1476888497, "answer_id": 40134775, "question_id": 40134749, "link": "https://stackoverflow.com/questions/40134749/how-to-ignore-name-xxx-already-exists-messages-when-moving-sheets-in-excel-vba/40134775#40134775", "title": "How to ignore &quot;name XXX already exists&quot; messages when moving sheets in excel VBA", "body": "<p>I think you are looking for</p>\n\n<pre><code>Application.DisplayAlerts = False\n    CurrentWorkBook.Sheets(Array(\"Compliance - learning\")).Copy Before:=ActiveWorkbook.Sheets(1)\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7497, "favorite_count": 0, "accepted_answer_id": 40134775, "answer_count": 1, "score": 0, "last_activity_date": 1476888497, "creation_date": 1476888402, "last_edit_date": 1531164843, "question_id": 40134749, "link": "https://stackoverflow.com/questions/40134749/how-to-ignore-name-xxx-already-exists-messages-when-moving-sheets-in-excel-vba", "title": "How to ignore &quot;name XXX already exists&quot; messages when moving sheets in excel VBA", "body": "<p>I am trying to copy from one workbook to another but get a message as I move the sheet that a name already exists.  is there a way to automatically ignore this message? </p>\n\n<p>The message is:\n<a href=\"https://i.stack.imgur.com/zi8Hw.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/zi8Hw.png\" alt=\"enter image description here\"></a> is:</p>\n\n<p>the code for the copy</p>\n\n<pre><code>CurrentWorkBook.Sheets(Array(\"Compliance - learning\")).Copy Before:=ActiveWorkbook.Sheets(1)\n</code></pre>\n"}, {"tags": ["vba", "attributes", "msxml"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476896412, "post_id": 40134692, "comment_id": 67544522, "body": "I don&#39;t think you can do that inline - too many operations involved in creating and attaching the attribute"}], "answers": [{"tags": [], "owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "is_accepted": false, "score": 2, "last_activity_date": 1477272075, "creation_date": 1477272075, "answer_id": 40209522, "question_id": 40134692, "link": "https://stackoverflow.com/questions/40134692/inline-xml-element-attribute-creation-in-msxml2-vba/40209522#40209522", "title": "Inline XML Element Attribute creation in msxml2 VBA", "body": "<p>This isn't \"inline\" I suppose, but hardly a hardship:</p>\n\n<pre><code>Private Sub Tester2()\n    Dim Dom As Object\n\n    Set Dom = CreateObject(\"MSXML2.DOMDocument\")\n    With Dom\n        With .appendChild(.createElement(\"Allocations\"))\n            With .appendChild(Dom.createElement(\"Employee55\"))\n                .Text = \"Test Element Value\"\n                .setAttribute \"EmpID\", \"10\"\n                .setAttribute \"EmpDob\", \"01021986\"\n            End With\n        End With\n        MsgBox .xml\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3825640, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9499a59f8c857a4aee1bd34fb7f6bdc8?s=128&d=identicon&r=PG&f=1", "display_name": "Merlin051", "link": "https://stackoverflow.com/users/3825640/merlin051"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477272075, "creation_date": 1476888249, "question_id": 40134692, "link": "https://stackoverflow.com/questions/40134692/inline-xml-element-attribute-creation-in-msxml2-vba", "title": "Inline XML Element Attribute creation in msxml2 VBA", "body": "<p>I'm working on some VBA to take some excel data and produce some XML which is then passed over to a SQL procedure for further processing.</p>\n\n<p>Unfortunately, I'm having an issue attaching an xml attribute to an element.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>Private Sub Tester()\n\nDim objDom As Object\nSet objDom = CreateObject(\"msxml2.DOMDocument\")\nSet objRootElem = objDom.CreateElement(\"Allocations\")\nobjDom.AppendChild objRootElem\n\nobjRootElem.AppendChild(objDom.CreateElement(\"Employee55\")).Text = \"Test Element Value\"\n\nMsgBox (objDom.XML)\n\nEnd Sub\n</code></pre>\n\n<p>This produces XML that looks like this:</p>\n\n<pre><code>&lt;Allocations&gt;&lt;Employee55&gt;Test Element Value&lt;/Employee55&gt;&lt;/Allocations&gt;\n</code></pre>\n\n<p>However what I'm after is additional attributes against the Employee55 element like this:</p>\n\n<pre><code>&lt;Allocations&gt;&lt;Employee55 EmpID=\"10\" EmpDob=\"01021986\"&gt;Test Element Value&lt;/Employee55&gt;&lt;/Allocations&gt;\n</code></pre>\n\n<p>I know if i declare the Employee object an object, and two additional Attribute objects, I can use Element.SetAttributeNode and pass in the Attribute object.</p>\n\n<p>But in this scenario, its dynamic and I don't have the Element in memory to work this way.</p>\n\n<p>I'm looking for a way to do this inline, much like I've added the .Text value to the Employee55 element.</p>\n\n<p>Any advice?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1476886828, "post_id": 40134019, "comment_id": 67537957, "body": "Sorry I should say what I am trying to do. I am looking to make a separate copy of the workbook for each rep including all of the tabs and if the tabs contain pivot tables (a few of them do) refresh the pivot tables to reflect just that reps data"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1476886986, "post_id": 40134019, "comment_id": 67538108, "body": "<code>UsedRange</code> is never defined as a variable.  If you mean the used range of a specific worksheet, you need to tell it what worksheet you&#39;re interested in: <code>Sheets(1).UsedRange</code> or <code>Sheets(&quot;Sheetname&quot;).UsedRange</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476886992, "post_id": 40134019, "comment_id": 67538113, "body": "<code>For each p in Sheets(&quot;Source&quot;).Range(&quot;AM1&quot;)</code> is just one cell. Do you mean that there&#39;s a range, with sheet names, and you want to get that range, and loop through those names?"}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1476887653, "post_id": 40134019, "comment_id": 67538689, "body": "yes the column AM in sheet &quot;Source&quot;  is where the reps names are and use that list to determine the unique names and create a separate workbook for each name"}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1476888766, "post_id": 40134019, "comment_id": 67539559, "body": "ok I change the range to      &#39; For Each p In Sheets(&quot;Source&quot;).Range(&quot;AM:AM&quot;)&#39; to try and have it look at the whole column"}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1476888885, "post_id": 40134019, "comment_id": 67539651, "body": "and I changed the UsedRange section to     For Each rw In Sheets(&quot;Source&quot;).UsedRange.Rows"}, {"owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "edited": false, "score": 0, "creation_date": 1476888978, "post_id": 40134019, "comment_id": 67539726, "body": "and the error I get now is at the very bottom    Runtime Error 91  Object Variable or With Block Variable not set and it highlights row     personRows.Copy SalesWB.Sheets(1).Cells(1, 1) &#39; Adding data in Excel sheet."}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "edited": false, "score": 0, "creation_date": 1476934596, "post_id": 40134019, "comment_id": 67559630, "body": "That&#39;s because personRows = Nothing, which in turn is because <code>Person = rw.Cells(1, 5)</code> never became True."}], "owner": {"reputation": 11, "user_id": 3276087, "user_type": "registered", "profile_image": "https://graph.facebook.com/559803444/picture?type=large", "display_name": "Mindbender", "link": "https://stackoverflow.com/users/3276087/mindbender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476886727, "creation_date": 1476886727, "last_edit_date": 1495540839, "question_id": 40134019, "link": "https://stackoverflow.com/questions/40134019/splitting-workbook-into-separate-workbooks-including-all-tabs", "title": "Splitting Workbook into separate workbooks including all tabs", "body": "<p>I looked at Bhaskar's code on the post located here (<a href=\"https://stackoverflow.com/questions/31062478/vba-code-to-split-an-excel-file-into-multiple-workbooks-based-on-the-contents-of\">VBA code to split an excel file into multiple workbooks based on the contents of a column?</a>)\nand have modified it to the point where it recognizes the field I need the workbooks split on but I am getting a variable not defined error at the following section</p>\n\n<p>For Each rw In UsedRange.Rows</p>\n\n<p>I appreciate any help you could provide</p>\n\n<p>I have included the code.</p>\n\n<pre><code>Option Explicit\nDim personRows As Range     'Stores all of the rows found\n\n'Split data into separate columns baed on the names defined in\n'a RepList on the 'Names' sheet.\nSub SplitSalesData()\nDim wb As Workbook\nDim p As Range\nDim counter2 As Integer\nDim i As Integer\ncounter2 = 0\ni = 0\nApplication.ScreenUpdating = False\n\n    ' in my case i am generating new excel based on every 8 reacords from begining. You can simplyfy this logic based on your need.\n\n        For Each p In Sheets(\"Source\").Range(\"AM1\") ' Give the name of your input sheet and column\n            If i = 0 Then                              ' We are starting, so generate new excel in memeory.\n                Workbooks.Add\n                Set wb = ActiveWorkbook\n                ThisWorkbook.Activate\n            End If\n            WritePersonToWorkbook wb, p.Value\n            i = i + 1   ' Increment the counter reach time\n            If i = 8 Then   ' As my need is after processing every 8 uniqe record just save the excel sheet and reset the processing\n                counter2 = counter2 + 1\n                wb.SaveAs ThisWorkbook.Path &amp; \"\\salesdata_\" &amp; CStr(counter2)   ' save the data at current directory location.\n                wb.Close\n                Set personRows = Nothing  ' Once the process has completed for curent excelsheet, set the personRows as NULL\n                i = 0\n            End If\n        Next p\n\nApplication.ScreenUpdating = True\nSet wb = Nothing\nEnd Sub\n\n'Writes all the data rows belonging to a RepList\nSub WritePersonToWorkbook(ByVal SalesWB As Workbook, _\n                      ByVal Person As String)\nDim rw As Range\nDim firstRW As Range\n\nFor Each rw In UsedRange.Rows - ***ERROR IS HERE***\n    If Not Not firstRW Is Nothing And Not IsNull(rw) Then\n        Set firstRW = rw  ' WE want to add first row in each excel sheet.\n    End If\n    If Person = rw.Cells(1, 5) Then  ' My filter is working based on \"FeederID\"\n        If personRows Is Nothing Then\n            Set personRows = firstRW\n            Set personRows = Union(personRows, rw)\n        Else\n            Set personRows = Union(personRows, rw)\n        End If\n    End If\nNext rw\npersonRows.Copy SalesWB.Sheets(1).Cells(1, 1) ' Adding data in Excel sheet.\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476887274, "post_id": 40134001, "comment_id": 67538372, "body": "The name actually <i>isn&#39;t</i> the same after it&#39;s been saved - prior to saving it doesn&#39;t have an extension.  You need to use the full path after it&#39;s saved."}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476887804, "post_id": 40134001, "comment_id": 67538816, "body": "Hi Comintern, thanks for the response.   Would this mean changing the above snippet to: GetObject(&quot;Book1.xlsm&quot;).Application or GetObject(&quot;C:\\Users\\Me\\Documents\\Book1.xlsm&quot;).Application  I&#39;ve tried both methods, the first results in the previous error. The second with &quot;File name or class name not found during Automation Operation (0x1B0)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1476887886, "post_id": 40134001, "comment_id": 67538876, "body": "It needs to be the full path - <code>GetObject(&quot;C:\\Users\\Me\\Documents\\Book1.xlsm&quot;)</code>."}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476888217, "post_id": 40134001, "comment_id": 67539152, "body": "Ah, it didn&#39;t work the previous time because I accidentally misspelt part of the file path. Everything seems to work perfectly now, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "is_accepted": true, "score": 0, "last_activity_date": 1476888461, "last_edit_date": 1495535552, "creation_date": 1476888461, "answer_id": 40134763, "question_id": 40134001, "link": "https://stackoverflow.com/questions/40134001/vbs-getobject-will-not-bind-to-saved-workbooks/40134763#40134763", "title": "VBS GetObject will not bind to saved workbooks", "body": "<p>I wasn't sure if I needed to close this question as answered, however, it seems that <a href=\"https://stackoverflow.com/users/4088852/comintern\">https://stackoverflow.com/users/4088852/comintern</a> has resolved the issue.</p>\n\n<blockquote>\n  <p>It needs to be the full path -\n  GetObject(\"C:\\Users\\Me\\Documents\\Book1.xlsm\").</p>\n</blockquote>\n\n<p>Thanks,</p>\n"}], "owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 40134763, "answer_count": 1, "score": 0, "last_activity_date": 1476888461, "creation_date": 1476886693, "question_id": 40134001, "link": "https://stackoverflow.com/questions/40134001/vbs-getobject-will-not-bind-to-saved-workbooks", "title": "VBS GetObject will not bind to saved workbooks", "body": "<p>I'm trying to write a script which will switch to a specific excel workbook and enter keys, however, the script will only run if the workbook which is being referenced is unsaved.</p>\n\n<p>For example:</p>\n\n<p>If I open a new excel workbook which creates a new workbook named \"Book1\"; the following works:</p>\n\n<p>Set xl = GetObject(\"Book1\").Application</p>\n\n<p>If I run the above when the workbook has been saved, even if the name remains the same, the above results in the following error: (0x800401E4).</p>\n\n<p>Is anyone aware of this being a problem, or can anyone point out what I'm doing wrong? I'd guess the error has something to do with the object name being different from the actual file name, so when excel creates the default workbook the code works because the name of the instance is \"Book1\" whereas the saved \"Book1\" is assigned another object name when saved?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476886750, "post_id": 40133757, "comment_id": 67537892, "body": "So after the line <code>n = Chart(Account)</code>, when it sends you into the next sub, what does <code>n</code> become? A value, or nothing? Is the function working at all, or is it setting <code>Chart = [whatever]</code>, but then <code>[whatever]</code> isn&#39;t being recognized in the main sub?"}, {"owner": {"reputation": 27, "user_id": 6819862, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/090f20c7ded60e2fce57ba5560b6bdde?s=128&d=identicon&r=PG&f=1", "display_name": "cpage", "link": "https://stackoverflow.com/users/6819862/cpage"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476887116, "post_id": 40133757, "comment_id": 67538218, "body": "Oh, I realize that this is simply a logic mistake on my part. I should change the <code>Chart = array_count(0)</code> to simply <code>Chart = 0</code>, and it works. This seems like not the best design. Any suggestions?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476887571, "post_id": 40133757, "comment_id": 67538639, "body": "Why aren&#39;t you just passing it around as a parameter? On the same note, why <i>do you</i> pass your global variables as parameters?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476887576, "post_id": 40133757, "comment_id": 67538645, "body": "There are unqualified references in <code>Sub Record</code>.  What <code>Worksheet</code> is being edited but by that subroutine?"}, {"owner": {"reputation": 27, "user_id": 6819862, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/090f20c7ded60e2fce57ba5560b6bdde?s=128&d=identicon&r=PG&f=1", "display_name": "cpage", "link": "https://stackoverflow.com/users/6819862/cpage"}, "edited": false, "score": 0, "creation_date": 1476887895, "post_id": 40133757, "comment_id": 67538880, "body": "Ledger is edited by that Subroutine, though I&#39;ve noticed that it doesn&#39;t work if the worksheet Journal is open when I run it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476888808, "post_id": 40133757, "comment_id": 67539596, "body": "That is because of the unqualified references.  The code will also throw an error if the account isn&#39;t found."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1476889490, "post_id": 40133757, "comment_id": 67540162, "body": "If you can provide a screenshot Worksheets(&quot;Ledger&quot;); I&#39;ll refactor the code for you."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1476888749, "creation_date": 1476888749, "answer_id": 40134876, "question_id": 40133757, "link": "https://stackoverflow.com/questions/40133757/global-array-that-function-can-edit-in-vba/40134876#40134876", "title": "Global Array that Function Can Edit in VBA", "body": "<p>If I realize correctly, your issue is that whenever you run RowInsert() you always get the same values of the array_count(0) (I suppose, that is why you have the debug.prints there).</p>\n\n<p>The reason for this is, that on the line:</p>\n\n<pre><code>array_count = Array(-1, -1, -1)\n</code></pre>\n\n<p>you are reinitiating the array every time (making it look like -1,-1,-1). Am I right?</p>\n"}], "owner": {"reputation": 27, "user_id": 6819862, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/090f20c7ded60e2fce57ba5560b6bdde?s=128&d=identicon&r=PG&f=1", "display_name": "cpage", "link": "https://stackoverflow.com/users/6819862/cpage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1476888749, "creation_date": 1476886113, "last_edit_date": 1476887231, "question_id": 40133757, "link": "https://stackoverflow.com/questions/40133757/global-array-that-function-can-edit-in-vba", "title": "Global Array that Function Can Edit in VBA", "body": "<p>I am working with Excel VBA and am trying to use a global array to keep track of different counts. Different subs and functions are able to access the global array <code>array_count</code>, but my goal is to have function <code>Chart</code> edit the values in the array. Right now, the function's edits to the array do not carry over to the other subs.</p>\n\n<pre><code>' Initialize variables\nPrivate counter As Integer\nPrivate Account As String\n\nPublic array_count As Variant\n\n' Iterate over rows, reading Account\nSub RowInsert()\n\n    array_count = Array(-1, -1, -1)\n\n    Debug.Print array_count(0)\n    Debug.Print array_count(1)\n    Debug.Print array_count(2)\n\n    For counter = 0 To 1\n\n    Account = Worksheets(\"Journal\").Cells(counter + 2, 2)\n\n    Call Record(Account)\n\n    Next counter\n\n    End Sub\n\n    ' Record the transaction in proper T-account \nSub Record(Account As String)\n\n        Dim target_row As Long\n\n        With Worksheets(\"Ledger\").Range(\"a1:c20\")\n\n            Set Header = .Find(Account)\n\n                Debug.Print Account\n\n            If Header Is Nothing Then\n\n                Debug.Print \"Not found.\"\n\n            End If\n\n            Dim n As Integer\n            n = Chart(Account)\n\n            Debug.Print n\n\n            target_row = Header.row + 2 + array_count(n)\n\n            Debug.Print target_row\n\n            Rows(target_row).Insert Shift:=xlDown\n\n            Cells(target_row - 1, 1) = Worksheets(\"Journal\").Cells(counter + 2, 1).Value\n\n                Debug.Print counter\n\n            If IsEmpty(Worksheets(\"Journal\").Cells(counter + 2, 3)) Then\n\n                Cells(target_row - 1, 3) = Worksheets(\"Journal\").Cells(counter + 2, 4).Value\n\n            Else\n\n                Cells(target_row - 1, 2) = Worksheets(\"Journal\").Cells(counter + 2, 3).Value\n\n            End If\n\n        End With\n\n    End Sub\n\n    ' Count the number of entries in each T-account\n    Function Chart(Account As String) As Integer\n\n    If Account = \"Cash\" Then\n\n        array_count(0) = array_count(0) + 1\n        Chart = array_count(0)\n\n\n    ElseIf Account = \"Equipment\" Then\n\n        array_count(1) = array_count(1) + 1\n        Chart = array_count(1)\n\n        Debug.Print array_count(1)\n\n\n    End If\n\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "escaping", "wildcard"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1476885641, "post_id": 40133451, "comment_id": 67536976, "body": "Sounds odd, but try finding <code>&quot;~*~*&quot;</code>"}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1476885869, "post_id": 40133451, "comment_id": 67537173, "body": "Just found the same solution by googling some more, and came back to update my answer. It works."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1476885924, "post_id": 40133451, "comment_id": 67537216, "body": "@BruceWayne: Why this sounds odd? It&#39;s documented here: <a href=\"https://support.microsoft.com/en-us/kb/214138\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/214138</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1476885994, "post_id": 40133451, "comment_id": 67537272, "body": "@AxelRichter - I didn&#39;t realize it was documented. Thanks for that!"}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "is_accepted": true, "score": 1, "last_activity_date": 1476967394, "creation_date": 1476967394, "answer_id": 40154832, "question_id": 40133451, "link": "https://stackoverflow.com/questions/40133451/vba-how-to-search-for-using-find/40154832#40154832", "title": "VBA: How to search for * using Find?", "body": "<p>Wildcard (*) can be escaped using tilde (~), this can thus be solved like this:</p>\n\n<pre><code>Set searchRange = Workbooks(fileName).Worksheets(1).Range(\"B:B\").Find(\"~*~*\", LookAt:=xlWhole)\n</code></pre>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/214138/\" rel=\"nofollow\">Official source, posted by Axel Richter in comments</a></p>\n"}], "owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 40154832, "answer_count": 1, "score": -1, "last_activity_date": 1476967394, "creation_date": 1476885380, "last_edit_date": 1476885950, "question_id": 40133451, "link": "https://stackoverflow.com/questions/40133451/vba-how-to-search-for-using-find", "title": "VBA: How to search for * using Find?", "body": "<p>I am trying to search for the string ** in a column in a worksheet, but I have trouble making this work as * also works as a wildcard when using find. To complicate it further the same column also includes *, so I need to find ** specifically. I have tried the below code so far, and in both cases it appears to find the first non-empty cell, which happens to be *.</p>\n\n<pre><code>Set searchRange = Workbooks(fileName).Worksheets(1).Range(\"B:B\").Find(Chr(42) &amp; Chr(42), LookAt:=xlWhole)\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>Set searchRange = Workbooks(fileName).Worksheets(1).Range(\"B:B\").Find(\"**\", LookAt:=xlWhole)\n</code></pre>\n\n<p>I have used Chr() succesfully to escape \" many times before, but it does not seem to work here. I have googled for solutions, but this solution is the only answer I have found so far, which does not work.</p>\n\n<p>An alternative solution might be to loop through the range and do a string comparison. This feels like a rather ugly solution though.</p>\n\n<p>EDIT: Was easier than I thought. Apparently this works:</p>\n\n<pre><code>Set searchRange = Workbooks(fileName).Worksheets(1).Range(\"B:B\").Find(\"~*~*\", LookAt:=xlWhole)\n</code></pre>\n"}, {"tags": ["vba", "excel", "validation", "passwords"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1476886154, "post_id": 40133375, "comment_id": 67537386, "body": "For what it&#39;s worth, your <code>If...Or</code> statements aren&#39;t doing anything. I think you mean <code>If...And</code>. As it is, all values of i, j, and k will satisfy the situations."}, {"owner": {"reputation": 13, "user_id": 7042678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pqgkxRcsubA/AAAAAAAAAAI/AAAAAAAAQp8/kD58Gc1b7rw/photo.jpg?sz=128", "display_name": "B&#225;rbara Pereira", "link": "https://stackoverflow.com/users/7042678/b%c3%a1rbara-pereira"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1476886474, "post_id": 40133375, "comment_id": 67537675, "body": "&quot;If...And&quot; doesn&#39;t work either..."}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1476886516, "post_id": 40133375, "comment_id": 67537707, "body": "I see now what you were trying to do; you should use <code>For</code> loops, not <code>If</code> statements."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1476886526, "post_id": 40133375, "comment_id": 67537716, "body": "<a href=\"http://security.stackexchange.com/a/32223/39867\">Must read</a> - TL;DR: password length is all that matters."}, {"owner": {"reputation": 13, "user_id": 7042678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pqgkxRcsubA/AAAAAAAAAAI/AAAAAAAAQp8/kD58Gc1b7rw/photo.jpg?sz=128", "display_name": "B&#225;rbara Pereira", "link": "https://stackoverflow.com/users/7042678/b%c3%a1rbara-pereira"}, "edited": false, "score": 0, "creation_date": 1476886584, "post_id": 40133375, "comment_id": 67537753, "body": "Like that?      For i = 65 To 90     For j = 97 To 122     For k = 48 To 57"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1476887174, "post_id": 40133375, "comment_id": 67538272, "body": "Just like that! See my answer below for more clarification."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 13, "user_id": 7042678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pqgkxRcsubA/AAAAAAAAAAI/AAAAAAAAQp8/kD58Gc1b7rw/photo.jpg?sz=128", "display_name": "B&#225;rbara Pereira", "link": "https://stackoverflow.com/users/7042678/b%c3%a1rbara-pereira"}, "edited": false, "score": 0, "creation_date": 1476887737, "post_id": 40134221, "comment_id": 67538755, "body": "I&#39;m glad it does. If you are happy with it please mark my answer as correct and close the question."}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 2, "last_activity_date": 1476887564, "last_edit_date": 1476887564, "creation_date": 1476887150, "answer_id": 40134221, "question_id": 40133375, "link": "https://stackoverflow.com/questions/40133375/vba-validate-if-my-password-contais-1-number-1-ucase-and-1-lcase/40134221#40134221", "title": "VBA - Validate if my password contais 1 number, 1 ucase and 1 lcase", "body": "<p>It looked like you were trying to do too much at once. There is nothing terribly wrong with splitting up the code a bit. Many times it makes it easier to read and understand what is going on.</p>\n\n<pre><code>Sub Password()\n\nDim b As Integer\nDim i As Integer, j As Integer, k As Integer\nDim psw As String\n\nDim hasNum As Boolean, hasUpper As Boolean, hasLower As Boolean\n\nDim LengthOFPasswordsList As Long\n\nLengthOFPasswordsList = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nFor b = 3 To LengthOFPasswordsList\n    'assume the password is no good.\n    hasNum = False\n    hasUpper = False\n    hasLower = False\n\n    'capture the psw in question\n    psw = Range(\"D\" &amp; b)\n\n    'see if there is a number in the password\n    'NOTE: the following For loops uses the ASCII values for numbers and letters.\n    For k = 48 To 57\n        If (InStr(1, psw, Chr(k))) Then\n            hasNum = True\n            Exit For\n        End If\n    Next k\n\n    'See if there is an upper case\n    For i = 65 To 90\n        If (InStr(1, psw, Chr(i))) Then\n            hasUpper = True\n            Exit For\n        End If\n    Next i\n\n    'See if there is a lower case\n    For j = 97 To 122\n        If (InStr(1, psw, Chr(j))) Then\n            hasLower = True\n            Exit For\n        End If\n    Next j\n\n    'See if all criteria was met\n    If Not hasLower Or Not hasUpper Or Not hasNum Or (Len(psw) &lt;&gt; 8) Then\n        Range(\"F\" &amp; b) = \"Password Inv\u00e1lida\"\n    End If\nNext b\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 2, "last_activity_date": 1476887896, "creation_date": 1476887896, "answer_id": 40134540, "question_id": 40133375, "link": "https://stackoverflow.com/questions/40133375/vba-validate-if-my-password-contais-1-number-1-ucase-and-1-lcase/40134540#40134540", "title": "VBA - Validate if my password contais 1 number, 1 ucase and 1 lcase", "body": "<p>How about something like this and use the built in functionality:</p>\n\n<pre><code>Sub PasswordCheck ()\nDim bNum as Boolean, bUpper as Boolean, bLower as Boolean\nDim lRow as Long, x as Long\nDim i as Integer\nDim sPWD as String\n\n  lRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n  For x = 1 to lRow         'Go through each Password\n    bNum = False\n    bUpper = False\n    bLower = False\n    sPWD = Range(\"D\" &amp; x)\n    For i = 1 to Len(sPWD)  'Go through each letter\n      If IsNumeric(Mid(sPWD, i, 1) Then\n        bNum = True\n      ElseIf Mid(sPWD, i, 1) Like \"[A-Z]\" Then\n        bUpper = True\n      ElseIf Mid(sPWD, i, 1) Like \"[a-z]\" Then\n        bLower = True\n      End If\n    Next i\n\n    If bNum And bUpper And bLower Then\n      'Password is valid\n    Else\n      'Password is Invalid\n      Range(\"F\" &amp; x) = \"Password Inv\u00e1lida\"\n    End If\n  Next x\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1476889624, "creation_date": 1476889624, "answer_id": 40135261, "question_id": 40133375, "link": "https://stackoverflow.com/questions/40133375/vba-validate-if-my-password-contais-1-number-1-ucase-and-1-lcase/40135261#40135261", "title": "VBA - Validate if my password contais 1 number, 1 ucase and 1 lcase", "body": "<p>I'd personally use regular expressions for this. Just check for each of your criteria and fail the password if any of them don't match. The validation function can be as simple as this:</p>\n\n<pre><code>'Requires a reference to Microsoft VBScript Regular Expressions x.x\nPrivate Function ValidPassword(inValue As String) As Boolean\n    Dim criteria As Variant\n    With New RegExp\n        For Each criteria In Split(\".{8},[A-Z],[a-z],[0-9]\", \",\")\n            .Pattern = criteria\n            If Not .Test(inValue) Then Exit Function\n        Next\n    End With\n    ValidPassword = True\nEnd Function\n</code></pre>\n\n<p>This also hugely simplifies the calling code:</p>\n\n<pre><code>Sub Password()\n    Dim b As Integer\n    For b = 3 To Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n        If Not ValidPassword(Range(\"D\" &amp; b)) Then\n            Range(\"F\" &amp; b) = \"Password Inv\u00e1lida\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7042678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pqgkxRcsubA/AAAAAAAAAAI/AAAAAAAAQp8/kD58Gc1b7rw/photo.jpg?sz=128", "display_name": "B&#225;rbara Pereira", "link": "https://stackoverflow.com/users/7042678/b%c3%a1rbara-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 40134221, "answer_count": 3, "score": 1, "last_activity_date": 1476889624, "creation_date": 1476885138, "last_edit_date": 1476885896, "question_id": 40133375, "link": "https://stackoverflow.com/questions/40133375/vba-validate-if-my-password-contais-1-number-1-ucase-and-1-lcase", "title": "VBA - Validate if my password contais 1 number, 1 ucase and 1 lcase", "body": "<p>I have a set of passwords and I need to verify for each one if it contains 1 number, 1 upper case, 1 lower case and if the length is 8 characters.</p>\n\n<p>I made this code but it isn't working for the characters, only for the length.\nCan you help me, please? Thanks!!</p>\n\n<pre><code>Sub Password()\n\n    Dim b As Integer\n    Dim i As Integer, j As Integer, k As Integer\n    Dim psw As String\n\n    Dim LengthOFPasswordsList As Long\n\n    LengthOFPasswordsList = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\n    For b = 3 To LengthOFPasswordsList\n        psw = Range(\"D\" &amp; b)\n\n        If i &gt;= 65 Or i &lt;= 90 Then\n            If j &gt;= 97 Or j &lt;= 122 Then\n                If k &gt; 48 Or k &lt;= 57 Then\n                    If psw &lt;&gt; (Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(i Or j Or k) _\n                    &amp; Chr(i Or j Or k) &amp; Chr(i Or j Or k) &amp; Chr(i Or j Or k)) _\n                    And Len(psw) &lt;&gt; 8 Then\n                        Range(\"F\" &amp; b) = \"Password Inv\u00e1lida\"\n                    End If\n                End If\n            End If\n        End If\n    Next b\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1476884310, "post_id": 40132943, "comment_id": 67535832, "body": "Your code works for me without issue.  Try your code in a new workbook and see if it works."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 3, "creation_date": 1476884600, "post_id": 40133063, "comment_id": 67536064, "body": "if you are fully qualifying ranges, you might want to qualify the final range (last line) as well. <code>Sheets(&quot;MySheetNameHere&quot;).Range(&quot;F27&quot;) = SumTotal</code>"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1476889550, "last_edit_date": 1476889550, "creation_date": 1476884431, "answer_id": 40133063, "question_id": 40132943, "link": "https://stackoverflow.com/questions/40132943/microsoft-excel-vba-sum-function-not-working/40133063#40133063", "title": "Microsoft Excel VBA sum function not working", "body": "<p>My guess is that you're not specifying the sheet correctly, try the below</p>\n\n<pre><code>Private Sub TextTotal1_Functions()\n\nDim SumTotal As Long\n\nSumTotal = Application.WorksheetFunction.Sum(Sheets(\"MySheetNameHere\").Range(\"F9:F26\"))\n\nSheets(\"MySheetNameHere\").Range(\"F27\") = SumTotal\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1476885034, "creation_date": 1476885034, "answer_id": 40133333, "question_id": 40132943, "link": "https://stackoverflow.com/questions/40132943/microsoft-excel-vba-sum-function-not-working/40133333#40133333", "title": "Microsoft Excel VBA sum function not working", "body": "<p>What I usually do when I use WorksheetFunction in VBA, is to write something like this in the immediate window:</p>\n\n<pre><code>?WorksheetFunction.Sum(selection)\n</code></pre>\n\n<p>and to see whether I am getting what I am expecting from the selection.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8678512, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/974b893367f17f0d6e02a8de6e60c55e?s=128&d=identicon&r=PG", "display_name": "Tauseef", "link": "https://stackoverflow.com/users/8678512/tauseef"}, "is_accepted": false, "score": 0, "last_activity_date": 1506451872, "last_edit_date": 1506451872, "creation_date": 1506451502, "answer_id": 46433677, "question_id": 40132943, "link": "https://stackoverflow.com/questions/40132943/microsoft-excel-vba-sum-function-not-working/46433677#46433677", "title": "Microsoft Excel VBA sum function not working", "body": "<p>Might be the Calculation is set to Manual, so set it back to Automatic:</p>\n\n<pre><code>Application.calcualtion = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6494737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BxQVPmsC63I/AAAAAAAAAAI/AAAAAAAAAZQ/6dnrZK1fnT8/photo.jpg?sz=128", "display_name": "efan787", "link": "https://stackoverflow.com/users/6494737/efan787"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1506451872, "creation_date": 1476884137, "question_id": 40132943, "link": "https://stackoverflow.com/questions/40132943/microsoft-excel-vba-sum-function-not-working", "title": "Microsoft Excel VBA sum function not working", "body": "<p>When i run the code i want the answer of the sum to be displayed in the cell (F 27). </p>\n\n<p>But the sum function does not work nothing is printed into the cells when i run the code. I don't get any errors what so ever.</p>\n\n<p>This is my code </p>\n\n<pre><code>Private Sub TextTotal1_Functions()\n\nDim SumTotal As Long\n\nSumTotal = WorksheetFunction.Sum(Range(\"F9:F26\"))\n\nRange(\"F27\") = SumTotal\n</code></pre>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476884004, "post_id": 40132725, "comment_id": 67535613, "body": "I think you need to adjust <code>Tp</code>. Iirc the values are relative to the worksheet, not the active cell."}, {"owner": {"reputation": 19, "user_id": 6730964, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-7v-2t5opjc4/AAAAAAAAAAI/AAAAAAAAABc/ftAZ_jFuIvU/photo.jpg?sz=128", "display_name": "Desi D", "link": "https://stackoverflow.com/users/6730964/desi-d"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476884848, "post_id": 40132725, "comment_id": 67536258, "body": "I&#39;m sorry but I am a total novice.. could you elaborate a bit about how I should change Tp? I am not understanding how I would adjust it to work for this scenario... I&#39;m sorry. Thank you though!"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476886073, "post_id": 40132725, "comment_id": 67537324, "body": "You never change <code>Lft</code> and <code>Tp</code> so your pictures are all inserted at the same position. You need to update them according to your intentions (which I am not sure about). Since you probably want the pictures to be beneath each other you only need to update <code>Tp</code>"}, {"owner": {"reputation": 19, "user_id": 6730964, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-7v-2t5opjc4/AAAAAAAAAAI/AAAAAAAAABc/ftAZ_jFuIvU/photo.jpg?sz=128", "display_name": "Desi D", "link": "https://stackoverflow.com/users/6730964/desi-d"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476886654, "post_id": 40132725, "comment_id": 67537808, "body": "You were absolutely right!!!! Could you please answer the question so I could mark you as correct??? THANK YOU SO MUCH!!"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1476886836, "creation_date": 1476886836, "answer_id": 40134080, "question_id": 40132725, "link": "https://stackoverflow.com/questions/40132725/excel-macro-that-embeds-images-is-having-trouble-looping/40134080#40134080", "title": "Excel Macro that embeds images is having trouble looping", "body": "<p>At the line</p>\n\n<pre><code>Application.ActiveSheet.Shapes.AddPicture(..., msoFalse, msoTrue, Lft, Tp, Wdth, Hgth)\n</code></pre>\n\n<p>the coordinates <code>Lft</code> and <code>Tp</code> are relative to the sheet, not the active cell. So you need to update them for each picture, i.e. move the line <code>Tp = Cells(pictureRow, picturePasteColumn).Top + 3</code> into the loop.</p>\n"}], "owner": {"reputation": 19, "user_id": 6730964, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-7v-2t5opjc4/AAAAAAAAAAI/AAAAAAAAABc/ftAZ_jFuIvU/photo.jpg?sz=128", "display_name": "Desi D", "link": "https://stackoverflow.com/users/6730964/desi-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 40134080, "answer_count": 1, "score": 0, "last_activity_date": 1476886836, "creation_date": 1476883498, "last_edit_date": 1495541795, "question_id": 40132725, "link": "https://stackoverflow.com/questions/40132725/excel-macro-that-embeds-images-is-having-trouble-looping", "title": "Excel Macro that embeds images is having trouble looping", "body": "<p>An AMAZING user helped me to embed images vs. inserting images, so that when users use the macro to insert images and then send the workbook to others, the images would show.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/40028899/excel-macro-places-images-but-they-do-not-appear-when-others-open-the-workbook\">Link to the question</a></p>\n\n<p>I edited it to work for me and it for the most part, worked like a dream!</p>\n\n<p>But now for the life of me, I cannot get this thing to loop properly. The images just pile one on top of each other. I read one other question on here that says it is related to resetting the path, but I am not sure how to do that, despite messing around a bit. </p>\n\n<pre><code>Dim repPic As Shape\nDim pictureNameColumn As Long\nDim picturePasteColumn As Long\nDim pictureColumn As Long\nDim pictureName As String\nDim lastPictureRow As Long\nDim pictureRow As Long\nDim pathForPicture As String\nDim Lft As Single\nDim Tp As Single\nDim Wdth As Single\nDim Hgth As Single\npictureNameColumn = 8\npicturePasteColumn = 2\npictureRow = 4\npictureColumn = 8\nlastPictureRow = Cells(Rows.Count, pictureNameColumn).End(xlUp).Row\nApplication.ScreenUpdating = False\npathForPicture = \"C:\\Users\\desid\\images\\\"\nLft = Cells(pictureRow, picturePasteColumn).Left + 30\nTp = Cells(pictureRow, picturePasteColumn).Top + 3\nWdth = Cells(pictureRow, picturePasteColumn).Width\nHgth = Cells(pictureRow, picturePasteColumn).Height\nDo While (pictureRow &lt;= lastPictureRow)\npictureName = Cells(pictureRow, pictureColumn)\n\nIf (pictureName &lt;&gt; vbNullString) Then\nIf (Dir(pathForPicture &amp; pictureName &amp; \".jpg\") &lt;&gt; vbNullString) Then\nCells(pictureRow, picturePasteColumn).Select\nSet repPic = Application.ActiveSheet.Shapes.AddPicture(pathForPicture &amp;             pictureName &amp; \".jpg\", msoFalse, msoTrue, Lft, Tp, Wdth, Hgth)\nrepPic.Width = 90\nrepPic.Height = 90\nElse\nCells(pictureRow, picturePasteColumn) = \"No Picture Found\"\nEnd If\nElse\nEnd If\npictureRow = pictureRow + 1\nLoop\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access", "stored-procedures"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476890161, "post_id": 40132544, "comment_id": 67540658, "body": "you are executing command and then assigning parameter value. what logic is that? (ps: executing cmd will return recordset)"}, {"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1476892279, "post_id": 40132544, "comment_id": 67542066, "body": "well spotted - must of been a copy and paste error.  amended, but still same error."}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476892245, "creation_date": 1476883086, "last_edit_date": 1476892245, "question_id": 40132544, "link": "https://stackoverflow.com/questions/40132544/access-fe-sql-be-odbc-call-failed-and-object-invalid-or-no-longer-set-with-store", "title": "Access FE SQL BE ODBC Call Failed and Object Invalid or No Longer Set with Stored Procedure", "body": "<p>I'm using Access 13 frontend with a SQL 2012 backend.  I call a stored procedure from Access using the below code and receive the message 'ODBC Call Failed'.  After that I then receive the message 'Object Invalid or No Longer Set'  The strange thing is, it returns the correct data from SQL server then produces the error.  When I click ok, I can continue to call the SP without any further errors until Access is closed\\re-opened.  Below is my VBA code (in debug it produces the error on: <code>Set Me!lstItems.Recordset = rs</code></p>\n\n<p>Also, if connected on the network, it works fine, if connecting via a VPN, the error occurs.  We have checked everything we can on the VPN to no avail - any ideas?</p>\n\n<pre><code>Private Sub cmdSearch_Click()\nOn Error GoTo cmdSearch_Click_Error\n\nIf IsNull(Me.txtSearch) Then\nMsgBox \"Please enter a value to search\", vbInformation\nElse\n\nDoCmd.Hourglass True\nSet CN = New ADODB.Connection\n\nCN.ConnectionString = \"DRIVER=SQL Server;SERVER=XXXXXXXXXXX;Database=XXXXXXXXXXXXXX;Trusted_Connection=YES;\"\n\nCN.Open\n    Set cmd = New ADODB.Command\n    With cmd\n        .ActiveConnection = CN\n        .CommandText = \"dbo.PVXSearch\"\n        .CommandType = adCmdStoredProc\n        Set prm = .CreateParameter(\"@Search\", adVarWChar, adParamInput, 50)\n    prm.Value = Me.txtSearch\n    .Parameters.Append prm\n    cmd.Execute\n\n  End With\n\n   Set rs = New ADODB.Recordset\n   With rs\n       .CursorLocation = adUseClient\n       .CursorType = adOpenStatic\n        .LockType = adLockReadOnly\n        .Open cmd\n    End With\n\n    Set Me!lstItems.Recordset = rs\n\n    Me.lstItems.Requery\n\n    Set prm = Nothing\n    Set cmd = Nothing\n    Set rs = Nothing\n\n\n    DoCmd.Hourglass False\n\nEnd If\nOn Error GoTo 0\nExit Sub\ncmdSearch_Click_Error:\nMsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure cmdSearch_Click of VBA Document Form_frmWebOrder - Please take a screenshot and email XXXXXXXXXXXXXXXXXX\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "protected-mode", "xlsm", "vba"], "owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 512, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1601516965, "creation_date": 1476882190, "last_edit_date": 1531161705, "question_id": 40132197, "link": "https://stackoverflow.com/questions/40132197/excel-xlsm-opens-in-protected-view-but-crashes-in-regular-view-upon-opening", "title": "Excel - .xlsm opens in Protected View, but crashes in regular view upon opening", "body": "<p>I have an Excel file that crashes when I try to open it regularly, but it somehow opens in protected view. It's strange because it was working fine yesterday. Then I restarted my computer, and reopened the sheet, and it crashed upon opening. I can open other files fine.</p>\n\n<p>Then I opened it in protected view, and it didn't crash. But of course, I can't work like that, so I click enable editing, and it crashes again. What am I doing wrong?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "macros"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 0, "last_activity_date": 1476948479, "creation_date": 1476948479, "answer_id": 40148059, "question_id": 40132133, "link": "https://stackoverflow.com/questions/40132133/elapsed-time-in-access-using-record-above/40148059#40148059", "title": "Elapsed Time in Access using record above", "body": "<p>In other DBMS systems, retrieving values from either the previous row or the next row is accomplished via <code>LAG</code> or <code>LEAD</code> functions. Access does not support those functions, but you can accomplish the same thing using subqueries. See the sample SQL below, in which I have assumed that the name of your table is \"TableName\".</p>\n\n<p>You didn't mention the unit in which you would like to display the elapsed time, or whether each row should be compared to the previous row or the next row. So here, both comparisons are done, and elapsed time is displayed in seconds.</p>\n\n<pre><code>SELECT t.M\n     , t.[Qty TStamp]\n     , t.DStamp\n     , (SELECT TOP 1 t1.DStamp\n        FROM TableName t1 \n        WHERE t1.DStamp &lt; t.DStamp\n        ORDER BY t1.DStamp DESC\n       ) AS PreviousDStamp\n     , (SELECT TOP 1 t2.DStamp\n        FROM TableName t2\n        WHERE t2.DStamp &gt; t.DStamp\n        ORDER BY t2.DStamp\n       ) AS NextDStamp\n      , DateDiff(\"s\", PreviousDStamp, t.DStamp) AS Seconds_From_Previous\n      , DateDiff(\"s\", t.DStamp, NextDStamp) AS Seconds_To_Next\nFROM TableName t\nORDER BY t.DStamp\n;\n</code></pre>\n\n<p>Please note that even though your question mentioned comparing only the time values, this SQL actually compares the full date/time values (i.e. the <code>DStamp</code> column). This way, your data will be accurate even if the date changes between rows.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476954925, "creation_date": 1476954925, "answer_id": 40150226, "question_id": 40132133, "link": "https://stackoverflow.com/questions/40132133/elapsed-time-in-access-using-record-above/40150226#40150226", "title": "Elapsed Time in Access using record above", "body": "<p>It isn't that difficult:</p>\n\n<pre><code>Select *,\n    (Select Max(T.DStamp)\n    From YourTable As T\n    Where T.DStamp &lt; YourTable.DStamp) As LastDStamp\nFrom YourTable\n</code></pre>\n\n<p>or the other way around:</p>\n\n<pre><code>Select *,\n    (Select Min(T.DStamp)\n    From YourTable As T\n    Where T.DStamp &gt; YourTable.DStamp) As NextDStamp\nFrom YourTable\n</code></pre>\n\n<p>If you need the timepart only:</p>\n\n<pre><code>Select *,\n    (Select TimeValue(Max(T.DStamp))\n    From YourTable As T\n    Where T.DStamp &lt; YourTable.DStamp) As LastTStamp\nFrom YourTable\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6920773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6426cbb5ebd5e2bcdad8ff82f8ca4f5?s=128&d=identicon&r=PG&f=1", "display_name": "RBC Kyle Bullard", "link": "https://stackoverflow.com/users/6920773/rbc-kyle-bullard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476954925, "creation_date": 1476882038, "last_edit_date": 1476950583, "question_id": 40132133, "link": "https://stackoverflow.com/questions/40132133/elapsed-time-in-access-using-record-above", "title": "Elapsed Time in Access using record above", "body": "<pre><code>    M   Qty TStamp  DStamp\nVF6 1   11:34:38 AM 8/11/2016 11:34:38 AM\nVF6 1   1:06:01 PM  8/11/2016 1:06:01 PM\nVF6 1   2:16:30 PM  8/11/2016 2:16:30 PM\nVF6 1   3:30:20 PM  8/11/2016 3:30:20 PM\nVF6 1   4:03:48 PM  8/11/2016 4:03:48 PM\nVF6 1   4:52:23 PM  8/11/2016 4:52:23 PM\nVF6 1   11:06:31 PM 8/11/2016 11:06:31 PM\nVF6 1   12:23:23 AM 8/12/2016 12:23:23 AM\nVF6 1   1:23:26 AM  8/12/2016 1:23:26 AM\nVF6 1   2:43:20 AM  8/12/2016 2:43:20 AM\nVF6 1   3:40:12 AM  8/12/2016 3:40:12 AM\nVF6 1   4:40:09 AM  8/12/2016 4:40:09 AM\nVF6 1   5:38:44 AM  8/12/2016 5:38:44 AM\nVF6 1   6:52:05 AM  8/12/2016 6:52:05 AM\nVF6 1   8:00:43 AM  8/12/2016 8:00:43 AM\n</code></pre>\n\n<p>Above is some sample data.\nI am wanting to get the elapsed times between records. For example I would like to know the elapsed time from:</p>\n\n<pre><code>11:34:38 AM and 1:06:01 PM\n</code></pre>\n\n<p>It's fairly simple if the fields are in the same record, but i am having difficulties using above information to generate the elapsed time. Any guidance will be a big help.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1476881585, "post_id": 40131941, "comment_id": 67533800, "body": "the <code>Dim Sominha As String</code> shouldn&#39;t be there, can anyone edit?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1476882661, "post_id": 40132235, "comment_id": 67534619, "body": "The thing is that if I create a loop it will take ages to finish, as the sheet is huge. Is it possible, then, to check if the sum of that column = 0, <code>Then Columns(&quot;E:E&quot;).Hidden = True</code>?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1476887431, "post_id": 40132235, "comment_id": 67538511, "body": "Take a look at the <code>CountA</code> <a href=\"https://www.techonthenet.com/excel/formulas/counta.php\" rel=\"nofollow noreferrer\">documentation</a>. This function will tell you if the cells in the range are empty -- if the range is empty, the the function returns zero (because there are zero non-blank cells in the range). Then yes, you can hide column E if you like based on that result."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1476882265, "creation_date": 1476882265, "answer_id": 40132235, "question_id": 40131941, "link": "https://stackoverflow.com/questions/40131941/testing-wether-column-values-is-0-then/40132235#40132235", "title": "Testing wether column values is =0, Then", "body": "<p>You're getting a <code>Range</code> error because your range reference is incorrectly formed. And you can't check an entire <code>Range</code> against a single value unless you create a loop. You can make the check with a worksheet function:</p>\n\n<pre><code>If WorksheetFunction.CountA(Range(\"E:E\")) = 0 Then \n    Debug.Print \"Column is empty\" \nElse \n    Debug.Print \"Column is not empty\" \nEnd If \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1476891113, "post_id": 40132353, "comment_id": 67541310, "body": "I&#39;m trying to modify this code to use it with a loop, why doesn&#39;t the following work?: <code>Sub Hide()     Dim r As Range     Dim col As Range          l = 3      Set r = Range(&quot;E3:E1549&quot;)     Set col = Columns(&quot;l&quot;)      If Application.WorksheetFunction.CountBlank(r) = r.Count Then         col.Hidden = True     End If End Sub</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1476882607, "creation_date": 1476882607, "answer_id": 40132353, "question_id": 40131941, "link": "https://stackoverflow.com/questions/40131941/testing-wether-column-values-is-0-then/40132353#40132353", "title": "Testing wether column values is =0, Then", "body": "<p>This is similar to the test you would perform in the worksheet:</p>\n\n<pre><code>Sub Hide()\n    Dim r As Range\n\n    Set r = Range(\"E3:E1549\")\n\n    If Application.WorksheetFunction.CountBlank(r) = r.Count Then\n        Columns(\"E:E\").Hidden = True\n    End If\nEnd Sub\n</code></pre>\n\n<p><em>COUNTBLANK() counts empty cells, cells containing NULL, and cells containing formulas returning NULL.</em></p>\n"}], "owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 40132353, "answer_count": 2, "score": 0, "last_activity_date": 1476882607, "creation_date": 1476881550, "last_edit_date": 1476882130, "question_id": 40131941, "link": "https://stackoverflow.com/questions/40131941/testing-wether-column-values-is-0-then", "title": "Testing wether column values is =0, Then", "body": "<p>I'm trying to use the below code to check if a column is empty, and if it is, it should be deleted, but it gives me a Range Error. What am I doing wrong?</p>\n\n<pre><code>Sub Hide()\n\n\n   If Range(E3, E1549) = \"\" Then\n\n      Columns(\"E:E\").Hidden = True\n\n      End If\n\n      End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476891309, "post_id": 40131721, "comment_id": 67541437, "body": "Short answer is that you can&#39;t - error handling is per process. What about just adding a custom property to <code>ThisWorkbook</code> that allows you to request the error count\\items from the &quot;Refresh Instance&quot; after it completes?"}, {"owner": {"reputation": 155, "user_id": 3711840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cr6aG.jpg?s=128&g=1", "display_name": "SliderSteve", "link": "https://stackoverflow.com/users/3711840/slidersteve"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1476893628, "post_id": 40131721, "comment_id": 67542971, "body": "Well that&#39;s annoying but thanks for confirming that. Can you explain how I&#39;d go about requesting the error count\\items from the Refresh instance please?"}], "owner": {"reputation": 155, "user_id": 3711840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cr6aG.jpg?s=128&g=1", "display_name": "SliderSteve", "link": "https://stackoverflow.com/users/3711840/slidersteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476880960, "creation_date": 1476880960, "question_id": 40131721, "link": "https://stackoverflow.com/questions/40131721/vba-to-capture-errors-in-a-seperate-excel-instance", "title": "VBA to capture errors in a seperate excel instance", "body": "<p>I have written a VBA procedure which opens, refreshes, saves and closes a large number of excel files containing pivot tables. The code loops through each report in turn, opening it up in a <strong>separate excel instance</strong> and refreshing it as well as other tasks. I have an error handler to capture errors produced if it can't find the file and if the file is read-only but I am trying to extend it capture errors which may be produced during the refresh/save steps.</p>\n\n<p>The problem is that as these errors occur in the \"Refresh instance\" of Excel whilst the errorhandler is in the \"Control instance\" of Excel it doesn't catch them. Does anyone know how to catch errors in another excel instance?</p>\n\n<pre><code>Errorhandler:\n\nerrorText = StandardPivots(1, myIndex)\nFailed(failedIndex) = errorText\nfailedIndex = failedIndex + 1\nobjXL.Application.DisplayAlerts = False\nobjXL.Quit\n\nResume Next\nEnd Sub\n</code></pre>\n\n<p><strong>StandardPivots</strong> is a variant which holds the reports to be refreshed.\n<strong>Failed</strong> is a array string which will hold the list of errored files\n<strong>objXL</strong> refers to my \"Refresh Instance\" of Excel</p>\n\n<p>It needs to be in a separate Excel instance as I have a method where the user can shut down the process which needs to be accessible at all times (not locked like it would be if a file was refreshing)</p>\n\n<p>Just in case it's useful. Here is how I handle the errors at the end:</p>\n\n<pre><code>If failedIndex = 0 Then\n   OutputMsg = \"All \" &amp; RefreshType &amp; \" Pivots Refreshed\"\n   ActiveWorkbook.Sheets(\"Control\").Range(\"E25\").Value = OutputMsg 'Just in case e-mail process fails, pivots which failed are output to excel\n   Produce_Email\nElse\n    For x = 0 To failedIndex - 1\n    OutputMsg = OutputMsg + Failed(x) &amp; \", \"\n    Next x\nOutputMsg = Left(OutputMsg, Len(OutputMsg) - 2)\nActiveWorkbook.Sheets(\"Control\").Range(\"E25\").Value = OutputMsg\nProduce_Email ' Main module\n</code></pre>\n\n<p>Let me know if you need anything else from me? </p>\n\n<p>Thanks for any help you can provide.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476880785, "post_id": 40131499, "comment_id": 67533186, "body": "Do you mean it goes to the next row?  Your click event finds the last row in column A and then adds the text to the next row down.  Change <code>Cells(lrCD + 1, &quot;A&quot;)</code> to a constant if you want to update the same cell each time <code>Cells(1, &quot;A&quot;)</code>."}, {"owner": {"reputation": 17, "user_id": 7002264, "user_type": "registered", "profile_image": "https://graph.facebook.com/348068572193248/picture?type=large", "display_name": "Mbali Ntuli", "link": "https://stackoverflow.com/users/7002264/mbali-ntuli"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476882410, "post_id": 40131499, "comment_id": 67534443, "body": "i tried doing that i even tried using Cells(lrCD, &quot;A&quot;),the probem is that the updated data goes to the next row down"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476883211, "post_id": 40131499, "comment_id": 67535003, "body": "There must be some other code that&#39;s mucking it up - I tried the exact code you&#39;ve posted, removed the <code>+1</code> and it always updated the same row based on the last row found in column A."}, {"owner": {"reputation": 17, "user_id": 7002264, "user_type": "registered", "profile_image": "https://graph.facebook.com/348068572193248/picture?type=large", "display_name": "Mbali Ntuli", "link": "https://stackoverflow.com/users/7002264/mbali-ntuli"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476888027, "post_id": 40131499, "comment_id": 67538994, "body": "i am using row select to populate the combobox, and that row is row A on sheet 2, now row B needs to be updated, but instead it does not update the selected item"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476888433, "post_id": 40131499, "comment_id": 67539317, "body": "Think I&#39;m getting confused with your English.... the combo box contains the values in column A on sheet2.  When you select one of those values in the combo box it will find that value in column A and update the adjacent value in column B with whatever text is in the textbox.  I think that&#39;s what you&#39;re asking?"}, {"owner": {"reputation": 17, "user_id": 7002264, "user_type": "registered", "profile_image": "https://graph.facebook.com/348068572193248/picture?type=large", "display_name": "Mbali Ntuli", "link": "https://stackoverflow.com/users/7002264/mbali-ntuli"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476892237, "post_id": 40131499, "comment_id": 67542037, "body": "yes that is what i mean"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1476894852, "creation_date": 1476894852, "answer_id": 40137013, "question_id": 40131499, "link": "https://stackoverflow.com/questions/40131499/a-command-box-for-updating-data-on-a-spreadsheet/40137013#40137013", "title": "a command box for updating data on a spreadsheet", "body": "<p>Create your form as below:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/PiiqD.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/PiiqD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column A in <code>Sheet2</code> contains unique values that will appear in your combobox.</p>\n\n<p>This code sits within the form.<br>\nThe <code>UserForm_Initialize()</code> event fires when you open the form and will populate the combobox with values.<br>\nThe <code>CommandButton6_Click</code> event searches column A and places the text in textbox5 next to the selected value.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim lrCD As Long\n    'Populate ComboBox with values from column A on Sheet2.\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        lrCD = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        Me.ComboBox1.RowSource = \"'Sheet2'!\" &amp; .Range(.Cells(1, 1), .Cells(lrCD, 1)).Address\n    End With\nEnd Sub\n\nPrivate Sub CommandButton6_Click()\n    Dim rCell As Range\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n\n        'Look for the selected value in column A.\n        Set rCell = .Columns(1).Find( _\n            What:=Me.ComboBox1.Value, _\n            After:=.Cells(1, 1), _\n            LookIn:=xlValues, _\n            LookAt:=xlWhole)\n\n        'If a value is found place the textbox value in the column next to it.\n        If Not rCell Is Nothing Then\n            rCell.Offset(, 1) = Me.TextBox5.Value\n        End If\n    End With\n\nEnd Sub  \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/myBsM.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/myBsM.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 17, "user_id": 7002264, "user_type": "registered", "profile_image": "https://graph.facebook.com/348068572193248/picture?type=large", "display_name": "Mbali Ntuli", "link": "https://stackoverflow.com/users/7002264/mbali-ntuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 40137013, "answer_count": 1, "score": 0, "last_activity_date": 1476894852, "creation_date": 1476880326, "last_edit_date": 1531164843, "question_id": 40131499, "link": "https://stackoverflow.com/questions/40131499/a-command-box-for-updating-data-on-a-spreadsheet", "title": "a command box for updating data on a spreadsheet", "body": "<p>Good day guys I created a userform on excel with a combobox and a command button, the command button is for updating the data on the spread sheet based on the item selected on the combobox and a textbox with data, the problem is every time I click the command button it does not update the data, instead it goes to the next column and fill it in. and i want the data to be updated on the item selected</p>\n\n<p>this is what I tried</p>\n\n<pre><code>  Private Sub CommandButton6_Click()\n    Dim lrCD As Long\n    lrCD = Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sheets(\"Sheet2\").Cells(lrCD + 1, \"A\").Value = ComboBox1.Text\n    Sheets(\"Sheet2\").Cells(lrCD + 1, \"B\").Value = TextBox5.Text\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476880283, "post_id": 40131323, "comment_id": 67532782, "body": "I do not get a box asking me for any input when I use your example"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476882411, "post_id": 40131323, "comment_id": 67534445, "body": "Is this the full code that you are running? If not, can you post more?"}, {"owner": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1476883044, "post_id": 40131323, "comment_id": 67534890, "body": "I posted the complete sub."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476884030, "post_id": 40131323, "comment_id": 67535636, "body": "next time it will be <i>very helpful</i> to people if you explained clearly that you are using Excel for mac. Will save you from a lot of useful answers."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "edited": false, "score": 0, "creation_date": 1476880513, "post_id": 40131445, "comment_id": 67532965, "body": "Thanks for you answer. The msgbox still appears tho, and now it gives the option to delete column Q."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1476880151, "creation_date": 1476880151, "answer_id": 40131445, "question_id": 40131323, "link": "https://stackoverflow.com/questions/40131323/excel-vba-remove-duplicates-automatically/40131445#40131445", "title": "Excel VBA Remove Duplicates Automatically", "body": "<p>If you use <code>Application.DisplayAlerts = False</code> the msgbox should not appear.</p>\n\n<p>As mentioned in my comment above, I don't get a warning when I use your example, but this code would normally suppress display alerts.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "edited": false, "score": 0, "creation_date": 1476880695, "post_id": 40131541, "comment_id": 67533113, "body": "Thanks Thomas. I had tried this one but it didn&#39;t work. My code is:"}, {"owner": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "edited": false, "score": 0, "creation_date": 1476883233, "post_id": 40131541, "comment_id": 67535014, "body": "For the second one, I received an &quot;ActiveX component can&#39;t create object&quot; error message"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476884950, "post_id": 40131541, "comment_id": 67536356, "body": "You received an error on the 2nd because you are using a Mac, which does not have a <code>Scripting.Dictionary</code> object."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1476886268, "post_id": 40131541, "comment_id": 67537492, "body": "@ScottHoltzman  Thanks.  I just updated my answer to use a <code>Collection</code> instead of a <code>Dictionary</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1476886211, "last_edit_date": 1476886211, "creation_date": 1476880451, "answer_id": 40131541, "question_id": 40131323, "link": "https://stackoverflow.com/questions/40131323/excel-vba-remove-duplicates-automatically/40131541#40131541", "title": "Excel VBA Remove Duplicates Automatically", "body": "<h2>Update:   This will work on a Mac OS</h2>\n\n<pre><code>Sub MacRemoveDuplicates()\n    Dim Data, UniqueData, v\n    Dim x As Long\n\n    Dim c As Collection\n    Set c = New Collection\n\n    With ActiveSheet\n\n        Data = Intersect(.Range(\"C:C\"), .UsedRange)\n        ReDim UniqueData(1 To UBound(Data, 1), 1 To 1)\n\n        For Each v In Data\n            If v &lt;&gt; vbNullString Then\n                On Error Resume Next\n                c.Add vbNullString, v\n\n                If Err.Number = 0 Then\n                    x = x + 1\n                    UniqueData(x, 1) = v\n                End If\n                On Error GoTo 0\n            End If\n        Next\n\n        .Range(\"T1\").Resize(x) = UniqueData\n    End With\nEnd Sub\n</code></pre>\n\n<h2>Here are two ways of removing duplicates using Windows OS.</h2>\n\n<pre><code>Sub Method1()\n\n    With ActiveSheet\n        .Range(\"C:C\").Copy Destination:=.Range(\"T:T\")\n        .Range(\"T:T\").RemoveDuplicates Columns:=1, Header:=xlNo\n    End With\n\nEnd Sub\n\n\nSub Method2()\n    Dim Data, v\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With ActiveSheet\n\n        Data = Intersect(.Range(\"C:C\"), .UsedRange)\n\n        For Each v In Data\n            If v &lt;&gt; vbNullString Then dict(v) = vbNullString\n        Next\n\n        .Range(\"T1\").Resize(dict.Count) = Application.Transpose(dict.Keys)\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "edited": false, "score": 0, "creation_date": 1476882876, "post_id": 40132012, "comment_id": 67534765, "body": "Maybe this (and the other Solutions) are not working on a Mac. Maybe it is a good idea to use very Basic coding only, without specific vba elements. For example you could Loop through the values, write them in an Array, compare them and delete those values which are mentioned twice. It&#39;s a bit more effort but it uses only Loops and Arrays, which are supported by Excel for Mac as far as I know."}], "tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": false, "score": 0, "last_activity_date": 1476881720, "creation_date": 1476881720, "answer_id": 40132012, "question_id": 40131323, "link": "https://stackoverflow.com/questions/40131323/excel-vba-remove-duplicates-automatically/40132012#40132012", "title": "Excel VBA Remove Duplicates Automatically", "body": "<p>Add \"Columns:=1\" to your code. By doing so, automatically the first column of the range is selected:</p>\n\n<pre><code>With ActiveSheet\n\n.Range(\"C:C\").Copy Destination:=.Range(\"T:T\")\n.Range(\"T:T\").RemoveDuplicates, Columns:=1, Header:=xlNo\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7042198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/960caa724c8a24a647fe086b4a710f28?s=128&d=identicon&r=PG&f=1", "display_name": "tamebrave", "link": "https://stackoverflow.com/users/7042198/tamebrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2823, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1476886211, "creation_date": 1476879846, "last_edit_date": 1476883120, "question_id": 40131323, "link": "https://stackoverflow.com/questions/40131323/excel-vba-remove-duplicates-automatically", "title": "Excel VBA Remove Duplicates Automatically", "body": "<p>I am trying to copy a column from a table and paste it, removing the duplicated cells when doing so. I am using this code:</p>\n\n<pre><code>Sub Median()\n\n    Application.Calculation = xlManual\n    Application.ScreenUpdating = False\n\n    Worksheets(\"Distance to Default\").Activate\n\nWith ActiveSheet\n\n    .Range(\"C:C\").Copy Destination:=.Range(\"T:T\")\n    .Range(\"T:T\").RemoveDuplicates , Header:=xlNo\n\nEnd With\n\n    Application.Calculation = xlAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ddvgC.png\" rel=\"nofollow\">msgbox</a></p>\n\n<p>It would be working properly if it weren't for the fact that a msgbox appears asking me to select for which column I want to remove the duplicates (picture above). Since I am only pasting one column, the question doesn't make sense. </p>\n\n<p>How can I change my code so the box doesn't appear anymore? </p>\n\n<p>Obs.: I have tried to use Columns:=1 just after RemoveDuplicates and it didn't work</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1476879881, "post_id": 40131223, "comment_id": 67532488, "body": "What is the problem?"}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1476879983, "post_id": 40131223, "comment_id": 67532551, "body": "When I go to run it I keep getting runtime error 1004, application defined or object defined error. I ran the debugger, and it says this line is the problem."}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1476879989, "post_id": 40131223, "comment_id": 67532555, "body": "Do While Cells([CurVal], [12]).Value &lt;&gt; &quot;A1&quot;"}, {"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1476881104, "post_id": 40131223, "comment_id": 67533416, "body": "Try: Do While Cells(CurVal, 12).Value &lt;&gt; &quot;A1&quot;"}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476882071, "post_id": 40131223, "comment_id": 67534191, "body": "I tried that and got the same error unfortunately. Is the comparison the issue?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476882656, "post_id": 40132033, "comment_id": 67534614, "body": "Yes, I do want to return CurVal. I am still getting an error on the Do While loop. Am I trying to test for something that VBA can&#39;t test for."}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476882902, "post_id": 40132033, "comment_id": 67534784, "body": "The Do While Loop in the FindTop function."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476882936, "post_id": 40132033, "comment_id": 67534811, "body": "Also, using the &quot;Locals&quot; window in the VBA editor would allow you to see the variables value in each Sub or Function."}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476883802, "post_id": 40132033, "comment_id": 67535463, "body": "I figured out how to run the step editor and found my main problem, as it turns out its not recognizing the value A1 in the cell, which is confusing. Is there a better way to define it so it will catch the cell to stop at?"}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476884936, "post_id": 40132033, "comment_id": 67536339, "body": "Do While Cells([CurVal], [12]).Value &lt;&gt; Range(&quot;A1&quot;).Value"}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476884976, "post_id": 40132033, "comment_id": 67536385, "body": "It keeps running until CurVal hits zero, and then gives the error."}, {"owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476885934, "post_id": 40132033, "comment_id": 67537223, "body": "I figured out a way to make it work, I decided to add a cell to compare to that I hid off to the side of the main sheet, so it would be easier to compare and break. Thank you for your help."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "edited": false, "score": 0, "creation_date": 1476902311, "post_id": 40132033, "comment_id": 67548064, "body": "Glad you were able to get it working.  I&#39;m sure you could do the comparison in VBA but one would need to see the data you are comparing.  In my test workbook it did fine but I was only using manually entered numbers."}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": true, "score": 0, "last_activity_date": 1476881773, "creation_date": 1476881773, "answer_id": 40132033, "question_id": 40131223, "link": "https://stackoverflow.com/questions/40131223/copy-paste-from-one-constantly-changing-workbook-to-another/40132033#40132033", "title": "Copy/Paste from one constantly changing workbook to another", "body": "<p>The problem is you are not returning a value from the subs you are calling so when you call <code>FindTop</code> the value for <code>FinalRow</code> is empty, the same issue is going to happen when you return from <code>FindTop</code> because <code>CurVal</code> is also empty in the <code>Thickness</code> sub.  </p>\n\n<p>I'd usually add a global variable if I needed to return something but I'm sure that's frowned upon or I would just bring those subs into the main and not worry about it.  I did do some searching and I believe the code below will work for you and return the correct values.  I wasn't able to finish <code>Thickness</code> but I was able to return both values so it should work.  I assume you wanted to return <code>CurVal</code> from <code>FindTop</code>?</p>\n\n<pre><code>Sub Thickness()\n'\n' Thickness Macro\n' Transfer Thickness\n'\n' Keyboard Shortcut: Ctrl+o\nWindows(\"data2.xls\").Activate\n\nFinalRow = FindLast()\n\nCurVal = FindTop(FinalRow)\n\n\n\nDo While CurVal &lt;= FinalRow\n     Windows(\"data2.xls\").Activate\n     Cells(CurVal, 8).Copy\n     CurVal = CurVal + 1\n     Windows(\"TestMacroProgram.xls\").Activate\n     Sheets(\"Sheet1\").Select\n     NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n     Cells(NextRow, 1).Select\n     ActiveSheet.Paste\nLoop\n\nEnd Sub\n\nFunction FindLast()\n    FindLast = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Function\n\nFunction FindTop(FinalRow)\n    CurVal = FinalRow\n    Do While Cells([CurVal], [12]).Value &lt;&gt; Range(\"A1\").Value\n    CurVal = CurVal - 1\n    Loop\n    FindTop = CurVal\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7042183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaef3318a5867e85f1a20f11b4efda5f?s=128&d=identicon&r=PG&f=1", "display_name": "fonzybeard", "link": "https://stackoverflow.com/users/7042183/fonzybeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 40132033, "answer_count": 1, "score": 0, "last_activity_date": 1476881773, "creation_date": 1476879525, "question_id": 40131223, "link": "https://stackoverflow.com/questions/40131223/copy-paste-from-one-constantly-changing-workbook-to-another", "title": "Copy/Paste from one constantly changing workbook to another", "body": "<p>I am trying to write a Macro that will take data from a spreadsheet that is constantly updating with varying amounts of data, and paste it into another spreadsheet in a single column without overwrite. The other thing is it is searching for two points, one of those being the bottom, and the other being the value \"A1\" in the 12th column as the top defining point. </p>\n\n<pre><code>Sub Thickness()\n'\n' Thickness Macro\n' Transfer Thickness\n'\n' Keyboard Shortcut: Ctrl+o\nWindows(\"data2.xls\").Activate\n\nCall FindLast(FinalRow)\n\nCall FindTop(CurVal)\n\n\n\nDo While CurVal &lt;= FinalRow\n     Windows(\"data2.xls\").Activate\n     Cells(CurVal, 8).Copy\n     CurVal = CurVal + 1\n     Windows(\"TestMacroProgram.xls\").Activate\n     Sheets(\"Sheet1\").Select\n     NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n     Cells(NextRow, 1).Select\n     ActiveSheet.Paste\nLoop\n\nEnd Sub\n\nSub FindLast(FinalRow)\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Sub\n\nSub FindTop(CurVal)\n    CurVal = FinalRow\n    Do While Cells([CurVal], [12]).Value &lt;&gt; \"A1\"\n    CurVal = CurVal - 1\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1478524143, "post_id": 40465773, "comment_id": 68176179, "body": "+1. The available constants for conditional compilation are listed here: <a href=\"https://msdn.microsoft.com/de-de/library/office/gg264614.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/de-de/library/office/gg264614.aspx</a>"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 8, "last_activity_date": 1478523369, "creation_date": 1478523369, "answer_id": 40465773, "question_id": 40131131, "link": "https://stackoverflow.com/questions/40131131/specify-path-to-user-folder-in-vba-for-both-windows-and-mac/40465773#40465773", "title": "Specify path to user folder in VBA for both Windows and Mac", "body": "<p>There is conditional compilation that allows you to compile diferent code according to the OS you are using. See <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264731.aspx\" rel=\"noreferrer\">this page</a> for conditional compiling.</p>\n\n<p>In your case you will need to enclose the specific code for Mac of Windows with:</p>\n\n<pre><code>#if Mac then\n'here Mac only code\n#else\n'here Windows only code\n#end if\n</code></pre>\n\n<p>I myself don't have Mac to test, but according to <a href=\"http://www.rondebruin.nl/mac/mac007.htm\" rel=\"noreferrer\">this site</a> you could use the <a href=\"https://msdn.microsoft.com/fr-fr/library/office/gg264812.aspx\" rel=\"noreferrer\">MacScript function</a> to get the requested folder path, with the right script passed in parameter.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 977161, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bfec661843508dc974b847c89ebe9390?s=128&d=identicon&r=PG", "display_name": "Andrew Abbott", "link": "https://stackoverflow.com/users/977161/andrew-abbott"}, "edited": false, "score": 0, "creation_date": 1478557234, "post_id": 40471287, "comment_id": 68196040, "body": "Thanks, will have a look when back in the office tomorrow."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 3, "creation_date": 1478876237, "post_id": 40471287, "comment_id": 68339561, "body": "@Chrismas007 <code>TheOS</code> variable is completely redundant here. You should do <code>InStr(1, Application.OperatingSystem, &quot;Windows&quot;) &gt; 0</code> right off the bat."}, {"owner": {"reputation": 355, "user_id": 977161, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bfec661843508dc974b847c89ebe9390?s=128&d=identicon&r=PG", "display_name": "Andrew Abbott", "link": "https://stackoverflow.com/users/977161/andrew-abbott"}, "edited": false, "score": 0, "creation_date": 1479037956, "post_id": 40471287, "comment_id": 68382575, "body": "Is <code>Environ(&quot;USERPROFILE&quot;)</code> valid on a Mac?"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 9, "last_activity_date": 1479060608, "last_edit_date": 1479060608, "creation_date": 1478540572, "answer_id": 40471287, "question_id": 40131131, "link": "https://stackoverflow.com/questions/40131131/specify-path-to-user-folder-in-vba-for-both-windows-and-mac/40471287#40471287", "title": "Specify path to user folder in VBA for both Windows and Mac", "body": "<p>You have two options:</p>\n\n<p><strong>1. Use <code>Application.PathSeparator</code>... <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820973.aspx\" rel=\"nofollow\">See the MSDN here</a>.</strong></p>\n\n<p>Code:</p>\n\n<pre><code>Dim PS as String\nPS = Application.PathSeparator\nIf Len(Dir(Environ(\"USERPROFILE\") &amp; PS &amp; \"Documents\" &amp; PS &amp; \"Some Folder\", vbDirectory)) = 0 Then\n    MkDir Environ(\"USERPROFILE\") &amp; PS &amp; \"Documents\" &amp; PS &amp; \"Some Folder\"\nEnd If\nOpen Environ(\"USERPROFILE\") &amp; PS &amp; \"Documents\" &amp; PS &amp; \"Some Folder\" &amp; PS &amp; \"file.php\" For Output As #1\nPrint #1, output\nClose\n</code></pre>\n\n<p><strong>2. Create an <code>IF THEN</code> to check for <code>OS</code></strong></p>\n\n<p>Code:</p>\n\n<pre><code>Sub SaveDoc()\n    Dim wksSheet As Worksheet\n\n    If InStr(1, Application.OperatingSystem, \"Windows\") &gt; 0 Then\n      'Code with Windows Path Separator\n      Exit Sub\n\n    Else\n      'Code with Mac Path Separator\n      Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6230877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ceae419aa6fe03ca8ac57c6c74934e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Parrish", "link": "https://stackoverflow.com/users/6230877/j-parrish"}, "is_accepted": false, "score": 1, "last_activity_date": 1603380183, "creation_date": 1603380183, "answer_id": 64485457, "question_id": 40131131, "link": "https://stackoverflow.com/questions/40131131/specify-path-to-user-folder-in-vba-for-both-windows-and-mac/64485457#64485457", "title": "Specify path to user folder in VBA for both Windows and Mac", "body": "<p>This worked for me.  I write on PC but have some Mac users.</p>\n<pre><code>  Set source_workbook = Application.ThisWorkbook\n  source_wkbk_path = source_workbook.Path\n\n  If Application.OperatingSystem Like &quot;*Mac*&quot; Then\n    current_path = source_wkbk_path &amp; &quot;/&quot; &amp; current_date &amp; &quot; Workbooks&quot; &amp; &quot;/&quot;\n  Else\n    current_path = source_wkbk_path &amp; &quot;\\&quot; &amp; current_date &amp; &quot; Workbooks&quot; &amp; &quot;\\&quot;\n  End If\n\n  If Len(Dir(current_path, vbDirectory)) = 0 Then\n    MkDir current_path\n  End If\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 977161, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bfec661843508dc974b847c89ebe9390?s=128&d=identicon&r=PG", "display_name": "Andrew Abbott", "link": "https://stackoverflow.com/users/977161/andrew-abbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4176, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1603380183, "creation_date": 1476879274, "last_edit_date": 1593679196, "question_id": 40131131, "link": "https://stackoverflow.com/questions/40131131/specify-path-to-user-folder-in-vba-for-both-windows-and-mac", "title": "Specify path to user folder in VBA for both Windows and Mac", "body": "<p>I am writing a tool which generates a file from Excel using VBA. The generated file is written to a folder, if it exists, in the user's Documents folder.</p>\n\n<p>e.g. <code>C:\\Users\\&lt;username&gt;\\Documents\\Some Folder\\</code></p>\n\n<p>If the last folder doesn't exist, then VBA creates it. I use the following line to ensure that the location of the folder works for different Windows users distributed in the organisation:</p>\n\n<pre><code>If Len(Dir(Environ(\"USERPROFILE\") &amp; \"\\Documents\\Some Folder\", vbDirectory)) = 0 Then\n    MkDir Environ(\"USERPROFILE\") &amp; \"\\Documents\\Some Folder\"\nEnd If\nOpen Environ(\"USERPROFILE\") &amp; \"\\Documents\\Some Folder\\\" &amp; \"file.php\" For Output As #1\nPrint #1, output\nClose\n</code></pre>\n\n<p>My issue now though is that I also have to cater for Mac OSX users. At present I don't have access to a Mac to test, but I am assuming the above won't work.</p>\n\n<p>What could could I use to point to the sub-folder in the user's documents, and how can I include code which conditionally uses either the Windows line or the Mac line?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476883750, "post_id": 40131062, "comment_id": 67535420, "body": "Rather than use <code>ActiveSheet</code> try <code>ThisWorkbook.Worksheets(&quot;Tab2&quot;)</code> - maybe it&#39;s not working on the correct sheet.  And your <code>Sheets(&quot;MAIN&quot;)</code> should be <code>ThisWorkbook.Sheets(&quot;MAIN&quot;)</code> - maybe the other users don&#39;t have the workbook active when the code runs (so it will execute on the active workbook)."}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476892197, "post_id": 40131062, "comment_id": 67542005, "body": "@DarrenBartrup-Cook Thank you for your response!! Sure, let me try"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476977295, "post_id": 40131062, "comment_id": 67586069, "body": "@DarrenBartrup-Cook it dint help. Stills the same issue, when I click &quot;ok&quot; on message, it will not enable cells. Any other suggestions, please"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1476978695, "post_id": 40131062, "comment_id": 67587014, "body": "You know, I&#39;ve just realised - if you press OK there&#39;s nothing in your code that unlocks the cells.  You need to add <code>ActiveSheet.Unprotect</code> to actually unlock the cells."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1477398900, "post_id": 40159336, "comment_id": 67742070, "body": "That worked...I moved NotifyUserGeneral to a normal module. Its working good now. Thank you"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1476979455, "creation_date": 1476979455, "answer_id": 40159336, "question_id": 40131062, "link": "https://stackoverflow.com/questions/40131062/macro-enabled-workbook-read-only-when-shared/40159336#40159336", "title": "Macro enabled workbook read only when shared", "body": "<p>I think this is the code you're after.  </p>\n\n<p><strong>Note:</strong> I've moved the declaration of <code>mMessageDisplayed</code> to the top of the module otherwise it gets reset to FALSE each time <code>NotifyUserGeneral</code> is called.  </p>\n\n<p><strong>Also note:</strong>  It may be better to move NotifyUserGeneral to a normal module if you want to call it from other sheets - remember to move the <code>mMessageDisplayed</code> declaration to.</p>\n\n<pre><code>Option Explicit\n\nPrivate mMessageDisplayed As Boolean\n\nPrivate Sub Worksheet_Activate()\n\n    NotifyUserGeneral\n\nEnd Sub\n\nPrivate Sub NotifyUserGeneral()\n\n    If ActiveSheet.ProtectContents And Not mMessageDisplayed Then\n        mMessageDisplayed = True\n        If MsgBox(\"Cells are locked on current sheet, press ok to Unlock\", vbOKCancel + vbInformation) = vbOK Then\n            ActiveSheet.Unprotect\n            ThisWorkbook.Worksheets(\"MAIN\").Range(\"G11\") = \"YES\"\n        Else\n            ThisWorkbook.Worksheets(\"MAIN\").Range(\"E29\") = \"NO\"\n        End If\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 40159336, "answer_count": 1, "score": 0, "last_activity_date": 1476979455, "creation_date": 1476879070, "question_id": 40131062, "link": "https://stackoverflow.com/questions/40131062/macro-enabled-workbook-read-only-when-shared", "title": "Macro enabled workbook read only when shared", "body": "<p>I have a macro enabled workbook. It has protected worksheet and workbook.\nWorkbook includes 3 Sheets.\nSheet1 named as Main\nSheet2 named as Tab2\nSheet3 named as Tab3</p>\n\n<p>I have disabled cells on Tab2 and I have a macro that should throw prompt to user enable cells or not. If User selects \"yes\" cells gets enabled and drop down on \"Main\" sheet will be changed to yes.</p>\n\n<p>Macro works fine for me. I have to share the workbook to the other users via e-mail.</p>\n\n<p>Users saves the workbook on his machine and selects \"Enable Editing\" and \"Enable Macros\". </p>\n\n<p>But the Workbook name at the top shows XXXX[Read-only] and cells are Tab2 are not getting enabled when users clicks \"ok\" on the prompt.</p>\n\n<p>Do I have an option to open the workbook Read/Write mode? Or any other option for me so that protection works fine?</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    NotifyUserGeneral\n\nEnd Sub\n\n\n\nPrivate Sub NotifyUserGeneral()\nDim mMessageDisplayed As Boolean\nDim message  As Integer\n\n    If ActiveSheet.ProtectContents = True And Not mMessageDisplayed Then\n        message = MsgBox(\"Cells are locked on current sheet, press ok to Unlock \", vbOKCancel)\n        mMessageDisplayed = True\n        If message = vbOK Then\n        Sheets(\"MAIN\").Range(\"G11\") = \"YES\"\n        Else\n        Sheets(\"MAIN\").Range(\"E29\") = \"NO\"\n    End If\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = True\nEnd Sub\n</code></pre>\n\n<p>Please do suggest</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476897292, "post_id": 40129936, "comment_id": 67545000, "body": "Which office are using?"}, {"owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476964069, "post_id": 40129936, "comment_id": 67575975, "body": "@Om3r I&#39;m using 2013"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1476895393, "creation_date": 1476895393, "answer_id": 40137178, "question_id": 40129936, "link": "https://stackoverflow.com/questions/40129936/automatically-send-an-email-alert-when-outlook-is-closed/40137178#40137178", "title": "Automatically send an email alert when outlook is closed", "body": "<p>Latest versions of Outlook do nto fire <code>Application.Quit</code> event. The only workaround is to track the open Explorer and Inspector windows and check when the last window is about to be closed. On startup, hook up the <code>Application.ActiveExplorer</code> window and also track the <code>Application.Explorers.NewExplorer</code> event. Same for the inspectors (<code>Application.Inspectors.NewInspector</code>). When <code>Explorer.Close</code> or <code>Inspector.Close</code> events fires, check the number of still open Explorers and Inspectors (<code>Application.Explorers.Count</code> and <code>Application.Inspectors.Count</code>). If there is only 1 window left, do what you need to do.</p>\n"}], "owner": {"reputation": 31, "user_id": 5701773, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bce4ba9a6ded3e5d03649fdcd52b716a?s=128&d=identicon&r=PG&f=1", "display_name": "Wilson", "link": "https://stackoverflow.com/users/5701773/wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593307588, "creation_date": 1476875826, "last_edit_date": 1593307588, "question_id": 40129936, "link": "https://stackoverflow.com/questions/40129936/automatically-send-an-email-alert-when-outlook-is-closed", "title": "Automatically send an email alert when outlook is closed", "body": "<p>I need to have outlook send me an email to let me know that the Outlook session has been closed. The code below doesn't work , but works at Application_Startup(). Any other suggestions on how to do it?</p>\n\n<pre><code>Private Sub Application_Quit()\n\nDim objMsg As MailItem \nDim EmailSubject As String \nDim SendTo As String \nSet objMsg = Application.CreateItem(olMailItem) \nEmailSubject = \"Outlook session Closing\" \nSendTo = \"xxxx@outlook.com\" \n\nobjMsg.To = SendTo \nobjMsg.Subject = EmailSubject \nobjMsg.Send \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 7041865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-RQz_7vsoPIU/AAAAAAAAAAI/AAAAAAAAALw/XjeRuZzhgOg/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/7041865/robert"}, "edited": false, "score": 0, "creation_date": 1476883751, "post_id": 40130284, "comment_id": 67535421, "body": "My problem is how can I call CommandButton1 (which is in the &quot;ThisDocument&quot; and the call is from UserForm? How can I call the button which is in the word document and not in the Userform?"}, {"owner": {"reputation": 1233, "user_id": 6903997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ1mr.png?s=128&g=1", "display_name": "Tim Schmidt", "link": "https://stackoverflow.com/users/6903997/tim-schmidt"}, "reply_to_user": {"reputation": 117, "user_id": 7041865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-RQz_7vsoPIU/AAAAAAAAAAI/AAAAAAAAALw/XjeRuZzhgOg/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/7041865/robert"}, "edited": false, "score": 0, "creation_date": 1476942523, "post_id": 40130284, "comment_id": 67562103, "body": "You don&#180;t need to call the CommandButton1 if you just write all the code you want to be executed into the method."}], "tags": [], "owner": {"reputation": 1233, "user_id": 6903997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ1mr.png?s=128&g=1", "display_name": "Tim Schmidt", "link": "https://stackoverflow.com/users/6903997/tim-schmidt"}, "is_accepted": false, "score": 1, "last_activity_date": 1476942802, "last_edit_date": 1476942802, "creation_date": 1476876799, "answer_id": 40130284, "question_id": 40129933, "link": "https://stackoverflow.com/questions/40129933/vba-word-hide-show-button/40130284#40130284", "title": "VBA Word Hide/Show Button", "body": "<ol>\n<li><p>Unfortunately there is no way to hide/unhide buttons in Word, but deleting them instead is a good solution for this problem.</p></li>\n<li><p>You can simply write a method  and call that method from a UserForm.</p>\n\n<pre><code>Public Sub test()\n    CommandButton1.Select\n    Selection.Delete\nEnd Sub\n</code></pre>\n\n<p>Now all you need to do is call the method :</p>\n\n<pre><code>call test\n</code></pre></li>\n</ol>\n\n<p>Edit:</p>\n\n<pre><code>Public Sub test()\n  CommandButton1.Select\n  Selection.Delete\n\n  'All the Other code\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n  call test\nEnd Sub\n</code></pre>\n\n<p>Now you can just call the <code>sub test</code> to execute the same code as the CommandButton1 does.</p>\n\n<p>Hope I could help.</p>\n"}], "owner": {"reputation": 117, "user_id": 7041865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-RQz_7vsoPIU/AAAAAAAAAAI/AAAAAAAAALw/XjeRuZzhgOg/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/7041865/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476942802, "creation_date": 1476875818, "last_edit_date": 1476890750, "question_id": 40129933, "link": "https://stackoverflow.com/questions/40129933/vba-word-hide-show-button", "title": "VBA Word Hide/Show Button", "body": "<p>I have created a button in Word which can help me to save files much more easier. I have a question related to this button from the document. I have read that it is not possible to hide or show the button. So I though I will delete the button which worked, but once the project got a bit complicated.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    CommandButton1.Select\n    Selection.Delete\n\n    UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Is it possible to use hide/show command for the CommandButtton1?</p></li>\n<li><p>If 1 is not possible then is it possible to call from UserForm the function CommandButton1 and delete it from there if a certain value is true?</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1476873032, "post_id": 40128651, "comment_id": 67527276, "body": "Can you give us the full code? You just want to copy all sheet except empty rows?"}, {"owner": {"reputation": 701, "user_id": 1959724, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7ca84710d2de3d87f9c81141b6175747?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/1959724/stefan"}, "edited": false, "score": 0, "creation_date": 1476874112, "post_id": 40128651, "comment_id": 67528123, "body": "Welcome on stackoverflow! Can you maybe add an image of the order form and the &quot;bottom of the register&quot;. I dont understand how it looks like. Is it a new worksheet or the same? I am sure we can help. The error &quot;Expected End Sub&quot; occurs if you copy code into an area, that is not wrapped by &quot;Sub MakroName()  .....your code.... End Sub"}, {"owner": {"reputation": 1, "user_id": 7041630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EQ5PZmeOWEc/AAAAAAAAAAI/AAAAAAAAAJQ/deTLp8AeI9w/photo.jpg?sz=128", "display_name": "Hannah Thorley", "link": "https://stackoverflow.com/users/7041630/hannah-thorley"}, "edited": false, "score": 0, "creation_date": 1476880467, "post_id": 40128651, "comment_id": 67532925, "body": "I&#39;m apparently not allowed to add images. The order form and register are on separate worksheets"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7041630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EQ5PZmeOWEc/AAAAAAAAAAI/AAAAAAAAAJQ/deTLp8AeI9w/photo.jpg?sz=128", "display_name": "Hannah Thorley", "link": "https://stackoverflow.com/users/7041630/hannah-thorley"}, "edited": false, "score": 0, "creation_date": 1476886949, "post_id": 40130024, "comment_id": 67538071, "body": "Would that not copy and paste over previous orders already in the register, if it starts from A1 every time?"}, {"owner": {"reputation": 826, "user_id": 1850457, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/468bd8fa27de50de396bbc7193aaddd8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H", "link": "https://stackoverflow.com/users/1850457/peter-h"}, "reply_to_user": {"reputation": 1, "user_id": 7041630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EQ5PZmeOWEc/AAAAAAAAAAI/AAAAAAAAAJQ/deTLp8AeI9w/photo.jpg?sz=128", "display_name": "Hannah Thorley", "link": "https://stackoverflow.com/users/7041630/hannah-thorley"}, "edited": false, "score": 0, "creation_date": 1476941400, "post_id": 40130024, "comment_id": 67561665, "body": "@HannahThorley You can modify the cell to your desire location. It&#39;s impossible to know where you need the data to go."}], "tags": [], "owner": {"reputation": 826, "user_id": 1850457, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/468bd8fa27de50de396bbc7193aaddd8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter H", "link": "https://stackoverflow.com/users/1850457/peter-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1476876101, "creation_date": 1476876101, "answer_id": 40130024, "question_id": 40128651, "link": "https://stackoverflow.com/questions/40128651/copying-only-non-blank-rows-and-pasting-to-the-first-blank-row/40130024#40130024", "title": "Copying only non blank rows and pasting to the first blank row", "body": "<p>This is a difficult one to even attempt answering because we can't see your spreadsheet.</p>\n\n<p>To help you with the copy the following code may assist. The code will copy data from B6 through to X6 of Sheet1 (you can change this to the sheet of your data so long as it isn't in the same sheet).</p>\n\n<p>The code will copy data from sheet1 to the \"Register of Orders\" one column at a time ignoring blanks values.</p>\n\n<pre><code>Sub test_copy_ignoring_blanks()\n\n    Sheets(\"Register of Orders\").Select\n    Range(\"A1\").select 'Data will be pasted To Cell A1 moving 1 column position\n\n    'Select the sheet where your data is I'm imagining this is sheet 1\n    Sheets(1).Select\n\n\n    Dim starting_column As Long\n    Dim ending_column As Long\n\n    'Set the starting and ending columns\n    Range(\"X6\").Select\n    ending_column = ActiveCell.Column\n    Range(\"B6\").Select\n    starting_column = ActiveCell.Column\n\n    'Loop through for the copy\n    For counter = starting_column To ending_column\n        Cells(6, counter).Select\n        If Not IsEmpty(ActiveCell.Value) Then\n        ' The cell is not empty so copy it and paste it to Regist Order\n        Selection.Copy\n        Sheets(\"Register of Orders\").Select\n        'Select the Range you want to paste it in\n        ActiveSheet.Paste\n        'Move the cursor one to the right\n        ActiveCell.Offset(0, 1).Select\n        Sheets(1).Select\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7041630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EQ5PZmeOWEc/AAAAAAAAAAI/AAAAAAAAAJQ/deTLp8AeI9w/photo.jpg?sz=128", "display_name": "Hannah Thorley", "link": "https://stackoverflow.com/users/7041630/hannah-thorley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1732, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1476880440, "creation_date": 1476872640, "last_edit_date": 1531164843, "question_id": 40128651, "link": "https://stackoverflow.com/questions/40128651/copying-only-non-blank-rows-and-pasting-to-the-first-blank-row", "title": "Copying only non blank rows and pasting to the first blank row", "body": "<p>I'm super new to VB so apologies if this is ridiculously simple. I've got a macro to transfer an order form to a continuous register of orders.  </p>\n\n<p>Here's the code I've got:</p>\n\n<pre><code>Range(\"B2:X2\").Select \nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Register of Orders\").Select\nRange(\"B9\").Select \nActiveSheet.Paste\n</code></pre>\n\n<p>Instead of Range B2:X2 I need to select all non blank rows. And instead of Range B9 I need to select the first blank row at the bottom of the register.</p>\n\n<p>I have had a look at a few answers on here and tried to use the code suggested, but I always got an error saying Expected End Sub.</p>\n"}, {"tags": ["vba", "oop"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1476873025, "post_id": 40128077, "comment_id": 67527265, "body": "VBA supports creating and instantiating classes: <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/classes.aspx</a>  For <code>object(key)</code> you have the <code>Collection()</code> type or a <code>Dictionary()</code>."}, {"owner": {"reputation": 331, "user_id": 1824556, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3562ed1f98c1110f02e3e6515b43c2d?s=128&d=identicon&r=PG", "display_name": "Peter Frey", "link": "https://stackoverflow.com/users/1824556/peter-frey"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1476878147, "post_id": 40128077, "comment_id": 67531227, "body": "Thank you! It seems like I always wanted to read this article."}], "owner": {"reputation": 331, "user_id": 1824556, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b3562ed1f98c1110f02e3e6515b43c2d?s=128&d=identicon&r=PG", "display_name": "Peter Frey", "link": "https://stackoverflow.com/users/1824556/peter-frey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476871194, "creation_date": 1476871194, "question_id": 40128077, "link": "https://stackoverflow.com/questions/40128077/vba-how-to-immitate-oop-style", "title": "vba how to immitate OOP style", "body": "<p>I would like to have some hardcoded varaibles and I would like to separete this from my actual code. In PHP I would use a config class and call config->foo later on. Is that somehow similar possible in VBA?</p>\n\n<p>I thought on a config function and call it like Config(\"Foo\"). </p>\n\n<p>Does this somehow work or must I go via Global Variables for the solution?</p>\n\n<pre><code>Sub SomeFunction()\n\nDim I As Long\n\nI = Config(\"Foo\") ' is supposed to be I = 1\n\nEnd Sub\n\nPublic Function Config(VariableName As String) As Variant\n\nStatic Foo As Long\nStatic Bar As String\nStatic SomeOtherVarThatIJustQuicklyMadeUp As String\nFoo = 1\nBar = \"Example\"\nDim ReturnValue As Variant\nReturnValue = GetVariableByName(VariableName)\nConfig = ReturnValue\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "export", "insert-into"], "answers": [{"comments": [{"owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "edited": false, "score": 0, "creation_date": 1476874027, "post_id": 40128540, "comment_id": 67528060, "body": "Wow! It is my lucky day. I just tried and copied and pasted the created SQL statement with NULL values and it works fine. Here is what I inserted &quot;INSERT INTO Table1 (Id, PersonName, DoB, NumberOfChildern) VALUES  (3, &#39;Edgar&#39;, NULL, NULL);&quot;"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1476872360, "last_edit_date": 1495541795, "creation_date": 1476872360, "answer_id": 40128540, "question_id": 40127962, "link": "https://stackoverflow.com/questions/40127962/generate-insert-into-statements-in-ms-access/40128540#40128540", "title": "Generate INSERT INTO statements in MS-Access", "body": "<p>It's your lucky day. I have done this for SQL Server - with a few modifications done below it should work for Access SQL.</p>\n\n<p>The key is to insert VALUES NULL, not create different statements if values are null.</p>\n\n<p>The <code>SET IDENTITY_INSERT ON/OFF</code> probably isn't needed for Access.</p>\n\n<p>Gustav has posted a <a href=\"https://stackoverflow.com/a/36494189/3820271\">generic function</a> that can replace all Sqlify/SqlDate etc. helper functions and covers more data types.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub InsertStatementsSql(ByVal sTABLE As String)\n\n    Dim DB As DAO.Database\n    Dim TD As DAO.TableDef\n    Dim RS As DAO.Recordset\n    Dim fld As DAO.Field\n    Dim sKpl As String\n    Dim sStart As String\n    Dim sValues As String\n    Dim S As String\n    Dim v As Variant\n    Dim i As Long\n    Dim bIdentity As Boolean\n\n    Set DB = CurrentDb\n    Set TD = DB.TableDefs(sTABLE)\n    Set RS = DB.OpenRecordset(sTABLE, dbOpenSnapshot)\n\n\n    ' Check for Autonumber/IDENTITY column\n    bIdentity = False\n    For i = 0 To TD.Fields.count - 1\n        If (TD.Fields(i).Attributes And dbAutoIncrField) &gt; 0 Then\n            bIdentity = True\n            Exit For\n        End If\n    Next i\n\n    If bIdentity Then\n        sKpl = sKpl &amp; \"SET IDENTITY_INSERT \" &amp; sTABLE &amp; \" ON;\" &amp; vbCrLf &amp; vbCrLf\n    End If\n\n    ' \"INSERT INTO ... VALUES \" for every line\n    For i = 0 To TD.Fields.count - 1\n        sStart = StrAppend(sStart, TD.Fields(i).Name, \", \")\n    Next i\n    sStart = \"INSERT INTO \" &amp; sTABLE &amp; \" (\" &amp; sStart &amp; \") VALUES \"\n\n    ' One line per record\n    Do While Not RS.EOF\n        sValues = \"\"\n        For i = 0 To TD.Fields.count - 1\n            v = RS(i)\n            If IsNull(v) Then\n                S = \"NULL\"\n            Else\n                Set fld = TD.Fields(i)\n                Select Case fld.Type\n                    Case dbText, dbMemo: S = Sqlify(CStr(v))\n                    Case dbDate: S = SqlDate(CDate(v))\n                    Case dbDouble, dbSingle: S = SqlNumber(CDbl(v))\n                    Case Else: S = CStr(v)\n                End Select\n            End If\n            sValues = StrAppend(sValues, S, \", \")\n        Next i\n        ' Append line to full SQL\n        sKpl = sKpl &amp; vbCrLf &amp; sStart &amp; \" (\" &amp; sValues &amp; \");\"\n        RS.MoveNext\n    Loop\n    RS.Close\n    Set TD = Nothing\n\n    If bIdentity Then\n        sKpl = sKpl &amp; vbCrLf &amp; vbCrLf &amp; \"SET IDENTITY_INSERT \" &amp; sTABLE &amp; \" OFF;\" &amp; vbCrLf\n    End If\n\n    Debug.Print sKpl\n\n    ' see https://support.microsoft.com/en-us/kb/210216 or https://msdn.microsoft.com/en-us/library/office/ff192913.aspx\n    ' or https://stackoverflow.com/a/25431633/3820271\n    'ClipBoard_SetData sKpl\n\nEnd Sub\n\n' ------------------- helper functions -----------------\n\n'  ein'string --&gt; 'ein''string'\nPublic Function Sqlify(ByVal S As String) As String\n\n    S = Replace(S, \"'\", \"''\")\n    S = \"'\" &amp; S &amp; \"'\"\n    Sqlify = S\n\nEnd Function\n\nPublic Function SqlDate(vDate As Date) As String\n    SqlDate = \"#\" &amp; Format(vDate, \"yyyy-mm-dd\") &amp; \"#\"\nEnd Function\n\nPublic Function SqlNumber(num As Double) As String\n    SqlNumber = Replace(CStr(num), \",\", \".\")\nEnd Function\n\nPublic Function StrAppend(sBase As String, sAppend As Variant, sSeparator As String) As String\n\n    If Len(sAppend) &gt; 0 Then\n        If sBase = \"\" Then\n            StrAppend = Nz(sAppend, \"\")\n        Else\n            StrAppend = sBase &amp; sSeparator &amp; Nz(sAppend, \"\")\n        End If\n    Else\n        StrAppend = sBase\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1861, "favorite_count": 0, "accepted_answer_id": 40128540, "answer_count": 1, "score": 0, "last_activity_date": 1476872360, "creation_date": 1476870891, "question_id": 40127962, "link": "https://stackoverflow.com/questions/40127962/generate-insert-into-statements-in-ms-access", "title": "Generate INSERT INTO statements in MS-Access", "body": "<p>I like to export data (single records) from one Access database to another one in another country. The idea is that I want to send a text file with INSERT INTO statements per email and the receiving PC just executes these INSERT INTO statements. I wrote already the code to read and execute the INSERT INTO statements in these text files.</p>\n\n<p>Obviously I have to generate the INSERT INTO statements.</p>\n\n<p>Here is an example.</p>\n\n<p>I have the following table:</p>\n\n<pre><code>Table1\nId                number\nPersonName        text\nDoB               date, can be empty\nNumberOfChildern  number, can be empty\n</code></pre>\n\n<p>I select the data like this:</p>\n\n<pre><code>SELECT Id, PersonName, DoB, NumberOfChildern FROM Table1;\n</code></pre>\n\n<p>What I want to generate are statements like this:</p>\n\n<pre><code>INSERT INTO Table1 (Id, PersonName, DoB, NumberOfChildern ) VALUES (1, \u2018Peter\u2019, #5-17-1990#, 1)\n</code></pre>\n\n<p>If all fields are always filled in then I could write one time the code and that's it. But there is a problem if a couple of fields might contain data or maybe no data.</p>\n\n<p>Here are some similar but different versions of the above statement:</p>\n\n<pre><code>INSERT INTO Table1 (Id, PersonName, DoB, NumberOfChildern ) VALUES (1, \u2018Peter\u2019, #5-17-1990#, 1)\nINSERT INTO Table1 (Id, PersonName, NumberOfChildern ) VALUES (1, \u2018Peter\u2019, 1)\nINSERT INTO Table1 (Id, PersonName, DoB ) VALUES (1, \u2018Peter\u2019, #5-17-1990#)\nINSERT INTO Table1 (Id, PersonName ) VALUES (1, \u2018Peter\u2019)\n</code></pre>\n\n<p>With just two fields which can contain NULL values there are already 4 different versions of this statement and with more fields it becomes more and more complicated (not really complicated but more work).</p>\n\n<p>I think about writing code in VBA which analyzes the table and the records which I want to export to check which kind of fields are used (i.e. date) and then generate statements like above.\nI am sure I can do this but I wonder if maybe others did this before.\nI don't want to reinvent the wheel.\nBut searching for \"generate SQL insert statements\" is not really efficient.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "textbox"], "comments": [{"owner": {"reputation": 1078, "user_id": 3525780, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/TZeux.jpg?s=128&g=1", "display_name": "Fusseldieb", "link": "https://stackoverflow.com/users/3525780/fusseldieb"}, "edited": false, "score": 0, "creation_date": 1476871210, "post_id": 40127879, "comment_id": 67525978, "body": "Try: <code>AfterUpdate</code>..."}, {"owner": {"reputation": 90, "user_id": 6387552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c4b1ba7d4219101ebc0a56ebaf598?s=128&d=identicon&r=PG", "display_name": "Irithyll", "link": "https://stackoverflow.com/users/6387552/irithyll"}, "reply_to_user": {"reputation": 1078, "user_id": 3525780, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/TZeux.jpg?s=128&g=1", "display_name": "Fusseldieb", "link": "https://stackoverflow.com/users/3525780/fusseldieb"}, "edited": false, "score": 1, "creation_date": 1476871413, "post_id": 40127879, "comment_id": 67526121, "body": "@Fusseldieb I tested <code>AfterUpdate</code> - it&#39;s the same effect in my case. :)"}], "answers": [{"tags": [], "owner": {"reputation": 90, "user_id": 6387552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c4b1ba7d4219101ebc0a56ebaf598?s=128&d=identicon&r=PG", "display_name": "Irithyll", "link": "https://stackoverflow.com/users/6387552/irithyll"}, "is_accepted": false, "score": 0, "last_activity_date": 1476872360, "last_edit_date": 1476872360, "creation_date": 1476872015, "answer_id": 40128410, "question_id": 40127879, "link": "https://stackoverflow.com/questions/40127879/vba-textboxs-change-affect-second-textbox-and-vice-versa/40128410#40128410", "title": "VBA Textbox&#39;s change affect second textbox and vice versa", "body": "<p>Instead of <code>tbWeight_Change()</code> or <code>tb_Volume_Change()</code> you could use the following:</p>\n\n<pre><code>Private Sub tbWeight_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    ' do everything you want to do\nEnd Sub\n</code></pre>\n\n<p>and of course:</p>\n\n<pre><code>Private Sub tbVolume_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    ' do everything you want to do\nEnd Sub\n</code></pre>\n\n<p>You change the value of the textbox, exit it via tab or mouse click and the other value of the textbox will change.</p>\n\n<p>If you want a parallel output while writing in the textbox you can use an extra textbox just for displaying the calculated value.</p>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 7041444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MrI9X_aH1M8/AAAAAAAAAAI/AAAAAAAAABM/Kh4HlMjRPHc/photo.jpg?sz=128", "display_name": "Petr Kate\u0159i\u0148&#225;k", "link": "https://stackoverflow.com/users/7041444/petr-kate%c5%99i%c5%88%c3%a1k"}, "is_accepted": true, "score": 2, "last_activity_date": 1476875563, "creation_date": 1476875563, "answer_id": 40129841, "question_id": 40127879, "link": "https://stackoverflow.com/questions/40127879/vba-textboxs-change-affect-second-textbox-and-vice-versa/40129841#40129841", "title": "VBA Textbox&#39;s change affect second textbox and vice versa", "body": "<p>Oh.. Finally it was so easy, only two new booleans and everything works fine:</p>\n\n<pre><code>Dim editingVolumeByApp As Boolean\nDim editingWeightByApp As Boolean\n\nPrivate Sub tbVolume_Change()\n  If editingVolumeByApp = False Then\n    '...\n    editingWeightByApp = True\n    tbWeight.Value = finalVolume * CDbl(tbMatDensi.Value)\n    editingWeightByApp = False\n    '...\n  End If\nEnd Sub\n\nPrivate Sub tbWeight_Change()\n  If editingWeightByApp = False Then\n    '...\n    editingVolumeByApp = True\n    tbVolume.Value = finalVolume * CDbl(tbMatComplCoef.Value)\n    editingVolumeByApp = False\n    '...\n  End If\nEnd Sub\n</code></pre>\n\n<p>And it works fine :-)</p>\n"}], "owner": {"reputation": 107, "user_id": 7041444, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MrI9X_aH1M8/AAAAAAAAAAI/AAAAAAAAABM/Kh4HlMjRPHc/photo.jpg?sz=128", "display_name": "Petr Kate\u0159i\u0148&#225;k", "link": "https://stackoverflow.com/users/7041444/petr-kate%c5%99i%c5%88%c3%a1k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 40129841, "answer_count": 2, "score": 0, "last_activity_date": 1476875563, "creation_date": 1476870660, "last_edit_date": 1476871612, "question_id": 40127879, "link": "https://stackoverflow.com/questions/40127879/vba-textboxs-change-affect-second-textbox-and-vice-versa", "title": "VBA Textbox&#39;s change affect second textbox and vice versa", "body": "<p>On my form I have more textboxes, but two of them are special. It's textbox with name <code>tbVolume</code> and textbox with name <code>tbWeight</code>.</p>\n\n<p>If I change <code>tbVolume</code>, by other parameters is computed value for <code>tbWeight</code>, but when I added same procedure to <code>tbWeight</code> (to compute value for <code>tbVolume</code>), it creates some kind of cyclically link, because change of volume changes weight, change of weight changes volume, etc...</p>\n\n<p>Does it exist some argument of <code>tbVolume_Changed()</code> / <code>tbWeight_Changed()</code> which can tell to procedure if value is changed by user or by application?</p>\n\n<p>Or do you have another idea how to solve this twin-textbox problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 1, "creation_date": 1476870765, "post_id": 40127653, "comment_id": 67525683, "body": "At which line error occurrs? The &quot;Data.xlsm&quot; and &quot;Data.xlsx&quot; are separate workbooks, aren&#39;t they?"}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1476872003, "post_id": 40127653, "comment_id": 67526554, "body": "Avoid <code>.Select</code> at all costs, it is the source of many common errors. Maybe the error occurs because you are selecting a range but you don&#39;t explicty indicate from which workbook. You could declare something like this: <code>Dim wb as Workbook: Set wb = Workbooks.Open(&quot;C:\\Users\\Desktop\\Data Analysis\\Data.xlsx&quot;)</code>. Then you should use <code>wb.Worksheets(&quot;List&quot;).Range(&quot;A1&quot;).End(xlDown).Row </code> for example."}], "owner": {"reputation": 11, "user_id": 7041388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd2ef5956fba87cd43e1d419b5c9d160?s=128&d=identicon&r=PG&f=1", "display_name": "Penny Lau", "link": "https://stackoverflow.com/users/7041388/penny-lau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476870000, "creation_date": 1476870000, "last_edit_date": 1531164843, "question_id": 40127653, "link": "https://stackoverflow.com/questions/40127653/vba-transfer-data-from-one-workbook-to-another-workbook", "title": "VBA transfer data from one workbook to another workbook", "body": "<p>I tried to write the followings to transfer the data from one workbook to another one, however, it gets the error 9 that is out of script range. I've checked twice and could not locate any mistakes. Could you help to check to see whether I have missed anything or something is wrong? Thanks a lot.</p>\n\n<pre><code>Private Sub Transfer_Click()\n\nApplication.ScreenUpdating = False\nSheets(\"List\").Select\nv = Range(\"A2\").End(xlDown).Row\nDim a()\nDim b()\nReDim a(v - 1)\nReDim b(v - 1)\nSheets(\"Yahoo\").Select\nFor i = 0 To v - 1 \na(i) = Cells(i + 7, 4) \nb(i) = Cells(i + 7, 5)\nNext\n\nChDir \"C:\\Users\\Desktop\\Data Analysis\"\nWorkbooks.Open Filename:=\"C:\\Users\\Desktop\\Data Analysis\\Data.xlsx\"\n\nSheets(\"List\").Select\nFor i = 2 To Range(\"A1\").End(xlDown).Row \nSheets(\"List\").Select \nk = Cells(i, 1) \nIf k = \"\" Then Exit For \nSheets(k).Select \nh = Range(\"B8\").End(xlDown).Row \nCells(h + 1, \"B\") = a(i - 2) \nCells(h + 1, \"F\") = b(i - 2)\nNext\n\nWindows(\"Data.xlsm\").Activate\nSheets(\"Yahoo\").Select\nApplication.CutCopyMode = False\nWorkbooks(\"Data.xlsx\").Save\nWorkbooks(\"Data.xlsx\").Close\nApplication.ScreenUpdating = True\nMsgBox \"Successfully transferred!\", vb0XOnly, \"Notice\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1476869396, "post_id": 40127317, "comment_id": 67524593, "body": "Can you show us the code you are using?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1476869624, "post_id": 40127317, "comment_id": 67524761, "body": "can be done with Excel formula too <code>=Right(A1,Find(&quot;&gt;&quot;,A1))&amp;&quot;&gt;&quot;&amp;Left(A1,Find(&quot;&gt;&quot;,A1)-1)</code>"}, {"owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1476870191, "post_id": 40127317, "comment_id": 67525221, "body": "Reverse does what it says on the tin, literally. Excel does not understand that you think 15 is a number, it reads 1 and 5 and then reverse it to 51. Use @Slai method above."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "is_accepted": true, "score": 1, "last_activity_date": 1476870499, "creation_date": 1476870499, "answer_id": 40127824, "question_id": 40127317, "link": "https://stackoverflow.com/questions/40127317/reverse-some-text-in-cell-selected-vba/40127824#40127824", "title": "reverse some text in cell selected - VBA", "body": "<p>You first need to find the position of the \">\" in the cell. you do this by taking the contents of the cell and treating it as a String and finding the \">\"</p>\n\n<p>This is done in the line beginning arrowPosition. This is the integer value of the position of the \">\" in you original string</p>\n\n<p>Next use Left to extract the text up to the \">\" and Right to extract the text after the \">\"</p>\n\n<p>Then build a new String of rightstr &amp; \">\" &amp; leftStr.</p>\n\n<p>Note I input my data from Sheet1 B5 but you can just use any source as long as it is a String in the correct format.</p>\n\n<pre><code>Sub Test()\n\nDim myString As String\n\nmyString = Sheets(\"Sheet1\").Range(\"B5\")\nDebug.Print myString\nDebug.Print reverseString(myString)\n\nEnd Sub\n\n\nFunction reverseString(inputString As String) As String\n\nDim leftStr As String\nDim rightStr As String\nDim arrowPosition As Integer\n\narrowPosition = InStr(1, inputString, \"&gt;\")\nleftStr = Left(inputString, arrowPosition - 1)\nrightStr = Right(inputString, Len(inputString) - arrowPosition)\nreverseString = rightStr &amp; \"&gt;\" &amp; leftStr\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "is_accepted": false, "score": 1, "last_activity_date": 1476874966, "creation_date": 1476874966, "answer_id": 40129607, "question_id": 40127317, "link": "https://stackoverflow.com/questions/40127317/reverse-some-text-in-cell-selected-vba/40129607#40129607", "title": "reverse some text in cell selected - VBA", "body": "<p>just because you look for a VBA, you can add this function into your code:</p>\n\n<pre><code>Function rev(t As String) As String\n    s = Split(t, \"&gt;\", 2)\n    rev = s(1) &amp; \"&gt;\" &amp; s(0)\nEnd Function\n</code></pre>\n\n<p>of course only if you have to reverse 2 number, otherwise you'll loop the \"s\", but the function would lose its usefulness</p>\n"}], "owner": {"reputation": 11, "user_id": 7040661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7c5b777f9417e68dcbf75df8127287?s=128&d=identicon&r=PG&f=1", "display_name": "YONeGo", "link": "https://stackoverflow.com/users/7040661/yonego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 40127824, "answer_count": 2, "score": -2, "last_activity_date": 1476874966, "creation_date": 1476869125, "last_edit_date": 1531164843, "question_id": 40127317, "link": "https://stackoverflow.com/questions/40127317/reverse-some-text-in-cell-selected-vba", "title": "reverse some text in cell selected - VBA", "body": "<p>I'm rooky for VBA. I have some problem about reversing my data on <strong>VBA-Excel</strong>. My data is \"<strong>3>8</strong> , <strong>6>15</strong> , <strong>26>41</strong> (each data on difference cells)\" that i could reverse \"3>8\" to \"8>3\" follow my requirement by using function reverse. But i couldn't reverse \"6>15\" and \"26>41\" to \"15>6\" and \"41>26\". It will be \"51>6\" and \"14>62\" that failure, I want to be \"15>6\" and \"41>26\".</p>\n\n<p><i>Reverse = StrReverse(Trim(str))</i></p>\n\n<p>Help me for solve my issue please and thank for comment.</p>\n"}, {"tags": ["vba", "outlook", "conditional", "signature"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1476869209, "post_id": 40127197, "comment_id": 67524459, "body": "When you say <b>to no avail</b>, what does it actually do? does it not match the either of the emails you specified? if not then what email address does <code>oReply.SenderEmailAddress</code> return?"}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476873279, "post_id": 40128364, "comment_id": 67527471, "body": "Hi, thanks for the reply, however this retreives sender address of the original email. I am essentially trying to retrieve <i>my own</i> sender address (the mailbox I intend to send the reply from) and use this to determine the appropriate mail contents."}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476874688, "post_id": 40128364, "comment_id": 67528615, "body": "Hey! this actually <b>had</b> some merit! I was able to use this to the <i>oReply</i> object and get the email address of the shared mailbox (there is some problem for the private one but I think I will be able to resolve it eventually)."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476874952, "post_id": 40128364, "comment_id": 67528824, "body": "Try this <code>oReply.Sendusingaccount.smtpaddress</code>"}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476876468, "post_id": 40128364, "comment_id": 67530029, "body": "This always retrieves the address of the private mailbox (both the mailboxes are under the same account). Updating question with current progress."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476880924, "post_id": 40128364, "comment_id": 67533271, "body": "Had a quick look and found this: <code>oReply.Session.Accounts.Item(1).DisplayName</code>. I think as there will only ever be 1 account for <code>oReply</code> session, it should give you the email address. Saying that, as I only have 1 account in my mailbox, I cannot properly test it"}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1476881529, "post_id": 40128364, "comment_id": 67533749, "body": "Again, this gave just the address of the private mailbox. Anyway - my solution is to use the original code snippet with <i>On Error</i>. The stuff works well for shared mailboxes and I do not expect users having more than one non-shared mailbox, so the private signature can be left in a simple <i>Else</i>."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1476871895, "creation_date": 1476871895, "answer_id": 40128364, "question_id": 40127197, "link": "https://stackoverflow.com/questions/40127197/reply-body-conditioned-by-mailbox-it-is-sent-from/40128364#40128364", "title": "Reply body conditioned by mailbox it is sent from", "body": "<p>I have something that I use to get sender email (as its dependent on your email exchange)<br></p>\n\n<pre><code>Dim strSendersEmailAddress As String\n\nIf oItem.SenderEmailType = \"EX\" Then\n    strSendersEmailAddress = oItem.Sender.GetExchangeUser.PrimarySmtpAddress\nElse\n    strSendersEmailAddress = oItem.SenderEmailAddress\nEnd If\n</code></pre>\n\n<p>You will have to get the email address before you <code>Set oReply = oItem.Reply</code></p>\n"}], "owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476878084, "creation_date": 1476868879, "last_edit_date": 1476878084, "question_id": 40127197, "link": "https://stackoverflow.com/questions/40127197/reply-body-conditioned-by-mailbox-it-is-sent-from", "title": "Reply body conditioned by mailbox it is sent from", "body": "<p>So I have multiple mailboxes under my Outlook account and I am trying to get them to generate reply template based on the mailbox I am replying from (one is private, one is shared). I have tried to base the condition on <em>SenderName</em> and <em>SenderEmailAddress</em>, but to no avail (reply email gets generated with the contents of the previous email retrieved but the text I intend to put in front of it is not there; the cause is that the value of <em>oReply.SenderEmailAddress</em> is empty as <em>Else</em> clause will write the stuff as intended).</p>\n\n<p>(and yes, there are snippets from code enabling reply with attachments)</p>\n\n<pre><code>Sub ReplyWithAttachments()\n    Dim oReply As Outlook.MailItem\n    Dim oItem As Object\n    Dim sSignature As String\n\n    Set oItem = GetCurrentItem()\n    If Not oItem Is Nothing Then\n        Set oReply = oItem.Reply\n\n        If oReply.SenderEmailAddress = \"mailbox.private@something.com\" Then\n            sSignature = \"Hello and welcome!\"\n        ElseIf oReply.SenderEmailAddress = \"mailbox.shared@something.com\" Then\n            sSignature = \"Go to hell!\"        \n        End If\n\n        CopyAttachments oItem, oReply\n        oReply.HTMLBody = sSignature &amp; oReply.HTMLBody\n        oReply.Display\n        oItem.UnRead = False\n    End If\n\n    Set oReply = Nothing\n    Set oItem = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>\nso I managed to get somewhere with</p>\n\n<pre><code>Set oReply = oItem.Reply\nsMailBox = oReply.Sender.GetExchangeUser.Address\n\nIf sMailBox = \"mailbox.private@something.com\" Then\n    sSignature = \"whatever\"\nElseIf sMailBox = \"mailbox.shared@something.com\" Then\n    sSignature = \"bla bla bla\"\nElse\n    sSignature = \"Something\"\n</code></pre>\n\n<p>The code works as intended for the shared mailbox but for the private one, it errors out with <em>Object variable or With block variable not set</em> pointing to .<em>Sender</em></p>\n\n<pre><code>sMailBox = oReply.Sender.GetExchangeUser.Address\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "is_accepted": false, "score": 0, "last_activity_date": 1476976269, "creation_date": 1476976269, "answer_id": 40158262, "question_id": 40127176, "link": "https://stackoverflow.com/questions/40127176/combining-multiple-ms-access-queries-into-one-existing-table/40158262#40158262", "title": "Combining multiple ms access queries into one existing table", "body": "<p>First, you should combine this into one query.  The way you have it each query selects just one column from the <code>Dump</code> table.  If you keep the queries separate you'd have to <code>JOIN</code> each of them, which is a pain and creates more opportunities for error.  As one query it would look like:</p>\n\n<pre><code>INSERT INTO [Output] \n(\n    SERVICE_REQUEST_NO,\n    EMERTEL_NOss,\n    LOGGED_DATEss,\n    PART_NOss,\n    PART_DESCss,\n    STATUS_DESCss,\n    STATUS_DATEss\n) \nSELECT DISTINCT\nSERVICE_REQUEST_NO,\nConcatrelated(\n\"EMERTEL_NO\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS EMERTEL_NOss,\nConcatrelated(\n\"LOGGED_DATE\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS LOGGED_DATEss,\nConcatrelated(\n\"PART_NO\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS PART_NOss,\nConcatrelated(\n\"PART_DESC\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS PART_DESCss,\nConcatrelated(\n\"STATUS_DESC\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS STATUS_DESCss,\nConcatrelated(\n\"STATUS_DATE\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") \n    AS STATUS_DATEss\nFROM [Dump]\n</code></pre>\n\n<p>I'm not exactly sure why you're using <code>DISTINCT</code> in each query without seeing your actual data.  For the purposes of this answer I'm assuming that you're using it to avoid exact duplicate rows in <code>[Output</code>.  The single <code>DISTINCT</code> at the top of my select list takes care of that.</p>\n"}], "owner": {"reputation": 11, "user_id": 6924953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b328189eff3a1b04ada4f99507e7bc?s=128&d=identicon&r=PG&f=1", "display_name": "Chetan.Bhavsar", "link": "https://stackoverflow.com/users/6924953/chetan-bhavsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476976269, "creation_date": 1476868791, "last_edit_date": 1476968721, "question_id": 40127176, "link": "https://stackoverflow.com/questions/40127176/combining-multiple-ms-access-queries-into-one-existing-table", "title": "Combining multiple ms access queries into one existing table", "body": "<p>I'm stuck with my poor knowledge of MS Access query. I have 2 tables. </p>\n\n<pre><code>1. Table Output and\n2. Dump : this is a linked table to an excel file\n</code></pre>\n\n<p>I have used Concatenate user function found at <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow\">http://allenbrowne.com/func-concat.html</a></p>\n\n<p>I have total 8 different queries as below:</p>\n\n<pre><code>Query_1 : DELETE table FROM [Output];\n\nQuery_2 : INSERT INTO [Output] (SERVICE_REQUEST_NO) SELECT DISTINCT SERVICE_REQUEST_NO\nFROM Dump\nORDER BY SERVICE_REQUEST_NO;\n\nQuery_3 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"EMERTEL_NO\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS EMERTEL_NOss\nFROM Dump AS i;\n\nQuery_4 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"LOGGED_DATE\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS LOGGED_DATEss\nFROM Dump AS i;\n\nQuery_5 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"PART_NO\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS PART_NOss\nFROM Dump AS i;\n\nQuery_6 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"PART_DESC\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS PART_DESCss\nFROM Dump AS i;\n\nQuery_7 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"STATUS_DESC\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS STATUS_DESCss\nFROM Dump AS i;\n\nQuery_8 : SELECT DISTINCT i.SERVICE_REQUEST_NO, ConcatRelated(\n\"STATUS_DATE\",\n\"Dump\",\n\"SERVICE_REQUEST_NO = \"\"\" &amp; [SERVICE_REQUEST_NO] &amp; \"\"\"\") AS STATUS_DATEss\nFROM Dump AS i;\n</code></pre>\n\n<p>My problem is i want to update or insert the out put of all these queries to table \"Output\" for matching <code>\"SERVICE_REQUEST_NO\"</code> field</p>\n\n<p>Do let me know if you want to have a look on my MS Access database.</p>\n\n<p>Please help me.</p>\n\n<p>Thanks for support <a href=\"https://i.stack.imgur.com/bBZ5a.jpg\" rel=\"nofollow\">Table Output fields</a>\n<a href=\"https://i.stack.imgur.com/bBZ5a.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/bBZ5a.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1476868854, "post_id": 40127044, "comment_id": 67524210, "body": "If you want the index of the first set of ones that is longer then the previous set of zeros, wouldn&#39;t that be the second set of ones in your example above? and not the 4th set of ones. Or have I misunderstood things?"}, {"owner": {"reputation": 13, "user_id": 6948938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d93a077efd64679eb8fe8aa3323be76?s=128&d=identicon&r=PG&f=1", "display_name": "dani&#228;la", "link": "https://stackoverflow.com/users/6948938/dani%c3%a4la"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1476869518, "post_id": 40127044, "comment_id": 67524683, "body": "no, i need a set of ones that is longer than following set of zeros not previous set of zeros."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6948938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d93a077efd64679eb8fe8aa3323be76?s=128&d=identicon&r=PG&f=1", "display_name": "dani&#228;la", "link": "https://stackoverflow.com/users/6948938/dani%c3%a4la"}, "edited": false, "score": 0, "creation_date": 1476873993, "post_id": 40127488, "comment_id": 67528031, "body": "I&#39;m sorry, it doesn&#39;t work like i need it. If i take 0001100000111001111111 the code returns 11 and this isn&#39;t the first index of longer set of ones then previous zeros. But thank you for your help!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 13, "user_id": 6948938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d93a077efd64679eb8fe8aa3323be76?s=128&d=identicon&r=PG&f=1", "display_name": "dani&#228;la", "link": "https://stackoverflow.com/users/6948938/dani%c3%a4la"}, "edited": false, "score": 0, "creation_date": 1476874291, "post_id": 40127488, "comment_id": 67528281, "body": "Hi, I did say it needs full testing :) , and I&#39;d coded the wrong way round :)  The code was a suggestion to get you started, the fix is you need to have another variable to hold the total of intEmpties and the Len checks.  Use this code with the locals window showing and you&#39;ll see what&#39;s happening in arrSplitInput and see the fix logic."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476876217, "last_edit_date": 1476876217, "creation_date": 1476869541, "answer_id": 40127488, "question_id": 40127044, "link": "https://stackoverflow.com/questions/40127044/find-first-longer-row-of-ones-than-following-rows-of-zeros-in-array-in-vba/40127488#40127488", "title": "find first longer row of ones than following rows of zeros in array in VBA", "body": "<p>Not fully tested, but something like this.  SORRY, I've coded > previous to, i'll change later.</p>\n\n<pre><code>Sub Testsing()\n\nDim strInput As String\nDim arrSplitInput() As String\nDim intLoop As Integer\nDim intZeroes As Integer\nDim intIndex As Integer\n\nstrInput = \"0001100000111001111111\"\narrSplitInput = Split(strInput, \"0\")\n\nFor intLoop = 0 To UBound(arrSplitInput)\n    If arrSplitInput(intLoop) = \"\" Then\n        intZeroes = intZeroes + 1\n    Else\n        If intIndex &gt; 0 Then intZeroes = intZeroes + 1\n        intIndex = intIndex + intZeroes\n        If Len(arrSplitInput(intLoop)) &gt; intZeroes Then\n            Debug.Print Mid(strInput, intIndex - 1, Len(arrSplitInput(intLoop)))\n            Stop\n        Else\n            intIndex = intIndex + Len(arrSplitInput(intLoop)) + 1\n        End If\n\n        intZeroes = 0\n\n    End If\n\nNext intLoop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1476942853, "post_id": 40138054, "comment_id": 67562244, "body": "@Hambone, I wish it were, while it&#39;s only age... anyway thanks!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1476987057, "post_id": 40138054, "comment_id": 67592018, "body": "@dani&#228;la, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1477749635, "post_id": 40138054, "comment_id": 67895505, "body": "@dani&#228;la, it&#39;d be nice of you giving proper feedback to people trying at helping you. thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1476898582, "creation_date": 1476898582, "answer_id": 40138054, "question_id": 40127044, "link": "https://stackoverflow.com/questions/40127044/find-first-longer-row-of-ones-than-following-rows-of-zeros-in-array-in-vba/40138054#40138054", "title": "find first longer row of ones than following rows of zeros in array in VBA", "body": "<p>you can use this function:</p>\n\n<pre><code>Option Explicit\n\nFunction GetOnes(inputStrng As String) As String\n    Dim i As Long\n    Dim zeros As Variant, ones As Variant\n\n    zeros = Split(WorksheetFunction.Trim(Replace(inputStrng, \"1\", \" \")))\n    ones = Split(WorksheetFunction.Trim(Replace(inputStrng, \"0\", \" \")))\n\n    For i = 0 To UBound(ones)\n        If Len(ones(i)) &gt; Len(zeros(i)) Then\n            GetOnes = ones(i)\n            Exit For\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>to be exploited as follows:</p>\n\n<pre><code>Sub main()    \n    MsgBox \"the first 'ones' sequence longer then subsequent 'zero' sequence is:\" &amp; vbCrLf &amp; vbCrLf &amp; vbTab &amp; GetOnes(\"0001100000111001111111\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1476914129, "creation_date": 1476914129, "answer_id": 40142153, "question_id": 40127044, "link": "https://stackoverflow.com/questions/40127044/find-first-longer-row-of-ones-than-following-rows-of-zeros-in-array-in-vba/40142153#40142153", "title": "find first longer row of ones than following rows of zeros in array in VBA", "body": "<p>Answer is overkill for a simple array job, but just a taste of OO VBA to see what you could get if you needed to extend the information required from the block of 1s.</p>\n\n<p>Put in a <strong>Class module</strong> (Alt-I-C) <strong><em>named NumBlock</em></strong></p>\n\n<pre><code>Option Explicit\n\nPrivate pLength As Long\nPrivate pIndex As Long\n\nPublic Property Get Length() As Long\n    Length = pLength\nEnd Property\n\nPublic Property Let Length(val As Long)\n    pLength = val\nEnd Property\n\nPublic Property Get Index() As Long\n    Index = pIndex\nEnd Property\n\nPublic Property Let Index(val As Long)\n    pIndex = val\nEnd Property\n</code></pre>\n\n<p>Regular module:</p>\n\n<pre><code>Option Explicit\n\nPublic Function getIndexOfLongerOnes(arr As Variant) As NumBlock\n\n  If InStr(1, TypeName(arr), \"()\", vbTextCompare) &lt; 1 Then\n        Err.Raise vbObjectError + 888, , \"The argument was not an array!\"\n  End If\n  Dim switched As Boolean\n  Dim a As Long, z As Long\n  Dim ones As NumBlock, zeroes As NumBlock\n\n  a = LBound(arr)\n  z = UBound(arr)\n  switched = True\n  Set ones = New NumBlock\n  Set zeroes = New NumBlock\n\n  Dim i As Long\n  For i = a To z\n        If i &gt; a Then\n              If arr(i) &lt;&gt; arr(i - 1) Then\n                    switched = True\n              Else\n                    switched = False\n              End If\n        End If\n        If arr(i) = 1 Then\n              If switched Then\n                    If ones.Length &gt; zeroes.Length Then\n                          Set getIndexOfLongerOnes = ones\n                          Exit Function\n                    End If\n                    Set ones = New NumBlock\n                    ones.Length = 1\n                    ones.Index = i\n              Else\n                    ones.Length = ones.Length + 1\n              End If\n        Else\n              If switched Then\n                    Set zeroes = New NumBlock\n                    zeroes.Length = 1\n                    zeroes.Index = i\n              Else\n                    zeroes.Length = zeroes.Length + 1\n              End If\n        End If\n\n  Next i\n\nEnd Function\n\nPublic Sub test()\n\n  On Error GoTo handler\n  Dim testArr As Variant\n  Dim block As NumBlock\n  testArr = Array(0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1)\n  Set block = getIndexOfLongerOnes(testArr)\n\n  MsgBox \"Index: \" &amp; block.Index &amp; vbNewLine &amp; \"Length: \" &amp; block.Length\n\n  Exit Sub\nhandler:\n  MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1476914744, "creation_date": 1476914744, "answer_id": 40142297, "question_id": 40127044, "link": "https://stackoverflow.com/questions/40127044/find-first-longer-row-of-ones-than-following-rows-of-zeros-in-array-in-vba/40142297#40142297", "title": "find first longer row of ones than following rows of zeros in array in VBA", "body": "<p>A simpler array job:</p>\n\n<pre><code>Public Function getArrIndex(arr As Variant) As Long\n  Dim switched As Boolean\n  Dim a As Long, z As Long, currOnesIndex As Long, currZeroesIndex As Long, currOnesLength As Long, currZeroesLength As Long\n  getArrIndex = -1 'default to -1 as not found qualifying set of ones\n  a = LBound(arr)\n  z = UBound(arr)\n  switched = True\n\n  Dim i As Long\n  For i = a To z\n        If i &gt; a Then\n              If arr(i) &lt;&gt; arr(i - 1) Then\n                    switched = True\n              Else\n                    switched = False\n              End If\n        End If\n        If arr(i) = 1 Then\n              If switched Then\n                    If currOnesLength &gt; currZeroesLength Then\n                          getArrIndex = currOnesIndex\n                          Exit Function\n                    End If\n                    currOnesLength = 1\n                    currOnesIndex = i\n              Else\n                    currOnesLength = currOnesLength + 1\n              End If\n        Else\n              If switched Then\n                    currZeroesLength = 1\n                    currZeroesIndex = i\n              Else\n                    currZeroesLength = currZeroesLength + 1\n              End If\n        End If\n\n  Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6948938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d93a077efd64679eb8fe8aa3323be76?s=128&d=identicon&r=PG&f=1", "display_name": "dani&#228;la", "link": "https://stackoverflow.com/users/6948938/dani%c3%a4la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1476914744, "creation_date": 1476868445, "question_id": 40127044, "link": "https://stackoverflow.com/questions/40127044/find-first-longer-row-of-ones-than-following-rows-of-zeros-in-array-in-vba", "title": "find first longer row of ones than following rows of zeros in array in VBA", "body": "<p>I have an array filled with zeros and ones like that:</p>\n\n<p>...00011000111100001100<strong>1</strong>1111100111...</p>\n\n<p>it always starts with zeros and ends with ones.</p>\n\n<p>I have to find the index of the beginning of the first row of ones, that is longer than the following row of zeros. The bold one above.</p>\n\n<p>I have already set a with the index of the first one, and set b with the index of the last zero.</p>\n\n<pre><code>k = 0\nDo While array(k) = 0\n\n    k = k + 1\n\nLoop\n\n a = k\n\nl = endOfArray\nDo While array(l) = 1\n\n    l = l - 1\n\nLoop\n\n b = l\n</code></pre>\n\n<p>How can i go on?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1476865454, "post_id": 40125469, "comment_id": 67521932, "body": "Have you tried .FireEvent(&quot;Click&quot;)  also, why not GetElementByID(&quot;Tab3&quot;)?"}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1476870486, "post_id": 40125469, "comment_id": 67525476, "body": "@Nathan_Sav : Tried both methods Nathan. FireEvent(&quot;Click&quot;) I am getting an &#39;Invalid argument&#39; error and the GetElemenetByID does not do anything."}, {"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1476870769, "post_id": 40125469, "comment_id": 67525687, "body": "Pop up will be having another instance of browser, hence you need to first find that new window by searching for title and then search for &quot;Tab3&quot; in that browser instance. It seems that your current code is  searching for Tab3 in parent instance of browser."}, {"owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "reply_to_user": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1476870947, "post_id": 40125469, "comment_id": 67525807, "body": "@J.B. But when I write the innerText after the pop up shows in Excel, it is able to get the values in the first tab(Which is &#39;Clicked&#39; by default)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1476888532, "post_id": 40125469, "comment_id": 67539398, "body": "Hi, sorry I missed the pop up bit.  Look at using Microsoft HTML Controls properly, using the correct objects, you&#39;ll be able to decipher things like this.  Find the web browser that&#39;s opened, this is a great start  <a href=\"https://msdn.microsoft.com/en-us/library/ms970672.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms970672.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1476889383, "creation_date": 1476889383, "answer_id": 40135145, "question_id": 40125469, "link": "https://stackoverflow.com/questions/40125469/how-do-i-click-a-tab-inside-a-pop-using-vba-in-internet-explorer/40135145#40135145", "title": "How do I click a tab inside a pop using vba in Internet Explorer", "body": "<p>Not posting as an answer per-se, just better formatting here.  Something like this, you'll need to build around.  It uses Microsoft Internet Controls and HTML Object library.</p>\n\n<p>Hope it helps</p>\n\n<pre><code>Sub n()\n\nDim arrExplorerWindows As SHDocVw.ShellWindows\nDim objIE As InternetExplorer\nDim intExplorerWindowLoop As Integer\nDim doc As MSHTML.HTMLDocument\nDim eleTab As MSHTML.IHTMLElement\n\nSet arrExplorerWindows = New SHDocVw.ShellWindows\n\nFor intExplorerWindowLoop = 0 To arrExplorerWindows.Count - 1\n\n    If arrExplorerWindows(intExplorerWindowLoop).Name = \"Internet Explorer\" Then\n        If arrExplorerWindows(intExplorerWindowLoop).LocationURL = _\n            \"http://www.investinganswers.com/\" Then\n            Set objIE = arrExplorerWindows(intExplorerWindowLoop)\n            Set doc = objIE.Document\n            Set eleTab = doc.getElementById(\"Tab3\")\n            eleTab.Click\n        End If\n    End If\n\nNext intExplorerWindowLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 701, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476889383, "creation_date": 1476864062, "question_id": 40125469, "link": "https://stackoverflow.com/questions/40125469/how-do-i-click-a-tab-inside-a-pop-using-vba-in-internet-explorer", "title": "How do I click a tab inside a pop using vba in Internet Explorer", "body": "<p>I am relatively new to VBA and I am trying to achieve this,</p>\n\n<ol>\n<li>Navigate to URL</li>\n<li>Click on a Button which opens a pop up that has 3 tabs</li>\n<li>Click on the 3rd tab</li>\n<li>Scrap some info</li>\n</ol>\n\n<p>I have been successful with 1 and 2. But I am unable to click on any of the tabs inside the pop up using VBA. </p>\n\n<p>This is the Html snippet of the pop up.</p>\n\n<pre><code>'&lt;ul class=\"clearfix\" id=\"historyTabs\"&gt;\n            &lt;li class=\"ajaxCall jsonpCall selected\" id=\"Tab1\"&gt;&lt;a href=\"javascript:;\"&gt;Some Details&lt;/a&gt;&lt;/li&gt;\n\n            &lt;li class=\"ajaxCall\" id=\"Tab2\"&gt;&lt;a class=\"Class1\" href=\"javascript:;\"&gt;More Details&lt;/a&gt;&lt;/li&gt;\n\n            &lt;li id=\"Tab3\"&gt;&lt;a href=\"javascript:;\"&gt;Even more Details&lt;/a&gt;&lt;span id=\"Tab31\" style=\"display: none;\"&gt;&lt;/span&gt;&lt;/li&gt;\n        &lt;/ul&gt;\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code> y = 1\n Set ec = HTML.getElementsByTagName(\"li\")\n For Each e In ec\n    idvalue = e.getAttribute(\"id\")\n    If idvalue = \"Tab3\" Then\n        idinnertext = e.innerText\n        Sheets(\"Sheet2\").Cells(y, 1).Value = idinnertext\n        e.click\n    Else \n        Sheets(\"Sheet2\").Cells(y, 2).Value = \"Not Tab3\"\n        y = y + 1\n   End if\n Next e\n</code></pre>\n\n<p>The code writes \"Even more details\" in my excel sheet but does not click the tab.</p>\n\n<p>Request some help with this.</p>\n\n<p>Thanks,\nAkilesh         </p>\n"}, {"tags": ["vba", "excel", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "edited": false, "score": 0, "creation_date": 1476866147, "post_id": 40125695, "comment_id": 67522367, "body": "Thanks for the information! However I do not know how to use Resume with markers, for the prompt is consistently &quot;Next&quot; expected (i.e.: in On Error Resume Next)..."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "edited": false, "score": 0, "creation_date": 1476866308, "post_id": 40125695, "comment_id": 67522478, "body": "Just use the line <code>Resume EXITHANDLER</code> instead of the line <code>GoTo EXITHANDLER</code>. I&#39;ll edit in some more information."}, {"owner": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "edited": false, "score": 0, "creation_date": 1476866529, "post_id": 40125695, "comment_id": 67522658, "body": "IT WORKS. THANK YOU SO MUCH. :D"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1476866600, "last_edit_date": 1592644375, "creation_date": 1476864753, "answer_id": 40125695, "question_id": 40124705, "link": "https://stackoverflow.com/questions/40124705/error-handling-within-a-loop-for-pivottable-object-sorting/40125695#40125695", "title": "Error Handling within a Loop for PivotTable object sorting", "body": "<p>This is from <a href=\"https://msdn.microsoft.com/en-us/library/5hsw66as.aspx\" rel=\"nofollow noreferrer\">MSDN</a> on Visual Studio but I think it applies to VBA in the same way.</p>\n<blockquote>\n<p>An &quot;enabled&quot; error handler is one that is turned on by an On Error statement. An &quot;active&quot; error handler is an enabled handler that is in the process of handling an error.</p>\n<p>If an error occurs while an error handler is active (between the occurrence of the error and a Resume, Exit Sub, Exit Function, or Exit Property statement), the current procedure's error handler cannot handle the error. Control returns to the calling procedure</p>\n</blockquote>\n<p>So after your code first gets to <code>On Error GoTo ERRHANDLER</code>, <code>ERRHANDLER</code> is <em>enabled</em>. Then when an error occurs <code>ERRHANDLER</code> is <em>activated</em> and handles the error. When you <code>GoTo EXITHANDLER</code> it stays active and still handles the error. The <code>On Error GoTo ERRHANDLER</code> has no effect at this point.</p>\n<p>To re-enable the <code>ERRHANDLER</code> you need to use <code>Resume EXITHANDLER</code> instead of <code>GoTo EXITHANDLER</code>.</p>\n<hr />\n<p><strong>Edit</strong> on the <code>Resume</code> statement. There are three ways to use <code>Resume</code>: <code>Resume</code>, <code>Resume Next</code> and <code>Resume label</code></p>\n<p><code>Resume</code> without an argument causes the code to resume at the line that caused the error. This obviously has to be used very careful as you must be absolutely certain that you fixed the problem or you'll end up in an infinite loop.</p>\n<p><code>Resume Next</code> causes the code to resume at the line after the line that caused the error.</p>\n<p><code>Resume Label</code> is almost the same as <code>GoTo Label</code> but with this you exit the error handler and resume normal code execution. The error handler is re-enabled.</p>\n"}], "owner": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 40125695, "answer_count": 1, "score": 1, "last_activity_date": 1476866600, "creation_date": 1476861592, "last_edit_date": 1531164843, "question_id": 40124705, "link": "https://stackoverflow.com/questions/40124705/error-handling-within-a-loop-for-pivottable-object-sorting", "title": "Error Handling within a Loop for PivotTable object sorting", "body": "<p>I've been trying to sort PivotTable objects in VBA using a function I've attempted:</p>\n\n<pre><code>Public Function PTSort(PTName As String, PTFieldName as String, SortArray As Variant)\n\nDim m as Integer: m = 1 'Row counter\nDim i as Long 'Dummy Variable for cycling\n\nWith ActiveSheet.PivotTables(PTName).PivotFields(PTFieldName)\n    .Parent.ManualUpdate = True\n    For i = LBound(SortArray) To UBound(SortArray)\n        With .PivotItems(SortArray(m - 1)) 'For in-code array\n            .Position = m\n        End With\n    m = m + 1\n    Next i\n    .Parent.ManualUpdate = False\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Whilst this works well with a known set of elements within <em>SortArray</em>, I have a master list to follow whilst sorting (so as to standardise a few orders accross several PivotTables), in which the PivotTable need not necessarily contain all said PivotItems. I have hence improved it to the following:</p>\n\n<pre><code>Sub PTSort(PTName As String, PTFieldName as String, SortArray As Variant)\n\nDim m as Integer: m = 1\nDim i as Long\nDim k As Integer: k = 1 'To cycle the position independently from the array in the event of disjoint.\n\nWith ActiveSheet.PivotTables(PTName).PivotFields(PTFieldName)\n    .Parent.ManualUpdate = True\n    For i = LBound(SortArray) To UBound(SortArray)\n        On Error GoTo ERRHANDLER:\n        With .PivotItems(SortArray(k)) 'After parsing from range of cells into VariantArray, then does one not require the \"-1\"\n            .Position = m\n        End With\n    m = m + 1\nExitHandler:\n    k = k + 1\n    Next i\n    .Parent.ManualUpdate = False\nEnd With\nGoTo ENDEND:\n\nERRHANDLER:\nGoTo EXITHANDLER:\n\nENDEND:\nEnd Sub\n</code></pre>\n\n<p>The <em>OnError GoTo</em> seems to only work once though, irregardless of how high up placed it?</p>\n\n<p>Help would be greatly appreciated. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1476864678, "creation_date": 1476864678, "answer_id": 40125665, "question_id": 40124700, "link": "https://stackoverflow.com/questions/40124700/excel-vba-removeduplicates-function-with-case-sensitivity/40125665#40125665", "title": "Excel VBA RemoveDuplicates function with case sensitivity", "body": "<p>Try the following code using a <code>Dictionary</code> to remove duplicates with case sensitivity:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    RemoveDuplicates Sheet1.Range(\"A1:A12\")\nEnd Sub\n\nSub RemoveDuplicates(rngDataColumn As Range)\n'assumes rngDataColumn is a column of data\n\n    Dim dic As Object\n    Dim rngCell As Range\n    Dim varKey As Variant\n    Dim lngCounter As Long\n\n    'create dictionary\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n\n    'dictionary becomes case sensitive\n    dic.CompareMode = vbBinaryCompare\n\n    'iterate range for unique values\n    For Each rngCell In rngDataColumn\n        If Not dic.Exists(rngCell.Value) Then\n            dic.Add Key:=rngCell.Value, Item:=True\n        End If\n    Next rngCell\n\n    'clear source range\n    rngDataColumn.ClearContents\n\n    'output unique items - with case sensitivity\n    lngCounter = 1\n    For Each varKey In dic.Keys\n        rngDataColumn(lngCounter, 1).Value = varKey\n        lngCounter = lngCounter + 1\n    Next varKey\n\nEnd Sub\n</code></pre>\n\n<p>A1:A12 in my test case is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0V4EN.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/0V4EN.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, to update your recorded macro, you could try:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    ActiveWorkbook.Sheets(3).Range(\"A:A\").Clear\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n\n    'use the new function here\n    RemoveDuplicates Selection\n    'Selection.RemoveDuplicates Columns:=1, Header:=xlNo\n\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    'Range(\"B12\").Select\n    Selection.End(xlToRight).Select\n    ActiveWorkbook.Sheets(3).Range(\"A:A\").Clear\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 1, "last_activity_date": 1476864785, "creation_date": 1476864785, "answer_id": 40125707, "question_id": 40124700, "link": "https://stackoverflow.com/questions/40124700/excel-vba-removeduplicates-function-with-case-sensitivity/40125707#40125707", "title": "Excel VBA RemoveDuplicates function with case sensitivity", "body": "<p>I have found <a href=\"http://www.mrexcel.com/forum/excel-questions/577181-case-sensitive-removal-duplicates-visual-basic-applications.html\" rel=\"nofollow\">here</a> and tested some nice solution, that seems to meet your expectations. You have to paste this function into your project:</p>\n\n<pre><code>Option Compare Binary\nSub deleteExactDuplicates(ByVal rng As Range)\n    Application.ScreenUpdating = False\n    With CreateObject(\"scripting.dictionary\")\n        For Each i In rng.Cells\n            v = i.Value\n            If .exists(v) Then\n                i.ClearContents\n            Else\n                .Add v, 1\n            End If\n        Next i\n    End With\n    On Error Resume Next\n    rng.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>Then, you have to call it in your code. If I understand, you want to remove duplicates from selected range, so the macro would look like this:</p>\n\n<pre><code>Sub test()\n   deleteExactDuplicates Selection\nEnd Sub\n</code></pre>\n\n<p>Now, this solution delete not only the values in selected range, but also entire rows, where duplicated values occurred. Are you OK with that, or you need something that removes duplicates only from particular range?</p>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 0, "accepted_answer_id": 40125665, "answer_count": 2, "score": 1, "last_activity_date": 1476864785, "creation_date": 1476861576, "last_edit_date": 1476864475, "question_id": 40124700, "link": "https://stackoverflow.com/questions/40124700/excel-vba-removeduplicates-function-with-case-sensitivity", "title": "Excel VBA RemoveDuplicates function with case sensitivity", "body": "<p>I'm trying to remove some duplicates from selected column, but the function removes all duplicates irrespective of the case. <code>RemoveDuplicates</code> considers lower case, upper case, etc as duplicate. E.g. the function removed <code>CENTRAL</code>, <code>central</code> and <code>Central</code>.</p>\n\n<p>I have simply recorded the following code and only changed it a little bit. I need to keep items with different cases and don't want to remove as duplicates.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    ActiveWorkbook.Sheets(3).Range(\"A:A\").Clear\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.RemoveDuplicates Columns:=1, Header:=xlNo\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    'Range(\"B12\").Select\n    Selection.End(xlToRight).Select\n    ActiveWorkbook.Sheets(3).Range(\"A:A\").Clear\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1476865634, "post_id": 40125021, "comment_id": 67522044, "body": "Thanks a lot for your explain. It&#39;s really clair and helpful."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1476867711, "post_id": 40125021, "comment_id": 67523403, "body": "And excuse me, I have another question. Can I define a <code>String</code> in <code>UserForm3</code>, and I distribute the &quot;aaa&quot; or &quot;bbb&quot; to this <code>String</code>in the <code>UserForm2</code> by clicking the buttons? I&#39;ve tried this but failed."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 1, "creation_date": 1476868319, "post_id": 40125021, "comment_id": 67523818, "body": "Yes you can, you have to declare is as a public member variable or property of the userform to do so (it can&#39;t be a private variable nor defined in a sub or a function)"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1476864831, "last_edit_date": 1476864831, "creation_date": 1476862675, "answer_id": 40125021, "question_id": 40124252, "link": "https://stackoverflow.com/questions/40124252/vba-how-to-use-buttons-to-deliver-different-values-between-userforms/40125021#40125021", "title": "VBA_How to use buttons to deliver different values between UserForms", "body": "<p>In your code, the <code>Initialize</code> event of <code>Userform3</code> will be called before you set the <code>Zone</code>, just when you set UF3 (if the default instance of userform3 is not already loaded somewhere else).</p>\n\n<p>Since you are not using the keyword <code>new</code> to instantiate new userforms objects, it uses the default instance.</p>\n\n<p>In your particular case, you need either to set Zone before setting UF3, so that Zone will have a value when Initialize is called in Userform3, or you can directly set UF3.Label1 to the correct value before calling UF3.Show.</p>\n\n<pre><code>Private UF3 As UserForm5\nPublic Zone As String\n\nPrivate Sub CommandButton1_Click()\n    'Either this possibility\n    Zone = \"test\"\n    Set UF3 = UserForm3\n    'or this one\n    UF3.Label1 = \"aaa\"\n    UF3.Show\nEnd Sub\n</code></pre>\n\n<p>Note that if you are using default instances of the userforms you don't even need to set them and can directly use the following code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Userform3.Label1 = \"aaa\" 'If the Userform3 default instance doesn't already exists,\n                             'the fist call to a method or a property will create and initialize it.\n                             'So here the Initialize event of Userform3 will be called\n                             'and then the value of Label1 will be changed.\n    Userform3.Show\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Additional info: Remember that Initialize will only be called once for each instance of an userform, and that calling <code>Me.Hide</code> does not unload the userform but only \"unshow\" it. So in your original code the label1 of Userform3 was set only once the first time you called <code>Set UF3 = Userform3</code>. You may have to used specific instances of the userform instead of the default one if you want to have a better control on when the userform's instances are loaded and unloaded.</p>\n"}], "owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 40125021, "answer_count": 1, "score": 0, "last_activity_date": 1476864831, "creation_date": 1476860199, "question_id": 40124252, "link": "https://stackoverflow.com/questions/40124252/vba-how-to-use-buttons-to-deliver-different-values-between-userforms", "title": "VBA_How to use buttons to deliver different values between UserForms", "body": "<p>I've met a problem when I with to use buttons to transfer values between Userformes (UF2 and UF3).</p>\n\n<p>My purpose is to use different buttons to change the content in the label of the userform3. For example, if I click 'aaa to 3', then userform3 shows up and the text in the label will be 'aaa'.</p>\n\n<p>Here is the Userform2:\n<a href=\"https://i.stack.imgur.com/LvIT1.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/LvIT1.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the code is here:</p>\n\n<pre><code>Public UF3 As UserForm3\nPublic Zone As String\n\nPrivate Sub CommandButton2_Click()\n\nSet UF3 = UserForm3\nZone = \"aaa\"\nUF3.Show\nZone = \"aaa\"\n\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\n\nSet UF3 = UserForm3\nZone = \"bbb\"\nUF3.Show\n\nEnd Sub\n</code></pre>\n\n<p>And the UserForm3:\n<a href=\"https://i.stack.imgur.com/wdy02.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/wdy02.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public UF2 As UserForm2\n\nPrivate Sub CommandButton1_Click()\n\nMe.Hide\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nSet UF2 = UserForm2\nLabel1 = UF2.Zone\n\nEnd Sub\n</code></pre>\n\n<p>But when I run it, the label in UF3 is always empty.</p>\n"}, {"tags": ["vba", "excel", "accounting"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1476860433, "post_id": 40124007, "comment_id": 67518756, "body": "<code>.Find</code> sounds like a good idea if you need to have the accounts beneath each other. Look into the <code>.End(xlDown)</code> method. It will help you find the last row of an account once you have found the first row."}, {"owner": {"reputation": 27, "user_id": 6819862, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/090f20c7ded60e2fce57ba5560b6bdde?s=128&d=identicon&r=PG&f=1", "display_name": "cpage", "link": "https://stackoverflow.com/users/6819862/cpage"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476861341, "post_id": 40124007, "comment_id": 67519298, "body": "How would I prevent <code>.End(xlDown)</code> from continuing on to the next account below it?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1476861447, "post_id": 40124007, "comment_id": 67519355, "body": "I would assume that you have at least one empty row between accounts. <code>.End(xlDown)</code> stops there (if applied to a non-empty cell) which is why it shouldn&#39;t be used to find the very last row in a column."}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1476868503, "creation_date": 1476868503, "answer_id": 40127062, "question_id": 40124007, "link": "https://stackoverflow.com/questions/40124007/offsetting-workaround-in-excel-vba/40127062#40127062", "title": "Offsetting Workaround in Excel VBA", "body": "<p>Answer to your edited question:</p>\n\n<p>The error you receive is because <code>.Find</code> didn't find anything and returned <code>Nothing</code>. Trying to access properties of <code>Nothing</code> will give the \"Object variable or With block variable not set\" error.</p>\n\n<p><code>.Find</code> doesn't handle merged cells that well. The easy solution in your case is to extend the search range so it includes the whole merged cell.</p>\n\n<pre><code>Dim Header As Range\nDim lastRow As Long\n\nWith Worksheets(\"Ledger\").Columns(\"A:C\")\n\n    Set Header = .Find(\"Cash\")\n    lastRow = Header.Row + entries\n    'I would prefer something like\n    'lastRow = Worksheets(\"Ledger\").Cells(Header.Row, \"B\").End(xlDown).Row (not tested)\n\n    Rows(lastRow).Insert Shift:=xlDown\n\n    Worksheets(\"Ledger\").Cells(lastRow, 1) = Worksheets(\"Journal\").Cells(counter + 2, 1).Value\nEnd With\n</code></pre>\n\n<p>I changed the name of the row variable so there's no confusion between the property <code>Row</code> and your variable <code>row</code>. You can see that the VBE is already confused as it's setting the property to lower case.</p>\n"}], "owner": {"reputation": 27, "user_id": 6819862, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/090f20c7ded60e2fce57ba5560b6bdde?s=128&d=identicon&r=PG&f=1", "display_name": "cpage", "link": "https://stackoverflow.com/users/6819862/cpage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 40127062, "answer_count": 1, "score": 1, "last_activity_date": 1476868503, "creation_date": 1476859286, "last_edit_date": 1476864882, "question_id": 40124007, "link": "https://stackoverflow.com/questions/40124007/offsetting-workaround-in-excel-vba", "title": "Offsetting Workaround in Excel VBA", "body": "<p>I am trying to automate posting accounting journal entries to a ledger, and am struggling with offsetting after I add new rows. My workbook has two sheets, Journal and Ledger, and my goal is to read each journal entry and add the entry to the correct T-account in the ledger by adding a new row. Most of the the copying entries works, but the macro runs into problems once the offsetting changes. I was considering using <code>.Find</code> as a better option since different T-accounts need different offsetting values depending one how many previous accounts are above them. How can I solve this offsetting row problem?</p>\n\n<p>Here is a link to the <a href=\"https://drive.google.com/file/d/0B-S_Oyu8bMqyM0RJUWFTeFY5VlE/view?usp=sharing\" rel=\"nofollow\">Excel File</a>, and below is my code in VBA.</p>\n\n<pre><code>Sub RowInsert()\n\nDim offset As Integer\noffset = 0\n\nDim counter As Integer\nFor counter = 0 To 1\n\nDim account As String\naccount = Worksheets(\"Journal\").Cells(counter + 2, 2)\n\n\nDim a As Double\n\nIf Worksheets(\"Journal\").Cells(counter + 2, 2) = \"Cash\" Then\nWorksheets(\"Ledger\").Rows(4 + offset).Insert Shift:=xlDown\n\noffset = offset + 1\n\nWorksheets(\"Ledger\").Cells(6 + offset, 1).Value = Worksheets(\"Journal\").Cells(counter + 2, 1).Value\n\n    If Worksheets(\"Journal\").Cells(counter + 2, 3).Value = Null Then\n    Worksheets(\"Ledger\").Cells(6 + offset, 3).Value = Worksheets(\"Journal\").Cells(counter + 2, 4).Value\n    Else\n    Worksheets(\"Ledger\").Cells(6 + offset, 2).Value = Worksheets(\"Journal\").Cells(counter + 2, 3).Value\n    End If\n\nElseIf Worksheets(\"Journal\").Cells(counter + 2, 2) = \"Equipment\" Then\nWorksheets(\"Ledger\").Rows(8 + offset).Insert Shift:=xlDown\n\noffset = offset + 1\n\nWorksheets(\"Ledger\").Cells(6 + offset, 1).Value = Worksheets(\"Journal\").Cells(counter + 2, 1).Value\n\n    If Worksheets(\"Journal\").Cells(counter + 2, 3).Value = Null Then\n    Worksheets(\"Ledger\").Cells(6 + offset, 3).Value = Worksheets(\"Journal\").Cells(counter + 2, 4).Value\n    Else\n    Worksheets(\"Ledger\").Cells(6 + offset, 2).Value = Worksheets(\"Journal\").Cells(counter + 2, 3).Value\n    End If\n\nEnd If\nNext counter\nEnd Sub\n</code></pre>\n\n<p>EDIT. If I were to pursue the <code>Range.Find</code> solution, how can I access this Range/cell result? Right now I get \"Run-time error '91': Object variable or With block variable not set\".</p>\n\n<pre><code>Sub RowInsert()\n\nDim counter As Integer\nFor counter = 0 To 1\n\nDim account As String\naccount = Worksheets(\"Journal\").Cells(counter + 2, 2)\n\n\nDim a As Double\n\nIf Worksheets(\"Journal\").Cells(counter + 2, 2) = \"Cash\" Then\n\n    Dim entries As Integer\n    entries = 0\n    Dim Header As Range\n    Dim row As Long\n\n    With Worksheets(\"Ledger\").Range(\"a1:a100\")\n\n        Set Header = .Find(\"Cash\")\n        ` Error here when try to use the Range Header\n        row = Header.row + entries\n\n        Rows(row).Insert Shift:=xlDown\n\n        Cells(row, 1) = Worksheets(\"Journal\").Cells(counter + 2, 1).Value\n\n    End With\n\nEnd If\nNext counter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "edited": false, "score": 0, "creation_date": 1476860771, "post_id": 40124180, "comment_id": 67518955, "body": "Thanks and please suggest which method is better to use?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "edited": false, "score": 0, "creation_date": 1476861056, "post_id": 40124180, "comment_id": 67519129, "body": "I generally prefer STR$(). It depends on the data you are trying to convert to string. Refer <a href=\"https://msdn.microsoft.com/en-in/library/aa263420%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-in/library/aa263420%28v=vs.60%29.aspx</a> for the size of variant and string."}, {"owner": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "edited": false, "score": 0, "creation_date": 1476862251, "post_id": 40124180, "comment_id": 67519846, "body": "I admire your way of presentation. It is really useful."}, {"owner": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "edited": false, "score": 0, "creation_date": 1476870126, "post_id": 40124180, "comment_id": 67525169, "body": "If we hide both the scroll bars in excel while executing macro on more sheets in the workbook improves performance?"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1476859923, "creation_date": 1476859923, "answer_id": 40124180, "question_id": 40123999, "link": "https://stackoverflow.com/questions/40123999/what-is-the-difference-between-vba-str-and-vba-str/40124180#40124180", "title": "What is the difference between VBA.Str and VBA.Str$?", "body": "<p>Str$ is identical to Str except for the declared type of its return value. i.e.  Str returns a Variant, the Str$ returns a String.</p>\n\n<p>Refer the <a href=\"https://msdn.microsoft.com/en-us/library/ee200152.aspx\" rel=\"nofollow\">msdn link</a></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "edited": false, "score": 0, "creation_date": 1476870170, "post_id": 40125282, "comment_id": 67525205, "body": "If we hide both the scroll bars in excel while executing macro on more sheets in the workbook improves performance?"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1476863483, "last_edit_date": 1495541795, "creation_date": 1476863483, "answer_id": 40125282, "question_id": 40123999, "link": "https://stackoverflow.com/questions/40123999/what-is-the-difference-between-vba-str-and-vba-str/40125282#40125282", "title": "What is the difference between VBA.Str and VBA.Str$?", "body": "<p><code>Str$</code> and <code>Str</code> are identical except for at least 2 important differences:</p>\n\n<ol>\n<li><p>If the usage of <code>Str$</code> returns anything other than a String, you'll get an error:</p>\n\n<pre><code>Debug.Print Str(Null)   'Prints Null\nDebug.Print Str$(Null)  'Throws Runtime Error 94 - Invalid use of Null\n</code></pre></li>\n<li><p><code>Str$</code> returns a String, whereas <code>Str</code> returns a Variant. In general, you should always prefer the strongly typed <code>Str$</code> over <code>Str</code></p></li>\n</ol>\n\n<p>There are many other functions that use <code>$</code>-suffixes, like <code>Left$</code>, <code>Mid$</code> and <code>Space$</code>.</p>\n\n<p>If we look at <code>Left$</code> (which is really just an alias for <code>_stdcall _B_str_Left</code>) and <code>Left</code> (which is really just an alias for <code>_stdcall _B_var_Left</code>), in the Type Library MIDL, we see that the <strong>input types matter too</strong>.</p>\n\n<pre><code>[entry(616), helpcontext(0x000f6ea1)]\nBSTR _stdcall _B_str_Left(\n                [in] BSTR String, \n                [in] long Length);\n[entry(617), helpcontext(0x000f653e)]\nVARIANT _stdcall _B_var_Left(\n                [in] VARIANT* String, \n                [in] long Length);\n</code></pre>\n\n<p>You can actually use the underlying functions in code:</p>\n\n<pre><code>Debug.Print VBA.Strings.[_B_var_Left](\"abc\",1) 'Prints a\nDebug.Print VBA.Strings.[_B_str_Left](\"abc\",1) 'Prints a\n</code></pre>\n\n<p>And to make matters more confusing, a function like <code>Join</code> (that <em>does</em> return a String, but which <em>doesn't</em> have a corresponding <code>Join$</code> function, <em>can</em> actually be used <em>with</em> a <code>$</code> suffix:</p>\n\n<pre><code>Debug.Print Join$(Array(1, 2, 3), \".\") 'Prints 1.2.3\n</code></pre>\n\n<p>For further discussion, see my answer at <a href=\"https://stackoverflow.com/questions/36002870/exactly-what-are-these-b-var-xxxxx-and-b-str-xxxxx-members-in-the-vba-com-libr\">Exactly what are these _B_var_Xxxxx and _B_str_Xxxxx members in the VBA COM libraries?</a></p>\n"}], "owner": {"reputation": 5, "user_id": 7040541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543946b13b9f38265dffc1fa3a7d73bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ghanshyam Dabhi", "link": "https://stackoverflow.com/users/7040541/ghanshyam-dabhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476863483, "creation_date": 1476859266, "last_edit_date": 1476859593, "question_id": 40123999, "link": "https://stackoverflow.com/questions/40123999/what-is-the-difference-between-vba-str-and-vba-str", "title": "What is the difference between VBA.Str and VBA.Str$?", "body": "<p>What is the difference between these two code lines</p>\n\n<pre><code>Debug.Print VBA.Str(123) \n</code></pre>\n\n<p>and</p>\n\n<pre><code>Debug.Print VBA.Str$(123)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1476861900, "post_id": 40123968, "comment_id": 67519605, "body": "Is the file saved as an xls, xla, or xlam?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1476862241, "post_id": 40123968, "comment_id": 67519839, "body": "Refer <a href=\"http://stackoverflow.com/questions/29475198/ms-office-2013-vba-password-security\">link</a>. Try using the code it may help you to get the password."}, {"owner": {"reputation": 25, "user_id": 7039820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf11ff29d6f5ecb4e5458a88df237331?s=128&d=identicon&r=PG&f=1", "display_name": "Achyut Deore", "link": "https://stackoverflow.com/users/7039820/achyut-deore"}, "edited": false, "score": 0, "creation_date": 1476875585, "post_id": 40123968, "comment_id": 67529320, "body": "Nice suggestion"}, {"owner": {"reputation": 25, "user_id": 7039820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf11ff29d6f5ecb4e5458a88df237331?s=128&d=identicon&r=PG&f=1", "display_name": "Achyut Deore", "link": "https://stackoverflow.com/users/7039820/achyut-deore"}, "edited": false, "score": 0, "creation_date": 1484807460, "post_id": 40123968, "comment_id": 70664121, "body": "Hi Mukul need your help for 64 Bit Office"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "is_accepted": true, "score": 0, "last_activity_date": 1476859660, "creation_date": 1476859660, "answer_id": 40124105, "question_id": 40123968, "link": "https://stackoverflow.com/questions/40123968/reset-excel-vba-password/40124105#40124105", "title": "Reset Excel VBA password", "body": "<p>The only way that you can achieve this is by using third party software downloaded from internet, but if you are not allowed to download applications. I say there is no easy way you can crack that vba password without application.</p>\n\n<p>But if you're interested on cracking it. You could try this article:\n<a href=\"http://datapigtechnologies.com/blog/index.php/hack-into-password-protected-vba-projects/\" rel=\"nofollow\">http://datapigtechnologies.com/blog/index.php/hack-into-password-protected-vba-projects/</a>\nSee if it helps.</p>\n"}], "owner": {"reputation": 25, "user_id": 7039820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf11ff29d6f5ecb4e5458a88df237331?s=128&d=identicon&r=PG&f=1", "display_name": "Achyut Deore", "link": "https://stackoverflow.com/users/7039820/achyut-deore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5190, "favorite_count": 0, "closed_date": 1476869976, "accepted_answer_id": 40124105, "answer_count": 1, "score": 0, "last_activity_date": 1476861824, "creation_date": 1476859176, "last_edit_date": 1531164843, "question_id": 40123968, "link": "https://stackoverflow.com/questions/40123968/reset-excel-vba-password", "closed_reason": "Duplicate", "title": "Reset Excel VBA password", "body": "<p>I forgets password of one VBA automation developed by me and now I have to update the VBA code but I am unable do that. And also please make note that I don't have permissions to download any application.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6490429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5efbde5a63855ceb4b00801b61d9333?s=128&d=identicon&r=PG&f=1", "display_name": "arduinooo", "link": "https://stackoverflow.com/users/6490429/arduinooo"}, "edited": false, "score": 0, "creation_date": 1476881879, "post_id": 40126733, "comment_id": 67534040, "body": "Thank you for your reply.  The vba is in HP Reflections (Attachmate) and it calls excel as an object.  My problem is I can&#39;t get the vba to determine if excel workbook is already open...and if it is resume sending Text (as .GetText) from Reflections."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1476867679, "creation_date": 1476867679, "answer_id": 40126733, "question_id": 40123962, "link": "https://stackoverflow.com/questions/40123962/excel-vba-to-see-if-a-workbook-is-open-and-if-is-write-data/40126733#40126733", "title": "Excel VBA to see if a workbook is open and if is write data", "body": "<p>If you are working with <strong>Excel VBA</strong> you don't need to create an excel application object. It's already available to you. code below will give you al the open workbooks:<br></p>\n\n<pre><code>Dim oWB As Workbook\n\nFor Each oWB In Workbooks\n\n    MsgBox oWB.Name\n\nNext\n\nSet oWB = Nothing\n</code></pre>\n\n<p>I've put a <code>MsgBox</code> just to give you an idea on how to get workbook name. you can use that to check if you expected workbook is already open. Give this a go and see if your updates work. If not post back and I'll try to help</p>\n"}], "owner": {"reputation": 1, "user_id": 6490429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5efbde5a63855ceb4b00801b61d9333?s=128&d=identicon&r=PG&f=1", "display_name": "arduinooo", "link": "https://stackoverflow.com/users/6490429/arduinooo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476867679, "creation_date": 1476859161, "question_id": 40123962, "link": "https://stackoverflow.com/questions/40123962/excel-vba-to-see-if-a-workbook-is-open-and-if-is-write-data", "title": "Excel VBA to see if a workbook is open and if is write data", "body": "<p>I'm trying to see if an excel workbook is open (Logtemplate.xlsm)using HP \n     Reflections VBA.And if the workbook is open on my desktop,then sendthe<br>\n     Text from Reflections to the next available row on that workbook.\n     I can get the excel workbook to open, but it will only update the Text one\n     time, and the next time I try to run the vba it reopens the same excel \n     file and doesn't update the Text.  I'm very new to VBA and any help \n     would be greatly appreciated.  Thank you in advance.   </p>\n\n<hr>\n\n<pre><code>Sub Test()\nOn Error GoTo 0\n\nWith Session\n\nWait 1\n\nDim Text As String\nDim TopRow, LastRow, LastColumn As Integer\nDim excelApp As Object\nDim wb As Workbook\nDim eRow As Long\n\nTopRow = .ScreenTopRow\nLastRow = TopRow + .DisplayRows\nLastColumn = .DisplayColumns\n\nText = .GetText(.CursorRow - 1, 0, .CursorRow, 125)\n\n\nOn Error GoTo 0\nSet wb = Nothing\nOn Error Resume Next\nSet wb = Workbooks(\"Logtemplate.xlsm\")\n\nOn Error GoTo 0\n\nIf wb Is Nothing Then\nSet excelApp = CreateObject(\"Excel.Application\")\nexcelApp.Visible = True\nSet excelApp = Workbooks.Open(\"C:\\Logtemplate.xlsm\")\nexcelApp.Worksheets(\"Sheet1\").Select\nexcelApp.Worksheets(\"Sheet1\").Range(\"A2\").Select\neRow = excelApp.Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End (xlUp).Offset  (1, 0).Row\n\nCells(eRow + 1, 1).Select\nCells(eRow, 1).Value = Text\n\n\nOn Error Resume Next\n\nIf Not wb(\"Logtemplate.xlsm\") Is Nothing Then\nSet excelApp = Worksheets(\"Sheet1\").Select\nEnd If\nOn Error Resume Next\nexcelApp.Worksheets(\"Sheet1\").Select\nexcelApp.Worksheets(\"Sheet1\").Range(\"A2\").Select\neRow = excelApp.Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End (xlUp).Offset (1, 0).Row\nCells(eRow + 1, 1).Select\nCells(eRow, 1).Value = Text\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476858030, "post_id": 40123563, "comment_id": 67517364, "body": "you may want to 1) post your so far code 2) give more details about what it does but shouldn&#39;t and what it should do but doesn&#39;t"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476864435, "post_id": 40123563, "comment_id": 67521219, "body": "Could you filter the data to exclude any rows where column E is blank, then do the print?"}, {"owner": {"reputation": 41, "user_id": 7031714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7dcd035f2ccd91a4df6a5d41859bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nickel", "link": "https://stackoverflow.com/users/7031714/nickel"}, "edited": false, "score": 0, "creation_date": 1476864876, "post_id": 40123563, "comment_id": 67521526, "body": "Ok... Then How do I filter the data in VBA"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1476867178, "post_id": 40123563, "comment_id": 67523081, "body": "record a Macro: start recording, do the needed filtering in Excel, stop the recording and see the generated code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 3, "creation_date": 1476867520, "post_id": 40123563, "comment_id": 67523293, "body": "BTW, be informed that <code>Range(r1, r2)</code> will reference cells ranging from the topleftmost cell down to the bottomrightmost one of the two ranges: in your case it&#39;ll reference all cells of columns between &quot;B&quot; to &quot;N&quot; (them included). If you want to reference cells of range <code>r1</code> <i>and</i> range <code>r2</code> then use <code>Union(r1, r2)</code>"}], "owner": {"reputation": 41, "user_id": 7031714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7dcd035f2ccd91a4df6a5d41859bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nickel", "link": "https://stackoverflow.com/users/7031714/nickel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 780, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476861396, "creation_date": 1476857686, "last_edit_date": 1531164843, "question_id": 40123563, "link": "https://stackoverflow.com/questions/40123563/excel-vba-print-data-rows-only", "title": "Excel VBA Print Data Rows Only", "body": "<p>Hi  I would like to print a range regarding E Column ...</p>\n\n<p>Print the range based on the E Column Data rows. I used xlCellTypeBlanks method but it is not help , because <strong>E Column cells have formulas.</strong> So I need to print only Data Rows of E Column,not the formula blank cells</p>\n\n<p>Here is my code</p>\n\n<pre><code>Columns(\"B:D\").EntireColumn.Hidden = False\nColumns(\"I:N\").EntireColumn.Hidden = False\nDim r1, r2 As Range\nSet r1 = Range(\"B:D\")\nSet r2 = Range(\"I:N\")\nRange(\"E4:E\").SpecialCells(xlCellTypeBlanks).EntireRow.Hidden = True\nActiveSheet.PageSetup.PaperSize = xlPaperA4\nActiveSheet.PageSetup.Orientation = xlPortrait\nActiveSheet.Range(r1, r2).PrintPreview\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5, "user_id": 7039982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba057eaafb61a4b9ff78e53bb761eda6?s=128&d=identicon&r=PG&f=1", "display_name": "Radziman Rani", "link": "https://stackoverflow.com/users/7039982/radziman-rani"}, "edited": false, "score": 0, "creation_date": 1476850639, "post_id": 40122024, "comment_id": 67514563, "body": "The value of total rows each sheet will display on new sheet"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476850926, "post_id": 40122024, "comment_id": 67514659, "body": "<code>Sheet.Rows.Count</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7039982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba057eaafb61a4b9ff78e53bb761eda6?s=128&d=identicon&r=PG&f=1", "display_name": "Radziman Rani", "link": "https://stackoverflow.com/users/7039982/radziman-rani"}, "edited": false, "score": 0, "creation_date": 1476855527, "post_id": 40122718, "comment_id": 67516273, "body": "Thanks. Working !!"}, {"owner": {"reputation": 417, "user_id": 3240704, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3e126942ce2ae2b6b62e50246e550a8d?s=128&d=identicon&r=PG&f=1", "display_name": "M O&#39;Connell", "link": "https://stackoverflow.com/users/3240704/m-oconnell"}, "reply_to_user": {"reputation": 5, "user_id": 7039982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba057eaafb61a4b9ff78e53bb761eda6?s=128&d=identicon&r=PG&f=1", "display_name": "Radziman Rani", "link": "https://stackoverflow.com/users/7039982/radziman-rani"}, "edited": false, "score": 0, "creation_date": 1476915156, "post_id": 40122718, "comment_id": 67554661, "body": "Marked as answered :)"}], "tags": [], "owner": {"reputation": 417, "user_id": 3240704, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3e126942ce2ae2b6b62e50246e550a8d?s=128&d=identicon&r=PG&f=1", "display_name": "M O&#39;Connell", "link": "https://stackoverflow.com/users/3240704/m-oconnell"}, "is_accepted": true, "score": 1, "last_activity_date": 1476854241, "creation_date": 1476854241, "answer_id": 40122718, "question_id": 40122024, "link": "https://stackoverflow.com/questions/40122024/how-to-count-rows-each-sheet-and-send-the-total-value-to-new-sheet/40122718#40122718", "title": "How to count rows each sheet and send the total value to new sheet?", "body": "<p>Same question answered <a href=\"http://www.mrexcel.com/forum/excel-questions/489376-count-lines-multiple-sheets.html\" rel=\"nofollow\">here</a></p>\n\n<pre><code>    For Each sh In Activeworkbook.Worksheets\n    MsgBox \"Sheet \" &amp; sh.Name &amp; \" has \" &amp; sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row - 1 &amp; \" rows\"\n    Next sh\n</code></pre>\n\n<p>This -1 from the rows (to exclude a header row) </p>\n"}], "owner": {"reputation": 5, "user_id": 7039982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba057eaafb61a4b9ff78e53bb761eda6?s=128&d=identicon&r=PG&f=1", "display_name": "Radziman Rani", "link": "https://stackoverflow.com/users/7039982/radziman-rani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1882, "favorite_count": 0, "closed_date": 1476861275, "accepted_answer_id": 40122718, "answer_count": 1, "score": -2, "last_activity_date": 1476854241, "creation_date": 1476850575, "last_edit_date": 1531161705, "question_id": 40122024, "link": "https://stackoverflow.com/questions/40122024/how-to-count-rows-each-sheet-and-send-the-total-value-to-new-sheet", "closed_reason": "Needs more focus", "title": "How to count rows each sheet and send the total value to new sheet?", "body": "<p>For example i have 7 sheets on workbook then i want to count all row each sheet. The total rows each sheets.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477749834, "post_id": 40123167, "comment_id": 67895562, "body": "@PankajKumar, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476856069, "creation_date": 1476856069, "answer_id": 40123167, "question_id": 40121993, "link": "https://stackoverflow.com/questions/40121993/complie-error-argument-not-optional/40123167#40123167", "title": "Complie error: Argument Not optional", "body": "<p>as per its <em>signature</em> your sub would expect a <code>control</code> argument of type <code>IRibbonControl</code></p>\n\n<p>but since it actually doesn't use it, you may want to remove it:</p>\n\n<pre><code>Public Sub ConvertDateFormat1()\n  ' rest of your sub code as it is\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6915810, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ceae04219495dcc43f857485f84e6429?s=128&d=identicon&r=PG&f=1", "display_name": "Pankaj Kumar", "link": "https://stackoverflow.com/users/6915810/pankaj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476856069, "creation_date": 1476850396, "question_id": 40121993, "link": "https://stackoverflow.com/questions/40121993/complie-error-argument-not-optional", "title": "Complie error: Argument Not optional", "body": "<p>I am using the below code to change Date format. using this macro as a dropdown option in ribbon using XML. but it's giving \"Argument Not optional\" error.</p>\n\n<p>Please help where I am doing wrong.</p>\n\n<pre><code>    Public Sub ConvertDateFormat1(control As IRibbonControl)\n'\n' date formating (MM/DD/YYYY)\n'\n\nDim oCl As Word.Cell\nDim oRng As Range\n'\n' Condition to check the selected data\n\n'\n  If Selection.Type = wdSelectionIP Or _\n      Not Selection.Information(wdWithInTable) Then\n    MsgBox \"Select a cell or range of cells before running\" _\n      &amp; \" this macro.\", , \"Nothing Selected\"\n    Exit Sub\n  End If\n  For Each oCl In Selection.Cells\n    Set oRng = oCl.Range\n    '\n\n    'Drop of the end of cell mark\n    '\n    oRng.End = oRng.End - 1\n    With oRng\n      If IsDate(oRng) Then\n         oRng.Text = Format(oRng.Text, \"MM/DD/YYYY\")\n\n    Else ' not a date - end loop\n        MsgBox (\"Invalid Date Format\")\n    End If\n    End With\n  Next oCl\nlbl_Exit:\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1476849068, "post_id": 40121583, "comment_id": 67514167, "body": "Since <code>Namespace</code> is not a native VBA type, you will need a reference to early bind it.  What references <i>do</i> you have in Tools|References?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 2, "creation_date": 1476849356, "post_id": 40121583, "comment_id": 67514246, "body": "Have you added reference to Microsoft Outlook Object Library ? It will be something like Microsoft Outlook xx.x Object Library"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1482998362, "post_id": 40121583, "comment_id": 69952431, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24261557/user-defined-type-not-defined-excel-macros\">User Defined Type Not Defined - Excel Macros</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1509444978, "post_id": 40121583, "comment_id": 81012049, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3645470/user-defined-type-not-defined-for-appointmentitem-in-excel\">User-defined type not defined for AppointmentItem in Excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "is_accepted": true, "score": -1, "last_activity_date": 1476847793, "creation_date": 1476847793, "answer_id": 40121632, "question_id": 40121583, "link": "https://stackoverflow.com/questions/40121583/excel-vba-compile-throws-a-user-defined-type-not-defined-error/40121632#40121632", "title": "Excel VBA Compile throws a \u201cUser-defined type not defined\u201d error", "body": "<p>From the error message shown, it is possible that you are missing any references or imported libraries on your code or maybe the excel file extension that you are working with does not support macros</p>\n"}], "owner": {"reputation": 25, "user_id": 7039820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf11ff29d6f5ecb4e5458a88df237331?s=128&d=identicon&r=PG&f=1", "display_name": "Achyut Deore", "link": "https://stackoverflow.com/users/7039820/achyut-deore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3870, "favorite_count": 0, "accepted_answer_id": 40121632, "answer_count": 1, "score": 1, "last_activity_date": 1593415439, "creation_date": 1476847496, "last_edit_date": 1593415439, "question_id": 40121583, "link": "https://stackoverflow.com/questions/40121583/excel-vba-compile-throws-a-user-defined-type-not-defined-error", "title": "Excel VBA Compile throws a \u201cUser-defined type not defined\u201d error", "body": "<p>I have an Excel file with a VBA code to send a outlook mail according specific excel cell contents, but it gave me a Compile error.</p>\n\n<p>The first few lines of the code are copied in directly from the VBE as: </p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim impname As String\nDim leadname As String\nDim subje As String\nDim ns As Namespace\nDim myOlSel As Outlook.Selection\n</code></pre>\n\n<p>The error showing at \"<strong>Dim ns As Namespace</strong>\"</p>\n\n<p>This code was working fine till last three day's but now it is showing an error msg. I have tried to clear Missing libraries form \"<strong>Tools | References</strong>\" but still I am facing the issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "edited": false, "score": 0, "creation_date": 1476847600, "post_id": 40121530, "comment_id": 67732546, "body": "Possible cause of this is the range length that you specified exceeds to the length of data you are calling on your code."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477749784, "post_id": 40123597, "comment_id": 67895546, "body": "@Ram, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476857851, "creation_date": 1476857851, "answer_id": 40123597, "question_id": 40121530, "link": "https://stackoverflow.com/questions/40121530/invalid-procedure-call-or-argument-in-excel-vba/40123597#40123597", "title": "Invalid procedure call or argument in excel vba", "body": "<p>as for the very error your post is asking help for, it comes out of:</p>\n\n<pre><code>Worksheets(\"Dashboard\").Range(\"E\" &amp; i).Resize(UBound(arr, 1)).Value = Join(arr, \" \")\n</code></pre>\n\n<p>since <code>arr</code> is a <strong><em>Two</strong>-dimensional</em> array while <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264098(v=office.15).aspx\" rel=\"nofollow\">Join()</a> function requires a <strong><em>One</strong>-dimensional</em> one </p>\n\n<p>you then should:</p>\n\n<ul>\n<li><p>declare arr as a <em>simple</em> Variant:</p>\n\n<pre><code>Dim arr As Variant\n</code></pre></li>\n<li><p>fill it in a way so as to generate a <em>One-dimensional</em> array</p>\n\n<pre><code>arr = Application.Transpose(rng.Value)\n</code></pre></li>\n</ul>\n\n<p>other than that it seems to me your code have some more issues</p>\n\n<p>you may want to fix this error first and then, should those issues actually arise and shouldn't you be able to fix, make a new post </p>\n"}], "owner": {"reputation": 1, "user_id": 7039763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74136475b2a4740a4bad008380710f19?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/7039763/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476857851, "creation_date": 1476847085, "question_id": 40121530, "link": "https://stackoverflow.com/questions/40121530/invalid-procedure-call-or-argument-in-excel-vba", "title": "Invalid procedure call or argument in excel vba", "body": "<p>I am using a filter on column1 of sheet1 with a unique no, get filtered values from column Z into an array (arr) object and paste those values as a string in one cell in \"Dashboard\" sheet. Repeat this process for all unique values on column 1 of sheet1. I am getting multiple errors 1. \"Invalid Procedure call or argument\" at Join() method. 2. Getting values into rng object and array. Can I get your help on where am I going wrong with this. Many Thanks.</p>\n\n<pre><code>Dim d As Object, c As Range, k, tmp As String\nDim TestRg As Range\nDim arr() As Variant\nDim i As Integer\nDim myCell As Range\nDim rng As Range\ni = 2\n\nSet d = CreateObject(\"scripting.dictionary\")\nColumns(1).Select\nFor Each c In Selection\n    tmp = Trim(c.Value)\n    If Len(tmp) &gt; 0 Then d(tmp) = d(tmp) + 1\nNext c\n\nFor Each k In d.Keys\nIf IsNumeric(k) Then\n Set TestRg = Range(\"A1:AQ\" &amp; LastRow(ActiveSheet))\n TestRg.AutoFilter Field:=1, Criteria1:=k, Operator:=xlFilterValues\n LasRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n Set rng = ActiveSheet.Range(\"Z1\" &amp; \":\" &amp; \"Z\" &amp; LasRow).SpecialCells(xlCellTypeVisible)\n rng.Activate\n arr = rng.Value\nWorksheets(\"Dashboard\").Range(\"A\" &amp; i) = k\nWorksheets(\"Dashboard\").Range(\"E\" &amp; i).Resize(UBound(arr, 1)).Value = Join(arr, \" \")\ni = i + 1\nErase arr\nEnd If\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint", "presentation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476848091, "post_id": 40121306, "comment_id": 67513913, "body": "That works for me on a table inserted via <code>Insert &gt;&gt; Table</code>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1476895144, "post_id": 40121306, "comment_id": 67543823, "body": "Same as Tim here; it works on a table inserted via Insert &gt;&gt; Table and on one added by clicking the Table icon in a content placeholder.  Are you sure Shape #3 is a table?  Open the presentation, go to slide 7, press tab to cycle through the shapes on the slide.  If the third press doesn&#39;t take you to a table, that&#39;d be the problem."}, {"owner": {"reputation": 11, "user_id": 6717278, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e6b3b8d256419f8638b2eeee4f9006a?s=128&d=identicon&r=PG&f=1", "display_name": "Smithfield", "link": "https://stackoverflow.com/users/6717278/smithfield"}, "edited": false, "score": 0, "creation_date": 1477013194, "post_id": 40121306, "comment_id": 67602355, "body": "Its interesting as this still does not work for me. And yeah it is the 3rd shape when I tab. I even tried re inserting the table and yet it throws the same error. I&#39;m at a little bit of a loss! I&#39;m going to try create a dummy file with 1 slide and 1 table and see if I can get it to work for that."}, {"owner": {"reputation": 11, "user_id": 6717278, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e6b3b8d256419f8638b2eeee4f9006a?s=128&d=identicon&r=PG&f=1", "display_name": "Smithfield", "link": "https://stackoverflow.com/users/6717278/smithfield"}, "edited": false, "score": 0, "creation_date": 1477014033, "post_id": 40121306, "comment_id": 67602557, "body": "Ok so creating a dummy file it didn&#39;t work either. There must be something else wrong somewhere else so I will work that out. Thank you both for your help."}], "owner": {"reputation": 11, "user_id": 6717278, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e6b3b8d256419f8638b2eeee4f9006a?s=128&d=identicon&r=PG&f=1", "display_name": "Smithfield", "link": "https://stackoverflow.com/users/6717278/smithfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476845615, "creation_date": 1476845615, "question_id": 40121306, "link": "https://stackoverflow.com/questions/40121306/vba-ppt-referencing-a-table", "title": "VBA PPT referencing a table", "body": "<p>I am writing a macro inside Excel that takes values from the worksheet and edits a presentation. \nI am having trouble referencing some values inside a table. \nThe line that keeps running into errors is...</p>\n\n<pre><code> reportFile.Slides(7).Shapes(3).Table.Cell(2, 2).Shape.TextFrame.TextRange.Text = \"fill\"\n</code></pre>\n\n<p>It keeps running into error '91' I have tried changing the shape id from numbers through 1-20 and it worked for none of them.</p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 2492, "user_id": 2883603, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LdFWO.jpg?s=128&g=1", "display_name": "Amit Kohli", "link": "https://stackoverflow.com/users/2883603/amit-kohli"}, "is_accepted": false, "score": 0, "last_activity_date": 1476844191, "creation_date": 1476844191, "answer_id": 40121102, "question_id": 40121009, "link": "https://stackoverflow.com/questions/40121009/linking-input-info-from-userform-to-cells/40121102#40121102", "title": "Linking input info from userform to cells", "body": "<p>You would add a button something like \"SAVE\", and add a macro to that (double-click it in the VBE), and inside there you can write something like <code>range(\"A3\").value=me.textbox1</code> where <code>A3</code> is the location you want to write to, and <code>textbox1</code> would be the thing in your userform you want to write into excel.</p>\n"}, {"tags": [], "owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "is_accepted": false, "score": 0, "last_activity_date": 1476844421, "creation_date": 1476844421, "answer_id": 40121129, "question_id": 40121009, "link": "https://stackoverflow.com/questions/40121009/linking-input-info-from-userform-to-cells/40121129#40121129", "title": "Linking input info from userform to cells", "body": "<p>Userform can be achieved using excel vba. Then run it on excel macro and post the values of textbox from excel vba userform to cells.</p>\n\n<p>For example:\n<code>Range(\"A4\").Value = Me.txtAmount.Value</code> - From Userform textbox to Cells\n<code>Range(\"A4\").EntireColumn.AutoFit</code> -Autofit Column of the displayed cell values.</p>\n"}], "owner": {"reputation": 3, "user_id": 6879323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9003c12438c7f9033df04090c019489?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole P", "link": "https://stackoverflow.com/users/6879323/nicole-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1111, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476844421, "creation_date": 1476843540, "question_id": 40121009, "link": "https://stackoverflow.com/questions/40121009/linking-input-info-from-userform-to-cells", "title": "Linking input info from userform to cells", "body": "<p>I'm creating a multipage userform where the user inputs data into textboxes and selects from combo boxes, option buttons, etc. I have a data sheet that has formulas in the cells and I'm trying to link what the user inputs in the userform to cells in a spreadsheet. How can I do this?</p>\n"}, {"tags": ["excel", "vba", "object", "vb6"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1476859429, "creation_date": 1476859429, "answer_id": 40124044, "question_id": 40120734, "link": "https://stackoverflow.com/questions/40120734/receiving-activex-automation-bad-index-error-message/40124044#40124044", "title": "Receiving ActiveX Automation: Bad Index Error Message", "body": "<p>you need some different cases handling, mainly depending if the wanted workbook is already open or not should a running Excel session be \"caught\"</p>\n\n<p>you may want to use some dedicated Functions not to clutter your main code and be more effective in both debugging and maintaining your code, like follows</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    ' Checking if Excel is open, if not, open it.\n    Dim xL As Object, wBook As Object, wSheet As Object, iCloseThings As Byte\n\n    Set xL = GetExcel(iCloseThings)\n\n    Set wBook = GetExcelWorkbook(xL, \"C:\\Users\\&lt;UserName&gt;\\Documents\\&lt;WorkBook&gt;.xlsx\")\n    If wBook Is Nothing Then Exit Sub\n    Set wSheet = wBook.ActiveSheet\n\n    If iCloseThings = 1 Then xL.Quit\nEnd Sub\n\nFunction GetExcel(iCloseThings As Byte) As Object\n    On Error Resume Next\n    Set GetExcel = GetObject(, \"Excel.Application\")\n    On Error GoTo 0\n    If GetExcel Is Nothing Then\n        iCloseThings = 1   ' Set Excel to close only if it was never open\n        Set GetExcel = CreateObject(\"Excel.Application\")\n    End If\nEnd Function\n\nFunction GetExcelWorkbook(xL As Object, wbFullName As String) As Object\n    Dim wbName As String\n\n    wbName = Right(wbFullName, Len(wbFullName) - InStrRev(wbFullName, \"\\\"))\n    On Error Resume Next\n    Set GetExcelWorkbook = xL.Workbooks(wbName)\n    On Error GoTo 0\n    If GetExcelWorkbook Is Nothing Then\n        Set GetExcelWorkbook = xL.Workbooks.Open(wbFullName)\n    Else\n        If GetExcelWorkbook.Path &amp; \"\\\" &amp; wbName &lt;&gt; wbFullName Then\n            MsgBox \"A workbook with the wanted name '\" &amp; wbName &amp; \"' is already open but its path doesn't match the required one\" _\n                   &amp; vbCrLf &amp; vbCrLf &amp; \"Close the already open workbook and run this macro again\", vbCritical + vbInformation\n            Set GetExcelWorkbook = Nothing\n        Else\n            MsgBox \"Wanted workbook is already open\", vbInformation\n        End If\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6576927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 40124044, "answer_count": 1, "score": -1, "last_activity_date": 1476859429, "creation_date": 1476841541, "question_id": 40120734, "link": "https://stackoverflow.com/questions/40120734/receiving-activex-automation-bad-index-error-message", "title": "Receiving ActiveX Automation: Bad Index Error Message", "body": "<h2>Prelude</h2>\n\n<p>I am starting a new project, and basically I am using Excel as a log for another program I am using. With this being said, this is a mixture of VBA (Only when using Excel's object) and VB6 (the main \"host\" programming language). <em>This is why both languages are tagged as I anticipate hateful comments from the use of tags; I am looking for a solution in <strong>either</strong>/<strong>mixture of both</strong> programming languages!!</em><br>\nAlso, I am aware some <em>VBA activists</em> will say to never use <code>ActiveSheet</code>. I am not concerned about this and I would like to say <em>thank you</em> ahead of time. I have one sheet in this workbook as it's primary function is to serve as a log. The <code>ActiveSheet</code> will always be the one and only sheet.  </p>\n\n<hr>\n\n<p>I have the following code, and I am not too familiar with Setting a workbook as an <code>object</code>, which is likely the reason I receive the <code>Bad Index</code> error.</p>\n\n<pre><code>Sub Test()\n    ' Checking if Excel is open, if not, open it.\n    Dim xL As Object, wBook As Object, iCloseThings As Byte\n    On Error Resume Next\n    Set xL = GetObject(, \"Excel.Application\") \n    On Error GoTo 0\n    If xL Is Nothing Then\n        iCloseThings = 1   ' Set Excel to close only if it was never open\n        Set xL = CreateObject(\"Excel.Application\")\n    End If\n\n    Set wBook = xL.Workbooks(\"C:\\Users\\&lt;UserName&gt;\\Documents\\&lt;WorkBook&gt;.xlsx\").ActiveSheet\n\n\n\n    If iCloseThings = 1 Then xL.Quit\nEnd sub\n</code></pre>\n\n<p>What I need assistance with is how would I properly set this object to point to the exact workbook I have in the above example? All I have ever known to do was something such as <code>Set wBook = XL.Workbooks(\"&lt;WorkBook&gt;.xlsx\").ActiveSheet</code> because I knew such workbook would already be open. But with the possibility of it not being open, I need something a little more flexible.</p>\n\n<p>Thanks for your assistance!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476843712, "post_id": 40120419, "comment_id": 67512990, "body": "Fix one issue at time..."}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476848015, "post_id": 40120419, "comment_id": 67513894, "body": "Okay, lets start off with having script? to open outlook and excel?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476850816, "post_id": 40120419, "comment_id": 67514629, "body": "Use task scheduler to start Outlook once your login, then Outlook can call Excel to send the email at 8am"}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1476854764, "post_id": 40120419, "comment_id": 67516003, "body": "Okay, have successfully get task scheduler to open outlook (though setting was run only when user is logged on). How do I get Outlook to call excel at set timing?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476945642, "post_id": 40144594, "comment_id": 67563719, "body": "I copied the code and edited accordingly, but when I tried to run (in the outlook vba), it pop up the macros window with no macros inside."}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476946835, "post_id": 40144594, "comment_id": 67564331, "body": "Have tried what you mention but doesn`t seems to work. Is there any way to check whats wrong on my part?"}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476951702, "post_id": 40144594, "comment_id": 67567306, "body": "Im unable to find Tools - References. I tried customizing the ribbon but doesn&#39;t see anything."}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476952557, "post_id": 40144594, "comment_id": 67567848, "body": "Apologies, misunderstood for the ribbons tool"}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 1, "creation_date": 1476952992, "post_id": 40144594, "comment_id": 67568152, "body": "Yes it worked as intended! Is there any way to make the excel save and close after sending out the emails?"}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476953659, "post_id": 40144594, "comment_id": 67568617, "body": "Just to clarify, when the reminder timing reaches the supposed time (8am) do I dismiss it or snooze for 1 day? or it doesn&#39;t makes a difference?"}, {"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1476954364, "post_id": 40144594, "comment_id": 67569111, "body": "Okay! So if I were to run it during the weekends fully automated, i.e. task scheduler open the outlook, and outlook open the excel and send out. should I shut down from there directly? (concern about no one clicking the dismiss button or excel not being saved properly)"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1547070267, "last_edit_date": 1547070267, "creation_date": 1476931856, "answer_id": 40144594, "question_id": 40120419, "link": "https://stackoverflow.com/questions/40120419/outlook-and-excel-vba-task-scheduler/40144594#40144594", "title": "Outlook and Excel VBA task Scheduler", "body": "<p>Now that you have Outlook running, Lets create a Recurring Task Item with reminder and set the time that you would like to call Excel.</p>\n\n<p><em><a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.Application.Reminder\" rel=\"nofollow noreferrer\">MSDN Application.Reminder Event (Outlook) Occurs immediately before a reminder is displayed.</a></em></p>\n\n<p><em>Task Item with Reminder</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/hqauK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hqauK.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Code goes to Outlook under ThisOutlookSession</em></p>\n\n<pre><code>Private Sub Application_Reminder(ByVal Item As Object)\n    If TypeOf Item Is Outlook.TaskItem Then\n\n        If Not Item.Subject = \"Send Report\" Then\n            Exit Sub\n        End If\n\n    End If\n\n    GetTemp Item ' call sub\nEnd Sub\n\nPrivate Sub GetTemp(ByVal Item As TaskItem)\n    Dim xlApp As Excel.Application\n    Dim xlBook As Workbook\n\n    Set xlApp = New Excel.Application\n    Set xlBook = xlApp.Workbooks.Open(\"C:\\Temp\\Excel_File.xlsm\") ' update with Excel name\n    xlApp.Visible = True\n\n'   // Run Macro in Excel_File\n    xlBook.Application.Run \"Module1.CheckDates\" ' Update with subname\n\n    Set xlApp = Nothing\n    Set xlBook = Nothing\nEnd Sub\n</code></pre>\n\n<p>Update Excel Path</p>\n\n<pre><code>xlApp.Workbooks.Open(\"C:\\Temp\\Excel_File.xlsm\")\n</code></pre>\n\n<p>Make sure to add Excel Library object to Outlook and macro security is enable to run</p>\n\n<p><em>Tools - References then look for Microsoft Excel xxx Object Library</em></p>\n"}], "owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2642, "favorite_count": 0, "accepted_answer_id": 40144594, "answer_count": 1, "score": 1, "last_activity_date": 1592898266, "creation_date": 1476838898, "last_edit_date": 1592898266, "question_id": 40120419, "link": "https://stackoverflow.com/questions/40120419/outlook-and-excel-vba-task-scheduler", "title": "Outlook and Excel VBA task Scheduler", "body": "<p>Am in desperate need for help as this whole \"system\" should be up by this week but being a totally novice to <strong>vba scripts</strong> and codes etc, I have no idea how to perform the tasks.</p>\n\n<p>I have created an excel which generates daily email reminders based on due dates and would like to use task scheduler to get it opened daily.</p>\n\n<p>What I want: </p>\n\n<ol>\n<li>PC to auto boot up at 745am (most likely using bios power management)</li>\n<li>PC reach user login page.</li>\n<li>Task scheduler opens outlook, followed by my excel and sent out the emails at 8am.</li>\n<li>Excel get saved and closed. (does this need a separate macro or code within the excel?)</li>\n<li>Computer shut down using task scheduler.</li>\n</ol>\n\n<p>From what I found out from various pages/questions asked by others, a <strong>vbs/cmd</strong> script have to be written, but some sources stated that in the task scheduler to run that script, I am not supposed to tick the option to \"run whether user is logged on or not\" (have no Idea how to write them as well, all I know is that I have to write it in notepad and save in the specific extension for the file name) \nHope someone could provide me with a detailed guide on how to perform the above tasks. \nAlso, I tried to use task scheduler to open the outlook app directly but it doesn't seem to work. Does it require a script as well?</p>\n\n<p>Other help needed for my excel: currently, my reminder macro is running on the 1st sheet only. Is it possible for it to run on all sheets?</p>\n\n<p>The code of the excel is as below:</p>\n\n<pre><code>Dim Bcell As Range\nDim iTo, iSubject, iBody As String\nDim ImportanceLevel As String\n\nPublic Sub CheckDates()\n\n For Each Bcell In Range(\"c2\", Range(\"c\" &amp; Rows.Count).End(xlUp))\n\nIf Bcell.Offset(0, 5) &lt;&gt; Empty Then ' if email column is not empty then command continues\n    If Now() - Bcell.Offset(0, 6) &gt; 0.9875 Then ' mail will not be sent if current time is within 23.7 hours from time of mail last sent.\n    ' Example: if mail is sent at 8am monday, between 8am monday to tuesday 7:18am, mail will not be sent.\n\n        If DateDiff(\"d\", Now(), Bcell) = 60 Then ' if date in column c is 60days later, email will be sent\n'       Debug.Print Bcell.Row &amp; \" 60\"\n\n        iTo = Bcell.Offset(0, 5)\n\n        iSubject = \"FIRST REMINDER - IN/SSGIFR no. \" &amp; Bcell.Offset(0, -2)\n\n        iBody = \"Dear all,\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"IN/SSGIFR No. \" &amp; Bcell.Offset(0, -2) &amp; \" - \" &amp; Bcell.Offset(0, 1) &amp; \" (Batch: \" &amp; Bcell.Offset(0, 3) &amp; \", Qty: \" &amp; _\n        Bcell.Offset(0, 2) &amp; \")\" &amp; \", notified on \" &amp; Bcell.Offset(0, -1) &amp; \" will be due on \" &amp; _\n        Bcell &amp; \".\" &amp; vbCrLf &amp; \"Please ensure that the consignment is closed by the due date and forward the closure reports ASAP.\" &amp; _\n        vbCrLf &amp; vbCrLf &amp; \"Thank you\" &amp; vbCrLf &amp; vbCrLf &amp; \"Regards,\" &amp; vbCrLf &amp; \"YYY Department\" &amp; _\n        vbCrLf &amp; \"XXX Pte Ltd.\"\n\n        SendEmail\n        Bcell.Offset(0, 6) = Now()\n\n        End If\n\n\n          If DateDiff(\"d\", Now(), Bcell) = 30 Then ' if date in column c is 30 days later, email will be sent\n'         Debug.Print Bcell.Row &amp; \" 30\"\n\n          iTo = Bcell.Offset(0, 5)\n\n          iSubject = \"SECOND REMINDER - IN/SSGIFR no. \" &amp; Bcell.Offset(0, -2)\n\n          iBody = \"Dear all,\" &amp; vbCrLf &amp; vbCrLf &amp; _\n          \"IN/SSGIFR No. \" &amp; Bcell.Offset(0, -2) &amp; \" - \" &amp; Bcell.Offset(0, 1) &amp; \" (Batch: \" &amp; Bcell.Offset(0, 3) &amp; \", Qty: \" &amp; _\n          Bcell.Offset(0, 2) &amp; \")\" &amp; \", notified on \" &amp; Bcell.Offset(0, -1) &amp; \" will be due on \" &amp; _\n          Bcell &amp; \".\" &amp; vbCrLf &amp; \"Please ensure that the consignment is closed by the due date and forward the closure reports ASAP.\" &amp; _\n          vbCrLf &amp; vbCrLf &amp; \"Thank you\" &amp; vbCrLf &amp; vbCrLf &amp; \"Regards,\" &amp; vbCrLf &amp; \"YYY Department\" &amp; _\n          vbCrLf &amp; \"XXX Pte Ltd.\"\n\n          SendEmail\n          Bcell.Offset(0, 6) = Now()\n\n        End If\n\n        If DateDiff(\"d\", Now(), Bcell) = 7 Then ' if date in column c is 30days later, email will be sent\n'       Debug.Print \"ROW: \" &amp; Bcell.Row &amp; \" 7\"\n        iTo = Bcell.Offset(0, 5)\n\n        iSubject = \"FINAL REMINDER - IN/SSGIFR no. \" &amp; Bcell.Offset(0, -2)\n\n        iBody = \"Dear all,\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"IN/SSGIFR No. \" &amp; Bcell.Offset(0, -2) &amp; \" - \" &amp; Bcell.Offset(0, 1) &amp; \" (Batch: \" &amp; Bcell.Offset(0, 3) &amp; \", Qty: \" &amp; _\n        Bcell.Offset(0, 2) &amp; \")\" &amp; \", notified on \" &amp; Bcell.Offset(0, -1) &amp; \" will be due on \" &amp; _\n        Bcell &amp; \".\" &amp; vbCrLf &amp; \"Please ensure that the consignment is closed by the due date and forward the closure reports ASAP.\" &amp; _\n        vbCrLf &amp; vbCrLf &amp; \"Thank you\" &amp; vbCrLf &amp; vbCrLf &amp; \"Regards,\" &amp; vbCrLf &amp; \"YYY Department\" &amp; _\n        vbCrLf &amp; \"XXX Pte Ltd.\"\n\n        SendEmail\n        Bcell.Offset(0, 6) = Now()\n\n        End If\n    End If\nEnd If\n            iTo = Empty\n            iSubject = Empty\n            iBody = Empty\n    Next Bcell\n\nEnd Sub\n\n\n\nPrivate Sub SendEmail()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n\n    With OutMail\n        .To = iTo\n        .CC = \"DEPARTMENT@EMAIL.COM\" &amp; \";COLLEAGUE@EMAIL.COM\"\n        .BCC = \"\"\n        .Subject = iSubject\n        .Body = iBody\n        .Importance = ImportanceLevel\n        'You can add a file like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Display\n    End With\n\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007", "excel-2016"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476832973, "post_id": 40119440, "comment_id": 67510414, "body": "That seems like perfectly valid syntax. If you comment it out (and the matching Next) then does the code compile ?"}, {"owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476833642, "post_id": 40119440, "comment_id": 67510590, "body": "it compile on the english 2007 version but not on the excel french 2016 version"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476833688, "post_id": 40119440, "comment_id": 67510600, "body": "I don&#39;t think you&#39;re answering the question I asked ?"}, {"owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476833724, "post_id": 40119440, "comment_id": 67510612, "body": "i&#39;m guessing the &#39;&#39;To&#39;&#39; or the &#39;&#39;Ubound&#39;&#39; might differ from english and french"}, {"owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476833840, "post_id": 40119440, "comment_id": 67510634, "body": "sorry williams i dont think i understand the question :S"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476834032, "post_id": 40119440, "comment_id": 67510690, "body": "Isn&#39;t all VBA in English now?  I know there used to be different versions in German/French (?) but not since a long time now..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476834075, "post_id": 40119440, "comment_id": 67510705, "body": "Comment out the line which is being flagged as invalid (and the matching <code>Next</code> line) and try compiling the project."}, {"owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476834111, "post_id": 40119440, "comment_id": 67510714, "body": "that&#39;s what i thought but the only difference between bot files is the 2007 and 2016 or french and english"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1476835991, "post_id": 40119440, "comment_id": 67511178, "body": "Have you tried changing <code>Arr</code> to another name? <code>Arr</code> seems eerily similar to <code>Arret</code> which might be some strange/legacy reserved word?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1476836657, "post_id": 40119440, "comment_id": 67511318, "body": "Or better still, have you tried using <code>WorkRng.FormulaLocal</code>?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1476836765, "post_id": 40119440, "comment_id": 67511343, "body": "Check the References dialog (go to Tools &gt; References in the VBA editor) and unselect any references marked as missing. Missing references tend to produce very odd syntax errors even in code which makes no use of the reference"}], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1476870786, "last_edit_date": 1476870786, "creation_date": 1476870398, "answer_id": 40127780, "question_id": 40119440, "link": "https://stackoverflow.com/questions/40119440/vba-excel-english-2007-cause-error-msg-on-excel-2016-french/40127780#40127780", "title": "VBA excel English 2007 cause error msg on excel 2016 french", "body": "<p>You will need to change , to ;</p>\n\n<p>It is a regional setting causing the problem, the reason for the semicolon is to distinguish from the decimal separator that in many countries is comma instead of dot.</p>\n\n<p>Another option is to change the separators in your Excel version (, . and ;)</p>\n"}], "owner": {"reputation": 31, "user_id": 6136082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21434fc068b31b7eb0e839089b9e57ed?s=128&d=identicon&r=PG&f=1", "display_name": "Anarchy98", "link": "https://stackoverflow.com/users/6136082/anarchy98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1476870786, "creation_date": 1476831715, "question_id": 40119440, "link": "https://stackoverflow.com/questions/40119440/vba-excel-english-2007-cause-error-msg-on-excel-2016-french", "title": "VBA excel English 2007 cause error msg on excel 2016 french", "body": "<p>I have this Macro used to invert the order of the selected row. \nThis Macro run smooth on my english pc with excel 2007 but doesn't work on my french pc with excel 2016. \nWhen i run it in the french pc, this line  <code>For j = 1 To UBound(Arr, 2) / 2</code>gets me a error msg </p>\n\n<p>''Compilation error: Syntax error''</p>\n\n<pre><code>  Sub FlipRows()\n'Updateby20131126\nDim Rng As Range\nDim WorkRng As Range\nDim Arr As Variant\nDim i As Integer, j As Integer, k As Integer\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nArr = WorkRng.Formula\nFor i = 1 To UBound(Arr, 1)\n    k = UBound(Arr, 2)\n    For j = 1 To UBound(Arr, 2) / 2\n        xTemp = Arr(i, j)\n        Arr(i, j) = Arr(i, k)\n        Arr(i, k) = xTemp\n        k = k - 1\n    Next\nNext\nWorkRng.Formula = Arr\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerquery"], "answers": [{"tags": [], "owner": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "is_accepted": false, "score": 4, "last_activity_date": 1476900398, "last_edit_date": 1476900398, "creation_date": 1476837163, "answer_id": 40120190, "question_id": 40119185, "link": "https://stackoverflow.com/questions/40119185/how-to-edit-the-source-of-a-power-query-using-vba/40120190#40120190", "title": "How to edit the source of a power query using VBA?", "body": "<p>You can use <code>ActiveWorkbook.Queries.Item</code> to get the query you want and use the <code>Formula</code> property to update the query's formula, like so:</p>\n\n<p><code>ActiveWorkbook.Queries.Item(\"LATEST\").Formula = \"let MyNewFormula = 1 + 1 in Source\"</code></p>\n\n<p>Note:  this only works on Excel 2016 or later.</p>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 6560720, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0a77146708fe3396808040a04ad3a487?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/6560720/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1480526975, "creation_date": 1480526975, "answer_id": 40894600, "question_id": 40119185, "link": "https://stackoverflow.com/questions/40119185/how-to-edit-the-source-of-a-power-query-using-vba/40894600#40894600", "title": "How to edit the source of a power query using VBA?", "body": "<p>I beleive you'd better avoid such methods as they can cause compatibility problems as well as some other.</p>\n\n<p>If you learn M, you probably won't need to edit code with VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 164, "user_id": 12397524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7ALV.jpg?s=128&g=1", "display_name": "dhumphreys", "link": "https://stackoverflow.com/users/12397524/dhumphreys"}, "edited": false, "score": 0, "creation_date": 1582710055, "post_id": 57711251, "comment_id": 106867567, "body": "When you&#39;re using this, is there any way to only change the Source part of the formula, or do you have to specify the entire PowerQuery formula?"}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1567085181, "creation_date": 1567085181, "answer_id": 57711251, "question_id": 40119185, "link": "https://stackoverflow.com/questions/40119185/how-to-edit-the-source-of-a-power-query-using-vba/57711251#57711251", "title": "How to edit the source of a power query using VBA?", "body": "<p>A bit late to the party, but additionally, for anyone who views this moving forward one can use:</p>\n\n<p><code>Thisworkbook.Queries(\"LATEST\").Formula = mFormula</code></p>\n\n<p>Note, <code>ThisWorkbook</code> is preferable to <code>ActiveWorkbook</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 3521037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbet0.jpg?s=128&g=1", "display_name": "dasg7", "link": "https://stackoverflow.com/users/3521037/dasg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1603552571, "creation_date": 1603552571, "answer_id": 64514908, "question_id": 40119185, "link": "https://stackoverflow.com/questions/40119185/how-to-edit-the-source-of-a-power-query-using-vba/64514908#64514908", "title": "How to edit the source of a power query using VBA?", "body": "<p>It is not recommended to use Thisworkbook.Queries(index).Formula = &quot;newFormula&quot; to change your queries, but I have not discovered any other method to update the connections.</p>\n<p>The drawback working with this method is that you can not change any specific property of the connection (source, etc), but you can use the functions Split, Replace, Instr, Mid, etc to get exactly what you want.</p>\n<p>Another drawback is that so often the new &quot;.formula&quot; throws syntax errors. For that, you will need a simple error handler.</p>\n"}], "owner": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7593, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1603552571, "creation_date": 1476830023, "last_edit_date": 1476846660, "question_id": 40119185, "link": "https://stackoverflow.com/questions/40119185/how-to-edit-the-source-of-a-power-query-using-vba", "title": "How to edit the source of a power query using VBA?", "body": "<p>I am trying to edit the source of one of my queries using VBA. This is what I have so far:</p>\n\n<pre><code> Dim mFormula As String\n\n mFormula = _\n\n \"let Source = Excel.Workbook(File.Contents(wbname), null, true) in Source\"\n\n query1 = ActiveWorkbook.Queries.Add(\"LATEST\", mFormula)\n</code></pre>\n\n<p>I set <code>wbname</code> previously in my code.  \"LATEST\" is already added, instead of delete it and read it, I would just like to change the source. Is this possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 3503064, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/100000173357927/picture?type=large", "display_name": "user3503064", "link": "https://stackoverflow.com/users/3503064/user3503064"}, "edited": false, "score": 0, "creation_date": 1476827981, "post_id": 40118791, "comment_id": 67509044, "body": "I post this question with fewer details and less information before, here is a link to the edited version of the same question  <a href=\"http://stackoverflow.com/questions/40067999/checking-words-value-in-excel-file?noredirect=1#comment67422198_40067999\" title=\"checking words value in excel file\">stackoverflow.com/questions/40067999/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1476833537, "creation_date": 1476833537, "answer_id": 40119712, "question_id": 40118791, "link": "https://stackoverflow.com/questions/40118791/numerical-values-of-words-in-excel-cell/40119712#40119712", "title": "Numerical values of words in Excel cell", "body": "<h2>Loop Through Words in a Sentence and Compare to Key Words to Find Sum of Key Word Value</h2>\n\n<hr>\n\n<p><strong><em>This is wildly inefficient code, so depending on the size of your data, run-times could become very long. Place the code found in this answer in a VBA module, and either run it from VBE or assign the macro to a button(shape) on your worksheet.</em></strong></p>\n\n<hr>\n\n<p><strong>The starting data set I used mimics what you provided.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JmaKF.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/JmaKF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>To achieve the result you desire, we can use multiple <code>For Loops</code> after constructing <code>Array()</code>s to \"match\" our values and add up a total sum. The ranges defining TEXT and WORD are dynamic, meaning you can add more and more to them and the code will continue to run all the way to the end on it's own.</strong></p>\n\n<pre><code>Sub WordToValue()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\n    Dim wordArray() As String, word As Variant, myWords As Range\n    Dim keyArray() As String, keyWord As Variant\n    Dim i As Long, numKey As Long, sumWord As Long\n    Dim textRange As Range: Set textRange = ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n    Dim keyRange As Range: Set keyRange = ws.Range(\"D2\", ws.Cells(ws.Rows.Count, \"D\").End(xlUp))\n\n    i = 0\n    numKey = 0\n    sumWord = 0\n    ReDim keyArray(0 To keyRange.Cells.Count)\n    For Each myWords In keyRange\n        keyArray(i) = myWords.Value\n        i = i + 1\n    Next myWords\n\n    For Each myWords In textRange\n        wordArray = Split(myWords.Value, \" \")\n        For Each word In wordArray\n            For Each keyWord In keyArray\n                If LCase(word) = LCase(keyWord) Then\n                     numKey = numKey + 1\n                     sumWord = sumWord + keyRange.Find(what:=keyWord, LookIn:=xlValues, lookat:=xlWhole).Offset(0, 1).Value\n                End If\n            Next keyWord\n        Next word\n        ws.Range(\"B\" &amp; myWords.Row).Value = numKey\n        ws.Range(\"C\" &amp; myWords.Row).Value = sumWord\n        numKey = 0\n        sumWord = 0\n    Next myWords\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>After running this code, the data set will yield the following results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/jWaa6.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/jWaa6.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Let me know if this achieves what you're asking for. </p>\n"}], "owner": {"reputation": 21, "user_id": 3503064, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/100000173357927/picture?type=large", "display_name": "user3503064", "link": "https://stackoverflow.com/users/3503064/user3503064"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476977366, "creation_date": 1476827902, "last_edit_date": 1531161705, "question_id": 40118791, "link": "https://stackoverflow.com/questions/40118791/numerical-values-of-words-in-excel-cell", "title": "Numerical values of words in Excel cell", "body": "<p>I have text cells in \"TEXT\" column in an Excel sheet (for example from A2 to A4), and I have a list of words\\value where each word has a specific value, this list of words\\values are in another sheet or other columns (for example from E2 to F4).</p>\n\n<p>I want to split each string up into individual words and place each word in it's own cell. In a separate range I want to apply each words corresponding value and add each string's values together for a \"RESULT\" sum of the string. </p>\n\n<p><a href=\"https://i.stack.imgur.com/CpO9T.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/CpO9T.png\" alt=\"my trial to solve this - pic2\"></a></p>\n\n<p>It would also be ok if it is possible to compare and return total value in \"RESULT\" cell without splitting \"TEXT\" cell into new cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SQ9Go.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/SQ9Go.png\" alt=\"an example of the results\"></a></p>\n\n<p>What I've tried doing is place each word from a string in it's own cell using Data > DataTools > Text to Columns. Then using <code>VLOOKUP</code> worksheet function to find matching words and applying their corresponding value and then finding the sum of that string range. The code works for smaller data sizes but I'm looking for something more professional and useful (like closer to what the first picture is, compared with the second picture.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1476843359, "creation_date": 1476843359, "answer_id": 40120990, "question_id": 40118779, "link": "https://stackoverflow.com/questions/40118779/looping-through-multiple-sheets-in-multiple-workbooks/40120990#40120990", "title": "Looping through multiple Sheets in Multiple Workbooks", "body": "<p>You don't need to loop through all Workbook objects, or through all Worksheet objects, so your code can be simplified to:</p>\n\n<pre><code>Sub CopyThenPaste()\n\n    Dim wb1 As Workbook\n    Set wb1 = ActiveWorkbook\n\n    Dim wsAtualizaABS As Worksheet\n    Set wsAtualizaABS = wb1.Worksheets(\"AtualizaABS\")\n\n    Dim wb2 As Workbook\n\n    Dim Destino As String\n    Dim Dados As String\n    Dim ABSid As String\n    Dim Pasta As String\n\n    On Error GoTo Errorcatch\n\n    'States the number of the last row that contains relevant information to the Macro\n    ultima_linha = wsAtualizaABS.Range(\"e2\").End(xlDown).Row\n\n    For i = 2 To ultima_linha\n        Destino = wsAtualizaABS.Cells(i, 6).Value\n        Dados = wsAtualizaABS.Cells(i, 7).Value\n        ABSid = wsAtualizaABS.Cells(i, 5).Value\n\n'********************\n'**** This block of code can probably be executed outside the loop,\n'**** unless the path to each workbook is different\n        'Asks the user what is the folder where VBA should look for the Workbook with the new information\n        With Application.FileDialog(msoFileDialogFolderPicker)\n            .Title = \"Por favor escolha uma pasta\"\n            .AllowMultiSelect = False\n            If .Show = -1 Then Pasta = .SelectedItems(1)\n        End With\n'********************\n\n        'Opens the new workbook, copies and then pastes the data in the current Workbook\n        Set wb2 = Workbooks.Open(Filename:=Pasta &amp; \"\\\" &amp; ABSid &amp; \".xls\")\n        wb2.Sheets(Dados).Cells.Copy Destination:=wb1.Worksheets(Destino).Range(\"A1\")\n        wb2.Close\n\n    Next\n\n    Exit Sub\n\nErrorcatch:\n    MsgBox Err.Description\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 991, "user_id": 4300334, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/11efc6b94e12efa079e0b3c6cdbe2f8b?s=128&d=identicon&r=PG&f=1", "display_name": "MBBertolucci", "link": "https://stackoverflow.com/users/4300334/mbbertolucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2058, "favorite_count": 0, "accepted_answer_id": 40120990, "answer_count": 1, "score": 1, "last_activity_date": 1476910062, "creation_date": 1476827856, "last_edit_date": 1476910062, "question_id": 40118779, "link": "https://stackoverflow.com/questions/40118779/looping-through-multiple-sheets-in-multiple-workbooks", "title": "Looping through multiple Sheets in Multiple Workbooks", "body": "<p>My Macro needs to run through this range in the worksheet \"AtualizaABS\" that contains the data necessary for the Macro to work:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KUAJk.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/KUAJk.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li><p>The Macro must check Column F in the range to identify the name of sheet in the current workbook where it is going to paste data (Variable \"Destino\" in the code).</p></li>\n<li><p>Once it has done that, the Macro proceeds to open a new folder in which it is going to search for the workbook which name matches the value in Column E (Variable \"ABSid\" in the code). </p></li>\n<li><p>After identifying the workbook, the Macro must copy all of the cells of the sheet which name matches the values in Column G (Variable \"Dados\" in the code) and then paste the data from the newly opened workbook into the original one (exactly in the sheet determined by variable \"Destino\" and column F).</p></li>\n</ol>\n\n<p>The code works for the first row of the range, but when it comes to looping through the other criteria in the sheet \"AtualizaABS\" and the other Workbooks to be opened, it fails (even though I used \"For each\" commands). </p>\n\n<p>How could I make the Macro loop through the rows in my range and then through the workbooks in the folder determined by the code?</p>\n\n<pre><code>Sub CopyThenPaste()\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim Sheet As Worksheet\nDim PasteStart As Range\nOn Error GoTo Errorcatch\n\n'States the number of the last row thtat contains relevant information to the Macro\nultima_linha = Range(\"e2\", Range(\"e2\").End(xlDown)).Rows.Count\n\n'Selects the data to be used in the Macro\nWorksheets(\"AtualizaABS\").Activate\nFor i = 2 To ultima_linha + 1\nDestino = ActiveSheet.Cells(i, 6).Value\nDados = ActiveSheet.Cells(i, 7).Value\nABSid = ActiveSheet.Cells(i, 5).Value\n\n'Selects all of the cells of the worksheet that is going to be updated\n    Set wb1 = ActiveWorkbook\n    For Each Sheet In wb1.Worksheets\n    Set PasteStart = Worksheets(Destino).[A1]\n    Sheets(Destino).Select\n    Cells.Select\n\n'Asks the user what is the folder where VBA should look for the Workbook with the new information\n    With Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Por favor escolha uma pasta\"\n    .AllowMultiSelect = False\n    If .Show = -1 Then Pasta = .SelectedItems(1)\n    End With\n\n\n'Opens the new workbook, copies and then pastes the data in the current Workbook\n    For Each wb2 In Workbooks\n    Set wb2 = Workbooks.Open(Filename:=Pasta &amp; \"\\\" &amp; ABSid &amp; \".xls\")\n    wb2.Sheets(Dados).Select\n    Cells.Select\n    Selection.Copy\n    wb1.Worksheets(Destino).Paste Destination:=PasteStart\n\n    Application.CutCopyMode = False\n    wb2.Close\n\n\n    Next\n\n    Next\n\n\nNext\n\n\nExit Sub\nErrorcatch:\nMsgBox Err.Description\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for the attention.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "edited": false, "score": 1, "creation_date": 1476892878, "post_id": 40120589, "comment_id": 67542487, "body": "How would I get this to apply to the entire workbook?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1476840322, "creation_date": 1476840322, "answer_id": 40120589, "question_id": 40118763, "link": "https://stackoverflow.com/questions/40118763/screentip-macro/40120589#40120589", "title": "ScreenTip Macro", "body": "<p>This loops over all <em>existing</em> hyperlinks on the active sheet, and sets their ScreenTip properties</p>\n\n<pre><code>Sub Demo()\n    Dim hl As Hyperlink\n\n    For Each hl In ActiveSheet.Hyperlinks\n        hl.ScreenTip = CStr(hl.Range.Value)\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1487553502, "creation_date": 1487553502, "answer_id": 42335035, "question_id": 40118763, "link": "https://stackoverflow.com/questions/40118763/screentip-macro/42335035#42335035", "title": "ScreenTip Macro", "body": "<p>As per your question:    </p>\n\n<pre><code>Dim hy As Hyperlink\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Sheets\n    For Each hy In ws.Hyperlinks\n        hy.ScreenTip = CStr(hy.Range.Value2)\n     Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 40120589, "answer_count": 2, "score": 1, "last_activity_date": 1487553633, "creation_date": 1476827751, "last_edit_date": 1487553633, "question_id": 40118763, "link": "https://stackoverflow.com/questions/40118763/screentip-macro", "title": "ScreenTip Macro", "body": "<p>I am trying to write a macro that </p>\n\n<ul>\n<li>finds each hyperlink,</li>\n<li>copies the name of the word the hyperlink is embedded in and then makes that the <code>ScreenTip</code></li>\n</ul>\n\n<p>Currently I have to do it for each cell. How do I update every hyperlink in my workbook? </p>\n\n<pre><code>Sub ScreenTip()\nOn Error Resume Next\nActiveSheet.Hyperlinks.Add Anchor:=Cells(8, 2), Address:=\"\", ScreenTip:=CStr(Cells(8, 2).Value)\nActiveSheet.Hyperlinks.Add Anchor:=Cells(8, 3), Address:=\"\", ScreenTip:=CStr(Cells(8, 3).Value)\nActiveSheet.Hyperlinks.Add Anchor:=Cells(8, 4), Address:=\"\", ScreenTip:=CStr(Cells(8, 4).Value)\nActiveSheet.Hyperlinks.Add Anchor:=Cells(8, 5), Address:=\"\", ScreenTip:=CStr(Cells(8, 5).Value)\nActiveSheet.Hyperlinks.Add Anchor:=Cells(8, 6), Address:=\"\", ScreenTip:=CStr(Cells(8, 6).Value)\n `..... etc\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7039006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba56639662914e11724362dcd985376?s=128&d=identicon&r=PG&f=1", "display_name": "Ben McCarty", "link": "https://stackoverflow.com/users/7039006/ben-mccarty"}, "edited": false, "score": 0, "creation_date": 1476896853, "post_id": 40118957, "comment_id": 67544764, "body": "That worked flawlessly.  Thank you so much.  I&#39;m actually a sophomore studying computer science and if there is one thing that I&#39;ve learned it&#39;s never name anything with spaces.  I did not make this database, but spaces are still haunting me."}], "tags": [], "owner": {"reputation": 1341, "user_id": 3605547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqf4J.jpg?s=128&g=1", "display_name": "Orilux", "link": "https://stackoverflow.com/users/3605547/orilux"}, "is_accepted": true, "score": 2, "last_activity_date": 1476828735, "creation_date": 1476828735, "answer_id": 40118957, "question_id": 40118746, "link": "https://stackoverflow.com/questions/40118746/add-record-if-it-doesnt-exist/40118957#40118957", "title": "Add record if it doesn&#39;t exist", "body": "<p>You should wrap <code>TEST_Budget Information</code> in square brackets and you are missing a couple of spaces. Try this: </p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO [TEST_Budget Information] ([ID to Link])\" &amp; _\n                \" VALUES ('\" &amp; [Internal ID to Link] &amp; \"')\"\n</code></pre>\n\n<p>I would recommend that in the future you avoid having spaces in your table and column names, as they can cause trouble.</p>\n"}], "owner": {"reputation": 3, "user_id": 7039006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba56639662914e11724362dcd985376?s=128&d=identicon&r=PG&f=1", "display_name": "Ben McCarty", "link": "https://stackoverflow.com/users/7039006/ben-mccarty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 40118957, "answer_count": 1, "score": 0, "last_activity_date": 1489953663, "creation_date": 1476827664, "last_edit_date": 1489953663, "question_id": 40118746, "link": "https://stackoverflow.com/questions/40118746/add-record-if-it-doesnt-exist", "title": "Add record if it doesn&#39;t exist", "body": "<p>I am trying to write a condition check that checks for the record to exist: if it does then it opens a form whereas if it doesn't it first adds a record and then opens the form.</p>\n\n<p>I got the condition check to work but I cannot figure out how to add a record to the table.</p>\n\n<p>The table has only two columns (ID, ID to Link).  ID is an auto-number and is the primary key.  ID to Link is only for linking budget information to the appropriate account.</p>\n\n<p>The code results in a Runtime Error (3134, syntax error in INSERT INTO statement).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Test_Budget_Click()\n\n  If IsNull(DLookup(\"[ID to Link]\", \"TEST_Budget Information\", \"[ID to Link] = \" &amp; _\n    [Forms]![Award Information]![Internal ID to Link] &amp; \"\")) Then\n\n      DoCmd.RunSQL \"INSERT INTO TEST_Budget Information([ID to Link])\" &amp; _\n        \"VALUES ('\" &amp; [Internal ID to Link] &amp; \"')\"\n      MsgBox \"Record does not exist\"\n  Else\n      MsgBox \"Record Exists\"\n  End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "hyperlink", "excel-2016", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476843595, "post_id": 40119320, "comment_id": 67512966, "body": "Wouldn&#39;t that remove the Hyperlink, and not just the associated ScreenTip?"}], "tags": [], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "is_accepted": false, "score": 0, "last_activity_date": 1476830812, "creation_date": 1476830812, "answer_id": 40119320, "question_id": 40118683, "link": "https://stackoverflow.com/questions/40118683/remove-excel-hyperlink-screen-tips/40119320#40119320", "title": "Remove Excel Hyperlink Screen Tips", "body": "<p>I don't mean to ask an obvious question, but have you selected Remove Hyperlink?</p>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 1, "last_activity_date": 1476831147, "creation_date": 1476831147, "answer_id": 40119365, "question_id": 40118683, "link": "https://stackoverflow.com/questions/40118683/remove-excel-hyperlink-screen-tips/40119365#40119365", "title": "Remove Excel Hyperlink Screen Tips", "body": "<p>Hyperlink objects have a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197693.aspx\" rel=\"nofollow\">ScreenTip property</a> which is read/write.</p>\n\n<p>If you set this property to the empty string, however, you will end up with a lengthy default ScreenTip that describes how to follow the link and how to edit the cell. The closest you can get to having no ScreenTip is to set the property to a single space - this makes the ScreenTip appear as a small box with no text:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\").Hyperlinks(1).ScreenTip = \" \"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RW8qb.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/RW8qb.png\" alt=\"Part of an Excel spreadsheet with a hyperlink in cell A1. The hyperlink text reads &quot;A hyperlink&quot; and there is a small white box immediately below the text\"></a></p>\n\n<p>There doesn't seem to be any obvious way to eliminate the ScreenTip entirely</p>\n"}], "owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 40119365, "answer_count": 2, "score": 0, "last_activity_date": 1476831147, "creation_date": 1476827337, "last_edit_date": 1531161705, "question_id": 40118683, "link": "https://stackoverflow.com/questions/40118683/remove-excel-hyperlink-screen-tips", "title": "Remove Excel Hyperlink Screen Tips", "body": "<p>When you add a hyperlink in Excel it creates a screen tip which you can modify it by going to edit hyperlink and the \"screentip\" but how would I remove it completely so that when you put your courser over a hyperlink that nothing appears. </p>\n\n<p><a href=\"https://i.stack.imgur.com/otsXK.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/otsXK.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/SZybK.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/SZybK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1476828514, "creation_date": 1476828514, "answer_id": 40118916, "question_id": 40118594, "link": "https://stackoverflow.com/questions/40118594/how-to-skip-a-column-while-and-not-copy-that-column-and-copy-the-other-columns/40118916#40118916", "title": "How to skip a column while and not copy that column and copy the other columns", "body": "<p>You can use <code>Union</code> to create a non-contiguous range to copy, like this</p>\n\n<pre><code>Sub Distinct()\n    Const TRNS_START As String = \"TRNS\"\n    Const TRNS_END As String = \"ENDTRNS\"\n    Const COMPANY As String = \"Triumph Foods LLC\"\n\n    Dim searchRng As Range, copyRngStart As Range, copyRngEnd As Range, copyRng As Range\n    Dim wsFrom As Worksheet\n\n    Set wsFrom = Worksheets(\"Information\")\n    Set searchRng = wsFrom.Range(\"A1\")\n\n    ' Enter/continue loop while A-column is non-empty\n    Do While Not IsEmpty(searchRng.Value)    \n        ' When we encounter the string TRNS in column A and Triumph Foods LLC in column E\n        If searchRng.Value = TRNS_START And _\n           searchRng.Offset(0, 4).Value = COMPANY Then\n\n            Set copyRngStart = searchRng ' Set the start of the copy area\n        End If\n\n        ' When we encounter the string ENDTRNS\n        '    (*and had a start cell already*)\n        If searchRng.Value = TRNS_END And Not copyRngStart Is Nothing Then\n\n            Set copyRngEnd = searchRng.Offset(-1, 6) ' A:G\n\n            Set copyRng = wsFrom.Range(copyRngStart, copyRngEnd)\n            ' union with I\n            Set copyRng = Application.Union(copyRng, copyRng.Columns(1).Offset(, 8))     \n            copyRng.Copy _\n              Destination:=Sheets(\"Display\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n\n            Set copyRngStart = Nothing 'clear the \"start\" range\n\n        End If\n        Set searchRng = searchRng.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476887604, "post_id": 40118937, "comment_id": 67538663, "body": "Thanks for the downvote without any explanation! Whoever it was!"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": -1, "last_activity_date": 1476828651, "creation_date": 1476828651, "answer_id": 40118937, "question_id": 40118594, "link": "https://stackoverflow.com/questions/40118594/how-to-skip-a-column-while-and-not-copy-that-column-and-copy-the-other-columns/40118937#40118937", "title": "How to skip a column while and not copy that column and copy the other columns", "body": "<p>I'm not much fan of copying using VBA, but prefer to assign the values directly. For your specific issue I suggest breaking the assignation of the values into 2 parts. So in your code when you would be copying the values you would replace your code with:</p>\n\n<pre><code>Sheets(\"Display\").Range(\"A\" &amp; (Sheets(\"Display\").Columns(1).Rows.Count + 1) &amp; \":H\" &amp; (Rows.Count + 1)).Value2 = Worksheets(\"Information\").Range(\"A1:G1\").Offset(copyRngStart.Row, 0)\nSheets(\"Display\").Range(\"I\" &amp; (Sheets(\"Display\").Columns(1).Rows.Count + 1)).Value2 = Worksheets(\"Information\").Range(\"H1\").Offset(copyRngStart.Row, 0)\n</code></pre>\n\n<p>This will write directly first from A to G and then write I to H.Hope this works for you.</p>\n"}], "owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 40118916, "answer_count": 2, "score": 0, "last_activity_date": 1476828651, "creation_date": 1476826989, "question_id": 40118594, "link": "https://stackoverflow.com/questions/40118594/how-to-skip-a-column-while-and-not-copy-that-column-and-copy-the-other-columns", "title": "How to skip a column while and not copy that column and copy the other columns", "body": "<p>I have a code here where it works great is doing what I want for my report but the only problem is that I want to exclude one column while copying data from one file to another. my code copies from column A to I but I want to exclude all data from H and probably move the data from I to the H so I don't have a empty column H. hope this make sense any help is appreciated thanks.</p>\n\n<pre><code>Sub Distinct()\nConst TRNS_START As String = \"TRNS\"\n    Const TRNS_END As String = \"ENDTRNS\"\n    Const COMPANY As String = \"Triumph Foods LLC\"\n\n    Dim searchRng As Range, copyRngStart As Range, copyRngEnd As Range\n\n    Set searchRng = Worksheets(\"Information\").Range(\"A1\")\n\n    ' Enter/continue loop while A-column is non-empty\n    Do While searchRng.Value &lt;&gt; \"\"\n\n        ' When we encounter the string TRNS in column A and Triumph Foods LLC in column E\n        If searchRng.Value = TRNS_START And _\n           searchRng.Offset(0, 4).Value = COMPANY Then\n\n            Set copyRngStart = searchRng ' Set the start of the copy area\n        End If\n\n        ' When we encounter the string ENDTRNS\n        '    (*and had a start cell already*)\n        If searchRng.Value = TRNS_END And Not copyRngStart Is Nothing Then\n\n            Set copyRngEnd = searchRng.Offset(-1, 8)\n\n            copyRngEnd.Worksheet.Range(copyRngStart, copyRngEnd).Copy _\n              Destination:=Sheets(\"Display\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n\n            Set copyRngStart = Nothing 'clear the \"start\" range\n\n        End If\n\n        Set searchRng = searchRng.Offset(1, 0)\n    Loop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1476869991, "post_id": 40118496, "comment_id": 67525057, "body": "Unfortunately, there is no support for working with non-contiguous selections or ranges via the Word object model. Selecting multiple ranges can only be done by the user."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1476875913, "post_id": 40118496, "comment_id": 67529580, "body": "P.S.: The limitations are documented <a href=\"https://support.microsoft.com/en-us/kb/288424\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7945899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fJB2H.jpg?s=128&g=1", "display_name": "BAP", "link": "https://stackoverflow.com/users/7945899/bap"}, "is_accepted": false, "score": 0, "last_activity_date": 1502690710, "creation_date": 1502690710, "answer_id": 45668295, "question_id": 40118496, "link": "https://stackoverflow.com/questions/40118496/keep-word-table-cell-selected-when-selecting-another-cell-with-vba/45668295#45668295", "title": "Keep Word Table Cell Selected When Selecting Another Cell with VBA", "body": "<p>Do you need them \"highlighted\"\nor just want the background color to change\nthat is easy</p>\n\n<pre><code>    itable.Cell(1, 2).Shading.BackgroundPatternColor =wdColorAqua\n</code></pre>\n\n<p>you can later search for the different background colors to do things with the data</p>\n\n<p>But I would suggest not using a table and moving to using a user form\nwhich can be set to do just about anything with clicks</p>\n\n<p>you need to set up the form so that one checkbox does not turn off others</p>\n\n<p>I use many such forms for data input in my EHR</p>\n\n<p>if you don't want to change the entire cell\njust use highlight</p>\n\n<pre><code>    Selection.Range.HighlightColorIndex = wdTeal\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6096423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/71a2f5d08e362ba8a8779faed10b42a2?s=128&d=identicon&r=PG&f=1", "display_name": "user6096423", "link": "https://stackoverflow.com/users/6096423/user6096423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502690710, "creation_date": 1476826553, "question_id": 40118496, "link": "https://stackoverflow.com/questions/40118496/keep-word-table-cell-selected-when-selecting-another-cell-with-vba", "title": "Keep Word Table Cell Selected When Selecting Another Cell with VBA", "body": "<p>I have a table with 2 columns. The first has a checkbox, the second contains the text. The checkbox highlights the cell</p>\n\n<pre><code>Sub CB1_Click()\nIf CB1 = True Then\nFor Each itable In ActiveDocument.Tables\nitable.Cell(1, 2).Range.Select\nNext\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The problem is if I check the third row down, the first row loses its selection and does not remain highlighted:</p>\n\n<pre><code>Sub CB3_Click()\nIf CB3 = True Then\nFor Each itable In ActiveDocument.Tables\nitable.Cell(3, 2).Range.Select\nNext\nEnd If\nEnd Sub\n</code></pre>\n\n<p>How can I change the code so after CB1 is clicked, the text in the 2nd coluimn of the first row remains selected when I click on CB3. It is the same effect as holding down the CTRL key and then clicking into the cell I want to copy. I just want to use the checkbox for the same purpose.</p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476826444, "post_id": 40118445, "comment_id": 67508439, "body": "You should share the formula you are using so we could assist."}, {"owner": {"reputation": 3, "user_id": 2708330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee8c7f07aea8e2d8fbb0967bdc2364f?s=128&d=identicon&r=PG&f=1", "display_name": "Marko", "link": "https://stackoverflow.com/users/2708330/marko"}, "edited": false, "score": 0, "creation_date": 1476826496, "post_id": 40118445, "comment_id": 67508458, "body": "Simple adding formula &quot;=AE2&amp;&quot; &quot;&amp;AF2&amp;&quot; &quot;&amp;AG2&amp;&quot; &quot;&amp;AH2&amp;&quot; &quot;&amp;AI2&amp;&quot; &quot;&amp;AJ2&amp;&quot;.&quot;&amp;AK2&quot;"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1476826931, "post_id": 40118445, "comment_id": 67508668, "body": "if the leading zeroes are done through Formatting this will not produce the results as it will drop formatting and just keep the values. Please see my answer below that converts the values to text in the format described and then concatenates them."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2708330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee8c7f07aea8e2d8fbb0967bdc2364f?s=128&d=identicon&r=PG&f=1", "display_name": "Marko", "link": "https://stackoverflow.com/users/2708330/marko"}, "edited": false, "score": 0, "creation_date": 1476828280, "post_id": 40118606, "comment_id": 67509150, "body": "Thank you for your help. This solves 90% of my problems, the problem is some cells have 1 number, and some have 11 numbers, so when I setup the code to have 0# or 00# changes the output. Please check the marked cell on screenshot. Can this be avoided somehow ?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 3, "user_id": 2708330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee8c7f07aea8e2d8fbb0967bdc2364f?s=128&d=identicon&r=PG&f=1", "display_name": "Marko", "link": "https://stackoverflow.com/users/2708330/marko"}, "edited": false, "score": 0, "creation_date": 1476829522, "post_id": 40118606, "comment_id": 67509572, "body": "Can you confirm that the format of each column remains consistent? I have figured a way to vary the formatting inside the <code>TEXT()</code> depending on the number of digits of the numbers. But you must know the total number of characters that each column should have as it must be hardcoded into the formula. Edit of formula will follow."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1476829896, "last_edit_date": 1476829896, "creation_date": 1476827051, "answer_id": 40118606, "question_id": 40118445, "link": "https://stackoverflow.com/questions/40118445/show-exact-numbers-in-excels-formula-calculation/40118606#40118606", "title": "Show exact numbers in excels formula calculation", "body": "<p>Assuming values on A1 to D1, formula would be:</p>\n\n<pre><code>=TEXT(A1,\"00#\")&amp;\" \"&amp;TEXT(B1,\"00#\")&amp;\" \"&amp;TEXT(C1,\"00#\")&amp;\" \"&amp;TEXT(D1,\"00#\")\n</code></pre>\n\n<p>The format must be specified in the formula for each one which should work for your use as seems that each number has different expected formatting. It will then format the value as text with the specific formatting and then concatenate them with spaces or whatever delimiter you use in between.</p>\n\n<p>EDIT: per OP clarifications in comment solution could be assuming a 2,1,3,2 length of digits for 4 columns of numbers (which you can change inside the <code>REPT()</code>) formula would be:</p>\n\n<pre><code>=TEXT(A1,REPT(\"0\",2-LEN(A1))&amp;REPT(\"#\",LEN(A1)))&amp;\" \"&amp;TEXT(B1,REPT(\"0\",1-LEN(B1))&amp;REPT(\"#\",LEN(B1)))&amp;\" \"&amp;TEXT(C1,REPT(\"0\",3-LEN(C1))&amp;REPT(\"#\",LEN(C1)))&amp;\" \"&amp;TEXT(D1,REPT(\"0\",2-LEN(D1))&amp;REPT(\"#\",LEN(D1)))\n</code></pre>\n\n<p>Regards,</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1476836730, "last_edit_date": 1476836730, "creation_date": 1476835832, "answer_id": 40120029, "question_id": 40118445, "link": "https://stackoverflow.com/questions/40118445/show-exact-numbers-in-excels-formula-calculation/40120029#40120029", "title": "Show exact numbers in excels formula calculation", "body": "<p>Here is a UDF that will return the result exactly as it shows in the original columns, including with the formatting.  No need to know the formatting beforehand.</p>\n\n<pre><code>Option Explicit\nFunction ConcatWithFormat(rg As Range) As String\n    Dim V As Variant\n    Dim I As Long\n\nReDim V(1 To rg.Count - 1)\nFor I = 1 To rg.Count - 1\n    V(I) = rg(I).Text\nNext I\n\nV(I - 1) = V(I - 1) &amp; \".\" &amp; rg(I).Text\n\nConcatWithFormat = Join(V)\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XDeuI.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/XDeuI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 2708330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee8c7f07aea8e2d8fbb0967bdc2364f?s=128&d=identicon&r=PG&f=1", "display_name": "Marko", "link": "https://stackoverflow.com/users/2708330/marko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476836730, "creation_date": 1476826346, "question_id": 40118445, "link": "https://stackoverflow.com/questions/40118445/show-exact-numbers-in-excels-formula-calculation", "title": "Show exact numbers in excels formula calculation", "body": "<p>I have numbers in cells like 001 , 011, 01, 03, 013 ( I used the custom cell formating 00 and/or 000) and when I use a formula on them to show in one cell all together I get it like this : 1 0 31 2 0 7 4 instead of 01 00 31 02 00 007.004. What should I do. </p>\n\n<p>Screenshot:</p>\n\n<p><a href=\"https://s4.postimg.org/61q9ybj31/image.jpg\" rel=\"nofollow\">https://s4.postimg.org/61q9ybj31/image.jpg</a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1476862308, "post_id": 40117576, "comment_id": 67519878, "body": "You should retrieve <i>Quantity</i> as is, then format the values when displayed by setting the format (property) of the textbox."}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1476862638, "post_id": 40117576, "comment_id": 67520092, "body": "@Gustav Ok, I will try that. Do you know how I should use format to get the expected result with two decimals?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1476862917, "post_id": 40117576, "comment_id": 67520278, "body": "Yes. For display (text) it would be: <code>Format([Quantity], &quot;0.00&quot;)</code>. To retrieve numeric values rounded by 4/5 to two decimals, it would be: <code>CCur(Format([Quantity], &quot;0.00&quot;))</code>. To set the Format property, use: &quot;0.00&quot;, or just &quot;Standard&quot;."}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1476863052, "post_id": 40117576, "comment_id": 67520374, "body": "@Gustav Thanks. If you provide that as an answer I will accept that solution."}], "answers": [{"comments": [{"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "edited": false, "score": 0, "creation_date": 1476854060, "post_id": 40118117, "comment_id": 67515745, "body": "The docs of CurrentDb.OpenRecordset says &quot;The source can be a table name, a query name, or an SQL statement that returns records&quot;..If i remove the convert and only select the quantity it works..So it is possible to send SQL"}, {"owner": {"reputation": 5832, "user_id": 4155665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7IH7Y.png?s=128&g=1", "display_name": "jleach", "link": "https://stackoverflow.com/users/4155665/jleach"}, "edited": false, "score": 1, "creation_date": 1476860082, "post_id": 40118117, "comment_id": 67518517, "body": "JET/ACE (the Access db engine) has it&#39;s own dialect of SQL, which doesn&#39;t include CONVERT.  (T-SQL is the SQL Server implementation of the SQL language: every database engine has a slightly different dialect)"}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1476825028, "creation_date": 1476825028, "answer_id": 40118117, "question_id": 40117576, "link": "https://stackoverflow.com/questions/40117576/vba-convert-number-to-decimal-when-using-sql-on-ms-access/40118117#40118117", "title": "Vba - Convert number to decimal when using SQL on Ms Access", "body": "<p>Surprise! Access doesn't use T-SQL.</p>\n\n<p>I think you want the FORMAT() function.</p>\n\n<p><a href=\"http://rogersaccessblog.blogspot.com/2013/05/what-are-differences-between-access-sql.html\" rel=\"nofollow\">What are differences between access sql</a></p>\n\n<p><a href=\"https://www.techonthenet.com/access/functions/\" rel=\"nofollow\">techonthenet.com/access/functions/</a></p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1476863244, "creation_date": 1476863244, "answer_id": 40125203, "question_id": 40117576, "link": "https://stackoverflow.com/questions/40117576/vba-convert-number-to-decimal-when-using-sql-on-ms-access/40125203#40125203", "title": "Vba - Convert number to decimal when using SQL on Ms Access", "body": "<p>For display (text) it would be: </p>\n\n<pre><code>Format([Quantity], \"0.00\")\n</code></pre>\n\n<p>To retrieve numeric values rounded by 4/5 to two decimals, it would be: </p>\n\n<pre><code>CCur(Format([Quantity], \"0.00\")) \n</code></pre>\n\n<p>To set the <em>Format</em> property, use: </p>\n\n<pre><code>\"0.00\", or just \"Standard\". \n</code></pre>\n"}], "owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3103, "favorite_count": 0, "accepted_answer_id": 40125203, "answer_count": 2, "score": 0, "last_activity_date": 1476863244, "creation_date": 1476822843, "last_edit_date": 1476859954, "question_id": 40117576, "link": "https://stackoverflow.com/questions/40117576/vba-convert-number-to-decimal-when-using-sql-on-ms-access", "title": "Vba - Convert number to decimal when using SQL on Ms Access", "body": "<p>Trying to convert a number value to decimal, with two decimals (,00), in vba when selecting value from MS Access table.\nThe Quantity column is of type number and the code Im using to format it is </p>\n\n<pre><code>Dim rstBody As DAO.Recordset\nDim orderBodyQuery As String\norderBodyQuery = \"SELECT distinct CONVERT(Decimal(9,2), Quantity) FROM \" + mainTable + \" WHERE [\" + uniqOrderColumn + \"] = \"\"\" + order + \"\"\"\"\nSet rstBody = CurrentDb.OpenRecordset(orderBodyQuery, dbOpenSnapshot)\n</code></pre>\n\n<p>This results in the error:</p>\n\n<blockquote>\n  <p>Undefined function 'CONVERT' in expression</p>\n</blockquote>\n\n<p>As the error describes Im guessing Im using the wrong syntax here (SQL Server) but I can't find how to do this.\nPlease help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1476826371, "creation_date": 1476826371, "answer_id": 40118449, "question_id": 40117424, "link": "https://stackoverflow.com/questions/40117424/vba-lock-a-single-cell-in-current-code/40118449#40118449", "title": "VBA lock a single cell in current code", "body": "<p>How about:</p>\n\n<pre><code>Sub Copy_Tabs_New()\n    Dim x, ListItem As Variant\n    Dim numtimes As Byte\n\n    x = InputBox(\"Enter number of times to copy 4075 Wilson\")\n    If Not IsNumeric(x) Then Exit Sub\n    If (x &lt; 1) Or (x &gt; 55) Then Exit Sub\n    ActiveWorkbook.Sheets(\"4075 Wilson\").Select\n    ListItem = Range(\"C3\").Value\n    Application.ScreenUpdating = False\n    For numtimes = 1 To x\n        ActiveWorkbook.Sheets(\"4075 Wilson\").Copy After:=ActiveSheet\n        Range(\"H3\").Value = ListItem\n        Call freeeze\n        Range(\"C3\").Value = Range(\"B2\").Value\n        ListItem = Range(\"C3\").Value\n    Next\n    ActiveWorkbook.Sheets(\"4075 Wilson\").Select\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub freeeze()\n    With ActiveSheet\n        .Unprotect\n        .Cells.Locked = False\n        .Range(\"H3\").Locked = True\n        .Protect\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7036642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9adbe0df20ca75201dd3d89efc1342?s=128&d=identicon&r=PG&f=1", "display_name": "CaL", "link": "https://stackoverflow.com/users/7036642/cal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 40118449, "answer_count": 1, "score": 0, "last_activity_date": 1477085513, "creation_date": 1476822210, "last_edit_date": 1531164843, "question_id": 40117424, "link": "https://stackoverflow.com/questions/40117424/vba-lock-a-single-cell-in-current-code", "title": "VBA lock a single cell in current code", "body": "<p>I hope you can help and thanks in advance. I have a following code and I like to add a code that freeze/locked cell <code>$H$3</code>. Please help.</p>\n\n<pre><code>Sub Copy_Tabs_New()\nDim x, ListItem As Variant\nDim numtimes As Byte\nx = InputBox(\"Enter number of times to copy 4075 Wilson\")\nIf Not IsNumeric(x) Then Exit Sub\nIf (x &lt; 1) Or (x &gt; 55) Then Exit Sub\nActiveWorkbook.Sheets(\"4075 Wilson\").Select\nListItem = Range(\"C3\").Value\nApplication.ScreenUpdating = False\nFor numtimes = 1 To x\n    ActiveWorkbook.Sheets(\"4075 Wilson\").Copy After:=ActiveSheet\n    Range(\"H3\").Value = ListItem\n    Range(\"C3\").Value = Range(\"B2\").Value\n    ListItem = Range(\"C3\").Value\nNext\nActiveWorkbook.Sheets(\"4075 Wilson\").Select\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476822207, "post_id": 40117217, "comment_id": 67506335, "body": "<code>Set myrng = ws.Range(&quot;A2:d&quot; &amp; Range(&quot;A&quot; &amp; ws.Rows.Count).End(xlUp).Row)</code> should be <code>Set myrng = ws.Range(&quot;A2:d&quot; &amp; ws.Range(&quot;A&quot; &amp; ws.Rows.Count).End(xlUp).Row)</code> - that&#39;s what is probably causing your error.  But the code you are using will not do what you want it to do - all your code is doing is highlighting duplicate values within the range (e.g. all the <code>0</code> values will be set to have one colour, and all the <code>7</code>s will be set to another colour, etc.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476822326, "post_id": 40117217, "comment_id": 67506408, "body": "Just a technicality: VBA doesn&#39;t <i>throw exceptions</i>, it <i>raises errors</i>. I <b>wish</b> we had exceptions (and a frakkin&#39; stack trace!!) in VBA =)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476822464, "post_id": 40117217, "comment_id": 67506478, "body": "And <code>.Find</code> will return <code>Nothing</code> if there&#39;s no match, so calling <code>.Address</code> on the result without checking if there&#39;s actually an object reference there, is asking for the runtime error you&#39;re getting."}, {"owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476822748, "post_id": 40117217, "comment_id": 67506623, "body": "@YowE3K, can u give me an example code to get highlighted like in picture"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1476822823, "post_id": 40117217, "comment_id": 67506660, "body": "@Mat&#39;sMug - but considering that the <code>.Find</code> is only searching for something that is already known to be in <code>myrng</code> (i.e. searching within <code>myrng</code> for <code>cell</code> within a <code>For Each cell In myrng</code> loop) the <code>.Find</code> <b>should</b> always get a match."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476822879, "post_id": 40117217, "comment_id": 67506690, "body": "@YowE3K right - I only merely skimmed through the code, that struck me as a good place for error 91 to be raised."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476823436, "post_id": 40117217, "comment_id": 67507003, "body": "@sam - I can&#39;t write the code without knowing the full rules that you are trying to embed in the code (e.g. why is one <code>8A83-AA</code>&#39;s value meant to be highlighted in orange while the other four are highlighted green?  why are none of the four <code>7L14-AA0014</code> values highlighted in green?).  Why don&#39;t you start writing the code and show us what you come up with and tell us which bits aren&#39;t working - we will have a much better chance of understanding your desired rules from seeing your first cut of the code than from reading your description."}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "is_accepted": false, "score": 0, "last_activity_date": 1476836933, "creation_date": 1476836933, "answer_id": 40120161, "question_id": 40117217, "link": "https://stackoverflow.com/questions/40117217/exception-when-highlighting-duplicates/40120161#40120161", "title": "Exception when highlighting duplicates", "body": "<p>use a loop that will tell the cells in val1 from val2 if they are equal or not. Put your loop for val1 and search through val2.</p>\n"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476836933, "creation_date": 1476821412, "question_id": 40117217, "link": "https://stackoverflow.com/questions/40117217/exception-when-highlighting-duplicates", "title": "Exception when highlighting duplicates", "body": "<p>I'm trying to highlight values in one column based on another column data. I have C1,C2 colums where for eg: 8A83-AA in both C1 and C2 has different Val1 and Val2 in some rows, if 8A83-AA(both occurrences) that matches val1 and val2 data then val1 highlight with green otherwise orange. The result should looks like</p>\n\n<p><a href=\"https://i.stack.imgur.com/alN5S.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/alN5S.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried the code in stackoverflow</p>\n\n<pre><code>Sub Highlight_Duplicate_Entry()\nDim ws As Worksheet\nDim cell As Range\nDim myrng As Range\nDim clr As Long\nDim lastCell As Range\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\nSet myrng = ws.Range(\"A2:d\" &amp; Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row)\nWith myrng\n    Set lastCell = .Cells(.Cells.Count)\nEnd With\nmyrng.Interior.ColorIndex = xlNone\nclr = 3\n\nFor Each cell In myrng\n    If Application.WorksheetFunction.CountIf(myrng, cell) &gt; 1 Then\n        ' addresses will match for first instance of value in range\n        If myrng.Find(what:=cell, lookat:=xlWhole, MatchCase:=False, after:=lastCell).Address = cell.Address Then\n            ' set the color for this value (will be used throughout the range)\n            cell.Interior.ColorIndex = clr\n            clr = clr + 1\n        Else\n            ' if not the first instance, set color to match the first instance\n            cell.Interior.ColorIndex = myrng.Find(what:=cell, lookat:=xlWhole, MatchCase:=False, after:=lastCell).Interior.ColorIndex\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>but it gives me exception object or block variable not set. I tried this range for one column at a time\n   <code>Set myrng = ws.Range(\"A2:A600\")</code>, it works. \n but for multiple column \n   <code>Set myrng = ws.Range(\"A2:D600\")</code> it is giving exception.\nAnd how do i highlight which looks like in above picture data with VBA or conditional formating.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1476819855, "post_id": 40116752, "comment_id": 67504980, "body": "Sort on column B descending then use remove duplicates on Column A."}, {"owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1476820043, "post_id": 40116752, "comment_id": 67505100, "body": "Thanks Scott! I think I was overthinking it."}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 7035537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde29a7d8f4150cb2f2907808f249181?s=128&d=identicon&r=PG&f=1", "display_name": "GNMercado", "link": "https://stackoverflow.com/users/7035537/gnmercado"}, "is_accepted": false, "score": 0, "last_activity_date": 1476836063, "creation_date": 1476836063, "answer_id": 40120051, "question_id": 40116752, "link": "https://stackoverflow.com/questions/40116752/filter-excel-data-by-most-recent-date/40120051#40120051", "title": "Filter excel data by most recent date", "body": "<p>Sort by date and filter the ID on your choice.</p>\n"}], "owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476836063, "creation_date": 1476819752, "question_id": 40116752, "link": "https://stackoverflow.com/questions/40116752/filter-excel-data-by-most-recent-date", "title": "Filter excel data by most recent date", "body": "<p>I have a list of IDs, dates and scores and I need to get the score corresponding to the latest date. The data looks like this:</p>\n\n<pre><code>ID  |   Date      |  Score\n___________________________\n123 |  03/15/2016 |  10\n123 |  08/10/2016 |  4\n456 |  09/01/2016 |  7\n456 |  02/02/2016 |  10\n678 |  07/01/2016 |  2\n987 |  04/18/2016 |  9\n987 |  03/02/2016 |  4\n</code></pre>\n\n<p>I want to pull the score for the most recent date, and only have one line per ID. Ideally, the finished table would look like this.</p>\n\n<pre><code>ID  |   Date      |  Score\n___________________________\n123 | 08/10/2016  |  4\n456 | 09/01/2016  |  7\n678 | 07/01/2016  |  2\n987 | 04/18/2016  |  9\n</code></pre>\n\n<p>I have tried to filter and sort this, but I have not been able to. If anyone has any ideas, or a snippet of VBA that would accomplish this, that would be awesome.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "is_accepted": true, "score": 0, "last_activity_date": 1476835867, "last_edit_date": 1476835867, "creation_date": 1476835153, "answer_id": 40119946, "question_id": 40116475, "link": "https://stackoverflow.com/questions/40116475/sorted-list-is-not-printing-vba-to-excel/40119946#40119946", "title": "Sorted list is not printing: VBA to Excel", "body": "<p>As this is an expansive spreadsheet, I narrowed my initial test field down to two arrays. The issue was that my list counters were not incrementing because they were pointing to a list which had, in my actual code, been commented out for testing purposes. As such, the subsequent lists (list1, list2, list3 ...) were limited to the number of records in the \"initial\" list. Therefore, there was nothing to trigger the For loops for data output: list.Count - 1 had no value so the For loop was skipped.</p>\n\n<p>As each list has the same number of records, my initial condition was simply to use the first list's index as the bounds for all subsequent lists. However, this breaks if the first list is not run (during testing). The best solution is to have each list's for loop check for it's own individual bounds.</p>\n\n<pre><code>For x=0 to list.Count -1\n  d=list.getkey(x)\n  do stuff\nNext\n\nFor X=0 to list1.Count-1\n d=list1.getkey(x)\n do stuff\nNext\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 40119946, "answer_count": 1, "score": 0, "last_activity_date": 1476835867, "creation_date": 1476818785, "question_id": 40116475, "link": "https://stackoverflow.com/questions/40116475/sorted-list-is-not-printing-vba-to-excel", "title": "Sorted list is not printing: VBA to Excel", "body": "<p>I have an array which is grabbing data from multiple worksheets to print out to a summary sheet in a single workbook. The array, when stepping through the code, appears to be grabbing the correct data through all sheets. The array should then save, at each pass through the loop, information to sorted lists.</p>\n\n<p>Source data is composed of two side by side (horizontal) sections representing two workers. The data for each worker, in terms of formating is identical. </p>\n\n<p>My lists are not printing to the summary page and there seems to be an issue with list.count. If I have list.count -1 then the for loop does not run at all. If I omit the -1 then I get a single pass of the loop. </p>\n\n<p>What is the problem with either the arrays being stored in the list and/or the output of the lists to the summary sheet?</p>\n\n<pre><code>Dim arTemp\nDim arTemp1\nDim d As Date\nDim x As Long, Y As Integer\nDim ws As Worksheet\nDim list As Object, list1 As Object\n\nSet list = CreateObject(\"System.Collections.SortedList\")\nSet list1 = CreateObject(\"System.Collections.SortedList\")\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Summary\" And ws.Name &lt;&gt; \"SheetX\" Then\n        With ws\n            For y = 3 to 7\n                d=DateSerial(Year(.Cells(3,y)), Month(.Cells(3,y)),1\n                If List.containskey(d) then\n                    arTemp = list(d)\n                    arTemp1 = list1(d)\n                Else\n                    ReDim arTemp(13)\n                    ReDim arTemp1(13)\n                End If\n                arTemp(0) = arTemp(0) + .Cells(4,y)\n                arTemp(1) = arTemp(1) + .Cells(5,y)\n                arTemp(2) = arTemp(2) + .Cells(6,y)\n                .\n                .\n                .\n                arTemp(12) = arTemp(12) + .Cells(16,y)\n                arTemp(13) = arTemp(13) + 1\n                list(d) = arTemp\n\n                arTemp1(0) = arTemp1(0) + .Cells(4,y + 11)\n                arTemp1(1) = arTemp1(1) + .Cells(5,y + 11)\n                arTemp1(2) = arTemp1(2) + .Cells(6,y + 11)\n                .\n                .\n                .\n                arTemp1(12) = arTemp1(12) + .Cells(16,y + 11)\n                arTemp1(13) = arTemp1(13) + 1\n                list1(d) = arTemp1\n            Next\n        End With\n    End If\nNext\n\nWith Worksheets(\"Summary\")\n    .Cells.Delete\n    For x = 0 To list.Count - 1\n        d = list.getkey(x)\n        .Cells(x + 43, 1) = Year(d)\n        .Cells(x + 43, 2) = Month(d)\n        .Cells(x + 43, 3) = list(d)(0)\n        .Cells(x + 43, 4) = list(d)(1)\n        .\n        .\n        .\n        .Cells(x +43, 15) = list(d)(12)\n    Next\n\n    For x = 0 To list.Count - 1\n        d = list1.getkey(x)\n        .Cells(x + 43, 1) = Year(d)\n        .Cells(x + 43, 2) = Month(d)\n        .Cells(x + 43, 3) = list1(d)(0)\n        .Cells(x + 43, 4) = list1(d)(1)\n        .\n        .\n        .\n        .Cells(x +43, 15) = list1(d)(12)\n    Next\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476817133, "post_id": 40115922, "comment_id": 67503473, "body": "Assuming you have numbers in cells H1:H12, ensure you convert <code>inputData</code> from a <code>Variant</code> to an Integer by using <code>wsFunc.VLookup(CInt(inputData), rngLook, 2, False)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1476817512, "post_id": 40115922, "comment_id": 67503682, "body": "Or use an Application.InputBox instead of just an InputBox, and use the <code>Type</code> parameter with a value of 1."}, {"owner": {"reputation": 43, "user_id": 6672827, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/726097cd50f8e9223a2263f50ac27f61?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6672827/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476817586, "post_id": 40115922, "comment_id": 67503727, "body": "You&#39;re the man :) . Yes the information on that range has numbers on the 1st column and text on the 2nd column . I believe this can be fixed if I change the variable to integer right ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476818189, "post_id": 40115922, "comment_id": 67504020, "body": "(a) Using <code>wsFunc.VLookup(CInt(inputData), rngLook, 2, False)</code> would be the <b>simplest</b> fix - it coerces the contents of <code>inputData</code> to an integer, and that will then be matched against your H1:H12 data.  (But I recommend that you place some validity checks on <code>InputData</code> to give proper warnings if the user enters &quot;xyz&quot;, or &quot;13&quot;, etc.)  (b) Using an <code>Application.InputBox</code> with a <code>Type</code> of 1 will at least ensure that the user enters a number, but you should still do validity checking before using it.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839468.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839468.aspx</a>"}, {"owner": {"reputation": 43, "user_id": 6672827, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/726097cd50f8e9223a2263f50ac27f61?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6672827/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1476819299, "post_id": 40115922, "comment_id": 67504671, "body": "I&#39;ve updated with the Cint and it was working fine but now is failing again and I have not changed anything. I have updated the code on the main question"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476819670, "post_id": 40116614, "comment_id": 67504887, "body": "Do <code>Application.Vlookup</code> instead of <code>WorksheetFunction.Vlookup</code>. The latter does not allow an error value to be returned, and you <i>may</i> need to trap for error value if the <code>inputData</code> value is not found in <code>rngLook</code>. Your validation sufficiently controls for the user-input side of things, but there&#39;s still some possibility that the worksheet itself is broken or manipulated, which would raise an error on the assignment to <code>inputData1</code>."}, {"owner": {"reputation": 43, "user_id": 6672827, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/726097cd50f8e9223a2263f50ac27f61?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6672827/sam"}, "edited": false, "score": 0, "creation_date": 1476820126, "post_id": 40116614, "comment_id": 67505154, "body": "Thanks to Everyone , I also figure out I was getting an error because the range changed as 1 user added a column but know I got it :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476820502, "post_id": 40116614, "comment_id": 67505363, "body": "I have updated the answer based on @DavidZemens suggestions.  (I wish MSDN listed VLookup as one of the Application object&#39;s Methods!! )"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476820691, "post_id": 40116614, "comment_id": 67505466, "body": "@YowE3K there is also an <code>Application.Match</code> and <code>Application.Index</code> function, all of which can return Error type. Very useful to have these :) Instead of raising an error or handling with <code>On Error GoTo...</code> you can trap <code>If IsError(Application.Match(...</code> or assign the result to a variant and check that for error."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476820892, "post_id": 40116614, "comment_id": 67505577, "body": "@DavidZemens - Oops - that reminded me - I changed <code>InputData1</code> to be a <code>Variant</code> while testing the change to use <code>Application.VLookup</code> but forgot to update the line in the answer - have now done so."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1476820812, "last_edit_date": 1476820812, "creation_date": 1476819278, "answer_id": 40116614, "question_id": 40115922, "link": "https://stackoverflow.com/questions/40115922/inputdata1-variable-is-not-taking-the-vlookup-function/40116614#40116614", "title": "InputData1 variable is not taking the vlookup function", "body": "<p>Your problem appears to arise because you are obtaining a string value from the InputBox, but then comparing that to numeric values in cells H1:H12.</p>\n\n<p>I recommend the following change to your code:</p>\n\n<pre><code>Sub Info()\n\n    Dim the_sheet As Worksheet\n    Dim table_list_object As ListObject\n    Dim table_object_row As ListRow\n    Dim inputData\n    Dim inputData1 \n    Dim rngLook As Range\n\n    Set rngLook = Sheets(\"AutoZeroDatabase\").Range(\"H1:I12\")\n\n    Set the_sheet = Sheets(\"Info\")\n    Set table_list_object = the_sheet.ListObjects(\"Table1\")\n    Set table_object_row = table_list_object.ListRows.Add\n\n    Do\n        inputData = Application.InputBox(Prompt:=\"Enter a number from 1 to 12 to select a month i.e. 1 for January\", _\n                                         Title:=\"Input Box Text\", _\n                                         Type:=1 + 4) 'Type 1 is number, 4 is boolean\n        If TypeName(inputData) = \"Boolean\" Then\n            If Not inputData Then\n                inputData1 = \"User refused to supply the month!!\"\n                Exit Do\n            End If\n        ElseIf inputData &lt;&gt; Int(inputData) Then\n            MsgBox \"Fractions of a month are not allowed!\"\n        ElseIf inputData &lt; 1 Or inputData &gt; 12 Then\n            MsgBox \"Months are numbered 1 to 12 - what am I meant to do with \" &amp; inputData &amp; \"?!?!?\"\n        Else\n            inputData1 = Application.VLookup(inputData, rngLook, 2, False)\n            If IsError(inputData1) Then\n                 MsgBox \"Something went very, very wrong - I couldn't find that value in the set of valid months!\"\n            End If\n            Exit Do\n        End If\n    Loop\n\n    table_object_row.Range(1, 1).Value = inputData1\n\n    MsgBox (\"Thank you for taking the time to update me :)\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6672827, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/726097cd50f8e9223a2263f50ac27f61?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6672827/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476820812, "creation_date": 1476816781, "last_edit_date": 1531164843, "question_id": 40115922, "link": "https://stackoverflow.com/questions/40115922/inputdata1-variable-is-not-taking-the-vlookup-function", "title": "InputData1 variable is not taking the vlookup function", "body": "<p>I've been trying to assign the result of a vlookup to a variable but the vlookup value is actually a user input but is not working.</p>\n\n<p>I do not know what else I can change on my vba code :(</p>\n\n<p>It is showing me a debug error on the vlookup formula</p>\n\n<pre><code>        Sub Info()\n\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\nDim inputData, inputData1 As String\nDim wsFunc As WorksheetFunction: Set wsFunc = Application.WorksheetFunction\nDim rngLook As Range\n\nSet rngLook = Sheets(\"AutoZeroDatabase\").Range(\"H1:I12\")\n\nSet the_sheet = Sheets(\"Info\")\nSet table_list_object = the_sheet.ListObjects(\"Table1\")\nSet table_object_row = table_list_object.ListRows.Add\n\ninputData = InputBox(\"Enter a number from 1 to 12 to select a month i.e. 1 for January\", \"Input Box Text\")\n\ninputData1 = wsFunc.VLookup(CInt(inputData), rngLook, 2, False)\n\ntable_object_row.Range(1, 1).Value = inputData1\n\nMsgBox (\"Thank you for taking the time to update me :)\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476817029, "post_id": 40115915, "comment_id": 67503415, "body": "Don&#39;t use IsNull to check whether a cell has content - something like <code>Len(ActiveSheet.Range(&quot;B&quot; &amp; num_line).Value)&gt;0</code> will work"}, {"owner": {"reputation": 93, "user_id": 6476123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9bc780f0e2576f92532294a2c2f84450?s=128&d=identicon&r=PG&f=1", "display_name": "AAzeeze", "link": "https://stackoverflow.com/users/6476123/aazeeze"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476817433, "post_id": 40115915, "comment_id": 67503633, "body": "Thank i will update my code in my post"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1476817566, "creation_date": 1476817566, "answer_id": 40116129, "question_id": 40115915, "link": "https://stackoverflow.com/questions/40115915/how-to-transform-specific-hierarchy-tree-to-standard-hierarchy-tree/40116129#40116129", "title": "How to transform specific hierarchy tree to standard hierarchy tree", "body": "<p>1) The empty value is because <code>IsNull</code> will return <code>False</code> for any cell, as an empty cell will be interpreted as <code>\"\"</code> or 0. Use <code>IsEmpty</code> or <code>cell.Value &lt;&gt; \"\"</code>.\nOf course you shouldn't use that check with <code>Level3</code> because you want that to be empty sometimes.</p>\n\n<p>2) To get rid of the trailing <code>/</code> you could simply check if <code>Level3</code> is empty</p>\n\n<pre><code>If Level3 &lt;&gt; \"\" Then\n    ActiveSheet.Range(\"F\" &amp; num_line) = Level1 &amp; \"/\" &amp; Level2 &amp; \"/\" &amp; Level3\nElse\n    ActiveSheet.Range(\"F\" &amp; num_line) = Level1 &amp; \"/\" &amp; Level2\nEnd If\n</code></pre>\n\n<p>3) There are many ways to find the last row. The easiest is </p>\n\n<pre><code>yoursheet.Cells(yoursheet.Rows.Count, \"B\").End(xlUp).Row\n</code></pre>\n\n<p>In your case you would have to check rows B and C and take the larger one.</p>\n"}, {"tags": [], "owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "is_accepted": false, "score": 0, "last_activity_date": 1574576255, "creation_date": 1574576255, "answer_id": 59015166, "question_id": 40115915, "link": "https://stackoverflow.com/questions/40115915/how-to-transform-specific-hierarchy-tree-to-standard-hierarchy-tree/59015166#59015166", "title": "How to transform specific hierarchy tree to standard hierarchy tree", "body": "<p><em>Solution by OP.</em></p>\n\n<pre><code>Sub GenerateTree()\n   Dim Level1 As String\n   Dim Level2 As String\n   Dim Level3 As String\n\n   Dim num_line_max As Integer\n   Dim num_line As Integer\n   Dim Result() As String\n   ReDim Result(i)\n\n   'Init\n   Level1 = ActiveSheet.Range(\"A2\").Value\n   max_line_B = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"B\").End(xlUp).Row\n   max_line_C = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"C\").End(xlUp).Row\n   If max_line_B &gt; max_line_C Then\n      num_line_max = max_line_B\n   Else\n      num_line_max = max_line_C\n   End If\n\n   'For each value\n   For num_line = 2 To num_line_max\n        If Len(ActiveSheet.Range(\"B\" &amp; num_line).Value) &gt; 0 Then 'If cell Bx contains something\n            Level2 = ActiveSheet.Range(\"B\" &amp; num_line).Value 'Update Level2\n        End If\n            Level3 = ActiveSheet.Range(\"C\" &amp; num_line).Value\n\n        If Level3 &lt;&gt; \"\" Then\n            ActiveSheet.Range(\"F\" &amp; num_line) = Level1 &amp; \"/\" &amp; Level2 &amp; \"/\" &amp; Level3\n        Else\n            ActiveSheet.Range(\"F\" &amp; num_line) = Level1 &amp; \"/\" &amp; Level2\n        End If\n    Next num_line\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6476123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9bc780f0e2576f92532294a2c2f84450?s=128&d=identicon&r=PG&f=1", "display_name": "AAzeeze", "link": "https://stackoverflow.com/users/6476123/aazeeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 40116129, "answer_count": 2, "score": 0, "last_activity_date": 1574576302, "creation_date": 1476816751, "last_edit_date": 1574576302, "question_id": 40115915, "link": "https://stackoverflow.com/questions/40115915/how-to-transform-specific-hierarchy-tree-to-standard-hierarchy-tree", "title": "How to transform specific hierarchy tree to standard hierarchy tree", "body": "<p>My users design folder tree in this format:<br>\n<a href=\"https://i.stack.imgur.com/xCvfX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xCvfX.png\" alt=\"Tree \"></a></p>\n\n<p>I would like transform this folder hierarchy to \"Windows\" format, like this:</p>\n\n<ul>\n<li>Root\\Folder1\\Folder11 </li>\n<li>Root\\Folder1\\Folder12 </li>\n<li>Root\\Folder1\\Folder13\n....</li>\n</ul>\n\n<p>So I did in VBA:</p>\n\n<pre><code>Sub GenerateTree()\n   Dim Level1 As String\n   Dim Level2 As String\n   Dim Level3 As String\n\n   Dim i As Integer\n   Dim num_line As Integer\n   Dim Result() As String\n   ReDim Result(i)\n\n   'Init\n   Level1 = ActiveSheet.Range(\"A2\").Value    \n\n   'For each value    For num_line = 2 To 11\n        If Len(ActiveSheet.Range(\"B\" &amp; num_line).Value) &gt; 0 Then 'If cell Bx contains something\n            Level2 = ActiveSheet.Range(\"B\" &amp; num_line).Value 'Update Level2\n        End If\n            Level3 = ActiveSheet.Range(\"C\" &amp; num_line).Value\n\n        'Result(num_line - 2) = Level1 &amp; \"/\" &amp; Level2 &amp; \"/\" &amp; Level3\n        ActiveSheet.Range(\"F\" &amp; num_line) = Level1 &amp; \"/\" &amp; Level2 &amp; \"/\" &amp; Level3\n    Next num_line\n</code></pre>\n\n<p>But my result, isn't good. \n<a href=\"https://i.stack.imgur.com/UjSU4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UjSU4.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have several problem, in my result:</p>\n\n<ul>\n<li>For <code>Root/Folder2/</code>, i have / at this end. I would like to have <code>Root/Folder2</code></li>\n<li>I think, I need to add a function to know the max of <code>num_line</code></li>\n</ul>\n"}, {"tags": ["vba", "excel", "split"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476815257, "post_id": 40115400, "comment_id": 67502349, "body": "<code>Arr_text</code> will be a zero-based array - <code>UBound(Arr_text)</code> will give you the upper bound of that array (zero if one item, one if two items, etc)"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1476815404, "creation_date": 1476815404, "answer_id": 40115518, "question_id": 40115400, "link": "https://stackoverflow.com/questions/40115400/vba-split-and-iserror-function/40115518#40115518", "title": "VBA - Split and IsError Function", "body": "<p>Arr_text will be a zero-based array - UBound(Arr_text) will give you the upper bound of that array (zero if one item, one if two items, etc)</p>\n\n<pre><code>Public Function idcode_2(text As String) As String\n\n    Dim Arr_text As Variant, rz2\n\n    Arr_text = Split(text, \" \", 3)\n\n    If UBound(Arr_text ) &gt; 0 Then\n        rz2 = Arr_text(1)\n    Else\n        rz2 = \"x\"\n    End If\n\n    idcode_2 = rz2\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477749936, "post_id": 40117075, "comment_id": 67895603, "body": "@KevinRuiz, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1476820955, "creation_date": 1476820955, "answer_id": 40117075, "question_id": 40115400, "link": "https://stackoverflow.com/questions/40115400/vba-split-and-iserror-function/40117075#40117075", "title": "VBA - Split and IsError Function", "body": "<pre><code>Public Function idcode_2(text As String) As String\n    If Instr(text, \" \") &gt; 0 Then\n        idcode = Split(text)(1)\n    Else\n        idcode = \"x\"\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7038218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LUi00pqvy9I/AAAAAAAAAAI/AAAAAAAAACs/T9xy5RkYPuA/photo.jpg?sz=128", "display_name": "Kevin Ruiz", "link": "https://stackoverflow.com/users/7038218/kevin-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476833450, "creation_date": 1476815009, "last_edit_date": 1531164843, "question_id": 40115400, "link": "https://stackoverflow.com/questions/40115400/vba-split-and-iserror-function", "title": "VBA - Split and IsError Function", "body": "<p>I'm struggling with VBA code. I'm working on a ID code generator program. One of the processes involves Split Company Names by words, and taking the first two words. Split has proved to be useful in this tasks, however, when in dealing with Company Names shorter than 2 words I've got a #VALUE! Error.</p>\n\n<p>One way I tried to fix it, was using the ISERROR function, so if I get any error it replaces it with a character, say \"X\".</p>\n\n<p>In summary, what I'm trying is to capture only the second Word of the Name, if there is no second Word, just display \"X\".</p>\n\n<pre><code>Public Function idcode_2(text As String) As String\nDim Arr_text As Variant\nDim rz_x, rz2, code As String\nDim i As Integer\nDim c\nArr_text = Split(text, \" \", 3)\nrz2 = Arr_text(1)\nIf IsError(rz2) = True Then\n    rz2 = \"X\"\n   Else\n    rz2 = rz2 &amp; \"\"\nEnd If\n    idcode_2 = rz2\nEnd Function\n</code></pre>\n\n<p>I'm using VBA in Excel - Microsoft Office Professional Plus 2013.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1476815040, "post_id": 40115392, "comment_id": 67502223, "body": "Yes that&#39;s possible in VBA"}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1476815487, "post_id": 40115392, "comment_id": 67502490, "body": "can you indicate me some functions/properties helpful to achieve this result? of course it would take only a couple of names, just to point me in the right documentation"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1476815670, "post_id": 40115392, "comment_id": 67502612, "body": "It would help to explain a little more exactly what you want to do, along with a small set of sample data"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1476815720, "post_id": 40115392, "comment_id": 67502649, "body": "It sounds like you&#39;re looking for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find</a> method"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1476816026, "post_id": 40115392, "comment_id": 67502819, "body": "I recommend checking <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. Technically, Tim answered your question.  To know more, we need to know what you&#39;re attempting to do. In VBA especially, there are many ways to do the same thing - but start with Find, perhaps Match, or Search.  Also, check out how to use Variables and <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid <code>.Select</code></a> for working directly with the data."}, {"owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "edited": false, "score": 0, "creation_date": 1476816072, "post_id": 40115392, "comment_id": 67502846, "body": "I should be able to make a search vertically, into a column that can be situated in different cells because once again to the document should be included new columns &quot;in the middle&quot;. Given this task comes my question, which was specifically to see if it was possible to identify a column from the content of his first cell, for example, which in my case will be populated with a specific string."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476822001, "post_id": 40115392, "comment_id": 67506222, "body": "Index, Match functions (Application), Offset method of range object, Application.GoTo or Select (if you want a literal &quot;move&quot;), etc."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1477749883, "post_id": 40117305, "comment_id": 67895581, "body": "@Jacopo Mansani, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1476821781, "creation_date": 1476821781, "answer_id": 40117305, "question_id": 40115392, "link": "https://stackoverflow.com/questions/40115392/in-excel-vba-is-it-possible-to-move-in-a-column-or-row-or-cell-based-solely-o/40117305#40117305", "title": "In Excel-VBA Is it possible to move in a column (or row, or cell) based solely on the content of another cell?", "body": "<p>to <em>\"... move, for example, in the fourth row of a column in which the first cell contains the word \"cat\"\"</em> you may use:</p>\n\n<pre><code>Rows(1).Find(What:=\"cat\",LookAt:=xlWhole, LookIn:=xlValues).Offset(3).Select\n</code></pre>\n\n<p>What above would throw an error if no first row cell value is \"cat\"</p>\n\n<p>To handle such a situation:</p>\n\n<pre><code>Dim found As Range\nSet found = Rows(1).Find(What:=\"cat\",LookAt:=xlWhole, LookIn:=xlValues)\nIf Not found Is Nothing Then found.Offset(3).Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7037112, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209274146044252/picture?type=large", "display_name": "Jacopo Mansani", "link": "https://stackoverflow.com/users/7037112/jacopo-mansani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476821781, "creation_date": 1476814984, "question_id": 40115392, "link": "https://stackoverflow.com/questions/40115392/in-excel-vba-is-it-possible-to-move-in-a-column-or-row-or-cell-based-solely-o", "title": "In Excel-VBA Is it possible to move in a column (or row, or cell) based solely on the content of another cell?", "body": "<p>I wanted to know if t's possible not to use only the spatial references (for example, \"Column A\", \"cell D3\") but instead be able to realize a macro to move, for example, in the fourth row of a column in which the first cell contains the word \"cat\" for example. I do not know if I was clear in my question, in case I wasn't just ask for further clarification.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476831160, "post_id": 40115327, "comment_id": 67509982, "body": "It may be related to TimeZones. See: <a href=\"https://forums.slipstick.com/threads/94145-problem-with-freebusy-before-1pm-only/\" rel=\"nofollow noreferrer\">forums.slipstick.com/threads/&hellip;</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476833209, "post_id": 40115327, "comment_id": 67510475, "body": "@RyanWildry Thanks!  While timezones don&#39;t seem to have been the problem, while trying the solutions presented, I found that the time portion of the date is being ignored.  It starts at the beginning of the day regardless of the time portion that you put in there."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476833362, "post_id": 40115327, "comment_id": 67510515, "body": "That would make sense then given what you were seeing. Should be an easy fix from there then. Re-reading the documentation just now, it&#39;s a Date value, but not including time."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476833422, "post_id": 40115327, "comment_id": 67510527, "body": "@RyanWildry where&#39;s the documentation you&#39;re looking at?  <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.recipient.freebusy.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> shows it as DateTime."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1476833469, "post_id": 40115327, "comment_id": 67510541, "body": "@RyanWildry Ahh, nevermind, I was looking at the wrong documentation.  I found the correct Outlook one that shows what you&#39;re saying."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 2, "last_activity_date": 1476895558, "last_edit_date": 1476895558, "creation_date": 1476833612, "answer_id": 40119728, "question_id": 40115327, "link": "https://stackoverflow.com/questions/40115327/using-recipient-freebusy-in-outlook/40119728#40119728", "title": "Using Recipient.FreeBusy in Outlook", "body": "<p>The problem seems to be that the <code>Start</code> parameter is a date parameter and not a DateTime parameter, so it will ignore the time, starting at the beginning of the day.</p>\n\n<p>You just need to count the correct number of output bits to get the correct hour.</p>\n\n<p>Instead of:</p>\n\n<pre><code> debug.print myRoom.FreeBusy(#10/18/2016 11:00:00 AM#, 30, false)\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code> myVal = myRoom.FreeBusy(#10/18/2016#, 30, false)\n debug.print Mid(myVal, 22, len(myVal) - 22)\n</code></pre>\n"}], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 1, "accepted_answer_id": 40119728, "answer_count": 1, "score": 2, "last_activity_date": 1593415419, "creation_date": 1476814751, "last_edit_date": 1593415419, "question_id": 40115327, "link": "https://stackoverflow.com/questions/40115327/using-recipient-freebusy-in-outlook", "title": "Using Recipient.FreeBusy in Outlook", "body": "<p>I am having trouble using the FreeBusy method of the Recipient class.</p>\n\n<p>The documentation states that the function parameters are:</p>\n\n<p><code>Start</code> which represents the start time, <code>MinPerChar</code> which represents the minutes per character returned, and <code>CompleteFormat</code> which represents whether you just want to know if the room is busy or additional details about the business.</p>\n\n<p>However, when putting the following code, I get the same results:</p>\n\n<pre><code> debug.print myRoom.FreeBusy(#10/18/2016 11:00:00 AM#, 30, false)\n</code></pre>\n\n<p>which gives:</p>\n\n<pre><code> 0000000000000000010000001......\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code> debug.print myRoom.FreeBusy(#10/18/2016 10:00:00 AM#, 30, false)\n</code></pre>\n\n<p>gives the same thing:</p>\n\n<pre><code> 0000000000000000010000001......\n</code></pre>\n\n<p>What am I doing wrong?  I would have thought that the second call would return the first one moved to the right by 2 bits with 2 additional values, but this does not seem to be the case. </p>\n\n<p>I am running Outlook 2013 on an Exchange Server.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814337, "post_id": 40115169, "comment_id": 67501848, "body": "<i>Does anyone know what I am missing in the macro? I won&#39;t post the entire script because it is very long...</i>  <b>&lt;&lt;</b> These two statements seem to be at odds with one another. Nobody here can read your mind..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1476814381, "post_id": 40115169, "comment_id": 67501870, "body": "Instead of <code>MsgBox</code> you probably want to use <code>InputBox</code> and assign the return value to <code>Range(&quot;M58&quot;)</code>, but that&#39;s just a guess."}, {"owner": {"reputation": 1, "user_id": 7038188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b294e45d20b07eb60c8c3aaeb29f6338?s=128&d=identicon&r=PG&f=1", "display_name": "Sherri", "link": "https://stackoverflow.com/users/7038188/sherri"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814708, "post_id": 40115169, "comment_id": 67502035, "body": "It is the exact same script but different cells. So L55, L56, L57 etc. I didn&#39;t think it would be necessary to see 50 of the same thing."}, {"owner": {"reputation": 1, "user_id": 7038188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b294e45d20b07eb60c8c3aaeb29f6338?s=128&d=identicon&r=PG&f=1", "display_name": "Sherri", "link": "https://stackoverflow.com/users/7038188/sherri"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814744, "post_id": 40115169, "comment_id": 67502049, "body": "Thanks, I will give it a try."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814757, "post_id": 40115169, "comment_id": 67502052, "body": "Are you familiar with <code>For...Next</code> loop statement? <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251601.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251601.aspx</a>"}, {"owner": {"reputation": 1, "user_id": 7038188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b294e45d20b07eb60c8c3aaeb29f6338?s=128&d=identicon&r=PG&f=1", "display_name": "Sherri", "link": "https://stackoverflow.com/users/7038188/sherri"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814913, "post_id": 40115169, "comment_id": 67502150, "body": "No, I am very new to vba (self taught) and thankful for all of the forums because I would be lost with most of this and the help of everyone!"}, {"owner": {"reputation": 1, "user_id": 7038188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b294e45d20b07eb60c8c3aaeb29f6338?s=128&d=identicon&r=PG&f=1", "display_name": "Sherri", "link": "https://stackoverflow.com/users/7038188/sherri"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814927, "post_id": 40115169, "comment_id": 67502161, "body": "I will look into the loop statement. Thanks!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1476814942, "post_id": 40115169, "comment_id": 67502170, "body": "If you&#39;re doing basically the same operation 50 times, it&#39;s probably better suited to use a loop structure with some variables."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1476815323, "creation_date": 1476815323, "answer_id": 40115490, "question_id": 40115169, "link": "https://stackoverflow.com/questions/40115169/creating-error-macro/40115490#40115490", "title": "Creating error macro", "body": "<p>Very simply, something like:</p>\n\n<pre><code>If Range(\"L58\") = \"Sigma Network\" And Range(\"M58\") = \"\" Then \n    Range(\"M58\").Value = InputBox(\"Please enter cable length \", \"Input value!\", 0)\nEnd If\n</code></pre>\n\n<p>You would of course need additional logic to prevent the user from entering a 0-value or empty string, etc., </p>\n\n<p>If you're doing this on for example, 50 different pairs of cells, (say L58 to L107 and M58 to M107 for example) this is a basic loop structure that you could use:</p>\n\n<pre><code>Dim cl as Range\nFor Each cl in Range(\"L58:L107\")\n    If cl.Value = \"Sigma Network\" and cl.Offset(0,1).Value = \"\" Then\n        cl.Offset(0,1).Value = GetValue(\"Please enter cable length \", \"Input value!\", 0)\n    End If\nNext\n</code></pre>\n\n<p>The loop can be further refined (e.g., if \"Sigma Network\" isn't the only thing you're checking for, or if you need different message text for the input box based on some other conditions, etc.</p>\n\n<p>This will require the custom <code>GetValue</code> function which invokes the <code>InputBox</code> prompt, and configured to prevent 0-value input from the user. Additional logic may be required to prevent other types of data entry.</p>\n\n<pre><code>Function GetValue(msg as String, _\n                  Optional title as String = \"\", _\n                  Optional default as Double = 0)\n'Function that calls the InputBox method\n    Dim ret\n    Do Until ret &lt;&gt; 0\n        ret = InputBox(msg, title, default)\n    Loop\n    GetValue = ret\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7038188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b294e45d20b07eb60c8c3aaeb29f6338?s=128&d=identicon&r=PG&f=1", "display_name": "Sherri", "link": "https://stackoverflow.com/users/7038188/sherri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476815323, "creation_date": 1476814189, "last_edit_date": 1476814348, "question_id": 40115169, "link": "https://stackoverflow.com/questions/40115169/creating-error-macro", "title": "Creating error macro", "body": "<p>I currently have a macro that will deliver a pop up in the event that a field is left blank. The problem that I have is, once you acknowledge the error, it goes away and lets you proceed without filling in the field. Does anyone know what I am missing in the macro? I won't post the entire script because it is very long but it currently looks like this...</p>\n\n<pre><code>If Range(\"L58\") = \"Sigma Network\" And Range(\"M58\") = \"\" Then MsgBox \"Please enter cable length \"\n</code></pre>\n\n<p>Can I create one script that will work for all of the others or does each need to have its own?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6928529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefe826cda4ec04563e47c4da5de86d4?s=128&d=identicon&r=PG&f=1", "display_name": "Mayfarm", "link": "https://stackoverflow.com/users/6928529/mayfarm"}, "edited": false, "score": 0, "creation_date": 1476822767, "post_id": 40115213, "comment_id": 67506629, "body": "Thanks ! That solved the issue. But now I get the error on currentdb.Execute &quot;Too few parameters. Expected 1&quot;"}], "tags": [], "owner": {"reputation": 388, "user_id": 6832277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec015d89bc7641563d937f882a8b15?s=128&d=identicon&r=PG&f=1", "display_name": "M. Rezaeyan", "link": "https://stackoverflow.com/users/6832277/m-rezaeyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1476815289, "last_edit_date": 1476815289, "creation_date": 1476814383, "answer_id": 40115213, "question_id": 40115123, "link": "https://stackoverflow.com/questions/40115123/vba-insert-query-query-input-must-contain-at-least-one-table-or-query/40115213#40115213", "title": "VBA Insert Query: &quot;Query input must contain at least one table or query&quot;&quot;", "body": "<p>After and before each [\"] put a blank space : </p>\n\n<pre><code>AppendPOLines = \" INSERT INTO tblPOlines( PurchaseOrderID, PurchaseOrderLineID, [Material#], FirstDeliveryDate, Quantity, CreatedBy ) \" _\n    &amp; \" SELECT tblPOLinesTemp.PurchaseOrderID, tblPOLinesTemp.PurchaseOrderLineID, tblPOLinesTemp.[Material#], tblPOLinesTemp.FirstDeliveryDate, tblPOLinesTemp.Quantity, [TempVars]![VarUserID] AS CreatedBy \" _\n    &amp; \" FROM tblPOLinesTemp LEFT JOIN tblPOlines ON (tblPOLinesTemp.PurchaseOrderLineID = tblPOlines.PurchaseOrderLineID) AND (tblPOLinesTemp.[PurchaseOrderID] = tblPOlines.[PurchaseOrderID]) \" _\n    &amp; \" WHERE (((tblPOlines.PurchaseOrderLineID) Is Null) AND ((tblPOlines.PurchaseOrderID) Is Null)); \"\n</code></pre>\n\n<p>your query is executed like following:</p>\n\n<p>INSERT INTO tblPOlines( PurchaseOrderID, PurchaseOrderLineID, [Material#], FirstDeliveryDate, Quantity, CreatedBy <strong>)SELECT</strong> tblPOLinesTemp.PurchaseOrderID, tblPOLinesTemp.PurchaseOrderLineID, tblPOLinesTemp.[Material#], tblPOLinesTemp.FirstDeliveryDate, tblPOLinesTemp.Quantity, [TempVars]![VarUserID] AS <strong>CreatedByFROM</strong> tblPOLinesTemp LEFT JOIN tblPOlines ON (tblPOLinesTemp.PurchaseOrderLineID = tblPOlines.PurchaseOrderLineID) AND (tblPOLinesTemp.[PurchaseOrderID] = tblPOlines.[PurchaseOrderID]<strong>)WHERE</strong> (((tblPOlines.PurchaseOrderLineID) Is Null) AND ((tblPOlines.PurchaseOrderID) Is Null));</p>\n\n<p>so CreatedByFrom is wrong and you get this error:\n\"query input must contain at least one table or query\"</p>\n"}], "owner": {"reputation": 3, "user_id": 6928529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefe826cda4ec04563e47c4da5de86d4?s=128&d=identicon&r=PG&f=1", "display_name": "Mayfarm", "link": "https://stackoverflow.com/users/6928529/mayfarm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476957472, "creation_date": 1476813999, "last_edit_date": 1476957472, "question_id": 40115123, "link": "https://stackoverflow.com/questions/40115123/vba-insert-query-query-input-must-contain-at-least-one-table-or-query", "title": "VBA Insert Query: &quot;Query input must contain at least one table or query&quot;&quot;", "body": "<p>I am importing data from an Excel spreadsheet into <code>tblPOLinesTemp</code> table, and then I have to apppend those to <code>tblPOLines</code> table. I am trying to execute an <code>insert into</code> SQL statement from VBA, but keep getting \"Query input must contain at least one table or query\" as error, and I cannot seem to figure out what is wrong as the SQL statement works when running it in Access! It is driving me crazy! Can you help?</p>\n\n<p>My code (I have Dim'ed AppendPOlines as String): </p>\n\n<pre><code>AppendPOLines = \"INSERT INTO tblPOlines ( PurchaseOrderID, PurchaseOrderLineID, [Material#], FirstDeliveryDate, Quantity, CreatedBy )\" _\n    &amp; \"SELECT tblPOLinesTemp.PurchaseOrderID, tblPOLinesTemp.PurchaseOrderLineID, tblPOLinesTemp.[Material#], tblPOLinesTemp.FirstDeliveryDate, tblPOLinesTemp.Quantity, [TempVars]![VarUserID] AS CreatedBy\" _\n    &amp; \"FROM tblPOLinesTemp LEFT JOIN tblPOlines ON (tblPOLinesTemp.PurchaseOrderLineID = tblPOlines.PurchaseOrderLineID) AND (tblPOLinesTemp.[PurchaseOrderID] = tblPOlines.[PurchaseOrderID])\" _\n    &amp; \"WHERE (((tblPOlines.PurchaseOrderLineID) Is Null) AND ((tblPOlines.PurchaseOrderID) Is Null));\"\n\n    CurrentDb.Execute AppendPOLines, dbFailOnError\n</code></pre>\n\n<p>Note that the Left Joins is to ensure that the Query does not insert rows with similar Purchase Order and Purchase Order Line ID - to avoid duplicate rows. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476815807, "post_id": 40115115, "comment_id": 67502705, "body": "Why not have your code unprotect the sheet and then re-protect the sheet when its done?"}, {"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1476818239, "post_id": 40115115, "comment_id": 67504046, "body": "That is certainly possible, but should be unnecessary. It works fine until I add that row."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476822552, "post_id": 40115115, "comment_id": 67506533, "body": "Your code doesn&#39;t insert any row"}, {"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "edited": false, "score": 0, "creation_date": 1476825006, "post_id": 40115115, "comment_id": 67507828, "body": "It doesn&#39;t. This code works before I manually insert a row and doesn&#39;t work after."}], "owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476813974, "creation_date": 1476813974, "question_id": 40115115, "link": "https://stackoverflow.com/questions/40115115/adding-a-row-causes-vba-validation-assignment-to-error-out", "title": "Adding a Row Causes VBA Validation Assignment to Error Out", "body": "<p>When I insert one row into a protected workbook, my VBA code that updates the validation input messages of four cells doesn't work anymore... unless I unprotect the worksheet. </p>\n\n<p>The worksheet is protected with the <code>userinterfaceonly</code> property set to <code>true</code>:\n<code>ThisWorkbook.Sheets(1).Protect password:=\"fa-202a\", userinterfaceonly:=True</code></p>\n\n<p>Let me reiterate that my validation input message code works fine <strong>until I insert a row</strong>. </p>\n\n<p>The first call to <code>AddNumberOfAvailableBatchesValidation</code> works fine.\nThe code throws an application-defined error on the second call to <code>AddNumberOfAvailableBatchesValidation</code>. The specific line in that sub that is failing is:</p>\n\n<p><code>.InputTitle = \"Maximum of 100 Pouch Batches\"</code></p>\n\n<p>As you can see it appears that it is having a problem modifying the existing data validation of the range <code>NamedRanges.NumBatchesAdditional1</code>. </p>\n\n<p>Each cell of these four is a single, unmerged cell.</p>\n\n<p>Here's the full code. </p>\n\n<pre><code>Private Sub UpdateInputMessages()\nDim numAvail As Integer\n\nnumAvail = 100 - NamedRanges.NumBatchesPrimary.Value - NamedRanges.NumBatchesAdditional1.Value - _\n           NamedRanges.NumBatchesAdditional2.Value - NamedRanges.NumBatchesAdditional3.Value\n\nAddNumberOfAvailableBatchesValidation NamedRanges.NumBatchesPrimary, numAvail\nAddNumberOfAvailableBatchesValidation NamedRanges.NumBatchesAdditional1, numAvail\nAddNumberOfAvailableBatchesValidation NamedRanges.NumBatchesAdditional2, numAvail\nAddNumberOfAvailableBatchesValidation NamedRanges.NumBatchesAdditional3, numAvail\n\nEnd Sub\n\nPrivate Sub AddNumberOfAvailableBatchesValidation(target As range, numberAvailable As Integer)\n\nWith target.Validation\n    .InputTitle = \"Maximum of 100 Pouch Batches\"\n    .InputMessage = \"There are \" &amp; numberAvailable &amp; \" pouch batches available.\"\n    .ShowInput = DropdownChangeIsMultipleSelectionEligible\nEnd With\n'This is to refresh the input messages\nWith target\n    .offset(0, 1).Select\n    .Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "checkbox", "ms-word", "word-2010"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 6096423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/71a2f5d08e362ba8a8779faed10b42a2?s=128&d=identicon&r=PG&f=1", "display_name": "user6096423", "link": "https://stackoverflow.com/users/6096423/user6096423"}, "is_accepted": false, "score": 0, "last_activity_date": 1476821196, "creation_date": 1476821196, "answer_id": 40117151, "question_id": 40115100, "link": "https://stackoverflow.com/questions/40115100/set-activex-checkbox-properties-with-vba-word-2010/40117151#40117151", "title": "set ActiveX checkbox properties with VBA word 2010", "body": "<p>For anyone with the same issue</p>\n\n<pre><code>'to place it in the table, assuming only 1 table, and in this example the checkbox is placed in the second Row, first Column\nActiveDocument.Tables(1).Cell(2, 1).Select\n\nSet myOB = Selection.InlineShapes.AddOLEControl(ClassType:=\"Forms.CheckBox.1\")\nWith myOB.OLEFormat\n.Activate\nSet myObj = .Object\nEnd With\nWith myObj\n'now you can name the field anything you want\n .Name = \"CB1\"\n .Value = False\n 'delete the caption, or have it say what you want\n .Caption = \"\"\n .Height = 22\n .Width = 22\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6096423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/71a2f5d08e362ba8a8779faed10b42a2?s=128&d=identicon&r=PG&f=1", "display_name": "user6096423", "link": "https://stackoverflow.com/users/6096423/user6096423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556709209, "creation_date": 1476813896, "question_id": 40115100, "link": "https://stackoverflow.com/questions/40115100/set-activex-checkbox-properties-with-vba-word-2010", "title": "set ActiveX checkbox properties with VBA word 2010", "body": "<p>I have searched high and low for this, but no luck.</p>\n\n<p>To create a checkbox:</p>\n\n<pre><code>Selection.InlineShapes.AddOLEControl ClassType:=\"Forms.CheckBox.1\"\n</code></pre>\n\n<p>However, there are several properties associated with a checkbox, and I wanted to find out how to set them as well when I am creating the checkbox.</p>\n\n<p>For example, I tried this:</p>\n\n<pre><code>Selection.InlineShapes.AddOLEControl ClassType:=\"Forms.CheckBox.1\", Caption:=\"\"\n</code></pre>\n\n<p>But the code throws a \"Named Argument Not Found\" error while highlighting Caption:=\"\"</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1476812582, "post_id": 40114622, "comment_id": 67500889, "body": "&quot;I would like someone to write code for me&quot; is called &quot;Homework Help&quot;.  <i>3.  Questions asking for &quot;homework help&quot; must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it.</i> -<a href=\"http://stackoverflow.com/help/on-topic\">Help Center: What&#39;s On Topic Here?</a>  You haven&#39;t written any code yet..."}, {"owner": {"reputation": 2896, "user_id": 3361028, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b53a63319b061edb80dc910c10cfbfd1?s=128&d=identicon&r=PG&f=1", "display_name": "hY8vVpf3tyR57Xib", "link": "https://stackoverflow.com/users/3361028/hy8vvpf3tyr57xib"}, "edited": false, "score": 0, "creation_date": 1476812759, "post_id": 40114622, "comment_id": 67500996, "body": "What error did you receive when running your macro?"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476812990, "post_id": 40114622, "comment_id": 67501135, "body": "Thanks for the quick reply. When I recorded the macro with the If statement  1, I got a code in VBE. When I inserted this code in my macro, it throws up &quot;Run-time error &#39;1004&#39;:Application-defined or object defined error&quot;. I am pasting the VBE code in original post. If Statement 2 gives :Name? error.."}, {"owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "edited": false, "score": 1, "creation_date": 1476820748, "post_id": 40114622, "comment_id": 67505495, "body": "Where is your &quot;ActiveCell&quot; ? If you have your active cell in the upper left hand corner of the sheet, your references of &#39;negative&#39; columns and rows will take the reference off the sheet, giving you the error."}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1476823266, "post_id": 40117593, "comment_id": 67506908, "body": "I&#39;m thinking you&#39;re going to want the first row deleted because D2 = D3 still. That&#39;s easy enough to do, it just depends on where you have the <code>B.EntireRow.Delete</code> line. Either at the start, or at the end. Currently it&#39;s at the end, unless you want me to put it at the beginning :)"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476833071, "post_id": 40117593, "comment_id": 67510439, "body": "Tyeler, Thank you so much for your help. I really appreciate it. I am new at  VBA and still learning it. The output seems to be promising. Yes, D 2 and D3 are still same, the comments in J2 and J3 should add and one of the rows should be deleted. This should happen for entire range i.e. comments for similar ids should join and for non similar, it should remain the same. This should continue till end of the range. a"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476833555, "post_id": 40117593, "comment_id": 67510569, "body": "I know, I am asking for too much, but can we also include or add this to If Statement 2: if(AND(I2=&quot;&quot;,I3=&quot;Y&quot;),&quot;Y&quot; else if(AND(I2=&quot;Y&quot;,I3=&quot;&quot;),&quot;Y&quot; else if(AND(I2=&quot;N&quot;,I3=&quot;&quot;),&quot;N&quot; else if(AND(I2=&quot;N&quot;,I3=&quot;&quot;),&quot;N&quot;,&quot;&quot;)endif)endif).."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476833679, "post_id": 40117593, "comment_id": 67510598, "body": "No problem, gimme just a sec and I&#39;ll fix it up for you. :)"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476833847, "post_id": 40117593, "comment_id": 67510640, "body": "Actually, from what you said in your first comment, the first row is going to have this output in J2: <code>Batch &#39;ABC&#39; has no earnings&#47;hoursBatch &#39;ABC&#39; paying &#39;S&#39; earnings 2697.62</code> Is that really what you want it to look like?"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476834781, "post_id": 40117593, "comment_id": 67510896, "body": "Thank you for the quick reply. I have modified the comments a little. Actually the output would look something like this &#39;x&#39; , &#39;s&#39; has no earning/hours, paying &#39;S&#39; earnings 2697.62. Once this is done, I will have to re-run the loop but this time compare first column A1=A2 then join J1 and J2. Then the entire comments would look something like this, For &#39;123&#39;, batch &#39;ABC&#39;, &#39;x&#39;,&#39;s&#39; has no earnings, paying &#39;s&#39; earnings 2697.62, batch &#39;XYZ&#39;, &#39;O&#39; has no earnings (if there are any earnings/ hours then &#39;O&#39; has hours 20) with same condition for statement 2. Finally, I will get a o/p without repetition"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476835774, "post_id": 40117593, "comment_id": 67511123, "body": "Can take your spreadsheet and show a complicated deletion, concatenate, resulting in the final product for one row? Like background color the rows that would be deleted in red or something, and show how their values would get concatenated. I think I&#39;d be able to understand the scope a little better this way. Make it where after all is said and done, 4 lines turn into 1 with something being added from each of the 3 lines to the last remaining one. post this as a picture in the bottom of your question and comment here when you&#39;re done so i get the alert. Thanks!"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476871489, "post_id": 40117593, "comment_id": 67526178, "body": "Hey, I have made the sheet that you have asked for. I hope you would understand the output I am looking for."}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476882080, "post_id": 40117593, "comment_id": 67534204, "body": "Sorry forgot to mention. In final output, comparison would be between A1 and A2 from output 1 and their consecutive comments would be concatenated with few more additional comments. Also, &quot;Y&quot; and &quot;N&quot; would be compared from new column in output 1 for A1 and A2 and result would be pasted in final output. Thanks.."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476892613, "post_id": 40117593, "comment_id": 67542303, "body": "I have new code written and its almost done but duty calls at work so if you dont mind waiting until later today, ill be able to get the updated answer for you. I used a different method too, so ill teach you how it works and why i changed it. :)"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476895922, "post_id": 40117593, "comment_id": 67544253, "body": "Thank you so much Tyeler. I have really learnt something from you. I used your coce and made some modifications to it to run it again and again to get the final output. I did get the final output but there are still few rows with similar values that did not join. I would be waiting for your new code and would be learning even more. I am pasting the codes that I have modified using your code above in original message."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476925215, "post_id": 40117593, "comment_id": 67557517, "body": "Sorry it took me so long to get back to you, but I finally finished it. It&#39;s at the top of my answer. I believe it&#39;s exactly what you were originally trying to achieve. Let me know what you think of it :)"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476983118, "post_id": 40117593, "comment_id": 67589692, "body": "Hey Tyeler, I tried your new code and I&#39;m sorry to say that it isn&#39;t working like it should. Also, the statement 2 &quot;Y&quot; and &quot;N&quot; isn&#39;t giving desired result. I have added an image to the main question which shows the sample data and output vs expected data."}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476987177, "post_id": 40117593, "comment_id": 67592085, "body": "I think if we can figure out how to run the loop without skipping the similar cell in Code 2 can fix the issue once and for all. I ran the code 2 in debug mode and see that it is comparing Row1 and Row2, adding the comments, deleting Row2. Now Row 3 becomes Row1 instead of Row1 being Row1 and comparing itself with Row3(which is new Row2) and if they are same add the comments else move on to Row 3(new Row2) and compare it with Row4(new Row3) and so on.."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476989921, "post_id": 40117593, "comment_id": 67593749, "body": "Did you mean to remove the original Column D data (used to have <code>123-ACB</code> in it and such). Because the code was using that column."}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1476995915, "post_id": 40117593, "comment_id": 67597028, "body": "No, that would still be intact till we receive the final output. Once, we have got the result we want, we can leave the column or delete it at the end. I ran the code with and without that column - With column D, I am getting the result shown in the image. without Column D, I get something with lot of data missing in it. For now lets assume we keep the column D as it is and get the final output with comments mentioned in expected result."}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477007549, "post_id": 40117593, "comment_id": 67601151, "body": "Hey Teyler, is there a way to reset the counter in code 3, for each condition because it will solve the problem. Now what happens is whenever the loop runs, it adds two similar values, deletes the second value an and loop runs again from 3rd value. In this case, we get two values of same group. If the loop stops starts again at 1st value and compares with 3rd value after deleting 2nd value and if there&#39;s no similar value then moves to next row, my problem would be solved. Waiting for your response."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477007641, "post_id": 40117593, "comment_id": 67601168, "body": "I just fixed the code. Gimme one sec, I&#39;m posting it now. It works 100% in accordance with the last data set you gave me. I also improved further on the formatting."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477008011, "post_id": 40117593, "comment_id": 67601240, "body": "Answer updated. Let me know what you think. That was actually a lot more difficult to figure out the logic than I thought it would be..."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477008492, "post_id": 40117593, "comment_id": 67601353, "body": "I gotta go, might be for the night. If anything comes up, I won&#39;t be able to get to it until tomorrow night. Hope it meets your needs this time! :)"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477009976, "post_id": 40117593, "comment_id": 67601676, "body": "Thank you so much for all you support Tyeler. I will try your code once I am back in office and keep you updated. I have my fingers crossed and hoping that it works so that I don&#39;t give you any more trouble. You have been really helpful."}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477084941, "post_id": 40117593, "comment_id": 67638879, "body": "Hey Tyeler, I have tried your new code today. I have no words to say, it is working like a charm. You made my day today. I have finished that project and results are outstanding. Thank you so much for your help.. :D"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477095517, "post_id": 40117593, "comment_id": 67641656, "body": "If you wouldn&#39;t mind, could you mark my answer as the answer to your question? I&#39;m glad I could help you :)"}, {"owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477165872, "post_id": 40117593, "comment_id": 67658615, "body": "Hey Tyeler, I lready did that, but I do not have enough reputations so it is not considering my vote"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "edited": false, "score": 0, "creation_date": 1477197002, "post_id": 40117593, "comment_id": 67664599, "body": "No, not upvote, although I do appreciate that. There&#39;s a check mark under the up/down vote icon. If you click the check mark, you&#39;ll accept this answer as the answer. :)"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 1, "last_activity_date": 1477007982, "last_edit_date": 1477007982, "creation_date": 1476822891, "answer_id": 40117593, "question_id": 40114622, "link": "https://stackoverflow.com/questions/40114622/multiple-if-statements-looping-using-vba/40117593#40117593", "title": "Multiple IF Statements looping using VBA", "body": "<h2>Converting Formula to Macro</h2>\n\n<p><strong>I recreated a raw version of the last picture you added:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/IYiaE.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/IYiaE.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Using the heavily modified code below</strong></p>\n\n<pre><code>Sub CompareAndCompare()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\n    Dim A As Range, B As Range, C As Range, D As Range, E As Range, F As Range, finalR As Range\n    Dim compRange As Range: Set compRange = ws.Range(\"D2\", ws.Cells(ws.Rows.Count, \"D\").End(xlUp))\n    Dim state1 As String, stateTypeA As String, yn As String, myCell As Variant\n    Dim myRow As Long, STATEMENT As String, tempString() As String\n    Dim passOne As Boolean, firstTime As Boolean: firstTime = True\n    Dim st1 As String, st2 As String, output1 As Range, output2 As Range\n    Dim idNo As Range, batchNo1 As Range, batchNo2 As Range\n\n    For myRow = 2 To compRange.Count + 1 'This loop puts statements in \"J\"\n        stateType = \"\"\nStartOver:\n        Set A = ws.Range(\"D\" &amp; myRow)        'A = D2\n        Set C = ws.Range(\"G\" &amp; myRow)        'C = G2\n        Set D = ws.Range(\"H\" &amp; myRow)        'D = H2\n        Set output1 = ws.Range(\"J\" &amp; myRow)\n\n        If A.Value = \"\" Then Exit For\n\n        STATEMENT = \"\"\n        If C.Value = 0 Then STATEMENT = STATEMENT &amp; \"1\"\n        If D.Value = 0 Then STATEMENT = STATEMENT &amp; \"2\"\n        If C.Value &lt;&gt; 0 Then STATEMENT = STATEMENT &amp; \"3\"\n        If D.Value &lt;&gt; 0 Then STATEMENT = STATEMENT &amp; \"4\"\n        stateType = \"(\" &amp; ws.Range(\"F\" &amp; myRow).Value &amp; \") \"\n\n        Select Case STATEMENT\n            Case \"12\" 'C = 0, D = 0\n                state1 = \"*\"\n\n            Case \"34\" 'C &lt;&gt; 0, D &lt;&gt; 0\n                state1 = stateType &amp; \"has earnings of \" &amp; C.Value &amp; \" and \" &amp; D.Value &amp; \" hours\"\n\n            Case \"14\" 'C = 0, D &lt;&gt; 0\n                state1 = stateType &amp; \"has \" &amp; D.Value &amp; \" hours\"\n\n            Case \"23\" 'D = 0, C &lt;&gt; 0\n                state1 = stateType &amp; \"has earnings of \" &amp; C.Value\n            Case Else: MsgBox STATEMENT 'If a case isn't defined, show STATEMENT so code can be added\n        End Select\n            output1.Value = state1\n    Next myRow\n'//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    For myRow = 2 To compRange.Count + 1 'This Loop concatenates \"J\" when same \"D\"\nReiterate:\n        Set A = ws.Range(\"D\" &amp; myRow) 'A = D2 on first iteration of the loop\n        Set B = A.Offset(1)           'B = D3\n\n        If A.Value = \"\" Then Exit For\n\n        If A.Value = B.Value Then\n\n\nCheckForMore:\n            Set G = A.Offset(0, 5)        'G = I2\n            Set H = A.Offset(1, 5)        'H = I3\n\n            If (G.Value = \"N\" And H.Value = \"N\") Or ((G.Value = \"\" Or H.Value = \"\") And (G.Value = \"N\" Or H.Value = \"N\")) Then 'Statement 2\n                yn = \"N\"\n            Else: yn = \"Y\"\n            End If\n\n            ws.Range(\"K\" &amp; myRow).Value = yn\n            Set B = A.Offset(1)\n            st1 = \"(\" &amp; ws.Range(\"F\" &amp; myRow).Value &amp; \")\"\n            st2 = \"(\" &amp; ws.Range(\"F\" &amp; myRow + 1).Value &amp; \")\"\n            Set output1 = ws.Range(\"J\" &amp; myRow)\n            Set output2 = ws.Range(\"J\" &amp; myRow + 1)\n\n            If firstTime = True Then\n                If output1.Value = \"*\" Then\n                    firstTime = False\n                    stateType = st1\n                End If\n            End If\n\n            If output2.Value = \"*\" And A.Value = B.Value Then\n                If stateType = \"\" Then\n                    stateType = st2\n                Else: stateType = stateType &amp; \", \" &amp; st2\n                End If\n                B.EntireRow.Delete\n                GoTo CheckForMore\n\n            ElseIf output1.Value = \"*\" And firstTime = False And A.Value = B.Value Then\n                output1.Value = \"* have no earnings/hours, \" &amp; output2.Value\n                B.EntireRow.Delete\n                GoTo Reiterate\n\n            ElseIf output1.Value &lt;&gt; \"*\" And firstTime = False And A.Value = B.Value Then\n                output1.Value = output1.Value &amp; \", \" &amp; output2.Value\n                B.EntireRow.Delete\n                GoTo Reiterate\n\n            ElseIf output1.Value &lt;&gt; \"*\" And stateType &lt;&gt; \"\" And A.Value = B.Value Then\n                output1.Value = output1.Value &amp; \", * have no earnings/hours, \" &amp; output2.Value\n                B.EntireRow.Delete\n                GoTo Reiterate '''''''''''''''''''''''\n\n            ElseIf output1.Value = \"*\" And A.Value &lt;&gt; B.Value Then\n                output1.Value = \"* have no earnings/hours \"\n\n            ElseIf output1.Value &lt;&gt; \"*\" And stateType &lt;&gt; \"\" Then\n                output1.Value = output1.Value &amp; \", * have no earnings/hours \"\n            End If\n\n            output1.Value = Replace(output1.Value, \"*\", stateType)\n            firstTime = True\n            stateType = \"\"\n        Else\n            output1.Value = Replace(output1.Value, \"*\", stateType)\n            firstTime = True\n            stateType = \"\"\n        End If\n    Next myRow\n\n    Set finalR = ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n    passOne = False\n'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    For Each myCell In finalR 'This loop finalizes and removes duplicates\n        myRow = myCell.Row\nfinalAgain:\n        Set output1 = ws.Range(\"J\" &amp; myRow)\n        Set output2 = ws.Range(\"J\" &amp; myRow + 1)\n        Set idNo = ws.Range(\"A\" &amp; myRow)\n        Set batchNo1 = ws.Range(\"C\" &amp; myRow)\n        Set batchNo2 = ws.Range(\"C\" &amp; myRow + 1)\n\n        If myCell.Value = myCell.Offset(1).Value Then\n            If passOne = False Then\n                output1.Value = \"FOR \" &amp; idNo.Value &amp; \", FROM BATCH \" &amp; batchNo1.Value &amp; \": \" &amp; output1.Value _\n                    &amp; Chr(10) &amp; \"FROM BATCH \" &amp; batchNo2.Value &amp; \": \" &amp; output2.Value\n            Else: output1.Value = output1.Value &amp; Chr(10) &amp; \"FROM BATCH \" &amp; batchNo2.Value &amp; \": \" &amp; output2.Value\n            End If\n            myCell.Offset(1).EntireRow.Delete\n            passOne = True\n            GoTo finalAgain\n        Else: If passOne = False Then output1.Value = \"FOR \" &amp; idNo.Value &amp; \", FROM BATCH \" &amp; batchNo1.Value &amp; \": \" &amp; output1.Value\n        End If\n        passOne = False\n    Next myCell\nEnd Sub\n</code></pre>\n\n<p><strong>Will yield the following result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/iVxvD.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/iVxvD.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Which looks similar to what you were wanting. I made some edit to the formatting to make it easier to read. Let me know what you think and if this works for you :)</em></strong></p>\n\n<hr>\n\n<hr>\n\n<h2>Original Answer Below (May be useful in seeing how to convert EXCEL Formula into VBA Code)</h2>\n\n<p><strong>I'm not sure I understand the scope of your question but this is the direct conversion as best as I could make sense of it. Let me know if it functions how you imagine it should.</strong></p>\n\n<hr>\n\n<p><strong>I recreated your sheet:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/SjZt5.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/SjZt5.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>The first thing you want to do when doing a conversion like this is to break your formula up into a proper code format. I included <code>Else</code> and <code>End if/conc</code> lines to make your end parentheses easier to follow:</strong></p>\n\n<p><strong>STATEMENT 1</strong></p>\n\n<pre><code>----------------------------STATEMENT 1-----------------------------\nIF(D2=D3,\n    (IF(G2+H2+G3+H3=0,\n        CONCATENATE(\"Batch \",\"'\",C2,\"'\",\" has no earnings/hours\"),\n    Else\n        (CONCATENATE(\n            IF(G2=0,\n                \"\",\n            Else\n                CONCATENATE(\"paying \",\"'\",F2,\"'\",\" earnings \",G2)\n            end if),\n            IF(H2=0,\n                \"\",\n            Else\n                IF(H2&lt;&gt;0,\n                    IF(G2=0,\n                        CONCATENATE(\"paying \",\"'\",F2,\"'\",\" hours \",H2),\n                    Else\n                        CONCATENATE(\" and hours \",H2)\n                    end if)\n                end if)\n            end if),\n            IF(G3=0,\n                \"\",\n            Else\n                CONCATENATE(\" , paying \",\"'\",F3,\"'\",\" earnings \",G3)\n            end if),\n            IF(H3=0,\n                \"\",\n            Else\n                IF(H3&lt;&gt;0,\n                    IF(G3=0,\n                        CONCATENATE(\" , paying \",\"'\",F3,\"'\",\" hours \",H3),\n                    Else\n                        CONCATENATE(\" and hours \",H3)\n                    end if)\n                end if)\n            end if)\n        end concatenate))\n    end if))\n    IF(D2&lt;&gt;D3,\n        IF(G2+H2=0,\n            CONCATENATE(\"Batch \",\"'\",C2,\"'\",\" has no earnings/hours\"),\n        Else\n            CONCATENATE(\"Batch \",\"'\",C2,\"'\",\n                CONCATENATE(\n                    IF(G2=0,\n                        \"\",\n                    Else\n                        CONCATENATE(\" paying \",\"'\",F2,\"'\",\" earnings \",G2)\n                    end if),\n                    IF(H2=0,\n                        \"\",\n                    Else\n                        IF(G2=0,\n                            CONCATENATE(\" paying \",\"'\",F2,\"'\",\" hours \",H2),\n                        Else\n                            CONCATENATE(\" and hours \",H2)\n                        end if)\n                    end if)\n                end concatenate)\n            end concatenate)\n        end if)\n    end if)\nend if)\n</code></pre>\n\n<p><strong>STATEMENT 2</strong></p>\n\n<pre><code>----------------------------STATEMENT 2-----------------------------\n=IF(D2&lt;&gt;D3,\n    I2,\nElse\n    IF(D2=D3,\n        IF(AND(I2=\"Y\",I3=\"Y\"),\n            \"Y\",\n        Else\n            IF(AND(I2=\"Y\",I3=\"N\"),\n                \"Y\",\n            Else\n                IF(AND(I2=\"N\",I3=\"Y\"),\n                    \"Y\",\n                Else\n                    IF(AND(I2=\"N\",I3=\"N\"),\n                        \"N\"\n                    end if)\n                end if)\n            end if)\n        end if)\n    end if)\nend if)\n</code></pre>\n\n<hr>\n\n<p><strong>With this easy to read format, it's just a matter of using proper VBA vocabulary and a little clean up</strong></p>\n\n<pre><code>Sub CompareAndCompare()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\n    Dim A As Range, B As Range, C As Range, D As Range, E As Range, F As Range\n    Dim compRange As Range: Set compRange = ws.Range(\"D2\", ws.Cells(ws.Rows.Count, \"D\").End(xlUp))\n    Dim state1 As String\n\n    For Each A In compRange    'A = D2 on first iteration of the loop\n        Set B = A.Offset(1)    'B = D3\n        Set C = A.Offset(0, 3) 'C = G2\n        Set D = A.Offset(0, 4) 'D = H2\n        Set E = A.Offset(1, 3) 'E = G3\n        Set F = A.Offset(1, 4) 'F = H3\n        Set G = A.Offset(0, 5) 'G = I2\n        Set H = A.Offset(1, 5) 'H = I3\n        state1 = \"\"\n\n        If A.Value = B.Value Then\n            If G.Value = \"N\" And H.Value = \"N\" Then 'Statement 2\n                ws.Range(\"K\" &amp; A.Row).Value = \"N\"\n            Else: ws.Range(\"K\" &amp; A.Row).Value = \"Y\"\n            End If\n\n            If C.Value + D.Value + E.Value + F.Value = 0 Then\n                state1 = \"Batch '\" &amp; ws.Range(\"C\" &amp; A.Row).Value &amp; \"' has no earnings/hours\"\n            Else\n                If C.Value &lt;&gt; 0 Then _\n                    state1 = state1 &amp; \"paying '\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"' earnings \" &amp; C.Value\n\n                If D.Value &lt;&gt; 0 Then\n                    If C.Value = 0 Then\n                        state1 = state1 &amp; \"paying '\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"' earnings \" &amp; D.Value\n                    Else\n                        state1 = state1 &amp; \" and hours \" &amp; D.Value\n                    End If\n                End If\n\n                If E.Value &lt;&gt; 0 Then _\n                    state1 = state1 &amp; \" , paying '\" &amp; ws.Range(\"F\" &amp; A.Offset(1).Row).Value &amp; \"' earnings \" &amp; E.Value\n\n                If F.Value &lt;&gt; 0 Then\n                    If E.Value = 0 Then\n                        state1 = state1 &amp; \" , paying '\" &amp; ws.Range(\"F\" &amp; A.Offset(1).Row).Value &amp; \"' hours \" &amp; F.Value\n                    Else\n                        state1 = state1 &amp; \" and hours \" &amp; F.Value\n                    End If\n                End If\n            End If\n            B.EntireRow.Delete\n        Else 'D2 &lt;&gt; D3\n            ws.Range(\"K\" &amp; A.Row).Value = G.Value 'Statement 2\n\n            If C.Value + D.Value = 0 Then\n                state1 = \"Batch '\" &amp; ws.Range(\"C\" &amp; A.Row).Value &amp; \"' has no earnings/hours\"\n            Else\n                state1 = \"Batch '\" &amp; ws.Range(\"C\" &amp; A.Row).Value &amp; \"'\"\n                If C.Value &lt;&gt; 0 Then _\n                    state1 = state1 &amp; \" paying '\" &amp; ws.Range(\"F\" &amp; A.Row) &amp; \"' earnings \" &amp; C.Value\n\n                If D.Value &lt;&gt; 0 Then\n                    If C.Value = 0 Then\n                        state1 = state1 &amp; \" paying '\" &amp; ws.Range(\"F\" &amp; A.Row) &amp; \"' hours \" &amp; D.Value\n                    Else\n                        state1 = state1 &amp; \" and hours \" &amp; D.Value\n                    End If\n                End If\n            End If\n        End If\n        ws.Range(\"J\" &amp; A.Row).Value = state1\n    Next A\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>When I run this code on the sheet, this is the resulting output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/rrAK2.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/rrAK2.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>It deleted the rows when D2:D3 are the same, and continues through the rest of the items in that range (which is dynamic). I didn't change the statements you wanted on the output. Let me know what you think.</p>\n"}], "owner": {"reputation": 15, "user_id": 7037890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a192c2617e373bcca66c13ecacd6c6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/7037890/nitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3694, "favorite_count": 0, "accepted_answer_id": 40117593, "answer_count": 1, "score": 0, "last_activity_date": 1477007982, "creation_date": 1476812154, "last_edit_date": 1476983178, "question_id": 40114622, "link": "https://stackoverflow.com/questions/40114622/multiple-if-statements-looping-using-vba", "title": "Multiple IF Statements looping using VBA", "body": "<p><strong>Data:</strong></p>\n\n<p>This is only a sample from the data I am using.</p>\n\n<p>Please find the output below. \"Output via Code\" is the one we are getting when we run the code. \"Expected Output\" is the one we are looking for.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jPAWa.jpg\" rel=\"nofollow\">Data+Output</a></p>\n\n<p>The first code and its modified versions which I have pasted earlier seems to be giving the result but the only problem is, it is leaving one or two similar values without joining them.</p>\n\n<p><strong>Original Message:</strong></p>\n\n<p>I have framed a \"If Statement\". This statement compares two rows and displays a comment in one of the columns. While the statement works perfectly in excel, the code recorded in VBE for the same do not. Please help.</p>\n\n<p><strong>Statement:</strong></p>\n\n<pre><code>=IF(D2=D3,(IF(G2+H2+G3+H3=0,CONCATENATE(\"Batch \",\"'\",C2,\"'\",\" has no earnings/hours\"),(CONCATENATE(IF(G2=0,\"\",CONCATENATE(\"paying \",\"'\",F2,\"'\",\" earnings \",G2)),IF(H2=0,\"\",IF(H2&lt;&gt;0,IF(G2=0,CONCATENATE(\"paying \",\"'\",F2,\"'\",\" hours \",H2),CONCATENATE(\" and hours \",H2)))),IF(G3=0,\"\",CONCATENATE(\" , paying \",\"'\",F3,\"'\",\" earnings \",G3)),IF(H3=0,\"\",IF(H3&lt;&gt;0,IF(G3=0,CONCATENATE(\" , paying \",\"'\",F3,\"'\",\" hours \",H3),CONCATENATE(\" and hours \",H3)))))))),IF(D2&lt;&gt;D3,IF(G2+H2=0,CONCATENATE(\"Batch \",\"'\",C2,\"'\",\" has no earnings/hours\"),CONCATENATE(\"Batch \",\"'\",C2,\"'\",CONCATENATE(IF(G2=0,\"\",CONCATENATE(\" paying \",\"'\",F2,\"'\",\" earnings \",G2)),IF(H2=0,\"\",IF(G2=0,CONCATENATE(\" paying \",\"'\",F2,\"'\",\" hours \",H2),CONCATENATE(\" and hours \",H2))))))))\n</code></pre>\n\n<ol>\n<li>I tried recording a macro for this statement, but I get a error when I execute the recorded code in my macro.</li>\n<li>I would like to convert this statement into macro and run it as loop till end of last row.</li>\n<li>I would like to compare a particular cell in Row 1 and Row 2, then execute above statement. Then compare values of two different cells in Row 1 and Row 2, paste the outcome in anther cell. Once these tasks are performed, delete the second row and run the loop for similar cell values, join the first comments with second comment. If next row value is different then not to delete the row and run the loop and so on till end of all rows.</li>\n<li>Also, the second \"if statement\" isn't doing the job it is suppose to do.</li>\n</ol>\n\n<p><strong>Second If Statement:</strong></p>\n\n<pre><code>=IF(D2&lt;&gt;D3,I2,IF(D2=D3,IF(AND(I2=\"Y\",I3=\"Y\"),\"Y\",lf(AND(I2=\"Y\",I3=\"N\"),\"Y\",IF(AND(I2=\"N\",I3=\"Y\"),\"Y\",IF(AND(I2=\"N\",I3=\"N\"),\"N\"))))))\n</code></pre>\n\n<p>VBE Code for If Statement 1:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(RC[-6]=R[1]C[-6],(IF(RC[-3]+RC[-2]+R[1]C[-3]+R[1]C[-2]=0,CONCATENATE(\"\"Batch \"\",\"\"'\"\",RC[-7],\"\"'\"\",\"\" has no earnings/hours\"\"),(CONCATENATE(IF(RC[-3]=0,\"\"\"\",CONCATENATE(\"\"paying \"\",\"\"'\"\",RC[-4],\"\"'\"\",\"\" earnings \"\",RC[-3])),IF(RC[-2]=0,\"\"\"\",IF(RC[-2]&lt;&gt;0,IF(RC[-3]=0,CONCATENATE(\"\" paying \"\",\"\"'\"\",RC[-4],\"\"'\"\",\"\"hours\"\", RC[-2]),CONCATENATE(\"\" and hours \"\",RC[-2]))\" &amp; _\n    \"1]C[-3]=0,\"\"\"\",CONCATENATE(\"\" , paying \"\",\"\"'\"\",R[1]C[-4],\"\"'\"\",\"\" earnings \"\",R[1]C[-3])),(IF(R[1]C[-2]=0,\"\"\"\",IF(R[1]C[-2]&lt;&gt;0,IF(R[1]C[-3]=0,CONCATENATE(\"\" paying \"\",\"\"\"\",R[1]C[-4],\"\"'\"\",\"\" hours \"\",R[1]C[-2]),CONCATENATE(\"\" and hours \"\",R[1]C[-2]))))))))),IF(RC[-6]&lt;&gt;R[1]C[-6],IF(RC[-3]+RC[-2]=0,CONCATENATE(\"\"Batch \"\",\"\"'\"\",RC[-7],\"\"'\"\",\"\" has no earnings/hours\"\")\" &amp; _\n    \"CONCATENATE(\"\"Batch \"\",\"\"'\"\",RC[-7],\"\"'\"\",CONCATENATE(IF(RC[-3]=0,\"\"\"\",CONCATENATE(\"\" paying \"\",\"\"'\"\",RC[-4],\"\"'\"\",\"\"earnings \"\",RC[-3])),IF(RC[-2]=0,\"\"\"\",IF(RC[-3]=0,CONCATENATE(\"\" paying \"\",\"\"'\"\",RC[-4],\"\"'\"\",\"\" hours \"\",RC[-2]),CONCATENATE(\"\" and hours \"\",RC[-2]))))))))\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bSEcK.jpg\" rel=\"nofollow\">Final Output</a></p>\n\n<p><strong>Code 1:</strong></p>\n\n<pre><code>Sub CompareAndCompare()\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet4\")\nDim A As Range, B As Range, C As Range, D As Range, E As Range, F As Range\nDim compRange As Range: Set compRange = ws.Range(\"D2\", ws.Cells(ws.Rows.Count, \"D\").End(xlUp))\nDim state1 As String\n\nFor Each A In compRange    'A = D2 on first iteration of the loop\n    Set B = A.Offset(1)    'B = D3\n    Set C = A.Offset(0, 3) 'C = G2\n    Set D = A.Offset(0, 4) 'D = H2\n    Set E = A.Offset(1, 3) 'E = G3\n    Set F = A.Offset(1, 4) 'F = H3\n    Set G = A.Offset(0, 5) 'G = I2\n    Set H = A.Offset(1, 5) 'H = I3\n    state1 = \"\"\n\n    If A.Value = B.Value Then\n        If G.Value = \"N\" And H.Value = \"N\" Then 'Statement 2\n            ws.Range(\"K\" &amp; A.Row).Value = \"N\"\n        Else\n            If G.Value = \"\" And H.Value = \"Y\" Then\n            ws.Range(\"K\" &amp; A.Row).Value = \"Y\"\n        Else\n             If G.Value = \"Y\" And H.Value = \"\" Then\n            ws.Range(\"K\" &amp; A.Row).Value = \"Y\"\n        Else\n            If G.Value = \"N\" And H.Value = \"\" Then\n            ws.Range(\"K\" &amp; A.Row).Value = \"N\"\n        Else\n            If G.Value = \"\" And H.Value = \"N\" Then\n            ws.Range(\"K\" &amp; A.Row).Value = \"N\"\n        Else\n            If G.Value = \"\" And H.Value = \"\" Then\n            ws.Range(\"K\" &amp; A.Row).Value = \"\"\n        Else: ws.Range(\"K\" &amp; A.Row).Value = \"Y\"\n        End If\n       End If\n      End If\n     End If\n    End If\n  End If\n        If C.Value + D.Value + E.Value + F.Value = 0 Then\n            state1 = \"'\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"', \" &amp; \"'\" &amp; ws.Range(\"F\" &amp; A.Offset(1).Row).Value &amp; \"' has no earnings/hours\"\n        Else\n            If C.Value &lt;&gt; 0 Then _\n                state1 = state1 &amp; \"paying '\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"' earnings \" &amp; C.Value\n\n            If D.Value &lt;&gt; 0 Then\n                If C.Value = 0 Then\n                    state1 = state1 &amp; \"paying '\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"' earnings \" &amp; D.Value\n                Else\n                    state1 = state1 &amp; \" and hours \" &amp; D.Value\n                End If\n            End If\n\n            If E.Value &lt;&gt; 0 Then _\n                state1 = state1 &amp; \" paying '\" &amp; ws.Range(\"F\" &amp; A.Offset(1).Row).Value &amp; \"' earnings \" &amp; E.Value\n\n            If F.Value &lt;&gt; 0 Then\n                If E.Value = 0 Then\n                    state1 = state1 &amp; \" paying '\" &amp; ws.Range(\"F\" &amp; A.Offset(1).Row).Value &amp; \"' hours \" &amp; F.Value\n                Else\n                    state1 = state1 &amp; \" and hours \" &amp; F.Value\n                End If\n            End If\n        End If\n        B.EntireRow.Delete\n    Else 'D2 &lt;&gt; D3\n        ws.Range(\"K\" &amp; A.Row).Value = G.Value 'Statement 2\n\n        If C.Value + D.Value = 0 Then\n            state1 = \"'\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"' has no earnings/hours\"\n        Else\n            'state1 = \"'\" &amp; ws.Range(\"F\" &amp; A.Row).Value &amp; \"'\"\n            If C.Value &lt;&gt; 0 Then _\n                state1 = \" paying '\" &amp; ws.Range(\"F\" &amp; A.Row) &amp; \"' earnings \" &amp; C.Value\n\n            If D.Value &lt;&gt; 0 Then\n                If C.Value = 0 Then\n                    state1 = \" paying '\" &amp; ws.Range(\"F\" &amp; A.Row) &amp; \"' hours \" &amp; D.Value\n                Else\n                    state1 = \" and hours \" &amp; D.Value\n                End If\n            End If\n        End If\n    End If\n    ws.Range(\"J\" &amp; A.Row).Value = state1\nNext A\nEnd Sub\n</code></pre>\n\n<p><strong>Code 2:</strong></p>\n\n<pre><code>Sub CompareAndCompare1()\nDim ws As Worksheet:  Set ws = ThisWorkbook.Sheets(\"Sheet4\")\nDim A As Range, B As Range\nDim compRange As Range: Set compRange = ws.Range(\"D2\", ws.Cells(ws.Rows.Count, \"D\").End(xlUp))\nDim state1 As String\nFor Each A In compRange    'A = D2 on first iteration of the loop\n    Set B = A.Offset(1)    'B = D3\n     Set C = A.Offset(0, 7) 'C =K2\n    Set D = A.Offset(1, 7) 'D = K3\n    state1 = \"\"\n If A.Value = B.Value Then\n         If C.Value = \"N\" And D.Value = \"N\" Then    'Statement 2\n            ws.Range(\"L\" &amp; A.Row).Value = \"N\"\n        Else\n            If C.Value = \"\" And D.Value = \"Y\" Then\n            ws.Range(\"L\" &amp; A.Row).Value = \"Y\"\n        Else\n             If C.Value = \"Y\" And D.Value = \"\" Then\n            ws.Range(\"L\" &amp; A.Row).Value = \"Y\"\n        Else\n            If C.Value = \"N\" And D.Value = \"\" Then\n            ws.Range(\"L\" &amp; A.Row).Value = \"N\"\n        Else\n            If C.Value = \"\" And D.Value = \"N\" Then\n            ws.Range(\"L\" &amp; A.Row).Value = \"N\"\n        Else\n            If C.Value = \"\" And D.Value = \"\" Then\n            ws.Range(\"L\" &amp; A.Row).Value = \"\"\n        Else: ws.Range(\"L\" &amp; A.Row).Value = \"Y\"\n        End If\n      End If\n     End If\n    End If\n   End If\n   End If\n  state1 = \"Batch \" &amp; ws.Range(\"C\" &amp; A.Row).Value &amp; \": \" &amp; ws.Range(\"J\" &amp;  A.Row).Value &amp; \", \" &amp; ws.Range(\"J\" &amp; A.Offset(1).Row).Value\n B.EntireRow.Delete \n Else 'D2&lt;&gt;D3\n ws.Range(\"L\" &amp; A.Row).Value = C.Value\n state1 = \"Batch \" &amp; ws.Range(\"C\" &amp; A.Row).Value &amp; \": \" &amp; ws.Range(\"J\" &amp; A.Row).Value\n End If\n ws.Range(\"M\" &amp; A.Row).Value = state1\n  Next A\n  End Sub\n</code></pre>\n\n<p><strong>Code 3:</strong></p>\n\n<pre><code>Sub CompareAndCompare2()\nDim ws As Worksheet:  Set ws = ThisWorkbook.Sheets(\"Sheet4\")\nDim A As Range, B As Range\nDim compRange As Range: Set compRange = ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\nDim state1 As String\n For Each A In compRange    'A = A2 on first iteration of the loop\n    Set B = A.Offset(1)    'B = A3\n     Set C = A.Offset(0, 11) 'C =L2\n    Set D = A.Offset(1, 11) 'D = L3\n    state1 = \"\"\nIf A.Value = B.Value Then\n        If C.Value = \"N\" And D.Value = \"N\" Then    'Statement 2\n            ws.Range(\"N\" &amp; A.Row).Value = \"N\"\n            Else: ws.Range(\"N\" &amp; A.Row).Value = \"Y\"\n        End If\n        state1 = \"For file# \" &amp; ws.Range(\"A\" &amp; A.Row).Value &amp; \", \" &amp;    ws.Range(\"M\" &amp; A.Row).Value &amp; \", \" &amp; ws.Range(\"M\" &amp; A.Offset(1).Row).Value\nB.EntireRow.Delete\nElse 'A2&lt;&gt;A3\nws.Range(\"N\" &amp; A.Row).Value = C.Value\nstate1 = \"For file# \" &amp; ws.Range(\"A\" &amp; A.Row).Value &amp; \", \" &amp; ws.Range(\"M\" &amp; A.Row).Value\nEnd If\nws.Range(\"O\" &amp; A.Row).Value = state1\nNext A\nEnd Sub\n</code></pre>\n"}]