[{"tags": ["vba", "add"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495668248, "post_id": 44169932, "comment_id": 75355750, "body": "<code>cint</code> try instead of val, you are concatenating"}, {"owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495668449, "post_id": 44169932, "comment_id": 75355802, "body": "something like this? a = CInt(TextBox1.Text) b = CInt(TextBox2.Text) c = CInt(TextBox3.Text)"}, {"owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495670008, "post_id": 44169932, "comment_id": 75356177, "body": "Thank you Nathan..It works now.."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "edited": false, "score": 1, "creation_date": 1495669990, "post_id": 44170144, "comment_id": 75356171, "body": "Hi Hexie, thank you so much..It works as what Nathan said I added also the one I used in my header post..please see.."}], "tags": [], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "is_accepted": true, "score": 1, "last_activity_date": 1495669359, "creation_date": 1495669359, "answer_id": 44170144, "question_id": 44169932, "link": "https://stackoverflow.com/questions/44169932/adding-2-numbers-in-2-textbox/44170144#44170144", "title": "Adding 2 Numbers in 2 TextBox", "body": "<p>You need to cast the value to cint, as Nathan_Sav said, you are currently concatenating strings.</p>\n\n<p>You would need to do something like this:</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nTextBox3.Value = CInt(TextBox1.Value) + CInt(TextBox2.Value)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 44170144, "answer_count": 1, "score": 1, "last_activity_date": 1495669943, "creation_date": 1495667812, "last_edit_date": 1495669943, "question_id": 44169932, "link": "https://stackoverflow.com/questions/44169932/adding-2-numbers-in-2-textbox", "title": "Adding 2 Numbers in 2 TextBox", "body": "<p>I'm having trouble adding 2 Integers in TextBox.  If I add 1 + 1 I get 11.</p>\n\n<p>Please help..</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim a As Integer\nDim b As Integer\nDim c As Integer\n\na = CInt(TextBox1.Text)\nb = CInt(TextBox2.Text)\nc = CInt(TextBox3.Text)\n\nTextBox3.Value = TextBox1.Value + TextBox2.Value\n\nc = a + b\n\nEnd Sub\n</code></pre>\n\n<p>I used this code and it works too:</p>\n\n<pre><code> x = CDbl(txtSurveyYes.Value) + CDbl(txtSurveyNo.Value)\n\n        txtTotal.Value = x\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 3, "creation_date": 1495668753, "post_id": 44169779, "comment_id": 75355885, "body": "Odd behavior is very likely to occur when using <code>Select&#47;Activate&#47;ActiveCell</code> and unqualified ranges (so extensively!). I urge you to read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495804128, "post_id": 44169779, "comment_id": 75417443, "body": "This is exactly my problem.  Thank you for the link now I know how to avoid select."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1495672640, "creation_date": 1495672640, "answer_id": 44170531, "question_id": 44169779, "link": "https://stackoverflow.com/questions/44169779/excel-vba-dynamic-code-repeat-failure/44170531#44170531", "title": "Excel VBA Dynamic Code Repeat Failure", "body": "<p>If you wanted to write write code you can easily understand you wouldn't write code like this:-</p>\n\n<pre><code>Sheets(\"Base434\").Select\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\n</code></pre>\n\n<p>This is what your code says, translated into plain language:-</p>\n\n<pre><code>Look at sheet \"Base434\"\nLook at cell A1 (implied: in that sheet)\nLook at what you are looking at and extend your view to the last ??? right\n    (This is where the mistake is)\nCopy what you are looking at.\n</code></pre>\n\n<p>Now, surely, if you wanted to understand what all this looking is aiming to do you might express the idea somewhat like this:-</p>\n\n<pre><code>Copy the cells in Row 1 of Sheet \"Base434\" from A1 to the end of the row.\n</code></pre>\n\n<p>With this kind of approach you would end up with code like this:-</p>\n\n<pre><code>Dim RangeToCopy As Range\nDim Cl As Long                              ' the last used column\n\nWith Worksheets(\"Base434\")\n    Cl = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    Set RangeToCopy = .Range(.Cells(1, 1), .Cells(1, Cl))\nEnd With\nMsgBox \"Range to copy = \" &amp; RangeToCopy.Address\nRangeToCopy.Copy\n</code></pre>\n\n<p>Would you say that this code is harder to read and understand than your version? Well, it has three advantages, even if it is. One, it doesn't have the fault that yours has. Two, it never got near to wanting to make the mistake that your approach made. Three, whatever errors it might still contain are easy to find and quick to eliminate.</p>\n\n<p>Besides, it runs faster.</p>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 2, "last_activity_date": 1495689315, "creation_date": 1495689315, "answer_id": 44172755, "question_id": 44169779, "link": "https://stackoverflow.com/questions/44169779/excel-vba-dynamic-code-repeat-failure/44172755#44172755", "title": "Excel VBA Dynamic Code Repeat Failure", "body": "<p>As commented by @A.S.H avoid using <code>Select/Activate/ActiveCell</code> if at all possible.  Ranges should be qualified by using their sheet names.  <code>With...End With</code> constructs achieve both of these goals.  The <code>With</code> statement allows you to perform a series of statements on a specified object without requalifying the name of the object.</p>\n\n<p>Indentation makes code much easier to read and understand.</p>\n\n<p>With the foregoing in mind I think this code is understandable</p>\n\n<pre><code>Sub NoStdHC()\nDim LastRow As Long\nDim sht As Worksheet\n\nApplication.ScreenUpdating = False\nWith Sheets(\"Base434\")\n    LastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row\n    .Range(\"A1:T\" &amp; LastRow).AutoFilter Field:=10, Criteria1:=\"&lt;=.5\"\n    .Range(.Cells(2, 11), .Cells(LastRow, 11)).Copy\nEnd With\nWith Sheets(\"Processing\")\n    .Range(\"AC1\").PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\n    .Range(\"C5\").FormulaR1C1 = \"=COUNTA(C[26])\"\n    .Range(\"E5\").FormulaR1C1 = \"=SUM(C[24])\"\nEnd With\nDim wsTest As Worksheet\nConst strSheetName As String = \"PR0OnStd\"\n'Loop through sheets to find strSheetName\n'if not found, then wsTest will be Nothing\nFor Each sht In ThisWorkbook.Sheets\n    If sht.Name = strSheetName Then\n        Set wsTest = ActiveWorkbook.Worksheets(strSheetName)\n        Exit For\n    End If\nNext\nIf wsTest Is Nothing Then\n'Add the sheet, set up headings, column widths and frozen pane\n    Worksheets.Add.Name = strSheetName\n    With Sheets(\"Base434\")\n        .Range(\"A1\", .Range(\"A1\").End(xlToRight)).Copy\n    End With\n    With Sheets(\"PR0OnStd\")\n        .Range(\"A1\").PasteSpecial xlPasteValues\n        .UsedRange.Columns.AutoFit\n    End With\n    With ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 1\n        .FreezePanes = True\n    End With\nEnd If\nWith Sheets(\"Base434\")\n    .Range(.Cells(2, 1), .Cells(LastRow, 2).End(xlToRight)).Copy\nEnd With\nWith Sheets(\"PR0OnStd\")\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    .Range(\"A\" &amp; LastRow).PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\nEnd With\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 44170531, "answer_count": 2, "score": 0, "last_activity_date": 1495689315, "creation_date": 1495666770, "last_edit_date": 1495677451, "question_id": 44169779, "link": "https://stackoverflow.com/questions/44169779/excel-vba-dynamic-code-repeat-failure", "title": "Excel VBA Dynamic Code Repeat Failure", "body": "<p>This code is a bit complex but the problem with it is the second and third time it is run it will start to lose columns on the \"Base434\" worksheet that it pulls information from.  I tried a quick fix of adding \"Range(\"A1\").Select so that anything previously highlighted couldn't throw it off but it keeps ditching the 20th row which is column \"T\".  I have left all of the code below in hope that someone can find my bug.  I just cannot sort it.  </p>\n\n<p>Essentially this code sorts set fields of data on an imported worksheet called \"Base434\", copies specific fields to another page which has some embeded formulas then checks to see if the worksheet \"NoStdHC\" exists.  If it doesn't it will create said worksheet and add the header.  Then move to the filtered worksheet called \"Base434\" and copy all visible cells in that worksheet.  It will then paste those in the first available cell in column A of \"NoStdHC\".  My issue is after running this once it refuses to copy the final column on the next \"Base434\" sheet that has been imported.  Can anyone find the fault in my code?  Yes I know a lot of this could be condensed if I were better at coding but I would prefer to understand what the code is doing which is why I have it written this way.</p>\n\n<pre><code>    Sub NoStdHC()\n'\n' NoStdHC Macro created by \n'\n\n'\n    Application.ScreenUpdating = False\n    Sheets(\"Base434\").Select\n    LastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n    ActiveSheet.Range(\"A1:T\" &amp; LastRow).AutoFilter Field:=15\n    ActiveSheet.Range(\"A1:T\" &amp; LastRow).AutoFilter Field:=10\n    ActiveSheet.Range(\"A1:T\" &amp; LastRow).AutoFilter Field:=10, Criteria1:=\"&lt;=.5\", _\n        Operator:=xlAnd\n    Columns(11).Cells.SpecialCells(xlCellTypeVisible).Cells(2).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Processing\").Select\n    Range(\"AC1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"C5\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=COUNTA(C[26])\"\n    Range(\"e5\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM(C[24])\"\n    Range(\"C8\").Select\n    Sheets(\"Base434\").Select\n    Dim wsTest As Worksheet\n    Const strSheetName As String = \"PR0OnStd\"\n\n    Set wsTest = Nothing\n    On Error Resume Next\n    Set wsTest = ActiveWorkbook.Worksheets(strSheetName)\n    On Error GoTo 0\n\n    If wsTest Is Nothing Then\n    Worksheets.Add.Name = strSheetName\n    Sheets(\"Base434\").Select\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"PR0OnStd\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Selection.Columns.AutoFit\n    Range(\"A2\").Select\n    With ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 1\n    End With\n    ActiveWindow.FreezePanes = True\n    End If\n    Sheets(\"Base434\").Select\n    Range(\"a1\").Select\n    Columns(1).Cells.SpecialCells(xlCellTypeVisible).Cells(2).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"PR0OnStd\").Select\n    LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    Range(\"A\" &amp; LastRow).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.ScreenUpdating = True\nEnd Sub'\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1495666926, "post_id": 44169762, "comment_id": 75355368, "body": "<code>For Each iCell In ActiveSheet.Range(ActiveSheet.Cells(4,r),ActiveSheet.Cells(7&zwnj;&#8203;8,r))</code> or since you are only looking at the active sheet <code>Range(Cells(4,r),Cells(78,r))</code>"}, {"owner": {"reputation": 956, "user_id": 3496240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e51d489805223fae1ef929503256e073?s=128&d=identicon&r=PG&f=1", "display_name": "gemmo", "link": "https://stackoverflow.com/users/3496240/gemmo"}, "edited": false, "score": 0, "creation_date": 1495671827, "post_id": 44169762, "comment_id": 75356616, "body": "Cells(81, r) &lt; 4.... how can these statements be true? are you saying the value of the cell? cells.value &lt;4?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 956, "user_id": 3496240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e51d489805223fae1ef929503256e073?s=128&d=identicon&r=PG&f=1", "display_name": "gemmo", "link": "https://stackoverflow.com/users/3496240/gemmo"}, "edited": false, "score": 1, "creation_date": 1495671897, "post_id": 44169762, "comment_id": 75356637, "body": "@gemmo the default of Cells() is <code>.Value</code>, Though my OCD requires I put it, it is not needed."}, {"owner": {"reputation": 21, "user_id": 5553032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vW9xS.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5553032/joe"}, "edited": false, "score": 0, "creation_date": 1495678044, "post_id": 44169762, "comment_id": 75358082, "body": "Thank you so much! Works great!"}], "owner": {"reputation": 21, "user_id": 5553032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vW9xS.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5553032/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495666627, "creation_date": 1495666627, "question_id": 44169762, "link": "https://stackoverflow.com/questions/44169762/how-to-use-activesheet-cells-cells", "title": "How to use ActiveSheet.[Cells(),Cells()]", "body": "<p>This is to select random values from unique data validation lists by column starting in column D.  Once my criteria is met I want to move to the next column.  The problem with what I have lies in the line</p>\n\n<p>\"For Each iCell In ActiveSheet.[Cells(4,r):Cells(78,r)]\"</p>\n\n<p>It works for column D when I use \"ActiveSheet.[D4:D78]\" but not as it currently is.</p>\n\n<p>Please help.</p>\n\n<pre><code>Sub build()\nDim r As Long\nr = 4\nDo While r &lt; 36\n    Do While Cells(81, r) &lt; 4 And Cells(82, r) &lt; 4 And Cells(83, r) &lt; 9 And Cells(84, r) &lt; 9\n        Dim iCell As Range\n        Randomize\n        For Each iCell In ActiveSheet.[Cells(4,r):Cells(78,r)]\n            iCell.Value = Range(iCell.Validation.Formula1).Cells(Int(Range(iCell.Validation.Formula1).Count * Rnd + 1))\n        Next\n    Loop\n    r = r + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": [".net", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495666596, "post_id": 44169723, "comment_id": 75355288, "body": "FYI - As you do with <code>Range()</code>, whenever you use <code>Cells()</code>, make sure to refer to the sheet you want it to run on.  It&#39;s a little unintuitive, but doing <code>Worksheets(&quot;Sheet1&quot;).Range(Cells(),Cells())</code> needs the worksheet before <code>Cells()</code>, even though it&#39;s in from of <code>Range()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1495671957, "creation_date": 1495671957, "answer_id": 44170444, "question_id": 44169723, "link": "https://stackoverflow.com/questions/44169723/compare-copy-and-paste-with-vba-excel/44170444#44170444", "title": "Compare, Copy and Paste with VBA Excel", "body": "<p>You can directly assign a value from one cell to another cell:</p>\n\n<pre><code>If WBC.Worksheets(\"DATA\").Cells(j, \"A\").Value = jobnum And _\n   WBC.Worksheets(\"DATA\").Cells(j, \"B\").Value = mainmachine Then\n\n\n    WBT.Worksheets(\"Sheet1\").Cells(j, \"P\").Value = _\n        WBC.Worksheets(\"DATA\").Cells(i, \"N\").Value\n\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8049796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6836e2f72f1ff7ef2f2cbc099e3cd99f?s=128&d=identicon&r=PG&f=1", "display_name": "pesqueda", "link": "https://stackoverflow.com/users/8049796/pesqueda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495671957, "creation_date": 1495666277, "question_id": 44169723, "link": "https://stackoverflow.com/questions/44169723/compare-copy-and-paste-with-vba-excel", "title": "Compare, Copy and Paste with VBA Excel", "body": "<p>It would be much appreciated if we could get some help with this!\nSo, I'm trying to compare \"Column A\"(Job Number)  from the \"CNC DEPT\" and \"Column A\" (Job Number)from the Capacity List. Then compare \"Column B\" (MainMachine from capacity) to \"Column K\" (Current WC off of CNC Dept). If those are both True, we would like to Copy Column N (Total Time) and paste it onto \"Column P\" (No data on CNC DEPT). I am having problems with the code listed below. The syntax is fine, but it returns a value of ####VALUE.The code copies a value from a second sheet and pastes it into the current sheet. The cell being copied derives its value from a VLOOKUP function on a different sheet. I think this may be creating the problem. Is there a way to copy a cell's numeric value \nonly and not the formula? Or maybe paste the value only (like the Paste Special  Values Only menu item)?</p>\n\n<p>Here's my CODE NOW</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub transfer()\nDim i As Long\nDim j As Long\nDim lastrow1 As Long\nDim lastrow2 As Long\nDim jobnum As String\nDim mainmachine As String\nDim WBT As Workbook ''''This Workbook\nDim WBC As Workbook ''''CapacitySummary workbook \n\nSet WBT = Workbooks(\"CNC TEST.xlsx\")\nSet WBC = Workbooks(\"CapacitySummary.xlsx\")\nlastrow1 = WBT.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = WBC.Worksheets(\"DATA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nWBT.Worksheets(\"sheet1\").Activate\nFor i = 2 To lastrow1\njobnum = WBT.Sheets(\"Sheet1\").Cells(i, \"A\").Value\nmainmachine = WBT.Sheets(\"Sheet1\").Cells(i, \"K\").Value\nWBC.Worksheets(\"DATA\").Activate\n\n\nFor j = 2 To lastrow2\n\nIf WBC.Worksheets(\"DATA\").Cells(j, \"A\").Value = jobnum And WBC.Worksheets(\"DATA\").Cells(j, \"B\").Value = mainmachine Then  ''  CapacitySummary workbook\nWBC.Worksheets(\"DATA\").Activate\nWBC.Worksheets(\"DATA\").Range(Cells(i, \"N\"), Cells(i, \"N\")).Copy\n\n''''Choosing Range to copy\nWBT.Worksheets(\"Sheet1\").Activate\nWBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\")).Select\n'Range.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n''''Choosing Range to paste\n\nEnd If\n\nNext j\nApplication.CutCopyMode = False\n\nNext i\n\n\n\n'Application.ScreenUpdating = True\n'Stoptime = Time\n'elapsedTime = (Stoptime - StartTime) * 24 * 60\n'MsgBox \"List Complete \" &amp; elapsedTime &amp; \" minutes. \" &amp; Chr(13)\n'findConn.Close\n\nEnd SubBC As Workbook ''''CapacitySummary workbook \n\nSet WBT = Workbooks(\"CNC TEST.xlsx\")\nSet WBC = Workbooks(\"CapacitySummary.xlsx\")\n\nlastrow1 = WBT.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = WBC.Worksheets(\"DATA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nWBT.Worksheets(\"sheet1\").Activate\nFor i = 2 To lastrow1\njobnum = WBT.Sheets(\"Sheet1\").Cells(i, \"A\").Value\nmainmachine = WBT.Sheets(\"Sheet1\").Cells(i, \"K\").Value\nWBC.Worksheets(\"DATA\").Activate\n\n\nFor j = 2 To lastrow2\n\nIf WBC.Worksheets(\"DATA\").Cells(j, \"A\").Value = jobnum And WBC.Worksheets(\"DATA\").Cells(j, \"B\").Value = mainmachine Then  ''  CapacitySummary workbook\nWBC.Worksheets(\"DATA\").Activate\nWBC.Worksheets(\"DATA\").Range(Cells(i, \"N\"), Cells(i, \"N\")).Copy\n\n''''Choosing Range to copy\nWBT.Worksheets(\"Sheet1\").Activate\nWBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\")).Select\n'Range.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n''''Choosing Range to paste\n\nEnd If\n\nNext j\nApplication.CutCopyMode = False\n\nNext i\n\n\n\n'Application.ScreenUpdating = True\n'Stoptime = Time\n'elapsedTime = (Stoptime - StartTime) * 24 * 60\n'MsgBox \"List Complete \" &amp; elapsedTime &amp; \" minutes. \" &amp; Chr(13)\n'findConn.Close\n</code></pre>\n\n<p>End Sub\n<a href=\"https://i.stack.imgur.com/Pxgv7.png\" rel=\"nofollow noreferrer\">CNC DEPT</a>\n<a href=\"https://i.stack.imgur.com/N6gMj.png\" rel=\"nofollow noreferrer\">CAPACITY</a></p>\n"}, {"tags": ["vba", "excel", "if-statement", "compare"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "edited": false, "score": 0, "creation_date": 1495667033, "post_id": 44169687, "comment_id": 75355403, "body": "The problem with conditional formatting is that the document I use is different every day and so I would have to re-create the conditional format all the time.  I am trying to get it going in VBA as I already have about 7-8 macros that will be applied to the document each morning when it is generated."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "edited": false, "score": 0, "creation_date": 1495667096, "post_id": 44169687, "comment_id": 75355418, "body": "Understood, I added the fix to your code, in the edit. @EricWaters see the bottom part of the answer."}, {"owner": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "edited": false, "score": 0, "creation_date": 1495667343, "post_id": 44169687, "comment_id": 75355489, "body": "Yea I did see that afterward and it works like a beauty!  Thanks so very much for the help!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495671669, "post_id": 44169687, "comment_id": 75356580, "body": "Cells uses the coordinal points.  <code>Cells(row,column)</code> so the Range is using those cells as the extent <code>Range(Startcell,EndCell)</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1495666793, "last_edit_date": 1495666793, "creation_date": 1495666050, "answer_id": 44169687, "question_id": 44169577, "link": "https://stackoverflow.com/questions/44169577/compare-ells-a3-and-a2-if-equal-nothing-else-color-row-3-cells-a-though-f-rep/44169687#44169687", "title": "Compare ells A3 and A2, if equal, nothing else color row 3 cells A though F. Repeat with next row", "body": "<p>if you are interested, this can be done with conditional formatting with the following formula:</p>\n\n<pre><code>=ISEVEN(SUMPRODUCT(1/COUNTIFS($A$1:$A1,$A$1:$A1)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rGN7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rGN7a.png\" alt=\"![enter image description here\"></a></p>\n\n<hr>\n\n<p>If you really want to use vba then change the this line:</p>\n\n<pre><code>a.Interior.color = currentColor 'Interior.Color\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Range(Cells(a.Row, 1), Cells(a.Row, 6)).Interior.Color = currentColor 'Interior.Color\n</code></pre>\n\n<p>so it will apply to the entire row in the desired range and not just Column A.</p>\n"}], "owner": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 44169687, "answer_count": 1, "score": 0, "last_activity_date": 1495666793, "creation_date": 1495665492, "last_edit_date": 1495665742, "question_id": 44169577, "link": "https://stackoverflow.com/questions/44169577/compare-ells-a3-and-a2-if-equal-nothing-else-color-row-3-cells-a-though-f-rep", "title": "Compare ells A3 and A2, if equal, nothing else color row 3 cells A though F. Repeat with next row", "body": "<p>What I have are a list of contracts below a header row.  Some contracts take up multiple rows.  </p>\n\n<p>What I would like is to have a VBA Macro that will compare cell A3 to A2.  If they are the same; next.  If they are different, then select the cells A3:F3 and change Interior.Color to grey.</p>\n\n<p>Then compare A4 to A3, then A5 to A4 and repeat for all used cells in the A column, effectively making a table.</p>\n\n<p>This is what the screen looks like:</p>\n\n<pre><code>Row   Column A   Column B     C         D        E        F\n\n1.    000000      (Info)   (Info)    (Info)   (Info)   (Info)\n2.    111111      (Info)   (Info)    (Info)   (Info)   (Info)\n3.    123456      (Info)   (Info)    (Info)   (Info)   (Info)\n4.    123456      (Info)   (Info)    (Info)   (Info)   (Info)\n5.    654321      (Info)   (Info)    (Info)   (Info)   (Info)\n6.    124536      (Info)   (Info)    (Info)   (Info)   (Info)\n7.    666666      (Info)   (Info)    (Info)   (Info)   (Info)\n</code></pre>\n\n<p>What I would like to see is:</p>\n\n<pre><code>1.    000000      (Info)   (Info)    (Info)   (Info)   (Info) 'line is clear\n2.    111111      (Info)   (Info)    (Info)   (Info)   (Info) 'line is grey\n3.    123456      (Info)   (Info)    (Info)   (Info)   (Info) 'line is clear\n4.    123456      (Info)   (Info)    (Info)   (Info)   (Info) 'line is clear\n5.    654321      (Info)   (Info)    (Info)   (Info)   (Info) 'line is grey\n6.    124536      (Info)   (Info)    (Info)   (Info)   (Info) 'line is clear\n7.    666666      (Info)   (Info)    (Info)   (Info)   (Info) 'line is grey\n</code></pre>\n\n<p>I have spent my day searching and have found (and worked on the following script however it is only coloring the first cell in the line.</p>\n\n<pre><code>Sub Line_Shading()\n\n    Application.ScreenUpdating = False\n    Dim this As Variant\n    Dim previous As Variant\n    Dim currentColor As Long\n\n    Dim rng As Range \n    Dim a As Range   \n    ' pick a color to start with\n    currentColor = 14277081              ' 14277081 Grey or 16777215 Clear\n    ' rng = used and visible cells\n\n    Set rng = Range(\"A2:A\" &amp; Range(\"A2\").End(xlDown).Row)\n\n    For Each a In rng\n        If Not a.Row = 1 Then            ' skip header row\n            this = a.Value\n            'some simple test logic to switch colors\n            If this &lt;&gt; previous Then\n                If currentColor = 14277081 Then\n                    currentColor = 16777215\n                ElseIf currentColor = 16777215 Then\n                    currentColor = 14277081\n                End If\n            End If\n\n            'set interior color\n            a.Interior.color = currentColor 'Interior.Color\n\n            previous = this\n\n       End If\n    Next a\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I feel that it will just be a modification of the line:\n            a.Interior.color = currentColor 'Interior.Color\n  but I just can't see the solution.</p>\n\n<p>Suggestions?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1495665115, "post_id": 44169485, "comment_id": 75354854, "body": "there is no question in your speech, only wants.  Stack Overflow is not a code for me or finish my code for me site.  Please explain the problem with the existing code and ask a specific question about what the code is doing that is in error.  Not &quot;How do I get from here to where I want?&quot;"}, {"owner": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495670216, "post_id": 44169485, "comment_id": 75356232, "body": "Sorry, you are right. I am only looking for a way to check if there is a specific string in the array without using a For loop."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "edited": false, "score": 0, "creation_date": 1495727873, "post_id": 44170467, "comment_id": 75383617, "body": "I wanted to try this, but i did not get this part so I could not fit it in my code.  <code>D(&quot;p_1&quot;) = D(&quot;p_2&quot;) + D(&quot;p_3&quot;) + D(&quot;p_4&quot;) + D(&quot;p_5&quot;)</code>  I am using Excel VBA so maybe <code>application.match</code> would work as you stated."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "edited": false, "score": 0, "creation_date": 1495733498, "post_id": 44170467, "comment_id": 75386753, "body": "@J.Bringas <code>application.match</code> is specific to Excel. You did not specify that you are using Excel. Are you? If so you should add the <code>excel</code> and <code>excel-vba</code> tags."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "edited": false, "score": 0, "creation_date": 1495747944, "post_id": 44170467, "comment_id": 75394266, "body": "@J.Bringas see the last part for using <code>Match</code>. Besides, I dont understand what you did not &quot;get&quot; from the dictionary part. The comment above that line clearly states what it is doing."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1495747856, "last_edit_date": 1495747856, "creation_date": 1495672189, "answer_id": 44170467, "question_id": 44169485, "link": "https://stackoverflow.com/questions/44169485/use-of-an-array-of-strings-to-have-conditions-of-which-data-to-copy-in-vba/44170467#44170467", "title": "Use of an array of strings to have conditions of which data to copy in VBA", "body": "<p>Since it is not clear which VBA application is your context (i.e. you could use <code>Application.Match</code> in Excel-VBA), you can achieve this with the help of a <code>Scripting.Dictionary</code> object, where you put your parameter names as keys, then check with <code>Dictionary.Exists</code> method. You then achieve two benefits:</p>\n\n<ul>\n<li>Easy search without loop</li>\n<li>Fast search</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>Sub UsingADictionary()\n    Dim D As Object: Set D = CreateObject(\"Scripting.Dictionary\")\n    D.CompareMode = TextCompare ' &lt;-- If you want to ignore case in param names\n\n    ' dummy statement to insert keys. Values will be 0, don't care\n    D(\"p_1\") = D(\"p_2\") + D(\"p_3\") + D(\"p_4\") + D(\"p_5\")  '...\n\n    If D.Exists(\"p_2\") Then\n      Debug.Print \"p_2 exists\"\n      ' ... do something for p_2\n    Else\n      Debug.Print \"p_2 does not exist\"\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now that you specified Excel and <code>Application.Match</code>, it can work this way. Notice that your array for search should be declared as variant, not as a typed array such as</p>\n\n<pre><code>Sub UsingMatch()\n  Dim parameters\n  parameters = Array(\"aa\", \"bb\", \"cc\", \"dd\", \"ee\")\n\n  If Not IsError(Application.Match(\"a\", parameters, 0)) Then\n    Debug.Print \"aa found\"\n  Else\n    Debug.Print \"aa Not found\"\n  End If\nEnd Sub\n</code></pre>\n\n<p>Note that <code>Match</code> is not case sensitive.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1495684564, "creation_date": 1495684564, "answer_id": 44172022, "question_id": 44169485, "link": "https://stackoverflow.com/questions/44169485/use-of-an-array-of-strings-to-have-conditions-of-which-data-to-copy-in-vba/44172022#44172022", "title": "Use of an array of strings to have conditions of which data to copy in VBA", "body": "<p>You can search an array by joining it to a string and search the string, here is an example of how it works:</p>\n\n<pre><code>Sub SearchArray()\n    Dim MyArr As Variant\n    MyArr = Array(\"Hello\", \"World\", \"These\", \"Are\", \"Seperate\", \"Array\", \"Values\")\n    If InStr(1, \"|\" &amp; Join(MyArr, \"|\") &amp; \"|\", \"|These|\") &gt; 0 Then MsgBox \"Found These\"\n    If InStr(1, \"|\" &amp; Join(MyArr, \"|\") &amp; \"|\", \"|NotInArray|\") &gt; 0 Then MsgBox \"Found NotInArray\"\nEnd Sub\n</code></pre>\n\n<p>We join the array to a single string using a pipe | as a delimiter, we then top and tail the string with a | so that we can search for our string with a pipe on either side, we do this to stop it returning a false positive if our search term exists in part in another value.</p>\n\n<p>Once we have our string, we use instr to determine the starting char of our search term, if it is not found it will simply be zero, a simple test to see if the result is >0 will determine if the value you are looking for is present in the array.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "edited": false, "score": 0, "creation_date": 1495727641, "post_id": 44182035, "comment_id": 75383469, "body": "Thanks this works perfect for my purpose, I&#39;d never heard of <i>lbound</i> nor <i>ubound</i> but it is good to learn this stuff."}], "tags": [], "owner": {"reputation": 116, "user_id": 8055070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8a61ed3c943ae2c305fdd70dffe0e60?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8055070/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1495719467, "creation_date": 1495719467, "answer_id": 44182035, "question_id": 44169485, "link": "https://stackoverflow.com/questions/44169485/use-of-an-array-of-strings-to-have-conditions-of-which-data-to-copy-in-vba/44182035#44182035", "title": "Use of an array of strings to have conditions of which data to copy in VBA", "body": "<p>Maybe this works for u</p>\n\n<pre><code>For i=lbound(parameters) to ubound(parameters)\n  Select Case Lcase(parameters(i))\n    Case \"parameter name1\"\n      Set tbl= ws.ListObjects(tablename)\n  End Select\n  'Copy tablecontents\nNext i\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7650288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1f0cb0cad69ae76b93e24f3694b5d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bringas", "link": "https://stackoverflow.com/users/7650288/j-bringas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1495747856, "creation_date": 1495664943, "last_edit_date": 1495747028, "question_id": 44169485, "link": "https://stackoverflow.com/questions/44169485/use-of-an-array-of-strings-to-have-conditions-of-which-data-to-copy-in-vba", "title": "Use of an array of strings to have conditions of which data to copy in VBA", "body": "<p>I am doing a code where you decide which parameters to include in my general report. I need to change my code when a parameters is to be reomved or added. </p>\n\n<p>When a change is done, I need to change which report to open and copy the formatted table from. What I want my code to do is to ask the user for the parameters they want to include and store them in some array (maybe) and the following code would have conditions to check if the string array has the word for the parameter.   </p>\n\n<p>Here I am pasting an idea but I am not sure if this is the more efficient way. </p>\n\n<pre><code>Dim parameters() As String\n'Input box for size of array*\nredim parameters(size)\n\n'Input box for p1, p2, ... pn\nparameters = { p_1, p_2, ... p_n}  ' I am not really sure about this part\n\nFor i = 1 To size\n    If LCase(parameters(i)) = \"parameter_name1\" Then \n        'Copy the table of paramater_name1 report\n        Exit For\n    End If\nNext i\n\nFor i = 1 To size\n    If LCase(parameters(i)) = \"parameter_name2\" Then \n        'Copy the table of paramater_name2 report\n        Exit For\n    End If\nNext i  \n\n...\n</code></pre>\n\n<p>Is there a more concrete (and less iterative) way to find if the input value is in the array? As you can see I am checking each object in the array. </p>\n\n<p>Any kind of help is welcome. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495663998, "post_id": 44169301, "comment_id": 75354481, "body": "Does the workbook open?"}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495664045, "post_id": 44169301, "comment_id": 75354494, "body": "@TimWilliams No it does not."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495664312, "post_id": 44169301, "comment_id": 75354582, "body": "What is calling <code>CommandButton2_Click</code> - is it just a button on a UserForm?  (I have to ask - I have seen people call code like this from a UDF.)"}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495664376, "post_id": 44169301, "comment_id": 75354606, "body": "@YowE3K Yes, <code>CommandButton2_Click</code> is a button."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1495664598, "post_id": 44169301, "comment_id": 75354683, "body": "Are you sure the <code>Open()</code> line gets executed?  I can&#39;t see how it could fail without at least raising an error."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495664642, "post_id": 44169301, "comment_id": 75354696, "body": "After the <code>myFile = .SelectedItems(1)</code>, add <code>Debug.Print myFile</code> and let us know what it returns in the Immediate Window (press CTRL+G in the VBE to see it)."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495664767, "post_id": 44169301, "comment_id": 75354736, "body": "@TimWilliams I see no reason as to why <code>Workbooks.Open(myFile)</code> wouldn&#39;t be executed. In the question at the <a href=\"https://stackoverflow.com/questions/7693530/excel-vba-cant-open-workbook\">link</a>  I included, there wasn&#39;t an error raised either."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495664824, "post_id": 44169301, "comment_id": 75354759, "body": "@BruceWayne I&#39;ve done that, and it returns the expected string: <code>C:\\Users\\User\\Desktop\\Templates and Example data\\Repeat Tests\\file.xlsx</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495665455, "post_id": 44169301, "comment_id": 75354955, "body": "The link you gave also mentions other issues that prevent a workbook from being opened, e.g. being within the Workbook_BeforeSave event.  Is anything like that likely to be happening in your situation?  Do you have any <code>Workbook</code> or <code>Worksheet</code> events at all in your code that might be confusing things (even though <code>EnableEvents</code> is set to <code>False</code>)?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495665765, "post_id": 44169301, "comment_id": 75355027, "body": "I&#39;ve never seen this type of line fail without raising some kind of error, so something quite specific is going on in your situation which we don&#39;t have access to.  Try putting a break on that line and check it&#39;s actually running."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495665899, "post_id": 44169301, "comment_id": 75355072, "body": "@YowE3K There are no events."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495667364, "post_id": 44169301, "comment_id": 75355493, "body": "@TimWilliams I added the break. It doesn&#39;t seem to be running--no Excel file opens and <code>wb = Nothing</code> remains--, but I can&#39;t come up with a reason why it wouldn&#39;t run."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495667917, "post_id": 44169301, "comment_id": 75355654, "body": "Your code runs for me with no modifications.  I would put a break on the first line of the sub and use F8 to step through and see what happens."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495668250, "post_id": 44169301, "comment_id": 75355752, "body": "@TimWilliams Stepping through is how I determined the <code>Set wb = Workbooks.Open(myFile)</code> line is the issue. The next line is <code>Set wbR = wb.Worksheets(3)</code> which produces an error (<code>run-time error 91</code>) because <code>wb = Nothing</code>. Only way <code>wb</code> can equal <code>Nothing</code> is if something is going wrong with the <code>Set wb</code> line or <code>myFile</code> isn&#39;t what I want it to be (but <code>myFile</code> is the proper string).,"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1495669109, "post_id": 44169301, "comment_id": 75355972, "body": "I meant step through the whole sub and see what is causing the <code>Open()</code> line to get skipped."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495728505, "post_id": 44169301, "comment_id": 75384003, "body": "@TimWilliams When going through the whole sub the line <code>Set wb = Workbooks.Open(myFile)</code> is not skipped over. It executes the line but <code>.Open()</code> doesn&#39;t open the file. Even when I step through with the full path &amp; file string instead of <code>myFile</code> it doesn&#39;t work."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495730583, "post_id": 44169301, "comment_id": 75385138, "body": "Check your tools references to make sure you have all the ordinary references.  1. Visual Basic for Applications, 2. Microsoft Excel 15.0 Object Library, 3. OLE Automation and 4. Microsoft Office 15.0 object library."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495734225, "post_id": 44169301, "comment_id": 75387105, "body": "I&#39;ve got no ideas - something else is going on here.  Try cutting your code down to only the problem line - comment out all of the other lines and hard-code the path passed to Open (similar to John&#39;s suggestion) - does it still fail?"}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495734935, "post_id": 44169301, "comment_id": 75387483, "body": "@TimWilliams I don&#39;t know how or why it worked, but after adding in the lines John Muggins suggested below and deleting them, the original line <code>Set wb = Workbooks.Open(myFile)</code> suddenly works."}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495731053, "post_id": 44185775, "comment_id": 75385403, "body": "Are you sure your file is named &quot;file.xlsx&quot;"}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "edited": false, "score": 1, "creation_date": 1495734683, "post_id": 44185775, "comment_id": 75387339, "body": "I added in the <code>Workbooks.Open Filename:=&quot;string&quot;</code> and the <code>Set wb = ActiveWorkbook</code>, and it worked. So I then replaced the <code>string</code> and tested <code>Workbooks.Open Filename:=myFile</code>, and that worked. Perplexed, I removed these lines and tested the original <code>Set wb = Workbooks.Open(myFile)</code> and it suddenly worked. I don&#39;t know what gives, but these lines work perfectly fine now."}, {"owner": {"reputation": 3052, "user_id": 3414257, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1663202984/picture?type=large", "display_name": "panoet", "link": "https://stackoverflow.com/users/3414257/panoet"}, "edited": false, "score": 0, "creation_date": 1501637938, "post_id": 44185775, "comment_id": 77861346, "body": "Had the same problem. And this solution still not fixing mine. Anyone?"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1495730852, "creation_date": 1495730852, "answer_id": 44185775, "question_id": 44169301, "link": "https://stackoverflow.com/questions/44169301/vba-workbook-openfile-returns-nothing/44185775#44185775", "title": "VBA Workbook.Open(File) returns Nothing", "body": "<p>And at the very last try this little sub.  If it doesn't open your workbook then there is a problem with the path or filename</p>\n\n<pre><code>Sub opendfghj()\n\nDim wb As Workbook\n\nWorkbooks.Open Filename:=\"C:\\Users\\User\\Desktop\\Templates and Example data\\Repeat Tests\\file.xlsx\"\n\nSet wb = ActiveWorkbook\n\nwb.Worksheets(\"Sheet1\").Range(\"A1\") = \"It Works\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 9533746, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TomFp", "link": "https://stackoverflow.com/users/9533746/tomfp"}, "is_accepted": false, "score": 4, "last_activity_date": 1526050608, "creation_date": 1526050608, "answer_id": 50295060, "question_id": 44169301, "link": "https://stackoverflow.com/questions/44169301/vba-workbook-openfile-returns-nothing/50295060#50295060", "title": "VBA Workbook.Open(File) returns Nothing", "body": "<p>If you have a copy of the workbook open (in a different folder) with the <strong>same name</strong> as the one your VBA is trying to open, it fails silently. The ActiveWorkbook solution appears to work - as you have at least one workbook open already - and that is active - but its not the one you think it is.</p>\n\n<p>I imagine it it could be a common mistake - as while developing a VBA project you might have a copy of the target workbook open to check on column numbers etc.</p>\n"}], "owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8283, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1526050608, "creation_date": 1495663888, "last_edit_date": 1495734805, "question_id": 44169301, "link": "https://stackoverflow.com/questions/44169301/vba-workbook-openfile-returns-nothing", "title": "VBA Workbook.Open(File) returns Nothing", "body": "<p><strong>EDIT:</strong> <em>After lots of help and not having a clue what's going on, it worked using a different method of opening (<a href=\"https://stackoverflow.com/a/44185775/8037946\">see @JohnMuggin's help below</a>)--so I un-commented my original code and suddenly it works.</em></p>\n\n<p>I've only found one other instance of <code>Workbook.Open(\"file\")</code> returning nothing <a href=\"https://stackoverflow.com/questions/7693530/excel-vba-cant-open-workbook\">(Link to Q)</a>. However, their problem was because of calling <code>Workbook.Open(\"file\")</code> in a user-defined function (to my understanding). Here, I am calling it in a <code>Sub</code>, but am having the same issue and can't find a solution. I am using Excel 2013.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n'Set variables\nDim wb As Workbook 'Workbook to open\nDim wbR As Worksheet 'This is the raw data on the new workbook\nDim wsL As Worksheet 'Worksheet in current file\nDim myFile As String 'File to open\nDim FilePicker As FileDialog\n\n'Set light chain hit worksheet\nSet wsL = ThisWorkbook.Worksheets(3)\n\n'Optimizes Speed\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\nSet FilePicker = Application.FileDialog(msoFileDialogFilePicker)\n\n'Opens folder-picking window\nWith FilePicker\n    .Title = \"Select a file.\"\n    .AllowMultiSelect = False\n    If .Show = True Then\n        myFile = .SelectedItems(1)\n    Else: GoTo NextCode\n    End If\nEnd With\n\n'If folder is not selected\nNextCode:\n    myFile = myFile\n    If myFile = \"\" Then GoTo ResetSettings\n\n'Set variable equal to opened workbook\nSet wb = Workbooks.Open(myFile)\n</code></pre>\n\n<p>The macro continues, but the last line <code>Set wb = Workbooks.Open(myFile)</code> sets <code>wb</code> as <code>Nothing</code>. This does not produce any errors until I call <code>wb</code> farther down in the code.</p>\n\n<p>An earlier line, <code>Set wsL = ThisWorkbook.Worksheets(3)</code>, also sets <code>wsL</code> as <code>Nothing</code>.</p>\n\n<p>I have checked each line and values using the debugger, and have determined <code>myFile</code> is the proper path, file name, and extension.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7442894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10154475117908918/picture?type=large", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/7442894/peter-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1495662018, "creation_date": 1495662018, "answer_id": 44168912, "question_id": 44168833, "link": "https://stackoverflow.com/questions/44168833/toggle-command-button/44168912#44168912", "title": "Toggle Command Button", "body": "<p>OH I managed to figure out my questions.  Instead of </p>\n\n<pre><code>If CommandButton1 = False And CollapseRange1.Font.Hidden = False Then\n</code></pre>\n\n<p>I use </p>\n\n<pre><code>If CommandButton1 = False And ActiveDocument.Tables(3).Cell(1, 1).Range.Font.Hidden = False Then\n</code></pre>\n\n<p>I hoped this helps someone else!</p>\n"}], "owner": {"reputation": 101, "user_id": 7442894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10154475117908918/picture?type=large", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/7442894/peter-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495681977, "creation_date": 1495661633, "last_edit_date": 1495681977, "question_id": 44168833, "link": "https://stackoverflow.com/questions/44168833/toggle-command-button", "title": "Toggle Command Button", "body": "<p>I was wondering if you guys can help me with this problem.  So I want a button that would show/hide a table in ms word.  However, I can only get the button to do either show or hide separately with my code.  Currently this code will show my table:</p>\n\n<pre><code>Sub Loan1()\n'Hides Sections Not Used in Expanded Form\n    Dim CollapseRange1 As Range\n    'Set Which Range/Cell to Associate with Button\n    With ActiveDocument.Tables(3)\n    Set CollapseRange1 = .Rows(1).Range\n        CollapseRange1.End = .Rows(25).Range.End\n    End With\n'If button is pressed then Hide/show CollapseRanges\n    If CommandButton1 = False And CollapseRange1.Font.Hidden = False Then\n    CollapseRange1.Font.Hidden = True\n    Else\n    CollapseRange1.Font.Hidden = False\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I was hoping to be able to use one button to show and hide my table depending on the state of my table (hidden or unhidden)</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1495660886, "post_id": 44168637, "comment_id": 75353324, "body": "sounds like you are looking for <code>vlookup()</code> like  <code>=vlookup(C1, A:B, 2, false)</code> into D1 to search C1 in column A and return the corresponding value from column B"}, {"owner": {"reputation": 1, "user_id": 8061816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8579eeec078e8d0526466789a3a40d?s=128&d=identicon&r=PG&f=1", "display_name": "Grant Wittenberg", "link": "https://stackoverflow.com/users/8061816/grant-wittenberg"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1495661294, "post_id": 44168637, "comment_id": 75353512, "body": "Thanks for the idea! That almost works perfectly, however, it also needs to be able to identify a string search even if it is contained within another. Ie. If the string ABC is contained within ABCD or ABC_D, then it should return the value that corresponds with ABC."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1495661772, "post_id": 44168637, "comment_id": 75353705, "body": "Then use wild cards <code>=vlookup(&quot;*&quot; &amp; C1 &amp; &quot;*&quot;, A:B, 2, false)</code>"}], "owner": {"reputation": 1, "user_id": 8061816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8579eeec078e8d0526466789a3a40d?s=128&d=identicon&r=PG&f=1", "display_name": "Grant Wittenberg", "link": "https://stackoverflow.com/users/8061816/grant-wittenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495660777, "creation_date": 1495660777, "last_edit_date": 1531161705, "question_id": 44168637, "link": "https://stackoverflow.com/questions/44168637/excel-function-search-for-a-string-from-a-list", "title": "Excel Function - Search for a string from a list.", "body": "<p>If I have 4 columns: \n<strong>Column A</strong> contains a string value.\n<strong>Column B</strong> contains a string that corresponds to the value in the same row in A.</p>\n\n<p>How can I search all the cells in <strong>Column C</strong> for any of the strings listed in <strong>Column A</strong>?  Then when a match is found, output the corresponding value from <strong>Column B</strong>. </p>\n\n<p>For clarity: Columns A and B are used for reference only. Column C is searched and Column D is where the result is recorded.</p>\n\n<p>Thank you for any help you can provide, \nGrant</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8061594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f6ab6c9dd925997312020f6927bf97?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedmaherfx", "link": "https://stackoverflow.com/users/8061594/ahmedmaherfx"}, "edited": false, "score": 0, "creation_date": 1495693109, "post_id": 44173115, "comment_id": 75362269, "body": "Works great thanks alot much appreciated your help, the only issue I faced that is stops at the last &quot;TH&quot; in column &quot;C&quot; and won&#39;t proceed to the previous cell next to last &quot;TH&quot; in column &quot;B&quot;. If you can modify it to proceed also to last previous cell in column B  and copy it untill to last cell in anthor column like column &quot;A&quot; or even to last of column &quot;B&quot;. Thanks in advance :)"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 3, "user_id": 8061594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f6ab6c9dd925997312020f6927bf97?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedmaherfx", "link": "https://stackoverflow.com/users/8061594/ahmedmaherfx"}, "edited": false, "score": 0, "creation_date": 1495693584, "post_id": 44173115, "comment_id": 75362482, "body": "When you say <code>won&#39;t proceed to the previous cell next to last &quot;TH&quot; in column &quot;B&quot;</code> do you mean you want to also copy cells in A the way they are in column B?  If you post a picture of what you want I should be able to change the code accordingly."}, {"owner": {"reputation": 3, "user_id": 8061594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f6ab6c9dd925997312020f6927bf97?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedmaherfx", "link": "https://stackoverflow.com/users/8061594/ahmedmaherfx"}, "edited": false, "score": 0, "creation_date": 1495756838, "post_id": 44173115, "comment_id": 75397019, "body": "Thankssssssssss alot works great, your Help is much appropriated :)"}], "tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 0, "last_activity_date": 1495724511, "last_edit_date": 1495724511, "creation_date": 1495691035, "answer_id": 44173115, "question_id": 44168617, "link": "https://stackoverflow.com/questions/44168617/vba-loop-search-by-text-offset-then-incremnt/44173115#44173115", "title": "VBA Loop search by text,offset then incremnt", "body": "<p>This should do what you want:</p>\n\n<pre><code>Option Explicit\n\n\nSub test()\n\n  Dim sht As Worksheet\n  Set sht = ActiveSheet\n\n  With sht\n    Dim ilastrow As Long\n    ilastrow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    Dim r As Range, cell As Range, prevCell As Range\n    Set r = .Range(\"C1:C\" &amp; ilastrow)\n\n    Set prevCell = Nothing\n    For Each cell In r\n      If cell.Value = \"TH\" Then\n        If Not prevCell Is Nothing Then\n          prevCell.Offset(1, -1).Resize(cell.Row - prevCell.Row - 1, 1).Value = prevCell.Offset(, -1).Value\n          Set prevCell = cell\n        Else\n          Set prevCell = cell\n        End If\n      End If\n    Next\n\n    ilastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    prevCell.Offset(1, -1).Resize(ilastrow - prevCell.Row, 1).Value = prevCell.Offset(, -1).Value\n\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8061594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93f6ab6c9dd925997312020f6927bf97?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedmaherfx", "link": "https://stackoverflow.com/users/8061594/ahmedmaherfx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 44173115, "answer_count": 1, "score": 0, "last_activity_date": 1495724511, "creation_date": 1495660698, "question_id": 44168617, "link": "https://stackoverflow.com/questions/44168617/vba-loop-search-by-text-offset-then-incremnt", "title": "VBA Loop search by text,offset then incremnt", "body": "<p>I've been searching for more than 3 days to build this VBA Macro I need so any help would be much I appreciated.I want to build a macro with a Loop that will search for certain fixed text (this will be my reference step text) in a column let us say it's Column C, once it find that text will offset to the next cell to the left in Column B and this cell will have a variable text that I want to copy down to just before the next text step of C. I think Macro will be by making double loops, first loop to search for the text in column C and once find it will offset to adjacent cell of column B then another loop to copy &amp; paste the value of cell of column B down to before the next text step of C and first loop will be performed on all column c. my trial with first loop was some how successful as I tried to make it either with identifying the certain text as a Boolean or using For Each loop. but my hard part was always in the second loop to increment the text of column B down to the cell before the next step of column C and relate the two loops to each other.\nBelow are my trials if you could help in them I would be much appreciated.</p>\n\n<pre><code>    Sub test()\n\n    Dim i As Long\n\n    Dim ilastrow As Long\n\n    Dim n As string\n\n    ilastrow = Range(\"C1\").End(xlDown).Row\nDim r As Range, cell As Range\nSet r = Range(\"C1\").End(xlDown).Row\n\nFor Each cell In r\n        If cell.Value = \"TH\" Then\n   ActiveCell.Offset(rowOffset:=0, columnOffset:=-1).Activate\nn = ActiveCell.Value\n'from here I want to copy n down to every cell until before next \"TH\" in column C then proceed with next \"TH\" as n will be changed and so on for all \"TH\" in Colmun C \n\nEnd If\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/j4iz7.jpg\" rel=\"nofollow noreferrer\">what I want to do with picture</a></p>\n\n<p>any help will be much appreciated thanks in advance :)</p>\n"}, {"tags": ["excel", "vba", "macos", "vbe"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495660508, "post_id": 44168184, "comment_id": 75353131, "body": "Just a note: the VBE (the VBA IDE) has nothing to do with its host - it&#39;s the same editor whether you&#39;re in Excel, Word, Outlook, PowerPoint, Sage300, AutoCAD, or whatever. The VBA editor on Mac is an entirely different thing though, even more severely under-featured than the VBE."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495660595, "post_id": 44168595, "comment_id": 75353177, "body": "&quot;fully functional&quot; as in &quot;still won&#39;t support plug-ins but will let you comment code blocks&quot;?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495660801, "post_id": 44168595, "comment_id": 75353273, "body": "@Mat&#39;sMug who knows, maybe the patch will be .NET Core Editor for Office (with a VBA converter), and debut on the mac. Or maybe not."}, {"owner": {"reputation": 6415, "user_id": 1183010, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/96G0W.jpg?s=128&g=1", "display_name": "R. Oosterholt", "link": "https://stackoverflow.com/users/1183010/r-oosterholt"}, "edited": false, "score": 0, "creation_date": 1512645327, "post_id": 44168595, "comment_id": 82346714, "body": "Since the Mac Office 2016 October release (October 10, 2017 V15.39.0 build 17101000), the VBA editor is improved a lot. See <a href=\"https://support.office.com/en-us/article/Release-notes-for-Office-2016-for-Mac-ed2da564-6d53-4542-9954-7e3209681a41?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">release notes</a>"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1495660550, "creation_date": 1495660550, "answer_id": 44168595, "question_id": 44168184, "link": "https://stackoverflow.com/questions/44168184/commenting-uncomment-vba-code-in-excel-for-mac-2016/44168595#44168595", "title": "Commenting / Uncomment VBA code in Excel for Mac 2016", "body": "<p>The VBA editor in Office mac 2016 is severely broken. Office mac 2011 did have the ability to comment/uncomment code blocks.</p>\n\n<p>MS have promised a fix, but none has yet arrived:</p>\n\n<p><a href=\"https://excel.uservoice.com/forums/304933-excel-for-mac/suggestions/9098431-bring-back-a-fully-functional-vbe-visual-basic-ed\" rel=\"nofollow noreferrer\">Bring back a fully functional VBE (Visual Basic Editor for VBA)</a></p>\n"}], "owner": {"reputation": 31, "user_id": 8061758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d93987b60227fb3434f282f1487aba5?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Kumfer", "link": "https://stackoverflow.com/users/8061758/brent-kumfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1593677416, "creation_date": 1495658887, "last_edit_date": 1593677416, "question_id": 44168184, "link": "https://stackoverflow.com/questions/44168184/commenting-uncomment-vba-code-in-excel-for-mac-2016", "title": "Commenting / Uncomment VBA code in Excel for Mac 2016", "body": "<p>I've seen posts for how to comment / uncomment blocks of VBA code in Excel but they all seem to be related to Excel for Windows.  I can't figure out a similar method for commenting large blocks of code in Excel for Mac 2016.  Please help.</p>\n\n<p>Here is the related post I found for Windows:\n<a href=\"https://stackoverflow.com/questions/12933279/how-to-comment-and-uncomment-blocks-of-code-in-the-office-vba-editor/12933280#12933280\">How to comment and uncomment blocks of code in the Office VBA Editor</a></p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1495659519, "post_id": 44167647, "comment_id": 75352710, "body": "A quick and dirty way is to wrap <code>On Error Resume Next</code> and <code>On Error GoTo 0</code> around <code>objProcess.Terminate</code>. I debugged on my machine and found that the first Terminate call closed all windows at once regardless of whether or not they had multiple tabs open. Perhaps just do it once and exit loop."}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1495778785, "creation_date": 1495778785, "answer_id": 44194710, "question_id": 44167647, "link": "https://stackoverflow.com/questions/44167647/terminating-all-explorer-instances-via-vba-excel/44194710#44194710", "title": "Terminating all explorer instances via VBA - Excel", "body": "<p>Not exactly what you asked, but another approach that uses powershell and includes an option (from <a href=\"https://stackoverflow.com/questions/11410293/kill-all-internet-explorer-processes-that-have-been-running-for-more-than-5-minu\">here</a> to close windows only where IE has been open for more than X seconds.</p>\n\n<pre><code>Sub Comesfast()\nX2 = Shell(\"powershell.exe get-process iexplore | ? { ([DateTime]::Now - $_.StartTime).TotalSeconds -gt 05 } | stop-process\", 1)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 1, "last_activity_date": 1495782586, "creation_date": 1495782586, "answer_id": 44195686, "question_id": 44167647, "link": "https://stackoverflow.com/questions/44167647/terminating-all-explorer-instances-via-vba-excel/44195686#44195686", "title": "Terminating all explorer instances via VBA - Excel", "body": "<p>This problem is caused by way how IE is handling tabs. There is 1 main instance of IE and for each tab new process iexplore is created.\nTherefore when main host instance is closed also all tabs-related processes are closed.\nIt causes error in your code, because collection you are enumerating is a snapshot of state from earlier state and you are trying to close not existing anymore processes. This could be observed in TaskManager.</p>\n\n<p>Now answer how to improve your code (of course simple on error resume next would also help, but exiting after first closed instance could be not enough if user has more sessions opened):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim objWMI As Object, objProcess As Object, objProcesses As Object\n\n    Do\n        Set objWMI = GetObject(\"winmgmts://.\")\n        Set objProcesses = objWMI.ExecQuery(\"Select * FROM Win32_Process Where Name = 'iexplore.exe'\")\n\n        If objProcesses.Count &gt; 0 Then\n            For Each objProcess In objProcesses\n                objProcess.Terminate\n                Exit For\n            Next\n        End If\n    Loop While objProcesses.Count &gt; 0\n\n    Set objProcesses = Nothing\n    Set objWMI = Nothing\n\n    Unload WebForm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 935453, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c937977e010dd91ccbd11018c19e7e5d?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/935453/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1495782586, "creation_date": 1495656749, "question_id": 44167647, "link": "https://stackoverflow.com/questions/44167647/terminating-all-explorer-instances-via-vba-excel", "title": "Terminating all explorer instances via VBA - Excel", "body": "<pre><code>Private Sub CommandButton1_Click()\nDim objWMI As Object, objProcess As Object, objProcesses As Object\n\nSet objWMI = GetObject(\"winmgmts://.\")\nSet objProcesses = objWMI.ExecQuery(\"Select * FROM Win32_Process Where Name = 'iexplore.exe'\")\n\nFor Each objProcess In objProcesses\n    objProcess.Terminate\nNext\n\nSet objProcesses = Nothing\nSet objWMI = Nothing\n\nUnload WebForm\n\nEnd Sub    \n</code></pre>\n\n<p>Trying to use this as a way to close out all instances of Explorer before running some functions that retrieve data from web based servers, but am running into an issue when it attempts to close out an open browser with multiple tabs.  If the user has only one IE window (one tab) open, then it closes it just fine and moves on; if these user has multiple windows open separately (not tabbed in one window), then it closes them all just fine and moves on; but for some reason, if one window is open with multiple tabs, then I get run-time error '-2147217406 (80041002)': \"Not found\".  Any help working through this would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495659472, "post_id": 44167503, "comment_id": 75352677, "body": "Your code seems to be doing a lookup of the string <code>&quot;A10&quot;</code> within the single cell range <code>&#39;\\\\store\\GroupDrives\\Pricing\\_Deli_\\Deli Fresh Shift\\Margin Master\\[0306-0312 Margin Master.xlsx]Bakery&#39;!G10</code> and returning the 3rd column of that single cell.  That is going to give errors."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495660145, "post_id": 44167503, "comment_id": 75352989, "body": "Sorry, no, it won&#39;t be looking for the string <code>&quot;A10&quot;</code>, I guess it will be looking for the contents of a cell A10, but I have no idea what cell A10 it will look for - almost certainly not the one in the closed workbook because that would need to be passed as <code>&#39;\\\\store\\GroupDrives\\Pricing\\_Deli_\\Deli Fresh Shift\\Margin Master\\[0306-0312 Margin Master.xlsx]Bakery&#39;!R10C1</code>.  (Why don&#39;t you make life easier for yourself and open the other workbook, do whatever processing you need, then close it again?)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495661488, "post_id": 44167503, "comment_id": 75353594, "body": "Thanks Yow, I know, making my life easier would be nice.  But in the office here we sometimes have workbooks with tens of thousands of lines, I&#39;m trying to develop a solution that doesn&#39;t take 25 minutes to compile information from closed workbooks.  I have adopted the code I was originally attempting to adopt in a different way.  Do I get in trouble on here if I post it as a possible solution?  Well, I&#39;ll do it in case it interests you.  It works in it&#39;s own way, but I&#39;m still trying to adapt it.  Thanks for leaving the comments!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495663537, "post_id": 44167503, "comment_id": 75354337, "body": "Self-answers aren&#39;t necessarily bad, although it is best if they could be derived solely on the information in the question.  Your current question reflects two problems (1) the incorrect parameters being passed and (2) the lack of quotation marks around the string being searched for.  The first problem is just &quot;garbage in - garbage out&quot; and can&#39;t be fixed without being told what the correct parameters are, but the second problem is something that could be useful to other people.  ..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495663592, "post_id": 44167503, "comment_id": 75354356, "body": "I suggest you edit the question to show your updated code <b>without the     If IsNumeric(vVal) Then ... End If bits</b> and simply ask &quot;why doesn&#39;t this VLookup work&quot;.  Then your answer makes complete sense, and the question and answer are useful for other people with a similar problem.  (This is just MY opinion though - other people, including yourself, may disagree.)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "is_accepted": false, "score": 0, "last_activity_date": 1495661557, "creation_date": 1495661557, "answer_id": 44168811, "question_id": 44167503, "link": "https://stackoverflow.com/questions/44167503/run-time-error-1004-when-using-vlookup-with-executeexcel4macro/44168811#44168811", "title": "Run-Time Error 1004 When Using Vlookup with ExecuteExcel4Macro", "body": "<p>This is a possibility if it can be adopted:</p>\n\n<p>Function:</p>\n\n<pre><code>Public Function GetVlookup(path, file, sheet, ref, Col, vVal)\n'   Retrieves a value from a closed workbook\n    Dim arg As String\n\n'   Make sure the file exists\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetVlookup = \"File Not Found\"\n        Exit Function\n    End If\n\n    If IsNumeric(vVal) Then\n      vVal = CDbl(vVal)\n    Else\n      vVal = Chr(34) &amp; vVal &amp; Chr(34)\n    End If\n'   Create the argument\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _\n      Range(ref).Address(, , xlR1C1)\n'   Execute an XLM macro\n    GetVlookup = ExecuteExcel4Macro(\"Vlookup(\" &amp; vVal &amp; \",\" _\n     &amp; arg &amp; \",\" &amp; Col &amp; \",0)\")\nEnd Function\n</code></pre>\n\n<p>Subroutine:</p>\n\n<pre><code>Sub TestThingSub()\n    Dim Varr As Variant\n    Varr = GetVlookup(\"\\\\store\\GroupDrives\\Pricing\\_Deli_\\Deli Fresh Shift\\Margin Master\\\", \"0306-0312 Margin Master2.xlsx\", \"Sheet2\", \"A1:B26\", 2, \"HORSE\")\n    MsgBox Varr\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495661557, "creation_date": 1495656136, "last_edit_date": 1495658847, "question_id": 44167503, "link": "https://stackoverflow.com/questions/44167503/run-time-error-1004-when-using-vlookup-with-executeexcel4macro", "title": "Run-Time Error 1004 When Using Vlookup with ExecuteExcel4Macro", "body": "<p>How do you properly construct a VLOOKUP statement in Excel VBA when using the ExecuteExcel4Macro function in VBA?</p>\n\n<p>I have a function that successfully looks up a value in another excel workbook without opening it using ExecuteExcel4Macro, but when I attempt to change the statement to a VLOOKUP statement I get a Run-time error 1004:</p>\n\n<p>The function:</p>\n\n<pre><code>Public Function fGetValueTest(sFilePath, sFileName, sSourceSheet, sSourceCell, vVal, Col)\n'Returns the value of a cell from a closed file [BD]\n\n    'Declaring variables [BD]\n    Dim sStringMacro As String\n    Dim externalValue As Variant\n\n    'Setting variables [BD]\n    externalValue = ExecuteExcel4Macro(\"'\" &amp; sFilePath &amp; \"[\" &amp; sFileName &amp; \"]\" &amp; sSourceSheet &amp; \"'!\" &amp; _\n    Range(\"A1\").Range(sSourceCell).Address(, , xlR1C1))\n\n    'Exception error on file not found [BD]\n    If Dir(sFilePath &amp; sFileName) = \"\" Then\n        fGetValueTest = \"File Not Found!\"\n        Exit Function\n    End If\n\n    'If value of source cell is N/A [BD]:\n    If Application.IsNA(externalValue) Then\n        'Skip and move on [BD]\n        fGetValueTest = \"0\"\n    ElseIf IsError(externalValue) Then\n        MsgBox \"Error - Check fGetValue Function\"\n    Else\n        'Creating macro variable [BD]\n        sStringMacro = \"'\" &amp; sFilePath &amp; \"[\" &amp; sFileName &amp; \"]\" &amp; sSourceSheet &amp; \"'!\" &amp; _\n        Range(\"A1\").Range(sSourceCell).Address(, , xlR1C1)\n        fGetValueTest = ExecuteExcel4Macro(\"Vlookup(\" &amp; vVal &amp; \",\" &amp; sStringMacro &amp; \",\" &amp; Col &amp; \",0)\")\n\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And it's usage in the subroutine:</p>\n\n<pre><code>Sub TestGetValue()\n\n    Dim sFileName As String\n    Dim sFilePath As String\n    Dim sSourceSheet As String\n    Dim sSourceCell As String\n    Dim sDestinationCell As String\n    Dim sDestinationSheet As String\n    Dim vVal As String\n    Dim Col As String\n\n    sFileName = \"0306-0312 Margin Master.xlsx\"\n    sFilePath = \"\\\\store\\GroupDrives\\Pricing\\_Deli_\\Deli Fresh Shift\\Margin Master\\\"\n    sSourceSheet = \"Bakery\"\n    sDestinationSheet = \"TestSheet\"\n    sSourceCell = \"G10\"\n    sDestinationCell = \"G10\"\n    vVal = \"A10\"\n    Col = 3\n\n    ThisWorkbook.Worksheets(sDestinationSheet).Range(sDestinationCell) = fGetValueTest(sFilePath, sFileName, sSourceSheet, sSourceCell, vVal, Col)\n\nEnd Sub\n</code></pre>\n\n<p>I don't see any errors in how the VLOOKUP statement is constructed, does ExecuteExcel4Macro require a different type of statement or is there something else going on here?</p>\n\n<p>Any help would be greatly appreciated, and if anyone happens to know if there is a manual for ExecuteExcel4Macro or any documentation of any real value that would also be helpful!  </p>\n"}, {"tags": ["excel", "vba", "formula", "code-conversion"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1495654034, "post_id": 44166937, "comment_id": 75350090, "body": "There is no question here, and if the question is &quot;how do I convert this to vba?&quot; it is too broad for this forum.  This site is about helping overcome specific problems with existing code."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1495654147, "post_id": 44166937, "comment_id": 75350158, "body": "Show us what you already have in VBA.  Also tell us what problem you are running into in doing this.  Just showing us an Excel formula does not tell us anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1495654155, "post_id": 44166937, "comment_id": 75350161, "body": "<code>Application.Evaluate(yourFunctionHere)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495654712, "post_id": 44166937, "comment_id": 75350415, "body": "Note: <code>Application.Evaluate</code> can be golfed to <code>[yourFunctionHere]</code> square-bracketed expressions."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495656108, "post_id": 44166937, "comment_id": 75351081, "body": "@A.S.H - It does?  I&#39;ve only used them sparingly but don&#39;t recall any issues."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1495656306, "post_id": 44166937, "comment_id": 75351187, "body": "My tip is write a UDF in VBA which does what the array formula would do - taking the four parameters. Then if you wish to call this from some kind of worksheet event, just call the function from the Worksheet event Sub with the 4 parameters."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495658069, "post_id": 44166937, "comment_id": 75352022, "body": "Works both on the sheet and when evaluated from VBA for me..."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1495658078, "post_id": 44166937, "comment_id": 75352031, "body": "Odd A.S.H, I&#39;m not finding this behaviour... Evaluate works fine for me"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1499704795, "last_edit_date": 1499704795, "creation_date": 1495658260, "answer_id": 44168059, "question_id": 44166937, "link": "https://stackoverflow.com/questions/44166937/convert-excel-array-to-vba/44168059#44168059", "title": "Convert Excel Array to VBA", "body": "<p>Unlike some other array formulas, this one <em>does</em> work with <code>Application.Evaluate</code>, it only needs to \"double up\" the double-quotes inside.</p>\n\n<pre><code>Dim v\nv = Application.Evaluate(\"=IFERROR(MATCH(J2&amp;K2,A1:A4&amp;B1:B4,0), \"\"\"\")\")\nDebug.Print v\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8008226, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154565778872596/picture?type=large", "display_name": "censley", "link": "https://stackoverflow.com/users/8008226/censley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1507946021, "creation_date": 1495653889, "last_edit_date": 1507946021, "question_id": 44166937, "link": "https://stackoverflow.com/questions/44166937/convert-excel-array-to-vba", "title": "Convert Excel Array to VBA", "body": "<p>I'm trying to convert an excel array to VBA. Any help would be appreciated:</p>\n\n<pre><code>{=IFERROR((MATCH('Surgery'!D10&amp;'Surgery'!D11,'NCCI'!A1:A263469&amp;'NCCI'!B1:B263469,0)),\"\")}\n</code></pre>\n\n<p>The Surgery worksheet is where the user inputs a list of codes and the NCCI worksheet is where the above array searches to find a match. It uses the two codes entered by the user to search in two columns on the NCCI worksheet to try and find where two codes are in the same row and returns the row number.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495654251, "post_id": 44166891, "comment_id": 75350193, "body": "My advice would be to use the macro recorder to summarize the sheet or range after the above code has done it&#39;s job.  And then incorporate the recorded macro code into the above code to do it automatically each time."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495655333, "post_id": 44166891, "comment_id": 75350718, "body": "Thanks John. The recorder just shows the selection.copy, it doesn&#39;t use the category in I21:I44 to validate against what is copied. The 21 rows in range B21:AH44 contain data along with dollar amounts. When the macro is run, in this instance the 21 rows Total the dollars per category and paste in a separate worksheet. My 21 rows condenses to 3 based on the category and technically date of the order in this example."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495655441, "post_id": 44166891, "comment_id": 75350766, "body": "I should have referenced the original post for more information as well.  <a href=\"https://stackoverflow.com/questions/37555692/vba-to-copy-and-paste-based-on-filter/37555842?noredirect=1#comment75336221_37555842\" title=\"vba to copy and paste based on filter\">stackoverflow.com/questions/37555692/&hellip;</a>"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1495657051, "post_id": 44166891, "comment_id": 75351564, "body": "Just a general comment... <code>Sheets(&quot;NEW PO&quot;).Range(&quot;G21:G44&quot;) = Sheets(&quot;NEW PO&quot;).Range(&quot;I21:I44&quot;).Value2</code> will be a lot faster than the copy paste and accomplish the same thing."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "reply_to_user": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1495658551, "post_id": 44166891, "comment_id": 75352258, "body": "@MattD thank you, will update and test. Appreciate the input!"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1495711797, "post_id": 44166891, "comment_id": 75372884, "body": "Another thing, the line <code>Dim CatRng, MonthRng, SDate, CxlDate, PoNumb, Vendor, Description As Range</code> is actually initializing all but &quot;Description&quot; as variants.  When you put multiple declarations on the same line, each one has to have an <code>as (type)</code> e.g. <code>Dim CatRng As Range, MonthRng As Range, SDate As Range, ...</code>"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495712179, "post_id": 44166891, "comment_id": 75373111, "body": "Thanks Matt, I made that change as well, same result when the macro runs. I will upload the two worksheets, may make it easier to see what is going on."}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1495712951, "post_id": 44166891, "comment_id": 75373539, "body": "The result is the same because once you set them equal to a range, the variant becomes type Variant/Object/Range"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495714361, "post_id": 44179808, "comment_id": 75374498, "body": "Matt, I&#39;ve cut the workbook down to the necessary tabs and entered the necessary data on the NEW PO Tab. If you run the macro on the NEW PO tab called &quot;Copy Data to PO&quot; you will see how the &quot;order&quot; is consolidated. Currently I get no errors or type mismatch. <a href=\"https://www.dropbox.com/s/l2ikw6cr0rqzde8/Inventory%20Plan%20Sample.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/l2ikw6cr0rqzde8/&hellip;</a>"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495716306, "post_id": 44179808, "comment_id": 75375766, "body": "Unfortunately, just about all online cloud storage providers are blocked at work and my internet facing machine runs linux so I can&#39;t download or run your code.   Can you attach some screen shots?"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495716693, "post_id": 44179808, "comment_id": 75375990, "body": "I think you are not getting a type mismatch because the if statement is never true because you are looking at the .text property of cell.  On my test code I set Count = 2 and had the number 2 entered in Cell C22.  When stepping through the code, <code>If cell.Text = Count</code> evaluates to <code>If &quot;2&quot; = 2</code> which on my machine evaluates as False.  If I use cell.Value, it evaluates as true and then the <code>Dsc = Dsc + ...</code> line causes run-time error 13 (type mismatch)"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495716865, "post_id": 44179808, "comment_id": 75376092, "body": "Top step through your code, in the VBA editor, click somewhere in the Copy_Data() sub and press F8.  Keep pressing F8 to step through your code line-by-line. Highlight a variable or expression, then right click and &quot;Add Watch...&quot; to watch how the value changes as you step through the code."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495718669, "post_id": 44179808, "comment_id": 75377316, "body": "Just added screen captures of the NEW PO Tab, PO tab, and a PO tab after the macro runs. I will go through your other comments as well."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495719580, "post_id": 44179808, "comment_id": 75377972, "body": "when i step through the code I see the error message, as you pointed out. The resulting value that is copied shows as:       : Value2 : &quot;SS Ecotec Solid&quot; : Variant/String : Module6.Copy_Data"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495722921, "post_id": 44179808, "comment_id": 75380307, "body": "Just had a minute to look at your screenshot, C21:C44 are strings so they can&#39;t be summed (I probably misunderstood your original question). Are you looking to count them instead? Remove duplicates? Can you explain what you mean by &quot;summarize range C21:C44&quot;?"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495723702, "post_id": 44179808, "comment_id": 75380842, "body": "They should be counted with duplicates removed. In the screen capture the PO Tab with the macro ran, column H should have returned 4 results now rather than 3. SS Ecotec Solid, SS Ecotec Stripe, LS Ladies Windjacket, Peached Ecotec Layer. Column H used to point to the New PO tab Y16 which had the same information each time (It always said Solid Shirt for example). Now that I am attempting to change what information is pulled to the PO tab, the copy macro really has another level of validation that needs to occur (the data in C21:C44)"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495725049, "post_id": 44179808, "comment_id": 75381811, "body": "I&#39;ll try and update the answer with more info later today but to get you started, what I would do is read your source data in to an array (see <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ArraysAndRanges.aspx</a>) and then use code from this answer (<a href=\"https://stackoverflow.com/questions/3017852/vba-get-unique-values-from-array\" title=\"vba get unique values from array\">stackoverflow.com/questions/3017852/&hellip;</a>) to strip duplicates and refer back to the Chip Pearson article to write the array back to the new range."}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495732449, "post_id": 44179808, "comment_id": 75386197, "body": "Answer updated.  Hopefully that is more along the lines of what you are looking for."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495733862, "post_id": 44179808, "comment_id": 75386930, "body": "I&#39;m getting a Next without For compile error with the &quot;Next Count&quot; at the very end of the Sub. Any thoughts?"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495735619, "post_id": 44179808, "comment_id": 75387884, "body": "You probably have an extra Next floating around somewhere higher in the code. Count your number of For&#39;s and Next&#39;s to make sure they are the same."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495736678, "post_id": 44179808, "comment_id": 75388520, "body": "Ok no more error messages but the same result. Column H on the PO tab returns 3 rows of &quot;SS Ecotec Solid&quot;"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495737108, "post_id": 44179808, "comment_id": 75388785, "body": "So you want to read C21:C44 on &quot;New PO&quot; and dump that in Column H of the &quot;PO&quot; tab with duplicates removed?"}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495738430, "post_id": 44179808, "comment_id": 75389479, "body": "That is correct, however it needs to match the category coming from G21:G44 on the new PO tab. Its not exactly dumping unique values, its matching the category. In the screen capture of the New PO tab rows 21 through 25 would return 1 result with the description Ecotec Solid, category 1, quantity 30 and Total (dollars) $825.  Back to my original code, or your revised which works. It seems like the only thing missing is a way to match or compare the Dsc against the Catrng"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495739475, "post_id": 44179808, "comment_id": 75390006, "body": "What is in G21:G44?  It is hidden in the screen shot."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495739694, "post_id": 44179808, "comment_id": 75390134, "body": "Its exactly what is in I21:I44 but in text format so it can transfer to the PO tab correctly. The users of the document wanted to be able to type in the sub category so I made &quot;I&quot; the data entry where G is what is actually being copied."}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495740930, "post_id": 44179808, "comment_id": 75390784, "body": "I don&#39;t have time to go through Glitch_Doctor&#39;s code to see what&#39;s going on but if you&#39;re getting 3 rows of the same thing instead of 3 different rows, you might need to use <code>Application.Transpose</code> on <code>.Range(&quot;H&quot; &amp; PORow).Value =Dsc</code> -&gt;  <code>.Range(&quot;H&quot; &amp; PORow).Value =Application.Transpose(Dsc)</code>flip the Dsc array from horizontal to vertical."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495742051, "post_id": 44179808, "comment_id": 75391399, "body": "Thanks Matt. Good thought but still the same result. The code seems to only be capturing one value from the C21:C44 range regardless. Appreciate your input and assistance!"}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495742772, "post_id": 44179808, "comment_id": 75391745, "body": "Best advice I can give is setup a watch for every variable and expression of interest and just step through the code watching how everything changes to see where the code goes wrong.  Might also put a comment on <a href=\"https://stackoverflow.com/questions/37555692/vba-to-copy-and-paste-based-on-filter\" title=\"vba to copy and paste based on filter\">stackoverflow.com/questions/37555692/&hellip;</a> with a link to this question to tie the two together."}, {"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "edited": false, "score": 0, "creation_date": 1495744826, "post_id": 44179808, "comment_id": 75392782, "body": "Thanks Matt. Not a complete resolution yet but I set DSC as a string and changed the Catrng code to include <code>Dsc = Dsc + Sheets(&quot;NEW PO&quot;).Range(&quot;C&quot; &amp; Row).Value</code>. Returns multiple descriptions on the PO tab. Not &quot;consolidated&quot; yet but a closer result"}], "tags": [], "owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "is_accepted": false, "score": 1, "last_activity_date": 1495733422, "last_edit_date": 1495733422, "creation_date": 1495712772, "answer_id": 44179808, "question_id": 44166891, "link": "https://stackoverflow.com/questions/44166891/vba-copy-and-paste-to-new-sheet-based-on-validating-date/44179808#44179808", "title": "VBA Copy and Paste to new sheet based on validating date", "body": "<p>If you are looking to count unique values in C21:C44 per your earlier comment then the code examples here (<a href=\"https://stackoverflow.com/questions/1676068/count-unique-values-in-excel\">Count unique values in Excel</a>) should work for you.</p>\n\n<p>I tested this answer (<a href=\"https://stackoverflow.com/a/36083024/7612553\">https://stackoverflow.com/a/36083024/7612553</a>) and it works. I added <code>And cell.Value &lt;&gt; \"\"</code> so it would not count blank cells passed to the function.</p>\n\n<pre><code>Public Function CountUnique(rng As Range) As Long\n    Dim dict As Scripting.Dictionary\n    Dim cell As Range\n    Set dict = New Scripting.Dictionary\n    For Each cell In rng.Cells\n         If Not dict.Exists(cell.Value) And cell.Value &lt;&gt; \"\" Then\n            dict.Add cell.Value, 0\n        End If\n    Next\n    CountUnique = dict.Count\nEnd Function\n</code></pre>\n\n<p>Then you could replace the <code>For Each cell In Description</code> loop with a call to <code>CountUnique(Description)</code></p>\n\n<p>For the scripting dictionary to work, you need to add a reference to Microsoft Scripting Runtime: Tools > References... > check \"Microsoft Scripting Runtime\"</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "reply_to_user": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1495808085, "post_id": 44189728, "comment_id": 75420200, "body": "Thanks for the help Matt!"}], "tags": [], "owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "is_accepted": false, "score": 1, "last_activity_date": 1495745938, "creation_date": 1495745938, "answer_id": 44189728, "question_id": 44166891, "link": "https://stackoverflow.com/questions/44166891/vba-copy-and-paste-to-new-sheet-based-on-validating-date/44189728#44189728", "title": "VBA Copy and Paste to new sheet based on validating date", "body": "<p>I believe this solved the question. Converted Dsc to a string and incorporated it into the Catrng array. The missing link was <code>Dsc=\"\"</code> to reset the value each time the array returned</p>\n\n<pre><code>Sub Copy_Data()\n\nDim Count As Long\nDim Qty As Long\nDim CatRng As Range\nDim MonthRng As Range\nDim SDate As Range\nDim CxlDate As Range\nDim PoNumb As Range\nDim Vendor As Range\nDim Description As Range\nDim Total As Currency\nDim StrTarget As String\nDim Dsc As String\nDim Row As Integer\nDim PORow As Integer\nDim Col As Integer\n\n\n    With Sheets(\"NEW PO\").Range(\"I21:I44\").Copy\n    End With\n    With Sheets(\"NEW PO\").Range(\"G21:G44\")\n    .PasteSpecial xlPasteValues, , False, False\n    End With\n    Range(\"A1\").Select\n   Application.CutCopyMode = False\n\nSet CatRng = Sheets(\"NEW PO\").Range(\"G21:G44\")\nSet MonthRng = Sheets(\"POs\").Range(\"M122:X122\")\nStrTarget = Sheets(\"New PO\").Range(\"W12\")\nSet SDate = Sheets(\"New PO\").Range(\"U12\")\nSet CxlDate = Sheets(\"New PO\").Range(\"U13\")\nSet PoNumb = Sheets(\"New PO\").Range(\"N10\")\nSet Vendor = Sheets(\"New PO\").Range(\"D14\")\nSet Description = Sheets(\"New PO\").Range(\"C21:C44\")\n\nCount = 0\n\n\nFor Count = 0 To 99\n\nTotal = 0\nQty = 0\nDsc = \"\"\n'So that the values reset each time the cat changes\n\n        For Each cell In CatRng\n        'To get the row number then total the required information\n            If cell.Value = Count Then\n            Row = cell.Row\n            Qty = Qty + Sheets(\"NEW PO\").Range(\"T\" &amp; Row).Value\n            Total = Total + Sheets(\"NEW PO\").Range(\"AA\" &amp; Row).Value\n            Dsc = Sheets(\"NEW PO\").Range(\"C\" &amp; Row).Value\n            'I guessed ext cost only as it has been totaled at the bottom,\n            'this is easily changed though\n            End If\n        Next cell\n\n\n\n    'Now put the totals into a PO only if there is a quantity of items\n    If Qty &gt; 0 Then\n    PORow = Sheets(\"POs\").Range(\"L1048576\").End(xlUp).Row + 1\n\n    'I'll let you sort the PO number and other fields out but the main 3 are done below\n    With Sheets(\"POs\")\n        .Range(\"I\" &amp; PORow).Value = Qty\n        .Range(\"L\" &amp; PORow).Value = Count\n        .Range(\"C\" &amp; PORow).Value = SDate\n        .Range(\"D\" &amp; PORow).Value = CxlDate\n        .Range(\"B\" &amp; PORow).Value = PoNumb\n        .Range(\"F\" &amp; PORow).Value = Vendor\n        .Range(\"H\" &amp; PORow).Value = Dsc\n        'My understanding here is that the target month in U12 is in the same format as\n        'the anticipated Receipt month, I hope this is what you were looking for\n\n     For Each cell In MonthRng\n            If cell.Value = StrTarget Then\n            Col = cell.Column\n            .Cells(PORow, Col).Value = Total\n            'Used .cells here as both column and row are now integers\n            '(only way i can ever get it to work)\n        End If\n\n      Next cell\n\n    End With\n    End If\n\nNext Count\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6406591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/959778635fa6deb7df8bf3a5ea74fff7?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/6406591/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495745938, "creation_date": 1495653721, "last_edit_date": 1495718622, "question_id": 44166891, "link": "https://stackoverflow.com/questions/44166891/vba-copy-and-paste-to-new-sheet-based-on-validating-date", "title": "VBA Copy and Paste to new sheet based on validating date", "body": "<p>I am trying to modify the VBA @Glitch_Doctor worked with me on. The \"Description\" range has changed on the New PO tab and needs to summarize in text form on the PO tab. I have all working currently it copies text to the appropriate column and row but does not summarize what is in the range C21:C44. Appreciate anyone's help getting the new data to summarize based on category and date, which it is not currently doing. </p>\n\n<p>This is the new items added to the code:</p>\n\n<pre><code>Dim Dsc As Variant\nDsc = Sheets(\"New PO\").Range(\"C21:C44\")\n\nFor Each cell In Description\n    'To get the row number then total the required information\n        If cell.Text = Count Then\n        Row = cell.Row\n        Dsc = Dsc + Sheets(\"NEW PO\").Range(\"C21:C44\" &amp; Row).Text\n        End If\n    Next cell\n</code></pre>\n\n<p>This is the full VBA:</p>\n\n<pre><code>Sub Copy_Data()\n\nDim Count, Qty As Long\nDim CatRng, MonthRng, SDate, CxlDate, PoNumb, Vendor, Description As Range\nDim Total As Currency\nDim StrTarget As String\nDim Dsc As Variant\nDim Row, PORow, Col As Integer\n\n\n    With Sheets(\"NEW PO\").Range(\"I21:I44\").Copy\n    End With\n    With Sheets(\"NEW PO\").Range(\"G21:G44\")\n    .PasteSpecial xlPasteValues, , False, False\n    End With\n    Range(\"A1\").Select\n   Application.CutCopyMode = False\n\nSet CatRng = Sheets(\"NEW PO\").Range(\"G21:G44\")\nSet MonthRng = Sheets(\"POs\").Range(\"M122:X122\")\nStrTarget = Sheets(\"New PO\").Range(\"W12\")\nSet SDate = Sheets(\"New PO\").Range(\"U12\")\nSet CxlDate = Sheets(\"New PO\").Range(\"U13\")\nSet PoNumb = Sheets(\"New PO\").Range(\"N10\")\nSet Vendor = Sheets(\"New PO\").Range(\"D14\")\nSet Description = Sheets(\"New PO\").Range(\"C21:C44\")\nDsc = Sheets(\"New PO\").Range(\"C21:C44\")\nCount = 0\n\n\nFor Count = 0 To 99\n\nTotal = 0\nQty = 0\n'So that the values reset each time the cat changes\n\n        For Each cell In CatRng\n        'To get the row number then total the required information\n            If cell.Value = Count Then\n            Row = cell.Row\n            Qty = Qty + Sheets(\"NEW PO\").Range(\"T\" &amp; Row).Value\n            Total = Total + Sheets(\"NEW PO\").Range(\"AA\" &amp; Row).Value\n            'I guessed ext cost only as it has been totaled at the bottom,\n            'this is easily changed though\n            End If\n        Next cell\n\n         For Each cell In Description\n        'To get the row number then total the required information\n            If cell.Text = Count Then\n            Row = cell.Row\n            Dsc = Dsc + Sheets(\"NEW PO\").Range(\"C21:C44\" &amp; Row).Text\n            End If\n        Next cell\n\n\n    'Now put the totals into a PO only if there is a quantity of items\n    If Qty &gt; 0 Then\n    PORow = Sheets(\"POs\").Range(\"L1048576\").End(xlUp).Row + 1\n\n    'I'll let you sort the PO number and other fields out but the main 3 are done below\n    With Sheets(\"POs\")\n        .Range(\"I\" &amp; PORow).Value = Qty\n        .Range(\"L\" &amp; PORow).Value = Count\n        .Range(\"C\" &amp; PORow).Value = SDate\n        .Range(\"D\" &amp; PORow).Value = CxlDate\n        .Range(\"B\" &amp; PORow).Value = PoNumb\n        .Range(\"F\" &amp; PORow).Value = Vendor\n        .Range(\"H\" &amp; PORow).Value = Dsc\n        'My understanding here is that the target month in U12 is in the same format as\n        'the anticipated Receipt month, I hope this is what you were looking for\n\n     For Each cell In MonthRng\n            If cell.Value = StrTarget Then\n            Col = cell.Column\n            .Cells(PORow, Col).Value = Total\n            'Used .cells here as both column and row are now integers\n            '(only way i can ever get it to work)\n        End If\n\n      Next cell\n\n    End With\n    End If\n\nNext Count\n\nEnd Sub\n</code></pre>\n\n<p>Link to the working file: <a href=\"https://www.dropbox.com/s/l2ikw6cr0rqzde8/Inventory%20Plan%20Sample.xlsm?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/l2ikw6cr0rqzde8/Inventory%20Plan%20Sample.xlsm?dl=0</a></p>\n\n<p>Screen Capture with New PO tab, PO Tab, PO tab after macro runs\n<a href=\"https://i.stack.imgur.com/7jbpG.png\" rel=\"nofollow noreferrer\">Screen Capture of Tabs</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1495658431, "post_id": 44166792, "comment_id": 75352189, "body": "You&#39;re still leaving lots of unreferenced objects. In <code>CreateBarPivot</code> there&#39;s  <code>BPivot.Chart.SetSourceData Source:=Range(&quot;$A$1:$C$18&quot;), PlotBy:=xlRows</code>. What worksheet is the <code>Range</code> referring to? Why is A1:C18 hard-coded (should it be the same as <code>PRange</code>)? Same questions for your <code>CreatePiePivot</code> sub. You only have to use <code>ActiveWorkbook.ShowPivotTableFieldList</code> once, since it&#39;s for the whole workbook -- but you should use <code>myWB.ShowPivotTableFieldList</code> instead. Anytime you use <code>Range</code>, <code>Sheets</code>, <code>Cells</code> you should put a reference in front of it."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495719320, "post_id": 44166792, "comment_id": 75377780, "body": "Thanks for the continued help on this, PeterT. I thought I had changed the source data to include a sheet, but it looks like I&#39;ve missed it. Since it is a pivot chart using data from a pivot table, should the line be <code>PPivot.Chart.SetSourceData Source:=PTable, PlotBy:=xlRows</code>?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495726441, "post_id": 44166792, "comment_id": 75382716, "body": "When you look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841196.aspx\" rel=\"nofollow noreferrer\"><code>SetSourceData</code> method documentation</a>, you&#39;ll see that it expects a <code>Range</code> for the <code>Source:=</code> parameter. (I honestly thought it was expecting a <code>PivotCache</code>, but no.) So use a sheet-referenced range or a range object variable with the correct area set."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495726583, "post_id": 44166792, "comment_id": 75382827, "body": "Thanks Peter. I actually set it to the range set for the table location and it seems to work. I&#39;ve posted an additional question that seems related here: <a href=\"https://stackoverflow.com/questions/44184383/vba-method-location-of-object-chart-failed-two-pivotcharts?noredirect=1&amp;lq=1\" title=\"vba method location of object chart failed two pivotcharts\">stackoverflow.com/questions/44184383/&hellip;</a> Since your original answer was correct, and it was just my ineptitude that&#39;s caused the drawn out fix, I&#39;ll mark the original question as answered."}], "answers": [{"tags": [], "owner": {"reputation": 238, "user_id": 9757930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEVLxGzjnsE/AAAAAAAAAAI/AAAAAAAADnU/vRuIvzLpAJU/photo.jpg?sz=128", "display_name": "mer_curius", "link": "https://stackoverflow.com/users/9757930/mer-curius"}, "is_accepted": false, "score": 0, "last_activity_date": 1528120937, "creation_date": 1528120937, "answer_id": 50682426, "question_id": 44166792, "link": "https://stackoverflow.com/questions/44166792/vba-method-setsourcedata-of-object-chart-failed-for-multiple-pivot-charts/50682426#50682426", "title": "VBA: Method &#39;SetSourceData&#39; of object &#39;_Chart&#39; failed For Multiple Pivot Charts", "body": "<p>I had this problem too, on the Excel 2016 64 bit build.  Solved it using the technique above to create a shape object, instead of a chart object:</p>\n\n<pre><code>Dim PChart as shape\nSet PChart  = PSheet.Shapes.AddChart\n    With PChart.Chart\n        .ChartType = xl3DColumn\n        .SetSourceData Source:=p.TableRange1, PlotBy:=xlRows\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10764316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783368a843eba0565285df04941a5945?s=128&d=identicon&r=PG&f=1", "display_name": "Wererty", "link": "https://stackoverflow.com/users/10764316/wererty"}, "is_accepted": false, "score": 0, "last_activity_date": 1583937356, "creation_date": 1583937356, "answer_id": 60638522, "question_id": 44166792, "link": "https://stackoverflow.com/questions/44166792/vba-method-setsourcedata-of-object-chart-failed-for-multiple-pivot-charts/60638522#60638522", "title": "VBA: Method &#39;SetSourceData&#39; of object &#39;_Chart&#39; failed For Multiple Pivot Charts", "body": "<p>I had similar problem. I solved it by setting to nothing variables holding pivotcache and previously used pivottables (before adding second chart).</p>\n"}], "owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1610, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1583937356, "creation_date": 1495653321, "question_id": 44166792, "link": "https://stackoverflow.com/questions/44166792/vba-method-setsourcedata-of-object-chart-failed-for-multiple-pivot-charts", "title": "VBA: Method &#39;SetSourceData&#39; of object &#39;_Chart&#39; failed For Multiple Pivot Charts", "body": "<p>This is part 2 of the previous question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44160540/vba-runtime-error-setsourcedata-for-second-pivot-chart\">VBA: Runtime Error - SetSourceData for Second Pivot Chart</a></p>\n\n<p>After following the (good) advice offered in that thread, I am still having the same problem. The title error is still showing after the second chart attempts to SetSourceData. If I add an On Error Resume Next, then the data gets wonky and unreliable. I'm starting to think it's a problem with the PivotCache, but I've attempted to differentiate the caches with different variable names. This did not solve the issue. Below is the code in it's entirety with some titles/names redacted:</p>\n\n<pre><code>Option Explicit\n\nSub CreatePivots()\n\nCall CreateBarPivot\nCall CreatePiePivot\n\nEnd Sub\nSub CreateBarPivot()\n\nDim myWB As Workbook\nDim PSheet, DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\nDim ChartWidth As Range\nDim BPivot As Shape\n\n'Define Workbook\nSet myWB = ThisWorkbook\n\n'Define worksheets\nSet PSheet = myWB.Sheets(\"Tools\")\nSet DSheet = myWB.Sheets(\"Aggregate\")\n\n'Define last data points\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Selects first to last filled row, and first to last filled column for data\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Create pivot cache\nSet PCache = myWB.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=PRange)\n\n'Create pivot table\nSet PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Range(\"A1\"), _\n        TableName:=\"ExcPT\")\n\n'Create pivot chart\nSet BPivot = PSheet.Shapes.AddChart\n    BPivot.Chart.SetSourceData Source:=Range(\"$A$1:$C$18\"), PlotBy:=xlRows\n    BPivot.Chart.ChartType = xlColumnStacked\n\nActiveWorkbook.ShowPivotTableFieldList = False\n\nWith BPivot.Chart.PivotLayout.PivotTable.PivotFields(\"redacted\")\n    .Orientation = xlPageField\n    .Position = 1\nEnd With\n\nWith BPivot.Chart.PivotLayout.PivotTable.PivotFields(\"redacted\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\n\nWith BPivot.Chart.PivotLayout.PivotTable.PivotFields(\"redacted\")\n    .Orientation = xlRowField\n   .Position = 1\nEnd With\n\nWith BPivot.Chart.PivotLayout.PivotTable.PivotFields(\"redacted\")\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\n\n'Insert Data\nWith PSheet.PivotTables(\"ExcPT\").PivotFields(\"Exception\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Caption = \"Exception Status Count\"\n    .Function = xlCount\nEnd With\n\n'Hide Not Due\nWith BPivot.Chart.PivotLayout.PivotTable.PivotFields(\"Exception Status\")\n    .PivotItems(\"Not due\").Visible = False\nEnd With\n\n'Move bar chart to Dashboard; resize\nSet ChartWidth = Sheets(\"Dashboard\").Range(\"B2:L25\")\nWith BPivot.Chart.Parent\n    .Height = ChartWidth.Height\n    .Width = ChartWidth.Width\n    .Top = ChartWidth.Top\n    .Left = ChartWidth.Left\nEnd With\n\nBPivot.Chart.ChartArea.Select\nBPivot.Chart.Location Where:=xlLocationAsObject, Name:=\"Dashboard\"\n\n\nEnd Sub\n\nSub CreatePiePivot()\n\nDim myWB As Workbook\nDim PSheet, DSheet As Worksheet\nDim PCache1 As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\nDim ChartWidth As Range\nDim PPivot As Shape\n\n'Define Workbook\nSet myWB = ThisWorkbook\n\n'Define worksheets\nSet PSheet = myWB.Sheets(\"Tools\")\nSet DSheet = myWB.Sheets(\"Aggregate\")\n\n'Define last data points\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Selects first to last filled row, and first to last filled column for data\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Create pivot cache\nSet PCache1 = myWB.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=PRange)\n\n'Create pivot table\nSet PTable = PCache1.CreatePivotTable _\n    (TableDestination:=PSheet.Range(\"F1\"), _\n        TableName:=\"ExcPT1\")\n\n'Create pivot chart\nSet PPivot = PSheet.Shapes.AddChart\n    PPivot.Chart.SetSourceData Source:=Range(\"$F$1:$H$18\"), PlotBy:=xlRows\n    PPivot.Chart.ChartType = xlPie\n\nActiveWorkbook.ShowPivotTableFieldList = False\n\n'Insert row\nWith PPivot.Chart.PivotLayout.PivotTable.PivotFields(\"Exception\")\n    .Orientation = xlRowField\n   .Position = 1\nEnd With\n\n'Insert Data\nWith PSheet.PivotTables(\"ExcPT1\").PivotFields(\"Exception\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Caption = \"Exception Status Count\"\n    .Function = xlCount\nEnd With\n\n'Hide Not Due\nWith PPivot.Chart.PivotLayout.PivotTable.PivotFields(\"Exception Status\")\n    .PivotItems(\"Not due\").Visible = False\nEnd With\n\n'Move pie chart to Dashboard; resize\nSet ChartWidth = Sheets(\"Dashboard\").Range(\"B26:L49\")\nWith PPivot.Chart.Parent\n    .Height = ChartWidth.Height\n    .Width = ChartWidth.Width\n    .Top = ChartWidth.Top\n    .Left = ChartWidth.Left\nEnd With\n\nPPivot.Chart.ChartArea.Select\nPPivot.Chart.Location Where:=xlLocationAsObject, Name:=\"Dashboard\"\n\nWith ActiveChart\n    .HasTitle = False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powershell", "vba"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1495653067, "post_id": 44166687, "comment_id": 75349597, "body": "What have you tried so far?  Did you import the csv file into Excel?  What code have you tied?"}, {"owner": {"reputation": 11, "user_id": 8046116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b2468e6ee2b3c14be62b7a3dbc6d675?s=128&d=identicon&r=PG&f=1", "display_name": "redwing88", "link": "https://stackoverflow.com/users/8046116/redwing88"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495653713, "post_id": 44166687, "comment_id": 75349926, "body": "Yes, I can make it work in excel but need to make it work in powershell as our suppliers are submitting us purchase orders per day in csv format. It would be very beneficial to have a script that can add up the quantities of the products in bulk for our packaging."}, {"owner": {"reputation": 8928, "user_id": 6788803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNRMz.png?s=128&g=1", "display_name": "BenH", "link": "https://stackoverflow.com/users/6788803/benh"}, "edited": false, "score": 1, "creation_date": 1495654156, "post_id": 44166687, "comment_id": 75350163, "body": "Please add your code by editing your question, so that is properly formatted"}, {"owner": {"reputation": 11, "user_id": 8046116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b2468e6ee2b3c14be62b7a3dbc6d675?s=128&d=identicon&r=PG&f=1", "display_name": "redwing88", "link": "https://stackoverflow.com/users/8046116/redwing88"}, "edited": false, "score": 0, "creation_date": 1495654306, "post_id": 44166687, "comment_id": 75350222, "body": "Thanks Ben, I&#39;ve added the code to the question."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495654830, "post_id": 44166687, "comment_id": 75350474, "body": "A .csv file is just a comma delimited ascii text file.  By the data above I assume it is two pieces of data per row in the csv file.  Can you edit your question to show the first few lines of one of the csv files?  Make sure the top line is present."}, {"owner": {"reputation": 11, "user_id": 8046116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b2468e6ee2b3c14be62b7a3dbc6d675?s=128&d=identicon&r=PG&f=1", "display_name": "redwing88", "link": "https://stackoverflow.com/users/8046116/redwing88"}, "edited": false, "score": 0, "creation_date": 1495655158, "post_id": 44166687, "comment_id": 75350644, "body": "Yes John, you&#39;re correct there are two pieces of data per row seperated by columns. I&#39;ve edited the question to show the sample from the csv file."}], "answers": [{"tags": [], "owner": {"reputation": 8928, "user_id": 6788803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNRMz.png?s=128&g=1", "display_name": "BenH", "link": "https://stackoverflow.com/users/6788803/benh"}, "is_accepted": false, "score": 1, "last_activity_date": 1495655906, "last_edit_date": 1495655906, "creation_date": 1495654649, "answer_id": 44167124, "question_id": 44166687, "link": "https://stackoverflow.com/questions/44166687/finding-and-adding-data-in-excel-via-powershell/44167124#44167124", "title": "Finding and adding data in Excel via Powershell", "body": "<p>Rather than using Excel as a COM Object you could use <code>Import-CSV</code> and then <code>Group-Object</code>. Then loop through the groups for the information you need.</p>\n\n<pre><code>Add-Type -AssemblyName System.Windows.Forms \n$FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property @{\n    Multiselect = $false # Multiple files can be chosen \n    Filter = 'Excel (.csv, *.xlxs)|.csv;*.xlsx' # Specified file types \n} \n[void]$FileBrowser.ShowDialog() \nForEach ($file in $FileBrowser.FileNames) {\n    $CSV = Import-CSV $file | Add-Member -Name Total -Value 0 -MemberType NoteProperty\n    $Groups = $CSV | Group-Object \"Product/Item Description\"\n    $NewCSV = Foreach ($Group in $Groups) {\n        $Count = 0\n        $Group.Group.\"Qty Ordered\" | ForEach-Object {$Count += $_}\n        Foreach ($value in $CSV) {\n            If ($value.\"Product/Item Description\" -eq $Group.Name) {\n                 $value.Total = $Count\n                 $value\n            }\n        }\n    }\n    Export-CSV \"$filenew\" -NoTypeInformation\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8046116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b2468e6ee2b3c14be62b7a3dbc6d675?s=128&d=identicon&r=PG&f=1", "display_name": "redwing88", "link": "https://stackoverflow.com/users/8046116/redwing88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495659757, "creation_date": 1495652904, "last_edit_date": 1531164843, "question_id": 44166687, "link": "https://stackoverflow.com/questions/44166687/finding-and-adding-data-in-excel-via-powershell", "title": "Finding and adding data in Excel via Powershell", "body": "<p>I have a CSV file that has similar products within it and quantities of each product beside it.</p>\n\n<p>Sample from CSV file</p>\n\n<pre><code>Qty Ordered         Product/Item Description    Top row (header)\n   7                Product1\n   3                Product2\n   5                Product1\n   3                Product3\n</code></pre>\n\n<p>I need a method to find all the similar product#s, add up their Quantities, and place the total of each similar product in a new row.</p>\n\n<pre><code>Add-Type -AssemblyName System.Windows.Forms\n$FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property \n@{\nMultiselect = $false # Multiple files can be chosen\nFilter = 'Excel (*.csv, *.xlxs)|*.csv;*.xlsx' # Specified file types\n}\n\n[void]$FileBrowser.ShowDialog()\n\n$file = $FileBrowser.FileNames;\n\n\n\n\n[Reflection.Assembly]::LoadWithPartialName\n(\"Microsoft.Office.Interop.Excel\")|Out-Null\n$excel = New-Object Microsoft.Office.Interop.Excel.ApplicationClass\n$excel.Visible = $true \n$wb = $excel.Workbooks.Open($file)\n$ws = $wb.ActiveSheet\n$c = $ws.Columns\n$c.Item(2).hidden = $true\n</code></pre>\n\n<p>This code, asks the user to select the csv file, hides useless columns and auto-sizes the important columns as well.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1495653335, "post_id": 44166644, "comment_id": 75349734, "body": "Do you have 3 worksheets? Do you maybe mean <code>set wbR = wb.Worksheets(&quot;Sheet3&quot;)</code>?  Also, while debugging, keep the <code>ScreenUpdating</code> ON...then step through the code with <code>F8</code> and see if your <code>wb</code> workbook actually opens."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1495653380, "post_id": 44166644, "comment_id": 75349753, "body": "Try something like <code>If Not wb is Nothing Then Set wbR = wb.Worksheets(3)</code> This will prevent it from trying to operate on wb if it isn&#39;t set. This will then confirm or deny that this is the source of the issue."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495653563, "post_id": 44166644, "comment_id": 75349854, "body": "I don&#39;t get an error with your code.  Make sure both workbooks have 3 worksheets in them.  Brandon is correct about being safe when setting workbooks, but since it worked fine on my machine I think that may not be the issue."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1495653741, "post_id": 44166644, "comment_id": 75349935, "body": "Agreed. It is most likely that the workbook being opened doesn&#39;t have three sheets in the Worksheets collection. This could be confirmed with something like <code>Debug.print wb.Worksheets.Count</code>"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495653874, "post_id": 44166644, "comment_id": 75350003, "body": "Hmmmm.  I tried deleting one of the sheets on the opened WB and got an error 9, not 91.  91 is &quot;object not set&quot; while 9 is &quot;Subscript Out of Range.&quot;  So it may be that wb is in deed not set....  I can only say when both WBs have 3 sheets then it works fine for me."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495654072, "post_id": 44166644, "comment_id": 75350118, "body": "@JohnMuggins That makes sense. It should give a subscript error if you are trying to use an index that is outside of the existing indices. Object variable not set should generally occur when the referenced object is &#39;Nothing&#39;."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1495654385, "post_id": 44166644, "comment_id": 75350257, "body": "@MTJ, put a pause line on the line throwing the error.  The program will stop before it executes that line.  Hold your cursor over the &quot;wb&quot; and see  if the little textbox says that it equals nothing."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495657285, "post_id": 44166644, "comment_id": 75351673, "body": "@JohnMuggins Both workbooks have more than eight sheets. I removed the <code>Application.ScreenUpdating = False</code> as BruceWayne said and stepped through the code, and the workbook did not open. When holding my cursor over the <code>wb</code> it shows <code>wb = Nothing</code>. Issue seems to be with opening <code>myFile</code>."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495657689, "post_id": 44166644, "comment_id": 75351868, "body": "OK.  Debugging is pretty easy.  Now put the pause at the very first executable line, which is &quot;Set wsL = ThisWorkbook.Worksheets(3)&quot;.  After this you can run each line one at a time until you see where it doesn&#39;t work by pressing PF8.  After each line executes, hold your cursor over each variable to see if it was set correctly.  A little box should pop up over each variable showing its value when you hover over it.  Keep pressing PF8 until you find the line that is not working."}, {"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495659885, "post_id": 44166644, "comment_id": 75352888, "body": "@JohnMuggins Whoops, wasn&#39;t clear in my last comment. What I meant when saying I was holding my cursor over the <code>wb</code>, was that the line <code>Set wb = Workbooks.Open(myFile)</code> doesn&#39;t appear to be working properly. This has me quite confused because <code>myFile</code> is the path and file (checks out when stepping through each line). Also discovered <code>Set wsL = ThisWorkbook.Worksheets(3)</code> returns <code>wsL = Nothing</code>, but that&#39;s a different issue."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "edited": false, "score": 0, "creation_date": 1495728762, "post_id": 44181126, "comment_id": 75384121, "body": "I actually determined the source of the error was the line <code>Set wb = Workbooks.Open(myFile)</code>. I <a href=\"https://stackoverflow.com/questions/44169301/vba-workbook-openfile-returns-nothing?noredirect=1#comment75355972_44169301\">posted another question</a> because I still can&#39;t get the thing to run. <code>.Open(myFile)</code> doesn&#39;t seem to be working, even if I use the string of the path &amp; file instead of <code>myFile</code>."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495716852, "creation_date": 1495716852, "answer_id": 44181126, "question_id": 44166644, "link": "https://stackoverflow.com/questions/44166644/vba-error-91-cannot-find-source-of-error/44181126#44181126", "title": "VBA error &#39;91&#39; - cannot find source of error", "body": "<p>Sorry, I have to use the answer box to do this because there is code involved.  But No, you're doing fine.  This is how debugging works.  Now that we know which lines are not working we will try to find out why.  Now try to change </p>\n\n<pre><code>wsL = ThisWorkbook.Worksheets(3) \n</code></pre>\n\n<p>to </p>\n\n<pre><code>wsL = ThisWorkbook.Worksheets(1) \n</code></pre>\n\n<p>or </p>\n\n<pre><code>wsL = ThisWorkbook.Worksheets(\"PUTnameOFsheetHere\") \n</code></pre>\n\n<p>to see if it sets or not.  If so then we know there is some kind of problem with WorkSheets(3).  </p>\n\n<p>Now we'll try to find why \"Set wb = Workbooks.Open(myFile)\" is not working.  Tunr on your macro recording.  Got to \"File\" on the menu and select \"Open.\"  The dialog box will open.  Search for your file in the dialog box and open it.  Go back to your original workbook and stop recording.  Find the recorded macro and you will see the exact line That Excel used to open the file.  It should be something like:</p>\n\n<pre><code>Workbooks.Open Filename:=\"C:\\Files\\CNC TEST.xlsx\"\n</code></pre>\n\n<p>Now run your script with PF8 and hover over \"myFile\" after it is initialized.  Does it's value match the path and filename of the recorded macro file?</p>\n"}], "owner": {"reputation": 79, "user_id": 8037946, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ff86f03e7afa476f04e28f813c38b9e?s=128&d=identicon&r=PG&f=1", "display_name": "MTJ", "link": "https://stackoverflow.com/users/8037946/mtj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495716852, "creation_date": 1495652776, "question_id": 44166644, "link": "https://stackoverflow.com/questions/44166644/vba-error-91-cannot-find-source-of-error", "title": "VBA error &#39;91&#39; - cannot find source of error", "body": "<p>I'm trying to open a file to access information in the third worksheet. The <code>.FileDialog</code> works fine and I can select a file, but I keep getting <code>run-time error '91'</code> because of the line <code>Set wbR = wb.Worksheets(3)</code> near the bottom of this section of code because <code>wb.Worksheets(3) = &lt;Object variable or With block variable not set&gt;</code>. This leads me to believe my <code>Set wb = Workbooks.Open(myFile)</code> does not work and returns <code>Nothing</code>, but after looking through how other people have opened files using <code>.FileDialog</code>, I can't see how mine is different and wouldn't function. Any help or advice would be much appreciated.</p>\n\n<pre><code>'Set variables\nDim wb As Workbook 'Workbook to open\nDim wbR As Worksheet 'This is the raw data on the new workbook\nDim wsL As Worksheet 'Worksheet in current file\nDim myFile As String 'File to open\nDim FilePicker As FileDialog\n\n'Set light chain hit worksheet\nSet wsL = ThisWorkbook.Worksheets(3)\n\n'Optimizes Speed\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n'Retrieve target file\nSet FilePicker = Application.FileDialog(msoFileDialogFilePicker)\n\n'Opens folder-picking window\nWith FilePicker\n    .Title = \"Select a file.\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myFile = Dir(.SelectedItems(1))\nEnd With\n\n'If folder is not selected\nNextCode:\n    myFile = myFile\n    If myFile = \"\" Then GoTo ResetSettings\n\n'Set variable equal to opened workbook\nSet wb = Workbooks.Open(myFile)\n'Ensure Workbook has opened before moving on to next line of code\nDoEvents\n'Sets worksheet for importing\nSet wbR = wb.Worksheets(3)\n</code></pre>\n\n<p>*the macro continues past this last line but it doesn't get to it yet because of this error</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1495699116, "post_id": 44166319, "comment_id": 75365415, "body": "When you manually insert it are you inserting in the exact same place? When you insert it from your code is it being inserted into a paragraph where the font is hidden?"}, {"owner": {"reputation": 172, "user_id": 4852830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6721fc4a32bd443906aa70a066c9ae47?s=128&d=identicon&r=PG&f=1", "display_name": "CDO", "link": "https://stackoverflow.com/users/4852830/cdo"}, "reply_to_user": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1495718289, "post_id": 44166319, "comment_id": 75377065, "body": "The shape was being inserted into a table cell that had hidden font. After fixing this it now prints. If you want to write up an answer, I&#39;ll except it."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1495729380, "post_id": 44166319, "comment_id": 75384464, "body": "Thank you, answer duly written up!"}], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1495729006, "creation_date": 1495729006, "answer_id": 44185220, "question_id": 44166319, "link": "https://stackoverflow.com/questions/44166319/vba-inserted-building-block-not-printing/44185220#44185220", "title": "VBA inserted building block not printing", "body": "<p>If the shape disappears in print preview it is probably because in the Font settings for the paragraph where the shape is anchored the Hidden property is set.</p>\n\n<p>This would also explain why you can't replicate the issue in a different document.</p>\n"}], "owner": {"reputation": 172, "user_id": 4852830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6721fc4a32bd443906aa70a066c9ae47?s=128&d=identicon&r=PG&f=1", "display_name": "CDO", "link": "https://stackoverflow.com/users/4852830/cdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44185220, "answer_count": 1, "score": 0, "last_activity_date": 1495729006, "creation_date": 1495651519, "last_edit_date": 1495652020, "question_id": 44166319, "link": "https://stackoverflow.com/questions/44166319/vba-inserted-building-block-not-printing", "title": "VBA inserted building block not printing", "body": "<p>I am trying to programmatically insert a building block into Microsoft Word using VBA, and while the insertion works, when viewing in print preview, and when printing, the building block does not appear.</p>\n\n<pre><code>Sub draw_point()\nDim objTemplate As Template\nDim objBB As BuildingBlock\n\n    Selection.MoveDown Unit:=wdLine, Count:=1\n\n    ' Set the template to store the building block\n    Set objTemplate = ActiveDocument.AttachedTemplate\n\n    ' Access the building block through the type and category\n    Set objBB = objTemplate.BuildingBlockTypes(wdTypeAutoText) _\n    .Categories(\"General\").BuildingBlocks(\"point\")\n\n    ' Insert the building block into the document replacing any selected text.\n    objBB.Insert Selection.Range\nEnd Sub\n</code></pre>\n\n<p>If I manually insert the building block it prints fine.</p>\n\n<p>I am creating the building block by inserting a shape, then adding it to </p>\n\n<pre><code>AutoText &gt; General &gt; Normal.dotm &gt; Insert content only\n</code></pre>\n\n<p>If I try to re-create this issue on a new document, it does not happen, but I'm unsure what properties differs between the two documents</p>\n"}, {"tags": ["vba", "coreldraw"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5837580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1083500521694909/picture?type=large", "display_name": "James Cunningham", "link": "https://stackoverflow.com/users/5837580/james-cunningham"}, "edited": false, "score": 0, "creation_date": 1495658191, "post_id": 44166599, "comment_id": 75352087, "body": "I made an edit to the code to have sA set differently I tested this but it still did not work correctly. I have not yet explored the Let method. Allow me to do that and get back with you."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 121, "user_id": 5837580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1083500521694909/picture?type=large", "display_name": "James Cunningham", "link": "https://stackoverflow.com/users/5837580/james-cunningham"}, "edited": false, "score": 0, "creation_date": 1495716443, "post_id": 44166599, "comment_id": 75375854, "body": "@JamesCunningham as long as you are <code>Set</code>ting it, it will still be a referenced object. Even if you <code>Set sC = sB</code> then <code>Set sA = sC</code> then <code>sA</code> will still be a reference of <code>sB</code>. I don&#39;t know what you&#39;ve tried, just providing that as an assumption."}, {"owner": {"reputation": 121, "user_id": 5837580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1083500521694909/picture?type=large", "display_name": "James Cunningham", "link": "https://stackoverflow.com/users/5837580/james-cunningham"}, "edited": false, "score": 0, "creation_date": 1495745207, "post_id": 44166599, "comment_id": 75393007, "body": "I wound up having to create a double to hold the position of the objects before they were repositioned. I also had to use the StaticID of the object for Corel to access the correct ones and place them where they should go. Ultimately my code looks quite different from the original, though @GibralterTop had a very useful post. Thanks."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 121, "user_id": 5837580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1083500521694909/picture?type=large", "display_name": "James Cunningham", "link": "https://stackoverflow.com/users/5837580/james-cunningham"}, "edited": false, "score": 0, "creation_date": 1495773315, "post_id": 44166599, "comment_id": 75400859, "body": "@JamesCunningham glad you were able to figure it out. I think maybe you should post edited code as answer instead of editing your question."}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 1, "last_activity_date": 1495652623, "creation_date": 1495652623, "answer_id": 44166599, "question_id": 44166237, "link": "https://stackoverflow.com/questions/44166237/coreldraw-selecting-specific-shapes-in-a-collection/44166599#44166599", "title": "CorelDraw selecting specific shapes in a collection", "body": "<p>You are setting the objects equal to each other and they reference each other in memory. In fact, you are doubling the object and using up twice as much memory. </p>\n\n<p><code>Set</code> sets an object equal to the reference of the object you want it to be. Here is an example.</p>\n\n<pre><code>Public Sub test()\n\n    Dim s As Worksheet\n    Dim s2 As Worksheet\n\n    Set s = Application.Workbooks.Add().Worksheets.Add\n    s.Name = \"one\"\n    Set s2 = s     's and s2 Name = \"one\"\n    s.Name = \"two\" 's and s2 Name = \"two\"\n\nEnd Sub\n</code></pre>\n\n<p><code>Let</code> sets an object equal to the value of the object you want it to be.</p>\n\n<p>Try </p>\n\n<pre><code>Set sA = new Shape\nLet sA = sB \n</code></pre>\n\n<p>Instead of </p>\n\n<pre><code>Set sA = sB\n</code></pre>\n\n<p>If that doesn't work, you may have to create a property or variable for each of the shapes you are wanting to work with.</p>\n\n<p><a href=\"https://stackoverflow.com/a/349624/5224021\">Similar Question</a></p>\n"}], "owner": {"reputation": 121, "user_id": 5837580, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1083500521694909/picture?type=large", "display_name": "James Cunningham", "link": "https://stackoverflow.com/users/5837580/james-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495658105, "creation_date": 1495651180, "last_edit_date": 1495658105, "question_id": 44166237, "link": "https://stackoverflow.com/questions/44166237/coreldraw-selecting-specific-shapes-in-a-collection", "title": "CorelDraw selecting specific shapes in a collection", "body": "<p>I'm trying to build a small nesting Function inside of my current working system. What I am having trouble with is that when I add the third shape to the collection and try to position it based on the previous shape added to the collection, it still positions it based on the very first shape. What I end up with is the original in the original position and the copies stacked on top of one another.</p>\n\n<pre><code>Function ArrangeImages(ByRef scol1 As Collection, ByRef sA, sB As Shape)\nDim i, ii As Long\n\ni = scol1.Count\nii = i - 1\n\nIf i = 1 Then\n\nSet sB = scol1.Item(i)\n\nEnd If\n\nIf scol1.Count &gt; 1 Then\n\nSet sA = scol1.Item(ii)\nSet sB = scol1.Item(i)\n\nsB.SetPosition sA.PositionX, sA.PositionY + (sA.SizeHeight / 2) + \n(sB.SizeHeight / 2) + 0.15\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": [".net", "vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495651422, "post_id": 44166082, "comment_id": 75348837, "body": "See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. SO isn&#39;t a &quot;please debug my code for me&quot; service."}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495652209, "creation_date": 1495652209, "answer_id": 44166488, "question_id": 44166082, "link": "https://stackoverflow.com/questions/44166082/transfering-specific-data-from-one-workbook-to-another/44166488#44166488", "title": "Transfering specific data from one workbook to another", "body": "<p>there are a couple of errors found.  mainly I don't understand the following two lines.  They use a lot of code to apparently point to a single cell.</p>\n\n<pre><code>WBC.Worksheets(\"DATA\").Range(Cells(i, \"N\"), Cells(i, \"N\")).Copy\nWBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\")).Select\n</code></pre>\n\n<p>Also I would suggest coding without ever using the word select or activate.  Slows it down.  Try the following code and see if it works for what you need.  </p>\n\n<pre><code>Sub transfer()\nDim i As Long\nDim j As Long\nDim lastrow1 As Long\nDim lastrow2 As Long\nDim jobnum As String\nDim mainmachine As String\nDim WBT As Workbook ''This Workbook CNC PL\nDim WBC As Workbook '' New workbook CapacitySummary\n\nSet WBT = Workbooks(\"CNC TEST.xlsx\")\nSet WBC = Workbooks(\"CapacitySummary.xlsx\")\nlastrow1 = WBT.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = WBC.Worksheets(\"DATA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastrow1\njobnum = WBT.Sheets(\"Sheet1\").Cells(i, \"A\").Value\nmainmachine = WBT.Sheets(\"Sheet1\").Cells(i, \"K\").Value\n\n\nFor j = 2 To lastrow2\n\nIf WBC.Worksheets(\"DATA\").Cells(j, \"A\").Value = jobnum And _\nWBC.Worksheets(\"DATA\").Cells(j, \"B\").Value = mainmachine Then\n'''' Comparing data between workbooks\nWBC.Worksheets(\"DATA\").Activate\n'WBC.Worksheets(\"DATA\").Range(Cells(i, \"N\"), Cells(i, \"N\")).Copy Destination:=WBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\"))\n\nWBT.Worksheets(\"Sheet1\").Range(\"P\" &amp; j) = WBC.Worksheets(\"DATA\").Range(\"N\" &amp; i)\n'ActiveSheet.PasteSpecial Paste:=xlPasteValues\n''''Choosing Range to copy\n'WBT.Worksheets(\"Sheet1\").Activate\n'WBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\")).Select\n'ActiveSheet.Paste\n\n''''Choosing Range to paste\nEnd If\n\nNext j\nApplication.CutCopyMode = False\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 3881978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3A55.png?s=128&g=1", "display_name": "DoomedJupiter", "link": "https://stackoverflow.com/users/3881978/doomedjupiter"}, "is_accepted": false, "score": 0, "last_activity_date": 1495722448, "last_edit_date": 1495722448, "creation_date": 1495653250, "answer_id": 44166774, "question_id": 44166082, "link": "https://stackoverflow.com/questions/44166082/transfering-specific-data-from-one-workbook-to-another/44166774#44166774", "title": "Transfering specific data from one workbook to another", "body": "<p>You could try the below code. Its been adjusted to avoid and .select, .activate or .copy commands.</p>\n\n<pre><code>Dim WBT As Excel.Workbook\nDim WBC As Excel.Workbook\nDim jobNumWBT As String\nDim jonNumWBC As String\nDim mainMachine As String\nDim machCenter As String\nDim WBTpath As String\nDim WBCpath As String\n\nWBTpath = \"[insert your path here]\"\nWBCpath = \"[insert your path here]\"\n\nSet WBT = GetObject(WBTpath)\nSet WBC = GetObject(WBCpath)\n\nFor i = 2 To WBT.Worksheets(1).Cells(1048576, 1).End(xlUp).Row\n    jobNumWBT = WBT.Worksheets(1).Cells(i, 1).Value\n    mainMachine = WBT.Worksheets(1).Cells(i, 11).Value 'current WC\n    For j = 2 To WBC.Worksheets(1).Cells(1048576, 1).End(xlUp).Row\n        jobNumWBC = WBC.Worksheets(\"DATA\").Cells(j, 1).Value\n        machCenter = WBC.Worksheets(\"DATA\").Cells(j, 2).Value\n        totalTime = WBC.Worksheets(\"DATA\").Cells(j, 14).Value\n\n        If jobNumWBT = jobNumWBC And machCenter = mainMachine Then\n            WBT.Worksheets(1).Cells(i, 16).Value = totalTime\n        End If\n\n    Next j\nNext i\n\nWBT.Save\nWBC.Save\nWBT.Close\nWBC.Close\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8049575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894329d50fb8eeb2198b07104815df96?s=128&d=identicon&r=PG&f=1", "display_name": "Rubious", "link": "https://stackoverflow.com/users/8049575/rubious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495722448, "creation_date": 1495650635, "last_edit_date": 1495664179, "question_id": 44166082, "link": "https://stackoverflow.com/questions/44166082/transfering-specific-data-from-one-workbook-to-another", "title": "Transfering specific data from one workbook to another", "body": "<p>I have made a piece of code with VBA that will transfer data from one workbook to another without taking the function with it. Every time it is ran, it doesn't seem to want to put out the correct information. Could you guys take a look at it and tell me what you see wrong?</p>\n\n<pre><code>Sub transfer()\n  Dim i As Long\n  Dim j As Long\n  Dim lastrow1 As Long\n  Dim lastrow2 As Long\n  Dim jobnum As String\n  Dim mainmachine As String\n  Dim WBT As Workbook ''This Workbook CNC PL\n  Dim WBC As Workbook '' New workbook CapacitySummary\n\n  Set WBT = Workbooks(\"CNC TEST.xlsx\")\n  Set WBC = Workbooks(\"CapacitySummary.xlsx\")\n  lastrow1 = WBT.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  lastrow2 = WBC.Worksheets(\"DATA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n  WBT.Worksheets(\"sheet1\").Activate\n  For i = 2 To lastrow1\n    jobnum = WBT.Sheets(\"Sheet1\").Cells(i, \"A\").Value\n    mainmachine = WBT.Sheets(\"Sheet1\").Cells(i, \"K\").Value\n    WBC.Worksheets(\"DATA\").Activate\n\n\n    For j = 2 To lastrow2\n\n      If WBC.Worksheets(\"DATA\").Cells(j, \"A\").Value = jobnum And \n        WBC.Worksheets(\"DATA\").Cells(j, \"B\").Value = mainmachine Then\n        '''' Comparing data between workbooks\n        WBC.Worksheets(\"DATA\").Activate\n        WBC.Worksheets(\"DATA\").Range(Cells(i, \"N\"), Cells(i, \"N\")).Copy\n        ActiveSheet.PasteSpecial Paste:=xlPasteValues\n        ''''Choosing Range to copy\n        WBT.Worksheets(\"Sheet1\").Activate\n        WBT.Worksheets(\"Sheet1\").Range(Cells(j, \"P\"), Cells(j, \"P\")).Select\n        ActiveSheet.Paste\n\n        ''''Choosing Range to paste\n      End If\n\n    Next j\n    Application.CutCopyMode = False\n\n  Next i\n\nEnd sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/XiUEi.png\" alt=\"Priority List\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/zYXsl.png\" alt=\"Capacity\"></p>\n\n<p>So, What we want to do is have the macro check both workbooks and see if the \"JobNumbers\" are matching. If so, we want it to check if the \"Mach Center\" on the Capacity and \"Current WC\" on the Priority List is matching. If it does, We want to copy the total time on the capacity list and paste it on Column \"P\" on the priority list (CNC Dept) without the function copying over with it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495650806, "post_id": 44166030, "comment_id": 75348531, "body": "are the values in those cells filled with a formula that returns <code>&quot;&quot;</code> or a constant?"}, {"owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495651042, "post_id": 44166030, "comment_id": 75348655, "body": "The return value is either text or &quot; &quot; from the formula"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1495651205, "post_id": 44166030, "comment_id": 75348734, "body": "Then xlCellTypeConstants will not work.  You can loop through the range, copy the values to another range then use the xlCellTypeConstants, or load it into an array and cycle through the array."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495657001, "post_id": 44166030, "comment_id": 75351543, "body": "Would .SpecialCells(xlCellTypeFormulas, xlCellTypeConstants) work?"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495650447, "creation_date": 1495650447, "question_id": 44166030, "link": "https://stackoverflow.com/questions/44166030/copy-paste-if-not-cell-value-is-blank-vba", "title": "copy paste if not cell value is blank vba", "body": "<p>I'm trying to copy non blank cells text and paste to other sheet. It is not able paste and the column is blank.No errors poping up</p>\n\n<p>My code:</p>\n\n<pre><code>Sub mycode()\nDim rngFiltered As Range \nOn Error Resume Next\nSet rngFiltered = Worksheets(\"sheet1\").Range(\"K2:K25\").Cells.SpecialCells(xlCellTypeConstants)\nOn Error GoTo 0\n\nIf Not rngFiltered Is Nothing Then\n    rngFiltered.Copy Sheets(\"sheet2\").Range(\"K2\")\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1495650077, "post_id": 44165855, "comment_id": 75348161, "body": "You can use a VBA user-defined function, starting with <code>Split(cellValueHere, vbLf)</code> and then loop over the resulting array (igoring empy values) to get a count.  Try that out then post back (with your code) if you run into problems."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495651316, "post_id": 44165855, "comment_id": 75348791, "body": "@TimWilliams that will leave <code>vbCr</code> in the string. better split on <code>vbNewLine</code> (or <code>vbCrLf</code>)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495651590, "post_id": 44165855, "comment_id": 75348930, "body": "@Mat&#39;sMug -  I had <code>Alt+Enter</code> in mind (which I think is just vbLf) but you&#39;re correct it would be better to account for presence of vbCr also."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495651691, "post_id": 44165855, "comment_id": 75348978, "body": "@TimWilliams you&#39;re right, it&#39;s Alt+Enter is just <code>vbLf</code> - TIL ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 0, "last_activity_date": 1495731439, "creation_date": 1495731439, "answer_id": 44185931, "question_id": 44165855, "link": "https://stackoverflow.com/questions/44165855/two-names-in-field/44185931#44185931", "title": "Two Names in Field", "body": "<p>If you have the names separated by the <code>Enter Key</code> in <code>Column A</code>, use the below formula in <code>Column B</code> and drag it to the right upto 6 or more cells and then drag down,</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE(SUBSTITUTE($A1,CHAR(10),\"#\"),\"#\",REPT(\" \",999)),(COLUMN(A:A)-1)*999+1,999))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NOwO3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NOwO3.png\" alt=\"enter image description here\"></a></p>\n\n<p>This formula splits your name strings with the <code>Enter Key</code> as the delimiter into multiple columns as you drag. You could then use <code>COUNTA</code> function to find the non-blank cells (number of names). I leave that part to you to google and find it. Hope this helped you.</p>\n"}], "owner": {"reputation": 17, "user_id": 8000492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dad2caf9df89a4c524a525717821c0?s=128&d=identicon&r=PG&f=1", "display_name": "AJ1225", "link": "https://stackoverflow.com/users/8000492/aj1225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 44185931, "answer_count": 1, "score": -2, "last_activity_date": 1495731439, "creation_date": 1495649839, "last_edit_date": 1495649927, "question_id": 44165855, "link": "https://stackoverflow.com/questions/44165855/two-names-in-field", "title": "Two Names in Field", "body": "<p>Currently, I am working with a scenario where I have 0 to 6 names in the field. For example, A2 has Bob Smith and Jone Random. Below is an example how they look in a check.</p>\n\n<pre><code>Effi Liu      \n               &lt;- (enter/gap)    \nKevin Xing\n</code></pre>\n\n<p>Basically, I want to generate a 1 column that counts how many people in A2. For example, two people and then create a function that will separate. Each of the names into different columns.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1495649538, "post_id": 44165718, "comment_id": 75347892, "body": "<b>EVERY</b> Range object needs to be assigned to a parent sheet <code>Sheets(&quot;Archive&quot;).Range(Sheets(&quot;Archive&quot;).Cells(2, x), Sheets(&quot;Archive&quot;).Cells(100, x)).Value...</code>"}, {"owner": {"reputation": 1, "user_id": 8061116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213775079757724/picture?type=large", "display_name": "Colby Raynor", "link": "https://stackoverflow.com/users/8061116/colby-raynor"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495650401, "post_id": 44165718, "comment_id": 75348324, "body": "Thank you very much. I searched SO for a solid hour before making an account. Sorry about the duplicate."}], "owner": {"reputation": 1, "user_id": 8061116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213775079757724/picture?type=large", "display_name": "Colby Raynor", "link": "https://stackoverflow.com/users/8061116/colby-raynor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1495649780, "answer_count": 0, "score": 0, "last_activity_date": 1495649333, "creation_date": 1495649333, "question_id": 44165718, "link": "https://stackoverflow.com/questions/44165718/excel-vba-copy-data-from-range-of-cells-with-a-variable-as-the-column", "closed_reason": "Duplicate", "title": "Excel VBA: Copy data from range of cells with a variable as the column", "body": "<p>I am trying to copy a range of cells from one sheet to another. It searches for an empty column, then copies the current data. However, it will not compile and fails at</p>\n\n<pre><code>Sheets(\"Archive\").Range(Cells(2, x), Cells(100, x)).Value = Sheets(\"Main\").Range(\"H2:H100\").Value\n</code></pre>\n\n<p>The full code is:</p>\n\n<pre><code>Sub Generate()\nDim i As Boolean\nDim x As Long\ni = False\nx = 2\nDo While i = False\n    If Sheets(\"Archive\").Cells(2, x) = \"\" Then\n    i = True\nSheets(\"Archive\").Range(Cells(2, x), Cells(100, x)).Value = Sheets(\"Main\").Range(\"H2:H100\").Value    \nMsgBox \"Done!\"\nEnd If\n    x = x + 1\n    'debug\n    MsgBox \"Iteration \" &amp; x\nLoop     \nSheets(\"Main\").Range(\"H2:H100\").Value = Sheets(\"Password Generator\").Range(\"A2:A100\").Value\nSheets(\"Main\").Range(\"I2:I100\").Value = Sheets(\"Password Generator\").Range(\"B2:B100\").Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "vba", "ms-access"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495649464, "post_id": 44165420, "comment_id": 75347845, "body": "SInce subforms <i>normally</i> open before main forms, you need to delay the subform. Take a look at: <a href=\"https://accessexperts.com/blog/2013/12/18/prevent-subforms-in-access-from-loading-before-main-forms/\" rel=\"nofollow noreferrer\">accessexperts.com/blog/2013/12/18/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8060975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4b3ef8bc895d2e9bfda05e10593165?s=128&d=identicon&r=PG&f=1", "display_name": "Blair", "link": "https://stackoverflow.com/users/8060975/blair"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495650165, "post_id": 44165420, "comment_id": 75348203, "body": "Thank you for pointing me towards that. So I changed the subforms to call from the original patient_ID. (I tag the patient as &quot;in use&quot; before opening the form). I would expect that by removing the dependence on the main form it would have fixed this issue, however it doesn&#39;t seem to have changed anything?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495650593, "post_id": 44165420, "comment_id": 75348415, "body": "Did you see the comment in that link that said &quot;Ben will talk about disabling the loading of subforms on startup in our next post.&quot; where &#39;next post&#39; is another link?"}, {"owner": {"reputation": 1, "user_id": 8060975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4b3ef8bc895d2e9bfda05e10593165?s=128&d=identicon&r=PG&f=1", "display_name": "Blair", "link": "https://stackoverflow.com/users/8060975/blair"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495653868, "post_id": 44165420, "comment_id": 75349999, "body": "No, I had missed that! quickly jumped to the next bit. I am a little confused by the code in it. (1) Do I place this is the main form or the header? Specifically where does this code go for the form? (2) This involves removing the Source Object for each subform and then subsequently reassigning it after the main form has loaded? (3) How do Cases work? I have not used them before. I largely use Python. VBA has only been for this project. Thank you for your patience!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1495654380, "post_id": 44165420, "comment_id": 75350253, "body": "1) Probably in form Open or Load or Current event. 2) Yes. 3) Google. Build code and test. If you have issues, post a new question."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8060975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4b3ef8bc895d2e9bfda05e10593165?s=128&d=identicon&r=PG&f=1", "display_name": "Blair", "link": "https://stackoverflow.com/users/8060975/blair"}, "edited": false, "score": 0, "creation_date": 1495650897, "post_id": 44165805, "comment_id": 75348583, "body": "You are right. I actually had put them in the Detail section not the proper header. Just tried placing Me.Requery in Private Sub Form_Load() of the header form, however it doesn&#39;t seem to work either. I think I might have misunderstood something? Thanks"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1, "user_id": 8060975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4b3ef8bc895d2e9bfda05e10593165?s=128&d=identicon&r=PG&f=1", "display_name": "Blair", "link": "https://stackoverflow.com/users/8060975/blair"}, "edited": false, "score": 0, "creation_date": 1495654752, "post_id": 44165805, "comment_id": 75350432, "body": "So why subforms in main form Header and not Detail? I have never had this issue and therefore never tried any code like this. No, Requery code in subform Load won&#39;t work mainly because the main form is not yet loaded. Would have to be code in the main form event that references the subform. That&#39;s what my answer describes."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1495650109, "last_edit_date": 1495650109, "creation_date": 1495649640, "answer_id": 44165805, "question_id": 44165420, "link": "https://stackoverflow.com/questions/44165420/microsoft-access-2010-lag-in-continuous-form-header-subforms/44165805#44165805", "title": "Microsoft Access 2010 lag in continuous form header subforms", "body": "<p>I know this will sound odd, but subforms actually load before parent form. Lag in subform display is not something I have encountered. Code should not be needed and likely will not correct. Must be something about the form/subform design, maybe their RecordSource. Would have to examine db to determine.</p>\n\n<p>It is not necessary to create form objects in VBA just to requery. Is code behind the main form? <code>Me.Requery</code> will be enough for the main form. I always give subform container a name different from the object it holds, like ctrPatient. Then just <code>Me.ctrPatient.Requery</code>.</p>\n\n<p>Why not put subforms in Detail section?</p>\n"}, {"tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1495656350, "creation_date": 1495656350, "answer_id": 44167554, "question_id": 44165420, "link": "https://stackoverflow.com/questions/44165420/microsoft-access-2010-lag-in-continuous-form-header-subforms/44167554#44167554", "title": "Microsoft Access 2010 lag in continuous form header subforms", "body": "<p>To answer your questions, and provide a condensed version of the logic referenced at:  <a href=\"https://accessexperts.com/blog/2014/01/07/delay-loading-subforms-in-access/\" rel=\"nofollow noreferrer\">https://accessexperts.com/blog/2014/01/07/delay-loading-subforms-in-access/</a></p>\n\n<p>is to:</p>\n\n<ol>\n<li>In design view, set your subform SourceObject to \"\" (and save your form)</li>\n<li>When you are ready to show the subform, just execute: Me..SourceObject = \"\"</li>\n<li>When you are ready to navigate to the NEXT patient, clear the subform link: Me..SourceObject = \"\"</li>\n</ol>\n\n<p>Now that should solve the issue of out of sync data between the main and sub.</p>\n\n<p>You don't need to use the CASE statements, but they operate as if you had a bunch of \"If\" / \"ElseIf\" all nestled together -- except the CASE makes it easier to follow. It basically gets a value from a variable (i.e. Select Case MyVariable); then checks to see if it equals what you want (Case 1, Case 2, etc.), and if so, does whatever you code.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8060975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4b3ef8bc895d2e9bfda05e10593165?s=128&d=identicon&r=PG&f=1", "display_name": "Blair", "link": "https://stackoverflow.com/users/8060975/blair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495656350, "creation_date": 1495648319, "last_edit_date": 1495655174, "question_id": 44165420, "link": "https://stackoverflow.com/questions/44165420/microsoft-access-2010-lag-in-continuous-form-header-subforms", "title": "Microsoft Access 2010 lag in continuous form header subforms", "body": "<p>I am a research student working on an access database where I have created a continuous form that is to be used in a sort of scrolling electronic health record format. The header includes information about the patient and the continuous form aspect is a series of patient visits. In the header, I have a few subforms, which populate based on linking on the patient_ID number which is posted in the header (generated by vba macro such that previously reviewed patients aren't revisited). These subforms seem to significantly lag such that they the results from the previous patient stick around going into the next one. The subforms contain user-selected pertinent data. Each form has its own table. They are linked primarily based on patient_ID. </p>\n\n<p>I have tried:</p>\n\n<ol>\n<li>macro on the header detail: on click, refresh. - seems to work, but not very elegant/intuitive</li>\n<li>macro on the main form - same as above but on load, click, got focus, lost focus, open, activate -- none of them seem to do anything. </li>\n<li><p>forced requery via vba (see below) on opening/etc of the form. Neither way has worked. Tried to run these on opening the header form. </p>\n\n<p><code>Public Function RequeryMain()\n    Dim frmMain As Form\n    Set frm = Forms(\"FRM_continuous_reports_patient\")\n    frm.Requery\nEnd Function</code></p>\n\n<p><code>Public Function RequeryHeader()\n    Dim frmHeader As SubForm\n    Set frmHeader = Forms(\"FRM_continuous_reports_patient\").FRM_continuous_header_working\n    frmHeader.Requery\nEnd Function</code></p></li>\n</ol>\n\n<p>In the end, it is frustrating for users to have to click to clear the form for new entries. It works otherwise. </p>\n\n<p>The end goal is for the form to open and have all the subforms load based on the newest patient_ID. This would likely have to involve a staggered load: (1) VBA script selects the next patient based on certain characteristics and passes the patient_ID to the main form; (2) load main continuous form based on patient_ID submitted to it; (3) load the header subforms and any pertinent data within (although should be blank for the first time these are seen); (4) on completion, back to (1). </p>\n\n<p>From what I understand, this is already how it is working, however the subforms are loading too quickly? How can I fix this? </p>\n\n<p>Hopefully someone can help explain how to remedy this/correct any misunderstandings I have about the mechanics of forms. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495649881, "post_id": 44165180, "comment_id": 75348082, "body": "Does your VBA code actually <i>store</i> a new record, or is that what you <i>plan</i> for the future? And is your plan really to be: (a) Click; (b) Ask user for data; (c) Store new record?  How about posting the code you have now so we can take a look?"}, {"owner": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1495748123, "post_id": 44165180, "comment_id": 75394325, "body": "Thanks for your comment, the code that I have now is:                             Sub Button6_Click()  Sheets(&quot;Blad4&quot;).Range(&quot;C5&quot;).Select ActiveCell.EntireColumn.Insert Shift:=xlRight  End Sub.                                                                                                                How you said it is exactly how I want it. hope you can help, thanks in advance"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "edited": false, "score": 0, "creation_date": 1495783040, "post_id": 44192282, "comment_id": 75404811, "body": "Actually I have one button for adding a column and one for adding a row. If I know how to do one, I will know how to do the other. the cells I need to fill in with the user input are: For the column I need to fill in cells C5:C13 and C16:C28 and for the rowB6:K6 and B17:K17. But now I have the problem if I insert a column and than a row that the range will change. Though that I can fix this by an &quot;if&quot; condition. So if the cell is green a new input box appears where the user can fill in the value. if you want to take a look at the file yourself, I can send it in an email to you"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "edited": false, "score": 0, "creation_date": 1495807507, "post_id": 44192282, "comment_id": 75419798, "body": "I&#39;m still curious about the &#39;text box for users to enter values&#39; part. If I&#39;m your user and you prompt me with 20+ textboxes, I&#39;m not going to be happy. Have you thought about either allowing the user to enter directly into the sheet cells (you can protect other cells); or provide a user form for their input? Yes, as you add rows and columns you will need to &#39;remember&#39; where you are. You could do that with either a global variable, or some code that will find the correct cell."}, {"owner": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "edited": false, "score": 0, "creation_date": 1495974367, "post_id": 44192282, "comment_id": 75464508, "body": "It is for a school assignment so it is mandatory to write a code for it. will try to figure it out. your code was a good direction on the first step"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "edited": false, "score": 0, "creation_date": 1495984471, "post_id": 44192282, "comment_id": 75467654, "body": "(1) Are you going to add another button that will indicate you want to add a column (you said you have a button to add a row)? If not, what will indicate whether a row or column? (2) Will the row or column always be added relative to where the &#39;ACTIVE CELL&#39; is, or will you always add a row or column relative to where the last row/column was added?"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1495762753, "creation_date": 1495762753, "answer_id": 44192282, "question_id": 44165180, "link": "https://stackoverflow.com/questions/44165180/vba-insert-a-new-row-and-show-a-box-where-the-user-can-fill-in-the-values-that/44192282#44192282", "title": "VBA, Insert a new row and show a box where the user can fill in the values that need to be in de cells", "body": "<p>Below is some code that will prompt a user to enter some value. The problem I have is understanding your requirements. In one case you say you want to add a ROW, yet your code adds a COLUMN. Which is it??  And how many cells do you need to fill with user input, and are they all in the same row or the same column?  If you want 3 or more cells filled, it is horrible to ask a user three or more questions. If you can have the user delimit the value for each cell (i.e. :, or |, or ...) then that would be nice.  </p>\n\n<p>Please clarify above questions...</p>\n\n<pre><code>Sub Button6_Click()\nDim strUserValue    As String\n    ' Ask user to enter a value. If you need values for several cells, then either\n    ' ask several questions, or pars the value they enter (i.e. 'John:Doe:Jr.' could\n    ' be split into three cells.\n    strUserValue = InputBox(\"Enter Value\", \"Provide value for cells\")\n    Sheets(\"Results\").Range(\"C5\").Select                ' You are selecting this row &amp; column\n    ActiveCell.EntireColumn.Insert Shift:=xlRight       ' This shifts the column right\n    ActiveCell.Offset(1).EntireRow.Insert               ' This inserts a new row relative to where you are (Active cell)\n    Cells(6, 3) = strUserValue                          ' What row / column do you want to enter data in????\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6949716, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/74364dfebe48c268d4b59495a6e414cb?s=128&d=identicon&r=PG&f=1", "display_name": "pjs", "link": "https://stackoverflow.com/users/6949716/pjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497348432, "creation_date": 1495647381, "last_edit_date": 1497348432, "question_id": 44165180, "link": "https://stackoverflow.com/questions/44165180/vba-insert-a-new-row-and-show-a-box-where-the-user-can-fill-in-the-values-that", "title": "VBA, Insert a new row and show a box where the user can fill in the values that need to be in de cells", "body": "<p>fhjdajhkfdakjhfdjkhdfjhkdfsjhkafdshjkdfajhkafdsjkhfdajhkafsd</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1495647074, "post_id": 44164753, "comment_id": 75346509, "body": "<i>The recurring answer I have seen is that the rng used in the union needs to be set to nothing.</i> - where did you read that? <code>Set foo = Union(Range(&quot;A1&quot;), Nothing)</code> raises run-time error 5 &#39;invalid procedure call or argument&#39;. IOW you need to check for <code>foundCell Is Nothing</code>, and make sure you don&#39;t give <code>Union</code> any reference that&#39;s not set."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495656048, "post_id": 44164753, "comment_id": 75351045, "body": "FWIW (not related to the error) - it would make be more logical if your <code>If FoundCell.Address = FirstFound Then Exit Do</code> was done before <code>Set rng = Union(rng, FoundCell)</code> or else you add the first found cell twice (not that it would matter - it would just ignore the second add)"}, {"owner": {"reputation": 5, "user_id": 3042129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d00fbda4206c9c10bbc53c9157e9042?s=128&d=identicon&r=PG&f=1", "display_name": "CodeStack", "link": "https://stackoverflow.com/users/3042129/codestack"}, "edited": false, "score": 0, "creation_date": 1495701082, "post_id": 44164753, "comment_id": 75366477, "body": "Apologies for not expanding when originally posting as I was very tight on time, however what I was trying to get across was that the same error posted on this forum suggests (especially if thrown on second export/run) that the workbook rng had not been previously cleared. All I wanted to get across was that I had already tried that solution.  E.g <a href=\"https://stackoverflow.com/questions/39840956/vba-method-union-of-object-global-failed\" title=\"vba method union of object global failed\">stackoverflow.com/questions/39840956/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3042129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d00fbda4206c9c10bbc53c9157e9042?s=128&d=identicon&r=PG&f=1", "display_name": "CodeStack", "link": "https://stackoverflow.com/users/3042129/codestack"}, "edited": false, "score": 0, "creation_date": 1495701156, "post_id": 44167602, "comment_id": 75366518, "body": "Went completely over my head that one, there were other objects in my code which I also had to use the ApXL object. Thanks for the tip. For anyone searching for a similar problem, changed to Set rng = ApXL.Union(rng, FoundCell)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5, "user_id": 3042129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d00fbda4206c9c10bbc53c9157e9042?s=128&d=identicon&r=PG&f=1", "display_name": "CodeStack", "link": "https://stackoverflow.com/users/3042129/codestack"}, "edited": false, "score": 0, "creation_date": 1495701328, "post_id": 44167602, "comment_id": 75366614, "body": "@CodeStack Oops - I just noticed that I switched your object name when I typed the answer - I used <code>xlAp</code> when you were using <code>ApXL</code>  (answer now edited - hopefully you noticed anyway)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1495701350, "last_edit_date": 1495701350, "creation_date": 1495656579, "answer_id": 44167602, "question_id": 44164753, "link": "https://stackoverflow.com/questions/44164753/method-union-of-object-global-failed/44167602#44167602", "title": "Method &#39;Union&#39; of Object &#39;_Global&#39; failed", "body": "<p>Change</p>\n\n<pre><code>Set rng = Union(rng, FoundCell)\n</code></pre>\n\n<p>to be</p>\n\n<pre><code>Set rng = ApXL.Union(rng, FoundCell)\n</code></pre>\n\n<p>because you are trying to use the <code>Union</code> command which is part of the Excel Application object.</p>\n"}], "owner": {"reputation": 5, "user_id": 3042129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d00fbda4206c9c10bbc53c9157e9042?s=128&d=identicon&r=PG&f=1", "display_name": "CodeStack", "link": "https://stackoverflow.com/users/3042129/codestack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2624, "favorite_count": 0, "accepted_answer_id": 44167602, "answer_count": 1, "score": 0, "last_activity_date": 1495701350, "creation_date": 1495645833, "last_edit_date": 1495656065, "question_id": 44164753, "link": "https://stackoverflow.com/questions/44164753/method-union-of-object-global-failed", "title": "Method &#39;Union&#39; of Object &#39;_Global&#39; failed", "body": "<p>I keep obtaining this error on my second export of a excel spreadsheet.</p>\n\n<p>The recurring answer I have seen is that the rng used in the union needs to be set to nothing. I have done that over and over across my code to no avail, is there something else I might be missing.</p>\n\n<p>Would appreciate any insight on this.</p>\n\n<pre><code>Set myRange = ApXL.Sheets(xlWSh.Name).Range(\"1:1\")\nSet LastCell = myRange.Cells(myRange.Cells.count)\nSet FoundCell = myRange.Find(what:=fnd, After:=LastCell)\n\nIf Not FoundCell Is Nothing Then\n  FirstFound = FoundCell.Address\nElse\n  GoTo NoValuesMatchingFound\nEnd If\nSet rng = FoundCell\n\n'Loop until cycled through all unique finds\nDo Until FoundCell Is Nothing\n  'Find next cell with fnd value\n  Set FoundCell = myRange.FindNext(After:=FoundCell)\n  'Add found cell to rng range variable\n  Set rng = Union(rng, FoundCell)\n  'Select Cells Containing Find Value\n  'Test to see if cycled through to first found cell\n  If FoundCell.Address = FirstFound Then Exit Do\nLoop\n\n rng.EntireColumn.Select\n ApXL.Selection.NumberFormat = \"dd-mm-yy  hh:mm:ss\"\n\n'Error Handler\nNoValuesMatchingFound:\n' Debug.Print \"No values were found in this worksheet\"\n\n' selects all of the cells\n ApXL.ActiveSheet.Cells.Select\n ' does the \"autofit\" for all columns\n ApXL.ActiveSheet.Cells.EntireColumn.AutoFit\n ' selects the first cell to unselect all cells\n xlWSh.Range(\"A1\").Select\n\n On Error Resume Next\n xlWBk.Sheets(\"Sheet2\").Delete\n xlWBk.Sheets(\"Sheet3\").Delete\n On Error GoTo 0\n\n With xlWBk\n   If cmbOverwrite &lt;&gt; \"Prompt\" Then\n     ApXL.DisplayAlerts = False \n   Else\n     ApXL.DisplayAlerts = True\n   End If\n   .SaveAs FileName:=txtSaveToFolder &amp; \"\\\" &amp; File_Name &amp; \".xlsx\"\n   Set rng = Nothing\n   .Close\n End With\n rstXX.Close\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 0, "last_activity_date": 1495648307, "creation_date": 1495648307, "answer_id": 44165414, "question_id": 44164487, "link": "https://stackoverflow.com/questions/44164487/vba-opening-workbooks-checking-if-workbook-is-open-best-practice-and-why/44165414#44165414", "title": "VBA Opening Workbooks/Checking if Workbook is Open Best Practice and Why", "body": "<p>This is the cleanest way i know: \n<a href=\"https://stackoverflow.com/questions/9373082/detect-whether-excel-workbook-is-already-open\">Detect whether Excel workbook is already open</a> .</p>\n\n<p>It does not actually crash, but you can only open a file once in read-write mode, if you open it twice it asked you to open it in read-only. </p>\n\n<p>So if you try this, the workbook will open every time, but it says Read-Only in the title. </p>\n\n<pre><code>Sub OpenWbk()\nDim xl As Object\nSet xl = CreateObject(\"Excel.Application\")\nDim wbk As Workbook\nDim sht As Worksheet\nxl.Visible = True\nSet wbk = xl.Workbooks.Open(\"C:\\Users\\User\\Desktop\\Book1.xlsm\")\nSet sht = wbk.Sheets(1)\nEnd Sub\n</code></pre>\n\n<p>It probably throws an error because it wants to access something that does not exists. \nIf you <code>set wbk = Workbooks(\"FileName\")</code> (throws error if not opened) and say <code>On Error Resume Next</code> and then check <code>If wbk Is Nothing</code>it will work.<br>\nSo the error message is some kind of protection i guess. </p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495648695, "creation_date": 1495648695, "answer_id": 44165511, "question_id": 44164487, "link": "https://stackoverflow.com/questions/44164487/vba-opening-workbooks-checking-if-workbook-is-open-best-practice-and-why/44165511#44165511", "title": "VBA Opening Workbooks/Checking if Workbook is Open Best Practice and Why", "body": "<p>UGP Might have beat me to the punch.  This code will check to see if your workbook is open.  If it is then it will set it to the variable myWB and it doesn't crash on me.  If it is not open it will open it with the same variable.  </p>\n\n<pre><code>Sub wsdcvbhui()\nDim wb As Workbook\nDim wbs As Workbooks\nDim myWB As Workbook\n\nSet wbs = Application.Workbooks\n\n    For Each wb In wbs\n      If wb.Path &amp; \"\\\" &amp; wb.Name = \"C:\\Files\\Bounce.xlsx\" Then ' change this to your file path and name\n            Set myWB = wb\n            GoTo skipOpen\n    End If\n    Next wb\n\n    Set myWB = Workbooks.Open(\"C:\\Files\\Bounce.xlsx\")\nskipOpen:\nmyWB.Activesheet.range(\"B2\").value = \"Hello\"\nmyWB.save\nmyWB.Close Saved = True\n\nSet wbs = Nothing\nSet myWB = Nothing\nSet wb = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8675608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e161e98ff89a255f76bc1f20c04f14?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Garcia", "link": "https://stackoverflow.com/users/8675608/julio-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1583690499, "creation_date": 1583690499, "answer_id": 60590476, "question_id": 44164487, "link": "https://stackoverflow.com/questions/44164487/vba-opening-workbooks-checking-if-workbook-is-open-best-practice-and-why/60590476#60590476", "title": "VBA Opening Workbooks/Checking if Workbook is Open Best Practice and Why", "body": "<p>To find out if a workbook is open, you can use a function for that purpose, which takes advantage of the \"On Error\" statement.</p>\n\n<pre><code>Sub testIsOpen()\n    Dim sFN     As String\n    Dim bFlag   As Boolean\n    sFN = \"FileName.xlsx\"     ' Put the name of your workbook here\n    bFlag = IsWkbOpen(sFN)\n    ' Print in Immediate window True or False\n    Debug.Print bFlag\nEnd Sub\n\nPublic Function IsWkbOpen(ByVal sFileName As String) As Boolean\n    Dim wkb         As Workbook\n    Dim bReturn     As Boolean\n    On Error GoTo EH   \n    bReturn = True\n    Set wkb = Workbooks(sFileName)\n    IsWkbOpen = bReturn\n    Exit Function\nEH:\n    bReturn = False\n    Resume Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7982062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44f8b91530cf572a9eba63cb76fdadf?s=128&d=identicon&r=PG&f=1", "display_name": "Sarchwalk", "link": "https://stackoverflow.com/users/7982062/sarchwalk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5084, "favorite_count": 0, "accepted_answer_id": 44165414, "answer_count": 3, "score": 0, "last_activity_date": 1583690499, "creation_date": 1495645039, "last_edit_date": 1531164843, "question_id": 44164487, "link": "https://stackoverflow.com/questions/44164487/vba-opening-workbooks-checking-if-workbook-is-open-best-practice-and-why", "title": "VBA Opening Workbooks/Checking if Workbook is Open Best Practice and Why", "body": "<p>I have made a macro that copies a worksheet from one workbook to another, and I have a couple questions about best practice when it comes to opening workbooks.</p>\n\n<p>From previous programming experience I know that you should check to see if something is already open before trying to open it. So far that has proven true with VBA as my macro crashes if the worksheet I'm copying from was already open. I would like to know what is the best way to test if it is open. It would likely not be the active workbook and testing <code>If Workbooks(file) Is Nothing Then ....</code> has given me errors. (This was what I found online as a possible solution)</p>\n\n<p>If I exclude the test mentioned above I get an error on:</p>\n\n<p><code>Set copyFromWB = Workbooks.Open(file)\nSet copyFromWS = copyFromWB.Sheets(copyFromSheetName) 'ERROR HERE</code> </p>\n\n<p>when the file is already open, but it works perfectly when the file is closed. I would like to know why an error is raised when the file is already open, a 'behind the scenes' answer is really what I'm looking for here, something that explains what the computer is thinking, moreso theory.</p>\n\n<p>Also on that note, I want to know why testing <code>If Workbooks(file) Is Nothing Then ....</code> doesn't work for me when I've seen it being suggested on multiple VBA help forums. Is this an issue with types or does it have to do with the version of excel I am using?</p>\n\n<p>For reference, \"file\" and \"copyFromSheetName\" exist and no errors arise when the file did not start from open at run-time.</p>\n\n<p>Summary:</p>\n\n<ol>\n<li>Cleanest way to test if a workbook is open?</li>\n<li>Why does an already opened Workbook cause a crash when trying to access its worksheets? (I'm thinking it actually has to do with the line above <code>Set copyFromWB = Workbooks.Open(file)</code></li>\n<li>Why won't comparing Workbooks(file) to Nothing work? Is it a type issue, excel version issue, or something else?</li>\n</ol>\n\n<p>I'm looking for more than a coded solution. It won't be much use to me if I don't understand why your code works and mine does not.</p>\n"}, {"tags": ["vba", "excel", "substitution"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 1, "creation_date": 1495645422, "post_id": 44164483, "comment_id": 75345605, "body": "Your formula works perfectly for me"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 1, "creation_date": 1495645670, "post_id": 44164483, "comment_id": 75345747, "body": "It doesn&#39;t seem to actually remove spaces. When I split the resulting String, each element after the first has a space in front of it."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 1, "creation_date": 1495645783, "post_id": 44164483, "comment_id": 75345801, "body": "can you show your split code also?"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 1, "creation_date": 1495646200, "post_id": 44164483, "comment_id": 75346034, "body": "I&#39;ve added it to the OP"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495646858, "post_id": 44164483, "comment_id": 75346388, "body": "Just add this to a msgbox <code>splitArr(0) &amp; splitArr(1) &amp; splitArr(2) &amp; splitArr(3)</code> . Its just printing fine"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495646998, "post_id": 44164483, "comment_id": 75346462, "body": "Yes the output looks good, but I want all spaces to be removed. The message displayed shows spaces between the elements."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1495647067, "post_id": 44164483, "comment_id": 75346503, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/145053/discussion-between-gowtham-shiva-and-tawm\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495652700, "post_id": 44164483, "comment_id": 75349418, "body": "Try the replace format instead of substitute.  workingCell = replace(workingCell, &quot; &quot;, &quot;&quot;) and also see if changing &quot;workingCell1 = Range(&quot;C4&quot;)&quot; to something like &quot;workingCell1 = Range(&quot;C4&quot;).Value might make a difference&quot;  If you didn&#39;t declare workingCell1 as a string then it might have made it a range object or variant."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 2, "creation_date": 1495670031, "post_id": 44164483, "comment_id": 75356185, "body": "obviously the character is not space. You can try to clean the text before splitting <code>splitArr = Split([clean(C4)], &quot;, &quot;)</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1495787985, "post_id": 44164483, "comment_id": 75407378, "body": "I&#39;d suspect you had an ANSI 160 character - often happens with data form the web. Using <code>Replace(text, chr(160), &quot;&quot;)</code> would work for that."}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 1, "creation_date": 1495650893, "post_id": 44165198, "comment_id": 75348581, "body": "That was my original solution, but that seems to not split the string at all. The result in my splitArr is a single element &quot;Tom, Adam, Ben, Sarah&quot;"}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 1, "creation_date": 1495651644, "post_id": 44165198, "comment_id": 75348961, "body": "Hmm.  It works for me.  Are you sure that the value in Range(&quot;C4&quot;) is what you think it is?"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 1, "creation_date": 1495653238, "post_id": 44165198, "comment_id": 75349680, "body": "Hmm, I just re-wrote the string in the Cell and it works fine. I&#39;m not sure what is wrong with the formatting of the original string, but this seems to be an issues with the source data, not the VBA."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": true, "score": 1, "last_activity_date": 1495647451, "creation_date": 1495647451, "answer_id": 44165198, "question_id": 44164483, "link": "https://stackoverflow.com/questions/44164483/vba-substitute-works-on-string-but-not-on-cell-contents/44165198#44165198", "title": "VBA: Substitute() works on string but not on Cell contents", "body": "<p>You don't need to remove the spaces.  Just include them as part of the delimiter in the Split function.</p>\n\n<pre><code>workingCell1 = Range(\"C4\") 'contains: Tom, Adam, Ben, Sarah\nsplitArr = VBA.Split(workingCell1, \", \")\n\nFor Each element In splitArr\n    Debug.Print (element)\nNext\n</code></pre>\n\n<p>Note the space after the comma in the delimiter argument in this line:</p>\n\n<pre><code>splitArr = VBA.Split(workingCell1, \", \")\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2161, "favorite_count": 0, "accepted_answer_id": 44165198, "answer_count": 1, "score": 1, "last_activity_date": 1495647451, "creation_date": 1495645029, "last_edit_date": 1495645960, "question_id": 44164483, "link": "https://stackoverflow.com/questions/44164483/vba-substitute-works-on-string-but-not-on-cell-contents", "title": "VBA: Substitute() works on string but not on Cell contents", "body": "<p>I've got a cell which contains the string \"Tom, Adam, Ben, Sarah\".\nI am trying to put each of these items into an array.\nThe Split() function does not seem to work with \", \" as a delimiter; only \",\"</p>\n\n<p>Therefore, I am trying to remove spaces from the string/cell before using Split(). In this case, I am using the Substitute() function because Replace() does not seem to work.</p>\n\n<pre><code>workingCell = \"Tom, Adam, Ben, Sarah\"\nworkingCell1 = Range(\"C4\") 'contains: Tom, Adam, Ben, Sarah\n\nworkingCell = WorksheetFunction.Substitute(workingCell, \" \", \"\")   'removes all spaces\nworkingCell1 = WorksheetFunction.Substitute(workingCell1, \" \", \"\") 'retains all spaces\n\nsplitArr = VBA.Split(workingCell1, \",\")\n\nFor Each element In splitArr\n    Debug.Print (element)\nNext\n</code></pre>\n\n<p>It seems that Range(\"C4\") is not being taken as a value, and is not treated as a string. Using Range(\"C4\").Value does not work either.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1495646158, "post_id": 44164429, "comment_id": 75346014, "body": "Protip: &quot;doesn&#39;t work&quot; isn&#39;t a very good way to describe what your code does. &quot;produces unexpected garbage&quot; would be more accurate. In general, you&#39;ll want to avoid &quot;my code doesn&#39;t work&quot; in SO questions, and instead <i>describe</i> what you&#39;re getting - garbage output, run-time error, etc."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1495656772, "post_id": 44164429, "comment_id": 75351438, "body": "Do you have any data validation to prevent me from selecting <code>2017&#47;02&#47;29</code> or <code>2017&#47;04&#47;31</code>? Is there a specific reason you don&#39;t want to use a calendar control which will provide this for you?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495649985, "post_id": 44164803, "comment_id": 75348116, "body": "Thanks Mat but it gives a &#39;Run time error 13. Type mismatch&#39;. Any ideas why?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495650040, "post_id": 44164803, "comment_id": 75348143, "body": "What&#39;s in these dropdowns? <code>DateSerial</code> expects integers. If your month dropdown contains <code>May</code> then you need a way to associate that to <code>5</code>. Consider having 2 columns in your dropdown, first being 0-width and containing values 1-12, second containing month names. Use the combobox&#39; <code>Value</code> to get the selected integer. Failing that, a keyed <code>Collection</code> mapping <code>May</code> (string key) to <code>5</code> (integer value) could work just as well."}, {"owner": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495650540, "post_id": 44164803, "comment_id": 75348394, "body": "Yes I have April, May, June  etc until March and not integers. I&#39;m not sure I understand how a keyed Collection would work. If you could show the code for that it would be very helpful. Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495650872, "post_id": 44164803, "comment_id": 75348563, "body": "@thankseveryone edited. It&#39;s much less code to make a multicolumn combobox though, and more robust, too."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495652602, "post_id": 44164803, "comment_id": 75349377, "body": "yeah that should work. now please don&#39;t edit your question <i>in response</i> to answers, it removes all the value from the question. Other people with similar issues will google up and come here. See <a href=\"https://stackoverflow.com/help/someone-answers\">help/someone-answers</a> if you&#39;re not sure what to do next."}, {"owner": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495652716, "post_id": 44164803, "comment_id": 75349430, "body": "I put the code like in my edited initial question above and the error now is &#39;run time error 438. Object doesn&#39;t support this property or method&#39; and it highlights in yellow the line about .cells(lrow, 2).value = Date serial(cboYear, monthID, cboDay). Is there anything I can do to fix this? Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495652898, "post_id": 44164803, "comment_id": 75349513, "body": "Makes no sense. Specify <code>Option Explicit</code>, declare all variables, watch for typos."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "edited": false, "score": 0, "creation_date": 1495653441, "post_id": 44164803, "comment_id": 75349785, "body": "IDK, try specifying <code>.Value</code> explicitly when reading the combobox values. Or ask a new question, since that&#39;s an entirely new problem. Error 438 is typically caused by blindly copy-pasting code instead of typing it and letting IntelliSense guide you. I gave you a <i>concept</i>, something to answer your original question."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1495650840, "last_edit_date": 1495650840, "creation_date": 1495645998, "answer_id": 44164803, "question_id": 44164429, "link": "https://stackoverflow.com/questions/44164429/combo-box-in-a-date-format/44164803#44164803", "title": "combo box in a date format", "body": "<p>You're dividing the year by the month, and then dividing that by the day. That's the value your cell is getting.</p>\n\n<p>Build an actual <em>date</em> instead.</p>\n\n<pre><code>.Cells(lRow, 2).Value = DateSerial(cboYear, cboMonth, cboDay)\n</code></pre>\n\n<p>And then format that date any way you wish, using <code>NumberFormat</code>:</p>\n\n<pre><code>.Cells(lRow, 2).NumberFormat = \"yyyy/MM/dd\"\n</code></pre>\n\n<hr>\n\n<p><code>DateSerial</code> expects integer values. If your <code>cboMonth</code> contains strings (month names), then you need to work a bit harder for it - the easiest is probably just to use a keyed collection - specify a string key when <code>.Add</code>ing the integers to the collection:</p>\n\n<pre><code>Static months As Collection\nIf months Is Nothing Then\n    Set months = New Collection\n    With months\n        .Add 1, \"January\"\n        .Add 2, \"February\"\n        .Add 3, \"March\"\n        '...\n        .Add 12, \"December\"\n    End With        \nEnd If\n</code></pre>\n\n<p>And then you have an easy lookup:</p>\n\n<pre><code>Dim monthId As Integer\nmonthId = months(cboMonth)\n</code></pre>\n\n<p>So your <code>DateSerial</code> would be:</p>\n\n<pre><code>.Cells(lRow, 2).Value = DateSerial(cboYear, monthId, cboDay)\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7634909, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5715f699b15199c6e00d30e9dff5487?s=128&d=identicon&r=PG&f=1", "display_name": "thankseveryone", "link": "https://stackoverflow.com/users/7634909/thankseveryone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 44164803, "answer_count": 1, "score": 0, "last_activity_date": 1495652611, "creation_date": 1495644850, "last_edit_date": 1495652611, "question_id": 44164429, "link": "https://stackoverflow.com/questions/44164429/combo-box-in-a-date-format", "title": "combo box in a date format", "body": "<p>my user form has three separate combo boxes for the users to select the following: Year, Month, Date (they are not dependent). For example if the user selects 2017 (the year), May(the month) and 23(the day) I want vba to enter in column two on my database sheet: \"2017/05/23\". I want it exactly in this format as a value. </p>\n\n<p>The code below doesn't work. Any help would be appreciated.  </p>\n\n<pre><code> With ws\n .Cells(lRow, 2).Value = Me.cboYear / Me.cboMonth / Me.cboDay.Value\n End With\n</code></pre>\n"}, {"tags": ["vba", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1495647073, "post_id": 44164924, "comment_id": 75346508, "body": "Wow... talk about missing the forest for the trees... Are you the florentbr of <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">SeleniumBasic</a> fame? If so, I&#39;m honored! Also, is work continuing on the project - there doesn&#39;t seem to have been much activity of late."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1495648580, "post_id": 44164924, "comment_id": 75347294, "body": "The project is still alive. I will release a new version soon to comply with the new Selenium 3 API and to support the new driver for Firefox."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1495648953, "post_id": 44164924, "comment_id": 75347525, "body": "Spectacular! Very glad to hear it."}, {"owner": {"reputation": 1382, "user_id": 1857125, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/247ee5061b93a3cfd724b862e6a0590f?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/1857125/kenny"}, "edited": false, "score": 0, "creation_date": 1568585189, "post_id": 44164924, "comment_id": 102309924, "body": "Is there a way to change download path while on <b>current session</b>, similar to how you click Chrome Settings-&gt;Download ? The answer I saw always incur <b>building new option + new driver + get a whole new session</b> . I would wish not to close the current session, since my folder separation based on each item in a drop-down list and there&#39;s no need to reload a new page. There are thousands of items in that drop-down; the accepted method means closing and loading the page thousands times."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1382, "user_id": 1857125, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/247ee5061b93a3cfd724b862e6a0590f?s=128&d=identicon&r=PG", "display_name": "Kenny", "link": "https://stackoverflow.com/users/1857125/kenny"}, "edited": false, "score": 0, "creation_date": 1612805435, "post_id": 44164924, "comment_id": 116875899, "body": "@Kenny this is why you should ask a whole new question of your own (referencing this one, if you choose), instead of asking a new question in the comments."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1495646405, "creation_date": 1495646405, "answer_id": 44164924, "question_id": 44164124, "link": "https://stackoverflow.com/questions/44164124/how-do-i-set-chrome-download-directory-with-selenium-vba/44164924#44164924", "title": "How do I set Chrome download directory with Selenium &amp; VBA", "body": "<p>The preferences from your example are specific to Firefox. You need to set the ones specific to Chrome to change the download directory:</p>\n\n<pre><code>Dim driver As New ChromeDriver\n\ndriver.SetPreference \"download.default_directory\", \"c:\\temp\"\ndriver.SetPreference \"download.directory_upgrade\", True\ndriver.SetPreference \"download.prompt_for_download\", False\ndriver.SetPreference \"safebrowsing.enabled\", True\ndriver.SetPreference \"plugins.plugins_disabled\", Array(\"Chrome PDF Viewer\")\n\ndriver.Get \"http://google.com\"\n\n\ndriver.Quit\n</code></pre>\n"}], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5974, "favorite_count": 1, "accepted_answer_id": 44164924, "answer_count": 1, "score": 3, "last_activity_date": 1495680061, "creation_date": 1495643960, "question_id": 44164124, "link": "https://stackoverflow.com/questions/44164124/how-do-i-set-chrome-download-directory-with-selenium-vba", "title": "How do I set Chrome download directory with Selenium &amp; VBA", "body": "<p>Using Win7, Office2010, Chrome 58, and Selenium 2.0.9, I'm automating the downloading of a number of files from a few websites (NB, I actually need the files and the sites are not mine - I'm <em>not</em> testing my own site), and I'd like to control where the files end up being downloaded.</p>\n\n<p>I have looked at quite a number of search results and everything I've found has led me to the following versions of code, each <code>Driver.SetPreference</code> variation has been tested independently and none of them work.</p>\n\n<pre><code>Private Sub DownloadDirTest()\n\n  Dim Driver As Selenium.ChromeDriver\n  Set Driver = New Selenium.ChromeDriver\n\n  Driver.SetPreference \"browser.download.dir\", \"\\\\server\\share\\my\\long\\path\"\n  Driver.SetPreference \"browser.download.dir\", \"\\\\\\\\server\\\\share\\\\my\\\\long\\path\"\n  'after mapping Y: to \"\\\\server\\share\\my\\long\\path\" in Windows Explorer\n  Driver.SetPreference \"browser.default_directory\", \"Y:\\\"\n  Driver.SetPreference \"browser.download.dir\", \"c:\\\"\n  Driver.SetPreference \"browser.default_directory\", \"c:\\\"\n\n  Driver.Start \"Chrome\", \"http://google.com\"\n\n  Driver.Close\n\nEnd Sub\n</code></pre>\n\n<p>As can been seen here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nWbhv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nWbhv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Most of the references I've seen are for Python, Java or Ruby, and they all make reference to something like:</p>\n\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(\"user-data-dir=/path/to/your/custom/profile\");\n</code></pre>\n\n<p>There doesn't seem to be any equivalent <code>ChromeOptions</code> available to VBA.</p>\n\n<p><strong>1)</strong> Does anyone know the actual property name to correctly set the download directory?</p>\n\n<p><strong>2)</strong> I'm not particularly wedded to Chrome, though it seems to be faster than <code>IEDriver</code> (in my initial testing), and I can't get the current Firefox driver to work. If someone has pointers to how to reliably set the DL directory in either of the other browsers (and a link to an updated Firefox driver - I haven't been able to find it via half-hearted searching), I'm open to using those.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495644243, "post_id": 44164041, "comment_id": 75344928, "body": "open a new workbook and give it a name, like wb.  Then copy sheet1 to destination wb before sheet1.  Then delete wb.sheet1. Then save wb with a filename the name of the sheet.  You can do all this with macro recorder."}, {"owner": {"reputation": 771, "user_id": 7392562, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ba47bc61ecca7021c911a2fad65f3f9a?s=128&d=identicon&r=PG&f=1", "display_name": "uSeruSher", "link": "https://stackoverflow.com/users/7392562/userusher"}, "edited": false, "score": 0, "creation_date": 1495644256, "post_id": 44164041, "comment_id": 75344939, "body": "<a href=\"https://www.extendoffice.com/documents/excel/628-excel-split-workbook.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/628-excel-split-workbook.ht&zwnj;&#8203;ml</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495646254, "creation_date": 1495646254, "answer_id": 44164878, "question_id": 44164041, "link": "https://stackoverflow.com/questions/44164041/vba-script-to-split-all-worksheets-in-a-workbook-to-separate-files/44164878#44164878", "title": "VBA Script to split all worksheets in a workbook to separate files", "body": "<p>Put this in a regular module:</p>\n\n<pre><code>Sub NewWb()\nDim ws As Worksheet\nDim wbActive As Workbook\nDim wbNew As Workbook\nDim x As Single\nApplication.ScreenUpdating = False\n    Set wbActive = ActiveWorkbook\n\n    For Each ws In wbActive.Worksheets\n        Set wbNew = Workbooks.Add\n        ws.Copy Before:=wbNew.Sheets(1)\n        abc = \"C:\\Files\\\" &amp; ws.Name &amp; \".xlsx\"\n        Application.DisplayAlerts = False\n        wbNew.Sheets(\"Sheet1\").Delete\n        Application.DisplayAlerts = True\n        wbNew.SaveAs Filename:=abc\n        wbNew.Close Saved = True\n    Next ws\n    Set ws = Nothing\n    Set wbActive = Nothing\n    Set wbNew = Nothing\n    Application.ScreenUpdating = True    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7794381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5cfeaa8f763a3d778760115b99bdfba?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Seidl", "link": "https://stackoverflow.com/users/7794381/steve-seidl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495646254, "creation_date": 1495643675, "last_edit_date": 1495644146, "question_id": 44164041, "link": "https://stackoverflow.com/questions/44164041/vba-script-to-split-all-worksheets-in-a-workbook-to-separate-files", "title": "VBA Script to split all worksheets in a workbook to separate files", "body": "<p>I have a script that does a vlookup for each sheet in workbook and then splits each worksheet into its own file. I have the below script, but it is not working. The vlookup portion is working fine, but I am having issues with the split. It doesn't fail and give me an error, it just doesn't do anything. </p>\n\n<pre><code>Sub Splitbook()\nMyPath = \"***Folder Location***\"\nFor Each sht In Workbooks(\"PO135 Division 1.xlsx\").Worksheets\nsht.Copy\nActiveSheet.Cells.Copy\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteValues\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteFormats\nActiveWorkbook.SaveAs _\nFilename:=MyPath &amp; \"\\\" &amp; sht.Name &amp; \".xlsx\"\nActiveWorkbook.Close savechanges:=False\nNext sht\nEnd Sub\n</code></pre>\n\n<p>I need to split the files and then save them in a distinct folder(\"<strong><em>Folder Location</em></strong>\")--this is just a placeholder for the time being, it would be updated prior to running the script--</p>\n\n<p>Any thoughts? Appreciate the help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495643627, "post_id": 44163923, "comment_id": 75344557, "body": "What is the data that you have in Sheet1B4? What do you want to change that to ? after applying this substitute formula?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495643713, "post_id": 44163923, "comment_id": 75344617, "body": "if your formulas are in one column just put the new formula in a different column that then refers to the ouput of the first and drag down."}, {"owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495644477, "post_id": 44163923, "comment_id": 75345054, "body": "@Gowtham Shiva the data in that sheet is irrelevant, I&#39;m just trying to add the seven substitution commands to every cell. Note that &#39;Sheet1&#39;!$B$4 is still in the edited formula."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495644542, "post_id": 44163923, "comment_id": 75345088, "body": "@CRBTC Why do you use a substitute function on an irrelevant data?"}, {"owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495644601, "post_id": 44163923, "comment_id": 75345128, "body": "@Scott Craner unfortunately the spreadsheet is not as well structured as I would like and I cannot change the arrangement of the cells as another spreadsheet depends on the values of this one."}, {"owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1495644691, "post_id": 44163923, "comment_id": 75345173, "body": "@Gowtham Shiva The data is relevant to my work, just irrelevant to what I am trying to do. What I&#39;m trying to do is replace <b>X</b> with =SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBS&zwnj;&#8203;TITUTE(SUBSTITUTE(<b>X</b>,&zwnj;&#8203;&quot;(&quot;,&quot;&quot;),&quot;)&quot;,&quot;&quot;),&quot;N&quot;,&zwnj;&#8203;&quot;&quot;),&quot;E&quot;,&quot;&quot;),&quot;S&quot;,&quot;&quot;),&zwnj;&#8203;&quot;W&quot;,&quot;&quot;),&quot;m&quot;,&quot;&quot;) in every cell on the spreadsheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1495644954, "post_id": 44163923, "comment_id": 75345323, "body": "To do this in place you will need vba.  You could easily do this and link it to a short cut key that will work on the selected cells."}, {"owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1495645251, "post_id": 44163923, "comment_id": 75345498, "body": "@Scott Craner I&#39;ll give that a shot and report back. Thanks."}, {"owner": {"reputation": 7231, "user_id": 236345, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ekgwV.jpg?s=128&g=1", "display_name": "Alfabravo", "link": "https://stackoverflow.com/users/236345/alfabravo"}, "edited": false, "score": 0, "creation_date": 1496332896, "post_id": 44163923, "comment_id": 75630227, "body": "Please mark your answer as accepted"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "is_accepted": true, "score": 0, "last_activity_date": 1495653083, "creation_date": 1495653083, "answer_id": 44166730, "question_id": 44163923, "link": "https://stackoverflow.com/questions/44163923/how-to-modify-multiple-formulas-at-once-in-the-same-way/44166730#44166730", "title": "How to modify multiple formulas at once in the same way?", "body": "<p>This was the macro I ended up making, and it worked!</p>\n\n<pre><code>Sub Macro1()\nDim CurrentCell As String\n  CurrentCell = ActiveCell.Formula\n  CurrentCell = Replace(\"=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@,\"\"(\"\",\"\"\"\"),\"\")\"\",\"\"\"\"),\"\"N\"\",\"\"\"\"),\"\"E\"\",\"\"\"\"),\"\"S\"\",\"\"\"\"),\"\"W\"\",\"\"\"\"),\"\"m\"\",\"\"\"\")\", \"@\", Mid(CurrentCell, 2))\n  ActiveCell.Formula = CurrentCell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11637030, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6d2e103eb13f9f148eeab475d8372910?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/11637030/gary"}, "is_accepted": false, "score": 0, "last_activity_date": 1560345150, "creation_date": 1560345150, "answer_id": 56563113, "question_id": 44163923, "link": "https://stackoverflow.com/questions/44163923/how-to-modify-multiple-formulas-at-once-in-the-same-way/56563113#56563113", "title": "How to modify multiple formulas at once in the same way?", "body": "<p>I believe if you highlight the range of cells containing the formulas you want to update then edit the first of those cells (top left) then use control enter, rather than just enter it will update all the formulas in the highlighted range.</p>\n"}], "owner": {"reputation": 3, "user_id": 8060697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70c377a1db383fb1b2e87bb8d064457?s=128&d=identicon&r=PG&f=1", "display_name": "CRBTC", "link": "https://stackoverflow.com/users/8060697/crbtc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 44166730, "answer_count": 2, "score": 0, "last_activity_date": 1560345150, "creation_date": 1495643346, "last_edit_date": 1531161705, "question_id": 44163923, "link": "https://stackoverflow.com/questions/44163923/how-to-modify-multiple-formulas-at-once-in-the-same-way", "title": "How to modify multiple formulas at once in the same way?", "body": "<p>I'm sure this has been asked and answered, but I can't word my question in a way that turns anything up.</p>\n\n<p>I figured out how to filter out certain characters from the data I receive by editing the formulas like this:</p>\n\n<pre><code>='Sheet1'!$B$4\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE('Sheet1'!$B$4,\"(\",\"\"),\")\",\"\"),\"N\",\"\"),\"E\",\"\"),\"S\",\"\"),\"W\",\"\"),\"m\",\"\")\n</code></pre>\n\n<p>What this does is remove any of those six characters from the cell. Note that the new formula contains the original formula within.</p>\n\n<p>I need to apply this change to all of the formulas in the sheet, and there are a lot of them. I tried playing around with <code>flash-fill</code>; no luck. Is there an easier way to \"add\" those substitute commands to all of the formulas without editing them all by hand?</p>\n\n<p>Thanks</p>\n\n<p>EDIT: This was the macro I ended up making, and it worked:</p>\n\n<pre><code>Sub Macro1()\nDim CurrentCell As String\n  CurrentCell = ActiveCell.Formula\n  CurrentCell = Replace(\"=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@,\"\"(\"\",\"\"\"\"),\"\")\"\",\"\"\"\"),\"\"N\"\",\"\"\"\"),\"\"E\"\",\"\"\"\"),\"\"S\"\",\"\"\"\"),\"\"W\"\",\"\"\"\"),\"\"m\"\",\"\"\"\")\", \"@\", Mid(CurrentCell, 2))\n  ActiveCell.Formula = CurrentCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "design-patterns"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1495643415, "post_id": 44163862, "comment_id": 75344420, "body": "Try it here and see if that works for you.  [;\\s.]"}, {"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1495643516, "post_id": 44163862, "comment_id": 75344481, "body": "Did not go through."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1495644211, "post_id": 44164123, "comment_id": 75344908, "body": "Wow! Saving link to this tool for the future references."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "edited": false, "score": 0, "creation_date": 1495644310, "post_id": 44164123, "comment_id": 75344970, "body": "Another very good page in my opinion is <a href=\"http://www.phpliveregex.com/\" rel=\"nofollow noreferrer\">phpliveregex.com</a> Even if it&#39;s called PHP, they use the same regexpatterns. What I like about this page is that it shows what the array will look like in a better way (in my opinion)."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 1, "last_activity_date": 1495643949, "creation_date": 1495643949, "answer_id": 44164123, "question_id": 44163862, "link": "https://stackoverflow.com/questions/44163862/vba-validate-list-of-emails-using-pattern/44164123#44164123", "title": "VBA validate list of emails using pattern", "body": "<p>Like this?<br>\n<a href=\"https://regex101.com/r/7IPvOB/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/7IPvOB/1</a></p>\n\n<p><code>^\\s?(([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5}){1,25})+([;.](([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5}){1,25})+)*$</code></p>\n"}, {"comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495644453, "post_id": 44164218, "comment_id": 75345042, "body": "Agree with you on that you don&#39;t want to regex email generally. If the user writes an email incorrect, then that is their problem. Not mine. +1 from me."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1495644238, "creation_date": 1495644238, "answer_id": 44164218, "question_id": 44163862, "link": "https://stackoverflow.com/questions/44163862/vba-validate-list-of-emails-using-pattern/44164218#44164218", "title": "VBA validate list of emails using pattern", "body": "<p>You're making your life much more complicated than it needs to be.</p>\n\n<pre><code>Dim addresses 'As Variant\naddresses = Split(addresses, \";\")\n</code></pre>\n\n<p>Done. You have your addresses in an array (albeit with an extra space, but you can easily trim it). A regex will inevitably exclude valid emails, unless it's compliant with the RFC822 standard for email addresses, and <a href=\"http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html\" rel=\"nofollow noreferrer\">you don't want such a regex pattern in your code</a>.</p>\n\n<blockquote>\n  <p><em>The grammar described in RFC 822 is surprisingly complex. Implementing validation with regular expressions somewhat pushes the limits of what it is sensible to do with regular expressions [...]</em></p>\n</blockquote>\n"}], "owner": {"reputation": 347, "user_id": 6712951, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/76695526b789999adfdd389a09b50a29?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/6712951/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 44164123, "answer_count": 2, "score": 0, "last_activity_date": 1495644238, "creation_date": 1495643139, "question_id": 44163862, "link": "https://stackoverflow.com/questions/44163862/vba-validate-list-of-emails-using-pattern", "title": "VBA validate list of emails using pattern", "body": "<p>I have got list of emails in a cell separated by semi-colons and space but i have got the pattern which validates emails only if they are separated by semi-colons. Where do I insert the space to fit my pattern?</p>\n\n<p>Example of emails:\naaa@bbb.com; ccc@eee.com; fff@ggg.com</p>\n\n<p>Amount of email addresses in a single cell varies from 1 to 20</p>\n\n<p>Pattern validating emails separated by semi-colons:</p>\n\n<pre><code>^(([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5}){1,25})+([;.](([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5}){1,25})+)*$\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495644771, "post_id": 44163858, "comment_id": 75345225, "body": "You can&#39;t. <code>ComboBox</code> only ever has a single selected item. Put a search <code>TextBox</code> (heck, or use a <code>ComboBox</code> to get autocomplete for free!) atop your <code>ListBox</code> control and handle control events accordingly; you&#39;ll need a button to remove one/all items from the listbox, too."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495645575, "post_id": 44163858, "comment_id": 75345696, "body": "@Mat&#39;sMug I Couldn&#39;t agree more with what you are saying. I&#39;m Surprised they don&#39;t have this facility for some reason. Can you write a sample example with code as an answer. I will go ahead and mark it. I have searched all the web for one complete day. I couldn&#39;t find one single thing useful. It will be useful for many if you can write a brief answer :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495645704, "post_id": 44163858, "comment_id": 75345761, "body": "Not really. Your question is too broad, you asked for ideas and I gave you one - <i>you</i> implement it. Ask a question when you&#39;re stumped on something more specific."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495645769, "post_id": 44163858, "comment_id": 75345793, "body": "I will do that anyways. I will get that done and update the answer :)"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495643128, "creation_date": 1495643128, "question_id": 44163858, "link": "https://stackoverflow.com/questions/44163858/vba-multiselect-in-a-dropdown", "title": "VBA - MultiSelect in a DropDown", "body": "<p>I have a Requirement Where a bundle of Items needs to be displayed in the Drop-Down List. The Problem for me is, because there are so many Items inside it, I need to Use Combobox over List-Box. The Reason for that is, if I know the name of the item, I can type in the search box of the drop-down and get my Item, Combo-Box allows you to do that. But the List Box doesn't allow the User Input.</p>\n\n<p>Now, Because there are some which names cannot be remembered, I need to use the Scroll bar in the drop-down to pick up the time. This is hectic, to select a single Item. I would like to have the facility of Using a Multi-select in this case.</p>\n\n<p><strong>So the Requirements are below:</strong></p>\n\n<p>1) A Drop-Down that allows the user to type in part of the Input(Say Ref for Refreigerator)</p>\n\n<p>2) A Drop-Down that allows the Multi-select.</p>\n\n<p>Obviously, I don't want to have two drop-downs Splitting the data.</p>\n\n<p>I am open to other Suggestions.</p>\n\n<p>Please Share your thoughts.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495644033, "post_id": 44163752, "comment_id": 75344812, "body": "HI, I don&#39;t think it&#39;s possible, looking at the schema(<code>connection.OpenSchema(adSchemaTables)</code>) of a workbook, with 3 sheets, and 1 table, gives the following <code>Sheet1$;Sheet2$;Sheet3$</code> as possible tables to query from, my table Table1 is not there."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1495644231, "post_id": 44163752, "comment_id": 75344921, "body": "If the named range works, then you could try using both, a named range that is built off <code>offset</code> from an anchor top left of your table, counta right and down for it&#39;s dimensions.  Not 100% sure it will work from o/s tho"}, {"owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495659540, "post_id": 44163752, "comment_id": 75352723, "body": "Thanks for the info. I will stay with named range."}], "owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495642842, "creation_date": 1495642842, "question_id": 44163752, "link": "https://stackoverflow.com/questions/44163752/use-sql-to-query-another-excel-file", "title": "Use SQL to Query another excel file", "body": "<p>I'm try an alternative to solve this <a href=\"https://stackoverflow.com/questions/44156402/initialization-of-data-source-failed-excel-2013\">issue</a> using VBA to get the data.</p>\n\n<p>The following code works fine when \"Tbltest\" is a range but not working when the name represent a table. How can I make it work with Table not range.</p>\n\n<pre><code>Function ConnectToExelPRJReview()\n\nDim Xlpath As String\nOn Error GoTo ErrHandlerconnection:\n\nDim Xlcn As ADODB.Connection\nDim Xlrs As ADODB.Recordset\n\nXlpath = \"\\\\xxx.xxx.xxxxxx.net\\project_review\\wip\\\" &amp; \"filetotest.xlsm\"\nstrCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Xlpath _\n&amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n\nSet Xlcn = CreateObject(\"ADODB.Connection\")\nSet Xlrs = CreateObject(\"ADODB.Recordset\")\n\nXlcn.Open strCon\n\n\nstrSQL = \"SELECT * FROM [Tbltest]\"\n\nXlrs.Open strSQL, Xlcn\n\n'display the first data\n\nMsgBox Xlrs.Fields(0).Value\n\nXlcn.Close\n\nExit Function\nErrHandlerconnection:\nMsgBox Err.Number &amp; \"   \" &amp; Err.Description, vbCritical, \"EXCEL CONNECTION ERROR\"\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5oPmj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5oPmj.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Umx2K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Umx2K.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495643080, "post_id": 44163663, "comment_id": 75344231, "body": "Your title seems to point toward confusion with late vs early binding. The code is identical in both cases, the only difference is that when you code against <code>Object</code> VBA resolves the member calls at run-time, whereas with early-binding they&#39;re resolved at compile-time (hence you get IntelliSense &amp; auto-completion)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495643180, "post_id": 44163663, "comment_id": 75344285, "body": "Just do <code>Dim accApp As Access.Application</code>. Done."}, {"owner": {"reputation": 53, "user_id": 2438356, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a2c02a200c619495f6e03bf2a9bdc8dc?s=128&d=identicon&r=PG", "display_name": "Randall Lee", "link": "https://stackoverflow.com/users/2438356/randall-lee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495643901, "post_id": 44163663, "comment_id": 75344724, "body": "I had to tweak that a bit and do <code>Set accApp = CreateObject(&quot;Access.Application&quot;)</code> and added <code>accApp.Application.Run &quot;modulename.macroname&quot;</code> near the end but now I am getting <code>Run time error Method Run of object &quot;Application&quot; failed</code> I am looking into now"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495643996, "post_id": 44163663, "comment_id": 75344795, "body": "If you&#39;re early binding, just <code>Set accApp = New Access.Application</code>.... there is no reason to change any of the <code>.OpenCurrentDatabase</code> or <code>.DoCmd.RunMacro</code> code. <i>Early/Late-bound code does the exact same identical thing. The <b>only</b> difference is that late-bound calls are resolved at run-time</i>."}, {"owner": {"reputation": 53, "user_id": 2438356, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a2c02a200c619495f6e03bf2a9bdc8dc?s=128&d=identicon&r=PG", "display_name": "Randall Lee", "link": "https://stackoverflow.com/users/2438356/randall-lee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495645091, "post_id": 44163663, "comment_id": 75345404, "body": "I think I&#39;m almost there...but now I&#39;m getting an error where it can&#39;t find the Access sub. It&#39;s a Sub, not a Function, and it&#39;s in a regular module. Is there a better syntax than what I have above?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495645223, "post_id": 44163663, "comment_id": 75345478, "body": "Not familiar with Access, but from the <a href=\"https://github.com/rubberduck-vba/Rubberduck/blob/ad63b1a4ce6d993f9263db4c1c0a131427cbfe20/Rubberduck.VBEEditor/Application/AccessApp.cs#L36-L44\" rel=\"nofollow noreferrer\">Rubberduck source code</a> it seems <code>Application.Run</code> only supports <code>ProjectName.MacroName</code> syntax - omit the module name if you have it, and make sure the name is unambiguous."}], "owner": {"reputation": 53, "user_id": 2438356, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a2c02a200c619495f6e03bf2a9bdc8dc?s=128&d=identicon&r=PG", "display_name": "Randall Lee", "link": "https://stackoverflow.com/users/2438356/randall-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495642518, "creation_date": 1495642518, "question_id": 44163663, "link": "https://stackoverflow.com/questions/44163663/how-do-i-call-an-access-sub-from-excel-when-access-is-declared-as-a-database-and", "title": "How do I call an Access sub from Excel when Access is declared as a Database and not an Object?", "body": "<pre><code>    Sub exportRecords()\n\n    Dim report As Worksheet\n    Set report = Sheets(\"Report\")\n\n    Dim lastrow, x As Integer\n        With report\n            lastrow = report.Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        End With\n\n    Dim db As Database\n    Dim rs As DAO.Recordset\n\n    Set db = OpenDatabase(\"\\\\~\\myDB.accdb\")\n    Set rs = db.OpenRecordset(\"TblData\", dbOpenTable)\n\n    For x = 2 To lastrow\n        If report.Range(\"AI\" &amp; x) = \"MSH\" Then\n            rs.AddNew\n            rs.Fields(\"Date\") = report.Range(\"A\" &amp; x).Value\n            rs.Fields(\"AgentName\") = report.Range(\"E\" &amp; x).Value\n            rs.Fields(\"Tardy\") = report.Range(\"S\" &amp; x).Value\n            rs.Fields(\"Comments\") = report.Range(\"X\" &amp; x).Value\n            rs.Update\n        Else\n        End If\n    Next x\n\n    '****THIS IS WHERE I WANT TO RUN THE ACCESS SUB/MACRO****\n\n    rs.Close\n    db.Close\n\n\n    End Sub\n</code></pre>\n\n<p>I am familiar with how to call an external sub if Access is declared as an object:</p>\n\n<pre><code>Dim accApp As Object\nSet accApp = CreateObject(\"Access.Application\")\naccApp.OpenCurrentDatabase(\"\\\\~\\myDB.accdb\")\naccApp.DoCmd.RunMacro \"Modulename.Macroname\"\n</code></pre>\n\n<p>But if I go that route then I'm unsure how to add the records using DAO like I am below. Is there any other way to call the sub?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1495642483, "post_id": 44163512, "comment_id": 75343825, "body": "@sbagnato Glad it worked. Please take a minute to accept the answer to mark your question as Solved."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1495643203, "post_id": 44163512, "comment_id": 75344301, "body": "Better yet, only declare var1 in Userform and use like so: With StartSelection .Show Msgbox .Var1 ENd With"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1495643901, "post_id": 44163512, "comment_id": 75344725, "body": "@jkpieterse not really much better, still works off the default instance, therefore will hit the exact same issues/bugs as without that <code>With</code> block."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1495706291, "post_id": 44163512, "comment_id": 75369504, "body": "See, never assume and then post things :-) You&#39;re right of course."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1495642102, "creation_date": 1495642102, "answer_id": 44163512, "question_id": 44163328, "link": "https://stackoverflow.com/questions/44163328/excel-vba-public-variable-not-passing-between-modules/44163512#44163512", "title": "Excel VBA - Public variable not passing between modules", "body": "<p>Remove the Public variable declaration from the UserForm Module and declare it on a Standard Module only.</p>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "accepted_answer_id": 44163512, "answer_count": 1, "score": 1, "last_activity_date": 1495642102, "creation_date": 1495641550, "question_id": 44163328, "link": "https://stackoverflow.com/questions/44163328/excel-vba-public-variable-not-passing-between-modules", "title": "Excel VBA - Public variable not passing between modules", "body": "<p>I am trying to pass a publicly declared variable's value from a userform back to a module where the code initially started.  I can print the value of the variable in the userform, but it does not persist when the code jumps back to the starting module.\nOption Explicit is declared on both sides, and I declared the single variable as well (ignore the var2 - var6 as they are not in use until I fix this singular issue).</p>\n\n<p>The code path starts in the first section below, jumps to the userform at \"StatSelection.Show\" and then jumps back at the end of the userform sub.  The first debug.print provides the variable, but the second one is blank..</p>\n\n<p>The main code is:</p>\n\n<pre><code>Option Explicit\n\nPublic var1 As String\n\nSub NoNameGame2FirstRoundResults()\n'\n' NoNameGame Macro\n'\n'\n'Load Round 1 file\n    Dim r1Name As Variant\n    Dim nngr1r As Workbook\n    ChDir \"D:\\Users\\stefan.bagnato\\Desktop\\No Name Game\"\n    r1Name = Application.GetOpenFilename\n    If r1Name &lt;&gt; False Then\n        Set nngr1r = Workbooks.Open(r1Name)\n    End If\n\n'Load previous week's file\n    Dim r1rName As Variant\n    Dim wps As Workbook\n    ChDir \"D:\\Users\\stefan.bagnato\\Desktop\\Weekly Performance Summary\"\n    r1rName = Application.GetOpenFilename\n    If r1rName &lt;&gt; False Then\n        Set wps = Workbooks.Open(r1rName)\n    End If\n\n'Create radio buttons to select week 1 stat\n    StatSelection.Show\n\n'Parse Column B for names, and paste corresponding data in column C\nnngr1r.Activate\n\nDebug.Print var1\n\nActiveWorkbook.Worksheets(\"Sheet1\").Columns(2).Find(\"Adam\").Offset(N, 1) = var1\n\nEnd Sub\n</code></pre>\n\n<p>The userform is:</p>\n\n<pre><code>    Option Explicit\n\nPublic var1 As String\n\nSub OptionButton1_Click()\n    Dim wps As Workbook, x As String\n    For Each wps In Workbooks\n    If wps.name &lt;&gt; ThisWorkbook.name Then x = wps.name\n    Next wps\n    Workbooks(x).Activate\n\n    var1 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F4\")), \"hh:mm:ss\")\n    var2 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F5\")), \"hh:mm:ss\")\n    var3 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F6\")), \"hh:mm:ss\")\n    var4 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F7\")), \"hh:mm:ss\")\n    var5 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F9\")), \"hh:mm:ss\")\n    var6 = Format((ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"F10\")), \"hh:mm:ss\")\n\n\n    Debug.Print var1\n\n    Me.Hide\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1495641863, "post_id": 44163271, "comment_id": 75343461, "body": "That is a very strange UI design. May I suggest to use either right-click or Shift+click for the alternate function? Use the <code>_MouseDown</code> event to catch these."}, {"owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1495642640, "post_id": 44163271, "comment_id": 75343941, "body": "@Andre Thank You!! If you submit that as an answer, I will accept it"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1495646958, "creation_date": 1495646958, "answer_id": 44165074, "question_id": 44163271, "link": "https://stackoverflow.com/questions/44163271/ms-access-button-with-on-click-and-on-double-click-events-vba/44165074#44165074", "title": "MS Access button with on click and on double click events (VBA)", "body": "<p>Putting <code>Click</code> and <code>DblClick</code> events on a button is IMO a rather confusing UI design. Better is to use either right-click or Shift+click (or Alt or Ctrl) for alternate functions.</p>\n\n<p>The <code>Click</code> event doesn't catch these modifiers, only <code>MouseDown</code> and <code>MouseUp</code>. It feels most natural if the actions are put in the <code>MouseUp</code> event procedure, e.g.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdMultiClick_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)\n\n    Dim SelectedFunction As String\n\n    If Button = acLeftButton Then\n        If (Shift And acShiftMask) Then\n            SelectedFunction = \"Shift-Left click!\"\n        Else\n            SelectedFunction = \"Left click!\"\n        End If\n    ElseIf Button = acRightButton Then\n        SelectedFunction = \"Right click!\"\n        ' Cancel the default right-click behavior (open context menu)\n        DoCmd.CancelEvent\n    End If\n\n    MsgBox SelectedFunction, vbInformation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6052693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c5554d0b95c0444b0bdf1cf09a644cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kayracer", "link": "https://stackoverflow.com/users/6052693/kayracer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2616, "favorite_count": 0, "accepted_answer_id": 44165074, "answer_count": 1, "score": 1, "last_activity_date": 1495646958, "creation_date": 1495641359, "question_id": 44163271, "link": "https://stackoverflow.com/questions/44163271/ms-access-button-with-on-click-and-on-double-click-events-vba", "title": "MS Access button with on click and on double click events (VBA)", "body": "<p>I have a button on a form in ms-access where I have both a \"On Click\" and \"on Dbl Click\" events filled.  I am running into the problem that the single click event works but the double click will not unless on the second click, I keep holding it down and drag the mouse off the button before I release it.  What this button does is it fills a textbox with certain text depending on the 2 different clicks. How is it I can fix this double click issue?  The code for the buttons is below.  Note that Task_ID_AfterUpdate() also fills in text fields according to what the Me.Task_ID is by looking it up in a Query.</p>\n\n<pre><code>'single click\nPrivate Sub getBtn_Click()\n    btnUpdateHelper (1162)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>'double click\nPrivate Sub getBtn_DblClick(cancel As Integer)\n    btnUpdateHelper (1449)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub btnUpdateHelper(Task As Variant)\n    'helper method for buttons, only pass task id\n    'Me.Task_ID is a textfield\n    Me.Task_ID = Task\n    Task_ID_AfterUpdate\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Task_ID_AfterUpdate()\n    Dim taskIdNum As String\n    taskIdNum = Me.Task_ID\n    'updates all fields to display the selected task\n    Me.Area = DLookup(\"Area\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Activity = DLookup(\"Activity\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Description = DLookup(\"Description\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Comments = DLookup(\"Comments\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Task_Group = DLookup(\"[Task Group]\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Mul = DLookup(\"Mul\", \"Query\", \"TaskID=\" &amp; taskIdNum)\n    Me.Time = DLookup(\"Time\", \"Query\", \"TaskID=\" &amp; taskIdNum)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "cmd"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4677534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/363f3f6a234f9f26ddd9da8bee7cb1b7?s=128&d=identicon&r=PG&f=1", "display_name": "BAW331", "link": "https://stackoverflow.com/users/4677534/baw331"}, "edited": false, "score": 0, "creation_date": 1495698266, "post_id": 44163410, "comment_id": 75364902, "body": "Thanks CLR for the help. I found that whenever I ran that code, it wouldn&#39;t do anything. If I put &quot;ipconfig&quot;, it would work but with my long string, it wouldn&#39;t parse into the cmd command line. But thanks for the help!"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 43, "user_id": 4677534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/363f3f6a234f9f26ddd9da8bee7cb1b7?s=128&d=identicon&r=PG&f=1", "display_name": "BAW331", "link": "https://stackoverflow.com/users/4677534/baw331"}, "edited": false, "score": 0, "creation_date": 1495700754, "post_id": 44163410, "comment_id": 75366277, "body": "It should work. The only thing you have to watch out for is spaces in the filename or folder names. If there are spaces, you have to wrap paths in double-quotes. Never mind though, it looks like you found a workaround but FYI there is nothing wrong with using the shell in the way you originally described if you get the syntax right."}, {"owner": {"reputation": 43, "user_id": 4677534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/363f3f6a234f9f26ddd9da8bee7cb1b7?s=128&d=identicon&r=PG&f=1", "display_name": "BAW331", "link": "https://stackoverflow.com/users/4677534/baw331"}, "edited": false, "score": 0, "creation_date": 1495721716, "post_id": 44163410, "comment_id": 75379488, "body": "hhhmm I guess I should have spend a bit more time with the code above as its simpler than what I used in the end. Hopefully anyone who stumbles on this thread will find it useful tho! Cheers CLR!"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1495641741, "creation_date": 1495641741, "answer_id": 44163410, "question_id": 44163233, "link": "https://stackoverflow.com/questions/44163233/using-excel-vba-to-run-a-cmd-command/44163410#44163410", "title": "Using Excel VBA to run a CMD command", "body": "<p>If in doubt, send the text to the Immediate Window to see if it still matches the syntax using:</p>\n\n<pre><code> Debug.Print \"cmd.exe /S /C \" &amp; locationofprogram &amp; \" \" &amp; \"-w\" &amp; \" \" &amp; outputfolder &amp; \" \" &amp; listoffiles\n</code></pre>\n\n<p>If that works, use:</p>\n\n<pre><code> wsh.Run \"cmd.exe /S /C \" &amp; locationofprogram &amp; \" \" &amp; \"-w\" &amp; \" \" &amp; outputfolder &amp; \" \" &amp; listoffiles, windowStyle, waitOnReturn\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 1, "last_activity_date": 1495643654, "creation_date": 1495643654, "answer_id": 44164030, "question_id": 44163233, "link": "https://stackoverflow.com/questions/44163233/using-excel-vba-to-run-a-cmd-command/44164030#44164030", "title": "Using Excel VBA to run a CMD command", "body": "<p>You can always create a .bat file, run the file, then delete it.  </p>\n\n<pre><code>MyFile = \"C:\\Bat-File\\Bat-File.bat\"\n\nfnum = FreeFile()\nOpen MyFile For Output As #fnum\nPrint #fnum, \"C:\\Program Files\\example program.exe -w C:\\Program files\\outputfile.file dir1 dir2 dir n+1\"    \nClose #fnum\n\nShell MyFile, vbNormalFocus\n\n' wait 10 seconds to let bat file finnish\nnewHour = Hour(Now()) \nnewMinute = Minute(Now()) \nnewSecond = Second(Now()) + 10 \nwaitTime = TimeSerial(newHour, newMinute, newSecond) \nApplication.Wait waitTime\n\n' delete bat-file\nkill MyFile\n</code></pre>\n\n<p>I can't test that example program runs without the \" around the dir\u00b4s so you have to see what happens.<br>\nBut if it does not work you need to double enclose the \" or use <code>&amp; CHR(34) &amp;</code></p>\n"}], "owner": {"reputation": 43, "user_id": 4677534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/363f3f6a234f9f26ddd9da8bee7cb1b7?s=128&d=identicon&r=PG&f=1", "display_name": "BAW331", "link": "https://stackoverflow.com/users/4677534/baw331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9958, "favorite_count": 0, "accepted_answer_id": 44164030, "answer_count": 2, "score": 1, "last_activity_date": 1495643654, "creation_date": 1495641237, "question_id": 44163233, "link": "https://stackoverflow.com/questions/44163233/using-excel-vba-to-run-a-cmd-command", "title": "Using Excel VBA to run a CMD command", "body": "<p>I would like to use Excel VBA to run a CMD command.</p>\n\n<p>The basic cmd command is:</p>\n\n<pre><code>\"C:\\Program Files\\example program.exe\" -w C:\\Program files\\outputfile.file \"dir1\" \"dir2\" \"dir n+1\"\n</code></pre>\n\n<p>The first part is the location of the program that will merge the files together.\nThe second part is the file location of the outputted merged files.\nAnd the \"dir1\".... is the files that will be merged together.</p>\n\n<p>I have code that lists the files to be merged but struggling to get the CMD code to get it so it does what I want as mentioned above. I have tried the following:</p>\n\n<pre><code>   Sub RunCMD()\n\n        Dim wsh As Object\n        Set wsh = VBA.CreateObject(\"WScript.Shell\")\n        Dim waitOnReturn As Boolean: waitOnReturn = True\n        Dim windowStyle As Integer: windowStyle = 1\n        Dim locationofprogram as string\n       'dir of program that will do the merge\n        Dim outputfolder as string\n       'dir of where the merged file will go\n        Dim listoffiles as string\n       'list of files to be merged\n\n        wsh.Run \"cmd.exe /S /C locationofprogram &amp; \" \" &amp; \"-w\" &amp; \" \" &amp; outputfolder &amp; \" \" &amp; listoffiles, windowStyle, waitOnReturn\n\n    End Sub\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1495644847, "post_id": 44163109, "comment_id": 75345268, "body": "What is the source of your input? Natively, there is no <i>list</i> or <i>set</i> structure in VBA. And why MS Access? Do you need storage in a database? Please give full context of your problem as this sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 701, "user_id": 749673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0mUeO.jpg?s=128&g=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/749673/tony"}, "edited": false, "score": 0, "creation_date": 1495657817, "post_id": 44163109, "comment_id": 75351916, "body": "Can you insert all of the values from all the lists into a one column table then run a query on that table sorting by the column then divide that record set into n sections? Am I over-simplifying the problem?"}, {"owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "edited": false, "score": 0, "creation_date": 1495737541, "post_id": 44163109, "comment_id": 75389026, "body": "Hi Parfait.  Thanks for following up (again).  I&#39;m using MS Access because I require a GUI, tables and reports (which I&#39;m familiar with in MS Access).  I hope my edit provides proper context."}, {"owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "edited": false, "score": 0, "creation_date": 1495737721, "post_id": 44163109, "comment_id": 75389140, "body": "Hi Tony. Thank you for your response.  Given that the numbers of schools by region and overall student counts are not equal, I believe it&#39;s a more complex solution (if everything was equal, then I think your solution would work; sort and divide by the number of staff)."}, {"owner": {"reputation": 701, "user_id": 749673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0mUeO.jpg?s=128&g=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/749673/tony"}, "edited": false, "score": 1, "creation_date": 1495740759, "post_id": 44163109, "comment_id": 75390690, "body": "This is an interesting problem. So there are roughly 1500 schools, each with <code>n</code> number of students. Is the region important? What do you think happens if you sum <code>n</code> and divide by the number of staff, then sort the entire list of schools descending and iterate through that list assigning that school to the staff member with the fewest students assigned? Once a staff member hits the <code>n&#47;staff</code> number then that staff member is removed from the list of staff members accepting new students. I&#39;m just spitballing here."}, {"owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "edited": false, "score": 1, "creation_date": 1495741846, "post_id": 44163109, "comment_id": 75391275, "body": "Hi Tony.  Thanks for taking the time to consider this problem.  Yes, the Region component also has to be (as close as possible) equally divided, which is what makes (for me) a complex problem.  I&#39;ve been reading various posts and this seems to be akin to what is referred to as a &#39;bin sorting&#39; problem, however, that&#39;s one dimensional (equally distributing a one quantity into bins) where as I have two dimensions to be equally distributed (number of schools by region and overall student counts)."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1495769647, "post_id": 44163109, "comment_id": 75399985, "body": "There are repeating values in your sample lists. Is this normal?"}, {"owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "edited": false, "score": 0, "creation_date": 1495770253, "post_id": 44163109, "comment_id": 75400104, "body": "Hi Ivan.  Yes, the number of students can be the same (schools are unique, the number of students is not)."}, {"owner": {"reputation": 701, "user_id": 749673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0mUeO.jpg?s=128&g=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/749673/tony"}, "edited": false, "score": 0, "creation_date": 1496426090, "post_id": 44163109, "comment_id": 75673471, "body": "Dave, did you get this solved? Are you still working on it? Just thinking through it I think the key points are creating a greedy algorithm that leverages the ability of Access to mimic complex data structures with tables and queries. It appears that the regions can be split, in other words more than one staff member can have schools from the West region. If that is the case then I still think it is a case of ordering the first table by student count descending then picking an arbitrary starting staff member and giving them the school-region combination with the highest count."}, {"owner": {"reputation": 701, "user_id": 749673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0mUeO.jpg?s=128&g=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/749673/tony"}, "edited": false, "score": 0, "creation_date": 1496426254, "post_id": 44163109, "comment_id": 75673559, "body": "After that then use the school count, region count, and student count to pick the next staff member. You will have to set a priority on the three counts when determining the next staff member and pick an arbitrary one in the event of a tie."}, {"owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "edited": false, "score": 0, "creation_date": 1496521270, "post_id": 44163109, "comment_id": 75698863, "body": "Hi Tony.  Thanks for your response.  As of yesterday, I have pieced together a solution (it&#39;s not very elegant) that seems to work.  I have to spend a bit of time testing it and I&#39;ll post the solution when I&#39;m done.  Again, thank you for your time and effort.  Dave"}], "owner": {"reputation": 37, "user_id": 7687989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/57716845a118e5c498ce66e50e27b1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Dave P.", "link": "https://stackoverflow.com/users/7687989/dave-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594639888, "creation_date": 1495640857, "last_edit_date": 1594639888, "question_id": 44163109, "link": "https://stackoverflow.com/questions/44163109/equally-distribute-values-across-multiple-sets", "title": "Equally distribute values across multiple sets", "body": "<h2>Background/context:</h2>\n\n<p>I have a table containing a listing of schools, each having a geographic region and a number of students to be contacted:</p>\n\n<pre><code>school_id, region, student_count\n1, West, 23\n2, Central, 33\n3, East, 55\n4, West, 7\n5, West, 18\n6, Central, 45\n7, Central, 15\n8, West, 32\nEtc.\nEtc\u2026 (there are ~1500 schools)\n</code></pre>\n\n<ul>\n<li>All schools are to be assigned to a group of support staff that will send out letters to the students at each school.</li>\n<li>The distribution of schools (by region) and student count (for all schools) has to be divided as equally as possible.  That is to say, if there are 5 support staff, the division of schools by region and student count should be (as close to) equal as possible for each staff person.  That said, the overall number of schools per region and student count will vary, i.e., the number of regions and student counts will never been equally divisible.</li>\n</ul>\n\n<h2>Specific problem:</h2>\n\n<p>I assumed the solution would require dividing up the schools by region (into lists), and then the values from them would be divided among the support staff members. The end result would be written to a table called <code>staff_assignment</code>:</p>\n\n<pre><code>staff_id, school_id\n1, 1\n1, 6\n1, 3\n2, 8\n2, 7\n2, 4\nEtc.\nEtc\u2026\n</code></pre>\n\n<p>So, <strong>I need to equally distribute 3 lists of values amongst n sets.</strong>  The distribution of the 3 lists needs to be (as close to) equal\nfor both the number of items being distributed as well as the overall total values for each set.  For example:</p>\n\n<pre><code>List 1 [27, 55, 34, 15, 8, 22, 17, 9, 13, 5, 25, 16, 36, 6, 17, 26, 37]\nList 2 [10, 32, 46, 24, 19, 23, 14, 51, 41, 12, 18, 64, 9, 11]\nList 3 [11, 49, 30, 29, 25, 20, 9, 13, 50, 12, 32, 39, 18, 12, 21, 33, 20, 15, 23, 11]\n\nwould be distributed amongst (in this case) 5 sets as:\n\nSet 1 [L1.27, L2.24, L3.25, etc., etc.]\nSet 2 [L1.55, L2.64, L3.49, etc., etc.]\nSet 3 [L1.34, L2.32, L3.33, etc., etc.]\nSet 4 [L1.15, L2.14, L3.15, etc., etc.]\nSet 5 [L1.8, L2.9, L3.9, etc.,etc.]\n</code></pre>\n\n<p>I am implementing this via an MS Access Form, so the solution will be done using VBA (the list values and number of sets for distribution will be obtained from user input via the Form).</p>\n\n<p>I have searched this site and the Net and there are some solutions, but they are all for other programming languages (e.g., C++, Ruby) that I have no experience with (I'm an in-house 'resource' who knows just enough to be the one who gets asked to concoct solutions to this kind of stuff). So, I just hoped there may a Black Belt VBA guru here that couyld explain how to do the same in VBA. </p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1495640822, "post_id": 44162968, "comment_id": 75342760, "body": "<code>rw.Interior.ColorIndex = 22</code> will do and <code>select case rw.cells(1,5)</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1495640865, "post_id": 44162968, "comment_id": 75342803, "body": "Why not use Conditional Formatting instead of a macro?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1495641464, "post_id": 44162968, "comment_id": 75343201, "body": "<code>For Each rw In sh.Rows</code> should be <code>For Each rw In sh.USEDRANGE.Rows</code> or you are going to examine 1,048,576 rows. There are other alternatives to finding the last non-blank row."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495642112, "post_id": 44162968, "comment_id": 75343620, "body": "Is <code>result</code> declared? Or used anywhere? Because right now it seems to be just an undeclared local being assigned and then promptly discarded. Also, yeah, <code>Exit For</code> just before <code>Next</code> ...is going to force-choke the loop after the first iteration."}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 7995847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTJwg.png?s=128&g=1", "display_name": "FishermansFriend", "link": "https://stackoverflow.com/users/7995847/fishermansfriend"}, "is_accepted": false, "score": 2, "last_activity_date": 1495641004, "creation_date": 1495641004, "answer_id": 44163169, "question_id": 44162968, "link": "https://stackoverflow.com/questions/44162968/conditional-case-statement-using-excel-vba-code/44163169#44163169", "title": "Conditional Case statement using Excel VBA code", "body": "<p>The line <code>Exit For</code> stops your iteration after the first time. I think, this is not, what you want. Or you have to write it inside the case-statement. </p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1495642601, "creation_date": 1495642601, "answer_id": 44163690, "question_id": 44162968, "link": "https://stackoverflow.com/questions/44162968/conditional-case-statement-using-excel-vba-code/44163690#44163690", "title": "Conditional Case statement using Excel VBA code", "body": "<pre><code>result = Range(rw.Row).Interior.ColorIndex = 40\n</code></pre>\n\n<p>That's an assignment. It's assigning to <code>result</code>, the value of the expression to the right of the assignment operator.</p>\n\n<pre><code>Range(rw.Row).Interior.ColorIndex = 40\n</code></pre>\n\n<p>When you have that on the right-hand side of an assignment operator, that's a <em>Boolean expression</em>, it evaluates to <code>True</code> or <code>False</code>. So <code>result</code> will be <code>True</code> when <code>ColorIndex</code> is <code>40</code>, and <code>False</code> otherwise.</p>\n\n<p>And then nothing gets done with the <code>result</code>.</p>\n\n<p>If you intended to actually set the <code>ColorIndex</code>, remove the <code>result =</code> assignment to turn the <em>Boolean expression</em> into an assignment instruction that assigns <code>ColorIndex</code>.</p>\n\n<p>And then there's the other problem: you explicitly exit the loop just before you finish the first iteration. Remove that <code>Exit For</code> if you want to actually loop.</p>\n"}], "owner": {"reputation": 1, "user_id": 8060444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af4ba91fc85a4f3add7165b1d0950c5?s=128&d=identicon&r=PG&f=1", "display_name": "BuellerM123", "link": "https://stackoverflow.com/users/8060444/buellerm123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495642601, "creation_date": 1495640456, "last_edit_date": 1495640673, "question_id": 44162968, "link": "https://stackoverflow.com/questions/44162968/conditional-case-statement-using-excel-vba-code", "title": "Conditional Case statement using Excel VBA code", "body": "<p>I am trying to write a conditional case statement that searches through a specific column, in excel, for a specific string and when it matches with the string that cell's background color is changed. </p>\n\n<p>If the cell is empty or does not match the string then nothing should happen to the cell.</p>\n\n<p>Right now I am trying to iterate through each cell in the column and check all possible string values to compare to but it does not seem to be working .</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub interiorsStatus()\n\nDim sh As Worksheet\nDim rw As Range\n\n\nSet sh = ActiveSheet\n\nFor Each rw In sh.Rows\nSelect Case sh.Cells(rw.Row, \"E\").Value\n\n    Case \"DELIVERED\"\n        result = Range(rw.Row).Interior.ColorIndex = 33\n\n    Case \"READY TO ORDER\"\n        result = Range(rw.Row).Interior.ColorIndex = 36\n\n    Case \"ORDERED\"\n        result = Range(rw.Row).Interior.ColorIndex = 39\n\n    Case \"DELIVERED\"\n        result = Range(rw.Row).Interior.ColorIndex = 43\n\n    Case \"EXISTING\"\n        result = Range(rw.Row).Interior.ColorIndex = 40\n\n    Case \"ON HOLD\"\n        result = Range(rw.Row).Interior.ColorIndex = 48\n\n    Case \"GENERAL CONTRACTOR\"\n        result = Range(rw.Row).Interior.ColorIndex = 2\n\n    Case \"AV &amp; BLINDS\"\n        result = Range(rw.Row).Interior.ColorIndex = 15\n\n    Case \"MILLWORK\"\n        result = Range(rw.Row).Interior.ColorIndex = 22\n\n    Case Else\n        result = \"\"\"\"\n\n     End Select\n\n     Exit For\n\n      Next rw\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "macos", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1552949436, "creation_date": 1552949436, "answer_id": 55231207, "question_id": 44162881, "link": "https://stackoverflow.com/questions/44162881/how-to-save-a-file-to-the-desktop-in-vba-mac/55231207#55231207", "title": "How to save a file to the Desktop in VBA (Mac)", "body": "<p>On a Mac in Excel you must use the <code>:</code> as separator:</p>\n\n<pre><code>wb.SaveAs Filename:=\"Macintosh HD:Users:\" &amp; un &amp; \":Desktop:\" &amp; CaseNum &amp; \".txt\", FileFormat:=xlText \n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7787991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d2971e37afcbd79518e7d52950d406?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Skalla", "link": "https://stackoverflow.com/users/7787991/ryan-skalla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3647, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1552949436, "creation_date": 1495640144, "question_id": 44162881, "link": "https://stackoverflow.com/questions/44162881/how-to-save-a-file-to-the-desktop-in-vba-mac", "title": "How to save a file to the Desktop in VBA (Mac)", "body": "<p>I am writing a Macro in VBA that needs to be compatible for both Windows and Mac machines. I have everything working up until the end when I need to save the file to the users Desktop as a Tab Delimited Text File. Below is the code I have tried, but I keep getting an error. Any help is appreciated. Thanks!</p>\n\n<pre><code>'Export doc as Delimited Text\n\nDim OS As String\nOS = Application.OperatingSystem\n\nDim un As Variant\n\nun = (Environ$(\"Username\"))\n\nDim wb As Workbook\nSet wb = Workbooks.Add\nThisWorkbook.Sheets(\"dataExport\").Copy Before:=wb.Sheets(1)\n\nIf InStr(OS, \"Windows\") &gt; 0 Then\n\nwb.SaveAs Filename:=\"C:\\Users\\\" &amp; un &amp; \"\\Desktop\\\" &amp; CaseNum &amp; \".txt\", FileFormat:=xlText\n\nElse\n\nwb.SaveAs Filename:=\"/Users/\" &amp; un &amp; \"/Desktop/\" &amp; CaseNum &amp; \".txt\", FileFormat:=xlText\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "file", "kill"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7791182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d7e349ebe3ae82f1403de3ec452f9?s=128&d=identicon&r=PG&f=1", "display_name": "Brentford123", "link": "https://stackoverflow.com/users/7791182/brentford123"}, "edited": false, "score": 0, "creation_date": 1495699691, "post_id": 44165455, "comment_id": 75365689, "body": "I&#39;ve found what my problem is, I&#39;m trying to delete all the files which automatically get saved into the C: Downloads on my computer so they&#39;re not in a folder within that location, just into users and then downloads. Any ideas on how I can clear all my downloads through VBA?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 71, "user_id": 7791182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d7e349ebe3ae82f1403de3ec452f9?s=128&d=identicon&r=PG&f=1", "display_name": "Brentford123", "link": "https://stackoverflow.com/users/7791182/brentford123"}, "edited": false, "score": 0, "creation_date": 1495715383, "post_id": 44165455, "comment_id": 75375134, "body": "In <code>C:\\Downloads</code>, or <code>C:\\Users\\&lt;userid&gt;\\Downloads</code>? Please <a href=\"https://stackoverflow.com/posts/44162807/edit\">edit</a> the question with the <i>specifics</i> and be clear of your intent. Maybe provide an example of before and after."}, {"owner": {"reputation": 71, "user_id": 7791182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d7e349ebe3ae82f1403de3ec452f9?s=128&d=identicon&r=PG&f=1", "display_name": "Brentford123", "link": "https://stackoverflow.com/users/7791182/brentford123"}, "edited": false, "score": 0, "creation_date": 1495785785, "post_id": 44165455, "comment_id": 75406191, "body": "Sorry I wasn&#39;t very clear, I&#39;ve used the coding you put above however because C:\\Downloads isn&#39;t a folder it isn&#39;t deleting any files. If I put a folder within the location it will delete that folder but I want to clear all files within downloads. Does that make sense? Thanks,"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 71, "user_id": 7791182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d7e349ebe3ae82f1403de3ec452f9?s=128&d=identicon&r=PG&f=1", "display_name": "Brentford123", "link": "https://stackoverflow.com/users/7791182/brentford123"}, "edited": false, "score": 0, "creation_date": 1495821001, "post_id": 44165455, "comment_id": 75427420, "body": "I have edited the answer to show deleting of all the files in a folder first, and then the folder itself (if needed). I hope you can adapt the above to your needs."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 7, "last_activity_date": 1495649005, "last_edit_date": 1495649005, "creation_date": 1495648492, "answer_id": 44165455, "question_id": 44162807, "link": "https://stackoverflow.com/questions/44162807/delete-all-files-in-a-folder/44165455#44165455", "title": "Delete all files in a folder", "body": "<p>Add a reference to <code>Microsoft Scripting Runtime</code> in the VBA environment</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Truu.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/5Truu.png\" alt=\"ref\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kWQWj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/kWQWj.png\" alt=\"scr\"></a></p>\n\n<p>The declare in a <code>Module</code> the following line</p>\n\n<pre><code>Global fso As New FileSystemObject\n</code></pre>\n\n<p>Now you can use all the nice and modern I/O functions. For example:</p>\n\n<pre><code>Public Sub TDELFOL()    \n    Dim path As String, f As File\n    path = fso.GetSpecialFolder(TemporaryFolder)\n    path = fso.BuildPath(path, \"MyTempFolder\")\n    If fso.FolderExists(path) Then\n        For Each f In fso.GetFolder(path).Files\n            f.Delete Force = True\n        Next\n        fso.DeleteFolder path, Force = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1863, "user_id": 2730283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jqcif.jpg?s=128&g=1", "display_name": "Stefan Crain", "link": "https://stackoverflow.com/users/2730283/stefan-crain"}, "edited": false, "score": 2, "creation_date": 1522949102, "post_id": 49677982, "comment_id": 86367679, "body": "While this code snippet may solve the question, <a href=\"https://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> helps to improve the quality of your response. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}, {"owner": {"reputation": 197, "user_id": 2646902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Rfy6m.jpg?s=128&g=1", "display_name": "DataSmarter", "link": "https://stackoverflow.com/users/2646902/datasmarter"}, "edited": false, "score": 0, "creation_date": 1570738575, "post_id": 49677982, "comment_id": 103018867, "body": "If you use this code and the folder is empty, it will generate an error: &quot;Execution error: 53 / file not found&quot;. So it&#39;s indeed simple but not reliable at 100%. And I don&#39;t think that adding something like &quot;On Error Resume Next&quot; is a good idea..."}, {"owner": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "edited": false, "score": 0, "creation_date": 1571080787, "post_id": 49677982, "comment_id": 103113845, "body": "True, so better doing it like @Ashok answer"}, {"owner": {"reputation": 529, "user_id": 2199960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04de3ea197417de6121497364d80b5a1?s=128&d=identicon&r=PG", "display_name": "klingu", "link": "https://stackoverflow.com/users/2199960/klingu"}, "edited": false, "score": 0, "creation_date": 1594725407, "post_id": 49677982, "comment_id": 111220055, "body": "Also when a file is in use by an application you get the Execution error: 70 / permission denied. I prefer using the FileSystemObject as @John-Alexiou does."}], "tags": [], "owner": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "is_accepted": false, "score": 10, "last_activity_date": 1522948499, "creation_date": 1522948499, "answer_id": 49677982, "question_id": 44162807, "link": "https://stackoverflow.com/questions/44162807/delete-all-files-in-a-folder/49677982#49677982", "title": "Delete all files in a folder", "body": "<p>A more simple way:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Del()\r\n  Kill \"C:\\FolderName\\*.*\"\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 10031220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mZl0UE_lrVA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3gNwoy4ilS-sSuNaata7cdGAS2Tg/mo/photo.jpg?sz=128", "display_name": "Ramesh Bhoopathy Raju", "link": "https://stackoverflow.com/users/10031220/ramesh-bhoopathy-raju"}, "edited": false, "score": 0, "creation_date": 1530695734, "post_id": 51170049, "comment_id": 89322693, "body": "You should not**"}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1530696275, "post_id": 51170049, "comment_id": 89323090, "body": "Edit the question for your correction, rather than adding it as a comment. Also, please format your code as code."}], "tags": [], "owner": {"reputation": 41, "user_id": 10031220, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mZl0UE_lrVA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3gNwoy4ilS-sSuNaata7cdGAS2Tg/mo/photo.jpg?sz=128", "display_name": "Ramesh Bhoopathy Raju", "link": "https://stackoverflow.com/users/10031220/ramesh-bhoopathy-raju"}, "is_accepted": false, "score": 4, "last_activity_date": 1576080039, "last_edit_date": 1576080039, "creation_date": 1530695710, "answer_id": 51170049, "question_id": 44162807, "link": "https://stackoverflow.com/questions/44162807/delete-all-files-in-a-folder/51170049#51170049", "title": "Delete all files in a folder", "body": "<p>You should <em>not</em> name macros as the in built functions. Just changing the macros with the same coding resolves the issues...</p>\n\n<pre><code>Sub Kill1 ()\n\nDim aFile As String\naFile = \"C:\\Test\\Test\\Downloads\\*.*\"\nIf Len(Dir$(aFile)) &gt; 0 Then\n    Kill aFile\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7791182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d7e349ebe3ae82f1403de3ec452f9?s=128&d=identicon&r=PG&f=1", "display_name": "Brentford123", "link": "https://stackoverflow.com/users/7791182/brentford123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26539, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1576080039, "creation_date": 1495639947, "question_id": 44162807, "link": "https://stackoverflow.com/questions/44162807/delete-all-files-in-a-folder", "title": "Delete all files in a folder", "body": "<p>I have the below code to try search for all files in my downloads folder and then delete them all however it's returning an error message based on the kill function not having enough arguments, any ideas?</p>\n\n<pre><code>Sub Kill ()\n\nDim aFile As String\naFile = \"C:\\Test\\Test\\Downloads\\*.*\"\nIf Len(Dir$(aFile)) &gt; 0 Then\n    Kill aFile\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "lotus-notes"], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 8011289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qAysa.jpg?s=128&g=1", "display_name": "Strahil", "link": "https://stackoverflow.com/users/8011289/strahil"}, "is_accepted": true, "score": 0, "last_activity_date": 1495663080, "creation_date": 1495663080, "answer_id": 44169143, "question_id": 44162649, "link": "https://stackoverflow.com/questions/44162649/read-fields-in-lotus-notes-documents-through-vba/44169143#44169143", "title": "Read fields in Lotus Notes Documents Through VBA", "body": "<p>It is possible, and also better to use the 'Back end' object <code>Notes.NotesSession</code>. So try this:</p>\n\n<pre><code>Set doc = view.GetFirstDocument\nWhile Not (doc Is Nothing)\n    'Check if you have the field in the document\n    if doc.HasItem(\"RevDueDate\") Then\n        revDate = doc.getFirstItem(\"RevDueDate\").Text\n    End If\nSet doc = view.GetNextDocument(doc)\nWend\n</code></pre>\n\n<p>It is also possible to use <code>Notes.NotesUiWorkspace</code>object by opening every document in the client, getting the fields data and closing the document but I would highly recommend <strong>NOT TO</strong> make it like this as there is high possibility that you will crash the Notes client, if you need to loop on more documents.</p>\n"}, {"tags": [], "owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1495673220, "creation_date": 1495673220, "answer_id": 44170605, "question_id": 44162649, "link": "https://stackoverflow.com/questions/44162649/read-fields-in-lotus-notes-documents-through-vba/44170605#44170605", "title": "Read fields in Lotus Notes Documents Through VBA", "body": "<p>You're using the Notes \"front-end\" classes rooted at Notes.NotesUIWorkspace. These are OLE classes, which means that they need the Notes client to be running and they work on the open document. There are also back-end classes rooted at Notes.NotesSession. These are also OLE classes, so they still need the Notes client to be running but they can access other documents (and other databases, servers, etc.). There is also a set of back-end classes rooted at Lotus.NotesSession. Note the different prefix. These are COM classes, so they do not need the Notes client to be running - though it does have to be installed and configured, and your code will have to provide the user's password since the client won't prompt for it.</p>\n\n<p>You can find documentation and examples for the NotesSession class h<a href=\"https://www.ibm.com/support/knowledgecenter/SSVRGU_8.5.3/com.ibm.designer.domino.main.doc/H_NOTESSESSION_CLASS.html\" rel=\"nofollow noreferrer\">ere</a>. Down near the bottom of the page, you'll find links to information about using them via OLE or COM. You can find a bunch of examples based on using the COM classes <a href=\"https://www.ibm.com/support/knowledgecenter/SSVRGU_9.0.1/basic/H_EXAMPLES_ACCESSING_THE_DOMINO_OBJECTS_THROUGH_COM.html\" rel=\"nofollow noreferrer\">here</a>, including one that traverses the documents in a view in database. Apart from the inital setup of the session, it would be the same if you use OLE.</p>\n"}], "owner": {"reputation": 13, "user_id": 8060302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e588fe5d3a3a0dcd1e963211f1bbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "alexmac97", "link": "https://stackoverflow.com/users/8060302/alexmac97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 1, "accepted_answer_id": 44169143, "answer_count": 2, "score": 1, "last_activity_date": 1495673220, "creation_date": 1495639542, "question_id": 44162649, "link": "https://stackoverflow.com/questions/44162649/read-fields-in-lotus-notes-documents-through-vba", "title": "Read fields in Lotus Notes Documents Through VBA", "body": "<p>I am trying to write VBA code that will read data from fields in a Lotus Notes document. Currently, I am able to read data using the <code>FieldGetText</code> method, however this only works when I have the document open. I need to be able to loop through documents without opening them, as there are several hundred. I need to be able to read these same fields from many documents, but cannot figure out how to loop through them. My code currently is:</p>\n\n<pre><code>    Set LotusNotes = CreateObject(\"Notes.NotesUiWorkspace\")\n    Set CurrentDoc = LotusNotes.CurrentDocument\n    While Not (CurrentDoc Is Nothing)\n\n    ' Affectation of data\n    DueDate = CurrentDoc.FieldGetText(\"RevDueDate\")\n    DueTime = CurrentDoc.FieldGetText(\"RevDueTime\")\n    DateClosed = CurrentDoc.FieldGetText(\"DateClosed\")\n\n    Wend\n</code></pre>\n\n<p>I understand that this uses a Front End object. I was able to use a Back End object that could loop through documents (without them being open), however the data (for the dates, specifically) did not match the field text from the documents. That code looked like this:</p>\n\n<pre><code>Set LotusNotes = CreateObject(\"Notes.NotesSession\")\nSet db = LotusNotes.GetDatabase(\"\")\nSet view = db.GetView(view_name)\nview.AutoUpdate = False\nSet columnview = view.AllEntries\n\nSet doc = view.GetFirstDocument\nWhile Not (doc Is Nothing)\n    revDate = doc.GetItemValueDateTimeArray(\"RevDueDate\")\n    revDate = doc.RevDueDate \nSet doc = view.GetNextDocument(doc)\nWend\n</code></pre>\n\n<p>Basically, I'm just wondering if it's possible to loop through multiple files using the <code>NotesUIWorkspace</code> class that I tried first, or if it's possible to somehow use <code>FieldGetText</code> in the <code>NotesWorkspace</code> class instead. </p>\n\n<p>Any help is appreciated, thanks. </p>\n"}, {"tags": ["vba", "outlook", "userform"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495667448, "post_id": 44162631, "comment_id": 75355508, "body": "Ahh, I know what you miss. You are missing <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work/5235#5235\">this</a> for those who spare their valuable time to answer your questions."}, {"owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495693623, "post_id": 44162631, "comment_id": 75362500, "body": "My mistake, all sorted. I just started with stackoverflow and wasn&#39;t sure how everything works."}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "is_accepted": true, "score": 0, "last_activity_date": 1495701909, "creation_date": 1495701909, "answer_id": 44176139, "question_id": 44162631, "link": "https://stackoverflow.com/questions/44162631/vba-outlook-userform-if-comebox-text-fields/44176139#44176139", "title": "vba, outlook, Userform if comebox &amp; text fields", "body": "<p>Found solution.</p>\n\n<pre><code> With Me \n   Select Case .ComboBox1T \n  Case \"1.New Application\" \n    If .TB1 = \"\" Or .TB2 = \"\" Or .TB3 = \"\"  Then MsgBox (\"Something\")\n\n  Case \"2.old Application\" \n    If .TB1 = \"\" Or .TB2 = \"\" Then MsgBox (\"Something\")\n\nCase \"3.Other Application\" \n    If ........\n\nCase \"4.\" \nCase \"5.\" \nCase \"6.\" \nCase \"7.\" \n\n\nEnd Select \nEnd With \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44176139, "answer_count": 1, "score": 0, "last_activity_date": 1495701909, "creation_date": 1495639502, "question_id": 44162631, "link": "https://stackoverflow.com/questions/44162631/vba-outlook-userform-if-comebox-text-fields", "title": "vba, outlook, Userform if comebox &amp; text fields", "body": "<p>I have user form with 1 combobox field and several text fields.\nCombobox 1 = type of application (7 different results)\nText field like Name, Surname, Town, Post Code etc.</p>\n\n<p>After pressing Ok button, I would like prompt user if mandatory field is missing.</p>\n\n<p>Mandatory field for 1 selection is field 1, field2 and field3\n for selection 2 only filed 1 and 2 for 3 only field 6 \netc.</p>\n\n<p>Weird thing is that if I select something I didn't define in this sub, I selecting value 4 or 5 I still get message.\nWhat did I miss?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf UserForm2.ComboBox1T.Value = \"1.New Application\" _\nAnd TextBox1.Text = \"\" _\nOr TextBox2.Text = \"\" _\nOr TextBox3.Text = \"\" _\nThen\nMsgBox (\"Fill in all mandatory Fields\")\n\n\nExit Sub\nEnd If\n\n\nIf UserForm2.ComboBox1T.Value = \"2.Old Application\" _\nAnd TextBox1.Text = \"\" _\nOr TextBox2.Text = \"\" _\nThen\nMsgBox (\"Fill in all mandatory Fields\")\n\nExit Sub\nEnd If\n\nIf UserForm2.ComboBox1T.Value = \"3.Somethingelse\" _\nAnd TextBox1.Text = \"\" _\nOr TextBox2.Text = \"\" _\nThen\nMsgBox (\"Fill in all mandatory Fields\")\n\n\nExit Sub\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1495638936, "post_id": 44162401, "comment_id": 75341319, "body": "What are you doing with <code>Format(Now(), &quot;********&quot;)</code>? That resolves to nothing at all?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1495639142, "post_id": 44162401, "comment_id": 75341479, "body": "Your program is trying to attach a file called <code>C:\\Users\\dmack\\my Documents\\Manufacturer Name.xlsx</code> to each mail. Presumably that doesn&#39;t exist so is unable to attach it."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1495639308, "post_id": 44162401, "comment_id": 75341600, "body": "...and you&#39;re not getting errors because you&#39;ve used <code>On Error Resume Next</code> to disable them."}, {"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1495640008, "post_id": 44162401, "comment_id": 75342140, "body": "sorry I uploaded the wrong set of code, I was trying to integrate another set of code."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1495641753, "post_id": 44162401, "comment_id": 75343389, "body": "You still have On Error Resume Next after Set OutMail = OutApp.CreateItem(0). Remove it so you can see errors and fix them yourself."}, {"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495647235, "post_id": 44162401, "comment_id": 75346600, "body": "I comment them out when running through. See edited code."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1495653786, "post_id": 44162401, "comment_id": 75349953, "body": "Can you share/post example of spreadsheet"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495646925, "post_id": 44162976, "comment_id": 75346424, "body": "So I have it automatically pointing at the correct file, but it wont attach the file. When I change debug.print to attachments.add it also will no longer open the email. See above for edited code"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495700470, "post_id": 44162976, "comment_id": 75366108, "body": "When you use debug.print, what gets written to the Immediate window? Is it a valid path/filename?"}, {"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495724241, "post_id": 44162976, "comment_id": 75381229, "body": "Yes it is, I have updated the code. It now attaches. But has broken my loop for sending multiple emails. It only generates one now, can you see where ive gone wrong on the return to the first section?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495725097, "post_id": 44162976, "comment_id": 75381848, "body": "In these cases, I tend to just &#39;step&#39; through the code using F8 within the VBE to see exactly what&#39;s going on."}, {"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495726338, "post_id": 44162976, "comment_id": 75382662, "body": "It goes through the first time, populates the email, attaches the file and then returns back to the top. When it runs the second time it enters the loop in the top section and that&#39;s where it breaks, it never leaves just constantly runs through the upper loop."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495727633, "post_id": 44162976, "comment_id": 75383461, "body": "The <code>For X...</code> loop, or the <code>For i...</code> loop?"}, {"owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495733177, "post_id": 44162976, "comment_id": 75386596, "body": "It was the For X - but I fixed it, and now the program works when ran. But does not work when gone through line by line with F8. Which is weird. Don&#39;t suppose you have any ideas on that one?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "edited": false, "score": 0, "creation_date": 1495795525, "post_id": 44162976, "comment_id": 75411933, "body": "Not much. If it works fine when left alone but <code>F8</code> causes issues then that&#39;s <i>normally</i> where the focus is reverting back to the VB Editor, but the code is relying on Active sheet or similar to work properly, such as when cells are Selected etc.. Your code could probably do with refactoring to remove any instances of this kind. The only one I can see is <code>ActiveSheet.ListObjects(&quot;Table10&quot;)</code> which should probably be <code>Sheets(&quot;theSheetName&quot;).ListObjects(&quot;Table10&quot;)</code> that you <code>Set</code> to <code>TB</code>. Also, your <code>For I = 1 To...</code> loop should probably then read: <code>For I = 1 To TB.ListRows.Count</code>."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1495640486, "creation_date": 1495640486, "answer_id": 44162976, "question_id": 44162401, "link": "https://stackoverflow.com/questions/44162401/attaching-relevent-excel-file-to-auto-email/44162976#44162976", "title": "Attaching relevent excel file to auto-email", "body": "<p>Change your <code>attach.add</code> line to:</p>\n\n<pre><code>Debug.Print \"C:\\users\\dmack\\my documents\\\" &amp; tb.DataBodyRange.Cells(Nrow, tb, ListColumns(\"Manufacturer Name\").Index)\n</code></pre>\n\n<p>and if you start seeing the correct <strong>full</strong> filepath\\filenames in the Immediate Window, then change it again, to:</p>\n\n<pre><code>.Attachments.Add \"C:\\users\\dmack\\my documents\\\" &amp; tb.DataBodyRange.Cells(Nrow, tb, ListColumns(\"Manufacturer Name\").Index)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "is_accepted": true, "score": 0, "last_activity_date": 1495731959, "creation_date": 1495731959, "answer_id": 44186061, "question_id": 44162401, "link": "https://stackoverflow.com/questions/44162401/attaching-relevent-excel-file-to-auto-email/44186061#44186061", "title": "Attaching relevent excel file to auto-email", "body": "<p>Heres the answer fully working and able to loop through the list of emails and send the required excel files. It will send 200 emails in under 5 minutes. Correctly. Cheers to all that helped!  </p>\n\n<pre><code>Sub BacklogEmail()\nDim subjectLine As String\nDim bodyline As String\nDim tb As ListObject\nDim lineCounter As Long\nDim myArray1, arrayCounter As Long, tempNumb As Long\nDim nameCounter As Long\nDim emAddress As String\nReDim myArray1(1 To 1)\narrayCounter = 0\nnameCounter = 1\n\nSet tb = ActiveSheet.ListObjects(\"Table10\")\n\n\nFor I = 1 To ActiveSheet.ListObjects(\"Table10\").ListRows.Count\n    emAddress = tb.DataBodyRange.Cells(I, tb.ListColumns(\"Email Address\").Index)\n    For X = LBound(myArray1) To UBound(myArray1)\n        On Error Resume Next\n        If emAddress = myArray1(X) Then GoTo goToNext\n    Next X\n        On Error GoTo 0\n        subjectLine = \"Update Required For on Order(s) # \"\n        ReDim Preserve myArray1(1 To nameCounter)\n        myArray1(nameCounter) = emAddress\n        nameCounter = nameCounter + 1\n        lineCounter = 1\n            With tb.ListColumns(\"Email Address\").Range\n                Set C = .Find(emAddress, LookIn:=xlValues)\n                If Not C Is Nothing Then\n                    firstaddress = C.Address\n                    Beep\n                    arrayCounter = arrayCounter + 1\n                    Do\n                        Nrow = C.Row - 1\n                        If lineCounter = 1 Then\n                            subjectLine = subjectLine &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index)\n                            lineCounter = lineCounter + 1\n                            bodyline = \"Order \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \",  Manufacturer Item Number \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Item Number\").Index)\n                        Else:\n                            subjectLine = subjectLine\n                            bodyline = bodyline &amp; vbNewLine &amp; \"Order \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \",  Manufacturer Item Number \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Item Number\").Index)\n                        End If\n\n                        Set C = .FindNext(C)\n                        Debug.Print vbNewLine\n                        Debug.Print emAddress\n                        Debug.Print \"Subject: \" &amp; subjectLine\n                        Debug.Print \"Body:\" &amp; vbNewLine; bodyline\n                    Loop While Not C Is Nothing And C.Address &lt;&gt; firstaddress\n                End If\n\n                        Run SendMailFunction(emAddress, subjectLine, bodyline)\n\n\n            End With\ngoToNext:\nNext I\nSet C = Nothing\nEnd Sub\n\n\nFunction SendMailFunction(emAddress As String, subjectLine As String, bodyline As String)\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim tb As ListObject\nDim NL As String\nDim DNL As String\nDim lineCounter As Long\nDim myArray1, arrayCounter As Long, tempNumb As Long\nDim nameCounter As Long\nReDim myArray1(1 To 1)\narrayCounter = 0\nnameCounter = 1\n\nNL = vbNewLine\nDNL = vbNewLine &amp; vbNewLine\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet tb = ActiveSheet.ListObjects(\"Table10\")\n\n           ReDim Preserve myArray1(1 To nameCounter)\n          myArray1(nameCounter) = emAddress\n           nameCounter = nameCounter + 1\n           lineCounter = 1\n            With tb.ListColumns(\"Email Address\").Range\n                Set C = .Find(emAddress, LookIn:=xlValues)\n               If Not C Is Nothing Then\n                    firstaddress = C.Address\n                    Beep\n                    arrayCounter = arrayCounter + 1\n                        Nrow = C.Row - 1\n                      If lineCounter = 1 Then\n\n      Set OutMail = OutApp.CreateItem(0)\n       On Error Resume Next\n        With OutMail\n\n            .To = emAddress\n            .Subject = subjectLine\n            .Body = \"Hello, attached is an excel file that we require you to complete. \" &amp; _\n                    \"This is required by as we must know when parts are going to become obsolete. \" &amp; DNL &amp; _\n                    \"We appriciate your contribution to keeping our databases current. \" &amp; DNL &amp; _\n                    \"Thank you for your timely response.\"\n            .Attachments.Add \":\\\\\\\\\\\" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \".xlsx\"\n                            lineCounter = lineCounter + 1\n\n           .Display\n\n      End With\n     On Error GoTo 0\n        Set OutMail = Nothing\n\n\nEnd If\nEnd If\nEnd With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7988007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2584fe907cecdae355443c377e532?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mack", "link": "https://stackoverflow.com/users/7988007/d-mack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 44186061, "answer_count": 2, "score": 2, "last_activity_date": 1593331342, "creation_date": 1495638760, "last_edit_date": 1593331342, "question_id": 44162401, "link": "https://stackoverflow.com/questions/44162401/attaching-relevent-excel-file-to-auto-email", "title": "Attaching relevent excel file to auto-email", "body": "<p>I have written code to export my data by manufacturer name into new books named for the manufacturer.</p>\n\n<p>Now I have tweaked an email macro to automatically email the manufacturers.</p>\n\n<p>I'd like it to automatically attach my files from My Documents</p>\n\n<p>Here's what I have, but it attaches nothing.</p>\n\n<pre><code>Sub BacklogEmail()\nDim subjectLine As String\nDim bodyline As String\nDim tb As ListObject\nDim lineCounter As Long\nDim myArray1, arrayCounter As Long, tempNumb As Long\nDim nameCounter As Long\nDim emAddress As String\nReDim myArray1(1 To 1)\narrayCounter = 0\nnameCounter = 1\n\nSet tb = ActiveSheet.ListObjects(\"Table10\")\n\n\nFor i = 1 To ActiveSheet.ListObjects(\"Table10\").ListRows.Count\n    emAddress = tb.DataBodyRange.Cells(i, tb.ListColumns(\"Email Address\").Index)\n    For X = LBound(myArray1) To UBound(myArray1)\n        On Error Resume Next\n        If emAddress = myArray1(X) Then GoTo goToNext\n    Next X\n        On Error GoTo 0\n        subjectLine = \"Obsolescence Report for Manufacturer(s)  \"\n        ReDim Preserve myArray1(1 To nameCounter)\n        myArray1(nameCounter) = emAddress\n        nameCounter = nameCounter + 1\n        lineCounter = 1\n            With tb.ListColumns(\"Email Address\").Range\n                Set C = .Find(emAddress, LookIn:=xlValues)\n                If Not C Is Nothing Then\n                    firstaddress = C.Address\n                    Beep\n                    arrayCounter = arrayCounter + 1\n                    Do\n                        Nrow = C.Row - 1\n                        If lineCounter = 1 Then\n                            subjectLine = subjectLine &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index)\n                            lineCounter = lineCounter + 1\n                           ' bodyline = \"Manufacturer \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \",  Manufacturer Item Number \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Item Number\").Index)\n                        Else:\n                            subjectLine = subjectLine\n                            'bodyline = bodyline &amp; vbNewLine &amp; \"Manufacturer \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \",  Manufacturer Item Number \" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Item Number\").Index)\n                        End If\n\n                        Set C = .FindNext(C)\n                    Loop While Not C Is Nothing And C.Address &lt;&gt; firstaddress\n                End If\n                        Run SendMailFunction(emAddress, subjectLine, bodyline)\n'                        Debug.Print vbNewLine\n'                        Debug.Print emAddress\n'                        Debug.Print \"Subject: \" &amp; subjectLine\n'                        Debug.Print \"Body:\" &amp; vbNewLine; bodyline\n            End With\ngoToNext:\nNext i\nSet C = Nothing\nEnd Sub\n\n\n\n\nFunction SendMailFunction(emAddress As String, subjectLine As String, bodyline As String)\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim tb As ListObject\nDim NL As String\nDim DNL As String\nDim lineCounter As Long\nDim myArray1, arrayCounter As Long, tempNumb As Long\nDim nameCounter As Long\nReDim myArray1(1 To 1)\narrayCounter = 0\nnameCounter = 1\n\nNL = vbNewLine\nDNL = vbNewLine &amp; vbNewLine\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet tb = ActiveSheet.ListObjects(\"Table10\")\n\n           ReDim Preserve myArray1(1 To nameCounter)\n           myArray1(nameCounter) = emAddress\n           nameCounter = nameCounter + 1\n           lineCounter = 1\n            With tb.ListColumns(\"Email Address\").Range\n                Set C = .Find(emAddress, LookIn:=xlValues)\n               If Not C Is Nothing Then\n                    firstaddress = C.Address\n                    Beep\n                    arrayCounter = arrayCounter + 1\n                        Nrow = C.Row - 1\n                      If lineCounter = 1 Then\n                      Set OutMail = OutApp.CreateItem(0)\n       On Error Resume Next\n        With OutMail\n\n            .To = emAddress\n            .Subject = subjectLine\n            .Body = \"Hello, attached is an excel file that we require you to complete. \" &amp; _\n                    \"This is required by as we must know when parts are going to become obsolete. \" &amp; _\n                    \"We appriciate your contribution to keeping our databases current. \" &amp; _\n                    \"Thank you for your timely response.\"\n                            .Attachments.Add \"U:\\\\\\\\\" &amp; tb.DataBodyRange.Cells(Nrow, tb.ListColumns(\"Manufacturer Name\").Index) &amp; \".xlsx\"\n                            lineCounter = lineCounter + 1\n\n           .Display\n\n\n     On Error GoTo 0\n        Set OutMail = Nothing\n\n\nEnd With\nEnd If\nEnd If\nEnd With\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8060305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37bf3be28a2613cb047ae281a37bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/8060305/richard"}, "edited": false, "score": 0, "creation_date": 1495729823, "post_id": 44170259, "comment_id": 75384714, "body": "will look into attached template"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1495670513, "creation_date": 1495670513, "answer_id": 44170259, "question_id": 44162370, "link": "https://stackoverflow.com/questions/44162370/opening-a-word-dotm-template-through-vba-and-need-doc-1-to-have-vba-code-same-as/44170259#44170259", "title": "Opening a word dotm template through vba and need doc 1 to have vba code same as template", "body": "<p>To my knowledge there isn't. Look at the new document's <code>AttachedTemplate</code> property, however. It points to the template with the code, and that code is available while the reference is. In other words, if you provide the user with a template and he creates a new document from that template that new document will be able to use all the code in the template while it remains on the same machine and the <code>AttachedTemplate</code> property isn't removed.</p>\n\n<p>However, once the link between document and AttachedTemplate is broken, by whichever method, the functionality also ceases. This is so by design. The only way to pass actual code with a document is by adding the code to the document itself and distributing copies of that document which would include the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 8060305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37bf3be28a2613cb047ae281a37bffd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/8060305/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504409475, "creation_date": 1495638669, "last_edit_date": 1504409475, "question_id": 44162370, "link": "https://stackoverflow.com/questions/44162370/opening-a-word-dotm-template-through-vba-and-need-doc-1-to-have-vba-code-same-as", "title": "Opening a word dotm template through vba and need doc 1 to have vba code same as template", "body": "<p>I have developed a word document log book. the user forms ask question's in order to mark certain sections Not applicable and then delete the section contents so log book is bespoke to site.</p>\n\n<p>I would really like to keep the master un corrupted by users and have tried the add.docuement method but this just opens a new document as doc 1 with all the log book content but no VBA code. Is there way to open a new doc with the VBA code included?</p>\n"}, {"tags": ["vba", "excel", "jira"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1495638388, "post_id": 44161916, "comment_id": 75340895, "body": "Is this from a filter?"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1495638446, "post_id": 44161916, "comment_id": 75340950, "body": "What about copy paste, You can mimic then what you&#39;ve done by recording a Mcro to VBA"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8054553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9934e34c8ee98368cff5bc69f7729db0?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/8054553/lilian"}, "edited": false, "score": 0, "creation_date": 1495639455, "post_id": 44162437, "comment_id": 75341701, "body": "please for login and password i don&#39;t need to put quotes &quot;&quot; ? os_username=yourlogin&amp;os_password=yourpassword,"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1495638928, "creation_date": 1495638928, "answer_id": 44162437, "question_id": 44161916, "link": "https://stackoverflow.com/questions/44161916/get-information-from-jira-account-with-authentification/44162437#44162437", "title": "Get information from JIRA account with authentification", "body": "<p>This is under the assumption you need to gather filter data</p>\n\n<pre><code> (New-Object System.Net.WebClient).DownloadFile(\"http://linktoyourjira/sr/jira.issueviews:searchrequest-excel-current-fields/yourFilterID/SearchRequest-yourFilterID.xls?tempMax=5000&amp;os_username=yourlogin&amp;os_password=yourpassword\",\"C:\\Users\\dzcoats\\Desktop\\Process A $(get-date -f MM-dd-yyyy).xls\")\n</code></pre>\n\n<p>While this is a POWERSHELL Script, it will dump your filter results into an excel file. </p>\n\n<p>Things you need to know - </p>\n\n<ul>\n<li>\"linktoyourjira\" should be pretty self explanatory, but however its the link to your jira instance</li>\n<li>YourfilterID is the ID for the filter you want to gather data from. If you need to know how to get your filter ID, just google. You need admin access to view the list of filters though (but the filter ID can be found by hovering over and option in the cogwheel next to the filter in the list with the admin page).</li>\n<li>yourlogin &amp; yourpassword should also be pretty self explanatory. </li>\n<li>To run this, just search for powershell in the start menu ( i am assuming you have a microsoft box thats current, as its generally installed everywhere) open it, paste in the editor and hit run :)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8054553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9934e34c8ee98368cff5bc69f7729db0?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/8054553/lilian"}, "is_accepted": false, "score": 0, "last_activity_date": 1495638970, "creation_date": 1495638970, "answer_id": 44162449, "question_id": 44161916, "link": "https://stackoverflow.com/questions/44161916/get-information-from-jira-account-with-authentification/44162449#44162449", "title": "Get information from JIRA account with authentification", "body": "<p>Thank you, here is my code : </p>\n\n<pre><code>Private JiraService As New MSXML2.XMLHTTP60\nPrivate JiraAuth As New MSXML2.XMLHTTP60\n\nSub JIRA()\n\n  With JiraAuth\n       .Open \"POST\", \"https://jiralink/rest/auth/1/session\", False\n       .setRequestHeader \"Content-Type\", \"application/json\"\n       .setRequestHeader \"Accept\", \"application/json\"\n       .send \" {\"\"username\"\" : \"\"\"username\"\"\", \"\"password\"\" : \"\"\"password\"\"\"}\"\"\"\n       MsgBox .Status\n       If .Status = \"200\" Then\n           sCookie = \"JSESSIONID=\" &amp; Mid(sErg, 42, 32) &amp; \"; Path=/\" &amp; sPfad\n           Login = True\n       End If\n  End With\n\n  With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;https://jiralink/sr/jira.issueviews:searchrequest-excel-all-fields/temp/SearchRequest.html?jqlQuery=project+%3D+NAME+AND+Sprint+%3D+1+ORDER+BY+priority+DESC%2C+updated+DESC&amp;tempMax=1000\" _\n        , Destination:=Range(\"$A$1\"))\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlEntirePage\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I want to export information to Excel, to get this result : \n<a href=\"https://i.stack.imgur.com/ReBI2.png\" rel=\"nofollow noreferrer\">result</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8054553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9934e34c8ee98368cff5bc69f7729db0?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/8054553/lilian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1495638970, "creation_date": 1495637515, "question_id": 44161916, "link": "https://stackoverflow.com/questions/44161916/get-information-from-jira-account-with-authentification", "title": "Get information from JIRA account with authentification", "body": "<p>Please can anyone help me, I am stuck, I have to extract data from JIRA web page and put it into EXCEL without using plugins that's way i am trying to do it with VBA but I don't how to proceed. I have tried several methods but it dosen't work for me, Is there anyone who has done that already ?</p>\n\n<p>Thank you </p>\n"}, {"tags": ["excel", "date", "range", "formulas", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495637572, "post_id": 44161915, "comment_id": 75340216, "body": "What do you mean to &quot;Find a date&quot;? Do you want to return that date? Return the cell address it&#39;s in, etc.? What have you tried, please share any attempts you&#39;ve made with us, and comments as to why they aren&#39;t doing what you want. Also, some sample data and sample expected output would help."}, {"owner": {"reputation": 13, "user_id": 6016331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752ac4b671fe2efa5b8897451fbcdfa0?s=128&d=identicon&r=PG&f=1", "display_name": "pat285", "link": "https://stackoverflow.com/users/6016331/pat285"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495637712, "post_id": 44161915, "comment_id": 75340349, "body": "from what I have googled I have used the couple of formulas below. I get that some of them may not be ideal, but I was just using trial and error.                                                                                                                                                                                                                           =IF(F2=MEDIAN(D2:E2),&quot;Yes&quot;,&quot;No&quot;)                                                         =IF(COUNTIF(D:E,K:K),&quot;Yes&quot;,&quot;No&quot;)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495637959, "post_id": 44161915, "comment_id": 75340550, "body": "Can you update your OP with what you&#39;re trying to find? Are you looking for a median date (meaning, a date in the middle of two other dates)?"}, {"owner": {"reputation": 13, "user_id": 6016331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752ac4b671fe2efa5b8897451fbcdfa0?s=128&d=identicon&r=PG&f=1", "display_name": "pat285", "link": "https://stackoverflow.com/users/6016331/pat285"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495638159, "post_id": 44161915, "comment_id": 75340711, "body": "I have 3 date strings the third of which, I am trying to compare if it is between the first two. So the output would only be a true or false."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1495639322, "post_id": 44162390, "comment_id": 75341610, "body": "You could run <code>MIN(A2:B2)</code> for <i>[earliest date]</i> and MAX for the other."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495639377, "post_id": 44162390, "comment_id": 75341637, "body": "@Jeeped - Ooh good thinking.  That&#39;d help if they had a larger list. But, OP said they are given three dates, so I figured to do what I did. Good call though, I didn&#39;t think of that!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1495639392, "post_id": 44162390, "comment_id": 75341656, "body": "re: <code>date1 As String, date2 As String</code> why <i>as string</i> ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495639569, "post_id": 44162390, "comment_id": 75341791, "body": "@Jeeped - ...I don&#39;t know, I wasn&#39;t sure how the data was presented at all. Is it already in VBA as a String? (OP tagged both <code>Formula</code> and <code>Macro</code>, and uses <code>var1</code> in their post).  I&#39;ll wait for OP to come in and give more detail ...which I honestly probably should have done before offering a solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1495639667, "post_id": 44162390, "comment_id": 75341894, "body": "Probably should be <code>date1 As Date, date2 As Date, chkDate As Date</code> but I would have used <code>date1 As Long, date2 As Long, chkDate As Long</code>. Even if the dates came in as strings it would be hard to use <code>&gt;</code> and <code>&lt;</code> against each other. Don&#39;t think you would get reliable results from comparing strings."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495650813, "post_id": 44162390, "comment_id": 75348535, "body": "For the record, this could be tweaked (as @Jeeped mentions), but until any update from OP, the <code>String</code> should work. Personally, I&#39;d like to use <code>Date()</code> since we&#39;re literally comparing dates, but OP uses the word &quot;String&quot; in their post, so I just went with that method..."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 4, "last_activity_date": 1495638737, "creation_date": 1495638737, "answer_id": 44162390, "question_id": 44161915, "link": "https://stackoverflow.com/questions/44161915/searching-for-a-date-in-a-range-of-dates-in-excel/44162390#44162390", "title": "searching for a date in a range of dates in Excel", "body": "<p>Using formulas, you would do <br><br>\n<code>=IF(AND([earliest date]&lt;=[check date],[latest date]&gt;=[check date]),\"Yes\",\"No\")</code>.\n<br><br><a href=\"https://i.stack.imgur.com/egirp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/egirp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you need it in VBA, you could do something like:</p>\n\n<pre><code>Function checkDate(date1 As String, date2 As String, chkDate As String) As String\nIf date1 &lt;= chkDate And date2 &gt;= chkDate Then\n    checkDate = \"Falls between!\"\nElse\n    checkDate = \"Outside the range\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>And run with <code>=checkDate(A2,B2,C2)</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6016331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752ac4b671fe2efa5b8897451fbcdfa0?s=128&d=identicon&r=PG&f=1", "display_name": "pat285", "link": "https://stackoverflow.com/users/6016331/pat285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44162390, "answer_count": 1, "score": 0, "last_activity_date": 1495657655, "creation_date": 1495637511, "last_edit_date": 1531161705, "question_id": 44161915, "link": "https://stackoverflow.com/questions/44161915/searching-for-a-date-in-a-range-of-dates-in-excel", "title": "searching for a date in a range of dates in Excel", "body": "<p>I am working on trying to find a formula or a macro that will help allow me find a particular date in a range of two dates.  I have tried a few different things, but I have come up empty.  Are there any solutions for this? I have 3 date strings, and I am looking to see if the third date falls in the range.  </p>\n\n<p>ex. date range is var1 5/1/17 through var2 5/7/17 and I am looking to see if var3 5/5/17 falls within that week. output true if true, false if false.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1495636698, "post_id": 44161506, "comment_id": 75339440, "body": "Check out <a href=\"https://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\">this site</a>. It&#39;s just one or two lines of code to move/copy a file in VBA."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495637896, "post_id": 44161506, "comment_id": 75340498, "body": "I&#39;ve changed your references from VBS to VBA as you&#39;re using spreadsheets (VBS is a different language)."}, {"owner": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "edited": false, "score": 0, "creation_date": 1495638775, "post_id": 44161506, "comment_id": 75341190, "body": "Thanks for clarifying that."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1495641567, "post_id": 44163049, "comment_id": 75343274, "body": "If you decide to point the destination_folder to something else, make sure the folder exists before you run this."}, {"owner": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "edited": false, "score": 0, "creation_date": 1495657194, "post_id": 44163049, "comment_id": 75351624, "body": "I keep getting a path not found error with the debug pointing at FileCopy .Cells(rw, 2), destination_folder &amp; .Cells(rw, 1) &amp; suffix"}, {"owner": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "edited": false, "score": 0, "creation_date": 1495657203, "post_id": 44163049, "comment_id": 75351627, "body": "suffix changed to .jpg  destination_folder = &quot;C:\\Users\\rykenes\\Desktop\\Output\\&quot; &#39; Set destination as user&#39;s desktop Is the only thing I edited"}, {"owner": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "edited": false, "score": 0, "creation_date": 1495660196, "post_id": 44163049, "comment_id": 75353007, "body": "After some tweaking and reading, I got it working exactly as needed. Thank you very much."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "edited": false, "score": 0, "creation_date": 1495700543, "post_id": 44163049, "comment_id": 75366157, "body": "Great news! If you&#39;re happy with the answer, don&#39;t forget to mark it answered. If you want me to change anything before you mark it, let me know."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1495700871, "last_edit_date": 1495700871, "creation_date": 1495640709, "answer_id": 44163049, "question_id": 44161506, "link": "https://stackoverflow.com/questions/44161506/excel-macro-to-copy-image-from-network-drive-to-other-folder/44163049#44163049", "title": "Excel Macro To Copy Image From Network Drive To Other Folder", "body": "<p>Not a lot to go on, but making a few assumptions on the way, like the filetype (<code>suffix</code>) and when you say 'desktop' - you mean the desktop on a recent version of Windows..</p>\n\n<pre><code>Sub copythem()\n    Dim rw As Long, start_row As Long, end_row As Long\n    Dim destination_folder As String\n    Dim suffix As String\n\n    suffix = \".jpg\"\n\n    With ActiveSheet\n        start_row = 1\n        end_row = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        destination_folder = Environ(\"homedrive\") &amp; Environ(\"homepath\") &amp; \"\\desktop\\output\\\" ' Set destination as output folder in user's desktop\n\n        For rw = start_row To end_row\n            If Dir(.Cells(rw, 2)) &lt;&gt; \"\" Then\n                FileCopy .Cells(rw, 2), destination_folder &amp; .Cells(rw, 1) &amp; suffix\n            Else\n                MsgBox \"File: \" &amp; .Cells(rw, 2) &amp; \" is not found.\"\n            End If\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8060102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Asmj66F1_kg/AAAAAAAAAAI/AAAAAAAAAIQ/a3Row6oSudg/photo.jpg?sz=128", "display_name": "Buddhak", "link": "https://stackoverflow.com/users/8060102/buddhak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 44163049, "answer_count": 1, "score": -1, "last_activity_date": 1495725891, "creation_date": 1495636478, "last_edit_date": 1531161705, "question_id": 44161506, "link": "https://stackoverflow.com/questions/44161506/excel-macro-to-copy-image-from-network-drive-to-other-folder", "title": "Excel Macro To Copy Image From Network Drive To Other Folder", "body": "<p>I am very new to VBA coding and am trying to help out a friend who is trying to have a macro that will download/copy multiple images from a network drive, rename them and save them to a folder on the desktop. </p>\n\n<p>The data in the spreadsheet is set up as such. \nThe macro would copy the image from the paths listed in column B and then rename the image with data from column A and save it to a folder on the Desktop</p>\n\n<pre><code>column A  -         column B      -              column C\n\n3487458   -  N:/path1/image1.jpg  -  http://www.website.com/data.pdf\n\n5412132   -  N:/path2/image2.jpg  -  http://www.website.com/data2.pdf\n</code></pre>\n\n<p>I have this that works for the Data in column C that are html links, but I need it to work for the data in column B that are paths to a network drive.</p>\n\n<pre><code>Const TargetFolder = \"C:\\Users\\XXXX\\Desktop\\Output\\\"\nPrivate Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" _\n(ByVal pCaller As Long, _\nByVal szURL As String, _\nByVal szFileName As String, _\nByVal dwReserved As Long, _\nByVal lpfnCB As Long) As Long\n\n\nSub Test()\n   For Each Hyperlink In ActiveSheet.Hyperlinks\n       LocalFileName = ActiveSheet.Cells(Hyperlink.Range.Row, 1).Value &amp; \n\".pdf\"\n   Call HTTPDownloadFile(Hyperlink.Address, TargetFolder &amp; LocalFileName)\n   Next Hyperlink\nEnd Sub\n</code></pre>\n\n<p>Thanks, Roy</p>\n\n<p>EDIT: CODE THAT WORKED</p>\n\n<pre><code>Sub copythem()\nDim rw As Long, start_row As Long, end_row As Long\nDim destination_folder As String\nDim suffix As String\n\nsuffix = \".jpg\"\n\nWith ActiveSheet\n    start_row = 1\n    end_row = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    destination_folder = \"C:\\Users\\XXXX\\Desktop\\Output\\\" ' Set destination as user's desktop\n\n    For rw = start_row To end_row\n        If Dir(.Cells(rw, 2)) &lt;&gt; \"(.Cells(rw, 2))\" Then\n            FileCopy .Cells(rw, 2), destination_folder &amp; .Cells(rw, 1) &amp; suffix\n        Else\n            MsgBox \"File: \" &amp; .Cells(rw, 2) &amp; \" is not found.\"\n        End If\n    Next\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1495637524, "post_id": 44161505, "comment_id": 75340173, "body": "Why do you have <code>For i = 2 to 2</code>? Just make <code>i = 2</code> and save yourself that loop. Can you give an example on how you want this to work?"}, {"owner": {"reputation": 27, "user_id": 8031066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a0429e2a803cb72745c6b3e16005666?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8031066/sam"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495639482, "post_id": 44161505, "comment_id": 75341723, "body": "so on sheet one I have a list of people in column 1 and column 3:5 have their details. On sheet 2 I have the same list of people but the other columns are a schedule. what I want is to hyperlink the list of people on sheet 2 and when I click the hyperlink it brings a message box displaying the information from sheet one column 3:5 from whichever person I clicked on. The purpose of this is to reference a persons credentials while looking at the schedule."}, {"owner": {"reputation": 27, "user_id": 8031066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a0429e2a803cb72745c6b3e16005666?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8031066/sam"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495639831, "post_id": 44161505, "comment_id": 75342010, "body": "I added an image to try and reference a little more."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8031066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a0429e2a803cb72745c6b3e16005666?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8031066/sam"}, "edited": false, "score": 0, "creation_date": 1495813638, "post_id": 44194220, "comment_id": 75423634, "body": "YES! Great thank you so much works like a charm on the first try!"}], "tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": true, "score": 0, "last_activity_date": 1495776480, "creation_date": 1495776480, "answer_id": 44194220, "question_id": 44161505, "link": "https://stackoverflow.com/questions/44161505/macro-with-variable-being-active-cell-and-linking-the-macro-to-a-hyperlink/44194220#44194220", "title": "macro with variable being active cell and linking the macro to a hyperlink", "body": "<p>Here I have a code that (<em>I am hoping to work and</em>) should be placed in the worksheet where the schedules are.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n' Declare and set the variable to check if the event(dblclick)\n' happened in the desired range - A.\nDim rIntersect As Range\nSet rIntersect = Intersect(Target, ThisWorkbook.Sheets(\"SheetOfSchedule\").Range(\"A:A\"))\n' Exits this sub if there is no change in the desired range.\nIf rIntersect Is Nothing Then Exit Sub\n\n'cancel the doubleclick action.\nCancel = True\n\n' Declare and set the variable that refers to their\n' detials in the 'SheetOfDetails'.\nDim rEmployee As Range\nSet rEmployee = LookFor(rIntersect.Value, ThisWorkbook.Sheets(\"SheetOfDetails\"), 1)\n\n' Declare the use the variable for looping\nDim iLoop As Integer\nDim strHolder As String     '&lt;~ string that will hold the details\nFor iLoop = 1 To 3          '&lt;~ change this to your requirements\n  strHolder = strHolder &amp; rEmployee.Offset(0, iLoop - 1).Value &amp; vbTab\nNext\n\nMsgBox strHolder\nEnd Sub\n\nPrivate Function LookFor(NameOfEmployee As String, inSheet As Worksheet, inColumn As Integer) As Range\n' This function will look for your employee name\n' and return a range object where you can get\n' details adjacent to this cell.\nDim lLoop As Long\n\nWith inSheet                                                '&lt;~ make sure that we are working with the correct sheet\n  For lLoop = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row     '&lt;~ loops through the last row\n    If .Cells(lLoop, inColumn).Value = NameOfEmployee Then  '&lt;~ loop until you find the emp name\n      Set LookFor = .Cells(lLoop, inColumn)                 '&lt;~ set the function to return that cell\n      Exit Function                                         '&lt;~ exit to save from\n    End If                                                  '   unnecesary loopings.\n  Next\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8031066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a0429e2a803cb72745c6b3e16005666?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8031066/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44194220, "answer_count": 1, "score": 0, "last_activity_date": 1495776480, "creation_date": 1495636478, "last_edit_date": 1495657490, "question_id": 44161505, "link": "https://stackoverflow.com/questions/44161505/macro-with-variable-being-active-cell-and-linking-the-macro-to-a-hyperlink", "title": "macro with variable being active cell and linking the macro to a hyperlink", "body": "<p>So what I have are two lists of information about people, one list is details of these people and the other is their schedule. Therefore, what I am trying to do is on the schedule I want to be able to click the name of the person and have a message box pop up and display all of their details.</p>\n\n<p>So far my code works. I just don't know how to implement the active cell as a variable when referencing the details. </p>\n\n<p>I don't know how to make this code dynamic so that when I click a different link it provides details based on who or where I clicked.</p>\n\n<pre><code>Private Sub \nWorksheet_FollowHyperlink(ByVal target As Hyperlink)\nRun (\"details\")\n\nEnd Sub\n\nSub details()\nDim msg As String, i As Long, a As Variant\nmsg = \"\"\ni = 2\n    For Each a In Array(\"B\", \"D\")\n        msg = msg &amp; Cells(i, a).Value &amp; vbTab\n    Next a\nMsgBox msg\nEnd Sub\n</code></pre>\n\n<p>The image shows what happens when I click \"john\"\nand what I want is to put the hyperlinked \"john on a different page and for that hyperlink to be dynamic.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ugSwC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ugSwC.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "backup"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 3, "creation_date": 1495636374, "post_id": 44161378, "comment_id": 75339145, "body": "Use <code>SaveCopyAs</code> to avoid having to resave, and try using <code>If Workbook.Saved = True</code> to avoid getting into a saving loop"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495636381, "post_id": 44161378, "comment_id": 75339153, "body": "First of all if you want to keep archive it should run when the user opens the workbook not when changes are applied and user is trying to save it. Your so called original would be simply another copy of edited workbook."}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1495637884, "post_id": 44161378, "comment_id": 75340492, "body": "As a part of your application logic, you should manage a variable <code>Public SaveCopy As Boolean</code> that will indicate whether to save or not"}, {"owner": {"reputation": 33, "user_id": 4181612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f2fdec534d7dbd5d29f028c29754865?s=128&d=identicon&r=PG&f=1", "display_name": "i.fathy", "link": "https://stackoverflow.com/users/4181612/i-fathy"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495638029, "post_id": 44161378, "comment_id": 75340612, "body": "edit:That&#39;s a very good point @Masoud and it worked, you should post it as an answer so i can mark it as answered."}], "answers": [{"comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495639602, "post_id": 44162590, "comment_id": 75341827, "body": "I would keep the extension in the name (last .xls will be the extension) for the sake of keeping the record that what was the actual extension of the file."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1495641411, "last_edit_date": 1495641411, "creation_date": 1495639397, "answer_id": 44162590, "question_id": 44161378, "link": "https://stackoverflow.com/questions/44161378/creating-a-backup-of-a-file-with-copy-after-save-goes-into-endless-loop/44162590#44162590", "title": "Creating a backup of a file with copy after_save, goes into endless loop", "body": "<p>To create an archive, you need to save the workbook when opening it, not at the end when the user is closing it. The code below takes care of this:</p>\n\n<pre><code>Private Sub Auto_Open()\n Dim WoExt, Ext, BkPath, nDateTime As String\n\n On Error GoTo ErrorHandler:\n\n    'defining variables\n    nDateTime = Format(Now, \"YYMMDD\")\n    Ext = \".xls\"\n    WoExt = ThisWorkbook.Name\n    BkPath = \"C:\\Users\\xxx.xxx\\Desktop\\vbatest\\Backup\\\"\n\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveCopyAs (BkPath + WoExt + \" - Backup - \" + nDateTime + Ext)\n        Application.DisplayAlerts = True\n\n\nExit Sub\n\nErrorHandler:\n             MsgBox \"Backup has not been saved.\"\nEnd Sub\n</code></pre>\n\n<p>This just saves the backup and leaves saving the edits to the user at the end.</p>\n"}], "owner": {"reputation": 33, "user_id": 4181612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f2fdec534d7dbd5d29f028c29754865?s=128&d=identicon&r=PG&f=1", "display_name": "i.fathy", "link": "https://stackoverflow.com/users/4181612/i-fathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 44162590, "answer_count": 1, "score": 1, "last_activity_date": 1549158280, "creation_date": 1495636166, "last_edit_date": 1549158280, "question_id": 44161378, "link": "https://stackoverflow.com/questions/44161378/creating-a-backup-of-a-file-with-copy-after-save-goes-into-endless-loop", "title": "Creating a backup of a file with copy after_save, goes into endless loop", "body": "<p>I wrote a code to run when user saves workbook, this code saves another copy, and then saves the original file again, to avoid leaving user editing the \"backup\" workbook.</p>\n\n<p>Once it saves the original file again, the \"after_save\" trigger is fired, and keeps saving to infinity.</p>\n\n<p>I checked for a solution here on StackOverFlow but haven't found one.</p>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\nCall SaveToLocations\nEnd Sub\n\nSub SaveToLocations()\n    Dim WoExt, Ext, BkPath, nDateTime As String\n    Static OrigName As String\n\n    'defining variables\n    nDateTime = Format(Now, \"YYMMDD\")\n    OrigName = \"C:\\Users\\xxx.xxx\\Desktop\\vbatest\\test orig.xlsm\"\n    Ext = \".xls\"\n    WoExt = \"test orig\"\n    BkPath = \"C:\\Users\\xxx.xxx\\Desktop\\vbatest\\Backup\\\"\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs (BkPath + WoExt + \" - Backup - \" + nDateTime + Ext)\n    ActiveWorkbook.SaveAs OrigName\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495636051, "post_id": 44160540, "comment_id": 75338888, "body": "I&#39;ve run into this before and IIRC solved it by avoiding the use of <code>ActiveChart</code>. Using <code>ActiveChart</code> only guarantees you&#39;re operating on whatever chart is active (duh), but that&#39;s not always the chart you think it is (unless you only have one chart in the whole workbook). <a href=\"https://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=201705241426107111278\">Avoid using Select and Activate</a>, and create an object linked to each specific chart so you&#39;ll never have trouble knowing which you&#39;re working with."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495636528, "post_id": 44160540, "comment_id": 75339284, "body": "This is good advice, PeterT, and I&#39;m glad you brought it up because I felt really uneasy about using so many &quot;Active&quot; items as I was trying to piece this together. This is my first attempt at creating pivot items in VBA so I went with what I could find (which used Active items obviously), so the result is what you see.  At what point/how can I identify each chart as a variable so that I can reference it appropriately?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495642627, "post_id": 44162688, "comment_id": 75343930, "body": "This is a huge help, PeterT. I am getting a Type Mismatch error on the Set BPivot = PSheet.Shapes.AddChart line, though. I have a Dim BPivot As Chart line at the top of the sub. I have also added a Dim myWB as Workbook and Set myWB = This Workbook; Set P/DSheet = myWB.Sheets(&quot;As applic.&quot;)."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495644087, "post_id": 44162688, "comment_id": 75344852, "body": "You can solve that problem by referring to the documentation for <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820981(v=office.14).aspx\" rel=\"nofollow noreferrer\"><code>Shapes.AddChart</code></a>"}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495647885, "post_id": 44162688, "comment_id": 75346922, "body": "I don&#39;t think I am seeing what you are seeing...?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495648485, "post_id": 44162688, "comment_id": 75347248, "body": "Dim BPivot As Shape. That&#39;s what the documentation link says (return value: Shape)"}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495650519, "post_id": 44162688, "comment_id": 75348383, "body": "Thanks Peter. I&#39;ve gone through and done the variable defining, and I&#39;m still getting the original issue from the OP. I am at a loss."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495650971, "post_id": 44162688, "comment_id": 75348615, "body": "Create another question and post your new code and ask again. You can even link back to this answer for having cleaned up the references and updated, just to make sure anyone else following this question is up to date."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495653349, "post_id": 44162688, "comment_id": 75349740, "body": "Added here:<a href=\"https://stackoverflow.com/questions/44166792/vba-method-setsourcedata-of-object-chart-failed-for-multiple-pivot-charts\" title=\"vba method setsourcedata of object chart failed for multiple pivot charts\">stackoverflow.com/questions/44166792/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1506007455, "last_edit_date": 1506007455, "creation_date": 1495639632, "answer_id": 44162688, "question_id": 44160540, "link": "https://stackoverflow.com/questions/44160540/vba-runtime-error-setsourcedata-for-second-pivot-chart/44162688#44162688", "title": "VBA: Runtime Error - SetSourceData for Second Pivot Chart", "body": "<p>This is an example to illustrate how to avoid using <code>Select</code> and <code>Activate</code> in your code, plus a few other (hopefully useful) comments.</p>\n\n<p>Always Use Option Explicit - this can't be emphasized enough</p>\n\n<p>This will turn the first few lines of your <code>Sub</code> into:</p>\n\n<pre><code>Option Explicit\n\nSub CreatePiePivot()\n    Dim thisWB As Workbook\n    Set thisWB = ThisWorkbook\n\n    Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Set PSheet = thisWB.Sheets(\"Tools\")\n    Set DSheet = thisWB.Sheets(\"Aggregate\")\n</code></pre>\n\n<p>Notice that by defining <code>thisWB</code>, you're setting up a workbook reference in a single line that, if you ever needed to change workbooks, change that one line and you're done. Also, <a href=\"http://analystcave.com/vba-tip-day-activeworkbook-vs-thisworkbook/\" rel=\"nofollow noreferrer\">this reference</a> can explain why you should use <code>ThisWorkbook</code> over <code>ActiveWorkbook</code>.</p>\n\n<p>Because some of your issues involve <strong><em>assumed</em></strong> references (either workbooks or worksheets or charts), the next lines can help show some necessary references that are easy to miss:</p>\n\n<pre><code>    'Define last data points\n    Dim lastRow As Long\n    Dim lastCol As Long\n    lastRow = DSheet.Cells(DSheet.Rows.Count, 1).End(xlUp).Row\n    lastCol = DSheet.Cells(1, DSheet.Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>Notice here that you have to reference <code>DSheet</code> <strong><em>inside</em></strong> of the <code>Cells</code> reference to guarantee that you're referring to the same worksheet. Otherwise VBA could assume that you're referring to the <code>ActiveSheet</code>, which may be completely different and give you an incorrect value.</p>\n\n<p>The next few lines become:</p>\n\n<pre><code>    'Selects first to last filled row, and first to last filled column for data\n    Dim PRange As Range\n    Set PRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)\n\n    'Create pivot cache\n    Dim PCache As PivotCache\n    Set PCache = ActiveWorkbook.PivotCaches.Create _\n                 (SourceType:=xlDatabase, SourceData:=PRange)\n</code></pre>\n\n<p>Your next statement in your code is <code>Sheets(\"Tools\").Activate</code> which, unless there is a specific reason you want to display that worksheet to the user at this time, is completely unnecessary. If you want the user to view this worksheet when all processing is completed, move this statement to the end of the <code>Sub</code>.</p>\n\n<p>Next:</p>\n\n<pre><code>    'Create blank pivot table\n    Dim PTable As PivotTable\n    Set PTable = PCache.CreatePivotTable _\n                 (TableDestination:=PSheet.Range(\"F1\"), _\n                  TableName:=\"ExcPT1\")\n</code></pre>\n\n<p>The real fix for your error comes next:</p>\n\n<pre><code>    'Create blank pivot chart\n    Dim PChart As Chart\n    Set PChart = PSheet.Shapes.AddChart\n    PChart.ChartType = xlPie\n    PChart.SetSourceData Source:=PSheet.Range(\"$F$2:$H$19\"), PlotBy:=xlRows\n</code></pre>\n\n<p>Because you're creating an object for the newly added chart, you never have to use <code>ActiveChart</code>. It follows the same idea of specifying complete references.</p>\n\n<p>And so on... you can hopefully use these examples to finish out the rest of your code and work through some of the issues you're having. Give it a try.</p>\n"}], "owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "accepted_answer_id": 44162688, "answer_count": 1, "score": 0, "last_activity_date": 1506007455, "creation_date": 1495634189, "question_id": 44160540, "link": "https://stackoverflow.com/questions/44160540/vba-runtime-error-setsourcedata-for-second-pivot-chart", "title": "VBA: Runtime Error - SetSourceData for Second Pivot Chart", "body": "<p>I am getting:</p>\n\n<p>Run-time error '-2147467259 (80004005)':\nMethod 'SetSourceData' of object '_Chart' failed</p>\n\n<p>intermittently when I try to run the following script:</p>\n\n<pre><code>Sub CreatePiePivot()\n'Define worksheets\nSet PSheet = Sheets(\"Tools\")\nSet DSheet = Sheets(\"Aggregate\")\n\n'Define last data points\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Selects first to last filled row, and first to last filled column for data\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Create pivot cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=PRange)\n\n'Moves user to Dashboard\nSheets(\"Tools\").Activate\n\n'Create blank pivot table\nSet PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Range(\"F1\"), _\n        TableName:=\"ExcPT1\")\n\n'Create blank pivot chart\nPSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlPie\n    ActiveChart.SetSourceData _\n        Source:=Range(\"$F$2:$H$19\"), _\n        PlotBy:=xlRows\n\nActiveWorkbook.ShowPivotTableFieldList = False\n\nWith ActiveChart.PivotLayout.PivotTable.PivotFields(\"Exception\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\n\n'Insert Data\nWith PSheet.PivotTables(\"ExcPT1\").PivotFields(\"Exception\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Caption = \"Exception Status Count\"\n    .Function = xlCount\nEnd With\n\n'Hide Not Due\nWith ActiveChart.PivotLayout.PivotTable.PivotFields(\"Exception Status\")\n    .PivotItems(\"Not due\").Visible = False\nEnd With\n\n'Move bar chart to Dashboard; resize\nActiveChart.ChartArea.Select\nActiveChart.Location Where:=xlLocationAsObject, Name:=\"Dashboard\"\n\nSet ChartWidth = Sheets(\"Dashboard\").Range(\"B26:L49\")\nWith ActiveChart.Parent\n    .Height = ChartWidth.Height\n    .Width = ChartWidth.Width\n    .Top = ChartWidth.Top\n    .Left = ChartWidth.Left\nEnd With\n\nWith ActiveChart\n    .HasTitle = False\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This sub is running after another very similar sub that creates a pivot bar chart using a sub connected to a button:</p>\n\n<pre><code>Sub CreatePivots()\n\nCall CreateBarPivot\nCall CreatePiePivot\n\nEnd Sub\n</code></pre>\n\n<p>The BarPivot runs perfectly, no problem, every time, and looks almost identical to the PiePivot shown above with the applicable changes to display the appropriate data. If I run those subs separately, it <em>usually</em> runs without a problem. I ran-and-deleted the sub and results three times before I got the error. The debug is pointing at this line:</p>\n\n<pre><code>    ActiveChart.SetSourceData _\n        Source:=Range(\"$F$2:$H$19\"), _\n        PlotBy:=xlRows\n</code></pre>\n\n<p>...but it looks exactly like the one used by the BarPivot. Since it's not happening exactly every time, but most of the time, I'm not sure where to start on troubleshooting. The documentation I've looked up (which is sparse by the way, or I'm looking in the wrong places) indicates I'm doing this right.</p>\n\n<p>What's causing the error, and how do I fix it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495634282, "post_id": 44160443, "comment_id": 75337463, "body": "Open up task manager. If you&#39;re seeing 2 EXCEL.EXE processes, they cannot talk to each other via the object model. <code>Application</code> refers to the current instance, and there&#39;s nothing in the object model that refers to anything in any other instance. Short answer: you can&#39;t. Why can&#39;t the source and destination workbooks be in the same Excel instance?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495634734, "post_id": 44160443, "comment_id": 75337821, "body": "It is possible to write your worksheet change function into the sheet module of the other workbook.  See Chip Pearson&#39;s &quot;    Sub AddProcedureToModule()&quot; over at <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a>"}, {"owner": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495641061, "post_id": 44160443, "comment_id": 75342945, "body": "@Mat&#39;sMug This is a template we&#39;re trying to send out to users that they will be able to edit themselves. Our hope is that they&#39;ll be in the same session but we wanted to see if it was possible to cover them using another instance as well. Thank you for the reply."}, {"owner": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495641100, "post_id": 44160443, "comment_id": 75342974, "body": "@JohnMuggins I&#39;ll take a look. Thanks for the reply."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "edited": false, "score": 0, "creation_date": 1495641907, "post_id": 44160596, "comment_id": 75343492, "body": "I deleted my code and pasted this in the ThisWorkbook module. Then saved and closed out excel. It still didn&#39;t work when pasting data from a workbook in a different session. Is there something I&#39;m forgetting? Or are some of the replies correct that this can&#39;t be done? Thanks for the quick reply."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "edited": false, "score": 0, "creation_date": 1495643044, "post_id": 44160596, "comment_id": 75344202, "body": "If you would remove the test for CutCopyMode you&#39;d see it works, but then the code will fire for any change. Problem is, when you copy from outside of Excel, Application.CutCopyMode does not equal xlCopy but equals zero."}, {"owner": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "edited": false, "score": 0, "creation_date": 1495654595, "post_id": 44160596, "comment_id": 75350352, "body": "Ok I&#39;ll give it a try. Thanks for your help."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": -1, "last_activity_date": 1495634310, "creation_date": 1495634310, "answer_id": 44160596, "question_id": 44160443, "link": "https://stackoverflow.com/questions/44160443/how-can-i-run-an-excel-enabled-event-macro-across-all-open-sessions-in-excel/44160596#44160596", "title": "How can I run an excel enabled event macro across all open sessions in excel?", "body": "<p>Paste this into the Thisworkbook module of the same file (assuming that moduleis currently empty!):</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents App As Application\n\nPrivate Sub App_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    If Application.CutCopyMode = xlCopy Then\n\n        Application.EnableEvents = False\n\n        Application.Undo\n        Target.PasteSpecial Paste:=xlPasteValues\n\n        Application.EnableEvents = True\n\n    End If\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Set App = Nothing\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set App = Application\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8059840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/680dc0d14a15e967badff72fcb584fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8059840/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495634310, "creation_date": 1495633950, "question_id": 44160443, "link": "https://stackoverflow.com/questions/44160443/how-can-i-run-an-excel-enabled-event-macro-across-all-open-sessions-in-excel", "title": "How can I run an excel enabled event macro across all open sessions in excel?", "body": "<p>VBA newbie here.</p>\n\n<p>I have an excel spreadsheet that is locked for formatting. However, if you paste into the spreadsheet, the format copied is then pasted into the locked worksheet. I'm using the code below to create an event in excel to undo and paste special values. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n\nIf Application.CutCopyMode = xlCopy Then\n\n    Application.EnableEvents = False\n\n    Application.Undo\n    Target.PasteSpecial Paste:=xlPasteValues\n\n    Application.EnableEvents = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This works perfectly, however, this only works if I am copying and pasting within the same excel session. How can I get this to work across all excel instances?</p>\n\n<p>Thanks!\nDan</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1495635628, "post_id": 44160299, "comment_id": 75338546, "body": "Please do not change the question after receiving an answer, it opens me up to down votes because my answer no longer works for your new criteria.  If you realize you asked the wrong question, try to modify the answer given to suit your needs, if you cannot change it on your own ask a new question and refer to this one."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "edited": false, "score": 0, "creation_date": 1495635074, "post_id": 44160446, "comment_id": 75338097, "body": "Thank you it works! Lets say not in the column &#39;to&#39; its not Kiwi-apl anymore but just Kiwi, so Apple have been absorbed by Kiwi. Does the formula should still works? Tha&#39;ts my problem actually instead of Kiwi-apl, Apple have been absorbed by Kiwi, so it should be &#39;from Apple to Kiwi&#39; thats all. Sorry for the confusion."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "edited": false, "score": 0, "creation_date": 1495635390, "post_id": 44160446, "comment_id": 75338342, "body": "No, it would look first to the first table.  I have edited the answer to reverse the logic."}, {"owner": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "edited": false, "score": 0, "creation_date": 1495635498, "post_id": 44160446, "comment_id": 75338439, "body": "Thank you for your answer, I understand your formula, that&#39;s great. I edited my question since actually its more a fruit name which absorb an other fruit and that was my real problem... Thank you!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "edited": false, "score": 1, "creation_date": 1495635938, "post_id": 44160446, "comment_id": 75338803, "body": "@user6457870 see third part for the new formula."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1495635945, "last_edit_date": 1495635945, "creation_date": 1495633959, "answer_id": 44160446, "question_id": 44160299, "link": "https://stackoverflow.com/questions/44160299/multiple-vlookup-with-excel/44160446#44160446", "title": "Multiple Vlookup with Excel", "body": "<p>Use a formula like this:</p>\n\n<pre><code>=IF(ISNUMBER(MATCH(G2,A:A,0)),SUMIF(A:A,G2,B:B),SUMPRODUCT(($E$2:$E$3=G2)*(SUMIF(A:A,$D$2:$D$3,B:B))))\n</code></pre>\n\n<p>The Sumproduct will iterate through the second list if needed, DO NOT use full column references where I have not, it will slow down the calcs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qgrFa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qgrFa.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>It first looks to the first table and if it exist there it does a simple SUMIFS().</p>\n\n<p>If you want to look first to the second table then we would need to reverse the logic a bit:</p>\n\n<pre><code>=IF(ISNUMBER(MATCH(G2,E:E,0)),SUMPRODUCT(($E$2:$E$3=G2)*(SUMIF(A:A,$D$2:$D$3,B:B))),SUMIF(A:A,G2,B:B))\n</code></pre>\n\n<p>It will now look first for a match in the second table before going to the first.</p>\n\n<hr>\n\n<p>To answer your new edited question, the formula gets simpler:</p>\n\n<pre><code>=SUMPRODUCT(($E$2:$E$8=G2)*SUMIF(A:A,$D$2:$D$8,B:B))+SUMIF(A:A,G2,B:B)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/S0Reo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S0Reo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 44160446, "answer_count": 1, "score": -1, "last_activity_date": 1495635945, "creation_date": 1495633614, "last_edit_date": 1531161705, "question_id": 44160299, "link": "https://stackoverflow.com/questions/44160299/multiple-vlookup-with-excel", "title": "Multiple Vlookup with Excel", "body": "<p>I am trying to understand something. </p>\n\n<p>I have a first file with fruit name and numbers inside. Then a second which set up new names as a result of sum of fruit names. </p>\n\n<p>Example. </p>\n\n<pre><code>  A     B \nKiwi    12\nApple   3\nKiwi    14 \nBanana  2\nApple   11\nOrange  6 \nOrange  8\nPomelo 12\n</code></pre>\n\n<p>And now I have a second table which say </p>\n\n<p>Merge Fruit. Meaning now in the 3rd Tab, Kiwi also contain apple. </p>\n\n<pre><code>from     to  \nApple   Kiwi\n</code></pre>\n\n<p>And my third table where B is what I am trying to find as the sum of all the fruit. </p>\n\n<pre><code>A           B \nKiwi       40 (sum of all Kiwi and apples)\nBanana     2(there is just 2 in the first tab)\nOrange     14 (6+8)\nPomelo     12\n</code></pre>\n\n<p>I know how to find all the fruit when the name don't move with a formula like </p>\n\n<pre><code>=SUMIF($A$1:$B$8,A1,$B$1:$B$8)\n</code></pre>\n\n<p>but I don't know how to do when the names are 'merged'. The 2 first tab will be always given and the A column of the third one too. I need to find just the column B of the last tab. Any ideas? The merge between fruits can be between 2 or more fruits, it can be 3,4 ... </p>\n\n<p>Thank you </p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 1, "creation_date": 1495634844, "post_id": 44160206, "comment_id": 75337910, "body": "Check out <a href=\"https://stackoverflow.com/questions/70947/how-can-i-refresh-all-the-pivot-tables-in-my-excel-workbook-with-a-macro\" title=\"how can i refresh all the pivot tables in my excel workbook with a macro\">stackoverflow.com/questions/70947/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1495634081, "post_id": 44160407, "comment_id": 75337284, "body": "Using entire columns for pivot table source data is inefficient and should be avoided. Use either dynamic named ranges or Tables instead."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1495634196, "post_id": 44160407, "comment_id": 75337382, "body": "@Rory What about step by step teaching? You won&#39;t graduate with a college degree from a primary school. I agree with you that it&#39;s not efficient but one lesson a day is my strategy. I included your point at the end of the answer. Thanks."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1495638742, "post_id": 44160407, "comment_id": 75341164, "body": "Apart from being inefficient, it also introduces the (blank) entry which you then have to filter out later. This can cause issues when you then add new items as unless you&#39;re careful, all previously unseen items will be filtered out also. Tables or Dynamic Ranges are definitely the preferred approach."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1495695810, "post_id": 44160407, "comment_id": 75363580, "body": "@Masoud That&#39;s why I just added it as a comment rather than downvoting. :)"}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1495634341, "last_edit_date": 1495634341, "creation_date": 1495633873, "answer_id": 44160407, "question_id": 44160206, "link": "https://stackoverflow.com/questions/44160206/how-do-you-refresh-a-pivot-table-in-order-to-be-taken-into-account-by-vba/44160407#44160407", "title": "How do you refresh a pivot table in order to be taken into account by vba?", "body": "<p>You cannot paste (append) rows to a pivot table. You should add your raw data to the place that your pivot table refers to if you want them to be in your pivot table.</p>\n\n<p>The important is the way that your pivot table is set up. You need to use ranges like \"A:G\" instead of \"A1:G800\" to make sure any row that will be added later will be included in your pivot table.</p>\n\n<p>If you set up your pivot table like this, after you add your raw data if you refresh your spreadsheet the pivot table will be updated and newly added data will be included in it.</p>\n\n<p>In the following link, I have some screenshots to how set up a pivot table for this purpose: </p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/43686521/count-if-for-excel-vba-and-printing-results-in-another-range/43687288#43687288\">Count if for excel VBA, and printing results in another range</a></strong></p>\n\n<p>p.s. As mentioned by @Rory using an entire column for a pivot table is not efficient. It is recommended to use \"named ranges\" or \"tables\".</p>\n"}], "owner": {"reputation": 87, "user_id": 8059849, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4fdd1a307d11012fe25f38fab07e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment Hurel", "link": "https://stackoverflow.com/users/8059849/cl%c3%a9ment-hurel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 44160407, "answer_count": 1, "score": 1, "last_activity_date": 1495638421, "creation_date": 1495633426, "last_edit_date": 1495638421, "question_id": 44160206, "link": "https://stackoverflow.com/questions/44160206/how-do-you-refresh-a-pivot-table-in-order-to-be-taken-into-account-by-vba", "title": "How do you refresh a pivot table in order to be taken into account by vba?", "body": "<p>I'm developing a userform that opens an excel file, imports a given number of rows and pastes the rows in a pivot table. Unfortunately, I have no idea how to refresh the pivot table in order to merge those new rows with the old ones.</p>\n\n<p>If any of you guys could help me, it would be great, because I only have basic knowledge and would like to achieve this project.</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1495633274, "post_id": 44160101, "comment_id": 75336555, "body": "loop along with new attachment path in each row in column G"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1495718039, "post_id": 44162911, "comment_id": 75376876, "body": "TThe server thre an exception"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1495718062, "post_id": 44162911, "comment_id": 75376893, "body": "only When I add .cc, it throws error, rest it works great"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1496499772, "post_id": 44162911, "comment_id": 75692633, "body": "Can you help me loop for a data in 100 rows"}], "tags": [], "owner": {"reputation": 41, "user_id": 8003939, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155360236230972/picture?type=large", "display_name": "Ryan William Noon", "link": "https://stackoverflow.com/users/8003939/ryan-william-noon"}, "is_accepted": false, "score": 0, "last_activity_date": 1495640239, "creation_date": 1495640239, "answer_id": 44162911, "question_id": 44160101, "link": "https://stackoverflow.com/questions/44160101/vba-email-loop-with-attachment-and-different-recipient-in-cc-does-not-execute/44162911#44162911", "title": "VBA Email Loop with Attachment and different recipient in CC does not execute", "body": "<p>.cc should be working for instance</p>\n\n<pre><code>.cc = \"YourEmail@Email.com;\"\n</code></pre>\n\n<p>What errors are you receiving?</p>\n"}], "owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495718105, "creation_date": 1495633200, "last_edit_date": 1495634258, "question_id": 44160101, "link": "https://stackoverflow.com/questions/44160101/vba-email-loop-with-attachment-and-different-recipient-in-cc-does-not-execute", "title": "VBA Email Loop with Attachment and different recipient in CC does not execute", "body": "<p>Dears,</p>\n\n<p>I am posting this question since VBA code in another mails are not executing my purpose</p>\n\n<p>Why cant I add .CC to my code and execute, it throws an error</p>\n\n<pre><code>Sub exporttoemail2()\n\n Dim OutlookApp As Object\n Dim MItem As Object\n Dim cell As Range\n Dim Subj As String\n Dim EmailAddr As String\n Dim Recipient As String\n Dim Msg As String\n Dim strLocation As String\n\n\n Set OutlookApp = CreateObject(\"Outlook.Application\")\n\n Set MItem = OutlookApp.CreateItem(olMailItem)\n\n With MItem\n .To = Range(\"D2\") &amp; \";\" &amp; Range(\"E2\") &amp; \";\" &amp; Range(\"F2\")\n .Subject = \"Hilti SOA - *Payment Notification* - \" &amp; Range(\"A2\") &amp; \" - \" &amp; Range(\"B2\")\n .htmlbody = \"Body\" \n\n\n strLocation = Range(\"G2\")\n\n .Attachments.Add (strLocation)\n\n .Display\n\n End With\n\nEnd Sub\n</code></pre>\n\n<p>I caanot add .CC function to execute smoothly please help, Also could you help if I can loop the list in each row</p>\n\n<p>Please refer snapshot of the excel file<a href=\"https://i.stack.imgur.com/IY8St.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1495632575, "post_id": 44159666, "comment_id": 75336010, "body": "Side Note: I recommend to read <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate\">VBA Best Practices - Avoid using Select</a>"}, {"owner": {"reputation": 3, "user_id": 8059673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a7d6d252db4640003daf799c6489af?s=128&d=identicon&r=PG&f=1", "display_name": "Falseboolean", "link": "https://stackoverflow.com/users/8059673/falseboolean"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495633611, "post_id": 44159666, "comment_id": 75336856, "body": "@Peh Thanks for the guide, will use this going forward"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1495632550, "creation_date": 1495632550, "answer_id": 44159827, "question_id": 44159666, "link": "https://stackoverflow.com/questions/44159666/sheetssheet-name-select-error/44159827#44159827", "title": "Sheets(&quot;Sheet Name&quot;).select Error", "body": "<p>This is not a solution to your problem, only a list of things to check:</p>\n\n<ol>\n<li>The incorrect workbook is active</li>\n<li>The tabname is miss-spelled</li>\n<li>The is a protection / hidden issue</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1495632670, "last_edit_date": 1495632670, "creation_date": 1495632611, "answer_id": 44159854, "question_id": 44159666, "link": "https://stackoverflow.com/questions/44159666/sheetssheet-name-select-error/44159854#44159854", "title": "Sheets(&quot;Sheet Name&quot;).select Error", "body": "<p>Please don't use <code>.Selection</code>\nYou should use:</p>\n\n<pre><code>Sub Reset_Additional()\n    Application.ScreenUpdating = False\n\n    With Worksheets(\"Additional\")\n        .Range(\"additionalcheckbox\").Value = False\n        .Range(\"additional1\").ClearContents\n        .Range(\"additional2\").ClearContents\n        .Range(\"additional3\").FormulaR1C1 = \"=RC[-11]\"\n        .Range(\"additional4\").FormulaR1C1 = \"=RC[-18]\"\n        .Range(\"additional5\").FormulaR1C1 = \"=RC[-18]\"\n        .Range(\"additional6\").FormulaR1C1 = \"=RC[-9]\"\n    End With\n\n    With Sheets(\"Macro Rules\")\n        .Range(\"B21\").FormulaR1C1 = \"=RC[+1]\"\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If your code stops, you probably misspelled the sheet name. </p>\n"}], "owner": {"reputation": 3, "user_id": 8059673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a7d6d252db4640003daf799c6489af?s=128&d=identicon&r=PG&f=1", "display_name": "Falseboolean", "link": "https://stackoverflow.com/users/8059673/falseboolean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1859, "favorite_count": 0, "accepted_answer_id": 44159854, "answer_count": 2, "score": 0, "last_activity_date": 1495632670, "creation_date": 1495632180, "last_edit_date": 1495632421, "question_id": 44159666, "link": "https://stackoverflow.com/questions/44159666/sheetssheet-name-select-error", "title": "Sheets(&quot;Sheet Name&quot;).select Error", "body": "<p>I am having an issue when running a VBA macro in a .xlsm file in Excel 2013.\nAll instances of <code>Sheets(\"SheetName\").Select</code> or <code>Sheets(\"SheetName\").Activate</code> error when executed.</p>\n\n<p>This is an example of one of the code samples that errors:</p>\n\n<pre><code>Sub Reset_Additional()\n    Application.ScreenUpdating = False\n    Sheets(\"Additional\").Select                 &lt;-- Code breaks on this line\n\n    Range(\"additionalcheckbox\").Select\n    Selection.Value = False\n    Range(\"additional1\").Select\n    Selection.ClearContents\n    Range(\"additional2\").Select\n    Selection.ClearContents\n    Range(\"additional3\").Select\n    Selection.FormulaR1C1 = \"=RC[-11]\"\n    Range(\"additional4\").Select\n    Selection.FormulaR1C1 = \"=RC[-18]\"\n    Range(\"additional5\").Select\n    Selection.FormulaR1C1 = \"=RC[-18]\"\n    Range(\"additional6\").Select\n    Selection.FormulaR1C1 = \"=RC[-9]\"\n\n    Sheets(\"Macro Rules\").Select\n\n    Range(\"B21\").Select\n    Selection.FormulaR1C1 = \"=RC[+1]\" \n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This is the VB error that occurs:<br>\n<a href=\"https://i.stack.imgur.com/nmhuu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nmhuu.png\" alt=\"VB Error\"></a></p>\n\n<p>The macro is supposed to reset some fields across a few sheets in the workbook.  The macro was previously working before a team member worked on the file with an earlier version of Excel and since then this error has happened.  I haven't been able to find much through searching around on this specific situation.    Reverting to an old version would be my last resort due to time constraints.  Any way to fix this would be awesome.</p>\n"}, {"tags": ["vba", "excel", "match"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 8055070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8a61ed3c943ae2c305fdd70dffe0e60?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8055070/max"}, "is_accepted": true, "score": 6, "last_activity_date": 1495632190, "creation_date": 1495632190, "answer_id": 44159674, "question_id": 44159529, "link": "https://stackoverflow.com/questions/44159529/application-match-in-vba/44159674#44159674", "title": "Application.match in VBA", "body": "<p>You need to specify the range where to search in both Matches. </p>\n\n<pre><code>Application.Match(1, ws.range(\"AD:AD\"),0)\n</code></pre>\n\n<p>where ws is your worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1495632192, "creation_date": 1495632192, "answer_id": 44159675, "question_id": 44159529, "link": "https://stackoverflow.com/questions/44159529/application-match-in-vba/44159675#44159675", "title": "Application.match in VBA", "body": "<p>The problem is the way you use <code>Application.Match</code>. \nIt should be like this:</p>\n\n<p><code>If Not IsError(Application.Match(1, Range(\"AD:AD\"), 0)) Then</code></p>\n\n<p>See more here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835873.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff835873.aspx</a></p>\n"}], "owner": {"reputation": 137, "user_id": 8030697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6ae6203e65b1ba57e1ecd01d9a572c?s=128&d=identicon&r=PG&f=1", "display_name": "Karen88", "link": "https://stackoverflow.com/users/8030697/karen88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45294, "favorite_count": 0, "accepted_answer_id": 44159674, "answer_count": 2, "score": 1, "last_activity_date": 1519503730, "creation_date": 1495631796, "last_edit_date": 1519503730, "question_id": 44159529, "link": "https://stackoverflow.com/questions/44159529/application-match-in-vba", "title": "Application.match in VBA", "body": "<p>I'm using \"Application.match\" to find if Column AD of a sheet contains \"1\".</p>\n\n<p>But whenever I try to run my code, \"Else\" condition is always True. Although I'm expecting it to enter the \"If\" condition, since Column AD has a cell with a value \"1\".</p>\n\n<p>The values of the cells in Column AD are mostly results of a formula, except for AD1, which has the string \"Check if Titile&amp;Author Match\", and AD2, which has the value \"0\".</p>\n\n<p>What is the problem. What is the solution for it?</p>\n\n<p>I hope you can suggest a solution that would still use the \".match\" method. This is because from my understanding \".match\" method returns the relative position of the match in the range. And I plan to use that value later on in my code.</p>\n\n<pre><code>Private Sub CmdLocateDta_Click()\n\nDim SearchColumn As Integer\n\nIf Not IsError(Application.Match(1, \"AD:AD\", 0)) Then\n    SearchColumn = Application.Match(1, \"AD\", 0)\n    MsgBox \"Data has been located.\" &amp; vbNewLine &amp; _\n           \"You can now input the Lending Information below.\"\nElse\n    MsgBox \"There seems to be no such book in the Database.\" &amp; _\n            vbNewLine &amp; \"Please re-check your input.\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 8053786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460ba55f8ea36ca9e51bcab34c64fc0a?s=128&d=identicon&r=PG", "display_name": "user8053786", "link": "https://stackoverflow.com/users/8053786/user8053786"}, "is_accepted": false, "score": 0, "last_activity_date": 1495633151, "last_edit_date": 1495633151, "creation_date": 1495631436, "answer_id": 44159398, "question_id": 44158839, "link": "https://stackoverflow.com/questions/44158839/vba-multiple-named-ranges-with-offset/44159398#44159398", "title": "VBA: Multiple Named Ranges with Offset", "body": "<p>The first one, range C1F, can be changed to:</p>\n\n<pre><code>ws.Names.Add Name:=Replace(ws.Name &amp; \"_C1F\", \" \", \"_\"), RefersToR1C1:=\"=OFFSET(R3C7,0,0,R1C6,1)\"\n</code></pre>\n\n<p>And then you change the rest accordingly. </p>\n\n<p>Alternatively, if you want the ranges to change every time you run the code:</p>\n\n<pre><code>ws.Names.Add Name:=Replace(ws.Name &amp; \"_C1F\", \" \", \"_\"), RefersToR1C1:=\"=OFFSET(R3C7,0,0,\u201d &amp; RowLength &amp; \" ,1)\"\n</code></pre>\n\n<p>Where you make</p>\n\n<pre><code>RowLength=range(\u201cF1\u201d).value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 3219646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bSFOB.png?s=128&g=1", "display_name": "g.kov", "link": "https://stackoverflow.com/users/3219646/g-kov"}, "is_accepted": false, "score": 0, "last_activity_date": 1495634494, "creation_date": 1495634494, "answer_id": 44160682, "question_id": 44158839, "link": "https://stackoverflow.com/questions/44158839/vba-multiple-named-ranges-with-offset/44160682#44160682", "title": "VBA: Multiple Named Ranges with Offset", "body": "<p>For just the first range, use </p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_C1F\", \" \", \"_\") _\n , RefersTo:=\"=offset($G$3,,,$F$1)\" _\n , MacroType:=1\n</code></pre>\n\n<p>make similar changes to set the other dynamic ranges.</p>\n\n<p><code>MacroType:=1</code> means that name does refer to a function.</p>\n"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1495634494, "creation_date": 1495630018, "question_id": 44158839, "link": "https://stackoverflow.com/questions/44158839/vba-multiple-named-ranges-with-offset", "title": "VBA: Multiple Named Ranges with Offset", "body": "<p>I have the following code</p>\n\n<pre><code>Sub NamedRange()\nApplication.ScreenUpdating = False\nDim ws As Worksheet\nDim rangeC1F As Range\nDim rangeC2F As Range\nDim rangeC3F As Range\nDim rangeC4F As Range\nDim rangeP1F As Range\nDim rangeP2F As Range\nDim rangeP3F As Range\nDim rangeP4F As Range\n\n    For Each ws In ThisWorkbook.Worksheets\n    ws.Activate\n    With ActiveWindow\n        Set rangeC1F = ws.Range(\"G3:G100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_C1F\", \" \", \"_\"), RefersTo:=rangeC1F\n        Set rangeC2F = ws.Range(\"T3:T100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_C2F\", \" \", \"_\"), RefersTo:=rangeC2F\n        Set rangeC3F = ws.Range(\"AG3:AG100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_C3F\", \" \", \"_\"), RefersTo:=rangeC3F\n        Set rangeC4F = ws.Range(\"AT3:AT100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_C4F\", \" \", \"_\"), RefersTo:=rangeC4F\n        Set rangeP1F = ws.Range(\"BG3:BG100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_P1F\", \" \", \"_\"), RefersTo:=rangeP1F\n        Set rangeP2F = ws.Range(\"BT3:BT100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_P2F\", \" \", \"_\"), RefersTo:=rangeP2F\n        Set rangeP3F = ws.Range(\"CG3:CG100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_P3F\", \" \", \"_\"), RefersTo:=rangeP3F\n        Set rangeP4F = ws.Range(\"CT3:CT100\")\n        ActiveWorkbook.Names.Add Name:=Replace(ws.Name &amp; \"_P4F\", \" \", \"_\"), RefersTo:=rangeP4F\n    End With\nNext                                               \nApplication.ScreenUpdating = True                                         \nEnd Sub\n</code></pre>\n\n<p>This code enables me to create defined/named ranges for a large amount of sheets. However, with the current code the ranges are static. I would like to make them dynamic with the \"offset\"-function. \nThe lenght of the ranges are determined by the values of cell F1 for range C1F, cell S1 for range C2F, cell AF1 for range C3F, cell AS1 for range C4F, cell BF1 for range P1F, cell BS1 for range P2F, cell CF1 for range P3F, cell CS1 for range P4F. The starting cells remain the same (cells G3, T3, AG3, ..., CT3)</p>\n\n<p>How can I correctly insert offset function in my existing module?</p>\n\n<p>thank you!</p>\n"}, {"tags": ["excel", "reference", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495630305, "post_id": 44158822, "comment_id": 75334156, "body": "yes, you need VBA if you don&#39;t want to do it manually. Formulas are for calculating only and therefore they only reference to the value of cells because you can&#39;t calculate with borders and text colors."}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1495631258, "post_id": 44159294, "comment_id": 75334906, "body": "Unfortunately this task will need to be repeated at regular intervals :("}], "tags": [], "owner": {"reputation": 186, "user_id": 7875515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8uwCi.jpg?s=128&g=1", "display_name": "Fillard Millmore", "link": "https://stackoverflow.com/users/7875515/fillard-millmore"}, "is_accepted": false, "score": 1, "last_activity_date": 1495631175, "creation_date": 1495631175, "answer_id": 44159294, "question_id": 44158822, "link": "https://stackoverflow.com/questions/44158822/include-formatting-when-referencing-cell-from-another-workbook/44159294#44159294", "title": "include formatting when referencing cell from another workbook", "body": "<p>If you simply want to do a one-time copy of a cell(s), I do not believe you'll need VBA. You should just be able to highlight the cells you desire for copying in one workbook, then CTRL+C [copy highlighted contents] - then open the workbook for pasting, right click the upper-left cell of the area to be pasted, click \"Paste Special\", and make sure that the 'Paste' radio-button is set to 'All', and click \"Paste\". If this is a link to data you wish to paste along with the formatting, the solution is more involved.  </p>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495631605, "creation_date": 1495629965, "last_edit_date": 1531161705, "question_id": 44158822, "link": "https://stackoverflow.com/questions/44158822/include-formatting-when-referencing-cell-from-another-workbook", "title": "include formatting when referencing cell from another workbook", "body": "<p>I want to pull in/copy over the values and formatting of a cell (the text color, the font size, bold etc) from one workbook to another. </p>\n\n<p>As I understand it, using a standard cell referencing doesn't work, you need vba.</p>\n\n<p>Here's some vba code which copies the formatting from a3 to a10 in the same worksheet:</p>\n\n<pre><code>Dim ping As Boolean\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Intersect(Target, Range(\"A3\")) Is Nothing Then\nIf ping = False Then\nRange(\"A3\").Copy\nRange(\"C10\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n        , SkipBlanks:=False, Transpose:=False\nEnd If\nping = True\nExit Sub\nElse\nping = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>How can I change this code to copy A3 from a different workbook named \"mybook\"?</p>\n"}, {"tags": ["vba", "excel", "range", "cells"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495629774, "post_id": 44158605, "comment_id": 75333724, "body": "how about <code>Range(&quot;A1&quot;, Cells(ostatnia_dana, ostatnia_dana1)).Select</code>?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1495630185, "post_id": 44158605, "comment_id": 75334053, "body": "Does Activesheet.usedrange.select not work? Or did I get the question wrong?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1495630570, "post_id": 44158605, "comment_id": 75334341, "body": "Or maybe you mean Activesheet.Range(&quot;A1&quot;).CurrentRegion.Select"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495630040, "post_id": 44158777, "comment_id": 75333920, "body": "you missed the <code>.</code> before <code>Rows.Count</code> and <code>Columns.Count</code> I think"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1495630391, "last_edit_date": 1495630391, "creation_date": 1495629842, "answer_id": 44158777, "question_id": 44158605, "link": "https://stackoverflow.com/questions/44158605/vba-total-range/44158777#44158777", "title": "VBA Total range", "body": "<p>This is a very dirty solution.\nChange the last row as in my example. :)</p>\n\n<pre><code>Option Explicit\n\nSub ranging()\n\n    Dim ostatnia_dana As Integer\n    Dim ostatnia_dana1 As Integer\n    ostatnia_dana = Cells(Rows.Count, 2).End(xlUp).Row\n    ostatnia_dana1 = Cells(2, Columns.Count).End(xlToLeft).Column\n    Range(Cells(1, 1), Cells(ostatnia_dana, ostatnia_dana1)).Select\n\nEnd Sub\n</code></pre>\n\n<p>This is a bit better:</p>\n\n<pre><code>Option Explicit\n\nSub ranging()\n\n    Dim ostatnia_dana   As Long\n    Dim ostatnia_dana1  As Long\n\n    With ActiveSheet\n        ostatnia_dana = .Cells(.Rows.Count, 2).End(xlUp).Row\n        ostatnia_dana1 = .Cells(2, .Columns.Count).End(xlToLeft).Column\n        .Range(.Cells(1, 1), .Cells(ostatnia_dana, ostatnia_dana1)).Select\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>What is better in the second solution:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Usage of Long</a>   </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Correct usage of Range and Cells objects</a></li>\n</ul>\n\n<p>In general, it would work quite well without the <code>With ActiveSheet</code> part, but if you refer to another sheet, which is not the active one it would fail. In general, lets imagine that you had some sheet other active and you want to select a sheet named <code>MyWorksheetName</code>. Then the following would work:</p>\n\n<pre><code>Option Explicit\n\nSub MyRanges()\n\n    Dim ostatnia_dana   As Long\n    Dim ostatnia_dana1  As Long\n\n    Dim ws              As Worksheet\n\n    Set ws = Worksheets(\"MyWorksheetName\")\n\n    With ws\n\n        ostatnia_dana = .Cells(Rows.Count, 2).End(xlUp).Row\n        ostatnia_dana1 = .Cells(2, Columns.Count).End(xlToLeft).Column\n\n        .Select\n        .Range(.Cells(1, 1), .Cells(ostatnia_dana, ostatnia_dana1)).Select\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7861478, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ee6e4d9e0eb14bd12b2543921e2bd58f?s=128&d=identicon&r=PG&f=1", "display_name": "aannie", "link": "https://stackoverflow.com/users/7861478/aannie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495630391, "creation_date": 1495629371, "last_edit_date": 1531164843, "question_id": 44158605, "link": "https://stackoverflow.com/questions/44158605/vba-total-range", "title": "VBA Total range", "body": "<p>I want to select entire data (whole range) in the sheet. I dont know why error occurs here:<br>\n<code>Range(\"A1:(Cells(ostatnia_dana, ostatnia_dana1)\").Select</code></p>\n\n<pre><code>Sub ranging()\n    Dim ostatnia_dana As Integer\n    Dim ostatnia_dana1 As Integer\n    ostatnia_dana = Cells(Rows.Count, 2).End(xlUp).Row\n    ostatnia_dana1 = Cells(2, Columns.Count).End(xlToLeft).Column\n    Range(\"A1:(Cells(ostatnia_dana, ostatnia_dana1)\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 7634567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60eed0f83209e24312353feea1baf655?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7634567/joe"}, "edited": false, "score": 0, "creation_date": 1495714894, "post_id": 44159410, "comment_id": 75374834, "body": "Then why does your solution include  Format:=xlBitmap ?  You&#39;re welcome"}, {"owner": {"reputation": 1, "user_id": 7634567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60eed0f83209e24312353feea1baf655?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7634567/joe"}, "edited": false, "score": 0, "creation_date": 1498019747, "post_id": 44159410, "comment_id": 76318832, "body": "The problem is with ChartObjects not with the format. I have to change Charts with chartObjects."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495631458, "creation_date": 1495631458, "answer_id": 44159410, "question_id": 44158472, "link": "https://stackoverflow.com/questions/44158472/change-excel-comment-shape-picture-file-format/44159410#44159410", "title": "Change Excel comment Shape Picture File format", "body": "<p>Try changing Format:=xlPicture to Format:=xlBitmap because jpg is a bitmap type image.  See the following from MS. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837557.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff837557.aspx</a> </p>\n\n<p>And also <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195475.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff195475.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7634567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60eed0f83209e24312353feea1baf655?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7634567/joe"}, "is_accepted": false, "score": 0, "last_activity_date": 1495686906, "creation_date": 1495686906, "answer_id": 44172343, "question_id": 44158472, "link": "https://stackoverflow.com/questions/44158472/change-excel-comment-shape-picture-file-format/44172343#44172343", "title": "Change Excel comment Shape Picture File format", "body": "<p>Found the solution: </p>\n\n<pre><code>Option Explicit\nSub ReduceImageSize()\n    Dim cmt As Comment\n    Dim MyChart As ChartObject\n    Dim MyPicture As String\n    Dim pic As Object\n    Dim PicWidth As Long\n    Dim PicHeight As Long\n    Dim num As Long\n    Dim Mysheet As Worksheet\n     num = 1\n    Application.ScreenUpdating = False\n    For Each Mysheet In ThisWorkbook.Worksheets\n     For Each cmt In ActiveSheet.Comments\n        With cmt\n            .Visible = True\n            .Shape.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n            .Visible = False\n            PicHeight = .Shape.Height\n            PicWidth = .Shape.Width\n\n           Set MyChart = ActiveSheet.ChartObjects.Add(0, 0, 100, 100)\n                With MyChart\n                    .Activate\n                    .Width = PicWidth\n                    .Height = PicHeight\n                    .Chart.Paste\n                    '.ChartArea.Select\n                    '.Paste\n                    .Chart.Export Filename:=\"C:\\Temp\\MyPic \" &amp; num &amp; \".jpg\", FilterName:=\"jpg\"\n                End With\n                .Shape.Fill.UserPicture PictureFile:=\"C:\\Temp\\MyPic \" &amp; num &amp; \".jpg\"\n                num = num + 1\n                MyChart.Delete\n            End With\n      Next\n      Application.ScreenUpdating = True\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7634567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60eed0f83209e24312353feea1baf655?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7634567/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495686906, "creation_date": 1495629001, "last_edit_date": 1531164843, "question_id": 44158472, "link": "https://stackoverflow.com/questions/44158472/change-excel-comment-shape-picture-file-format", "title": "Change Excel comment Shape Picture File format", "body": "<p>Hi I want to change the file format of the comment shape picture (Fill) and as well as to a standard height and width. Tried the following code but it is keep on throwing Application defined error \"Run time error 1004\". Please guide me to correct this one.</p>\n\n<pre><code>Sub ReduceImageSize()\n\n    Dim cmt As Comment\n    Dim MyChart As Chart\n    Dim MyPicture As String\n    Dim pic As Object\n    Dim PicWidth As Long\n    Dim PicHeight As Long\n    Dim num As Long\n    num = 1\n    Application.ScreenUpdating = False\n    For Each cmt In ActiveSheet.Comments\n        With cmt\n            .Visible = True\n            .Shape.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n            .Visible = False\n            PicHeight = .Shape.Height\n            PicWidth = .Shape.Width\n\n           Set MyChart = Charts.Add(0, 0, 100, 100).Chart\n                With MyChart.Parent\n                    .Width = PicWidth\n                    .Height = PicHeight\n                    .ChartArea.Select\n                    .Paste\n                    .ChartObjects(1).Chart.Export Filename:=\"C:\\Temp\\MyPic \" &amp; num &amp; \".jpg\", FilterName:=\"jpg\"\n                End With\n                .Shape.Fill.UserPicture PictureFile:=\"C:\\Temp\\MyPic \" &amp; num - 1 &amp; \".jpg\"\n                num = num + 1\n                ActiveChart.Delete\n\n            End With\n\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel-2010", "userform"], "comments": [{"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 1, "creation_date": 1495628922, "post_id": 44158300, "comment_id": 75333075, "body": "Isn&#39;t textbox6 being assigned the value in Cells(iRow, 9)? Format column 9 as &quot;text&quot; and entire the data there as you want it to appear in textbox6."}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "reply_to_user": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 1, "creation_date": 1495629720, "post_id": 44158300, "comment_id": 75333681, "body": "Maybe I didn&#39;t make myself clear enough. I want the preset text &quot;06-&quot; shown in the Userform TextBox6. So when they enter the &quot;06-&quot;11111111 (only the remaining numbers), the value returns to my sheet as 06-11111111. Do you think this is possible?"}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 1, "creation_date": 1495630289, "post_id": 44158300, "comment_id": 75334143, "body": "Oh sure. Add &quot;06-&quot; &amp; before Me.Textbox6.Value. So it reads <code>ws.Cells(iRow, 9).Value = &quot;06-&quot; &amp; Me.TextBox6.Value</code> You may need to format the cells to text or something because it might give you a date otherwise. Answer is below :)"}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 1, "creation_date": 1495630444, "post_id": 44158300, "comment_id": 75334249, "body": "Just to explain, everything between the &quot; &quot; is what text you want and the &amp; is the command to add the rest of your instruction."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1495630509, "post_id": 44158980, "comment_id": 75334306, "body": "Would i do this in a Private Sub?"}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "reply_to_user": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 1, "creation_date": 1495630613, "post_id": 44158980, "comment_id": 75334374, "body": "In your code, yes. Just add that small portion <code>&quot;06-&quot; &amp;</code> in front of <code>Me.TextBox6.Value</code>"}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "reply_to_user": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 1, "creation_date": 1495630756, "post_id": 44158980, "comment_id": 75334490, "body": "You won&#39;t see it in the text box but it will show in the cell when its done."}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1495631245, "post_id": 44158980, "comment_id": 75334895, "body": "Ahhhhh, now i get it. How do i go upon showing something like this in a TextBox. Because my users, are you know, users. I want them to see and enter the remaining 8 numbers. If I do it like this my users will probably end up with the value of 06-06-11111111.."}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "reply_to_user": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 1, "creation_date": 1495632021, "post_id": 44158980, "comment_id": 75335516, "body": "You could simply add a label in front of the textbox. and on the label properties, change &quot;caption&quot; to 06-. That way, they will see the 06- in front of the textbox and won&#39;t enter it. You could also just put a label stating don&#39;t add the code, just enter your 8 digit number or something."}], "tags": [], "owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "is_accepted": true, "score": 1, "last_activity_date": 1495630368, "creation_date": 1495630368, "answer_id": 44158980, "question_id": 44158300, "link": "https://stackoverflow.com/questions/44158300/formatting-textbox-userform-vba-in-excel-2010-to-dutch-mobile-phone-number/44158980#44158980", "title": "Formatting Textbox (Userform VBA in Excel 2010) to Dutch mobile phone number", "body": "<pre><code>ws.Cells(iRow, 9).Value = \"06-\" &amp; Me.TextBox6.Value\n</code></pre>\n\n<p>Be aware of cell formatting as you may get a date. Convert to text or number etc.</p>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 44158980, "answer_count": 1, "score": 0, "last_activity_date": 1495630368, "creation_date": 1495628484, "question_id": 44158300, "link": "https://stackoverflow.com/questions/44158300/formatting-textbox-userform-vba-in-excel-2010-to-dutch-mobile-phone-number", "title": "Formatting Textbox (Userform VBA in Excel 2010) to Dutch mobile phone number", "body": "<p>Fellow StackOverFlow-ians,</p>\n\n<p>I come to you with another question that i'm trying to learn from.\nI have a UserForm which adds Employees to an Employee-database.\nCode is as below, and working perfectly.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim iRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Employee-Data\")\n\niRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nws.Cells(iRow, 4).Value = Me.TextBox1.Value\nws.Cells(iRow, 3).Value = Me.TextBox2.Value\nws.Cells(iRow, 7).Value = Me.TextBox3.Value\nws.Cells(iRow, 6).Value = Me.TextBox4.Value\nws.Cells(iRow, 15).Value = Me.TextBox5.Value\nws.Cells(iRow, 9).Value = Me.TextBox6.Value\nThisWorkbook.Save\nUnload Employee\nEnd Sub\n</code></pre>\n\n<p>My problem is as following, I want to restrict the format of TextBox6 to a Dutch telephone-number, which is 06-########. I want TextBox6 to show 06- and make it only able to type 8 numbers in as Value.</p>\n\n<p>I've tried the following and more:</p>\n\n<pre><code>Private Sub TextBox6_Change()\nTextBox1.Text = Format(ws.Cells(iRow, 9).Value,\"##\"\"-\"########\")\n\nEnd Sub\n</code></pre>\n\n<p>What is my error in thinking here, am i using a wrong approach? Can anybody suggest a decent solution for this problem? As said before, trying to learn from my errors, so please tell me what I'm doing wrong instead of just providing a solution.</p>\n"}, {"tags": ["vba", "excel", "range", "border"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495629631, "post_id": 44158298, "comment_id": 75333615, "body": "I recommend to use <a href=\"https://support.office.com/en-us/article/Format-an-Excel-table-6789619f-c889-495c-99c2-2f971c0e2370?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">formatted tables</a> for this use case. Then you can access and copy the whole formatted table at once without searching for values or borders."}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495630501, "post_id": 44158298, "comment_id": 75334300, "body": "Thanks for your input. I will definitely keep your suggestion in mind. If I do need to use borders still, can you recommend any ways to search for the entire table of borders?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495630566, "post_id": 44158298, "comment_id": 75334337, "body": "yes, use formatted tables. Otherwise no. <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">Here</a> is a nice guide what you can do with tables and VBA."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495630329, "post_id": 44158663, "comment_id": 75334173, "body": "Thanks for your input. However, It does not get the empty rows as well. I will keep your code in mind should I need it for other tasks though."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495632799, "post_id": 44158663, "comment_id": 75336204, "body": "Which empty rows?"}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495633122, "post_id": 44158663, "comment_id": 75336442, "body": "Refer to the second picture, there are empty rows in the second table. Can you modify your code to copy the whole table, including those empty rows of borders as well? Cheers"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495633239, "post_id": 44158663, "comment_id": 75336532, "body": "OK I see now, so it&#39;s all the block of cells with borders."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495633728, "post_id": 44158663, "comment_id": 75336960, "body": "Amended code above - please give it a go and let me know how you get on."}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495636723, "post_id": 44158663, "comment_id": 75339473, "body": "Thanks for your help! Your code kind of works. Just one thing though. Is it possible to get the block of cells, regardless of the border&#39;s thickness? Currently your code only works on the thin line border, while disregarding the medium thickness border."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1495637043, "post_id": 44158663, "comment_id": 75339759, "body": "I&#39;ve made another change which seems to work when I tested it."}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 1, "creation_date": 1495640039, "post_id": 44158663, "comment_id": 75342172, "body": "Excellent! This will do. Thanks a lot for your help. I really appreciate it."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1495637029, "last_edit_date": 1495637029, "creation_date": 1495629531, "answer_id": 44158663, "question_id": 44158298, "link": "https://stackoverflow.com/questions/44158298/excel-vba-how-to-select-the-whole-table-of-borders/44158663#44158663", "title": "Excel VBA - How to select the whole table of borders", "body": "<p>Try this</p>\n\n<pre><code>Sub x()\n\nDim rEnd As Range, rStart As Range, i As Long\n\nSet rEnd = Range(\"C\" &amp; Rows.Count).End(xlUp)\n\nDo While rEnd.Offset(i).Borders(xlEdgeBottom).LineStyle = xlContinuous\n    i = i - 1\nLoop\n\nSet rStart = rEnd.Offset(i + 1)\n\nRange(rStart, rEnd).Resize(, 8).Copy rEnd.Offset(3)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "accepted_answer_id": 44158663, "answer_count": 1, "score": 1, "last_activity_date": 1495637029, "creation_date": 1495628479, "last_edit_date": 1495629449, "question_id": 44158298, "link": "https://stackoverflow.com/questions/44158298/excel-vba-how-to-select-the-whole-table-of-borders", "title": "Excel VBA - How to select the whole table of borders", "body": "<p>i am very new to Excel VB. I am hoping you can assist with my problem. </p>\n\n<p>I have several tables like this\n<a href=\"https://i.stack.imgur.com/ku1sO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ku1sO.png\" alt=\"this\"></a></p>\n\n<p>The tables can be edited such as by inserting new rows, etc by the user.</p>\n\n<p>I want to highlight and copy the latest table (the one at the very last row) and paste it at the next available space, 3 rows down. \nI managed to do this, but I can only highlight and copy the cells with data. So should there be an empty row in the middle of the table, or an empty last row with borders, it would not copy correctly, as shown here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yQa4B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yQa4B.png\" alt=\"here\"></a></p>\n\n<p>I do still need to copy everything within the borders including empty rows, but I lack the skills and knowledge to do so. I hope you can assist.</p>\n\n<p>The following is my code:</p>\n\n<pre><code>Sub CopyPaste()\n    LastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    FirstColumn = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlNext).Column\n    LastColumn = Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n    BelowLastName = Cells.Find(\"\", After:=Cells(LastRow, FirstColumn), SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Row\n\n\n    Cells(BelowLastName, FirstColumn).Select 'This selects C5 (refer image)\n    Selection.Offset(-1).Select 'This selects C4 (refer image)\n    Range(Selection, Cells(LastRow, LastColumn)).Select 'This highlights whole table\n    Selection.Copy\n\n    Cells(LastRow, FirstColumn).Select\n    ActiveCell.Offset(3).Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "file", "directory"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 1, "creation_date": 1495628224, "post_id": 44158090, "comment_id": 75332592, "body": "Please format your code to make it readable. What changes to your code have you tried so far?"}, {"owner": {"reputation": 1, "user_id": 8055144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1990374927669469/picture?type=large", "display_name": "Eloisa Zuccherelli", "link": "https://stackoverflow.com/users/8055144/eloisa-zuccherelli"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495630208, "post_id": 44158090, "comment_id": 75334067, "body": "Done! I&#39;m learning haha"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495632493, "post_id": 44158090, "comment_id": 75335933, "body": "Well done! What changes to your code have you tried so far? Adding an <code>If</code> statement to the part where you add your results to the list to filter for your desired folder names should do the trick."}, {"owner": {"reputation": 1, "user_id": 8055144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1990374927669469/picture?type=large", "display_name": "Eloisa Zuccherelli", "link": "https://stackoverflow.com/users/8055144/eloisa-zuccherelli"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495633224, "post_id": 44158090, "comment_id": 75336521, "body": "That&#39;s what I was trying, but Idk how to write this.. If (?).Name = &quot;March&quot; Idk what string to put"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495634934, "post_id": 44158090, "comment_id": 75337979, "body": "After the line <code>ReDim Preserve myList(1 To 2, 1 To n)</code> add <code>Debug.Print(MyDir)</code> and <code>Debug.Print(myFile.Name)</code>. Look at the output in your immediate window. This way it should be easier to see on what to filter in your <code>If</code> statement."}, {"owner": {"reputation": 1, "user_id": 8055144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1990374927669469/picture?type=large", "display_name": "Eloisa Zuccherelli", "link": "https://stackoverflow.com/users/8055144/eloisa-zuccherelli"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495637744, "post_id": 44158090, "comment_id": 75340378, "body": "I didn&#39;t see anything :("}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495646195, "post_id": 44158090, "comment_id": 75346031, "body": "Press ctrl+G to view the window"}], "owner": {"reputation": 1, "user_id": 8055144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1990374927669469/picture?type=large", "display_name": "Eloisa Zuccherelli", "link": "https://stackoverflow.com/users/8055144/eloisa-zuccherelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495635097, "creation_date": 1495627867, "last_edit_date": 1495635097, "question_id": 44158090, "link": "https://stackoverflow.com/questions/44158090/improving-a-code-to-bring-just-folders-that-i-choose", "title": "Improving a code to bring just folders that I choose", "body": "<p>I have the code below that's working just fine. I got it from a site. In this code I choose the name of a file that I want to get and then It brings all the folders/subfolders where there's this file.\nI want to refine with the name of the subfolders. I want to choose to return files that belongs in subfolders that contains the name \"March\" and \"Week 2\" for example.</p>\n\n<pre><code>Sub test()\n  Dim MyDir As String, temp(), myList, myExtension As String\n  Dim SearchSubFolders As Boolean, Rtn As Integer, msg As String\n  With Application.FileDialog(msoFileDialogFolderPicker)\n    If .Show Then\n      MyDir = .SelectedItems(1)\n    End If\n  End With\n  msg = \"Enter File name and Extension\" &amp; vbLf &amp; \"following wild\" &amp; _\n        \" cards can be used\" &amp; vbLf &amp; \"* # ?\"\n  myExtension = Application.InputBox(msg)\n  If (myExtension = \"False\") + (myExtension = \"\") Then Exit Sub\n  Rtn = MsgBox(\"Include Sub Folders ?\", vbYesNo)\n  SearchSubFolders = Rtn = 6\n  myList = SearchFiles(MyDir, myExtension, 0, temp(), SearchSubFolders)\n  If Not IsError(myList) Then\n    ActiveSheet.Cells(1).Resize(UBound(myList, 2), 2).Value = Application.Transpose(myList)\n  Else\n    MsgBox \"No file found\"\n  End If\n  Call DeleteRowNoInclude\nEnd Sub\n\nPrivate Function SearchFiles(MyDir As String _\n                           , myFileName As String, n As Long, myList() _\n                           , Optional SearchSub As Boolean = False) As Variant\n  Dim fso As Object, myFolder As Object, myFile As Object\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n  For Each myFile In fso.GetFolder(MyDir).Files\n    Select Case myFile.Attributes\n      Case 2, 4, 6, 34\n      Case Else\n        If (Not myFile.Name Like \"~$*\") _\n         * (myFile.Path &amp; \"\\\" &amp; myFile.Name &lt;&gt; ThisWorkbook.FullName) _\n         * (UCase(myFile.Name) Like UCase(myFileName)) Then\n          n = n + 1\n          ReDim Preserve myList(1 To 2, 1 To n)\n          myList(1, n) = MyDir\n          myList(2, n) = myFile.Name\n        End If\n    End Select\n  Next\n  If SearchSub Then\n    For Each myFolder In fso.GetFolder(MyDir).subfolders\n       SearchFiles = SearchFiles(myFolder.Path, myFileName, n, myList, SearchSub)\n    Next        \n  End If\n  SearchFiles = IIf(n &gt; 0, myList, CVErr(xlErrRef))\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495636885, "post_id": 44158541, "comment_id": 75339605, "body": "Thanks! Works great! Would you happen to know how to select every other row in the sheet1 column A? Because in column A (sheet1) I have input, then new row is comment and then input then comment again."}, {"owner": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495639443, "post_id": 44158541, "comment_id": 75341695, "body": "Oh John, I notice it takes about 15 secs for sheet2 to search for the item in sheet1. Do you know if there&#39;s a way to speed it up? The last row the code needs to search is the last one with something inputed."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495649478, "post_id": 44158541, "comment_id": 75347853, "body": "The .find method is the fastest search method I know.  How many used rows do you have in Sheet1.  It would take many, many rows to make it take 15 seconds per search.  Something else might be slowing it down.  But no, I don&#39;t know how to make the .find method search only every other row.  Maybe you should try putting all the dat in sheet1.column&quot;A&quot; into an array - and search through the array.  That is the only thing that would be faster than the .find method.  Let me take a look.  Is your data on odd rows and comments on even rows?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495650305, "post_id": 44158541, "comment_id": 75348277, "body": "I just tested it with 11,000 pieces of data in column A and it found a word in row 10,033 in less than a second.  Now the &quot;LastRow&quot; variable above is set to get the last used row of the entire sheet1, not just column &quot;A&quot;.  Try changing that to &quot;LastRow = Sheet1.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row&quot;"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495650647, "post_id": 44158541, "comment_id": 75348447, "body": "also change the following line &quot;Set c = .Find(Target, LookIn:=xlValues)&quot; to this: &quot;Set c = .Find(Target, LookIn:=xlValues LookAt:=xlWhole)&quot;"}, {"owner": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495651659, "post_id": 44158541, "comment_id": 75348965, "body": "I took your suggestion to make a new list in another worksheet that takes in only the rows I want and it made the search super fast. It might just be that my laptop is super slow and it&#39;s just really laggy. You&#39;re such a lifesaver, this works so well!! THANKSS &lt;3 :)"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "edited": false, "score": 0, "creation_date": 1495652380, "post_id": 44158541, "comment_id": 75349282, "body": "Good!  Glad to help"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1495629211, "creation_date": 1495629211, "answer_id": 44158541, "question_id": 44158053, "link": "https://stackoverflow.com/questions/44158053/vba-to-restrict-input-in-sheet2-column-a-to-the-same-values-found-in-sheet1-colu/44158541#44158541", "title": "VBA to restrict input in sheet2 column A to the same values found in sheet1 columnA", "body": "<p>Put this in sheet2 module.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 1 Then\n    LastRow = Sheet1.UsedRange.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    With Sheet1.Range(\"a1:a\" &amp; LastRow)\n        Set c = .Find(Target, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            Exit Sub\n        End If\n    End With\n    Application.EnableEvents = False\n    Beep\n    MsgBox Target &amp; \" is not found in Sheet1 Column A\"\n    Target = \"\"\n    Application.EnableEvents = True\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8042526, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1550114921668106/picture?type=large", "display_name": "Didi Zhang", "link": "https://stackoverflow.com/users/8042526/didi-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 44158541, "answer_count": 1, "score": 0, "last_activity_date": 1495629412, "creation_date": 1495627777, "last_edit_date": 1531164843, "question_id": 44158053, "link": "https://stackoverflow.com/questions/44158053/vba-to-restrict-input-in-sheet2-column-a-to-the-same-values-found-in-sheet1-colu", "title": "VBA to restrict input in sheet2 column A to the same values found in sheet1 columnA", "body": "<p>Anyway I can restrict any values in sheet2 column A to whatever values were found in sheet1 columnA? If the user puts in a value in sheet2 column A that is not found in sheet1 columnA, a msgbox will come up and restrict the input.  Perhaps use VBA for this? </p>\n\n<p>Thanks in advance!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495628955, "post_id": 44157921, "comment_id": 75333092, "body": "You can extract them one bye one: Copy the column you like first at first and paste it then copy the column you want to be second and paste it and so on."}], "answers": [{"tags": [], "owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "is_accepted": false, "score": 0, "last_activity_date": 1495639181, "last_edit_date": 1525816189, "creation_date": 1495636864, "answer_id": 44161671, "question_id": 44157921, "link": "https://stackoverflow.com/questions/44157921/extract-columns-to-another-excel-sheet-in-certain-order/44161671#44161671", "title": "Extract columns to another Excel sheet, in certain order", "body": "<p>The fastest way to do it would be to read the first table in to an array (see <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ArraysAndRanges.aspx</a> for examples), copy values from the first array into a second array in the order that you want to paste, and then write the array to a new table.</p>\n\n<p>Working with arrays instead of copy/paste is orders of magnitude faster.</p>\n\n<p>This example reads a range with three columns into an array and then picks column 1 and 3 and puts them into a new array.  Should be enough to get you started!</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub test()\nDim range1 as Range, destination as Range\ndim sourcedata() as variant\ndim targetdata() as variant\n\nSet range1 = Range(\"B1:D50\")\nSet destination = Range(\"K1\")\nsourcedata = range1.Value2\n\nRedim targetdata(UBound(sourcedata, 1), 2)\n\nDim i As Long\n\nFor i = 1 to Ubound(sourcedata, 1)\n    targetdata(i, 1) = sourcedata(i, 1)\n    targetdata(i, 2) = sourcedata(i, 3)\nNext\n\ndestination.Resize(Ubound(targetdata, 1), Ubound(targetdata, 2)).Value = targetdata\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1186467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e44380958cc0f9a881ea5b980ab53c?s=128&d=identicon&r=PG", "display_name": "user1186467", "link": "https://stackoverflow.com/users/1186467/user1186467"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1746, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1495639181, "creation_date": 1495627443, "last_edit_date": 1531161705, "question_id": 44157921, "link": "https://stackoverflow.com/questions/44157921/extract-columns-to-another-excel-sheet-in-certain-order", "title": "Extract columns to another Excel sheet, in certain order", "body": "<p>I have a large datafile in Excel with about 240 columns each representing a variable. As I only need 56 of these variables, I want to extract the corresponding columns to another Excel sheet. </p>\n\n<p>I managed to do so with a macro using the following code (which I found here <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_winother/extract-columns-from-excel-to-new-sheet-as/d825f54f-4f19-42da-881b-95ae0af74b04\" rel=\"nofollow noreferrer\">Extract columns from excel to new sheet as repeated process</a>):</p>\n\n<pre><code>Public Sub extractCol()\n    Set range1 = Range(\"A:D, BI:BI, BQ:BQ,CL:CL,CM:CN,CT:CT,DB:DB\")\n    range1.Copy\n    Set newbook = Workbooks.Add\n    ActiveCell.PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>Because this new datafile will be more clear and convenient if I have the columns in a certain order (e.g.: DB - BI - CL - CM - CN - A:D), I wonder whether there is something I can add to this code to put the columns in the order I want in the new file?</p>\n\n<p>Or is there an entirely different way to do this whole extracting and sorting of columns in excel that doesn't use a (or this) macro? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 1, "creation_date": 1495627952, "post_id": 44157846, "comment_id": 75332341, "body": "What exactly do you mean by &quot;stuck&quot;? Error message? Does your loop work?"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495629230, "post_id": 44157846, "comment_id": 75333306, "body": "as in...it keeps on looking for &quot;84225&quot; and isn&#39;t moving on to &quot;85511&quot; and then &quot;85370&quot; and so on"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495629933, "post_id": 44157846, "comment_id": 75333839, "body": "its still searching only for &quot;84225&quot; and ignoring other S/Os :/"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495632274, "post_id": 44157846, "comment_id": 75335735, "body": "its working now, thank you"}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1495629377, "post_id": 44158240, "comment_id": 75333410, "body": "i used your code and now nothing is happening. think of it as if im &quot;Ctrl F&quot; for each value in my range and looking for it in the other Sheet (&quot;data&quot;)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1495633453, "post_id": 44158240, "comment_id": 75336719, "body": "That&#39;s what the code does - Ctrl F on each value in <code>SearchKey</code>.  There&#39;s a couple of things that could be causing it:  Is <code>SearchKey</code> looking at the correct range (I changed it to <code>C17:C21</code> on <code>Sheet1</code> for testing).  Are the values you&#39;re searching for in column C on the <code>Data</code> sheet?  Are the numbers on both sheet formatted as numbers or text (as long as they&#39;re both the same it should work).  Trying stepping through the code using F8 - does <code>FoundValue</code> contain a value after the <code>Find</code> command if it never does then that&#39;s the bit that&#39;s failing so it just skips over the <code>Cell.Offset(</code> line."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1495633763, "last_edit_date": 1495633763, "creation_date": 1495628295, "answer_id": 44158240, "question_id": 44157846, "link": "https://stackoverflow.com/questions/44157846/find-a-value-in-range-loop/44158240#44158240", "title": "Find a value in range + loop", "body": "<p>On each loop you're searching for the whole range of <code>SearchKey</code> and not just <code>Cell</code> so I'm guessing it's always using the first cell in SearchKey as your search criteria.</p>\n\n<p>You're also searching in the formula rather than the values, and looking for a part match which may return incorrect results (part match on 20 would return a find in 20, 201, 11120001, etc).</p>\n\n<p>Not qualifying your sheet names and using Activate probably isn't helping much either.</p>\n\n<p>Try this code:</p>\n\n<pre><code>Public Sub Test()\n\n    Dim SrcSht As Worksheet, TgtSht As Worksheet\n    Dim SearchKey As Range, Cell As Range\n    Dim FoundValue As Range\n\n    With ThisWorkbook\n        Set SrcSht = .Worksheets(\"Sheet1\")\n        Set TgtSht = .Worksheets(\"Data\")\n    End With\n\n    Set SearchKey = SrcSht.Range(\"C17:C21\")\n    For Each Cell In SearchKey\n        'Search column 3 (C) for your the value\n        Set FoundValue = TgtSht.Columns(3).Find(What:=Cell, _\n                                                After:=TgtSht.Columns(3).Cells(1, 1), _\n                                                LookIn:=xlValues, _\n                                                LookAt:=xlWhole, _\n                                                SearchOrder:=xlByRows, _\n                                                SearchDirection:=xlNext)\n\n        'Only proceed if value found, otherwise an error will occur.\n        If Not FoundValue Is Nothing Then\n            Cell.Offset(, 1) = FoundValue.Offset(, 1)\n        End If\n    Next Cell\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nTo test the code place the cursor within the procedure and press F8 to process each line in turn.  The <code>FoundValue</code> should contain a value each time it's executed.  </p>\n\n<p>To check this hover your cursor over the variable to see its value: </p>\n\n<p><a href=\"https://i.stack.imgur.com/TimG1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TimG1.png\" alt=\"enter image description here\"></a></p>\n\n<p>The row highlighted in yellow is the next line that will be executed.  If <code>FoundValue</code> is nothing then the following line isn't processed, if it's not nothing then the line is executed.</p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "is_accepted": true, "score": 1, "last_activity_date": 1495632198, "creation_date": 1495632198, "answer_id": 44159677, "question_id": 44157846, "link": "https://stackoverflow.com/questions/44157846/find-a-value-in-range-loop/44159677#44159677", "title": "Find a value in range + loop", "body": "<pre><code>Sub mac1()\n\n\nWorksheets(\"Sheet1\").Activate\nRange(\"c17\").Select\n\n\nDim srch As Range, cell As Variant\nSet srch = Range(\"c17:c160\")\n\nFor Each cell In srch\nSheets(\"data\").Activate\n\n    Cells.Find(What:=cell, LookIn:=xlValues, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\n\nActiveCell.Offset(0, -1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Sheet1\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nActiveSheet.Paste\nActiveCell.Offset(1, -1).Range(\"A1\").Select\nSelection.Copy\nNext cell\n</code></pre>\n\n<p>End Sub</p>\n\n<p>this is working!\nthank you all</p>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 44159677, "answer_count": 2, "score": 0, "last_activity_date": 1495633763, "creation_date": 1495627262, "question_id": 44157846, "link": "https://stackoverflow.com/questions/44157846/find-a-value-in-range-loop", "title": "Find a value in range + loop", "body": "<p>I need my macro to Look at a cell in my range, Find that value in the a different WS and paste a value on to that's next to the value i'm looking for (my original WS). do this again and again to the values in the range.</p>\n\n<p>now it all works but for some reason the value is stuck on the first search and wont look for other values in the original range.\nhere is my code, and the pictures should help.</p>\n\n<pre><code>Sub Macro1()\n</code></pre>\n\n<p>'\n'now im gonna match the \"UDD\" TO THE \"S/O\"</p>\n\n<pre><code>Worksheets(\"Sheet1\").Activate\nRange(\"c17\").Select\n\n   Dim Searchkey As Range, cell As Range\n   Set Searchkey = Range(\"c17:c160\")\n\nFor Each cell In Searchkey\nSheets(\"data\").Activate\nCells.Find(What:=Searchkey, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Activate\nActiveCell.Offset(0, -1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Sheet1\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nActiveSheet.Paste\nActiveCell.Offset(1, -1).Range(\"A1\").Select\nSelection.Copy\nNext cell\n</code></pre>\n\n<p>End Sub</p>\n\n<p>why is my macro stuck on \"84225\" and not looping to the other S/O?</p>\n\n<p>Thank you<a href=\"https://i.stack.imgur.com/E8iKe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E8iKe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1495628939, "creation_date": 1495628939, "answer_id": 44158450, "question_id": 44157837, "link": "https://stackoverflow.com/questions/44157837/how-to-find-if-the-column-exists-in-excel-through-vba/44158450#44158450", "title": "How to find if the column exists in Excel through VBA", "body": "<p><code>Find</code> can't be used to find values spread over several cells. I suggest this kind of code.</p>\n\n<pre><code>Private Sub FindMatchingColumn()\n    ' 24 May 2017\n\n    Dim Caption1, Caption2\n    Dim Combination As String\n    Dim Captions As String\n    Dim C As Long\n\n    Caption1 = \"Column A\"\n    Caption2 = \"Column 1\"\n    Combination = CStr(Caption1) &amp; CStr(Caption2)\n\n    With ActiveSheet\n        Do\n            C = C + 1\n            Captions = CStr(.Cells(1, C).value) &amp; CStr(.Cells(2, C).value)\n            If StrComp(Captions, Combination, vbTextCompare) = 0 Then Exit Do\n        Loop While Len(Captions)\n\n        If Len(Captions) Then\n            MsgBox \"Column \" &amp; C &amp; \" has matching captions\"\n        Else\n            MsgBox \"No matching captions were found\" &amp; vbCr &amp; _\n                   \"Write new captions to Column \" &amp; C\n            .Cells(1, C).value = Caption1\n            .Cells(2, C).value = Caption2\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Caption1 and Caption2 are the two column headers you are looking for. The first part of the code loops through all the columns to find that combination. If it is found it passes the column where it was found to the following code. If not, it passes the number of the next blank column.</p>\n\n<p>The second part takes that column number and acts upon it. If it is a used column you can add your value there. If it is a new column it adds the two captions and then you can add your values in it.</p>\n\n<p>This code presumes that you know the sequence of the captions. If you need to accept either A + B or B + A both values must be checked before passing to the next column in the Do loop.</p>\n"}], "owner": {"reputation": 11, "user_id": 7936066, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hCZizdzkQjw/AAAAAAAAAAI/AAAAAAAACOw/a9C2gzIouWI/photo.jpg?sz=128", "display_name": "Ramprasad N", "link": "https://stackoverflow.com/users/7936066/ramprasad-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1905, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495636254, "creation_date": 1495627244, "last_edit_date": 1495636254, "question_id": 44157837, "link": "https://stackoverflow.com/questions/44157837/how-to-find-if-the-column-exists-in-excel-through-vba", "title": "How to find if the column exists in Excel through VBA", "body": "<p>I have two headers in two rows in my excel based on which i upload values for each row. if the combination of two headers is already available, the values will be updated in that row. If that combination is not available a new column will be created. <br/>\nSample Excel<br/>\n<a href=\"https://i.stack.imgur.com/IrvFQ.jpg\" rel=\"nofollow noreferrer\"></a><a href=\"https://i.stack.imgur.com/4zruI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4zruI.jpg\" alt=\"sample xls\"></a>      </p>\n\n<p>As in the image, If i find Column 2 and Column B combination again i can update value in a new row against Column 2 and Column B. If there is another combination of headers say, Column 5 and column B, then it will create a new column. </p>\n\n<p>Using VBA i am able to check only one column header but not the combination of the headers. i used the below code.</p>\n\n<pre><code>Set c=ws.Range(\"B2\",ws.Cells(2,Columns.Count)).Find:=What(d,1)\nIF c is Nothing Then\nMy code\nElse`My Code End If \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495626377, "post_id": 44157467, "comment_id": 75331162, "body": "if you want the <b>blank</b> cell after the last used row (= last row filled with dada) then use <code>lastRow + 1</code> because <code>lastRow</code> represents the last row filled with data."}, {"owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495626492, "post_id": 44157467, "comment_id": 75331233, "body": "This happens with the + 1"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495626666, "post_id": 44157467, "comment_id": 75331388, "body": "So I can&#39;t guess what you are trying to achieve, you need to tell us your goal. Describe what your code actually does and what you expect it to do please."}, {"owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495627150, "post_id": 44157467, "comment_id": 75331758, "body": "Okay. I edited my question. I&#39;m not sure if that is understandable though. I&#39;m having a hard time explaining what I want to happen."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1495627578, "post_id": 44157467, "comment_id": 75332060, "body": "There are lots of merged cells in row 1. So, when lastrow = 1 in your loop, you would effectively be trying to write to various cells in the merged range. That isn&#39;t possible. You can only write in the first cell. Therefore check the value of lastrow."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 0, "creation_date": 1495629513, "post_id": 44158030, "comment_id": 75333526, "body": "Hi, Thank you so much. This worked for me. And I understood what is happening to my code through your explanation. Thank you so much. Now I&#39;ll research about the IIf you just told me to use to understand what happened. Thank you so much."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "reply_to_user": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 1, "creation_date": 1495629916, "post_id": 44158030, "comment_id": 75333816, "body": "You&#39;re welcome ;-) The <code>IIf</code> will add 1 to the result when <code>i = 1</code>, otherwise it will add nothing ( 0 ). It is like an <code>If ... Then ...  Else ...</code> statement, but then in a form you can use in an expression."}, {"owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 0, "creation_date": 1495630080, "post_id": 44158030, "comment_id": 75333952, "body": "Okay. I understand now. Thank you so much."}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1495628013, "last_edit_date": 1495628013, "creation_date": 1495627711, "answer_id": 44158030, "question_id": 44157467, "link": "https://stackoverflow.com/questions/44157467/excel-vba-add-data-to-cell-after-last-used-row/44158030#44158030", "title": "Excel VBA: Add data to cell after last used row", "body": "<p>The problem is that the first time you do <code>.Cells(.Rows.Count, 1).End(xlUp).Row</code> there will not be anything yet in A2, so <code>lastRow</code> will be 1. But once you put the value \"No.\" in that cell the next time you execute that code (with <code>i</code> being 2), A2 will be filled, so now <code>.Cells(.Rows.Count, 1).End(xlUp).Row</code> will return 2, giving you the effect you get: all other values end up one row lower.</p>\n\n<p>There are several way to solve this, but here is one way. Add <code>+ IIf(i = 1, 1, 0)</code> the assignment of <code>lastRow</code>:</p>\n\n<pre><code>lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + IIf(i = 1, 1, 0)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 0, "accepted_answer_id": 44158030, "answer_count": 1, "score": 0, "last_activity_date": 1495628013, "creation_date": 1495626269, "last_edit_date": 1495627087, "question_id": 44157467, "link": "https://stackoverflow.com/questions/44157467/excel-vba-add-data-to-cell-after-last-used-row", "title": "Excel VBA: Add data to cell after last used row", "body": "<p><a href=\"https://i.stack.imgur.com/lBdn2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lBdn2.png\" alt=\"enter image description here\"></a>\nThe pic shows what happens with my code. </p>\n\n<p>I have a user form and I add the labels of the user form into the selected worksheet. And this is what I tried. Now the problem is why is it that there is one cell not on the same row as the others? </p>\n\n<pre><code>Dim c As Control\nFor Each c In Me.Controls\n    If TypeName(c) = \"Label\" Then\n        With ActiveSheet\n            i = i + 1\n            Dim lastRow As Long\n            lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n\n            If c &lt;&gt; \"Chapter\" Then\n                .Range(Cells(1, 1), Cells(1, i)).Name = \"Chapter1\"\n                .Range(\"Chapter1\").Merge\n                .Range(\"Chapter1\").Value = \"Chapter 1\"\n                .Range(\"Chapter1\").HorizontalAlignment = xlCenter\n\n                .Cells(lastRow, i).Value = c.Caption\n            End If\n        End With\n    End If\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ucanaccess"], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1495662707, "last_edit_date": 1495662707, "creation_date": 1495638642, "answer_id": 44162357, "question_id": 44156324, "link": "https://stackoverflow.com/questions/44156324/open-command-console-and-pass-arguments-into-it-using-vba-access/44162357#44162357", "title": "Open command console and pass arguments into it using VBA Access", "body": "<p>The UCanAccess command-line utilities \"console.bat\" and \"console.sh\" are currently designed for interactive use only (as of version 4.0.2). They do not take parameters.</p>\n"}], "owner": {"reputation": 1, "user_id": 7966782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b65a76ec92625f644b438d82fed764?s=128&d=identicon&r=PG&f=1", "display_name": "Celso", "link": "https://stackoverflow.com/users/7966782/celso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495662707, "creation_date": 1495623320, "last_edit_date": 1495654774, "question_id": 44156324, "link": "https://stackoverflow.com/questions/44156324/open-command-console-and-pass-arguments-into-it-using-vba-access", "title": "Open command console and pass arguments into it using VBA Access", "body": "<p>I have this:</p>\n\n<pre><code>Private Sub Command25_Click()\n\n    Dim BatFile As String\n    BatFile = \"C:\\UCanAccess-4.0.2-bin\\console.bat\"\n\n    Shell BatFile &amp; \" \" &amp; \"\"\"C:\\Users\\celso\\Documents\\KeysConsole.accdb\"\"\"\n</code></pre>\n\n<p>What I want is to use <code>UCanAccess</code> to connect to my database, with that above code it only opens the command console and wait for input arguments for directory of the database file. </p>\n\n<p>How can I provide the argument so after console.bat is open pass the argument automatically and connect to the file without interaction.\nSorry I'm new on this and have tried different ways and no chances.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495623342, "post_id": 44156251, "comment_id": 75329029, "body": "Please add  the code you have tried so far to the question."}, {"owner": {"reputation": 5, "user_id": 7381005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l3LKZ.png?s=128&g=1", "display_name": "endgame", "link": "https://stackoverflow.com/users/7381005/endgame"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495623600, "post_id": 44156251, "comment_id": 75329206, "body": "Sorry, I haven&#39;t written any code for this specific problem because I really don&#39;t know exactly how to address it. Couldn&#39;t find any questions similar enough either to get any ideas"}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1495625755, "last_edit_date": 1495625755, "creation_date": 1495625432, "answer_id": 44157112, "question_id": 44156251, "link": "https://stackoverflow.com/questions/44156251/vba-counting-the-number-of-columns-within-a-range-until-encountering-a-specifie/44157112#44157112", "title": "VBA: counting the number of columns within a range until encountering a specified value", "body": "<p>Anything is possible with VBA. This Counts the Cells in Row 2, starting in Col B to the right until \"Grand Total\" is  reached. It returns the Number of Month as you wished.</p>\n\n<pre><code>Function CountMonth() As Integer\nDim LastCol As Long\nDim sht As Worksheet\nDim Counter As Integer\n\nSet sht = Worksheets(\"Sheet1\")\nLastCol = sht.Cells(3, Columns.Count).End(xlToLeft).Column\n\nFor i = 2 To LastCol\n    If sht.Cells(3, i).Value &lt;&gt; \"Grand Total\" Then\n        Counter = Counter + 1\n    Else \n        Exit For\n    End If\nNext i\nCountMonth = Counter\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7381005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l3LKZ.png?s=128&g=1", "display_name": "endgame", "link": "https://stackoverflow.com/users/7381005/endgame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6431, "favorite_count": 0, "accepted_answer_id": 44157112, "answer_count": 1, "score": 0, "last_activity_date": 1495625755, "creation_date": 1495623125, "question_id": 44156251, "link": "https://stackoverflow.com/questions/44156251/vba-counting-the-number-of-columns-within-a-range-until-encountering-a-specifie", "title": "VBA: counting the number of columns within a range until encountering a specified value", "body": "<p>What I'd like to achieve through VBA is to count the number of columns within a certain range, but in such a manner that the counting would stop once a specified cell value is encountered. Further, I want to assign the value to a variable that I'll use later on for calculations in a sub I've written.</p>\n\n<p>I have a pivot table that varies in width depending on how many months I choose to include. Please take a look at the picture in case my explanations are unclear :) (Can't embed images as my reputation is insufficient, but there's a link below) Ultimately, I want to count the number of months and store it as the value of a variable I call <em>numberofmonths</em>. I'm not very experienced with VBA and if there is a better way to do this, please let me know. </p>\n\n<p>I figured that one way to do this would be to define a range starting from (3,3), as this starting point is fixed, and ending at say (3,20) as I won't use more than 12 months at most, and then count the number of non-empty cells until the cell containing the text \"Grand Total\" is encountered. By the way, there is data in the cells next to the \"Grand Total\" column, and the values 17/01, 17/02,... are also found there, which is why I thought it would be better to stop once \"Grand Total\" is reached instead of using some sort of countif-approach. Is this possible at all? Any help will be greatly appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/pzBpb.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/pzBpb.png</a></p>\n"}, {"tags": ["r", "excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1495621021, "post_id": 44155405, "comment_id": 75327446, "body": "To read a text file into Excel you can use something like this: <a href=\"https://stackoverflow.com/questions/31140659/vba-excel-macro-to-update-list-via-external-file/31141373#31141373\" title=\"vba excel macro to update list via external file\">stackoverflow.com/questions/31140659/&hellip;</a> Afterwards, you can <code>split()</code> your data / rows on <code>**</code> as the delimiter. That should cover it. Or is there more to it and I am missing something?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1495621783, "post_id": 44155405, "comment_id": 75327984, "body": "So you have <code>AbcCdfEfg</code> and you need <code>Array(&quot;Abc&quot;,&quot;Cdf&quot;,&quot;Efg&quot;)</code>?"}, {"owner": {"reputation": 72, "user_id": 8058525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f5f5e6bd1282c55e882b63a5f4ea68?s=128&d=identicon&r=PG&f=1", "display_name": "MrC", "link": "https://stackoverflow.com/users/8058525/mrc"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495621862, "post_id": 44155405, "comment_id": 75328037, "body": "@Ralph : Can you give more detail on the split() part please?is this some function within VBA?"}, {"owner": {"reputation": 72, "user_id": 8058525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f5f5e6bd1282c55e882b63a5f4ea68?s=128&d=identicon&r=PG&f=1", "display_name": "MrC", "link": "https://stackoverflow.com/users/8058525/mrc"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1495622060, "post_id": 44155405, "comment_id": 75328198, "body": "@Vityata : yes.reading in array will solve. Just that the delimiter here is &quot;**&quot;"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495622267, "post_id": 44155405, "comment_id": 75328356, "body": "yes, <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Split()</a> is a built-in function which will return an array and split the given input string on the delimiter you determine. So <code>split(&quot;some**text****for**testing&quot;, &quot;**&quot;)</code> will return a (0-based) array of <code>&quot;some&quot;, &quot;text&quot;, &quot;&quot;, &quot;for&quot;, &quot;testing&quot;</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1495622477, "post_id": 44155405, "comment_id": 75328508, "body": "@MrC - can you give two examples of input string and desired output?"}, {"owner": {"reputation": 72, "user_id": 8058525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f5f5e6bd1282c55e882b63a5f4ea68?s=128&d=identicon&r=PG&f=1", "display_name": "MrC", "link": "https://stackoverflow.com/users/8058525/mrc"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1495632934, "post_id": 44155405, "comment_id": 75336303, "body": "@Ralph : tried and got perfect result thanks a lot."}], "owner": {"reputation": 72, "user_id": 8058525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f5f5e6bd1282c55e882b63a5f4ea68?s=128&d=identicon&r=PG&f=1", "display_name": "MrC", "link": "https://stackoverflow.com/users/8058525/mrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495620776, "creation_date": 1495620776, "question_id": 44155405, "link": "https://stackoverflow.com/questions/44155405/read-continuous-text-file-with-specific-delimiter-for-new-line", "title": "Read continuous text file with specific delimiter for new line", "body": "<p>I have text file like below\nAbc<strong>Cdf</strong>Efg\nHere \"**\" is the delimiter for new line\nI want to read it in a data frame in R or excel table using VBA\nThe result should have 3 records.\nAny idea?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1495619885, "creation_date": 1495619885, "answer_id": 44155061, "question_id": 44155006, "link": "https://stackoverflow.com/questions/44155006/vlookup-with-a-named-range/44155061#44155061", "title": "Vlookup with a named range", "body": "<p>You need to try it like this...</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-1],\" &amp; unit_index &amp; \"!alpha_lookup,2,FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5837662, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2bb59a2b7e91df23012ed35102a3bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "Log On", "link": "https://stackoverflow.com/users/5837662/log-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495620170, "creation_date": 1495619756, "last_edit_date": 1495620170, "question_id": 44155006, "link": "https://stackoverflow.com/questions/44155006/vlookup-with-a-named-range", "title": "Vlookup with a named range", "body": "<p>I have a variable which takes the name of a workbook. I will be working through a list of these workbooks. For example,</p>\n\n<pre><code>dim unit_index as variant\n\nunit_index = \"unit_20444b_201608.xls\"\n</code></pre>\n\n<p>I want to use a <code>vlookup</code> to return a value from the workbook assigned to <code>unit_index</code>. So when I enter the <code>vlookup</code> formula manually and record the macro I get the code below:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=VLOOKUP(RC[-1],unit_20444b_201608.xls!alpha_lookup,2,FALSE)\"\n</code></pre>\n\n<p>I want the workbook name to change dynamically so I want the code to look something like this:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=VLOOKUP(RC[-1],**unit_index**!alpha_lookup,2,FALSE)\"\n</code></pre>\n\n<p><code>alpha_lookup</code> is the named range in <code>unit_index</code>.</p>\n\n<p>So the workbook name would change as <code>unit_index</code> is updated. How can I make this work?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "edited": false, "score": 0, "creation_date": 1576897473, "post_id": 44539820, "comment_id": 105051986, "body": "First of all, set &quot;.Visible = True &quot; , or  you won&#39;t get the shadow you want."}], "tags": [], "owner": {"reputation": 1, "user_id": 8058673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/626379b015850b730dd83756d73819e5?s=128&d=identicon&r=PG&f=1", "display_name": "MarekD", "link": "https://stackoverflow.com/users/8058673/marekd"}, "is_accepted": false, "score": 0, "last_activity_date": 1497429972, "creation_date": 1497429972, "answer_id": 44539820, "question_id": 44154953, "link": "https://stackoverflow.com/questions/44154953/vba-powerpoint-text-font-shadow-via-macro/44539820#44539820", "title": "VBA-PowerPoint text/font shadow via macro", "body": "<p>If someone will have problems with simillar case I have found the answer :)</p>\n\n<p>The shadow (ribbon like shadow) for data label text/value is done via <code>TextRange2</code> property, but I was missing <code>Format</code>. Like this :</p>\n\n<pre><code>Dim tr As TextRange2 \nSet tr = s.DataLabels(pts.Count).Format.TextFrame2.TextRange\nWith tr.Font.Shadow\n  .OffsetX = 10\n  .OffsetY = 10\n  .Size = 1\n  .Blur = 4\n  .Transparency = 0.5\n  .Visible = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8058673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/626379b015850b730dd83756d73819e5?s=128&d=identicon&r=PG&f=1", "display_name": "MarekD", "link": "https://stackoverflow.com/users/8058673/marekd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1497429972, "creation_date": 1495619668, "last_edit_date": 1495625796, "question_id": 44154953, "link": "https://stackoverflow.com/questions/44154953/vba-powerpoint-text-font-shadow-via-macro", "title": "VBA-PowerPoint text/font shadow via macro", "body": "<p>I'm trying to make text in the data label of the chart with shadow effect (that shadow effect which you have at top of the PowerPoint menu), but I'm unable to make it work, <code>dataLabels.shadow</code> or <code>dataLabels.font.shadow</code>  makes the frame shadowed, not the text. </p>\n\n<p>I was googling a lot, I have found out this could be possible via <code>TextFormat</code> or <code>TextFormat2</code> property, unfortunately I'm not able to access it for the text in the data label anyhow. My current code, lines after comment does not work:</p>\n\n<pre><code>For Each Shape In Slide.Shapes\n    If Shape.HasChart Then\n\n        Dim i As Integer\n        Dim v As Variant\n\n        Set pts = Shape.Chart.SeriesCollection(1).Points\n\n        For Each s In Shape.Chart.SeriesCollection\n            v = s.Values\n            If s.Name &lt;&gt; \"XXX_XXX\" Then\n                If v(pts.Count) &gt;= 0.05 Then\n                    s.Select\n                    s.Points(pts.Count).Select\n                    s.Points(pts.Count).ApplyDataLabels\n                    s.DataLabels.Font.Color = s.Border.Color\n                    s.DataLabels.Font.Size = 20\n                    s.DataLabels.Font.Name = \"Calibri\"\n                    's.DataLabels.Shadow = True \n                    's.DataLabels.Font.Shadow = msoTrue \n                    's.Points(pts.Count).DataLabel.Font.Shadow = msoTrue\n                    's.Points(pts.Count).DataLabel(pts.Count).TextFrame.TextRange.Font.Shadow = msoTrue                                                   \n                End If\n            End If\n        Next s\n    End If\nNext Shape\n</code></pre>\n"}, {"tags": ["vba", "excel", "do-while", "type-mismatch"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1495619605, "post_id": 44154865, "comment_id": 75326463, "body": "Perhaps you have an error value in one of the cells."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1495620128, "post_id": 44154865, "comment_id": 75326846, "body": "Have you tried Do While Not IsEmpty(ActiveCell.Offset(0, -nr_kol + 1))"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1495620498, "post_id": 44154865, "comment_id": 75327104, "body": "Side Note: (1) You should <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate\">avoid using Select and Activate</a>. (2) Always use <code>Long</code> instead of <code>Integer</code> (read <a href=\"http://stackoverflow.com/a/26409520/3219613\">here</a> why)."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1495620552, "post_id": 44155293, "comment_id": 75327144, "body": "<code>nr_kol + 1 *-1</code> is the same as <code>nr_kol -1</code> isn&#39;t it?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495620625, "post_id": 44155293, "comment_id": 75327195, "body": "@Peh - I am still sleepy."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495631269, "post_id": 44155293, "comment_id": 75334910, "body": "Still won&#39;t work. Selected cell is A1 (from 2 lines above in his code) and you try to move in negative direction. Can&#39;t work (see my answer)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495631556, "post_id": 44155293, "comment_id": 75335159, "body": "@Peh - he was probably meaning that the active cell is the last cell in the selection... I guess..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495632982, "post_id": 44155293, "comment_id": 75336338, "body": "yes, hard to tell without any information of the OP. Or he thinks the ActiveCell of the beginning before any macro ran is still selected. Nevertheless the code needs some improvement."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1495631522, "last_edit_date": 1495631522, "creation_date": 1495620478, "answer_id": 44155293, "question_id": 44154865, "link": "https://stackoverflow.com/questions/44154865/vba-type-mismatch-on-do-while-not/44155293#44155293", "title": "VBA type mismatch on DO WHILE NOT", "body": "<p>What is <code>-nr_kol</code> in\n<code>Do While Not ActiveCell.Offset(0, -nr_kol + 1) = \"\"</code></p>\n\n<p>Probably you want to write\n<code>Do While Not ActiveCell.Offset(0, (nr_kol + 1) *-1) = \"\"</code></p>\n\n<p>In general, probably you may try something like this:</p>\n\n<pre><code>Dim nr_kol As long\nnr_kol = ActiveCell.Column\nWorksheets(\"dane\").Range(\"I1\").Copy\nWorksheets(\"dystr hist\").Range(\"a1\").Select\n    ActiveCell.End(xlToRight).Offset(0, 1).PasteSpecial xlPasteValues\nActiveCell.End(xlToRight).select\nDo While Not ActiveCell.Offset(0, -nr_kol + 1) = \"\"\nSelection.Offset(1, 0).Select\n    ActiveCell.Value = Application.VLookup(ActiveCell.Offset(0, -nr_kol + 1).Text, Worksheets(\"temp2\").Range(\"B:I\"), 8, False)\nLoop\n</code></pre>\n\n<p>The difference is in the change of the <code>ActiveCell</code> with the following code:\n    <code>ActiveCell.End(xlToRight).select</code></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1506007005, "last_edit_date": 1506007005, "creation_date": 1495631109, "answer_id": 44159269, "question_id": 44154865, "link": "https://stackoverflow.com/questions/44154865/vba-type-mismatch-on-do-while-not/44159269#44159269", "title": "VBA type mismatch on DO WHILE NOT", "body": "<p>This is the explanation why that you asked for:</p>\n\n<p>The issue is you select range A1 with </p>\n\n<pre><code>Worksheets(\"dystr hist\").Range(\"a1\").Select \n'here you do some copy which doesn't change cell selection of A1\n</code></pre>\n\n<p>and next you try to move a probably negative column value in</p>\n\n<pre><code>ActiveCell.Offset(0, -nr_kol + 1) \n</code></pre>\n\n<p>where <code>-nr_kol + 1</code> is negative for <code>nr_kol &gt; 1</code>. This doesn't work because A1 is the most top most left cell in the sheet and you just can't move left.</p>\n\n<hr>\n\n<p>Solution:</p>\n\n<ul>\n<li>Avoid using <code>ActiveCell</code></li>\n<li>Avoid using <code>Select</code></li>\n<li>Fully qualify your Cells/Ranges with worksheets</li>\n<li><a href=\"http://stackoverflow.com/a/26409520/3219613\">Use <code>Long</code> instead of <code>Integer</code></a></li>\n</ul>\n"}], "owner": {"reputation": 15, "user_id": 7613561, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801769686515423/picture?type=large", "display_name": "FatBatman", "link": "https://stackoverflow.com/users/7613561/fatbatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 44159269, "answer_count": 2, "score": 0, "last_activity_date": 1506007005, "creation_date": 1495619447, "question_id": 44154865, "link": "https://stackoverflow.com/questions/44154865/vba-type-mismatch-on-do-while-not", "title": "VBA type mismatch on DO WHILE NOT", "body": "<p>I've got o problem with my macro:</p>\n\n<pre><code>Dim nr_kol As Integer\nnr_kol = ActiveCell.Column\nWorksheets(\"dane\").Range(\"I1\").Copy\nWorksheets(\"dystr hist\").Range(\"a1\").Select\n    ActiveCell.End(xlToRight).Offset(0, 1).PasteSpecial xlPasteValues\n\nDo While Not ActiveCell.Offset(0, -nr_kol + 1) = \"\"\nSelection.Offset(1, 0).Select\n    ActiveCell.Value = Application.VLookup(ActiveCell.Offset(0, -nr_kol + 1).Text, Worksheets(\"temp2\").Range(\"B:I\"), 8, False)\nLoop\n</code></pre>\n\n<p>It should work like this: it takes week number from \"dane\" sheet and paste it in \"dystr hist\" sheet in first free cell in first row. Then we have vlookup for items, until the list is finished.\nIt worked for previous sheet, but in this particular place it crashes with type mismatch. Can anyone explain me why?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1495619215, "post_id": 44154423, "comment_id": 75326136, "body": "Which line throws the error? Are you dealing with VB or VBA? Is Activecell set? Have you checked the content of it? Have you tried to use a constant as Webpage to narrow down your problem?"}, {"owner": {"reputation": 1, "user_id": 7605905, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457439330967439/picture?type=large", "display_name": "Vinod Patil", "link": "https://stackoverflow.com/users/7605905/vinod-patil"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1495621557, "post_id": 44154423, "comment_id": 75327811, "body": "This Line - IE.Document.Forms(0).all(&quot;User Name&quot;).Value = &quot;UserID&quot; is throwing error."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1495624696, "post_id": 44154423, "comment_id": 75329916, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25524265/logging-in-a-website-via-vba\">Logging in a website via vba</a>"}], "owner": {"reputation": 1, "user_id": 7605905, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457439330967439/picture?type=large", "display_name": "Vinod Patil", "link": "https://stackoverflow.com/users/7605905/vinod-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495618475, "creation_date": 1495618223, "last_edit_date": 1531164843, "question_id": 44154423, "link": "https://stackoverflow.com/questions/44154423/error-424-in-vb", "title": "Error 424 In VB", "body": "<p>I am trying to create the Automation using VB to log in to website by using the User ID &amp; Password, but its giving me error 424 Object required as shown below the VB Code</p>\n\n<pre><code>Sub Test()\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    IE.Visible = True\n    IE.Navigate (\"https://appsglobal.nike.com/Citrix/AppsGlobal/auth/login.aspx\" &amp; ActiveCell)\n    Do\n        If IE.ReadyState = 4 Then\n            IE.Visible = False\n            Exit Do\n        Else\n            DoEvents\n        End If\n    Loop\n    IE.Document.Forms(0).all(\"User Name\").Value = \"UserID\"\n    IE.Document.Forms(0).all(\"Password\").Value = \"Password\"\n    IE.Document.Forms(0).submit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste", "paste"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1495618908, "post_id": 44154327, "comment_id": 75325921, "body": "if you want to copy also the Cell&#39;s Background color, then you need to use the <b>2-Lines</b> syntax you are currently using"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1495620470, "post_id": 44154327, "comment_id": 75327088, "body": "So there is no other way to pretend using second line. Something seems easy, but not possible  at the same time in this application:)"}, {"owner": {"reputation": 151, "user_id": 13574635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54a4803686d1544b75cf72aca942bbd?s=128&d=identicon&r=PG&f=1", "display_name": "pelelter", "link": "https://stackoverflow.com/users/13574635/pelelter"}, "edited": false, "score": 0, "creation_date": 1607969347, "post_id": 44154327, "comment_id": 115433146, "body": "You can create your own function to do that. This way, you won&#39;t need to write two lines of code every time (if that&#39;s the problem)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1611102419, "post_id": 44154327, "comment_id": 116341468, "body": "To answer your question, No there is no way to paste values and formats all in one command, the closest you can get is values and number formats but not cell formats. Can I ask why it&#39;s such an issue to do values then formats? Also why are you against using a with statement? It&#39;s clean and efficient. If you are that against with I supposed you could set up a range variable called <code>PasteRange</code> and use <code>PasteRange.PasteSpecial xlPasteValue: PasteRange.PasteSpecial xlPasteFormats</code> but it would be very inefficient."}], "answers": [{"comments": [{"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495618280, "post_id": 44154371, "comment_id": 75325429, "body": "<code>xlPasteFormats</code> is doing exactly same thing with <b>Format Painter</b> is this <code>NumberFormats</code> does the same?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495630366, "post_id": 44154371, "comment_id": 75334196, "body": "Erm, I guess I misread the question. The answer really is that you cannot combine those two, you have to do two paste specials."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1566397024, "post_id": 44154371, "comment_id": 101644937, "body": "If this is not the correct answer, you should simply delete it rather than editing to say it&#39;s not correct."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": -1, "last_activity_date": 1495630406, "last_edit_date": 1495630406, "creation_date": 1495618109, "answer_id": 44154371, "question_id": 44154327, "link": "https://stackoverflow.com/questions/44154327/xlpastevalues-and-xlpasteformats-at-the-same-time/44154371#44154371", "title": "xlPasteValues and xlPasteFormats at the same time", "body": "<p>You are looking for:</p>\n\n<pre><code>xlPasteValuesAndNumberFormats\n</code></pre>\n\n<h2>edit## This is not the correct answer.</h2>\n"}, {"comments": [{"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1517532037, "post_id": 48574004, "comment_id": 84144838, "body": "Thanks for your answer, however xlPasteAll pastes formulas not values."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1517534824, "post_id": 48574004, "comment_id": 84145474, "body": "@Mertinc No, it pastes everything.  The documentation explains what each constant means: <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlpastetype.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1517534902, "post_id": 48574004, "comment_id": 84145497, "body": "Oh, yes but I don&#39;t want formulas to be pasted , when you paste everything it pastes the formulas as well. I simply want to only paste it&#39;s values."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1517535000, "post_id": 48574004, "comment_id": 84145516, "body": "@Mertinc Oh ok, I didn&#39;t understand realize that."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1517535064, "post_id": 48574004, "comment_id": 84145529, "body": "No worries at all mate. Thanks for your effort anyway. I think it&#39;s not possible to combine paste values with format at the same time."}], "tags": [], "owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "is_accepted": false, "score": -1, "last_activity_date": 1517531673, "creation_date": 1517531673, "answer_id": 48574004, "question_id": 44154327, "link": "https://stackoverflow.com/questions/44154327/xlpastevalues-and-xlpasteformats-at-the-same-time/48574004#48574004", "title": "xlPasteValues and xlPasteFormats at the same time", "body": "<p><code>xlPasteAll</code>  </p>\n\n<p>(Actually, since <code>xlPasteAll</code> is the default paste option, you can just leave it off.)</p>\n\n<p>Source: <a href=\"https://msdn.microsoft.com/en-us/library/aa195818(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa195818(v=office.11).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4375438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe1fedec8f655313abd9e4e8e16cb17?s=128&d=identicon&r=PG&f=1", "display_name": "user4375438", "link": "https://stackoverflow.com/users/4375438/user4375438"}, "is_accepted": false, "score": -2, "last_activity_date": 1566396776, "creation_date": 1566396776, "answer_id": 57593665, "question_id": 44154327, "link": "https://stackoverflow.com/questions/44154327/xlpastevalues-and-xlpasteformats-at-the-same-time/57593665#57593665", "title": "xlPasteValues and xlPasteFormats at the same time", "body": "<p>You can paste the content several times to get what you need, like </p>\n\n<pre><code>Cells(1, 1).PasteSpecial Paste:=xlPasteAll\nCells(1, 1).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14346158, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8905df5a72481d1245d98ad73aa546d1?s=128&d=identicon&r=PG", "display_name": "Leonardo Rogich", "link": "https://stackoverflow.com/users/14346158/leonardo-rogich"}, "is_accepted": false, "score": 0, "last_activity_date": 1601226191, "last_edit_date": 1601226191, "creation_date": 1601138774, "answer_id": 64080221, "question_id": 44154327, "link": "https://stackoverflow.com/questions/44154327/xlpastevalues-and-xlpasteformats-at-the-same-time/64080221#64080221", "title": "xlPasteValues and xlPasteFormats at the same time", "body": "<p>You can use it this way:</p>\n<pre><code>NewSheet.Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nNewSheet.Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n<p>Place the two commands one after each other. First, you have to paste all, then you paste again, but only values and number formats.</p>\n"}], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 10387, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1613725575, "creation_date": 1495617969, "last_edit_date": 1611101231, "question_id": 44154327, "link": "https://stackoverflow.com/questions/44154327/xlpastevalues-and-xlpasteformats-at-the-same-time", "title": "xlPasteValues and xlPasteFormats at the same time", "body": "<p>I am copying a range and then pasting it's values and formats to another range:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>ws5.Range(&quot;F3:N&quot; &amp; xCell).SpecialCells(xlCellTypeVisible).Copy\n    \nws16.Cells(Rows.Count, &quot;B&quot;).End(xlUp).Offset(4, 0).PasteSpecial xlPasteValues\nws16.Cells(Rows.Count, &quot;B&quot;).End(xlUp).Offset(4, 0).PasteSpecial xlPasteFormats\n</code></pre>\n<p>Is it possible to do these two paste actions in one action without using <code>With</code>?</p>\n<p>I would like to increase the speed of my macro and that kind of small reduction might help me.</p>\n<p>Is there something like <code>.PasteSpecial xlPasteValues and xlPasteFormats</code>?</p>\n<p>I found <a href=\"https://www.mrexcel.com/forum/excel-questions/167518-pastespecial-values-formats-same-time.html\" rel=\"nofollow noreferrer\">link</a> but even this answer is using <code>With</code>, which is useless for me.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495618160, "post_id": 44154167, "comment_id": 75325357, "body": "You could add the frame (do you mean the <code>Option Group</code> frame?), remove the label from the frame and add a text box and format it to look like the label - now you can add a Control Source to the text box so it displays the creation date."}, {"owner": {"reputation": 2934, "user_id": 884319, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3MUIl.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/884319/tim"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495618919, "post_id": 44154167, "comment_id": 75325928, "body": "Yes I mean the Option Group Frame. Your solution seems more like a workaround - there must be a way to set the caption dynamically (at least I&#39;d like to think that). Positioning a bound Textbox over the empty caption sounds &quot;dirty&quot; :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1495619314, "post_id": 44154167, "comment_id": 75326222, "body": "Yep, a workaround but it works as @Andre said.  I guess you could do something with code and the <code>On Current</code> event but why bother figuring it all out, writing a bunch of code when a text box will do the job for you?"}, {"owner": {"reputation": 2934, "user_id": 884319, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3MUIl.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/884319/tim"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495619347, "post_id": 44154167, "comment_id": 75326253, "body": "You are right. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 2934, "user_id": 884319, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3MUIl.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/884319/tim"}, "edited": false, "score": 0, "creation_date": 1496060110, "post_id": 44154725, "comment_id": 75493538, "body": "I am having this problem again, with buttons this time. By any chance, do you have an idea for a workaround ? I have a button that changes a value in the current record, and then the button should be disabled. If I disable it in the code, it is disabled for all entries of the continuous form."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1495619082, "creation_date": 1495619082, "answer_id": 44154725, "question_id": 44154167, "link": "https://stackoverflow.com/questions/44154167/set-the-caption-of-a-frame-in-a-continuous-form/44154725#44154725", "title": "Set the caption of a frame in a continuous form", "body": "<p>Set the Record Source of your form to whichever table/query you're using.</p>\n\n<p>Add the Option Group frame to the form and delete the label.\nPlace a text box where the deleted label was and format as needed.</p>\n\n<p>Give the text box a Control Source pointing to your date field and it should just work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4t5rG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4t5rG.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/szZKr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/szZKr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1495619141, "creation_date": 1495619141, "answer_id": 44154746, "question_id": 44154167, "link": "https://stackoverflow.com/questions/44154167/set-the-caption-of-a-frame-in-a-continuous-form/44154746#44154746", "title": "Set the caption of a frame in a continuous form", "body": "<p>You can't do this directly. </p>\n\n<p>Unbound controls like the frame caption by definition have the same value for all records in a continuous form.</p>\n\n<p>The only way is to use a bound control (textbox) as workaround, as shown by Darren.</p>\n"}], "owner": {"reputation": 2934, "user_id": 884319, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3MUIl.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/884319/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 44154725, "answer_count": 2, "score": 1, "last_activity_date": 1495619197, "creation_date": 1495617597, "last_edit_date": 1495619197, "question_id": 44154167, "link": "https://stackoverflow.com/questions/44154167/set-the-caption-of-a-frame-in-a-continuous-form", "title": "Set the caption of a frame in a continuous form", "body": "<p>I would like to set the caption of a frame <strong>dynamically</strong> inside a continuous form. </p>\n\n<p>So far I am doing the following:</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.myFrame.Caption = Me.created_date \nEnd Sub\n</code></pre>\n\n<p><strong>This only sets the value of the first record for all Frames.</strong> I want the frame to have the \"creation_date\" of each entry of my table.</p>\n\n<p>What do I have to do to make the caption dynamic ? The Frame control does not have a \"Data\" binding like textfields, so I think that I have to set it programmatically.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1495617517, "post_id": 44154014, "comment_id": 75324871, "body": "<code>frmLogin.lblMsg.caption</code> and <code>frmLogin.repaint</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1495617703, "post_id": 44154014, "comment_id": 75325018, "body": "Actually you can do it only with <code>frmLogin.Repaint</code>, the <code>frmLogin.lblMsg.caption</code> is not needed."}, {"owner": {"reputation": 193, "user_id": 6536408, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RSmYc.png?s=128&g=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6536408/kai"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495617800, "post_id": 44154014, "comment_id": 75325098, "body": "@Nathan_Sav Thanks, it works."}, {"owner": {"reputation": 193, "user_id": 6536408, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RSmYc.png?s=128&g=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6536408/kai"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1495617818, "post_id": 44154014, "comment_id": 75325116, "body": "@Vityata Exactly, thank you bro"}], "owner": {"reputation": 193, "user_id": 6536408, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/RSmYc.png?s=128&g=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6536408/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495629371, "creation_date": 1495617210, "last_edit_date": 1531164843, "question_id": 44154014, "link": "https://stackoverflow.com/questions/44154014/how-to-change-the-label-in-form-immediately-using-vba", "title": "How to change the label in form immediately using vba", "body": "<pre><code>Public Sub login()\n    frmLogin.lblMsg = \"Logging in...\"\n    MsgBox \"Login successfully\"\nEnd Sub\n</code></pre>\n\n<p>When I call this Sub, I want to change the label to \"Logging in...\" during process, but it does not work. The label just change when the Sub was complete (after message box show the message). Is the form runs on one thread? Is any way to solve this?</p>\n"}, {"tags": ["php", ".net", "excel", "windows", "vba"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1495623122, "post_id": 44153838, "comment_id": 75328899, "body": "please check this link <a href=\"http://www.cpearson.com/excel/AppEvent.aspx\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 476, "user_id": 7770552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jkfR43BnIRQ/AAAAAAAAAAI/AAAAAAAAAOI/2BZCqFnlJtk/photo.jpg?sz=128", "display_name": "Mihail Kuznesov", "link": "https://stackoverflow.com/users/7770552/mihail-kuznesov"}, "edited": false, "score": 0, "creation_date": 1495644142, "post_id": 44153838, "comment_id": 75344874, "body": "It is possible by using File System Filter Driver. You can read about it here: <a href=\"https://www.codeproject.com/Articles/43586/File-System-Filter-Driver-Tutorial\" rel=\"nofollow noreferrer\">codeproject.com/Articles/43586/&hellip;</a> If you don&#39;t have knowledge of C/C++ and Windows Internals, it will be very hard way"}, {"owner": {"reputation": 476, "user_id": 7770552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jkfR43BnIRQ/AAAAAAAAAAI/AAAAAAAAAOI/2BZCqFnlJtk/photo.jpg?sz=128", "display_name": "Mihail Kuznesov", "link": "https://stackoverflow.com/users/7770552/mihail-kuznesov"}, "edited": false, "score": 0, "creation_date": 1495644147, "post_id": 44153838, "comment_id": 75344877, "body": "Or, second way, you can start windows file audit for your directory, create trigger in Task Scheduler for this events and execute program in case of access to files in your directory. This software can analyze windows log, and show notification. But just for opening files, not closing."}, {"owner": {"reputation": 690, "user_id": 6390490, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20935ff908f3fb4b47975f38d51cb633?s=128&d=identicon&r=PG&f=1", "display_name": "smarttechy", "link": "https://stackoverflow.com/users/6390490/smarttechy"}, "edited": false, "score": 0, "creation_date": 1495773051, "post_id": 44153838, "comment_id": 75400779, "body": "I was thinking to create an excel addin <a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/excel-add-in-create.htm</a>"}], "owner": {"reputation": 690, "user_id": 6390490, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20935ff908f3fb4b47975f38d51cb633?s=128&d=identicon&r=PG&f=1", "display_name": "smarttechy", "link": "https://stackoverflow.com/users/6390490/smarttechy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495773317, "creation_date": 1495616829, "last_edit_date": 1495773317, "question_id": 44153838, "link": "https://stackoverflow.com/questions/44153838/how-to-display-a-notification-whenever-excel-or-word-is-opened-in-my-computer", "title": "How to display a notification whenever excel or word is opened in my computer", "body": "<p>I want to know if it is possible to display a message/ notification in my computer whenever I open excel or word file within sub directory of a specific directories. \nLike </p>\n\n<pre><code>Main_directory/sub1/abc.xlxs\nMain_directory/sub2/abcd.xlxs\nMain_directory/sub3/abcdd.docx\n</code></pre>\n\n<p>If any of this file is opened or closed then display a notification / message. </p>\n\n<p>Currently I know using PHP and I think something like this will be made in .net/ vba . \nCan somebody please suggest how it can be done , if it is possible. \nCurrently using windows platform. </p>\n\n<p>Edit: I found this <a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/excel-add-in-create.htm</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 4, "creation_date": 1495616869, "post_id": 44153669, "comment_id": 75324401, "body": "The tab colour can be found in the worsheet tab property; eg. <code>Sheet1.Tab.ColorIndex</code> returns the index of the Color on the <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow noreferrer\">color palette</a>. You&#39;ll have to think carefully about which event you use to trigger the box to change colour though - perhaps post the code you&#39;ve written so far to get more directed advice"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 8058439, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AvAVu8VL_ac/AAAAAAAAAAI/AAAAAAAAAGs/NDI-Mjeh9eg/photo.jpg?sz=128", "display_name": "Ghassen Ben Lazhar", "link": "https://stackoverflow.com/users/8058439/ghassen-ben-lazhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1495634255, "creation_date": 1495634255, "answer_id": 44160571, "question_id": 44153669, "link": "https://stackoverflow.com/questions/44153669/how-to-read-the-color-of-excel-tab-in-order-to-use-it-to-color-a-cell-or-a-box/44160571#44160571", "title": "How to read the color of excel tab in order to use it to color a cell or a box ?", "body": "<p>Thank you guys for the helpful answers , the following line did what I wanted : </p>\n\n<p><code>ActiveSheet.Shapes.Range(Array(\"Check Box \" &amp; j)).Fill.ForeColor.RGB = Worksheets(thename).Tab.color</code></p>\n\n<p>with j an index , and thename as a variable reading the Name of the tab at every Iteration .. </p>\n\n<p>Cheers , </p>\n"}], "owner": {"reputation": 19, "user_id": 8058439, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AvAVu8VL_ac/AAAAAAAAAAI/AAAAAAAAAGs/NDI-Mjeh9eg/photo.jpg?sz=128", "display_name": "Ghassen Ben Lazhar", "link": "https://stackoverflow.com/users/8058439/ghassen-ben-lazhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1495634255, "creation_date": 1495616370, "last_edit_date": 1531161705, "question_id": 44153669, "link": "https://stackoverflow.com/questions/44153669/how-to-read-the-color-of-excel-tab-in-order-to-use-it-to-color-a-cell-or-a-box", "title": "How to read the color of excel tab in order to use it to color a cell or a box ?", "body": "<p>I want to use color a box with the exact color of the tab , so whenever I Change the color of the tab the color of the can be changed accordingly, any ideas how to get the rgb code of the tab color for example ? </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7331, "user_id": 947083, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9cf154f828528bd15ad0bf22e93abcf6?s=128&d=identicon&r=PG&f=1", "display_name": "Totumus Maximus", "link": "https://stackoverflow.com/users/947083/totumus-maximus"}, "edited": false, "score": 0, "creation_date": 1495617679, "post_id": 44153447, "comment_id": 75324995, "body": "What is wrong with doing it in 2 actions rather then a single action?"}, {"owner": {"reputation": 255, "user_id": 5361974, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9c19d2decdf55c758f72ac07064d49bb?s=128&d=identicon&r=PG&f=1", "display_name": "\u912d\u6709\u7dad", "link": "https://stackoverflow.com/users/5361974/%e9%84%ad%e6%9c%89%e7%b6%ad"}, "reply_to_user": {"reputation": 7331, "user_id": 947083, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9cf154f828528bd15ad0bf22e93abcf6?s=128&d=identicon&r=PG&f=1", "display_name": "Totumus Maximus", "link": "https://stackoverflow.com/users/947083/totumus-maximus"}, "edited": false, "score": 0, "creation_date": 1495635985, "post_id": 44153447, "comment_id": 75338840, "body": "I want to do the action like picture and i don&#39;t limit it just one action or two actions."}], "owner": {"reputation": 255, "user_id": 5361974, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9c19d2decdf55c758f72ac07064d49bb?s=128&d=identicon&r=PG&f=1", "display_name": "\u912d\u6709\u7dad", "link": "https://stackoverflow.com/users/5361974/%e9%84%ad%e6%9c%89%e7%b6%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593764691, "creation_date": 1495615804, "last_edit_date": 1593764691, "question_id": 44153447, "link": "https://stackoverflow.com/questions/44153447/how-can-i-select-two-different-string-in-the-word", "title": "How can I select two different string in the word?", "body": "<p>I have to use word vba to select the different range word.</p>\n\n<p>like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HQhhW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HQhhW.png\" alt=\"enter image description here\"></a></p>\n\n<p>I try to use the api: range(start,end).select</p>\n\n<p>but it's only select one range.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495615972, "post_id": 44153390, "comment_id": 75323810, "body": "Add the lines that broke your code"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1495616179, "post_id": 44153390, "comment_id": 75323955, "body": "Are you sure <code>IE.DOCUMENT.Body.GETElementsByTagName(&quot;div&quot;)</code> returns something?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1495616831, "post_id": 44153390, "comment_id": 75324380, "body": "and IE is something as IE.Document..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495617216, "post_id": 44153390, "comment_id": 75324666, "body": "Try debugging it by adding multiple lines <code>Set Levels = IE</code>, then <code>Set Levels = IE.DOCUMENT</code>, then <code>Set Levels = IE.DOCUMENT.Body</code> - and see which line fails - that will tell you which one isn&#39;t an object but is actually <code>Nothing</code>.  (e.g. if <code>Set Levels = IE.DOCUMENT</code> works, but <code>Set Levels = IE.DOCUMENT.Body</code> fails then you know that <code>IE.DOCUMENT</code> was probably <code>Nothing</code>)"}, {"owner": {"reputation": 1, "user_id": 8058224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309a96297ddbe2a0591188ce1b9c688e?s=128&d=identicon&r=PG&f=1", "display_name": "Sett", "link": "https://stackoverflow.com/users/8058224/sett"}, "edited": false, "score": 0, "creation_date": 1495735103, "post_id": 44153390, "comment_id": 75387588, "body": "Thanks. the &quot;IE&quot; was in fact what was causing the problem. Thanks much"}], "owner": {"reputation": 1, "user_id": 8058224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309a96297ddbe2a0591188ce1b9c688e?s=128&d=identicon&r=PG&f=1", "display_name": "Sett", "link": "https://stackoverflow.com/users/8058224/sett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495628675, "creation_date": 1495615628, "last_edit_date": 1495628675, "question_id": 44153390, "link": "https://stackoverflow.com/questions/44153390/run-time-error-91-displays-even-when-i-declare-the-object-and-set-the-object", "title": "Run-time error &#39;91&#39; displays even when I declare the object and set the object", "body": "<p>I don't have a clue what is happening with my <code>Excel VBA</code> code. I clearly declare <code>Levels</code> as object then set <code>Levels</code> as shown below. I Dim <code>Levels</code> after option explicit (module level) then set <code>Levels</code> within the subroutine itself. The strange thing is that the code was running perfectly fine until I added a few lines of code that had nothing to do with <code>Levels</code> at all. The code has been working for months and the code was duplicated and runs perfectly fine on another computer(without the newly added lines). But, even after setting <code>Levels</code> as an object as shown below, a Run-time <code>'91': Object variable not set</code> message is displayed. I tried using a brand new variable name but it gives me the same error, it just wont recognize that object that performs that task anymore. </p>\n\n<pre><code>Dim Levels As Object\n\nSet Levels = IE.DOCUMENT.Body.GETElementsByTagName(\"div\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "automation"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1495614824, "post_id": 44152886, "comment_id": 75323058, "body": "Do you know the exact part of your code that causes the unwanted behaviour on an empty sheet?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495615743, "post_id": 44152886, "comment_id": 75323665, "body": "If I am understanding your problem correctly (that some of the columns you are copying from a worksheet do not have the same number of rows as other columns, but you want everything to continue to line up), you need to move the calculation of <code>NextRow</code> outside your <code>For c</code> loop, and base it on a single column that you know will always be populated.  Then you should use that same value for all columns until you again calculate <code>NextRow</code> when the next workbook is being processed."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495615438, "post_id": 44153084, "comment_id": 75323463, "body": "As <code>NextRow</code> is only used inside the <code>If</code>, it won&#39;t matter if it is only calculated within the <code>If</code>."}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495615800, "post_id": 44153084, "comment_id": 75323699, "body": "@vityata - is that an empty header on one of the 17 spreadsheets? Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495616003, "post_id": 44153084, "comment_id": 75323831, "body": "@Tan3157 - yup, that&#39;s the question. :) And see the edit."}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495616471, "post_id": 44153084, "comment_id": 75324162, "body": "@vityata - It still doesn&#39;t work unfortunately with the same error. The header is on all the spreadsheets. However, if the column is blank or empty the data from the next spreadsheet moves the data into the blank cells. Not sure how to explain without attaching the docs. Let me know if that makes sense."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495617342, "post_id": 44153084, "comment_id": 75324764, "body": "@Tan3157 what exactly it moves? The whole column? E.g., put two screenshots with <code>FAKE DATA</code> to your question, titled as <code>Expected</code> and <code>Current situation</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495617385, "post_id": 44153084, "comment_id": 75324787, "body": "@Tan3157 Are you trying to ensure that all columns copied from a workbook start at the same destination row, even if some of the columns in the previous workbook were empty?"}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495618247, "post_id": 44153084, "comment_id": 75325407, "body": "@YowE3K - All the columns mentioned on the code will always be on every tracker. I have attached the image to the orginal questions. Thanks again"}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 1, "creation_date": 1495618317, "post_id": 44153084, "comment_id": 75325454, "body": "@vityata i have attached an image to the original question. I believe it is a link. Thanks for your help"}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495619585, "post_id": 44153084, "comment_id": 75326446, "body": "@vityata Thanks. As I am literally a beginner on VBA where would I add the new code or embed it to my code for it to work effectively? Thanks again for your help"}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495620720, "post_id": 44153084, "comment_id": 75327247, "body": "@Vityata - I have just given the code a go. Unfortunately it is not copying everything from each workbook across. Do you know why? Thank you"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495620759, "post_id": 44153084, "comment_id": 75327280, "body": "@Tan3157 - did you make only these 3 changes? Nothing else?"}, {"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495620963, "post_id": 44153084, "comment_id": 75327414, "body": "@vityata - i also removed the below code.  NextRow = .Cells(Rows.Count, myCol).End(xlUp).Row + 1"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1495621159, "last_edit_date": 1495621159, "creation_date": 1495614755, "answer_id": 44153084, "question_id": 44152886, "link": "https://stackoverflow.com/questions/44152886/copy-columns-from-multiple-spreadsheets-data-moving-up-when-column-empty-on-spr/44153084#44153084", "title": "Copy columns from multiple spreadsheets. Data moving up when column empty on spreadsheet", "body": "<p>Actually you want one row per sheet. Nothing else. Nothing more. You do not even need to calculate it. You need to increment it <code>lngRow = lngRow+1</code>.\nTry to use the following into your code:</p>\n\n<pre><code>Option Explicit\n\nSub CopyColumns()\n\n    Dim lngRow  As Long: lngRow = 1\n\n    Do While Len(FileName) &gt; 0\n        Set wb = Workbooks.Open(CopyFromPath &amp; FileName)\n        With wb.Sheets(\"Open Issue Actions\")\n            lngRow = lngRow + 1\n\n            With CopyToWs\n                If Not myHeader Is Nothing Then\n                    myCol = myHeader.Column\n                    .Cells(lngRow, myCol).PasteSpecial xlPasteValues\n                    Set myHeader = Nothing\n                End If\n            End With\n        End With\n        wb.Close saveChanges:=False\n    Loop\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>In the code you add/edit three things:</p>\n\n<ul>\n<li><code>The line Dim lngRow as Long: lngRow=1</code> on top with the other <code>Dim</code></li>\n<li><code>lngRow = lngRow + 1</code> after the <code>With wb.Sheets(\"Open Issue Actions\")</code></li>\n<li>the paste values should be like this <code>.Cells(lngRow, myCol).PasteSpecial xlPasteValues</code></li>\n</ul>\n\n<p>The whole code is here: <a href=\"https://pastebin.com/kXdzkGZ1\" rel=\"nofollow noreferrer\">https://pastebin.com/kXdzkGZ1</a></p>\n\n<p>The idea is to have lngRow and to increment it for every WorkSheet that you open. And do not do anything else with it.</p>\n\n<p>In general, your code can be optimized in some ways, if it works ok after the change, put it here for further ideas: <a href=\"https://codereview.stackexchange.com/\">https://codereview.stackexchange.com/</a></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495617625, "post_id": 44153583, "comment_id": 75324953, "body": "Thanks for this. If I can quickly just explain. So I have my 17 individual workbooks. I also have my master workbook. The code goes into the folder and extracts the named columns from each individual workbook. However, if one of the columns on the individual workbooks is empty, on the master workbook the data from the next individual workbook moves up into the its position. Does this makes sense and do you think the code above will work. Thank you"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495617798, "post_id": 44153583, "comment_id": 75325097, "body": "@Tan3157 If you have one column that you know is populated in every workbook, then you can easily find the last used cell in that column (in the destination worksheet) at the start of the processing of each workbook, and then copy all columns from that workbook to that row.  The question is .... do you have such a column?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495618085, "post_id": 44153583, "comment_id": 75325290, "body": "@Tan3157 - e.g. Is &quot;Issue Type&quot; always populated for every row in every workbook?  Or is &quot;Issue DocID&quot; always populated?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "edited": false, "score": 0, "creation_date": 1495618359, "post_id": 44153583, "comment_id": 75325484, "body": "@Tan3157 Judging by the image you just posted, it looks like &quot;Issue Type&quot; (column A) will always exist in every row in every workbook.  Therefore the code above will work out which is the next empty cell in column A (row 32 in your image) and paste all the columns from the next workbook into their appropriate columns starting at row 32."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1495616117, "creation_date": 1495616117, "answer_id": 44153583, "question_id": 44152886, "link": "https://stackoverflow.com/questions/44152886/copy-columns-from-multiple-spreadsheets-data-moving-up-when-column-empty-on-spr/44153583#44153583", "title": "Copy columns from multiple spreadsheets. Data moving up when column empty on spreadsheet", "body": "<p>Calculate <code>NextRow</code> only once per workbook, and then use it for all columns:</p>\n\n<pre><code>Do While Len(FileName) &gt; 0\n    'Calculate the next row to be populated for all columns, based on the last\n    'used cell in column A\n    '(I used column A, but pick whatever destination column will always be\n    'populated in every workbook.)\n    With CopyToWs\n        NextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End With\n    'Process this workbook\n    Set wb = Workbooks.Open(CopyFromPath &amp; FileName)\n    With wb.Sheets(\"Open Issue Actions\")\n        lcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        For c = 1 To lcol\n            '...\n                With CopyToWs\n                    If Not myHeader Is Nothing Then\n                        myCol = myHeader.Column\n                        'NextRow = .Cells(Rows.Count, myCol).End(xlUp).Row + 1\n                        .Cells(NextRow, myCol).PasteSpecial xlPasteValues\n                        Application.CutCopyMode = False\n                        Set myHeader = Nothing\n                    End If\n                End With\nnxt:\n                '...\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4898437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45218c39a748f5e8587666ab2c6fc21?s=128&d=identicon&r=PG&f=1", "display_name": "Tan3157", "link": "https://stackoverflow.com/users/4898437/tan3157"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 44153583, "answer_count": 2, "score": 1, "last_activity_date": 1496222183, "creation_date": 1495614170, "last_edit_date": 1496222183, "question_id": 44152886, "link": "https://stackoverflow.com/questions/44152886/copy-columns-from-multiple-spreadsheets-data-moving-up-when-column-empty-on-spr", "title": "Copy columns from multiple spreadsheets. Data moving up when column empty on spreadsheet", "body": "<p>I have the below code. The code will go into each of the 17 workbooks and extract certain columns based on the columns headers name. This will repeat and add to the bottom of the master workbook, until the last one has been extracted. \nUnfortunately, if there is nothing in one of the columns on one of the individual 17 workbooks, the data from the next workbook gets moved up in the cells. Is there anyway to sort this. I have added the code below. </p>\n\n<pre><code>Option Explicit\nSub CopyColumns()\nDim CopyFromPath As String, FileName As String\nDim CopyToWb As Workbook, wb As Workbook, CopyToWs As Worksheet\nDim lastRow As Long, NextRow As Long, lcol As Long, c As Long, sv As Integer\nDim ws As Worksheet\nDim myCol As Long\nDim myHeader As Range\nr\\\"\nSet CopyToWb = ActiveWorkbook\nSet c).End(xlUp).Row\n                    If lastRow = 1 Then GoTo nxt\n\n                    Range(Cells(2, c), Cells(lastRow, c)).Copy\n                    CopyToWs.Activate\n                    Set myHeader = CopyToWs.Rows(1).Find(What:=.Cells(1, c).Value, Lookat:=xlWhole)\n                    With CopyToWs\n                        If Not myHeader Is Nothing Then\n                            myCol = myHeader.Column\n                            NextRow = .Cells(Rows.Count, myCol).End(xlUp).Row + 1\n                            .Cells(NextRow, myCol).PasteSpecial xlPasteValues\n                            Application.CutCopyMode = False\n                            Set myHeader = Nothing\n                        End If\nnxt:\n                    End With\n                End If\n            Next c\n    wb.Close saveChanges:=False\n    End With\n    FileName = Dir\nLoop\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495614123, "post_id": 44152788, "comment_id": 75322572, "body": "you seem to have the code. Be clear on what you need. If you want the Freeform instead of scribble....change the control and execute as before"}, {"owner": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495614480, "post_id": 44152788, "comment_id": 75322815, "body": "I haven&#39;t the code yet. I find the different control like &#39;scribble&#39; (the example above) but what i need is free transform control"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495614681, "post_id": 44152788, "comment_id": 75322950, "body": "I am not sure about a free transform control... But there is a Freeform controls which lets you scribble an area."}, {"owner": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495615136, "post_id": 44152788, "comment_id": 75323263, "body": "oh thanks. by the way, how to set the TakeFocusOnClick property of the CommandButton to FALSE?  The Execute command does not pause so the following code is executed straight away."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1495615455, "post_id": 44152788, "comment_id": 75323475, "body": "Thses activex objects has an Ole Object property., The take focus property should be in there some where"}], "owner": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495613889, "creation_date": 1495613889, "question_id": 44152788, "link": "https://stackoverflow.com/questions/44152788/free-transform-tool-activated-by-button", "title": "Free Transform tool activated by button", "body": "<p>I want to be able to push a button on the excel sheet which will change the mouse to the free transform tool and then allow me to draw on the excel sheet. Is that possible?\nI make an example to append scribble tool example instead a free transform</p>\n\n<p><code>Sub cButton_Click()\nApplication.CommandBars(\"Drawing\").Controls(\"AutoShapes\").Controls(\"Lines\").Controls(\"Scribble\").Execute\nEnd Sub\n</code></p>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495613665, "post_id": 44152655, "comment_id": 75322255, "body": "Did you try without using <code>.select</code>? Like <code>Sheets(&quot;AAA&quot;).Shapes(&quot;Drop_Leg&quot;).ListFillRange = &quot;=&#39;BBB&#39;!n2:n&quot; &amp; x</code>. This can occur when the shape is not visible or something, then it obviously cannot be selected."}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495614549, "post_id": 44152655, "comment_id": 75322860, "body": "Yeap, I have tried. I get the error: Object doesn&#39;t support this property or method..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1495614670, "post_id": 44152655, "comment_id": 75322939, "body": "is it a Drop-Down (combo-box type user-form) ? or Active-X combo-box ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1495614738, "post_id": 44152655, "comment_id": 75322987, "body": "Out of curiousity, what is the maximum value in M2:M200?  (It seems strange that you are using the maximum in that range to determine how many cells to use in the next column.  E.g. if the maximum in M2:M200 is 497, are you really wanting to use N2:N498 to populate the combobox?)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495615051, "post_id": 44152655, "comment_id": 75323197, "body": "This should work without selecting if it is of type user-form and no ActiveX: <code>Sheets(&quot;AAA&quot;).Shapes(&quot;Drop_Leg&quot;).ControlFormat.ListFillRange = &quot;=&#39;BBB&#39;!n2:n&quot; &amp; x</code>"}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1495615256, "post_id": 44152655, "comment_id": 75323335, "body": "@ShaiRado Active-x"}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495615291, "post_id": 44152655, "comment_id": 75323364, "body": "@YowE3K between 8 and 19, depends on a previous listbox."}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495615368, "post_id": 44152655, "comment_id": 75323406, "body": "@Peh Doesnt work error as your previous solution. I am guessing now that the proble is related with the question raised by Shai Rado"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495615495, "post_id": 44152655, "comment_id": 75323497, "body": "@PauloAlves no it is because you are using an ActiveX combobox and the code is for an user-form combobox. I would stay away from ActiveX if possible, due to compatibility issues. Try using a user-form combobox instead with that code."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 0, "creation_date": 1495616714, "post_id": 44153422, "comment_id": 75324304, "body": "Thanks. for the help, but still not there.Get the error:      &quot;Unable to gget the OLEObjects property of the worksheet class&quot;  The reason why I used the active X was because the form comboBox for some reason doesn&#39;t let me type."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 0, "creation_date": 1495617044, "post_id": 44153422, "comment_id": 75324515, "body": "@PauloAlves  you copied my entire code and which line did you get your error ?"}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 0, "creation_date": 1495617774, "post_id": 44153422, "comment_id": 75325080, "body": "With Sheets(&quot;AAA&quot;).OLEObjects(&quot;Drop_Leg&quot;).Object"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 1, "creation_date": 1495620054, "post_id": 44153422, "comment_id": 75326799, "body": "@PauloAlves That means that there is no ActiveX combobox called <code>Drop_Leg</code> in sheet <code>AAA</code>. Check your sheet name and combobox name again."}, {"owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 0, "creation_date": 1495621915, "post_id": 44153422, "comment_id": 75328089, "body": "Solved. restart excel and voil&#225;! your code is working perfectly!! Thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "edited": false, "score": 0, "creation_date": 1495622111, "post_id": 44153422, "comment_id": 75328246, "body": "@PauloAlves  you&#39;re welcome, please mark as &quot;Answer&quot; by clicking the gray check-mark next to my answer, it will turn green"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1495615721, "creation_date": 1495615721, "answer_id": 44153422, "question_id": 44152655, "link": "https://stackoverflow.com/questions/44152655/excel-vba-combobox-error/44153422#44153422", "title": "Excel VBA ComboBox error", "body": "<p>Try the code below to populate your <strong>Active-X</strong> <code>Combo-Box</code>.</p>\n\n<p>There's no need to use <code>Select</code> to populate the <code>Combo-Box</code>, it only slows down your code's run-time.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub FillCombo()\n\nDim x           As Long\nDim ComboRng    As Range\n\nx = Application.WorksheetFunction.Max(Sheets(\"BBB\").Range(\"M2:M200\")) + 1\nSet ComboRng = Sheets(\"BBB\").Range(\"N2:N\" &amp; x) '&lt;-- set the Range\n\nWith Sheets(\"AAA\").OLEObjects(\"Drop_Leg\").Object\n    .Clear ' clear before adding new values\n    .List = ComboRng.Value ' populate the list with values from Column N\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4985548, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uA8ApZiBlqo/AAAAAAAAAAI/AAAAAAAACrE/-7qat8-B5wQ/photo.jpg?sz=128", "display_name": "Paulo Alves", "link": "https://stackoverflow.com/users/4985548/paulo-alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 44153422, "answer_count": 1, "score": 0, "last_activity_date": 1495615721, "creation_date": 1495613524, "last_edit_date": 1531164843, "question_id": 44152655, "link": "https://stackoverflow.com/questions/44152655/excel-vba-combobox-error", "title": "Excel VBA ComboBox error", "body": "<p>I am trying to fill a comboxbox located in sheet \"AAA\" with data in Sheet \"BBB\"</p>\n\n<pre><code>x = Application.WorksheetFunction.Max(Sheets(\"BBB\").Range(\"m2:m200\")) + 1\nSheets(\"AAA\").Shapes(\"Drop_Leg\").Select\nWith Selection\n    .ListFillRange = \"='BBB'!n2:n\" &amp; x\nEnd With\n</code></pre>\n\n<p>I am getting the error</p>\n\n<blockquote>\n  <p>\"Requested Shapes are locked for selection\". </p>\n</blockquote>\n\n<p>I have tried different approaches, but cannot get it to work. This used to be a dropbox, but I was asked to change it to a combo. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495612987, "post_id": 44152414, "comment_id": 75321814, "body": "Have you tried <code>FirstBBSName = ThisWorkbook.Worksheets(7).Name</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1495613136, "post_id": 44152472, "comment_id": 75321916, "body": "Yes, that is it! Sometimes you just need another pair of eyes to see"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1495613059, "creation_date": 1495613059, "answer_id": 44152472, "question_id": 44152414, "link": "https://stackoverflow.com/questions/44152414/function-to-return-a-sheet-name-no-longer-working/44152472#44152472", "title": "Function to return a sheet name no longer working", "body": "<p>First, it's <code>Volatile</code>, not <code>Volitile</code>. :)</p>\n\n<p>Second, you need to specify <code>ThisWorkbook</code> as the containing workbook:</p>\n\n<pre><code>Function FirstBBSName()\n\nApplication.Volatile True\nFirstBBSName = ThisWorkbook.Worksheets(7).Name\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 44152472, "answer_count": 1, "score": 0, "last_activity_date": 1495613059, "creation_date": 1495612852, "last_edit_date": 1531164843, "question_id": 44152414, "link": "https://stackoverflow.com/questions/44152414/function-to-return-a-sheet-name-no-longer-working", "title": "Function to return a sheet name no longer working", "body": "<p>I had a function to return the name of the 7th sheet in my workbook:</p>\n\n<pre><code>Function FirstBBSName()\n\nApplication.Volitile True\nFirstBBSName = Worksheets(7).Name\n\nEnd Function\n</code></pre>\n\n<p>Then on the sheet I would refer to it like so:</p>\n\n<pre><code>=\"'\"&amp;FirstBBSName()&amp;\"'!\"\n</code></pre>\n\n<p>I can then use it in other <code>INDRECT</code> formula and what not.\nI need the above as the 7th sheet may or may not be present and it's name could be different every time.</p>\n\n<p>It worked, but my problem was that it returned the name of the 7th sheet of whatever workbook was open and being changed, due to <code>Application.Volitile</code> and <code>Worksheets(7).Name</code>. Which is not what I intend it to do. It should only return the name of the 7th sheet of the workbook the code is in.</p>\n\n<p>I tried to alter the funtion to do this, but failed, so I returned it to the code above, exactly how it was before. Now I only receive a <code>#VALUE</code> error on my sheet when I try to get the output.</p>\n\n<p>Why would this be?</p>\n\n<p>(Yes the sheet is present at the moment, there are 9 sheets on the workbook currently.)</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1495612963, "post_id": 44152251, "comment_id": 75321796, "body": "Thank you for quick response Romcel.. Your code will put all workbook&#39;s sheets in the array.. I need to put only specific sheets not all of them.. these sheets are specified in the code itself .. Then I want to declare range variable with the same name varBBB each for one sheet (varBBB(1) = Sheets(First Array Element).UsedRange, varBBB(2 = Sheets(Second Array Element).UsedRange))"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1495613196, "post_id": 44152251, "comment_id": 75321948, "body": "Updated the post. You can disregard the first set of code and iterate trough the specific array of sheets using the second set of code. You need the <code>arrHolder()</code> to temporarily hold the array of <code>UsedRange</code>."}], "tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": false, "score": 0, "last_activity_date": 1495613084, "last_edit_date": 1495613084, "creation_date": 1495612388, "answer_id": 44152251, "question_id": 44152166, "link": "https://stackoverflow.com/questions/44152166/vba-declare-variables-from-elements-of-a-dynamic-array/44152251#44152251", "title": "vba - Declare variables from elements of a dynamic array", "body": "<p>Maybe you are looking for something like,</p>\n\n<pre><code>Dim arrWS() As String\nDim iLoop As Integer\n\nWith ThisWorkbook\n  ReDim arrWS(1 To .Sheets.Count)\n  For iLoop = 1 To .Sheets.Count\n    arrWS(iLoop) = .Sheets(iLoop).Name\n  Next\nEnd With\n</code></pre>\n\n<p>then you can use <code>Ubound(arrWWS)</code> to get the last index of the array.</p>\n\n<p>You can now use this code to store each usedrange in the sheet,</p>\n\n<pre><code>Dim arrBB() As Variant\nDim arrHolder() As Variant\n\n  ReDim arrBB(1 To UBound(arrWS))\n  For iLoop = LBound(arrWS) To UBound(arrWS)\n    arrHolder() = Sheets(arrWS(iLoop)).UsedRange.Value\n    arrBB(iLoop) = arrHolder()\n  Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1495613797, "post_id": 44152521, "comment_id": 75322349, "body": "Thank you Rory.. When I create the sheets array like that varAAA= Array(&quot;Sheet1&quot;, Sheet2&quot;, &quot;Sheet4&quot;) your code gives me Subscript out of range error."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1495617997, "last_edit_date": 1495617997, "creation_date": 1495613163, "answer_id": 44152521, "question_id": 44152166, "link": "https://stackoverflow.com/questions/44152166/vba-declare-variables-from-elements-of-a-dynamic-array/44152521#44152521", "title": "vba - Declare variables from elements of a dynamic array", "body": "<p>You could do this:</p>\n\n<pre><code>Dim varBBB()\nRedim varBBB(LBound(varAAA) to UBound(varAAA))\nFor i = LBound(varAAA) to UBound(varAAA)\n    varBBB(i) = Sheets(varAAA(i)).UsedRange\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1495613983, "post_id": 44152740, "comment_id": 75322469, "body": "How can we refer to the cells in an array of range?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1495614084, "post_id": 44152740, "comment_id": 75322536, "body": "@RomcelGeluz However you want to, e.g. <code>varBBB(3).Cells(1,1)</code> or <code>varBBB(x).Range(myRangeVariable)</code> or ....  It&#39;s no different to using a non-array <code>Range</code> object, except that it is indexed."}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1495614242, "post_id": 44152740, "comment_id": 75322666, "body": "Oh yes! Another reason not to use a 3D array, (I used to do this to represent the sheet with 3rdD). Thanks a ton."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1495614010, "last_edit_date": 1495614010, "creation_date": 1495613757, "answer_id": 44152740, "question_id": 44152166, "link": "https://stackoverflow.com/questions/44152166/vba-declare-variables-from-elements-of-a-dynamic-array/44152740#44152740", "title": "vba - Declare variables from elements of a dynamic array", "body": "<p>Your main problem is that you must <code>Set</code> object variables:</p>\n\n<pre><code>'1- Declare an array containing some worksheet names\n' ==&gt; varAAA = Array(\"Sheet1\", \"Sheet3\", \"Sheet4\", ...)\nDim VarAAAA\nvarAAA = Array(\"Sheet1\", \"Sheet3\", \"Sheet4\")\n\n'2- Get the number of elements in this array\nDim N As Long\nN = UBound(varAAA) - LBound(varAAA) + 1\n\n'3- Then like that if possible:\n'Dim varBBB(1 To N)\nDim varBBB() As Range\nReDim varBBB(1 To N)\n'For i = 1 to N\nFor i = 1 To N\n'varBBB(i) = Sheets(varAAA(i)).UsedRange\n    Set varBBB(i) = Sheets(varAAA(i - 1 + LBound(varAAA))).UsedRange\n    'Confirm that ranges have been correctly set\n    Debug.Print i, varAAA(i - 1 + LBound(varAAA)), varBBB(i).Address\n'Next N\nNext\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 44152740, "answer_count": 3, "score": 0, "last_activity_date": 1495617997, "creation_date": 1495612154, "last_edit_date": 1531164843, "question_id": 44152166, "link": "https://stackoverflow.com/questions/44152166/vba-declare-variables-from-elements-of-a-dynamic-array", "title": "vba - Declare variables from elements of a dynamic array", "body": "<p>I need to declare variant variables from the elements of a dynamic array.</p>\n\n<p>I have an array (arrWS) which contains the names of specific sheets which is populated manually, and I want to declare \"N\" range objects where \"N\" is the number of worksheets.</p>\n\n<p>Sequence:\n1- Declare an array containing some worksheet names ==> varAAA = Array(\"Sheet1\", \"Sheet3\", \"Sheet4\", ...)</p>\n\n<p>2- Get the number of elements in this array</p>\n\n<p>3- Then like that if possible:</p>\n\n<pre><code>Dim varBBB(1 To N)\nFor i = 1 to N\n    varBBB(i) = Sheets(varAAA(i)).UsedRange\nNext N\n</code></pre>\n\n<p>Thank you so much in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1495610842, "post_id": 44151618, "comment_id": 75320278, "body": "With that much data, I strongly suggest to move it to MS Access database and handle it there."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495611412, "post_id": 44151618, "comment_id": 75320693, "body": "And make sure to use the 64bit edition of Office which an handle more memory than the usually used 32bit edition."}, {"owner": {"reputation": 21, "user_id": 7989939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a25f3d201ac1c0c7687ff13d6581ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Vahagn Poghosyan", "link": "https://stackoverflow.com/users/7989939/vahagn-poghosyan"}, "edited": false, "score": 1, "creation_date": 1495612539, "post_id": 44151618, "comment_id": 75321530, "body": "It will exceed the capacity of Access (2GB). It doesn&#39;t matter if I use 32bit or 64 bit Excel"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "edited": false, "score": 0, "creation_date": 1495613537, "post_id": 44151618, "comment_id": 75322160, "body": "is the above script running 16 times or just once?"}, {"owner": {"reputation": 21, "user_id": 7989939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a25f3d201ac1c0c7687ff13d6581ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Vahagn Poghosyan", "link": "https://stackoverflow.com/users/7989939/vahagn-poghosyan"}, "edited": false, "score": 0, "creation_date": 1495613789, "post_id": 44151618, "comment_id": 75322341, "body": "It is in a for loop and runs several times until it has opened and taken the necessary info from all files in specific folder"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495614758, "post_id": 44151618, "comment_id": 75323010, "body": "Unless <b>absolutely</b> necessary for backward compatibility I&#39;d use a server-side cursor and not a <code>.CursorLocation = adUseClient</code>. Also, if you&#39;re opening them read-only then I&#39;d use a <code>.CursorType = adOpenForwardOnly</code>. BTW, I just used your code on a file containing one million rows without a problem. No, I didn&#39;t iterate over it 12+ times. Nonetheless, if your machine cannot handle these files then there is little we can do to help. I (personally) would move to a DB server (MySQL, MS SQL, Oracle DB Express or any other). Makes it easier and much faster."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1495618360, "post_id": 44151618, "comment_id": 75325485, "body": "Perhaps a PowerQuery solution is helpful here?"}, {"owner": {"reputation": 21, "user_id": 7989939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a25f3d201ac1c0c7687ff13d6581ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Vahagn Poghosyan", "link": "https://stackoverflow.com/users/7989939/vahagn-poghosyan"}, "edited": false, "score": 0, "creation_date": 1495619601, "post_id": 44151618, "comment_id": 75326458, "body": "Thank you Ralph for feedback, I run the script on very powerful machine, hence I don&#39;t think it&#39;s hardware problem here, I think maybe there is some limitation with recordset object and if yes how can I avoid it"}], "owner": {"reputation": 21, "user_id": 7989939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a25f3d201ac1c0c7687ff13d6581ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Vahagn Poghosyan", "link": "https://stackoverflow.com/users/7989939/vahagn-poghosyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495610538, "creation_date": 1495610538, "last_edit_date": 1531164843, "question_id": 44151618, "link": "https://stackoverflow.com/questions/44151618/excel-vba-memory-issue", "title": "Excel VBA memory issue", "body": "<p>I have a huge data (16 files with 300,000 rows and 65 columns in each) in excel. I am trying to analyse the data via vba (For each file the recordset takes the data based on criteria). For 12 files it works, however when I increase the files involved the vba just dies, after opening and taking the information from 12th file.</p>\n\n<pre><code>connectionToDatabase.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n\"Data Source=\" &amp; CStr(file) &amp; \";\" &amp; _\n\"Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\nconnectionToDatabase.CursorLocation = adUseClient\nrecordsTable.Open \"SELECT a, b,c,d ... z, where z&gt;10000\"  \n</code></pre>\n\n<p>It does some arithmetic here and then </p>\n\n<pre><code>recordsTable.Close\nconnectionToDatabase.Close\nSet recordsTable = Nothing\nSet connectionToDatabase = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "select", "reference"], "comments": [{"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495611125, "post_id": 44151396, "comment_id": 75320503, "body": "Reason for downvote?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1495612263, "post_id": 44151396, "comment_id": 75321337, "body": "That&#39;s the only downside here in SO. People downvote and don&#39;t specify the reason. I am not sure why you got a downvote while your question makes sense and in fact a good question."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1495612310, "post_id": 44151396, "comment_id": 75321366, "body": "Also I upvoted it to counter the downvote."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1495612701, "post_id": 44151396, "comment_id": 75321639, "body": "1. Why not a function? They&#39;re works well. Another option here: You can add a dictionary as member of <code>ThisWorkbook</code> and populate it with (ws.CodeName, ws) pair on events such as Open, NewSheet and at cetera. And after that you can pull your ws from that dict just with <code>Set ws =ThisWorkbook.CodeNameWss(&quot;Codename&quot;)</code>. 2.Best option to avoid an <code>Activate</code> - just not using it. Don&#39;t feel obligated to use it, if you need anything except &quot;activating&quot; the cell."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1495613279, "post_id": 44151396, "comment_id": 75322006, "body": "@sktneer Thank you. This sentence is from SO  help center to explain us <b>When should we vote down?</b> ==&gt; <b>Use your downvotes whenever you encounter an egregiously sloppy, no-effort-expended post, or an answer that is clearly and perhaps dangerously incorrect.</b> I am trying to solve this issue for a very long time and as I mentioned within the text, I really spent a lot of effort searched for many sources and I think it&#39;s not that <i>egregiously sloppy</i> and I wonder where is not clear enough.."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1495614707, "post_id": 44151396, "comment_id": 75322964, "body": "@CommonSense thanks for your interest. Because I use this kind of codes a lot and I don&#39;t want to run another function each time. But the question is answered now, the only thing I was missing is, CodeNames are only working in ThisWorkbook so when I was trying to define it one more time, it was occurring an error."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1495615441, "post_id": 44151396, "comment_id": 75323466, "body": "@Mertinc, CodeName is a string property and you trying to use a hard-coded variable (in scope of thisworkbook), If your codenames are changed over time (and you doesnt handle it) - your code will fail, but with function approach there&#39;re less pain if it happen. Your question is misleading, because you never really use a codename. It&#39;s better to run a function each time than use a hard-coded stuff. But if you sufficent with that - who am I to blame you (:"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495615666, "post_id": 44151396, "comment_id": 75323617, "body": "Oh no mate cheers thanks for your interest :) But I think you misunderstood me, my CodeNames will never change unless I want it. (I&#39;m not talking about Sheet Names , which user can easily change. Actually the reason I&#39;m using CodeNames is to avoid this problem.) And I really do use a codename :)"}], "answers": [{"comments": [{"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495614555, "post_id": 44152153, "comment_id": 75322866, "body": "Oh, so the only thing I was missing: <b>the limitation is you can use the codename in ThisWorkbook only</b> information in this case. Anyway, that&#39;s solved now. But can you please underline that <code>wsData</code> <b>is not a variable</b> but really just Worksheet&#39;s <b>CodeName</b>. (I misunderstood it at first) Thanks @sktneer"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495616527, "post_id": 44152153, "comment_id": 75324191, "body": "@Mertinc You&#39;re welcome. Glad you found it useful. I have added the comment in the solution to make is clear that wsData is the sheet code name."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 3, "last_activity_date": 1495616465, "last_edit_date": 1495616465, "creation_date": 1495612114, "answer_id": 44152153, "question_id": 44151396, "link": "https://stackoverflow.com/questions/44151396/using-worksheet-codename-and-avoiding-select-activate/44152153#44152153", "title": "Using Worksheet CodeName and Avoiding .Select &amp; .Activate", "body": "<p>While setting a sheet variable to the codename, the limitation is you can use the codename in ThisWorkbook only i.e. the workbook which contains the code.</p>\n\n<p>Consider this code...</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = wsData 'where wsData is the CodeName of a sheet.\n</code></pre>\n\n<p>Now in your code you can manipulate or perform actions on ws sheet without activating or selecting it.\nActually in case of CodeNames, you don't need to declare a sheet variable, you can directly refer to the sheet by using it's codename irrespective of which sheet is currently active.</p>\n\n<p>like...</p>\n\n<pre><code>wsData.Cells.Clear\nSet Rng = wsData.Range(\"A1\").CurrentRegion\n</code></pre>\n\n<p>e.g. with your another example code</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = wsData 'where wsData is the CodeName of a sheet.\n\nFirstRow = ws.Cells.Find(What:=\"FIRST TEXT I'M LOOKING FOR\", After:= _\n        ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Row\n\n'Or just (without declaring the ws sheet variable where wsData is the sheet code name)\nFirstRow = wsData.Cells.Find(What:=\"FIRST TEXT I'M LOOKING FOR\", After:= _\n        ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Row\n</code></pre>\n"}], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 44152153, "answer_count": 1, "score": 2, "last_activity_date": 1495616465, "creation_date": 1495609931, "last_edit_date": 1495610274, "question_id": 44151396, "link": "https://stackoverflow.com/questions/44151396/using-worksheet-codename-and-avoiding-select-activate", "title": "Using Worksheet CodeName and Avoiding .Select &amp; .Activate", "body": "<p>In my workbook I frequently need to activate some sheets by using their <strong>CodeName</strong> then <strong>search for some texts</strong> within that sheet and <strong>use the row or column number of the cell</strong> that contains the text I'm looking for.</p>\n\n<p>In that situations, I am using below kind of codes:</p>\n\n<pre><code>Sheet16.Select '(Using codename)\nCells.Find(What:=\"FIRST TEXT I'M LOOKING FOR\", After:= _\n        ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate\n\n   FirstRow= ActiveCell.Row\n\n    Cells.Find(What:=\"SECOND TEXT I'M LOOKING FOR\", After:= _\n        ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate\n\nSecondRow = ActiveCell.Row\n\nRows(FirstRow &amp; \":\" &amp; SecondRow + 1).EntireRow.Hidden = False\n</code></pre>\n\n<p>Eveything works well, but nowadays I am trying to improve my codes and I'd like to run my codes faster.</p>\n\n<p><strong><em>Now,</em></strong></p>\n\n<h2>1- How can I reference my WorkSheets' CodeName easily?</h2>\n\n<p><strong>(I'm looking for answer like ThisWorkbook.Worksheets(\"Sheet1\") - not a function</strong></p>\n\n<pre><code>Dim wb as Workbook, ws as Worksheet\nset wb = ThisWorkbook\nset ws = wb.CodeName(Sheet16) or wb.Sheet16 or sheet16\n'then \nws.Cells.Find(What ..........   rest of the code  ...... )\n</code></pre>\n\n<p>none of them working for <strong><code>CodeName</code></strong> property.\n<a href=\"https://stackoverflow.com/questions/25203173/fully-reference-a-worksheet-by-codename\">Fully reference a worksheet by codename</a> or <a href=\"https://stackoverflow.com/questions/22256536/referencing-sheets-in-another-workbook-by-codename-using-vba\">Referencing sheets in another workbook by codename using VBA</a> didn't answer my question. </p>\n\n<h2>2- How can I avoid using <strong>.Activate</strong> to use the result cell of <strong>Cells.Find()</strong> formula.</h2>\n\n<p>Again in that example I firstly search for specific text, which is <strong>:=\"FIRST TEXT I'M LOOKING FOR\"</strong> in the first part of my code, and then I need to use that cell to get it's <strong>row number</strong> or use <strong>offset</strong> or <strong>anything</strong> , and because of that I feel myself obligated to use <strong>.Activate</strong> because,</p>\n\n<pre><code>FirstRow =  Cells.Find(What:=\"FIRST TEXT I'M LOOKING FOR\", After:= _\n        ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Row\n</code></pre>\n\n<p>kind of codes do not work as well. <a href=\"https://stackoverflow.com/a/10717999/7130016\">How to avoid using Select in Excel VBA macros</a> here in that answer there are couple of suggestions but none of them helps me in this case. I tried to get an answer from the owner of this answer to avoid any duplicate question but he suggested me to ask a new question. <em>(And as long as both of my questions belong to my example code and I'll connect them, I asked them together in one question.)</em></p>\n"}, {"tags": ["sql-server", "ms-access", "file-upload", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1495610370, "post_id": 44151345, "comment_id": 75319922, "body": "Welcome to StackOverflow. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>, and try to improve your question with further information. What have you already tried, what is not working, etc."}, {"owner": {"reputation": 661, "user_id": 4735777, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e64d8da16cef0dcdb8a61b48b6289142?s=128&d=identicon&r=PG&f=1", "display_name": "PacoDePaco", "link": "https://stackoverflow.com/users/4735777/pacodepaco"}, "edited": false, "score": 0, "creation_date": 1495618665, "post_id": 44151345, "comment_id": 75325730, "body": "Download SQL Server Management studio and query the file with the help of Access OLEDB provider using OPENROWSET."}, {"owner": {"reputation": 3, "user_id": 6639254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-619D48p_Dk0/AAAAAAAAAAI/AAAAAAAABX8/j4sqvMPKQ4E/photo.jpg?sz=128", "display_name": "Renjith R", "link": "https://stackoverflow.com/users/6639254/renjith-r"}, "edited": false, "score": 0, "creation_date": 1495619131, "post_id": 44151345, "comment_id": 75326071, "body": "Hi Pawel, I tried below code but it gives me error or object not found since I am using &quot;Match&quot; function. First checking Columns of Excel data with SQL columns         For col = 0 To .Fields.count - 1             index = xlApp.Application.Match(.Fields(col).Name, sourceRange.Rows(2), 0)             If index &gt; 0 Then                 exportFieldsCount = exportFieldsCount + 1                 tableFields(exportFieldsCount) = col                 rangeFields(exportFieldsCount) = index             End If Next And then adding data into Recordset. But Recordset.UpdateBatch is also not working"}, {"owner": {"reputation": 3, "user_id": 6639254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-619D48p_Dk0/AAAAAAAAAAI/AAAAAAAABX8/j4sqvMPKQ4E/photo.jpg?sz=128", "display_name": "Renjith R", "link": "https://stackoverflow.com/users/6639254/renjith-r"}, "edited": false, "score": 0, "creation_date": 1495619392, "post_id": 44151345, "comment_id": 75326292, "body": "Hi Pawel, can u share any article or link which can help me"}, {"owner": {"reputation": 3, "user_id": 6639254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-619D48p_Dk0/AAAAAAAAAAI/AAAAAAAABX8/j4sqvMPKQ4E/photo.jpg?sz=128", "display_name": "Renjith R", "link": "https://stackoverflow.com/users/6639254/renjith-r"}, "edited": false, "score": 0, "creation_date": 1495619557, "post_id": 44151345, "comment_id": 75326421, "body": "For col = 0 To .Fields.count - 1             index = xlApp.Application.Match(.Fields(col).Name, sourceRange.Rows(2), 0)             If index &gt; 0 Then                 exportFieldsCount = exportFieldsCount + 1                 tableFields(exportFieldsCount) = col                 rangeFields(exportFieldsCount) = index             End If         Next  above code gives me Method Not found since I am using Access but function is of Excel"}, {"owner": {"reputation": 661, "user_id": 4735777, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e64d8da16cef0dcdb8a61b48b6289142?s=128&d=identicon&r=PG&f=1", "display_name": "PacoDePaco", "link": "https://stackoverflow.com/users/4735777/pacodepaco"}, "edited": false, "score": 0, "creation_date": 1495622017, "post_id": 44151345, "comment_id": 75328158, "body": "<a href=\"https://stackoverflow.com/questions/24150739/code-to-read-xlsx-sheet-into-a-table-in-a-sql-server-database\">Here</a> you can find what you need once you are connected to your server using SSMS. You can also use data import tool in SSMS."}, {"owner": {"reputation": 3, "user_id": 6639254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-619D48p_Dk0/AAAAAAAAAAI/AAAAAAAABX8/j4sqvMPKQ4E/photo.jpg?sz=128", "display_name": "Renjith R", "link": "https://stackoverflow.com/users/6639254/renjith-r"}, "edited": false, "score": 0, "creation_date": 1496225851, "post_id": 44151345, "comment_id": 75570665, "body": "the problem is OPENROWSET is not supported in Azure Cloud"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498252353, "creation_date": 1498252353, "answer_id": 44730016, "question_id": 44151345, "link": "https://stackoverflow.com/questions/44151345/how-to-upload-excel-data-into-sql-with-access-vba/44730016#44730016", "title": "How to Upload Excel Data into SQL with Access Vba?", "body": "<p>I just answered a question like this about an hour ago.</p>\n\n<pre><code>Sub Button_Click()\n'TRUSTED CONNECTION\n    On Error GoTo errH\n\n    Dim con As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim strPath As String\n    Dim intImportRow As Integer\n    Dim strFirstName, strLastName As String\n\n    Dim server, username, password, table, database As String\n\n\n    With Sheets(\"Sheet1\")\n\n            server = .TextBox1.Text\n            table = .TextBox4.Text\n            database = .TextBox5.Text\n\n\n            If con.State &lt;&gt; 1 Then\n\n                con.Open \"Provider=SQLOLEDB;Data Source=\" &amp; server &amp; \";Initial Catalog=\" &amp; database &amp; \";Integrated Security=SSPI;\"\n                'con.Open\n\n            End If\n            'this is the TRUSTED connection string\n\n            Set rs.ActiveConnection = con\n\n            'delete all records first if checkbox checked\n            If .CheckBox1 Then\n                con.Execute \"delete from tbl_demo\"\n            End If\n\n            'set first row with records to import\n            'you could also just loop thru a range if you want.\n            intImportRow = 10\n\n            Do Until .Cells(intImportRow, 1) = \"\"\n                strFirstName = .Cells(intImportRow, 1)\n                strLastName = .Cells(intImportRow, 2)\n\n                'insert row into database\n                con.Execute \"insert into tbl_demo (firstname, lastname) values ('\" &amp; strFirstName &amp; \"', '\" &amp; strLastName &amp; \"')\"\n\n                intImportRow = intImportRow + 1\n            Loop\n\n            MsgBox \"Done importing\", vbInformation\n\n            con.Close\n            Set con = Nothing\n\n    End With\n\nExit Sub\n\nerrH:\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/je8xE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/je8xE.png\" alt=\"enter image description here\"></a>\nAlso, check out these links.</p>\n\n<p><a href=\"https://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm\" rel=\"nofollow noreferrer\">https://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm</a></p>\n\n<p><a href=\"http://tomaslind.net/2013/12/26/export-data-excel-to-sql-server/\" rel=\"nofollow noreferrer\">http://tomaslind.net/2013/12/26/export-data-excel-to-sql-server/</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6639254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-619D48p_Dk0/AAAAAAAAAAI/AAAAAAAABX8/j4sqvMPKQ4E/photo.jpg?sz=128", "display_name": "Renjith R", "link": "https://stackoverflow.com/users/6639254/renjith-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1171, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1498252353, "creation_date": 1495609815, "last_edit_date": 1495613013, "question_id": 44151345, "link": "https://stackoverflow.com/questions/44151345/how-to-upload-excel-data-into-sql-with-access-vba", "title": "How to Upload Excel Data into SQL with Access Vba?", "body": "<p>I have large data in Excel that I need to upload to SQL Server but I am using Access as a Front End. Number of columns in Excel are around 90 and number of records goes above 700,000</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1495611673, "post_id": 44151199, "comment_id": 75320888, "body": "Welcome to Stack Overflow. First of all this is not a free code writing service so you will need to show (the code) what you already have done (Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>). Secondly &quot;<i>group all the values with <code>#N&#47;A</code> right at the bottom</i>&quot; is not a really clear statement. Did you eventually mean &quot;<i>move the lines with <code>#N&#47;A</code> to the bottom</i>&quot;?"}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495612872, "post_id": 44151199, "comment_id": 75321741, "body": "Sub GroupRows()     Dim rownum As Long     For rownum = 1 To 1000     If Cells(rownum, 3).Value = &quot;#N/A&quot; Then         Rows(rownum).Delete     Next rownum     Cells(rownum, 3).Activate End Sub                                                                                                                             at first I wanted to delete all the rows that have the &quot;#N/A&quot; value, so i used the code above, but it always gives me an error, so I wanted to group them at the bottom first then record a macro to delete them."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495613047, "post_id": 44151199, "comment_id": 75321856, "body": "I hope what i am saying is clear."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1495613103, "post_id": 44151199, "comment_id": 75321895, "body": "Please don&#39;t post code in comments (it&#39;s unreadable because it is not formatted). Instead <a href=\"https://stackoverflow.com/posts/44151199/edit\">edit</a> your question to add it. Then describe what your code actually does (what the result is) and what you expect it to do (what the result should be). If there are any errors tell us what the error says and at which line in the code it occurs."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495613272, "post_id": 44151199, "comment_id": 75322004, "body": "If you delete rows you need to start the loop from the bottom <code>For rownum = 1000 To 1 Step -1</code> because otherwise the rownumbers change while the loop runs."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495613775, "post_id": 44151199, "comment_id": 75322328, "body": "Thank you, i&#39;ve edited the question, let me try the changes you&#39;ve suggested."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495614172, "post_id": 44151199, "comment_id": 75322608, "body": "Yes, the error message is a bit misleading if you are not familiar with VBA. There is a <code>End If</code> missing right before <code>Next rownum</code>. I reformatted (indented) your code so you can see where it is missing. Nevertheless the loop needs to start from the bottom. <i>Side Note: Read <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices\">VBA Best Practices</a> if you are a beginner with VBA this helps a lot to avoid any issues and shows you a good practice how to write code.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1495615928, "creation_date": 1495615928, "answer_id": 44153500, "question_id": 44151199, "link": "https://stackoverflow.com/questions/44151199/grouping-value-using-vba/44153500#44153500", "title": "Grouping Value using VBA", "body": "<p>This is how your code would look like if you use the last used row instead of a fixed max row number.</p>\n\n<pre><code>Sub GroupRows()\n    Dim iRow As Long, lastRow As Long\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"MySheetName\") 'qualify your sheet\n\n    lastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row 'find last used row\n\n    For iRow = lastRow To 1 Step -1 'run from last used row backwards to row 1\n        If ws.Cells(iRow, 3).Text = \"#N/A\" Or _\n           ws.Cells(iRow, 4).Text = \"#N/A\" Then\n            ws.Rows(iRow).Delete\n        End If\n    Next iRow\n\n    ws.Cells(iRow, 3).Activate\nEnd Sub\n</code></pre>\n\n<p>Your code was missing a <code>End if</code> and you should always qualify a <code>Cells</code> or <code>Range</code> with a worksheet like <code>ws.Cells</code> or <code>ws.Range</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 44153500, "answer_count": 1, "score": 1, "last_activity_date": 1495615928, "creation_date": 1495609399, "last_edit_date": 1495614228, "question_id": 44151199, "link": "https://stackoverflow.com/questions/44151199/grouping-value-using-vba", "title": "Grouping Value using VBA", "body": "<p>I got the following data on a table, I want to make a macro that will group all the values with <code>#N/A</code> right at the bottom. Please assist.</p>\n\n<pre><code>       A         B                     C        D           E\n1     Line      Item               Quantity Part Number Description\n2     Line 1    Fan Motor           0           0          0\n3     Line 2    Fan                #N/A      #N/A         #N/A\n4     Line 3    Fan guard           0           0          0\n5     Line 4    Pump                0           0          0\n6     Line 5    Access door         0           0          0\n7     Line 6    Nozzle grommet      0           0          0\n8     Line 7    Nozzle              0           0          0\n9     Line 20   SST tube            0           0          0\n10    Line 21   Flanges             2      205024M2P     HDGFLG  \n11    Line 22   Part 11             #N/A      #N/A        #N/A\n12    Line 23   Part 12             #N/A      #N/A        #N/A\n16    Line 29   Terminal box         1     31123800P     TERMINAL BOX\n14    Line 25   Check Valve         #N/A      #N/A        #N/A\n15    Line 26   Buttefly Valve      #N/A      #N/A        #N/A\n17    Line 30   Solenoid valve       1     31601700P     SOLENOID VALVE 1 PER8\n18    Line 31   Coil                 1     31602000P     COIL FOR SOL. VALVE\n</code></pre>\n\n<p>I used the code below initially to delete rows with value <code>#N/A</code> </p>\n\n<pre><code>Sub GroupRows()\n    Dim rownum As Long\n\n    For rownum = 1 To 1000\n        If Cells(rownum, 3).Text = \"#N/A\" Then\n            Rows(rownum).Delete\n\n    Next rownum\n    Cells(rownum, 3).Activate\nEnd Sub\n</code></pre>\n\n<p>but a </p>\n\n<blockquote>\n  <p>\"Compile error: Next without For\" </p>\n</blockquote>\n\n<p>error message pops up, thing is I am still new to VBA and there's some things I do not quite understand as of yet, so I do not know whether I am coding right or not.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 4, "creation_date": 1495607939, "post_id": 44150589, "comment_id": 75318432, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. We will be here waiting for you. Ready to assist and help you finalize <i>your code</i>."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1495608563, "post_id": 44150589, "comment_id": 75318804, "body": "If you just want the number of rows which has the value <code>x</code> in column <code>y</code> or column <code>z</code>, then I would suggest using <code>COUNTIFS()</code>. It should be quite simple to implement."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1495720579, "post_id": 44152072, "comment_id": 75378675, "body": "Dear UGP, when i run this code, after 30 secs , it says &#39;Not responding&quot;. I will attach excel sheet if possible"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1496057202, "post_id": 44152072, "comment_id": 75491705, "body": "Hello UGP, agree, I edited the code and used it. It works Absolutely fine. The the values are coming in the cell.  The only problem I am having is , I am not able figure out why the excell starts not respong after the value have incorporated in excel"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1496057519, "post_id": 44152072, "comment_id": 75491901, "body": "It show error debug at sht.Cells(i, Col + 5).Value = Scan(Path, sht.Cells(i, Col).Value). May be limit is uper or lower limit is not set. Ot it is not able to find out when to stop or end running the code"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1496058931, "post_id": 44152072, "comment_id": 75492820, "body": "I did a few small changes, dont know if they change anything for you. i dont know where the error could comes from. i tried, but couldnt recreate the error you got."}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1496059322, "post_id": 44152072, "comment_id": 75493055, "body": "Excellent, Supercool, this works perfectly find. Thanks you so much, Much Appreciated"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1503290290, "post_id": 44152072, "comment_id": 78536449, "body": "it is possible to Hyperlink the path, so I can directly Click and the file opens. Please advise"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1503294703, "post_id": 44152072, "comment_id": 78537791, "body": "Look <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/hyperlinks-add-method-excel\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1504526170, "post_id": 44152072, "comment_id": 79033122, "body": "I tried a lot but could not create the file path as hyperlink where cell has more than 1 path. Please help , that will be really helpful"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "edited": false, "score": 0, "creation_date": 1504527804, "post_id": 44152072, "comment_id": 79034061, "body": "Excel allows only one hyperlink per cell, you could use a workaround like <a href=\"https://superuser.com/questions/982162/how-to-add-2-hyperlinks-in-a-single-cell-in-excel-2010\">here</a>. Or just use multiple cells."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 1, "last_activity_date": 1496059586, "last_edit_date": 1496059586, "creation_date": 1495611892, "answer_id": 44152072, "question_id": 44150589, "link": "https://stackoverflow.com/questions/44150589/vba-macro-to-search-a-keyword-from-excel-file-and-return-the-file-path-with-numb/44152072#44152072", "title": "VBA Macro to search a keyword from Excel file and return the file path with number of counts", "body": "<p>You are probably looking for something around these lines. This Code scans every File in the Folder in <code>Path</code> and compares the with the Ord No. <code>Name</code>. The Function then returns the Number of Files and the paths in the format <code>counter, path, path, ...</code>. </p>\n\n<pre><code>Sub Test()\nDim Path1 As String, Data() As String\nDim lRow As Long\nDim i As Integer\nDim sht As Worksheet\nSet sht = Worksheets(\"Tabelle1\")\nlRow = sht.Cells(Rows.Count, 3).End(xlUp).Row\nPath1 = \"C:\\Users\\User\\Desktop\\Files\\\"\nCol = 3\nFor i = 2 To lRow\n    If sht.Cells(i, Col).Value &lt;&gt; \"\" Then\n        sht.Cells(i, Col + 5).Value = Scan(Path1, sht.Cells(i, Col).Value)\n    End If\n    If i = lRow Then\n        If Col = 4 Then\n           Exit For\n        End If\n        Col = 4\n        i = 0\n    End If\nNext i\nEnd Sub\n\nFunction Scan(ByVal MyPath As String, Name As String) As String\nDim File As String, temp As String\nDim i As Integer: i = 0\n\nFile = Dir(MyPath &amp; \"*.*\")\n\nDo While File &lt;&gt; \"\"\n    If File Like \"*\" &amp; Name &amp; \"*\" Then\n       i = i + 1\n       temp = temp &amp; MyPath &amp; File &amp; \",\"\n    End If\n    File = Dir()\nLoop\ntemp = i &amp; \",\" &amp; temp\nScan = Left(temp, Len(temp) - 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1507097237, "creation_date": 1495607459, "last_edit_date": 1507097237, "question_id": 44150589, "link": "https://stackoverflow.com/questions/44150589/vba-macro-to-search-a-keyword-from-excel-file-and-return-the-file-path-with-numb", "title": "VBA Macro to search a keyword from Excel file and return the file path with number of counts", "body": "<p>VBA is interesting and I'm a Newbie.</p>\n\n<p>I have an Excel file with a list of number that I have to find in a folder and I want to return the path as a link in my Excel file so I can open and verify the docs are right and then print</p>\n\n<pre><code>INVOICE DATE    INVOICE NO  DN          ORDER NO    COMPANY NAME\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n</code></pre>\n\n<p>Say My folder path to search is <code>C:\\Users\\XXXXX\\XXXXX\\XXXXX</code></p>\n\n<p>For example</p>\n\n<pre><code>INVOICE DATE    INVOICE NO  DN          ORDER NO    COMPANY NAME\n5/9/2017    XXXXX   XXXXX   XXXXX   XXXXX\n</code></pre>\n\n<p>I want to search the number of files with number under DN and Order No column and retrive count of the files founds in a column and most important retrieve the file path of files found in another column in same row and search the whole list till the end</p>\n\n<p><code>DN - 287484135</code> and <code>order No 580449925</code> - search by both the numbers</p>\n\n<p>The naming convention of file in the folder are as below\n<code>Delivery_0650_LF_XXXXX_Delivery_note.PDF</code> - This is for DN\n<code>Order_9250_TA_055699732_File Name..TIF</code> - This is for Order No\n<code>Order_9250_TA_052835641_Copy_of_customer_PO.TIF</code> - This is for Order No</p>\n\n<p>Or at least please suggest to verify if the keywords are found ot organise the work effectively.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1495608518, "post_id": 44150571, "comment_id": 75318787, "body": "You can group them (this will not change the look of the shapes), but there is no possibility to combine shapes in Excel (if combine means removing the lines inside the overlapping shapes and keeping only the outline)."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1495609736, "post_id": 44150571, "comment_id": 75319511, "body": "You will need external program to combine the shapes, then copy and paste back into Excel. You can only do Edit Shape - Edit Points to change/add/etc to shapes individually."}, {"owner": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495610347, "post_id": 44150571, "comment_id": 75319909, "body": "How about this code example @Peh:  ActiveSheet.Shapes.range(Array(shape1.Name, shape2.Name)).Select CommandBars.ExecuteMso (&quot;ShapesUnion&quot;)  is it working"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495611067, "post_id": 44150571, "comment_id": 75320457, "body": "@Manik Didn&#39;t understand what you want to say with your comment. Did you see my answer below? This might be an alternative way for you?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "edited": false, "score": 0, "creation_date": 1496042561, "post_id": 44151465, "comment_id": 75483145, "body": "@Manik If this solved your issue you might consider marking this answer as solution so everyone can see that this question was solved."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1495610747, "last_edit_date": 1495610747, "creation_date": 1495610123, "answer_id": 44151465, "question_id": 44150571, "link": "https://stackoverflow.com/questions/44150571/how-to-combine-shapes-using-vba-excel/44151465#44151465", "title": "How to combine shapes using vba-excel?", "body": "<p>There is no possibility to combine shapes in Excel. But here is an example how you can draw combined borders around your selections. This might be an option for you.</p>\n\n<p>So with the selection of your example we end up with this:<br>\n<a href=\"https://i.stack.imgur.com/a7BB5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a7BB5.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub DrawCombinedBordersOnly()\n    '''''split range\n    Dim s() As String\n    Dim txt As String\n    Dim i As Long\n\n    Dim rngOverlappings As Range\n\n    'Draw borders around all selected ranges\n    Selection.BorderAround LineStyle:=xlDot, Weight:=xlThin\n\n    s = Split(Selection.Address(False, False), \",\")\n\n    For i = LBound(s) To UBound(s)\n        Dim r As Range: Set r = Range(s(i))\n        Dim j As Long\n        For j = LBound(s) To UBound(s)\n            'find overlapping areas\n            If i &lt;&gt; j And Not Application.Intersect(r, Range(s(j))) Is Nothing Then\n                If rngOverlappings Is Nothing Then\n                    Set rngOverlappings = Application.Intersect(r, Range(s(j)))\n                Else\n                    Set rngOverlappings = Union(rngOverlappings, Application.Intersect(r, Range(s(j))))\n                End If\n            End If\n        Next j\n    Next i\n\n    ' remove borders from overlappings\n    If Not rngOverlappings Is Nothing Then\n        rngOverlappings.Borders.LineStyle = xlNone\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9339858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf214ceebb213698661aabedf386afbf?s=128&d=identicon&r=PG&f=1", "display_name": "Fahad Al-Dossary", "link": "https://stackoverflow.com/users/9339858/fahad-al-dossary"}, "is_accepted": false, "score": 0, "last_activity_date": 1558700459, "last_edit_date": 1558700459, "creation_date": 1558611876, "answer_id": 56274508, "question_id": 44150571, "link": "https://stackoverflow.com/questions/44150571/how-to-combine-shapes-using-vba-excel/56274508#56274508", "title": "How to combine shapes using vba-excel?", "body": "<p>Try This and remove  apostrophe '  before <strong>'</strong> Range(\"D5:F9,F8:H12,H11:J15\").Select 'for test</p>\n\n<pre><code>Sub cohabitationButton_Click()\n    '''''split range\n    Dim WB As Workbook\n    Dim WS As Worksheet\n     Dim s() As String\n    Dim txt As String\n    Dim i As Long\n    Dim Shp As Shape\n    Dim L  As Single, T  As Single, Lft As Single, Tp As Single\n    Set WB = ThisWorkbook 'Set WB = Workbooks(\"WorkbookName\")\n    Set WS = WB.ActiveSheet 'Set WS = WB.WorkSheets(\"WorkSheetName\")\n\n With WS\n    For Each Shp In .Shapes\n    If Shp.Type = 5 Then Shp.Delete\n    Next\n\n   ' Range(\"D5:F9,F8:H12,H11:J15\").Select 'for test***\nMyRange = Selection.Address\n    s = Split(Selection.Address(False, False), \",\")\n    Dim Names(1 To 100) As Variant\n\n    For i = LBound(s) To UBound(s)\n        Dim r As Range: Set r = Range(s(i))\n        With r\n            L = .Left - 5\n            T = .Top - 5\n            w = .Width + 10\n            h = .Height + 10\n            If i = LBound(s) Then\n            Lft = L\n            Tp = T\n            End If\n            If Lft &gt; L Then Lft = L\n            If Tp &gt; T Then Tp = T\n        End With\n        ShapeName = \"ex\"\n\n        With .Shapes.AddShape(msoShapeFlowchartTerminator, L, T, w, h)\n            .Fill.Visible = msoFalse\n            .Line.Weight = 1\n            .Line.DashStyle = msoLineDash\n            .Line.ForeColor.RGB = BASICCOLOR\n            .Name = Replace(.Name, \"Flowchart: Terminator\", ShapeName)\n            Names(i + 1) = .Name\n\n        End With\n    Next i\n    .Activate\n    .Shapes.Range(Names).Select\n\n        Selection.Cut\n         Call MangeCombinePPTFromExcel(WS, Lft, Tp)\n.Range(MyRange).Select\n\nEnd With 'WS\n\nEnd Sub\n\nPublic Sub MangeCombinePPTFromExcel(WS As Worksheet, Lft As Single, Tp As Single)\n\nDim PPT As Object\nDim Pres As Object\nDim Sld As Object\nDim Shp As Shape, Rctangl As Shape, Rctangll As Shape, MergeShape As Shape\n\nSet PPT = CreateObject(\"Powerpoint.Application\")\nSet Pres = PPT.Presentations.Add\nSet Sld = Pres.Slides.Add(1, 12)\n PPT.Activate\n\n ShapeName = \"ex\"\n\n    With Sld\n        .Shapes.Paste.Select\n        On Error Resume Next\n         PPT.CommandBars.ExecuteMso (\"ShapesUnion\")\n        On Error GoTo 0\n         .Shapes(.Shapes.Count).Cut\n\n\n    End With\n            With WS 'back to Excel\n                .Paste\n                With .Shapes(.Shapes.Count)\n                .Name = ShapeName\n                    .Left = Lft\n                    .Top = Tp\n                End With\n            End With\n  PPT.Quit\nEnd Sub\n</code></pre>\n\n<p>Click to see Picture\n<a href=\"https://i.imgur.com/hMxtCkD.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}], "owner": {"reputation": 83, "user_id": 6741907, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a8e053353227fc6a87363f8892dce06?s=128&d=identicon&r=PG&f=1", "display_name": "natadecoco", "link": "https://stackoverflow.com/users/6741907/natadecoco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1130, "favorite_count": 0, "accepted_answer_id": 44151465, "answer_count": 2, "score": 0, "last_activity_date": 1558700459, "creation_date": 1495607406, "last_edit_date": 1495608236, "question_id": 44150571, "link": "https://stackoverflow.com/questions/44150571/how-to-combine-shapes-using-vba-excel", "title": "How to combine shapes using vba-excel?", "body": "<p>I want to combine shapes based on range selection. Like this picture. Is it possible?\nHere I attached the images:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4eM8j.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4eM8j.jpg\" alt=\"combine picture\"></a>\nHere I attached my code</p>\n\n<pre><code>Sub cohabitationButton_Click()\n    '''''split range\n    Dim s() As String\n    Dim txt As String\n    Dim i As Long\n\n    s = Split(Selection.Address(False, False), \",\")    \n\n    For i = LBound(s) To UBound(s)\n        Dim r As range: Set r = range(s(i))\n        With r\n            l = .Left - 5\n            t = .Top - 5\n            w = .Width + 10\n            h = .Height + 10\n        End With\n        ShapeName = \"ex\"\n\n        With ActiveSheet.Shapes.AddShape(msoShapeFlowchartTerminator, l, t, w, h)\n            .Fill.Visible = msoFalse\n            .Line.Weight = 1\n            .Line.DashStyle = msoLineDash\n            .Line.ForeColor.RGB = BASICCOLOR\n            .Name = ShapeName\n        End With  \n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "text"], "comments": [{"owner": {"reputation": 182, "user_id": 8023405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628b17284783fbc6aa4abf9e2485ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "Zedee.Chen", "link": "https://stackoverflow.com/users/8023405/zedee-chen"}, "edited": false, "score": 0, "creation_date": 1495606167, "post_id": 44150116, "comment_id": 75317510, "body": "Maybe you should post your code first, so others could try to figure what the problem is.  Anyway the source file is hard to analyze as it&#39;s not following any program format.  (e.g. are all the fields separated by tabs?)"}, {"owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "reply_to_user": {"reputation": 182, "user_id": 8023405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628b17284783fbc6aa4abf9e2485ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "Zedee.Chen", "link": "https://stackoverflow.com/users/8023405/zedee-chen"}, "edited": false, "score": 0, "creation_date": 1495606513, "post_id": 44150116, "comment_id": 75317673, "body": "My code is very useless, I&#39;ve done it by recording a macro and opening one of the text files, after that copying and pasting cells. This is my main problem. My source file is not following any program format. I tried to do that by opening text files in excel and changing positions of cells. But there are more than 4000 text files so It is hard to open all of them in excel."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495607073, "post_id": 44150116, "comment_id": 75317937, "body": "Is your posted text file the <i>actual file</i> or have you generalized the content? Are all files formatted exactly the same with the same number of fields ? Can you post an example file somewhere where it can be downloaded ?"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1495607422, "post_id": 44150116, "comment_id": 75318152, "body": "If text files are TAB delimited then u can split the text into column at each TAB using text to column option...please check this link for vba solution <a href=\"https://stackoverflow.com/a/37843318/7889129\">link</a>"}, {"owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495608020, "post_id": 44150116, "comment_id": 75318484, "body": "I generalized the content.  <a href=\"https://www.dropbox.com/s/33p6xwtpblzpdm6/sample.txt?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/33p6xwtpblzpdm6/sample.txt?dl=0</a> here is the link of my file. @Tim Williams"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495608876, "post_id": 44150116, "comment_id": 75318967, "body": "OK - this will not be a very simple task to do reliably, and would be more or less difficult depending on the variability/consistency in your files.  If you&#39;re not that familiar with coding then I&#39;d consider hiring someone for the task."}, {"owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495608993, "post_id": 44150116, "comment_id": 75319057, "body": "I am familiar with coding but not with vba. Do you have any suggestion about how can I start? @Tim Williams"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495609324, "post_id": 44150116, "comment_id": 75319246, "body": "Start with how to read a text file line-by-line in VBA - you can use either the &quot;built-in&quot; methods, or some people find the <code>FileSystemObject</code> methods easier to work with. Then you can use methods like <code>Split()</code> and <code>Instr()</code> to find the pieces of the content you need, based on the location of &quot;known&quot; content (such as &quot;Feature1&quot;, &quot;Feature2&quot; etc)"}, {"owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495609770, "post_id": 44150116, "comment_id": 75319528, "body": "Can you share a sample code that I can start with? @Tim Williams"}, {"owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495612089, "post_id": 44150116, "comment_id": 75321197, "body": "Also, I need to read a lot of text files line by line, not one file. How can I read them line by line with FileSystemObject method? @TimWilliams"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1495613745, "post_id": 44150116, "comment_id": 75322310, "body": "it might be easier to do this with Power Query than with VBA. But either way, there will be a learning curve. This is not a free code writing service, so you&#39;ll need to make your own start and post a question when you are stuck on a specific problem, not the general approach. You should work out the general approach yourself. On paper, with words. Then translate that into the coding language."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1495619192, "post_id": 44150116, "comment_id": 75326115, "body": "<i>How can I read them line by line</i>  Go through the documentation for the FileSystemObject and that method will be presented, along with others."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495649523, "post_id": 44150116, "comment_id": 75347883, "body": "&quot;I need to read a lot of text files line by line, not one file&quot; - if you can read one file, you can read many files (assuming they all follow the same pattern).  The main challenge here is to figure out that first file ;-)"}], "owner": {"reputation": 81, "user_id": 7579026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec43307d8c70dea985dbdfde9121306d?s=128&d=identicon&r=PG&f=1", "display_name": "OykuA", "link": "https://stackoverflow.com/users/7579026/oykua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495605615, "creation_date": 1495605615, "question_id": 44150116, "link": "https://stackoverflow.com/questions/44150116/importing-some-parts-of-a-lot-of-text-files-to-excel-with-vba", "title": "Importing some parts of a lot of text files to excel with VBA", "body": "<p>I am new to VBA so I need your advices. I need to read data from a lot of text files into excel. Text files are like that: <a href=\"https://i.stack.imgur.com/gW0fl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gW0fl.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I have to do is, I need to read every files' all Feature types and parametres actual values. The format of excel should be like that:<a href=\"https://i.stack.imgur.com/TUyRE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TUyRE.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried some codes by adapting to my situation but I couldn't do. Do you have an advice about how can I do that? Any advice is appreciated.</p>\n"}, {"tags": ["vba", "shell", "outlook"], "comments": [{"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 1, "creation_date": 1495615293, "post_id": 44149929, "comment_id": 75323368, "body": "Can you please describe a bit more exact what you want? What is not working?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1495615316, "post_id": 44149929, "comment_id": 75323380, "body": "(1) Where do you want to pass the message from?  Who or what knows that No emails are to be forwarded?  (2) Why aren&#39;t you using VBA&#39;s MsgBox to display the message?  You may have a good reason but it is not obvious from your question."}, {"owner": {"reputation": 15, "user_id": 8057358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c589358e2e903a7c8af6e8b0a60394?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnie fanto", "link": "https://stackoverflow.com/users/8057358/johnnie-fanto"}, "edited": false, "score": 0, "creation_date": 1495933344, "post_id": 44149929, "comment_id": 75456239, "body": "2. I will be setting up the macro to run every ten minutes and want a pop up to tell the user that the macro is running if they happen to be working in outlook at the time."}, {"owner": {"reputation": 15, "user_id": 8057358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c589358e2e903a7c8af6e8b0a60394?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnie fanto", "link": "https://stackoverflow.com/users/8057358/johnnie-fanto"}, "edited": false, "score": 0, "creation_date": 1495933573, "post_id": 44149929, "comment_id": 75456272, "body": "1. If I was using a normal message box then Msgbox aMessageLabel would give me a pop up reading &quot;No Emails to be Forwarded&quot;, however when I run the above code the pop up is blank."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8057358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c589358e2e903a7c8af6e8b0a60394?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnie fanto", "link": "https://stackoverflow.com/users/8057358/johnnie-fanto"}, "edited": false, "score": 0, "creation_date": 1499232975, "post_id": 44837192, "comment_id": 76811363, "body": "I have update my macro and the popup are appearing and disappearing with the relevant text, thanks for your help!"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1499276582, "last_edit_date": 1499276582, "creation_date": 1498785346, "answer_id": 44837192, "question_id": 44149929, "link": "https://stackoverflow.com/questions/44149929/outlook-pass-variable-to-be-displayed-in-temporary-popup/44837192#44837192", "title": "Outlook - Pass variable to be displayed in temporary Popup", "body": "<p>this works </p>\n\n<pre><code>Sub Test()\n\n    ' this is the resulting windows command (you can run at command prompt)\n    ' mshta.exe vbscript:close(CreateObject(\"WScript.shell\").Popup(\"No Emails to be Forwarded!\",5,\"Message\"))\n    ' the \"5\" is number of seconds that the popup message will live\n\n    Dim aShell\n    Set aShell = CreateObject(\"WScript.Shell\")\n\n    aMessageLabel = \"No Emails to be Forwarded!\"\n\n    Dim cmd As String\n\n    ' multiline\n    cmd = \"mshta.exe vbscript:close(CreateObject(\"\"WScript.shell\"\").Popup(\"\"\"\n    cmd = cmd &amp; aMessageLabel\n    cmd = cmd &amp; \"\"\",5,\"\"Message\"\"))\"\n    Debug.Print cmd\n    aShell.Run cmd\n\n    ' one line\n    aShell.Run \"mshta.exe vbscript:close(CreateObject(\"\"WScript.shell\"\").Popup(\"\"\" &amp; aMessageLabel &amp; \"\"\",5,\"\"Message\"\"))\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8057358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c589358e2e903a7c8af6e8b0a60394?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnie fanto", "link": "https://stackoverflow.com/users/8057358/johnnie-fanto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 44837192, "answer_count": 1, "score": 0, "last_activity_date": 1593387553, "creation_date": 1495604772, "last_edit_date": 1593387553, "question_id": 44149929, "link": "https://stackoverflow.com/questions/44149929/outlook-pass-variable-to-be-displayed-in-temporary-popup", "title": "Outlook - Pass variable to be displayed in temporary Popup", "body": "<p>In Outlook I have setup the following code to temporarily display a message. </p>\n\n<p>However I cannot work out how to pass a variable (<code>aMessageLabel</code>) containing the text to be displayed.</p>\n\n<pre><code>Sub Test()\n\n    Dim aShell\n\n    Set aShell = CreateObject(\"WScript.Shell\")\n\n    aMessageLabel = Chr(34) &amp; \"No Emails to be Forwarded!\" &amp; Chr(34)\n\n    aShell.Run \"mshta.exe vbscript:close(CreateObject(\"\"WScript.shell\"\").Popup(aMessageLabel,5,\"\"Message\"\"))\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "sum", "vba"], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": true, "score": 1, "last_activity_date": 1495600689, "creation_date": 1495600689, "answer_id": 44149090, "question_id": 44148995, "link": "https://stackoverflow.com/questions/44148995/excel-sumproduct-with-if-statement-in-a-cell/44149090#44149090", "title": "Excel SumProduct with if Statement in a cell.", "body": "<p>You can simply use <code>=SUMIF()</code> formula to get sum of these numbers for a special name. </p>\n\n<pre><code>=SUMIF($A$1:$B$64,A1,$B$1:$B$64)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=SUMIF($A$1:$B$64,\"kiwi\",$B$1:$B$64)\n</code></pre>\n\n<p>You can change these ranges based on your list. (You can even define dynamic name in <code>Name Manager</code> and then you can use that <strong>Name</strong> <em>as your range</em>.)</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8055378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/POpYr.jpg?s=128&g=1", "display_name": "Simplicissimus", "link": "https://stackoverflow.com/users/8055378/simplicissimus"}, "is_accepted": false, "score": 1, "last_activity_date": 1495609777, "creation_date": 1495609777, "answer_id": 44151325, "question_id": 44148995, "link": "https://stackoverflow.com/questions/44148995/excel-sumproduct-with-if-statement-in-a-cell/44151325#44151325", "title": "Excel SumProduct with if Statement in a cell.", "body": "<p>It's not the fact that your cell is calculated (contains a formula), it's because the result of the formula is a text.</p>\n\n<p>Maybe you could use \u00e0 0 instead of the 0-length text and apply conditional formatting to your cells (font colour white if 0 value)</p>\n\n<pre><code>    =if(A64=\"\", 0, 12)\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6457870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d11163655449372f5262226b591583b?s=128&d=identicon&r=PG&f=1", "display_name": "user6457870", "link": "https://stackoverflow.com/users/6457870/user6457870"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 44149090, "answer_count": 2, "score": 1, "last_activity_date": 1495609777, "creation_date": 1495600049, "last_edit_date": 1531161705, "question_id": 44148995, "link": "https://stackoverflow.com/questions/44148995/excel-sumproduct-with-if-statement-in-a-cell", "title": "Excel SumProduct with if Statement in a cell.", "body": "<p>I have a basic problem in Excel. I have a row with names and one with numbers. I try to find what is the sum of these numbers for a special name. </p>\n\n<p>ex.    </p>\n\n<pre><code> A        B\nApple     12\nApple     12\nKiwi      9 \nApple     4\nBanana    51\nKiwi      12\nBanana    4 \nKiwi      \n</code></pre>\n\n<p>So far I just use a basic sumproduct which works well. Like </p>\n\n<pre><code>=Sumproduct((A1:A8=A1)*(B1:B8)\nThis formula gives me back my total number of Apples\n(12+12+4). \n</code></pre>\n\n<p>The problem is, if a cell contain some formula, then I have #VALUE! result. \nLet say the last cell called Kiwi contain a code like</p>\n\n<pre><code>=if(A64=\"\", \"\", 12) \nThen it makes Kiwi empty if A64 is empty. Great.\n</code></pre>\n\n<p>But sumproduct don't work anymore. </p>\n\n<p>I can't sort the name... any ideas? </p>\n\n<p>Thank you </p>\n"}]