[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1531353035, "post_id": 51295515, "comment_id": 89568656, "body": "Is CentralReg the codename of a worksheet in that workbook?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10067350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fffe9dedbc3768fd9c343cc2c101cf72?s=128&d=identicon&r=PG&f=1", "display_name": "Nickvi1", "link": "https://stackoverflow.com/users/10067350/nickvi1"}, "edited": false, "score": 0, "creation_date": 1531383401, "post_id": 51295737, "comment_id": 89577864, "body": "Thank you so much urdearboy, with the exception of a couple of sheet name changes to make things clearer and stop excel getting confused, that worked perfectly and gives me valuable insight into how I should be looking to code in the future. You were correct CentralReg is a worksheet and your assumption that I wanted the vale from &quot;B27&quot; in to the offset cell was also correct."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1531355594, "last_edit_date": 1531355594, "creation_date": 1531354649, "answer_id": 51295737, "question_id": 51295515, "link": "https://stackoverflow.com/questions/51295515/why-does-my-vba-code-that-works-in-module-not-work-as-expected-when-assigned-to/51295737#51295737", "title": "why does my VBA code that works in module not work as expected when assigned to a worksheet and a button", "body": "<p>I believe you are trying to refer to <code>CentralReg</code> which is a worksheet, which means you should qualify it as such. </p>\n\n<p>Also, you should not dim variables that are similar to defined objects/properties in VBE. Try <code>MyCell</code> instead of <code>cell</code> (good practice, <em>not required</em>).  </p>\n\n<p>I am assuming you want to see if the value on sheet <code>CentralReg</code> in <code>Column A</code> is equal to sheet <code>Result</code> <code>B2</code>. If this condition is met, your <code>MyCell</code> will take on the value equal sheet <code>Result</code> <code>B27</code></p>\n\n<hr>\n\n<pre><code>Dim MyCell As Range\nDim Result, NewValue as Variant\nResult = ThisWorkbook.Sheets(\"Result\").Range(\"B2\")\nNewValue = ThisWorkbook.Sheets(\"Result\").Range(\"B27\")\n\nWith ThisWorkbook.Sheets(\"CentralReg\")\n    For Each MyCell In .Range(\"A2:A250\")\n        If MyCell = Result Then MyCell.Offset(, 4) = NewValue\n    Next MyCell\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1531355299, "creation_date": 1531355299, "answer_id": 51295806, "question_id": 51295515, "link": "https://stackoverflow.com/questions/51295515/why-does-my-vba-code-that-works-in-module-not-work-as-expected-when-assigned-to/51295806#51295806", "title": "why does my VBA code that works in module not work as expected when assigned to a worksheet and a button", "body": "<p>That with statement is useless as nothing actually uses it within the construct.</p>\n\n<p>Delete <code>with CentralReg</code> and <code>End with</code> and it will work.</p>\n\n<p>alternatively if CentralReg IS something like a sheet then you need to precede your code with a <code>.</code> so this: <code>Range(\"A2:A250\")</code> becomes this: <code>.Range(\"A2:A250\")</code> and so on, the <code>.</code> tells the code that it is related to whatever your <code>with</code> construct surrounds</p>\n"}], "owner": {"reputation": 3, "user_id": 10067350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fffe9dedbc3768fd9c343cc2c101cf72?s=128&d=identicon&r=PG&f=1", "display_name": "Nickvi1", "link": "https://stackoverflow.com/users/10067350/nickvi1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51295737, "answer_count": 2, "score": 0, "last_activity_date": 1531355594, "creation_date": 1531352381, "last_edit_date": 1531354602, "question_id": 51295515, "link": "https://stackoverflow.com/questions/51295515/why-does-my-vba-code-that-works-in-module-not-work-as-expected-when-assigned-to", "title": "why does my VBA code that works in module not work as expected when assigned to a worksheet and a button", "body": "<p>I have a workbook that is essentially an automated test, marking and feedback tool for end of topic tests for students. On the '701Test' sheetThey input their teaching group via a drop down list and the select their from subsequent list. They answer the multiple choice questions and press a button when finished. The button takes them to a 'results' page which gives their marks for each question, give feedback for incorrect answers and gives a total score. They then hit the finish button which generates a PDF copy of the mark sheet in their my documents folder and then emails a copy to themselves and the Schools email account. At this point I also wanted to post the final score to the students record on a central registry using a loop through the student list to find the name and offset to post the Score value from the 'Results' page and finally return to the test page. This last bit I wrote the code for in a module and it executes perfectly, but when added to the main code and run from the button the loop part fails to execute but the return to the test page does work, but no error is recorded for the loop failure.</p>\n\n<p>Here is the 'Results' page code in full the 'With Central reg' bit at the bottom is the problem, any help is greatly appreciated.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Dim IsCreated As Boolean\n  Dim PdfFile As String, Title As String\n  Dim OutlApp As Object\n  Dim cell As Range\n  Dim Students As Range\n\n  Title = Range(\"D1\").Value\n  sname = Range(\"B2\").Value\n  PdfFile = CreateObject(\"WScript.Shell\").SpecialFolders(\"MyDocuments\") &amp; \"\\\" &amp; sname &amp; Title &amp; \".pdf\"\n\n\n  With ActiveSheet\n    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n  End With\n\n  On Error Resume Next\n  Set OutlApp = GetObject(, \"Outlook.Application\")\n  If Err Then\n    Set OutlApp = CreateObject(\"Outlook.Application\")\n    IsCreated = True\n  End If\n  OutlApp.Visible = True\n  On Error GoTo 0\n\n  With OutlApp.CreateItem(0)\n\n    .Subject = Title\n    .to = Range(\"B2\").Value  ' &lt;-- Put email of the recipient here\"\n    .CC = \"\" ' &lt;-- Put email of 'copy to' recipient here\n    .Body = \"Hi,\" &amp; vbLf &amp; vbLf _\n          &amp; \"Yr 7 701 EOT test attached in PDF format.\" &amp; vbLf &amp; vbLf _\n          &amp; \"Regards,\" &amp; vbLf _\n          &amp; \"KDS ICT Dept\" &amp; vbLf &amp; vbLf\n    .Attachments.Add PdfFile\n\n    Application.Visible = True\n    .Display\n  End With\n\n  If IsCreated Then OutlApp.Quit\n\n  Set OutlApp = Nothing\n\n\n  With CentralReg\n\n\n    For Each cell In Range(\"A2:A250\")\n    If cell = Range(\"Results!B2\").Value Then\n    cell.Offset(0, 4).Activate\n    ActiveCell.Value = Range(\"Results!B27\").Value\n    End If\n    Next\n\n\nEnd With\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1531359574, "last_edit_date": 1531359574, "creation_date": 1531359246, "answer_id": 51296190, "question_id": 51295511, "link": "https://stackoverflow.com/questions/51295511/error-in-vba-for-powerpoint-when-trying-to-center-a-title424-object-required/51296190#51296190", "title": "Error in VBA for powerpoint when trying to center a title(424: object required)", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/shape-object-powerpoint\" rel=\"nofollow noreferrer\"><code>Shape</code></a> object has <a href=\"https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/shape-left-property-powerpoint\" rel=\"nofollow noreferrer\"><code>Left</code></a>, <a href=\"https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/shape-top-property-powerpoint\" rel=\"nofollow noreferrer\"><code>Top</code></a>, <a href=\"https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/shape-width-property-powerpoint\" rel=\"nofollow noreferrer\"><code>Width</code></a>, and <a href=\"https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/shape-height-property-powerpoint\" rel=\"nofollow noreferrer\"><code>Height</code></a> properties. <code>TextFrame</code>, <code>TextRange</code>, and <code>Text</code> are irrelevant in this case.</p>\n\n<pre><code>Option Explicit\n\nSub CenterTitle()\n    Dim myPresentation As Presentation: Set myPresentation = ActivePresentation\n\n    With myPresentation.Slides(1).Shapes(1)\n        .Left = (myPresentation.PageSetup.SlideWidth - .Width) / 2\n        .Top = (myPresentation.PageSetup.SlideHeight - .Height) / 2\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8233553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a97a7e0529d7ae1e9b74b40b9cb809?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Murthy", "link": "https://stackoverflow.com/users/8233553/varun-murthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 51296190, "answer_count": 1, "score": 0, "last_activity_date": 1531359574, "creation_date": 1531352333, "question_id": 51295511, "link": "https://stackoverflow.com/questions/51295511/error-in-vba-for-powerpoint-when-trying-to-center-a-title424-object-required", "title": "Error in VBA for powerpoint when trying to center a title(424: object required)", "body": "<pre><code>With myPresentation.Slides(index).Shapes(1).TextFrame.TextRange.Text\n        .Left = (ActivePresentation.PageSetup.SlideWidth - .Width) / 2\n        .Top = (ActivePresentation.PageSetup.SlideHeight - .Height) / 2\nEnd With\n</code></pre>\n\n<p>So basically I have a slide with a 1 title object and I am trying to format it to be centered, </p>\n\n<pre><code>.Left = (ActivePresentation.PageSetup.SlideWidth - .Width) / 2\n</code></pre>\n\n<p>but this line throws an object required error. Any help is appreciated</p>\n"}, {"tags": ["excel", "vba", "autosave"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531351098, "post_id": 51295360, "comment_id": 89568259, "body": "A &quot;database&quot;?  Or a &quot;workbook&quot;?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1531351149, "post_id": 51295360, "comment_id": 89568271, "body": "I&#39;m guessing other users don&#39;t have access to save to your folder on that network drive..."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1531351154, "post_id": 51295360, "comment_id": 89568274, "body": "If you&#39;re saving to &quot;...IanMartin\\Desktop\\Backup Files\\&quot; - are the other people using the program also having access to this directory?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531351253, "post_id": 51295360, "comment_id": 89568303, "body": "What&#39;s you code doing or not doing?  Try stepping through the code with F8 to see what&#39;s going on. More tips about <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">Debugging VBA here</a> and also , check out how to put together a <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>.."}, {"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "edited": false, "score": 0, "creation_date": 1531351488, "post_id": 51295360, "comment_id": 89568356, "body": "do you have roaming profiles in your network?...is that part of your own user account?  users arent going to have privileges to write to your profile folders"}, {"owner": {"reputation": 41, "user_id": 8072941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159d47831b6294b6c39480f79cff9b89?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Martin", "link": "https://stackoverflow.com/users/8072941/ian-martin"}, "edited": false, "score": 0, "creation_date": 1531355730, "post_id": 51295360, "comment_id": 89569144, "body": "The database is on a shared drive (I:). All staff have their own profile stored on drive U: All computers are linked via ThinClient Modems. When I am online the VBA code works in sending the backup from Drive I; to where my profile is based on Drive U: I know other staff have accessed the databases, but no backup file was created in my folder. I am trying to find a way to create a backup that will be placed in a drive where the other staff cannot accidently find it and delete it by mistake."}, {"owner": {"reputation": 41, "user_id": 8072941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159d47831b6294b6c39480f79cff9b89?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Martin", "link": "https://stackoverflow.com/users/8072941/ian-martin"}, "edited": false, "score": 0, "creation_date": 1531355949, "post_id": 51295360, "comment_id": 89569187, "body": "Ctznkane525, I believe you may very well be right, as we have roaming profiles that we can access from different locations. I have been told that we have a sharepoint site, would using this be a better way to safeguard the databases not being accidentally deleted?"}, {"owner": {"reputation": 1054, "user_id": 4496560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20182668dc86156a19fe0960ad09b244?s=128&d=identicon&r=PG", "display_name": "Gregor y", "link": "https://stackoverflow.com/users/4496560/gregor-y"}, "edited": false, "score": 0, "creation_date": 1531358896, "post_id": 51295360, "comment_id": 89569703, "body": "if 12 people have this work book open at the same time, then even in the ideal situation where all the users have access to the backup folder you&#39;re still going to be faced with the last person to save is the only backup you&#39;ll get... FYI: Office365 claims to have better multi-user controls kinda like google sheets."}, {"owner": {"reputation": 41, "user_id": 8072941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159d47831b6294b6c39480f79cff9b89?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Martin", "link": "https://stackoverflow.com/users/8072941/ian-martin"}, "edited": false, "score": 0, "creation_date": 1531370760, "post_id": 51295360, "comment_id": 89572013, "body": "As far as I am aware only one person at a time can access the database at a time. A message comes up that the database is locked by another user and you can only read the database. So a backup should be generated each time the database is closed. The corporation I work for hasn&#39;t provided Office365 as an option to choose. We are using Excel 2010, which isn&#39;t the most up to date version available."}], "owner": {"reputation": 41, "user_id": 8072941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159d47831b6294b6c39480f79cff9b89?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Martin", "link": "https://stackoverflow.com/users/8072941/ian-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554483190, "creation_date": 1531350846, "last_edit_date": 1554483190, "question_id": 51295360, "link": "https://stackoverflow.com/questions/51295360/backing-up-shared-database-to-drive-where-other-users-cannot-delete", "title": "Backing up shared database to drive where other users cannot delete", "body": "<p>I have been trying to automatically back up a database, that is on a shared drive, to a different drive every time it is accessed. I put together this code.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n 'Saves the current file to a backup folder and the default folder\n 'Note that any backup is overwritten\n     Application.DisplayAlerts = False\n     ActiveWorkbook.SaveCopyAs Filename:=\"\\\\pdc2cif004.onelondon.tfl.local\\vdm3_data1$\\IanMartin\\Desktop\\Backup Files\\\" &amp; _\n             ActiveWorkbook.Name\n     ActiveWorkbook.Save\n     Application.DisplayAlerts = True\n End Sub\n</code></pre>\n\n<p>This was placed in the worksheet as Before Save. The code works if I access the database, but it does not work if anyone else access the database.</p>\n\n<p>I know other staff have accessed the databases, but no backup file was created in my folder. I am trying to create a backup that will be placed in a drive where the other staff cannot accidentally find it and delete it by mistake.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531349572, "post_id": 51295144, "comment_id": 89567905, "body": "If you&#39;re drilling into a series of nested dictionaries or collections wouldn&#39;t each have to be referenced as an item of the parent like you are referencing item(key 0)?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531349728, "post_id": 51295144, "comment_id": 89567939, "body": "You should apply some context to your post.   I&#39;m assuming that <code>response</code> is <code>responseText</code> which is a JSON string converted by a library.  My answer to <a href=\"https://stackoverflow.com/a/51128453/9912714\">Using VBA and VBA-JSON to access JSON data from Wordpress API</a> would probably work."}, {"owner": {"reputation": 13, "user_id": 6074405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5d4dNJD0enw/AAAAAAAAAAI/AAAAAAAABJ0/EOUNYkr21cU/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/6074405/mark"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1531351030, "post_id": 51295144, "comment_id": 89568245, "body": "@TinMan I&#39;m not a VBA expert, so thanks for your patience.  I have tried: <code>ComID = response.Result.PartData.PartList.PartDto(1).ComID</code>  and <code>ComID = response.Result.PartData.PartList.PartDto.Keys()(1).ComID</code> and neither of those worked."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531351361, "post_id": 51295144, "comment_id": 89568327, "body": "@Jeeped asked that question. You should review my post.  What does <code>TypeName(response.Result.PartData.PartList.PartDto)</code>  return?"}, {"owner": {"reputation": 13, "user_id": 6074405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5d4dNJD0enw/AAAAAAAAAAI/AAAAAAAABJ0/EOUNYkr21cU/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/6074405/mark"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531351552, "post_id": 51295144, "comment_id": 89568372, "body": "@TinMan &quot;JScriptTypeInfo&quot;"}, {"owner": {"reputation": 13, "user_id": 6074405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5d4dNJD0enw/AAAAAAAAAAI/AAAAAAAABJ0/EOUNYkr21cU/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/6074405/mark"}, "edited": false, "score": 0, "creation_date": 1531351924, "post_id": 51295144, "comment_id": 89568453, "body": "Yeah, &#39;Set scriptControl = CreateObject(&quot;MSScriptControl.ScriptControl&quot;)     scriptControl.Language = &quot;JScript&quot;     Set Response = scriptControl.Eval(&quot;(&quot; + sRespText + &quot;)&quot;)&#39;"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531352258, "post_id": 51295144, "comment_id": 89568512, "body": "Working with the <code>JScriptTypeInfo</code> is a little tricky but I created a function that convert the JSON string into a usable object <a href=\"https://codereview.stackexchange.com/q/196482/171419\">Function to Return a JSON Like Objects Using VBA Collections and Arrays</a>."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531352473, "post_id": 51295144, "comment_id": 89568556, "body": "You should know that the <code>ScriptControl</code> is not supported by 64 bit systems. You should probably use the library from the first link that I posted in conjunction with my answer to that link."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531352880, "post_id": 51295144, "comment_id": 89568628, "body": "Make sure and use @TinMan to target your comments to me."}], "owner": {"reputation": 13, "user_id": 6074405, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5d4dNJD0enw/AAAAAAAAAAI/AAAAAAAABJ0/EOUNYkr21cU/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/6074405/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531349121, "creation_date": 1531349121, "question_id": 51295144, "link": "https://stackoverflow.com/questions/51295144/excel-vba-accessing-array", "title": "Excel VBA Accessing Array", "body": "<p>I can't seem to access an item 0:\n<a href=\"https://i.stack.imgur.com/XZhBN.png\" rel=\"nofollow noreferrer\">Watch Experession</a>\n.</p>\n\n<p>I have tried a number of different ways to access ComID, such as:</p>\n\n<pre><code> ComID = response.Result.PartData.PartList.PartDto.Item(0).ComID  OR\n ComID = response.Result.PartData.PartList.PartDto.(0).ComID      OR\n ComID = response.Result.PartData.PartList.PartDto.0.ComID\n</code></pre>\n\n<p>This works all the way up to PartDto, but I'm just struggling to access Item 0.</p>\n\n<p>My backup solution is to loop through each item in PartDto, which can work, but there's got to be a better way.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "vba", "loops", "for-loop"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1531358606, "post_id": 51294786, "comment_id": 89569647, "body": "What does the line <code>ActiveWorkbook.Close savechanges:=False</code> do within the loop when you already close the workbook earlier using <code>xTempWb.Close False</code>? Also I would replace <code>ActiveWorkbook.SaveAs</code> with <code>xTempWb.SaveAs</code>, because referencing active workbook is not reliable. If it doesn&#39;t help, please don&#39;t make us guess and state on which line the error appears."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1531377370, "last_edit_date": 1531377370, "creation_date": 1531376659, "answer_id": 51298597, "question_id": 51294786, "link": "https://stackoverflow.com/questions/51294786/convert-multiple-csv-files-to-tab-delimited/51298597#51298597", "title": "Convert multiple csv files to tab delimited", "body": "<p>You'd better not rely on any <em>active</em> object (<code>Workbook</code>, in this case) and reference a proper object instance, instead</p>\n\n<p>also, you should handle <code>Application.DisplayAlerts</code> by setting it to <code>False</code> <em>before</em> entering files loop and moving its setting back to <code>True</code> in the ExitHandler block and make sure you always set it should any error arise</p>\n\n<p>so I'd go as follows:</p>\n\n<pre><code>Sub sandbox2()\n\n    Dim xFilesToOpen As Variant\n    Dim i As Long\n    Dim xScreen As Boolean\n\n    On Error GoTo ErrHandler\n    xScreen = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n\n    xFilesToOpen = Application.GetOpenFilename(\"Text Files (*.*), *.*\", , , , True)\n    xDelimiter = Application.InputBox(\"Delimiter: \", , \",\")\n\n    If TypeName(xFilesToOpen) = \"Boolean\" Then\n        MsgBox \"No files were selected\", , \"Sorry dude\"\n    Else\n        Application.DisplayAlerts = False ' set it to 'False' only once before entering the loop\n        For i = 1 To UBound(xFilesToOpen)\n            With Workbooks.Open(xFilesToOpen(i)) ' open a workbook with current name and reference it\n                .SaveAs Filename:=Replace(.FullName, \".csv\", \"\") + \".txt\", FileFormat:=xlText, CreateBackup:=False ' act on referenced workbook properties\n                .Close False ' close referenced workbook\n            End With\n        Next i\n    End If\n\nExitHandler:\n    Application.DisplayAlerts = True ' be sure to set it back to 'True' should any error take you out of your loop\n    Application.ScreenUpdating = xScreen\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, , \"error\"\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n\n<p>please note I  got rid of</p>\n\n<pre><code>Dim xTempWb As Workbook ' no longer used\n\nDim xWb As Workbook ' never used\n....\nSet xWb = Nothing ' never set\n\nDim xDelimiter As String ' never used\n....\nxDelimiter = Application.InputBox(\"Delimiter: \", , \",\") ' never used\n</code></pre>\n\n<p>and used <code>Dim i as Long</code>, as a general rule not to incur in any overflow error since an integers can reach up to some <a href=\"https://stackoverflow.com/questions/10558540/vba-macro-crashes-after-32000-rows\">32000 value or so</a></p>\n"}], "owner": {"reputation": 47, "user_id": 8120930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65e6a60398ac8e46b6c898f08b1fdae6?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/8120930/matt-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 51298597, "answer_count": 1, "score": 0, "last_activity_date": 1575841266, "creation_date": 1531346602, "last_edit_date": 1575841266, "question_id": 51294786, "link": "https://stackoverflow.com/questions/51294786/convert-multiple-csv-files-to-tab-delimited", "title": "Convert multiple csv files to tab delimited", "body": "<p>I need to save a selection of <em>.csv</em> files, under the same name, as <em>tab delimited</em> files.</p>\n\n<p>I have the following code to select the files, specify the delimiter, and then iterate through the files, opening and saving them one by one.</p>\n\n<p>The issue is the iteration.</p>\n\n<pre><code>Sub sandbox2()\n\n    Dim xFilesToOpen As Variant\n    Dim i As Integer\n    Dim xWb As Workbook\n    Dim xTempWb As Workbook\n    Dim xDelimiter As String\n    Dim xScreen As Boolean\n    Dim strFileFullName As String\n\n    On Error GoTo ErrHandler\n    xScreen = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n\n    xFilesToOpen = Application.GetOpenFilename(\"Text Files (*.*), *.*\", , , , True)\n    xDelimiter = Application.InputBox(\"Delimiter: \", , \",\")\n\n    If TypeName(xFilesToOpen) = \"Boolean\" Then\n        MsgBox \"No files were selected\", , \"Sorry dude\"\n        GoTo ExitHandler\n    End If\n\n    For i = 1 To UBound(xFilesToOpen)\n        Set xTempWb = Workbooks.Open(xFilesToOpen(i))\n        strFileFullName = Replace(ActiveWorkbook.FullName, \".csv\", \"\")\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs Filename:=strFileFullName + \".txt\", FileFormat:=xlText, CreateBackup:=False\n        xTempWb.Close False\n        Application.DisplayAlerts = True\n        ActiveWorkbook.Close savechanges:=False\n        Set xTempWb = Nothing\n    Next i\n\nExitHandler:\n    Application.ScreenUpdating = xScreen\n    Set xWb = Nothing\n    Set xTempWb = Nothing\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, , \"error\"\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n\n<p>This code will work for the first file, but then I get the error</p>\n\n<blockquote>\n  <p>\"Object variable or With block variable not set\"</p>\n</blockquote>\n\n<p>When looking at the folder, the first file is saved as a <em>.txt</em> file, but only the first.</p>\n"}, {"tags": ["excel", "vba", "variables", "integer", "save"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1531346139, "post_id": 51294642, "comment_id": 89566947, "body": "Seeing more code would probably help here. Cannot see how (if) you qualified your ranges, among other things ~"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531346328, "post_id": 51294642, "comment_id": 89567016, "body": "You need to post your actual code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531346432, "post_id": 51294642, "comment_id": 89567054, "body": "You stated <i>&#39;irow_Sheet1 available as constant&#39;</i> then wondered*&#39;c1.Row-1&quot; simply doesn&#39;t get saved in iRowYear variable&#39;*. Well, which is it? Is iRowYear  a constant or a variable? You cannot reassign a public constant."}, {"owner": {"reputation": 31, "user_id": 7575899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e1e89585b45c268ee1cc3a1464c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Qudsia", "link": "https://stackoverflow.com/users/7575899/qudsia"}, "edited": false, "score": 0, "creation_date": 1531403109, "post_id": 51294642, "comment_id": 89591239, "body": "Sorry, didn&#39;t paste code because it&#39;s a lot of code with three calls before this point...and I&#39;ve simplified the variables names for here. Here&#39;s where the range is declared:"}, {"owner": {"reputation": 31, "user_id": 7575899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e1e89585b45c268ee1cc3a1464c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Qudsia", "link": "https://stackoverflow.com/users/7575899/qudsia"}, "edited": false, "score": 0, "creation_date": 1531406027, "post_id": 51294642, "comment_id": 89593314, "body": "I&#39;ve added some additional info and For statement for the range"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7575899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e1e89585b45c268ee1cc3a1464c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Qudsia", "link": "https://stackoverflow.com/users/7575899/qudsia"}, "is_accepted": false, "score": 0, "last_activity_date": 1531943834, "last_edit_date": 1531943834, "creation_date": 1531930252, "answer_id": 51406609, "question_id": 51294642, "link": "https://stackoverflow.com/questions/51294642/excel-vba-variable-declared-as-integer-not-saving-integer-value-runtime-error/51406609#51406609", "title": "Excel VBA - Variable declared as integer not saving integer value (Runtime error 1004)", "body": "<p>Issue solved by modifying \"If\" statement.<br>\nIn my actual code I was assigning value to two variables in If statement:  </p>\n\n<pre><code>If bSheet2 = True Then iRowYear = (c1.Row-2) AND (iRowMonth=c1.Row-1)\n</code></pre>\n\n<p>I stupidly omitted iRowMonth in my question to save time. \nCode seems to be running fine after I changed the If statement to:  </p>\n\n<pre><code>If bSheet2 = True Then  \n    iRowYear = c1.Row-2  \n    iRowMonth = c1.Row-1  \nEnd If\n</code></pre>\n\n<p>Still a little baffled since there were times the code still ran okay for Sheet1.</p>\n\n<p>Thanks to all for input, and I apologize for the incomplete question.</p>\n"}], "owner": {"reputation": 31, "user_id": 7575899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e1e89585b45c268ee1cc3a1464c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Qudsia", "link": "https://stackoverflow.com/users/7575899/qudsia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531943834, "creation_date": 1531345724, "last_edit_date": 1531405863, "question_id": 51294642, "link": "https://stackoverflow.com/questions/51294642/excel-vba-variable-declared-as-integer-not-saving-integer-value-runtime-error", "title": "Excel VBA - Variable declared as integer not saving integer value (Runtime error 1004)", "body": "<p>I've been trying to debug for hours getting Run-Time error '1004': Application-defined or object-defined error. I've located what causes the error I think, can't figure out reason.  </p>\n\n<p>I'm processing two sheets with same code.<br>\nbSheet1 = True  'if code is run from sheet1)<br>\nbSheet2 = True  'if code is run from sheet2)  </p>\n\n<p>both Boolean variables are given initial value of False.  </p>\n\n<p>If bSheet1 = True then iRowYear = iRowYear_Sheet1  'assigned value earlier in code, irowYear_Sheet1 =4<br>\nif bSheet2 = True then iRowYear = c1.Row-2       </p>\n\n<p>iRowYear is declared as an integer like regular variable. It will be the same row# for Sheet1. I have declared iRowYear_Sheet1 as an integer and assigned it value of 4 (\"iRowYear_Sheet1=4) earlier in code.\n\"c1\" is cell range, declared as range. code uses it to loop through each cell from first project name to last.<br>\nYear is always two rows above project name in Sheet2.  </p>\n\n<p>The calculations and Boolean values all show correctly when debugging...row number shows correctly when I hover over \"c1.Row-1\" but iRowYear keeps on showing \"0\". Although the \"If\" statement holds true and code is read when stepping through.  </p>\n\n<p>The code works fine when processing Sheet1, but for sheet two, the calculated value \"c1.Row-1\" simply doesn't get saved in iRowYear variable, and error is thrown later in the code.  </p>\n\n<p>There are times, usually the first run or so when it actually processes data for Sheet2, but randomly gets stuck, and once stuck it continues to throw error, each time indicating iRowYear is \"0\".  </p>\n\n<p>----------Additional info------------\nThere's a lot of code with various Calls so can't paste everything...I'm also simplifying variable names here. Here's where the immediate loop starts. Code goes on to close the loops and ends If statements...and it runs fine for sheet1. It's for Sheet2 where there is error on the last statement below. Randomly the error sometimes occurs later in the code for same variable (iRowYear) showing as zero:</p>\n\n<p>Option Explicit</p>\n\n<p>Global c1 as range<br>\nGlobal iRowYear As Integer<br>\nGlobal Const iRowYear_Sheet1 = 4  'Row# same for sheet1, varies for sheet2  </p>\n\n<p>.....\n'There are loops and conditions before this...only pasting start of immediate loop...loops and conditions working ok</p>\n\n<p>For Each c1 In wsSchedule.Range(Cells(iRowFirst, iCol_Status), Cells(iRowLast, iCol_Status))</p>\n\n<p>If c1.Value2 = \"GO\" Then</p>\n\n<pre><code>    If bSheet1 = True Then iRowYear = iRowYear_Sheet1    \n    If bSheet2 = True Then iRowYear = (c1.Row - 2)    \n\n    iColLast = wsSchedule.Cells(iRowYear, 130).End(xlToLeft).Column    \n</code></pre>\n\n<p>'etc...  </p>\n\n<p>Error on last line showing iRowYear as zero, even though \"c1.Row-2\" showing correct integer value with mouseover. bSheet1 is showing false and bSheet2 is showing True with mouseover. Code steps through correctly but iRowYear is not storing the output of \"c1.Row-2\"...it remains zero.</p>\n"}, {"tags": ["vba", "select", "range"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531345491, "post_id": 51294576, "comment_id": 89566705, "body": "what do you mean you <code>can not pass the selected range to VBA</code>  Can you share the code in which you tried?"}, {"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1531345513, "post_id": 51294576, "comment_id": 89566714, "body": "Can you give any example of your current code and data ?"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531345940, "post_id": 51294576, "comment_id": 89566877, "body": "For example i select a group of cells, let say &quot;B3:J10&quot; and i need to format all with borders and color, and i want to make it running a macro."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531346083, "post_id": 51294576, "comment_id": 89566918, "body": "The use <code>With Selection</code> and do the things you want with that selection and finish with <code>End With</code>"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531346167, "post_id": 51294576, "comment_id": 89566955, "body": "Sub Macro2()     a = ActiveCell.CurrentRegion.Address End Sub"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531346434, "post_id": 51294576, "comment_id": 89567056, "body": "The last Active.currentRegion do not work properly, I will trie with your sujection thank Scott"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531346488, "post_id": 51294576, "comment_id": 89567075, "body": "Can you send me an example?"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531346622, "post_id": 51294576, "comment_id": 89567120, "body": "Remember the macro do not know the range, it have to be read from the Spreadsheet"}, {"owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "edited": false, "score": 0, "creation_date": 1531347172, "post_id": 51294576, "comment_id": 89567271, "body": "when I use A= Active.cell.address I get the adrress of the selected cell but not the range,                                                                                                                  when I use A=  ActiveCell.CurrentRegion.Address I get a range that do not correspond with the selected one."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1531347147, "last_edit_date": 1531347147, "creation_date": 1531346639, "answer_id": 51294793, "question_id": 51294576, "link": "https://stackoverflow.com/questions/51294576/passing-the-previosly-selected-range-cells-in-a-spreasheet-to-vba-focus-to-work/51294793#51294793", "title": "Passing the previosly selected range cells in a spreasheet to VBA focus to work with", "body": "<p>The first sub will show you the range you have selected, although I do not think you need to know the range (it is already selected) so the bottom two subs should be of more interest to you. </p>\n\n<p>You can make changes to your selection using either method. (<code>With</code> block or directly qualified ranges)</p>\n\n<pre><code>Sub ShowRange()\n\nMsgBox (Selection.Address(False, False))\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Notice that the <code>With</code> block will qualify every format with a range</p>\n\n<pre><code>Sub Method1()\n\nWith Selection\n    .Font.Size = 16\n    .Interior.Color = RGB(255, 0, 0)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Without the <code>With</code> block, you will need to directly qualify each format with a range (<code>Selection</code>). </p>\n\n<pre><code>Sub Method2()\n\nSelection.Font.Size = 10\nSelection.Interior.Color = RGB(255, 0, 0)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10067219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0510d8e5eeeb3f443376b7aacbf7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ayllon", "link": "https://stackoverflow.com/users/10067219/jorge-ayllon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1531347147, "creation_date": 1531345337, "question_id": 51294576, "link": "https://stackoverflow.com/questions/51294576/passing-the-previosly-selected-range-cells-in-a-spreasheet-to-vba-focus-to-work", "title": "Passing the previosly selected range cells in a spreasheet to VBA focus to work with", "body": "<p>I want to make a VBA macro to format a group of cells previously selected, but i can not pass the selected range to VBA, can somebody give me a hand? </p>\n"}, {"tags": ["python", "excel", "vba", "xlwings", "chdir"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1531343171, "post_id": 51293948, "comment_id": 89565822, "body": "why don&#39;t you use a complete path? or you can use a browser to select the file if it cannot find the python file in the previously selected directory"}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1531378239, "post_id": 51293948, "comment_id": 89574828, "body": "You need to set the PYTHONPATH (either in your addin or config file) in order for RunPython to find the file, see: <a href=\"http://docs.xlwings.org/en/stable/addin.html#global-settings\" rel=\"nofollow noreferrer\">docs.xlwings.org/en/stable/addin.html#global-settings</a>"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 8677466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f95c71bde0d7867be0d6b3966e62448c?s=128&d=identicon&r=PG&f=1", "display_name": "WLC", "link": "https://stackoverflow.com/users/8677466/wlc"}, "is_accepted": false, "score": 0, "last_activity_date": 1583160738, "creation_date": 1583160738, "answer_id": 60491357, "question_id": 51293948, "link": "https://stackoverflow.com/questions/51293948/changing-working-directory-for-runpython-import/60491357#60491357", "title": "Changing working directory for RunPython import", "body": "<p>Had the same problem. Turns out that you need to change the xlwings default path. In VB Editor go to xlwings.xlam ( if password is required it is \"xlwings\"), open the modules folder and select module \"main\". Add in Wsh.currentdirectory = \"C:\\\" in Sub ExecuteWindows as highlighted in the picture below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l5xnv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l5xnv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 39, "user_id": 10032708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f214aa45fa54e416f971a57962450a96?s=128&d=identicon&r=PG&f=1", "display_name": "MMac11", "link": "https://stackoverflow.com/users/10032708/mmac11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1583160738, "creation_date": 1531342062, "question_id": 51293948, "link": "https://stackoverflow.com/questions/51293948/changing-working-directory-for-runpython-import", "title": "Changing working directory for RunPython import", "body": "<p>I am trying to run my Python script from an Excel VBA macro. Originally I did not have an issue because the .py file was in the same directory as the excel file. Now we would like to store the .py file in a different directory and the macro produces an error.</p>\n\n<p>Original Macro:</p>\n\n<pre><code>RunPython (\"import pythonefile; pythonfile.get_data()\")\n</code></pre>\n\n<p>I would like to do something like the following, but am not sure how to change the directory that the macro imports the .py file from.</p>\n\n<pre><code>ChDir \"C:\\\"\nRunPython (\"import pythonfile; pythonfile.get_data()\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "range"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531342245, "post_id": 51293881, "comment_id": 89565449, "body": "I suspect you just need more practice with the pivot table&#39;s grouping feature.  I can say that because the same thing drove me crazy for a long time. I assume you&#39;re giving the pivot table a column of dates and one or more columns of data?"}, {"owner": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531342521, "post_id": 51293881, "comment_id": 89565573, "body": "Yes!!!! and I need to date be grouped by ex.: jun-2018 and jun-2016 not just jun"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1531343412, "post_id": 51293881, "comment_id": 89565900, "body": "Post a screen shot of what you&#39;re doing. It&#39;s probably easy to fix if we can see it."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1531343559, "post_id": 51293881, "comment_id": 89565964, "body": "@J&#233;ssicaSartori please note that if you get an answer that works, please click the check to accept it. Looks like when you asked a question previously you just said you loved the author (which I&#39;m sure he appreciated). <a href=\"https://stackoverflow.com/questions/51050039/vba-date-for-logic\">stackoverflow.com/questions/51050039/vba-date-for-logic</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1531343790, "post_id": 51293881, "comment_id": 89566062, "body": "So when you&#39;re grouping, does selecting both &quot;Months&quot; and &quot;Years&quot; not give what you want?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "edited": false, "score": 0, "creation_date": 1531407247, "post_id": 51294328, "comment_id": 89594125, "body": "That is what I was doing. But I am sure my data only has information from 2016 to 2018 and when I select months and years, it gives me years like 19001... to 2019 which does not make any sense!"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "reply_to_user": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "edited": false, "score": 0, "creation_date": 1531411774, "post_id": 51294328, "comment_id": 89597066, "body": "Then the data is wrong, or Excel isn&#39;t recognizing it properly because of the way it&#39;s entered/formatted.  You need to find the outliers, and fix them.  The easiest way to find the outliers is to add a filter to the original data, and see what values aren&#39;t listed under the years 2016-2018."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1531344059, "creation_date": 1531344059, "answer_id": 51294328, "question_id": 51293881, "link": "https://stackoverflow.com/questions/51293881/range-right-and-left-formulas/51294328#51294328", "title": "Range Right and Left Formulas", "body": "<p>Forget about trying to manually manipulate the data, it's always best to leave dates as Dates and adjust the way you see them.</p>\n\n<ol>\n<li><strong>Add</strong> the <strong><em>Date</em></strong> field as a <strong><em>Column</em></strong> in the pivot table.</li>\n<li><strong>Right click</strong> on any <strong><em>date</em></strong>.</li>\n<li><strong>Click Group...</strong> </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/FUr4V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FUr4V.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"4\">\n<li>Select both <strong>Months</strong> &amp; <strong>Years</strong></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/PoXOG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PoXOG.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"5\">\n<li>Enjoy!</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/f9FLQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f9FLQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "edited": false, "score": 0, "creation_date": 1531407758, "post_id": 51294373, "comment_id": 89594461, "body": "Thank you!!! I think my mistake was that I was selecting first the months and then the years! I tried to do it again and not worked."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "edited": false, "score": 0, "creation_date": 1531413383, "post_id": 51294373, "comment_id": 89597939, "body": "@J&#233;ssicaSartori - You&#39;re welcome! I&#39;m glad you got it figured out.  ...by the way, now that you&#39;ve reached 15 rep, <b>you can <i>also</i> \u25b2Upvote</b> any answers you consider <b>helpful or well-written</b>, including the accepted answer. This earns the author an additional 10 rep. ;-)  ...and <i>welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i>"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1531346457, "last_edit_date": 1531346457, "creation_date": 1531344321, "answer_id": 51294373, "question_id": 51293881, "link": "https://stackoverflow.com/questions/51293881/range-right-and-left-formulas/51294373#51294373", "title": "Range Right and Left Formulas", "body": "<h2><sub><a href=\"https://i.stack.imgur.com/vSeFx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vSeFx.png\" alt=\"Pivot Tables:\"></a></sub>   <sup><em>Let Excel do the work for you!</em></sup></h2>\n\n<blockquote>\n  <p><sub> I had a question a while back on a different forum where someone who had been using Excel for a few months, proudly told me that his spreadsheet get daily inspections, since he's going through it cell by cell every day anyhow, to calculate the averages - <strong><em>using a calculator.</em></strong></sub></p>\n  \n  <p><sub>True story.  He has very impressed when I showed him that <em>Excel can even do <strong>averages</em></strong>.  It's not his fault - there's no way he could have known of all of the features until someone told him....</sub> :-)</p>\n</blockquote>\n\n<p>Pivot tables are one of the most underappreciated and underused features in Excel, giving the most flexibility in data reporting with the least amount of effort -- once you become aware of what it can do for you.  This is only one little feature:</p>\n\n<hr>\n\n<p>When your pivot table is grouping dates in ways you don't want it to, you can choose to re-group in several ways.</p>\n\n<ol>\n<li>First, click anywhere <strong>within the date column</strong> of your Pivot Table  </li>\n<li>Click the <code>Analyze</code> (pivot-table specific) tab on the ribbon.</li>\n<li><p>In the <strong><code>Groups</code> Group</strong>, click <strong><code>Ungroup</code></strong>.  <em>(lol)</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/oknqU.png\" alt=\"img\"></p></li>\n<li><p>Next, click <code>Group Field</code> (if it's not enabled, click on a date again)</p>\n\n<p><a href=\"https://i.stack.imgur.com/GSNYu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GSNYu.png\" alt=\"img2\"></a></p></li>\n<li><p>Here you can <strong>*Select or Deselect multiple items as needed</strong>.  </p>\n\n<p>For example, you said you had issue with it grouping months across multiple years -- so <strong>you would select <code>Months</code> and <code>Years</code></strong> and then click <kbd>OK</kbd>.</p></li>\n</ol>\n\n<p>Experimenting with it may be the best way to learn. There are infinite possibile ways to arrange the same data with the many layers of options that are built-in.</p>\n\n<hr>\n\n<h2><strong>Endless possibilities</strong></h2>\n\n<p>There are other options available through the context (right-click) menu, as well as on the <code>Design</code> ribbon tab (which appears when you click on the pivot table).</p>\n\n<p><img src=\"https://i.stack.imgur.com/uckiS.png\" alt=\"img toolbar\"></p>\n\n<hr>\n\n<p><strong>Just a couple variations of basic arrangements under <code>Report Layout</code>:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LOyWD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LOyWD.png\" alt=\"img\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ouVyQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ouVyQ.png\" alt=\"img\"></a></p>\n\n<hr>\n\n<h2>The right function for the job</h2>\n\n<p>Lastly, if you do still need to refer to specific data in your pivot table from else where in the workbook, instead of using text functions (like <code>RIGHT</code> and <code>MID</code>), use the function meant for the job: </p>\n\n<ul>\n<li><a href=\"https://support.office.com/article/getpivotdata-function-8c083b99-a922-4ca0-af5e-3af55960761f\" rel=\"nofollow noreferrer\"><strong>Excel's <code>GETPIVOTDATA</code> function</a></strong>!</li>\n</ul>\n\n<hr>\n\n<h1>More Information:</h1>\n\n<ul>\n<li>Microsoft : <a href=\"https://support.office.com/en-us/article/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576\" rel=\"nofollow noreferrer\"><strong>Create a PivotTable to analyze worksheet data</strong></a>  </li>\n<li>Microsoft : <a href=\"https://support.office.com/en-us/article/group-or-ungroup-data-in-a-pivottable-c9d1ddd0-6580-47d1-82bc-c84a5a340725\" rel=\"nofollow noreferrer\"><strong>Group or ungroup data in a PivotTable</strong></a>  </li>\n<li>Wikipedia : <a href=\"https://en.wikipedia.org/wiki/Pivot_table\" rel=\"nofollow noreferrer\"><strong>Pivot Tables</strong></a></li>\n<li>Microsoft : <a href=\"https://support.office.com/article/getpivotdata-function-8c083b99-a922-4ca0-af5e-3af55960761f\" rel=\"nofollow noreferrer\"><strong><code>GETPIVOTDATA</code> function</strong> (Excel)</a>  </li>\n<li>ExcelJet : <a href=\"https://exceljet.net/excel-functions/excel-getpivotdata-function\" rel=\"nofollow noreferrer\"><strong>How to use Excel's <code>GETPIVOTDATA</code> Function</strong></a></li>\n</ul>\n\n<hr>\n\n<h2>Advanced Pivot Table Tips:</h2>\n\n<ul>\n<li>TutsPlus : <a href=\"https://business.tutsplus.com/tutorials/advanced-excel-pivot-table-techniques--cms-28572\" rel=\"nofollow noreferrer\"><strong>How To Make Use of 5 Advanced Excel Pivot Table Techniques</strong></a>   </li>\n<li>ExcelJet : <a href=\"https://exceljet.net/things-to-know-about-excel-pivot-tables\" rel=\"nofollow noreferrer\"><strong>23 things you should know about Excel pivot tables</strong></a>    </li>\n<li>ExcelChamps : <a href=\"https://excelchamps.com/blog/pivot-table-tips-tricks/\" rel=\"nofollow noreferrer\"><strong>Top 31 Pivot Table Tips &amp; Tricks for Advanced Excel Users</strong></a>  </li>\n</ul>\n"}], "owner": {"reputation": 37, "user_id": 9996393, "user_type": "registered", "profile_image": "https://graph.facebook.com/251946532233493/picture?type=large", "display_name": "J&#233;ssica Sartori", "link": "https://stackoverflow.com/users/9996393/j%c3%a9ssica-sartori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 51294373, "answer_count": 2, "score": 1, "last_activity_date": 1531346457, "creation_date": 1531341722, "last_edit_date": 1531342649, "question_id": 51293881, "link": "https://stackoverflow.com/questions/51293881/range-right-and-left-formulas", "title": "Range Right and Left Formulas", "body": "<p>What I am actually trying to do is just filter the information on my pivot table. The problem I am getting is that when I group the data by months it groups all the months regardless if they are in the same year or not. I accept any advice on how to fix that in a simpler way. \nMy current roundabout is the code below, which is also not working. \nAll I am doing there is applying the right and left formulas in ranges, so I can get the years and months in different columns and then filter by that. </p>\n\n<p>Cans someone please help me with this issue? Thank you so much!</p>\n\n<pre><code>All.Range(\"L\" &amp; endprivate + 1, \"L\" &amp; total5).NumberFormat = \"mmm-yy\"\nAll.Range(\"U1\").Value = \"Year for Pivot Table\"\nAll.Range(\"V1\").Value = \"Month for Pivot Table\"\nAll.Range(\"U\" &amp; (endprivate + 1), \"U\" &amp; total5) = Right(All.Range(\"L\" &amp; (endprivate + 1), \"L\" &amp; total5), 2)\nAll.Range(\"V\" &amp; (endprivate + 1), \"V\" &amp; total5) = Left(All.Range(\"L\" &amp; endprivate + 1, \"L\" &amp; total5), 3)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531341741, "post_id": 51293771, "comment_id": 89565245, "body": "You need to further explain what you&#39;re trying to do - saying &quot;it doesn&#39;t work&quot; is not descriptive enough. You have several blocks of code in here which appear to have no functionality at all - twice you loop through all your worksheets, activate them and <code>Debug.Print</code> their name to the immediate window, but in your comments you say it copies the file name to column A? You need to cut this question down and make it simpler to understand."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1531341778, "post_id": 51293771, "comment_id": 89565256, "body": "I&#39;m not the best at this (which you will see if you check out the questions I asked - and received excellent help for...) but you have the for loop to do worksheets then right after that you limit it to mybook.worksheets(3). At least that is my reading of it..."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1533711693, "post_id": 51293771, "comment_id": 90440823, "body": "I rolled back the edit which removed your code because that made the question even worse and the answer impossible to relate to the question."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531347834, "post_id": 51294620, "comment_id": 89567493, "body": "Hi @dwirony  Thanks for your reply. twice you loop through all your worksheets, activate them and Debug.Print their name to the immediate window, but in your comments you say it copies the file name to column A? You need to cut this question down and make it simpler to understand."}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531348247, "post_id": 51294620, "comment_id": 89567585, "body": "Hi @dwirony  Thanks for your reply. I am trying to figure out where to loop through the code so that it will take data from range &quot;A15:B20&quot; from a workbook. Basically I need the code to go through a designated folder and pull data from workbooks. My problem is some workbooks have 1 worksheet and some have more than 1 worksheet. For the workbooks with more than 1 worksheet, the code wont pull in data from the multiple worksheets and will only pull data from the first worksheet in the workbook. The reason I included the loops are to try and go through the workbooks to run the working code."}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531350083, "post_id": 51294620, "comment_id": 89568010, "body": "@ Mistrella Thanks for this, I tried to implement your changes and am getting a compile error: &quot;Invalid Next Control Variable Reference&quot; with the Next ws at the end."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531352668, "post_id": 51294620, "comment_id": 89568595, "body": "@MikeP. I made an edit. I had accidentally put the <code>Next ws</code> on the wrong line. I tested it again, and it worked for me with a straight copy/paste this time."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1531370786, "post_id": 51294620, "comment_id": 89572021, "body": "Plus 1 from me, thanks for confirming what I thought I understood !"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531418454, "post_id": 51294620, "comment_id": 89600440, "body": "@Mistrella Currently the code will extract data from 1 worksheet in 1 workbook. My goal is to be able to extract data from multiple worksheet in 1 workbook, I added the loop function as I thought it would help me accomplish my goal. The code currently works for 1 worksheet extract from 1 workbook but i&#39;m trying to add the loop function to apply that same code to 3 worksheets in 1 workbook for example. thanks for your help!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531425061, "post_id": 51294620, "comment_id": 89603540, "body": "@MikeP.  Verifying: you tried my updated code, and it was only extracting data from one worksheet in one workbook? How many workbooks are in the folder specified (<code>C:\\Users\\mp180423\\Desktop\\Gas</code>) ?"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531428651, "post_id": 51294620, "comment_id": 89605169, "body": "@Mistrella I have 11 workbooks in my folder, The code I copied will only extract data from the first worksheet in every workbook. I copied your code under &quot;Corrected without changes formatted differently&quot; I opened a new module and pasted the code and click run and it gives me the same outcome as my original code. Thank you so much for your time and help!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531436598, "post_id": 51294620, "comment_id": 89607622, "body": "@MikeP. I hadn&#39;t paid a lot of attention to when the workbooks were being closed. I edited the code so that the workbook is closed <b>after</b> it&#39;s done cycling through the worksheets, instead of <i>before</i> getting to the second worksheet in the cycle. I tested it with workbooks with multiple sheets, and it looked like it was behaving correctly. Give it another go?"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531504005, "post_id": 51294620, "comment_id": 89636497, "body": "@Mistrella the edited code works well! Can you please explain what additional code you added vs what I originally had to make this functionality work correctly? It is extracting the data from multiple worksheets in 1 workbook now so exactly what i&#39;m looking for! You&#39;re awesome Mistrella!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531505639, "post_id": 51294620, "comment_id": 89637228, "body": "@MikeP. I added a section called <b>Change Details</b>, since I thought the explanation a bit long for the comments. Let me know if you would like further detail."}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1531507132, "post_id": 51294620, "comment_id": 89637843, "body": "@Mistrella  Thanks for the change details section. So I compared against the code I originally received (before I added the loops) and your corrected code (there are 3 major things I noticed) 1 was added cycle through worksheets, which I&#39;m okay with, 2. Changed reference to current worksheet, what does (with mybook.worksheet(3)) to (with ws) change? and 3. adding debug.print ws name &amp; &quot; : # &quot; &amp;FNum what is this doing and why was it added? I see it prints file name and index number in immediate window but why is that necessary? Thank you so much for all your generous help!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531509133, "post_id": 51294620, "comment_id": 89638617, "body": "<code>mybook.worksheet(3)</code> was telling the code &quot;No matter which sheet you&#39;re cycling through, use the third one in the workbook (for getting the ranges)&quot; Switching that to <code>ws</code> tells the code to use the worksheet it&#39;s currently on in the cycle, as the one on which to find the ranges. For 3), it&#39;s not needed. The original code you posted in your question included a cycle through all the worksheets to print their names to the immediate window. I simple adjusted it so it prints the name of the current worksheet (I added the FNum as back reference to which file it came from)."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 1, "last_activity_date": 1531505537, "last_edit_date": 1531505537, "creation_date": 1531345591, "answer_id": 51294620, "question_id": 51293771, "link": "https://stackoverflow.com/questions/51293771/i-am-trying-to-have-this-macro-include-the-ability-to-copy-data-from-multiple-wo/51294620#51294620", "title": "I am trying to have this macro include the ability to copy data from multiple worksheets in a workbook but it will only copy from the first worksheet", "body": "<p>I expect that the single worksheet from the single workbook which this code <strong>was</strong> correctly working for, would be the only workbook with at least 3 worksheets.</p>\n\n<p>When selecting the range you have:</p>\n\n<pre><code>With mybook.Worksheets(3)\n    Set sourceRange = .Range(\"A15:B20\")\nEnd With\n</code></pre>\n\n<p>Note that this restricts the data to the range from only the 3rd (third) worksheet from every workbook.</p>\n\n<p>Also note that on the line prior, you have:</p>\n\n<pre><code>On Error Resume Next\n</code></pre>\n\n<p>This would effectively mask the errors coming from attempting to extract data from all the non-existing 3rd worksheets. For the workbook with at least 3 worksheets, since the <code>With mybook.Worksheets(3)</code> is hard-coded into your code, this was the only worksheet the data was pulled from.</p>\n\n<p>(And the reason it wasn't duplicated for each worksheet in that workbook, is because the cycles through the worksheets were restricted to the <code>Debug.Print</code> lines. The code for the data-moving only cycled through once for each workbook)</p>\n\n<p>Below, you will see three (3) sections:</p>\n\n<ol>\n<li><p>Change Details.</p>\n\n<ul>\n<li>This is to help high-light the changes I made to your code so that it cycles through the data-moving for each worksheet, pulling once from each worksheet.</li>\n</ul></li>\n<li><p>Corrected</p>\n\n<ul>\n<li>This is for ease of copy/pasting the code</li>\n</ul></li>\n<li><p>Original</p>\n\n<ul>\n<li>This is to maintain a copy of the original code I based my answer off of (in case of changes).</li>\n</ul></li>\n</ol>\n\n<hr>\n\n<p><strong>Change Details</strong></p>\n\n<p>From original:</p>\n\n<pre><code>Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\nOn Error GoTo 0\n\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nws.Activate\nDebug.Print ws.Name\n\nNext\n</code></pre>\n\n<blockquote>\n<pre><code>If Not mybook Is Nothing Then\n</code></pre>\n</blockquote>\n\n<pre><code>    On Error Resume Next\n\n     ' Change this range to fit your own needs.\n     With mybook.Worksheets(3)\n          Set sourceRange = .Range(\"A15:B20\")\n     End With\n</code></pre>\n\n<p>Changed to:</p>\n\n<pre><code>Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\nOn Error GoTo 0\n\nDim ws As Worksheet\n</code></pre>\n\n<blockquote>\n<pre><code>If Not mybook Is Nothing Then\n</code></pre>\n</blockquote>\n\n<pre><code>    For Each ws In Worksheets\n        On Error Resume Next\n\n        ' Change this range to fit your own needs.\n        With ws\n            Set sourceRange = .Range(\"A15:B20\")\n        End With\n</code></pre>\n\n<ul>\n<li>Top-half:\n\n<ul>\n<li>Although I kept the <code>Dim ws As Worksheet</code>, I removed the Debug.Print cycle through all worksheets, as it had no effect on any other code.</li>\n</ul></li>\n<li>Lower-half:\n\n<ul>\n<li>Added a <code>For Each ws In Worksheets</code> around the functional code <em><strong>(which required adding <code>Next ws</code> above <code>mybook.Close savechanges:=False</code>)</strong></em>, and shifted the <em>with</em> statement from <code>With mybook.Worksheets(3)</code> to <code>With ws</code></li>\n</ul></li>\n</ul>\n\n<p>Since there was another extraneous <code>Debug.Print</code> cycle right before the file name was added to column A, I replaced it with <code>Debug.Print ws.Name &amp; \": #\" &amp; FNum</code> to be a bit more informative.</p>\n\n<hr>\n\n<p><strong>Corrected</strong></p>\n\n<hr>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    ' Change this to the path\\folder location of your files.\n    MyPath = \"C:\\Users\\mp180423\\Desktop\\Gas\"\n\n    ' Add a slash at the end of the path if needed.\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n' If there are no Excel files in the folder, exit.\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n       ' Fill the myFiles array with the list of Excel files\n    ' in the search folder.\n    FNum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        FNum = FNum + 1\n        ReDim Preserve MyFiles(1 To FNum)\n        MyFiles(FNum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    ' Set various application properties.\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    ' Add a new workbook with one sheet.\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    ' Loop through all files in the myFiles array.\n    If FNum &gt; 0 Then\n        For FNum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n            On Error GoTo 0\n\n            ' Added cycle through worksheets\n            Dim ws As Worksheet\n            If Not mybook Is Nothing Then\n                For Each ws In Worksheets\n\n                    On Error Resume Next\n\n                     ' Change this range to fit your own needs.\n                    ' Shifted reference to current worksheet-of-interest\n                    With ws\n                        Set sourceRange = .Range(\"A15:B20\")\n                    End With\n\n                    If Err.Number &gt; 0 Then\n                        Err.Clear\n                        Set sourceRange = Nothing\n                    Else\n                        ' If source range uses all columns then\n                        ' skip this file.\n                        If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                            Set sourceRange = Nothing\n                        End If\n                    End If\n                    On Error GoTo 0\n\n                    If Not sourceRange Is Nothing Then\n\n                        SourceRcount = sourceRange.Rows.Count\n\n                        If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                            MsgBox \"There are not enough rows in the target worksheet.\"\n                            BaseWks.Columns.AutoFit\n                            mybook.Close savechanges:=False\n                            GoTo ExitTheSub\n                        Else\n\n                            ' Prints file name and index number in immediate window.\n                            Debug.Print ws.Name &amp; \": #\" &amp; FNum\n\n                            ' Copy the file name in column A.\n                            With sourceRange\n                                BaseWks.Cells(rnum, \"A\"). _\n                                        Resize(.Rows.Count).Value = MyFiles(FNum)\n                            End With\n\n                            ' Set the destination range.\n                            Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                            ' Copy the values from the source range\n                            ' to the destination range.\n                            With sourceRange\n                                Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                            End With\n                            destrange.Value = sourceRange.Value\n\n                            rnum = rnum + SourceRcount\n                        End If\n                    End If\n                'Cycles through next worksheet-of-interest\n                Next ws\n                mybook.Close savechanges:=False\n\n            End If\n        Next FNum\n        BaseWks.Columns.AutoFit\n    End If\n\n        Range(\"B1\").Select\n        Selection.AutoFilter\n        ActiveSheet.Range(\"$A$1:$C$66\").AutoFilter Field:=2, Criteria1:= _\n        \"Kilowatt hours used Current period\"\n\n\nExitTheSub:\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\n\nMsgBox (\"Merge Completed.\")\nEnd Sub\n</code></pre>\n\n<p><strong>Original</strong></p>\n\n<hr>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    ' Change this to the path\\folder location of your files.\n    MyPath = \"C:\\Users\\mp180423\\Desktop\\Gas\"\n\n    ' Add a slash at the end of the path if needed.\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n' If there are no Excel files in the folder, exit.\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n       ' Fill the myFiles array with the list of Excel files\n    ' in the search folder.\n    FNum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        FNum = FNum + 1\n        ReDim Preserve MyFiles(1 To FNum)\n        MyFiles(FNum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    ' Set various application properties.\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    ' Add a new workbook with one sheet.\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    ' Loop through all files in the myFiles array.\n    If FNum &gt; 0 Then\n        For FNum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n            On Error GoTo 0\n\n\n            Dim ws As Worksheet\n\n            For Each ws In Worksheets\n            ws.Activate\n            Debug.Print ws.Name\n\n            Next\n\n\n\n            If Not mybook Is Nothing Then\n                On Error Resume Next\n\n                ' Change this range to fit your own needs.\n                With mybook.Worksheets(3)\n                    Set sourceRange = .Range(\"A15:B20\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    ' If source range uses all columns then\n                    ' skip this file.\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"There are not enough rows in the target worksheet.\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        ' Copy the file name in column A.\n                        For Each ws In Worksheets\n                        ws.Activate\n                        Debug.Print ws.Name\n                        Next\n\n                        With sourceRange\n                            BaseWks.Cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(FNum)\n                        End With\n\n                        ' Set the destination range.\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        ' Copy the values from the source range\n                        ' to the destination range.\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n\n            End If\n\n        Next FNum\n        BaseWks.Columns.AutoFit\n    End If\n\n        Range(\"B1\").Select\n        Selection.AutoFilter\n        ActiveSheet.Range(\"$A$1:$C$66\").AutoFilter Field:=2, Criteria1:= _\n        \"Kilowatt hours used Current period\"\n\n\nExitTheSub:\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\n\nMsgBox (\"Merge Completed.\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1533711641, "answer_count": 1, "score": -3, "last_activity_date": 1533711664, "creation_date": 1531341148, "last_edit_date": 1533711664, "question_id": 51293771, "link": "https://stackoverflow.com/questions/51293771/i-am-trying-to-have-this-macro-include-the-ability-to-copy-data-from-multiple-wo", "closed_reason": "Needs details or clarity", "title": "I am trying to have this macro include the ability to copy data from multiple worksheets in a workbook but it will only copy from the first worksheet", "body": "<p>This is my data below.\nThe code works just doesn't fit my requirements. I need to add the functionality that will allow me to pull data from multiple worksheets in 1 workbook but currently it will only pull the data from 1 worksheet in 1 workbook. \nI've included the code to go through different worksheets but as of now the code will only extract data from 1 worksheet in 1 workbook. \nAny help is greatly appreciated. Thanks!</p>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    ' Change this to the path\\folder location of your files.\n    MyPath = \"C:\\Users\\mp180423\\Desktop\\Gas\"\n\n    ' Add a slash at the end of the path if needed.\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n' If there are no Excel files in the folder, exit.\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n       ' Fill the myFiles array with the list of Excel files\n    ' in the search folder.\n    FNum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        FNum = FNum + 1\n        ReDim Preserve MyFiles(1 To FNum)\n        MyFiles(FNum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    ' Set various application properties.\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    ' Add a new workbook with one sheet.\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    ' Loop through all files in the myFiles array.\n    If FNum &gt; 0 Then\n        For FNum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n            On Error GoTo 0\n\n\n            Dim ws As Worksheet\n\n            For Each ws In Worksheets\n            ws.Activate\n            Debug.Print ws.Name\n\n            Next\n\n\n\n            If Not mybook Is Nothing Then\n                On Error Resume Next\n\n                ' Change this range to fit your own needs.\n                With mybook.Worksheets(3)\n                    Set sourceRange = .Range(\"A15:B20\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    ' If source range uses all columns then\n                    ' skip this file.\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"There are not enough rows in the target worksheet.\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        ' Copy the file name in column A.\n                        For Each ws In Worksheets\n                        ws.Activate\n                        Debug.Print ws.Name\n                        Next\n\n                        With sourceRange\n                            BaseWks.Cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(FNum)\n                        End With\n\n                        ' Set the destination range.\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        ' Copy the values from the source range\n                        ' to the destination range.\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n\n            End If\n\n        Next FNum\n        BaseWks.Columns.AutoFit\n    End If\n\n        Range(\"B1\").Select\n        Selection.AutoFilter\n        ActiveSheet.Range(\"$A$1:$C$66\").AutoFilter Field:=2, Criteria1:= _\n        \"Kilowatt hours used Current period\"\n\n\nExitTheSub:\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\n\nMsgBox (\"Merge Completed.\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "is_accepted": false, "score": 0, "last_activity_date": 1531341296, "last_edit_date": 1531341296, "creation_date": 1531340901, "answer_id": 51293732, "question_id": 51293582, "link": "https://stackoverflow.com/questions/51293582/how-to-copy-data-to-blank-line-then-delete-original-in-excel/51293732#51293732", "title": "How to Copy Data to Blank Line then Delete Original in Excel", "body": "<p>What you've got already will work.  However, I would make these edits:</p>\n\n<pre><code>Sub Find_Blank_And_Fill()\nDim cnter As Integer\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\ncnter = 0\nRange(\"B29:F29\").copy 'Avoid using \"Select\"! Also, this way you only copy once.\n\nFor i = 3 To lastRow 'Start your fill operation after your known rows\n    If IsEmpty(Cells(i, 1)) Then\n        Cells(i,2).PasteSpecial Paste:=xlPasteValues 'Simplified\n        cnter = cnter + 1 'Why is this here?  It's counting empty rows right now\n    End If\nNext i\napplication.cutcopymode = false 'Turns off the box around the area you copied\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10066744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15109bb5cb0fc6124b72fa300fbb26d?s=128&d=identicon&r=PG&f=1", "display_name": "ProWHP", "link": "https://stackoverflow.com/users/10066744/prowhp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594207105, "creation_date": 1531340154, "last_edit_date": 1594207105, "question_id": 51293582, "link": "https://stackoverflow.com/questions/51293582/how-to-copy-data-to-blank-line-then-delete-original-in-excel", "title": "How to Copy Data to Blank Line then Delete Original in Excel", "body": "<p>I'm having difficulty coding in excel and can't figure out how to do everything I need to.  I'm trying to take data from one row, search for a blank row in a different area of the same sheet on the same workbook, copy the data using the values-only setting, then delete the original data.</p>\n\n<p>Here's what I have so far, the only problem is I'm unsure how to tell it to paste the data.  The question marks indicate where I'm stuck.  Do I even need something else or can I just go straight to the 'selection.pastespecial' part of the code?</p>\n\n<p>Any help or guidance would be greatly appreciated, thank you!</p>\n\n<pre><code>   Sub Find_Blank_And_Fill()\n    Dim cnter As Integer\n\n    lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    cnter = 0\n\n    For i = 1 To lastRow\n        If IsEmpty(Cells(i, 1)) Then\n            Range(\"B29:F29\").Select\n            Selection.copy\n            ????\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n            End Select\n            cnter = cnter + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>There's a photo to help make this easier to understand if I'm not conveying it well.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZUBVF.png\" alt=\"Visual Description\"></p>\n\n<p>Sincerely,</p>\n\n<p>ProWHP</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531340228, "post_id": 51293577, "comment_id": 89564691, "body": "Nice catch on the <code>xlnullstring</code>, I missed that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1531342693, "post_id": 51293577, "comment_id": 89565643, "body": "worth noting since you have <code>delete</code> in comments that if user really wants to delete rows they will need to loop backward through the range"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1531346451, "post_id": 51293577, "comment_id": 89567062, "body": "This code isn&#39;t doing what I want it to do. Any other suggestions?"}, {"owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "edited": false, "score": 0, "creation_date": 1531346954, "post_id": 51293577, "comment_id": 89567208, "body": "I don&#39;t want the cells to be deleted. I have a total at the bottom. It takes away my formatting on that. I just want cleared contents to be shifted up."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1531379063, "last_edit_date": 1531379063, "creation_date": 1531340138, "answer_id": 51293577, "question_id": 51293479, "link": "https://stackoverflow.com/questions/51293479/how-to-clear-all-contents-within-a-given-range-based-on-if-one-column-returning/51293577#51293577", "title": "How to clear all contents within a given range based on if one column returning zero value?", "body": "<p><strong>EDIT</strong>: this will do the consolidation of the remaining rows</p>\n\n<pre><code>Sub Equity()\n\n    Dim rng As Range, rw As Range, arr, i As Long, n As Long\n\n    Set rng = Range(\"P4:R12\")\n    ReDim arr(1 To rng.Rows.Count, 1 To rng.Columns.Count)\n\n    For Each rw In rng.Rows\n        If Application.CountA(rw) &gt; 0 And rw.Cells(2) &lt;&gt; \"\" Then\n            i = i + 1\n            For n = 1 To UBound(arr, 2)\n                arr(i, n) = rw.Cells(n)\n            Next n\n        End If\n    Next rw\n\n    rng.Value = arr\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "is_accepted": false, "score": 0, "last_activity_date": 1531411764, "last_edit_date": 1531411764, "creation_date": 1531411443, "answer_id": 51310154, "question_id": 51293479, "link": "https://stackoverflow.com/questions/51293479/how-to-clear-all-contents-within-a-given-range-based-on-if-one-column-returning/51310154#51310154", "title": "How to clear all contents within a given range based on if one column returning zero value?", "body": "<p>Thanks for trying guys, but I used a combination of different codes to achieve the result I was looking for. See below. This worked!</p>\n\n<pre><code>Sub Equity()\nDim LastRow As Long\nDim I As Long\n    Application.ScreenUpdating = False\n    LastRow = Range(\"Q\" &amp; rows.Count).End(xlUp).Row\n    For I = LastRow To 2 Step -1\n        If (Cells(I, \"Q\") = 0) Then\n            With Range(Cells(I, \"P\"), Cells(I, \"R\"))\n                .ClearContents\n            End With\n        End If\n        If (Cells(I, \"T\") = 1) Then Range(Cells(I, \"A\"), Cells(I,\"Y\")).Interior.ColorIndex = 35`\n    Next I\n    Application.ScreenUpdating = True\n    Range(\"P4:R12\").Sort key1:=Range(\"P4\"), _\n        order1:=xlAscending, Header:=xlNo\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>You can follow the picture model above and replace my column letter with yours if you have a similar issue.The end result looks like picture below. First part of the code clears contents based on Bales column being 0. Second part, I used sorting instead of shift contents up.</p>\n\n<p><a href=\"https://i.stack.imgur.com/m07p3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m07p3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 10028294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5qMjcIXKaI0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37Wxkk2xeguDiL5tfrwyZrfMzI6Q/mo/photo.jpg?sz=128", "display_name": "Sorab", "link": "https://stackoverflow.com/users/10028294/sorab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531411764, "creation_date": 1531339646, "last_edit_date": 1531378792, "question_id": 51293479, "link": "https://stackoverflow.com/questions/51293479/how-to-clear-all-contents-within-a-given-range-based-on-if-one-column-returning", "title": "How to clear all contents within a given range based on if one column returning zero value?", "body": "<p><a href=\"https://i.stack.imgur.com/A3Nrx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A3Nrx.png\" alt=\"enter image description here\"></a>So say I'm trying to clear contents within Range P4:R12. Column P has alphabetical value, but Q and R have numerical. I want to clear contents off all 3 columns P4, Q4, and R4 based on the fact that column Q is 0, and shift contents up on P through Q only once the content is cleared on P through Q based on Q = 0.</p>\n\n<p>Can someone help me? I'm using below code, but it only clears contents on columns Q and R zero values. I want to clear column P alphabetical content as well if values are 0 in column Q. No formulas involved in cells. All values.</p>\n\n<p>You can see on picture above any cell that doesn't have bales amount i want to clear portfolio content as well, and then shift cells up, without messing with formatting. Portfolio is column P, Bales is Q, and COGS is column R.</p>\n\n<pre><code>Sub Equity()\nDim q As Range\nFor Each q In Range(\"P4:R12\")\n    If q.Value = xlnullstring Then\n    q.Resize(1, 4).Value = xlnullstring\n    End If\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531339449, "post_id": 51293191, "comment_id": 89564363, "body": "Is PS execution policy allowing PS1 scripts to run? Default is to block execution. Try adding the <code>-noexit</code> switch if the PS1 window immediately closes."}, {"owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1531340219, "post_id": 51293191, "comment_id": 89564682, "body": "I tried and that did not help, I see the window pop open but then closes and the script isn&#39;t executed.  I did the below: <code>x = Shell(&quot;POWERSHELL.exe -noexit&quot; &amp; &quot;H:\\Operations\\REPORTS\\Reports2018\\Balance Sheet\\SLmarginJE.ps1&quot;, 1)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531340258, "post_id": 51293191, "comment_id": 89564702, "body": "You can <a href=\"https://stackoverflow.com/posts/51293191/edit\">edit</a> your question with any additional relevant info / what you&#39;ve tried."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531340330, "post_id": 51293191, "comment_id": 89564730, "body": "<code>...-noexit&quot; &amp; &quot;H:\\Operations\\...</code>  you haven&#39;t left a space between these arguments"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 9, "last_activity_date": 1531340710, "creation_date": 1531340710, "answer_id": 51293698, "question_id": 51293191, "link": "https://stackoverflow.com/questions/51293191/how-to-run-powershell-script-through-excel-vba/51293698#51293698", "title": "how to run powershell script through excel VBA", "body": "<p>If your file path has spaces you need to put quotes around it. </p>\n\n<pre><code>x = Shell(\"POWERSHELL.exe -noexit \" &amp; _\n           \"\"\"H:\\Operations\\REPORTS\\Reports2018\\Balance Sheet\\SLmarginJE.ps1\"\"\", 1) \n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18498, "favorite_count": 1, "accepted_answer_id": 51293698, "answer_count": 1, "score": 6, "last_activity_date": 1531396028, "creation_date": 1531338333, "last_edit_date": 1531396028, "question_id": 51293191, "link": "https://stackoverflow.com/questions/51293191/how-to-run-powershell-script-through-excel-vba", "title": "how to run powershell script through excel VBA", "body": "<p>I am trying to use an Excel VBA macro to launch a PowerShell script if a certain condition is met. I'm not getting any errors in the code when it runs and I am able to manually run the PowerShell script from the Windows Explorer window without errors. However, when I execute the below VBA code, the PowerShell does not run and I am not sure why. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim x as Variant\nIf rs.RecordCount = 0 Then\n    x = Shell(\"POWERSHELL.exe \" &amp; \"H:\\MyFolder\\MyFile.ps1\", 1)\nEnd If\n</code></pre>\n\n<p>I can't tell if something in the VBA code is wrong because I'm not getting any run time errors but the PowerShell script is not actually running </p>\n\n<p><strong>UPDATE</strong>: with the extra quotes I am able to see the error message now that's popping up in the cmd window but it is still having issues with the space even with the extra quotes. I have moved my script to a different file path that doesn't have spaces but I now seeing errors that running scripts are disabled. This seems like it is no longer a code based problem. thank you all!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1531338465, "post_id": 51293132, "comment_id": 89563944, "body": "What is <code>removeduplicates</code>? That sounds like a UDF. So you are writing code, to iterate through cells to put a formula in that calls VBA code that does &lt;something&gt; and sends it&#39;s value back to that cell, then you copy that value into another cell and remove the formula. That feels... pretty roundabout. How about reduce those three lines to just <code>x.Offset(,2)value = removeduplicates(x.offset(,-1).value)</code> (or whatever that&#39;s pointing to)."}, {"owner": {"reputation": 27, "user_id": 5385714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f4b705c730f877eb1f7f912c2190c9?s=128&d=identicon&r=PG&f=1", "display_name": "cmc", "link": "https://stackoverflow.com/users/5385714/cmc"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531338667, "post_id": 51293132, "comment_id": 89564025, "body": "It is a UDF. It removes duplicates in a cell with strings separated by commas. It&#39;s roundabout because another macro outputs something into offset 2, then the formula removes the dupes, and then the final values are hardcoded into the original cell."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531338727, "post_id": 51293132, "comment_id": 89564052, "body": "I guess my point is, just call it directly in your VBA. <code>Range(&quot;A1&quot;).Value = removeDuplicates(Range(&quot;B1&quot;).Value)</code> for instance would put the dedup&#39;d values from B1 into A1 WITHOUT a formula. There is no reason to put it in a formula, wait for it to calculate and populate the cell, then copy the value and paste it into another cell and then delete the formula when you can just call the <code>removeduplicate()</code> function directly in VBA."}, {"owner": {"reputation": 27, "user_id": 5385714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f4b705c730f877eb1f7f912c2190c9?s=128&d=identicon&r=PG&f=1", "display_name": "cmc", "link": "https://stackoverflow.com/users/5385714/cmc"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531339349, "post_id": 51293132, "comment_id": 89564335, "body": "This doesn&#39;t really work here because another macro is outputting something into x.Offset(, 2) and that output has dupes. So to remove the dupes, I can&#39;t just do <code>.Offset(, 2).Value = RemoveDuplicates.Offset(, 2).Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1531338539, "creation_date": 1531338539, "answer_id": 51293242, "question_id": 51293132, "link": "https://stackoverflow.com/questions/51293132/faster-way-of-looping-through-each-cell-in-a-defined-range-with-offsets/51293242#51293242", "title": "Faster way of looping through each cell in a defined range - with offsets?", "body": "<p>Try this</p>\n\n<pre><code>With strText\n    .Offset(, 3).FormulaR1C1 = \"=removeduplicates(RC[-1])\"\n    .Offset(, 2).Value = .Offset(, 3).Value\n    .Offset(, 3).ClearContents\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5385714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f4b705c730f877eb1f7f912c2190c9?s=128&d=identicon&r=PG&f=1", "display_name": "cmc", "link": "https://stackoverflow.com/users/5385714/cmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 51293242, "answer_count": 1, "score": 0, "last_activity_date": 1531338539, "creation_date": 1531338112, "question_id": 51293132, "link": "https://stackoverflow.com/questions/51293132/faster-way-of-looping-through-each-cell-in-a-defined-range-with-offsets", "title": "Faster way of looping through each cell in a defined range - with offsets?", "body": "<p>Here's the code I'm using</p>\n\n<pre><code>For Each x In strText\n    x.Offset(, 3).FormulaR1C1 = \"=removeduplicates(RC[-1])\"\n    x.Offset(, 2).Value = x.Offset(, 3).Value\n    x.Offset(, 3).ClearContents\nNext x\n</code></pre>\n\n<p>The issue is that the range is 10,000 cells over 15 sheets so this takes ages. Is there any way to do this faster?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1531338552, "post_id": 51293120, "comment_id": 89563978, "body": "You don&#39;t need to reference column K, use this in cell M7108 and copy up and down: <code>=IF(J7108=J7107,M7107+TIMEVALUE(&quot;0:00:00.01&quot;),J7108)</code> and then make sure to format the cell as Custom with <code>h:mm:ss.00</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531340831, "post_id": 51293120, "comment_id": 89564924, "body": "Do you really mean microseconds?  Milliseconds?"}, {"owner": {"reputation": 1, "user_id": 10066868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22685b01f3e935c59176abf2b431fd38?s=128&d=identicon&r=PG&f=1", "display_name": "user10066868", "link": "https://stackoverflow.com/users/10066868/user10066868"}, "edited": false, "score": 0, "creation_date": 1531344167, "post_id": 51293120, "comment_id": 89566206, "body": "Its working, thanks for your help. Its milliseconds"}], "owner": {"reputation": 1, "user_id": 10066868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22685b01f3e935c59176abf2b431fd38?s=128&d=identicon&r=PG&f=1", "display_name": "user10066868", "link": "https://stackoverflow.com/users/10066868/user10066868"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531340296, "creation_date": 1531338062, "last_edit_date": 1531340296, "question_id": 51293120, "link": "https://stackoverflow.com/questions/51293120/counter-in-excel-if-else-statement", "title": "Counter in Excel If else statement", "body": "<p>I am stuck with an excel question and need help in creating a counter and add the micro seconds in Air Time field when Count Air Time is more than 1 to differentiate the unique records.</p>\n\n<p>Incremental counter to the Air Time field to make it unique and remove duplicates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hjeGj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hjeGj.jpg\" alt=\"img1\"></a></p>\n\n<p>Thanks,\nNupur</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1531337663, "post_id": 51292963, "comment_id": 89563556, "body": "Since this is working code, you&#39;ll get constructive help on coding style and ways to improve performance over at <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531337676, "post_id": 51292963, "comment_id": 89563563, "body": "If your code works fine but needs tune-ups, put it up on <a href=\"https://codereview.stackexchange.com\">Code Review</a> and <b>describe its purpose, what it does and how it does it and why it does it that way</b>, give it a title that summarizes the code&#39;s purpose, and folks on CR will be happy to help you improve your coding skills in every possible way, <i>including</i> performance."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1531337702, "post_id": 51292963, "comment_id": 89563580, "body": "Maybe throw in a few <code>Debug.Print Timer</code> in various places to see <i>where</i> the code is slow."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531337756, "post_id": 51292963, "comment_id": 89563610, "body": "Also mention how many rows are involved in each sheet, and/or provide screenshots if possible."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1531337868, "post_id": 51292963, "comment_id": 89563670, "body": "I normally just click on a few places a debug point and click on play. That way you&#39;ll narrow down the troublesome area straight away - it&#39;s either the loop or the bit where you&#39;re pasting vlookup() down to last row - what is the last row?"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531337387, "creation_date": 1531337387, "question_id": 51292963, "link": "https://stackoverflow.com/questions/51292963/ways-to-improve-macros-execution-time", "title": "Ways to improve macros execution time", "body": "<p>I have created a macro, which runs fine but, for no reason I can explain, takes so long to finish. I have tried running the macro line to line and cannot figure out which part of the process takes so long. I can only imagine that it is the part where I delete rows based on backround color. I have built several macros with similar lines of code and the performance was way better.</p>\n\n<pre><code>Sub Pharma_Stock_Report()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim lastrow1 As Long\nDim lastrow2 As Long\nDim lastrow3 As Long\nDim cell As Range\nDim DeleteRange As Range\n\nspath1 = Application.ThisWorkbook.Path &amp; \"\\Pharma replenishment.xlsm\"\nspath2 = Application.ThisWorkbook.Path &amp; \"\\NOT OK.xlsx\"\nWorkbooks.Open spath1\nWorkbooks.Open spath2\n\nSet ws1 = Workbooks(\"Pharma Stock Report.xlsm\").Worksheets(\"Pharma Stock Report\")\nSet ws2 = Workbooks(\"Pharma replenishment.xlsm\").Worksheets(\"Replenishment\")\nSet ws3 = Workbooks(\"NOT OK.xlsx\").Worksheets(\"Sheet1\")\n\nws1.Cells.Clear\n\nlastrow1 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nws2.Range(\"A4:G\" &amp; lastrow1).Copy\nWith ws1.Range(\"A1\")\n    .PasteSpecial xlPasteColumnWidths\n    .PasteSpecial xlPasteValues, , False, False\n    .PasteSpecial xlPasteFormats, , False, False\nEnd With\n\nApplication.CutCopyMode = False\nWorkbooks(\"Pharma replenishment.xlsm\").Close\n\nlastrow2 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor Each cell In ws1.Range(\"D2:D\" &amp; lastrow2)\n    If Not cell.Interior.ColorIndex = 2 Or cell.Interior.ColorIndex = -4142 Then\n        If DeleteRange Is Nothing Then\n            Set DeleteRange = cell\n        Else\n            Set DeleteRange = Union(DeleteRange, cell)\n        End If\n    End If\nNext cell\nIf Not DeleteRange Is Nothing Then DeleteRange.EntireRow.Delete\n\nws3.Range(\"H1:J1\").Copy\nWith ws1.Range(\"H1\")\n    .PasteSpecial xlPasteColumnWidths\n    .PasteSpecial xlPasteValues, , False, False\n    .PasteSpecial xlPasteFormats, , False, False\nEnd With\n\nlastrow3 = ws1.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nws1.Range(\"H2:H\" &amp; lastrow3).Formula = \"=IFERROR(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:H,3,FALSE),\"\"\"\")\"\nWith Range(\"H2:H\" &amp; lastrow3)\n    .Value = .Value\n    .NumberFormat = \"dd/mm/yyyy\"\nEnd With\n\nws1.Range(\"I2:I\" &amp; lastrow3).Formula = \"=IFERROR(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:I,4,FALSE),\"\"\"\")\"\nWith Range(\"I2:I\" &amp; lastrow3)\n    .Value = .Value\n    .NumberFormat = \"dd/mm/yyyy\"\nEnd With\n\nws1.Range(\"J2:J\" &amp; lastrow3).Formula = \"=IFERROR(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:J,5,FALSE),\"\"\"\")\"\nWith Range(\"J2:J\" &amp; lastrow3)\n    .Value = .Value\n    .NumberFormat = \"dd/mm/yyyy\"\nEnd With\n\nApplication.CutCopyMode = False\nWorkbooks(\"NOT OK.xlsx\").Close\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531372813, "post_id": 51292883, "comment_id": 89572639, "body": "You haven&#39;t shown your strReverse code."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1531490312, "last_edit_date": 1531490312, "creation_date": 1531373820, "answer_id": 51298001, "question_id": 51292883, "link": "https://stackoverflow.com/questions/51292883/reverse-a-selection-of-data-from-a-specific-column-if-value-in-a-cell-meets-a-cr/51298001#51298001", "title": "Reverse a selection of data from a specific column if value in a cell meets a criteria", "body": "<p>Here is a method using the <code>.Reverse</code> method of <code>ArrayList</code> object</p>\n\n<pre><code>Option Explicit\nPublic Sub ReverseAList()\n    Dim ws As Worksheet, arr(), i As Long, aList As Object, lastRow As Long\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set aList = CreateObject(\"System.Collections.ArrayList\")\n    With ws\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row 'whichever column is required to determine last row. Assumes there are headers in row1\n        If lastRow = 2 Then arr(0) = .Range(\"A2\").Value\n        arr = .Range(\"A2:A\" &amp; lastRow).Value\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            aList.Add arr(i, 1)\n        Next i\n\n        aList.Reverse\n\n        For i = 0 To aList.Count - 1\n            arr(i + 1, 1) = aList(i)\n        Next\n\n        .Cells(2, 2).Resize(aList.Count, 1) = arr\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Data and output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ElNbH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ElNbH.png\" alt=\"Data and output\"></a></p>\n\n<hr>\n\n<p>Same thing re-writing a sub by <a href=\"https://wellsr.com/vba/2018/excel/reverse-order-of-array-with-vba/\" rel=\"nofollow noreferrer\">Ryan Wells</a> as a function:</p>\n\n<pre><code>Public Sub ReverseAList2()\n    Dim ws As Worksheet, arr(), i As Long, aList As Object, lastRow As Long\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    With ws\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row 'whichever column is required to determine last row. Assumes there are headers in row1\n        If lastRow = 2 Then arr(0) = .Range(\"A2\").Value\n        arr = .Range(\"A2:A\" &amp; lastRow).Value\n        .Cells(2, 2).Resize(UBound(arr), 1) = ReverseArray(arr)\n    End With\nEnd Sub\n\nPublic Function ReverseArray(vArray As Variant) As Variant\n    Dim vTemp As Variant, i As Long, iUpper As Long, iMidPt As Long\n    iUpper = UBound(vArray, 1)\n    iMidPt = (UBound(vArray, 1) - LBound(vArray, 1)) \\ 2 + LBound(vArray)\n    For i = LBound(vArray) To iMidPt\n        vTemp = vArray(iUpper, 1)\n        vArray(iUpper, 1) = vArray(i, 1)\n        vArray(i, 1) = vTemp\n        iUpper = iUpper - 1\n    Next i\n    ReverseArray = vArray\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10023747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c8ad2936e1c2012c529f78567f92d78?s=128&d=identicon&r=PG&f=1", "display_name": "istillhavetogopee", "link": "https://stackoverflow.com/users/10023747/istillhavetogopee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 51298001, "answer_count": 1, "score": 0, "last_activity_date": 1531490312, "creation_date": 1531337071, "question_id": 51292883, "link": "https://stackoverflow.com/questions/51292883/reverse-a-selection-of-data-from-a-specific-column-if-value-in-a-cell-meets-a-cr", "title": "Reverse a selection of data from a specific column if value in a cell meets a criteria", "body": "<p>I have a form where users enter the name of a project and the type of transaction.</p>\n\n<p>I have written a macro that returns a selection of data from a table based on the name of the project the user entered, and it works perfectly.</p>\n\n<p>Now I need to add in a function that reverses the order of that same list if the user enters a specific transaction type, it reverses the order of the same list of data.</p>\n\n<p>For example, if type A returns:</p>\n\n<p>Bob</p>\n\n<p>Jerry</p>\n\n<p>Andrew</p>\n\n<p>Jeff</p>\n\n<p>Then type B would reverse that order and return:</p>\n\n<p>Jeff</p>\n\n<p>Andrew</p>\n\n<p>Jerry</p>\n\n<p>Bob</p>\n\n<p>The VBA I wrote for the first portion, to return the list based on project name is:</p>\n\n<pre><code>Sub finddata()\n\nDim projectName As String\nDim transactionType As String\nDim finalRow As Integer\nDim i As Integer\n\nSheets(\"Template_Test\").Range(\"G10:I38\").ClearContents\n\nprojectName = Sheets(\"Template_Test\").Range(\"E10\").Value\nfinalRow = Sheets(\"Project_Structure\").Range(\"A20000\").End(xlUp).Row\ntransactionType = Sheets(\"Template_Test\").Range(\"E14\").Value\n\nFor i = 2 To finalRow\n    Sheets(\"Project_Structure\").Activate\n    If Cells(i, 1) = projectName Then\n        Sheets(\"Project_Structure\").Range(Cells(i, 2), Cells(i, 4)).Copy\n    Sheets(\"Template_Test\").Activate\n        Sheets(\"Template_Test\").Range(\"G100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        End If\nNext i\n\nSheets(\"Template_Test\").Range(\"E10\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I can get the selection to reverse order using the built in vba function strReverse and a specific range, but my data is not a consistent length of cells - sometimes it's 6 names and sometimes it's 15 - and I can't figure out how to get it to adjust the length it needs to reverse without including blank cells underneath the range.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531338362, "post_id": 51292849, "comment_id": 89563893, "body": "Good one... there doesn&#39;t appear to be a <code>CommandBarButton</code> for it. Might have been possible pre-2007."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1531339021, "creation_date": 1531339021, "answer_id": 51293340, "question_id": 51292849, "link": "https://stackoverflow.com/questions/51292849/excel-vba-button-to-activate-the-drawing-of-an-autoshape/51293340#51293340", "title": "EXCEL VBA : Button to activate the drawing of an autoshape", "body": "<p>Pre-2007, everything was a <code>CommandBarButton</code>, with an <code>ID</code>. You get ahold of that <code>CommandBarButton</code>, you can invoke its <code>Execute</code> method.</p>\n\n<p>Office 2007 ditched the commandbars and introduced the Ribbon. Some commandbars are still available and you <em>can</em> invoke them like in the old days, but as far as I can see there's no <code>CommandBarButton</code> remotely related to \"shapes\" or \"connector\".</p>\n\n<p>I'm using this method:</p>\n\n<pre><code>Public Sub FindCmdBarControl(ByVal name As String)\n    Dim cmdbar As CommandBar\n    For Each cmdbar In Application.CommandBars\n        Dim ctrl As CommandBarControl\n        For Each ctrl In cmdbar.Controls\n            If ctrl.TooltipText Like \"*\" &amp; name &amp; \"*\" Or ctrl.Caption Like \"*\" &amp; name &amp; \"*\" Then\n                Debug.Print cmdbar.name, ctrl.Caption, ctrl.TooltipText, ctrl.ID\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>...but running <code>FindCmdBarControl \"line\"</code> yields this output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Formatting    &amp;Underline    &amp;Underline (Ctrl+U)          115 \nCell          Sp&amp;arklines                  31623 \nSeries        Add T&amp;rendline...           Add T&amp;rendline...            914 \nFormat Data Series          Add T&amp;rendline...           Add T&amp;rendline...            914 \nList Range Popup            Sp&amp;arklines                  31623 \nNil           &amp;Line         Insert Line Sparkline        18927 \nNil           &amp;Column       Insert Column Sparkline      18928 \nNil           &amp;Win/Loss     Insert Win/Loss Sparkline    18929 \nNil           Edit &amp;Single Sparkline's Data...          Edit &amp;Single Sparkline's Data...           19223 \nNil           &amp;Group        Group Selected Sparklines    19226 \nNil           &amp;Ungroup      Ungroup Selected Sparklines  19227 \nNil           &amp;Clear Selected Sparklines  &amp;Clear Selected Sparklines   19229 \nNil           C&amp;lear Selected Sparkline Groups          C&amp;lear Selected Sparkline Groups           19230 \nNil           &amp;Hidden &amp;&amp; Empty Cells...   Sparkline Hidden &amp;&amp; Empty Cells            19224 \nNil           &amp;More Colors...             More Sparkline Colors        19451 \nNil           Custom &amp;Weight...           Sparkline Custom Weight      19453 \nNil           &amp;Line         Convert to Line Sparkline    20450 \nNil           &amp;Column       Convert to Column Sparkline  20451 \nNil           &amp;Win/Loss     Convert to Win/Loss Sparkline              20452 \nNil           &amp;More Colors...             More Sparkline Negative Point Colors       20473 \nNil           &amp;More Colors...             More Sparkline Marker Colors               20474 \nNil           &amp;More Colors...             More Sparkline High Point Colors           20475 \nNil           &amp;More Colors...             More Sparkline Low Point Colors            20476 \nNil           &amp;More Colors...             More Sparkline First Point Colors          20477 \nNil           &amp;More Colors...             More Sparkline Last Point Colors           20478 \nLine Color    &amp;More Outline Colors...     &amp;More Outline Colors...      1052 \nBuilt-in Menus              &amp;Group and Outline                         30032 \n</code></pre>\n\n<p>So, say you want to invoke the <code>&amp;Underline</code> command (ID 115), you can do this:</p>\n\n<pre><code>Application.CommandBars(\"Formatting\").FindControl(ID:=115).Execute\n</code></pre>\n\n<p>Running <code>FindCmdBarControl \"connector\"</code> yields nothing, and I'm out of ideas. See if you can locate a command ID for what you're looking for... that said, there's already a built-in button in the Ribbon that does exactly what you want (let the user draw a connector)...</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10066746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d26f42e824f183f004710ec15bd9c259?s=128&d=identicon&r=PG&f=1", "display_name": "Teebee15", "link": "https://stackoverflow.com/users/10066746/teebee15"}, "is_accepted": false, "score": 0, "last_activity_date": 1531345989, "creation_date": 1531345989, "answer_id": 51294676, "question_id": 51292849, "link": "https://stackoverflow.com/questions/51292849/excel-vba-button-to-activate-the-drawing-of-an-autoshape/51294676#51294676", "title": "EXCEL VBA : Button to activate the drawing of an autoshape", "body": "<p>Thank you very much for your response. I've managed to find the ID within Connectors.</p>\n\n<pre><code>Application.CommandBars(\"Connectors\").FindControl(ID:=1042).Execute\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5793729, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207058188190664/picture?type=large", "display_name": "Mi Cha Elmu Eller", "link": "https://stackoverflow.com/users/5793729/mi-cha-elmu-eller"}, "is_accepted": false, "score": 0, "last_activity_date": 1586249089, "creation_date": 1586249089, "answer_id": 61076079, "question_id": 51292849, "link": "https://stackoverflow.com/questions/51292849/excel-vba-button-to-activate-the-drawing-of-an-autoshape/61076079#61076079", "title": "EXCEL VBA : Button to activate the drawing of an autoshape", "body": "<p>Just to point the right ID:</p>\n\n<p>Commandbar = \"Drawing\"</p>\n\n<p>Controlname= \"&amp;Line\"</p>\n\n<p>ID = 130</p>\n"}], "owner": {"reputation": 31, "user_id": 10066746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d26f42e824f183f004710ec15bd9c259?s=128&d=identicon&r=PG&f=1", "display_name": "Teebee15", "link": "https://stackoverflow.com/users/10066746/teebee15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1586249089, "creation_date": 1531336937, "question_id": 51292849, "link": "https://stackoverflow.com/questions/51292849/excel-vba-button-to-activate-the-drawing-of-an-autoshape", "title": "EXCEL VBA : Button to activate the drawing of an autoshape", "body": "<p>I'm stuck. I've searched high and low, far and wide. And I cannot find a solution out there. </p>\n\n<p>Is it possible to activate the line tool in the AutoShapes object via a Form Control button?</p>\n\n<p>I know how to draw a line from fixed locations via a macro however I would like the user to draw their own lines. </p>\n\n<pre><code>ActiveSheet.Shapes.AddConnector(msoConnectorStraight, 88.8, 447.6, 168.6, 480.6 _\n    ).Select\n</code></pre>\n\n<p>Is there a way to activate the drawing tool but not actually draw it and allowing the user to complete the rest of the process themselves? </p>\n\n<p>Thank you in advance,</p>\n\n<p>Teebee</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1531337519, "post_id": 51292781, "comment_id": 89563498, "body": "Maybe remove the apostrophe delimiters."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1531346502, "post_id": 51292781, "comment_id": 89567077, "body": "Your tabled names indicate some kind of linked SQL Server connection yet you don&#39;t mention that in your question or in tags. Do you have linked tables? Are you trying to use sql pass through queries?"}], "answers": [{"comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1531405453, "post_id": 51293123, "comment_id": 89592896, "body": "Nice use of the word &quot;octothorpe&quot;. :)"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 3, "last_activity_date": 1531338920, "last_edit_date": 1531338920, "creation_date": 1531338072, "answer_id": 51293123, "question_id": 51292781, "link": "https://stackoverflow.com/questions/51292781/how-do-i-code-a-date-variable-into-an-access-sql-statement/51293123#51293123", "title": "How do I code a date variable into an Access sql statement", "body": "<p>In Access SQL dates need to be surrounded by octothorpes, and formatted either <code>mm/dd/yyyy</code> or <code>yyyy-mm-dd</code>. The main error here is the quotes instead of octothorpes.</p>\n\n<pre><code>SQL1 = (\"DELETE dbo_Subjects.*, dbo_Subjects.Date_Created FROM dbo_Subjects \" &amp; _\n                \"WHERE (((dbo_Subjects.Date_Created)&gt;=#\" &amp; strLastImportStamp &amp; \"#));\")\n</code></pre>\n\n<p>Alternatively, you can <a href=\"https://stackoverflow.com/q/49509615/7296893\">use parameters or TempVars</a>, but that does require it to be an actual date.</p>\n"}], "owner": {"reputation": 19, "user_id": 10047564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ec3e21318063d09bb5ea4c0cd83f7d?s=128&d=identicon&r=PG&f=1", "display_name": "ReciprocalHokie", "link": "https://stackoverflow.com/users/10047564/reciprocalhokie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562668040, "creation_date": 1531336719, "last_edit_date": 1531346551, "question_id": 51292781, "link": "https://stackoverflow.com/questions/51292781/how-do-i-code-a-date-variable-into-an-access-sql-statement", "title": "How do I code a date variable into an Access sql statement", "body": "<p>I am trying to do something in Access that is truly simple but I can't seem to get it to work. I have researched the answer online and tried many different things that were suggested to get this code to run in VBA but to no avail.</p>\n\n<p>The value in Me.txtImportStartGeneralDate is '7/11/2018 2:27:19 PM'\nWhen I create a delete query using Access query design, it deletes the records perfectly fine. However the SQL statement in the VBA code below throws a Runtime error 3464.</p>\n\n<p>I've tried both with and without the hash marks surrounding the General Date format. \nI've tried to cast the date/time using CDate().\nI've tried replacing the variable as defined below with, \n\" &amp; Me.txtImportStartGeneralDate &amp; \"\n, nothing seems to work.</p>\n\n<pre><code>Private Sub cmdUndoImport_Click()\n\n    MsgBox \"Are you sure you want to do this?\", vbOKCancel, \"THIS CANNOT BE UNDONE!!!\"\n\n    strLastImport = Me.txtImportStartGeneralDate\n    strLastImportStamp = \"#\" &amp; strLastImport &amp; \"#\"\n    DoCmd.SetWarnings False\n    SQL1 = (\"DELETE dbo_Subjects.*, dbo_Subjects.Date_Created FROM dbo_Subjects \" &amp; _\n                \"WHERE (((dbo_Subjects.Date_Created)&gt;='\" &amp; strLastImportStamp &amp; \"'));\")\n\n    DoCmd.RunSQL SQL1\n    SQL2 = (\"DELETE dbo_Specimens.*, dbo_Specimens.Date_Created FROM dbo_Specimens \" &amp; _\n                \"WHERE (((dbo_Specimens.Date_Created)&gt;='\" &amp; strLastImportStamp &amp; \"'));\")\n    DoCmd.RunSQL SQL2\n    SQL3 = (\"DELETE dbo_Samples.*, dbo_Samples.Date_Created FROM dbo_Samples \" &amp; _\n                \"WHERE (((dbo_Samples.Date_Created)&gt;='\" &amp; strLastImportStamp &amp; \"'));\")\n    DoCmd.RunSQL SQL3\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531337492, "post_id": 51292770, "comment_id": 89563487, "body": "Change <code>DOMDocument</code> to <code>DOMDocument60</code>. And then at the bottom of your code change <code>ChildNotes</code> to <code>ChildNodes</code>.  The code works for me."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531338162, "post_id": 51292770, "comment_id": 89563809, "body": "I noticed the DOMDocument60 issue and was going to edit the code as you sent that. I will change the other issue and see what happens."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531338506, "post_id": 51292770, "comment_id": 89563963, "body": "@PeterT that works perfectly! Thank you for your guidance"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1531339821, "post_id": 51292770, "comment_id": 89564523, "body": "I would avoid <code>MsgBox</code> calls in a function, particularly if that function is meant to be used as a UDF (i.e. invoked from a worksheet cell). If there&#39;s no data, <i>return no data</i>. Or, return a specific error code, e.g. <code>CVErr(xlErrNA)</code>, but then your function will have to return a <code>Variant</code>, not a <code>String</code>."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531340000, "post_id": 51292770, "comment_id": 89564590, "body": "@MathieuGuindon if I wanted to do that, would i  simply replace the <code>MsgBox</code> part of the code with that <code>CVErr(xlErrNA)</code> and then change the return to <code>Variant</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1531340087, "post_id": 51292770, "comment_id": 89564627, "body": "Yup. <code>ReverseGeoCode = CVErr(xlErrNa)</code> in place of the <code>MsgBox</code>, then <code>Exit Function</code>, yes. I would also handle any run-time error and return <code>CVErr(xlErrValue)</code> if anything goes wrong while acquiring the data (e.g. server down, or any other run-time error)."}], "owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531336679, "creation_date": 1531336679, "question_id": 51292770, "link": "https://stackoverflow.com/questions/51292770/reverse-geocoding-macro-user-defined-type-not-defined", "title": "Reverse GeoCoding Macro: User-defined Type Not Defined", "body": "<p>I am attempting to use someone's reverse geocoding macro to help with the functionality of a different macrobook. Here is the code:</p>\n\n<pre><code>Public Function ReverseGeoCode(myInput1 As String, myInput2 As String) As String\n\n'You will need to reference Microsoft XML, v6.0 object library\n\n    Dim XMLDoc As New DOMDocument\n    Dim XMLNODE As IXMLDOMNode\n    Dim I As Long\n    Dim lat, lng, myAddress As String\n\n    lat = myInput1\n    lng = myInput2\n\n    XMLDoc.Load \"http://maps.googleapis.com/maps/api/geocode/xml?latlng=\" &amp; lat &amp; \",\" &amp; lng &amp; \" &amp;sensor=false\"\n\n    Do Until XMLDoc.readyState = 4\n        DoEvents\n    Loop\n\n    If Len(XMLDoc.Text) = 0 Then\n        Call MsgBox(\"No Data!\")\n        Exit Function\n    End If\n\n    Set XMLNode = XMLDoc.SelectSingleNode(\"/GeocodeResponse/result/formatted_address\")\n\n    For i= 0 To XMLNode.ChildNotes.Length - 1\n        myAddress = XMLNode.ChildNotes(i).Text\n    Next i\n\n    ReverseGeoCode = myAddress\n\nEnd Function\n</code></pre>\n\n<p>I am not super familiar with any of what this code is doing. I followed the instructions to reference Microsoft XML v6.0 object library, but when I try to call the function, the cell prints \"#VALUE!\" and within the code I see <code>DOMDocument</code> in my first <code>Dim</code> statement highlighted, with the error message \"User-defined type not defined\"</p>\n\n<p>Anybody have any idea what is going on here?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1383, "user_id": 2458668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375160e4bf745627127c703109ab6462?s=128&d=identicon&r=PG", "display_name": "Ankur Patel", "link": "https://stackoverflow.com/users/2458668/ankur-patel"}, "edited": false, "score": 0, "creation_date": 1531336189, "post_id": 51292582, "comment_id": 89562941, "body": "Try the following link: <a href=\"https://stackoverflow.com/questions/5174362/microsoft-access-condense-multiple-lines-in-a-table/5174843#5174843\" title=\"microsoft access condense multiple lines in a table\">stackoverflow.com/questions/5174362/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1531336593, "post_id": 51292582, "comment_id": 89563130, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5174362/microsoft-access-condense-multiple-lines-in-a-table\">Microsoft Access condense multiple lines in a table</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531336637, "post_id": 51292582, "comment_id": 89563150, "body": "Have you tried anything? Which part are you stuck at? Do you have the <code>join</code> between <code>Groups</code> and <code>Contacts</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531336977, "post_id": 51292582, "comment_id": 89563298, "body": "FWIW you <b>don&#39;t</b> want your <code>Groups</code> table to contain information for multiple contacts. You want a <i>normalized</i> data set; the comma-separated result doesn&#39;t belong in a table, it belongs in a query/view, or on a report, or some client - don&#39;t store denormalized data, you&#39;ll regret it later."}, {"owner": {"reputation": 33, "user_id": 3606616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462ec1b267e4d137825a26bce7f060e?s=128&d=identicon&r=PG&f=1", "display_name": "user3606616", "link": "https://stackoverflow.com/users/3606616/user3606616"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531338417, "post_id": 51292582, "comment_id": 89563925, "body": "@MathieuGuindon Sorry, I realized I made a mistake in describing this. I am not modifying the original Groups table, only creating a query for a specific export."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531338464, "post_id": 51292582, "comment_id": 89563943, "body": "Olivier&#39;s answer, and the linked question, seem to give you a very good starting point."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531337052, "post_id": 51292769, "comment_id": 89563325, "body": "Not familiar with Access, but isn&#39;t DAO referenced by default?"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531337488, "post_id": 51292769, "comment_id": 89563484, "body": "It was referenced by default in older versions. Newer reference ADODB instead. I usually remove ADODB and add DAO because I prefer the latter."}, {"owner": {"reputation": 33, "user_id": 3606616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462ec1b267e4d137825a26bce7f060e?s=128&d=identicon&r=PG&f=1", "display_name": "user3606616", "link": "https://stackoverflow.com/users/3606616/user3606616"}, "edited": false, "score": 1, "creation_date": 1531339771, "post_id": 51292769, "comment_id": 89564499, "body": "Thanks, that&#39;s exactly what I needed!"}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 2, "last_activity_date": 1531337937, "last_edit_date": 1531337937, "creation_date": 1531336677, "answer_id": 51292769, "question_id": 51292582, "link": "https://stackoverflow.com/questions/51292582/combining-data-into-one-field-using-ms-access-and-sql/51292769#51292769", "title": "Combining Data into one Field Using MS Access and SQL", "body": "<p>You cannot do it with SQL alone. You need a VBA function. The function I show below uses the DAO library. Make sure to have a reference to the corresponding DLL (Microsoft DAO 3.6 Object Library).</p>\n\n<p>Add this code to a module:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function JoinRecords(dataSource As String, Optional delimiter As String = \";\", _\n                                  Optional columns As Long = 1) As String\n    Dim db As DAO.Database, rs As DAO.Recordset, s As String, col As Long\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(dataSource, dbOpenForwardOnly)\n    Do Until rs.EOF\n        For col = 0 To columns - 1\n            If s = \"\" Then\n                s = Nz(rs(col))\n            Else\n                s = s &amp; delimiter &amp; Nz(rs(col))\n            End If\n        Next col\n        rs.MoveNext\n    Loop\n    rs.Close: Set rs = Nothing\n    db.Close: Set db = Nothing\n    JoinRecords = s\nEnd Function\n</code></pre>\n\n<p>Then you can run this query</p>\n\n<pre><code>UPDATE Groups\nSET Info = JoinRecords(\"SELECT Name &amp; ': ' &amp; Contact FROM Contacts WHERE ID=\" &amp; ID, \", \")\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3606616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9462ec1b267e4d137825a26bce7f060e?s=128&d=identicon&r=PG&f=1", "display_name": "user3606616", "link": "https://stackoverflow.com/users/3606616/user3606616"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51292769, "answer_count": 1, "score": 0, "last_activity_date": 1531339839, "creation_date": 1531335894, "last_edit_date": 1531339839, "question_id": 51292582, "link": "https://stackoverflow.com/questions/51292582/combining-data-into-one-field-using-ms-access-and-sql", "title": "Combining Data into one Field Using MS Access and SQL", "body": "<p>I have these two tables:</p>\n\n<p>Groups:</p>\n\n<pre><code>+----+-------+------+\n| ID | Title | Info |\n+----+-------+------+\n|  1 | Red   |      |\n|  2 | Blue  |      |\n|  3 | Green |      |\n+----+-------+------+\n</code></pre>\n\n<p>Contacts:</p>\n\n<pre><code>+----+-------+----------------+\n| ID | Name  |    Contact     |\n+----+-------+----------------+\n|  1 | Joe   | joe@test.com   |\n|  3 | Billy | billy@test.com |\n|  3 | Sally | sally@test.com |\n+----+-------+----------------+\n</code></pre>\n\n<p>I am trying to match them based on ID, and move all of the data from Contacts to the 'info' field in Groups so there is only one table, without having duplicate records for each contact.</p>\n\n<pre><code>+----+-------+----------------------------------------------+\n| ID | Title |                     Info                     |\n+----+-------+----------------------------------------------+\n|  1 | Red   | Joe: joe@test.com                            |\n|  2 | Blue  |                                              |\n|  3 | Green | Billy: billy@test.com, Sally: sally@test.com |\n+----+-------+----------------------------------------------+\n</code></pre>\n\n<p>Am I overstepping bounds by trying to use SQL to do this? I can't figure out how to aggregate multiple fields into one field using SQL. I am using MS Access so maybe I should look into using VBA to perform this right before I export the data.</p>\n\n<p>Edit: Not a duplicate of <a href=\"https://stackoverflow.com/questions/5174362/microsoft-access-condense-multiple-lines-in-a-table\">Microsoft Access condense multiple lines in a table</a>\nI am condensing multiple fields into one, not just one field into one.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1531335460, "post_id": 51292426, "comment_id": 89562592, "body": "Description only is difficult to understand, and it vaguely sounds like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>.  Can you provide sample data with before and after results?"}, {"owner": {"reputation": 73682, "user_id": 2097240, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/JskU5.jpg?s=128&g=1", "display_name": "Daniel M&#246;ller", "link": "https://stackoverflow.com/users/2097240/daniel-m%c3%b6ller"}, "edited": false, "score": 0, "creation_date": 1531336437, "post_id": 51292426, "comment_id": 89563047, "body": "You can use a named range for the entire column (example &quot;A:A&quot;) and make the macro look only up to the last filled cell, or you can use a named range only for the header, and use offsets to get the following values until you find an empty cell."}, {"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "edited": false, "score": 0, "creation_date": 1531338082, "post_id": 51292426, "comment_id": 89563777, "body": "Thanks for the responses, based on the feedback I have edited the question thoroughly because I don&#39;t think the original wording fully conveyed what I am trying to do."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531343281, "post_id": 51292426, "comment_id": 89565862, "body": "Named cells implies a Named Range.  What does that have to do with the sample code? <code>Range(&quot;Section_Z&quot;).Cut Sheet1.Range(&quot;A10&quot;)</code> will moved a the Named Range <code>Section_Z</code> to <code>Sheet1.Range(&quot;A10&quot;)</code> and retain its name."}, {"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "edited": false, "score": 0, "creation_date": 1531398610, "post_id": 51292426, "comment_id": 89587990, "body": "You can name a range which is several cells but you can also name a specific cell, this is useful if you want to navigate to a specific place in the document.  Naming a cell effectively inserts a hyperlink destination into the document.  From the code I&#39;m not cutting cells I&#39;m copying so I don&#39;t know what the outcome with cutting a cell would be but as far as copying goes the cell does not retain it&#39;s name when it is copied over."}], "answers": [{"tags": [], "owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "is_accepted": true, "score": 0, "last_activity_date": 1532027562, "creation_date": 1532027562, "answer_id": 51430252, "question_id": 51292426, "link": "https://stackoverflow.com/questions/51292426/vba-copy-named-cells-from-one-sheet-and-paste-to-another-retaining-names/51430252#51430252", "title": "VBA copy named cells from one sheet and paste to another retaining names", "body": "<p>After much searching I was able to cobble together a solution.</p>\n\n<pre><code>    On Error Resume Next\n    ActiveWorkbook.Names.Add Name:=Worksheets(\"Master List\").Cells(RowCount.Row,_\n     1).Name.Name &amp; \"_retail\", RefersTo:=RetailSheet &amp; intCount\n\n   intCount = intCount + 1\n</code></pre>\n\n<p>We add a new name to to the workbook; <code>ActiveWorkbook.Names.Add</code> the name comes from the existing name on the other sheet <code>Name:=Worksheets(\"Master List\").Cells(RowCount.Row,1).Name.Name &amp; \"_retail\"</code> the <code>&amp; \"_retail</code> ensures that the new name doesn't overwrite the old name because I wanted it on the same sheet.</p>\n\n<p><code>RefersTo:=RetailSheet &amp; intCount</code> sets the address of the new cell (<code>RetailSheet</code> is just a string <code>=Retail!$A$</code> and <code>intCount</code> ensures that the row is relative to the row on the retail sheet rather than the master sheet.</p>\n\n<p><code>On Error Resume Next</code> just moves to the next row if the cell is not named (which most aren't).</p>\n"}], "owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 51430252, "answer_count": 1, "score": 0, "last_activity_date": 1532027562, "creation_date": 1531335197, "last_edit_date": 1531338025, "question_id": 51292426, "link": "https://stackoverflow.com/questions/51292426/vba-copy-named-cells-from-one-sheet-and-paste-to-another-retaining-names", "title": "VBA copy named cells from one sheet and paste to another retaining names", "body": "<p>Is there any way to copy a named cell and paste it into a new sheet and have the name transfer over?  Lets say for example I had a list of 5000 books and I wanted to index it so people didn't have to scroll through 4950 books to get to the \"Z\" section, they could just click a link and it would take them to the named cell \"Section_Z\".  </p>\n\n<p>With one sheet this would be easy but I'm using a <code>for each</code> loop in VBA to take specific items from a master list and divide them into three separate sheets based on some criteria.  Each separate sheet has to have an index like the use case mentioned above so when the cell named \"Section_Z\" copies over to Sheet2 it's name and relative location would also be copied to reflect Sheet2.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code> 'for loop starts going through the master list\n\n    for Each RowCount In Worksheets(\"Master List\").ListObjects(\"MasterListTable\").Range.Rows\n\n    'if statements determine the category that the product should be placed in based on Category column G.\n\n    If Cells(RowCount.Row, 7).Value Like \"Retail*\" Then\n    TotalRowsRetail = TotalRowsRetail + 1\n\n     'copy the row\n       RowCount.EntireRow.Copy\n\n       'select the retail sheet and paste the row corresponding with the current iteration (this does not look for the next blank row because this macro is intended to be run occasionally to totally refresh the sheets)\n\n        Worksheets(\"Retail\").Select\n        Worksheets(\"Retail\").Range(\"A\" &amp; TotalRowsRetail).Select\n        ActiveCell.Offset(1, 0).Select\n\n        ActiveCell.PasteSpecial xlPasteValues\n\n\n\n\n\n     ElseIf Cells(RowCount.Row, 7).Value Like \"Corporate*\" Then\n    TotalRowsGroup = TotalRowsGroup + 1\n       RowCount.EntireRow.Copy\n\n        Worksheets(\"Corporate\").Select\n        Worksheets(\"Corporate\").Range(\"A\" &amp; TotalRowsCorporate).Select\n        ActiveCell.Offset(1, 0).Select\n\n        ActiveCell.PasteSpecial\n\n\n\n        Worksheets(\"Master List\").Select\n\n\n    Next RowCount\n\n    'after the for each loop runs the tables in the retail and corporate sheets are resized to match the amount of data pasted in\n\n    Worksheets(\"Retail\").Select\n     ActiveSheet.ListObjects(\"RetailTable\").Resize Range(\"$A$10:$G$\" &amp; TotalRowsRetail + 1)\n     Worksheets(\"Corporate\").Select\n     ActiveSheet.ListObjects(\"CorporatepTable\").Resize Range(\"$A$10:$G$\" &amp; TotalCorporateGroup + 1)\n</code></pre>\n\n<p>The above macro works perfectly, I'm only posting it to try and give some context to what I am trying to do, which is essentially copy not just cell formatting ie 'ActiveCell.PasteSpecial xlPasteValues` but also paste any named cells.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531334877, "post_id": 51292287, "comment_id": 89562311, "body": "Make the format of the cell containing the <code>VLOOKUP()</code> formula the same as the format of the cells in the column you are returning data from.  If the column returned is variable, then a <code>UDF()</code> is a possible solution."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531335295, "post_id": 51292287, "comment_id": 89562510, "body": "but the column I am returning data from has different formats, not just one.. thats why I want to change the column format to text but, when I do that the dates are replaced by numbers"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531335648, "post_id": 51292287, "comment_id": 89562682, "body": "Great!  the <code>UDF()</code> can retrieve data by getting the cell&#39;s <b>address</b>.  This means it can get the cell&#39;s format as well as its value and return the result in the desired format...................is a VBA version of <code>VLOOKUP()</code> acceptable??"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531335727, "post_id": 51292287, "comment_id": 89562719, "body": "yes it is acceptable! Can you please explain further how to use this UDF?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531335803, "post_id": 51292287, "comment_id": 89562752, "body": "Once I have written the <code>UDF()</code>, I&#39;ll include instruction."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531335811, "post_id": 51292287, "comment_id": 89562758, "body": "@Gary&#39;sStudent how do you plan on changing the target cells format to the format of the lookup cell.  As far as I know a UDF can&#39;t do that."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1531335923, "post_id": 51292287, "comment_id": 89562803, "body": "@ScottCraner  The <code>UDF()</code>  will return pure Text as the cell&#39;s format won&#39;t matter."}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1531338220, "post_id": 51293069, "comment_id": 89563832, "body": "Thats really awesome! Thanks a lot! Real MVP!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1531346274, "post_id": 51293069, "comment_id": 89566993, "body": "@Jonnyboi  Thanks..........try it out and let me know if you find any bugs.............."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1531447040, "last_edit_date": 1531447040, "creation_date": 1531337863, "answer_id": 51293069, "question_id": 51292287, "link": "https://stackoverflow.com/questions/51292287/changing-all-vlookup-formats-in-text-format/51293069#51293069", "title": "Changing all vlookup formats in text format", "body": "<p>Lets start out with a little table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1M7hR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1M7hR.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you see, the items in column <strong>H</strong> have varying formats; date formats, number formats, and currency formats.</p>\n\n<p>Our code is:</p>\n\n<pre><code>Public Function vbaLookup(valu As Variant, rng As Range, icol As Long) As String\n    Dim FirstRow As Long, LastRow As Long, i As Long\n\n    LastRow = rng.Rows.Count\n    FirstRow = 1\n\n    For i = FirstRow To LastRow\n        If valu = rng(1).Offset(i - 1, 0) Then\n            vbaLookup = rng(1).Offset(i - 1, icol - 1).Text\n            Exit Function\n        End If\n    Next i\n    vbaLookup = \"xxxx\"\nEnd Function\n</code></pre>\n\n<ul>\n<li>The first argument is the lookup value</li>\n<li>the second argument is the table range</li>\n<li>the third argument is the column indicator.</li>\n</ul>\n\n<p>In the example shown below, we place in cell <strong>C1</strong> the formula:</p>\n\n<pre><code>=vbaLookup(\"gamma\",G1:I3,2)\n</code></pre>\n\n<p>What we get is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/J8MWy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J8MWy.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you see, the proper format gets picked up !!<br><br>  <em>NOTE:  There are limitations....it won't pick up underlining or font colors or cell background colors, etc.</em></p>\n\n<p>User Defined Functions (UDFs) are very easy to <strong>install</strong> and use:</p>\n\n<ol>\n<li><kbd>ALT</kbd>+<kbd>F11</kbd>  brings up the VBE window</li>\n<li><kbd>ALT</kbd>+<kbd>I</kbd>\n<kbd>ALT</kbd>+<kbd>M</kbd> opens a fresh module</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you save the workbook, the UDF will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To <strong>remove</strong> the UDF:</p>\n\n<ol>\n<li>bring up the VBE window as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To <strong>use</strong> the UDF from Excel:</p>\n\n<pre><code>=vbaLookup(\"gamma\",G1:I3,2)\n</code></pre>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>and for specifics on UDFs, see:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 2, "accepted_answer_id": 51293069, "answer_count": 1, "score": 2, "last_activity_date": 1531447040, "creation_date": 1531334615, "question_id": 51292287, "link": "https://stackoverflow.com/questions/51292287/changing-all-vlookup-formats-in-text-format", "title": "Changing all vlookup formats in text format", "body": "<p>I am vlooking up values from an excel sheet (they are in column I and J as it is obvious from code) that are either dates or numbers or text. I am trying to change the formats of these values to text, so as to vlookup the value of the cell as it is shown. So if I see 28/07/2018, I want to vlookup it as it is and not get as a vlookup result a number or a date(which most of the time is automatically transfered as a number). What I have tried so far is given below but it does not work well.</p>\n\n<pre><code>ws3.Range(\"I2:J\" &amp; lastrow1).NumberFormat = \"@\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1531344457, "creation_date": 1531344457, "answer_id": 51294399, "question_id": 51292284, "link": "https://stackoverflow.com/questions/51292284/vba-macro-sending-pdf-through-outlook-windows10-error-1004/51294399#51294399", "title": "VBA Macro - Sending PDF through outlook (Windows10) Error 1004", "body": "<p>The part that you are defining a mail item is not good, do sth like this, complete the code yourself:</p>\n\n<pre><code>Sub SendAttachment()\n    Set olObj = CreateObject(\"Outlook.Application\")\n    With olObj.CreateItem(olMailItem)\n        .Subject = \"mySubject\"\n        .To = \"test@test.com\"\n        .CC = \"test@test.com\"\n        .Body = \"test\"\n        .Attachments.Add Name\n        .send\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>PS:</strong> It is always recommended to use explicit definitions (e.g. Dim sSubject as string)</p>\n"}], "owner": {"reputation": 1, "user_id": 10064789, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zg0LD5_BsqM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p7ayIj0ILAVYt-mFAkS4flgz_mPA/mo/photo.jpg?sz=128", "display_name": "Braden Pratt", "link": "https://stackoverflow.com/users/10064789/braden-pratt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531379023, "creation_date": 1531334583, "last_edit_date": 1531379023, "question_id": 51292284, "link": "https://stackoverflow.com/questions/51292284/vba-macro-sending-pdf-through-outlook-windows10-error-1004", "title": "VBA Macro - Sending PDF through outlook (Windows10) Error 1004", "body": "<p>Hi I really need some help here. I'm trying to export the active sheet in MS Excel as a PDF and have it save to the drive as well as Email it through outlook to several company different contacts. It seems to work with everyone who doesn't have Windows 10. I'm the only one with a Windows 10 PC. ActiveSheet is where i'm getting the error.\nBelow is the code that I've used but I keep getting a error message 1004</p>\n\n<pre><code>Name = Specific location\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Name, _\n    Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas \n    _:=False, OpenAfterPublish:=False\n\nActiveWorkbook.Save\n    Set Mail_Object = CreateObject(\"Outlook.Application\")\n    With Mail_Object.CreateItem(o)\n    .Subject = \n    .To = \n    .CC =\n    .Body = \n    .Attachments.Add Name \n    .send\nEnd With\n    MsgBox \"E-mail successfully sent\", 64\n    Application.DisplayAlerts = False\n    Set Mail_Object = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531336154, "post_id": 51292169, "comment_id": 89562923, "body": "FYI <code>&amp;HFF1111</code> is a legit hex literal, no need to make it a string then convert it to a double."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1531336368, "post_id": 51292250, "comment_id": 89563017, "body": "<code>&amp;H1111FF</code> as a hex literal works just as well for the first case; no need to stringify it and convert it to a <code>Double</code> with <code>Val</code>, VBA understands hex literals perfectly fine =)"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531337091, "post_id": 51292250, "comment_id": 89563339, "body": "@MathieuGuindon: Thanks for the hint. Removed all <code>Val</code> functions."}, {"owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "edited": false, "score": 0, "creation_date": 1531340527, "post_id": 51292250, "comment_id": 89564799, "body": "That&#39;s what was tripping me up. Dang! So if I were to expand the code to allow the a superuser to pick the color and save it to a database, I would have to convert it coming in. Anyways I like this answer because it accomplishes what I am looking to do."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 2, "last_activity_date": 1531337179, "last_edit_date": 1531337179, "creation_date": 1531334464, "answer_id": 51292250, "question_id": 51292169, "link": "https://stackoverflow.com/questions/51292169/how-to-set-background-of-a-form-to-a-hexidecimal-color-in-ms-access-vba/51292250#51292250", "title": "How to set background of a form to a hexidecimal color in MS-Access VBA", "body": "<p>The value needs to be GBR</p>\n\n<pre><code>&amp;H1111ff\n</code></pre>\n\n<p>There is also a <code>RGB()</code> function</p>\n\n<pre><code>RGB(255,17,17) 'Same as &amp;H1111ff\n</code></pre>\n\n<p>Say you have </p>\n\n<pre><code>s = \"ff1111\"\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>Me.Detail.BackColor = RGB(\"&amp;H\" &amp; Left$(s, 2), _\n                          \"&amp;H\" &amp; Mid$(s, 3, 2), _\n                          \"&amp;H\" &amp; Right$(s, 2))\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>Me.Detail.BackColor = \"&amp;H\" &amp; Right$(s, 2) &amp; Mid$(s, 3, 2) &amp; Left$(s, 2)\n</code></pre>\n\n<p>According to @MathieuGuindon the <code>Val</code> function is not required as VBA understands hex strings and automatically converts them to <code>Long</code>.</p>\n"}], "owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2061, "favorite_count": 1, "accepted_answer_id": 51292250, "answer_count": 1, "score": 1, "last_activity_date": 1531337179, "creation_date": 1531334038, "last_edit_date": 1531334982, "question_id": 51292169, "link": "https://stackoverflow.com/questions/51292169/how-to-set-background-of-a-form-to-a-hexidecimal-color-in-ms-access-vba", "title": "How to set background of a form to a hexidecimal color in MS-Access VBA", "body": "<p>I am looking to set the background of a form to a hex value given a condition.</p>\n\n<pre><code>Private Sub Form_Load()\n    If Not IsNull(Me.SeparationDate) Then Me.Detail.BackColor = Val(\"&amp;H\" &amp; \"ff1111\")\nEnd Sub\n</code></pre>\n\n<p>Problem is that with this condition my background is turning a dark blue color and not an off red.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531760692, "post_id": 51292035, "comment_id": 89705962, "body": "What is the error? Identify the specific line of code."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1535492421, "post_id": 51292035, "comment_id": 91083438, "body": "Set a reference to the Microsoft Word object model."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1562459735, "creation_date": 1562459735, "answer_id": 56918600, "question_id": 51292035, "link": "https://stackoverflow.com/questions/51292035/how-to-format-selected-text/56918600#56918600", "title": "How to format selected text?", "body": "<p><em>Outlook does not understand <code>InchesToPoints(0)</code> When Converting a measurement from inches to points-  simply use <strong><code>.LeftIndent = (0)</code></strong>, or specify the <code>Application</code> Example <strong><code>Word.InchesToPoints(0)</code></em></strong></p>\n\n<hr>\n\n<pre><code>Public Sub UseWord_Fmt()\n'   Wrapper\n    Dim Ins As Outlook.Inspector\n    Dim wDoc As Word.Document\n    Dim Word As Word.Application\n    Dim Selection As Word.Selection\n\n    Set Ins = Application.ActiveInspector\n    Set wDoc = Ins.WordEditor\n    Set Word = wDoc.Application\n    Set Selection = Word.Selection\n'\n'\n    ' My code, generic so that I can later modify\n'\n'\n    Selection.HomeKey Unit:=wdStory\n    Selection.MoveDown Unit:=wdLine, Count:=4, Extend:=wdExtend\n    With Selection.ParagraphFormat\n        .LeftIndent = (0)\n        .RightIndent = (0)\n        .SpaceBefore = 6\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n        .LineSpacingRule = wdLineSpaceSingle\n        .Alignment = wdAlignParagraphLeft\n        .WidowControl = True\n        .KeepWithNext = False\n        .KeepTogether = False\n        .pageBreakBefore = False\n        .NoLineNumber = False\n        .Hyphenation = True\n        .FirstLineIndent = (0)\n        .OutlineLevel = wdOutlineLevelBodyText\n        .CharacterUnitLeftIndent = 0\n        .CharacterUnitRightIndent = 0\n        .CharacterUnitFirstLineIndent = 0\n        .LineUnitBefore = 0\n        .LineUnitAfter = 0\n        .MirrorIndents = False\n        .TextboxTightWrap = wdTightNone\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 2678545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563fecf1b1f327b17eee0c67af9ce73f?s=128&d=identicon&r=PG&f=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/2678545/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592723738, "creation_date": 1531333459, "last_edit_date": 1592723738, "question_id": 51292035, "link": "https://stackoverflow.com/questions/51292035/how-to-format-selected-text", "title": "How to format selected text?", "body": "<p>I am trying to format selected text in Outlook 2010.</p>\n\n<p>I recorded a macro that works for Word.</p>\n\n<p>My Outlook code fails on the second line before I get to the working Word code.</p>\n\n<p>I have been using VBA for many years, almost entirely in Excel.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic Sub UseWord_Fmt()\n'   Wrapper\n    Dim Ins As Outlook.Inspector\n    Dim wDoc As Word.Document\n    Dim Word As Word.Application\n    Dim Selection As Word.Selection\n\n    Set Ins = Application.ActiveInspector\n    Set wDoc = Ins.WordEditor\n    Set Word = wDoc.Application\n    Set Selection = Word.Selection\n'\n'\n    ' My code, generic so that I can later modify\n'\n'\n    Selection.HomeKey Unit:=wdStory\n    Selection.MoveDown Unit:=wdLine, Count:=4, Extend:=wdExtend\n    With Selection.ParagraphFormat\n        .LeftIndent = InchesToPoints(0)\n        .RightIndent = InchesToPoints(0)\n        .SpaceBefore = 6\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n        .LineSpacingRule = wdLineSpaceSingle\n        .Alignment = wdAlignParagraphLeft\n        .WidowControl = True\n        .KeepWithNext = False\n        .KeepTogether = False\n        .PageBreakBefore = False\n        .NoLineNumber = False\n        .Hyphenation = True\n        .FirstLineIndent = InchesToPoints(0)\n        .OutlineLevel = wdOutlineLevelBodyText\n        .CharacterUnitLeftIndent = 0\n        .CharacterUnitRightIndent = 0\n        .CharacterUnitFirstLineIndent = 0\n        .LineUnitBefore = 0\n        .LineUnitAfter = 0\n        .MirrorIndents = False\n        .TextboxTightWrap = wdTightNone\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1531332411, "post_id": 51291742, "comment_id": 89561198, "body": "mayber your <code>lastrow</code> is greater than16?"}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531333270, "post_id": 51291742, "comment_id": 89561578, "body": "As @ScottCraner said, does it ever even get into the <code>If</code> statement? Have you tried debugging and stepping through to see where the issue is?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1531333285, "post_id": 51291742, "comment_id": 89561583, "body": "Step through your code using <b>F8</b> and check the values of your variables. Possible logic error"}, {"owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1531334935, "post_id": 51291742, "comment_id": 89562344, "body": "@urdearboy when I debug it keeps running through the loop but when I actually run the macro, it just returns to A1 and stops."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1531335002, "post_id": 51291742, "comment_id": 89562378, "body": "Your code doesn&#39;t actually do anything except activate A1."}, {"owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531335502, "post_id": 51291742, "comment_id": 89562616, "body": "@SJR so how would I get it to loop back around and repeat?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1531335640, "post_id": 51291742, "comment_id": 89562678, "body": "repeat till when, right now if you got it working it would never end as it would start the loop over and over again.  It would probably help if you discussed what you are actually trying to accomplish in the code."}, {"owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531336192, "post_id": 51291742, "comment_id": 89562944, "body": "@ScottCraner trying to get it to auto scroll down, loop back to A1 and then repeat over and over (we run a job board in the shop where some of the tables are cut off, so this would allow them to be visible, then loop and repeat)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531336530, "post_id": 51291742, "comment_id": 89563095, "body": "for how long, forever?  change <code>For i = 1 To 14 Step 2</code> to <code>For i = 1 To lastRow Step 2</code> and append all <code>Range(..</code> and <code>Cells(...</code> with <code>ws.</code>"}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "edited": false, "score": 0, "creation_date": 1531403317, "post_id": 51299561, "comment_id": 89591389, "body": "When I ran this, it just froze halfway through the first scroll."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "edited": false, "score": 0, "creation_date": 1531404523, "post_id": 51299561, "comment_id": 89592269, "body": "Well, I tested it and it works as expected. Try to go through it step by step with F8 to see what happens and check the values of the variables. Copy it into a new workbook and eg fill 10 rows in column A with data to test it."}, {"owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "edited": false, "score": 0, "creation_date": 1531415572, "post_id": 51299561, "comment_id": 89598958, "body": "I got it; I just threw a do...loop around the autoscroll statement I had and now it works. Thank you!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1531380514, "last_edit_date": 1531380514, "creation_date": 1531380175, "answer_id": 51299561, "question_id": 51291742, "link": "https://stackoverflow.com/questions/51291742/why-wont-it-loop/51299561#51299561", "title": "Why won&#39;t it loop?", "body": "<p>The following example will scroll forever. But I suggest to use <code>DoEvents</code> and a stop switch otherwise it will really run forever and will not be stoppable.</p>\n\n<pre><code>Option Explicit\n\nPublic StopScroll As Boolean 'global switch to stop scrolling\n\nPublic Sub ScrollForever()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long\n    iRow = 1\n\n    StopScroll = False 'initialize scroll\n\n    Do\n        DoEvents 'make excel responsive\n        If StopScroll Then Exit Sub 'possibility to stop the scroll again\n\n        ActiveWindow.ScrollRow = iRow\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n        iRow = iRow + 1 'count 1 row up (change it to 2 for step 2)\n        iRow = IIf(iRow &gt; LastRow, 1, iRow) 'if last row is reached reset to 1\n    Loop While iRow &lt;= LastRow 'this is never true because of the line above and therefore runs forever\nEnd Sub\n</code></pre>\n\n<p>You can use the following eg. for a button to stop scrolling:</p>\n\n<pre><code>Public Sub StopIt()\n    StopScroll = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "is_accepted": false, "score": 0, "last_activity_date": 1531415679, "creation_date": 1531415679, "answer_id": 51311217, "question_id": 51291742, "link": "https://stackoverflow.com/questions/51291742/why-wont-it-loop/51311217#51311217", "title": "Why won&#39;t it loop?", "body": "<p>So All I did to the aforementioned code was add a do...loop and it now repeats:</p>\n\n<pre><code> Sub ReRunMacro()\n  Dim xMin As String\n  Dim lastRow As Long, i As Long\n  Dim ws As Worksheet\n  Dim validSheets() As Variant\n\n  Set ws = ActiveSheet\n\n  validSheets = Array(\"CNC Machining Cell 2\", \"CNC Grinding Cell\", \"CNC Turning Cell 1 &amp; 3\", \"CNC Turning Cell 2\")\n\n  If UBound(Filter(validSheets, ws.Name)) = -1 Then \n  Exit Sub \n  End If\n\n  lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n Do\n  For i = 1 To 14 Step 2\n        Cells(i, 1).Select\n        ActiveWindow.SmallScroll down:=1\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n        If i = lastRow - 2 Or i = lastRow - 1 Then\n        i = 0\n        Cells(1, 1).Select\n     End If\n   Next i\n   Range(\"A1\").Activate\n Loop\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 1036131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64c95a0f3d88a44a7aedd76a4088ba8?s=128&d=identicon&r=PG", "display_name": "rjwctm21", "link": "https://stackoverflow.com/users/1036131/rjwctm21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531415679, "creation_date": 1531332135, "last_edit_date": 1531379115, "question_id": 51291742, "link": "https://stackoverflow.com/questions/51291742/why-wont-it-loop", "title": "Why won&#39;t it loop?", "body": "<p>The auto scroll works fine, but I'm trying to get this to loop back around but once it returns to A1, it just stops and the macro seemingly is done. What did I do wrong?</p>\n\n<pre><code> Sub ReRunMacro()\n Dim xMin As String\n Dim lastRow As Long, i As Long\n Dim ws As Worksheet\n Dim validSheets() As Variant\n\n Set ws = ActiveSheet\n\n validSheets = Array(\"CNC Machining Cell 2\", \"CNC Grinding Cell\", \"CNC Turning Cell 1 &amp; 3\", \"CNC Turning Cell 2\")\n\n If UBound(Filter(validSheets, ws.Name)) = -1 Then \n Exit Sub \n End If\n\n lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n For i = 1 To 14 Step 2\n\n\n       Cells(i, 1).Select\n       ActiveWindow.SmallScroll down:=1\n       Application.Wait (Now + TimeValue(\"0:00:02\"))\n       If i = lastRow - 2 Or i = lastRow - 1 Then\n       i = 0\n       Cells(1, 1).Select\n    End If\n  Next i\n  Range(\"A1\").Activate\n\n  End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-reports"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1531349616, "post_id": 51291696, "comment_id": 89567917, "body": "The report section might automatically shrink by setting <code>CanShrink</code> setting to <code>True</code>, and then in the <code>Detail_Format</code> event, check the image path length and change the <code>Image.Visible</code>  property to <code>False</code> if it&#39;s zero length. Haven&#39;t tested but worth a try."}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 1, "last_activity_date": 1531343605, "creation_date": 1531343605, "answer_id": 51294233, "question_id": 51291696, "link": "https://stackoverflow.com/questions/51291696/dynamically-add-image-controls-on-access-report/51294233#51294233", "title": "Dynamically add image controls on Access report", "body": "<p>You can't add any controls to a report when Access is in Runtime mode. But you can easily resize the image control using VBA in one of the Report's <code>Format</code> methods. Assuming your Image control is named \"Image1\", and it is in the Detail section:</p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n\n    If Me.Image1.ImageHeight = 0 Then\n        Me.Image1.Height = 144  ' whatever minimum height you want\n        Me.Detail.Height = 144\n    Else\n        Me.Image1.Height = 1440 ' whatever the normal Image1 height is\n        Me.Detail.Height = 1530 ' whatever maximum detail height you want\n    Endif\n\nEnd Sub\n</code></pre>\n\n<p>That should be very close to what you need.</p>\n"}], "owner": {"reputation": 3, "user_id": 10066501, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wbuEsCOdoa0/AAAAAAAAAAI/AAAAAAAAAB4/_DnYJ_AU_yk/photo.jpg?sz=128", "display_name": "SchaadRak", "link": "https://stackoverflow.com/users/10066501/schaadrak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "accepted_answer_id": 51294233, "answer_count": 1, "score": 0, "last_activity_date": 1531349664, "creation_date": 1531331937, "last_edit_date": 1531349664, "question_id": 51291696, "link": "https://stackoverflow.com/questions/51291696/dynamically-add-image-controls-on-access-report", "title": "Dynamically add image controls on Access report", "body": "<p>I have a table in Access that has comments in one field and a file path to an associated picture in another. My report has the comment and then an image bound to the file path field underneath that comment. However, most comments do not have a picture with it, and the empty space between comments makes the report unnecessarily long.</p>\n\n<p>Is there a way in VBA to only add an image control if there is a file path and minimize the spacing between the pictureless comments? </p>\n"}, {"tags": ["vba", "excel", "automation"], "answers": [{"tags": [], "owner": {"reputation": 1806, "user_id": 4146351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2WTdU1bWVaQ/AAAAAAAAAAI/AAAAAAAABeg/yvJBsxf1slM/photo.jpg?sz=128", "display_name": "Eric Yang", "link": "https://stackoverflow.com/users/4146351/eric-yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1531331527, "creation_date": 1531331527, "answer_id": 51291597, "question_id": 51291561, "link": "https://stackoverflow.com/questions/51291561/log-files-for-excel-macros-when-run-with-automation/51291597#51291597", "title": "Log files for Excel macros when run with automation", "body": "<p>You'd have to import a library for logging. It doesn't do it automatically.</p>\n\n<p><a href=\"https://github.com/VBA-tools/VBA-Log\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-Log</a></p>\n\n<p>Would be a good place to start. You'd have to write your own callback to log it somewhere else though.</p>\n"}], "owner": {"reputation": 568, "user_id": 4980645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f69bb7a04beacc46989f6412e5c0038?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4980645/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 51291597, "answer_count": 1, "score": 1, "last_activity_date": 1531383245, "creation_date": 1531331387, "last_edit_date": 1531383245, "question_id": 51291561, "link": "https://stackoverflow.com/questions/51291561/log-files-for-excel-macros-when-run-with-automation", "title": "Log files for Excel macros when run with automation", "body": "<p>When an Excel macro, there are generally popups for what went wrong. Obviously this wont be the case if you're doing scheduled, automated runs with tools like Cruise Control or Bamboo. When an Excel macro fails, does it produce a log file somewhere? Are there other ways to determine what went wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1531329245, "post_id": 51290956, "comment_id": 89559702, "body": "Have you searched on here for any possible Q and A that does something similar? And I only ask you ask I know there are some... You should show some effort as this is not a &quot;free coding service&quot; where you post what you want and collect 24h later..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531329952, "post_id": 51290956, "comment_id": 89560086, "body": "Try recording a macro and see what they gives you, then edit your question with it."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531334925, "post_id": 51290956, "comment_id": 89562338, "body": "<a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/noattempt</a> - please do read this document properly. It will help you ask a much better question and in return you will receive a much better answer."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1531337747, "post_id": 51290956, "comment_id": 89563605, "body": "Have look at : <a href=\"https://stackoverflow.com/q/51283963/4961700\">stackoverflow.com/q/51283963/4961700</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10066264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63309da6be50e5c5c939e5c7c1492a48?s=128&d=identicon&r=PG&f=1", "display_name": "C2018", "link": "https://stackoverflow.com/users/10066264/c2018"}, "is_accepted": false, "score": 0, "last_activity_date": 1531383621, "creation_date": 1531383621, "answer_id": 51300597, "question_id": 51290956, "link": "https://stackoverflow.com/questions/51290956/excel-vba-pull-specific-worksheet-from-different-files-into-existing-workbook-a/51300597#51300597", "title": "Excel VBA: pull specific worksheet from different files into existing workbook and change name", "body": "<p>I have been using this code to pull in the worksheets, however the link to the folders do not alwys function especially if I change it.   ChDir (\"\\C:Test\") It also takes a long time opening and then closing files. And asking for updates to links everytime a workbook is opened. </p>\n\n<p>Dim DataName As String\n    Dim DataWB As Workbook\n    Dim File As String\n    Dim MasterWB As Workbook\n    Dim MScnt As Integer\n    Dim Snr As Integer</p>\n\n<pre><code>'Find out number of sheets in Master\nSet MasterWB = ActiveWorkbook\nMScnt = MasterWB.Sheets.Count\n\n'Switch to folder containing data workbooks\n'Use path from master for now\nChDir (\"\\\\C:Test\")\n\n'Find al xlsx workbooks in folder\nFile = Dir(\"*.xlsx\")\nWhile File &lt;&gt; \"\"\n    Debug.Print \"Processing file \" &amp; File\n    'Do not process yourself\n    If InStr(File, MasterWB.Name) = 0 Then\n        'Open data workbook\n        Set DataWB = Workbooks.Open(File, xlUpdateLinksNever, True)\n        DataWB.Activate\n        'Catch missing input sheet\n        On Error Resume Next\n        Snr = 0\n        Snr = Sheets(\"2. Hours Reconciliation\").Index\n        On Error GoTo 0\n        If Snr &gt; 0 Then\n            Sheets(Snr).Copy After:=MasterWB.Sheets(1)\n            MasterWB.Activate\n            'Rename added sheet; use data wb name for now\n        End If\n        MasterWB.Activate\n        DataWB.Close False\n    End If\n    'Next file\n    File = Dir()\nWend\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 10066264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63309da6be50e5c5c939e5c7c1492a48?s=128&d=identicon&r=PG&f=1", "display_name": "C2018", "link": "https://stackoverflow.com/users/10066264/c2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 573, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1531383621, "creation_date": 1531328990, "question_id": 51290956, "link": "https://stackoverflow.com/questions/51290956/excel-vba-pull-specific-worksheet-from-different-files-into-existing-workbook-a", "title": "Excel VBA: pull specific worksheet from different files into existing workbook and change name", "body": "<p>I am very new to VBA and am trying to do the following below</p>\n\n<p>For example: \nWorksheets' name is \"Sheet1\" I need to pull this specific sheet from many different files in different folders into an existing Workbook \"Workbook A\". </p>\n\n<ul>\n<li>Paste the new sheets as values</li>\n<li>Unprotect the sheet</li>\n<li>Then rename these new sheets based on a cell value's \"A2\" first 4 values</li>\n</ul>\n\n<p>Doing all this without altering the existing worksheets in Workbook A. Just applying this to the newly integrated sheets \"Sheet1\". </p>\n"}, {"tags": ["vba", "excel", "derivative"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531328940, "post_id": 51290792, "comment_id": 89559545, "body": "Instead of trying to read into the chart, read into the source data - where is it located?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1531329005, "post_id": 51290792, "comment_id": 89559578, "body": "I may have an suggestion but not sure (not y usual kind of math)  Sample data could be helpful.  On the other hand, as it is more a math question than programming, it could be better suited to <a href=\"https://math.stackexchange.com/help/on-topic\"><b>Stack Exchange Mathmatics</b></a>..."}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531329098, "post_id": 51290792, "comment_id": 89559627, "body": "@dwirony I have the source data located in columns A and F. they go between Rows 8 and 600. They are just numbers which make up the slopes in that image"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531329156, "post_id": 51290792, "comment_id": 89559657, "body": "I&#39;ve never used it but have you considered the SLOPE function?"}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531329256, "post_id": 51290792, "comment_id": 89559709, "body": "@SJR I have just learned that the slope function exists. I&#39;m wondering if running the slope in a loop across several rows at a time until it gets to the bottom might be the best way?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531329641, "post_id": 51290792, "comment_id": 89559934, "body": "Could you share a sample of your data?  If it &#39;s really just X &amp; Y coordinates and you just want to find the cloest point to a corner, then there are numerous examples online - <b>if you keep in mind that Lat/Long map coordinates are also an X/Y plot</b>, so all calculations would be interchangeable. Example: <a href=\"https://www.mrexcel.com/forum/excel-questions/860328-need-compare-latitude-longitude-coordinates-find-closest-office.html\" rel=\"nofollow noreferrer\"><i>Need to compare Latitude &amp; Longitude coordinates to find closest office</i></a>"}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "edited": false, "score": 0, "creation_date": 1531329718, "post_id": 51290792, "comment_id": 89559969, "body": "I started testing little sections of the data at a time to see the slope changes and it definitely would give a decent idea.  Does anyone know how to loop the slope function through 5 or less rows at a time to return slope numbers that could potentially be saved in another column?"}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531329756, "post_id": 51290792, "comment_id": 89559989, "body": "@ashleedawg  How do I put in excel data? I tried pasting it in and it just loaded a paragraph of numbers and not two columns."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531330226, "post_id": 51290792, "comment_id": 89560209, "body": "That sounds about right. You can do this worksheet formulae using OFFSET to resize the range."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531334299, "post_id": 51290792, "comment_id": 89562026, "body": "@isaac ...text-to-columns?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1531335157, "post_id": 51290792, "comment_id": 89562442, "body": "I think I&#39;d run a loop across the source data, compute a moving average, play by ear to find a good threshold, and when I reach a data point that&#39;s beyond the current average + threshold, call that my target data point, select it on the chart, make it bright red and enlarge it. Or something :)"}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "edited": false, "score": 0, "creation_date": 1531402793, "post_id": 51290792, "comment_id": 89591013, "body": "Thank you for the help so far. I&#39;ve been attempting a loop using the slope function and some testing seems to be giving promising results. However I haven&#39;t gotten it to work perfectly yet. I&#39;ll update back.  Thanks!"}, {"owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "edited": false, "score": 0, "creation_date": 1532710163, "post_id": 51290792, "comment_id": 90091466, "body": "I just edited my code in the original post to the most recent version. I was able to get most of the code working. Then I added the beginning code which allows me to run the macro over multiple files using a loop through an array.  However I started getting a weird runtime 1004 error or it pops up a box that says error 400 on the line that goes   Slope = WorksheetFunction.Slope(rng, rng.Offset(0, 1)  I&#39;m not sure what to do. I dont believe I changed the code but it stopped working and I don&#39;t understand. Ive tried it on other computers and one of them was working and now it doesnt either"}], "owner": {"reputation": 1, "user_id": 10066197, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c_HixO-f8zE/AAAAAAAAAAI/AAAAAAAAAV4/Ld9WdkvAx4Q/photo.jpg?sz=128", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10066197/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533046640, "creation_date": 1531328391, "last_edit_date": 1533046640, "question_id": 51290792, "link": "https://stackoverflow.com/questions/51290792/using-excel-macro-to-find-point-of-slope-change", "title": "Using Excel macro to find point of slope change", "body": "<p>EDIT: I have solved the issues that were addressed in this post. Thanks to everyone who helped. The basic solution was misplacing my code in the wrong module.</p>\n\n<p>I have some X &amp; Y data for Excel chart and need to <strong>find the location of the corner</strong> in the graph.</p>\n\n<p>Using a macro I started to evaluate the data but haven't been able to find the reasonable way to find a stark change in the slope to identify the corner.</p>\n\n<p>I have one column with X values and another with Y values. </p>\n\n<p><a href=\"https://i.stack.imgur.com/6mrRT.png\" rel=\"nofollow noreferrer\" title=\"Click to enlarge image.\"><img src=\"https://i.stack.imgur.com/6mrRTm.png\" alt=\"Image of Chart \" title=\"Click to enlarge image.\"></a></p>\n\n<p>If you look at the circle in the corner, I'm looking to find the location of that corner. it doesn't have to be perfectly accurate but as good as possible.</p>\n\n<p>Some of this code I found on other answers, but most of it was modified from the macro recorder. I'm still trying to make it work to get first and second derivatives. That's what those first two large blocks of code are trying to accomplish. I was hoping to use a local max or something like that in the derivatives to determine the corners location.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\nSub FindSlopeIncrease()\nDim lastrow As Long\nDim chtObj As ChartObject\nDim Slope As Double\nDim rng As Range\nDim Start As Integer\nDim Load As Integer\nDim DDate As String\nDim f As Variant\nDim src As Object\nDim myfile As Variant\nDim i As Integer\nDim mysheet As Variant\nDim x As Integer\nDim savefile As Workbook\n\nLet Slope = 0\nLet Start = 400 'cell value to start searching from\n\nDDate = Date\n\nCall Lights_Off 'Turns off screenupdating and warning messages to increase speed of macro\n\nmyfile = Application.GetOpenFilename(MultiSelect:=True) 'Returns filename as string to open .xls spreadsheets.\n    If TypeName(myfile) = \"False\" Then\n        Exit Sub\n    End If\n\n    Set savefile = Workbooks.Add\n    ActiveWorkbook.Activate\n    ActiveSheet.Range(\"A1\") = \"Load (N)\"\n\n    If IsArray(myfile) Then\n        For i = LBound(myfile) To UBound(myfile)\n        'Runs array to open multiple files at a time\n\n            Set src = Workbooks.Open(myfile(i), ReadOnly:=True)\n\n            Worksheets(1).Activate\n\n            For Each chtObj In ActiveSheet.ChartObjects\n                chtObj.Delete\n            Next\n\n            lastrow = ActiveSheet.UsedRange.Rows.Count + 1\n\n            ActiveSheet.Columns(6).ClearContents\n            ActiveSheet.Columns(7).ClearContents\n            ActiveSheet.Columns(8).ClearContents\n            ActiveSheet.Columns(9).ClearContents\n\n            ActiveSheet.Range(\"C8:C\" &amp; lastrow).Copy\n            ActiveSheet.Range(\"F8:F\" &amp; lastrow).PasteSpecial\n            ActiveSheet.Range(\"C8\").Copy\n            ActiveSheet.Range(\"F8:F\" &amp; lastrow).PasteSpecial Operation:=xlPasteSpecialOperationSubtract\n            ActiveSheet.Range(\"F6\") = \"Extension(mm)\"\n\n            For x = Start To lastrow\n                Set rng = Range(\"A\" &amp; x, \"A\" &amp; x + 2)\n                If x = Start Then\n                    Slope = WorksheetFunction.Slope(rng, rng.Offset(0, 1))\n                    GoTo 1\n                ElseIf WorksheetFunction.Slope(rng, rng.Offset(0, 1)) - 400 &gt;= Slope Then\n                    MsgBox \"Slope = \" &amp; Slope &amp; \" Cell value = \" &amp; x\n                    Let Load = Range(\"A\" &amp; x)\n                    MsgBox \"Can Contact load = \" &amp; Load &amp; \"N\"\n                    savefile.Activate\n                    ActiveWorkbook.ActiveSheet.Range(\"A\" &amp; i + 1) = [Load]\n                    GoTo 2\n                End If\n\n1:          Slope = WorksheetFunction.Slope(rng, rng.Offset(0, 1))\n            Next x\n2:\n            src.Close False\n            'Closes Spreadsheet after data has been saved\n            Set src = Nothing\n            Next i 'Goes to next \"i\": runs the next file in line for multiple file selections\n                Else\n            End If\nErrHandler:\n            Application.EnableEvents = True\n            Application.ScreenUpdating = True\n\n\nActiveWorkbook.SaveAs Filename:=Month(DDate) &amp; Day(DDate) &amp; Year(DDate) &amp; \" Can Contact Load Summary\", FileFormat:=xlWorkbookNormal, CreateBackup:=False\n\n    ActiveWorkbook.Close\n\n    Call Lights_On 'Turns screenupdating and Warning messages back on\nEnd Sub\n\nPublic Sub Lights_Off()\n\n    '\\\\ Turns OFF screen updating and warning messages to speed up macro.\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n\nEnd Sub\nPublic Sub Lights_On()\n\n    '\\\\ Turns ON screen updating and warning messages when macro stops.\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1531328527, "post_id": 51290606, "comment_id": 89559326, "body": "<i>Welcome to Stack Overflow!</i> be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (it earns you a badge too!) ...I think you&#39;re over-complicating your task  Do you know how to do this manually, with AutoFilter?  If so, record a macro of yourself doing whatever actions you want, and you code will be 90% written for you."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531328726, "post_id": 51290606, "comment_id": 89559431, "body": "see: <a href=\"//msdn.microsoft.com/vba/word-vba/articles/recording-a-macro-to-generate-code\" rel=\"nofollow noreferrer\"><b>Recording a Macro to Generate Code</b></a> as well as <a href=\"//msdn.microsoft.com/vba/word-vba/articles/revising-recorded-visual-basic-macros\" rel=\"nofollow noreferrer\"><b>Revising Recorded Visual Basic Macros</b></a>."}, {"owner": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531850448, "post_id": 51290606, "comment_id": 89747239, "body": "Hi,that&#39;s originally what I did.. I recorded the macro and tweaked it for my own use. It has worked for my previous file but not this one for some reason.."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "edited": false, "score": 0, "creation_date": 1531850489, "post_id": 51293614, "comment_id": 89747257, "body": "Hi,Thanks for your response! I just tested your code above and still ran into the same error on the &quot;rngToDelete.EntireRow.Delete&quot; part... :(:(:("}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "edited": false, "score": 0, "creation_date": 1531851961, "post_id": 51293614, "comment_id": 89747934, "body": "Is there another table on your sheet?"}, {"owner": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "edited": false, "score": 0, "creation_date": 1531858843, "post_id": 51293614, "comment_id": 89751236, "body": "OK.. so I changed the code to &quot; rngToDelete.Rows.Delete&quot; and for some reason that one worked instead. I am not sure why .EntireRow is giving me issues.... :("}, {"owner": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "edited": false, "score": 0, "creation_date": 1531858861, "post_id": 51293614, "comment_id": 89751247, "body": "Nope, I only have 1 table in my sheet."}, {"owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "edited": false, "score": 1, "creation_date": 1579687909, "post_id": 51293614, "comment_id": 105846368, "body": "had a similar problem <code>EntireRow.Delete</code> is the way it worked (there are other tables (vertically arranged) on the sheet and other stuff and the tables are not starting on column A)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1531340344, "creation_date": 1531340344, "answer_id": 51293614, "question_id": 51290606, "link": "https://stackoverflow.com/questions/51290606/getting-error-1004-when-deleting-filtered-rows/51293614#51293614", "title": "Getting error 1004 when deleting filtered rows?", "body": "<p>Since you have a <code>ListObject</code>, you can refer to a <code>ListColumn</code> by its header (\"Vendor Item?\") instead of <code>Find</code>ing the cell in row 2. </p>\n\n<p>Also, I'd refer to the <code>Index</code> of that <code>ListColumn</code>, not its <code>Column</code>, when you want to filter. The <code>Index</code> returns its column number within the table, while <code>Column</code> would be its column on the sheet. The two would coincide if your table starts in Column A (which it sounds like is the case here), but <code>Index</code> is more robust if your table's position changes.</p>\n\n<p>Finally, no need to <code>Activate</code> or <code>Select</code>. </p>\n\n<pre><code>Option Explicit\n\nSub DeleteVendorOnly()\n    Dim tbl As ListObject\n    Dim colIndex As Integer\n    Dim rngToDelete As Range\n\n    Set tbl = Sheets(\"Sheet1\").ListObjects(\"Table1\")  ' Change to your sheet name\n    colIndex = tbl.ListColumns(\"Vendor Item?\").Index\n\n    tbl.Range.AutoFilter Field:=colIndex, Criteria1:=\"Yes\"\n\n    On Error Resume Next\n        Set rngToDelete = tbl.DataBodyRange.SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If Not rngToDelete Is Nothing Then\n        rngToDelete.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4203549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1fd9214c599c43bd542eed2ec1bf5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ee Laine", "link": "https://stackoverflow.com/users/4203549/ee-laine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531340344, "creation_date": 1531327583, "last_edit_date": 1531328241, "question_id": 51290606, "link": "https://stackoverflow.com/questions/51290606/getting-error-1004-when-deleting-filtered-rows", "title": "Getting error 1004 when deleting filtered rows?", "body": "<p>I am trying to delete rows after filtering on a column that indicates whether an item is Vendor Only (Yes/No). </p>\n\n<p>I want to delete all rows where the values under that column indicate Yes. However, I run into an error when I select the visible rows to delete.</p>\n\n<p>I've used this same code for other macros before but this time it did not work.  </p>\n\n<pre><code>Dim VisibleCell As Long 'Variable to count the number of visible cells after filtering\n\nVisibleCell = Application.WorksheetFunction.Subtotal(3, Range(\"A3:A50000\"))\nRange(\"Table1\").Select\n\n'Filter and remove all Vendor Only items\nRows(\"2:2\").Select 'Find column for Vendor Only and filter for Yes values\n    Cells.Find(What:=\"Vendor Item?\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n\nMyCol = ActiveCell.Column\nActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=MyCol, Criteria1:= _\n    \"Yes\", Operator:=xlAnd\nVisibleCell = Application.WorksheetFunction.Subtotal(3, Range(\"A3:A50000\"))\n\nIf VisibleCell &gt; 0 Then\n    Range(\"A3:A2000\").SpecialCells(xlCellTypeVisible).Select\n    Selection.EntireRow.Delete 'Error occurs here\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "fileopener2"], "comments": [{"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531327967, "post_id": 51290597, "comment_id": 89559067, "body": "You should avoid <code>On Error Resume Next</code> like the plague.  Remove that, test it with every scenario and see what, if any, error is actually returned.  Then trap for that specific error.  Personally, I would also add code to make sure the file even exists at all."}, {"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531329936, "post_id": 51290597, "comment_id": 89560077, "body": "removed the On Error Resume Next and received Runtime error &#39;9&#39; Subscript out of Range on this line"}, {"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531329941, "post_id": 51290597, "comment_id": 89560079, "body": "Set wBook = Workbooks(&quot;X:\\Audit Tracking\\Team_Larry\\DailyReports\\Larry_Blank.xlsm&quot;)"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531330101, "post_id": 51290597, "comment_id": 89560162, "body": "That&#39;s because Workbooks is interpreted as an undimensioned array.  You&#39;re apparently not using the correct syntax to open a workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531330171, "post_id": 51290597, "comment_id": 89560193, "body": "@BillHileman <code>Workbooks</code> is an object collection, not an array. Error 9 is thrown when the specified file doesn&#39;t exist in the collection, which is exactly by design. OP isn&#39;t trying to open anything here."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1531330310, "post_id": 51290597, "comment_id": 89560254, "body": "Thanks, Mathieu, I don&#39;t work with spreadsheets so I did not pick up on that.  Makes sense - an error 9 works the same way with collections as arrays.  So that&#39;s specifically what you should be checking for, @rholdren."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531330890, "post_id": 51291322, "comment_id": 89560508, "body": "The workbook does exist but when I copy and paste the code from above I&#39;m still getting &quot;Larry&#39;s workbook is not open&quot; but it is"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531330918, "post_id": 51291322, "comment_id": 89560525, "body": "@rholdren is it opened <b>on another computer</b>? Take the time to read the top part of this answer."}, {"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531331305, "post_id": 51291322, "comment_id": 89560693, "body": "copied and pasted about and entered the file is open and still tell me it&#39;s not"}, {"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531331399, "post_id": 51291322, "comment_id": 89560740, "body": "I have it open on my computer"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531331502, "post_id": 51291322, "comment_id": 89560781, "body": "Compare the path you&#39;re using to <code>Debug.Print Workbooks(1).FullName</code> (or <code>Workbooks(2).FullName</code>, depending on whether the file was opened first or second). <b>If someone else has it opened on another machine, you will not be able to know</b>. Excel will tell you."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531332263, "post_id": 51291322, "comment_id": 89561139, "body": "@rholdren edited with more ideas... that said I don&#39;t know why you&#39;d need a macro to tell you whether you have a given workbook opened on your own machine... you don&#39;t know what workbooks you&#39;re opening?"}, {"owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531332460, "post_id": 51291322, "comment_id": 89561221, "body": "I have an audit team who when they post an audit score it goes from the auditor file to a supervisor file.  If the supervisor file is open the audit won&#39;t post.  It was my hope that in the beginning of the posit process I could have the auditor notified that the file was already open that way they would know to send an email to the supervisor to close the file."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "edited": false, "score": 0, "creation_date": 1531332702, "post_id": 51291322, "comment_id": 89561327, "body": "@rholdren if &quot;the auditor&quot; and &quot;the supervisor&quot; are two different persons on two different computers that potentially have the same file-on-the-network opened, then you&#39;re trying to determine whether <code>Application.Workbooks</code> contains a file that someone else has opened, and for one more time, <i>you can&#39;t do that</i>. See if <a href=\"https://support.office.com/en-us/article/collaborate-on-excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104\" rel=\"nofollow noreferrer\"><b>co-authoring</b></a> features can help, or research how to make the workbook a <i>shared workbook</i>."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1531332182, "last_edit_date": 1531332182, "creation_date": 1531330443, "answer_id": 51291322, "question_id": 51290597, "link": "https://stackoverflow.com/questions/51290597/issues-with-detecting-open-file/51291322#51291322", "title": "Issues with detecting open file", "body": "<blockquote>\n  <p><em>it was telling me it was not open when it was and when it wasn't</em></p>\n</blockquote>\n\n<p>The <code>Application.Workbooks</code> collection contains all the workbooks opened <strong>in this instance</strong> of <code>Excel.Application</code>; if the workbook is opened by someone else on another machine, it's not in the collection and you can't use that method to know this.</p>\n\n<p>If you're using the latest &amp; greatest Excel 2016 on Office 365, see how you can dismiss that concern altogether using <a href=\"https://support.office.com/en-us/article/collaborate-on-excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104\" rel=\"nofollow noreferrer\">co-authoring</a> features.</p>\n\n<p>Otherwise, you can try <em>sharing</em> the workbook and then Excel can tell you exactly who has it opened, but then <em>shared workbooks</em> has a number of issues, including but not limited to, the inability to edit VBA code.</p>\n\n<p>Using a hard-coded path is a good way to get false negatives, too. Open the file, verify its actual <code>FullName</code> and use that.</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To Application.Workbooks.Count\n    Debug.Print Application.Workbooks(i).FullName\nNext\n</code></pre>\n\n<p>If the file's location doesn't really matter, only its file name, you can iterate the opened files and see if one has a matching file name:</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To Application.Workbooks.Count\n    If Application.Workbooks(i).Name = \"Larry_Blank.xlsm\" Then\n        MsgBox \"File is opened.\"\n        Exit For\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1531332941, "creation_date": 1531332941, "answer_id": 51291927, "question_id": 51290597, "link": "https://stackoverflow.com/questions/51290597/issues-with-detecting-open-file/51291927#51291927", "title": "Issues with detecting open file", "body": "<p><a href=\"https://i.stack.imgur.com/qhJik.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qhJik.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When you open an Excel workbook a hidden temporary copy of the workbook will be created.  This is presumably used to recovery crashed files.  Notice that the temporary workbook's name and path is the same as the actual workbook but has <code>~$</code> prefixed to the filename.  Since the file path remains the same, we can assume that the \u2193`isWorkbookOpen()\u2193 will work even with mapped and shared folders.</p>\n\n<pre><code>Function isWorkbookOpen(Path As String) As Boolean\n    Dim values() As String\n    values = Split(Path, \"\\\")\n    values(UBound(values)) = \"~$\" &amp; values(UBound(values))\n    Path = Join(values, \"\\\")\n\n    isWorkbookOpen = Len(Dir(Path, vbHidden)) &gt; 0\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 0, "last_activity_date": 1531334775, "last_edit_date": 1531334775, "creation_date": 1531334446, "answer_id": 51292246, "question_id": 51290597, "link": "https://stackoverflow.com/questions/51290597/issues-with-detecting-open-file/51292246#51292246", "title": "Issues with detecting open file", "body": "<p>I believe your code will test if you have it open, on the computer your running the code from.</p>\n\n<p>This code will open the workbook, if it opens in a read only state then someone else has it open.  Note: If you open it on your computer, and then run this code on the same computer it will report that it's not in a read only state.</p>\n\n<pre><code>Sub Test()\nDim oWB As Workbook\n\nSet oWB = Application.Workbooks.Open(\"C:\\Temp\\test.xlsx\")      \n\nIf oWB.ReadOnly Then\n    MsgBox \"Open\"\nElse\n    MsgBox \"Closed\"\nEnd If\noWB.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9807643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32abaef2920baead2b672735675fc8a1?s=128&d=identicon&r=PG&f=1", "display_name": "rholdren", "link": "https://stackoverflow.com/users/9807643/rholdren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1531334775, "creation_date": 1531327551, "last_edit_date": 1531329621, "question_id": 51290597, "link": "https://stackoverflow.com/questions/51290597/issues-with-detecting-open-file", "title": "Issues with detecting open file", "body": "<p>I have literally copied and pasted and tested every bit of code from may BBs and the same thing happens with all of them.  they all either tell me that that the file is open if it's open or closed or they tell me that the file is closed when it is open or closed.  The code never gets it correct.  Here is the last thing I tried and it was telling me it was not open when it was and when it wasn't</p>\n\n<p>Can someone tell me if this is due to the file being located on the network</p>\n\n<pre><code>Sub Is_WorkBook_Open()\n\n    Dim wBook As Workbook\n\n\n\n    On Error Resume Next\n\n\n    Set wBook = Workbooks(\"X:\\Audit Tracking\\Team_Larry\\DailyReports\\Larry_Blank.xlsm\")\n\n    'Not open\n\n    If wBook Is Nothing Then\n\n        MsgBox \"Larry's Workbook is not open, Proceed to posting\", vbCritical\n\n        Set wBook = Nothing\n\n        On Error GoTo 0\n\n        'It is open\n    Else\n\n        MsgBox \"Yes it is open, Notify Supervisor to close file\", vbInformation\n\n        Set wBook = Nothing\n\n        On Error GoTo 0\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531329588, "post_id": 51290442, "comment_id": 89559899, "body": "So what&#39;s wrong with your existing code, are you getting an error? Is nothing pasting over? Can you provide us some sample data (or show us how your dates are being formatted)? Your code works fine for me."}, {"owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531330256, "post_id": 51290442, "comment_id": 89560230, "body": "I am not getting an error, it is just not filling any cells in &quot;Sheet3&quot; under the right conditions it will work when I use <code>isEmpty(Range(&quot;V&quot; &amp; e)) = True</code>, but it will also paste over the blank cells putting me back where I started.  The dates are formatted like 7/11/2018 1:29PM in the C column (Where the excel serial number is coming from).  These dates are from a SQL server and come with the data about the bins."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531333192, "post_id": 51290442, "comment_id": 89561541, "body": "It looks like you need to increment <code>i</code> even if your <code>If</code> statement doesn&#39;t return <code>True</code>."}, {"owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531334255, "post_id": 51290442, "comment_id": 89562003, "body": "The paste destination is dependent on <code>i</code>, so iterating <code>i</code> would not paste the values together, i.e. stacked in the same column.  I tried you solution and it did not work.  Thank you though!"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1531335278, "post_id": 51290442, "comment_id": 89562498, "body": "It looks like your dateserials are in multiple columns, but you&#39;re only checking column V?  Are your dateserials in column V?  The screenshot doesn&#39;t include column letters, so can&#39;t validate."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531339699, "post_id": 51290442, "comment_id": 89564466, "body": "@BenGribbin Maybe I&#39;m just not understanding what you&#39;re trying to do - but like tigeravatar said, if your dates are in multiple columns then you need to loop through the entire range, instead of just one column. Something like <code>For Each cell in Range(&quot;V2:Z&quot; &amp; EndRow)</code>..."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1531339831, "post_id": 51290442, "comment_id": 89564529, "body": "It would help if your screenshot included the rows and columns to try to match with what you&#39;re doing."}, {"owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1531365222, "post_id": 51290442, "comment_id": 89570919, "body": "@dwirony I am just trying to do one column at a time so I can get down a proof o f concept, but you are right; my range is 7 columns wide that I am trying to repeat this process on.  However, the problem is not being able to compare times in my if statement or use isEmpty().  I think something may be wrong with the way the data is formatted."}, {"owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "edited": false, "score": 0, "creation_date": 1531365242, "post_id": 51290442, "comment_id": 89570922, "body": "Also I updated the picture to give you guys more context."}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1531371485, "post_id": 51290442, "comment_id": 89572187, "body": "Have you tried if (IsNumeric(Cells (e, 22) and Cells(e, 22).Value &gt; DateValue(&quot;April 19, 2011&quot;))?"}, {"owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "edited": false, "score": 0, "creation_date": 1531398689, "post_id": 51290442, "comment_id": 89588050, "body": "Tried it, and each part of the <code>if</code> and it did not work."}], "owner": {"reputation": 11, "user_id": 10064993, "user_type": "registered", "profile_image": "https://graph.facebook.com/2169287259753224/picture?type=large", "display_name": "BennyG123", "link": "https://stackoverflow.com/users/10064993/bennyg123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531367006, "creation_date": 1531326982, "last_edit_date": 1531367006, "question_id": 51290442, "link": "https://stackoverflow.com/questions/51290442/excel-vba-combine-dates-that-are-spaced-out-into-a-seperate-sheet", "title": "Excel VBA: Combine dates that are spaced out into a seperate sheet", "body": "<p>I am trying to take data that is randomly spaced out in a column and combine it into another sheet. The data that I am trying to move is an excel serial number and so I can not use <code>isEmpty() = False</code> or <code>.Value &gt; 1</code> in my if statement. April 11th is an arbitrary date that all the other dates come after.  The problem is in my if statement. Been stuck on this for a while.</p>\n\n<p>So far I have the following code:</p>\n\n<pre><code>EndRow = Range(\"V\" &amp; Rows.Count).End(xlUp).Row\n\ni = 1\n\nFor e = 27 To EndRow\n\nIf Cells(e, 22).Value &gt; DateValue(\"April 19, 2011\") Then\n\n    Sheets(\"Sheet1\").Range(\"V\" &amp; e).Copy\n    Sheets(\"Sheet3\").Range(\"B\" &amp; i).PasteSpecial xlPasteValues\n    i = i + 1\n\nEnd If\nNext e\n</code></pre>\n\n<p>In the photo it shows the data I am working with.  I am trying to calculate the time it takes to empty a bin.  A \"1\" signifies the bin is running a \"0\" signifies it is not.  Whenever there is a 0 then a 1 (a start) in the cell beneath it, the timestamp is given.  Same for 0 then a 1 (a Stop).</p>\n\n<p><a href=\"https://i.stack.imgur.com/rgisV.png\" rel=\"nofollow noreferrer\">Excel Sheet</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3887, "user_id": 7914637, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x_BhuHcC8Ww/AAAAAAAAAAI/AAAAAAAAABg/hiPWIjRXbhI/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7914637/alexander"}, "edited": false, "score": 0, "creation_date": 1531330066, "post_id": 51290405, "comment_id": 89560147, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6863940/how-to-copy-sheets-to-another-workbook-using-vba\">How to copy sheets to another workbook using vba?</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1531328576, "last_edit_date": 1531328576, "creation_date": 1531327223, "answer_id": 51290508, "question_id": 51290405, "link": "https://stackoverflow.com/questions/51290405/create-a-new-workbook-with-some-of-the-sheets-of-the-old-one/51290508#51290508", "title": "Create a new workbook with some of the sheets of the old one", "body": "<p>Make copies of the other worksheets as well.</p>\n\n<pre><code>'copy first ws to no location to create the workbook then loop through\n'and make copies of the others\ndim ewb as workbook, w as long\nwith thisworkbook\n    .worksheets(1).copy\n    set ewb = activeworkbook\n    for w = 2 to 4\n        .worksheets(w).copy after:=ewb.worksheets(ewb.worksheets.count)\n    next w\n    'work with the new workbook as ewb \nend with\n\n'alternately, copy them into a new workbook all at once\nDim wss As Variant, nwb As Workbook\n\nwss = Array(\"Sheet12\", \"Sheet13\", \"Sheet14\", \"Sheet15\")  '&lt;~~ desired worksheets to copy\n\nWith ThisWorkbook\n    .Worksheets(wss).Copy\n    Set nwb = ActiveWorkbook\n    'work with the new workbook as nwb\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10066132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94b71549264a0895b9bf53cba3de1a9?s=128&d=identicon&r=PG&f=1", "display_name": "V&#237;ctor Fern&#225;ndez", "link": "https://stackoverflow.com/users/10066132/v%c3%adctor-fern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 51290508, "answer_count": 1, "score": 1, "last_activity_date": 1531383202, "creation_date": 1531326815, "last_edit_date": 1531383202, "question_id": 51290405, "link": "https://stackoverflow.com/questions/51290405/create-a-new-workbook-with-some-of-the-sheets-of-the-old-one", "title": "Create a new workbook with some of the sheets of the old one", "body": "<p>I have a workbook with around 10 sheets, and I would like a macros that creates a new workbook with 4 sheets of the original. </p>\n\n<p>I have this:</p>\n\n<pre><code>Sheets(\"1\").Range(\"A1:xfd200\").Copy\nWorkbooks.Add\nActiveSheet.Paste Destination:=Range(\"A1\")\n</code></pre>\n\n<p>But that only creates a new workbook with one of the sheets I need.</p>\n\n<p>I would appreciate any help.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1531327340, "post_id": 51290371, "comment_id": 89558788, "body": "This answer <a href=\"https://stackoverflow.com/a/19157769/5103770\">stackoverflow.com/a/19157769/5103770</a> should help to get you started."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1531332979, "post_id": 51290371, "comment_id": 89561446, "body": "@Stadem I have edited a the Question to incorporate my current VBA Code. How do I move down one row for both Range(&quot;A5&quot;) and Range(&quot;K5&quot;)?"}, {"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1531342365, "post_id": 51290371, "comment_id": 89565504, "body": "As you mentioned, use a loop. Go back to @GlennFromIowa&#39;s answer <a href=\"https://stackoverflow.com/a/50380337/5103770\">stackoverflow.com/a/50380337/5103770</a> to your previous question and try using the Do While Loop that he suggested. Make sure you understand what&#39;s happening in the &quot;Do While _____&quot; condition check so that you don&#39;t get stuck in an infinite loop. You&#39;ll use lines like <code>FileName1 = wsOriginalWorksheet.Range(&quot;A&quot;&amp;SourceRow).Value</code>. And if you get super-frustrated, it&#39;s probably because of the Record Macro Tool lines. They got you this far, now it&#39;s time to replace them. Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "is_accepted": true, "score": 0, "last_activity_date": 1531415412, "creation_date": 1531415412, "answer_id": 51311149, "question_id": 51290371, "link": "https://stackoverflow.com/questions/51290371/how-to-open-multiple-excel-workbooks-using-vba-referencing-cells-in-another-work/51311149#51311149", "title": "How to Open Multiple Excel workbooks using VBA referencing cells in another workbook for the path and name", "body": "<p>Thanks Everyone for all your Help. I seem to have figured it out. Here's what I got if anyone else is wondering.</p>\n\n<pre><code>Sub Macro2()\n\nApplication.ScreenUpdating = False\n\nDim sFile As String\nDim wb As Workbook\nDim FileName1 As String\nDim FileName2 As String\nDim wksSource As Worksheet\nConst scWkbSourceName As String = \"theFILE 1.1.xlsm\"\n\nSet wkbSource = Workbooks(scWkbSourceName)\nSet wksSource = wkbSource.Sheets(\"Sheet1\") ' Replace Sheet1 with the sheet name\n\nConst wsOriginalBook As String = \"theFILE 1.1.xlsm\"\nConst sPath As String = \"E:\\ParentFolder\\theFILES\\\"\n\nSourceRow = 5\n\nDo While Cells(SourceRow, \"D\").Value &lt;&gt; \"\"\n\nFileName1 = wksSource.Range(\"A\" &amp; SourceRow).Value\nFileName2 = wksSource.Range(\"K\" &amp; SourceRow).Value\n\nsFile = sPath &amp; FileName1 &amp; \"\\\" &amp; FileName2 &amp; \".xlsm\"\n\nSet wb = Workbooks.Open(sFile)\n\n''FORMAT TXT\nRange(\"J10\").Select\nSelection.Font.Italic = True\n\nRange(\"I3\").Select \nSelection.Font.Bold = True\n\n''RENAME COLUMN HEADERS\nRange(\"G19\").Select\nActiveCell.FormulaR1C1 = \"WHO MADE THIS?\"\n    Selection.Font.Bold = True\nColumns(\"G:G\").ColumnWidth = 18.57\n\nRange(\"H19\").Select\nActiveCell.FormulaR1C1 = \"MANU\"\n    Selection.Font.Bold = True\nColumns(\"H:H\").ColumnWidth = 23.29\n\n''ADD COMPANY\nRange(\"I4\").Select\nApplication.WindowState = xlNormal\nWindows(\"theFILE 1.1.xlsm\").Activate\nRange(\"D5\").Select\nSelection.Copy\nWindows(FileName2).Activate\nActiveSheet.Paste\nApplication.CutCopyMode = False\nRange(\"I4\").Select\n\n\n'''CLOSE WORKBOOK W/O BEFORE SAVE FUNCTION\nApplication.EnableEvents = False\nActiveWorkbook.Save\nActiveWorkbook.Close\nApplication.EnableEvents = True\n\nSourceRow = SourceRow + 1 ' Move down 1 row for source sheet\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 51311149, "answer_count": 1, "score": 0, "last_activity_date": 1594209974, "creation_date": 1531326714, "last_edit_date": 1594209974, "question_id": 51290371, "link": "https://stackoverflow.com/questions/51290371/how-to-open-multiple-excel-workbooks-using-vba-referencing-cells-in-another-work", "title": "How to Open Multiple Excel workbooks using VBA referencing cells in another workbook for the path and name", "body": "<p>How can I open multiple Excel Workbooks one at a time using VBA? I created 3200 Similar Workbooks and now I need to change some formatting. I would like to create a Loop function to open the first workbook based on a master list starting on Line 5. The general Path is the same for all but each workbook is in it's own folder. The folder was created based on a column and the Workbook Document was created using another Column. </p>\n\n<pre><code>Sub Macro2()\n\nApplication.ScreenUpdating = False\n\nDim sPath As String\nDim sFile As String\nDim wb As Workbook\n\n\nFileName1 = Range(\"A5\")\nFileName2 = Range(\"K5\")\n\nsPath = \"E:\\PARENTFOLDER\\theFILES\\\"\nsFile = sPath &amp; FileName1 &amp; \"\\\" &amp; FileName2 &amp; \".xlsm\"\n\nSet wb = Workbooks.Open(sFile)\n\n''FORMAT TXT\nRange(\"J10\").Select 'clamp design\nSelection.Font.Italic = True\n\nRange(\"I3\").Select 'utility parent \nSelection.Font.Bold = True\n\n''RENAME COLUMN HEADERS\nRange(\"G19\").Select\nActiveCell.FormulaR1C1 = \"TXTa?\"\n    Selection.Font.Bold = True\nColumns(\"G:G\").ColumnWidth = 18.57\n\nRange(\"H19\").Select\nActiveCell.FormulaR1C1 = \"TXTb\"\n    Selection.Font.Bold = True\nColumns(\"H:H\").ColumnWidth = 23.29\n\n''COPY\nRange(\"I4\").Select\nApplication.WindowState = xlNormal\nWindows(\"theFILE 1.1.xlsm\").Activate\nRange(\"D5\").Select\nSelection.Copy\nWindows(FileName2).Activate\nActiveSheet.Paste\nApplication.CutCopyMode = False\nRange(\"I4\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Then I need to open the next workbook 1 line down and so on until empty cells.\nA5 becomes A6 While K5 becomes K6 and so on and so forth.</p>\n\n<p>I am aware I cheated and used Excel's Record Macro Tool.</p>\n\n<p>Any and all Help is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "macos", "excel-formula"], "comments": [{"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 1, "creation_date": 1531327200, "post_id": 51290293, "comment_id": 89558703, "body": "&quot;Would work, but isn&#39;t&quot; What error pops?"}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 1, "last_activity_date": 1531327437, "creation_date": 1531327437, "answer_id": 51290568, "question_id": 51290293, "link": "https://stackoverflow.com/questions/51290293/excel-vba-write-formula-referencing-cell-values/51290568#51290568", "title": "Excel VBA - Write Formula referencing cell values", "body": "<p>Try to do something equivalent as:</p>\n\n<pre><code>Sub Sum()\n\n    With Sheets(\"Sheet1\")\n        .Cells(3, 1).Formula = \"=SUM(\" &amp; .Cells(1, 1).Value &amp; \"+\" &amp; .Cells(2, 1).Value &amp; \")\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This particular code worked for me.\nPay attention to the Sheet name and the cells you need to use.</p>\n\n<p>I know you need to turn the Row and Column numbers into iterable indexes, but that's easy from here.</p>\n"}], "owner": {"reputation": 9, "user_id": 10066079, "user_type": "registered", "profile_image": "https://graph.facebook.com/1311595765556412/picture?type=large", "display_name": "Tushar Agarwal", "link": "https://stackoverflow.com/users/10066079/tushar-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593629055, "creation_date": 1531326458, "last_edit_date": 1593629055, "question_id": 51290293, "link": "https://stackoverflow.com/questions/51290293/excel-vba-write-formula-referencing-cell-values", "title": "Excel VBA - Write Formula referencing cell values", "body": "<p>I am trying to enter a formula in a cell referencing cells which will be filled manually.\nFor example, <code>A3</code> references <code>A1</code> and <code>A2</code>, but those two values will be filled by me.</p>\n\n<p>In this case, <code>cell [dateColumnCounter][r] = [dateColumnCounter][r+!] - [dateColumnCounter][r+2]</code></p>\n\n<p>I can't use direct cell names unfortunately because those will change based on the counter values.</p>\n\n<p>This is what I thought would work, but doesn't:</p>\n\n<pre><code>Worksheets(\"Hours\").Cells(r, dateColumnCounter).Formula = \"=\" &amp; \nWorksheets(\"Hours\").Cells(r+1, dateColumnCounter).Value &amp; \"-\" &amp; \nWorksheets(\"Hours\").Cells(r+2, dateColumnCounter).Value\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1531329177, "post_id": 51290036, "comment_id": 89559665, "body": "How robust do you need it to be?  Does it need to keep track of the different areas after you close the workbook? Or will there be a cleanup routine when the Workbook is opened to clear the &quot;Cache&quot;?"}, {"owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1531330347, "post_id": 51290036, "comment_id": 89560271, "body": "The information on sheet &quot;A&quot; will be deleted using another macro after it has been pasted on to sheet &quot;B&quot;. I don&#39;t think the function can work when the workbook is closed too. It&#39;s fine if the function can just work when the workbook is open. However if the function can work if the workbook is closed, that would be a bonus. The &quot;Cache&quot; will only be cleared using the macro above, nothing else. My problem is that once the information is cleared on sheet &quot;A&quot;, the function will not work."}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1531336666, "post_id": 51290036, "comment_id": 89563170, "body": "In your delete function, why are you taking the <code>NoOfCrew</code> from the last row in the <code>&quot;Hotel Booking&quot;</code> sheet, and then using it in the <code>&quot;Cache&quot;</code> sheet?  Also, do you want to have the delete function just delete a portion of the data, or the entire cache?"}, {"owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1531360618, "post_id": 51290036, "comment_id": 89570048, "body": "I realized my mistake and tried using the number of crew from the &quot;Cache&quot; sheet but it still does not work when I run the macro multiple times. I only want the delete function to delete what it copied and pasted onto the &quot;Cache&quot; sheet. eg, if I enter 3 rows of information on &quot;Hotel Booking&quot; and run the macro, and I then delete the information from &quot;Hotel Booking&quot; and insert 4 rows of different information and run the macro again, the macro should delete accordingly. First delete the initial 3 rows, then the 4 rows, according to when they were run."}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1531411112, "creation_date": 1531411112, "answer_id": 51310071, "question_id": 51290036, "link": "https://stackoverflow.com/questions/51290036/excel-vba-delete-after-timer/51310071#51310071", "title": "Excel VBA Delete after timer", "body": "<p>You need to keep track of the number or rows that are copied each time, and perhaps the starting row...but as I type this I realize that the starting row isn't required and just complicates matters.  Anyway, I already fixed it up with the starting row, so here it is...</p>\n\n<pre><code>Type CacheArea\n    StartingRow As Long\n    Rows As Long\nEnd Type\n\nPrivate PasteCache() As CacheArea, CacheCount As Long\n\nSub Cache()\nDim NoOfCrew As Long\n\n    NoOfCrew = Sheets(\"Cache\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    NoOfCrew = NoOfCrew + 1\n\n    Sheets(\"Hotel Booking\").Range(\"Q10:U19\").Copy\n    Sheets(\"Cache\").Range(\"A\" &amp; NoOfCrew).PasteSpecial\n\n    Sheets(\"Hotel Booking\").Range(\"X10:X19\").Copy\n    Sheets(\"Cache\").Range(\"F\" &amp; NoOfCrew).PasteSpecial\n\n    ReDim Preserve PasteCache(CacheCount)\n    With PasteCache(CacheCount)\n        .StartingRow = NoOfCrew\n        .Rows = Sheets(\"Hotel Booking\").Range(\"X10:X19\").Rows.Count\n    End With\n    CacheCount = CacheCount + 1\n\n    Application.CutCopyMode = False\n    Run \"DelayMacro\"\nEnd Sub\n\n\nSub Delete()\nDim NoOfCrew As Long, Row As Long\n\n    If CacheCount &gt; 0 Then\n        Row = PasteCache(0).StartingRow\n        NoOfCrew = PasteCache(0).Rows\n        Sheets(\"Cache\").Range(\"A\" &amp; Row &amp; \":F\" &amp; Row + NoOfCrew - 1).Delete shift:=xlUp\n    End If\n\n    ' Shift all the values up in the buffer \n    ' Not required if we don't use .StartingRow and just assume that you are deleting from the top\n    For i = 1 To CacheCount - 1\n        PasteCache(i - 1) = PasteCache(i)\n        ' Adjust all the starting rows down by the number of rows deleted.\n        PasteCache(i - 1).StartingRow = PasteCache(i - 1).StartingRow - Rows\n    Next\n\n    ' Remove the extra entry\n    If CacheCount &gt; 0 Then\n        ReDim Preserve PasteCache(CacheCount - 1)\n        CacheCount = CacheCount - 1\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10030544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123ee3285f0c018b207aaa441fde9db5?s=128&d=identicon&r=PG&f=1", "display_name": "quantamz", "link": "https://stackoverflow.com/users/10030544/quantamz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531411112, "creation_date": 1531325559, "last_edit_date": 1531332012, "question_id": 51290036, "link": "https://stackoverflow.com/questions/51290036/excel-vba-delete-after-timer", "title": "Excel VBA Delete after timer", "body": "<p>I want to copy and paste a bunch of information from <code>sheet A</code> to <code>sheet B</code> and I want to delete the information from <code>sheet B</code> after a certain time frame. However, the macro should be able to run multiple times and subsequent information from <code>sheet A</code> should be pasted below the current information pasted on <code>sheet B</code> that has not been deleted yet. My current code can do this but I have a problem where by if I paste more information on <code>sheet B</code> the second time, the deleting function will mess up.</p>\n\n<p>Copy and Paste Function:</p>\n\n<pre><code>Sub Cache()\n\nDim NoOfCrew As Long\n\nNoOfCrew = Sheets(\"Cache\").Cells(Rows.Count, \"A\").End(xlUp).Row\nNoOfCrew = NoOfCrew + 1\n\nSheets(\"Hotel Booking\").Range(\"Q10:U19\").Copy\nSheets(\"Cache\").Range(\"A\" &amp; NoOfCrew).PasteSpecial\n\nSheets(\"Hotel Booking\").Range(\"X10:X19\").Copy\nSheets(\"Cache\").Range(\"F\" &amp; NoOfCrew).PasteSpecial\n\nApplication.CutCopyMode = False\nRun \"DelayMacro\"\nEnd Sub\n</code></pre>\n\n<p>Delete Function:</p>\n\n<pre><code>Sub Delete()\n\nDim NoOfCrew As Long\n\nNoOfCrew = Sheets(\"Hotel Booking\").Cells(Rows.Count, \"Q\").End(xlUp).Row\nNoOfCrew = NoOfCrew - 8\n\nSheets(\"Cache\").Range(\"A2:F\" &amp; NoOfCrew).Delete shift:=xlUp\n\nEnd Sub\n</code></pre>\n\n<p>Delay Function:</p>\n\n<pre><code>Sub DelayMacro()\n\nApplication.OnTime Now() + TimeValue(\"00:00:10\"), \"Delete\"\n\nEnd Sub\n</code></pre>\n\n<p>Also asked this on:</p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-vba-macros/1205362-excel-vba-delete-after-timer\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-vba-macros/1205362-excel-vba-delete-after-timer</a></p>\n\n<p><a href=\"http://www.vbaexpress.com/forum/showthread.php?63161-Excel-VBA-Delete-after-timer&amp;p=381929#post381929\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?63161-Excel-VBA-Delete-after-timer&amp;p=381929#post381929</a></p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531325252, "post_id": 51289947, "comment_id": 89557697, "body": "Put them back as Long."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531325329, "post_id": 51289947, "comment_id": 89557737, "body": "Do you really want to open IPIC_DATA.xlsx 5000 times?"}, {"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531325482, "post_id": 51289947, "comment_id": 89557804, "body": "It still gave me the same error after I put them back as Long."}, {"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531325553, "post_id": 51289947, "comment_id": 89557828, "body": "No I don&#39;t want to open it that many times. Should I put the &#39;Set wb =....&#39; before the For loop?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531325929, "post_id": 51290050, "comment_id": 89558021, "body": "Went back to Long &amp; wb, but it gave me a 1004 error again. Is the path to the range not being specified correctly?"}, {"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531326557, "post_id": 51290050, "comment_id": 89558343, "body": "I corrected my range and cell references, but am still receiving the same error. Does this mean that the .Range is unable to find the cells I am specifying with my variables?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531326885, "post_id": 51290050, "comment_id": 89558525, "body": "Yes, I didn&#39;t notice until I got your range references cleaned up but C1 and C4 cannot be zero; there is no column 0. Perhaps you intended to use them as a progressive offset but they cannot be used directly as a column index number when they are zero."}, {"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531326889, "post_id": 51290050, "comment_id": 89558529, "body": "Also, the workbook was able to be opened before so I didn&#39;t changed the filename."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 0, "creation_date": 1531326966, "post_id": 51290050, "comment_id": 89558576, "body": "Yes, you were relying on the default folder and it worked last time. It may not work next time if the default folder location changes."}, {"owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "edited": false, "score": 1, "creation_date": 1531327107, "post_id": 51290050, "comment_id": 89558651, "body": "Thank you Jeeped. I added 1 to all of my range references because I had originally started at 0,1,2..etc. &amp; now it can find those ranges."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531326764, "last_edit_date": 1531326764, "creation_date": 1531325601, "answer_id": 51290050, "question_id": 51289947, "link": "https://stackoverflow.com/questions/51289947/run-time-error-13-for-a-dynamic-range-with-variables-in-vba-data-type-mismatc/51290050#51290050", "title": "&#39;Run-time error 13&#39; for a dynamic range with variables in VBA. Data type mismatch", "body": "<ol>\n<li><p>Put <code>Set wb = Workbooks.Open(Filename:=\"IPIC_DATA.xlsx\")</code> above and outside the loop. You are trying to open it 5000 times.</p></li>\n<li><p><code>Workbooks(wb)</code> should be <code>wb</code>. You've set the workbook object to a workbook type var. No need to use the object to identify wb out of the workbooks collection.</p></li>\n<li><p>Go back to Long. Integers aren't cool.</p></li>\n</ol>\n\n<p>Here are some corrected range and cell references.</p>\n\n<pre><code>'I made a guess as to the folder location of IPIC_DATA.xlsx\n'don't rely on default folder locations; be as specific as possible\nSet wb = Workbooks.Open(Filename:=thisworkbook.path &amp; \"\\IPIC_DATA.xlsx\")\n\nFor x = 1 To 5000\n\n    r1 = 7: c1 = 0  'there is no column 0\n    r2 = 7: c2 = 1\n    r3 = 7: c3 = 2\n    r4 = 7: c4 = 0 'there is no column 0\n    r5 = 7: c5 = 1\n\n    with wb.Worksheets(\"Sheet1\")\n        Set v1 = .Range(.Cells(r1, c1), .Cells(r2, c2))\n        Set v2 = .Cells(r3, c3)\n        Set v3 = .Cells(r1, c1)\n        Set v4 = .Range(.Cells(r4, c4), .Cells(r5, c5))\n    end with\n\n    '...\nNext x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1531327805, "last_edit_date": 1531327805, "creation_date": 1531327509, "answer_id": 51290589, "question_id": 51289947, "link": "https://stackoverflow.com/questions/51289947/run-time-error-13-for-a-dynamic-range-with-variables-in-vba-data-type-mismatc/51290589#51290589", "title": "&#39;Run-time error 13&#39; for a dynamic range with variables in VBA. Data type mismatch", "body": "<p>Kudos to @Jeeped for sorting this out - however a <em>type mismatch</em> error is very common when working with Excel cells in VBA. This answer addresses the more common cause, <strong>for which your now-working code still isn't immune to</strong>.</p>\n\n<hr>\n\n<p>A <em>type mismatch</em> error is typically something you get when you assign a cell's value to some typed variable, be it a <code>String</code>, a <code>Double</code>, a <code>Date</code>, or whatever - like this:</p>\n\n<pre><code>Dim v As String\nv = sheet.Range(\"A1\").Value\n</code></pre>\n\n<p>It can also happen when a cell's value is involved in an expression, like this:</p>\n\n<pre><code>If sheet.Range(\"A1\").Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Why is that?</p>\n\n<p>If the cell is empty, or <em>actually</em> contains a usable value, there's no problem. However if the cell contains an <code>Error</code> value, such as <code>#N/A</code>, <code>#VALUE!</code>, or any other cell error, then the above code throws run-time error 13 as you're experiencing.</p>\n\n<p>A cell's value is a <code>Variant</code>; a <code>Variant</code> can contain anything, including a <code>String</code>, an <code>Object</code> reference, or an <code>Error</code> value. VBA will implicitly convert a <code>Variant/Date</code> to a <code>Variant/String</code> if you're reading a cell value into some <code>String</code> variable, or if you're comparing it to some string literal.</p>\n\n<p>But a <code>Variant/Error</code> can't be implicitly (or explicitly) converted to anything.</p>\n\n<p>So the morale of the story, is that you can never assume what the <code>Variant</code> subtype of a cell is going to be, nor that this subtype can be coerced into a specific data type.</p>\n\n<p>To avoid <em>type mismatch</em> errors when working with cells, you need to read the cell values into a <code>Variant</code>:</p>\n\n<pre><code>Dim v As Variant\nv = sheet.Range(\"A1\").Value\n</code></pre>\n\n<p>And then use the <code>IsError</code> function to determine whether you're looking at a <code>Variant/Error</code>:</p>\n\n<pre><code>If Not IsError(v) Then\n    'v is safe to convert to whatever you need it to be\nElse\n    'cell contains an error value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9991067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-odpbKFanNek/AAAAAAAAAAI/AAAAAAAAAdQ/MddAAthvF9M/photo.jpg?sz=128", "display_name": "Kwon Black", "link": "https://stackoverflow.com/users/9991067/kwon-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 51290589, "answer_count": 2, "score": 2, "last_activity_date": 1531327805, "creation_date": 1531325172, "last_edit_date": 1531326072, "question_id": 51289947, "link": "https://stackoverflow.com/questions/51289947/run-time-error-13-for-a-dynamic-range-with-variables-in-vba-data-type-mismatc", "title": "&#39;Run-time error 13&#39; for a dynamic range with variables in VBA. Data type mismatch", "body": "<p>I am receiving a 'runtime error 13' for a line that is supposed to select a dynamic range from a worksheet in a opened workbook. I commented the line in the program.</p>\n\n<p>From research, I found that the 13 error is caused by a mismatch in data, so I tried changing my \"v1, v2, v3...\" variables to integers(they were <code>Dim As Long</code>).This had no effect.</p>\n\n<p>I specify a workbook and worksheet for each cell and range because I was receiving a '1004 error' before, &amp; the answer from another thread was to qualify the <code>ranges()</code> &amp; <code>cells()</code>.</p>\n\n<p>What is causing this error? Could there be an issue with the workbook and worksheet datatypes? Any help is appreciated. Thanks!</p>\n\n<pre><code>Sub FillPartNumRev()\nDim ws As Worksheet, wb As Workbook\nDim v1 As Range, v2 As Range, v3 As Range\nDim r1 As Long, r2 As Long, r3 As Long, r4 As Long, r5 As Long\nDim c1 As Long, c2 As Long, c3 As Long, c4 As Long, c5 As Long\nFor x = 1 To 5000\n\nSet wb = Workbooks.Open(Filename:=\"IPIC_DATA.xlsx\")\n\nr1 = 7: c1 = 0\nr2 = 7: c2 = 1\nr3 = 7: c3 = 2\nr4 = 7: c4 = 0\nr5 = 7: c5 = 1\n\n\nSet v1 = wb.Worksheets(\"Sheet1\").Range(wb.Worksheets(\"Sheet1\").Cells(r1, c1), wb.Worksheets(\"Sheet1\").Cells(r2, c2))\n'run-time error 13\nSet v2 = wb.Worksheets(\"Sheet1\").Range(wb.Worksheets(\"Sheet1\").Cells(r3, c3))\nSet v3 = wb.Worksheets(\"Sheet1\").Range(wb.Worksheets(\"Sheet1\").Cells(r1, c1))\nSet v4 = wb.Worksheets(\"Sheet1\").Range(wb.Worksheets(\"Sheet1\").Cells(r4, c4), wb.Worksheets(\"Sheet1\").Cells(r5, c5))\n\n    If v4 &lt;&gt; \"\" &amp; v2 = \"\" Then\n        v1.Copy v4\n\n    ElseIf v4 = \"\" Then\n        r1 = r1 + 7\n        r2 = r2 + 7\n\n    End If\n\nr4 = r4 + 1\nc4 = c4 + 1\nr5 = r5 + 1\nc5 = c5 + 1\nr3 = r3 + 1\nc3 = c3 + 1\n\n\nNext x\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "pivot-table", "week-number"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531325527, "post_id": 51289831, "comment_id": 89557818, "body": "Just clarifying: you <i>have</i> tried manually changing the formulas to &quot;Late&quot; where appropriate, and this plus the pivot table refresh had the desired result?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003190"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531325661, "post_id": 51289831, "comment_id": 89557886, "body": "Yes, I have manually changed the formulas to &quot;Late&quot; and the pivot table reads the &quot;Late&quot; values in that column, making it a part of the first row header in the table."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10003190"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1531330673, "post_id": 51289831, "comment_id": 89560406, "body": "Would there be a way to replace the output so that &quot;Late&quot; is not part of a formula and just text in a cell?"}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 1, "last_activity_date": 1531331545, "creation_date": 1531331545, "answer_id": 51291605, "question_id": 51289831, "link": "https://stackoverflow.com/questions/51289831/in-vba-replace-formula-output-with-text-value/51291605#51291605", "title": "In VBA replace formula output with text value", "body": "<p>This will give \"Late\" as the result of the formula instead of part of the formatting. Since pivot tables usually treat formula-result text as they would \"just\" text, this should give the desired result.</p>\n\n<p>Replace:</p>\n\n<pre><code>With .Range(.Cells(2, \"X\"), .Cells(.Rows.Count, \"O\").End(xlUp).Offset(0, 9))\n    .Formula = \"=weeknum(o2)\"\n    .NumberFormat = \"0_)\"\n    .FormatConditions.Delete\n    With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=and(x2&lt;weeknum(today()), year(o2)=year(today()))\")\n        .NumberFormat = \"\\L\\a\\t\\e_)\"\n    End With\nEnd With\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>With .Range(.Cells(2, \"X\"), .Cells(.Rows.Count, \"O\").End(xlUp).Offset(0, 9))\n    .Formula = \"=if(and(weeknum(o2)&lt;weeknum(today()), year(o2)=year(today())),\"\"Late\"\",weeknum(o2))\"\n    .NumberFormat = \"0_)\"\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10003190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 51291605, "answer_count": 1, "score": 2, "last_activity_date": 1594207677, "creation_date": 1531324758, "last_edit_date": 1594207677, "question_id": 51289831, "link": "https://stackoverflow.com/questions/51289831/in-vba-replace-formula-output-with-text-value", "title": "In VBA replace formula output with text value", "body": "<p>I have VBA code to make my column WEEKNUM formula say \"Late\" if it is in a certain range of weeks. The formula turns the week number into the word \"Late\" when the code is run; however, this goes to a pivot table on the sheet over and the \"Late\" values are not showing up when the table is refreshed since it is still in the form as a formula. Is there a way that whenever the WEEKNUM value is \"Late\" to clear out the cell and enter the text \"Late\"? Better yet can the formula output be replaced with a text value?</p>\n\n<pre><code>    With MyWorkbook.Worksheets(\"sheet2\")\n    With .Range(.Cells(2, \"X\"), .Cells(.Rows.Count, \"O\").End(xlUp).Offset(0, 9))\n        .Formula = \"=weeknum(o2)\"\n        .NumberFormat = \"0_)\"\n        .FormatConditions.delete\n        With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=and(x2&lt;weeknum(today()), year(o2)=year(today()))\")\n            .NumberFormat = \"\\L\\a\\t\\e_)\"\n        End With\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "match"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "edited": false, "score": 0, "creation_date": 1531410802, "post_id": 51289755, "comment_id": 89596445, "body": "If I understand your formula correctly, it would return &quot;yes&quot; or &quot;no&quot; depending on whether the value in A2 was present in any of the rows (and the next row the value in A3, etc.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "edited": false, "score": 0, "creation_date": 1531410851, "post_id": 51289755, "comment_id": 89596473, "body": "Yes, that is correct. That is how I understood your request."}, {"owner": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "edited": false, "score": 0, "creation_date": 1531411464, "post_id": 51289755, "comment_id": 89596863, "body": "I don&#39;t think this will solve my problem.  I need something that will compare all values in Sheet1 Column A with the values populated in the particular columns of Sheet2 Row 1 determine if any match.  I need to do this for each individual Row in Sheet2, and determine if there is a match for every row."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "edited": false, "score": 0, "creation_date": 1531419521, "post_id": 51289755, "comment_id": 89600951, "body": "No worries. Good to hear you got sorted out."}, {"owner": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "edited": false, "score": 0, "creation_date": 1531762987, "post_id": 51289755, "comment_id": 89707093, "body": "Actually, I haven&#39;t gotten it sorted out.  I still don&#39;t have an answer of how to do the comparison I&#39;m trying to do between the column and the rows on the other sheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531325149, "last_edit_date": 1531325149, "creation_date": 1531324522, "answer_id": 51289755, "question_id": 51289617, "link": "https://stackoverflow.com/questions/51289617/determine-if-any-value-in-sheet1-column-a-matches-any-value-in-each-row-of-she/51289755#51289755", "title": "Determine if any value in Sheet1, Column A, matches any value in each row of Sheet2", "body": "<p>No need for VBA. Just put this formula in Sheet1!B2 and fill down or double-click the 'fill handle'.</p>\n\n<pre><code>=if(isnumber(match(a2, sheet2!$1:$1, 0)), \"yes\", \"no\")\n</code></pre>\n\n<p>If you absolutely require VBA then,</p>\n\n<pre><code>sub isitthere()\n    with worksheets(\"sheet1\")\n        with .range(.cells(2, \"B\"), .cells(.rows.count, \"A\").end(xlup).offset(0, 1))\n            .formula = \"=if(isnumber(match(a2, sheet2!$1:$1, 0)), \"\"yes\"\", \"\"no\"\")\"\n            .value = value\n        .end with\n    end with\nend sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10065779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405f24ca8d2e72a0e5aab001b4fec6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trefsger", "link": "https://stackoverflow.com/users/10065779/nicole-trefsger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549509190, "creation_date": 1531324041, "last_edit_date": 1549509190, "question_id": 51289617, "link": "https://stackoverflow.com/questions/51289617/determine-if-any-value-in-sheet1-column-a-matches-any-value-in-each-row-of-she", "title": "Determine if any value in Sheet1, Column A, matches any value in each row of Sheet2", "body": "<p>I'm trying to determine if any of the codes from Sheet1 Column A exist in each row of names in Sheet2, each of which have as many as 24 columns.</p>\n\n<p>I do not need to know every match, just a logical yes/no for each row, if a match is found on any value in the column.</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324369, "post_id": 51289614, "comment_id": 89557188, "body": "TRIM isn&#39;t intended for removing <i>all</i> whitespace. And is there a question? It would help if you made it very clear what the question is and the problem you are having with implementing it."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 1, "creation_date": 1531324379, "post_id": 51289614, "comment_id": 89557193, "body": "What is the question? Where did you get stuck?"}, {"owner": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "reply_to_user": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531324511, "post_id": 51289614, "comment_id": 89557285, "body": "@Aneta The sub call does not work at all. It wont take my range and spit out the function based on a macro button"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324538, "post_id": 51289614, "comment_id": 89557304, "body": "And your function expects one argument which is a range. You are passing 2 arguments when you call it. And the second one you are passing may confuse the compiler even if your function expected two, as your are passing a variable called String which is also a datatype."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324809, "post_id": 51289614, "comment_id": 89557467, "body": "Myrange.Value is going to generate an array not a string so your regex will not work as is. You will need a way to replace all occurences within the range (which isn&#39;t a single cell). Using an entire column is also horribly inefficient."}, {"owner": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324897, "post_id": 51289614, "comment_id": 89557511, "body": "@QHarr I am sorry I dont ask questions often on this site, I am just trying to get a macro that will run the function. I know the function works because I can just use the =simplecellregex in a cell. I want to make it so I can just click a column and click the macro and have the macro do it all instead of me having the type that into the cell. The sub is where the issue is. I dont understand the arguments and range because I dont use VBA ever. This is literally my first time."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324917, "post_id": 51289614, "comment_id": 89557527, "body": "And your regex is basically a RTRIM. See RTRIM <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/ltrim-rtrim-and-trim-functions\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531324956, "post_id": 51289614, "comment_id": 89557546, "body": "@user7823345 I don&#39;t mean to sound rude. I hope I didn&#39;t. I am trying to give some pointers. There are alot of things to address in the code shown."}, {"owner": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531325070, "post_id": 51289614, "comment_id": 89557603, "body": "@QHarr you arent rude at all, I get you are trying to help and I appreciate it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531325080, "post_id": 51289614, "comment_id": 89557607, "body": "I think maybe you mean a single cell is the range argument if you are calling this from a cell. An UDF (a user defined function) can only return something to the cell it is called from. It cannot impact on other cells. If you are intending on implementing this for more than one cell by calling the function from code you are going to need to make some changes as mentioned above."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531325081, "post_id": 51289614, "comment_id": 89557609, "body": "REGEX seems an inefficient way to just remove whitespace at the end of a line."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531325207, "post_id": 51289614, "comment_id": 89557673, "body": "Also, a REGEX whitespace character does NOT match the NBSP, which is sometimes a problem in data imported from the web or html document."}, {"owner": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "edited": false, "score": 0, "creation_date": 1531325368, "post_id": 51289614, "comment_id": 89557754, "body": "Would you guys recommend I scrap this function and write a RTRIM sub? Never used RTRIM before, didnt know it was a thing. But I do know TRIM didnt work when I was looking to remove all whitespace from entries in a column."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531325861, "post_id": 51289614, "comment_id": 89557981, "body": "RTRIM will not remove all whitespace. Only from the right hand side which is what your regex is doing."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1531325887, "post_id": 51289614, "comment_id": 89558001, "body": "What do you mean by &quot;Not Working&quot;.  The worksheet function TRIM will remove trailing and leading spaces, along with duplicate spaces within a string (leaving a single space).  And your regex will only remove trailing spaces (along with trailing tab characters and a few other things that are not usually in a string).  So if that is the only difference between the two, then you are OK.  If not, there is something about your data that needs investigation."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "edited": false, "score": 0, "creation_date": 1531328064, "post_id": 51290155, "comment_id": 89559103, "body": "See the last bit of code. You can associate that with a button you place on the ribbon."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1531330469, "last_edit_date": 1531330469, "creation_date": 1531325952, "answer_id": 51290155, "question_id": 51289614, "link": "https://stackoverflow.com/questions/51289614/calling-a-myrange-function-in-a-sub/51290155#51290155", "title": "Calling a Myrange Function in a Sub", "body": "<h2>EDIT:</h2>\n\n<p>Use the following if you want to select a range and then press a button</p>\n\n<pre><code>Option Explicit\nPublic Sub RemoveEndWhiteSpace()\n    Dim arr(), i As Long, myRange As Range\n    Set myRange = Selection\n    If myRange.Columns.Count &gt; 1 Or myRange Is Nothing Then Exit Sub\n    If myRange.Count = 1 Then\n        myRange = RTrim$(myRange.Value)\n        Exit Sub\n    Else\n        arr = myRange.Value\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            arr(i, 1) = RTrim$(arr(i, 1))\n        Next i\n        myRange = arr\n    End If\nEnd Sub\n</code></pre>\n\n<p>To output to a different column:</p>\n\n<pre><code>myRange.Offset(, 1) = arr '&lt;==use offset to put result in a different column e.g. one to the right\n</code></pre>\n\n<hr>\n\n<p>Example run of the last bit of code tied to a button (where macro is set to all open workbooks btw)</p>\n\n<p><a href=\"https://i.stack.imgur.com/7qmaY.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7qmaY.gif\" alt=\"Test\"></a></p>\n\n<hr>\n\n<h2>tl;dr;</h2>\n\n<p>If you want to click on a column and trailing white space be removed something like the following. This uses a worksheet event of when you select a column to run the sub. The sub checks how many cells are populated in the column and works with those.  </p>\n\n<p><code>Private Sub Worksheet_SelectionChange</code> would go in the code pane for the sheet you are wanting to do the replacement on.</p>\n\n<p><code>.UsedRange</code> is not always the most reliable method.</p>\n\n<p>The sub it calls would go in a standard module. I suspect there are more efficient ways to do this to be honest but thought I would have a quick play.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count = Columns(1).Cells.Count And Target.Columns.Count = 1 Then\n        'MsgBox \"running\"\n        RemoveEndWhiteSpace Intersect(Target, Me.UsedRange)\n    End If\nEnd Sub\n\nPublic Sub RemoveEndWhiteSpace(ByVal myRange As Range)\n    Dim arr(), i As Long\n    If myRange.Count = 1 Then\n        myRange = RTrim$(myRange.Value)\n        Exit Sub\n    Else\n        arr = myRange.Value\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            arr(i, 1) = RTrim$(arr(i, 1))\n        Next i\n        myRange = arr\n    End If\nEnd Sub\n</code></pre>\n\n<p>More reliable for used range of column would be:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count = Columns(1).Cells.Count And Target.Columns.Count = 1 Then\n       ' MsgBox \"running\"\n        Dim lastRow As Long, myRange As Range\n        lastRow = Cells(Rows.Count, Target.Column).End(xlUp).Row\n        Set myRange = Range(Cells(1, Target.Column), Cells(lastRow, Target.Column))\n        RemoveEndWhiteSpace myRange\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 5, "user_id": 7823345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bcc03178b32c61817aa0a9e7c59f14?s=128&d=identicon&r=PG&f=1", "display_name": "Sarion", "link": "https://stackoverflow.com/users/7823345/sarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 51290155, "answer_count": 1, "score": -1, "last_activity_date": 1531338379, "creation_date": 1531324027, "last_edit_date": 1531338379, "question_id": 51289614, "link": "https://stackoverflow.com/questions/51289614/calling-a-myrange-function-in-a-sub", "title": "Calling a Myrange Function in a Sub", "body": "<p>I put together a <code>regex</code> function that will remove all whitespace from a column, and when I use it on a sheet I just have to type in <code>=simplecellregex()</code> then I run that in the new column against all of the entries. The reason I am doing it this way is because <code>TRIM()</code> does not work always so I looked for a way that did.</p>\n\n<pre><code>Function simpleCellRegex(Myrange As Range) As String\n\n    Dim Regex As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    strPattern = \"\\s+$\"\n\n        If strPattern &lt;&gt; \"\" Then\n            strInput = Myrange.Value\n            strReplace = \"\"\n\n        With Regex\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If Regex.Test(strInput) Then\n            simpleCellRegex = Regex.Replace(strInput, strReplace)\n        Else\n            simpleCellRegex = strInput\n        End If\n    End If\nEnd Function\n\n\n\nSub regex1()\n\nColumn.Add\nRange(\"D2\").Value = simpleCellRegex(Myrange, String)\n\nEnd Sub\n</code></pre>\n\n<p>So this was the setup so that whenever I get workbooks I just click the column I want the function to run on and it runs the regex and spits it out the the column next to it. The plan is to make this a macro so I can just add a button on the excel menu ribbon and make this regex easy to run.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531324724, "post_id": 51289513, "comment_id": 89557411, "body": "<code>&lt;img src=&quot; &amp; &quot;&#39;&quot; &amp; ChartName1 &amp; &quot;&#39;&gt;&quot;</code> this points to an image stored in your local drive, so other recipients are not going to be able to access that file"}, {"owner": {"reputation": 11, "user_id": 10065890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwlvmrwRER8/AAAAAAAAAAI/AAAAAAAAADk/OEBNx6ggJsg/photo.jpg?sz=128", "display_name": "Animesh Das", "link": "https://stackoverflow.com/users/10065890/animesh-das"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531373443, "post_id": 51289513, "comment_id": 89572861, "body": "Can you please suggest if there is any alternate solution for this?"}, {"owner": {"reputation": 11, "user_id": 10065890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwlvmrwRER8/AAAAAAAAAAI/AAAAAAAAADk/OEBNx6ggJsg/photo.jpg?sz=128", "display_name": "Animesh Das", "link": "https://stackoverflow.com/users/10065890/animesh-das"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531375266, "post_id": 51289513, "comment_id": 89573602, "body": "Is there anyway i can store it in OneDrive and give access to all the recipients and then send email? will it help"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531378051, "post_id": 51289513, "comment_id": 89574734, "body": "Take a look here for info about embedding images in emails.  <a href=\"https://www.campaignmonitor.com/blog/email-marketing/2013/02/embedded-images-in-html-email/\" rel=\"nofollow noreferrer\">campaignmonitor.com/blog/email-marketing/2013/02/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 10065890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwlvmrwRER8/AAAAAAAAAAI/AAAAAAAAADk/OEBNx6ggJsg/photo.jpg?sz=128", "display_name": "Animesh Das", "link": "https://stackoverflow.com/users/10065890/animesh-das"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1531391095, "post_id": 51289513, "comment_id": 89582982, "body": "Sorry to come back on this again. The Base64 code is too large to add in the code. I will have multiple charts added in email. Can someone please suggest a different solution. also the chart is dynamic hence it will create different image everytime the data is updated but with the same name. Will that not change the base64 code?"}], "owner": {"reputation": 11, "user_id": 10065890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwlvmrwRER8/AAAAAAAAAAI/AAAAAAAAADk/OEBNx6ggJsg/photo.jpg?sz=128", "display_name": "Animesh Das", "link": "https://stackoverflow.com/users/10065890/animesh-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1592949845, "creation_date": 1531323686, "last_edit_date": 1592949845, "question_id": 51289513, "link": "https://stackoverflow.com/questions/51289513/add-chart-in-email-body", "title": "Add Chart in email body", "body": "<p>Hi I am using below code to add chart and send email to multiple recipients. It works fine. In my sent item i can see a perfect email created and sent. But all the recipients are not able to see the charts. All they see is two red X</p>\n\n<pre><code>Sub Send_Email_Updated()\n\nDim olApp As Object\nDim NewMail As Object\nDim NewMail1 As Object\nDim ChartName As String\nDim ChartName1 As String\nDim SendingRng As Range\nDim htmlString As String\nDim OMail As Outlook.MailItem\n\nSet wb = ActiveWorkbook\nSet S1 = wb.Worksheets(\"Incident Tickets\")\nSet S2 = wb.Worksheets(\"Assets and Representatives\")\nSet S3 = wb.Worksheets(\"Email\")\n\n'Set SendingRng = Worksheets(\"Email\").Table(\"A30:C43\")\nSet SendingRng = Worksheets(\"Email\").Range(\"A30:C43\")\nSet olApp = CreateObject(\"Outlook.Application\")\nSet OMail = olApp.CreateItem(olMailItem)\n\n' Group 1\nIf S3.Cells(7, 2) &lt;&gt; 0 Or S3.Cells(8, 2) &lt;&gt; 0 Or S3.Cells(9, 2) &lt;&gt; 0 Then\n\nOMail.Display\n\n'fill in the file path/name of the gif file app graph\n    ChartName = Environ$(\"Temp\") &amp; \"\\Chart 1.gif\"\n\n    ActiveWorkbook.Worksheets(\"Email\").ChartObjects(\"Chart 1\").Chart.Export _\n    Filename:=ChartName, FilterName:=\"GIF\"\n\n'fill in the file path/name of the gif file trend graph\n    ChartName1 = Environ$(\"Temp\") &amp; \"\\Chart 31.gif\"\n\n    ActiveWorkbook.Worksheets(\"Email\").ChartObjects(\"Chart 31\").Chart.Export _\n    Filename:=ChartName1, FilterName:=\"GIF\"\n\n    Set NewMail = olApp.CreateItem(0)\n    With NewMail\n        .Subject = \"Action Required on Incidents and Problem Candidates for GC060.1 - Group 1\"\n        .To = \"animesh.das@xyz.com\"\n\n        .HTMLBody = \n        \"&lt;img src=\" &amp; \"'\" &amp; ChartName1 &amp; \"'&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"_\n        \"&lt;img src=\" &amp; \"'\" &amp; ChartName &amp; \"'&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" &amp; _\n\n        .Send\n    End With\n\n    ChartName = vbNullString\n    ChartName1 = vbNullString\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1531321528, "creation_date": 1531321528, "answer_id": 51288828, "question_id": 51288636, "link": "https://stackoverflow.com/questions/51288636/counting-digit-in-column-based-on-subject/51288828#51288828", "title": "Counting digit in column based on subject", "body": "<p>A blank cell is numerically zero and that is one of your accepted conditions. Differentiate between blanks and zero values.</p>\n\n<pre><code>=IF(and(f4&lt;&gt;\"\", OR(F4=0,F3=1)),\"\",COUNTIFS($A$2:A2, $A$2,$F$2:F2,0)-SUM($I$2:I2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1531388381, "last_edit_date": 1531388381, "creation_date": 1531378376, "answer_id": 51299023, "question_id": 51288636, "link": "https://stackoverflow.com/questions/51288636/counting-digit-in-column-based-on-subject/51299023#51299023", "title": "Counting digit in column based on subject", "body": "<p>Based on @Jeeped answer. If you use <code>-SUMIF($A$2:A2,A3,$I$2:I2)</code> instead of <code>-SUM($I$2:I2)</code> you don't need to adjust this part for each subject number. Just use the following formula in I3 and copy it down.</p>\n\n<pre><code>=IF(AND(F4&lt;&gt;\"\",OR(F4=0,F3=1)),\"\",COUNTIFS($A$2:A3,A3,$F$2:F3,0)-SUMIF($A$2:A2,A3,$I$2:I2))\n</code></pre>\n\n<p>Note that I also changed the second parameter in the <code>COUNTIFS</code> to <code>A3</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 8206285, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-08YdUHLqOdw/AAAAAAAAAAI/AAAAAAAAABE/B6QrUSgjxuc/photo.jpg?sz=128", "display_name": "Anna Li", "link": "https://stackoverflow.com/users/8206285/anna-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549013579, "creation_date": 1531320926, "last_edit_date": 1549013579, "question_id": 51288636, "link": "https://stackoverflow.com/questions/51288636/counting-digit-in-column-based-on-subject", "title": "Counting digit in column based on subject", "body": "<p>I am just using formulas in excel and was wondering how you could count all the 0s until a 1 is reached, and then start the process over again, based on subject number. If this is not possible simply with formulas, how could I write a VBA code for this?</p>\n\n<p>Right now I am trying to use,</p>\n\n<pre><code>=IF(OR(F4=0,F3=1),\"\",COUNTIFS($A$2:A2, $A$2,$F$2:F2,0)-SUM($I$2:I2))\n</code></pre>\n\n<p>which I input in I3 and I change the <code>COUNTIFS($A$#:A#, $A$#...)</code> part for each subject number.</p>\n\n<p>This seems to work with the exception of the last grouping, as it won't output a number before the next subject.</p>\n\n<p>Example Data: </p>\n\n<pre><code>subid         yes       number_yes(output)\n1             0\n1             0\n1             0            3\n1             1\n1             0            1\n1             1\n1             0\n2             0\n2             0            2\n2             1\n2             0\n2             0\n3             \netc.\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "vlookup"], "comments": [{"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 7, "creation_date": 1531321728, "post_id": 51288600, "comment_id": 89555582, "body": "Instead of using the <code>=IF(</code> formula, use <code>=IFERROR(</code>. =IFERROR(what_to_do_if_everything_goes_okay;&quot;&quot;)."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1531328773, "post_id": 51288600, "comment_id": 89559458, "body": "It still does not run !"}, {"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 1, "creation_date": 1531346183, "post_id": 51288600, "comment_id": 89566965, "body": "Try no spaces between &quot;&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": true, "score": 2, "last_activity_date": 1531329421, "creation_date": 1531329421, "answer_id": 51291057, "question_id": 51288600, "link": "https://stackoverflow.com/questions/51288600/vlookup-to-return-blank-instead-of-0-or-n-a/51291057#51291057", "title": "Vlookup to return blank instead of 0 or #N/A", "body": "<p>I could emulate your example with a sample code, because you didn't provide a data to testing purposes.</p>\n\n<p>The formula that worked:</p>\n\n<p><code>=IFERROR(LOOKUP(B11;A1:A9;B1:B9);\"\")</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/fM4KH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fM4KH.png\" alt=\"\"></a>\n<a href=\"https://i.stack.imgur.com/bL6R1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bL6R1.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2212, "favorite_count": 0, "accepted_answer_id": 51291057, "answer_count": 1, "score": 1, "last_activity_date": 1531329421, "creation_date": 1531320825, "last_edit_date": 1531328745, "question_id": 51288600, "link": "https://stackoverflow.com/questions/51288600/vlookup-to-return-blank-instead-of-0-or-n-a", "title": "Vlookup to return blank instead of 0 or #N/A", "body": "<p>I am using vlookup to get data from a source but I want the result to be blank instead of 0 or N/A when there is no vlookup value. So far it gives me an error. My code:</p>\n\n<pre><code>ws1.Range(\"H2:H\" &amp; lastrow3).Formula = \"=IF(ISNA(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:H,3,FALSE))+(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:H,3,FALSE)=\"\"),\"\",VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:H,3,FALSE))\"\n</code></pre>\n\n<p><strong>Edit</strong> (Still it does not run)</p>\n\n<pre><code>ws1.Range(\"H2:H\" &amp; lastrow3).Formula = \"=IFERROR(VLOOKUP(C2,'[NOT OK.xlsx]Sheet1'!F:H,3,FALSE),\"\")\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 8, "creation_date": 1531319929, "post_id": 51288271, "comment_id": 89554324, "body": "Remove the <code>{}</code> and use <code>.FormulaArray</code> not <code>.Formula</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1531320093, "post_id": 51288271, "comment_id": 89554450, "body": "Don&#39;t forget to mention the smaller character limit in your answer @ScottCraner."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 3, "creation_date": 1531322255, "post_id": 51288271, "comment_id": 89555935, "body": "Whenever you are wondering how to simulate any manual task in Excel, use the macro recorder and see what it makes. Then improve it a bit."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1531322515, "post_id": 51288271, "comment_id": 89556122, "body": "If you record a macro, you would see that the <code>.FormulaArray</code> gets formulas in <code>R1C1</code> format only. Thus, you have to rewrite your code a bit. But the best case is to record it first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1531323383, "post_id": 51288271, "comment_id": 89556617, "body": "@Vityata - good point about FormulaArray accepting both xlR1C1 and xlA1 style formulas."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1531382494, "last_edit_date": 1531382494, "creation_date": 1531323020, "answer_id": 51289292, "question_id": 51288271, "link": "https://stackoverflow.com/questions/51288271/excel-vba-formula-string-array-formula-how-to-simulate-ctrlshiftenter-press/51289292#51289292", "title": "Excel vba formula string: array formula - how to simulate Ctrl+Shift+Enter press", "body": "<p>To create an array formula with a simulated ctrl+shift+enter (aka CSE), use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formulaarray-property-excel\" rel=\"nofollow noreferrer\">Range.FormulaArray Property</a> instead of the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel\" rel=\"nofollow noreferrer\">Range.Formula Property</a> and let Excel add the 'curly braces'.</p>\n\n<pre><code>with Workbooks(job_file).Worksheets(1)\n    .Cells(h + b, 195).FormulaArray = _\n        \"=IF(MAX(IF(B2:M2&gt;$FY\" &amp; currentRow &amp; \",$B$1:$M$1))=0,0,\" &amp; _\n            \"MAX(IF(sheet1!B2:M2&gt;$FY\" &amp; currentRow &amp; \", sheet1!$B$1:$M$1)))+1\"\nend with\n</code></pre>\n\n<p>I noticed in your formula that you use <code>B2:M2</code> and <code>sheet1!B2:M2</code>. Shouldn't they <strong>both</strong> be <code>sheet1!B2:M2</code>?</p>\n\n<p>There are some considerations.</p>\n\n<ul>\n<li><p>Runtime Error: 1004 - Too long. There is a reduced character limit of 255 for FormulaArray but <a href=\"https://stackoverflow.com/questions/51196290/error-1004-when-trying-to-use-formulaarray-replace-trick-does-not-work/51197173?s=1|0.0000#51197173\">there are work-arounds</a>.</p></li>\n<li><p>Runtime Error: 1004 - Broken String. Remember that all quotes within a quoted string must be doubled up. This is easily one of the most common causes of errors when trying to write a formula into a cell through VBA. Hint: <code>TEXT(,)</code> can be used instead of <code>\"\"</code> so you don't have to type <code>\"\"\"\"</code> for a zero-length string.</p></li>\n<li><p>FormulaArray accepts both xlR1C1 and xlA1 style formulas. If you can wrap your head around xlR1C1 style formula syntax, it is generally easier to construct a concatenated formula string in xlR1C1 since you can use digits to represent column numbers instead of trying to convert column ordinals to a column letter. However, do not try to mix-and-match xlA1 and xlR1C1 range references in the same formula; they must all be one style or the other.</p></li>\n<li><p>If you are having trouble formulating a string that will be accepted as a formula, put a tick (e.g. <code>'</code> ) in front of the first equals sign then run the code and return to the worksheet to see what was put in. Make modifications on the worksheet until you have a working formula then transfer those modifications to the VBA code.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1531324402, "creation_date": 1531324402, "answer_id": 51289720, "question_id": 51288271, "link": "https://stackoverflow.com/questions/51288271/excel-vba-formula-string-array-formula-how-to-simulate-ctrlshiftenter-press/51289720#51289720", "title": "Excel vba formula string: array formula - how to simulate Ctrl+Shift+Enter press", "body": "<p>As a note, it looks like this can be done without an array formula, like so:</p>\n\n<pre><code>Workbooks(job_file).Worksheets(1).Cells(h + b, 195).Formula = _\n        \"=IF($FY\" &amp; currentRow &amp; \"&gt;MAX(B2:M2),0,\" &amp; _\n         \"MAX(INDEX((B2:M2&gt;$FY\" &amp; currentRow &amp; \")*$B$1:$M$1,)))+1\"\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 1, "accepted_answer_id": 51289292, "answer_count": 2, "score": 3, "last_activity_date": 1531382494, "creation_date": 1531319835, "question_id": 51288271, "link": "https://stackoverflow.com/questions/51288271/excel-vba-formula-string-array-formula-how-to-simulate-ctrlshiftenter-press", "title": "Excel vba formula string: array formula - how to simulate Ctrl+Shift+Enter press", "body": "<p>I have a worksheet with data and some columns which I fill with formulas via vba. The formula I struggle with is an array formula that looks like this:</p>\n\n<pre><code>Workbooks(job_file).Worksheets(1).Cells(h + b, 195).Formula = _\n            \"{=IF(MAX(IF(B2:M2&gt;$FY\" &amp; currentRow &amp; \",$B$1:$M$1))=0,0,\" &amp; _\n              \"MAX(IF(sheet1!B2:M2&gt;$FY\" &amp; currentRow &amp; \",\" &amp; _\n                                \"sheet1!$B$1:$M$1)))+1}\"\n</code></pre>\n\n<p>It's supposed to be an array formula, so that's why I put <code>{}</code> there. However, when run it simply display the formula's text in a cell, without calculating it. I have to manually remove the brackets, and then press <code>Ctrl+Shift+Enter</code> myself.</p>\n\n<p>Is there any way to avoid it? I have a great many rows and I can't ctrlshiftenter each. </p>\n\n<p>I tried running it without brackets, it works, but gives a <code>#VALUE!</code> error, which can also be fixed by applying <code>Ctrl+Shift+Enter</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1531319881, "post_id": 51288264, "comment_id": 89554275, "body": "Why vba, Conditional Formatting will do it."}, {"owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531320788, "post_id": 51288264, "comment_id": 89554943, "body": "I&#39;ve tried using conditional formatting, and it absolutely works. The problem i&#39;m having is that it makes my worksheet extremely slow."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1531322275, "post_id": 51288264, "comment_id": 89555950, "body": "I&#39;m not sure VBA being faster than conditional formatting."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531331712, "post_id": 51288264, "comment_id": 89560884, "body": "What was the formula you used for conditional formatting?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "edited": false, "score": 0, "creation_date": 1531331319, "post_id": 51289673, "comment_id": 89560700, "body": "Thank You Mike. I still incur slow processing by adding formulas. It seems when I add formulas, there is a lag when entering data within each field."}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1531324217, "creation_date": 1531324217, "answer_id": 51289673, "question_id": 51288264, "link": "https://stackoverflow.com/questions/51288264/how-to-find-and-highlight-duplicate-rows-based-on-3-columns/51289673#51289673", "title": "How to find and highlight duplicate rows based on 3 columns", "body": "<p>No strict need for VBA ...</p>\n\n<ol>\n<li>create one more column as the concatenation of all key fields</li>\n<li>sort the concatenation column</li>\n<li>create a dup-check formula in yet another column (looking for equality in the row above) - like so:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/B0tFF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B0tFF.png\" alt=\"enter image description here\"></a></p>\n\n<p>all rows with result > 1 are the nth repetitions of the key.</p>\n\n<p>After elimination of duplicates (or whatever processing) you can restore the original sort order by sorting on SortKey</p>\n"}], "owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594207650, "creation_date": 1531319819, "last_edit_date": 1594207650, "question_id": 51288264, "link": "https://stackoverflow.com/questions/51288264/how-to-find-and-highlight-duplicate-rows-based-on-3-columns", "title": "How to find and highlight duplicate rows based on 3 columns", "body": "<p>does anyone have VBA code to highlight duplicate rows based on three columns? </p>\n\n<p>I'm using a sheet called \"Billing Voucher (Part 1)\" I would like to create a button that highlights duplicate rows in blue (only based on three columns) when pressed. </p>\n\n<p>For example, </p>\n\n<pre><code>   | D   E   I\n---+-------------\n 1 | 1   1   1\n 2 | 1   2   7\n 3 | 7   9   1\n 4 | 1   1   1\n</code></pre>\n\n<p>Based on the above, the program should highlight row 1 and 4. </p>\n\n<p>I'm not sure why is it so difficult to find the right code to highlight duplicates.</p>\n\n<p>I cant use conditional formatting because it slows my computer tremendously, \nand a lot of the reusable code seems to either be overly complex, or does something else.  </p>\n\n<p>I've seen so many instances of code, isn't there a simple way to create the program without being overly complex</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1531319834, "post_id": 51288241, "comment_id": 89554228, "body": "Does storing the macro in the <code>Personal.xlsb</code> not work? Those are accessible from any Excel file."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1531319915, "post_id": 51288241, "comment_id": 89554309, "body": "@BruceWayne I&#39;m unfamiliar with your recommendation. Can you elaborate?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1531321459, "post_id": 51288241, "comment_id": 89555400, "body": "Or use an add-in containing the macro."}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1531320119, "creation_date": 1531320119, "answer_id": 51288367, "question_id": 51288241, "link": "https://stackoverflow.com/questions/51288241/how-to-add-a-macro-to-mutiple-excel-files-using-vba/51288367#51288367", "title": "How to add a macro to mutiple excel files using VBA", "body": "<p>you'll need a reference first</p>\n\n<pre><code>Microsoft Visual Basic For Applications Extensibility 5.3\n</code></pre>\n\n<p>And here you go. Have fun</p>\n\n<pre><code>Public Sub AddNewModule()\n\n  Dim proj As VBIDE.VBProject\n  Dim comp As VBIDE.VBComponent\n\n  Set proj = ActiveWorkbook.VBProject\n  Set comp = proj.VBComponents.Add(vbext_ct_StdModule)\n  comp.Name = \"MyNewModule\"\n\n  Set codeMod = comp.CodeModule\n\n  With codeMod\n    lineNum = .CountOfLines + 1\n    .InsertLines lineNum, \"Public Sub ANewSub()\"\n    lineNum = lineNum + 1\n    .InsertLines lineNum, \"  MsgBox \" &amp; \"\"\"\" &amp; \"I added a module!\" &amp; \"\"\"\"\n    lineNum = lineNum + 1\n    .InsertLines lineNum, \"End Sub\"\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>You can also just use the workbook with the code in it as a reference as well. Then you can call the module remotely. </p>\n\n<p>As @BruceWayne mentioned, there is also sotring it in the personal book.</p>\n\n<p>tl;dr - there's a few options that can get you there. </p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1531322330, "creation_date": 1531322330, "answer_id": 51289076, "question_id": 51288241, "link": "https://stackoverflow.com/questions/51288241/how-to-add-a-macro-to-mutiple-excel-files-using-vba/51289076#51289076", "title": "How to add a macro to mutiple excel files using VBA", "body": "<p>I recommend storing them in the <code>Personal.xslb</code> file which is accessible across Excel.</p>\n\n<p>See <a href=\"https://support.office.com/en-us/article/copy-your-macros-to-a-personal-macro-workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566\" rel=\"nofollow noreferrer\">this page</a> or <a href=\"https://www.rondebruin.nl/win/personal.htm\" rel=\"nofollow noreferrer\">this page</a> for more detail, but generally a quick way to get started is:</p>\n\n<ol>\n<li>Press <kbd>ALT+F11</kbd> to open the VBEditor.</li>\n<li>Right click the \"VBAProject (PERSONAL.XLSB)\" and Add a new module</li>\n<li>Add your code in the module. </li>\n<li>Now, when you go to View --> Macros, you can choose to see those stored in the Personal.xlsb file:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/6wUCf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6wUCf.jpg\" alt=\"enter image description here\"></a><br>\n<sub>(I \"whited out\" my macros for privacy, but they'll be listed by name)</sub></p>\n\n<p>Note: If you do not have a \"Personal.xlsb\", then you must create it.  Simply record a new macro, but choose to store it in \"Personal Macro Workbook\".  Then you should see it in the VBEditor.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uc09U.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uc09U.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1531534988, "last_edit_date": 1531534988, "creation_date": 1531530535, "answer_id": 51334393, "question_id": 51288241, "link": "https://stackoverflow.com/questions/51288241/how-to-add-a-macro-to-mutiple-excel-files-using-vba/51334393#51334393", "title": "How to add a macro to mutiple excel files using VBA", "body": "<p>I would think the easiest way to have the same code in slightly different Excel files is to have one 'template' and save it several times as several slightly different files.  Or, if you want to get fancy, you can create an AddIn to make an Excel Macro available to all workbooks.</p>\n\n<pre><code>Option Explicit\nDim cControl As CommandBarButton\n\nPrivate Sub Workbook_AddinInstall()\nOn Error Resume Next 'Just in case\n    'Delete any existing menu item that may have been left.\n    Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"Super Code\").Delete\n    'Add the new menu item and Set a CommandBarButton Variable to it\n    Set cControl = Application.CommandBars(\"Worksheet Menu Bar\").Controls.Add\n    'Work with the Variable\n        With cControl\n            .Caption = \"Super Code\"\n            .Style = msoButtonCaption\n            .OnAction = \"MyGreatMacro\"\n            'Macro stored in a Standard Module\n        End With\n    On Error GoTo 0\nEnd Sub\n\nPrivate Sub Workbook_AddinUninstall()\nOn Error Resume Next 'In case it has already gone.\n    Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"Super Code\").Delete\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>This code will be all you need to add a single menu item (called Super Code) to the end of the existing Worksheet Menu Bar as soon as the Add-in is installed by the user via Tools>Add-ins. When the Super Code menu item is clicked a macro (that is within a standard module of the add-in) is run. As mentioned earlier, the above code MUST be placed in the Private Module of ThisWorkbook for the Add-in. </p>\n\n<p>If you want the Super Code menu item added, say before the Format menu item, you could use some code like this.</p>\n\n<pre><code>Option Explicit\nDim cControl As CommandBarButton\n\nPrivate Sub Workbook_AddinInstall()\nDim iContIndex As Integer\n    On Error Resume Next 'Just in case\n    'Delete any existing menu item that may have been left\n    Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"SuperCode\").Delete\n    'Pass the Index of the \"Format\" menu item number to a Variable.\n    'Use the FindControl Method to find it's Index number. ID number _\n     is used in case of Customization\n    iContIndex = Application.CommandBars.FindControl(ID:=30006).Index\n    'Add the new menu item and Set a CommandBarButton Variable to it.\n    'Use the number passed to our Integer Variable to position it.\n    Set cControl = Application.CommandBars(\"Worksheet Menu Bar\").Controls.Add(Before:=iContIndex)\n    'Work with the Variable\n        With cControl\n            .Caption = \"Super Code\"\n            .Style = msoButtonCaption\n            .OnAction = \"MyGreatMacro\" \n            'Macro stored in a Standard Module\n        End With\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>There would be no need to change the Workbook_AddinUninstall() code in this case.</p>\n\n<p>We have covered ID numbers while working with CommandBars etc in a P rior Newsletter Issue The link to the Microsoft site that has a BIG list of all the ID numbers for working with CommandBars can be Found Here</p>\n\n<p>The above examples actually have the all the menu item code in the Workbook_AddinInstall and Workbook_AddinUnInstall Not a problem when the code is only adding one menu item. If however, you will be adding more then one and perhaps even Sub menus, you should place it in a Procedure (or 2) inside a standard Module. Then use some code as shown below</p>\n\n<pre><code>Private Sub Workbook_AddinInstall()\nRun \"AddMenus\"\nEnd Sub\n\n\n\nPrivate Sub Workbook_AddinUninstall()\nRun \"DeleteMenu\"\nEnd Sub\n</code></pre>\n\n<p>Then in the standard module put some code perhaps like this</p>\n\n<pre><code>Sub AddMenus()\nDim cMenu1 As CommandBarControl\nDim cbMainMenuBar As CommandBar\nDim iHelpMenu As Integer\nDim cbcCutomMenu As CommandBarControl\n    '(1)Delete any existing one.We must use On Error Resume next _\n        in case it does not exist.\n    On Error Resume Next\n    Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"&amp;NewMenu\").Delete\n    '(2)Set a CommandBar variable to Worksheet menu bar\n    Set cbMainMenuBar = Application.CommandBars(\"Worksheet Menu Bar\")\n    '(3)Return the Index number of the Help menu. We can then use _\n        this to place a custom menu before.\n    iHelpMenu = cbMainMenuBar.Controls(\"Help\").Index\n    '(4)Add a Control to the \"Worksheet Menu Bar\" before Help\n    'Set a CommandBarControl variable to it\n    Set cbcCutomMenu = cbMainMenuBar.Controls.Add(Type:=msoControlPopup, Before:=iHelpMenu)\n    '(5)Give the control a caption\n    cbcCutomMenu.Caption = \"&amp;New Menu\"\n    '(6)Working with our new Control, add a sub control and _\n        give it a Caption and tell it which macro to run (OnAction).\n            With cbcCutomMenu.Controls.Add(Type:=msoControlButton)\n                .Caption = \"Menu 1\"\n                .OnAction = \"MyMacro1\"\n            End With\n    '(6a)Add another sub control give it a Caption _\n        and tell it which macro to run (OnAction)\n            With cbcCutomMenu.Controls.Add(Type:=msoControlButton)\n                .Caption = \"Menu 2\"\n                .OnAction = \"MyMacro2\"\n            End With\n'Repeat step \"6a\" for each menu item you want to add.\n    'Add another menu that will lead off to another menu\n    'Set a CommandBarControl variable to it\n        Set cbcCutomMenu = cbcCutomMenu.Controls.Add(Type:=msoControlPopup)\n    ' Give the control a caption\n        cbcCutomMenu.Caption = \"Next Menu\"\n    'Add a control to the sub menu, just created above\n        With cbcCutomMenu.Controls.Add(Type:=msoControlButton)\n            .Caption = \"&amp;Charts\"\n            .FaceId = 420\n.OnAction = \"MyMacro2\"\nEnd With\nOn Error GoTo 0\nEnd Sub\n\n\nSub DeleteMenu()\nOn Error Resume Next\nApplication.CommandBars(\"Worksheet Menu Bar\").Controls(\"&amp;NewMenu\").Delete\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>You can find all details here.</p>\n\n<p><a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/excel-add-in-create.htm</a></p>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531534988, "creation_date": 1531319760, "question_id": 51288241, "link": "https://stackoverflow.com/questions/51288241/how-to-add-a-macro-to-mutiple-excel-files-using-vba", "title": "How to add a macro to mutiple excel files using VBA", "body": "<p>Is there any way to write a VBA Macro to input another VBA Macro into multiple excel workbooks? If so, how do I start?</p>\n\n<p>Any and all help is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319736, "post_id": 51288195, "comment_id": 89554140, "body": "You need to start at row 17 or the first loop will try to do <code>Rows(&quot;-15:14&quot;)</code> and there are no negative rows."}, {"owner": {"reputation": 1, "user_id": 10065570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204704199081621/picture?type=large", "display_name": "Karl Monfort", "link": "https://stackoverflow.com/users/10065570/karl-monfort"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531320125, "post_id": 51288195, "comment_id": 89554478, "body": "Thanks for the reply. I tried editing it, but it still didnt hide the cells. Btw the cells contains if functions that returns &quot;Bar Already Terminated&quot; if the value returns false to some other reference cells. Does it affect the result?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531320418, "post_id": 51288195, "comment_id": 89554670, "body": "So the error is gone?"}, {"owner": {"reputation": 1, "user_id": 10065570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204704199081621/picture?type=large", "display_name": "Karl Monfort", "link": "https://stackoverflow.com/users/10065570/karl-monfort"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531321761, "post_id": 51288195, "comment_id": 89555602, "body": "Yes, I just dont know why it still doesnt work huhu, anyway I&#39;ll do some twicks then I&#39;ll get back to you if it works. thanks again! :D"}], "owner": {"reputation": 1, "user_id": 10065570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204704199081621/picture?type=large", "display_name": "Karl Monfort", "link": "https://stackoverflow.com/users/10065570/karl-monfort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531320256, "creation_date": 1531319612, "last_edit_date": 1531319639, "question_id": 51288195, "link": "https://stackoverflow.com/questions/51288195/how-to-hide-rows-16-rows-above-and-13-rows-below-in-a-cell-where-it-has-a-value", "title": "How To Hide Rows 16 rows above and 13 rows below in a cell where it has a value that says Bar is Already Terminated In Excel", "body": "<pre><code>Sub Button210_Click()\nDim r As Long\nFor r = 1 To 1500 Step 30\n    Rows(r - 16 &amp; \":\" &amp; r + 13).Hidden = Cells(r, \"C\").Value = \"Bar Already Terminated\"\nNext\nEnd Sub\n</code></pre>\n\n<p>The code above returns Type Mismatch. Im new in vba, please help. Thanks</p>\n"}, {"tags": ["sql-server", "ms-access", "hash", "vba", "varbinary"], "comments": [{"owner": {"reputation": 45, "user_id": 4621064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e3G7rpQfsDQ/AAAAAAAAAAI/AAAAAAAAAA4/O8ySz-JJsIc/photo.jpg?sz=128", "display_name": "wendykcoding", "link": "https://stackoverflow.com/users/4621064/wendykcoding"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1531324544, "post_id": 51288178, "comment_id": 89557309, "body": "I hope my edit provides a little clarification. I don&#39;t understand why my sup wants this hash of an image and expect it to display the actual image in an Access report"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4621064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e3G7rpQfsDQ/AAAAAAAAAAI/AAAAAAAAAA4/O8ySz-JJsIc/photo.jpg?sz=128", "display_name": "wendykcoding", "link": "https://stackoverflow.com/users/4621064/wendykcoding"}, "edited": false, "score": 0, "creation_date": 1531355900, "post_id": 51290624, "comment_id": 89569177, "body": "Thank you. I am going to read up on your links and test them tomorrow at work. This is the first part of a larger project which I am working on, at the moment, I really would like to have the forms working and reports generated.  Will let you know how it goes."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1531327663, "creation_date": 1531327663, "answer_id": 51290624, "question_id": 51288178, "link": "https://stackoverflow.com/questions/51288178/how-does-varbinary-datatype-work-to-store-image-for-a-user-to-view-in-access-fro/51290624#51290624", "title": "How does varbinary datatype work to store image for a user to view in Access front end?", "body": "<p>A <code>VARBINARY</code> field in SQL server is a field that stores binary data, and is often used for storing files. You can fit entire files in this field.</p>\n\n<p>If you have a <code>VARBINARY</code> field in SQL server, and create a linked table in Access to the table with that field, it gets interpreted as an OLE object, since OLE objects are binary data too. </p>\n\n<p>You can use the <em>Bound object frame</em> control in Access to save images into OLE objects, both as an image (which is displayable), or as a package. This does not require any code. You can right click the field -> Insert Object -> Bitmap Image to insert bitmap images into an OLE field. However, this stores OLE object data along with the image data, which makes it <strong><em>very</em></strong> hard to work with using code, and nearly impossible in non-vba applications. Using this approach is only justifiable if you're sure you're going to stick with Access for the lifetime of the database, in my opinion.</p>\n\n<p>I've shared an example on working with VBA code and the OLE object <a href=\"https://stackoverflow.com/a/48711364/7296893\">here</a>, but that uses hacky code that executes GUI operations. It's nearly impossible to port to other applications. I recommend you use the next way instead. </p>\n\n<p>Alternatively, you can directly store binary data in the OLE object/Varbinary field. This makes it a lot easier to deal with using VBA code or any future application, since it's just the file data stored in the field, there's no OLE object data stored with it.  I've shared code to load binary data in a field and save it back to disk <a href=\"https://stackoverflow.com/a/49522352/7296893\">here</a>. </p>\n\n<p>The hard part of this puzzle, if you're just working with binary image data, is displaying the image to the user. I've shared 3 approaches <a href=\"https://stackoverflow.com/a/46793834/7296893\">here</a>, with code for one one of them. However, that's quite complex VBA code.</p>\n"}], "owner": {"reputation": 45, "user_id": 4621064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e3G7rpQfsDQ/AAAAAAAAAAI/AAAAAAAAAA4/O8ySz-JJsIc/photo.jpg?sz=128", "display_name": "wendykcoding", "link": "https://stackoverflow.com/users/4621064/wendykcoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 51290624, "answer_count": 1, "score": 0, "last_activity_date": 1531327663, "creation_date": 1531319556, "last_edit_date": 1531327275, "question_id": 51288178, "link": "https://stackoverflow.com/questions/51288178/how-does-varbinary-datatype-work-to-store-image-for-a-user-to-view-in-access-fro", "title": "How does varbinary datatype work to store image for a user to view in Access front end?", "body": "<p>I did some research and the web has taken me all over the place and I still haven't found a suitable solution or guide to what I am trying to achieve.</p>\n\n<p>I read up a similar post to what I am asking. Except that's #php\n<a href=\"https://stackoverflow.com/questions/24400767/how-to-store-and-retrieve-image-in-sql-server-varbinarymax-datatype\">Retrieving Image in SQL Server (varbinary)</a></p>\n\n<p>Update:\nThe \"conventional\" way is the create file directory and file path. This was my initial method to get the front end up and running for the user. \nMy sup actually advised that I use this hash method nonsense which he can't even explain properly to me.</p>\n\n<p>A user must be able to insert an image on the form, generate a report displaying the image as well.</p>\n\n<p>How does the varbinary work to link sql and Access for what I am trying to achieve? I am currently playing around with my development to resolve it.</p>\n\n<p>Any clarification?\nI have no other way of putting this question after my first edit.</p>\n\n<p>This is the form\n<a href=\"https://i.stack.imgur.com/TR5IL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TR5IL.png\" alt=\"The Picture field is OLE Object type because the SQL datatype is varbinary. I think this is how Access recognises it.\"></a></p>\n\n<p>For each form entry a user should insert a picture to support the Findings.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1531318801, "post_id": 51287887, "comment_id": 89553400, "body": "is vba really necessary: <code>=SUM(N:N)-SUM(SUMIFS(N:N,M:M,{&quot;Equipment&quot;,&quot;Other&quot;}))</code>"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319009, "post_id": 51287887, "comment_id": 89553565, "body": "I mean, necessary, probably not.  But would be nice to have all the code and functionality be consistent througout.  also, how does this account for Sheet1 and sheet0 not being in the same workbooks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319109, "post_id": 51287887, "comment_id": 89553640, "body": "Formulas can reference another workbook: <a href=\"https://www.ablebits.com/office-addins-blog/2015/12/08/excel-reference-another-sheet-workbook/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2015/12/08/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319162, "post_id": 51287887, "comment_id": 89553672, "body": "But in your vba use the top one and change the formula being evaluated to the formula I provided."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319753, "post_id": 51287887, "comment_id": 89554157, "body": "That is a good suggestion thank you, but it throws a &quot;Compile error: Expected: list separator or ) &quot;.  I have never written it out where a formula is used in a line of VBA, that was a copy of another solution from the site so I never understood it could be done that way."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319805, "post_id": 51287887, "comment_id": 89554195, "body": "please show the line as you entered it, I cannot read your screen."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531319998, "post_id": 51287887, "comment_id": 89554384, "body": "Oh, I thought you could, sorry.  :)     This is the line: <code>lAnswer = wbFrom.Sheets(&quot;Sheet0&quot;).Evaluate(&quot;=SUM(N:N)-SUM(SUMIFS(N:N,M&zwnj;&#8203;:M,{&quot;Equipment&quot;,&quot;Oth&zwnj;&#8203;er&quot;}))&quot;)</code> and  <code>lAnswer = wbFrom.Sheets(&quot;Sheet0&quot;).Evaluate(=SUM(N:N)-SUM(SUMIFS(N:N,M:&zwnj;&#8203;M,{&quot;Equipment&quot;,&quot;Othe&zwnj;&#8203;r&quot;})))</code> and <code>lAnswer = wbFrom.Sheets(&quot;Sheet0&quot;).Evaluate(&quot;SUMPRODUCT(N:N)-SUM(SUMIFS&zwnj;&#8203;(N:N,M:M,{&quot;Equipment&zwnj;&#8203;&quot;,&quot;Other&quot;}))&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531320080, "post_id": 51287887, "comment_id": 89554442, "body": "you need to double the <code>&quot;</code> inside the string: <code>lAnswer = wbFrom.Sheets(&quot;Sheet0&quot;).Evaluate(&quot;=SUM(N:N)-SUM(SUMIFS(N:N,M&zwnj;&#8203;:M,{&quot;&quot;Equipment&quot;&quot;,&quot;&quot;&zwnj;&#8203;Other&quot;&quot;}))&quot;)</code>"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531320821, "post_id": 51287887, "comment_id": 89554964, "body": "That has removed the error, thank you - however the sum coming up in D16 of Sheet1 in the other workbook is coming up as zero.  In an earlier version of the attempt, I used <code>Set rng3 = wbFrom.Sheets(&quot;Sheet0&quot;).Range(&quot;N9&quot;, Range(&quot;N9&quot;).End(xlDown))</code> to get the range and help add -- that looks to no longer be needed with the N:N and M:M columns your way.  Any thoughts on why it is not adding up right at all?"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531324548, "post_id": 51287887, "comment_id": 89557313, "body": "I attempted to use just the formula, on the sheet itself, outside of the VBA example we are talking about - and even in the SUM formula, the result is still zero.  Used <code>=SUM(P:P)-SUM(SUMIFS(P:P,K:K,{&quot;Static&quot;,&quot;Other&quot;}))</code> (in excel outside of the VBA).  Converting the column to &#39;number&#39; doesn&#39;t change the results also."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531329764, "post_id": 51287887, "comment_id": 89559993, "body": "So I was able to adapt your suggestion, to this, and get an answer (yay):  <code>lAnswer = wbFrom.Sheets(&quot;Sheet0&quot;).Evaluate(&quot;=SUM(P9:P9999) - (SUMIF(K9:K9999,&quot;&quot;Static IP MRC&quot;&quot;,P9:P9999)+SUMIF(K9:K9999,&quot;&quot;Deposit NRC&quot;&quot;,P9:P9999))&quot;)</code>  however, it only works if I manually convert the column from general to Number.  The info comes in as General and not numbers so by default the formula will not work without some other kind of intervention which is not ideal.  I guess I have to figure out how to convert it via code at the time of copying it?"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1531330199, "creation_date": 1531330199, "answer_id": 51291258, "question_id": 51287887, "link": "https://stackoverflow.com/questions/51287887/sum-all-of-the-values-in-column-n-except-for-when-a-specific-criteria-is-met-in/51291258#51291258", "title": "Sum all of the values in Column N, EXCEPT for when a specific criteria is met in Column M", "body": "<p>So I was able to adapt your suggestion, to this, and get an answer (yay):  <code>lAnswer = wbFrom.Sheets(\"Sheet0\").Evaluate(\"=SUM(P9:P9999) - (SUMIF(K9:K9999,\"\"Static IP MRC\"\",P9:P9999)+SUMIF(K9:K9999,\"\"Deposit NRC\"\",P9:P9999))\")</code><br>\nhowever, it only works if I manually convert the column from general to Number.  </p>\n\n<p>So I added this and it converts and works now: </p>\n\n<p><code>Range(\"P9:P9999\").Select 'specify the range which suits your purpose\nWith Selection\nSelection.NumberFormat = \"General\"\n.Value = .Value\nEnd With</code></p>\n\n<p>Thanks again for all your help Scott!</p>\n"}], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531330199, "creation_date": 1531318700, "question_id": 51287887, "link": "https://stackoverflow.com/questions/51287887/sum-all-of-the-values-in-column-n-except-for-when-a-specific-criteria-is-met-in", "title": "Sum all of the values in Column N, EXCEPT for when a specific criteria is met in Column M", "body": "<p>I need to sum up all of the values in Column_N, EXCEPT for when a specific criteria is met in Column_M.  </p>\n\n<p>I want to sum everything up in ColN of sheet0 except for when things like 'Equipment' and 'other' values are found in ColM of Sheet0.  Then I need to put that Sum into cell D16 of Sheet1 in a different workbook.  </p>\n\n<p>(The values in Column M can be in any order and are not always in the same order, so I can't just ignore the last two or three rows.)  </p>\n\n<pre><code>Col_M        Col_N\nStatic       30\nPlan         1850\nMain         150\nSwitch       54.95\nEquipment    24.95\nOther        4.95\n</code></pre>\n\n<p>So instead of the sum of this column N being $2,114, it should only be $2,084, because Equipment and Other exist in Column M.  </p>\n\n<p>This is how I currently sum the column:</p>\n\n<pre><code>Dim rng3 As Range\nDim lAnswer As Variant\nSet rng3 = wbFrom.Sheets(\"Sheet0\").Range(\"N9\", Range(\"N9\").End(xlDown))\nlAnswer = wbFrom.Sheets(\"Sheet0\").Evaluate(\"SUMPRODUCT(--N9:N50000)\")\nwbTo.Sheets(\"Sheet1\").Range(\"D16\").Value = lAnswer\n</code></pre>\n\n<p>I use this to pull out values for when a match occurs.  I think I need to change this logic to instead of when it matches, to when it does NOT match - but am not sure how to do that. </p>\n\n<pre><code>Dim range1 As Range\n\nLstRw = Cells(Rows.Count, \"K\").End(xlUp).Row\n\nFor Each range1 In wbFrom.Sheets(\"Sheet0\").Range(\"K9:K\" &amp; LstRw)\n  If range1 = \"Construction Costs NRC\" Then\nwbTo.Sheets(\"Sheet1\").Range(\"D10\") = range1.Offset(0, 10)\n  End If\nNext\n\n'and this \n\nLstRw = Cells(Rows.Count, \"Y\").End(xlUp).Row\nSet List = CreateObject(\"Scripting.Dictionary\")\n\nFor Each rng In Range(\"Y9:Y\" &amp; LstRw)\n  If rng.Offset(0, 0) &lt;&gt; \"Company\" And rng.Offset(0, 0) &lt;&gt; \"\" Then\n    If Not List.exists(rng.Value) Then List.Add rng.Value, Nothing\n\n  End If\nNext\n</code></pre>\n\n<p>Is there a way to better combine these two thoughts into one bit of code? </p>\n"}, {"tags": ["vba", "search"], "comments": [{"owner": {"reputation": 47, "user_id": 9542263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/av9ZD.png?s=128&g=1", "display_name": "Customizer", "link": "https://stackoverflow.com/users/9542263/customizer"}, "edited": false, "score": 0, "creation_date": 1531318694, "post_id": 51287835, "comment_id": 89553317, "body": "What/where is the source of your data?"}, {"owner": {"reputation": 11, "user_id": 10065445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p1j-0nAjavU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o5-gRI4JO9bHuKdyDj6md5CLsKiQ/mo/photo.jpg?sz=128", "display_name": "McKenzie", "link": "https://stackoverflow.com/users/10065445/mckenzie"}, "reply_to_user": {"reputation": 47, "user_id": 9542263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/av9ZD.png?s=128&g=1", "display_name": "Customizer", "link": "https://stackoverflow.com/users/9542263/customizer"}, "edited": false, "score": 0, "creation_date": 1531406070, "post_id": 51287835, "comment_id": 89593336, "body": "It is in an excell spreadsheet with the labels of Name, Food Type, Price Points, and people attending."}], "owner": {"reputation": 11, "user_id": 10065445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p1j-0nAjavU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o5-gRI4JO9bHuKdyDj6md5CLsKiQ/mo/photo.jpg?sz=128", "display_name": "McKenzie", "link": "https://stackoverflow.com/users/10065445/mckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531330987, "creation_date": 1531318567, "last_edit_date": 1531330987, "question_id": 51287835, "link": "https://stackoverflow.com/questions/51287835/multiple-selection-search-narrow", "title": "Multiple Selection Search Narrow", "body": "<p>I am wanting to create a catering search for my coworkers that allows them to pick things like people attending and food type and then it will narrow down the spreadsheet of catering options to those parameters. I am extremely new to VBA and been trying to search for how to do this but I feel like I don't know the correct terms. How would I go about making this happen if it even is possible? </p>\n\n<p>what I want to be pulled</p>\n\n<p><a href=\"https://i.stack.imgur.com/3imcc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3imcc.jpg\" alt=\"what I want to be pulled\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531317210, "post_id": 51287256, "comment_id": 89552096, "body": "Are all the named ranges on the same sheet?  Are the updates to those ranges being done directly to the ranges manually, or are they the product of formulas in the named ranges?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1531317215, "post_id": 51287256, "comment_id": 89552105, "body": "Share with us your &#39;Worksheet Changes&#39; sub and we&#39;ll help you get it working.."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1531317237, "post_id": 51287256, "comment_id": 89552126, "body": "Is there any overlap among the Named ranges ??"}, {"owner": {"reputation": 13, "user_id": 10065331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd1b8249866d50c3dcdbc1a39242af5?s=128&d=identicon&r=PG&f=1", "display_name": "zfray100", "link": "https://stackoverflow.com/users/10065331/zfray100"}, "edited": false, "score": 0, "creation_date": 1531317437, "post_id": 51287256, "comment_id": 89552303, "body": "All of the updates are manual and all of the named ranges are distinct. The named ranges do not share any cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531317535, "post_id": 51287256, "comment_id": 89552383, "body": "Are they on the same sheet?"}, {"owner": {"reputation": 13, "user_id": 10065331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd1b8249866d50c3dcdbc1a39242af5?s=128&d=identicon&r=PG&f=1", "display_name": "zfray100", "link": "https://stackoverflow.com/users/10065331/zfray100"}, "edited": false, "score": 0, "creation_date": 1531317564, "post_id": 51287256, "comment_id": 89552406, "body": "Yes, they are on the same sheet."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1531317639, "post_id": 51287256, "comment_id": 89552467, "body": "Please note that <b>C is not a valid name for a Named Range.</b>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1531317647, "post_id": 51287256, "comment_id": 89552473, "body": "Then please show the code that is not working, so we can help solve the problem."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531317792, "post_id": 51287256, "comment_id": 89552595, "body": "you could test if a specific name was changed by <code>If Not Intersect(Target, Range(&quot;Name1&quot;)) Is Nothing Then &#39;Name1 changed</code> would that fit your needs? If not: Are your names in the workbook scope or in the worksheet scope if you look into the name manager?"}], "answers": [{"tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1531317945, "creation_date": 1531317945, "answer_id": 51287605, "question_id": 51287256, "link": "https://stackoverflow.com/questions/51287256/identify-and-paste-the-named-range-that-was-most-recently-updated/51287605#51287605", "title": "Identify and Paste the named range that was most recently updated", "body": "<p>In your worksheet code: here is an example.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Target, Me.Range(\"RangeA\")) Is Nothing Then\n    ThisWorkbook.worksheets(\"SomeSheet\").Range(\"a cell\").Value = \"A\"\nelseif Not Application.Intersect(Target, Me.Range(\"RangeB\")) Is Nothing Then\n    ThisWorkbook.worksheets(\"SomeSheet\").Range(\"a cell\").Value = \"B\"\n'etc ....\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1531318382, "creation_date": 1531318382, "answer_id": 51287764, "question_id": 51287256, "link": "https://stackoverflow.com/questions/51287256/identify-and-paste-the-named-range-that-was-most-recently-updated/51287764#51287764", "title": "Identify and Paste the named range that was most recently updated", "body": "<p>This assumes that the \"other\" worksheet is named \"track\" and that the three Named Ranges are named \"A\", \"B\", and \"D\" <em>(for some reason \"C\" is not valid)</em>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n\n    msg = \"\"\n\n    If Not Intersect(Target, Range(\"A\")) Is Nothing Then msg = \"A\"\n    If Not Intersect(Target, Range(\"B\")) Is Nothing Then msg = \"B\"\n    If Not Intersect(Target, Range(\"D\")) Is Nothing Then msg = \"D\"\n    If msg = \"\" Then Exit Sub\n\n    Application.EnableEvents = False\n        Sheets(\"track\").Range(\"A1\").Value = msg\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1531318448, "creation_date": 1531318448, "answer_id": 51287788, "question_id": 51287256, "link": "https://stackoverflow.com/questions/51287256/identify-and-paste-the-named-range-that-was-most-recently-updated/51287788#51287788", "title": "Identify and Paste the named range that was most recently updated", "body": "<p>You can test if any name intersects with the changed target</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim N As Name\n    For Each N In Application.Names 'loop throug all names in the workbook scope\n        If Not Intersect(Target, N.RefersToRange) Is Nothing Then\n            Debug.Print N.Name 'print changed name\n            Exit For 'stop loop if a name intersects\n        End If\n    Next N\nEnd Sub\n</code></pre>\n\n<p>Depending on if you need to check the workbook scope names or the worksheet scope names you need to use either <code>Application.Names</code> or <code>Me.Names</code> in the <code>Each</code> loop.</p>\n\n<p>If you have overlapping names remove the <code>Exit For</code> to output all changed names.</p>\n"}], "owner": {"reputation": 13, "user_id": 10065331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd1b8249866d50c3dcdbc1a39242af5?s=128&d=identicon&r=PG&f=1", "display_name": "zfray100", "link": "https://stackoverflow.com/users/10065331/zfray100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51287764, "answer_count": 3, "score": 0, "last_activity_date": 1549012526, "creation_date": 1531317083, "last_edit_date": 1549012526, "question_id": 51287256, "link": "https://stackoverflow.com/questions/51287256/identify-and-paste-the-named-range-that-was-most-recently-updated", "title": "Identify and Paste the named range that was most recently updated", "body": "<p>I am trying to use VBA to identify the name of the named range that was most recently updated. I have been trying to use Worksheet Changes but have not gotten anywhere. In other words, if I have three named ranges \"A\", \"B\", and \"C\" all on the same worksheet and the named range \"B\" is changed. I want the name \"B\" not the data in the range to be pasted in a cell on a different worksheet. Thank you for any help.</p>\n"}, {"tags": ["excel", "vba", "outlook", "calendar"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1531343107, "post_id": 51286664, "comment_id": 89565796, "body": "You may have success with this method to reference a shared calendar <a href=\"https://stackoverflow.com/questions/20141659/outlook-2013-vba-display-shared-calendar\" title=\"outlook 2013 vba display shared calendar\">stackoverflow.com/questions/20141659/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1531513346, "last_edit_date": 1531513346, "creation_date": 1531512244, "answer_id": 51332129, "question_id": 51286664, "link": "https://stackoverflow.com/questions/51286664/saving-appointments-to-a-shared-outlook-calendar-from-excel/51332129#51332129", "title": "Saving appointments to a shared Outlook calendar from Excel", "body": "<p>I haven't tested this on other PCs, but the code below works fine for me.</p>\n\n<pre><code>Private Sub Add_Appointments_To_Outlook_Calendar()\n\n    'Include Microsoft Outlook nn.nn Object Library from Tools -&gt; References\n    Dim oAppt As AppointmentItem\n    Dim Remind_Time As Double\n\n    i = 2\n    Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n\n    'Loop through entire list of Reminders to be added\n    While Subj &lt;&gt; \"\"\n        Set oAppt = Outlook.Application.CreateItem(olAppointmentItem)\n\n        oAppt.Subject = Subj\n        oAppt.Location = ThisWorkbook.Sheets(1).Cells(i, 2)\n        oAppt.Start = ThisWorkbook.Sheets(1).Cells(i, 3)\n        Remind_Time = ThisWorkbook.Sheets(1).Cells(i, 4) * 1 * 60\n        oAppt.ReminderMinutesBeforeStart = Remind_Time\n        oAppt.AllDayEvent = True\n        oAppt.Save\n\n        i = i + 1\n        Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n    Wend\n    MsgBox \"Reminder(s) Added To Outlook Calendar\"\n\nEnd Sub\n</code></pre>\n\n<p>' <a href=\"https://www.slipstick.com/developer/create-appointments-spreadsheet-data/\" rel=\"nofollow noreferrer\">https://www.slipstick.com/developer/create-appointments-spreadsheet-data/</a></p>\n\n<p>' <a href=\"https://blogs.msdn.microsoft.com/brunoterkaly/2014/07/24/scheduling-appointments-in-outlook-from-excel/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/brunoterkaly/2014/07/24/scheduling-appointments-in-outlook-from-excel/</a></p>\n"}], "owner": {"reputation": 13, "user_id": 4302227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50fea89e096ec5c0fc762ef08eef2e7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D", "link": "https://stackoverflow.com/users/4302227/ryan-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531513346, "creation_date": 1531315546, "question_id": 51286664, "link": "https://stackoverflow.com/questions/51286664/saving-appointments-to-a-shared-outlook-calendar-from-excel", "title": "Saving appointments to a shared Outlook calendar from Excel", "body": "<p>I have a script which adds an appointment to a shared outlook calendar. The script below works on the calendar's host computer but not from other pc's. The code is: </p>\n\n<pre><code>Sub OC1SOAK()\nDim oApp As Object\nDim oNameSpace As Namespace\nDim oFolder As Object\nDim OutTaskOC11 As Outlook.AppointmentItem\nDim OutTaskOC12 As Outlook.AppointmentItem\nDim OutTaskOC115 As Outlook.AppointmentItem\nSet oApp = New Outlook.Application\nSet oNameSpace = oApp.GetNamespace(\"MAPI\")\nSet oFolder = oNameSpace.GetFolderFromID(\"*folderidhere*\")\nWith oFolder\n    Set OutTaskOC11 = oFolder.Items.ADD(olAppointmentItem)\n    Set OutTaskOC12 = oFolder.Items.ADD(olAppointmentItem)\n    Set OutTaskOC115 = oFolder.Items.ADD(olAppointmentItem)\n    With OutTaskOC11\n        .Subject = TR.Text + \"   \" + Fuel1.Text + \"   \" + \"Vapor\" + \"   \" + \"Start\"\n        .Start = startdate.Text\n        .End = startdate.Text\n    End With\n    With OutTaskOC12\n        .Subject = TR.Text + \"   \" + Fuel1.Text + \"   \" + \"Submerged\"\n        .Start = Format(DateValue(startdate.Text) + Val(\"3\"), \"mm/dd/yyyy\")\n        .End = Format(DateValue(startdate.Text) + Val(\"3\"), \"mm/dd/yyyy\")\n    End With\n        With OutTaskOC115\n        .Subject = TR.Text + \"   \" + \"Finished\"\n        .Start = Format(DateValue(startdate.Text) + Val(\"6\"), \"mm/dd/yyyy\")\n        .End = Format(DateValue(startdate.Text) + Val(\"6\"), \"mm/dd/yyyy\")\n    End With\n    OutTaskOC11.SAVE\n    OutTaskOC12.SAVE\n    OutTaskOC115.SAVE\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The error I get is, </p>\n\n<blockquote>\n  <p>Run-time error '-2147220991 (80040201)': The operation failed. The\n  messaging interfaces have returned an unknown error. If the problem\n  persists, restart outlook.</p>\n</blockquote>\n\n<p>Anyone have any ideas why? I've checked calendar share permissions. I originally thought it was due using Createitems/move so I went with items.add instead. </p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1531314834, "post_id": 51286302, "comment_id": 89550300, "body": "Can they change the value of B also, or just A?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1531314838, "post_id": 51286302, "comment_id": 89550303, "body": "I take it you can&#39;t put a formula in column B - something like <code>= 1 - Column A</code> ?"}, {"owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "edited": false, "score": 0, "creation_date": 1531315005, "post_id": 51286302, "comment_id": 89550437, "body": "ideally, the two related columns can change values both ways"}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1531315837, "post_id": 51286302, "comment_id": 89551041, "body": "Can you have hidden column where you  store sum of <code>columns A</code> and <code>B</code> as values?  These values would need to get updated on <code>workbook_open</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1531316822, "post_id": 51286302, "comment_id": 89551776, "body": "Your main issue is that when a cell changes, you lose it&#39;s previous value. I&#39;d suggest researching Events and there are plenty of examples of ways to overcome that. Once you have some code, if you&#39;re still struggling to get it to work then we should be better placed to help further. (or.. if you&#39;re <i>really</i> lucky, you might get someone generous enough to do it for you..)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1531316752, "creation_date": 1531316752, "answer_id": 51287140, "question_id": 51286302, "link": "https://stackoverflow.com/questions/51286302/seeking-a-solution-for-when-user-decrements-a-cells-value-another-cell-differ/51287140#51287140", "title": "seeking a solution for when user decrements a cell&#39;s value, another cell (different column) will increment that same value", "body": "<p>Here is an example for columns <strong>A</strong> and <strong>B</strong>.  Insert this event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range, OldValue As Variant, NewValue As Variant, Delta As Variant\n    Set A = Range(\"A:A\")\n    If Intersect(Target, A) Is Nothing Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n\n    Application.EnableEvents = False\n        NewValue = Target.Value\n        Application.Undo\n        OldValue = Target.Value     'capture previous value\n        Target.Value = NewValue    'restore new value\n        If NewValue &lt; OldValue Then\n            Delta = OldValue - NewValue\n            Target.Offset(0, 1).Value = Target.Offset(0, 1).Value + Delta\n        End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>If a value in column <strong>A</strong> is reduced by user action, the value in column <strong>B</strong> <em>(in the adjacent cell)</em> will be increased by the same amount.</p>\n\n<p>If the value in column <strong>A</strong> is increased, then no action is taken.  If more than one cell in column <strong>A</strong> is changed at the same time, no action is taken.</p>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1531317002, "creation_date": 1531317002, "answer_id": 51287222, "question_id": 51286302, "link": "https://stackoverflow.com/questions/51286302/seeking-a-solution-for-when-user-decrements-a-cells-value-another-cell-differ/51287222#51287222", "title": "seeking a solution for when user decrements a cell&#39;s value, another cell (different column) will increment that same value", "body": "<p>I kind of dislike that you have not showed any effort to solve your question, but given it is a fairly intriguing topic I gave it a go as a form of a nice \"practice homework\" for myself.</p>\n\n<p>This code produces the expected result:</p>\n\n<pre><code>Dim oldval As Long\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n   Dim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n   If Not Intersect(Target, ws.Range(\"A1:A\" &amp; Rows.Count)) Is Nothing Then\n        If IsNumeric(Target.Value2) Then\n            oldval = Target.Value2\n        Else\n            oldval = 0\n        End If\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>This first procedure is used to store the original value before change ^</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A1:A\" &amp; Rows.Count)) Is Nothing Then\n        Target.Offset(0, 1).Value2 = oldval - Target.Value2\n    End If\nEnd Sub\n</code></pre>\n\n<p>And upon change, displays the difference in column B ^</p>\n\n<blockquote>\n  <p>Input Data:</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/3kgg6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3kgg6.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Upon change in Column A <em>(result as expected)</em></p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/yMU9M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yMU9M.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "is_accepted": false, "score": 0, "last_activity_date": 1531318405, "creation_date": 1531318405, "answer_id": 51287774, "question_id": 51286302, "link": "https://stackoverflow.com/questions/51286302/seeking-a-solution-for-when-user-decrements-a-cells-value-another-cell-differ/51287774#51287774", "title": "seeking a solution for when user decrements a cell&#39;s value, another cell (different column) will increment that same value", "body": "<p>I have this, that will add sum on column A and B on <code>workbook_open</code> and then use it if A or B changes the value.</p>\n\n<p>This should go to the ThisWorkbook code area:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim i As Integer\nFor i = 1 To Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"Sheet1\").Range(\"C\" &amp; i) = Sheets(\"Sheet1\").Range(\"A\" &amp; i) + Sheets(\"Sheet1\").Range(\"B\" &amp; i)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This should got to the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 1 Then\n    Cells(Target.Row, 2) = Cells(Target.Row, 3) - Cells(Target.Row, 1)\n    End\nEnd If\nIf Target.Column = 2 Then\n    Cells(Target.Row, 1) = Cells(Target.Row, 3) - Cells(Target.Row, 2)\n    End\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51287140, "answer_count": 3, "score": -5, "last_activity_date": 1531318405, "creation_date": 1531314523, "last_edit_date": 1531314704, "question_id": 51286302, "link": "https://stackoverflow.com/questions/51286302/seeking-a-solution-for-when-user-decrements-a-cells-value-another-cell-differ", "title": "seeking a solution for when user decrements a cell&#39;s value, another cell (different column) will increment that same value", "body": "<p>example:</p>\n\n<pre><code>Column A = 1\nColumn B = 0\n</code></pre>\n\n<p>[user changes value of <code>Column A</code> to <code>0</code>]</p>\n\n<p>new values:</p>\n\n<pre><code>Column A = 0\nColumn B = 1\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1531317841, "post_id": 51286424, "comment_id": 89552629, "body": "Yes, Its working fine, all the issues and error messages gone ! thanks guys."}, {"owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1531317886, "post_id": 51286424, "comment_id": 89552663, "body": "Now I have one more doubt. I need to update that field itself for this I&#39;m using the query as follows.  str=&quot; Update tblImport set isworked=&#39;Y&#39; where claimId=&#39; &quot; &amp; cstr(rs!CalimId)  but it&#39;s not updating that field I checked with debug print then it&#39;s showing as update tblimport set isworked=&#39;Y&#39; where claimId=&#39;121212121     This much last  &#39; is not coming could you please help me to fix this?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1531321535, "post_id": 51286424, "comment_id": 89555451, "body": "Try removing the space and typo: <code>&quot; \u2026 where ClaimId=&#39;&quot; &amp; CStr(rs!ClaimId.Value) &amp; &quot;&#39;&quot;</code>."}, {"owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "edited": false, "score": 0, "creation_date": 1531387128, "post_id": 51286424, "comment_id": 89580304, "body": "Thanks for all the answers and replies it&#39;s working fine, thank you all"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1531314882, "creation_date": 1531314882, "answer_id": 51286424, "question_id": 51286132, "link": "https://stackoverflow.com/questions/51286132/record-set-issue-in-ms-access-2007/51286424#51286424", "title": "Record Set Issue in Ms Access 2007", "body": "<p>Use DAO:</p>\n\n<pre><code>Dim rs as DAO.Recordset  \n</code></pre>\n\n<p>That requires a reference for <strong>Microsoft Office xx.0 Access database engine Object Library</strong> to be set.</p>\n"}], "owner": {"reputation": 47, "user_id": 10010784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615ce996da891223914d89c2b18bc6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Shinilrk", "link": "https://stackoverflow.com/users/10010784/shinilrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51286424, "answer_count": 1, "score": 1, "last_activity_date": 1531314882, "creation_date": 1531314043, "question_id": 51286132, "link": "https://stackoverflow.com/questions/51286132/record-set-issue-in-ms-access-2007", "title": "Record Set Issue in Ms Access 2007", "body": "<p>I'm new to ms access VBA, I have a form and table  in ms access 2007.<br>\nin my table I will import some values for processing through this form.\nin that form I'm having 5 textboxes I want to text box should fill the values automatically. using the rs\nHere I need to create one recordset to make it easy for the user's<br>\nI have created one Query for this. but I'm facing some error messages when my page loads.   </p>\n\n<pre><code>Private sub Form_Load() \nDim strqry as string  \nDim rs as ADODB.Recordset  \nstrQry=\"select xyz,abc,ffg from tblImport where isworked='N'\"  \nset rs = currentdb.openrecordset(strqry)\n\nif not (rs.EOF and rs.BOF) then  \nme.textbox0.value=Cstr(rs!xyz)  \nme.textbox1.value=Cstr(rs!abc)  \nend if\n\nEnd sub\n</code></pre>\n\n<p>Here I 'm facing two error messages while form loads<br>\n1. type Mismatch runtime error 13<br>\n2. object variable or with variable not set , runtime error 91<br>\ncan any one help me on this ?\nPlease </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 113, "user_id": 7731623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TCREW.jpg?s=128&g=1", "display_name": "Nandan A", "link": "https://stackoverflow.com/users/7731623/nandan-a"}, "edited": false, "score": 0, "creation_date": 1531314273, "post_id": 51285960, "comment_id": 89549864, "body": "Probably duplicate of <a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\" title=\"copy from one workbook and paste into another\">stackoverflow.com/questions/19351832/&hellip;</a>"}, {"owner": {"reputation": 4707, "user_id": 3980115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0346113c8f43a8036d8989fa0ba3ae55?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad274", "link": "https://stackoverflow.com/users/3980115/vlad274"}, "edited": false, "score": 2, "creation_date": 1531315790, "post_id": 51285960, "comment_id": 89551013, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\">Copy from one workbook and paste into another</a>"}], "owner": {"reputation": 1, "user_id": 10064985, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WrsS5UsLIq4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7on2QjRl8ytbHjgLO7LO1IwE2C4Ug/mo/photo.jpg?sz=128", "display_name": "user10064985", "link": "https://stackoverflow.com/users/10064985/user10064985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531317611, "creation_date": 1531313546, "last_edit_date": 1531317611, "question_id": 51285960, "link": "https://stackoverflow.com/questions/51285960/copy-data-from-different-excel-files-from-different-folders-in-another-file", "title": "Copy data from different excel files from different folders in another file", "body": "<p>I have one folder containing subfolders and that subfolders are having .xlsx files.\nRead data from these .xlsx files and paste it into another excel file.</p>\n\n<p>How can I read data from multiple files?</p>\n"}, {"tags": ["vba", "excel", "clipboard"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531318267, "post_id": 51285401, "comment_id": 89552991, "body": "How difficult would it be to run it and edit the full error descriptions and codes into the question? Makes it a lot easier for others to help you with debugging."}, {"owner": {"reputation": 111, "user_id": 5756950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264840a8b80dae3c7342825d2da985d3?s=128&d=identicon&r=PG&f=1", "display_name": "Phizzy", "link": "https://stackoverflow.com/users/5756950/phizzy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1531318321, "post_id": 51285401, "comment_id": 89553047, "body": "I&#39;ve been trying to since I posted this. Sods law I can&#39;t reproduce the damned error."}, {"owner": {"reputation": 111, "user_id": 5756950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264840a8b80dae3c7342825d2da985d3?s=128&d=identicon&r=PG&f=1", "display_name": "Phizzy", "link": "https://stackoverflow.com/users/5756950/phizzy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531496027, "post_id": 51285401, "comment_id": 89632480, "body": "edited with errors."}, {"owner": {"reputation": 312, "user_id": 704977, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/geyHC.png?s=128&g=1", "display_name": "music2myear", "link": "https://stackoverflow.com/users/704977/music2myear"}, "edited": false, "score": 0, "creation_date": 1531772373, "post_id": 51285401, "comment_id": 89711293, "body": "I would guess that using a completely different method for storing and retrieving the information has some sizable benefits. It&#39;s been too long since I worked in VBA and macros, but have you tried storing the information in variables instead of the clipboard."}], "owner": {"reputation": 111, "user_id": 5756950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264840a8b80dae3c7342825d2da985d3?s=128&d=identicon&r=PG&f=1", "display_name": "Phizzy", "link": "https://stackoverflow.com/users/5756950/phizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531496015, "creation_date": 1531311809, "last_edit_date": 1531496015, "question_id": 51285401, "link": "https://stackoverflow.com/questions/51285401/experiencing-problems-with-copy-paste-excel-objects-shapes-with-vba", "title": "Experiencing problems with copy/paste excel objects/shapes with VBA", "body": "<p>I have some complex code which takes some user inputs (names of shapes to copy) then copies said shapes from one sheet to another multiple times. The items are grouped shapes drawn in Excel and all named correctly and uniquely.</p>\n\n<p>I receive copy and paste errors intermittently <strong>\"Method 'Paste' of object _Worksheet' failed\"</strong> and <strong>\"Method 'copy' Of Object '_worksheet' Failed</strong>. Through researching the problem we understand that it is fairly common and has something to do with programmes which conflict with Excel when they are accessing the clipboard.</p>\n\n<p>So far, my colleague and I have deduced that 2 programmes in particular interfere the most with the copy/paste operations - Adobe Reader and Autodesk Powershape. (Autodesk and Adobe both have Reference Libraries available within VBA, not sure if this is a coincidence?)</p>\n\n<p>The problem used to occur very frequently whilst we had the programmes open, so we wrote the following macros/functions to try and stablise the code:-</p>\n\n<pre><code>Public Sub CopyShape(ItemName, CopyDestination)\n\nCall ClearClipboard Sheets(CopyDestination).Shapes(ItemName).Copy \n\nDo Until IsClipboardEmpty = False DoEvents Loop\n\nEnd Sub\n</code></pre>\n\n<p>Where \"ClearClipboard\" is:-</p>\n\n<pre><code>Public Function ClearClipboard() \n\nOpenClipboard (0&amp;) \n\nEmptyClipboard\n\nCloseClipboard \n\nEnd Function\n</code></pre>\n\n<p>and the function IsClipboardEmpty is:-</p>\n\n<pre><code>Function IsClipboardEmpty() As Boolean \n\nIsClipboardEmpty = (CountClipboardFormats() = 0) \n\nEnd Function\n</code></pre>\n\n<p>with the following public declarations:-</p>\n\n<pre><code>Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long \n\nDeclare Function EmptyClipboard Lib \"user32\" () As Long \n\nDeclare Function CloseClipboard Lib \"user32\" () As Long\n\nPublic Declare Function CountClipboardFormats Lib \"user32\" () As Long\n</code></pre>\n\n<p>This code works quite a lot of the time (far better than trying to use \"DoEvents\" after the copy operation which just failed miserably) as it forces the code to check if the copied item is in the clipboard before trying to paste it, but it doesn't always work - something in the background still messes up the code.</p>\n\n<p>Is there any way of either:-</p>\n\n<ul>\n<li>locking and unlocking the clipboard using VBA or APIs?</li>\n<li>using a completely different method of copying and pasting the shapes?</li>\n</ul>\n\n<p>Any and all solutions welcome and of course happy to answers any questions.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1531311840, "post_id": 51285397, "comment_id": 89548096, "body": "Which line errors?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1531312613, "post_id": 51285397, "comment_id": 89548672, "body": "Btw your loop only ever operates on the same cell as you don&#39;t reference <code>cell</code>."}, {"owner": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531318178, "post_id": 51285397, "comment_id": 89552902, "body": "Ah thanks, good point! I think the line that is giving me the error is &quot;TheFile(i) = .SelectedItems(i)&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "edited": false, "score": 0, "creation_date": 1531318117, "post_id": 51286191, "comment_id": 89552860, "body": "Thanks a lot for your answer! I tried your solution, but now I&#39;m getting an Application-defined or object-defined error (1004).  Do you know what could be causing this? I put everything after &quot;For  Each Cell In Selection&quot; into the part in your code that says do all the image stuff here."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "edited": false, "score": 0, "creation_date": 1531318872, "post_id": 51286191, "comment_id": 89553447, "body": "As long as you don&#39;t tell in which line (or which code) you get an error we can not help."}, {"owner": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "edited": false, "score": 0, "creation_date": 1531392704, "post_id": 51286191, "comment_id": 89584028, "body": "Thanks a lot! It works as intended now and the check for the cell selection size matching the number of selected images is also a nice touch! Much appreciated!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "edited": false, "score": 0, "creation_date": 1531394399, "post_id": 51286191, "comment_id": 89585138, "body": "@juleswhatevs you need to check the counts because if they don&#39;t match the code would throw an error and stop. So this was actually a <i>must have</i> here."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1531319875, "last_edit_date": 1531319875, "creation_date": 1531314181, "answer_id": 51286191, "question_id": 51285397, "link": "https://stackoverflow.com/questions/51285397/insert-multiple-images-as-comments-into-multiple-cells-using-vba-giving-subscrip/51286191#51286191", "title": "Insert Multiple Images As Comments Into Multiple Cells Using VBA Giving Subscript Out Of Range Error (9)", "body": "<p>The issue is if you <code>Dim TheFile() As String</code> your array has no defined dimension and therefore you cannot access any item in the array like <code>TheFile(1) = 0</code>.</p>\n\n<p>Here is an example on how to use the FileDialog for a multiselect</p>\n\n<pre><code>Dim fd As FileDialog\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n\nWith fd\n    .InitialFileName = CurDir             \n    .InitialView = msoFileDialogViewList  \n    .AllowMultiSelect = True\n    .Filters.Clear \n    .Filters.Add Description:=\"Images\", Extensions:=\"*.*\", Position:=1\n    .Title = \"Choose image\"\nEnd With\n\nDim FileChosen As Integer \nFileChosen = fd.Show 'show dialog\n\nIf FileChosen = -1 Then\n\n    Dim AddImagesRange As Range\n    Set AddImagesRange = Selection\n\n    'check if cells count matches files count\n    If AddImagesRange.Cells.Count &lt;&gt; fd.SelectedItems.Count Then\n        MsgBox \"Count of seletced cells does not match count of images\"\n        Exit Sub\n    End If\n\n    Dim i As Long:  i = 1\n    Dim objImage As Object\n\n    Dim Cell As Range\n    For Each Cell In AddImagesRange\n        Set objImage = CreateObject(\"WIA.ImageFile\")\n        objImage.LoadFile fd.SelectedItems(i)\n\n        Cell.AddComment\n        With Cell.Comment.Shape 'avoid cascaded with statements\n            .Fill.UserPicture fd.SelectedItems(i)\n            .Height = objImage.Height * 0.45\n            .Width = objImage.Width * 0.45\n        End With\n\n        i = i + 1\n        Set objImage = Nothing\n    Next Cell\n\nElse\n    MsgBox (\"No image selected\")\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1531319739, "creation_date": 1531319739, "answer_id": 51288234, "question_id": 51285397, "link": "https://stackoverflow.com/questions/51285397/insert-multiple-images-as-comments-into-multiple-cells-using-vba-giving-subscrip/51288234#51288234", "title": "Insert Multiple Images As Comments Into Multiple Cells Using VBA Giving Subscript Out Of Range Error (9)", "body": "<p>Try this.</p>\n\n<pre><code>Sub AddImageTo()\n\nDim TheFile() As String\nDim Cell As Range\nDim rngPic() As Range\nDim i As Integer, k As Integer, n As Integer, j As Integer\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n         .AllowMultiSelect = True          'Only one file\n         .InitialFileName = CurDir         'directory to open the window\n         .Filters.Clear                    'Cancel the filter\n         .Filters.Add Description:=\"Images\", Extensions:=\"*.*\", Position:=1\n         .Title = \"Choose image\"\n         .Show\n            For i = 1 To .SelectedItems.Count\n                k = k + 1\n                ReDim Preserve TheFile(1 To k)\n                    TheFile(k) = .SelectedItems(i)\n                Next i\nEnd With\n'No file selected\nIf k = 0 Then\n    MsgBox (\"No image selected\")\nExit Sub\nEnd If\n\nSet objImage = CreateObject(\"WIA.ImageFile\")\n    objImage.LoadFile TheFile(1)\nFor Each Cell In Selection\n    n = n + 1\n    ReDim Preserve rngPic(1 To n)\n    Set rngPic(n) = Cell\nNext Cell\nFor j = 1 To UBound(TheFile)\n    If j &gt; n Then Exit Sub\n        With rngPic(j)\n            .ClearComments\n            .AddComment\n            With .Comment\n                With .Shape\n                    .Fill.UserPicture TheFile(j)\n                    .Height = objImage.Height * 0.45\n                    .Width = objImage.Width * 0.45\n                End With\n            End With\n        End With\nNext j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10064784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d71b4374d592b2a7c00d153b256028?s=128&d=identicon&r=PG&f=1", "display_name": "juleswhatevs", "link": "https://stackoverflow.com/users/10064784/juleswhatevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 51286191, "answer_count": 2, "score": 2, "last_activity_date": 1531319875, "creation_date": 1531311790, "question_id": 51285397, "link": "https://stackoverflow.com/questions/51285397/insert-multiple-images-as-comments-into-multiple-cells-using-vba-giving-subscrip", "title": "Insert Multiple Images As Comments Into Multiple Cells Using VBA Giving Subscript Out Of Range Error (9)", "body": "<p>I'm getting the subscript out of range (error 9) when trying to insert multiple images into a comment in multiple cells. The idea of the VBA code is for me to be able to select multiple cells in workbook, then select multiple images, and it will add the images in order as a comment to each cell in order.</p>\n\n<p>In order to do this I first try to go through the selected images in the file dialog window with a For loop and add them to the TheFile array. Then I try to use another For loop to add the image in the array position of j into the current cell and move on to the next cell and do the same.</p>\n\n<p>Any idea what is causing the subscript out of range error? My code below:</p>\n\n<pre><code>Sub AddImageTo()\n\nDim TheFile() As String\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n         .AllowMultiSelect = True          'Only one file\n         .InitialFileName = CurDir         'directory to open the window\n         .Filters.Clear                    'Cancel the filter\n         .Filters.Add Description:=\"Images\", Extensions:=\"*.*\", Position:=1\n         .Title = \"Choose image\"\n\n         If .Show = -1 Then\n            For i = 1 To .SelectedItems.Count\n            TheFile(i) = .SelectedItems(i)\n            Next i\n         Else: TheFile(1) = 0\n         End If\nEnd With\n'No file selected\nIf TheFile(1) = 0 Then\nMsgBox (\"No image selected\")\nExit Sub\nEnd If\n\nSet objImage = CreateObject(\"WIA.ImageFile\")\n    objImage.LoadFile TheFile\n\nFor j = 1 To UBound(TheFile)\nFor Each cell In Selection\n    With ActiveCell\n        .AddComment\n        With .Comment\n            With .Shape\n                .Fill.UserPicture TheFile(j)\n                .Height = objImage.Height * 0.45\n                .Width = objImage.Width * 0.45\n            End With\n        End With\n    End With\nNext cell\nNext j\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531311711, "post_id": 51285323, "comment_id": 89547996, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51067024/paste-special-without-using-clipboard\">Paste special without using clipboard</a>"}, {"owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531312024, "post_id": 51285323, "comment_id": 89548240, "body": "Hi Sir. I would like to paste the range of cell in the same worksheet only leaving 1 column.  Everytime I click the button, it will paste the cell in the next sequence."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531312771, "post_id": 51285323, "comment_id": 89548801, "body": "Well... instead of declaring the second worksheet like in the linked example, simply paste the data to the same one <i>(thought that was a pretty obvious intuition...)</i>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531313021, "post_id": 51285323, "comment_id": 89548969, "body": "What does the &quot;next sequence&quot; mean. What does &quot;Next Position&quot; mean. What does &quot;Bypass one column&quot; mean. What &quot;Next date&quot; and which date are you talking about? The one in the original range or the one in the pasted range. Please clarify your question using excel terms and your example screenshot &quot;Sequence&quot;, &quot;Position&quot;, and &quot;Bypass&quot; are not excel words so they are meaningless without some definition."}, {"owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "edited": false, "score": 0, "creation_date": 1531314200, "post_id": 51285323, "comment_id": 89549811, "body": "Basically If I click the button, it will paste the range of cell to the same sheet on the right side bypassing 1 column. (Please see snip image).  If I click the button again, it will do the same thing onto the next range of cell.  Then of course the day will change example June 1 to June 2."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1531315174, "post_id": 51285323, "comment_id": 89550567, "body": "If you click it again it will paste it into the &quot;next range of cell&quot;... What &quot;next range&quot; what does that mean? Another block/range starting at <code>K1</code>? Please try to be explicit. You clicked the button again... which range is being copied? The range starting at <code>F1</code> or the one starting <code>A1</code>? It&#39;s not at all clear what you want to have happen. Why would the new range in <code>K1</code> get <code>June 2nd</code>. Wouldn&#39;t it be <code>June 3rd</code> because you already increased the date in range <code>F1</code> in the first button click. Perhaps post three pictures. 1) starting state 2) state after 1st click 3) state after 3rd click."}, {"owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "edited": false, "score": 0, "creation_date": 1531315539, "post_id": 51285323, "comment_id": 89550804, "body": "Sorry for that Sir..Let&#39;s imagine range A1:D5 as the only table there, if I click the button, it will copy to range F1:I5 then the date will be June 2.  If I click again the button it will copy the same table to range K1:N5 then date will be June 3. something like that Sir."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "edited": false, "score": 0, "creation_date": 1531354268, "post_id": 51287400, "comment_id": 89568882, "body": "Hi Buddy @ tigeravatar, that actually works. Thank you so much..I have a bit of question, if I wanted to extend my rows of original table up to 20 rows. What to change their in the code?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "edited": false, "score": 0, "creation_date": 1531400628, "post_id": 51287400, "comment_id": 89589449, "body": "@ArerrabFearmoreNayr No change needed, the <code>.CurrentRegion</code> will already adjust to however many rows of data are in your table."}, {"owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "edited": false, "score": 0, "creation_date": 1531448769, "post_id": 51287400, "comment_id": 89609848, "body": "Hi Sir TigerAvatar, you really help me a lot Sir. This makes my team mates daily task to be more faster.  I have another co-worker where she needs to copy and paste a table (4 rows, 10 column). She needs to paste it going down. I will look your code Sir and study. If  Ihave issue Sir I will connect with you."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1531318003, "last_edit_date": 1531318003, "creation_date": 1531317450, "answer_id": 51287400, "question_id": 51285323, "link": "https://stackoverflow.com/questions/51285323/copy-range-of-cells-and-paste-it-in-sequence-using-offset/51287400#51287400", "title": "Copy range of cells and paste it in sequence using offset", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rCopy As Range\n    Dim rDest As Range\n    Dim dtLastDate As Date\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rCopy = ws.Range(\"A1\").CurrentRegion\n    Set rDest = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Offset(, 2)\n    dtLastDate = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Value2\n\n    rCopy.Copy rDest\n    ws.Cells(3, rDest.Column + rCopy.Columns.Count - 1).Resize(rCopy.Rows.Count - 2).ClearContents\n    rDest.Cells(1, 1).Value = dtLastDate + 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9219553, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039149302771805/picture?type=large", "display_name": "Arerrab Fearmore Nayr", "link": "https://stackoverflow.com/users/9219553/arerrab-fearmore-nayr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531318003, "creation_date": 1531311584, "last_edit_date": 1531312889, "question_id": 51285323, "link": "https://stackoverflow.com/questions/51285323/copy-range-of-cells-and-paste-it-in-sequence-using-offset", "title": "Copy range of cells and paste it in sequence using offset", "body": "<p>I have a simple range of cells in Sheet1. I wanted to copy this entire range of cells and paste it in the next position just bypass one column.  Then I wanted to automatic change the date to the next date.</p>\n\n<p>Please see snip image.<img src=\"https://i.stack.imgur.com/oKET2.png\" alt=\"Image\"></p>\n\n<p>Code so far:</p>\n\n<pre><code>Sub Copy()\n\nRange(\"A1:D5\").Copy Range(\"F1:I5\")\nRange(\"I3:I5\").ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 78, "user_id": 9475851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f04702f065994084c6416ee14d9af28f?s=128&d=identicon&r=PG&f=1", "display_name": "Larsg432", "link": "https://stackoverflow.com/users/9475851/larsg432"}, "edited": false, "score": 0, "creation_date": 1531311198, "post_id": 51285063, "comment_id": 89547611, "body": "I am not a 100% sure but i think the line <code>WS_Project.name = wsProject</code> should be <code>WS_Project.name = &quot;wsProject&quot; </code> first. And i came across a similar problem last week, that a workbook wouldn&#39;t activate a sheet. The problem was that i had to refer to the <code>workbook</code> with the ending of it. For example: <code>Workbooks(&quot;yourwbname.xlsx&quot;).Worksheets(&quot;Sheet1&quot;).Activate</code> However i know that you don&#39;t have to add an ending to the name of a reference, but it worked in a similar case for me."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1531311211, "post_id": 51285063, "comment_id": 89547615, "body": "In your procedure, what is supposed to be this argument: <code>Public Sub setProgramAlerts(turnThem As turnThem)</code>? Pretty sure that must return an error"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1531311410, "post_id": 51285063, "comment_id": 89547758, "body": "Also, doing a procedure that passes an argument to a controller as a <code>Select</code> that has no specified default behaviour... that&#39;s one dangerous game you are playing."}, {"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1531311485, "post_id": 51285063, "comment_id": 89547815, "body": "the argument for setProgramAlerts is an Enum: &#39;code&#39; Enum turnThem     allOff = 0     allOn = 1 End Enum &#39;code&#39;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531316213, "post_id": 51285063, "comment_id": 89551309, "body": "The code won&#39;t run - <code>WS_Project.Name = wsProject</code>.  You haven&#39;t give <code>wsProject</code> a value anywhere.  You also haven&#39;t added the Enum for <code>turnThem</code>.  Should the first line of <code>Main</code> read as <code>setProgramAlerts AllOn</code> otherwise what&#39;s the point of the enum?  You haven&#39;t added <code>Option Explicit</code> which is bad practice - misspelled variables are created as new variables, hides so many simple coding mistakes..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12172000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a4fa91d9a41ae2f19fa977128a79fa?s=128&d=identicon&r=PG&f=1", "display_name": "ktibor331", "link": "https://stackoverflow.com/users/12172000/ktibor331"}, "is_accepted": false, "score": 0, "last_activity_date": 1570371644, "last_edit_date": 1570371644, "creation_date": 1570361902, "answer_id": 58256860, "question_id": 51285063, "link": "https://stackoverflow.com/questions/51285063/vba-worksheet-activate-not-working/58256860#58256860", "title": "VBA - Worksheet.activate not working", "body": "<p>I have seen this problem before: </p>\n\n<blockquote>\n  <p>WorkSheet_Activate (and _Deactivate) not working  </p>\n</blockquote>\n\n<p>I have found a solution at least for my case.<br>\nA worksheet change, either programmatically or manually, activated a worksheet containing certain conditional formatting having UDFs (a very simple VBA function).<br>\nAfter deleting the UDFs and replacing them with Excel formulas, the problem totally ceased.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "is_accepted": false, "score": 0, "last_activity_date": 1579674814, "creation_date": 1579674814, "answer_id": 59853900, "question_id": 51285063, "link": "https://stackoverflow.com/questions/51285063/vba-worksheet-activate-not-working/59853900#59853900", "title": "VBA - Worksheet.activate not working", "body": "<p>I had the same problem.\nAfter setting Application.ScreenUpdating = True before sheet.activate everything worked fine. </p>\n"}], "owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3403, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1579674814, "creation_date": 1531310736, "last_edit_date": 1531311646, "question_id": 51285063, "link": "https://stackoverflow.com/questions/51285063/vba-worksheet-activate-not-working", "title": "VBA - Worksheet.activate not working", "body": "<p>I was wondering if you could help me figure out why worksheet.activate does nothing in the case below. \nI turn off     </p>\n\n<pre><code>.ScreenUpdating = False\n.EnableEvents = False\n.DisplayAlerts = False, \n</code></pre>\n\n<p>-> create a new file and add sheets to it, \n-> turn them back on, \n-> and when i try to activate the new file, it does nothing, and the main file remains active.</p>\n\n<p>Does anyone have a solution for something like this?</p>\n\n<pre><code>Enum getWhat\n    getRow = 0\n    getCol = 1\nEnd Enum  \n\nSub main()\n    SetProgramAlerts 0\n    Set currentWorkbook= ActiveWorkbook\n    Set newWorbook = Workbooks.add\n    With newWorbook\n        Set WS_Project = .Worksheets(\"Sheet1\")\n        WS_Project.name = wsProject\n        '....\n    End with\n    SetProgramAlerts 1\n    newWorbook.Activate 'this actually does nothing, even though application.screenupdating = true\nend sub\n\nPublic Sub setProgramAlerts(turnThem As turnThem)\n    'TURN EVERITHING OFF AT THE BEGINING OF A MACRO\n    'REMEMBER TO TURN BACK ON\n    DoEvents\n    Select Case turnThem\n        Case 0      'All off\n            With Application\n                If .ScreenUpdating Or .EnableEvents Or .DisplayAlerts Then\n                    .ScreenUpdating = False\n                    .EnableEvents = False\n                    .DisplayAlerts = False\n                End If\n\n                If Workbooks.Count &gt; 0 Then\n                    If .Calculation &lt;&gt; xlCalculationManual Then .Calculation = xlCalculationManual\n                End If\n                '.statusBar = True\n            End With\n\n        Case 1      'All on in opposite order\n            With Application\n                '.statusBar = False\n                If Workbooks.Count &gt; 0 Then\n                    .Calculation = xlCalculationAutomatic\n                End If\n\n                If .DisplayAlerts = False Or .EnableEvents = False Or .ScreenUpdating = False Then\n                    .DisplayAlerts = True\n                    .EnableEvents = True\n                    .ScreenUpdating = True\n                End If\n            End With        \n    End Select\n    DoEvents\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "time"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1531311264, "post_id": 51284887, "comment_id": 89547666, "body": "<code>Range(&quot;C5&quot;).Value= &quot;TIME&quot; &amp; &quot; &quot; &amp; Range(&quot;C4&quot;).Text</code> if you want the exact same formating."}, {"owner": {"reputation": 1302, "user_id": 8739330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6a72fe03143bcbcae9c5cbc610c72870?s=128&d=identicon&r=PG&f=1", "display_name": "West", "link": "https://stackoverflow.com/users/8739330/west"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1531311543, "post_id": 51284887, "comment_id": 89547861, "body": "@VincentG That works perfecly too cheers"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1302, "user_id": 8739330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6a72fe03143bcbcae9c5cbc610c72870?s=128&d=identicon&r=PG&f=1", "display_name": "West", "link": "https://stackoverflow.com/users/8739330/west"}, "edited": false, "score": 0, "creation_date": 1531311491, "post_id": 51284970, "comment_id": 89547820, "body": "My pleasure. See also Vincent&#39;s comment."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1531310458, "creation_date": 1531310458, "answer_id": 51284970, "question_id": 51284887, "link": "https://stackoverflow.com/questions/51284887/how-to-get-the-value-of-a-cell-displaying-time-as-text-in-vba/51284970#51284970", "title": "How to get the value of a cell displaying time, as text, in VBA", "body": "<p>Assuming it is a proper time you have to format it. To Excel dates and times are just numbers, it's the formatting that makes them look like dates or times. (A time is a fraction of a day, hence your answer.)</p>\n\n<pre><code>Range(\"C5\").Value = \"TIME\" &amp; \" \" &amp; Format(Range(\"C4\").Value, \"hh:mm:ss\")\n</code></pre>\n"}], "owner": {"reputation": 1302, "user_id": 8739330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6a72fe03143bcbcae9c5cbc610c72870?s=128&d=identicon&r=PG&f=1", "display_name": "West", "link": "https://stackoverflow.com/users/8739330/west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 51284970, "answer_count": 1, "score": 0, "last_activity_date": 1531310458, "creation_date": 1531310205, "question_id": 51284887, "link": "https://stackoverflow.com/questions/51284887/how-to-get-the-value-of-a-cell-displaying-time-as-text-in-vba", "title": "How to get the value of a cell displaying time, as text, in VBA", "body": "<p>I have cell <code>C4</code> with the value <code>1:05:20</code> and I'm trying to create a string <code>TIME 1:05:20</code> and paste this string into another cell <code>C5</code> using VBA but am not getting what I need. My code below returns \n<code>TIME 4.53703703703704E-02</code> instead.  </p>\n\n<pre><code>Public Sub timer()\n\nRange(\"C5\").Value= \"TIME\" &amp; \" \" &amp; Range(\"C4\").Value\n\nEnd Sub\n</code></pre>\n\n<p>How can I get the required value?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531310880, "post_id": 51284871, "comment_id": 89547373, "body": "What&#39;s wrong with google? <a href=\"https://stackoverflow.com/questions/9373082/detect-whether-excel-workbook-is-already-open\" title=\"detect whether excel workbook is already open\">stackoverflow.com/questions/9373082/&hellip;</a>"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531310983, "post_id": 51284871, "comment_id": 89547451, "body": "@SJR Saw those exact answers. But the functions declared use the error handlers."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531311048, "post_id": 51284871, "comment_id": 89547497, "body": "Then I think it&#39;s safe to say that for all intents and purposes this is one of those occasions where impossible to avoid."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531311146, "post_id": 51284871, "comment_id": 89547579, "body": "I wouldn&#39;t say it&#39;s impossible - switching through all opened workbooks and matching the names with the required one, should do it for me without the error handlers. But it consumes time, that&#39;s why I didn&#39;t opt for that yet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531311318, "post_id": 51284871, "comment_id": 89547691, "body": "You&#39;ve answered your own question then! Strictly speaking this isn&#39;t an SO question as your code is working."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1531311769, "last_edit_date": 1531311769, "creation_date": 1531311328, "answer_id": 51285236, "question_id": 51284871, "link": "https://stackoverflow.com/questions/51284871/handling-erros-for-application-workbooks-without-using-error-handlers/51285236#51285236", "title": "Handling erros for Application.Workbooks without using Error handlers", "body": "<p>One way to do it is check each workbook name, but what's wrong with the functions in the link that @SJR gave?  </p>\n\n<p>In your provided code you've kept the error handler within the main body of code - it should appear between the <code>Exit Sub</code> and <code>End Sub</code> at the end of the procedure.</p>\n\n<p>Something like this would work without an error handler, but it's slower as it needs to check each workbook:  </p>\n\n<pre><code>Sub Test()\n\n    Dim Uwk As Workbook\n    Dim WbkName As String\n\n    WbkName = \"PERSONAL.XLSB\"\n\n    For Each Uwk In Workbooks\n        If Uwk.Name = WbkName Then\n            Exit For\n        End If\n    Next Uwk\n\n    If Not Uwk Is Nothing Then\n        MsgBox Uwk.Name &amp; \" found!\"\n    Else\n        MsgBox \"Not found.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Your version of the code should have the error handler outside the main body:  </p>\n\n<pre><code>Sub Test1()\n\n    Dim WbkName As String\n    Dim UWk As Workbook\n\n    WbkName = \"PERSONAL1.XLSB\"\n\n    On Error GoTo OpenWorkbookError\n\n    Set UWk = Workbooks(WbkName)\n\nTidyExit:\n    'Close anything that needs closing and Exit.\n\nExit Sub  '&lt;&lt; End of main body of procedure.\n\nOpenWorkbookError:\n    Select Case Err.Number\n        Case 9 'Subscript out of range.\n            MsgBox \"Please open the required workbook.\"\n            Resume TidyExit\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                Err.Description, vbOKOnly + vbCritical\n            Resume TidyExit\n    End Select\n\nEnd Sub  '&lt;&lt; End of procedure.\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51285236, "answer_count": 1, "score": 0, "last_activity_date": 1531311769, "creation_date": 1531310153, "last_edit_date": 1531310264, "question_id": 51284871, "link": "https://stackoverflow.com/questions/51284871/handling-erros-for-application-workbooks-without-using-error-handlers", "title": "Handling erros for Application.Workbooks without using Error handlers", "body": "<p>I am trying to assign an opened workbook to an workbook object. If that workbook is not already opened, then it throws an error. I am handling the errors using an Error Handler.</p>\n\n<p>This works for me:</p>\n\n<pre><code>On Error GoTo OpenWorkbookError\n\nSet Uwk = Application.Workbooks(WbkName)\n\nOpenWorkbookError:\nIf Err &lt;&gt; 0 Then\n  Err.Clear\n  MsgBox (\"Please Open the Required Workbook\")\n  Exit Sub\nEnd If\n</code></pre>\n\n<p>But is there a way to avoid using the error handlers in this situation.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531318294, "post_id": 51284499, "comment_id": 89553017, "body": "It looks like your code already does everything you want, but you want to connect it to a command button?  Or do you want to perform the pivot table update without running the stored procedure?"}, {"owner": {"reputation": 151, "user_id": 5577668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e346c2cc78bd5460c9701fc51adbb72c?s=128&d=identicon&r=PG&f=1", "display_name": "EmanuelF", "link": "https://stackoverflow.com/users/5577668/emanuelf"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531319749, "post_id": 51284499, "comment_id": 89554151, "body": "@PeterT I have two sheets, one called &quot;Dados&quot;. In that contains the result of running the stored procedure. The pivot table is in the sheet called &quot;ViewHistorico&quot; and in that is updated based in the sheet &quot;Dados&quot;. I want the pivot table be updated by the SP without the sheet &quot;Dados&quot;. That&#39;s clear?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1531335835, "post_id": 51284499, "comment_id": 89562768, "body": "Since pivot tables are based on data (with an internal link object called a <code>PivotCache</code>), the only real way to update the pivot table is to update the data. In your case, updating the data (on &quot;Dados&quot;) involves running the SP. Microsoft has defined pivot tables to only be updated through the source data. Your only other option is to have your SQL query return data and you manually format it to a different worksheet."}], "owner": {"reputation": 151, "user_id": 5577668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e346c2cc78bd5460c9701fc51adbb72c?s=128&d=identicon&r=PG&f=1", "display_name": "EmanuelF", "link": "https://stackoverflow.com/users/5577668/emanuelf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557185677, "creation_date": 1531308941, "last_edit_date": 1557185677, "question_id": 51284499, "link": "https://stackoverflow.com/questions/51284499/update-a-powerpivot-in-excel-using-vba", "title": "Update a PowerPivot in Excel using VBA", "body": "<p>I have a Stored Procedure and I need to put the result in a PivotTable. The SP has two date values as paramenters. I want a macro button to take the two paramenters (each one in a different cell), execute the SP and update the PivotTable in a Excel spreadsheet.</p>\n\n<p>I have a macro that takes the parameters and updates the table with the result of the SP and automatically refreshes a Pivot Table based on the table.</p>\n\n<pre><code>Sub Atualizar()\n    Dim lDataIni As String\n    Dim lDataFim As String\n    'Obtem os dados do par\u00eametro para consulta\n    lDataIni = \"'\" &amp; Format(Sheets(\"ViewHistorico\").Range(\"C1\").Value, \"yyyyMMdd HH:mm:SS\") &amp; \"'\"\n    lDataFim = \"'\" &amp; Format(Sheets(\"ViewHistorico\").Range(\"C2\").Value, \"yyyyMMdd 23:59:59\") &amp; \"'\"\n\n    Sheets(\"Dados\").Select\n    'executa a consulta na planilha Dados para popular a tabela\n    With ActiveWorkbook.Connections(\"Query from dbDW\").ODBCConnection\n        .BackgroundQuery = False 'False para for\u00e7ar a espera da atualiza\u00e7\u00e3o do PowerPivot\n        .CommandText = Array(\"EXEC SpHistoricoCobrancaProdutor \" &amp; lDataIni &amp; \" , \" &amp; lDataFim)\n        .CommandType = xlCmdSql\n        .Connection = Array(Array( _\n        \"ODBC;DRIVER=SQL Server Native Client 11.0;SERVER=dbDW;UID=efritsch;Trusted_Connection=Yes;APP=Microsoft Office 2013;WSID=C3\" _\n        ), Array(\"1089;DATABASE=DW;\"))\n        .RefreshOnFileOpen = False\n        .SavePassword = False\n        .SourceConnectionFile = \"\"\n        .SourceDataFile = \"\"\n        .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n        .AlwaysUseConnectionFile = False\n    End With\n    With ActiveWorkbook.Connections(\"Query from dbDW\")\n        .Name = \"Query from dbDW\"\n        .Description = \"\"\n    End With\n\n    ActiveWorkbook.RefreshAll\n\n    'Atualiza o PowerPivot com base na planilha Dados que foi atualizadas\n    Sheets(\"ViewHistorico\").Select\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotCache.Refresh\n\n    MsgBox (\"Atualizado com sucesso!\")\n\nEnd Sub\n</code></pre>\n\n<p>What I really want is a macro button that updates the PivotTable without necessity of other table.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "edited": false, "score": 0, "creation_date": 1531308830, "post_id": 51284199, "comment_id": 89546007, "body": "try <code>If .Cells(i, &quot;D&quot;).Interior.ColorIndex = -4142</code>"}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1531309356, "post_id": 51284424, "comment_id": 89546368, "body": "Unfortunatelly it does not run.. I just figured out that the background color of the cells I want to keep is not no fill but it is white.. does this change anything?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1531309485, "post_id": 51284424, "comment_id": 89546487, "body": "@PericlesFaliagas  Yes, it will change things!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1531309670, "post_id": 51284424, "comment_id": 89546623, "body": "@PericlesFaliagas  on my system <i>white</i> is <b><i>2</i></b> rather than <b><i>-4142</i></b>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1531309904, "post_id": 51284424, "comment_id": 89546776, "body": "@PericlesFaliagas  see my <b>Edit#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 5, "last_activity_date": 1531309878, "last_edit_date": 1531309878, "creation_date": 1531308724, "answer_id": 51284424, "question_id": 51284199, "link": "https://stackoverflow.com/questions/51284199/delete-entire-row-if-a-cell-has-a-background-color/51284424#51284424", "title": "Delete entire row, if a cell has a background color", "body": "<p>Don't use <strong><em>0</em></strong>:</p>\n\n<pre><code>Sub qwerty()\n    Dim ws1 As Worksheet: Set ws1 = ActiveSheet\n    Dim Nodel As Boolean\n    With ws1\n        lastrow2 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        For i = lastrow2 To 2 Step -1\n            Nodel = False\n            If .Cells(i, \"D\").Interior.ColorIndex = -4142 Then\n               Nodel = True\n            End If\n            If Not Nodel Then\n                .Rows(i).EntireRow.Delete\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If you want to retain cells with a white background, first verify that \"white\" corresponds to \"colorindex=2\" and then use <strong><em>2</em></strong> in place of <strong><em>-4142</em></strong> in the code.</p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 51284424, "answer_count": 1, "score": 2, "last_activity_date": 1531309878, "creation_date": 1531308108, "last_edit_date": 1531308651, "question_id": 51284199, "link": "https://stackoverflow.com/questions/51284199/delete-entire-row-if-a-cell-has-a-background-color", "title": "Delete entire row, if a cell has a background color", "body": "<p>I am trying to delete all the rows of which the cell in column D has a background color. I have written the code below, but everytime I run it, it runs indefinitely until it eventually crashes. Both <code>ws1</code> and <code>lastrow2</code> are well defined (I mention it to clear this possibility of why my macro is not running)</p>\n\n<pre><code>With ws1\n    lastrow2 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = lastrow2 To 2 Step -1\n        nodel = False\n\n        If .Cells(i, \"D\").Interior.ColorIndex = 0 Then\n            nodel = True\n        End If\n\n        If Not nodel Then\n            .Rows(i).EntireRow.Delete\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["java", "vba", "internet-explorer", "automation", "invisible"], "comments": [{"owner": {"reputation": 1336, "user_id": 623048, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21e986a6c54514b362062a0a6b6e90e1?s=128&d=identicon&r=PG", "display_name": "Graham Asher", "link": "https://stackoverflow.com/users/623048/graham-asher"}, "edited": false, "score": 0, "creation_date": 1531308265, "post_id": 51284133, "comment_id": 89545669, "body": "Please explain what &#39;an invisible IE&#39; is; what does IE stand for?"}, {"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "reply_to_user": {"reputation": 1336, "user_id": 623048, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21e986a6c54514b362062a0a6b6e90e1?s=128&d=identicon&r=PG", "display_name": "Graham Asher", "link": "https://stackoverflow.com/users/623048/graham-asher"}, "edited": false, "score": 0, "creation_date": 1531308380, "post_id": 51284133, "comment_id": 89545724, "body": "Internet Explorer sorry"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1531310719, "post_id": 51284133, "comment_id": 89547247, "body": "Is there an URL you could share? It may be possible to avoid Sendkeys. Also, are you tied to using Internet Explorer and are you allowed to install software on your machine?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "edited": false, "score": 1, "creation_date": 1531377122, "post_id": 51285080, "comment_id": 89574314, "body": "Thanks for helping, its work also when the IE is invisible"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1531310792, "creation_date": 1531310792, "answer_id": 51285080, "question_id": 51284133, "link": "https://stackoverflow.com/questions/51284133/control-an-element-in-invisible-internet-explorer-vba/51285080#51285080", "title": "Control an Element in invisible Internet Explorer vba", "body": "<p>You are using SendKeys to trigger the event when potentially you can trigger the event as shown below.</p>\n\n<pre><code>IEDocument.querySelector(\"#zeichn\").fireEvent \"onKeyUp\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>IEDocument.getElementById(\"zeichn\").fireEvent \"onKeyUp\"\n</code></pre>\n\n<p>I have never tried setting focus when IE.Visible = False but, if it is possible, then you may need to <code>.Focus</code>, on the element, before doing the above.</p>\n"}], "owner": {"reputation": 5, "user_id": 10029220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--9O_gKkPrlU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUfh8vsMzZ5uKHJKtjWyq9PpPy9g/mo/photo.jpg?sz=128", "display_name": "M. F.", "link": "https://stackoverflow.com/users/10029220/m-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 51285080, "answer_count": 1, "score": 0, "last_activity_date": 1531315225, "creation_date": 1531307866, "last_edit_date": 1531315225, "question_id": 51284133, "link": "https://stackoverflow.com/questions/51284133/control-an-element-in-invisible-internet-explorer-vba", "title": "Control an Element in invisible Internet Explorer vba", "body": "<p>is there a way that i can control an invisible IE with this Element.\nWhen IE is visible i can use focus and Sendkey functions. But don't know how, when it is invisible</p>\n\n<pre><code>&lt;tr bgcolor=\"#c8d8f8\"&gt;\n&lt;td valign=top colspan=2&gt;\n&lt;b&gt;Link_Nr / Link_St&lt;/b&gt;\n&lt;br&gt;\n&lt;input type=\"text\" name=\"LINK\" id=\"link\" size=\"70\" value=\"\" \nonKeyUp=\"Auswahl_Link();\"&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>My way till now:</p>\n\n<pre><code>IEDocument.all.LINK.Value = linknummer\nIEDocument.all.Item(\"Link\").Focus (\"Link\")\n\nIf IEDocument.all.Item(\"Link\").SetFocus Then\n    Application.SendKeys \"{UP}\", True\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "rules"], "owner": {"reputation": 21, "user_id": 10064419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/302f15a6424b0d6f058170036cc74988?s=128&d=identicon&r=PG&f=1", "display_name": "proxydlx", "link": "https://stackoverflow.com/users/10064419/proxydlx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1207, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531307490, "creation_date": 1531307490, "question_id": 51284029, "link": "https://stackoverflow.com/questions/51284029/creating-outlook-rules-with-excel-vba", "title": "Creating Outlook Rules with Excel VBA", "body": "<p>i have to handle about 8000 emails and sort them into the specific folders in Outlook (2013). Hence, i have created the folders in Outlook through an excel list. This spreadsheet contains beside the foldername, as well the senders/receivers email address. Consequently, i want to create automated rules, following this example:</p>\n\n<p>emails -> Received by sheet1.cells(i,4) -> move to folder (=sheet1.cells(i,5)</p>\n\n<p>Through google-ing I have created this code:</p>\n\n<pre><code>Sub createOutlookRule()\nDim appOutlook As Outlook.Application\nDim olRules As Outlook.Rules\nDim myRule As Outlook.Rule\nDim moveToAction As Outlook.MoveOrCopyRuleAction\nDim fromAction As Outlook.ToOrFromRuleCondition\nDim myInbox As Outlook.Folder\nDim moveToFolder As Outlook.Folder\n\nFor i = 2 To 5\nSet appOutlook = New Outlook.Application\nSet myInbox = appOutlook.Session.GetDefaultFolder(olFolderInbox)\n\nSet olRules = appOutlook.Session.DefaultStore.GetRules()\nSet myRule = olRules.Create(Sheet2.Cells(i, 1), olRuleReceive)\nSet fromAction = myRule.Conditions.From\n\na = Sheet2.Cells(i, 3)\n\nSet moveToFolder = myInbox.Folders(\"Mifid\").Folders(a)\n\nWith fromAction\n.Enabled = True\n\nIf IsEmpty(Sheet2.Cells(i, 4)) Then GoTo 4 Else\n\n.Recipients.Add (Sheet2.Cells(i, 4))\n\nIf IsEmpty(Sheet2.Cells(i, 5)) Then GoTo 3 Else\n\n.Recipients.adds (Sheet2.Cells(i, 5))\n3:\n\nEnd With\n\nSet moveToAction = myRule.Actions.moveToFolder\n\nWith moveToAction\n.Enabled = True\n.Folder = moveToFolder\nEnd With\nolRules.Save\n4:\nNext i\nEnd Sub\n</code></pre>\n\n<p>which essentially creates the rule but so far does not work in moving it (i am still working on the solution... if someone has an idea please feel free to tell me)</p>\n\n<p>Anyhow, now i have adjusted it for the sent-items but during the \"move part\" i am getting an error</p>\n\n<p>Code:</p>\n\n<pre><code>Sub createOutlookRuleSENTITEMS()\nDim appOutlook As Outlook.Application\nDim olRules As Outlook.Rules\nDim myRule As Outlook.Rule\nDim moveToAction As Outlook.MoveOrCopyRuleAction\nDim SENTAction As Outlook.ToOrFromRuleCondition\nDim myInbox As Outlook.Folder\nDim moveToFolder As Outlook.Folder\n\nFor i = 2 To 5\nSet appOutlook = New Outlook.Application\nSet myInbox = appOutlook.Session.GetDefaultFolder(olFolderInbox)\n\nSet olRules = appOutlook.Session.DefaultStore.GetRules()\nSet myRuleSENT = olRules.Create(Sheet2.Cells(i, 1), olRuleSend)\nSet TOAction = myRuleSENT.Conditions.SentTo\n\na = Sheet2.Cells(i, 3)\n\nSet moveToFolder = myInbox.Folders(\"Mifid\").Folders(a)\n\nWith TOAction\n.Enabled = True\nIf IsEmpty(Sheet2.Cells(i, 4)) Then GoTo 4 Else\n.Recipients.Add (\"test@example.com\")\nIf IsEmpty(Sheet2.Cells(i, 5)) Then GoTo 3 Else\n.Recipients.adds (Sheet2.Cells(i, 5))\n3:\nEnd With\nSet moveToAction = myRuleSENT.Actions.moveToFolder\n\nWith moveToAction\n.Enabled = True\n.Folder = moveToFolder\nEnd With\nolRules.Save\n4:\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Error-Message: Run-time error ...\nInvalid operation. this rule action cannot be enabled because either the rule is read-only or invalid for the rule type, or the action conflicts with another action on the rule</p>\n\n<p>Any Ideas?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10064132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd8a27b039554701bc054ca48b50c3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Neto", "link": "https://stackoverflow.com/users/10064132/bruno-neto"}, "edited": false, "score": 0, "creation_date": 1531309244, "post_id": 51284233, "comment_id": 89546295, "body": "Thank you!! That solved part of my problem as I&#39;m now able to get all the information I need from the source files. I&#39;m getting a window saying that there&#39;s a large amount of information in the clipboard. Is there a way to automatically turn that off?  Should I try to include the duplicates check in this or add it as a different macro?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 15, "user_id": 10064132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd8a27b039554701bc054ca48b50c3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Neto", "link": "https://stackoverflow.com/users/10064132/bruno-neto"}, "edited": false, "score": 0, "creation_date": 1531309620, "post_id": 51284233, "comment_id": 89546584, "body": "Add the line Application.CutCopyMode = False after the pastespecial to stop the warnings. I&#39;d remove duplicates after importing all the data using wstarget.UsedRange.RemoveDuplicates Header:=xlYes"}, {"owner": {"reputation": 15, "user_id": 10064132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd8a27b039554701bc054ca48b50c3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Neto", "link": "https://stackoverflow.com/users/10064132/bruno-neto"}, "edited": false, "score": 0, "creation_date": 1531310087, "post_id": 51284233, "comment_id": 89546884, "body": "Yeah, I figured that out after asking, sorry. I added       wbSource.Application.CutCopyMode = False before closing without saving changes and it worked. I added the wstarget.UsedRange.RemoveDuplicates Header:=xlYes before the &quot;tidy up&quot; part and I&#39;m running the macro for two test files. If i run the macro twice, it copies once the table from file 1 and then twice the table from file 2. If I run it for three test files twice my guess is it will show table 1, table 2, table 3 and then table 2 and table 3 again but I&#39;m not detecting where this problem comes from. :S"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1531308205, "creation_date": 1531308205, "answer_id": 51284233, "question_id": 51283963, "link": "https://stackoverflow.com/questions/51283963/vba-to-open-several-workbooks-copy-specific-data-remove-duplicate-rows-and-pas/51284233#51284233", "title": "VBA to open several workbooks, copy specific data, remove duplicate rows and paste the information in a new workbook", "body": "<p>replace </p>\n\n<pre><code>  wsSource.Range(\"B1:N\" &amp; lRow).Copy Destination:=wsTarget.Range(\"A\" &amp; NextRow0)\n</code></pre>\n\n<p>with</p>\n\n<pre><code> wsSource.Range(\"B1:N\" &amp; lRow).Copy \n wsTarget.Range(\"A\" &amp; NextRow0).pastespecial xlpastevalues\n</code></pre>\n\n<p>to turn your data from formulas (ie #REF) into values. Assuming the rest of your code works that ought to fix things</p>\n"}], "owner": {"reputation": 15, "user_id": 10064132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd8a27b039554701bc054ca48b50c3?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Neto", "link": "https://stackoverflow.com/users/10064132/bruno-neto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 51284233, "answer_count": 1, "score": 0, "last_activity_date": 1531308205, "creation_date": 1531307262, "question_id": 51283963, "link": "https://stackoverflow.com/questions/51283963/vba-to-open-several-workbooks-copy-specific-data-remove-duplicate-rows-and-pas", "title": "VBA to open several workbooks, copy specific data, remove duplicate rows and paste the information in a new workbook", "body": "<p>I know the title is not that clear but I hope I can explain it better in this description. I'm new to VBA and I need to write some code that does the following:</p>\n\n<p>. Opens several workbooks in a specific folder and copies information from a table in the middle of the source sheets (only one actives) to a target Sheet1 in a new workbook. Problem 1: the tables have the same number of columns but different number of rows (originally they vary from A42 to L##(?) because users can add or remove rows, or leave them blank) so what I did was create a new hidden sheet in each of the source files that has a first A column with 1s and 0s so I could know the range of my copy and \"pre-format\" the information I want to transfer to the target file)</p>\n\n<p>. Copies the information from the hidden sheet of each source file to a target workbook, starting at the second row of Sheet1 of the target workbook (for the table being copied) - first row will have a pre-written header in advance - and keeps pasting information from the next files in the first available blank row of the target sheet</p>\n\n<p>. Removes duplicate rows: in case the user runs the macro more than one time, won't see the original tables replicated several times (haven't got this far yet)</p>\n\n<p>I know very little about VBA so this is how far I've come copy-pasting different stuff I searched online (btw, code is not working as intended):</p>\n\n<pre><code>Sub ImportWorksheets()\nDim sFile As String           'file to process\nDim wsTarget As Worksheet\nDim wbSource As Workbook\nDim wsSource As Worksheet\n\n'check the folder exists\nIf Not FileFolderExists(FOLDER_PATH) Then\n  MsgBox \"Specified folder does not exist, exiting!\"\n  Exit Sub\nEnd If\n\n'reset application settings in event of error\nOn Error GoTo errHandler\nApplication.ScreenUpdating = False\n\n'set up the target worksheet\nSet wsTarget = Sheets(\"Sheet1\")\n\nDim NextRow0 As Long\nNextRow0 = 2\n'using NextRow0 to paste the new tables in in target sheet\n\n'loop through the Excel files in the folder\nsFile = Dir(FOLDER_PATH &amp; \"*.xls*\")\nDo Until sFile = \"\"\n\n  'open the source file and set the source worksheet - ASSUMED WORKSHEET(1)\n  Set wbSource = Workbooks.Open(FOLDER_PATH &amp; sFile)\n  Set wsSource = wbSource.Worksheets(2) 'EDIT IF NECESSARY\n\n  Dim lRow As Long\n\n  lRow = wsSource.Columns(\"A\").Find(1, SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole).Row\n  wsSource.Range(\"B1:N\" &amp; lRow).Copy Destination:=wsTarget.Range(\"A\" &amp; NextRow0)\n  NextRow0 = wsTarget.Range(\"A100000\").End(xlUp).Row\n\n  'close the source workbook, increment the output row and get the next file\n  wbSource.Close SaveChanges:=False\n  sFile = Dir()\nLoop\n\nerrHandler:\nOn Error Resume Next\nApplication.ScreenUpdating = True\n\n\n'tidy up\nSet wsSource = Nothing\nSet wbSource = Nothing\nSet wsTarget = Nothing\nEnd Sub\n</code></pre>\n\n<p>Right now the code is not pasting the information as values but rather paths and is not copying the right information (second column is returning #REF). Can you help me figure out how to correct what's wrong and end the code?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1531307370, "post_id": 51283932, "comment_id": 89545158, "body": "You forgot an <code>=</code> so <code>&quot;=SUM(B1:D1)&quot;</code> (Although I would not think that would result in #NAME ...)"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1531307760, "post_id": 51283932, "comment_id": 89545380, "body": "@Alex K. Sorry for confusion, it&#39;s the result of retyping. The error isn&#39;t because of it."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531313593, "post_id": 51284195, "comment_id": 89549369, "body": "or <code>Cells(1,1).FormulaLocal = &quot;=\u0421\u0423\u041c\u041c(B1:D1)&quot;</code> if you prefer."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531313663, "post_id": 51284195, "comment_id": 89549424, "body": "@CLR I heard it wouldn&#39;t work on Excels with a different language version. I have a Russian Excel version, so I guess <code>FormulaLocal</code> wouldn&#39;t work for someone with an English Excel isntalled on?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531314292, "post_id": 51284195, "comment_id": 89549882, "body": "That would make sense. I hadn&#39;t realised you were looking to use this on other set-ups."}], "tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 3, "last_activity_date": 1531308071, "creation_date": 1531308071, "answer_id": 51284195, "question_id": 51283932, "link": "https://stackoverflow.com/questions/51283932/excel-vba-formula-string-doesnt-calculate-name-error/51284195#51284195", "title": "Excel vba formula string doesn&#39;t calculate: #NAME? error", "body": "<p>You're not specifying which property of Cells you want.</p>\n\n<p>The default property of Cells is Value. Therefore when you write:</p>\n\n<pre><code>Cells(1,1) = \"=SUM(B1:D1)\"\n</code></pre>\n\n<p>... what you're actually saying is:</p>\n\n<pre><code>Cells(1,1).Value = \"=SUM(B1:D1)\"\n</code></pre>\n\n<p>You need to use the .Formula property:</p>\n\n<pre><code>Cells(1,1).Formula = \"=SUM(B1:D1)\"\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 51284195, "answer_count": 1, "score": 0, "last_activity_date": 1594207698, "creation_date": 1531307180, "last_edit_date": 1594207698, "question_id": 51283932, "link": "https://stackoverflow.com/questions/51283932/excel-vba-formula-string-doesnt-calculate-name-error", "title": "Excel vba formula string doesn&#39;t calculate: #NAME? error", "body": "<p>I have this sub that types in a sum formula in A1 cell:</p>\n\n<pre><code>Sub test_string()\n    ThisWorkbook.Worksheets(\"test\").Cells(1, 1) = \"=\u0421\u0423\u041c\u041c(B1:D1)\"\nEnd Sub\n</code></pre>\n\n<p>At first it looks like it has worked, but when I open a worksheet there's a <code>#NAME?</code> error in A1 cell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LI3g2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LI3g2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The error disappears when I manually calculate the formula (put cursor in formula's text and click Enter).</p>\n\n<p>Why does this happen and is there a way to fix it? I tried</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"test\").Cells(1, 1).Calculate\n</code></pre>\n\n<p>But to no result.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1531309204, "post_id": 51283908, "comment_id": 89546264, "body": "could you not use formulas to show the data in your destination sheet?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1531310683, "post_id": 51283908, "comment_id": 89547222, "body": "You could use an Inputbox."}, {"owner": {"reputation": 11, "user_id": 4137485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fdd5ee5fc5ada67445a6b483febbea?s=128&d=identicon&r=PG&f=1", "display_name": "Alejo Linardi", "link": "https://stackoverflow.com/users/4137485/alejo-linardi"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1531400991, "post_id": 51283908, "comment_id": 89589686, "body": "Hey thanks for the replies. @OurManinBananas SJRI would rather not use formulas as the sheet gets pretty heavy with all the references and also there is the inefficiency of changing them every time. Regarding the input box i know how they work and would be able to but sometimes struggle to get them in the code properly."}], "owner": {"reputation": 11, "user_id": 4137485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fdd5ee5fc5ada67445a6b483febbea?s=128&d=identicon&r=PG&f=1", "display_name": "Alejo Linardi", "link": "https://stackoverflow.com/users/4137485/alejo-linardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547229482, "creation_date": 1531307097, "last_edit_date": 1547229482, "question_id": 51283908, "link": "https://stackoverflow.com/questions/51283908/copy-data-from-workbook-to-another-workbook-matching-columns-and-rows", "title": "Copy data from workbook to another workbook matching columns and rows", "body": "<p>I have a master data file (Conso.xls) where I consolidate information from several countries (Country1, 2, 3.xls). Both Conso and Country have the same rows, which are expense concepts, they are in A4:A32. The column headers, that are weeks (e.g. W31, W32, w33) are in different positions or cells depending on the country but always on the 2nd row. For example, in one Excel file W31 will be in A2 and in another in D2 (always 2nd row, but different column).</p>\n\n<p>I am trying to make a macro that looks for the column header in the country book and copies the data below it to the Conso book, to the column with the same header (W31, w32, w33) etc.  It would be nice to have a msgbox that pops up and asks to which specific sheet within the workbook to copy the data to. </p>\n\n<pre><code>Sub test()\nDim r As Range, c As Range, msg As String\nWith Sheets(\"Backend - raw\").Range(\"4:4\").CurrentRegion\n    For Each r In Sheets(\"Backend - processed\").Range(\"b7:t7\")\n        Set c = .Rows(1).Find(r.Value, , , xlWhole, , 0)\n        If Not c Is Nothing Then\n            .Columns(c.Column).Copy\n            r.PasteSpecial xlPasteValues\n        Else\n            msg = msg &amp; vbLf &amp; r.Value\n        End If\n    Next\n    Application.CutCopyMode = False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1531305614, "post_id": 51283348, "comment_id": 89543943, "body": "What&#39;s <code>Me.Next</code> and why are you setting focus to it if you&#39;re going to set focus to <code>Me.ID</code> immediately after."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1531305711, "post_id": 51283348, "comment_id": 89544019, "body": "What line of code throws the error? What have you tried to fix it?"}, {"owner": {"reputation": 51, "user_id": 3763204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c71c395a30638ec09c107611b0161?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertSan", "link": "https://stackoverflow.com/users/3763204/albertsan"}, "edited": false, "score": 0, "creation_date": 1531305997, "post_id": 51283348, "comment_id": 89544203, "body": "I&#39;ve tried to create a string just to simplify .FindFirst   other than that I don&#39;t know where I got it wrong"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1531306260, "post_id": 51283348, "comment_id": 89544377, "body": "Strange. An obvious error are the parentheses, these should only be used if you want a function/method to return a parameter, and should be removed both on that <code>rs.FindFirst</code> and that <code>MsgBox</code>, but I haven&#39;t seen it cause this error. You can specify <code>dbOpenDynaset</code> on the <code>.OpenRecordset</code>, but that should be the default."}, {"owner": {"reputation": 51, "user_id": 3763204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c71c395a30638ec09c107611b0161?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertSan", "link": "https://stackoverflow.com/users/3763204/albertsan"}, "edited": false, "score": 1, "creation_date": 1531306433, "post_id": 51283348, "comment_id": 89544503, "body": "well you know what Erik, I actually specify <code>dbOpenDynaset</code> and it work. strange, I always thought that is the default"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1531314055, "creation_date": 1531314055, "answer_id": 51286136, "question_id": 51283348, "link": "https://stackoverflow.com/questions/51283348/access-vba-error-operation-not-supported-for-this-type-of-object/51286136#51286136", "title": "access VBA error &quot;operation not supported for this type of object&quot;", "body": "<pre><code>db.OpenRecordset(\"&lt;a local Table&gt;\")\n</code></pre>\n\n<p>will open a recordset of type <code>Table</code>, for which <code>.FindFirst</code> etc. are not valid.</p>\n\n<p>Either use <code>dbOpenDynaset</code> or use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836416.aspx\" rel=\"nofollow noreferrer\"><code>.Seek</code></a> method.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow noreferrer\">Database.OpenRecordset Method (DAO)</a></p>\n\n<blockquote>\n  <p>If you open a Recordset in a Microsoft Access workspace and you don't specify a type, OpenRecordset creates a table-type Recordset, if possible. If you specify a linked table or query, OpenRecordset creates a dynaset-type Recordset.</p>\n</blockquote>\n"}], "owner": {"reputation": 51, "user_id": 3763204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c71c395a30638ec09c107611b0161?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertSan", "link": "https://stackoverflow.com/users/3763204/albertsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2517, "favorite_count": 0, "accepted_answer_id": 51286136, "answer_count": 1, "score": 1, "last_activity_date": 1531314055, "creation_date": 1531305514, "last_edit_date": 1531305890, "question_id": 51283348, "link": "https://stackoverflow.com/questions/51283348/access-vba-error-operation-not-supported-for-this-type-of-object", "title": "access VBA error &quot;operation not supported for this type of object&quot;", "body": "<p>I have this vba code and I don't understand why it return error<br>\nme.ID is stored as string btw</p>\n\n<pre><code>Private Sub ID_AfterUpdate()\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n\n    Me.ID = UCase(Me.ID)\n      Set db = CurrentDb\n    Set rs = db.OpenRecordset(\"Products\")   \n    rs.FindFirst (\"[SKU] =\"\"\" &amp; Me.ID &amp; \"\"\"\") //this is the one giving error\n    If Not rs.NoMatch Then\n        MsgBox (\"SKU Existed\")\n        Me.ID.Value = Null\n        Me.Next.SetFocus //just for the sake of moving to this field then\n        Me.ID.SetFocus  //to this field coz sometimes it won't go straight to\n    End If\n\n    rs.Close\n    Set rs = Nothing\n    Set db = Nothing End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/UqiCu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UqiCu.png\" alt=\"any idea where I got this wrong ?\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1531304632, "post_id": 51283005, "comment_id": 89543281, "body": "<a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=239\" rel=\"nofollow noreferrer\">vbaexpress.com/kb/getarticle.php?kb_id=239</a>"}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "reply_to_user": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 1, "creation_date": 1531305134, "post_id": 51283005, "comment_id": 89543627, "body": "I just wrote that .protectcontents isn&#39;t solution for me. please read my post carefully"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 5, "last_activity_date": 1531306044, "creation_date": 1531306044, "answer_id": 51283534, "question_id": 51283005, "link": "https://stackoverflow.com/questions/51283005/how-check-if-excel-worksheet-is-protected/51283534#51283534", "title": "How check if Excel worksheet is protected?", "body": "<p>The three protection properties of a worksheet are the following:</p>\n\n<ul>\n<li><code>Sheets(1).ProtectContents</code></li>\n<li><code>Sheets(1).ProtectDrawingObjects</code></li>\n<li><code>Sheets(1).ProtectScenarios</code> </li>\n</ul>\n\n<p>You can check whether both 3 are <code>False</code>. If this is the case, it is not protected.</p>\n\n<p><code>.ProtectionMode</code> says whether \"User-Interface-only\" protection is turned on. You may add it to the function, if you need it. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-protectionmode-property-excel\" rel=\"noreferrer\">MSDN - ProtectionMode</a></p>\n"}], "owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "accepted_answer_id": 51283534, "answer_count": 1, "score": 1, "last_activity_date": 1531306044, "creation_date": 1531304539, "question_id": 51283005, "link": "https://stackoverflow.com/questions/51283005/how-check-if-excel-worksheet-is-protected", "title": "How check if Excel worksheet is protected?", "body": "<p>I want to check if Excel worksheet is protected or not. I know that I can check <code>.protectcontents</code>, but what if worksheet is protected like this:</p>\n\n<pre><code>activesheet.protect contents:=false\n</code></pre>\n\n<p><code>.protectcontents</code> returns <code>false</code> but shapes are locked.\nPlease help.</p>\n"}, {"tags": ["excel", "vba", "email", "smtp"], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "edited": false, "score": 0, "creation_date": 1531366812, "post_id": 51284468, "comment_id": 89571202, "body": "Works perfectly. I just need to figure out how to add some formatting to the text now. Do you have any idea about this also?"}, {"owner": {"reputation": 310, "user_id": 7457808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqXOj.png?s=128&g=1", "display_name": "Franz", "link": "https://stackoverflow.com/users/7457808/franz"}, "reply_to_user": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "edited": false, "score": 1, "creation_date": 1531381759, "post_id": 51284468, "comment_id": 89576872, "body": "You can use any HTML-markup, see <a href=\"https://www.w3schools.com/html/html_intro.asp\" rel=\"nofollow noreferrer\">w3schools</a> or many others for reference. Or you just format the mail in any mailing tool to look as it should do, export as html and change the definition of the <code>html_text</code> variable accordingly. One problem might be that the <code>&lt;style&gt;</code> tag will determine the mails appearance, but belongs to the HTML <code>&lt;head&gt;</code> section. As I have not found a proper reference for CDO, I dont know how to do that. You could try putting it at the very beginning of the <code>&lt;body&gt;</code> or including the styles as attributes of all the tags."}, {"owner": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "edited": false, "score": 0, "creation_date": 1531465830, "post_id": 51284468, "comment_id": 89614749, "body": "I added the HTML as you instructed, but I think I am not quite getting something correct as it presents a problem as soon as it gets to the second Next cell. I have changed part of the original code to this:  <a href=\"http://rextester.com/SEG14395\" rel=\"nofollow noreferrer\">rextester.com/SEG14395</a>"}, {"owner": {"reputation": 310, "user_id": 7457808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqXOj.png?s=128&g=1", "display_name": "Franz", "link": "https://stackoverflow.com/users/7457808/franz"}, "reply_to_user": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "edited": false, "score": 0, "creation_date": 1531479081, "post_id": 51284468, "comment_id": 89621945, "body": "What you did cannot work because <code>next cell</code> is just the footer line of the loop. If you want to just go through an arbitrary collection of cells (what you were trying in the externally provided code sample, maybe you should provide it here; also, this was not what you tried in the original question), construct an array of Captions and one of Ranges (or Strings keeping the addresses) and loop through those. More flexible would be including the captions in the sheet and passing a coherent range like you did in the original question, though."}, {"owner": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "edited": false, "score": 0, "creation_date": 1531499655, "post_id": 51284468, "comment_id": 89634470, "body": "Ahh, I thought next cell actually moved to the next cell from the selected range. For example if I just paste Cell1 and then used Next Cell, then Cell2 would be paste. Guess I misunderstood. Hence my HTML between each cell being pasted etc and a new Next Cell haha. How do I pass a coherent range and keep the sheets style formatting though? Because not all fonts in the range are same colour for instance."}], "tags": [], "owner": {"reputation": 310, "user_id": 7457808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqXOj.png?s=128&g=1", "display_name": "Franz", "link": "https://stackoverflow.com/users/7457808/franz"}, "is_accepted": true, "score": 2, "last_activity_date": 1531322971, "last_edit_date": 1531322971, "creation_date": 1531308838, "answer_id": 51284468, "question_id": 51282985, "link": "https://stackoverflow.com/questions/51282985/how-can-i-add-a-range-of-cells-as-the-body-of-a-custom-smtp-email-from-excel-usi/51284468#51284468", "title": "How can I add a Range of cells as the body of a custom SMTP email from Excel using Visual Basic?", "body": "<p>If I understand correctly, you cannot simply assign the range to <code>.HTMLBody</code>. You may have to construct the HTML-String \"by hand\" and have something similar to</p>\n\n<pre><code>html_text = \"&lt;table&gt;\" &amp; vbCrLf &amp; \"&lt;tr&gt;\"\nFor Each Row In myrng.Rows\n    For Each cell In Row.Cells\n        html_text = html_text &amp; \"&lt;td&gt;\" &amp; cell.Text &amp; \"&lt;/td&gt;\"\n    Next cell\n    html_text = html_text &amp; \"&lt;/tr&gt;\" &amp; vbCrLf\nNext Row\nhtml_text = html_text &amp; \"&lt;/table&gt;\"\n.HTMLBody=html_text\n</code></pre>\n\n<p>replace your line</p>\n\n<pre><code>.HTMLBody = myRng\n</code></pre>\n\n<p>.</p>\n"}], "owner": {"reputation": 118, "user_id": 8442835, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10159156630470297/picture?type=large", "display_name": "Dayley", "link": "https://stackoverflow.com/users/8442835/dayley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 51284468, "answer_count": 1, "score": 0, "last_activity_date": 1594209966, "creation_date": 1531304477, "last_edit_date": 1594209966, "question_id": 51282985, "link": "https://stackoverflow.com/questions/51282985/how-can-i-add-a-range-of-cells-as-the-body-of-a-custom-smtp-email-from-excel-usi", "title": "How can I add a Range of cells as the body of a custom SMTP email from Excel using Visual Basic?", "body": "<p>On the click of a button in Excel, I am sending a range of cells on a sheet as the body of an email. The email is sending correctly, but I cannot work out how to add the actual range of cells as the body. Here is the code I am currently using in Excel's Visual Basic along with the <strong>Micrsoft CDO for Windows 2000 Library</strong>:</p>\n\n<pre><code>Sub Email_Figures_Click()\nDim myMail As CDO.Message\n\nSet myMail = New CDO.Message\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = False\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"HIDDEN\"\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"HIDDEN\"\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"HIDDEN\"\nmyMail.Configuration.Fields.Update\n\nWith myMail\n.Subject = \"HIDDEN\"\n.From = \"HIDDEN\"\n.To = \"HIDDEN\"\n\n    Dim myRng As Range\n    Set myRng = Nothing\n\n    'Only the visible cells in the selection\n    Set myRng = Sheets(\"Monthly Figures\").Range(\"A1:B29\").SpecialCells(xlCellTypeVisible)\n\n    If myRng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n\n    End If\n\n.HTMLBody = myRng\nEnd With\nOn Error Resume Next\nmyMail.Send\nMsgBox (\"Email has been sent!\")\nSet myMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>Anything that has the word HIDDEN is to protect the client.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531303691, "post_id": 51282649, "comment_id": 89542729, "body": "What are the values of the ComboBoxes?"}, {"owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531303758, "post_id": 51282649, "comment_id": 89542771, "body": "Combobox 1 = Period 1, Period 2.... Period 13, Combobox2 = Week 1, Week 2, week 3 &amp; week 4"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531303992, "post_id": 51282649, "comment_id": 89542919, "body": "You could use <code>FoundRange = Range().Find()</code> to search for the ComboBox1 Value in the sheet. And <code>FoundRange.Offset(3, 0)</code> for Week1 and <code>FoundRange.Offset(3, 1)</code> for Week2 etc. Give it a try and come back with your code and a specific question to it (or errors you got)."}, {"owner": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "edited": false, "score": 0, "creation_date": 1531304907, "post_id": 51282649, "comment_id": 89543460, "body": "Sounds like this way you will have to list all the possibilities, i.e. Period1/Week1, Week2, etc... then Period2/Week1, Week2, etc... if that is what you want, then you could use a label instead of a textbox, for example name it DisplayLabel1 and then declare:  if combobox1 = Cell E3 (Period 1) &amp; combobox2 = Cell E4 (week) then DisplayLabel1.Caption = &quot;whatever cell address content is supposed to display&quot;.value... then another if and another..."}, {"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "edited": false, "score": 0, "creation_date": 1531310192, "post_id": 51282649, "comment_id": 89546948, "body": "Is there any pattern of selecting a cell after week/period was selected? Eg if week 1 is selected will it be always cell in row 6 no matter which period was selected? If yes then you could use hidden columns in comboboxes and put rows/columns numbers in there. Eg Period 1 is column 5 and week 1 is row 6 and offset 0. So cell to select is .cells(6,5).offset(0,0)"}], "answers": [{"tags": [], "owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "is_accepted": true, "score": 1, "last_activity_date": 1531309955, "creation_date": 1531309955, "answer_id": 51284819, "question_id": 51282649, "link": "https://stackoverflow.com/questions/51282649/vba-userform-populate-textbox-with-cell-value-based-on-2-combobox-selections/51284819#51284819", "title": "VBA Userform Populate textbox with cell value based on 2 combobox selections", "body": "<p>concentrating the 2 text boxes in to 1 value and searching solved this issue</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n Dim Inp, Outp\n    Dim Rng As Range\n    Inp = TextBox1.Value\n    With Sheets(\"2018 - 2019\").Range(\"E2:H2\")\n        Set Rng = .Find(what:=Inp, after:=.Cells(.Rows.Count, 1), LookIn:=xlValues, _\n                            LookAt:=xlPart, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n        If Not Rng Is Nothing Then\n            Outp = Rng.Offset(5, 0).Value\n            TextBox2.Value = Outp\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 51284819, "answer_count": 1, "score": 0, "last_activity_date": 1594207111, "creation_date": 1531303413, "last_edit_date": 1594207111, "question_id": 51282649, "link": "https://stackoverflow.com/questions/51282649/vba-userform-populate-textbox-with-cell-value-based-on-2-combobox-selections", "title": "VBA Userform Populate textbox with cell value based on 2 combobox selections", "body": "<p>I am trying to populate textbox on userform based on 2 combobox selections? I cannot find any code to get close to this i can populate with 1 combobox but not 2 can anyone help?</p>\n\n<p>Example if combobox1 = Cell E3 (Period 1) &amp; combobox2 = Cell E4 (week) show Cell value E6 in Textbox1</p>\n\n<p><a href=\"https://i.stack.imgur.com/55VHD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/55VHD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2nFbH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2nFbH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If anyone can help I would be very greatful</p>\n"}, {"tags": ["html", "vba", "ms-access", "web-scraping", "onclick"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1531303797, "post_id": 51282627, "comment_id": 89542803, "body": "1) Format and edit your code properly please 2) Insert HTML as snippet not as image (use tools provided) 3) Make your question nice and clear 4) Describe what <i>doesn&#39;t work</i> means. Error messages? What are they? Which lines? What did you try?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1531303908, "post_id": 51282627, "comment_id": 89542881, "body": "You also aren&#39;t sending <i>POST binary request</i> as far as I can see. And I can&#39;t see r/std/icons/combi64.png in the image provided."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1531304087, "post_id": 51282627, "comment_id": 89542975, "body": "As newbie take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read about <a href=\"https://stackoverflow.com/help/asking\">Asking</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10057623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef357c8c77138ac54ae2b3988567a28?s=128&d=identicon&r=PG&f=1", "display_name": "V.Vittorio", "link": "https://stackoverflow.com/users/10057623/v-vittorio"}, "edited": false, "score": 0, "creation_date": 1531314268, "post_id": 51285889, "comment_id": 89549861, "body": "i using your code but don&#39;t work. Look a picture error. I use also a break-point for wait page load."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 10057623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef357c8c77138ac54ae2b3988567a28?s=128&d=identicon&r=PG&f=1", "display_name": "V.Vittorio", "link": "https://stackoverflow.com/users/10057623/v-vittorio"}, "edited": false, "score": 1, "creation_date": 1531314591, "post_id": 51285889, "comment_id": 89550116, "body": "Try the above E.Document.getElementsByClassName(&quot;tbi&quot;)(1).Click . And please learn how to edit info into your question using the edit keyword under your question.  Failing all that just  IE.Document.querySelector(&quot;img[src=&#39;r/std/icons/combi64.png&#39;&zwnj;&#8203;]&quot;).Click"}, {"owner": {"reputation": 1, "user_id": 10057623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef357c8c77138ac54ae2b3988567a28?s=128&d=identicon&r=PG&f=1", "display_name": "V.Vittorio", "link": "https://stackoverflow.com/users/10057623/v-vittorio"}, "edited": false, "score": 1, "creation_date": 1531315055, "post_id": 51285889, "comment_id": 89550482, "body": "WORK!!! Using only IE.Document.getElementsByClassName(&quot;tbi&quot;)(1).Click thanks thanks thanks thanks :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1531314532, "last_edit_date": 1531314532, "creation_date": 1531313311, "answer_id": 51285889, "question_id": 51282627, "link": "https://stackoverflow.com/questions/51282627/vba-to-click-internet-explorer-with-only-onlick/51285889#51285889", "title": "VBA to click Internet Explorer with ONLY Onlick", "body": "<p>I meant simply</p>\n\n<pre><code>IE.Navigate \"http://Mysite/Home/\"\nWhile IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend\nIE.Document.getElementsByClassName(\"tbi\")(1).Click\n</code></pre>\n\n<p>It is a single element. No For Loop required. No innerText check. Just as shown above. Note that you also need to wait for the page to load; to that end I have added <code>While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend</code>.</p>\n\n<hr>\n\n<p>To click on the icon then</p>\n\n<pre><code>IE.Document.querySelector(\"img[src='r/std/icons/combi64.png']\").Click\n</code></pre>\n\n<p>But I am not sure the icon is clickable.</p>\n"}], "owner": {"reputation": 1, "user_id": 10057623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef357c8c77138ac54ae2b3988567a28?s=128&d=identicon&r=PG&f=1", "display_name": "V.Vittorio", "link": "https://stackoverflow.com/users/10057623/v-vittorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1531386259, "answer_count": 1, "score": -10, "last_activity_date": 1593955322, "creation_date": 1531303347, "last_edit_date": 1593955322, "question_id": 51282627, "link": "https://stackoverflow.com/questions/51282627/vba-to-click-internet-explorer-with-only-onlick", "closed_reason": "Not suitable for this site", "title": "VBA to click Internet Explorer with ONLY Onlick", "body": "<p>Because don't work?\nPlease Help me! :(</p>\n\n<p><a href=\"https://i.stack.imgur.com/RcFsS.jpg\" rel=\"nofollow noreferrer\">HTML CODE</a></p>\n\n<pre><code>Dim i As Long \n\nDim IE As Object\n\nDim Doc As Object\n\nDim objElement As Object\n\nDim objCollection As Object\n\nDim buttonCollection As Object\n\nDim valeur_heure As Object\n\n\n' Create InternetExplorer Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n' You can uncoment Next line To see form results\n\nIE.Visible = True\n\n' Send the form data To URL As POST binary request\n\nIE.Navigate \"http://Mysite/Home/\"\n\nDim elements As Object, element As Object\n\nFor Each element In IE.Document.getElementsByTagName(\"img\")\n\n    If element.innertext = \"r/std/icons/combi64.png\" Then\n         element.Focus\n        element.Click\n        Exit For\n    End If\n\nNext\n\n  Set IE = Nothing\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "join", "named-ranges"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531303536, "post_id": 51282481, "comment_id": 89542634, "body": "<code>arrMOTORsplit</code> contains a single value doesn&#39;t it, not an array?"}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1531433061, "post_id": 51282481, "comment_id": 89606786, "body": "arrMOTORsplit is the single returned value (the corresponding translation) that&#39;s on the same row as the value from the first split. I want to join these single values. Ex: Benzine, Hybride -&gt; Gasoline, Hybrid"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1531502991, "post_id": 51282481, "comment_id": 89635990, "body": "Found an innovative solution in <b>ANY order of combinations</b> - will edit my answer :-)"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1531434897, "post_id": 51282783, "comment_id": 89607242, "body": "Hi Vitayata, Thank you for the quick reply. I&#39;ve played around with your solution, but couldn&#39;t integrate the comparing part  to achieve for Ex: (B1)Benzine, (B3)Hybride -&gt; (E1)Gasoline, (E3)Hybrid or another combination."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1531506835, "post_id": 51282783, "comment_id": 89637731, "body": "@Vityata, find your answers helpful in any case +1. - BTW I edited my answer to demonstrate an innovative and fully flexible approach which might be of some interest for you.  :-)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1531303845, "creation_date": 1531303845, "answer_id": 51282783, "question_id": 51282481, "link": "https://stackoverflow.com/questions/51282481/how-to-join-returned-values-from-named-range-separated-by-comma/51282783#51282783", "title": "How to join returned values from named range separated by comma", "body": "<p>With 2 arrays this is a possible solution:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim inputString As String\n    Dim arrString As Variant\n    Dim arrResult As Variant\n\n    inputString = \"Benzine, Diesel, Hybride\"\n    arrString = Split(inputString, \",\")\n\n    Dim total As Long: total = UBound(arrString)\n    ReDim arrResult(total)\n\n    Dim i As Long\n    For i = LBound(arrString) To UBound(arrString)\n        arrResult(total - i) = Trim(arrString(i))\n    Next i\n\n    Debug.Print Join(arrResult, \" ,\")\n\nEnd Sub\n</code></pre>\n\n<p>However, there is a classic solution of this problem, reversing everything twice:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim inputString As String\n    inputString = \"Benzine, Diesel, Hybride\"\n    inputString = StrReverse(inputString)\n    Dim arr As Variant: arr = Split(inputString, \",\")\n\n    Dim i As Long\n    For i = LBound(arr) To UBound(arr)\n        arr(i) = Trim(StrReverse(arr(i)))\n    Next i\n\n    Debug.Print Join(arr, \", \")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1531434118, "post_id": 51293412, "comment_id": 89607079, "body": "Hi T.M., I&#39;ve tried to integrate your code, but could only get a full column into the join. So I tried to get for   Ex: Benzine, Hybride -&gt; Gasoline, Hybrid or another combination,   but couldn&#39;t get it to work yet. I got stuck on the comparing part:  If arrMOTOR(w, 1) = Splitted(j) Then"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1531471331, "post_id": 51293412, "comment_id": 89617586, "body": "@W.Duri - Do you want to execute for example something like &quot;Show me the concatenated 1st and 3rd row values in column 1 and add the corresponding concatenation in column 4 to get a result string.&quot; ?"}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 1, "creation_date": 1531473213, "post_id": 51293412, "comment_id": 89618705, "body": "Yes, so what happens is: 1) A user inputs any (concatenated) combination from a listbox in Dutch (column 1)  2) I split into separate values  3) And indeed, lookup the translated value (for example English: column 4).  4) The last step (where I&#39;m stuck) is to get translated values concatenated"}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1531587827, "post_id": 51293412, "comment_id": 89656612, "body": "I&#39;ve just tried your code, but I&#39;m getting a Run-time error &#39;13&#39;: Type mismatch on part [2]  where a is getting implemented."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 0, "creation_date": 1531663321, "post_id": 51293412, "comment_id": 89670692, "body": "@W.Duri - edited my answer to reply to your comment; hope this helps."}, {"owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 1, "creation_date": 1531811450, "post_id": 51293412, "comment_id": 89721975, "body": "Thank you very much. I&#39;ve figured out that the Run-time error &#39;13&#39; is occuring when there&#39;s no value entered in the one of the rows in column M - ONDERDELEN. It would be great if an empty value could be replaced with a &quot;-&quot; instead. I thought about using isempty somehow, but I&#39;m not sure where to put it. My best guess is around &quot;ar&quot; in Function getRowAr."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "edited": false, "score": 1, "creation_date": 1531815466, "post_id": 51293412, "comment_id": 89724368, "body": "@W.Duri - Glad my approach is useful. As to your question: simply **insert a first row into your named range <code>Motor</code> and fill all values with &quot;-&quot; as I suggested in the addendum edit and check if the complete range is redefined."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1531663212, "last_edit_date": 1531663212, "creation_date": 1531339378, "answer_id": 51293412, "question_id": 51282481, "link": "https://stackoverflow.com/questions/51282481/how-to-join-returned-values-from-named-range-separated-by-comma/51293412#51293412", "title": "How to join returned values from named range separated by comma", "body": "<p><strong>Get comma separated strings for each column in named range</strong></p>\n\n<p>I didn't analyze your code, but this should work to receive the first three values joined </p>\n\n<pre><code>\"Benzine, Diesel, Hybride\"  ' e.g. from first column \n</code></pre>\n\n<p>or</p>\n\n<pre><code>\"Gasoline, Diesel, Hybrid\"  ' e.g. from the fourth column\n</code></pre>\n\n<p>from a named range \"Motor\" via the <code>Application.Index</code> function.</p>\n\n<p><strong>Notes</strong></p>\n\n<p>The parameter 0 in this <code>Index</code> function indicates to not choose a specific row, the Parameter <code>ColNo</code> chooses each of your columns in a Loop. A subsequent <em>transposition</em> allows to change the 2 dimensioned array values to a 1-dim array. The <code>Join</code> function needs a 1-dim array and concatenates the chosen column items therein.  </p>\n\n<p><em>Hint:</em> The following sample code uses a fully qualified range reference assuming that you don't call the <code>TestMe</code> procedure from your <em>Personal Macro Library</em>. In the latter case you'd have to change references and workbook identification (not using <strong><code>ThisWorkbook</code></strong>!).</p>\n\n<p><strong>Example code</strong></p>\n\n<pre><code>Option Explicit      ' declaration head of your code module\n\nSub TestMe()\nDim v As Variant, ColNo As Long\n' assign first three rows to variant 1-based 2-dim datafield array\n  v = ThisWorkbook.Worksheets(\"Motor\").[Motor].Resize(3, 4) ' Named range value\n' write comma separated list for each column\n  For ColNo = 1 To 4\n      Debug.Print Join(Application.Transpose(Application.Index(v, 0, ColNo)), \", \")\n  Next ColNo\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>EDIT - Flexible Search in ANY ORDER to translate joined lists</strong></p>\n</blockquote>\n\n<p>This solution allows to return joined search words in <em>any combination</em> using the <code>Application.Index</code> function in an advanced way using row and column arrays as parameters. The main function <code>getSplitters()</code> creates a variant 2-dim array in only three steps <strong>without loops and redims</strong> and uses two language constants (Const DUTCH and Const ENGLISH).:</p>\n\n<ol>\n<li>assigns data to variant 1-based 2-dim datafield array</li>\n<li>gets only the selected rows based on comma separated string values</li>\n<li>reduces the same array to Dutch and English columns</li>\n</ol>\n\n<p><strong>Calling Code</strong></p>\n\n<p>Due to your OP the calling code anylyzes all comma separated strings in Column <code>M</code> in your sheet <code>\"ONDERDELEN\"</code> as far as there are values in column A. This is made by passing these found string values to the main function <code>getSplitters</code> with an <strong>innovative approach</strong> to get results in <em>only three steps without Loops</em> (see function code below).</p>\n\n<p>Translation is based on values in the named range <code>Motor</code> <code>\"B1:E4\"</code> in sheet <code>\"Motor\"</code> where rows comprise different sort of fuel with neighbouring columns for different languages (starting with Dutch in the first column and English in the fourth col). </p>\n\n<p><em>Note that using VBA it is faster to loop through an array to get values than through a range.</em></p>\n\n<pre><code>Option Explicit             ' declaration head of your code module\nConst DUTCH   As Integer = 1\nConst ENGLISH As Integer = 4\n\nSub TranslateAnyFuelCombination()\n' Purpose: returns comma separated lists in column \"M\" and translates from Dutch to English\n' Example: \"Benzine, Hybride, Diesel\" (Dutch) gets to \"Gasoline, Hybrid, Diesel\" in English\n  Dim s As String\n  Dim oWS As Worksheet, i&amp;, LastRow&amp;, vMOTOR As Variant\n  Set oWS = Thisworkbook.Worksheets(\"ONDERDELEN\")   ' fully qualified reference\n' Get last row of wanted data\n  LastRow = oWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  vMOTOR = oWS.Range(\"M1:M\" &amp; LastRow)\n  For i = 2 To LastRow                       'Starting below headers\n      Debug.Print getSplitters(vMOTOR(i, 1))\n  Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Main function</strong></p>\n\n<pre><code>Function getSplitters(ByVal sRows As String) As String\n  Dim i As Long, j    As Long\n  Dim v As Variant, a As Variant\n' [0] analyze selected rows string, e.g. \"Benzine, Hybride, Diesel\"\n  a = getRowAr(sRows)          ' -&gt; assign 1-dim Rows Array(1, 3, 2)\n' [1] assign data to variant 1-based 2-dim datafield array\n  v = Application.Transpose(ThisWorkbook.Worksheets(\"Motor\").[Motor])      ' Named range value\n' [2] get only selected rows, e.g. 1st, 3rd and 2nd -&gt; in free order (!) Benzine, Hybride, Diesel\n  v = Application.Transpose(Application.Index(v, _\n      Application.Evaluate(\"row(1:\" &amp; UBound(v, 2) &amp; \")\"), _\n      a))                      ' transposed columns array = selected rows\n' [3] reduce to Dutch and English columns\n  v = Application.Transpose(Application.Index(v, _\n      Application.Evaluate(\"row(1:\" &amp; (UBound(a) + 1) &amp; \")\"), _\n      Array(DUTCH, ENGLISH)))               ' selected columns array (above array retransposed)\n' [4] return concatenated strings\n  getSplitters = Join(Application.Transpose(Application.Transpose(Application.Index(v, 1, 0))), \", \") &amp; \" -&gt; \" &amp; _\n                 Join(Application.Transpose(Application.Transpose(Application.Index(v, 2, 0))), \", \")\nEnd Function\n</code></pre>\n\n<p><strong>Two helper functions</strong></p>\n\n<pre><code>Function getRowAr(ByVal sList As String) As Variant\n' Purpose: split comma separated list into 1-dim number array in FREE ORDER\n' Example: \"Benzine, Hybride, Diesel\" -&gt; Array(1, 3, 2)\n  Dim ar, i&amp;\n' change words in comma separated list to numbers\n  ar = Split(Replace(sList, \" \", \"\"), \",\")\n  For i = LBound(ar) To UBound(ar)\n      ar(i) = val(getNumber(ar(i)))                ' change to numbers\n  Next i\n  getRowAr = ar                                    ' return\nEnd Function\n\nFunction getNumber(ByVal s As String) As Long\n' Purpose: replaces dutch search words with corresponding row number\n  Dim arFuel\n' get search words to 1-dim array\n  arFuel = Application.Index(ThisWorkbook.Worksheets(\"Motor\").[Motor], 0, DUTCH)\n' return corresponding number\n  getNumber = Application.Match(s, arFuel)\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p><strong>Addendum</strong> <em>(Edit due to comment)</em></p>\n</blockquote>\n\n<p>The above code works as intended if you are sure that the concatenated search words (or starting parts) <em>actually match</em> else an Error 13 is raised. You can solve this issue in two steps:</p>\n\n<ol>\n<li>Insert an <strong>empty first row</strong> into your named range <code>Motor</code> (or fill it e.g. with <code>?</code>, <code>#N/A</code> etc.)</li>\n<li>Change the 2nd helper function as follows:</li>\n</ol>\n\n<p><strong>Edited function <code>getNumber()</code></strong></p>\n\n<pre><code> Function getNumber(ByVal s As String) As Long\n ' Purpose: replaces dutch search words with corresponding row number\n   Dim arFuel\n ' get search words to 1-dim array\n   arFuel = Application.Index(ThisWorkbook.Worksheets(\"Motor\").[Motor], 0, DUTCH)\n ' return corresponding number\n   On Error Resume Next                             ' provide for not found case\n   getNumber = Application.Match(s, arFuel, 0)      ' find only exact matches\n   If Err.Number &lt;&gt; 0 Then getNumber = 0            ' could be omitted in case of a zero return\n End Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9189148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb1900fcf40ec79147b7f5515bd0430?s=128&d=identicon&r=PG&f=1", "display_name": "W. Duri", "link": "https://stackoverflow.com/users/9189148/w-duri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 1, "accepted_answer_id": 51293412, "answer_count": 2, "score": 3, "last_activity_date": 1594209929, "creation_date": 1531302934, "last_edit_date": 1594209929, "question_id": 51282481, "link": "https://stackoverflow.com/questions/51282481/how-to-join-returned-values-from-named-range-separated-by-comma", "title": "How to join returned values from named range separated by comma", "body": "<p>I've spent hours trying to find out how to join returned values from a named range, but the result is a </p>\n\n<blockquote>\n  <p>run-time error 32 - Type mismatch.</p>\n</blockquote>\n\n<p>As a newbie I'm still struggling with arrays, so maybe I've overlooked some detail. Thank you for helping me out.</p>\n\n<p>Example: (B1)Benzine, (B2)Diesel, (B3)Hybride -> (E1)Gasoline, (E2)Diesel, (E3)Hybrid</p>\n\n<p>This is the named range:<br>\n<a href=\"https://i.stack.imgur.com/DUxQ3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DUxQ3.jpg\" alt=\"Named Range: MOTOR\"></a></p>\n\n<p><strong>Another example (to be more clear):</strong></p>\n\n<p>Example 2: (B1)Benzine, (B3)Hybride -> (E1)Gasoline, (E3)Hybrid</p>\n\n<p><a href=\"https://i.stack.imgur.com/DUxQ3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tDWGM.jpg\" alt=\"Named Range: MOTOR\"></a></p>\n\n<pre><code>Option Explicit\n\nSub splitter()\n\nDim i As Long\nDim w As Long\n'Dim oWB As Workbook\nDim oWS As Worksheet\nDim oWS9 As Worksheet\nDim rngMOTOR As Range\nDim rngMOTOR2 As Range\nDim arrMOTOR() As Variant\nDim LastRow As Long\n\n'Set oWB = Workbooks(\"BRONBESTAND.xlsm\")\nSet oWS = Sheets(\"ONDERDELEN\")\nSet oWS9 = Sheets(\"MOTOR\")                                              '5 columns: 1 Short &amp; LONG + 1 NL + 3 Languages !!!!! WARNING\n\nLastRow = oWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow                                                                             'Starting below headers\n\n\n        Set rngMOTOR = oWS.Cells(i, \"M\")                                                                'MOTOR      ...\n        Set rngMOTOR2 = oWS9.Range(\"MOTOR\")                                                 'MOTOR2: MOTOR - Bronbestand       arrPOS = rngPOS2.Value\n\n        arrMOTOR = rngMOTOR2.Value\n\n\n'*********\nDim txt As String\nDim j As Integer\nDim Splitted As Variant\nDim arrMOTORall As Variant\nDim arrMOTORsplit As Variant\nDim Motor3 As String\n\ntxt = oWS.Cells(i, \"M\")                                                                'MOTOR      ...\n\n        Debug.Print (\"txt : \") &amp; i &amp; \": \"; txt\n\n    If Not IsEmpty(txt) Then\n\n        Splitted = Split(txt, \", \")\n        For j = 0 To UBound(Splitted)\n\n                Cells(1, j + 1).Value = Splitted(j)\n                        Debug.Print (\"                ---&gt; Splitted: \") &amp; Splitted(j)\n\n        '**** INSERT *****\n\n\n                For w = LBound(arrMOTOR) To UBound(arrMOTOR)\n                    If arrMOTOR(w, 1) = Splitted(j) Then                                                                    'EX: B - Benzine\n                            arrMOTORsplit = (arrMOTOR(w, 4))                                                               '(arrMOTOR(y, 2)) -&gt; 1=SHORT+LONG , 2=NL, 3=FR, 4=EN\n                                    Debug.Print (\"                ---&gt; arrMOTORsplit: \") &amp; i &amp; \": \" &amp; arrMOTORsplit\n\n        '**** JOIN ****\n                            arrMOTORall = Join(arrMOTORsplit, \", \")\n                                    Debug.Print (\"arrMOTORall: \") &amp; arrMOTORall\n\n\n                    End If\n                Next w\n        Next j\n    End If\n\n   Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1531302929, "post_id": 51282428, "comment_id": 89542255, "body": "And what isn&#39;t working? Are you using the right sheet and did you intend on using column A to find the last row?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1531303496, "last_edit_date": 1592644375, "creation_date": 1531303391, "answer_id": 51282643, "question_id": 51282428, "link": "https://stackoverflow.com/questions/51282428/set-lastrow-variable-as-3-lines-offset-from-the-last-occupied-row/51282643#51282643", "title": "Set lastrow variable as 3 lines offset from the last occupied row", "body": "<p>Four things.</p>\n<ol>\n<li><p>Ensure you are working with the expected workbook e.g. ThisWorkbook</p>\n</li>\n<li><p>Ensure ws2 is the sheet you intend to work with</p>\n</li>\n<li><p>Ensure column A is the column you want to use to find the last row</p>\n</li>\n<li><p>Check that the lastrow is &gt;= 4 before attempting to remove 3.</p>\n<p>Code for check:</p>\n<pre><code>lastRow1 = ws2.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row    \nlastRow1 = IIf(lastRow1 &lt; 4, 1, lastRow1 - 3)\n</code></pre>\n</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10064483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bee48670e045b115e1c0ac2805c0b4b?s=128&d=identicon&r=PG", "display_name": "Shamika", "link": "https://stackoverflow.com/users/10064483/shamika"}, "is_accepted": false, "score": 0, "last_activity_date": 1531308637, "last_edit_date": 1531308637, "creation_date": 1531307549, "answer_id": 51284047, "question_id": 51282428, "link": "https://stackoverflow.com/questions/51282428/set-lastrow-variable-as-3-lines-offset-from-the-last-occupied-row/51284047#51284047", "title": "Set lastrow variable as 3 lines offset from the last occupied row", "body": "<p>Try this:</p>\n\n<pre><code>    ThisWorkbook.Sheets(\"Name of your sheet\").Activate\n    Dim cnt As Integer, lastrow As Double\n    cnt = ActiveSheet.UsedRange.Rows.Count  'Counts no of rows\n    'Assuming that you want value in column A\n    lastrow = Range(\"A\" &amp; cnt-3).Value      \n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 51282643, "answer_count": 2, "score": 0, "last_activity_date": 1531308637, "creation_date": 1531302816, "last_edit_date": 1531303391, "question_id": 51282428, "link": "https://stackoverflow.com/questions/51282428/set-lastrow-variable-as-3-lines-offset-from-the-last-occupied-row", "title": "Set lastrow variable as 3 lines offset from the last occupied row", "body": "<p>I am trying to set the variable lastrow. I want the value of it to be 3 rows less than the last occupied row of my excel sheet. To be more clear, my current last occupied row is row 50. But I want the lastrow variable to be set as 47.\nMy code so far.</p>\n\n<pre><code>lastrow1 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 3\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531302511, "post_id": 51282223, "comment_id": 89542006, "body": "Why do you use VBA for that? I think that should be possible with a simple <code>=SUMIF()</code> formula."}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531307546, "post_id": 51282223, "comment_id": 89545264, "body": "because there are 32 types of fruits for me to scan from 39000 rows, in addition to over 50 worksheets that I have to clean, and I have to send the output to the 51th sheet.... so this is just a small part of that massive process. Yep I guess sumif should be good. Thanks for your suggestion"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1531302977, "creation_date": 1531302977, "answer_id": 51282495, "question_id": 51282223, "link": "https://stackoverflow.com/questions/51282223/use-vba-to-look-up-a-value-in-a-column-then-sum-up-the-value-in-the-adjacent-co/51282495#51282495", "title": "Use VBA to look up a value in a column, then sum up the value in the adjacent column", "body": "<p>You can do that with formulas only (no need for VBA).</p>\n\n<p>Assuming the data in your example where <code>Type</code> is column C and <code>No_of_unit_sold</code> is column D. You could use in column E:</p>\n\n<pre><code>=SUMIF(C:C,1,D:D)  'to sum all units of type 1\n=SUMIF(C:C,2,D:D)  'to sum all units of type 2\n\u2026\n=SUMIF(C:C,32,D:D) 'to sum all units of type 32\n</code></pre>\n\n<hr>\n\n<p>Or what I used in G in the example below is:</p>\n\n<pre><code>=SUMIF(C:C,F:F,D:D)\n</code></pre>\n\n<p><em>Note that you need to put the results into a new column, not in the same column as <code>No_of_unit_sold</code> because this would calculate wrong then.</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/Htpxe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Htpxe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 7731623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TCREW.jpg?s=128&g=1", "display_name": "Nandan A", "link": "https://stackoverflow.com/users/7731623/nandan-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1531303203, "creation_date": 1531303203, "answer_id": 51282581, "question_id": 51282223, "link": "https://stackoverflow.com/questions/51282223/use-vba-to-look-up-a-value-in-a-column-then-sum-up-the-value-in-the-adjacent-co/51282581#51282581", "title": "Use VBA to look up a value in a column, then sum up the value in the adjacent column", "body": "<p>Try this below code. Use <code>if</code> condition to check your criteria and then get the corresponding value from column D and add it to final <code>Total</code>.</p>\n\n<pre><code>Sub Typee()\n\nDim TotalType As Integer\nDim Total As Integer\nTotal = 0\n\nTotalType = Range(\"C2\").End(xlDown).Row\n\nFor i = 2 To TotalType\nIf Sheets(\"Sheet1\").Range(\"C\" &amp; i).Value = 1 Then\nTotal = Total + Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value\nEnd If\nNext\n\nMsgBox Total\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1531305311, "creation_date": 1531305311, "answer_id": 51283285, "question_id": 51282223, "link": "https://stackoverflow.com/questions/51282223/use-vba-to-look-up-a-value-in-a-column-then-sum-up-the-value-in-the-adjacent-co/51283285#51283285", "title": "Use VBA to look up a value in a column, then sum up the value in the adjacent column", "body": "<p>As @P\u1d07\u029c said, best solution would be a pure SUMIF. No need of VBA.</p>\n\n<p>In case you need to do it with VBA for any reasons, there is always an VBA version of each formula available in Excel if you use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-worksheetfunction-property-excel\" rel=\"nofollow noreferrer\">Application.WorksheetFunction Property</a>.</p>\n\n<p>For my code, I used <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.worksheetfunction.sumif.aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow noreferrer\">WorksheetFunction.SumIf method</a></p>\n\n<p>My code just pops up a Msgbox with the sum of <code>No_of_unit_sold</code> if <code>Type=1</code>.</p>\n\n<pre><code>Sub Macro1()\nDim LastRow As Long 'to save the last row number of column TYPE with data\n\nLastRow = Range(\"C\" &amp; Range(\"C:C\").Rows(Range(\"C:C\").Rows.Count).Row).End(xlUp).Row\n\nMsgBox Application.WorksheetFunction.SumIf(Range(\"C2:C\" &amp; LastRow), 1, Range(\"D2:D\" &amp; LastRow))\nEnd Sub\n</code></pre>\n\n<p>Adapt it tou your needs.</p>\n"}], "owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 51282495, "answer_count": 3, "score": 0, "last_activity_date": 1531305311, "creation_date": 1531302279, "last_edit_date": 1531303167, "question_id": 51282223, "link": "https://stackoverflow.com/questions/51282223/use-vba-to-look-up-a-value-in-a-column-then-sum-up-the-value-in-the-adjacent-co", "title": "Use VBA to look up a value in a column, then sum up the value in the adjacent column", "body": "<p>I have a table like this:</p>\n\n<pre><code> Name   Variation   Type    No_of_unit_sold\n\n Apple   FG72H       1         12\n Apple   FG72H       1         17\n Apple   FG72H       1         61\n Apple   FG73H       1          1\n Apple   FG74H       1          3\n Orange  OO20        1          3\n Orange  OO20        1          4\n Orange  OO20        1        117\n Orange  OO20        1          0\n Orange  OO20        1          4\n Orange  OO21        2         15\n Grape   G7TY        1         110\n Grape   G7TY        1          65\n Grape   G7TY        3          53\n Grape   G7TY        3          31\n Grape   G7TY        1          12\n Grape   G7TY        1          1\n</code></pre>\n\n<p>The actual table is about 39000 rows long.</p>\n\n<p>So I need to look for type <code>1</code> (there's 1 to 32) in column <code>Type</code> </p>\n\n<p>then sum up the corresponding <code>No_of_unit_sold</code> and place the result at the bottom row of <code>No_of_unit_sold</code>.</p>\n\n<pre><code>Worksheets(\"All Fruits\").Activate\n    Dim i As Integer\n    Dim rng As Range\n\n    Worksheets(name).Activate\n\n\n    lastrow = Range(\"C2\").End(xlDown).Row\n    For i = 1 to 32\n         Set rng = Range(\"D:D\").Find(what = i)\n\n         '???????????\n\n         Cells(lastrow, 5).Offset(1, 0).Select\n         Cells(lastrow, 5).Offset(1, 0) = \"=Sum(D2:D\" &amp; lastrow &amp; \")\"\n     Next i\n End Sub\n</code></pre>\n\n<p>I need suggestion at the <code>????</code> part.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531309373, "post_id": 51282054, "comment_id": 89546381, "body": "32 bit vs 64 bit versions of windows? This might cause a difference . Alternatively check version number of the XML parser"}, {"owner": {"reputation": 1, "user_id": 10063899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--toJcAe9D4o/AAAAAAAAAAI/AAAAAAAAHG4/S0I_liZBFQg/photo.jpg?sz=128", "display_name": "Thijs Nijpjes", "link": "https://stackoverflow.com/users/10063899/thijs-nijpjes"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531313924, "post_id": 51282054, "comment_id": 89549596, "body": "Good one. Didn&#39;t check. But both machines run 64bit of windows 7/10. Both Excel versions are 32bit and build version 16.0.8431.2270"}, {"owner": {"reputation": 1, "user_id": 10063899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--toJcAe9D4o/AAAAAAAAAAI/AAAAAAAAHG4/S0I_liZBFQg/photo.jpg?sz=128", "display_name": "Thijs Nijpjes", "link": "https://stackoverflow.com/users/10063899/thijs-nijpjes"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531314400, "post_id": 51282054, "comment_id": 89549968, "body": "The version number of the XML parser, do you mean the Microsoft XML, v6.0 or some other version information? Both machines use the same."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531317966, "post_id": 51282054, "comment_id": 89552740, "body": "A type mismatch suggests that one of your &quot;As&quot; statements is no longer a valid type. If they both use the same version of MSXML2 then it must be Byref log As logger?"}, {"owner": {"reputation": 1, "user_id": 10063899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--toJcAe9D4o/AAAAAAAAAAI/AAAAAAAAHG4/S0I_liZBFQg/photo.jpg?sz=128", "display_name": "Thijs Nijpjes", "link": "https://stackoverflow.com/users/10063899/thijs-nijpjes"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531321317, "post_id": 51282054, "comment_id": 89555311, "body": "@Harassed dad Thing is the logger isn&#39;t the issue. The debugger stops on the line :     Set GetDomNodeList = domdocument.childNodes The part where the logger is used I&#39;ve stripped out of the pasted code as the debugger didn&#39;t stumble on that part of the code. Only on the last line of the code it stops."}], "answers": [{"comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531741330, "post_id": 51307795, "comment_id": 89694038, "body": "Excel compiles to p-code behind the scenes. If something goes wrong with that then forcing a recompile (which is what your process did effectively) is the only way of sorting it. I suspect that was the problem"}], "tags": [], "owner": {"reputation": 1, "user_id": 10063899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--toJcAe9D4o/AAAAAAAAAAI/AAAAAAAAHG4/S0I_liZBFQg/photo.jpg?sz=128", "display_name": "Thijs Nijpjes", "link": "https://stackoverflow.com/users/10063899/thijs-nijpjes"}, "is_accepted": false, "score": 0, "last_activity_date": 1531407368, "last_edit_date": 1531407368, "creation_date": 1531404498, "answer_id": 51307795, "question_id": 51282054, "link": "https://stackoverflow.com/questions/51282054/vba-office-2016-windows7-10-difference-set-ixmldomnodelist-domdocument60-chil/51307795#51307795", "title": "VBA office 2016 windows7/10 difference: Set IXMLDOMNodeList = DOMDocument60.childNodes", "body": "<p>After a lot of trials I found a solution. Export the class, remove it and import the class again and all magically works again. I'm baffled by this. </p>\n"}], "owner": {"reputation": 1, "user_id": 10063899, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--toJcAe9D4o/AAAAAAAAAAI/AAAAAAAAHG4/S0I_liZBFQg/photo.jpg?sz=128", "display_name": "Thijs Nijpjes", "link": "https://stackoverflow.com/users/10063899/thijs-nijpjes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531407368, "creation_date": 1531301754, "last_edit_date": 1531314992, "question_id": 51282054, "link": "https://stackoverflow.com/questions/51282054/vba-office-2016-windows7-10-difference-set-ixmldomnodelist-domdocument60-chil", "title": "VBA office 2016 windows7/10 difference: Set IXMLDOMNodeList = DOMDocument60.childNodes", "body": "<p>I've got an issue with a piece of VBA code that runs fine on a windows 7 machine, but doesn't work on windows 10. My VBA skills aren't good enough to figure this one out. </p>\n\n<p>This part of the code in run in a Excel class and is used to load a <code>xml</code> file and return the <code>xml</code> as a class.</p>\n\n<pre><code>Public Function GetDomNodeList(ByRef log As Logger) As MSXML2.IXMLDOMNodeList\nDim domdocument As New MSXML2.DOMDocument60\n\n'Open file for handling\ndomdocument.async = False\ndomdocument.Load (strThisFilePath)\n\n'Call the helper sub to do the actual work:\nSet GetDomNodeList = domdocument.childNodes\nEnd Function\n</code></pre>\n\n<p>When debugging it tells me there is a type mismatch. I've tried to debug the issue, but I'm running short on knowledge here. My main question is why this works on windows 7 and why not on windows 10 running the same office version (2016) VBA7.1</p>\n"}, {"tags": ["sql", "vba", "sharepoint", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1531600613, "post_id": 51332076, "comment_id": 89659691, "body": "Hey @ryguy72, thanks for very comprehensive answer! I&#39;ve already resolved this with C# (it loads data in ~4 seconds instead of 1,5minute when using VBA), but I will mark your answer as correct, because for sure it is also a good way to deal with this problem."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1531511904, "creation_date": 1531511904, "answer_id": 51332076, "question_id": 51282004, "link": "https://stackoverflow.com/questions/51282004/inserting-data-into-sharepoint-table-using-outlook-vba-how-to-speed-up-the-proc/51332076#51332076", "title": "Inserting data into SharePoint Table using Outlook VBA (how to speed up the process?)", "body": "<p>Well, VBA is inherently slow.  Maybe you can just import everything from Outlook to Access/Excel, and then source your SharePoint data from Access/Excel.  </p>\n\n<p>On the site where you want to add a spreadsheet based list, go to Settings Office 365 Settings button and then click Add an app.</p>\n\n<p>In the Find an app field, type spreadsheet and then click the search icon Search box magnifying glass icon .\nfind an app field with Spreadsheet typed in and search button highlighted</p>\n\n<p>In the search results page, click Import Spreadsheet.\nImport spreadsheet app highlighted in New apps dialog</p>\n\n<p>In the New app page, type a Name for the list.</p>\n\n<p>The name appears at the top of the list in most views, becomes part of the web address for the list page, and appears in site navigation to help users find the list. You can change the name of a list, but the web address will remain the same.\nNew app dialog with name and file location filled in, import highlighted</p>\n\n<p>Type an optional Description.</p>\n\n<p>The description appears underneath the name in most views. You can change the description for a list at any time using list settings.</p>\n\n<p>Browse to or type the File location of the spreadsheet. Click Import when done.</p>\n\n<p>The spreadsheet will open in Excel, and you'll see the Import to Windows SharePoint Services List window.</p>\n\n<p>In the Import to Windows SharePoint Services List window, choose Table Range, Range of Cells, or Named Range. If you want to select a range manually, choose Range of Cells, and then click Select Range. In the spreadsheet, click the upper left cell, hold down the Shift key, and select the lower right cell of the range you want.\nExcel spreadsheet with range highlighted</p>\n\n<p>The range will appear in the Select Range field. Click Import.\nImport to spreadsheet dialog with Import highlighted</p>\n\n<p>After you import a spreadsheet, check the columns of the list to make sure that the data was imported as you expected. For example, you may want to specify that a column contains currency instead of a number. To view or change list settings, open the list, click the List tab or click Settings Office 365 Settings button , and then click List Settings.</p>\n\n<p>The spreadsheet data will appear in a list in SharePoint.\nList in SharePoint Online</p>\n\n<p>See the links below for more info.</p>\n\n<p><a href=\"http://3sharp.com/blog/load-excel-data-into-a-sharepoint-2013-list-fast-and-easy/\" rel=\"nofollow noreferrer\">http://3sharp.com/blog/load-excel-data-into-a-sharepoint-2013-list-fast-and-easy/</a></p>\n\n<p><a href=\"https://technet.microsoft.com/en-us/library/2008.04.access.aspx\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/en-us/library/2008.04.access.aspx</a></p>\n"}], "owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 51332076, "answer_count": 1, "score": 0, "last_activity_date": 1592950067, "creation_date": 1531301585, "last_edit_date": 1592950067, "question_id": 51282004, "link": "https://stackoverflow.com/questions/51282004/inserting-data-into-sharepoint-table-using-outlook-vba-how-to-speed-up-the-proc", "title": "Inserting data into SharePoint Table using Outlook VBA (how to speed up the process?)", "body": "<p>I've wrote a macro that takes some data from e-mail body and then instert this data into SharePoint Table.\nScrapping the e-mail body works fine, as well as inserting data to SharePoint - but the inserting part takes a long time (about 2 minutes for each execute).</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Public Const sDEMAND_ROLE_GUID As String = \"{111111111-2222-3333-4444-111111111111}\"\nPublic Const sSHAREPOINT_SITE As String = \"https://randomsharepoint.com/sites/test/\"\n\nSub insertIntoSharePoint()\nDim cn      As ADODB.Connection\nDim sConn   As String\nDim sSQL    As String\n\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;\" &amp; _\n\"DATABASE=\" &amp; sSHAREPOINT_SITE &amp; \";\" &amp; _\n\"List=\" &amp; sDEMAND_ROLE_GUID &amp; \";\"\n\nSet cn = New ADODB.Connection\n\nsSQL = \"INSERT INTO [TEST TABLE]([Test1], [Test2], [Test3], [Test4], [Test5], [Test6], [Test7], [Test8], [Test9], [Test10], [Test11])\" &amp; _\n        \"VALUES ('TestVal1', 'TestVal2','TestVal3','TestVal4','TestVal5','TestVal6','TestVal7','TestVal8','TestVal9','TestVal10','TestVal11');\"\n\nWith cn\n    .ConnectionString = sConn\n    .Open\n    .Execute sSQL 'This is the line that takes most of the runtime'\n    .Close\nEnd With\n\nSet cn = Nothing\nMsgBox \"Item successfully added to SharePoint\"\nEnd Sub\n</code></pre>\n\n<p>Is there any way to optimize this code?\nOr the slow execution depends only on internet connection/weak computer?\nOr do you have any other solution to solve the main problem? (scrapping e-mail body and inserting it into SharePoint List)</p>\n"}, {"tags": [".net", "vba", "vb.net", "ms-access", "windows-update"], "comments": [{"owner": {"reputation": 183, "user_id": 5840752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a570ac2886630fdec37ea48e54367e?s=128&d=identicon&r=PG&f=1", "display_name": "Volker Fried", "link": "https://stackoverflow.com/users/5840752/volker-fried"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531302623, "post_id": 51281730, "comment_id": 89542084, "body": "We have the problem with many customers. Currently over 40 machines. Currently only on Windows 7 SP1 64-bit systems. Windows 7 32-bit systems are not affected."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531303230, "post_id": 51281730, "comment_id": 89542435, "body": "I had a number of Windows Update errors while installing that update... Gonna reboot momentarily.  (I&#39;m also Win7)"}, {"owner": {"reputation": 916, "user_id": 2458080, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/72861ae9bc11f9494cb4842490a2921a?s=128&d=identicon&r=PG", "display_name": "user2458080", "link": "https://stackoverflow.com/users/2458080/user2458080"}, "edited": false, "score": 0, "creation_date": 1531321135, "post_id": 51281730, "comment_id": 89555183, "body": "We are experiencing the same issue on Windows Server 2012 R2. The relevant Windows update for 2012 R2 is KB4340558 when you&#39;re looking at the update history and KB4338424 when you&#39;re looking at installed updates. When we uninstall the update, the error disappears. Despite my best efforts, I was unable to find an alternate solution to uninstalling. We would also prefer a better solution."}, {"owner": {"reputation": 906, "user_id": 2907389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ef30967241098964c84c5e3d8c7b0de?s=128&d=identicon&r=PG&f=1", "display_name": "Nickolai Nielsen", "link": "https://stackoverflow.com/users/2907389/nickolai-nielsen"}, "edited": false, "score": 0, "creation_date": 1531397618, "post_id": 51281730, "comment_id": 89587340, "body": "I am seen this on Windows 10 x64, &quot;429: ActiveX component can&#39;t create object&quot;, uninstalling KB4338819 solves the problem. On Windows 7 x64 we are having problems with KB4338420"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 1, "creation_date": 1531411952, "post_id": 51281730, "comment_id": 89597170, "body": "Related to <a href=\"https://stackoverflow.com/questions/51289285/how-do-i-properly-instantiate-32-bit-com-objects-in-classic-asp-after-installing\" title=\"how do i properly instantiate 32 bit com objects in classic asp after installing\">stackoverflow.com/questions/51289285/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531323844, "post_id": 51288983, "comment_id": 89556894, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/app-domains/enhanced-strong-naming\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/app-domains/&hellip;</a>"}, {"owner": {"reputation": 916, "user_id": 2458080, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/72861ae9bc11f9494cb4842490a2921a?s=128&d=identicon&r=PG", "display_name": "user2458080", "link": "https://stackoverflow.com/users/2458080/user2458080"}, "edited": false, "score": 0, "creation_date": 1531335987, "post_id": 51288983, "comment_id": 89562839, "body": "Which version of Visual Studio? Are you using a key generated by VS (e.g. untrusted root)? Can you tell if the certificate is SHA1 or SHA256?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531338412, "post_id": 51288983, "comment_id": 89563922, "body": "As an alternative, don&#39;t strong-name your assembly. As noted in the link that @HansPassant referred to, it&#39;s not meant to be used as a security mechanism. When we consider that only one version of the library can be loaded at a time in context of COM, the only good use case for strong names goes out of the window."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531343074, "post_id": 51288983, "comment_id": 89565788, "body": "It is important for [ComVisible] assemblies, they belong in the GAC on the user&#39;s machine to solve DLL Hell."}, {"owner": {"reputation": 916, "user_id": 2458080, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/72861ae9bc11f9494cb4842490a2921a?s=128&d=identicon&r=PG", "display_name": "user2458080", "link": "https://stackoverflow.com/users/2458080/user2458080"}, "edited": false, "score": 0, "creation_date": 1531343512, "post_id": 51288983, "comment_id": 89565941, "body": "Understood. Installing an unsigned version of the library still gives the same error. I&#39;m truly puzzled."}, {"owner": {"reputation": 183, "user_id": 5840752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a570ac2886630fdec37ea48e54367e?s=128&d=identicon&r=PG&f=1", "display_name": "Volker Fried", "link": "https://stackoverflow.com/users/5840752/volker-fried"}, "edited": false, "score": 0, "creation_date": 1532607635, "post_id": 51288983, "comment_id": 90044888, "body": "The signature was first created with Visual Studio 2010. Project is today a Visual Studio 2017 project and the new working signature was created with Visual Studio 2017."}], "tags": [], "owner": {"reputation": 183, "user_id": 5840752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a570ac2886630fdec37ea48e54367e?s=128&d=identicon&r=PG&f=1", "display_name": "Volker Fried", "link": "https://stackoverflow.com/users/5840752/volker-fried"}, "is_accepted": false, "score": 5, "last_activity_date": 1532607755, "last_edit_date": 1532607755, "creation_date": 1531322021, "answer_id": 51288983, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51288983#51288983", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>Our Interop .Net Assembly had a signature with a strong name. The signing is apparently no longer accepted. Creating a new signature (* .snk file) in Visual Studio causes the CreateObject ComInterop call to work again.</p>\n\n<p><strong>EDIT 26.07.2018</strong></p>\n\n<p>We enabled User Account Control (UAC) on the machines from our customers like Pao'lino described. </p>\n\n<p>Creating a new signature also create a new public key token for the assembly. This causes reference problems.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 1660535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e860fbaa1f00579aca72bfb8ca96ec14?s=128&d=identicon&r=PG", "display_name": "Pao&#39;lino", "link": "https://stackoverflow.com/users/1660535/paolino"}, "edited": false, "score": 0, "creation_date": 1531388022, "post_id": 51300859, "comment_id": 89580930, "body": "What is the downvote for?  Just bringing my experience, this way we fixed many PCs."}], "tags": [], "owner": {"reputation": 49, "user_id": 1660535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e860fbaa1f00579aca72bfb8ca96ec14?s=128&d=identicon&r=PG", "display_name": "Pao&#39;lino", "link": "https://stackoverflow.com/users/1660535/paolino"}, "is_accepted": false, "score": 2, "last_activity_date": 1531901433, "last_edit_date": 1531901433, "creation_date": 1531384502, "answer_id": 51300859, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51300859#51300859", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>Enabling UAC and setting it to default level fixed the issue for us.</p>\n\n<p>Our scenario is .NET assemblies exposed to COM and a VB6 application instancing this .NET objects with CreateObject.</p>\n\n<p>Update.. The UAC trick doesn't work on Windows Server 2012 R2.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10069558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84af47ef4a08ddd057a5afe02f3c1531?s=128&d=identicon&r=PG", "display_name": "Jeff Wilson", "link": "https://stackoverflow.com/users/10069558/jeff-wilson"}, "is_accepted": false, "score": 3, "last_activity_date": 1531386447, "creation_date": 1531386447, "answer_id": 51301502, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51301502#51301502", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>We are experiencing problems as well. We found that it was actually one of the embedded updates inside of KB4340556 - KB4338420 that was causing our the problem.</p>\n\n<p>We have an APP that uses COM object as a hook between itself and MS Office. Installing this update removed the COM object causing the required mscoree.dll not to load.\nOnly seeing the problem on 64bit Win7 with 64Bit Office products installed.</p>\n\n<p>I have posted to the developer community at visualstudio.com (<a href=\"https://developercommunity.visualstudio.com/content/problem/291884/july-2018-cumlative-security-and-quality-update-kb.html\" rel=\"nofollow noreferrer\">https://developercommunity.visualstudio.com/content/problem/291884/july-2018-cumlative-security-and-quality-update-kb.html</a>) in their .NET forum. The problem is under Triage at the moment.\nRemoving KB4338420 fixes the problem temporarily, but then the next time your system checks for updates, it thinks KB4340556 is not installed and wants to re-install it. Only work around for now is to hide the update, since it is only KB4338420 that is missing. </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10065201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c2c02129caccf0aa7335be38dfe7ca?s=128&d=identicon&r=PG&f=1", "display_name": "TB DTC", "link": "https://stackoverflow.com/users/10065201/tb-dtc"}, "is_accepted": false, "score": 1, "last_activity_date": 1531392161, "creation_date": 1531392161, "answer_id": 51303578, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51303578#51303578", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>To corroborate what other users here have said. We are also having problems following KB4340556. The following code</p>\n\n<p><code>Set myObject = CreateObject(\"System.Collections.ArrayList\")</code></p>\n\n<p>causes a 'Permission Denied' error when creating a .NET component within classic ASP running on IIS and Server 2008r2 64bit.</p>\n\n<p>The same code run in a .vbs file (in 32 bit) works fine.</p>\n\n<p>Specifying a different version of .NET in the application pool has no effect.</p>\n"}, {"comments": [{"owner": {"reputation": 436, "user_id": 259548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691484590e7060d09b9acaee793d8abf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/259548/matt"}, "edited": false, "score": 0, "creation_date": 1531403493, "post_id": 51304556, "comment_id": 89591517, "body": "Thanks. Woke up this morning to the problem. This &#39;fixed&#39; it for me"}, {"owner": {"reputation": 1076, "user_id": 1271691, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/15f4d85a1b7112fa7add72272ca8dc67?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1271691/jonathan"}, "edited": false, "score": 0, "creation_date": 1531746173, "post_id": 51304556, "comment_id": 89697094, "body": "This is the answer that solved it. I had the same problem since the windows security update last week (had a &quot;permission denied&quot; on object creation however). I was a bit desperate to have to rewrite all the code using .net dll with com. Thank you so much"}, {"owner": {"reputation": 372, "user_id": 418970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bd64133069f23ae091c12a81d237a?s=128&d=identicon&r=PG", "display_name": "piotrbrzuska", "link": "https://stackoverflow.com/users/418970/piotrbrzuska"}, "edited": false, "score": 0, "creation_date": 1531829910, "post_id": 51304556, "comment_id": 89734042, "body": "Ok it works on anonymous authentication, but I can&#39;t do this on windows authentication."}], "tags": [], "owner": {"reputation": 709, "user_id": 1133343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBxGl.jpg?s=128&g=1", "display_name": "keydon", "link": "https://stackoverflow.com/users/1133343/keydon"}, "is_accepted": false, "score": 6, "last_activity_date": 1531395777, "last_edit_date": 1531395777, "creation_date": 1531395087, "answer_id": 51304556, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51304556#51304556", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>We were affected with multiple customers too.</p>\n\n<p>I ruled out invalid strong-name signing of our assemblies, since the .NET Assemblies from the Framework itself were affected by that access-denied error too.</p>\n\n<p>Finally I managed to solve the issue by configuration.\nApparently the authenticating identity of the website has now to match the identity of the app-pool. Or IUSR has no longer enough permissions.\n<a href=\"https://i.stack.imgur.com/QgojV.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/QgojV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10104978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VW8p4.jpg?s=128&g=1", "display_name": "Tom L", "link": "https://stackoverflow.com/users/10104978/tom-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1533010699, "creation_date": 1533010699, "answer_id": 51605389, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject/51605389#51605389", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>Microsoft released a fix on 7/30. See the following KB <a href=\"https://support.microsoft.com/en-gb/help/4345913/access-denied-errors-after-installing-july-2018-security-rollup-update\" rel=\"nofollow noreferrer\">\"Access Denied\" errors and applications with COM activation fail after installing July 2018 Security and Quality Rollup updates for .NET Framework</a>.</p>\n"}], "owner": {"reputation": 183, "user_id": 5840752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a570ac2886630fdec37ea48e54367e?s=128&d=identicon&r=PG&f=1", "display_name": "Volker Fried", "link": "https://stackoverflow.com/users/5840752/volker-fried"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5531, "favorite_count": 6, "protected_date": 1531991836, "answer_count": 6, "score": 10, "last_activity_date": 1594631512, "creation_date": 1531300783, "last_edit_date": 1594631512, "question_id": 51281730, "link": "https://stackoverflow.com/questions/51281730/since-windows-update-kb4340556-vba-com-net-automation-error-on-createobject", "title": "Since Windows Update kb4340556: VBA COM .NET Automation error on CreateObject()", "body": "<p>Since the update <a href=\"https://support.microsoft.com/en-us/help/4340556/security-and-quality-rollup-updates-for-net-framework-3-5-1-4-5-2-4-6\" rel=\"noreferrer\">Windows7 Update KB 4340556</a> of the Jul 10, 2018 we get the following error message:</p>\n\n<blockquote>\n  <p><strong><code>\"Automation Error\"</code></strong> : \n  <em><code>The system cannot find the file specified\" from the Access VBA CreateObject() call.</code></em></p>\n</blockquote>\n\n<pre><code> Set ComClass = CreateObject(\"MyApplication1.InteropStart\")\n</code></pre>\n\n<p>Microsoft identifies this as a security issue.</p>\n\n<p>If we <strong>uninstall</strong> the update KB4340556, the call will work as before.</p>\n\n<p>Does anyone have the same problem? Or a better solution than the update to uninstall?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531309112, "post_id": 51281505, "comment_id": 89546190, "body": "Your code has several problems. Selection doesn&#39;t (normally) take a . in front. The range A2 of a selection is NOT the same as the cell A2. The selection in the second line seems to be referring to the selection in Word not Excel - you need to distinguish them."}, {"owner": {"reputation": 5, "user_id": 9254645, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9anUFRRxLbs/AAAAAAAAAAI/AAAAAAAADPA/GP-eHr8PZuc/photo.jpg?sz=128", "display_name": "Prady Pradeep", "link": "https://stackoverflow.com/users/9254645/prady-pradeep"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531325773, "post_id": 51281505, "comment_id": 89557935, "body": "Hi. Thanks for the response. Pleas find the below my code below. i want this code to be executed for all the value in column A using loop. please help"}, {"owner": {"reputation": 5, "user_id": 9254645, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9anUFRRxLbs/AAAAAAAAAAI/AAAAAAAADPA/GP-eHr8PZuc/photo.jpg?sz=128", "display_name": "Prady Pradeep", "link": "https://stackoverflow.com/users/9254645/prady-pradeep"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1531327141, "post_id": 51281505, "comment_id": 89558665, "body": "&#39;Documents.Add &quot;C:\\Users\\Desktop\\Temp.dotx&quot;          Range(&quot;F2&quot;).Copy         .Selection.Goto What:=wdGoToBookmark, Name:=&quot;Dateloc&quot;         .Selection.PasteSpecial                   Range(&quot;B2&quot;).Copy         .Selection.Goto What:=wdGoToBookmark, Name:=&quot;Nameloc&quot;         .Selection.PasteSpecial                  Range(&quot;e2&quot;).Copy         .Selection.Goto What:=wdGoToBookmark, Name:=&quot;Addloc&quot;         .Selection.PasteSpecial&#39;"}], "owner": {"reputation": 5, "user_id": 9254645, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9anUFRRxLbs/AAAAAAAAAAI/AAAAAAAADPA/GP-eHr8PZuc/photo.jpg?sz=128", "display_name": "Prady Pradeep", "link": "https://stackoverflow.com/users/9254645/prady-pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594030746, "creation_date": 1531300127, "last_edit_date": 1594030746, "question_id": 51281505, "link": "https://stackoverflow.com/questions/51281505/vba-to-create-word-template-from-excel-data", "title": "VBA to create word template from excel data", "body": "<p>I have Excel VBA which will open the pre defined word template and will map the Name, address and other information based on bookmarks. I have macro which is currently does for the data in column A2. I want to insert loop so that I can pick and run automatically for all the Names in column A. Please advice how to use loop function.</p>\n<pre><code>.Selection.range(\u201cA2\u201d).copy\n.selection Go to what:= -1, name:=\u201cNamelocation\u201d\n.Selection.pastespecial\n</code></pre>\n<p>This code goes on with diff range and bookmark location</p>\n"}, {"tags": ["vba", "excel", "import-from-excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1531300060, "creation_date": 1531300060, "answer_id": 51281487, "question_id": 51281336, "link": "https://stackoverflow.com/questions/51281336/transfer-spreadsheet-to-access-database-with-vba/51281487#51281487", "title": "Transfer Spreadsheet to Access Database with VBA", "body": "<p>Instead of:  <code>Me.Text5 = fileName</code></p>\n\n<p>write:\n<code>fileName = Me.Text5</code></p>\n\n<p>In many programming languages the left variable gets the value of the right one. </p>\n"}], "owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 51281487, "answer_count": 1, "score": 1, "last_activity_date": 1531301742, "creation_date": 1531299638, "last_edit_date": 1531301742, "question_id": 51281336, "link": "https://stackoverflow.com/questions/51281336/transfer-spreadsheet-to-access-database-with-vba", "title": "Transfer Spreadsheet to Access Database with VBA", "body": "<p>I have a browse button and pick and place the file name and path in textbox5. I need to use the same value in my file name but it does not work. It throws:</p>\n\n<blockquote>\n  <p>Run Time Error 2522- The action or method requires a File Name argument</p>\n</blockquote>\n\n<pre><code>Private Sub Command10_Click()\n  Dim dbs As DAO.Database\n  Dim td As DAO.TableDef\n  Dim fileName As String\n\n'set current database\n Set dbs = CurrentDb\n\n Me.Text5 = fileName\n\nDoCmd.TransferSpreadsheet acImport, , \"tblS3DimportTemp\", fileName, True\n MsgBox \"Data Uploaded!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531298196, "post_id": 51280760, "comment_id": 89538988, "body": "Can you try only <code>Shell &quot;C:\\Users\\DGMS\\AppData\\Local\\Continuum\\anaconda2\\python.exe&quot;</code>"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531298625, "post_id": 51280760, "comment_id": 89539259, "body": "@Vityata Nothing appears to happen."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531298744, "post_id": 51280760, "comment_id": 89539331, "body": "True, I missed the <code>cmd.exe</code> part. See the answer."}], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531298875, "post_id": 51281018, "comment_id": 89539419, "body": "the cmd opened now, but how can I reference the specific python script?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531299007, "post_id": 51281018, "comment_id": 89539511, "body": "@DGMS89 - by writing its path."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531299416, "post_id": 51281018, "comment_id": 89539798, "body": "Your answer works if the script and the .exe are in the same folder, but I cant get it to work in different folders. I am using:  Shell &quot;cmd.exe /S /c &quot; &amp; &quot;C:\\Users\\DGMS\\AppData\\Local\\Continuum\\anaconda2\\python.exe&quot; &amp; &quot;\\\\Network\\structured\\Uploader_v2.py&quot; but nothng seems to happen. Is there a way to fix this?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531299700, "post_id": 51281018, "comment_id": 89540006, "body": "@DGMS89 - Can you try <code>Shell &quot;cmd.exe &#47;S &#47;c &quot; &amp; &quot;\\\\Network\\structured\\Uploader_v2.py&quot;</code> Although, I am not sure how many versions of Python do you have. I usually work with one."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531299989, "post_id": 51281018, "comment_id": 89540182, "body": "Nothing seems to happen. I am also trying it with all of the python script commented out, except for &quot;selectmonth = raw_input(&quot;Please enter month (&#39;January&#39;, &#39;February&#39;...:&quot;)&quot;, still nothing happens."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1531300185, "post_id": 51281018, "comment_id": 89540312, "body": "@DGMS89 - make the Python code really simple. E.g. simply write <code>print &#39;Something&#39;</code> to see whether it gets printed."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531300438, "post_id": 51281018, "comment_id": 89540517, "body": "Same result, I am trying all the simplest code variations I can think of, to no avail. It appears to open the cmd, but close it instantly after."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531300527, "post_id": 51281018, "comment_id": 89540594, "body": "@DGMS89 - so the problem is that the cmd gets closed? Then write something for input, it thus it would wait - <a href=\"https://stackoverflow.com/questions/70797/python-user-input-and-commandline-arguments\" title=\"python user input and commandline arguments\">stackoverflow.com/questions/70797/&hellip;</a>"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531300876, "post_id": 51281018, "comment_id": 89540831, "body": "Just tried that, it appears that the cmd part of your command is working, but it does not read the .py file for some reason."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531300938, "post_id": 51281018, "comment_id": 89540876, "body": "@DGMS89 - try to put the <code>.py</code> file on your PC, not on a server and give it a try."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531301283, "post_id": 51281018, "comment_id": 89541122, "body": "Same result. It only worked when I hat both the .exe and the .py in the same folder."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531301457, "post_id": 51281018, "comment_id": 89541255, "body": "@DGMS89 - You need &quot;Environment variables&quot; and &quot;Add Python exe to path&quot;. Read this, it would help you - <a href=\"https://www.howtogeek.com/197947/how-to-install-python-on-windows/\" rel=\"nofollow noreferrer\">howtogeek.com/197947/how-to-install-python-on-windows</a>"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531307441, "post_id": 51281018, "comment_id": 89545195, "body": "I completely reinstalled python and all libraries in my PC. The result is the same, this is indeed very weird."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1531309815, "post_id": 51281018, "comment_id": 89546712, "body": "@DGMS89 - you have to <b>add Python exe to path</b>. Read that article."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1531309863, "last_edit_date": 1531309863, "creation_date": 1531298719, "answer_id": 51281018, "question_id": 51280760, "link": "https://stackoverflow.com/questions/51280760/running-python-script-from-vba-with-network-paths/51281018#51281018", "title": "Running Python script from vba with network paths", "body": "<p>The way that I am using:</p>\n\n<p><code>Shell \"cmd.exe /S /c \" &amp; \"C:\\somePath\\Uploader_v2.py\"</code></p>\n\n<p>This is some code sample, that I have built some time ago:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim path As String: path = \"C:\\Python\\\"\n    Dim pathExe As String\n    Dim i As Long\n    Dim txtStream As TextStream        'Library - Microsoft Scripting Runtime\n    Dim fso As New FileSystemObject    'Library - Microsoft Scripting Runtime\n    Dim fileName As String\n\n    Columns(\"C:D\").Clear\n    For i = 1 To 8\n\n        fileName = \"file\" &amp; i &amp; \".txt\"\n        pathExe = path &amp; \"CodeForces.py\" &amp; \" \"\"\" &amp; Cells(i, 1) &amp; \"\"\" &gt;\" &amp; path &amp; fileName\n        Shell \"cmd.exe /S /c \" &amp; pathExe\n\n        Application.Wait Now + #12:00:01 AM#\n        Set txtStream = fso.OpenTextFile(path &amp; fileName)\n        Cells(i, 3) = txtStream.ReadLine\n        txtStream.Close\n        'Kill path &amp; fileName\n\n        If Cells(i, 3) = Cells(i, 2) Then Cells(i, 4) = \"Pass...\"\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>It runs a Python exe in <code>C:\\Python\\CodeForces.py</code> and the result from it is exported to a notepad.</p>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 1, "accepted_answer_id": 51281018, "answer_count": 1, "score": 2, "last_activity_date": 1531309863, "creation_date": 1531297890, "question_id": 51280760, "link": "https://stackoverflow.com/questions/51280760/running-python-script-from-vba-with-network-paths", "title": "Running Python script from vba with network paths", "body": "<p><strong>Scenario:</strong> I have a simple VBA code that should run a python script.</p>\n\n<p><strong>Problem:</strong> For some reason, this code (which is a direct variation of what I found here: <a href=\"https://stackoverflow.com/questions/18135551/how-to-call-python-script-on-excel-vba\">How to call python script on excel vba?</a> ) does not appear to work. It runs the VBA part to completion but does not perform any of the functions of the python script.</p>\n\n<p><strong>VBA code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n    Dim args As String\n    Dim Ret_Val\n\n    args = \"\\\\Network\\structured\\Uploader_v2.py\"\n    Ret_Val = Shell(\"C:\\Users\\DGMS\\AppData\\Local\\Continuum\\anaconda2\\python.exe\" &amp; \" \" &amp; args, vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Python code:</strong></p>\n\n<pre><code>import pandas as pd\nimport datetime\nimport os\nimport Tkinter\nfrom Tkinter import Tk\nfrom tkFileDialog import askdirectory\nfrom Tkinter import filedialog\nfrom os import listdir\nfrom os.path import isfile, join\nimport glob\n\n# Get input and output paths\nTk().withdraw() \nsourcefolder =  askdirectory()\noutputfolder = askdirectory()\nselectmonth = raw_input(\"Please enter month ('January', 'February'...:\")\n\n# Get content\nall_files = glob.glob(os.path.join(sourcefolder, \"*.xls*\"))\ncontentdataframes = []\ncontentdataframes2 = []\n\nfor f in all_files:\n    df = pd.read_excel(f)\n    df['Name'] = os.path.basename(f).split('.')[0].split('_')[0]\n    mask = df.columns.str.contains('Base')\n    c2 = df.columns[~mask].tolist()\n    df = df[c2]\n    contentdataframes.append(df)\n\nconcatenatedfinal = pd.concat(contentdataframes)\n\nconcatenatedfinal .to_excel(outputfolder + \"/\" + selectmonth + \"_Upload.xlsx\",index=False)\n</code></pre>\n\n<p><strong>Obs:</strong> My python code basically gets some path inputs as from the user (filedialog) then gets some data and saves to another file.</p>\n\n<p><strong>Question:</strong> Considering that the python code works when run on its own, what may be the reason for it not the be run properly from excel? Is there a way to fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531299844, "post_id": 51280756, "comment_id": 89540085, "body": "Please note that <code>Dim xRow, xCol As Integer</code> only defines <code>xCol As Integer</code> but <code>xRow As Variant</code> if no type is specified. You need to specify a type for <b>every</b> variable: <code>Dim xRow As Long, xCol As Integer</code>. Also note that Excel has more rows than <code>Integer</code> can handle and you must use <code>Long</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5756958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1329873bc7fa2e57d1ed047ceaa82654?s=128&d=identicon&r=PG&f=1", "display_name": "Khaledtaj8", "link": "https://stackoverflow.com/users/5756958/khaledtaj8"}, "edited": false, "score": 0, "creation_date": 1531299387, "post_id": 51280965, "comment_id": 89539779, "body": "I have tried to use (date(), Now()) but still the cells at column D are not effected at all. the question is how to make VBA deal with data that is generated from a formula. i am not sure, but the code is working fine in cells that have to formulas."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 55, "user_id": 5756958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1329873bc7fa2e57d1ed047ceaa82654?s=128&d=identicon&r=PG&f=1", "display_name": "Khaledtaj8", "link": "https://stackoverflow.com/users/5756958/khaledtaj8"}, "edited": false, "score": 0, "creation_date": 1531299445, "post_id": 51280965, "comment_id": 89539826, "body": "Isn&#39;t that because of your <code>Target.Text &lt;&gt; &quot;&quot;</code> condition as my edit suggested?"}, {"owner": {"reputation": 55, "user_id": 5756958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1329873bc7fa2e57d1ed047ceaa82654?s=128&d=identicon&r=PG&f=1", "display_name": "Khaledtaj8", "link": "https://stackoverflow.com/users/5756958/khaledtaj8"}, "edited": false, "score": 0, "creation_date": 1531299729, "post_id": 51280965, "comment_id": 89540027, "body": "i have tried it, still nothing is showing up in col.D."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 55, "user_id": 5756958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1329873bc7fa2e57d1ed047ceaa82654?s=128&d=identicon&r=PG&f=1", "display_name": "Khaledtaj8", "link": "https://stackoverflow.com/users/5756958/khaledtaj8"}, "edited": false, "score": 0, "creation_date": 1531301506, "post_id": 51280965, "comment_id": 89541280, "body": "@Khaledtaj8 check my edit (again). Tested it myself and it works"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1531301471, "last_edit_date": 1531301471, "creation_date": 1531298532, "answer_id": 51280965, "question_id": 51280756, "link": "https://stackoverflow.com/questions/51280756/auto-insert-todays-date-based-on-another-cell-that-is-filled-via-formula/51280965#51280965", "title": "Auto insert today&#39;s date based on another cell that is filled via formula", "body": "<p>According to MDN documentation of <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\"><code>Format()</code></a> function:</p>\n\n<blockquote>\n  <p>Description Returns a Variant (String) containing an expression\n  formatted according to instructions contained in a format expression.\n  SyntaxFormat(expression [ ,format [ ,firstdayofweek [ ,firstweekofyear\n  ]]] ) </p>\n</blockquote>\n\n<p>This is not what you're trying to achieve, but fret not, Excel already has an inbuilt function to return the current date - it's name is pretty intuitive as well - <code>date()</code> if you want date. If you also wanna track time, use <code>now()</code> instead</p>\n\n<p>Tested and works:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Range(Cells(1, 2), Cells(Rows.Count, 2)), Target) Is Nothing Then\n\n                If IsEmpty(Target.Offset(0, 2)) Then\n                    Target.Offset(0, 2).Value2 = Now\n                    Target.Offset(0, 2).NumberFormat = \"mm/dd/yyyy HH:mm:ss\"\n                End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><em>Though I'd probably recommend @PEH's implementation, because it can also track multiple entries which I have not accounted for in my answer</em></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1531299984, "last_edit_date": 1531299984, "creation_date": 1531299447, "answer_id": 51281264, "question_id": 51280756, "link": "https://stackoverflow.com/questions/51280756/auto-insert-todays-date-based-on-another-cell-that-is-filled-via-formula/51281264#51281264", "title": "Auto insert today&#39;s date based on another cell that is filled via formula", "body": "<p>The trick is to check if the date was already written and not write it again. So it is only added the first time you add a project name in column B.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const TimeColumn = \"D\"\n\n    If Not Intersect(Target, Range(\"B:B\")) Is Nothing Then 'only trigger on column B\n\n        Dim TargetRow As Range\n        For Each TargetRow In Target.Rows 'needed if multiple rows are filled at once eg (copy/paste in col B)\n            If Cells(TargetRow.Row, TimeColumn).Value = vbNullString Then 'test if there is already a date\n                With Cells(TargetRow.Row, TimeColumn)\n                    .Value = Now() 'write the value\n                    .NumberFormat = \"mm/dd/yyyy HH:mm:ss\" 'format it\n                End With\n            End If\n        Next TargetRow\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You probably might want to change <code>Range(\"B:B\")</code> into the range where you plan to input the data like <code>Range(\"B4:B\" &amp; Rows.Count)</code> to not trigger in the headlines.</p>\n\n<p>Also note that it might happen that in column B multiple rows are inserted eg by copy paste. That's why we need that loop <code>For Each TargetRow In Target.Rows</code> so every added line gets its date written.</p>\n\n<p>Also note that we need to use <code>.NumberFormat</code> to format the value in the cell. <code>Format(Now, \"mm/dd/yyyy HH:mm:ss\")</code> won't work because it adds the date as text (string) but not as a date value (you can calculate with).</p>\n"}], "owner": {"reputation": 55, "user_id": 5756958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1329873bc7fa2e57d1ed047ceaa82654?s=128&d=identicon&r=PG&f=1", "display_name": "Khaledtaj8", "link": "https://stackoverflow.com/users/5756958/khaledtaj8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 1, "accepted_answer_id": 51281264, "answer_count": 2, "score": 2, "last_activity_date": 1531301471, "creation_date": 1531297880, "question_id": 51280756, "link": "https://stackoverflow.com/questions/51280756/auto-insert-todays-date-based-on-another-cell-that-is-filled-via-formula", "title": "Auto insert today&#39;s date based on another cell that is filled via formula", "body": "<p>Using MS Excel, I am making cells from (column A) to be auto generated (as ID) if cells from column B is not blank using the formula <code>=IF(B4&lt;&gt;\"\",\"2018-CI-\"&amp;ROWS(A$4:A4),\"\")</code> and it is working fine.</p>\n\n<p>what i am trying to do is that i want when a code is generated in a cell of column A1, the date of data entry to be auto inserted in cell of the same row on column D.</p>\n\n<p>So, when the user write a new project name in Col.B, the code will be automatically generated in Col.A in addition to the date of entry to be automatically generated in Col.D. (i want to make the date static, so it does not change if project name is changed because the ID will not change).</p>\n\n<p>i am using this VBA code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim xCellColumn As Integer\nDim xTimeColumn As Integer\nDim xRow, xCol As Integer\nxCellColumn = 1\nxTimeColumn = 4\nxRow = Target.Row\nxCol = Target.Column\nIf Target.Text &lt;&gt; \"\" Then\n    If xCol = xCellColumn Then\n       Cells(xRow, xTimeColumn) = Format(Now, \"mm/dd/yyyy HH:mm:ss\")\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>however, nothing is effected in cells of Col.D, the code works fine if i changed <code>xCellColumn = 1</code> to <code>xCellColumn = 2</code> which is Col.B (project names in table).</p>\n\n<p>This a picture of table on excel: <a href=\"https://i.stack.imgur.com/K2dUR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K2dUR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Am i doing something wrong? could you help me please? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531297938, "post_id": 51280717, "comment_id": 89538833, "body": "Use <code>MOD</code>.  For example:  <code>If row MOD 1000 = 0 Then</code>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531298272, "post_id": 51280717, "comment_id": 89539033, "body": "Use an &quot;outer&quot; for loop with a step of 1000: <code>for row = 1 to totalrows step 1000</code>"}, {"owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "edited": false, "score": 0, "creation_date": 1531298515, "post_id": 51280717, "comment_id": 89539183, "body": "Hi, thanks for your prompt response. Can you please phrase the code here. I am new to VBA and do not know the syntax well. Thanks in advance"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1531298552, "creation_date": 1531298552, "answer_id": 51280972, "question_id": 51280717, "link": "https://stackoverflow.com/questions/51280717/looping-a-code-in-the-first-100-rows-then-the-next-thousand-rows/51280972#51280972", "title": "Looping a code in the first 100 rows then the next thousand rows", "body": "<p>This would color all the looped rows in blue.</p>\n\n<pre><code>Public Sub LoopMe()\n    Dim i As Long\n    For i = 1 To 2 ^ 20 Step 1000\n        Worksheets(1).Rows(i).Interior.Color = vbBlue\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 51280972, "answer_count": 1, "score": 0, "last_activity_date": 1531298552, "creation_date": 1531297771, "question_id": 51280717, "link": "https://stackoverflow.com/questions/51280717/looping-a-code-in-the-first-100-rows-then-the-next-thousand-rows", "title": "Looping a code in the first 100 rows then the next thousand rows", "body": "<p>I have a set of code which i want to loop in all the rows in an excel sheet. The limitation here is that the code i am using can only process 1000 rows at a time. What i want to do is to set the pointer using a for statement every time at the next 1000th row. This means first my code runs in the first 1000 rows then it comes back and runs in the next 1000 rows till then last row. Please can anyone let me know how i can do this in VBA. Thanks!</p>\n"}, {"tags": ["vba", "cmd", "powerpoint"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1531299112, "post_id": 51280661, "comment_id": 89539583, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> The first thing you need to realize in regards to your question is that <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>, <a href=\"https://stackoverflow.com/questions/tagged/vbscript\">vbscript</a>, <a href=\"https://stackoverflow.com/questions/tagged/vb.net\">vb.net</a>, <a href=\"https://stackoverflow.com/questions/tagged/vb6\">vb6</a> etc are all similar, but <b>not</b> interchangeable.  You can&#39;t run <code>VBA</code> from the command line.  You are probably thinking of <a href=\"https://stackoverflow.com/questions/tagged/vbscript\">vbscript</a> (<code>VBS</code>).  Given that information, you might to some Googling into how to run the commands your trying to run, but in <code>VBS</code> instead."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1531299117, "post_id": 51280661, "comment_id": 89539588, "body": "An overview on Wikipedia: <a href=\"//en.wikipedia.org/wiki/Visual_Basic_for_Applications\" rel=\"nofollow noreferrer\"><b>VBA</b></a> and <a href=\"//en.wikipedia.org/wiki/VBScript\" rel=\"nofollow noreferrer\"><b>VBS</b></a>. Also <a href=\"//msdn.microsoft.com/vba/outlook-vba/articles/common-things-you-can-do-with-vbscript\" rel=\"nofollow noreferrer\">Common Things You Can Do with VBScript</a>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1531302882, "post_id": 51280661, "comment_id": 89542231, "body": "VBScript is untyped, so to declare a variable you must just <code>Dim X</code> not <code>Dim X as SomeType</code>"}, {"owner": {"reputation": 94, "user_id": 8506776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e0580a4499ad67f3a769bc41cd41c7?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/8506776/j-doe"}, "edited": false, "score": 0, "creation_date": 1531303480, "post_id": 51280661, "comment_id": 89542606, "body": "yeah i got that but why not it is throwing any error when in statements like \t<code>Set MyPresentation = objNewPowerPoint.Presentations.Open(&quot;C:\\Users\\vmishra\\Deskto&zwnj;&#8203;p\\PPT-Slides.pptx&quot;) </code>consider ppt path is wrong I am running like <code>Wscript hi.vbs</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1531312763, "post_id": 51283198, "comment_id": 89548795, "body": "So that&#39;s what is typically called a <i>Variant</i> data type... Using <code>Dim</code> in VBScripts might improve readability, that&#39;s why I&#39;m usually doing it..."}, {"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 1, "creation_date": 1531315611, "post_id": 51283198, "comment_id": 89550867, "body": "Still the variant is set to a particular data type. See <a href=\"http://ecs.syr.edu/faculty/fawcett/Handouts/cse775/presentations/BruceMcKinneyPapers/variants.htm\" rel=\"nofollow noreferrer\">ecs.syr.edu/faculty/fawcett/Handouts/cse775/presentations/&hellip;</a> It used to be an MS paper."}], "tags": [], "owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1531305054, "creation_date": 1531305054, "answer_id": 51283198, "question_id": 51280661, "link": "https://stackoverflow.com/questions/51280661/vba-enexpected-running-vba-from-cmd-line/51283198#51283198", "title": "VBA : Enexpected running VBA from cmd line", "body": "<p>In VBScript you cannot dim something as something.</p>\n\n<pre><code>Dim objNewPowerPoint\nDim MyPresentation\nDim pSlides\n</code></pre>\n\n<p>And <code>dim</code> is optional and serves no technical purpose in VBS (it merely catches spelling mistakes if <code>Option Explicit</code> is specified, else it does nothing at all as in your case except take time to the process the line). In compiled languages it allocates storage and checks data types when using it.</p>\n\n<p>When you use <code>Set =</code> VBS knows it an object and makes it one (4 x 32 bit integers - One a reference count and another a memory address of the function table for the object - two are unused). If you use <code>x=5555</code> vbs knows it's a integer. </p>\n"}], "owner": {"reputation": 94, "user_id": 8506776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e0580a4499ad67f3a769bc41cd41c7?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/8506776/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531305054, "creation_date": 1531297563, "question_id": 51280661, "link": "https://stackoverflow.com/questions/51280661/vba-enexpected-running-vba-from-cmd-line", "title": "VBA : Enexpected running VBA from cmd line", "body": "<p>I wanted to open an existing ppt using Wscript and modify it. For that I am opening the file in visual studio editor and executing the script from cmd in windows using <code>WScript hi.vbs</code> </p>\n\n<p>But when I ran the same code I am getting error. </p>\n\n<pre><code>Expected end of statement in line 4 \n</code></pre>\n\n<p>Line 4 looks like <code>Dim objNewPowerPoint As Object</code>\nHowever Same case works when I run code in excel VBA editor. </p>\n\n<p>When I am removing the As object I am not getting any error nor any changes are happening in the PPT file. \nWondering what is the possible issue. </p>\n\n<p>I am not using excel vba or word vba i am just running the file from <code>cmd</code> </p>\n\n<pre><code>Sub Open_an_existing_Presentations()\n\nDim objNewPowerPoint As Object\nDim MyPresentation  As Object\nDim pSlides  As Object\n\nSet objNewPowerPoint = CreateObject(PowerPoint.Application)\n'Make this Application Object Visible\nobjNewPowerPoint.Visible = True\n</code></pre>\n\n<p>Please help me how can i modify and more importantly how to see both errors compile and syntax. </p>\n\n<p>FYI : I am completely new into VBA and I am trying to update a PPT and wanted to run vba script from another program so trying something like this. Best suggestions are always welcome </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1531298617, "last_edit_date": 1531298617, "creation_date": 1531296595, "answer_id": 51280348, "question_id": 51280249, "link": "https://stackoverflow.com/questions/51280249/if-cell-is-blank-delete-entire-row/51280348#51280348", "title": "If cell is blank delete entire row", "body": "<p>The main issue in your code is that it is counting wrong.\n<code>\"A17:A1000\" &amp; r</code> does not count the rows up but appends the number <code>r</code> to that string. So eg if <code>r = 500</code> it will result in <code>\"A17:A1000500\"</code> but not in <code>\"A17:A1500\"</code> as you might expected.</p>\n\n<hr>\n\n<p>To delete all rows where column A has a blank cell you can use </p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteRowsWithBlankCellsInA()\n    Worksheets(\"Sheet1\").Range(\"A17:A1000\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p><em>This one deletes all blank lines at once and therefore is pretty fast. Also it doesn't need to disable <code>ScreenUpdating</code> because it is only one action.</em></p>\n\n<hr>\n\n<p>Or if blank and zero cells need to be deleted use</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteRowsWithBlankOrZeroCellsInA()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\") 'define which worksheet\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long\n    For iRow = LastRow To 1 Step -1\n        If ws.Cells(iRow, \"A\").Value = vbNullString Or ws.Cells(iRow, \"A\").Value = 0 Then\n            ws.Rows(iRow).Delete\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p><em>This one deletes line by line. Each delete action takes its time so it takes longer the more lines you delete. Also it might need to disable <code>ScreenUpdating</code> otherwise you see the line-by-line action.</em></p>\n\n<p>An alternative way is to collect all the rows you want to delete with <code>Union()</code> and then delete them at once.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteRowsWithBlankOrZeroCellsInA()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")  'define which worksheet\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim DeleteRange As Range\n\n    Dim iRow As Long\n    For iRow = LastRow To 1 Step -1 'also forward looping is possible in this case: For iRow = 1 To LastRow\n        If ws.Cells(iRow, \"A\").Value = vbNullString Or ws.Cells(iRow, \"A\").Value = 0 Then\n            If DeleteRange Is Nothing Then\n                Set DeleteRange = ws.Rows(iRow)\n            Else\n                Set DeleteRange = Union(DeleteRange, ws.Rows(iRow)) 'collect rows to delete\n            End If\n        End If\n    Next iRow\n\n    DeleteRange.Delete 'delete all at once\nEnd Sub\n</code></pre>\n\n<p><em>This is also pretty fast because you have again only one delete action. Also it doesn't need to disable <code>ScreenUpdating</code> because it is one action only.</em></p>\n\n<p>In this case it is also not necessary to loop backwards <code>Step -1</code>, because it just collects the rows in the loop and deletes at once (after the loop). So looping from <code>For iRow = 1 To LastRow</code> would also work.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531297413, "post_id": 51280446, "comment_id": 89538476, "body": "<code>Rows(i).EntireRow.Delete</code> should be <code>ws.Rows(i).Delete</code> I think, because <code>Rows(i)</code> is already the entire row. Also <code>i</code> should declare as <code>Dim i As Long</code>"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1531298048, "post_id": 51280446, "comment_id": 89538905, "body": "@P\u1d07\u029c I think both should work, but yes, technically <code>.EntireRow</code> is excessive here. As to the <code>i</code> declaration, my code didn&#39;t have <code>Option Explicit</code> so it wouldn&#39;t cause a hassle, but I guess it is a good practice to get to using, given OP seems fairly new to VBA anyways. Edited accordingly, thanks for the revision."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531298246, "post_id": 51280446, "comment_id": 89539018, "body": "No worries, didn&#39;t say it won&#39;t work, just a improvement ;)  But <code>Rows(i).Delete</code> should really specify the worksheet <code>ws.Rows(i).Delete</code> (as I commented) to avoid any odd behavior."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1531298467, "post_id": 51280446, "comment_id": 89539150, "body": "Also, it&#39;s best practice to loop backwards when deleting rows otherwise you may skip over some rows by mistake"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1531298748, "last_edit_date": 1531298748, "creation_date": 1531296931, "answer_id": 51280446, "question_id": 51280249, "link": "https://stackoverflow.com/questions/51280249/if-cell-is-blank-delete-entire-row/51280446#51280446", "title": "If cell is blank delete entire row", "body": "<p>There are multiple errors in your code.</p>\n\n<ol>\n<li>First of all, your procedure should have it's scope declared.\nPresumably in your case <code>Private</code></li>\n<li>You are incorrectly defining your <code>Range()</code> Please look at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">its definition</a></li>\n<li><code>Range.Value = 0</code> is not the same as <code>Range = \"\"</code> or better yet <code>IsEmpty(Range)</code></li>\n<li>Looping from beginning to end when deleting individual rows will cause complications (given their indexes <em>[indices(?)]</em> change) - or to better word myself - it is a valid practice, but you should know what you're doing with the indexes. In your case it seems much easier to them them in the LIFO order. </li>\n<li>Last but not least, you're unnecessarily complicating your code with certain declarations (not an error so to say, but something to be improved upon)</li>\n</ol>\n\n<p>With all the considered, your code should look something like this:</p>\n\n<pre><code>Option Explicit\nPrivate Sub remove_empty_rows()\nDim ws as Worksheet: Set ws = Sheets(\"Your Sheet Name\")\nDim lr as Long\nlr = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\nDim i as Long\nFor i = lr to 1 Step -1\n   If IsEmpty(ws.Cells(i, 1)) Then\n      ws.Rows(i).Delete\n   End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>In general, without meaning to sound condescending, it looks like you have some learning gaps in your coding practice. I'd refer properly reading some documentation or tutorial first, before actually doing coding like this yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1531299601, "creation_date": 1531299601, "answer_id": 51281321, "question_id": 51280249, "link": "https://stackoverflow.com/questions/51280249/if-cell-is-blank-delete-entire-row/51281321#51281321", "title": "If cell is blank delete entire row", "body": "<p>Taking into account that <code>A17</code> cell is a header, you could use <code>AutoFilter</code> instead of iterating over cells:</p>\n\n<pre><code>Sub FastDeleteMethod()\n    Dim rng As Range, rngFiltered As Range\n    Set rng = Range(\"A17:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    With rng\n        .AutoFilter Field:=1, Criteria1:=0, Operator:=xlOr, Criteria2:=\"=\"\n        On Error Resume Next\n        Set rngFiltered = rng.SpecialCells(xlCellTypeVisible)\n        If Err = 0 Then rngFiltered.EntireRow.Delete\n        On Error GoTo 0\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba7b7960d8896f4cde7519c3484f783?s=128&d=identicon&r=PG&f=1", "display_name": "thomasuponor", "link": "https://stackoverflow.com/users/9396005/thomasuponor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3521, "favorite_count": 0, "closed_date": 1531306791, "accepted_answer_id": 51280348, "answer_count": 3, "score": 0, "last_activity_date": 1531299601, "creation_date": 1531296232, "last_edit_date": 1531296283, "question_id": 51280249, "link": "https://stackoverflow.com/questions/51280249/if-cell-is-blank-delete-entire-row", "closed_reason": "Duplicate", "title": "If cell is blank delete entire row", "body": "<p>In Excel, I want to delete entire row if a cell is blank.\nThis should count for A17:A1000.\nRunning the script it returns the error:</p>\n\n<blockquote>\n  <p>Run-time 1004 error<br>\n  Method Range of object global failed</p>\n</blockquote>\n\n<p>If I replace A17:A1000 with A it deletes some rows.</p>\n\n<pre><code>Sub DeleteBlanks()\n    Dim r As Long\n    Dim m As Long\n    Application.ScreenUpdating = False\n    m = Range(\"A17:A1000\" &amp; Rows.Count).End(xlUp).Row\n    For r = m To 1 Step -1\n        If Range(\"A17:A1000\" &amp; r).Value = \"\" Or Range(\"A17:A1000\" &amp; r).Value = 0 Then\n            Range(\"A17:A1000\" &amp; r).EntireRow.Delete\n        End If\n    Next r\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1531297505, "post_id": 51279844, "comment_id": 89538534, "body": "If you write <code>target_date = Cells(20, 2).Value</code>, would it work? <code>Instead of Cells(2,20)</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531298370, "post_id": 51279844, "comment_id": 89539094, "body": "What&#39;s the exact value you&#39;ve entered in cell <code>T2</code>?  I&#39;m having no problem finding the cell with the code - declaring <code>target_date</code> as a variant or date and <code>finding</code> as a variant or range works.  The correct sheet is active when you perform the find?  You&#39;ve not qualified the cells with a sheet reference so maybe something to consider."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1531298536, "post_id": 51279844, "comment_id": 89539198, "body": "Does the value in <code>T2</code> contain a time part while the list of dates doesn&#39;t? If so try using <code>target_date = Int(Cells(2, 20))</code>."}, {"owner": {"reputation": 1, "user_id": 3848185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771ae6dcdf23a4d2f7a182750e2a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "fueh", "link": "https://stackoverflow.com/users/3848185/fueh"}, "edited": false, "score": 0, "creation_date": 1531299458, "post_id": 51279844, "comment_id": 89539836, "body": "The value for <code>Cells(2, 20)</code> is <code>1&#47;1&#47;2018</code> format that is set to display as <code>1-Jan-18</code>. I have no problem searching for <code>1&#47;1&#47;2018</code>  but when I tried to search for <code>1&#47;8&#47;2018</code> there will be no results found."}, {"owner": {"reputation": 1, "user_id": 3848185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771ae6dcdf23a4d2f7a182750e2a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "fueh", "link": "https://stackoverflow.com/users/3848185/fueh"}, "edited": false, "score": 0, "creation_date": 1531300990, "post_id": 51279844, "comment_id": 89540917, "body": "Also, if I changed <code>A2</code> into <code>1&#47;8&#47;2018</code> instead of <code>=A1+7</code>, the search function is able to locate the cell."}], "owner": {"reputation": 1, "user_id": 3848185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771ae6dcdf23a4d2f7a182750e2a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "fueh", "link": "https://stackoverflow.com/users/3848185/fueh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531298094, "creation_date": 1531294971, "last_edit_date": 1531298094, "question_id": 51279844, "link": "https://stackoverflow.com/questions/51279844/search-function-unable-to-find-formula-result", "title": "Search function unable to find formula result", "body": "<p>I am trying to do a search macro to find a specific date in a table. However the dates in the table are set in weeks by adding 7 from the previous date. So if <code>A1</code> is <code>1/1/2018</code> then <code>A2</code> would be <code>A1+7</code>, resulting in <code>1/8/2018</code>, so on and forth. I have added <code>LookIn:=xlValues</code> in the search function but the search still does not return any results. Would greatly appreciate some help.</p>\n\n<p>This is the code I am using:</p>\n\n<pre><code>target_date = Cells(2, 20).Value\n\nSet finding = Cells.Find(What:=target_date, After:=Cells(1, 1), LookIn:=xlValues, LookAt:= _\n    xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False)\n\nIf Not finding Is Nothing Then finding.Activate\n</code></pre>\n"}, {"tags": ["vba", "excel", "azure-sql-database", "adodb"], "comments": [{"owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1531294615, "post_id": 51279649, "comment_id": 89536787, "body": "you can try to connect to the azure data source doing it manually from the Excel data thumb Data &gt; Get Data &gt; From Azure. Once you did this you will be able to retreive the connection string from &quot;Existing connections&quot;"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531298054, "post_id": 51279649, "comment_id": 89538909, "body": "Can your VM resolve the name to your data source?"}], "owner": {"reputation": 13, "user_id": 7687736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c18d2a94394b5b267b9c77dd0be73de4?s=128&d=identicon&r=PG&f=1", "display_name": "Myx", "link": "https://stackoverflow.com/users/7687736/myx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531294382, "creation_date": 1531294314, "last_edit_date": 1531294382, "question_id": 51279649, "link": "https://stackoverflow.com/questions/51279649/adodb-connection-not-working-on-virtual-machine", "title": "adodb connection not working on virtual machine", "body": "<p>In Excel VBA I used to be able to connect to an Azure database and pull the latest data into the spreadsheet via a virtual machine. However, this no longer works, the same code works and updates when I run it on my desktop.</p>\n\n<p>Code looks like:</p>\n\n<pre><code>Set objMyConn = New ADODB.Connection\nSet objMyRecordset = New ADODB.Recordset\nDim LinkSQL As String\nobjMyConn.ConnectionString = \"Provider=SQLNCLI11; Password=\" &amp; \"\"\"###\"\"\" &amp; \"; User ID=###; Initial Catalog=###;\" &amp; \"Data Source=###;\"\nLinkSQL = \"###\"\nSet objMyRecordset.ActiveConnection = objMyConn\nobjMyRecordset.Open LinkSQL\nSheet1.Range(\"A2\").CopyFromRecordset (objMyRecordset)\nobjMyRecordset.Close\nobjMyConn.Close\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1531292413, "creation_date": 1531292413, "answer_id": 51279121, "question_id": 51279014, "link": "https://stackoverflow.com/questions/51279014/1004-error-when-trying-to-insert-formula-with-vlookup/51279121#51279121", "title": "1004 error when trying to insert formula with &quot;vlookup&quot;", "body": "<p>When inserting formulas via VBA you need to use \"US-style\" comma separator and not a semicolon, unless you use <code>FormulaLocal</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10063001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98404ea9aff69a4fbe262deabbc1622b?s=128&d=identicon&r=PG&f=1", "display_name": "user9003", "link": "https://stackoverflow.com/users/10063001/user9003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1531294727, "answer_count": 1, "score": -2, "last_activity_date": 1531292413, "creation_date": 1531292021, "question_id": 51279014, "link": "https://stackoverflow.com/questions/51279014/1004-error-when-trying-to-insert-formula-with-vlookup", "closed_reason": "Duplicate", "title": "1004 error when trying to insert formula with &quot;vlookup&quot;", "body": "<p>I am new to vba (actually started yesterday) so please excuse my ignorance on details I should include in my question.</p>\n\n<p>I am trying to use a macro to insert a formula containing \"vlookup\" into a cell in excel. However, if I try to run the macro, I get an error \"1004 - application defined or object defined error\"</p>\n\n<p>The line that causes the issue:</p>\n\n<pre><code>Worksheets(\"Berechnungen\").Cells(19, 10).Formula = \"=VLOOKUP(R3C1;R9C1:R12C1;16;FALSE)\"\n</code></pre>\n\n<p>I tried different formulas like</p>\n\n<pre><code>Worksheets(\"Berechnungen\").Cells(19, 10).Formula = \"=SUM(R3C4:R3C5)\"\n</code></pre>\n\n<p>that all worked like a charm.</p>\n\n<p>I am using Microsoft Office 365 ProPlus, version 1708 in German language.</p>\n\n<p>Please let me know if you require any additional information!</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1531289953, "post_id": 51278374, "comment_id": 89534403, "body": "Well, give us a clue - which line has the value error?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1531291390, "post_id": 51278374, "comment_id": 89535082, "body": "Can you show the code how you use this function? A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might help here."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1531291409, "post_id": 51278374, "comment_id": 89535087, "body": "Maybe <code>Dim r As Range</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1531291815, "post_id": 51278374, "comment_id": 89535310, "body": "Call the function from a Sub instead of from a worksheet cell and you&#39;ll be able to debug it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1531292301, "post_id": 51278374, "comment_id": 89535585, "body": "Works fine for me in Excel 2016 on Mac, assuming none of the inputs are an error. What version are you using?"}, {"owner": {"reputation": 153, "user_id": 1554613, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e6808538c72a1ffd8b32630f662932ea?s=128&d=identicon&r=PG", "display_name": "mend", "link": "https://stackoverflow.com/users/1554613/mend"}, "edited": false, "score": 0, "creation_date": 1533284994, "post_id": 51278374, "comment_id": 90299452, "body": "My version: Excel 2016 15.21.1. Tried creating a workbook from scratch but still the same error."}], "owner": {"reputation": 153, "user_id": 1554613, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e6808538c72a1ffd8b32630f662932ea?s=128&d=identicon&r=PG", "display_name": "mend", "link": "https://stackoverflow.com/users/1554613/mend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593629072, "creation_date": 1531289624, "last_edit_date": 1593629072, "question_id": 51278374, "link": "https://stackoverflow.com/questions/51278374/vba-function-works-in-windows-but-not-in-mac-os", "title": "VBA function works in windows but not in mac os", "body": "<p>This VBA function for merging range works in windows but gives <code>#VALUE</code> in mac os.</p>\n\n<pre><code>Option Explicit\n\nPublic Function MergeRange(ParamArray rng()) As Single()\n    Dim i As Long\n    Dim count As Long\n    Dim r As Excel.Range\n    Dim s() As Single\n\n    For i = LBound(rng) To UBound(rng)\n        If (TypeOf rng(i) Is Excel.Range) Then\n            For Each r In rng(i)\n                ReDim Preserve s(count)\n                s(count) = r.Value\n\n                count = count + 1\n            Next r\n        End If\n    Next i\n\n    MergeRange = s\nEnd Function\n</code></pre>\n\n<p>The code comes from another stackoverflow thread <a href=\"https://stackoverflow.com/questions/19248509/how-merge-mix-range-of-cell-as-formula-parameter\">How merge/mix range of cell as formula parameter</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531289219, "post_id": 51278202, "comment_id": 89534070, "body": "Sounds straightforward enough.  The first step is to forget about the radio buttons for now, and get the &quot;guts&quot; of it working.  Making it button-activated is an afterthought.  Have you attempted this yet? - can you share your code?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531289399, "post_id": 51278202, "comment_id": 89534144, "body": "I am curious what you&#39;re trying to accomplish, &quot;end goal&quot;  -- obviously if the user make other changes after deleting the data, it may not be recoverable... is that a problem or is this data easily regenerated?  Perhaps it would be better to just Hide/Unhide the appropriate columns/rows?"}, {"owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1531289883, "post_id": 51278202, "comment_id": 89534372, "body": "I tried to hide column but because I have merged cells it destroys the format of the entire sheet. I am very novice in VBA (self learning). The &#39;end goal&#39; is that this is going to be used as a form. I want that cell range deleted as it is not applicable if their activity is &quot;Out&quot; selected by a radio button. If their activity is &quot;In&quot; then that cell range and it&#39;s header is made available/visible. Apologies again if I am not making sense, I don&#39;t have code to share as I simply don&#39;t know what I am doing to attempt it."}, {"owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 2, "creation_date": 1531293868, "post_id": 51278202, "comment_id": 89536414, "body": "A lot of this is quite simple and can be done with recorded macros at the core. On clicking out then copy the range to a &#39;trashcan&#39; sheet and delete the range on the main sheet. On clicking &#39;in&#39; and if the &#39;trashcan&#39; is not empty then copy and insert the trashcan range into the main sheet and delete the &#39;trashcan&#39; range."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1531359040, "post_id": 51278202, "comment_id": 89569734, "body": "What do you need help with, exactly? You want to know how to delete a cell? How to undo the last command? How to insert a cell? How to associate code with a button? How to call a subroutine when the value of a form field changes?"}, {"owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "reply_to_user": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 0, "creation_date": 1531434802, "post_id": 51278202, "comment_id": 89607217, "body": "@AndyW That&#39;s a great suggestion and shouldn&#39;t be too hard to figure out. I&#39;ll try that and get back to you all. Thank you."}, {"owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "reply_to_user": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 0, "creation_date": 1531722004, "post_id": 51278202, "comment_id": 89683500, "body": "@AndyW I got it to work this way, thanks for the suggestion (should have thought of that)"}], "owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594031272, "creation_date": 1531288810, "last_edit_date": 1594031272, "question_id": 51278202, "link": "https://stackoverflow.com/questions/51278202/excel-vba-deleting-cells-via-radio-button-and-restoring-the-content-if-other-r", "title": "Excel VBA - Deleting Cells via radio button and restoring the content if other radio button clicked", "body": "<p>I would like some help with excel VBA please as I'm just unsure how to do this and couldn't find anything to guide me.</p>\n<p>I have 2 radio button, 1st is &quot;In&quot; and 2nd is &quot;Out&quot;.</p>\n<p>What I am trying to do is. If &quot;Out&quot; is clicked, cells <code>D9:D20</code> are deleted and cells on the right will shift left.</p>\n<p>If you click &quot;In&quot;, I would like the original content to come back (think of it like you've clicked Undo-Last (Ctrl+Z)</p>\n<p>The purpose is, I am trying to build a smarter form for someone in our business that will have the fields change based on what activity you are doing.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531292746, "post_id": 51278025, "comment_id": 89535820, "body": "Do the Column B values allows follow a <code>&#47;</code> in Column A?"}, {"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531293655, "post_id": 51278025, "comment_id": 89536297, "body": "I don&#39;t quite understand what you mean. I tried to say that the values in A can include more than just the B value. Like numbers and a slash before the value of the real value of B. I hope you understand, I don&#39;t know how to describe better -&gt; the example above says it all I guess."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1531293805, "post_id": 51278025, "comment_id": 89536380, "body": "Is there any pattern to the how B can be contained within A?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1531294014, "post_id": 51278025, "comment_id": 89536474, "body": "Are B values always the last 9 characters in A values?"}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1531288611, "post_id": 51278104, "comment_id": 89533823, "body": "OP is searching B values in <i>any</i> row of A :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531288826, "post_id": 51278104, "comment_id": 89533912, "body": "maybe <code>if(isnumber(match(&quot;*&quot;&amp;b1&amp;&quot;*&quot;, a:a, 0)), &quot;X&quot;, &quot;&quot;)</code>"}, {"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531289188, "post_id": 51278104, "comment_id": 89534057, "body": "@Jeeped Wow, thanks for the quick answers. So you mean I just put it in an excel cell like   <code>=if(isnumber(match(&quot;*&quot;&amp;b1&amp;&quot;*&quot;, a:a, 0)), &quot;X&quot;, &quot;&quot;)</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531289505, "post_id": 51278104, "comment_id": 89534184, "body": "Yes, the one above or Solar Mike&#39;s answer in the response above."}, {"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531293872, "post_id": 51278104, "comment_id": 89536415, "body": "Do you mean: <code>IF(IFERROR(MATCH(P2,B2:B1000,0),FALSE),&quot;X&quot;,&quot;&quot;)</code> (columns are adapted). Where do I write that code? When I write it in a cell it gives me an error, asking if I really wanted to put a function."}], "tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 2, "last_activity_date": 1531298633, "last_edit_date": 1531298633, "creation_date": 1531288392, "answer_id": 51278104, "question_id": 51278025, "link": "https://stackoverflow.com/questions/51278025/excel-vba-compare-value-to-column/51278104#51278104", "title": "Excel VBA compare value to column", "body": "<p>Why bother with vba?</p>\n\n<p>All you need is this in column C:</p>\n\n<pre><code>=if(A1=B1,\"X\",\"\")\n</code></pre>\n\n<p>Edit after comment: to look in all of column A - you can set the range:</p>\n\n<pre><code>=IF(IFERROR(MATCH(B1,A1:A10,0),FALSE),\"X\",\"\")\n</code></pre>\n\n<p>Just enter in cell C1 or whichever cell you want to start, make sure that \"B1 or B16\" is the first cell you want to check and drag down...</p>\n\n<p>Edit 2 see image and note the \"No Val\" update...\n<a href=\"https://i.stack.imgur.com/zZrT1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zZrT1.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531292407, "post_id": 51278509, "comment_id": 89535652, "body": "Thanks for your answer! However, the code doesn&#39;t work for me. It just puts an &quot;X&quot; in the first row column c. The thing is that any value of column B can be anywhere in column A. But some values of B are not in A. I hope you understood my question. Thank you for your thoughts."}, {"owner": {"reputation": 66, "user_id": 9735552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d38106980585c38ecbeb7eea3e4253?s=128&d=identicon&r=PG&f=1", "display_name": "Exelus", "link": "https://stackoverflow.com/users/9735552/exelus"}, "reply_to_user": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531299844, "post_id": 51278509, "comment_id": 89540084, "body": "ok i probably understood your question badly, i thought you search value from A in B so it puts &quot;X&quot; in collumn C next to founded B value , but if you can provide file it would be much easier to help you."}], "tags": [], "owner": {"reputation": 66, "user_id": 9735552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d38106980585c38ecbeb7eea3e4253?s=128&d=identicon&r=PG&f=1", "display_name": "Exelus", "link": "https://stackoverflow.com/users/9735552/exelus"}, "is_accepted": false, "score": 0, "last_activity_date": 1531309805, "last_edit_date": 1531309805, "creation_date": 1531290136, "answer_id": 51278509, "question_id": 51278025, "link": "https://stackoverflow.com/questions/51278025/excel-vba-compare-value-to-column/51278509#51278509", "title": "Excel VBA compare value to column", "body": "<p>I think you are searching for something like this : </p>\n\n<pre><code>Sub test()\n\n\nFor i = 1 To Cells(Rows.Count, 10).End(xlUp).Row 'just change \"1\" to whenever     column you want to count rows from\nFor b = 1 To Cells(Rows.Count, 12).End(xlUp).Row\n\nDim search As Variant, Find As Variant\n\nsearch = Cells(b, 12).Value\nFind = Cells(i, 10).Value\n\nIf Find Like \"*\" &amp; search &amp; \"*\" Or Find = search Then\n\nCells(b, 2).Offset(0, 1).Value = \"x\"\n\nEnd If\n\nIf Cells(i, 1).Value = \"\" Then\nExit Sub\nEnd If\n\nNext b\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>it worked for me, so i hope it will help you too.</p>\n\n<p>*edited to find B value in A column and put \"X\" next to Searched B value </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531300523, "post_id": 51280038, "comment_id": 89540592, "body": "Thanks for your answer! The value in Column C, however can be anywhere in column B. E.g. 111/aaa can be in column B row 294. And when aaa is in row 211 in column C I have to find that (in B294) and mark the cell next to it with an &quot;X&quot;."}, {"owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "edited": false, "score": 0, "creation_date": 1531301632, "post_id": 51280038, "comment_id": 89541377, "body": "I have added a picture in the question as further explanation."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1531295594, "creation_date": 1531295594, "answer_id": 51280038, "question_id": 51278025, "link": "https://stackoverflow.com/questions/51278025/excel-vba-compare-value-to-column/51280038#51280038", "title": "Excel VBA compare value to column", "body": "<p>Why do you even use VBA for this?</p>\n\n<p>I tried using the following situation:</p>\n\n<pre><code>      | Column A | Column B | Column C | Column D\nRow 2 |          | 111/aaa  |      aaa | =IFERROR(FIND(C2;B2);0)\nRow 3 |          | 222/bbb  |          | =IFERROR(FIND(C2;B3);0)\nRow 4 |          |          |          | =IF(D2+D3=0;\"X\";D2+D3)\n</code></pre>\n\n<p>Is this what you want?</p>\n"}], "owner": {"reputation": 71, "user_id": 9167695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8429ae257abb27d09244a7751f535800?s=128&d=identicon&r=PG&f=1", "display_name": "tollube", "link": "https://stackoverflow.com/users/9167695/tollube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1531309805, "creation_date": 1531288060, "last_edit_date": 1531301571, "question_id": 51278025, "link": "https://stackoverflow.com/questions/51278025/excel-vba-compare-value-to-column", "title": "Excel VBA compare value to column", "body": "<p>I have the following problem:\nI have an excel with 2 columns A and B. In A there are different serial numbers which can contain values of the different B values. Between the rows there can be empty cells in both columns. </p>\n\n<p>What needs to be done by a VBA script:\nThe script has to take the values of B and search that in the column A. Remember: the values can be: A567=2174/ENJFA7384 and B45=ENJFA7384  -> that would mean they match. If they match there should be written a \"X\" in the column C. If there is no match for the value of B in A it would just continue.</p>\n\n<p>I have tried to achieve that and it works but the program crashes because it is very inefficient. Here the code (that script marks the cell yellow instead of writing the \"X\"):</p>\n\n<pre><code>Sub suchen()\n'in Spalte A nach einem Namen suchen\n'die Zeilen farblich markieren und\n'die Anzahl der Treffer anzeigen\n\nDim suche As String\nDim z As Integer\n\nDim a As Range, b As Range\n\nSet a = Range(\"P2:P391\")\n\nFor Each b In a.Rows\n\nsuche = b.Value\n\n'hier \u00e4ndern falls eine andere Spalte durchsucht werden soll\n[B10].Activate\n\n'wenn keine Eingabe in InpuBox erfolgte wird abgebrochen\nIf suche = \"\" Then Exit Sub\n\n'bis zur ersten leeren Zelle suchen\nDo Until ActiveCell = \"STOP\"\n'eine Zeile nach unten gehen\nActiveCell.Offset(1, 0).Activate\n   'wenn die Zelle den gesuchten Wert enth\u00e4lt:\n    If ActiveCell Like suche Or ActiveCell Like \"*\" &amp; suche Or ActiveCell = suche Then\n\n   'und die Zelle gelb markieren\n    ActiveCell.Interior.ColorIndex = 36\n    End If\nLoop\nNext\n\nEnd Sub\n</code></pre>\n\n<p>If there are any questions feel free to ask.\nAny ideas on how to make this work? Any new ideas are highly appreciated. \nThank you in advande!</p>\n\n<p>EDIT\nHere is an example picture of what the script should do:\n<a href=\"https://i.stack.imgur.com/fDzcC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fDzcC.png\" alt=\"The yellow marks don&#39;t have to be made.\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1531284651, "post_id": 51277422, "comment_id": 89532430, "body": "<code>If Sheet1.Cells(i, 1) = Sheet1.Cells(j, 1) Then</code> should one of those be Sheet2? Maybe <code>Sheet2.Cells(j, 1)</code> ...?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1531284722, "post_id": 51277422, "comment_id": 89532452, "body": "Your logic does not work? In what way? Please make the effort to actually explain the issue."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1531284853, "post_id": 51277422, "comment_id": 89532484, "body": "Some sample data might also be helpful."}, {"owner": {"reputation": 31, "user_id": 9616621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P39frJV1IRM/AAAAAAAAAAI/AAAAAAAAABQ/bUCAfrG096M/photo.jpg?sz=128", "display_name": "ankit singh", "link": "https://stackoverflow.com/users/9616621/ankit-singh"}, "edited": false, "score": 0, "creation_date": 1531285695, "post_id": 51277422, "comment_id": 89532748, "body": "Thank you @Jeeped it worked"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1531295234, "post_id": 51277422, "comment_id": 89537164, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1531285874, "last_edit_date": 1531285874, "creation_date": 1531285159, "answer_id": 51277550, "question_id": 51277422, "link": "https://stackoverflow.com/questions/51277422/excel-vba-logic-not-working/51277550#51277550", "title": "Excel VBA logic not working", "body": "<pre><code>For i = 2 To 15\n    For j = 2 To 15\n        If Sheet1.Cells(i, 1) = Sheet1.Cells(j, 1) Then\n            ...\n</code></pre>\n\n<p>The above code is going to find 14 matches since i and j are the same value 14 times and they both refer to the same worksheet, same column.</p>\n\n<p>Since you use j to refer to a row on Sheet2 later in the code, the above should most likely be closer to this.</p>\n\n<pre><code>For i = 2 To 15\n    For j = 2 To 15\n        If Sheet1.Cells(i, 1) = Sheet2.Cells(j, 1) Then\n            ...\n</code></pre>\n\n<p>However, even if switching to Sheet2.Cells(j, 1) repairs the logic, do everything for everything else is very inefficient. You could reduce the loops with Exit For statements that did not continue looking for matches after one had been found. Furthe to the one-match-and-done is a match on the column's values which negates the inner loop entirely.</p>\n\n<pre><code>Sub addition()\n    Dim i As long, a As long\n    Dim j As variant, b as variant\n\n    For i = 2 To 15\n        i = application.match(Sheet1.Cells(i, 1), Sheet2.Cells(2, 1).resize(14, 1), 0)\n        if not iserror(i) then\n            For a = 2 To 5\n                b = application.match(Sheet1.Cells(1, a), Sheet2.Cells(1, 2).resize(1, 4), 0)\n                if not iserror(b) then\n                    Sheet1.Cells(i, a) = Sheet2.Cells(j, b) + Sheet1.Cells(i, a)\n                End If\n            Next a\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9616621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P39frJV1IRM/AAAAAAAAAAI/AAAAAAAAABQ/bUCAfrG096M/photo.jpg?sz=128", "display_name": "ankit singh", "link": "https://stackoverflow.com/users/9616621/ankit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531295225, "creation_date": 1531284303, "last_edit_date": 1531295225, "question_id": 51277422, "link": "https://stackoverflow.com/questions/51277422/excel-vba-logic-not-working", "title": "Excel VBA logic not working", "body": "<p>There are two sheets with company name in first column and item price is 1st row. Now i need if company name is matched than it should check row and update the values</p>\n\n<pre><code>Sub addition()\n    Dim j As Integer\n    Dim i As Integer\n    Dim a As Integer\n    Dim b As Integer\n\n    For i = 2 To 15\n        For j = 2 To 15\n            If Sheet1.Cells(i, 1) = Sheet1.Cells(j, 1) Then\n                For a = 2 To 5\n                    For b = 2 To 5\n                        If Sheet1.Cells(1, a) = Sheet2.Cells(1, b) Then\n                                Sheet1.Cells(i, a) = Sheet2.Cells(j, b) + Sheet1.Cells(i, a)\n\n                        End If\n                     Next b\n                Next a\n\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>But in some row logic works others it does not.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531286419, "post_id": 51277395, "comment_id": 89532981, "body": "Is this within the ONLINE-CASH VOUCHER.xlsm workbook or are you activating an external workbook?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1531286515, "post_id": 51277395, "comment_id": 89532999, "body": "Yes this is the ONLINE-CASH  VOUCHER.xlsm workbook&#39;s aftersave event. Although the ActiveSheet.Paste pastes in a new workbook file after <code>Set wb=Workbooks.Add</code>. If I copy and paste the exact code into a <code>sub test()</code> it will work with no problems."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1531287458, "post_id": 51277395, "comment_id": 89533360, "body": "Actually I just made a sub procedure and then I just put a <code>Call Procedure</code> in the aftersave event and it works. Just can&#39;t understand why it won&#39;t work in the event"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1531288261, "creation_date": 1531288261, "answer_id": 51278069, "question_id": 51277395, "link": "https://stackoverflow.com/questions/51277395/activesheet-paste-does-not-work-in-workbook-event-but-works-in-module/51278069#51278069", "title": "ActiveSheet.Paste does not work in workbook event, but works in module", "body": "<p>Try these revisions.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n\n    'This section just counts total number of rows for worksheets\n    Dim Total_rows_Entries As Long\n    Dim Total_rows_Payees As Long\n    Dim Total_rows_Accounts As Long\n\n    'With Workbooks(\"ONLINE-CASH VOUCHER.xlsm\")\n    With ThisWorkbook\n\n        With .Worksheets(\"Entries\").ListObjects(\"Entries\").ListColumns(3).Range\n            Total_rows_Entries = .Find(What:=\"*\", _\n                After:=.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n        End With\n\n        With .Worksheets(\"List of Payees\").ListObjects(\"ListofPayees\").ListColumns(1).Range\n            Total_rows_Payees = .Find(What:=\"*\", _\n                After:=.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n        End With\n\n        With .Worksheets(\"List of Accounts\").ListObjects(\"ListofAccounts\").ListColumns(1).Range\n            Total_rows_Accounts = .Find(What:=\"*\", _\n                After:=.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n        End With\n\n        Dim copy_Path As String\n        Dim lastColumn As Long, total_Rows As Long\n        Dim wb As Workbook, ws As Worksheet\n        Dim open_wb As Boolean\n\n        copy_Path = \"C:\\Users\\Asus\\Desktop\\\"\n\n        For Each ws In .Worksheets\n            With ws\n                Select Case .Name\n                    Case \"Entries\"\n                        total_Rows = Total_rows_Entries\n                    Case \"List of Accounts\"\n                        total_Rows = Total_rows_Accounts\n                    Case \"List of Payees\"\n                        total_Rows = Total_rows_Payees\n                End Select\n                Select Case .Name\n                    Case \"Entries\", \"List of Accounts\", \"List of Payees\"\n                        On Error Resume Next\n                        Workbooks(ws.Name &amp; \".xlsx\").Close savechanges:=False\n                        Set wb = Workbooks.Add\n                        On Error GoTo 0\n\n                        lastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n                        .Range(.Cells(1, \"A\"), .Cells(total_Rows, lastColumn)).Copy _\n                            Destination:=wb.Worksheets(1).Cells(1, 1)\n                        Application.DisplayAlerts = False\n                        wb.SaveAs Filename:=copy_Path &amp; ws.Name, FileFormat:=xlOpenXMLWorkbook\n                        wb.Close savechanges:=False\n                        Application.DisplayAlerts = True\n                End Select\n            End With\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 51278069, "answer_count": 1, "score": 0, "last_activity_date": 1531288261, "creation_date": 1531284147, "last_edit_date": 1531286278, "question_id": 51277395, "link": "https://stackoverflow.com/questions/51277395/activesheet-paste-does-not-work-in-workbook-event-but-works-in-module", "title": "ActiveSheet.Paste does not work in workbook event, but works in module", "body": "<p>The <code>ActiveSheet.Paste</code> code after a workbook is added works when I place it in a <code>Module</code> but if I placed it inside the <code>Workbook AfterSave Event</code> it returns an error. When I tried <code>Debug.Print(Application.ActiveSheet.Name) it prints</code>Sheet1<code>and</code>Debug.Print(Application.ActiveWorkbook.Name) as <code>Book13</code> so it should be correct. I also tried placing <code>Range(\"A1\").Select</code> but it does not paste still. </p>\n\n<p><a href=\"https://i.stack.imgur.com/XUxEj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XUxEj.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n\n'This section just counts total number of rows for worksheets    \nDim Total_rows_Entries As Long\nDim Total_rows_Payees As Long\nDim Total_rows_Accounts As Long\n\nWorkbooks(\"ONLINE-CASH VOUCHER.xlsm\").Activate\n\nWith Worksheets(\"Entries\").ListObjects(\"Entries\").ListColumns(3).Range\nTotal_rows_Entries = .Find(What:=\"*\", _\n    After:=.Cells(1), _\n    Lookat:=xlPart, _\n    LookIn:=xlFormulas, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious, _\n    MatchCase:=False).Row\nEnd With\n\nWith Worksheets(\"List of Payees\").ListObjects(\"ListofPayees\").ListColumns(1).Range\nTotal_rows_Payees = .Find(What:=\"*\", _\n    After:=.Cells(1), _\n    Lookat:=xlPart, _\n    LookIn:=xlFormulas, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious, _\n    MatchCase:=False).Row\nEnd With\n\nWith Worksheets(\"List of Accounts\").ListObjects(\"ListofAccounts\").ListColumns(1).Range\nTotal_rows_Accounts = .Find(What:=\"*\", _\n    After:=.Cells(1), _\n    Lookat:=xlPart, _\n    LookIn:=xlFormulas, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious, _\n    MatchCase:=False).Row\nEnd With\n\n'Problem is in this section    \nDim vArr As String\nDim lastColumn As Long\nDim wb As Workbook\nDim WS As Excel.Worksheet\nDim copy_Path As String\nDim open_wb As Boolean\n\ncopy_Path = \"C:\\Users\\Asus\\Desktop\\\"\nFor Each WS In Workbooks(\"ONLINE-CASH VOUCHER.xlsm\").Worksheets\n    If WS.Name = \"Entries\" Or WS.Name = \"List of Accounts\" Or WS.Name = \"List of Payees\" Then\n        lastColumn = Worksheets(WS.Name).Cells(1, Columns.Count).End(xlToLeft).Column\n        vArr = Split(Cells(1, lastColumn).Address(True, False), \"$\")(0)\n        Worksheets(WS.Name).Range(\"A1:\" &amp; vArr &amp; Total_rows_Entries).Copy\n        Set wb = Workbooks.Add\n        'Error is this ActiveSheet.Paste\n        ActiveSheet.Paste\n        Application.DisplayAlerts = False\n        open_wb = IsWorkBookOpen(copy_Path &amp; WS.Name &amp; \".xlsx\")\n        If open_wb = True Then\n            Workbooks(WS.Name &amp; \".xlsx\").Close\n        End If\n        wb.SaveAs copy_Path &amp; WS.Name &amp; \".xlsx\"\n        Application.DisplayAlerts = True\n        ActiveWorkbook.Close\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "pivot-table", "invalid-argument"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1531283416, "post_id": 51276983, "comment_id": 89532124, "body": "Late-Bound <code>Set xlApp = CreateObject(&quot;Excel.Application&quot;)</code>doesn&#39;t know the enums (e.g. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlpivottableversionlist-enumeration-excel\" rel=\"nofollow noreferrer\">xlPivotTableVersion15</a> = 5).-&gt; non declared var, value is wrong. You have to use the integer value or create your own enum or const. This won&#39;t happen with <code>Option Explicit</code>!"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1531290787, "post_id": 51276983, "comment_id": 89534802, "body": "@ComputerVersteher: Total agree with <code>Option Explicit</code>. However, the VBA compiler does know the enum even when using late binding as long as the reference is part of the project - which is alwasy true for the Excel library. However, <code>xlPivotTableVersion15</code> is valid (and defined) starting with Excel 2013, so if you are on 2010 (or earlier), it is unknown."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531291060, "post_id": 51276983, "comment_id": 89534926, "body": "@FunThomas: No, the Excel Lib is not a standard reference of ms access, which executes the code if tags are correct!"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1531291378, "post_id": 51276983, "comment_id": 89535075, "body": "oh, you&#39;re right. Didn&#39;t saw that tag. Anyhow, that doesn&#39;t solve the problem, there is something else wrong"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1531292441, "post_id": 51276983, "comment_id": 89535669, "body": "You too, <code>Dim myRange As Range</code> needs the reference! So it is there. I have no proper sheet to test the code, sorry."}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "edited": false, "score": 0, "creation_date": 1531314764, "post_id": 51276983, "comment_id": 89550247, "body": "But the Dim myRange As Range worked in my loop in the above part of the code when I added the highlight styling. How else do I need to reference it?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1531947536, "post_id": 51276983, "comment_id": 89793248, "body": "I do not see an Dim xlLo.  Has the Set gone out of scope? Option Explicit?"}], "owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594632294, "creation_date": 1531281037, "last_edit_date": 1594632294, "question_id": 51276983, "link": "https://stackoverflow.com/questions/51276983/vba-access-pivot-table-coding", "title": "VBA Access Pivot Table Coding", "body": "<p>I am having trouble getting past this one error when creating my Pivot Tables. It keeps saying there is an \"Invalid Procedure Call or Argument\" on </p>\n\n<pre><code>Sub AlternateRowColors()\n\nDim lastAddress As String\n\nDim myRange As Range, xlApp As Object, xlBook As Object, xlSheet As Object, xlObj As Object, xlPC As Object, xlPT As Object, xlPI As Object\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\nSet xlBook = xlApp.Workbooks.Open(\"L:\\WF Reporting\\Superdash\\Superdash_Reporting.xlsx\")\n\nSet xlSheet = xlBook.Sheets(4)\n\nxlApp.Visible = True\n\n\nFor Each Sheet In xlBook.Sheets  \n  lastAddress = Sheet.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Address\nSheet.Activate\n  Set xlLo = Sheet.ListObjects.Add(xlSrcRange, Range(\"A1:\" &amp; lastAddress), , xlYes)\n  xlLo.TableStyle = \"TableStyleMedium16\"  \n\n\nNext Sheet\n\n    Set xlPC = xlBook.PivotCaches.Create(xlDatabase, \"tbl_Superdash_Bot_Rpt\", xlPivotTableVersion15) \nSet xlObj = xlBook.Sheets.Add(xlSheet)\nSet xlPT = xlPC.CreatePivotTable(xlLo.Range(\"A3\"), \"Superdash_Bot_pivot\") \nxlObj.Name = \"Summary\"\n\nWith xlPT\n    .RowAxisLayout xlTabularRow\n    .InGridDropZones = True\n    .DisplayErrorString = True\n    .ShowTableStyleRowStripes = True\n\n With .PivotFields(\"Bot_Skill_Name\")\n    .Orientation = xlPageField\n End With\n\n\n With .PivotFields(\"Human_Skill_Name\")   \n        .Orientation = xlPageField\n End With\n\nEnd With\n\nxlBook.Save  \nxlBook.Close \nxlApp.Quit   \n\nEnd Sub\n</code></pre>\n\n<p>I am getting an error on the </p>\n\n<pre><code>Set xlPT = xlPC.CreatePivotTable(xlLo.Range(\"A3\"), \"Superdash_Bot_pivot\")'\n</code></pre>\n\n<p>line. It is saying that there is an </p>\n\n<blockquote>\n  <p>Invalid Call or Argument</p>\n</blockquote>\n\n<p>. It seems to me that all of these are previously defined. What am I missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531274741, "post_id": 51276183, "comment_id": 89530292, "body": "You repeated that mistake with F33 in the LaminatedBench paragraph. The second F33 should be G33. You still have &#39;... When <b>F33</b> is cleared/changed, clear cell: H33 &amp; L33. ...&#39;."}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531275108, "post_id": 51276183, "comment_id": 89530377, "body": "@Jeeped. HI mate. Sorry, I have edited the question as it was picking up the old question. Are u able to look into it after the changes.Thanks mate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531275355, "post_id": 51276183, "comment_id": 89530432, "body": "You&#39;ve copied a lot of the old question but you haven&#39;t explained what new things you want to do with the wall tiles table."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531278662, "post_id": 51276336, "comment_id": 89531101, "body": "Are you able to adjust my code? I have so many tables, and it will be very time consuming to adjust your code for all the tables that I have created (where the code I am using, which i pasted in my question, works great for others bigger tables). Please, can you give it a go?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531278959, "post_id": 51276336, "comment_id": 89531151, "body": "I don&#39;t agree with that coding method. While it is considered &#39;best practice&#39; to avoid triggering a worksheet_change that runs on top of itself through disabling events, that method of code actually uses it in a perverse form of loop. So, no; I&#39;m sorry but I won;t rework that code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531279067, "post_id": 51276336, "comment_id": 89531168, "body": "If you have a lot of tables with different layouts and you cannot loop them or union them then you are just going to have to do it brick-by-brick."}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531279189, "post_id": 51276336, "comment_id": 89531185, "body": "Ok mate. If you think your code is better, I will start adjusting it to my needs. Thanks mate!"}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531350518, "post_id": 51276336, "comment_id": 89568104, "body": "I am trying to adjust your code for all my other tables but I am confused as to why you used &quot;Dim c as Range&quot; in one code and &quot;Dim 1b as Range&quot; in the other two codes. Could you please advise if I should keep using 1b for all my other codes?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531351716, "post_id": 51276336, "comment_id": 89568415, "body": "a) Actually, that was EL-BEE, not ONE-BEE as in <b>L</b>aminated<b>B</b>ench. b) I try not to dim a var until I know I will need it. That&#39;s why all the vars are dimmed inside the If statements. However, in your case you should probably just dim a single one at the very top and use the same one for all of the different variations."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531352968, "post_id": 51276336, "comment_id": 89568641, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174843/discussion-between-jeeped-and-omar\">continue this discussion in chat</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531377165, "post_id": 51276336, "comment_id": 89574329, "body": "@Omar - please see <a href=\"https://stackoverflow.com/questions/51298646/running-worksheet-change-on-top-of-itself-intentionally\">this</a>"}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1531385422, "post_id": 51276336, "comment_id": 89579201, "body": "I saw it and I created a spreadsheet with the same values and code you posted. The problem is once I clear a cell say D12,I can no longer enter a value in D12. When can we chat again? I am running out of time to deliver this spreadhseet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1531275686, "creation_date": 1531275686, "answer_id": 51276336, "question_id": 51276183, "link": "https://stackoverflow.com/questions/51276183/vba-clearing-cells-based-on-clearing-changing-another-cell-and-applying-it-to-al/51276336#51276336", "title": "VBA clearing cells based on clearing/changing another cell and applying it to all rows", "body": "<p>Add this section to  the code I responded with in your <a href=\"https://stackoverflow.com/questions/51255008/vba-clearing-cells-based-on-clearing-changing-another-sell-and-applying-it-to-al/51256435#51256435\">previous question</a>.</p>\n\n<pre><code>'WallTiles\nIf Not Intersect(Target, Range(\"A96:A113\")) Is Nothing Then\n    On Error GoTo safe_exit\n    Application.EnableEvents = False\n    Dim wt As Range\n    For Each wt In Intersect(Target, Range(\"A96:A113\"))\n        If IsEmpty(wt) Then _\n            wt.Resize(1, 2).ClearContents\n    Next lb\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531275686, "creation_date": 1531274341, "last_edit_date": 1531275067, "question_id": 51276183, "link": "https://stackoverflow.com/questions/51276183/vba-clearing-cells-based-on-clearing-changing-another-cell-and-applying-it-to-al", "title": "VBA clearing cells based on clearing/changing another cell and applying it to all rows", "body": "<p>have two tables on the same excel sheet. The first table is named Cabinet, and its range is $A$12:$AN$29 The second table is named WallTiles, and its range is $A$96:$AN$113</p>\n\n<p>For the table \"Cabinet\":</p>\n\n<p>I am trying to create a macro, that allows the following: When A12 is cleared/changed, clear cells: B12, C12, D12 &amp; H12. When B12 is cleared/changed, clear cells: C12, D12 &amp; H12. When C12 is cleared/changed, clear cells: D12 &amp; H12.</p>\n\n<p>Similarly: When A13 is cleared/changed, clear cells: B13, C13, D13 &amp; H13. When B13 is cleared/changed, clear cells: C13, D13 &amp; H13. When C13 is cleared/changed, clear cells: D13 &amp; H13. &amp; This applies to all the rows from Row12 to Row29.</p>\n\n<p>For the table \"WallTiles:</p>\n\n<p>I am trying to create a macro, that allows the following: When A96 is cleared, clear cells: B96 &amp; F 96. This applies to all the rows from Row96 to Row113.</p>\n\n<p>I am using the below code that @Dy.Lee gave me and it worked great for the Cabinet table:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rngDB As Range\nIf Target.Count &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Range(\"a12\", \"c29\")) Is Nothing Then\n    Set rngDB = Range(Target.Offset(, 1), Range(\"d\" &amp; Target.Row))\n    Set rngDB = Union(rngDB, Range(\"h\" &amp; Target.Row))\n    rngDB.ClearContents\nEnd If\nEnd Sub\n</code></pre>\n\n<p>However, When I apply it to table WallTiles, it works by clearing B and F, but it doesn't let me enter values in column B.I need to enter data in B96: B113.</p>\n\n<pre><code>    If Target.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Range(\"a96\", \"b113\")) Is Nothing Then\n    Set rngDB = Range(Target.Offset(, 1), Range(\"b\" &amp; Target.Row))\n    Set rngDB = Union(rngDB, Range(\"f\" &amp; Target.Row))\n    rngDB.ClearContents\n    End If\n</code></pre>\n\n<p>Please help!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1531274721, "post_id": 51276107, "comment_id": 89530287, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime\">Multiple Variable Arguments to Application.OnTime</a>"}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1531274600, "last_edit_date": 1531274600, "creation_date": 1531274182, "answer_id": 51276162, "question_id": 51276107, "link": "https://stackoverflow.com/questions/51276107/how-do-you-call-a-procedure-that-has-parameters-on-the-application-ontime-functi/51276162#51276162", "title": "How do you call a procedure that has parameters on the Application.onTime function?", "body": "<p>I hate to say this but you need even <em>more</em> quotes :-) However, there's no real need to split out the internal quotes into separate strings, you can just use:</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:05\"), \"'popUpReminder \"\"Hello\"\"'\"\n</code></pre>\n\n<p>Perhaps a more viewable example would be a function that takes a single integer. That would be:</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:05\"), \"'checkAnswer 42'\"\n</code></pre>\n\n<p>You can see there that the entire statement is quoted.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1531274570, "creation_date": 1531274570, "answer_id": 51276202, "question_id": 51276107, "link": "https://stackoverflow.com/questions/51276107/how-do-you-call-a-procedure-that-has-parameters-on-the-application-ontime-functi/51276202#51276202", "title": "How do you call a procedure that has parameters on the Application.onTime function?", "body": "<p>You need a single quote on either side and a slight reformatting:</p>\n\n<pre><code>Sub popUpReminder(msg As String)\n    MsgBox (msg)\nEnd Sub\n\nSub schedulePopUp()\n    Application.OnTime Now + TimeValue(\"00:00:05\"), \"'popUpReminder(\"\"Hello\"\")'\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1531291747, "creation_date": 1531291747, "answer_id": 51278934, "question_id": 51276107, "link": "https://stackoverflow.com/questions/51276107/how-do-you-call-a-procedure-that-has-parameters-on-the-application-ontime-functi/51278934#51278934", "title": "How do you call a procedure that has parameters on the Application.onTime function?", "body": "<h2>Passing a Method With Parameters as a String</h2>\n\n<ul>\n<li>Enclose the whole procedure with parameters inside single quotes/Chr(39)</li>\n<li>Add space after parameter </li>\n<li>Wrap String values inside double quotes/Chr(35)</li>\n<li>Wrap Dates with hashes/Chr(35)</li>\n</ul>\n\n<p>\u2191These Rules\u2191 work for both <code>Application.OnTime</code>, <code>Application.Run</code> or <code>Control.OnAction</code>.  </p>\n\n<p>You could do all the above every time or you could just write a subroutine to do it for you.  Or you could just copy and paste the one I wrote:</p>\n\n<pre><code>Sub Test()\n    Application.OnTime Now + TimeValue(\"00:00:01\"), WrapMacro(\"popUpReminders \", 1, 2, \"3\", \"Tin\", \"Man\", Date)\n    Application.Run WrapMacro(\"popUpReminders\", 1, 2, \"3\", \"Tin\", \"Man\", Date)\n    ActiveSheet.Buttons.Add(0, 0, 72, 72).OnAction = WrapMacro(\"popUpReminders \", 1, 2, \"3\", \"Tin\", \"Man\", Date)\nEnd Sub\n\nFunction WrapMacro(ProcName As String, ParamArray Args() As Variant) As String\n    Dim n As Long\n    For n = 0 To UBound(Args)\n        If TypeName(Args(n)) = \"String\" Then          'Surround with Double Quotes\n            Args(n) = Chr$(34) &amp; Args(n) &amp; Chr$(34)\n        ElseIf TypeName(Args(n)) = \"Date\" Then        'Surround with Hashes\n            Args(n) = Chr$(35) &amp; Args(n) &amp; Chr$(35)\n        End If\n    Next\n\n    WrapMacro = Chr$(39) &amp; ProcName &amp; Space(1) &amp; Join(Args, \",\") &amp; Chr$(39)\nEnd Function\n\nSub popUpReminders(ParamArray Args() As Variant)\n    MsgBox Join(Args, vbNewLine)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KuIWe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KuIWe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5884122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af53dd19d9deeae079490c1fe9a8836c?s=128&d=identicon&r=PG&f=1", "display_name": "MDMacKillop", "link": "https://stackoverflow.com/users/5884122/mdmackillop"}, "is_accepted": false, "score": 0, "last_activity_date": 1540289043, "creation_date": 1540289043, "answer_id": 52946331, "question_id": 51276107, "link": "https://stackoverflow.com/questions/51276107/how-do-you-call-a-procedure-that-has-parameters-on-the-application-ontime-functi/52946331#52946331", "title": "How do you call a procedure that has parameters on the Application.onTime function?", "body": "<p>Another variation for repeating events</p>\n\n<pre><code>Sub Test()\nFor i = 5 To 12\nApplication.OnTime TimeValue(Format(i, \"00\") &amp; \":00:00\"), \"'DoCopy \" &amp; i &amp; \"'\"\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9457910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JCo", "link": "https://stackoverflow.com/users/9457910/jco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1540289043, "creation_date": 1531273672, "question_id": 51276107, "link": "https://stackoverflow.com/questions/51276107/how-do-you-call-a-procedure-that-has-parameters-on-the-application-ontime-functi", "title": "How do you call a procedure that has parameters on the Application.onTime function?", "body": "<p>\nHow do I call a procedure on the Application.onTime function when the procedure being called has a parameter?\n</p>\n\n<pre><code>Sub popUpReminder(msg As String)\n    MsgBox (msg)\nEnd Sub\n\nSub schedulePopUp()\n    Application.OnTime Now + TimeValue(\"00:00:05\"), \"popUpReminder \" &amp; \"\"\"\" &amp; \"Hello\" &amp; \"\"\"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1531273921, "post_id": 51276091, "comment_id": 89530142, "body": "What does your code have to do with removing <code>{&quot;isaId&quot;:</code> ?"}, {"owner": {"reputation": 69, "user_id": 10061960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RkgRgiuyicY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pW5AWU268unKqXb2mWv31DuJTuPg/mo/photo.jpg?sz=128", "display_name": "Joseph Bay", "link": "https://stackoverflow.com/users/10061960/joseph-bay"}, "edited": false, "score": 0, "creation_date": 1531274991, "post_id": 51276091, "comment_id": 89530346, "body": "Sorry, I may have worded my question incorrectly. I am approaching it as looking for &quot;2&quot; with 5 random numbers and &quot;703,&quot; and when found, replace the entire value of the cell with just the number found in the cell. Hopefully that makes sense. I have not had to do this before so I am not even sure if I am wording my question correctly."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1531276761, "creation_date": 1531276761, "answer_id": 51276453, "question_id": 51276091, "link": "https://stackoverflow.com/questions/51276091/vba-looping-through-column-with-dynamic-data-set-and-deleting-specific-text-fro/51276453#51276453", "title": "VBA: Looping through column with dynamic data set and deleting specific text from each cell", "body": "<p>Try this basic Regular Expression (RegEx) matching.</p>\n\n<pre><code>Sub find2_____703()\n\n    Dim i As Long, str As String\n    Static rgx As Object\n\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n        rgx.Pattern = \"2\\d{5}703\"\n    End If\n\n    With Worksheets(\"test\")\n        For i = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            str = .Cells(i, \"A\").Value2\n            With rgx\n                If .Test(str) Then\n                    str = .Execute(str).Item(0)\n                End If\n            End With\n            .Cells(i, \"A\") = str\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The pattern is the number two, then exactly five random digits between zero and nine then seven-oh-three.</p>\n"}], "owner": {"reputation": 69, "user_id": 10061960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RkgRgiuyicY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pW5AWU268unKqXb2mWv31DuJTuPg/mo/photo.jpg?sz=128", "display_name": "Joseph Bay", "link": "https://stackoverflow.com/users/10061960/joseph-bay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 51276453, "answer_count": 1, "score": 1, "last_activity_date": 1531276761, "creation_date": 1531273536, "question_id": 51276091, "link": "https://stackoverflow.com/questions/51276091/vba-looping-through-column-with-dynamic-data-set-and-deleting-specific-text-fro", "title": "VBA: Looping through column with dynamic data set and deleting specific text from each cell", "body": "<p>I have a problem;</p>\n\n<p>I am tying to create a macro that will run through a column in a sheet, in this case column A, and loop through each cell containing data. Whenever the macro loops through a cell, I need it to delete a specific set of text from each cell. This text I need to delete will never change as the data is the same from a website I pull from. However the text I need to delete will always be followed by a string of numbers, which in this case represents incoming freight orders to the facility where I work. </p>\n\n<p>Example of data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LRSuJ.png\" rel=\"nofollow noreferrer\">Example Data</a></p>\n\n<p>I tried creating a macro that will leave the numbers but delete {\"isaId\": specifically. I need the numbers by themselves to copy into an HTML send request in another part of the tool I am making. </p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>Sub Test2()\n    Dim test As Worksheet\n        Set test = Worksheets(\"test\")\n    Dim testcheck As Boolean\n    Range(\"A2\").Select\n\n    Do Until IsEmpty(ActiveCell)\n        If testcheck = \"27*703\" Like \"276782703\" = True Then\n\n'   276782703 is just an example number; the numbers will always be in this format, meaning they will always start with 2 and end with 703 with five random numbers in-between.\n\n            ActiveCell.FormulaR1C1 = testcheck\n                ActiveCell.Offset(1, 0).Select\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I think I may be using wildcards incorrectly, though I am not sure, and the code I have gives me an error, so I'm stumped. Any help would be greatly appreciated.</p>\n"}]