[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "edited": false, "score": 0, "creation_date": 1554955359, "post_id": 55622720, "comment_id": 97941381, "body": "have you tried recording the action you do manually to import an excel. Enable recording on Developer tab on Data tab, New query, From XML"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1554985319, "post_id": 55622720, "comment_id": 97955818, "body": "Where&#39;s your XML? You need to either flatten it with XSLT to import or parse nodes by their levels with XPath to retrieve values."}], "owner": {"reputation": 1, "user_id": 11343201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cac5602a6b1b3243265e329ea243054?s=128&d=identicon&r=PG", "display_name": "Leila", "link": "https://stackoverflow.com/users/11343201/leila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984264, "creation_date": 1554939510, "last_edit_date": 1554984264, "question_id": 55622720, "link": "https://stackoverflow.com/questions/55622720/import-xml-file", "title": "Import xml file", "body": "<p>I am programming in the VBA source code a logic to import an xml file into excel, but I do not know which function to parse in the spreadsheet.</p>\n\n<p>Trying this command but it does not work:</p>\n\n<pre><code>  ActiveWorkbook.XmlImport Url:=sArquivo, ImportMap:=Nothing, Overwrite:=True, Destination:=Range(\"$A$1\")\n</code></pre>\n\n<p>Code: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n\n&lt;!DOCTYPE CFXML [\n</code></pre>\n\n<p>I want to import the tags: \n<code>\"&lt;ProductDescription&gt;\", \"&lt;Quantity&gt;\", \"&lt;MonetaryAmount&gt;\", \"&lt;ProductTypeCode&gt;\", \"&lt;ProprietaryProductIdentifier&gt;\", \"&lt;ProductIdentifierTypeCode&gt;\"</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554937653, "post_id": 55622486, "comment_id": 97937916, "body": "The Worksheet Change event doesn&#39;t fire when a cell changes value due to formula recalculation. You can use the Worksheet Calculate event for that. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.calculate(even)\" rel=\"nofollow noreferrer\">Here&#39;s</a> the documentation."}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554938566, "post_id": 55622486, "comment_id": 97938120, "body": "@BigBen Great! Would you recommend something other than my intersect function to monitor for the changes?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554939161, "post_id": 55622486, "comment_id": 97938251, "body": "I think you&#39;re referring to the fact that the Calculate event doesn&#39;t have a <code>Target</code> argument? Pretty sure there are examples here on SO of how to do it - basically you  populate an array with the original values of <code>A4:Q4</code> when the workbook opens, with the Workbook Open event. Then in the Calculate event, compare the new values to the previous. If anything changed, copy to sheet2, then update the array with the new values."}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554947466, "post_id": 55622486, "comment_id": 97939929, "body": "@BigBen Thanks. I&#39;m not very knowledgeable with arrays or how to compare them to one another. I&#39;ve made an update in my original question above declaring individual variables (as that&#39;s what I know how to do) along the lines of what I think you&#39;re suggesting, but when I ran it again, it copy and pastes about 80 rows of the same thing into Sheet2. I only need one per change. Hope you still have some insight. Thanks a lot!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554949653, "post_id": 55622486, "comment_id": 97940354, "body": "If 2 or more cells change simultaneously, should the row get copied more than once to sheet 2?"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554950194, "post_id": 55622486, "comment_id": 97940448, "body": "@BigBen I would say, if 2 cells change simultaneously, it could be copied over only once"}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554951700, "post_id": 55623907, "comment_id": 97940707, "body": "Thank you so much for all your help, but I&#39;m still having an issue. I&#39;ve updated my question above with screenshots, but now when I first open the workbook, and manually make a change just to simulate a changing RTD cell, I get an error Out of Stack Space, and then when I click debug it pastes it 82 times into Sheet2 :O I double checked that I have all of the codes in their proper modules as well."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554951753, "post_id": 55623907, "comment_id": 97940716, "body": "I saw your update. Do you have any code in the sheet2 code module?"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554951860, "post_id": 55623907, "comment_id": 97940738, "body": "Negative. Only Sheet1, ThisWorkbook and a module with the appropriate code segments. I don&#39;t know if it matters, but I&#39;m also copying the time over from Sheet1 with is the value in cell R4, but that is not one of the cells being monitored in the range, just one that gets copied so I don&#39;t imagine that&#39;s it?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554952197, "post_id": 55623907, "comment_id": 97940787, "body": "It&#39;s actually because of that. I assume the formula in <code>R4</code> is <code>=NOW()</code>? I&#39;ll make an edit."}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554952305, "post_id": 55623907, "comment_id": 97940814, "body": "Oh god, sorry about that. Yes R4 is =NOW()"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554953350, "post_id": 55623907, "comment_id": 97940997, "body": "Worked! Thanks a million for all your help. I&#39;ll give this solution the mark as the answer. My only concern is that, the RTD is stalled for the night as it&#39;s stock data that I&#39;m pulling and the markets are closed so the RTD data isn&#39;t streaming (much) during the evening, so first thing tomorrow morning I&#39;ll confirm that the RTD updates are copying over, and not just me manually changing the Sheet1.Range values to test like I am now. If you don&#39;t hear back from me, it works! Thanks again, you taught me a lot from your solution!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 1, "creation_date": 1554953384, "post_id": 55623907, "comment_id": 97941006, "body": "Happy coding! Glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1554952655, "last_edit_date": 1554952655, "creation_date": 1554950517, "answer_id": 55623907, "question_id": 55622486, "link": "https://stackoverflow.com/questions/55622486/log-rtd-value-changes-in-another-worksheet/55623907#55623907", "title": "Log &#39;RTD&#39; Value Changes in Another Worksheet", "body": "<p>As noted in the comments, the Worksheet.Change event doesn't fire when a cell changes value due to formula recalculation. So you can use the Worksheet.Calculate event. </p>\n\n<p>Unlike the Worksheet.Change event, there is no <code>Target</code> in the Worksheet.Calculate event. You can test that a cell within your specific range has recalculated using the following:</p>\n\n<hr>\n\n<ol>\n<li><p>In the <code>ThisWorkbook</code> code module:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    PopulateKeyValueArray\nEnd Sub\n</code></pre></li>\n<li><p>In the <code>Sheet1</code> code module:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    On Error GoTo SafeExit\n    Application.EnableEvents = False\n\n    Dim keyCells As Range\n    Set keyCells = Me.Range(\"A4:Q4\")\n\n    Dim i As Long\n    For i = 1 To UBound(KeyValues, 2)\n        If keyCells(, i).Value &lt;&gt; keyValues(1, i) Then\n\n            Dim lastRow As Long\n            With Sheet2\n                lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n                .Range(\"A\" &amp; lastRow &amp; \":R\" &amp; lastRow).Value =   Me.Range(\"A4:R4\").Value\n            End With\n\n            Exit For\n        End If\n    Next i\n\nSafeExit:\n    PopulateKeyValueArray\n    Application.EnableEvents = True\nEnd Sub\n</code></pre></li>\n<li><p>In a normal code module:</p>\n\n<pre><code>Public keyValues()\n\nPublic Sub PopulateKeyValueArray()\n    keyValues = Sheet1.Range(\"A4:Q4\").Value\nEnd Sub\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>(1): <code>keyValues</code> is a <code>Public</code> array that is populated with the values in <code>keyCells</code> when the workbook first opens.</p>\n\n<p>(2): When any cell changes due to formula recalculation in <code>Sheet1</code>, the values in <code>keyCells</code> are compared one-by-one to their corresponding element in <code>keyValues</code>. If there is a difference, i.e. a cell in <code>keyCells</code> has been updated, then the latest values in <code>A4:R4</code> are written to the next available row in <code>Sheet2</code>. The <code>Exit For</code> ensures that this value transfer only happens once, even if multiple cells have changed. Finally, <code>keyValues</code> is updated with the latest values in <code>keyCells</code>. </p>\n\n<p>(3): <code>PopulateKeyValueArray</code> reads the values from <code>Sheet1:Range(\"A4:Q4\")</code> into the <code>keyValues</code> array.</p>\n\n<p>Note that <code>keyValues</code> will be empty when you first add the code to your workbook, so either save and re-open, or run <code>PopulateKeyValueArray</code> to populate the array.</p>\n"}], "owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 55623907, "answer_count": 1, "score": 0, "last_activity_date": 1554984246, "creation_date": 1554937585, "last_edit_date": 1554984246, "question_id": 55622486, "link": "https://stackoverflow.com/questions/55622486/log-rtd-value-changes-in-another-worksheet", "title": "Log &#39;RTD&#39; Value Changes in Another Worksheet", "body": "<p>I'm having some issues finding an answer for this.</p>\n\n<p>In Sheet1, I have a range of cells (\"A4:Q4\") that all have certain RTD functions in them, where they are gathering real time stock data from an outside program. These cells update every few seconds, depending on the changes from the parent program.</p>\n\n<p>What I want to do, is have it so that every time any value in that range changes (ie. everytime the RTD values update), copy that range's values and paste them to the next available empty row in Sheet2. This should effectively create a long list of values, but I'm having an issue with the RTD stuff. My current code will do what I want, but only if the values in the range are changed manually, NOT when the RTD values get updated. Even when the RTD values are updating/changing, it's not copying those new values over to Sheet2, if that makes sense. It would seem it has something to do with the macro not realizing that the values are changing automatically. When I make my own changes to the values in that range, it works, but that renders the RTD functions in the cells useless.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Worksheets(\"Sheet1\").Range(\"A4:Q4\")\n\n    ' Wait for change to happen...\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n\n\n    ' once change happens, copy the range (yes keep R4 value too)\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A4:R4\").Copy\n\n    ' Paste it into the next empty row of Sheet2\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        Dim NextRow As Range\n        Set NextRow = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A\" &amp; .UsedRange.Rows.Count + 1)\n        NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n\n        Application.CutCopyMode = False\n\n    End With\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'm thinking a potential solution would be to make a loop where by it stores each value in that range, and then every half a second or 1 second it would compare the stored values to the \"current\" values and see if there's any change. If there is, copy that range's values to Sheet2. But this seems clunky.</p>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["excel", "vba", "loops", "object", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11214929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JV8vY.png?s=128&g=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/11214929/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1555006273, "creation_date": 1555006273, "answer_id": 55638800, "question_id": 55622382, "link": "https://stackoverflow.com/questions/55622382/looping-through-activex-comboboxes-on-a-worksheet-and-assigning-named-range-to-l/55638800#55638800", "title": "Looping through activeX ComboBoxes on a worksheet and assigning named range to listfill", "body": "<p>I think I found a cleaner way to do this. I did not realize that you do not have to specify the worksheet for the named range even though the ranges are on a separate sheet.In this example, <code>\"Range1\"</code> and <code>\"Range2\"</code> are on their own worksheet. Also, it works without declaring the <code>ComboBoxes</code> as Objects. <code>ComboBoxes</code> are left to the default names of <code>ComboBox1</code>, <code>ComboBox2</code>, and <code>ComboBox3</code>.\nCame to this solution via <a href=\"https://stackoverflow.com/questions/36429846/populating-combobox-from-named-ranges\">Populating combobox from named ranges</a></p>\n\n<p>I'm sure there would be a good way to loop this instead of making a unique <code>if</code> statement for each unique cell in <code>Range A1:A3</code> and associated <code>ComboBox</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim result As String\nDim search1P As String\nDim search2P As String\n\nsearch1P = \"1P\"\nsearch2P = \"2P\"\n\nIf Not Intersect(Target, Range(\"A1:A3\")) Is Nothing Then 'if target is within range A1:A3\n\nresult = Target.Value ' set result variable equal to whatever the target cell value is\n\nIf Not Intersect(Target, Range(\"A1\")) Is Nothing Then 'if cell A1, evaluate cb1\n\n    If InStr(UCase(result), search1P) &lt;&gt; 0 Then 'if result variable contains \"1P\" then\n    ComboBox1.ListFillRange = \"Range1\" 'Populate cb1 with \"Range1\"\n    ElseIf InStr(UCase(result), search2P) &lt;&gt; 0 Then 'if result variable contains \"2P\" then\n    ComboBox1.ListFillRange = \"Range2\" 'populate combobox with \"Range2\"\n    Else: ComboBox1.ListFillRange = \"\" 'leave cb blank if source cell is invalid\n    End If\n\nElseIf Not Intersect(Target, Range(\"A2\")) Is Nothing Then 'if cell A2, update cb2\n\n    If InStr(UCase(result), search1P) &lt;&gt; 0 Then 'if result variable contains \"1P\" then\n    ComboBox2.ListFillRange = \"Range1\" 'Populate cb1 with \"Range1\"\n    ElseIf InStr(UCase(result), search2P) &lt;&gt; 0 Then 'if result variable contains \"2P\" then\n    ComboBox2.ListFillRange = \"Range2\" 'populate combobox with \"Range2\"\n    Else: ComboBox2.ListFillRange = \"\" 'leave cb blank if source cell is invalid\n    End If\n\nElseIf Not Intersect(Target, Range(\"A3\")) Is Nothing Then 'if cell A2, update cb3\n\n    If InStr(UCase(result), search1P) &lt;&gt; 0 Then 'if result variable contains \"1P\" then\n    ComboBox3.ListFillRange = \"Range1\" 'Populate cb1 with \"Range1\"\n    ElseIf InStr(UCase(result), search2P) &lt;&gt; 0 Then 'if result variable contains \"2P\" then\n    ComboBox3.ListFillRange = \"Range2\" 'populate combobox with \"Range2\"\n    Else: ComboBox3.ListFillRange = \"\" 'leave cb blank if source cell is invalid\n    End If\n\nEnd If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11214929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JV8vY.png?s=128&g=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/11214929/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555006273, "creation_date": 1554936828, "last_edit_date": 1554998389, "question_id": 55622382, "link": "https://stackoverflow.com/questions/55622382/looping-through-activex-comboboxes-on-a-worksheet-and-assigning-named-range-to-l", "title": "Looping through activeX ComboBoxes on a worksheet and assigning named range to listfill", "body": "<p>I have columns A and B. Each cell in column B contains an activeX <code>ComboBox</code>. What I want is for the <code>ComboBox</code> in column B to populate in reference to a named range from a different sheet based on the input in column A (directly next to the combo box)</p>\n\n<p>To do this I need to run a loop through each <code>ComboBox</code> on the worksheet with nested IF statements, but cannot figure out how to loop through the combo box objects and then assign a named range to the combo box if other conditions are true.</p>\n\n<p>For simplicity, cell A1 would be next to <code>ComboBox1</code>. Cell A2 would be next to <code>ComboBox2</code> etc.</p>\n\n<p>Basic example:</p>\n\n<pre><code>myRange1 = ActiveWorkbook.Worksheets(\"Ranges\").Range(\"NamedRange1\")\nmyRange2 = ActiveWorkbook.Worksheets(\"Ranges\").Range(\"NamedRange2\")\ni = 1\n\nFor Each ComboBox on ActiveWorksheet\n\nIf Cell(\"A\" &amp; i) 'condition1 here' Then\nComboBoxi.ListFillRange = myRange1\ni = i+1\nElseif Cell(\"A\" &amp; i) 'condition2 here' Then\nComboBox'i'.ListFillRange = myRange2\ni = i+1\nElse 'do nothing\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1555031422, "last_edit_date": 1555031422, "creation_date": 1554940995, "answer_id": 55622882, "question_id": 55622244, "link": "https://stackoverflow.com/questions/55622244/merge-cells-in-table-with-ms-word-vba-macro/55622882#55622882", "title": "Merge cells in table with ms word VBA macro", "body": "<p>For excel VBA code writers, it is a common conceptual problem, we used to treat a blank  cell as empty (\"\"). but actually an apparently blank Word table cell  contains two invisible characters (at least in word 2007) i.e. <code>chr(13)</code> &amp; <code>Chr(7)</code>. it could be tested  with simple statement like</p>\n\n<pre><code>MsgBox Len(.Cell(1, 1).Range.Text)\nMsgBox Asc(Right(.Cell(1, 1).Range.Text, 1))\nMsgBox Asc(Left(.Cell(1, 1).Range.Text, 1))\n</code></pre>\n\n<p>so to make your code work it may be modified to something like</p>\n\n<pre><code>Sub merge()\nDim x As Integer, i As Integer, S As String\nx = ActiveDocument.Tables(1).Rows.Count\n    With ActiveDocument.Tables(1)\n      For i = 1 To x\n      S = .Cell(i, 2).Range.Text\n      S = Replace(S, Chr(13), \"\")\n      S = Replace(S, Chr(7), \"\")\n            If S = \"\" Then\n            .Cell(Row:=i, Column:=2).merge _\n            MergeTo:=.Cell(Row:=i, Column:=3)\n            .Borders.Enable = False\n            End If\n      Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>or test line may be modified to    </p>\n\n<pre><code>If Len(.Cell(i, 2).Range.Text) = 2 Then\n</code></pre>\n\n<p>also could not understand why in your code you are iterating to <code>ActiveDocument.Tables(1).Rows.Count+1</code> so for testing i used only <code>For i = 1 To x</code></p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1555138799, "creation_date": 1555138799, "answer_id": 55662927, "question_id": 55622244, "link": "https://stackoverflow.com/questions/55622244/merge-cells-in-table-with-ms-word-vba-macro/55662927#55662927", "title": "Merge cells in table with ms word VBA macro", "body": "<p>Try changing:</p>\n\n<pre><code>If .Cell(i, 2).Range.Text = \"\" Then\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>If Split(.Cell(i, 2).Range.Text,vbCr)(0) = \"\" Then\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11343046, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rqXcFCZWWtg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXhRnbVEwd2QiiM0tTbbcMnWXIYw/mo/photo.jpg?sz=128", "display_name": "smafeto", "link": "https://stackoverflow.com/users/11343046/smafeto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2021, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555138799, "creation_date": 1554936000, "question_id": 55622244, "link": "https://stackoverflow.com/questions/55622244/merge-cells-in-table-with-ms-word-vba-macro", "title": "Merge cells in table with ms word VBA macro", "body": "<p>I want to merge in one cell with vba, but not working.</p>\n\n<p>mycode :</p>\n\n<pre><code>Sub merge()\nDim x As Integer, i As Integer\nx = ActiveDocument.Tables(1).Rows.Count\n    With ActiveDocument.Tables(1)\n      For i = 1 To x + 1\n            If .Cell(i, 2).Range.Text = \"\" Then\n            .Cell(Row:=i, Column:=2).merge _\n            MergeTo:=.Cell(Row:=i, Column:=3)\n            .Borders.Enable = False\n            End If      \n      Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>In the document, I have a table (five row and three columns).</p>\n"}, {"tags": ["excel", "vba", "function", "arguments"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554936133, "post_id": 55622242, "comment_id": 97937535, "body": "I doubt your function has a worksheet parent: <code>Sheet1.extrapolatendg(currentRow)</code> should probably be just <code>extrapolatendg(currentRow)</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554936196, "post_id": 55622242, "comment_id": 97937556, "body": "If <code>row</code> is a <code>Range</code>, you can&#39;t do <code>Range(&quot;b&quot; &amp; row)</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554936703, "post_id": 55622242, "comment_id": 97937664, "body": "Also <code>Function extrapolatendg(row As Range) As Integer</code> will throw an error if the value is not an <code>Integer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1554979793, "creation_date": 1554979793, "answer_id": 55630707, "question_id": 55622242, "link": "https://stackoverflow.com/questions/55622242/passing-an-argument-to-a-function-error-type-13/55630707#55630707", "title": "Passing an argument to a function error type 13", "body": "<p>I do not think this function does what you think it does. Here's is what it's doing</p>\n\n<pre><code>Function extrapolatendg(row As Range) As Integer\n    'This is a function, it will do a calculation and return a value.\n    ' It's name is extrapolatendg, \n     '(it accepts a range object (either a single cell or a block of cells) and calls that range \"row\") \n     'It will return an Integer value\n\n     extrapolatendg = Range(\"b\" &amp; row).Value\n     'since the object called row is being used in a context that expects a value, \n      'VBA will use the default property of the object - in this case the Value property\n     'Find the Value property of the range called row \n     'if row is a single cell and has something in it that can be interpreted as a long then \n    'continue, otherwise throw an error of  \"Type Mismatch\".\n    'Concatenate that long with the letter \"b\"\n    'Pass that string as an argument to the function \"Range\" - \n    'This will return an object of type \"Range\"\n    'Obtain the value of the \"value\" property of this object\n    'Attempt to coerce this value into an Integer \n    '- if this succeeds, return this value as the result of the function extrapolatendg, \n    'otherwise throw an error \"Type Mismatch\"\n\n End Function  'finished\n</code></pre>\n\n<p>Note that in order to use it you must pass the range argument it is expecting, so</p>\n\n<pre><code>        Function findrownumberndg(extrapolatendg(Some cell reference goes here) As Integer)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11314225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MV3s8DBIIU0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdc6vZerxyUFXVnietmbp5rJZWbBA/mo/photo.jpg?sz=128", "display_name": "mendax88", "link": "https://stackoverflow.com/users/11314225/mendax88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554979793, "creation_date": 1554935981, "last_edit_date": 1554936930, "question_id": 55622242, "link": "https://stackoverflow.com/questions/55622242/passing-an-argument-to-a-function-error-type-13", "title": "Passing an argument to a function error type 13", "body": "<p>I am currently getting a type 13 error because a function seems to be getting a wrong argument. What am I doing wrong?</p>\n\n<p>Sheet 1 function (when the sub calls this function it generates a type 13 error):</p>\n\n<pre><code>Function extrapolatendg(row As Range) As Integer\n\nextrapolatendg = Range(\"b\" &amp; row).Value\n\nEnd Function\n</code></pre>\n\n<p>Sheet 6 function:</p>\n\n<pre><code>Function findrownumberndg(extrapolatendg As Integer)\n\nSet foundcell = Range(\"a:a\").Find(extrapolatendg, lookat:=xlWhole)\n\nIf Not foundcell Is Nothing Then\n\nfindrownumberndg = 0\n\nElse\n\nfindrownumberndg = foundcell.row\n\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>thisworkbook sub actioning functions</p>\n\n<pre><code>Sub getndg()\n\nFor x = 6 To sheet1lastrow()\n\nDim currentRow As Range\nSet currentRow = Sheet1.Rows(x)\n\nextraolatendg = Sheet1.extrapolatendg(currentRow)\n\nSheet6.findrownumberndg (extrapolatendg)\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I would expect the extrapolatendg function to take the cell value and pass it to the findrownumberndg in order to return the row number in another sheet.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554935865, "post_id": 55622177, "comment_id": 97937468, "body": "What Microsoft page are you referencing? By the way, is the <code>=</code> a typo? Seems like it."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 2, "last_activity_date": 1554980169, "creation_date": 1554980169, "answer_id": 55630842, "question_id": 55622177, "link": "https://stackoverflow.com/questions/55622177/what-are-some-other-methods-i-can-use-instead-of-activepresentation-in-powerpo/55630842#55630842", "title": "What are some other methods I can use INSTEAD of &quot;ActivePresentation&quot; in PowerPoint VBA", "body": "<p>Don't copy, duplicate</p>\n\n<pre><code>Dim NewSlide as Slide\nSet newSlide = ActivePresentation.Slides(1).Duplicate\nNewSlide.MoveTo toPos:=4  'move it to become the fourth slide\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1555085681, "creation_date": 1555085681, "answer_id": 55655772, "question_id": 55622177, "link": "https://stackoverflow.com/questions/55622177/what-are-some-other-methods-i-can-use-instead-of-activepresentation-in-powerpo/55655772#55655772", "title": "What are some other methods I can use INSTEAD of &quot;ActivePresentation&quot; in PowerPoint VBA", "body": "<p>Slight variant on Harassed Dad's solution.  PPT barks at the Set line because Duplicate returns a SlideRange object rather than a Slide object.  .Duplicate(1) returns the first slide in the range as a Slide object. This duplicates slide 2 and moves it to the first position in the presentation. </p>\n\n<pre><code>Sub CopySlide()\n    Dim oSl As Slide\n    With ActivePresentation\n        Set oSl = .Slides(2).Duplicate(1)\n        oSl.MoveTo (1)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11221744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6maWgZS49g4/AAAAAAAAAAI/AAAAAAAABa0/FH-7nIODauA/photo.jpg?sz=128", "display_name": "Nicole P.", "link": "https://stackoverflow.com/users/11221744/nicole-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555085681, "creation_date": 1554935562, "question_id": 55622177, "link": "https://stackoverflow.com/questions/55622177/what-are-some-other-methods-i-can-use-instead-of-activepresentation-in-powerpo", "title": "What are some other methods I can use INSTEAD of &quot;ActivePresentation&quot; in PowerPoint VBA", "body": "<p>I'm currently working on PowerPoint VBA and writing a code to be able to copy the first slide and paste it again in the same presentation. However, I keep getting the error \"Clipboard is empty or contains data which may not be posted here\" and according to Microsoft page the problem is the use of \"ActivePresentation\" </p>\n\n<p>I'm looking for another way to refer to the slide that I have open without using ActivePresentation. Any help? Ideas?</p>\n\n<p>The line of code I use ActivePresentation is below:</p>\n\n<pre><code>ActivePresentation.Slides(1).Copy\nActivePresentation.Slides.Paste(ActivePresentation.Slides.Count=1)\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11343041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65902009434657579258afe23dd9d55e?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe2021", "link": "https://stackoverflow.com/users/11343041/jdoe2021"}, "edited": false, "score": 0, "creation_date": 1554988239, "post_id": 55622443, "comment_id": 97957738, "body": "This is fantastic! Thank you so much for your help. The one issue I&#39;m still having is that it doesn&#39;t stop at the first instance and posting the header multiple times, do you have any suggestions for fixing this?"}, {"owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "reply_to_user": {"reputation": 15, "user_id": 11343041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65902009434657579258afe23dd9d55e?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe2021", "link": "https://stackoverflow.com/users/11343041/jdoe2021"}, "edited": false, "score": 0, "creation_date": 1554989951, "post_id": 55622443, "comment_id": 97958951, "body": "@jdoe2021 Do you want it to stop immediately after adding the first header to column A for the first time, so that is only ever adds one header if any?"}, {"owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "reply_to_user": {"reputation": 15, "user_id": 11343041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65902009434657579258afe23dd9d55e?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe2021", "link": "https://stackoverflow.com/users/11343041/jdoe2021"}, "edited": false, "score": 0, "creation_date": 1554992422, "post_id": 55622443, "comment_id": 97960705, "body": "@jdoe2021 In this case, add an <code>Exit For</code> after the <code>dataSheet.Cells(r, 1).Value = headerSheet.Cells(1, 14).Value</code> line."}, {"owner": {"reputation": 15, "user_id": 11343041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65902009434657579258afe23dd9d55e?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe2021", "link": "https://stackoverflow.com/users/11343041/jdoe2021"}, "edited": false, "score": 0, "creation_date": 1554992700, "post_id": 55622443, "comment_id": 97960891, "body": "It&#39;s working perfectly now. Thanks again for all your help, I really appreciate it."}], "tags": [], "owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "is_accepted": true, "score": 0, "last_activity_date": 1554937278, "creation_date": 1554937278, "answer_id": 55622443, "question_id": 55622169, "link": "https://stackoverflow.com/questions/55622169/create-a-header-by-determining-when-two-cells-do-not-match-and-pasting-header-fr/55622443#55622443", "title": "Create a header by determining when two cells do not match and pasting header from another sheet", "body": "<p>I suggest you work with column numbers if you can. Then you will probably see that you need far less indices than your current code does, and you don't forget to update the indices (like currently <code>iRow2</code> and <code>iCol2</code>) so easily.</p>\n\n<pre><code>Dim dataSheet As Worksheet\nDim headerSheet As Worksheet\n\nSet dataSheet = ActiveWorkbook.Sheets(2)\nSet headerSheet = ActiveWorkbook.Sheets(1)\n\nDim r As Integer\nFor r = 9 To 80\n  If dataSheet.Cells(r, 3).Value &lt;&gt; dataSheet.Cells(r + 2, 3).Value Then\n    dataSheet.Cells(r, 1).Value = headerSheet.Cells(1, 14).Value\n  End If\nNext r\n</code></pre>\n\n<p>This should give you a good start. I don't know that exactly the inner loop is meant to check, because you're never touching <code>iRow2</code> and <code>iCol2</code> it will try to check the cell at R0C0 which is an invalid address. If you want to make sure the row you compare with isn't empty, check that first within the <code>For</code> loop:</p>\n\n<pre><code>...\nFor r = 9 To 90\n  If dataSheet.Cells(r + 2, 3).Value = \"\" Then\n    Exit For\n  ElseIf dataSheet.Cells(r, 3).Value &lt;&gt; dataSheet.Cells(r + 2, 3).Value Then\n    dataSheet.Cells(r, 1).Value = headerSheet.Cells(1, 14).Value\n  End If\nNext r\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11343041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65902009434657579258afe23dd9d55e?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe2021", "link": "https://stackoverflow.com/users/11343041/jdoe2021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 55622443, "answer_count": 1, "score": 0, "last_activity_date": 1554984234, "creation_date": 1554935495, "last_edit_date": 1554984234, "question_id": 55622169, "link": "https://stackoverflow.com/questions/55622169/create-a-header-by-determining-when-two-cells-do-not-match-and-pasting-header-fr", "title": "Create a header by determining when two cells do not match and pasting header from another sheet", "body": "<p>I'm looking for something that is able to start searching in row 9 of column C for cells that do not equal cells 2 rows below. E.g. C9 &lt;> C11, C10 &lt;> C12, etc. Then Copy a cell from another sheet and paste it into Column A in the same row where there was the first discrepancy. E.G. if C9 &lt;> C11, then paste from Sheet2 into A11. The purpose is to insert a new header after already formatting and sorting the data, below is one of the many variations I have tried, receiving only errors or blank inputs. </p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<pre><code>Dim iRow2 As Integer, iCol2 As Integer, iRow3 As Integer, iCol3 As Integer\nDim oRng2 As Range\nDim oRng3 As Range\nDim qqq As Range\n\nSet oRng2 = Range(\"C9:C80\")\nSet oRng3 = Range(\"A9:A80\")\n\niCol2 = oRng2.Column\niCol3 = oRng3.Column\n\nFor Each qqq In oRng2\nDo\nIf qqq.Cells(oRng2, 3) &lt;&gt; qqq.Cells(oRng2 + 2, 3) Then\n ThisWorkbook.Worksheets(\"Sheet1\").Range(\"N1\").Copy Destination = Sheets(\"Sheet2\").Range(oRng2 + 2, 1)\n\nEnd If\nLoop While Not Cells(iRow2, iCol2).Text = \"\"\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1554987439, "post_id": 55621958, "comment_id": 97957168, "body": "Open the <a href=\"https://support.office.com/en-us/article/use-the-name-manager-in-excel-4d8c4c2b-9f7d-44e3-a3b4-9f61bd5c64e4\" rel=\"nofollow noreferrer\">name manager</a> and see what it shows for the name <code>BBTMembers</code>."}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1555023162, "post_id": 55621958, "comment_id": 97974668, "body": "I solved the problem by adding &quot;Worksheets(&quot;Sheet2&quot;).&quot;"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1555051266, "post_id": 55621958, "comment_id": 97981119, "body": "That means the name was <a href=\"https://stackoverflow.com/a/2176154/11683\">local</a>."}], "owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984222, "creation_date": 1554933967, "last_edit_date": 1554984222, "question_id": 55621958, "link": "https://stackoverflow.com/questions/55621958/with-activeworkbook-names-itembbtmembers-produces-1004-error", "title": "&quot;With ActiveWorkbook.Names.Item(&quot;BBTMembers&quot;)&quot; produces 1004 error", "body": "<p>After modifying the contents of a range, I loop through it to find out how many rows are present (Counter) then resize the range.  This works for one range but not another.  </p>\n\n<p>The code below is a clip from a test Sub that works for the first three lines.  Line four produces Run-time error '1004'.</p>\n\n<pre><code>...\nWith ActiveWorkbook.Names.Item(\"Namelist\")\n.RefersTo = .RefersToRange.Resize(Counter / 2, 4)\nEnd With\nWith ActiveWorkbook.Names.Item(\"BBTMembers\") 'Run-time error '1004':\n                                             'Application-defined or.... \n.RefersTo = .RefersToRange.Resize(Counter / 2, 4)\nRange(\"BBTMembers2\") = Range(\"BBTMembers\").Resize(Counter, 4)\nEnd With\n...\n</code></pre>\n\n<p>Ranges are defined as Variant and initialized as (0 To 2, 0 To 100).  I am baffled as to why one works and the other doesn't.  I have tried changing the spelling of BBTMembers among other things.</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554934174, "post_id": 55621950, "comment_id": 97936941, "body": "Instead of <code>.additem</code> paste all items found on the dictionary in a range on a hidden sheet, then use <code>.RowSource</code> on the listbox to update all items at once."}, {"owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554935449, "post_id": 55621950, "comment_id": 97937366, "body": "Not familiar with that, I&#39;ll look it up and give it a go.  Thanks for the suggestion, Ricardo A"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554936101, "post_id": 55621950, "comment_id": 97937523, "body": "<code>.RowSource</code> requires a range like <code>Sheet1!A2:A50</code> and it will show all 50 items without using <code>.additem</code>. If your range has empty cells, it will also show empty items on the list. Based on your already written code, instead of marking the lists as &quot;Show&quot; you clear the sheet first <code>.Cells.ClearContents</code> and start adding each of those &quot;Show&quot; items on the Sheet. After all are added, you find the last cell <code>.Cells(Rows.Count, 1).End(xlUp).Row</code> and then you set up the <code>.RowSource</code> with that range. This will add all items to the list."}, {"owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554936737, "post_id": 55621950, "comment_id": 97937666, "body": "Thanks Ricardo A, that&#39;s precisely what I did.  It&#39;s actually a bit slower, I have screenupdating off and the worksheet is hidden, but I get a little spinny &quot;I&#39;m thinking&quot; icon every time I type a character into the textbox."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554937074, "post_id": 55621950, "comment_id": 97937758, "body": "The point is to reduce the loops to a single loop. The loops are slowing this down. How about adding the dictionary items to an array instead of adding them to a Cell, then paste the array. This way you only paste once on the sheet."}, {"owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554995981, "post_id": 55621950, "comment_id": 97963146, "body": "Thanks for the comment, Ricardo - that was helpful!  I was able to get it down to one loop, I also then used a collection instead of a dictionary which sped it up."}], "owner": {"reputation": 49, "user_id": 10631015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HHgWJ.png?s=128&g=1", "display_name": "Ben Denody", "link": "https://stackoverflow.com/users/10631015/ben-denody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984215, "creation_date": 1554933923, "last_edit_date": 1554984215, "question_id": 55621950, "link": "https://stackoverflow.com/questions/55621950/userform-textbox-slow-and-not-showing-characters-as-typed", "title": "UserForm Textbox Slow and Not Showing Characters as Typed", "body": "<p>I'm attempting to get a listbox in a userform to dynamically filter content by what is typed into a textbox on that same form.  It works, but when the user starts typing it basically freezes up while executing the code to filter.  If I type a series of characters fast the textbox will not show the characters for a few seconds.  I'd like to dynamically filter the listbox without the lag.</p>\n\n<p>I've attempted to create a timer that times how long it has been since the user last typed a character before executing the filter, but that brought along with it another set of problems including the last character a user types not firing the <code>textbox_change</code> if it was typed fast in relation to the penultimate character.</p>\n\n<pre><code>Private Sub FilterTextBox_Change()\n\nDim bSelected As Boolean\nDim lListIncrementer As Long\nDim lDictionaryIncrementer As Long\nDim lOriginalListBoxDictionaryIncrementer As Long\nDim lLastListItem As Long\nDim sFilterString As String\nDim lDictionaryIncrementerOffset As Long\nDim dTimerDifference As Double\nDim sCurrentString As String\n\nsFilterString = UCase(InvoiceProductAssociation.FilterTextBox.Text)\nlLastListItem = InvoiceProductAssociation.CatapultItemIdAndDescriptionListBox.ListCount - 1\nlDictionaryIncrementerOffset = 0\n\n\nFor lDictionaryIncrementer = 0 To oListBoxItemDictionary.Count - 1\n    sCurrentString = UCase(oListBoxItemDictionary.Keys(lDictionaryIncrementer))\n\n    If InStr(sCurrentString, sFilterString) Then\n        oListBoxItemDictionary(oListBoxItemDictionary.Keys(lDictionaryIncrementer)) = \"Show\"\n    ElseIf sFilterString = vbNullString Then\n        oListBoxItemDictionary(oListBoxItemDictionary.Keys(lDictionaryIncrementer)) = \"Show\"\n    Else\n        oListBoxItemDictionary(oListBoxItemDictionary.Keys(lDictionaryIncrementer)) = \"Hide\"\n    End If\nNext lDictionaryIncrementer\n\nFor lListIncrementer = 0 To lLastListItem\n\n    If InvoiceProductAssociation.CatapultItemIdAndDescriptionListBox.Selected(lListIncrementer) = True Then\n        oListBoxSelectedDictionary(\"Selected\") = InvoiceProductAssociation.CatapultItemIdAndDescriptionListBox.List(lListIncrementer)\n    End If\n\nNext lListIncrementer\n\nInvoiceProductAssociation.CatapultItemIdAndDescriptionListBox.Clear\n\nFor lDictionaryIncrementer = 0 To oListBoxItemDictionary.Count - 1\n\n    If oListBoxItemDictionary.Items(lDictionaryIncrementer) = \"Show\" Then\n\n        With InvoiceProductAssociation.CatapultItemIdAndDescriptionListBox\n            .AddItem oListBoxItemDictionary.Keys(lDictionaryIncrementer)\n            If oListBoxSelectedDictionary(\"Selected\") = oListBoxItemDictionary.Keys(lDictionaryIncrementer) Then\n                InvoiceProductAssociation.CatapultItemIdAndDescriptionListBox.Selected(lDictionaryIncrementer + lDictionaryIncrementerOffset) = True\n            End If\n        End With\n    Else\n        lDictionaryIncrementerOffset = lDictionaryIncrementerOffset - 1\n    End If\n\n    lListIncrementer = lListIncrementer + 1\n\nNext lDictionaryIncrementer\n\nEnd Sub\n</code></pre>\n\n<p>The number of items being loaded into the dictionary are over 1,000, but dictionaries have been highly responsive for me in the past, so I'm thinking its the .additem is causing the lag.</p>\n\n<p>I'm wondering if anyone has any suggestions on either how to add the items to the list-box faster, or has a suggestion for successfully only triggering the filter once the user has stopped typing for x seconds.</p>\n"}, {"tags": ["excel", "vba", "compiler-errors", "excel-2016"], "comments": [{"owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "edited": false, "score": 0, "creation_date": 1554957177, "post_id": 55621735, "comment_id": 97941744, "body": "refer <a href=\"https://stackoverflow.com/questions/11560934/when-editing-microsoft-office-vba-how-can-i-disable-the-popup-compile-error-m\" title=\"when editing microsoft office vba how can i disable the popup compile error m\">stackoverflow.com/questions/11560934/&hellip;</a>  when tools - options - auto syntax check is Off your code will bring up the popup you require but will not suppress the error since it&#39;s a basic syntax check that it does and is out of scope of VBA runtime."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "edited": false, "score": 0, "creation_date": 1554987325, "post_id": 55621735, "comment_id": 97957074, "body": "@user2648008 Certainly, and I&#39;m sure I can check that option to suppress the popup, however that&#39;s not really the main issue that&#39;s occurring, whether or not that option is enabled doesn&#39;t change the fact that this method is unable to detect whether the compilation was successful or not, until I can figure out a way to do that, this method will not work correctly."}], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984208, "creation_date": 1554932660, "last_edit_date": 1554984208, "question_id": 55621735, "link": "https://stackoverflow.com/questions/55621735/vba-method-to-detect-compilation-failure", "title": "VBA - Method to Detect Compilation Failure", "body": "<p>I have the following code:</p>\n\n<pre><code>Public Function Compiler()\n    On Error GoTo ErrorHandler\n\n    Compiler = \"Successfully Compiled\"\n\n    Dim compileMe As Object\n    Set compileMe = Application.VBE.CommandBars.FindControl(Type:=msoControlButton, ID:=578)\n\n    If compileMe.Enabled Then\n        compileMe.Execute\n    End If\n\n    Exit Function\n\nErrorHandler:\n\n    Compiler = \"Unable to Compile - \" &amp; Err.Description\n\nEnd Function\n</code></pre>\n\n<p>It is very similar to the suggestion <a href=\"https://stackoverflow.com/a/36893179/2912011\">posted here</a>, and it doesn't work. It you introduce errors into the rest of your application and run this, you will get \"Successfully Compiled\" every time (after clicking past the error messages).</p>\n\n<p>Is there a way to have the method return \"Unable to Compile\" if the file cannot be compiled?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1554929577, "post_id": 55621132, "comment_id": 97935256, "body": "Just a note - this can be done with conditional formatting. Is VBA required? Also, the placement of <code>row_cnt = row_cnt + 1</code> at the beginning  is causing the extra cell to be colored. Increment <code>row_cnt</code> at the end."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1554929973, "creation_date": 1554929973, "answer_id": 55621243, "question_id": 55621132, "link": "https://stackoverflow.com/questions/55621132/how-to-write-vba-for-do-until-last-row-of-data-set/55621243#55621243", "title": "How to write VBA for Do Until last row of data set", "body": "<p>you can dynamically find the last row, such that:</p>\n\n<pre><code>lr = cells(rows.count,1).end(xlup).row\nrow_cnt = 1\nDo until row_cnt = lr+1 'so you get actions on your last row\n    'do stuff\n    row_cnt = row_cnt + 1\nloop\n</code></pre>\n\n<p>if you can avoid vba for this, bigben's suggestion for conditional formatting would be solid</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1554932505, "creation_date": 1554932505, "answer_id": 55621702, "question_id": 55621132, "link": "https://stackoverflow.com/questions/55621132/how-to-write-vba-for-do-until-last-row-of-data-set/55621702#55621702", "title": "How to write VBA for Do Until last row of data set", "body": "<p>To answer the specific Q \"Why doesn't my <code>Do Until</code>work\":</p>\n\n<p>It's because you test based on a value of <code>row_cnt</code> , then immediately increment it inside the loop, so process the next row.</p>\n\n<p>To fix that, move the increment to just before <code>Loop</code> and adjust the initialisation of <code>row_cnt</code></p>\n\n<p>On a side note, you should use Long rather than Integer as the counter data type </p>\n"}], "owner": {"reputation": 1, "user_id": 11342680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884ba718b09492b3bf7ae866ba89ec94?s=128&d=identicon&r=PG&f=1", "display_name": "MattER2092", "link": "https://stackoverflow.com/users/11342680/matter2092"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1013, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555055035, "creation_date": 1554929408, "last_edit_date": 1555055035, "question_id": 55621132, "link": "https://stackoverflow.com/questions/55621132/how-to-write-vba-for-do-until-last-row-of-data-set", "title": "How to write VBA for Do Until last row of data set", "body": "<p>I am new to VBA and looking to run a code to colour cells in rows in a specific colour. I have been using DO UNTIL and always end with an extra cell coloured. What is the best way to overcome this.</p>\n\n<p>The table I am working with looks like this,</p>\n\n<ol>\n<li>Number/Name</li>\n<li>1/test_01</li>\n<li>2/test_02</li>\n<li>3/test_03</li>\n<li>4/test_04</li>\n<li>5/test_05</li>\n</ol>\n\n<p>and continues on and the end will change each time i run the code.</p>\n\n<p>I have set up a test sheet to get the basic idea running so I can expand upon it once I have it running properly. This specific test is dividing column A (Number) by 2 and if there is a remainder of 1 then it will be coloured one way and if not it will be coloured another.</p>\n\n<pre><code>Sub Button2_Click()\nDim row_cnt As Integer\nrow_cnt = 1\n\nDo Until Sheets(\"sheet1\").Range(\"A\" &amp; row_cnt).Value = \"\"\nrow_cnt = row_cnt + 1\n        If Sheets(\"sheet1\").Range(\"A\" &amp; row_cnt).Value Mod 2 &lt;&gt; 0 Then\n        Range(\"A\" &amp; row_cnt &amp; \":B\" &amp; row_cnt).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent6\n            .TintAndShade = -0.249977111117893\n            .PatternTintAndShade = 0\n    End With\n    Else\n        Range(\"A\" &amp; row_cnt &amp; \":B\" &amp; row_cnt).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent4\n            .TintAndShade = -0.249977111117893\n            .PatternTintAndShade = 0\n        End With\n    End If\nLoop\nEnd Sub\n</code></pre>\n\n<p>I expect the cells to be coloured until the last cell with a value in. However, this code goes past that and colours an extra cell. I am looking for a way to improve what I have.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 2, "creation_date": 1554929164, "post_id": 55621051, "comment_id": 97935083, "body": "Yeah, you\u2019re using it wrong, have you looked at the doco for InStr? Even if your approach did work, you\u2019ve also got parentheses problems."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "edited": false, "score": 0, "creation_date": 1554932022, "post_id": 55621051, "comment_id": 97936226, "body": "I\u2019ll work with .find(what=InterfaceNumber) etc instead of InStr..."}, {"owner": {"reputation": 1, "user_id": 11342534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4Vq-k0YdJ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezNidZpMnRC1BDBxOGzVgBLSYCKQ/mo/photo.jpg?sz=128", "display_name": "Tim Jhonson", "link": "https://stackoverflow.com/users/11342534/tim-jhonson"}, "edited": false, "score": 0, "creation_date": 1554932525, "post_id": 55621051, "comment_id": 97936401, "body": "Thanks Irene! I&#39;ll try that and see. I&#39;m new to VBA so any advice/tips are welcomed."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554934402, "post_id": 55621051, "comment_id": 97937014, "body": "After you fix your InStr it should work. MS Documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/instr-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 11342534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4Vq-k0YdJ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezNidZpMnRC1BDBxOGzVgBLSYCKQ/mo/photo.jpg?sz=128", "display_name": "Tim Jhonson", "link": "https://stackoverflow.com/users/11342534/tim-jhonson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555000463, "creation_date": 1554928985, "last_edit_date": 1555000463, "question_id": 55621051, "link": "https://stackoverflow.com/questions/55621051/is-there-a-way-to-search-cells-to-find-a-partial-match", "title": "Is there a way to search cells to find a partial match", "body": "<p>I'm currently trying to build a tool which will allow me to search for the value held in \"B3\" in a second sheet. After it finds that value in sheet2,through a loop, it will then copy and paste the cells next to it into sheet1 in a specified destination. My issue is after trying to use the instr function to pull this in I keep receiving an error. Is there somethign I'm missing in my instring or is there something else I should add?</p>\n\n<p>Here's the code I've used so far:</p>\n\n<pre><code> Dim InterfaceNumber As Integer\n\n Dim finalrow As Integer\n\n Dim i As Integer 'counter\n\n Dim InterfaceInformation As Variant\n\n InterfaceNumber = Sheets(\"Trackers Search\").Range(\"B3\").Value\n\n  finalrow = Sheets(\"Trackers\").Cells(Rows.Count, \"C\").End(xlUp).Row\n\n   For i = 4 To finalrow\n\n   If instr(\"C3:D50\"),InterfaceNumber) Then\n\n Sheets(\"trackers\").Range(\"B\" &amp; i &amp; \":E\" &amp; i).Copy\n\n   InterfaceInformation = Sheets(\"trackers\").Range(\"B\" &amp; i &amp; \":E\" &amp; i).Copy\n\n   Sheets(\"Trackers Search\").Range(\"B1000\").End(xlUp).Offset(1, \n    0).PasteSpecial\n\nElse\n\n\n End If\n</code></pre>\n\n<p>I expect to be able to loop through the \"Trackers\" sheet and find all the cells that match the value in cell \"B3\" and to paste it into The first sheet in range B8:E8</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554930351, "post_id": 55621020, "comment_id": 97935590, "body": "Place a breakpoint (F8) on the <code>FnameInLoop =</code> line, run your code; when the breakpoint is hit, use the immediate pane (Ctrl+G) to output the value of <code>files</code> and inspect <code>a</code> and its <code>UBound</code>. &quot;Subscript out of range&quot; means you&#39;re accessing an array index that doesn&#39;t exist."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554930388, "post_id": 55621020, "comment_id": 97935611, "body": "It has over one file, but should that occur, how would I both resolve the current error and provide checking to remove a future error of having only one file in files?"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554930663, "post_id": 55621020, "comment_id": 97935707, "body": "@MathieuGuindon Thank you, used locals window and a has the path split from &quot;C&quot;, &quot;user&quot;, &quot;computer (C:\\Users\\work\\Desktop) all the way to the end file."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554930788, "post_id": 55621020, "comment_id": 97935757, "body": "But does that one throw the error you&#39;re getting? See, without a <code>files(n)</code> string that reliably reproduces the problem, it&#39;s very hard to help debugging. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and feel free to <a href=\"https://stackoverflow.com/posts/55621020/edit\">edit</a> your post accordingly."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554931005, "post_id": 55621020, "comment_id": 97935856, "body": "@MathieuGuindon Thank you, used locals window and a has the path split from &quot;C&quot;, &quot;user&quot;, &quot;computer (C:\\Users\\work\\Desktop) all the way to the end file.  Added On Error Resume Next and discovered that at then end, of the run the last file is being duplicated but there is no full path on that same row, thus an extra row with only the last folder is populating an extra row. <a href=\"https://i.imgur.com/hhCeCI0.png\" rel=\"nofollow noreferrer\">i.imgur.com/hhCeCI0.png</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554931339, "post_id": 55621020, "comment_id": 97935990, "body": "The last thing you need is <code>On Error Resume Next</code>... you want to break when that error is thrown, and inspect the inputs and see why <code>UBound(a)-1</code> is out of range for <code>a</code> in that specicfic case."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554932419, "post_id": 55621020, "comment_id": 97936362, "body": "Yes, using <code>On Error Resume Next</code> allowed me to see the end result of the error, I have inspected &quot;files&quot; and the last file in locals window is without value, thus the error."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "is_accepted": false, "score": 0, "last_activity_date": 1554933517, "creation_date": 1554933517, "answer_id": 55621890, "question_id": 55621020, "link": "https://stackoverflow.com/questions/55621020/how-to-resolve-runtime-error-9-subscript-out-of-range-when-getting-last-folder/55621890#55621890", "title": "How to resolve Runtime error 9, subscript out of range when getting last folder in a path", "body": "<p>@MathieuGuindon resolved, thank you for your input which produced the successful result, just added checking if value is null, below:</p>\n\n<pre><code>`' extract last folder in path\nDim a As Variant\ni = 5\nFor n = LBound(files) To UBound(files)\n    a = Split(files(n), \"\\\")\n    If Not Fnameinloop = \"\" Then\n    Fnameinloop = a(UBound(a) - 1)\n    Cells(i, 1).Value = Fnameinloop\n    End If\n    i = i + 1\n    Next n\n` \n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554933517, "creation_date": 1554928843, "last_edit_date": 1554930095, "question_id": 55621020, "link": "https://stackoverflow.com/questions/55621020/how-to-resolve-runtime-error-9-subscript-out-of-range-when-getting-last-folder", "title": "How to resolve Runtime error 9, subscript out of range when getting last folder in a path", "body": "<p>Attempting to retrieve the last folder in a path using an array, it is working but returning Run-Time error 9, Subscript out of range at end of script execution.\n<a href=\"https://i.stack.imgur.com/kVM5A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVM5A.png\" alt=\"Screenshot of the line where error occuring\"></a>\n`</p>\n\n<pre><code>Dim a As Variant\ni = 5\nFor n = LBound(files) To UBound(files)\n    a = Split(files(n), \"\\\")\n    FnameInLoop = a(UBound(a) - 1)\n    Cells(i, 1).Value = FnameInLoop\n    i = i + 1\n    Next n`\n</code></pre>\n"}, {"tags": ["excel", "vba", "search", "listbox", "userform"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554928832, "post_id": 55620457, "comment_id": 97934923, "body": "are you populating your listbox as part of initialize code?  when you load your userform, are you opening as modeless?  you should be able to provide a new array to the listbox right after your sort (can do it several ways)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554929143, "post_id": 55620457, "comment_id": 97935075, "body": "also, need to know more about your data... are there duplicate values in the listbox, or will you be needing to find unique values?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554929335, "post_id": 55620457, "comment_id": 97935157, "body": "also, have you seen this post, <a href=\"https://stackoverflow.com/questions/40948329/how-to-show-just-filtered-rows-in-my-userform-listbox\">How to show just filtered rows in my userform listbox</a>"}], "owner": {"reputation": 1, "user_id": 11342546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5afe18b0d114d23a6524d1b87884f1?s=128&d=identicon&r=PG&f=1", "display_name": "A. Marx", "link": "https://stackoverflow.com/users/11342546/a-marx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554926369, "creation_date": 1554926369, "question_id": 55620457, "link": "https://stackoverflow.com/questions/55620457/how-can-i-update-a-listbox-with-autofilter-data", "title": "How can I update a listbox with AutoFilter data?", "body": "<p>I have a userform which lists information from a worksheet in a listbox.\nI have added a search tool which filters by keywords entered using AutoFilter.\nHow can I then display the filtered worksheet in the listbox?</p>\n\n<p>I've been playing around with SpecialCells(xlCellTypeVisible) but I can't seem to get it to work, it says permission denied.</p>\n\n<p>Here is my current code to search the worksheet and filter the data.</p>\n\n<pre><code>Private Sub CommandButton5_Click()\nRange(\"A1\").AutoFilter field:=1, Criteria1:=txtKeywords.Value\nEnd Sub\n</code></pre>\n\n<p>My aim is to have the data displayed in this listbox, so I can then add functions for deleting the data from the worksheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554925026, "post_id": 55620084, "comment_id": 97933250, "body": "Maybe take a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\">Workbook.SheetChange event</a>."}, {"owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554926592, "post_id": 55620084, "comment_id": 97933955, "body": "So far I&#39;ve just seen examples where the worksheet change event was a worksheet-level event. Great to know that can be placed at the level of the workbook as well. Cheers BigBen!"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "edited": false, "score": 0, "creation_date": 1554926464, "post_id": 55620369, "comment_id": 97933909, "body": "Thanks so much Gary, I&#39;ll give this a shot."}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 1, "creation_date": 1554935896, "post_id": 55620369, "comment_id": 97937474, "body": "Just to add an additional permutation onto Gary&#39;s answer, you could write a function that 1) creates a new worksheet based on the template sheet, 2) copies the data from the target sheet to the new sheet, 3) deletes the old sheet, 4) renames the new sheet to the same name as the old sheet, 5) moves the new sheet to the same location as the old sheet. In this way, you could in effect &#39;add&#39; the worksheet code to the page!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1554926068, "creation_date": 1554926068, "answer_id": 55620369, "question_id": 55620084, "link": "https://stackoverflow.com/questions/55620084/vba-events-for-worksheets-that-are-macro-generated/55620369#55620369", "title": "VBA events for worksheets that are macro generated", "body": "<p>A tiny trick:</p>\n\n<p>The usual way to add a sheet is to use code like:</p>\n\n<pre><code>Sheets.Add\n</code></pre>\n\n<p>which will get you a fresh new sheet, but this new sheet will have no event code associated with it.</p>\n\n<p>Instead create a template worksheet <em>(called templ)</em>  and in this template worksheet include all necessary event macros.  Now, instead of <code>Add</code>ing a new worksheet, just:</p>\n\n<pre><code>Sheets(\"templ\").Copy after:=Sheets(Sheets.Count)\n</code></pre>\n\n<p>you get a new worksheet, but with all macros attached!</p>\n"}], "owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554984199, "creation_date": 1554924875, "last_edit_date": 1554984199, "question_id": 55620084, "link": "https://stackoverflow.com/questions/55620084/vba-events-for-worksheets-that-are-macro-generated", "title": "VBA events for worksheets that are macro generated", "body": "<p>I relatively new to VBA. Here is what I need to accomplish:</p>\n\n<p>I need code to run when the value of some cells changes in some worksheets. I just learned how to do this using events. \nThe problem I'm having is that the worksheets that need the event are not there to begin with, but are generated by a macro. Also, their number might vary depending on the data (i.e. sometimes the macro might generate 3, sometimes 10.. and will rename them using some cell values, so also the names differ every time).</p>\n\n<p>From what I can see, the event that triggers the macro on cell change needs to be coded for the object itself (specific worksheets). Is there a way to do it for worksheets that are macro-generated, and don't exist in the workbook when first opened?</p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1554925188, "post_id": 55620058, "comment_id": 97933327, "body": "This is normal behavior, given you&#39;re opening an attachment. Save the attached .xlsm locally, then open it from its location. Other than that, pretty hard to guess what might be wrong with code we can&#39;t see."}, {"owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "edited": false, "score": 0, "creation_date": 1554935577, "post_id": 55620058, "comment_id": 97937398, "body": "It might also be related to Excel still realizing this is a downloaded file. Check the file properties from the context menu in the normal Explorer. Below the &quot;Read only&quot; and &quot;Hidden&quot; flag there could be another section &quot;Security&quot; stating that the file comes from a different computer. Next to that hint is a third checkbox to allow access. Tick that and check if that helps."}], "owner": {"reputation": 11, "user_id": 11342398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b6bb4d5df2fb7db0d84aa2031f92e4?s=128&d=identicon&r=PG&f=1", "display_name": "rbn", "link": "https://stackoverflow.com/users/11342398/rbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554969654, "creation_date": 1554924791, "last_edit_date": 1554969654, "question_id": 55620058, "link": "https://stackoverflow.com/questions/55620058/excel-vba-userform-wont-work-on-all-computers", "title": "Excel VBA Userform won&#39;t work on all computers", "body": "<p>I have made a user's form using VBA excel code. Its working fine on my laptop however when I tried it on my office computer it doesn't work. I emailed the file to myself and downloaded it from Outlook in the office. Its a .xlsm file. It gives me an error message that macros have been disabled. I have already changed settings to enable macros and allow VBA projects. I reopened excel and checked again it still doesn't work. The downloaded file from outlook, when I click visual basic, it doesn't show me any user form or code at all. Not sure why. </p>\n\n<p>My whole code is present in the user form part (file in a personal laptop). There is a button on \"sheet 3\" which basically opens the user form. Not sure if it's saving the code only locally on my computer. As per my understanding if it's saved in the file it should be a part of it even if its opened on any other computer. My laptop version is office 365 and office one is 2016. I am not an advanced user. Kindly advise what is the error out here.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 1, "creation_date": 1554924328, "post_id": 55619798, "comment_id": 97932959, "body": "Can you be more specific about your problem? I assume you are trying to force login names to be a specific case? Also, your code would be a great candidate for a <code>Select Case</code> <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/select-case-statement\" rel=\"nofollow noreferrer\">structure</a>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1554924394, "post_id": 55619798, "comment_id": 97932983, "body": "Maybe use <code>Option Compare Binary</code> in module header <a href=\"https://www.fmsinc.com/MicrosoftAccess/modules/options/index.html#OptionCompare\" rel=\"nofollow noreferrer\">fmsinc.com/MicrosoftAccess/modules/options/&hellip;</a> or review <a href=\"http://www.accessforums.net/showthread.php?t=25944\" rel=\"nofollow noreferrer\">accessforums.net/showthread.php?t=25944</a>"}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554924552, "post_id": 55619798, "comment_id": 97933047, "body": "You should also consider hashing and salting your passwords, especially if this tool is exposed to the broader internet."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1554926562, "creation_date": 1554926562, "answer_id": 55620497, "question_id": 55619798, "link": "https://stackoverflow.com/questions/55619798/how-to-solve-ms-access-login-case-sensitive/55620497#55620497", "title": "How to solve MS Access login case sensitive?", "body": "<p>You can use <em>StrComp</em>:</p>\n\n<pre><code>DLookup(\"USER_NAME\", \"USER\", \"StrComp(USER_ID, '\" &amp; Me.LOGINID.Value &amp; \"', \" &amp; vbBinaryCompare &amp; \") = 0\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11342346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLGOB.jpg?s=128&g=1", "display_name": "Sholma Jahan", "link": "https://stackoverflow.com/users/11342346/sholma-jahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1554926562, "creation_date": 1554923625, "last_edit_date": 1554924066, "question_id": 55619798, "link": "https://stackoverflow.com/questions/55619798/how-to-solve-ms-access-login-case-sensitive", "title": "How to solve MS Access login case sensitive?", "body": "<p>I share my code which I use in MS Access database login form. </p>\n\n<p>Can anyone help me solve the case sensitivity problem?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command1_Click() \n    Dim UserLevel As Integer \n    Dim USER_NAME As String \n    Dim TemLoginID As String\n\n    If IsNull(Me.LOGINID) Then\n        MsgBox \"Please enter your login ID\", vbInformation, \"Login Id is required.\"\n        Me.LOGINID.SetFocus \n    ElseIf IsNull(Me.PASSWORD) Then\n        MsgBox \"Please enter your password\", vbInformation, \"Password Id is required.\"\n        Me.PASSWORD.SetFocus \n    Else\n        If (IsNull(DLookup(\"USER_NAME\", \"USER\", \"USER_ID = '\" &amp; Me.LOGINID.Value &amp; \"'\"))) Or _\n        (IsNull(DLookup(\"PASSWORD\", \"USER\", \"PASSWORD = '\" &amp; Me.PASSWORD.Value &amp; \"'\"))) Then\n            MsgBox \"Incorrect ID or Password.\" \n        Else\n            TemLoginID = Me.LOGINID.Value\n            USER_NAME = DLookup(\"USER_NAME\", \"USER\", \"USER_ID = '\" &amp; Me.LOGINID.Value &amp; \"'\")\n            UserLevel = DLookup(\"DIGINATION\", \"USER\", \"USER_ID = '\" &amp; Me.LOGINID.Value &amp; \"'\")\n            DoCmd.Close\n            If UserLevel = 1 Then\n                MsgBox \"Welcome to our TravelSoft! You are login as a Admin.\"\n                DoCmd.OpenForm \"DESHBOARD\"\n                Forms![DESHBOARD]![LOGINID] = TemLoginID\n                Forms![DESHBOARD]![USER] = USER_NAME    \n            Else\n                If UserLevel = 2 Then\n                    MsgBox \"Welcome to our TravelSoft! You are login as a Manager.\"\n                    DoCmd.OpenForm \"DESHBOARD\"\n                    Forms![DESHBOARD]![LOGINID] = TemLoginID\n                    Forms![DESHBOARD]!Reissue.Enabled = False\n                    Forms![DESHBOARD]!void.Enabled = False\n                    Forms![DESHBOARD]!adm.Enabled = False\n                    Forms![DESHBOARD]!particular.Enabled = False\n                    Forms![DESHBOARD]!userid.Enabled = False\n                    Forms![DESHBOARD]!Profile.Enabled = False\n                    Forms![DESHBOARD]!AGENT.Enabled = False\n                    Forms![DESHBOARD]![USER] = USER_NAME\n                Else\n                    If UserLevel = 3 Then\n                        MsgBox \"Welcome to our TravelSoft! You are login as a Accounts.\"\n                        DoCmd.OpenForm \"DESHBOARD\"\n                        Forms![DESHBOARD]![LOGINID] = TemLoginID\n                        Forms![DESHBOARD]!Reissue.Enabled = False\n                        Forms![DESHBOARD]!void.Enabled = False\n                        Forms![DESHBOARD]!adm.Enabled = False\n                        Forms![DESHBOARD]!particular.Enabled = False\n                        Forms![DESHBOARD]!userid.Enabled = False\n                        Forms![DESHBOARD]!Profile.Enabled = False\n                        Forms![DESHBOARD]!AGENT.Enabled = False\n                        Forms![DESHBOARD]!reissue_confirm.Enabled = False\n                        Forms![DESHBOARD]!void_confirm.Enabled = False\n                        Forms![DESHBOARD]!adm_confirm.Enabled = False\n                        Forms![DESHBOARD]!Passenger_information.Enabled = False\n                        Forms![DESHBOARD]!ticket_confirm.Enabled = False\n                        Forms![DESHBOARD]![USER] = USER_NAME\n                    Else\n                        MsgBox \"Welcome to our TravelSoft! You are login as a User.\"\n                        DoCmd.OpenForm \"DESHBOARD\"\n                        Forms![DESHBOARD]![LOGINID] = TemLoginID\n                        Forms![DESHBOARD]!reissue_confirm.Enabled = False\n                        Forms![DESHBOARD]!void_confirm.Enabled = False\n                        Forms![DESHBOARD]!adm_confirm.Enabled = False\n                        Forms![DESHBOARD]!ticket_confirm.Enabled = False\n                        Forms![DESHBOARD]!Profile.Enabled = False\n                        Forms![DESHBOARD]!AGENT.Enabled = False\n                        Forms![DESHBOARD]!userid.Enabled = False\n                        Forms![DESHBOARD]![USER] = USER_NAME\n                    End If\n                End If\n            End If\n        End If \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1554933288, "post_id": 55621470, "comment_id": 97936661, "body": "Works absolutely as required. Thank you very much :)"}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1554933923, "post_id": 55621470, "comment_id": 97936866, "body": "quick additional question.... if i wanted to apply this to three image controls in the same frame control, how could i achieve this?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1554938455, "post_id": 55621470, "comment_id": 97938097, "body": "Do you know how to make a class module?"}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1554973044, "post_id": 55621470, "comment_id": 97948571, "body": "I appreciate you elaborating further. I seem to get a user-defined type not defined error on the second line of the user form code though?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1554978435, "post_id": 55621470, "comment_id": 97951879, "body": "The <code>MoveableImage</code>  code belongs in a class module that has been renamed <code>MoveableImage</code>   Watch:<a href=\"https://www.youtube.com//watch?v=MjbmsVDnAL0&amp;index=39&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 35 - Class Modules</a> and <a href=\"https://www.youtube.com//watch?v=bBAdhclCT9g&amp;index=40&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 36 - Using Class Modules in Other Projects</a>"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1554938948, "last_edit_date": 1554938948, "creation_date": 1554931137, "answer_id": 55621470, "question_id": 55619734, "link": "https://stackoverflow.com/questions/55619734/check-if-nested-control-is-outside-parent-control-range/55621470#55621470", "title": "Check if nested control is outside parent control range", "body": "<p>You need to determine it the Image control border intersects its parent border.\nHere is the way that I would do it:</p>\n\n<pre><code>Private Type Coords\n    Left As Single\n    Top As Single\n    X As Single\n    Y As Single\n    MaxLeft As Single\n    MaxTop As Single\nEnd Type\nPrivate Image1Coords As Coords\n\nPrivate Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n    If Button = XlMouseButton.xlPrimaryButton Then\n        Image1Coords.X = X\n        Image1Coords.Y = Y\n    End If\n\nEnd Sub\n\nPrivate Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    Const PaddingRight As Long = 4, PaddingBottom As Long = 8\n    Dim newPoint As Point\n\n    If Button = XlMouseButton.xlPrimaryButton Then\n        Image1Coords.Left = Image1.Left + X - Image1Coords.X\n        Image1Coords.Top = Image1.Top + Y - Image1Coords.Y\n\n        Image1Coords.MaxLeft = Image1.parent.Width - Image1.Width - PaddingRight\n        Image1Coords.MaxTop = Image1.parent.Height - Image1.Height - PaddingBottom\n\n        If Image1Coords.Left &lt; 0 Then Image1Coords.Left = 0\n\n        If Image1Coords.Left &lt; Image1Coords.MaxLeft Then\n            Image1.Left = Image1Coords.Left\n        Else\n            Image1.Left = Image1Coords.MaxLeft\n        End If\n\n        If Image1Coords.Top &lt; 0 Then Image1Coords.Top = 0\n\n        If Image1Coords.Top &lt; Image1Coords.MaxTop Then\n            Image1.Top = Image1Coords.Top\n        Else\n            Image1.Top = Image1Coords.MaxTop\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<h2>MoveableImage Class</h2>\n\n<p>Taking it a step further we can encapsulate the code using a class.</p>\n\n<pre><code>Option Explicit\n\nPrivate Type Coords\n    Left As Single\n    Top As Single\n    x As Single\n    Y As Single\n    MaxLeft As Single\n    MaxTop As Single\nEnd Type\nPrivate Image1Coords As Coords\n\nPublic WithEvents Image1 As MSForms.Image\n\nPrivate Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)\n\n    If Button = XlMouseButton.xlPrimaryButton Then\n        Image1Coords.x = x\n        Image1Coords.Y = Y\n    End If\n\nEnd Sub\n\nPrivate Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)\n    Const PaddingRight As Long = 4, PaddingBottom As Long = 8\n    Dim newPoint As Point\n\n    If Button = XlMouseButton.xlPrimaryButton Then\n        Image1Coords.Left = Image1.Left + x - Image1Coords.x\n        Image1Coords.Top = Image1.Top + Y - Image1Coords.Y\n\n        Image1Coords.MaxLeft = Image1.Parent.Width - Image1.Width - PaddingRight\n        Image1Coords.MaxTop = Image1.Parent.Height - Image1.Height - PaddingBottom\n\n        If Image1Coords.Left &lt; 0 Then Image1Coords.Left = 0\n\n        If Image1Coords.Left &lt; Image1Coords.MaxLeft Then\n            Image1.Left = Image1Coords.Left\n        Else\n            Image1.Left = Image1Coords.MaxLeft\n        End If\n\n        If Image1Coords.Top &lt; 0 Then Image1Coords.Top = 0\n\n        If Image1Coords.Top &lt; Image1Coords.MaxTop Then\n            Image1.Top = Image1Coords.Top\n        Else\n            Image1.Top = Image1Coords.MaxTop\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<h2>Userform Code</h2>\n\n<pre><code>Option Explicit\nPrivate MovableImages(1 To 3) As New MoveableImage\n\nPrivate Sub UserForm_Initialize()\n    Set MovableImages(1).Image1 = Image1\n    Set MovableImages(2).Image1 = Image2\n    Set MovableImages(3).Image1 = Image3\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55621470, "answer_count": 1, "score": 1, "last_activity_date": 1558128684, "creation_date": 1554923348, "last_edit_date": 1558128684, "question_id": 55619734, "link": "https://stackoverflow.com/questions/55619734/check-if-nested-control-is-outside-parent-control-range", "title": "Check if nested control is outside parent control range", "body": "<p>I have added drag-drop functionality to an image control that is nested inside a Frame Control in my Excel userform.</p>\n\n<p>I am trying to prevent the nested image control from being moved outside of the parent control.</p>\n\n<p>I was thinking of using an IF statement in a BeforeDropOrPaste event to exit all running macros (so the mousemove event) if the position is outside the range of the parent control.</p>\n\n<p>How do I compare the drop location of the control to the range of the parent control?</p>\n\n<p>What I think the code would look like.</p>\n\n<pre><code>Private x_offset%, y_offset%\n\nPrivate Sub Image1_BeforeDropOrPaste(ByVal Cancel As MSForms.ReturnBoolean, ByVal Action As MSForms.fmAction, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)\n\nDim X as Range \nDim Y as Range\n\nSet x = parent control range\nSet y = the drop location of the control this code is in\n\n'If Y is outside or intersects X then\nEnd\nElse\nEnd Sub\n\nPrivate Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, _\n    ByVal X As Single, ByVal Y As Single)\n\n   If Button = XlMouseButton.xlPrimaryButton Then\n     x_offset = X\n     y_offset = Y\n   End If\n\nEnd Sub\n\nPrivate Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, _\n    ByVal X As Single, ByVal Y As Single)\n\n  If Button = XlMouseButton.xlPrimaryButton Then\n    Image1.Left = Image1.Left + X - x_offset\n    Image1.Top = Image1.Top + Y - y_offset\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>If the location of the nested control is outside of or intersects the parent control range then return the nested control to the location it was at before the MouseMove event. </p>\n\n<p>Edit - I found this code that uses a function to return a true value if the control objects overlap. <a href=\"http://www.vbaexpress.com/forum/showthread.php?33829-Solved-finding-if-two-controls-overlap\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?33829-Solved-finding-if-two-controls-overlap</a> </p>\n\n<pre><code>Function Overlap(aCtrl As Object, bCtrl As Object) As Boolean\nDim hOverlap As Boolean, vOverlap As Boolean\n\nhOverlap = (bCtrl.Left - aCtrl.Width &lt; aCtrl.Left) And (aCtrl.Left &lt; bCtrl.Left + bCtrl.Width)\nvOverlap = (bCtrl.Top - aCtrl.Height &lt; aCtrl.Top) And (aCtrl.Top &lt; bCtrl.Top + bCtrl.Height)\nOverlap = hOverlap And vOverlap\nEnd Function\n</code></pre>\n\n<p>How could this work for example where the Frame control is called \"Frame1\" and the Image control is called \"Image1\"?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554920950, "post_id": 55619051, "comment_id": 97931460, "body": "What are the errors and on which line is the error thrown"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554922452, "post_id": 55619051, "comment_id": 97932166, "body": "What exactly are you trying to do with this: <code>Set myRange = ActiveSheet.Range(&quot;A3:O100&quot;).End(xlDown)</code> I might be wrong but I think you are not using this correctly. It doesn&#39;t have to do directly with your question, but still."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1554923643, "post_id": 55619051, "comment_id": 97932684, "body": "...Are the <code>`</code> we see here on SO due to copy/pasting?  Just asking since the character to comment in VBA is a single quote, <code>&#39;</code>."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1554929955, "post_id": 55619051, "comment_id": 97935424, "body": "Based on the sample data provided, your <code>myRange</code> works out to be a single cell <code>A8</code>. There are no cells with the value &quot;USD 0.00&quot;. <code>LastRow</code> calculates to be <code>1</code> because you&#39;re using column O but there&#39;s no data in your sample that runs out to that column. Also, you&#39;re comparing a numeric result returned from the <code>CountBlank</code> function to a string with <code>&quot;13&quot;</code>. My strong recommendation is to take much of your code out and start with simple logic blocks and make each one work solidly before adding the next block."}, {"owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "edited": false, "score": 0, "creation_date": 1554974079, "post_id": 55619051, "comment_id": 97949228, "body": "Sorry about not making enough changes  The columns go all the way to December  and December is the last column and thats the column O  The part of the code that removes USD 0.00 works  I am more concerned about what the VLookup is doing wrong  I am editing the code to just have that"}, {"owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554974736, "post_id": 55619051, "comment_id": 97949628, "body": "@ScottCraner The error is &quot;Object doesn&#39;t support this property or method The error is on line  <code>If cs.VLookup(Range(&quot;B&quot; &amp; Row).Value, ps.Range(&quot;B2:B100&quot;), 0) Then </code>"}, {"owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554974874, "post_id": 55619051, "comment_id": 97949711, "body": "@StavrosJon I am trying to choose the range as A3:O100 till the end of the last entry ( hence the End(xlDown)  Is there a mistake there?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554975297, "post_id": 55619051, "comment_id": 97949952, "body": "@VarunR Yes I&#39;m afraid there is.    It should look like this:   <code>Set myRange = Range(ActiveSheet.Range(&quot;A3:O3&quot;), ActiveSheet.Range(&quot;A3:O3&quot;).End(xlDown))</code>    Also you should avoid using <code>ActiveSheet</code>"}, {"owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554976473, "post_id": 55619051, "comment_id": 97950699, "body": "@StavrosJon Thank you. Changed it!  Any other suggestion about the Vlookup if Loop?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554978111, "post_id": 55619051, "comment_id": 97951710, "body": "@VarunR Also <code>cs.VLookup</code> will give you an error.  What you probably want to do is this <code>cs.Application.WorksheetFunction.VLookup(...)</code>.  Also upvoting the comments that helped you won&#39;t hurt either :-P"}, {"owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1554979279, "post_id": 55619051, "comment_id": 97952339, "body": "@StavrosJon Dont have the necessary reputations to do that yet :(  Give me one so that I can do that in the future :D  Also, Thank you for your help with the Vlookup thing."}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1554981692, "creation_date": 1554981692, "answer_id": 55631322, "question_id": 55619051, "link": "https://stackoverflow.com/questions/55619051/looking-for-value-in-column-a-in-sheet-a-in-column-b-present-in-sheet-b-and-chan/55631322#55631322", "title": "looking for value in Column A in Sheet A in Column B present in Sheet B and changing color", "body": "<p>If I read your question right, you would like to modify the formatting of a cell, based on some information, which can be retrieved from a formula.</p>\n\n<p>There are two different cases:</p>\n\n<ol>\n<li>You want the formatting of that cell only to happen, based on user interaction (like clicking a button). In that case, it's ok to opt for VBA.</li>\n<li>You want the formatting of that cell to happen automatically. In that case, it's better to opt for conditional formatting.</li>\n</ol>\n\n<p>In case you opt for conditional formatting, you might need a formula, based on the following:</p>\n\n<pre><code>=VLookup(A!B3;B!$B$2:$B$100;2) // this will give the value for January for Apple1 in sheet B.\n                               // In case \"Apple1\" is not there, you get a #N/A error.\n=ISNA(...)                     // You might use this for catching #N/A errors.\n...\n</code></pre>\n\n<p>So, basically, you'll end up with a formula like this:</p>\n\n<pre><code>=ISNA(VLOOKUP(...);0) - ISNA(VLOOKUP(...);0)&gt;0\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4608000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/360df1aaa0e11c59407e5142b844f42e?s=128&d=identicon&r=PG&f=1", "display_name": "VarunR", "link": "https://stackoverflow.com/users/4608000/varunr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1554981692, "creation_date": 1554920620, "last_edit_date": 1554979472, "question_id": 55619051, "link": "https://stackoverflow.com/questions/55619051/looking-for-value-in-column-a-in-sheet-a-in-column-b-present-in-sheet-b-and-chan", "title": "looking for value in Column A in Sheet A in Column B present in Sheet B and changing color", "body": "<p>There are multiple steps in what I am trying to do so bear with me.</p>\n\n<p>I have two sheets A and B</p>\n\n<p>Sheet A</p>\n\n<pre><code>                    Jan     Feb     March   Apr Jun Jul Aug Sep Oct Nov Dec         \nNames   SubNames                \nApple   Apple1      30.00                    -   -   -   -   -   -   -   -\n        Apple2      45.00   10               -   -   -   -   -   -   -   -\n        Apple3                               -   -   -   -   -   -   -   -\n        Apple4                               -   -   -   -   -   -   -   -\n        SubTotal    75.00   0.00    10.00    \nBanana  Banana11                             -   -   -   -   -   -   -   -\n        Banana22    15.00                    -   -   -   -   -   -   -   -\n        Banana33    32.00   17.75   65.00    -   -   -   -   -   -   -   -\n        SubTotal    37.00   32.75   34.50   \nCherry  1Cherry1    28.00   13.78   43.00    -   -   -   -   -   -   -   -\n        2Cherry2            20.00       \n        3Cherry3    20.00   16.50   100.00   -   -   -   -   -   -   -   -  \n        Subtotal    48.00   50.28   143.00   -   -   -   -   -   -   -   -\nDragon  DragonF1    31.00   35.00            -   -   -   -   -   -   -   -\n        Subtotal    31.00   35.00   0.00    \n        Grand Total 191.00  118.03  187.50  \n                            496.53          \n</code></pre>\n\n<p>Sheet B                 </p>\n\n<pre><code>                    Jan     Feb     March   Apr Jun Jul Aug Sep Oct Nov Dec     \nNames   SubNames            \nApple   Apple1      30.00                    -   -   -   -   -   -   -   -\n        Apple2      60.00                    -   -   -   -   -   -   -   -\n        Apple3                               -   -   -   -   -   -   -   -\n        Apple4                               -   -   -   -   -   -   -   -\n        SubTotal    90.00   0.00    0.00\nBanana  Banana11                             -   -   -   -   -   -   -   -\n        Banana22                             -   -   -   -   -   -   -   -\n        Banana33    37.00   17.75   34.50    -   -   -   -   -   -   -   -\n        SubTotal    37.00   17.75   34.50\nCherry  1Cherry1    28.00   13.78   63.15    -   -   -   -   -   -   -   -\n        2Cherry2            15.35            -   -   -   -   -   -   -   -\n        3Cherry3    35.00   16.50   97.65    -   -   -   -   -   -   -   -\n        Subtotal    63.00   45.63   160.80\nExtra   Extra1234   30.00                    -   -   -   -   -   -   -   -\n        Extra4321                            -   -   -   -   -   -   -   -\n        Subtotal    30.00   0.00    0.00\nDragon  DragonF1    31.00   34.50            -   -   -   -   -   -   -   -\n        Subtotal    31.00   34.50   0.00     -   -   -   -   -   -   -   -\n     Grand Total    251.00  97.88   195.30\n                            544.18      \n\n</code></pre>\n\n<p>There are columns from A - O</p>\n\n<p>I need to check if the values in Sheet B Column B match with values in Sheet A and Column B </p>\n\n<p>If they do, I need the values under Jan, Feb and March to be compared as follows:</p>\n\n<p>Change color of cell to Green in Sheet B if the value increases from Sheet A to B\nChange color of cell to Decreases in Sheet B if the value decreases from Sheet A to B</p>\n\n<p>Subtotals and Totals fields can be ignored. </p>\n\n<p>I keep getting errors, but I am not sure if my code is complete. </p>\n\n<pre><code>Public Sub Edit()\n    Dim myRange As Range\n    Dim iCell As Range\n    Dim LastRow As Integer, Row As Integer, Col As Integer\n    Dim CSheet As Integer, PSheet As Integer\n    CSheet = ActiveSheet.Index\n    PSheet = CSheet - 1\n\n    Set cs = ActiveSheet\n    Set ps = Worksheets(PSheet)\n\n    'selecting range of active region\n    Set myRange = Range(ActiveSheet.Range(\"A3:O3\"), ActiveSheet.Range(\"A3:O3\").End(xlDown))\n\n    LastRow = Cells(Rows.Count, 15).End(xlUp).Row\n\n    'Highlighting all rows with no entries for forecast\n    For Row = 3 To LastRow\n        If WorksheetFunction.CountBlank(Range(\"C\" &amp; Row &amp; \":O\" &amp; Row)) = \"13\" Then\n            Range(\"C\" &amp; Row &amp; \":O\" &amp; Row).Style = \"Note\"\n        End If\n\n        'Highlighting green and red\n        If cs.VLookup(Range(\"B\" &amp; Row).Value, ps.Range(\"B2:B100\"), 0) Then\n            For Col = 3 To 15\n                If cs.Cells(Row, Col) &gt;= ps.Cells(Row &amp; Col) Then\n                    cs.Cells(Row, Col).Style = \"Good\"\n                Else\n                    cs.Cells(Row, Col).Style = \"Bad\"\n                End If\n            Next Col\n\n        End If\n\n    Next Row\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autocad"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554925902, "post_id": 55618848, "comment_id": 97933668, "body": "Where is <code>shtCount</code> defined? That might be throwing your error 91. A quick google search also gives <a href=\"http://www.vbforums.com/showthread.php?667363-RESOLVED-VBA-Word-Excel-Error-462-when-running-the-code-twice\" rel=\"nofollow noreferrer\">a possible cause of your error 462</a>"}, {"owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554991979, "post_id": 55618848, "comment_id": 97960407, "body": "shtCount is DIM&#39;d as an integer and defined in the same like Error 91 is thrown.  I&#39;ve already been through that thread and made the changes. Haven&#39;t helped"}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554993374, "post_id": 55618848, "comment_id": 97961371, "body": "I would guess then that the error is coming from <code>Set wBook = ExcelApp.ActiveWorkbook</code>. If any window (clipboard, messagebox, etc) is open on top of Excel, then this will &quot;fail&quot; silently by setting <code>wBook</code> to <code>Nothing</code>. Then, when you go to count sheets in <code>wBook</code>, you&#39;ll get the Error 91."}, {"owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1555017177, "post_id": 55618848, "comment_id": 97972929, "body": "As I said below the Excel workbook is already open, so I&#39;ll have to test if the Set ExcelApp = GetObject(, &quot;Excel.Application&quot;) in the first line brings Excel &quot;to the front,&quot; so to speak, or if it does get set to Nothing. I&#39;ll check it out"}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1555084674, "post_id": 55618848, "comment_id": 97999684, "body": "Did that solve it, or is this one still unresolved? Now you&#39;ve got me curious."}, {"owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1555331029, "post_id": 55618848, "comment_id": 98061173, "body": "I checked whether Excel gets brought &quot;to the front&quot; with the GetApplication command, and it seems it does. So sadly no, that didn&#39;t fix the issue."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "edited": false, "score": 0, "creation_date": 1554991333, "post_id": 55619300, "comment_id": 97959950, "body": "Thank you for your reply, I appreciate the help.  You&#39;re correct that Excel is already open when this bit runs, and the source Excel workbook and target workbook are the same file, so my program opens Excel workbook -&gt; .dwg file info removed -&gt; drawing files scraped for data (with excels still open) -&gt; data placed in open Excel workbook.  I removed the &quot;no sense&quot; if statement."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "edited": false, "score": 0, "creation_date": 1555004114, "post_id": 55619300, "comment_id": 97967570, "body": "@John You&#39;re welcome. Did my suggestion resolve the errors you were encountering?"}, {"owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "edited": false, "score": 0, "creation_date": 1555017268, "post_id": 55619300, "comment_id": 97972963, "body": "Unfortunately no, neither your suggestions or SG&#39;s above have helped. I made a workaround by using a basic .txt file instead of excel for now, but I&#39;ll try out what I mentioned in my last above and report back"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 1, "last_activity_date": 1555003605, "last_edit_date": 1555003605, "creation_date": 1554921579, "answer_id": 55619300, "question_id": 55618848, "link": "https://stackoverflow.com/questions/55618848/vba-in-autocad-errors-inconsistently-when-referencing-excel/55619300#55619300", "title": "VBA In AutoCAD Errors Inconsistently When Referencing Excel", "body": "<p>On first review, there are several issues with this block of code:</p>\n\n<pre><code>Set ExcelApp = GetObject(, \"Excel.Application\")\nIf ExcelApp Is Nothing Then\n    Set ExcelApp = CreateObject(\"Excel.Application\")\n    If Not ExcelApp Then\n        ExcelApp.Workbooks.Open (tempName)\n    End If\nEnd If\n</code></pre>\n\n<p>The statement:</p>\n\n<pre><code>Set ExcelApp = GetObject(, \"Excel.Application\")\n</code></pre>\n\n<p>Will raise a runtime error if Excel is not open; presumably, you have <code>On Error Resume Next</code> present in your code to bypass this error, or perhaps you have Excel open in your testing.</p>\n\n<p>If Excel is already open, your code will never open your target workbook since the code will not reach the statement:</p>\n\n<pre><code>ExcelApp.Workbooks.Open (tempName)\n</code></pre>\n\n<p>Furthermore, the <code>if</code> statement surrounding the above expression makes no sense:</p>\n\n<pre><code>If Not ExcelApp Then\n    ExcelApp.Workbooks.Open (tempName)\nEnd If\n</code></pre>\n\n<p>Here, you are saying: <em>\"if the ExcelApp evaluates to False then use it to open the Workbook\"</em></p>\n"}], "owner": {"reputation": 21, "user_id": 10653154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ug5lPvUqaPg/AAAAAAAAAAI/AAAAAAAAAA8/Rn9d8vm8Zug/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/10653154/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555003605, "creation_date": 1554919799, "last_edit_date": 1554992019, "question_id": 55618848, "link": "https://stackoverflow.com/questions/55618848/vba-in-autocad-errors-inconsistently-when-referencing-excel", "title": "VBA In AutoCAD Errors Inconsistently When Referencing Excel", "body": "<p>I have a program that looks at a list of .dwg files in an excel file, opens the drawings one at a time, pulls the properties for given block references, then dumps those properties into a new sheet in the original excel file.</p>\n\n<p>This code runs perfectly fine roughly half the time, with all the data accounted for and formatted properly, but the other half of the time I get Run-time Errors 9, 91 or 462.</p>\n\n<p>I put the errors in parentheses in the line they're thrown. </p>\n\n<p>What in my code is causing these errors, and if it's not a programming issue then what's the best way to write an ErrorHandler for these errors?</p>\n\n<pre><code>Set ExcelApp = GetObject(, \"Excel.Application\")\nIf ExcelApp Is Nothing Then\n    Set ExcelApp = CreateObject(\"Excel.Application\")\n    If Not ExcelApp Then\n        ExcelApp.Workbooks.Open (tempName)\n    End If\nEnd If\n\nExcelApp.DisplayAlerts = False\nExcelApp.Visible = False\nSet wBook = ExcelApp.ActiveWorkbook\nDoEvents\n\nshtCount = wBook.Worksheets.Count ' ' (Error 91)\nIf shtCount &lt;&gt; 1 Then\n    DoEvents\n    wBook.Worksheets(\"Dump\").Delete ' ' (Error 9, Despite that sheet existing)\n    DoEvents\nEnd If\n\nSet wSheet = wBook.Worksheets.Add(After:=Worksheets(\"DrawSheets\")) ' ' (Error 462)\nDoEvents\nwSheet.Name = \"Dump\"\nDoEvents\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1554919409, "post_id": 55618677, "comment_id": 97930710, "body": "Within your <code>For...Next</code> or <code>For Each</code> loop, you need an <code>If [condition = True] Then Exit For</code>. This, as you might surmise, instructs the program to <i>exit</i> the loop when the condition is met. <code>Do Until [condition = True]</code> should also solve it, assuming you&#39;ve implemented the loop propertly. Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> example of the code you&#39;re using, it&#39;s not really possible to further assist. Also, please consider including example data as raw text rather than screenshots. The former are easier for others to copy/paste into a spreadsheet and therefore debug your problem."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1554919473, "post_id": 55618677, "comment_id": 97930740, "body": "Why not just modify the formula in column G? Adding a <code>COUNTIF</code> to count the number of previous instances of &quot;Prize #2&quot; should do the trick, if I understand the requirement correctly."}, {"owner": {"reputation": 33, "user_id": 11024467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d9e3dabee5429237c8ee57037d83a?s=128&d=identicon&r=PG&f=1", "display_name": "Apostate", "link": "https://stackoverflow.com/users/11024467/apostate"}, "edited": false, "score": 0, "creation_date": 1554921725, "post_id": 55618677, "comment_id": 97931816, "body": "BigBen, I think I could make yours work, but I already got another solution in VBA."}, {"owner": {"reputation": 33, "user_id": 11024467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d9e3dabee5429237c8ee57037d83a?s=128&d=identicon&r=PG&f=1", "display_name": "Apostate", "link": "https://stackoverflow.com/users/11024467/apostate"}, "edited": false, "score": 0, "creation_date": 1554921782, "post_id": 55618677, "comment_id": 97931848, "body": "David, I get what you&#39;re saying there, but I found an answer elsewhere.  But thanks anyway"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 11024467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d9e3dabee5429237c8ee57037d83a?s=128&d=identicon&r=PG&f=1", "display_name": "Apostate", "link": "https://stackoverflow.com/users/11024467/apostate"}, "is_accepted": false, "score": 0, "last_activity_date": 1554922260, "creation_date": 1554922260, "answer_id": 55619484, "question_id": 55618677, "link": "https://stackoverflow.com/questions/55618677/vba-how-to-skip-rows-based-on-condition-and-stop-when-a-specific-number-of-condi/55619484#55619484", "title": "VBA how to skip rows based on condition and stop when a specific number of conditions have been met", "body": "<p>Here is the code that ended up working.  Hope I generic'd it up correctly</p>\n\n<pre><code>Dim P1Range As Range\nDim P1Cell As Range\nDim P2Range As Range\nDim Counter As Long\nSet P1Range = Range(\"F7:F\" &amp; LastRowDest)\nSet P2Range = Range(\"G7:G\" &amp; LastRowDest)\nCounter = Application.WorksheetFunction.CountIf(P2Range, \"Prize2\")\n    For Each P1Cell In P1Range\n            If P1Cell Like \"*Prize1*\" Then\n                Counter = Application.WorksheetFunction.CountIf(P2Range, \"Prize2\")\n                 'MsgBox Counter\n                If Counter &lt; 2 Then\n                P1Cell.Offset(0, 1).Formula = \"Prize2\"                \n                End If                 \n            End If        \n        Next P1Cell\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11024467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d9e3dabee5429237c8ee57037d83a?s=128&d=identicon&r=PG&f=1", "display_name": "Apostate", "link": "https://stackoverflow.com/users/11024467/apostate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554984193, "creation_date": 1554919039, "last_edit_date": 1554984193, "question_id": 55618677, "link": "https://stackoverflow.com/questions/55618677/vba-how-to-skip-rows-based-on-condition-and-stop-when-a-specific-number-of-condi", "title": "VBA how to skip rows based on condition and stop when a specific number of conditions have been met", "body": "<p>I'm running a data file for a contest where there are two types of prizes.  The second prize is based on the first, but using VBA, I'm having difficulty skipping rows AND stopping at specific condition (count).</p>\n\n<p>The output looks like this\n<img src=\"https://i.imgur.com/om2cop4.jpg\" alt=\"Imgur\"></p>\n\n<p>There are only 2 available for Prize2 and I want the VBA code to stop it at the 2nd successful Prize2</p>\n\n<p>I've looked at Do Until Loops and For...Next options, but haven't gotten a successful code to stop the Prize 2 list without filling the entire column or getting an error</p>\n\n<p>Below is what I'm using as code to get the table as it is now.  I previously had the code for the first two rows, but if a plant doesn't have Prize 1, then the 2nd Prize2 doesn't show.</p>\n\n<pre><code>'Portion using Prize 1 to determine Prize 2\nDim LastRowDest As Long\nSheets(\"ThisSheet\").Select\nLastRowDest = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nRange(\"G2:G\" &amp; LastRowDest).FormulaR1C1 = \"=IF(RC[-1]=\"\"Prize1\"\",\"\"Prize2\"\",\"\" \"\")\"\n</code></pre>\n\n<p>This is how the output with two Prize2's available should look\n<img src=\"https://i.imgur.com/HUf1eJS.jpg\" alt=\"Imgur\"></p>\n"}, {"tags": ["excel", "vba", "charts", "range"], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1554927767, "creation_date": 1554927767, "answer_id": 55620777, "question_id": 55618021, "link": "https://stackoverflow.com/questions/55618021/how-to-make-the-range-in-my-chart-database-dynamic/55620777#55620777", "title": "how to make the range in my chart database dynamic", "body": "<p>The <code>Range</code> object takes a string as an argument, so you should be able to loop through your rows like such:</p>\n\n<pre><code>Dim intRowCount as Integer\nDim intTotalRows as Integer 'You will have to give this a value\n\nFor intRowCount = 1 to intTotalRows\n    'Your 1 second delay goes here\n    Dim strRangeString as String\n    strRangeString = \"A1:F1,A\" &amp; Trim(Str(intRowCount + 2)) &amp; \":F\" &amp; Trim(Str(intRowCount + 2)) 'Or whatever your row offset is\n    ActiveChart.SetSourceData Source:=Sheets(\"Blad1\").Range(strRangeString), _\n        PlotBy:=xlRows\nNext intRowCount\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11341667, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w-N2syzCPl0/AAAAAAAAAAI/AAAAAAAAAec/1IirlqPxpwk/photo.jpg?sz=128", "display_name": "Mario DC", "link": "https://stackoverflow.com/users/11341667/mario-dc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554946549, "creation_date": 1554916351, "last_edit_date": 1554946549, "question_id": 55618021, "link": "https://stackoverflow.com/questions/55618021/how-to-make-the-range-in-my-chart-database-dynamic", "title": "how to make the range in my chart database dynamic", "body": "<p>I am getting data <code>(12)</code> every 5 seconds and I want to put these on a chart after the data input has stopped. I want to make the chart dynamic by reading each row separately. How do I avoid having to write each line ? I need to get the offset code in the range somehow and make it loop. </p>\n\n<p>Biggest problem is that I don't know anything about writing codes, I record and try to find out like that. I have no background in IT at all.</p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Grafiek 1\").Activate\n    ActiveChart.PlotArea.Select\n    ActiveChart.SetSourceData Source:=Sheets(\"Blad1\").Range(\"A1:F2\"), _\n        PlotBy:=xlRows\n    ActiveChart.SetSourceData Source:=Sheets(\"Blad1\").Range(\"A1:F1,A3:F3\"), _\n        PlotBy:=xlRows\n    ActiveChart.SetSourceData Source:=Sheets(\"Blad1\").Range(\"A1:F1,A4:F4\"), _\n        PlotBy:=xlRows\n</code></pre>\n\n<p>I want the range to go up automatically (ie. a3:f3 --> a4:f4 -->...) so each row of data is put on the chart separately (I use a 1 second delay).</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 1, "creation_date": 1554916199, "post_id": 55617801, "comment_id": 97929150, "body": "What type of control is <code>Days_Used_For_Off_Test</code>? The controls themselves are Access Objects, so if you&#39;re trying to actually change the control, you would need a <code>Set</code> statement. If you&#39;re trying to change the value of a textbox, you would use <code>Days_Used_For_Off_Test.Value</code>. (You probably have a similar issue with <code>Fill_SKU</code>)"}, {"owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 0, "creation_date": 1554917285, "post_id": 55617801, "comment_id": 97929680, "body": "What is the error you&#39;re receiving?"}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554917173, "post_id": 55618133, "comment_id": 97929631, "body": "If the sub is located in the module for the form, isn&#39;t the <code>Me!</code> also un-necessary?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 2, "creation_date": 1554926747, "post_id": 55618133, "comment_id": 97934019, "body": "Probably yes, but the use of Me makes it clear what the intention with the code and the ownership of the control are."}, {"owner": {"reputation": 11, "user_id": 11341738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h14VdS-Ad1U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYweO03kF5giiE-syk1TjxBlgKLQ/mo/photo.jpg?sz=128", "display_name": "JayRod722", "link": "https://stackoverflow.com/users/11341738/jayrod722"}, "edited": false, "score": 0, "creation_date": 1555076250, "post_id": 55618133, "comment_id": 97994417, "body": "I tried this and now I get a data type mismatch in criteria expression. I checked and the fields I am referencing are all &quot;Number&quot; type. Is there something in the form that would throw it off?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1555078693, "post_id": 55618133, "comment_id": 97996074, "body": "No, but if number, no quotes. See edited answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1555078664, "last_edit_date": 1555078664, "creation_date": 1554916741, "answer_id": 55618133, "question_id": 55617801, "link": "https://stackoverflow.com/questions/55617801/how-to-get-a-form-field-to-auto-fill-when-a-product-is-entered/55618133#55618133", "title": "How to get a form field to auto fill when a product is entered?", "body": "<p>You probably are referring to the current form, thus use <em>Me</em>:</p>\n\n<pre><code>Private Sub PopulateFields()\n    Me!Days_Used_For_Off_Test.Value = DLookup(\"Days_Used_For_Off_Test\", \"tblTestDays\", \"Fill_SKU = \" &amp; Me!Fill_SKU.Value &amp; \"\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11341738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h14VdS-Ad1U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYweO03kF5giiE-syk1TjxBlgKLQ/mo/photo.jpg?sz=128", "display_name": "JayRod722", "link": "https://stackoverflow.com/users/11341738/jayrod722"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594621229, "creation_date": 1554915495, "last_edit_date": 1594621229, "question_id": 55617801, "link": "https://stackoverflow.com/questions/55617801/how-to-get-a-form-field-to-auto-fill-when-a-product-is-entered", "title": "How to get a form field to auto fill when a product is entered?", "body": "<p>I am trying to get my form to populate the days needed for testing automatically when I enter a new record but it keeps erring out. I am very new to using VBA and Access 2016.</p>\n\n<p>I have looked at some other examples that people have posted that work and cannot get it to work.<br>\nI am continually getting debugger.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Fill_SKU_AfterUpdate()\n    PopulateFields\nEnd Sub\n\nPrivate Sub PopulateFields()\n    frmSerialTracerLog.Days_Used_For_Off_Test = DLookup(\"Days_Used_For_Off_Test\", \"tblTestDays\", \"Fill_SKU = '\" &amp; frmSerialTracerLog.Fill_SKU &amp; \"'\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1554916127, "post_id": 55617779, "comment_id": 97929118, "body": "Out of curiosity, does the &quot;slideshow&quot; need to run 24 hours a day?"}, {"owner": {"reputation": 25, "user_id": 9867400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1809436f2225f2af370a7f54de1cfc93?s=128&d=identicon&r=PG", "display_name": "dausfaul", "link": "https://stackoverflow.com/users/9867400/dausfaul"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554926089, "post_id": 55617779, "comment_id": 97933752, "body": "Yes, that is correct. This spreadsheet will be running 24 hours a day."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554927375, "post_id": 55617779, "comment_id": 97934313, "body": "Then the answer below will work, just dont forget to change <code>Application.OnTime Now + TimeValue(&quot;00:00:05&quot;), &quot;ShowNextSheet&quot;</code> to <code>Application.OnTime Now + TimeValue(&quot;00:00:10&quot;), &quot;ShowNextSheet&quot;</code> since you want the change to happen every 10 seconds."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9867400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1809436f2225f2af370a7f54de1cfc93?s=128&d=identicon&r=PG", "display_name": "dausfaul", "link": "https://stackoverflow.com/users/9867400/dausfaul"}, "edited": false, "score": 0, "creation_date": 1554929969, "post_id": 55618156, "comment_id": 97935433, "body": "I&#39;ve updated the code to look like this: <code>Sub StartSlideShow()     Application.OnTime Now + TimeValue(&quot;00:00:05&quot;), &quot;ShowNextSheet&quot; End Sub  Sub ShowNextSheet()     Dim lastIndex As Integer, nextShtIndex As Integer      lastShtIndex = Worksheets.Count     nextShtIndex = ActiveSheet.Index + 1  If nextShtIndex &lt;= lastShtIndex Then     Worksheets(nextShtIndex).Select     StartSlideShow Else     Worksheets(1).Select     StartSlideShow End If End Sub  </code> It posts Runtime Error &#39;1004&#39; Select method of Worksheet class failed  Says line   <code>Worksheets(nextShtIndex).Select</code> is issue"}, {"owner": {"reputation": 25, "user_id": 9867400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1809436f2225f2af370a7f54de1cfc93?s=128&d=identicon&r=PG", "display_name": "dausfaul", "link": "https://stackoverflow.com/users/9867400/dausfaul"}, "edited": false, "score": 0, "creation_date": 1554932643, "post_id": 55618156, "comment_id": 97936438, "body": "Found out what was causing the error - A hidden sheet was interrupting the sequence, Unhid the sheet and it started working."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 25, "user_id": 9867400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1809436f2225f2af370a7f54de1cfc93?s=128&d=identicon&r=PG", "display_name": "dausfaul", "link": "https://stackoverflow.com/users/9867400/dausfaul"}, "edited": false, "score": 0, "creation_date": 1554943884, "post_id": 55618156, "comment_id": 97939226, "body": "@dausfaul Great to hear. Hidden sheets can&#39;t be selected."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 3, "last_activity_date": 1554916816, "creation_date": 1554916816, "answer_id": 55618156, "question_id": 55617779, "link": "https://stackoverflow.com/questions/55617779/continuous-worksheet-switching-loop/55618156#55618156", "title": "Continuous Worksheet Switching Loop", "body": "<p>The code that you're currently using checks if the index of the next sheet is less than (or equal to) the last index of the workbook. If it isn't (meaning you've gone through all of your sheets), then the application terminates. In your case, you don't want to terminate the application, so in the case that the next sheet index is greater than the last sheet, simply select the first sheet manually, and refire the code.</p>\n\n<pre><code>If nextShtIndex &lt;= lastShtIndex Then\n    Worksheets(nextShtIndex).Select\n    StartSlideShow\nElse\n    Worksheets(1).Select\n    StartSlideShow\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9867400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1809436f2225f2af370a7f54de1cfc93?s=128&d=identicon&r=PG", "display_name": "dausfaul", "link": "https://stackoverflow.com/users/9867400/dausfaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 55618156, "answer_count": 1, "score": 2, "last_activity_date": 1618322345, "creation_date": 1554915356, "last_edit_date": 1618322345, "question_id": 55617779, "link": "https://stackoverflow.com/questions/55617779/continuous-worksheet-switching-loop", "title": "Continuous Worksheet Switching Loop", "body": "<p>I have an Excel spreadsheet to display SQL Data charts that will show on a monitor in our machine shop.</p>\n<p>The spreadsheet has 45 tabs and I need to switch between tabs with an interval of 10 seconds per tab and then return to the first tab and repeat the loop.</p>\n<p>I found <a href=\"https://stackoverflow.com/questions/12233753/how-can-i-change-excel-sheets-with-5sec-time-gap-one-after-another-using-vb-code\">How can i change excel sheets with 5sec time gap one after another using VB code by macro?</a>).</p>\n<p>How do I make the code loop indefinitely?</p>\n<p>Here's the code from the link:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub StartSlideShow()\n    Application.OnTime Now + TimeValue(&quot;00:00:05&quot;), &quot;ShowNextSheet&quot;\nEnd Sub\n\nSub ShowNextSheet()\n    Dim lastIndex As Integer, nextShtIndex As Integer\n\n    lastShtIndex = Worksheets.Count\n    nextShtIndex = ActiveSheet.Index + 1\n\n    If nextShtIndex &amp;lt;= lastShtIndex Then\n        Worksheets(nextShtIndex).Select\n        StartSlideShow\n    Else\n        MsgBox &quot;End of slide show&quot;\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "edited": false, "score": 0, "creation_date": 1554939146, "post_id": 55618127, "comment_id": 97938248, "body": "Thanks for the easy tip. Plz make a slight correction in your code by replacing <code>vbCtrlMask</code> with <code>acCtrlMask</code>. It works fine then."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 2, "last_activity_date": 1554980737, "last_edit_date": 1554980737, "creation_date": 1554916720, "answer_id": 55618127, "question_id": 55617668, "link": "https://stackoverflow.com/questions/55617668/how-to-trap-vbkeyreturn-only-in-vba-access/55618127#55618127", "title": "How to trap vbKeyReturn only in VBA Access", "body": "<p>You need to check for the <code>Shift</code> argument like this:</p>\n\n<pre><code>Private Sub Text1_KeyDown(KeyCode As Integer, Shift As Integer)\n   If KeyCode = vbKeyReturn Then\n      If Not Shift = acCtrlMask Then\n         MsgBox \"Enter\"\n         KeyCode = 0\n         Me.parent.Combo.SetFocus\n      End If\n   End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "edited": false, "score": 0, "creation_date": 1554938843, "post_id": 55618195, "comment_id": 97938177, "body": "I tried but it didn&#39;t work. I found the answer by @Lee Mac as solution."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1554916969, "creation_date": 1554916969, "answer_id": 55618195, "question_id": 55617668, "link": "https://stackoverflow.com/questions/55617668/how-to-trap-vbkeyreturn-only-in-vba-access/55618195#55618195", "title": "How to trap vbKeyReturn only in VBA Access", "body": "<p>Try checking for the key code:</p>\n\n<pre><code>Private Sub txt_1_KeyDown(KeyCode As Intger, Shift as Integer)\n\n    Select Case KeyCode\n        Case vbKeyEnter\n            KeyCode = 0\n            Me.parent.Combo.SetFocus\n        Case Else\n            ' Leave key code as is.\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 3, "last_activity_date": 1554920902, "creation_date": 1554920902, "answer_id": 55619138, "question_id": 55617668, "link": "https://stackoverflow.com/questions/55617668/how-to-trap-vbkeyreturn-only-in-vba-access/55619138#55619138", "title": "How to trap vbKeyReturn only in VBA Access", "body": "<p>You will need a conditional expression testing that:</p>\n\n<ul>\n<li>The <kbd>Enter</kbd> key (ASCII character 13) has been pressed</li>\n<li>The Shift argument of the event handler is zero, indicating no <kbd>Ctrl</kbd>, <kbd>Shift</kbd>, <kbd>Alt</kbd> have been pressed in conjunction with the <kbd>Enter</kbd> key.</li>\n</ul>\n\n<p>The code might look something like this:</p>\n\n<pre><code>Private Sub txt_1_KeyDown(KeyCode As Intger, Shift As Integer)\n    If KeyCode = 13 And Shift = 0 Then\n        KeyCode = 0\n        Me.Parent.Combo.SetFocus\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 55619138, "answer_count": 3, "score": 2, "last_activity_date": 1554980737, "creation_date": 1554914951, "last_edit_date": 1554915961, "question_id": 55617668, "link": "https://stackoverflow.com/questions/55617668/how-to-trap-vbkeyreturn-only-in-vba-access", "title": "How to trap vbKeyReturn only in VBA Access", "body": "<p>I have a <code>textbox</code> control in a <code>subForm</code> which is a <code>singleForm</code>. However, when I press <code>enter</code> key it adds a <code>new record</code> and the previous <code>record</code> hides away. I have the <code>form property</code> already set to <code>current record</code>. </p>\n\n<p>I used the code below to trap <code>enter</code> key, that works. </p>\n\n<pre><code>Private Sub txt_1_KeyDown (KeyCode As Intger, Shift as Integer)\n\nSelect case KeyCode\n    Case vbKeyCode\n        KeyCode = 0\n        Me.parent.Combo.SetFocus\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>However, now I cannot add a <code>new line</code> using <code>Ctrl + Enter</code> within the <code>textbox</code> since the code fires as soon as I press <code>enter</code>. Can someone help how to change the code above so that it only traps <code>enter</code> key and keeps the default Access behavior of adding new line on pressing <code>Ctrl + Enter</code>.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "edited": false, "score": 0, "creation_date": 1554931201, "post_id": 55617611, "comment_id": 97935939, "body": "Thanks @Dmitry, took a bit of trial and error but this worked exactly as I wanted it to."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1554914767, "creation_date": 1554914767, "answer_id": 55617611, "question_id": 55617526, "link": "https://stackoverflow.com/questions/55617526/excel-userform-to-get-outlook-display-name-and-email-from-alias/55617611#55617611", "title": "Excel Userform to get outlook display name and email from alias", "body": "<p>Instead of using <code>olGAL.AddressEntries(olAliasName)</code>, use <code>olNS.CreateRecipient(olAliasName)</code> / <code>Recipient.Resolve</code> / <code>set olMember = Recipient.AddressEntry</code></p>\n"}], "owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55617611, "answer_count": 1, "score": 0, "last_activity_date": 1554914767, "creation_date": 1554914502, "question_id": 55617526, "link": "https://stackoverflow.com/questions/55617526/excel-userform-to-get-outlook-display-name-and-email-from-alias", "title": "Excel Userform to get outlook display name and email from alias", "body": "<p>I have a userform with 3 textboxes and 1 button. I want to put an outlook alias into textbox1 (txtPID) and return the display type and email in boxes 2 &amp; 3 (txtName &amp; txtEmail)</p>\n\n<p>this appears to connect to outlook and pull information but it's not searching the alias given in textbox 1</p>\n\n<pre><code>\nLoad UsrFrmNewRep\n\nDim olApp As Outlook.Application\nDim olNS As Outlook.Namespace\nDim olGAL As Outlook.AddressList\nDim olMember As Outlook.AddressEntry\nDim olAliasName As String\nDim exchuser As Outlook.ExchangeUser\n\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olGAL = olNS.AddressLists(\"Global Address List\")\n\nolAliasName = UsrFrmNewRep.txtPID.Value\nSet olMember = olGAL.AddressEntries(olAliasName)\nSet exchuser = olMember.GetExchangeUser\n\nIf Not exchuser Is Nothing Then\n\nUsrFrmNewRep.txtName.Value = exchuser.DisplayType\nUsrFrmNewRep.txtEmail.Value = exchuser.PrimarySmtpAddress\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>i'm sure i'm not referencing something correctly i'm just not sure what. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "string", "string-length"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1554915103, "post_id": 55617482, "comment_id": 97928612, "body": "Why use the address at all? You already have a Range object, so just loop through its Areas collection and delete the offset range for each area."}, {"owner": {"reputation": 49, "user_id": 2941294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ee91bb163f0bf75dadad2e4782fc44?s=128&d=identicon&r=PG", "display_name": "Graeme Hilton", "link": "https://stackoverflow.com/users/2941294/graeme-hilton"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1554981913, "post_id": 55617482, "comment_id": 97953842, "body": "@Rory - That&#39;s a good hint. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 2941294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ee91bb163f0bf75dadad2e4782fc44?s=128&d=identicon&r=PG", "display_name": "Graeme Hilton", "link": "https://stackoverflow.com/users/2941294/graeme-hilton"}, "edited": false, "score": 0, "creation_date": 1554981943, "post_id": 55618314, "comment_id": 97953868, "body": "So with the hint from @rory I got the following code:     Set rngDeleteCells = sht.Clumns(n).SpecialCells(xlTypeBlanks)     For Each delRange in rngDeleteCells.Areas         destSht.Range(delRange.Offset(0,n-1).Address).Clear     Nest delRange"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1554917449, "creation_date": 1554917449, "answer_id": 55618314, "question_id": 55617482, "link": "https://stackoverflow.com/questions/55617482/how-can-i-get-the-full-return-value-from-an-address-method/55618314#55618314", "title": "How can I get the full return value from an Address Method?", "body": "<p>@Rory is suggesting you do something like this...\nChange the column letter offset value as needed. Note: If you use a negative number that would offset past Col A, you will get an error.</p>\n\n<pre><code>For Each cell In Range(\"B2:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n    If cell = \"\" Then\n        cell.Offset(, -1).Clear\n    End If\nNext cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1554926188, "creation_date": 1554926188, "answer_id": 55620408, "question_id": 55617482, "link": "https://stackoverflow.com/questions/55617482/how-can-i-get-the-full-return-value-from-an-address-method/55620408#55620408", "title": "How can I get the full return value from an Address Method?", "body": "<p>You can do this with the <code>AutoFilter</code> and the <code>SpecialCells</code> method:</p>\n\n<p>You may have to change the worksheet and cell references in the code depending on where your table is located:</p>\n\n<pre><code>Option Explicit\nSub delRowsWithBlanks()\n    Dim R As Range, WS As Worksheet\n    Dim rArea As Range, lrowCount As Long\n\nSet WS = Worksheets(\"sheet3\")\nWith WS\n    Set R = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(columnsize:=2)\nEnd With\n\nR.AutoFilter field:=2, Criteria1:=\"=\"\nlrowCount = 0\n    For Each rArea In R.SpecialCells(xlCellTypeVisible).Areas\n        lrowCount = lrowCount + rArea.Rows.Count\n    Next rArea\n\nIf lrowCount &gt; 1 Then 'assumes header row\n    R.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nEnd If\n\nR.AutoFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 2941294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ee91bb163f0bf75dadad2e4782fc44?s=128&d=identicon&r=PG", "display_name": "Graeme Hilton", "link": "https://stackoverflow.com/users/2941294/graeme-hilton"}, "is_accepted": false, "score": 0, "last_activity_date": 1555054159, "last_edit_date": 1555054159, "creation_date": 1554982239, "answer_id": 55631476, "question_id": 55617482, "link": "https://stackoverflow.com/questions/55617482/how-can-i-get-the-full-return-value-from-an-address-method/55631476#55631476", "title": "How can I get the full return value from an Address Method?", "body": "<p>I'm posting an \"Answer\" to get the formatting correct and to post up my final solution:</p>\n\n<pre><code>rngDeleteCells = sht.Columns(n).SpecialCells(xlCellTypeBlanks)\nFor Each delRange In rngDeleteCells.Areas\n    destSht.Range(delRange.Offset(0, n - 1).Address).Clear\nNext delRange\n</code></pre>\n\n<p>I have to use the <code>.Address</code> for each <code>delRange</code> so I can then offset to a different column in a different sheet for the deletion.</p>\n\n<p>Thanks to @rory and @GMalc for their help.</p>\n"}], "owner": {"reputation": 49, "user_id": 2941294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ee91bb163f0bf75dadad2e4782fc44?s=128&d=identicon&r=PG", "display_name": "Graeme Hilton", "link": "https://stackoverflow.com/users/2941294/graeme-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1555054159, "creation_date": 1554914377, "question_id": 55617482, "link": "https://stackoverflow.com/questions/55617482/how-can-i-get-the-full-return-value-from-an-address-method", "title": "How can I get the full return value from an Address Method?", "body": "<p>I have a column of data in an Excel sheet which has empty cells distributed in it.  I have a matching column of date/time information which does not have empty cells in it. I need to delete from the date/time column those elements which match with the empty cells in the data column.\ne.g. I need to delete the Time elements for 5 and 9.</p>\n\n<pre><code>Time Data\n   1    1\n   2    2\n   3    3\n   4    4\n   5\n   6    5\n   7    6\n   8    7\n   9\n  10    8   \n  11    9\n  12   10\n</code></pre>\n\n<p>Using VBA I have generated a list of the blank cells in the Data column with this code:</p>\n\n<pre><code>deleteCells = sht.Columns(n).SpecialCells(xlCellTypeBlanks).Address _\n    RowAbsolute:=False, ColumnAbsolute:=False\n</code></pre>\n\n<p>and then I delete the accompanying elements of the time column with the following code.</p>\n\n<pre><code>destSht.Range(deleteCells).Offset(0, n - 1).Clear\ndestSht.Columns(2*n-1).SpecialCells(xlCellTypeConstants).Copy _\n    Destination:=destSht.Columns(tempcol)\ndestSht.Columns(tempcol).Copy Destination:=destSht.Columns(2*n-1)`\n</code></pre>\n\n<p>(The Offset means delete one column to the left of the reference given, the following two lines then copy the data to a temporary location and in the process close up the gaps created in the column, then copy it back again.)</p>\n\n<p>But, the returned string for <code>deleteCells</code> is truncated at 256 characters (Len(deleteCells) => 256).  This doesn't cover all the cell references I need to delete.</p>\n\n<p>How can I get the Address to return a longer string? If this won't return more than 256 characters, how can I get the full list of cells I need to eliminate from my Time column in order to have a contiguous Data column?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 2, "last_activity_date": 1554914754, "last_edit_date": 1554914754, "creation_date": 1554914033, "answer_id": 55617393, "question_id": 55617243, "link": "https://stackoverflow.com/questions/55617243/how-to-output-collection-items-to-a-column-in-a-new-worksheet/55617393#55617393", "title": "How to output collection items to a column in a new worksheet?", "body": "<p>You can create a new sheet with the name you prefer, and then iterate the cells of one column to add the values to it. Here's one way to create a sheet using a helper function:</p>\n\n<pre><code>Public Function CreateSheet(ByVal shtName As String) As Worksheet\n    Dim ws As Worksheet\n    With ThisWorkbook\n        Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        ws.Name = shtName\n    End With\n    Set CreateSheet = ws\nEnd Function\n</code></pre>\n\n<p>And you can use it like this:</p>\n\n<pre><code>Sub main()\n    Dim uniques As Collection\n    Dim source As Range\n\n    Set source = ActiveSheet.Range(\"P2:AF60000\")\n    Set uniques = GetUniqueValues(source.Value)\n\n    Dim outputSheet As Worksheet\n    Set outputSheet = CreateSheet(\"Output\")\n\n    Dim i As Long\n    For i = 1 To uniques.Count\n        'Debug.Print uniques(i)\n        outputSheet.Cells(i, 1).Value = uniques(i)\n    Next\nEnd Sub\n</code></pre>\n\n<p>This will create a new sheet with the name <code>Output</code> and populate column <code>A</code> of that sheet with the values from your <code>uniques</code> collection.</p>\n"}], "owner": {"reputation": 184, "user_id": 1287165, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dd8a26a3f4c672b6e834cc16f254aa9?s=128&d=identicon&r=PG", "display_name": "anxoestevez", "link": "https://stackoverflow.com/users/1287165/anxoestevez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55617393, "answer_count": 1, "score": 0, "last_activity_date": 1554914754, "creation_date": 1554913369, "last_edit_date": 1554914266, "question_id": 55617243, "link": "https://stackoverflow.com/questions/55617243/how-to-output-collection-items-to-a-column-in-a-new-worksheet", "title": "How to output collection items to a column in a new worksheet?", "body": "<p>I have the following code intended to extract unique values from a range, whose output is printed in the debug window:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim uniques As Collection\n    Dim source As Range\n\n    Set source = ActiveSheet.Range(\"P2:AF60000\")\n    Set uniques = GetUniqueValues(source.Value)\n\n    Dim it\n    For Each it In uniques\n        Debug.Print it\n    Next\nEnd Sub\n\nPublic Function GetUniqueValues(ByVal values As Variant) As Collection\n    Dim result As Collection\n    Dim cellValue As Variant\n    Dim cellValueTrimmed As String\n\n    Set result = New Collection\n    Set GetUniqueValues = result\n\n    On Error Resume Next\n\n    For Each cellValue In values\n        cellValueTrimmed = Trim(cellValue)\n        If cellValueTrimmed = \"\" Then GoTo NextValue\n        result.Add cellValueTrimmed, cellValueTrimmed\n    NextValue:\n    Next cellValue\n\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>How I could print it to a column (a value per cell) in a new sheet?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1559904250, "post_id": 55616989, "comment_id": 99574348, "body": "Also, is there a way to get the selected text to become a separate column? Word has Comment.Scope but there doesn&#39;t seem to be an equivalent for Powerpoint."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1554979155, "post_id": 55617612, "comment_id": 97952264, "body": "Thanks PeterT, I&#39;ve tried this new code but it doesn&#39;t seem to do anything? Should I insert this somewhere in the previous code?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1554987096, "post_id": 55617612, "comment_id": 97956910, "body": "The code above should run from a module in your Powerpoint presentation. What it should do (and works for me) is to print information about the comments to the immediate window in the debugger. It illustrates how to gain access to the <code>Comment</code> object for the details you require. What you&#39;ll have to do is create an Excel Application object and transfer these comment details directly to a worksheet, just as you have in your post. Your code has the pieces for this already, you just need to merge your code with my example."}, {"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1555335650, "post_id": 55617612, "comment_id": 98063986, "body": "Thanks @PeterT, I&#39;ve tried inputting the code but it now gives me a compile error (Method or data member not found). Where would you add your Powerpoint code in my original Word code? My knowledge of VBA is very poor, apologies."}, {"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1555425168, "post_id": 55617612, "comment_id": 98102066, "body": "Thanks Peter, works brilliantly. Do you know if there is a way of creating separate columns for each reply to each comment? So if there is one comment with two replies, it would create three columns for that comment."}, {"owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "edited": false, "score": 0, "creation_date": 1559904275, "post_id": 55617612, "comment_id": 99574360, "body": "Also, is there a way to get the selected text to become a separate column? Word has Comment.Scope but there doesn&#39;t seem to be an equivalent for Powerpoint"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 3, "last_activity_date": 1555342044, "last_edit_date": 1555342044, "creation_date": 1554914771, "answer_id": 55617612, "question_id": 55616989, "link": "https://stackoverflow.com/questions/55616989/export-powerpoint-comments-to-excel/55617612#55617612", "title": "Export Powerpoint comments to Excel", "body": "<p>Here's an example you can adapt with your code above. It steps through all the slides, and catches all the comments on each slide.</p>\n\n<pre><code>Option Explicit\n\nSub ExportPowerpointComments()\n    Dim slideNumber As Long\n    Dim commentNumber As Long\n\n    Dim thisSlide As Slide\n    For Each thisSlide In ActivePresentation.Slides\n        slideNumber = thisSlide.slideNumber\n        Dim thisComment As Comment\n        For Each thisComment In thisSlide.Comments\n            commentNumber = commentNumber + 1\n            With thisComment\n                Debug.Print commentNumber &amp; vbTab;\n                Debug.Print slideNumber &amp; vbTab;\n                Debug.Print .AuthorInitials &amp; vbTab;\n                Debug.Print .Author &amp; vbTab;\n                Debug.Print Format(.DateTime, \"dd-mmm-yyyy hh:mm\") &amp; vbTab;\n                Debug.Print .Text &amp; vbTab\n            End With\n        Next thisComment\n    Next thisSlide\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>EDIT:</strong> updated code to show saving the comment data to Excel</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub ExportPointpointComments()\n    ' Create objects to help open Excel and create\n    ' a new workbook behind the scenes.\n    Dim xlApp As Excel.Application\n    Dim xlWB As Excel.Workbook\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.Visible = False\n\n    ' Create a new Workbook. Shouldn't interfere with\n    ' other Workbooks that are already open. Will have\n    ' at least one worksheet by default.\n    Set xlWB = xlApp.Workbooks.Add\n\n    With xlWB.Worksheets(1).Range(\"A1\")\n        ' Create headers for the comment information\n        .Offset(0, 0) = \"Comment Number\"\n        .Offset(0, 1) = \"Slide Number\"\n        .Offset(0, 2) = \"Reviewer Initials\"\n        .Offset(0, 3) = \"Reviewer Name\"\n        .Offset(0, 4) = \"Date Written\"\n        .Offset(0, 5) = \"Comment Text\"\n        .Offset(0, 6) = \"Section\"\n\n        Dim slideNumber As Long\n        Dim commentNumber As Long\n        Dim thisSlide As Slide\n        For Each thisSlide In ActivePresentation.Slides\n            slideNumber = thisSlide.slideNumber\n            Dim thisComment As Comment\n            For Each thisComment In thisSlide.Comments\n                commentNumber = commentNumber + 1\n                .Offset(commentNumber, 0) = commentNumber\n                .Offset(commentNumber, 1) = slideNumber\n                .Offset(commentNumber, 2) = thisComment.AuthorInitials\n                .Offset(commentNumber, 3) = thisComment.Author\n                .Offset(commentNumber, 4) = Format(thisComment.DateTime, \"dd-mmm-yyyy hh:mm\")\n                .Offset(commentNumber, 5) = thisComment.Text\n            Next thisComment\n        Next thisSlide\n    End With\n\n    ' Make the Excel workbook visible\n    xlApp.Visible = True\n\n    ' Clean up our objects\n    Set xlWB = Nothing\n    Set xlApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11341473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ccb8ad8b791463091a3717e5efd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "30 Degrees North", "link": "https://stackoverflow.com/users/11341473/30-degrees-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1555342044, "creation_date": 1554912518, "question_id": 55616989, "link": "https://stackoverflow.com/questions/55616989/export-powerpoint-comments-to-excel", "title": "Export Powerpoint comments to Excel", "body": "<p>I am trying to create a macro to export Powerpoint comments into Excel, with columns for different headings such as author, slide number etc.</p>\n\n<p>Tried using the code I have for Word for this macro, which works fine, however being a novice at VBA I don't know how to customise this code for Powerpoint</p>\n\n<pre><code>Sub ExportWordComments()\n\n' Purpose: Search for comments in any text that's been pasted into\n' this document, then export them into a new Excel spreadsheet.\n' Requires reference to Microsoft Excel 15.0 Object Library in VBA,\n' which should already be saved with as part of the structure of\n' this .docm file.\n\nDim bResponse As Integer\n\n' Exit routine if no comments have been found.\nIf ActiveDocument.Comments.Count = 0 Then\n  MsgBox (\"No comments found in this document\")\n  Exit Sub\nElse\n  bResponse = MsgBox(\"Do you want to export all comments to an Excel worksheet?\", _\n              vbYesNo, \"Confirm Comment Export\")\n  If bResponse = 7 Then Exit Sub\nEnd If\n\n' Create a object to hold the contents of the\n' current document and its text. (Shorthand\n' for the ActiveDocument object.\nDim wDoc As Document\nSet wDoc = ActiveDocument\n\n' Create objects to help open Excel and create\n' a new workbook behind the scenes.\nDim xlApp As Excel.Application\nDim xlWB As Excel.Workbook\n\nDim i As Integer\nDim oComment As Comment         'Comment object\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = False\n\n' Create a new Workbook. Shouldn't interfere with\n' other Workbooks that are already open. Will have\n' at least one worksheet by default.\nSet xlWB = xlApp.Workbooks.Add\n\nWith xlWB.Worksheets(1).Range(\"A1\")\n\n  ' Create headers for the comment information\n  .Offset(0, 0) = \"Comment Number\"\n  .Offset(0, 1) = \"Page Number\"\n  .Offset(0, 2) = \"Reviewer Initials\"\n  .Offset(0, 3) = \"Reviewer Name\"\n  .Offset(0, 4) = \"Date Written\"\n  .Offset(0, 5) = \"Comment Text\"\n  .Offset(0, 6) = \"Section\"\n\n  ' Export the actual comments information\n  For i = 1 To wDoc.Comments.Count\n   Set oComment = wDoc.Comments(i)\n   Set rngComment = oComment.Reference\n   rngComment.Select\n   Set rngHeading = wDoc.Bookmarks(\"\\HeadingLevel\").Range\n   rngHeading.Collapse wdCollapseStart\n   Set rngHeading = rngHeading.Paragraphs(1).Range\n  .Offset(i, 0) = oComment.Index\n  .Offset(i, 1) = oComment.Reference.Information(wdActiveEndAdjustedPageNumber)\n  .Offset(i, 2) = oComment.Initial\n  .Offset(i, 3) = oComment.Author\n  .Offset(i, 4) = Format(oComment.Date, \"mm/dd/yyyy\")\n  .Offset(i, 5) = oComment.Range\n  .Offset(i, 6) = rngHeading.ListFormat.ListString &amp; \" \" &amp; rngHeading.Text\nNext i\n\nEnd With\n\n' Make the Excel workbook visible\nxlApp.Visible = True\n\n' Clean up our objects\nSet oComment = Nothing\nSet xlWB = Nothing\nSet xlApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>The output is a new Excel workbook with a sheet and 7 columns that show the Comment Number, Page Number, Reviewer Initials, Reviewer Name, Date Written, Comment Text and Section (Heading)</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554912536, "post_id": 55616899, "comment_id": 97927290, "body": "Is the code definitely triggered properly when a cell changes? Do you have anything in A4?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1554912816, "post_id": 55616899, "comment_id": 97927446, "body": "<code>Cells(Rows.Count</code> I may think you have to confirm rows.count to sheet 2 as well"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554914546, "post_id": 55616899, "comment_id": 97928327, "body": "@SJR Yes there is a value in Sheet1.A4 and it monitors the entire range so if any of the cell values change in the range, it should copy over"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554914706, "post_id": 55616899, "comment_id": 97928418, "body": "Your code works for me. Is &quot;Sheet2&quot; definitely the right sheet?"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554916495, "post_id": 55616899, "comment_id": 97929294, "body": "@SJR Yes, Sheet2 should be the destination for the paste. For me, all it&#39;s doing is pasting over the same row in Sheet2. It&#39;s not creating a list. Whenever a change is made in Sheet1.Range(&quot;A4:Q4&quot;), it should copy that range, and then paste it below the last used row in Sheet2, it shouldn&#39;t paste over it. Hope that makes sense?"}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1554932850, "post_id": 55618462, "comment_id": 97936504, "body": "Awesome! Thanks so much!"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 2, "last_activity_date": 1554918045, "creation_date": 1554918045, "answer_id": 55618462, "question_id": 55616899, "link": "https://stackoverflow.com/questions/55616899/copy-range-to-another-sheets-next-row-when-a-change-is-detected/55618462#55618462", "title": "Copy Range to Another Sheet&#39;s Next Row When a Change is Detected", "body": "<p>You need to place your <code>NextRow</code> inside a <code>With</code> statement to ensure you get the correct row count.</p>\n\n<pre><code>Sheet1.Range(\"A4:R4\").Copy\n\nWith Sheets(\"Sheet2\")\nDim NextRow As Range\nSet NextRow = .Range(\"A\" &amp;  .UsedRange.Rows.Count + 1)\n\n    NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n\nApplication.CutCopyMode = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55618462, "answer_count": 1, "score": 1, "last_activity_date": 1554984187, "creation_date": 1554912209, "last_edit_date": 1554984187, "question_id": 55616899, "link": "https://stackoverflow.com/questions/55616899/copy-range-to-another-sheets-next-row-when-a-change-is-detected", "title": "Copy Range to Another Sheet&#39;s Next Row When a Change is Detected", "body": "<p>I am working on a VBA script that monitors a certain range (\"A4:Q4\") for changes as this range uses the \"RTD\" function and refreshes every second or so. Once it detects that one of the values in that range changes, I want it to copy that range over to a new sheet, and paste in the next available row.</p>\n\n<p>I have tried to below code, but currently all it does is replace the current line in Sheet2 (the destination), it does not add it to the next available row.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Worksheets(\"Sheet1\").Range(\"A4:Q4\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n       Is Nothing Then\n\n        ' Display a message when one of the designated cells has been\n        ' changed.\n        ' Place your code here.\n        ' MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n\n        'find next free cell in destination sheet\n        Dim NextFreeCell As Range\n        Set NextFreeCell = ThisWorkbook.Worksheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\n\n        'copy &amp; paste. Yes, I also want R4 to copy over\n        Worksheets(\"Sheet1\").Range(\"A4:R4\").Copy\n        NextFreeCell.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False\n\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I effectively just want to end up with a log of all the changes into sheet2, copying the range to next available empty row as changes happen. It would be nice to have this assigned to a button where one click would start the logger and another click would stop it, rather than just automatically starting when the workbook is open, but the way it is now is ok too.</p>\n\n<p>Thanks!!</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I've tried adapting to use this code instead, but it's still not adding a new row to Sheet2:</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n\n\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Worksheets(\"Sheet1\").Range(\"A4:Q4\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n\n\n    Dim NextRow As Range\n    Set NextRow = Range(\"A\" &amp; Sheets(\"Sheet2\").UsedRange.Rows.Count + 1)\n    Sheet1.Range(\"A4:R4\").Copy\n    Sheet2.Activate\n    NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n    Application.CutCopyMode = False\n    Set NextRow = Nothing\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It's just not offsetting properly in Sheet2! Ah!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1554911905, "post_id": 55616796, "comment_id": 97926947, "body": "You&#39;ll need to write some vba in the <code>Worksheet_Change()</code> event."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1554916048, "post_id": 55617926, "comment_id": 97929082, "body": "Note that I went for a Inches to Meters conversion. Since inches to metric make no sense."}, {"owner": {"reputation": 3, "user_id": 11341246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b774f6ae1a22010d9180ab815fd4496?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11341246/jason"}, "edited": false, "score": 0, "creation_date": 1554918464, "post_id": 55617926, "comment_id": 97930294, "body": "That gets me well on my way. Thank you."}], "tags": [], "owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "is_accepted": true, "score": 0, "last_activity_date": 1554915971, "creation_date": 1554915971, "answer_id": 55617926, "question_id": 55616796, "link": "https://stackoverflow.com/questions/55616796/inputs-reciprocity-metric-imperial/55617926#55617926", "title": "Inputs reciprocity METRIC &lt;---&gt; IMPERIAL", "body": "<p>You may try this. To be place in the concerned sheet's code: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"B2\")) Is Nothing Then\n        Range(\"C2\").Value = Range(\"B2\").Value * 0.0254\n    End If\n\n\n    If Not Intersect(Target, Range(\"C2\")) Is Nothing Then\n         Range(\"B2\").Value = Range(\"C2\").Value * 39.37007874 \n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11341246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b774f6ae1a22010d9180ab815fd4496?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11341246/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55617926, "answer_count": 1, "score": 0, "last_activity_date": 1554984179, "creation_date": 1554911847, "last_edit_date": 1554984179, "question_id": 55616796, "link": "https://stackoverflow.com/questions/55616796/inputs-reciprocity-metric-imperial", "title": "Inputs reciprocity METRIC &lt;---&gt; IMPERIAL", "body": "<p>I am creating a spreadsheet that will do simple conversions from inch to meters.<br> I would like is to be able to enter a value and have the conversion populate in a different cell. For example:</p>\n\n<p>Cell <code>B2</code> and <code>C2</code> are inch / meter cells. So if I enter a value into cell <code>C2</code> then <code>B2</code> will return the value of C2 * 39.37007874.<br> Conversely if I enter a value into B2, C2 would return a value of B2 * 0.0254 overwriting C2.</p>\n"}, {"tags": ["vba", "macos", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 1794536, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3e12a90b4c481a86ec14e1ea904b275?s=128&d=identicon&r=PG", "display_name": "Marion McKelvie", "link": "https://stackoverflow.com/users/1794536/marion-mckelvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1562761247, "creation_date": 1562761247, "answer_id": 56970582, "question_id": 55616784, "link": "https://stackoverflow.com/questions/55616784/createobject-excel-application-in-word-2016-for-mac/56970582#56970582", "title": "CreateObject (&quot;Excel.Application&quot;) in Word 2016 for Mac", "body": "<p>did you get anywhere with this?  I know you posted the question sometime ago, but I'm getting the same problem trying to open Excel from Powerpoint on Mac in the same way.  It worked on previous versions but fails in Office 2016.\nI've found references to people reporting it as a problem but no resolutions, although I have seen someone suggesting that Excel be opened with Applescript.  Given the number of references to the Application object in the macro, I'm probably looking at a complete rewrite.</p>\n"}, {"tags": [], "owner": {"reputation": 1091, "user_id": 1086134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd9e9d29fb9c6eb4c051bb92d9e2bf96?s=128&d=identicon&r=PG", "display_name": "Martin_W", "link": "https://stackoverflow.com/users/1086134/martin-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1601601714, "last_edit_date": 1601601714, "creation_date": 1601600366, "answer_id": 64164983, "question_id": 55616784, "link": "https://stackoverflow.com/questions/55616784/createobject-excel-application-in-word-2016-for-mac/64164983#64164983", "title": "CreateObject (&quot;Excel.Application&quot;) in Word 2016 for Mac", "body": "<p>After a lot of trial and error in Mac Word VBA, the following works for me. One important thing I discovered was that <code>CreateObject(&quot;Excel.Application&quot;)</code> returns a <code>Excel.Workbook</code> object rather than an <code>Excel.Application</code> object (and <code>GetObject(...)</code> does the same). This seems to be a change from earlier versions of Excel for Mac. Another was that the launch behavior was somewhat inconsistent, so I added retries with a delay.</p>\n<pre class=\"lang-vba prettyprint-override\"><code>    Sub Test1()\n        Dim objExcelWkbk As Object\n    \n        On Error Resume Next\n        \n        ' GetObject() and CreateObject() behave inconsistently... retry a few times\n        Dim iRetry As Integer\n        iRetry = 1\n        Do While iRetry &lt;= 3\n            ' I also tried:\n            '     Set objExcelWkbk = New Excel.Application\n            ' Although this *will* launch Excel, it always gives an &quot;Class does not support Automation or does not support expected interface&quot; error\n            \n            ' If Excel is already open then assign to the variable\n            ' For Excel, an Excel.Application.Workbook object is returned when successful (rather than Excel.Application)\n            Set objExcelWkbk = GetObject(, &quot;Excel.Application&quot;)\n            CheckAndReportError (&quot;Try#&quot; &amp; iRetry &amp; &quot; (A) GetObject()&quot;)\n            Wait 2\n            If Not objExcelWkbk Is Nothing Then\n                Exit Do\n            End If\n            \n            ' If Excel was not previously open then object variable will be empty\n            ' so create the object\n            Set objExcelWkbk = CreateObject(&quot;Excel.Application&quot;)\n            CheckAndReportError (&quot;Try#&quot; &amp; iRetry &amp; &quot; (B) CreateObject()&quot;)\n            Wait 2\n            If Not objExcelWkbk Is Nothing Then\n                Exit Do\n            End If\n            \n            iRetry = iRetry + 1\n        Loop\n        Err.Clear\n        \n        If objExcelWkbk Is Nothing Then\n            Debug.Print &quot;Failed to create Excel object&quot;\n        Else\n            Debug.Print &quot;Excel version &quot; &amp; objExcelWkbk.Application.Version &amp; &quot;; OS &quot; &amp; objExcelWkbk.Application.OperatingSystem\n            CheckAndReportError (&quot;(C) objExcelWkbk.Application.Version&quot;)\n            objExcelWkbk.Application.Quit\n            CheckAndReportError (&quot;(D) objExcelWkbk.Application.Quit()&quot;)\n        End If\n        \n        Set objExcelWkbk = Nothing\n    End Sub\n    \n    Sub CheckAndReportError(Label As String)\n        If Err.Number = 0 Then\n            Debug.Print Label &amp; &quot; no error&quot;\n            Exit Sub\n        End If\n        Debug.Print Label &amp; &quot; error #&quot; &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Description\n        Err.Clear\n    End Sub\n    \n    Sub Wait(ByVal Seconds As Single)\n        Dim CurrentTimer As Variant\n        WaitUntil = Timer + Seconds\n        Do While Timer &lt; WaitUntil\n            DoEvents\n        Loop\n    End Sub\n    \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11341338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f1625acd7d4d23144a47280163674d?s=128&d=identicon&r=PG&f=1", "display_name": "Molzella", "link": "https://stackoverflow.com/users/11341338/molzella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1606785333, "creation_date": 1554911785, "last_edit_date": 1606785333, "question_id": 55616784, "link": "https://stackoverflow.com/questions/55616784/createobject-excel-application-in-word-2016-for-mac", "title": "CreateObject (&quot;Excel.Application&quot;) in Word 2016 for Mac", "body": "<p>I have Word 2016 VBA code to read data in an Excel document.</p>\n<p>This works on Windows platforms (Windows 7 and Windows 10).</p>\n<p>On Mac it fails on the <code>CreateObject(&quot;Excel.Application&quot;)</code> instruction.</p>\n<blockquote>\n<p>run-time error '-2146959355 (80080005)'<br />\nAutomation error</p>\n</blockquote>\n<p>Is this a problem in Office 2016 for Mac (currently using version 16.23), or is this a problem in my &quot;environment&quot; and the way Office is installed on my Mac?</p>\n<p>It used to work and stopped working with an Office 2016 for Mac update. I can not remember which version caused the issue. Since almost two years, I check this code with every Office update and it has always failed.<br />\nI tried running a Windows 10 virtual machine with Parallels Desktop, and in this virtual Windows environment, the code works. I need to run it &quot;natively&quot;.</p>\n<p>The following code reproduces the problem:</p>\n<pre><code>Sub MyTestOfCreateObject()\n    Dim xlapp As Object\n    Set xlapp = CreateObject(&quot;Excel.Application&quot;)\n    xlapp.Visible = True\n    xlapp.Quit\n    Set xlapp = Nothing\nEnd Sub\n</code></pre>\n<p>I tried replacing <code>CreateObject(&quot;Excel.Application&quot;)</code> with\n<code>Set xlapp = New Excel.Application</code>. I got the same error message.</p>\n<p>I expect xlapp to be used as an Excel object.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1554912170, "post_id": 55616734, "comment_id": 97927091, "body": "Is it always <code>print all [schedule&lt;=(diff+1)]&quot;,&quot;[report&lt;=(diff+1)]&quot;,&quot;[p&amp;l&lt;=(diff+1)]</code> ?  So if diff is 4, it would gather schedule01 through schedule05 (and same for the rest)?"}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1554912666, "post_id": 55616734, "comment_id": 97927354, "body": "Yes, it would be.  The arrays are report01 through report100 and likewise for p&amp;l and schedule.  I would also like to include additional summaries of report, p&amp;l, and schedule which would be consolidated and included under all scenarios."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554912861, "post_id": 55617005, "comment_id": 97927477, "body": "Under this scenario, how would you include the PrintOut function to send to PDF?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913062, "post_id": 55617005, "comment_id": 97927566, "body": "@mj11314256 You didn&#39;t show your code for that.  I assume it would be the same as what you&#39;re doing now where you loop through every element in your array."}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913413, "post_id": 55617005, "comment_id": 97927734, "body": "Worksheets(&quot;data&quot;).Range(&quot;pageArray&quot;).PrintOut in the original code popped up the save as PDF print function.  When this is run, I still obtain an &quot;Application-define or object-defined error&quot;."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913468, "post_id": 55617005, "comment_id": 97927757, "body": "Ah, ok, that&#39;s expecting a one-dimensional array instead of 2 dimensional like I have here.  Just need to change how the array is generated.  Just a sec"}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913506, "post_id": 55617005, "comment_id": 97927779, "body": "Thank you tigeravatar, appreciate the help"}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913799, "post_id": 55617005, "comment_id": 97927951, "body": "I&#39;m still not getting a functioning PrintOut.  For the message box, it also only is showing the Schedule values."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554913920, "post_id": 55617005, "comment_id": 97928008, "body": "The msgbox was just for testing, that can be removed."}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554914090, "post_id": 55617005, "comment_id": 97928089, "body": "I understand that.  I am still receiving the same errors as before running this macro."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554915434, "post_id": 55617005, "comment_id": 97928782, "body": "I find it surprising that your original code would work and this does not since they are functionally the same. May need to <code>Join</code> the array into a comma delimited string (or build it as a comma delimited string to begin with)"}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554915975, "post_id": 55617005, "comment_id": 97929046, "body": "My original code was not working to print the PDF that&#39;s why I posted.  It worked when the array&#39;s were short and did not have to go to multiple lines."}, {"owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "edited": false, "score": 0, "creation_date": 1554915992, "post_id": 55617005, "comment_id": 97929058, "body": "I appreciate you trying it out tigeravatr"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554913567, "last_edit_date": 1554913567, "creation_date": 1554912538, "answer_id": 55617005, "question_id": 55616734, "link": "https://stackoverflow.com/questions/55616734/print-up-to-300-strings-of-arrays-to-pdf-based-on-a-calculated-value/55617005#55617005", "title": "Print Up to 300 Strings of Arrays to PDF Based on a Calculated Value", "body": "<p>To expand on my comment, it would look like this:</p>\n\n<pre><code>Dim lDiff As Long\nDim pageArray As Variant\nDim sFormat As String\nDim i As Long, j As Long\n\n'if a certain difference value, use\nlDiff = Worksheets(\"Inputs\").Range(\"D7\").Value - Worksheets(\"Inputs\").Range(\"D6\").Value\nReDim pageArray(1 To (lDiff + 1) * 3)\nFor i = 1 To UBound(pageArray, 1) Step 3\n    j = j + 1\n    If j &lt; 100 Then sFormat = \"00\" Else sFormat = \"000\"\n    pageArray(i) = \"schedule\" &amp; Format(j, sFormat)\n    pageArray(i + 1) = \"report\" &amp; Format(j, sFormat)\n    pageArray(i + 2) = \"p&amp;l\" &amp; Format(j, sFormat)\n    MsgBox pageArray(i)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11314256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3975363ef355f5bd88e2b3c7b2ac6db6?s=128&d=identicon&r=PG&f=1", "display_name": "mj11314256", "link": "https://stackoverflow.com/users/11314256/mj11314256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554926452, "creation_date": 1554911570, "last_edit_date": 1554926452, "question_id": 55616734, "link": "https://stackoverflow.com/questions/55616734/print-up-to-300-strings-of-arrays-to-pdf-based-on-a-calculated-value", "title": "Print Up to 300 Strings of Arrays to PDF Based on a Calculated Value", "body": "<p>I need to print a string of arrays dependent on a difference of two values on my input page to separate sheets within the same PDF but I have been running into a few issues.  </p>\n\n<p>Based on the difference of two cells, the function will determine which arrays to print.  </p>\n\n<p>There are two possible solutions I have thought of but have been unsuccessful attempting both.</p>\n\n<ol>\n<li><p>Indirectly reference a string of arrays in a cell to print such as \"abc,bcd,cde,def,efg...\"</p></li>\n<li><p>(As Shown Below) Use conditional if-then functions to invoke the array based on the difference in these two cells</p></li>\n</ol>\n\n<h3>Primary Goals</h3>\n\n<ol>\n<li>Print into a single PDF</li>\n<li>Determine specific arrays to print depending on the difference in two values contained in a cell on my input page</li>\n<li>Allow for PageSetup values (have this figured out)</li>\n</ol>\n\n<p>I am using MSFT 365.  I tried initially using an indirect array reference to a cell with a variable value string including the arrays to be included without success.</p>\n\n<p>Next, I tried to hardcode for all 100 possible values for this difference but in that case, I am running into line limits and errors associated with using _ to continue the array function on another line.</p>\n\n<p>If the difference value equals 3, it is shown as below.  If the difference value equals 4, you would add another array line including \"schedule05\",\"report05\",\"p&amp;l05\"</p>\n\n<pre><code>Option Explicit\n\nSub PrintTest()\n\n'if a certain difference value, use\nIf (Worksheets(\"Inputs\").Range(\"D7\") - Worksheets(\"Inputs\").Range(\"D6\")) = \"3\" Then\n\n\nDim pageArray As Variant\n\n'set array for given difference\npageArray = Array(\"schedule01\", \"report01\", \"p&amp;l01\", _\n\"schedule02\", \"report02\", \"p&amp;l02\", _\n\"schedule03\", \"report03\", \"p&amp;l03\", _\n\"schedule04\", \"report04\", \"p&amp;l04\")\n\n\nWorksheets(\"data\").Activate\nWorksheets(\"data\").PageSetup.CenterHorizontally = True\n\n'page setup values\nWith ActiveSheet.PageSetup\n.FitToPagesWide = 1\n.FitToPagesTall = 1\n.Orientation = xlLandscape\nEnd With\n\n'call array for print\nWorksheets(\"data\").Range(\"pageArray\").PrintOut\n\nElseif\n\n'Here is where I could put another similar function for a difference of 4\n\n\n'......\n\nElse\n'Here is where I could put another similar function for a difference of x\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I expected this would get me a PDF where each of these arrays is printed on a separate sheet and will print a selection of arrays based on the difference value.</p>\n"}, {"tags": ["excel", "vba", "excel-online"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1554918665, "post_id": 55616721, "comment_id": 97930374, "body": "An \u201eExcel Online\u201c also is a file. Its OneDrive-Location can be synchronized with each of your local computers and you can each treat the file like a local file. If you work manually together within it, you can see each others cell cursor. However a VBA treatment may lead to trouble - I don\u2018t have experience with that."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1554928843, "post_id": 55616721, "comment_id": 97934933, "body": "You can create an Excel Online workbook and store all the data centrally on one or more worksheets. Then, each local Excel file would essentially perform as a &quot;client&quot; of the central database, you would have to manage when to save data from the client to the central workbook -- this would potentially involve data synchronization, data lockouts while a client accesses the data, and a whole host of other well understood sync issues. MS Access has much of this capability built-in if you can use MS Access Online or other similar databases."}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "edited": false, "score": 0, "creation_date": 1554997385, "post_id": 55616721, "comment_id": 97964040, "body": "Thank you. These are options I will be looking into. I will make the Excel Online Version Read-only to prevent syncing/lock-out issues and still give visibility to each team member of what each other are working on. It will be traced to a master spreadsheet contained on our shared drive. Each member of the team will have a local file that they use to track only their personal projects and their spreadsheet will contain a macro to update the master spreadsheet on the shared drive."}], "owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562464675, "creation_date": 1554911508, "last_edit_date": 1554984171, "question_id": 55616721, "link": "https://stackoverflow.com/questions/55616721/macro-to-copy-from-local-excel-and-paste-to-excel-online", "title": "Macro to Copy from Local Excel and Paste to Excel Online", "body": "<p>Please verify if this is possible...</p>\n\n<p>I have a team of 5. We each have local excel files we use as project trackers. We want to collaborate on a high level using a master project tracker in Excel Online on OneDrive but individually continue to use our local trackers to update more detailed information on each project.</p>\n\n<p>I understand Excel Online cannot run macros. But is it possible for our local files to each run a macro that copy and pastes our weekly project updates automatically to this master tracker in Excel Online?</p>\n\n<p>I have not found anything on this. I am wondering if this is even possible to do or if anyone has a better solution than this for what we need.</p>\n\n<p>Below is code to copy and paste from one workbook to another. How can this be altered to copy and paste to an Excel Online Workbook? If this is even possible.</p>\n\n<pre><code>Sub Copy_Paste_Below_Last_Cell()\n'Find the last used row in both sheets and copy and paste data below existing data.\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\n\n  'Set variables for copy and destination sheets\n  Set wsCopy = Workbooks(\"New Data.xlsx\").Worksheets(\"Export 2\")\n  Set wsDest = Excel Online Workbook\n\n  '1. Find last used row in the copy range based on data in column A\n  lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, \"A\").End(xlUp).Row\n\n  '2. Find first blank row in the destination range based on data in column A\n  'Offset property moves down 1 row\n  lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1).Row\n\n  '3. Copy &amp; Paste Data\n  wsCopy.Range(\"A2:D\" &amp; lCopyLastRow).Copy _\n    wsDest.Range(\"A\" &amp; lDestLastRow)\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1554911863, "post_id": 55616689, "comment_id": 97926922, "body": "More code will help with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, but do you understand how to locate identify an Object within a Worksheet or Document?  I would recommend experimenting with &quot;copy from one place in Excel to another place in Excel&quot;, and &quot;copy from one place in Word to another place in Word&quot;, and then see if you can join up the middles"}, {"owner": {"reputation": 1, "user_id": 11341403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxRM_oQXr8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca_IIk_Lrz_iWzd8YZh4IkNGRSeg/mo/photo.jpg?sz=128", "display_name": "SOJP", "link": "https://stackoverflow.com/users/11341403/sojp"}, "edited": false, "score": 0, "creation_date": 1554915466, "post_id": 55616689, "comment_id": 97928798, "body": "Hi, thanks for the comments. I have included the code so far. As you can see, the ending is incomplete. I have googled but I cannot find how to select existing pictures on Word based on the Names I have assigned on the Selection Panel."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554915930, "post_id": 55616689, "comment_id": 97929023, "body": "It&#39;s important to know how the pictures are formatted in the Word document. Unlike Excel or PowerPoint, where pictures are always <code>Shape</code> objects (meaning they &quot;float&quot;) Word can also handle pictures like text characters (<code>InlineShapes</code>). As a general rule, it&#39;s easier to work with <code>InlineShapes</code> when using VBA than with <code>Shapes</code> when you want to &quot;replace&quot; them with something else. But in order to advise you we need to know more details about how the pictures are used in the target document..."}, {"owner": {"reputation": 1, "user_id": 11341403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxRM_oQXr8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca_IIk_Lrz_iWzd8YZh4IkNGRSeg/mo/photo.jpg?sz=128", "display_name": "SOJP", "link": "https://stackoverflow.com/users/11341403/sojp"}, "edited": false, "score": 0, "creation_date": 1554916273, "post_id": 55616689, "comment_id": 97929193, "body": "Thanks Cindy. Let&#39;s say I use InlineShapes.    For some context: Basically the pictures I will be copying over will be pictures of charts I have created in Excel. If I paste over InlineShapes, will they maintain the same format (in terms of size of the chart) or do I need to specify that?    I want to &quot;name&quot; the InlineShapes in the Selection Panel. How do I select named pictures?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554965622, "post_id": 55616689, "comment_id": 97944662, "body": "Cross-posted (and answered) at: <a href=\"https://www.mrexcel.com/forum/general-excel-discussion-other-questions/1094015-selecting-images-word.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/general-excel-discussion-other-questions/&hellip;</a>&zwnj;&#8203;. For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}, {"owner": {"reputation": 1, "user_id": 11341403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxRM_oQXr8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca_IIk_Lrz_iWzd8YZh4IkNGRSeg/mo/photo.jpg?sz=128", "display_name": "SOJP", "link": "https://stackoverflow.com/users/11341403/sojp"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554967039, "post_id": 55616689, "comment_id": 97945382, "body": "@CindyMeister Apologies for annoying you and everyone else. I will make sure I notify when I cross-post in the future.  I received a solution on MrExcel of using bookmarks but I need to run this VBA code everyday. I think with that solution, the Word document I am working with will be filled with pictures from the previous days. I suggested using a &quot;template picture&quot; so that I can replace the previous day&#39;s images with the latest image. Is this possible? Or is there a better way to think about it?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1555009632, "post_id": 55616689, "comment_id": 97969909, "body": "I recommend you delete these two questions and start a new one - Stack Overflow is not designed to have forum-type discussions, it&#39;s a Q&amp;A site. The short answer, based on what I know, would be to recreate the bookmarks around the InlineShapes so that they can be re-addressed the next time around."}], "owner": {"reputation": 1, "user_id": 11341403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxRM_oQXr8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca_IIk_Lrz_iWzd8YZh4IkNGRSeg/mo/photo.jpg?sz=128", "display_name": "SOJP", "link": "https://stackoverflow.com/users/11341403/sojp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554915775, "creation_date": 1554911411, "last_edit_date": 1554915775, "question_id": 55616689, "link": "https://stackoverflow.com/questions/55616689/how-to-copy-and-paste-pictures-from-excel-to-word", "title": "How to copy and paste pictures from Excel to Word", "body": "<p>I am producing a report which needs to be run daily. I have some pictures in Excel and I want to copy them and paste them into Word. I need them in a certain location. All this needs to be done in VBA.</p>\n\n<p>My proposed way of doing this is by creating template pictures in Word and giving them a name (which can be seen in Home > Select > Selection Panel). I assume that I can then copy the pictures from Excel and paste them over the template pictures (i.e. replacing the template pictures) - I believe this type of technique is possible with Excel-Powerpoint.</p>\n\n<p>(1) If I can execute this, will the pictures from Excel go to the right location in Word and be of the same dimensions as the template pictures?</p>\n\n<p>(2) How do I select the existing named template pictures?</p>\n\n<p>Here is my code so far but at the end, I am missing the ability to select the existing NAMED template pictures...</p>\n\n<pre><code>Dim wd As Object\nDim ObjDoc As Object\nDim FilePath As String\nDim FileName As String\nFilePath = \"OMITTED FOR PRIVACY REASONS\"\nFileName = \"OMITTED FOR PRIVACY REASONS\"\n\nOn Error Resume Next\n    Set wd = GetObject(, \"Word.Application\")\n\nIf wd Is Nothing Then\n    Set wd = CreateObject(\"Word.Application\")\n    Set ObjDoc = wd.Documents.Open(FilePath &amp; \"\\\" &amp; FileName)\nElse\n    On Error GoTo notOpen\n    Set ObjDoc = wd.Documents(FileName)\n    GoTo OpenAlready\nnotOpen:\n    Set ObjDoc = wd.Documents.Open(FilePath &amp; \"\\\" &amp; FileName)\nEnd If\nOpenAlready:\nOn Error GoTo 0\n\n   wd.Visible = True\n   ObjDoc.\n\n</code></pre>\n\n<p>Thank you so much for your time and effort!</p>\n"}, {"tags": ["excel", "vba", "api", "web-scraping", "dataset"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554917118, "post_id": 55617088, "comment_id": 97929607, "body": "This is only returning the first row, I need it to return all the rows in the array."}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554919133, "post_id": 55617088, "comment_id": 97930576, "body": "It&#39;s also not parsing any errors, such as if I put in an invalid Project ID, I&#39;d like to be able to grab this:     &lt;dtAPIErrors diffgr:id=&quot;dtAPIErrors1&quot; msdata:rowOrder=&quot;0&quot;&gt;     &lt;ErrorNumber&gt;API0011-009&lt;/ErrorNumber&gt;     &lt;ErrorDescription&gt;     Task doesn&#39;t exist. It might have been deleted by another user.     &lt;/ErrorDescription&gt;     &lt;ErrorType&gt;MSG_FUNCTIONAL&lt;/ErrorType&gt;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 1, "creation_date": 1554919450, "post_id": 55617088, "comment_id": 97930726, "body": "See my note about using SelectNodes. I don&#39;t see dtAPIErrors in the structure."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 1, "creation_date": 1554919535, "post_id": 55617088, "comment_id": 97930772, "body": "Will the collections of nodes be the same length for each xpath? Would each xpath nodeset continue down the same column?"}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554922042, "post_id": 55617088, "comment_id": 97931974, "body": "Yes to both questions."}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554922105, "post_id": 55617088, "comment_id": 97931995, "body": "The errors are only added to the structure when they exist. I&#39;ve updated my OP to show an example."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 1, "creation_date": 1554923507, "post_id": 55617088, "comment_id": 97932627, "body": "So, will you have one or the other? Either with error or not with error? And if with error where would you write that?"}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554925844, "post_id": 55617088, "comment_id": 97933642, "body": "It&#39;d only ever be one or the other: If there&#39;s an error, only the errors get returned, if there&#39;s no error then it returns the original example. I&#39;d want to just output the error to a message window and stop the script."}, {"owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "edited": false, "score": 0, "creation_date": 1554930562, "post_id": 55617088, "comment_id": 97935670, "body": "You&#39;re a saint, this is exactly what I needed! Thank you. Is there anyway to have the message for the error use the ErrorDescription instead of a generic description?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554930735, "last_edit_date": 1554930735, "creation_date": 1554912772, "answer_id": 55617088, "question_id": 55616604, "link": "https://stackoverflow.com/questions/55616604/using-vba-how-do-i-load-an-api-dataset-into-excel-from-an-http-get-function/55617088#55617088", "title": "Using VBA how do I load an API DataSet into Excel from an HTTP GET function?", "body": "<p>You can treat that as xml and use xpath. Here I am reading from file but you would load response into xmldocument. It is really to show you can select by xpath. I am selecting with <code>SelectSingleNode</code> but you can see how you could add a loop for <code>SelectNodes</code>.</p>\n\n<p>This will only align row wise if nodesets from each xpath are the same length. If not, a shared parent node must be used and then child nodes accessed from that. The row counter would increment within loop over shared parent node.</p>\n\n<p>If using multiple requests, another For Loop would be required over requests and then the next free row should be found at the top of that loop to determine where to start writing to.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim xmlDoc As Object, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set xmlDoc = CreateObject(\"MSXML2.DOMDocument\")\n    With xmlDoc\n        .validateOnParse = True\n        .setProperty \"SelectionLanguage\", \"XPath\"\n        .async = False\n\n        If Not .Load(\"C:\\Users\\User\\Desktop\\Test.xml\") Then\n            Err.Raise .parseError.ErrorCode, , .parseError.reason\n        End If\n    End With\n    Dim node As Object, i As Long, xpath As Variant, j As Long\n    j = 1\n    For Each xpath In Array(\"TASK_ID\", \"TASK_NUMBER\", \"TASK_RESUME\", \"TASK_GROUP_NAME\")\n        ws.Cells(9, j) = xmlDoc.SelectSingleNode(\"//\" &amp; xpath).Text\n        j = j + 1\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>In your case load the function return string. <strong>Edit: updated for multiple nodes</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim xmlDoc As Object, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set xmlDoc = CreateObject(\"MSXML2.DOMDocument\")\n    With xmlDoc\n        .validateOnParse = True\n        .setProperty \"SelectionLanguage\", \"XPath\"\n        .async = False\n\n        If Not .LoadXML(GetHTTP(url)) Then\n            Err.Raise .parseError.ErrorCode, , .parseError.reason\n        End If\n    End With\n    Dim node As Object, i As Long, xpath As Variant, j As Long, errorNode As Object, k As Long\n    Set errorNode = xmlDoc.SelectSingleNode(\"//ErrorDescription\")\n    If Not errorNode Is Nothing Then\n        MsgBox errorNode.Text\n        Exit Sub\n    End If\n    j = 1\n    For Each xpath In Array(\"TASK_ID\", \"TASK_NUMBER\", \"TASK_RESUME\", \"TASK_GROUP_NAME\")\n        k = 0\n        For Each node In xmlDoc.SelectNodes(\"//\" &amp; xpath)\n            ws.Cells(9 + k, j) = node.Text\n            k = k + 1\n        Next\n        j = j + 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55617088, "answer_count": 1, "score": 1, "last_activity_date": 1554930735, "creation_date": 1554911069, "last_edit_date": 1554922227, "question_id": 55616604, "link": "https://stackoverflow.com/questions/55616604/using-vba-how-do-i-load-an-api-dataset-into-excel-from-an-http-get-function", "title": "Using VBA how do I load an API DataSet into Excel from an HTTP GET function?", "body": "<p>I'm trying to load the DataSet output from an API call directly into a cell range on my worksheet. Specifically I just need TASK_ID, TASK_NUMBER, TASK_RESUME, and TASK_GROUP_NAME. They've provided some <a href=\"http://api.aceproject.com/explorer/?fct=gettasks\" rel=\"nofollow noreferrer\">.NET code examples here</a> for the API function I'm  utilizing, but the code doesn't translate directly into VBA.</p>\n\n<p>I've successfully parsed and utilized JSON for prior functions, but for this task I need to actually output the response back into Excel. I have the option of formatting the HTTP response as XML, RecordSet, DataSet, or JSON. As this is also a bit of a learning opportunity for me I'd like to learn and utilize DataSet for this function, but if XML makes more sense then I'll trust your judgement, but ideally I'd like to be able to use either.</p>\n\n<p>I've commented out the relevant .NET code I copied from the API example, the top portion was what I found from an XML tutorial.</p>\n\n<pre><code>Private URL As String\nSub Query_Click()\nDim ws As Worksheet: Set ws = Worksheets(\"Generator\")\n\nURL = Worksheets(\"API\").Range(\"B7\")\nDim strResp As String: strResp = GetHTTP(ByVal URL)\nDim xmlDoc As New MSXML2.DOMDocument\nIf Not xmlDoc.LoadXML(strResp) Then\n    MsgBox \"Load Error\"\nEnd If\n\n'    Dim dsOutput As DataSet: dsOutput = Deserialize(Of DataSet)(strXML)\n'            If dsOutput IsNot Nothing AndAlso dsOutput.Tables.Count &gt; 0 Then\n'                If dsOutput.Tables.Contains(\"dtAPIErrors\") Then\n'                    Throw New Exception(String.Format(\"{0}: {1}\", _\n'                                                      dsOutput.Tables(0).Rows(0).Item(\"ErrorNumber\").ToString, _\n'                                                      dsOutput.Tables(0).Rows(0).Item(\"ErrorDescription\").ToString))\n'                End If\n'            End If\n\n    Set xmlDoc = Nothing\n\nEnd Sub\nPrivate Function GetHTTP(ByVal URL As String) As String\n    On Error Resume Next\n    With CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n        .Open \"GET\", URL, False\n        .Send\n        GetHTTP = .ResponseText\n    End With\n\nEnd Function\n\n'Private Function Deserialize(Of T)( ByVal strXML As String) As T\n'        Dim objet As T = Nothing\n'        Dim objType As Type = GetType(T)\n'        Try\n'            If Not String.IsNullOrEmpty(strXML) Then\n'                Dim objSerializer As New System.Xml.Serialization.XmlSerializer(objType)\n'                Dim objText As New System.Text.StringBuilder()\n'                Dim objXmlReader As New System.IO.StringReader(strXML)\n'                objet = DirectCast(objSerializer.Deserialize(objXmlReader), T)\n'                objXmlReader.Close()\n'            End If\n'            Return objet\n'        Catch ex As Exception\n'            Throw\n'        Finally\n'            If objet IsNot Nothing Then objet = Nothing\n'        End Try\n'End Function\n</code></pre>\n\n<p>I'd like to load everything in starting at Row 9, with the Task ID into Column A, Task # into Column B, Task Resume (AKA Task Name) into Column C, and Task Group into Column D. If I can get a working example for just 1 of the DataSet records I'm sure I'll be able to replicate it for the others.</p>\n\n<pre><code>&lt;DataSet&gt;\n&lt;xs:schema xmlns=\"\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" id=\"dsOutput\"&gt;\n&lt;xs:element name=\"dsOutput\" msdata:IsDataSet=\"true\" msdata:UseCurrentLocale=\"true\"&gt;\n&lt;xs:complexType&gt;\n&lt;xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\"&gt;\n&lt;xs:element name=\"dtOutput\" msdata:CaseSensitive=\"False\" msdata:Locale=\"en-US\"&gt;\n&lt;xs:complexType&gt;\n&lt;xs:sequence&gt;\n&lt;xs:element name=\"TASK_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_NUMBER\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_RESUME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_TASK_MODIFIED\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"IS_ASSIGNED_OR_REVIEWER\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ASSIGNED\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"REVIEWER\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ASSIGNED_ID\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"REVIEWER_ID\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"PROJECT_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"PROJECT_NUMBER\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"PROJECT_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"PROJECT_TYPE_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"COMPANY_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_GROUP_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_GROUP_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_GROUP_MYORDER\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_TYPE_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_TYPE_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_TYPE_MYORDER\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_STATUS_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_STATUS_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_STATUS_MYORDER\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_STATUS_COMPLETED\" type=\"xs:unsignedByte\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_STATUS_COMPLETED_LOGICAL_SORT\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_PRIORITY_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_PRIORITY_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_PRIORITY_MYORDER\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"USER_CREATOR_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"USERNAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"FIRST_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"LAST_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_DESC_CREATOR\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_DESC_CREATOR_PLAIN\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ESTIMATED_TIME\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_EXPECTED_START_TASK\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_EXPECTED_END_TASK\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_TASK_CREATED\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"POURCENTAGE_DONE\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ACTUAL_HOURS\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ACTUAL_PERCENT_DONE\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DOCUMENT_COUNT\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ACTUAL_START_DATE\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ACTUAL_END_DATE\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DIVIDE_HOURS\" type=\"xs:boolean\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"WEEKEND_ALLOWED\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"UPDATE_USER_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"UPDATE_USERNAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"UPDATE_FIRST_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"UPDATE_LAST_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"COUNT_SUCCESSORS\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"COUNT_PREDECESSORS\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_RECUR_MODIFIED\" type=\"xs:boolean\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TIMESHEET_INOUT_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"COMMENT_COUNT\" type=\"xs:decimal\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_STATUS_STARTED\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"DATE_STATUS_COMPLETED\" msdata:DateTimeMode=\"Unspecified\" type=\"xs:dateTime\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"POSITION\" type=\"xs:double\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_DEPENDENCY_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"MARKED\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"READY_TO_START\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"TASK_RECURRENCY_ID\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"EXPIRATION_DATE\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"STANDBY\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"WEEKEND_ALLOWED_NAME\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"NAV_TASK_POSITION\" type=\"xs:int\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"PERIODICITY_SUMMARY\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;/xs:sequence&gt;\n&lt;/xs:complexType&gt;\n&lt;/xs:element&gt;\n&lt;/xs:choice&gt;\n&lt;/xs:complexType&gt;\n&lt;/xs:element&gt;\n&lt;/xs:schema&gt;\n&lt;diffgr:diffgram xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" xmlns:diffgr=\"urn:schemas-microsoft-com:xml-diffgram-v1\"&gt;\n&lt;dsOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput1\" msdata:rowOrder=\"0\" diffgr:hasChanges=\"inserted\"&gt;\n&lt;TASK_ID&gt;5&lt;/TASK_ID&gt;\n&lt;TASK_NUMBER&gt;1.0000000&lt;/TASK_NUMBER&gt;\n&lt;TASK_RESUME&gt;Wolf&lt;/TASK_RESUME&gt;\n&lt;DATE_TASK_MODIFIED&gt;2019-03-29T15:56:29.937&lt;/DATE_TASK_MODIFIED&gt;\n&lt;IS_ASSIGNED_OR_REVIEWER&gt;0&lt;/IS_ASSIGNED_OR_REVIEWER&gt;\n&lt;PROJECT_ID&gt;2&lt;/PROJECT_ID&gt;\n&lt;PROJECT_NUMBER&gt;0000002&lt;/PROJECT_NUMBER&gt;\n&lt;PROJECT_NAME&gt;Canines&lt;/PROJECT_NAME&gt;\n&lt;PROJECT_TYPE_NAME&gt;General&lt;/PROJECT_TYPE_NAME&gt;\n&lt;COMPANY_ID&gt;1&lt;/COMPANY_ID&gt;\n&lt;TASK_GROUP_ID&gt;4&lt;/TASK_GROUP_ID&gt;\n&lt;TASK_GROUP_NAME&gt;Development&lt;/TASK_GROUP_NAME&gt;\n&lt;TASK_GROUP_MYORDER&gt;9999999&lt;/TASK_GROUP_MYORDER&gt;\n&lt;TASK_TYPE_ID&gt;6&lt;/TASK_TYPE_ID&gt;\n&lt;TASK_TYPE_NAME&gt;Addition&lt;/TASK_TYPE_NAME&gt;\n&lt;TASK_TYPE_MYORDER&gt;9999999&lt;/TASK_TYPE_MYORDER&gt;\n&lt;TASK_STATUS_ID&gt;5&lt;/TASK_STATUS_ID&gt;\n&lt;TASK_STATUS_NAME&gt;Completed&lt;/TASK_STATUS_NAME&gt;\n&lt;TASK_STATUS_MYORDER&gt;9999999&lt;/TASK_STATUS_MYORDER&gt;\n&lt;TASK_STATUS_COMPLETED&gt;1&lt;/TASK_STATUS_COMPLETED&gt;\n&lt;TASK_STATUS_COMPLETED_LOGICAL_SORT&gt;2&lt;/TASK_STATUS_COMPLETED_LOGICAL_SORT&gt;\n&lt;TASK_PRIORITY_ID&gt;7&lt;/TASK_PRIORITY_ID&gt;\n&lt;TASK_PRIORITY_NAME&gt;Normal&lt;/TASK_PRIORITY_NAME&gt;\n&lt;TASK_PRIORITY_MYORDER&gt;3&lt;/TASK_PRIORITY_MYORDER&gt;\n&lt;USER_CREATOR_ID&gt;1&lt;/USER_CREATOR_ID&gt;\n&lt;USERNAME&gt;Dracius&lt;/USERNAME&gt;\n&lt;FIRST_NAME&gt;Ace&lt;/FIRST_NAME&gt;\n&lt;LAST_NAME&gt;Rimmer&lt;/LAST_NAME&gt;\n&lt;TASK_DESC_CREATOR/&gt;\n&lt;ESTIMATED_TIME&gt;0.00&lt;/ESTIMATED_TIME&gt;\n&lt;DATE_EXPECTED_START_TASK&gt;2019-03-29T00:00:00&lt;/DATE_EXPECTED_START_TASK&gt;\n&lt;DATE_EXPECTED_END_TASK&gt;2019-03-29T00:00:00&lt;/DATE_EXPECTED_END_TASK&gt;\n&lt;DATE_TASK_CREATED&gt;2019-03-29T13:24:31.82&lt;/DATE_TASK_CREATED&gt;\n&lt;POURCENTAGE_DONE&gt;10&lt;/POURCENTAGE_DONE&gt;\n&lt;DOCUMENT_COUNT&gt;0&lt;/DOCUMENT_COUNT&gt;\n&lt;ACTUAL_START_DATE&gt;2019-03-29T00:00:00&lt;/ACTUAL_START_DATE&gt;\n&lt;ACTUAL_END_DATE&gt;2019-03-29T00:00:00&lt;/ACTUAL_END_DATE&gt;\n&lt;DIVIDE_HOURS&gt;true&lt;/DIVIDE_HOURS&gt;\n&lt;WEEKEND_ALLOWED&gt;0&lt;/WEEKEND_ALLOWED&gt;\n&lt;UPDATE_USER_ID&gt;3&lt;/UPDATE_USER_ID&gt;\n&lt;UPDATE_USERNAME&gt;Fenrir&lt;/UPDATE_USERNAME&gt;\n&lt;COUNT_SUCCESSORS&gt;1&lt;/COUNT_SUCCESSORS&gt;\n&lt;COUNT_PREDECESSORS&gt;0&lt;/COUNT_PREDECESSORS&gt;\n&lt;TASK_RECUR_MODIFIED&gt;false&lt;/TASK_RECUR_MODIFIED&gt;\n&lt;COMMENT_COUNT&gt;0&lt;/COMMENT_COUNT&gt;\n&lt;DATE_STATUS_STARTED&gt;2019-03-29T19:55:24.24&lt;/DATE_STATUS_STARTED&gt;\n&lt;DATE_STATUS_COMPLETED&gt;2019-03-29T19:55:24.24&lt;/DATE_STATUS_COMPLETED&gt;\n&lt;POSITION&gt;325056&lt;/POSITION&gt;\n&lt;MARKED&gt;0&lt;/MARKED&gt;\n&lt;READY_TO_START&gt;0&lt;/READY_TO_START&gt;\n&lt;WEEKEND_ALLOWED_NAME&gt;No&lt;/WEEKEND_ALLOWED_NAME&gt;\n&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput2\" msdata:rowOrder=\"1\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput3\" msdata:rowOrder=\"2\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput4\" msdata:rowOrder=\"3\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput5\" msdata:rowOrder=\"4\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput6\" msdata:rowOrder=\"5\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput7\" msdata:rowOrder=\"6\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput8\" msdata:rowOrder=\"7\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;dtOutput diffgr:id=\"dtOutput9\" msdata:rowOrder=\"8\" diffgr:hasChanges=\"inserted\"&gt;...&lt;/dtOutput&gt;\n&lt;/dsOutput&gt;\n&lt;/diffgr:diffgram&gt;\n&lt;/DataSet&gt;\n</code></pre>\n\n<p>Example Error Output:</p>\n\n<pre><code>&lt;DataSet&gt;\n&lt;xs:schema xmlns=\"\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" id=\"dsOutput\"&gt;\n&lt;xs:element name=\"dsOutput\" msdata:IsDataSet=\"true\" msdata:UseCurrentLocale=\"true\"&gt;\n&lt;xs:complexType&gt;\n&lt;xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\"&gt;\n&lt;xs:element name=\"dtAPIErrors\"&gt;\n&lt;xs:complexType&gt;\n&lt;xs:sequence&gt;\n&lt;xs:element name=\"ErrorNumber\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ErrorDescription\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ErrorType\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"Language\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"ParamName\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;xs:element name=\"Id\" type=\"xs:string\" minOccurs=\"0\"/&gt;\n&lt;/xs:sequence&gt;\n&lt;/xs:complexType&gt;\n&lt;/xs:element&gt;\n&lt;/xs:choice&gt;\n&lt;/xs:complexType&gt;\n&lt;/xs:element&gt;\n&lt;/xs:schema&gt;\n&lt;diffgr:diffgram xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" xmlns:diffgr=\"urn:schemas-microsoft-com:xml-diffgram-v1\"&gt;\n&lt;dsOutput&gt;\n&lt;dtAPIErrors diffgr:id=\"dtAPIErrors1\" msdata:rowOrder=\"0\"&gt;\n&lt;ErrorNumber&gt;API0011-009&lt;/ErrorNumber&gt;\n&lt;ErrorDescription&gt;\nTask doesn't exist. It might have been deleted by another user.\n&lt;/ErrorDescription&gt;\n&lt;ErrorType&gt;MSG_FUNCTIONAL&lt;/ErrorType&gt;\n&lt;Language&gt;en-US&lt;/Language&gt;\n&lt;/dtAPIErrors&gt;\n&lt;/dsOutput&gt;\n&lt;/diffgr:diffgram&gt;\n&lt;/DataSet&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1554910760, "post_id": 55616396, "comment_id": 97926246, "body": "You can use <code>InStr()</code> to test. As an example, this will pass the <code>if</code>: <code>If InStr(1, &quot;dogcatdog&quot;, &quot;cat&quot;) Then</code>"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1554910888, "post_id": 55616396, "comment_id": 97926315, "body": "<code>2 Or 6</code> is a bitwise operation evaluating to 6. Is that what you intend?"}, {"owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "edited": false, "score": 0, "creation_date": 1554910969, "post_id": 55616396, "comment_id": 97926378, "body": "It was intended to search column 2 and 6"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1554911065, "post_id": 55616396, "comment_id": 97926431, "body": "Try <code>If Worksheets(&quot;Purchase Log&quot;).Cells(a, 2).Value = Cells(1, 35) Or Worksheets(&quot;Purchase Log&quot;).Cells(a, 6).Value = Cells(1, 35)</code>. Alternatively, check out the <code>Range.AutoFilter</code> method."}, {"owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "edited": false, "score": 0, "creation_date": 1554911198, "post_id": 55616396, "comment_id": 97926525, "body": "the (a, 2 or 6) is successfully searching the 2 columns, the issue is its searching for a an exact match when all I need is a partial match."}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1554911226, "post_id": 55616396, "comment_id": 97926547, "body": "Are you sure it&#39;s not just looking at column 6 and ignoring 2?"}, {"owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "edited": false, "score": 0, "creation_date": 1554911770, "post_id": 55616396, "comment_id": 97926869, "body": "It is ignoring 2, thank you for that catch."}, {"owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "edited": false, "score": 0, "creation_date": 1554911970, "post_id": 55616396, "comment_id": 97926983, "body": "I have looked into the InStr function and i&#39;m just not sure how to insert it into this code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "edited": false, "score": 0, "creation_date": 1554922681, "post_id": 55618664, "comment_id": 97932257, "body": "Theres an error in the syntax in the If line. @Scott Holtzman"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1554925634, "last_edit_date": 1554925634, "creation_date": 1554919004, "answer_id": 55618664, "question_id": 55616396, "link": "https://stackoverflow.com/questions/55616396/how-to-search-for-a-string-of-text-in-a-worksheet/55618664#55618664", "title": "How to search for a string of text in a worksheet", "body": "<p>Give this a shot. It uses <code>Like</code> with wildcard on front and back to capture, for example \"theDog\", \"Dog\", or \"Doggie\" with search term of \"Dog\".</p>\n\n<pre><code>With Worksheets(\"Purchase Log\")\n\n    Dim theMatch as String\n    theMatch = .cells(1,35).Value\n\n    For a = 2 to 200 \n\n        If .Cells(a,2).Value Like \"*\" &amp; theMatch &amp; \"*\" Or _\n            .Cells(a,6).Value Like \"*\" &amp; theMatch &amp; \"*\" Then\n                .Rows(a).Hidden = False\n        Else\n            .Rows(a).Hidden = True\n        End If\n\n   Next\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11341305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f367f26b68cbe21d36385e678d809fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Toboe918", "link": "https://stackoverflow.com/users/11341305/toboe918"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554984148, "creation_date": 1554910387, "last_edit_date": 1554984148, "question_id": 55616396, "link": "https://stackoverflow.com/questions/55616396/how-to-search-for-a-string-of-text-in-a-worksheet", "title": "How to search for a string of text in a worksheet", "body": "<p>I am filtering search results for a worksheet with easy to use command buttons and I am trying to hide all rows that do not contain the text provided in a cell.</p>\n\n<p>I have then code to hide all rows that contain an exact input in a cell but I am trying to include partials as well.</p>\n\n<pre><code>For a = 2 To 200\n    If Worksheets(\"Purchase Log\").Cells(a, 2 Or 6).Value = Cells(1, 35) Then \n        Worksheets(\"Purchase Log\").Rows(a).Hidden = False\n    Else\n        Worksheets(\"Purchase Log\").Rows(a).Hidden = True\n    End If\n</code></pre>\n\n<p>For example I would like the search \"cat\" to also include any rows with \"Bobcat\" but current code can only produce \"Bobcat\" if text in box is exactly \"Bobcat\"</p>\n"}, {"tags": ["vba", "csv", "variables", "ms-word", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554908884, "post_id": 55615698, "comment_id": 97925188, "body": "CSV is a plain-text file format; you can use the <code>Open</code> statement and a loop with <code>Line Input</code> statements to read/parse it line by line. See if <a href=\"https://stackoverflow.com/a/11528932/1188513\">this answer</a> helps."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554909058, "post_id": 55615698, "comment_id": 97925303, "body": "With VBA is better to think of CSV as an excel file. Open it with VBA as a <code>new Excel.Application object</code>. Then you can do your search on the excel file for the caption. That&#39;s the first approach I personally would try. Edit: The comment above states the truth about CSV, it&#39;s a plain text. However with VBA you can easily open it on Excel and work with it much simpler in my opinion, this is why I said its best to think of it as an excel file when using VBA."}, {"owner": {"reputation": 14, "user_id": 11341070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MU70BsOQScU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcifCigr1qgeHpVGuhSkozwmXMAdQ/mo/photo.jpg?sz=128", "display_name": "Jon Swiss", "link": "https://stackoverflow.com/users/11341070/jon-swiss"}, "edited": false, "score": 0, "creation_date": 1554909379, "post_id": 55615698, "comment_id": 97925494, "body": "Thank you Ricardo. But how would i do that ?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554916624, "post_id": 55615698, "comment_id": 97929350, "body": "Rather than CSV you might consider XML. &quot;Looking up&quot; can be done more &quot;reasonably&quot; with XML since an XML parser provides such tools. And using XML won&#39;t involve invoking another application (Excel, as suggested in another comment). Or does your experience with PowerShell involve any kind of data querying? INI files are another possibility... No matter which approach you decide on, you will need to do some basic research..."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554966118, "post_id": 55615698, "comment_id": 97944909, "body": "As was previous stated, &quot;CSV is a plain-text file&quot;. There is no value in opening such a file in Excel unless you&#39;re doing something Excel-specific with it. To extract a particular record, or group of records, you could use ADODB, or simply open it in Word and use Find."}], "answers": [{"tags": [], "owner": {"reputation": 14, "user_id": 11341070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MU70BsOQScU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcifCigr1qgeHpVGuhSkozwmXMAdQ/mo/photo.jpg?sz=128", "display_name": "Jon Swiss", "link": "https://stackoverflow.com/users/11341070/jon-swiss"}, "is_accepted": true, "score": 0, "last_activity_date": 1555049505, "creation_date": 1555049505, "answer_id": 55645489, "question_id": 55615698, "link": "https://stackoverflow.com/questions/55615698/look-up-userform-caption-variable-in-csv-to-get-other-values/55645489#55645489", "title": "Look up UserForm Caption Variable in CSV to get other values", "body": "<p>Thank you for your help.</p>\n\n<p>I found a way with CSV.</p>\n\n<pre><code>  'R\u00e9pertoire\ndirectory = \"H:\\@SCRIPTS\\VBA_MacroWord_DigitRH\\\"\nFileName = \"BaseSignatureTest.csv\"\n'Ouverture de la connexion CSV\nSet rs = CreateObject(\"ADODB.Recordset\")\nstrcon = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; directory &amp; \";\" _\n&amp; \"Extended Properties=\"\"text;HDR=Yes;FMT=Delimited\"\";\"\nstrSQL = \"SELECT * FROM \" &amp; FileName\nrs.Open strSQL, strcon, 3, 3\nrs.MoveFirst\n\nDo\n   col1 = rs(\"Nom\")\n   col2 = rs(\"Fonction\")\n   col3 = rs(\"DPT\")\n   col4 = rs(\"Signature\")\n   rs.MoveNext\n\n   'Si une valeur a \u00e9t\u00e9 trouv\u00e9e et qu'elle corresponds, d\u00e9finition des valeurs\n   If col1 = RHSignature2 Then\n   MsgBox \"Signature2\"\n   MsgBox col1\n   MsgBox col2\n   MsgBox col3\n   MsgBox col4\n</code></pre>\n\n<p>Seems to be working. Maybe there is a better way. But thanks to everyone that took some time that took the time to read me.\nHave a nice week,\nJon</p>\n"}], "owner": {"reputation": 14, "user_id": 11341070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MU70BsOQScU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcifCigr1qgeHpVGuhSkozwmXMAdQ/mo/photo.jpg?sz=128", "display_name": "Jon Swiss", "link": "https://stackoverflow.com/users/11341070/jon-swiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55645489, "answer_count": 1, "score": 0, "last_activity_date": 1555049505, "creation_date": 1554908215, "last_edit_date": 1554916268, "question_id": 55615698, "link": "https://stackoverflow.com/questions/55615698/look-up-userform-caption-variable-in-csv-to-get-other-values", "title": "Look up UserForm Caption Variable in CSV to get other values", "body": "<p>I want a Word Macro that will insert dynamic signatures (up to three) and have never done any VBA before (more of a Powershell guy...).</p>\n\n<p>To do that, I've created a UserForm in the \"developer\" interface with 3 frames and plenty of radio buttons containing as caption the names of the people that will be able to sign.</p>\n\n<p>As there are 60 peoples (or more) that will be able to sign, I have thought about having a CSV file with them containing their \"Name, Department, Function). </p>\n\n<p>My issue is I have no clue on how to read a CSV, compare it with my caption (let's say Caption = \"Jon Swiss\") and initialize the variable for three other values.</p>\n\n<p>I have tagged my document with some bookmarks (that works with the caption only).</p>\n\n<p>I don't know if you need the script I have done (nothing about the CSV - sorry...)</p>\n\n<pre><code>Private Sub RHBtn_Accepter_Click_Click()\n'Initialisation\nDim i As Integer\n'***\n'       Signature 1\n'*** \n'Pour chaque valeur possible\n  For i = 1 To Me.Controls.Count\n    'Si i plus petit que le nombre de valeur d\u00e9finie\n    If i &lt; Me.Controls.Count Then\n      Set MyControl = Me.Controls.Item(i)\n      'Si control dispose du tag RHSign1\n      If MyControl.Tag = \"RHSign1\" Then\n         'Si une valeur est activ\u00e9e\n         If MyControl.Value = True Then\n            'Mise en variable du nom en Sign1\n            RHSignature1 = MyControl.Caption\n            Exit For\n         End If\n      End If\n    End If\n  Next i\n\n'***\n'       Gettings CSV Value\n'***\n\n'***\n'       Tagging the bookmarks\n'***\n           If ActiveDocument.Bookmarks.Exists(\"RhSignet1\") = True Then\n              Selection.GoTo What:=wdGoToBookmark, Name:=\"RhSignet1\"\n              Selection.TypeText Text:=RHSignature1\n           End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554909651, "post_id": 55615561, "comment_id": 97925664, "body": "You are disabling events, this could be the reason the box doesnt update to False/True. Try to make it work without disabling events. Also to make it work when changing more than one, do not set WorkRng to anything, only compare if Target is inside the WorkRange, then loop all ranges inside Target.Range."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1554909830, "post_id": 55615561, "comment_id": 97925766, "body": "Where in your code do you refer to these tick boxes?"}, {"owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "edited": false, "score": 0, "creation_date": 1554910693, "post_id": 55615561, "comment_id": 97926211, "body": "i was able to fix it by adding another line  ~~~ Rng.Offset(, 147).Value = False ~~~  however now the other issue still remains, which is not all selected cells are applied to the code at the same time. it only does it one at a time"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554912680, "post_id": 55615561, "comment_id": 97927361, "body": "Change <code>For Each Rng In WorkRng</code> to <code>For Each Rng In Target.Range</code> and try it."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "is_accepted": false, "score": -1, "last_activity_date": 1554913013, "creation_date": 1554913013, "answer_id": 55617144, "question_id": 55615561, "link": "https://stackoverflow.com/questions/55615561/how-to-target-an-specific-columns-after-a-delete-without-buttons/55617144#55617144", "title": "How to target an specific columns after a delete without buttons", "body": "<p>This is the final result in which everything started working correctly.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) '&lt;----- Start of worksheet script\nDim WorkRng As Range '&lt;----- selection\nDim Rng As Range '&lt;----- selected cell(s)\nDim xOffsetColumn As Integer '&lt;----- idk lol\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"O:O\"), Target) '&lt;----- block selection for anything other than column O\nxOffsetColumn = 1 '&lt;----- Useless , but it means the cell one range forward will be changed.\nIf Not WorkRng Is Nothing Then '&lt;----- if statement\n    Application.EnableEvents = False '&lt;----- idk what this is for but ok.\n    For Each Rng In WorkRng '&lt;----- Start of cell loop\n        If Not VBA.IsEmpty(Rng.Value) Then '&lt;----- Second start of if statement\n            Rng.Offset(0, xOffsetColumn).Value = Now '&lt;----- Date and time\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"dd-mm-yyyy\" '&lt;----- Date and time format\n        Else '&lt;----- if's else statement.\n            Rng.Offset(0, xOffsetColumn).ClearContents '&lt;----- Command for deletion.\n            Rng.Offset(, 147).Value = False '&lt;----- Tick Box sets to false.\n        End If '&lt;----- Second end of if statement\n    Next Rng '&lt;----- end of loop\n    Application.EnableEvents = True '&lt;----- I also don't know what this is for but ok.\nEnd If '&lt;----- First end of if statement.\n\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11259346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d3a8ede13241eea099aca81d5f8895?s=128&d=identicon&r=PG&f=1", "display_name": "user163342", "link": "https://stackoverflow.com/users/11259346/user163342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554913013, "creation_date": 1554907864, "question_id": 55615561, "link": "https://stackoverflow.com/questions/55615561/how-to-target-an-specific-columns-after-a-delete-without-buttons", "title": "How to target an specific columns after a delete without buttons", "body": "<p>So i'm trying to make a code that deletes cells as long as they belong to the same column(horizontally) after deleting a cell from column \"O\".\nColumn N is all tick boxes linked to column FF. if they are set to true when the deletion happens, it should turn false.\nColumn O is where the deletion should happen( the objective is to simply press the cell and click delete or back space on the keyboard, not a button.)\nColumn P is sign date, which should also be deleted.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Update 20140722\nDim WorkRng As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"O:O\"), Target)\nxOffsetColumn = 1\nIf Not WorkRng Is Nothing Then\n    Application.EnableEvents = False\n    For Each Rng In WorkRng\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = Now\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"dd-mm-yyyy\"\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\n    Application.EnableEvents = True\nEnd If\n</code></pre>\n\n<p>haven't been able to set the boxes to false. also i can't choose multiple cells, it only deletes one at a time.</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12131166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-07cLgj1UCuc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3RW_P1SyQYV2HA5pkBgpbJo3rkQ/photo.jpg=k-s128", "display_name": "Doug H", "link": "https://stackoverflow.com/users/12131166/doug-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1569629842, "creation_date": 1569629842, "answer_id": 58142435, "question_id": 55615515, "link": "https://stackoverflow.com/questions/55615515/perform-macro-on-close-event-if-file-was-saved/58142435#58142435", "title": "Perform Macro on Close Event IF File was Saved", "body": "<p>Try the before_save event in the \"ThisProject\" project objects ( <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa204873(v=office.11)\" rel=\"nofollow noreferrer\">Microsoft Help Page</a> )</p>\n\n<p>Something along the lines of:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Option Explicit\n    Private Sub Project_BeforeClose(ByVal pj As Project)\n        ~~  Your code for doing things in excel ~~\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11092003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed84023b9440189af98c7078bb0b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "J Lawrence", "link": "https://stackoverflow.com/users/11092003/j-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593558202, "creation_date": 1554907713, "last_edit_date": 1593558202, "question_id": 55615515, "link": "https://stackoverflow.com/questions/55615515/perform-macro-on-close-event-if-file-was-saved", "title": "Perform Macro on Close Event IF File was Saved", "body": "<p>I want to run a macro \"ExportToExcel\" automatically when I close my .mpp file, BUT only if the Project was saved. </p>\n\n<p>Reason: we only save this after we make changes; however, we are constantly opening the files to review. If this ran every time we closed, it would not be efficient.</p>\n\n<p>I toyed with projectaftersave and could not make it work. I can make the following code work, but it runs EVERY time I close the file.</p>\n\n<p>Sub Auto_Close()</p>\n\n<p>Call ExportToExcel</p>\n\n<p>End Sub</p>\n\n<p>Expectations are to run my code when I close the .mpp ONLY if it was saved (not 'Save As') prior to closing.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 15, "user_id": 10861589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da14415d05a662b9ab109030a4665967?s=128&d=identicon&r=PG&f=1", "display_name": "Zeflik", "link": "https://stackoverflow.com/users/10861589/zeflik"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554973933, "post_id": 55615270, "comment_id": 97949118, "body": "Ok, updated with screenshots. All paragraphs have different indentation and there is a lots of them. Formating of the source material is not an option. My job is to only convert text to table and keep formatting according to source material."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10861589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da14415d05a662b9ab109030a4665967?s=128&d=identicon&r=PG&f=1", "display_name": "Zeflik", "link": "https://stackoverflow.com/users/10861589/zeflik"}, "edited": false, "score": 0, "creation_date": 1555077744, "post_id": 55638481, "comment_id": 97995436, "body": "OMG! This is exactly what I was looking for! Thank you :) Is there any chance to additionally detect and skip all paragraphs that belongs to Table of Contents? If not, it can be as is :)"}, {"owner": {"reputation": 15, "user_id": 10861589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da14415d05a662b9ab109030a4665967?s=128&d=identicon&r=PG&f=1", "display_name": "Zeflik", "link": "https://stackoverflow.com/users/10861589/zeflik"}, "edited": false, "score": 0, "creation_date": 1556045384, "post_id": 55638481, "comment_id": 98301803, "body": "I solved this additional issue by simply removing all TOC instances from the source document before collecting the source paragraphs. Target TOC contains multiple paragraphs and is omitted like nested tables."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1555004949, "creation_date": 1555004949, "answer_id": 55638481, "question_id": 55615270, "link": "https://stackoverflow.com/questions/55615270/how-to-reasign-indentation-after-converting-all-paragraphs-to-a-table-in-word-do/55638481#55638481", "title": "How to reasign indentation after converting all paragraphs to a table in Word document with VBA?", "body": "<p>There would be a number of ways to approach this. After some consideration, I decided a fairly straight-forward one would be to get an array of all the paragraphs <em>not</em> in a table from the source document. </p>\n\n<p>When looping the rows in the target document the number of paragraphs will be greater than one only in rows that contain a nested table. In this case, the <code>Range</code> is set to the end (last paragraph).</p>\n\n<p>Then the indent is applied from the corresponding paragraph in the array using the loop counter (plus 1, since arrays are 0-based).</p>\n\n<pre><code>Sub RestoreParaIndents()\n    Dim sourceDocument As Document, targetDocument As Document\n    Dim myRange As Range\n    Set sourceDocument = ActiveDocument\n    Set targetDocument = Documents.Add(ActiveDocument.FullName)\n    Set myRange = targetDocument.content  \n\n    'Get an array of all paragraphs not in a table in the source document\n    'This will provide the indent information in the loop for the target document\n    Dim aParas() As Paragraph, para As Paragraph\n    Dim counterPara As Long\n    counterPara = 0\n    For Each para In sourceDocument.Paragraphs\n        If Not para.Range.Information(wdWithInTable) Then\n            ReDim Preserve aParas(counterPara)\n            Set aParas(counterPara) = para\n            counterPara = counterPara + 1\n        End If\n    Next\n\n    myRange.ConvertToTable Separator:=wdSeparateByParagraphs\n\n    Dim i As Long\n    Dim rw As Row, rng As Range\n    For i = 1 To targetDocument.Tables(1).Range.Rows.Count\n        Set rw = targetDocument.Tables(1).Range.Rows(i)\n        Set rng = rw.Range.Cells(1).Range\n\n        'If the cell contains multiple paragraphs then in contains\n        'a nested table. Skip the table and go to the end (last paragraph)\n        If rng.Paragraphs.Count &gt; 1 Then\n            Set rng = rng.Paragraphs.Last.Range\n        End If\n        rng.Paragraphs(1).LeftIndent = aParas(i - 1).LeftIndent\n        rng.Paragraphs(1).FirstLineIndent = aParas(i - 1).FirstLineIndent \n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10861589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da14415d05a662b9ab109030a4665967?s=128&d=identicon&r=PG&f=1", "display_name": "Zeflik", "link": "https://stackoverflow.com/users/10861589/zeflik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 55638481, "answer_count": 1, "score": 1, "last_activity_date": 1555004949, "creation_date": 1554907065, "last_edit_date": 1555002116, "question_id": 55615270, "link": "https://stackoverflow.com/questions/55615270/how-to-reasign-indentation-after-converting-all-paragraphs-to-a-table-in-word-do", "title": "How to reasign indentation after converting all paragraphs to a table in Word document with VBA?", "body": "<p>I'm regularly working with large Word documents. I have to convert all  paragraphs to a table. </p>\n\n<p>Source document structure sample:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kF11f.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kF11f.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After conversion (Insert -> Table -> Convert text to table) Word loses information about indents for random paragraphs. Target document:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Caeem.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Caeem.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, indents for paragraphs \"c\" and \"d\" disappeared. Don't know why but it happens quite often.</p>\n\n<p>It should be exactly the same as in the source documents:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ni9ud.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ni9ud.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Finding and correcting the errors for very large documents takes hours, so I thought that I can repair broken indents in the target document by taking indent values from the source paragraphs.</p>\n\n<p>This is my first attempt using VBA, I started like this:</p>\n\n<pre><code>Dim sourceDocument, targetDocument As Document\nDim myRange As Range\nSet sourceDocument = ActiveDocument\nSet targetDocument = Documents.Add(ActiveDocument.FullName)\nSet myRange = targetDocument.Range(Start:=targetDocument.paragraphs(1).Range.Start, End:=targetDocument.paragraphs(targetDocument.paragraphs.Count).Range.End)\nmyRange.converttotable Separator:=wdSeparateByParagraphs\nDim i As Integer\nFor i = 1 To targetDocument.Tables(1).Range.Rows.Count\n    targetDocument.Tables(1).Range.Rows(i).Range.Cells(1).Range.paragraphs(1).LeftIndent = sourceDocument.paragraphs(i).LeftIndent\n    targetDocument.Tables(1).Range.Rows(i).Range.Cells(1).Range.paragraphs(1).FirstLineIndent = sourceDocument.paragraphs(i).FirstLineIndent\nNext i\n</code></pre>\n\n<p>The script works as expected for simple paragraphs since the number of paragraphs matches the count of rows in the target table. But in the case of tables existing in source document it gets messy. In tables, the number of paragraphs is doubled.</p>\n\n<p>Source tables are nested in one target cell which is fine, no problems with them, and they do not have to be corrected. </p>\n\n<p>So my question is how to match source paragraphs with target paragraphs in tables (omitting source tables and target nested tables)?</p>\n\n<p>Or maybe there is another way of converting paragraphs to a table with correct indentation?</p>\n"}, {"tags": ["excel", "vba", "object"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 1, "creation_date": 1554907372, "post_id": 55615141, "comment_id": 97924250, "body": "It&#39;s going to be a matter of referencing.  When you step through [F8], &#39;This workbook&#39; will be whatever workbook the currently running macro is saved in.  When your execute full [f5], &#39;This workbook&#39;  will be whatever workbook was last activated."}, {"owner": {"reputation": 175, "user_id": 8538935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91a600e3297ee3e85258d82aa092b7fa?s=128&d=identicon&r=PG", "display_name": "vib", "link": "https://stackoverflow.com/users/8538935/vib"}, "reply_to_user": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1554907830, "post_id": 55615141, "comment_id": 97924508, "body": "This is why I tried with wbInbound.activate first, and the issue is the same, is it normal? I put &quot;thisworkbook&quot; as the whole code is placed here"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 2, "creation_date": 1554907887, "post_id": 55615141, "comment_id": 97924549, "body": "The Application.Run line looks to me to be referencing 2 workbooks wbInbound and Thisworkbook ...."}, {"owner": {"reputation": 175, "user_id": 8538935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91a600e3297ee3e85258d82aa092b7fa?s=128&d=identicon&r=PG", "display_name": "vib", "link": "https://stackoverflow.com/users/8538935/vib"}, "edited": false, "score": 1, "creation_date": 1554908113, "post_id": 55615141, "comment_id": 97924696, "body": "I simplified everything and put the code into a module and removed the &quot;Thisworkbook&quot; and this if working fine Thank you :)"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1554908115, "post_id": 55615141, "comment_id": 97924697, "body": "where is the macro you want to run saved... is it in the workbook that you&#39;ve just opened or is it in the workbook along with the code that&#39;s you&#39;re running above?"}, {"owner": {"reputation": 175, "user_id": 8538935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91a600e3297ee3e85258d82aa092b7fa?s=128&d=identicon&r=PG", "display_name": "vib", "link": "https://stackoverflow.com/users/8538935/vib"}, "edited": false, "score": 0, "creation_date": 1554908149, "post_id": 55615141, "comment_id": 97924723, "body": "in the workbook i just opened in the object &quot;thisworkbook&quot;"}], "owner": {"reputation": 175, "user_id": 8538935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91a600e3297ee3e85258d82aa092b7fa?s=128&d=identicon&r=PG", "display_name": "vib", "link": "https://stackoverflow.com/users/8538935/vib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554906706, "creation_date": 1554906706, "question_id": 55615141, "link": "https://stackoverflow.com/questions/55615141/method-run-of-object-failed-with-run-command-but-not-step-by-step", "title": "Method Run of object failed with run command but not step by step", "body": "<p>I wrote a quick piece of code which was working great on another workbook but not on the current one.\nThe goal is simple: open a workbook and run a macro inside this workbook.\n I have the following error message\n\"Method 'Run' of object '_Application' failed</p>\n\n<p>What is strange is: when I execute the full macro with F5, I have the error message but it's working well if I execute step by step command (F8)</p>\n\n<p>What is strange is: when I execute the full macro with F5, I have the error message but it's working well if I execute step by step command (F8)</p>\n\n<pre><code>Sub open_Inbound()\nDim wbInbound As Workbook\nApplication.AutomationSecurity = msoAutomationSecurityLow\nWorkbooks.Open Filename:=\"my path/removed\", \nReadOnly:=True\nSet wbInbound = Workbooks(\"my name.xlsm\")\n'wbInbound.Activate\nDoEvents\nApplication.Run \"'\" &amp; wbInbound.Name &amp; \"'!Thisworkbook.makeIndicator\"\n\nDoEvents\nwbInbound.Close\n\n\nEnd Sub\n</code></pre>\n\n<p>I expect to run the macro \"makeIndicator\" in normal processing when I press F5 or run command and not only step by step</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1554906792, "post_id": 55615127, "comment_id": 97923874, "body": "Totally possible. It&#39;s up to you how and where you want to store the submissions (in a collection, a dictionary, an array, a worksheet...) Then you just retrieve and display those values."}, {"owner": {"reputation": 13, "user_id": 11340915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa342b322fd0aba5e03815afe421ba2?s=128&d=identicon&r=PG&f=1", "display_name": "xbauks", "link": "https://stackoverflow.com/users/11340915/xbauks"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1554907076, "post_id": 55615127, "comment_id": 97924072, "body": "I&#39;m very new to VBA and writing code in general (I have no background in it). What would be the best way to go about this? I want the user to be able to decide how many times they input data. So some users might only need to use the form once. Others might need 5 instances. I don&#39;t need you to write the code for me but if you could point in the right direction, I&#39;d really appreciate it!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1554908445, "post_id": 55615127, "comment_id": 97924893, "body": "It can be hard to get started on this kind of stuff. I&#39;ve been there. I&#39;ve put an example as an answer using the most plain userform on a brand new workbook. Here I&#39;m using an array called <code>Submissions</code> to hold the values submitted by the user in <code>TextBox1</code>. To get this running after creating the userform and pasting this code in, you can go to your <code>Immediate</code> pane (View&gt;&gt;Immediate) and type in <code>userForm1.Show</code> and press enter."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11340915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa342b322fd0aba5e03815afe421ba2?s=128&d=identicon&r=PG&f=1", "display_name": "xbauks", "link": "https://stackoverflow.com/users/11340915/xbauks"}, "edited": false, "score": 0, "creation_date": 1554912236, "post_id": 55615728, "comment_id": 97927127, "body": "Thank you so much! This is exactly what I needed!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1554908335, "creation_date": 1554908335, "answer_id": 55615728, "question_id": 55615127, "link": "https://stackoverflow.com/questions/55615127/excel-vba-userform-using-the-same-form-to-generate-continuous-data/55615728#55615728", "title": "Excel VBA userform - using the same form to generate continuous data", "body": "<p>Here's a quick POC. Consider a plain-jane userform with a textbox and two command buttons. I didn't change the default names here at all. Just added a userform with textbox1, commandbutton1, and commandbutton2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cGmAU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cGmAU.png\" alt=\"enter image description here\"></a></p>\n\n<p><code>CommandButton1</code> submits and <code>CommandButton2</code> quits out of the userform (Clicked when the user is done submitting, for instance).</p>\n\n<p>The code to make this work as you described. This goes in the code page for the userform. </p>\n\n<pre><code>'declare a string array to hold the submissions from textbox1\nPrivate submissions() As String\n\n'Code to run when the form activates\nPrivate Sub UserForm_Activate()\n    'When this userform is first initialized set up the array\n    'as a one dimensional array with a single element\n    ReDim submissions(0 To 0)\nEnd Sub\n\n'Code to run when the commandbutton1 is clicked\nPrivate Sub CommandButton1_Click()\n    'call the addSubmission sub\n    addSubmission\nEnd Sub\n\n'Code to run when the commandButton2 is clicked\nPrivate Sub CommandButton2_Click()\n\n    'add submission one more time\n    addSubmission\n\n    'Now Loop through the array and send the values out\n    'to the worksheet\n    Dim rowCounter As Long\n    rowCounter = 1\n    For Each submission In submissions\n        Sheet1.Cells(rowCounter, 1).Value = submission\n        rowCounter = rowCounter + 1\n    Next submission\n\n    'Now close the form\n    Me.Hide\n\n    'And activate sheet1 for the user to see their submissions\n    Sheet1.Activate\nEnd Sub\n\n'addSubmission will add textBox1 value to\n'  the submissions array declared at the\n'  top of this userform code.\nSub addSubmission()\n    'First we have to redim the array to hold the new\n    '   submission.\n    'But only redim it if this isn't the first submission\n    If UBound(submissions) &gt; 0 Or submissions(0) &lt;&gt; \"\" Then ReDim Preserve submissions(0 To UBound(submissions) + 1)\n    submissions(UBound(submissions)) = Me.TextBox1.Value\n\n    'Clear the textbox so the user doesn't have to backspace\n    Me.TextBox1.Value = \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11340915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa342b322fd0aba5e03815afe421ba2?s=128&d=identicon&r=PG&f=1", "display_name": "xbauks", "link": "https://stackoverflow.com/users/11340915/xbauks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 55615728, "answer_count": 1, "score": 1, "last_activity_date": 1554909257, "creation_date": 1554906663, "last_edit_date": 1554909257, "question_id": 55615127, "link": "https://stackoverflow.com/questions/55615127/excel-vba-userform-using-the-same-form-to-generate-continuous-data", "title": "Excel VBA userform - using the same form to generate continuous data", "body": "<p>I'm fairly new to VBA. I want to create a userform that will allow the user to use the same form multiple times. Each time the form is used, any data the user inputs, gets added to a variable (the same variable or multiple different ones). When the user has input all the data, they can hit submit and the form will spit out all the data in order. </p>\n\n<p>Example:\nUserform with a textbox and 2 command buttons, <code>Next</code> and <code>Submit</code>.\nUser inputs <code>1</code>, clicks <code>Next</code>. User inputs <code>2</code>, clicks <code>Submit</code>. \nUserform prints out <code>1, 2</code>.</p>\n\n<p>How would I go about doing this? Is this even possible?</p>\n"}, {"tags": ["excel", "vba", "dynamic-arrays"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554907388, "post_id": 55615074, "comment_id": 97924258, "body": "You haven&#39;t populated the arrays, just set their sizes."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11340966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eca935b58e6bc21bb7e155ad05e63c4?s=128&d=identicon&r=PG&f=1", "display_name": "Jotix", "link": "https://stackoverflow.com/users/11340966/jotix"}, "edited": false, "score": 1, "creation_date": 1554909345, "post_id": 55615629, "comment_id": 97925475, "body": "Worked perfectly! Sorry about forgetting to populate the Array!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1554908051, "creation_date": 1554908051, "answer_id": 55615629, "question_id": 55615074, "link": "https://stackoverflow.com/questions/55615074/comparing-2-dynamic-arrays-of-different-sizes-and-seeing-how-many-match/55615629#55615629", "title": "Comparing 2 Dynamic Arrays of different sizes and seeing how many match", "body": "<p>Try this. Populate the arrays from the ranges in one go. Loop through ISRC, check if each element is in the other array using MATCH and keep a tally.</p>\n\n<pre><code>Sub x()\n\nDim ws As Worksheet\nDim wb As Workbook, lastrow As Long, i As Long, v As Variant, count As Long\n\nDim ISRC As Variant\nDim ISRC2 As Variant\n\nSet wb = Workbooks(\"Recordssales2019-04-05\")\n\nDim ws1  As Worksheet\nDim ws2  As Worksheet\n\nSet ws1 = wb.Worksheets(\"Recordssales2019-04-\")\nSet ws2 = wb.Worksheets(\"Metadata\")\n\nlastrow = ws1.Range(\"E100000\").End(xlUp).Row\nISRC = Application.Transpose(ws1.Range(\"E1:E\" &amp; lastrow).Value)\n'MsgBox lastrow\n\nlastrow = ws2.Range(\"AJ100000\").End(xlUp).Row\nISRC2 = Application.Transpose(ws2.Range(\"AJ1:AJ\" &amp; lastrow).Value)\n'MsgBox lastrow\n\nFor i = LBound(ISRC) To UBound(ISRC)\n    v = Application.Match(ISRC(i), ISRC2, 0)\n    If IsNumeric(v) Then count = count + 1\nNext i\n\nMsgBox count &amp; \" elements of ISRC are in ISRC2 (\" &amp; Format(count / UBound(ISRC), \"0.0%\") &amp; \").\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11340966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eca935b58e6bc21bb7e155ad05e63c4?s=128&d=identicon&r=PG&f=1", "display_name": "Jotix", "link": "https://stackoverflow.com/users/11340966/jotix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55615629, "answer_count": 1, "score": 0, "last_activity_date": 1554984142, "creation_date": 1554906505, "last_edit_date": 1554984142, "question_id": 55615074, "link": "https://stackoverflow.com/questions/55615074/comparing-2-dynamic-arrays-of-different-sizes-and-seeing-how-many-match", "title": "Comparing 2 Dynamic Arrays of different sizes and seeing how many match", "body": "<p>I have 2 Dynamic Arrays which the first Array contains 15,000 values and is located on Sheet1. The second Array has 519 Values and is located on Sheet2. </p>\n\n<p>All Values in the first Array should be in the Second array, as the first array contains duplicated values. </p>\n\n<p>What I want to do, is to compare the First Array with the Second Array and to return a % of how many match. (it should be 100%).</p>\n\n<p>The code shown just contains the Dynamic Arrays and the start of the Formula to check both the L and U bounds of the Arrays. However I'm stuck on what the formula should say. </p>\n\n<pre><code>Dim ws As Worksheet\nDim wb As Workbook\n\nDim ISRC() As Variant\nDim ISRC2() As Variant    \n\nSet wb = Workbooks(\"Recordssales2019-04-05\")\n\nDim ws1  As Worksheet\nDim ws2  As Worksheet\n\nSet ws1 = wb.Worksheets(\"Recordssales2019-04-\")\nSet ws2 = wb.Worksheets(\"Metadata\")\n\nLastrow = ws1.Range(\"E100000\").End(xlUp).Row\nReDim ISRC(1 To Lastrow + 1)\nMsgBox Lastrow\n\nLastrow = ws2.Range(\"AJ100000\").End(xlUp).Row\nReDim ISRC2(1 To Lastrow + 1)\nMsgBox Lastrow\n\nFor i = LBound(ISRC) To UBound(ISRC)\n    If ISRC(i) = ISRC2(i) Then\n</code></pre>\n\n<p>Ideally for the first array to be compared to the second array and to return with a match of how many are the same. From there I want to be able to do the next step based on if they matched. If they didn't match they should not be included in the next step.</p>\n"}, {"tags": ["ms-access", "combobox", "vba", "onchange"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 2, "creation_date": 1554906585, "post_id": 55615054, "comment_id": 97923749, "body": "Best Practices VBA Troubleshooting: Set a breakpoint (F9) and then Single Step (F8)"}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 1, "creation_date": 1554906736, "post_id": 55615054, "comment_id": 97923840, "body": "Do the values not work?  What happens when you try the code?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1554907015, "post_id": 55615054, "comment_id": 97924022, "body": "Put <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of each module.   It enforces variable declaration and reports undeclared or misspelled variables/constants at compile time.  To have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1554909503, "creation_date": 1554909503, "answer_id": 55616122, "question_id": 55615054, "link": "https://stackoverflow.com/questions/55615054/access-combobox-values-depend-on-previous-combobox/55616122#55616122", "title": "Access: Combobox Values Depend on Previous Combobox", "body": "<p>The combobox <code>AddItem</code> method will add an item to the combo's <code>ValueList</code>.  But I doubt that is what you really want.  If the user selected <em>\"Apple\"</em> in the first combo and then went back and selected <em>\"Blueberry\"</em>, I suspect you want the second combo to contain only the <em>\"Blueberry\"</em> choices, not both the <em>\"Apple\"</em> and <em>\"Blueberry\"</em> choices.</p>\n\n<p>Avoid that by altering the <code>ValueList</code> property directly ...</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate Sub Combobox1_AfterUpdate()\n    Dim strValueList As String\n\n    Select Case Me.Combobox1.Value\n    Case \"Apple\"\n        strValueList = \"Sauce;Seeds\"\n    Case \"Blueberry\"\n        strValueList = \"Pie;Cobbler\"\n    Case Else\n        MsgBox \"What should happen when selection = '\" &amp; Me.Combobox1.Value &amp; \"'?\"\n    End Select\n    Me.Combobox2.RowSource = strValueList\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li>Use the first combo's <code>AfterUpdate</code> event because its value has been finalized at that point.</li>\n<li>Include <code>Option Explicit</code> as <a href=\"https://stackoverflow.com/questions/55615054/access-combobox-values-depend-on-previous-combobox#comment97924022_55615054\">Andre suggested</a>.  Don't write VBA code without it.</li>\n<li>Consider storing your fruit names and options in a table and using queries instead of value lists for the combobox row sources.  Then when you need to change the available choices, edit the data in the table instead of revising VBA code.  </li>\n</ol>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55616122, "answer_count": 1, "score": 0, "last_activity_date": 1554909595, "creation_date": 1554906441, "last_edit_date": 1554909595, "question_id": 55615054, "link": "https://stackoverflow.com/questions/55615054/access-combobox-values-depend-on-previous-combobox", "title": "Access: Combobox Values Depend on Previous Combobox", "body": "<p>So I have two comboboxes, <code>Combobox1</code> and <code>Combobox2</code>. If the user chooses \"Apple\" for <code>Combobox1</code>, I want the values for <code>Combobox2</code> to be \"Sauce\" and \"Seeds\".</p>\n\n<p>Likewise, if a user picks \"Blueberry\" for Combobox1, i'd like Combobox2 values to choose from be \"Pie\" and \"Cobbler\".</p>\n\n<p>I'm having touble figuring out how to make the values for the second combobox based on the first choice. I think it would be something like this...</p>\n\n<pre><code>Private Sub Combobox1_Change()\n    If Combobox1= Apple Then\n        Combobox2.AddItem \"Sauce\"\n        Combobox2.AddItem \"Seeds\"\n    End If\n\n    If Combobox1= BlueberryThen\n        Combobox2.AddItem \"Pie\"\n        Combobox2.AddItem \"Cobbler\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The onChange event is working based on test i've done, but no matter what I pick for the first combobox, the second combobox is empty.</p>\n"}, {"tags": ["excel", "vba", "rubberduck"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1554906739, "post_id": 55614845, "comment_id": 97923846, "body": "Please read: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554907481, "post_id": 55614845, "comment_id": 97924314, "body": "There&#39;s a missing <code>Set</code> keyword in <code>sheetUI = HelloSheet</code> (ugh that <i>should</i> have fired a &quot;missing set keyword&quot; inspection), in the <code>Class_Initialize</code> handler for <code>SheetView</code> =)"}, {"owner": {"reputation": 97, "user_id": 9535720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEU5g.jpg?s=128&g=1", "display_name": "Yasen Simeonov", "link": "https://stackoverflow.com/users/9535720/yasen-simeonov"}, "edited": false, "score": 0, "creation_date": 1554910123, "post_id": 55614845, "comment_id": 97925930, "body": "@peakpeak - thanks for your input, having read that I do see how I could have made my post more concise."}, {"owner": {"reputation": 97, "user_id": 9535720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEU5g.jpg?s=128&g=1", "display_name": "Yasen Simeonov", "link": "https://stackoverflow.com/users/9535720/yasen-simeonov"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554910577, "post_id": 55614845, "comment_id": 97926161, "body": "@Mathieu Guindon - with hindsight Code Inspections was flagging the &quot;missing Set keyword&quot;, I am still getting to grips with all the useful features Rubberduck is packed with. Keep up the good work, you are a legend for proving beyond doubt (in my opinion) that OOP programming IS possible in VBA and IS preferable for projects with a certain level of complexity/scope/change frequency."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554911008, "post_id": 55614845, "comment_id": 97926399, "body": "Thanks! Rubberduck wouldn&#39;t be half as awesome without the work of M.Doerner, Comintern, this, Vogel612, ThunderFrame (RIP), and the various contributions of many others -- please don&#39;t hesitate to submit any issue or provide any sort of feedback on <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">GitHub</a>, and feel free to star us if you haven&#39;t already!"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9535720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEU5g.jpg?s=128&g=1", "display_name": "Yasen Simeonov", "link": "https://stackoverflow.com/users/9535720/yasen-simeonov"}, "edited": false, "score": 0, "creation_date": 1554909819, "post_id": 55615639, "comment_id": 97925759, "body": "Thank you, Mathieu! Indeed, the issue was <a href=\"https://u.cubeupload.com/yasosim/20190410RubberduckCo.png\" rel=\"nofollow noreferrer\">getting flagged</a> in Code Inspections - being a Rubberduck newbie I had neglected this awesome feature until now. I will not make this mistake again :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 9535720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEU5g.jpg?s=128&g=1", "display_name": "Yasen Simeonov", "link": "https://stackoverflow.com/users/9535720/yasen-simeonov"}, "edited": false, "score": 1, "creation_date": 1554910035, "post_id": 55615639, "comment_id": 97925872, "body": "@YasenSimeonov thanks! Note that some of these inspections are extremely tricky to get right (due to inherited interfaces and default members, and our mishandling of arrays in certain situations), so there <i>are</i> a number of false positives - do review inspection results, but don&#39;t apply fixes blindly =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1554908077, "creation_date": 1554908077, "answer_id": 55615639, "question_id": 55614845, "link": "https://stackoverflow.com/questions/55614845/setting-private-withevents-as-sheet1-sheetui-sheet1-causes-error-438-object/55615639#55615639", "title": "Setting (Private WithEvents As Sheet1) sheetUI = Sheet1 causes error 438: Object doesn&#39;t support this property or method", "body": "<blockquote>\n<pre><code>Private WithEvents sheetUI As HelloSheet\n\nPrivate Sub Class_Initialize()\n    sheetUI = HelloSheet\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p><code>sheetUI</code> is an object reference, assigning it requires the <code>Set</code> keyword:</p>\n\n<pre><code>Private WithEvents sheetUI As HelloSheet\n\nPrivate Sub Class_Initialize()\n    Set sheetUI = HelloSheet\nEnd Sub\n</code></pre>\n\n<p>Error 438 is thrown whenever you try to access the default member of a <code>Worksheet</code> class, since <code>Worksheet</code> has no default member - this code reproduces the error from the <em>immediate pane</em>:</p>\n\n<pre><code>?Sheet1\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>foo = Sheet1\n</code></pre>\n\n<p>Rubberduck inspections <em>should</em> have warned about this, under \"Code Quality Issues\":</p>\n\n<blockquote>\n  <p>Object variable 'sheetUI' is assigned without the 'Set' keyword.</p>\n</blockquote>\n"}], "owner": {"reputation": 97, "user_id": 9535720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cEU5g.jpg?s=128&g=1", "display_name": "Yasen Simeonov", "link": "https://stackoverflow.com/users/9535720/yasen-simeonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 55615639, "answer_count": 1, "score": 2, "last_activity_date": 1554908077, "creation_date": 1554905906, "question_id": 55614845, "link": "https://stackoverflow.com/questions/55614845/setting-private-withevents-as-sheet1-sheetui-sheet1-causes-error-438-object", "title": "Setting (Private WithEvents As Sheet1) sheetUI = Sheet1 causes error 438: Object doesn&#39;t support this property or method", "body": "<p>I am using <a href=\"https://rubberduckvba.wordpress.com/2018/09/04/oop-battleship-part-3-the-view/\" rel=\"nofollow noreferrer\">this</a> excellent tutorial as a base to create a simple \"Hello World\" Excel VBA project leveraging on Mathieu Guindon's concept of writing Object-Oriented Programming VBA code, discussed in a series of articles on the <a href=\"https://rubberduckvba.wordpress.com/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/</a> blog.</p>\n\n<p>I have created a \"bare bones\" project without any Model containing an Excel worksheet (HelloSheet), a View, a ViewAdapter (including ViewCommands and ViewEvents interfaces) and a Controller. The VBA project compiles without errors but when I try to run the \"application entry\" macro I get the dreaded \"Run-time error 438: Object doesn't support this property or method\". This happens inside the Class_Initialize() sub of my View class where I have declared \"Private WithEvents sheetUI As HelloSheet\" and try to set \"sheetUI = HelloSheet\". </p>\n\n<p><a href=\"http://u.cubeupload.com/yasosim/20190410ProjectTree.png\" rel=\"nofollow noreferrer\">Here</a> is an overview of my project tree, as seen in the RubberDuck VBIDE.</p>\n\n<p>I have tried updating the VBA project references to exactly match those of the \"Battleship\" sample project. I also tried the two different approaches to implementing the <a href=\"https://rubberduckvba.wordpress.com/2018/09/11/lazy-object-weak-reference/\" rel=\"nofollow noreferrer\">Lazy Object / Weak Reference</a> in the View class - the one in the \"Battleship (WorksheetView).xlsm\" linked in the <a href=\"https://rubberduckvba.wordpress.com/2018/09/04/oop-battleship-part-3-the-view/\" rel=\"nofollow noreferrer\">original article</a> vs the approach used in the <a href=\"https://github.com/rubberduck-vba/Battleship\" rel=\"nofollow noreferrer\">latest version on GitHub</a>, more specifically:</p>\n\n<pre><code>Private adapter As ***IWeakReference***\nPrivate WithEvents sheetUI As HelloSheet\n\nPrivate Sub Class_Initialize()\n    sheetUI = HelloSheet\nEnd Sub\n\nPrivate Property Get ViewEvents() As ISheetViewEvents\n    Set ViewEvents = adapter ***.Object***\nEnd Property\n</code></pre>\n\n<p>VS</p>\n\n<pre><code>Private adapter As ***SheetViewAdapter***\nPrivate WithEvents sheetUI As HelloSheet\n\nPrivate Sub Class_Initialize()\n    sheetUI = HelloSheet\nEnd Sub\n\nPrivate Property Get ViewEvents() As ISheetViewEvents\n    Set ViewEvents = ***adapter***\nEnd Property\n</code></pre>\n\n<p>..but the \"Run-time error 438: Object doesn't support this property or method\" persisted.</p>\n\n<p>Below is all relevant code split in sheets, classes, interfaces etc.:</p>\n\n<p>1) HelloSheet (regular Excel sheet code-behind):</p>\n\n<pre><code>'@Folder(\"HelloWorld.View.Worksheet\")\nOption Explicit\n\nPublic Event DoubleClick(ByVal clickedRow As Integer)\n\nPublic Sub HideShape(shapeName As String)\n    Dim currentShape As Shape\n    Set currentShape = Me.Shapes(shapeName)\n    currentShape.Visible = msoFalse\nEnd Sub\n\nPublic Sub ShowShape(shapeName As String)\n    Dim currentShape As Shape\n    Set currentShape = Me.Shapes(shapeName)\n    currentShape.Visible = msoTrue\nEnd Sub\n\nPublic Sub OnLaunchCommand()\n    ShowShape (\"WarningTriangle\")\nEnd Sub\n\nPublic Sub TempManualHide()\n    HideShape (\"WarningTriangle\")\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = True\n    RaiseEvent DoubleClick(Target.Row)\nEnd Sub\n\nPublic Sub PreviewSelectedRecord(ByVal selectedRow As Integer)\n    Me.Cells(1, 1).Value2 = \"Row is \" &amp; CStr(selectedRow)\nEnd Sub\n</code></pre>\n\n<p>2) SheetView class:</p>\n\n<pre><code>'@Folder(\"HelloWorld.View.Worksheet\")\nOption Explicit\nImplements ISheetViewCommands\n\nPrivate adapter As SheetViewAdapter ' IWeakReference\nPrivate WithEvents sheetUI As HelloSheet\n\nPrivate Sub Class_Initialize()\n    sheetUI = HelloSheet\nEnd Sub\n\nPrivate Property Get ViewEvents() As ISheetViewEvents\n    Set ViewEvents = adapter '.Object\nEnd Property\n\n\n':GameSheet event handlers\n':Messages sent from the view\n':***************************\n\nPrivate Sub sheetUI_DoubleClick(ByVal clickedRow As Integer)\n    ViewEvents.PreviewSelectedRecord clickedRow\nEnd Sub\n\n\n':IGridViewCommands\n':Messages sent from the controller\n':*********************************\n\nPrivate Property Set ISheetViewCommands_Events(ByVal value As ISheetViewEvents)\n    Set adapter = value ' WeakReference.Create(Value)\nEnd Property\n\nPrivate Property Get ISheetViewCommands_Events() As ISheetViewEvents\n    Set ISheetViewCommands_Events = adapter '.Object\nEnd Property\n\nPrivate Sub ISheetViewCommands_OnLaunchCommand()\n    sheetUI.OnLaunchCommand\nEnd Sub\n\nPrivate Sub ISheetViewCommands_OnPreviewSelectedRecord(ByVal selectedRow As Integer)\n    sheetUI.PreviewSelectedRecord selectedRow\nEnd Sub\n</code></pre>\n\n<p>3) ISheetViewEvents interface:</p>\n\n<pre><code>'@Folder(\"HelloWorld.View\")\n'@Interface\nOption Explicit\n\nPublic Sub PreviewSelectedRecord(ByVal selectedRow As Integer)\nEnd Sub\n</code></pre>\n\n<p>4) ISheetViewCommands interface:</p>\n\n<pre><code>'@Folder(\"HelloWorld.View\")\n'@Interface\nOption Explicit\n\n'@Description(\"Gets/sets a weak refererence to the view events.\")\nPublic Property Get Events() As ISheetViewEvents\nEnd Property\n\nPublic Property Set Events(ByVal value As ISheetViewEvents)\nEnd Property\n\nPublic Sub OnLaunchCommand()\nEnd Sub\n\nPublic Sub OnPreviewSelectedRecord(ByVal selectedRow As Integer)\nEnd Sub\n</code></pre>\n\n<p>5) SheetViewAdapter class (PredeclaredId / has default instance):</p>\n\n<pre><code>'@Folder(\"HelloWorld.View\")\nOption Explicit\n'@PredeclaredId\nImplements ISheetViewCommands\nImplements ISheetViewEvents\n\nPublic Event OnPreviewCurrentSelectedRecord(ByVal selectedRow As Integer)\n\nPrivate Type TAdapter\n    SheetViewCommands As ISheetViewCommands\nEnd Type\nPrivate this As TAdapter\n\nPublic Function Create(ByVal view As ISheetViewCommands) As SheetViewAdapter\n    With New SheetViewAdapter\n        Set .SheetViewCommands = view\n        Set view.Events = .Self\n        Set Create = .Self\n    End With\nEnd Function\n\nPublic Property Get Self() As SheetViewAdapter\n    Set Self = Me\nEnd Property\n\n'@Description(\"Gets/sets a reference that exposes commands to send to the view.\")\nPublic Property Get SheetViewCommands() As ISheetViewCommands\n    Set SheetViewCommands = this.SheetViewCommands\nEnd Property\n\nPublic Property Set SheetViewCommands(ByVal value As ISheetViewCommands)\n    Set this.SheetViewCommands = value\nEnd Property\n\n\n':IGridViewEvents\n':Messages sent from the view\n':***************************\n\nPrivate Sub ISheetViewEvents_PreviewSelectedRecord(ByVal selectedRow As Integer)\n    RaiseEvent OnPreviewCurrentSelectedRecord(selectedRow)\nEnd Sub\n\n\n':IGridViewCommands\n':Messages sent from the controller\n':*********************************\n\nPrivate Property Set ISheetViewCommands_Events(ByVal value As ISheetViewEvents)\n    Err.Raise 5, TypeName(Me), \"Invalid use of property\"\nEnd Property\n\nPrivate Property Get ISheetViewCommands_Events() As ISheetViewEvents\n    Set ISheetViewCommands_Events = Me\nEnd Property\n\nPrivate Sub ISheetViewCommands_OnLaunchCommand()\n    this.SheetViewCommands.OnLaunchCommand\nEnd Sub\n\nPrivate Sub ISheetViewCommands_OnPreviewSelectedRecord(ByVal selectedRow As Integer)\n    this.SheetViewCommands.OnPreviewSelectedRecord selectedRow\nEnd Sub\n</code></pre>\n\n<p>6) HelloController class:</p>\n\n<pre><code>'@Folder(\"HelloWorld\")\nOption Explicit\n\nPrivate viewCommands As ISheetViewCommands\nPrivate WithEvents viewAdapter As SheetViewAdapter\n\nPublic Sub Launch(ByVal adapter As SheetViewAdapter)\n    Set viewAdapter = adapter\n    Set viewCommands = adapter\n    viewCommands.OnLaunchCommand\nEnd Sub\n\nPrivate Sub viewAdapter_OnPreviewCurrentSelectedRecord(ByVal selectedRow As Integer)\n    viewCommands.OnPreviewSelectedRecord selectedRow\nEnd Sub\n</code></pre>\n\n<p>7) And finally the \"Macros\" standard module which serves as an entry point. This is where I encounter the error (the \"Set view = New SheetView\" line):</p>\n\n<pre><code>'@Folder(\"HelloWorld\")\n'@Description(\"Application entry points.\")\nOption Explicit\n'@Ignore MoveFieldCloserToUsage\nPrivate controller As HelloController\n\nPublic Sub LaunchWorksheetInterface()\n    Dim view As SheetView\n    Set view = New SheetView\n\n    Set controller = New HelloController\n    controller.Launch SheetViewAdapter.Create(view)\nEnd Sub\n</code></pre>\n\n<p>Supposing I could get around the entry-level error, I would expect a very simple functionality:</p>\n\n<p>1) A hidden Excel shape is made visible on the HelloSheet (the OnLaunchCommand);</p>\n\n<p>2) When double-clicking on a cell, the row it is located on would be reported in cell A1 of the same worksheet (the Worksheet_BeforeDoubleClick event).</p>\n\n<p>Obviously this amount of code for such simple tasks is overkill - my idea is once I get these basics working to add Model classes to the project and map them to certain areas (i.e. Tables/ListObjects) inside the Workbook.</p>\n\n<p>Any help will be greatly appreciated! And kudos to anyone who has made it to the end of this rather long post :)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": 0, "last_activity_date": 1554909483, "creation_date": 1554909483, "answer_id": 55616114, "question_id": 55614757, "link": "https://stackoverflow.com/questions/55614757/need-a-little-guidance-with-coding-a-button-in-a-database-workbook/55616114#55616114", "title": "Need a little guidance with coding a button in a database workbook", "body": "<p>This is more a prompt aimed at helping not an answer</p>\n\n<p>Step 1 - Add-in info for where the data can be found</p>\n\n<pre><code>Private Sub Create_Plan_Click()\n\nDim UserFilename As String\nDim FullName As String\nDim dbSrcRow as long, dbSrcSht as Worksheet  ' These 2 Added\n\nUserFilename = Combo_Title &amp; Txt_FirstName &amp; Txt_MiddleInit &amp; Txt_LastName &amp; Combo_Suffix\nFullName = Combo_Title &amp; \" \" &amp; Txt_FirstName &amp; \" \" &amp; Txt_MiddleInit &amp; \". \" &amp; Txt_LastName &amp; \" \" &amp; Combo_Suffix\n\n' You also need to provide info as to where the data base record is\n  Set dbSrcSht = \"dbSheet\"  ' You need to edit this\n  Set dbSrcRow = 123        ' and this too\n' Done\n\n' I've swapped these next 2 lines around\n' seems you need to carryout the copying before you loose/unload the data\n  Meal_Cat_Form.Show  ' This will become the copy routine not a form\n  Unload Choose_User\n' Done\n\nEnd Sub\n</code></pre>\n\n<p>Step 2 - Add-In info about which sheets need copying</p>\n\n<pre><code>' You also need to provide info as to which sheets need to be copied\n  Set Shts2Copy = \"Sht1,Sht2,Sht3\"  ' You need to edit this\n' Done\n</code></pre>\n\n<p>Finally - You need to create a new workbook and fill-in the info, then save it</p>\n"}], "owner": {"reputation": 1, "user_id": 11340735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d36ff735c9af128d1f93f609b354580?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/11340735/rick-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554909483, "creation_date": 1554905592, "last_edit_date": 1554906367, "question_id": 55614757, "link": "https://stackoverflow.com/questions/55614757/need-a-little-guidance-with-coding-a-button-in-a-database-workbook", "title": "Need a little guidance with coding a button in a database workbook", "body": "<p>I created a database in excel and worksheets that need to be copied and populated with information from a certain record from the database. I need a new workbook file to be opened with the individual's name on the filename and the workbook filled with the copied sheets and the information from the one record transferred over as well.</p>\n\n<p>I am really new to using excel with VBA and am in need of assistance. </p>\n\n<pre><code>Private Sub Create_Plan_Click()\n\nDim UserFilename As String\nDim FullName As String\n\nUserFilename = Combo_Title &amp; Txt_FirstName &amp; Txt_MiddleInit &amp; Txt_LastName &amp; Combo_Suffix\nFullName = Combo_Title &amp; \" \" &amp; Txt_FirstName &amp; \" \" &amp; Txt_MiddleInit &amp; \". \" &amp; Txt_LastName &amp; \" \" &amp; Combo_Suffix\n\n\nUnload Choose_User\n\nMeal_Cat_Form.Show\n\nEnd Sub\n</code></pre>\n\n<p>Instead of showing Meal_Cat_Form, I want to copy the record along with other sheets in the database file and create a whole new workbook with the copied sheets and the info from the record chosen.</p>\n"}, {"tags": ["excel", "vba", "merge"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554905962, "post_id": 55614657, "comment_id": 97923406, "body": "Don&#39;t know if this is the reason for your problem, but you use <code>c</code> and variable in the <code>for</code>-loop and within that loop, you are modifying it&#39;s value (in the inner <code>While</code>). You never should do this (and it is forbidden in nearly all programming languages). Plus, you are not checking if <code>c</code> exceeds  <code>LastColumn</code> in the <code>While</code>-loop."}, {"owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554908890, "post_id": 55614657, "comment_id": 97925193, "body": "You&#39;re right! Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "edited": false, "score": 0, "creation_date": 1554908879, "post_id": 55615845, "comment_id": 97925182, "body": "Thank you sooo much! It worked, I hadn&#39;t thought about that, thanks guys!"}], "tags": [], "owner": {"reputation": 89, "user_id": 7531499, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vU67b0KGnac/AAAAAAAAAAI/AAAAAAAABNQ/2slhSUwA2rw/photo.jpg?sz=128", "display_name": "TGLIDE", "link": "https://stackoverflow.com/users/7531499/tglide"}, "is_accepted": true, "score": 0, "last_activity_date": 1554908713, "creation_date": 1554908713, "answer_id": 55615845, "question_id": 55614657, "link": "https://stackoverflow.com/questions/55614657/the-code-to-merge-adjacent-cells-using-vba-isnt-working-anymore-and-i-cant-see/55615845#55615845", "title": "The code to merge adjacent cells using VBA isn&#39;t working anymore and I can&#39;t seem to find the problem", "body": "<p>As stated in the comments, you are changing a variable that is used in <code>for</code> loop in another loop, and the variable may exceed last_column. Create a auxiliary variable for this end as follows:</p>\n\n<pre><code>Sub BPS_MergeCells()\n    Application.DisplayAlerts = False\n\n    Dim rng As Range\n    Dim LastColumn As Long\n    Dim ColumnsInRange As Long\n    Dim r As Long\n    Dim c As Long\n    Dim c_aux As Long\n\n    'Last Column Used\n    LastColumn = ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(3, Columns.Count).End(xlToLeft).Column\n\n    'Rows\n    For r = 3 To 4\n        'Columns\n        For c = 1 To LastColumn\n            c_aux = c\n            Do While c_aux &lt; LastColumn And ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(r, c_aux) = ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(r, c_aux + 1)\n                ColumnsInRange = ColumnsInRange + 1\n                c_aux = c_aux + 1\n            Loop\n\n            Set rng = Range(Cells(r, c), Cells(r, c_aux))\n            rng.Select\n            With Selection\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlBottom\n                .WrapText = False\n                .Orientation = 0\n                .AddIndent = False\n                .IndentLevel = 0\n                .ShrinkToFit = False\n                .ReadingOrder = xlContext\n                .MergeCells = False\n            End With\n            Selection.Merge\n            ColumnsInRange = 0\n        Next c\n    Next r\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 55615845, "answer_count": 1, "score": 1, "last_activity_date": 1554908713, "creation_date": 1554905304, "last_edit_date": 1554906607, "question_id": 55614657, "link": "https://stackoverflow.com/questions/55614657/the-code-to-merge-adjacent-cells-using-vba-isnt-working-anymore-and-i-cant-see", "title": "The code to merge adjacent cells using VBA isn&#39;t working anymore and I can&#39;t seem to find the problem", "body": "<p>I'm trying to figure out what's wrong with the code, but can't seem to find out. It's working fine with the other sheets, but with this one it's always implying there's an error, and the structure's exactly the same.</p>\n\n<p>The error \"Application-defined or object-defined error\" shows up at the <b>Do While</b> line of the code.</p>\n\n<p>It's working on the 3rd row, but not on the 4th</p>\n\n<p>Here's an image of the Sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xv7Qp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xv7Qp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know how to fix this error? Thanks in advance</p>\n\n<pre><code>Sub BPS_MergeCells()\n    Application.DisplayAlerts = False\n\n    Dim rng As Range\n    Dim LastColumn As Long\n    Dim ColumnsInRange As Long\n    Dim r As Long\n    Dim c As Long\n\n    'Last Column Used\n    LastColumn = ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(3, Columns.Count).End(xlToLeft).Column\n\n    'Rows\n    For r = 3 To 4\n        'Columns\n        For c = 1 To LastColumn\n            Do While ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(r, c) = ThisWorkbook.Sheets(\"Blast Pro Series\").Cells(r, c + 1)\n                ColumnsInRange = ColumnsInRange + 1\n                c = c + 1\n            Loop\n\n            Set rng = Range(Cells(r, c - ColumnsInRange), Cells(r, c))\n            rng.Select\n            With Selection\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlBottom\n                .WrapText = False\n                .Orientation = 0\n                .AddIndent = False\n                .IndentLevel = 0\n                .ShrinkToFit = False\n                .ReadingOrder = xlContext\n                .MergeCells = False\n            End With\n            Selection.Merge\n            ColumnsInRange = 0\n        Next c\n    Next r\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554905378, "post_id": 55614542, "comment_id": 97923043, "body": "You need a space after FROM in city.rowsource, and before &quot;Order by ProvinceID&quot;"}, {"owner": {"reputation": 1, "user_id": 10233784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6KPKvZBQKbI/AAAAAAAAAAI/AAAAAAAAAJ0/OqDdUXNyfNo/photo.jpg?sz=128", "display_name": "Shehzad Amir", "link": "https://stackoverflow.com/users/10233784/shehzad-amir"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554905570, "post_id": 55614542, "comment_id": 97923145, "body": "can u type that for me , i didnt understand"}, {"owner": {"reputation": 1, "user_id": 10233784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6KPKvZBQKbI/AAAAAAAAAAI/AAAAAAAAAJ0/OqDdUXNyfNo/photo.jpg?sz=128", "display_name": "Shehzad Amir", "link": "https://stackoverflow.com/users/10233784/shehzad-amir"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554905698, "post_id": 55614542, "comment_id": 97923221, "body": "But It highlights the Me.ProvinceId and says that method or member data not found"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1554907014, "post_id": 55614542, "comment_id": 97924021, "body": "Why do you have surrounding <code>&#39;</code>&#39;s here: <code>ProvinceID_AfterUpdate</code>? Please remove them. Did you try to compile the code (you find that in the <code>Debug</code> menu)?"}, {"owner": {"reputation": 1, "user_id": 10233784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6KPKvZBQKbI/AAAAAAAAAAI/AAAAAAAAAJ0/OqDdUXNyfNo/photo.jpg?sz=128", "display_name": "Shehzad Amir", "link": "https://stackoverflow.com/users/10233784/shehzad-amir"}, "edited": false, "score": 0, "creation_date": 1554915261, "post_id": 55614542, "comment_id": 97928685, "body": "Compiler is not working its non selectable option"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 10233784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6KPKvZBQKbI/AAAAAAAAAAI/AAAAAAAAAJ0/OqDdUXNyfNo/photo.jpg?sz=128", "display_name": "Shehzad Amir", "link": "https://stackoverflow.com/users/10233784/shehzad-amir"}, "edited": false, "score": 0, "creation_date": 1554916531, "post_id": 55615462, "comment_id": 97929316, "body": "Then a field name is either missing or misspelled. Double-check."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1554907539, "creation_date": 1554907539, "answer_id": 55615462, "question_id": 55614542, "link": "https://stackoverflow.com/questions/55614542/how-fix-the-error-arrising-method-or-data-member-not-found-in-ms-access-vba-co/55615462#55615462", "title": "how fix the error arrising &quot;Method or data member not found&quot; in Ms access VBA code 2007", "body": "<p>Try with:</p>\n\n<pre><code>Me.City.RowSource = \"SELECT CityName FROM City \" &amp; _\n    \"WHERE ProvinceID = \" &amp; Me.ProvinceID &amp; \" \" &amp; _\n    \"ORDER BY City\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10233784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6KPKvZBQKbI/AAAAAAAAAAI/AAAAAAAAAJ0/OqDdUXNyfNo/photo.jpg?sz=128", "display_name": "Shehzad Amir", "link": "https://stackoverflow.com/users/10233784/shehzad-amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1584650341, "creation_date": 1554904967, "last_edit_date": 1554905313, "question_id": 55614542, "link": "https://stackoverflow.com/questions/55614542/how-fix-the-error-arrising-method-or-data-member-not-found-in-ms-access-vba-co", "title": "how fix the error arrising &quot;Method or data member not found&quot; in Ms access VBA code 2007", "body": "<p>I m making a school Management system software on Access 2007, but while in combo box i had made a province list and next box city i had written the cities names, i m connecting them with vba code than province name is selected the related cities are shown in that such box,but i got an error of \"method or data member not found\"... </p>\n\n<p>I already tried to enable macros but issue didnt resolved</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub 'ProvinceID_AfterUpdate'()\nMe.City.RowSource = \"SELECT CityName FROM\" &amp; _\n        \" City WHERE ProvinceID = \" &amp; Me.ProvinceID &amp; _\n        \"Order BY ProvinceID\"\nMe.City = Me.City.ItemData(0)\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "dllregistration", "dynamics-sl"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1554916901, "post_id": 55614502, "comment_id": 97929500, "body": "The most basic reason is that you changed the DLL but forgot to remove and add back the changed .tlb in your VBA project.  Or just forgot to run Regasm again, one good reason to let VS do this automatically."}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1554917516, "post_id": 55614502, "comment_id": 97929807, "body": "@HansPassant, I have a cmd file that I created that regenerate the tbl file each time. I&#39;m pretty sure that I&#39;m running regasm unregister and register each time, since it never worked, I watch every step carefully. I just tried to check the Register for COM interop (after unregistered the other one) and I have the same result, only the late binding is working."}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1554922190, "post_id": 55614502, "comment_id": 97932034, "body": "@HansPassant, In the Process Monitor, I can see the writing of the class and the interface by the RegAsm (my actual code is the same as Freeflow). But when I look at my program, I see that it read the good class but it just don&#39;t read the interface. After that, there is a lot of stuff that is not found but nothing with clsid."}], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554909579, "post_id": 55615896, "comment_id": 97925630, "body": "I have the exacte same result. When using the reference, I got the error but the late binding is working same as before."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554912019, "post_id": 55615896, "comment_id": 97927000, "body": "@AlexDupuis: Could it be as simple as the fact that you are using MessBox rather than MsgBox? I added VBA code for the test that correctly returns POL on my machine. Please make sure you have Option Explicit as the first line in each of your module/classes."}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554915409, "post_id": 55615896, "comment_id": 97928768, "body": "Yes, I had the Option Explicit and the MessBox is something from the application that I use (Dynamics SL). To be sure, I copied both of you sources and paste it on my side, I even used Excel and I have the same result. Maybe it&#39;s something in my setup. I use VS2008, FW 3.5, compiling in Release x86."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554974302, "post_id": 55615896, "comment_id": 97949364, "body": "I&#39;m using VS2019Community, FW 4.5.  I suspect this might be the issue."}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554987301, "post_id": 55615896, "comment_id": 97957050, "body": "I will try to upgrade on a snapshot of this server to be sure that I&#39;m not braking anything ;)"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554991119, "post_id": 55615896, "comment_id": 97959784, "body": "You might find this link useful. <a href=\"https://bettersolutions.com/csharp/excel-interop/vba-calling-csharp-com-interop.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/csharp/excel-interop/&hellip;</a>   With VS2017 and 2019 there is no need to do the regasm seperately if all the correct boxes are ticked in the project properties dialog boxes."}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "edited": false, "score": 0, "creation_date": 1554995634, "post_id": 55615896, "comment_id": 97962931, "body": "I have access to VS2017 on an other system, I created the exact same project and copied the DLL to the VM, used RegAsm and it worked perfectly. Maybe something is wrong with 2008. I will check to install it on my VM."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1554910448, "last_edit_date": 1554910448, "creation_date": 1554908854, "answer_id": 55615896, "question_id": 55614502, "link": "https://stackoverflow.com/questions/55614502/how-can-i-fix-run-time-error-430-from-importing-custom-dll-in-vba-project/55615896#55615896", "title": "How can I fix Run-time error 430 from importing custom DLL in VBA project", "body": "<p>I think you need to define an interface to be able to see getcompany.</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\n\nnamespace PolygonSl\n{\n    [Guid(\"6DC1808F-81BA-4DE0-9F7C-42EA11621B7E\")]\n    [System.Runtime.InteropServices.ComVisible(true)]\n    [System.Runtime.InteropServices.InterfaceType(ComInterfaceType.InterfaceIsDual)]\n    public interface IConfig\n    {\n        string GetCompany();\n    }\n\n    [Guid(\"434C844C-9FA2-4EC6-AB75-45D3013D75BE\")]\n    [System.Runtime.InteropServices.ComVisible(true)]\n    [System.Runtime.InteropServices.ClassInterface(ClassInterfaceType.None)]\n    public class Config : IConfig\n    {\n        public string GetCompany()\n        {\n            return \"POL\";\n        }\n    }\n}\n</code></pre>\n\n<p>You can generate the interface automatically by placing the cursor in the class definition and using Edit.Refactor.ExtractInterface.  </p>\n\n<p>I'd have to admit that I'm at the absolute edge of my abilities here and the above is put together based on examples I've seen elsewhere. </p>\n\n<p>Edit</p>\n\n<p>The following test code works fine on my PC</p>\n\n<pre><code>Option Explicit\nSub polygontest()\n\n    Dim my_polygon As SOPolygon.Config\n    Set my_polygon = New SOPolygon.Config\n    Debug.Print my_polygon.GetCompany\n\nEnd Sub\n</code></pre>\n\n<p>Where SOPolygon is the project name.</p>\n"}], "owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55615896, "answer_count": 1, "score": 0, "last_activity_date": 1554916097, "creation_date": 1554904848, "last_edit_date": 1554916097, "question_id": 55614502, "link": "https://stackoverflow.com/questions/55614502/how-can-i-fix-run-time-error-430-from-importing-custom-dll-in-vba-project", "title": "How can I fix Run-time error 430 from importing custom DLL in VBA project", "body": "<p>I've struggle several hours on that and I can't find what I'm doing wrong. </p>\n\n<p>I created a new C# dll project, here is the content of the only class it contain:</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\n\nnamespace PolygonSl {\n\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    public class Config {\n\n        [ComVisible(true)]\n        public string GetCompany() {\n            return \"POL\";\n        }\n    }\n}\n</code></pre>\n\n<p>I basically remove everything from it trying to make it work, the only reference is <code>System</code>. </p>\n\n<p>I checked the <code>Make assembly COM-Visible</code> flag on the <code>Assembly Information</code> and my project is signed (seams required for codebase). </p>\n\n<p>It compiling fine, after that, I called <code>RegAsm.exe</code>, giving it my dll, I added <code>/codebase</code> and <code>/tlb</code>, the command is successful. </p>\n\n<p>When I go to my VBA project, I can add my new tlb file to the references, working fine. After, I can use it in my code, the autocomplete is working and I can compile with no errors.</p>\n\n<p>Then, when I execute, I got this:</p>\n\n<pre><code>Run-time error '430':\nClass does not support Automation or does not support expected interface\n</code></pre>\n\n<p>Here is my code sample in the VBA: </p>\n\n<pre><code>Private Sub Button1_Click()\n    'With CreateObject(\"PolygonSl.Config\")\n    With New PolygonSl.Config\n        MessBox .GetCompany, MB_OK, \"Test\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>I tried late binding and my code is running fine with it but I'd like to be able to use the autocomplete.</p>\n\n<p>Anyone have a suggestion on what I could try to make it work?</p>\n\n<p><strong>Edit (Adding some details on my environment)</strong></p>\n\n<ul>\n<li>I work on VS2008 for projects related to Dynamics SL (one of the Microsoft ERPs)</li>\n<li>I'm on Windows Server 2008 R8 Standard, running from VMWare</li>\n<li>Compiling on Framework 3.5, Release, x86, Dynamics SL client is 32 bits</li>\n<li>I tried my dll on Dynamics but also on Excel to be sure that the problem was not Dynamics ;)</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1559696409, "creation_date": 1559696409, "answer_id": 56453042, "question_id": 55614283, "link": "https://stackoverflow.com/questions/55614283/import-data-from-multiple-urls/56453042#56453042", "title": "Import data from multiple URLs", "body": "<p>What about doing it a different way.  Please try and feedback.</p>\n\n<pre><code>' XMLHTTP request:\n\nOption Explicit\nPublic Sub GetTable()\n    Dim sResponse As String, html As HTMLDocument, hTable As Object\n    Set html = New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://finviz.com/screener.ashx?v=152\", False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    With html\n        .body.innerHTML = sResponse\n        Set hTable = .getElementsByTagName(\"tbody\")(9)\n        WriteTable hTable, 1, ThisWorkbook.Worksheets(\"Sheet1\")\n    End With\nEnd Sub\n\nPublic Sub WriteTable(ByVal hTable As Object, Optional ByVal startRow As Long = 1, Optional ByVal ws As Worksheet)\n    If ws Is Nothing Then Set ws = ActiveSheet\n    Dim tRow As Object, tCell As Object, tr As Object, td As Object, r As Long, c As Long\n    r = startRow\n    With ws\n        Set tRow = hTable.getElementsByTagName(\"tr\")\n        For Each tr In tRow\n            r = r + 1: c = 1\n            Set tCell = tr.getElementsByTagName(\"td\")\n            For Each td In tCell\n                .Cells(r, c).Value = td.innerText\n                c = c + 1\n            Next td\n        Next tr\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8410500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d2c29bc3620c62c3c1c61c5720750fa?s=128&d=identicon&r=PG&f=1", "display_name": "Ocean8", "link": "https://stackoverflow.com/users/8410500/ocean8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559696409, "creation_date": 1554904228, "last_edit_date": 1554984124, "question_id": 55614283, "link": "https://stackoverflow.com/questions/55614283/import-data-from-multiple-urls", "title": "Import data from multiple URLs", "body": "<p>I'm trying to import data from several different URLs dynamically from a list on another worksheet. The code pasted below works to import one but need to loop through several different Urls. </p>\n\n<ul>\n<li>All the newly created tables(which are linked to different URLs should be created on the same sheet consecutively one after another. </li>\n</ul>\n\n<p>Anyone has any ideas on how to do that? or maybe an easier or better idea on how i can make this happen? </p>\n\n<p>Million Thanks &amp; kind regards to all</p>\n\n<pre><code>Sub test()\n'\n'\n    ActiveWorkbook.Queries.Add Name:=\"Table 2\", Formula:= _\n        \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://finviz.com/screener.ashx?f=sec_basicmaterials&amp;v=121\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data2 = Source{2}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Promoted Headers\"\" = Table.PromoteHeaders(Data2, [PromoteAllScalars=true]),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(#\"\"Promoted Headers\"\",{{\"\"No.\"\", Int64.Type}, {\"\"Ticker\"\", type text}, {\"\"Market Cap\"\", type te\" &amp; _\n        \"xt}, {\"\"P/E\"\", type text}, {\"\"Fwd P/E\"\", type text}, {\"\"PEG\"\", type text}, {\"\"P/S\"\", type text}, {\"\"P/B\"\", type text}, {\"\"P/C\"\", type text}, {\"\"P/FCF\"\", type text}, {\"\"EPS this Y\"\", type text}, {\"\"EPS next Y\"\", type text}, {\"\"EPS past 5Y\"\", type text}, {\"\"EPS next 5Y\"\", type text}, {\"\"Sales past 5Y\"\", type text}, {\"\"Price\"\", type number}, {\"\"Change\"\", Percentage.Typ\" &amp; _\n        \"e}, {\"\"Volume\"\", type text}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n    ActiveWorkbook.Worksheets.Add\n    ActiveSheet.Range(\"a10\").Select\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n        \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 2\"\";Extended Properties=\"\"\"\"\" _\n        , Destination:=Range(\"$A$1\")).QueryTable\n        .CommandType = xlCmdSql\n        .CommandText = Array(\"SELECT * FROM [Table 2]\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"Table_2\"\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 1, "creation_date": 1554904271, "post_id": 55614204, "comment_id": 97922354, "body": "What you trying to do? And what each formula does?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554904303, "post_id": 55614204, "comment_id": 97922377, "body": "Best way to work when dealings with large amounts of data is using arrays, always. For the code you gave I don&#39;t really know what do you want to achieve. But look up at arrays, dictionaries and so to speed up your performance. Also using <code>Application.ScreenUpdating = False</code> and <code>Application.Calculation = xlCalculationManual</code> are useful. Don&#39;t forget to turn them back at the end."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554905494, "post_id": 55614204, "comment_id": 97923104, "body": "DmitrijHolkin I think formulas are rather self explanatory. @Damian I have used that as well."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554905969, "post_id": 55614204, "comment_id": 97923411, "body": "What is not clear is how the two groups of codes relate.  Are you filling the same formulas 35 times?"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554910214, "post_id": 55614204, "comment_id": 97925972, "body": "Exactly right @ScottCraner and in effect it creates a massive table with 100 rows, which I have to overwrite with values. Also the reason I have 2 Unions is because the Union has a limited number of ranges that can be added to it."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1554916360, "post_id": 55614204, "comment_id": 97929232, "body": "It&#39;s still not clear to me (perhaps it is to scott) what you are doing with these unions. You define them here, but... then what. Does it take 15 minutes just to run these <code>Set Union</code> statements? What happens after these are set? Why add these cells that you are putting formulas in to the union. Where do you define these <code>r1a</code> named variables and why aren&#39;t you using those variables when setting your formulas? It&#39;s not at all clear what, overall, you are trying to do. All I see here are two unrelated chunks of code with little explanation of what they do or how they are related."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1554979988, "post_id": 55614204, "comment_id": 97952739, "body": "+Not referencing complete columns in all your sumifs formulas would speed up things as well"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1554985952, "post_id": 55614204, "comment_id": 97956209, "body": "Thanks @EvR I&#39;ll try that as well :)"}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "is_accepted": true, "score": 0, "last_activity_date": 1554979508, "last_edit_date": 1554979508, "creation_date": 1554976624, "answer_id": 55629708, "question_id": 55614204, "link": "https://stackoverflow.com/questions/55614204/anything-more-effcient-than-unions-or-union-of-a-union-please-advise/55629708#55629708", "title": "Anything more effcient than Unions or Union of a Union? Please advise", "body": "<p>Once I have restarted my computer it takes less than 3 mins lol. Sorry</p>\n\n<p>Panic is over </p>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1619071142, "accepted_answer_id": 55629708, "answer_count": 1, "score": -2, "last_activity_date": 1554979508, "creation_date": 1554904009, "last_edit_date": 1554932405, "question_id": 55614204, "link": "https://stackoverflow.com/questions/55614204/anything-more-effcient-than-unions-or-union-of-a-union-please-advise", "closed_reason": "Not suitable for this site", "title": "Anything more effcient than Unions or Union of a Union? Please advise", "body": "<p>I create 35 sets of the following formulas (also see the union part below):</p>\n\n<pre><code>Range(\"E7\").Formula = \"=COUNTIFS(Last100!$C:$C,E$2,Last100!$M:$M,'Data'!E$3,Last100!$A:$A,'Data'!$D7)\"\n\nRange(\"F7\").Formula = \"=COUNTIFS(Last100!$C:$C,E$2,Last100!$M:$M,'Data'!E$3,Last100!$H:$H,$D7)*-1\"\n\nRange(\"G7\").Formula = \"=COUNTIFS(Last100!$A:$A,\"\"&lt;=\"\"&amp;'Data'!$D7,Last100!$H:$H,\"\"&gt;\"\"&amp;'Data'!$D7,Last100!$C:$C,'Data'!E$2,Last100!$M:$M,'Data'!E$3)+COUNTIFS(Last100!$A:$A,\"\"&lt;=\"\"&amp;'Data'!$D7,Last100!$H:$H,\"\"=\"\"&amp;\"\"31/12/2000\"\",Last100!$C:$C,'Data'!E$2,Last100!$M:$M,'Data'!E$3)\"\n\nRange(\"H7\").Formula = \"=SUMIFS(Sierra_Alpha!$E:$E,Sierra_Alpha!$A:$A,'Data'!$D7,Sierra_Alpha!$B:$B,'Data'!E$2,Sierra_Alpha!$C:$C,'Data'!E$3)\" 'ok\n\nRange(\"I7\").Formula = \"=SUMIFS(Sierra_Alpha!$D:$D,Sierra_Alpha!$A:$A,'Data'!$D7,Sierra_Alpha!$B:$B,'Data'!E$2,Sierra_Alpha!$C:$C,'Data'!E$3)\" 'ok\n\nRange(\"J7\").Formula = \"=COUNTIFS(Last100!$C:$C,E$2,Last100!$M:$M,'Data'!J$3,Last100!$A:$A,'Data'!$D7)\" 'ok\n\nRange(\"K7\").Formula = \"=COUNTIFS(Last100!$C:$C,E$2,Last100!$M:$M,'Data'!J$3,Last100!$H:$H,$D7)*-1\"     'ok\n\nRange(\"L7\").Formula = \"=COUNTIFS(Last100!$A:$A,\"\"&lt;=\"\"&amp;'Data'!$D7,Last100!$H:$H,\"\"&gt;\"\"&amp;'Data'!$D7,Last100!$C:$C,'Data'!E$2,Last100!$M:$M,'Data'!J$3)+COUNTIFS(Last100!$A:$A,\"\"&lt;=\"\"&amp;'Data'!$D7,Last100!$H:$H,\"\"=\"\"&amp;\"\"31/12/2000\"\",Last100!$C:$C,'Data'!E$2,Last100!$M:$M,'Data'!J$3)\"\n\nRange(\"M7\").Formula = \"=SUMIFS(Sierra_Alpha!$E:$E,Sierra_Alpha!$A:$A,'Data'!$D7,Sierra_Alpha!$B:$B,'Data'!E$2,Sierra_Alpha!$C:$C,'Data'!J$3)\"\n\nRange(\"N7\").Formula = \"=SUMIFS(Sierra_Alpha!$D:$D,Sierra_Alpha!$A:$A,'Data'!$D7,Sierra_Alpha!$B:$B,'Data'!E$2,Sierra_Alpha!$C:$C,'Data'!J$3)\"\n</code></pre>\n\n<p>Imagine that formulas (as you can see) are aligned in a row Range=E7:N7\nNow, this range is copied into another 35 rXa's, thus e.g. formulas from r1a=E7:N7, are copied into r2a which covers another 10 columns and so on until r35a. Then I use autofill to fill in 100 rows. Then Excel calculates (and this bit takes approx 15 mins), after that I replace formulas with values. Thus I end up with a large table at the end. Thus, I need an advice on how to make it more efficient please. </p>\n\n<p><strong>Union part:</strong></p>\n\n<pre><code>Set raUnion = Union(r1a, r2a, r3a, r4a, r5a, r6a, r7a, r8a, r9a, r10a, r11a, r12a, r13a, r14a, r15a, r16a, r17a)\n\nSet raUnion2 = Union(r18a, r19a, r20a, r21a, r22a, r23a, r24a, r25a, r26a, r27a, r28a, r29a, r30a, r31a, r32a, r33a, r34a, r35a)\n\nSet raUnionOFUnions = Union(raUnion, raUnion2)\n\nSet UnionaR = Range(\"E7:MZ7\")\n</code></pre>\n\n<p>It takes approximately 15 minutes to run it. Can someone advise on a more efficient alternative please?</p>\n"}, {"tags": ["r", "excel", "vba", "excel-formula", "markov-chains"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8251916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785403a7bfe6ea2b43894bc0d98dd396?s=128&d=identicon&r=PG&f=1", "display_name": "Shastere", "link": "https://stackoverflow.com/users/8251916/shastere"}, "is_accepted": false, "score": 0, "last_activity_date": 1554914707, "last_edit_date": 1554914707, "creation_date": 1554910194, "answer_id": 55616331, "question_id": 55614141, "link": "https://stackoverflow.com/questions/55614141/i-have-a-r-formula-for-making-a-transition-probability-matrix-that-i-want-to-imp/55616331#55616331", "title": "I have a R formula for making a transition probability matrix that I want to implement in excel", "body": "<p>Assuming you have the following data in your excel sheet beginning at position <code>A1</code> for the <code>X</code> :</p>\n\n<blockquote>\n  <p>If you want to put the two tables at differents positions modify the following variables in the macro with the new positions : <code>startRowNumX, startColNumX, startRowNumP, startColNumP</code></p>\n  \n  <p>Note that the matix is fill with 0 and 1 because you didn't put data for an example in your post</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/wqx5b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wqx5b.png\" alt=\"enter image description here\"></a>\nHere a way to achieve what want you want to do with a macro :</p>\n\n<pre><code>Sub TransitonProbabilityMatrix()\n    Dim startRowNumX, startColNumX, startRowNumP, startColNumP, sizeMatrix As Integer\n    startRowNumX = 1\n    startColNumX = 1\n    startRowNumP = 3\n    startColNumP = 1\n\n    sizeMatrix = startColNumX\n    While (Not IsEmpty(Cells(startRowNumX, sizeMatrix)))\n        sizeMatrix = sizeMatrix + 1\n    Wend\n    sizeMatrix = sizeMatrix - startColNumX\n\n    For i = startColNumX + 1 To startColNumX + sizeMatrix - 2\n        Cells(Cells(startRowNumX, i) + startRowNumP, Cells(startRowNumX, i + 1) + startColNumP) = Cells(Cells(startRowNumX, i) + startRowNumP, Cells(startRowNumX, i + 1) + startColNumP) + 1\n    Next\n\n    For i = startRowNumP + 1 To startRowNumP + sizeMatrix - 1\n        For j = startColNumP + 1 To startColNumP + sizeMatrix - 1\n            Cells(i, j) = Cells(i, j) / WorksheetFunction.Sum(ActiveSheet.Range(Cells(i, startColNumP + 1), Cells(i, startColNumP + sizeMatrix)))\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>This Sub first search for the size of the matrix and after apply the transition.</p>\n"}], "owner": {"reputation": 1, "user_id": 10654960, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ2zwtPo50U/AAAAAAAAAAI/AAAAAAAADMM/hPmzhCmvJRw/photo.jpg?sz=128", "display_name": "Shivam Dave", "link": "https://stackoverflow.com/users/10654960/shivam-dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554914707, "creation_date": 1554903798, "last_edit_date": 1554909817, "question_id": 55614141, "link": "https://stackoverflow.com/questions/55614141/i-have-a-r-formula-for-making-a-transition-probability-matrix-that-i-want-to-imp", "title": "I have a R formula for making a transition probability matrix that I want to implement in excel", "body": "<p>I have this code to generate the transition probability matrix from a sequence repeating from 1 to 12 depicting sales.</p>\n\n<p>How can I implement this code in Excel using a formula</p>\n\n<p>I have no experience with VBA and I tried it in excel but failed</p>\n\n<pre><code>x &lt;- e$Range\np &lt;- matrix(nrow = 12, ncol = 12, 0)\nfor (t in 1:(length(x) - 1)) p[x[t], x[t + 1]] &lt;- p[x[t], x[t + 1]] + 1\nfor (i in 1:12) p[i, ] &lt;- p[i, ] / sum(p[i, ])\np\n</code></pre>\n\n<p>A transition probability of each value in each cell of those 12 values.</p>\n\n<p>Thank You in advance,\nRegards</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554905341, "post_id": 55612967, "comment_id": 97923021, "body": "It&#39;s not clear what you mean by &quot;but now I need dynamic tables&quot;. Do you mean the number of rows and/or columns may vary? Where&#39;s the data coming from and how what code would you use to &quot;read&quot; it?"}, {"owner": {"reputation": 26, "user_id": 11340375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-P8dMw3Cc8/AAAAAAAAAAI/AAAAAAAAAGM/sw1lPVQHUBU/photo.jpg?sz=128", "display_name": "Ionyx Arts", "link": "https://stackoverflow.com/users/11340375/ionyx-arts"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554905846, "post_id": 55612967, "comment_id": 97923326, "body": "I edited the main post for better understanding"}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 11340375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-P8dMw3Cc8/AAAAAAAAAAI/AAAAAAAAAGM/sw1lPVQHUBU/photo.jpg?sz=128", "display_name": "Ionyx Arts", "link": "https://stackoverflow.com/users/11340375/ionyx-arts"}, "edited": false, "score": 0, "creation_date": 1554903278, "post_id": 55613299, "comment_id": 97921725, "body": "When I try this I&#39;ll get &quot;RuntimeError 13&quot; I directly set &quot;BookMarkName&quot; as Bookmark and defined a Range as &quot;Table_Info&quot; (just for testing)"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 26, "user_id": 11340375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-P8dMw3Cc8/AAAAAAAAAAI/AAAAAAAAAGM/sw1lPVQHUBU/photo.jpg?sz=128", "display_name": "Ionyx Arts", "link": "https://stackoverflow.com/users/11340375/ionyx-arts"}, "edited": false, "score": 0, "creation_date": 1554903718, "post_id": 55613299, "comment_id": 97922005, "body": "It probably because you dont have template file in needed folder"}, {"owner": {"reputation": 26, "user_id": 11340375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-P8dMw3Cc8/AAAAAAAAAAI/AAAAAAAAAGM/sw1lPVQHUBU/photo.jpg?sz=128", "display_name": "Ionyx Arts", "link": "https://stackoverflow.com/users/11340375/ionyx-arts"}, "edited": false, "score": 0, "creation_date": 1554907806, "post_id": 55613299, "comment_id": 97924492, "body": "tried the new code, i will try tomorrow again, head is exploding for today :-) Thanks to all who tried to help - I am fine to publish the document here when it&#39;s finished."}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1554903695, "last_edit_date": 1554903695, "creation_date": 1554901411, "answer_id": 55613299, "question_id": 55612967, "link": "https://stackoverflow.com/questions/55612967/create-dynamic-table-in-worddocument-with-excel-vba-macro-depending-on-filled-li/55613299#55613299", "title": "Create dynamic Table in Worddocument with Excel VBA Macro depending on filled Lines", "body": "<p>First you need create bookmark by select whole table in template file and add Bookmark\n<a href=\"https://i.stack.imgur.com/3Zdy3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Zdy3.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub test()\n        Dim WA As Object, WD As Object\n        TempFolder = ThisWorkbook.path &amp; \"\\Temp\\\"\n        TemplateName = ThisWorkbook.path &amp; \"\\file.docx\"\n            Set WA = CreateObject(\"Word.Application\")\n                'WA.Visible = False\n            Set WD = WA.Documents.Add(TemplateName)\n                With WD\n                    If IsBM(WD, \"Table_Info\") Then ' Check if Bookmark Exist\n                        With .Bookmarks.Item(\"Table_Info\").range.Tables(1) ' Work on Table Bookmarked as Table_Info\n                            ColN = 1\n                            For RowN = 1 To 10\n                                .Rows(RowN).Cells(ColN).range.Text = \"Col= \" &amp; ColN &amp; \" Row= \" &amp; RowN '\"Column1RowN\"\n                                .Rows(RowN).Cells(ColN + 1).range.Text = \"Col= \" &amp; ColN &amp; \" Row= \" &amp; RowN '\"Column2RowN\"\n                                .Rows(RowN).Cells(ColN + 2).range.Text = \"Col= \" &amp; ColN &amp; \" Row= \" &amp; RowN '\"Column3RowN\"\n                            Next RowN\n                        End With\n                        .Bookmarks.Item(\"Table_Info\").Delete\n                    End If\n                End With\n            WD.SaveAs TempFolder &amp; \"1.docx\"\n            WD.Close False\n            Set WD = Nothing\n            WA.Quit False\n            Set WA = Nothing\n    End Sub\n\n\n    Function IsBM(ByVal WDs As Object, ByVal BookMarkName As String) As Boolean\n        On Error Resume Next\n            IsBM = WDs.Bookmarks.Exists(BookMarkName)\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 11340375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-P8dMw3Cc8/AAAAAAAAAAI/AAAAAAAAAGM/sw1lPVQHUBU/photo.jpg?sz=128", "display_name": "Ionyx Arts", "link": "https://stackoverflow.com/users/11340375/ionyx-arts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554905829, "creation_date": 1554900448, "last_edit_date": 1554905829, "question_id": 55612967, "link": "https://stackoverflow.com/questions/55612967/create-dynamic-table-in-worddocument-with-excel-vba-macro-depending-on-filled-li", "title": "Create dynamic Table in Worddocument with Excel VBA Macro depending on filled Lines", "body": "<p>I am building an Excel-Tool where you'll have an inputmask. After being done and clicking on \"Execute\" it will automatically create directories inclusive worddocuments from templates by predefined textmarkers.\nNow the Problem:</p>\n\n<p>In these templates are tables and I only want to give these tables as much lines as they really need and I am totally out of any idea how to solve that. Find the code for filling automatically below:</p>\n\n<pre><code>Public Function Txtmkr_SDD()\n\nDim appWord             As Object 'Word-Instance\nDim wdDoc               As Object 'Word-Document\nDim wdRngE              As Object 'Word-Range 1\nDim wdRngR              As Object 'Word-Range 2\nDim wdRngC              As Object 'Word-Range 3\nDim wdRngCN             As Object 'Word-Range 4\n\nDim wks                 As Worksheet 'Excel-Worksheet\nDim AdresseCE           As String\nDim neueAdresseCE       As Long\nDim Processname1        As String\nDim Processname2        As String\nDim Version             As String\n\nDim IDPath As String\nIf TB_ID.Value = vbNullString Then TB_ID = IDPath Else IDPath = (TB_ID.Value) &amp; Chr(32)\n\n\n'*** Word start ***\nSet appWord = CreateObject(\"Word.Application\")\n\n'*** opens File ***\nSet wdDoc = appWord.Documents.Add(Template:=Worksheets(\"StartPage\").Cells(48, 4) &amp; \"\\Document_Templates\\SDD_Template.dotx\", NewTemplate:=False, DocumentType:=0)\n\n'*** Word visible ***\nappWord.Visible = True\n\n'*** just in case Document is protected ***\n'doc.Unprotect\n\n'*** Jump to Textmarker in Word ***\n'*** Check of existence ***\n'*** Take Value from \"CopyData\" Cell \"B1\" and insert Textmarker ***\nIf wdDoc.Bookmarks.Exists(\"Processname1\") Then\n    With wdDoc.Bookmarks(\"Processname1\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(1, 2).Value\n        wdDoc.Bookmarks.Add \"Processname1\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Processname1].\"\nEnd If\n\n  '*** Take Value from \"CopyData\" Cell \"B2\" and insert Textmarker ***\nIf wdDoc.Bookmarks.Exists(\"Processname2\") Then\n    With wdDoc.Bookmarks(\"Processname2\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(2, 2).Value\n        wdDoc.Bookmarks.Add \"Processname2\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Processname2].\"\nEnd If\n\n\n  If wdDoc.Bookmarks.Exists(\"SDDVersion\") Then\n    With wdDoc.Bookmarks(\"SDDVersion\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(3, 2).Value\n        wdDoc.Bookmarks.Add \"SDDVersion\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Version].\"\nEnd If\n\n\n      If wdDoc.Bookmarks.Exists(\"Create_Date\") Then\n    With wdDoc.Bookmarks(\"Create_Date\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(4, 2).Value\n        wdDoc.Bookmarks.Add \"Create_Date\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Create_Date].\"\nEnd If\n\n\n          If wdDoc.Bookmarks.Exists(\"SDDAuthor\") Then\n    With wdDoc.Bookmarks(\"SDDAuthor\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(6, 2).Value\n        wdDoc.Bookmarks.Add \"SDDAuthor\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Author].\"\nEnd If\n\n\n\n\n          If wdDoc.Bookmarks.Exists(\"ProcessID\") Then\n    With wdDoc.Bookmarks(\"ProcessID\")\n        Set wdRngE = .Range\n        wdRngE.Text = Worksheets(\"CopyData\").Cells(20, 2).Value\n        wdDoc.Bookmarks.Add \"ProcessID\", wdRngE\n    End With\nElse\n    MsgBox \"Missing Link [Author].\"\nEnd If\n\n'*** Set Time_Date and SDD Path ***\n Dim time_date As String\n time_date = Format(Date, \"yyyy_mm_dd\")\n Dim SDD As String\n Dim shp As Shape\n\n'*** Define SDD as Filename ***\nSDD = (time_date &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(1, 2).Value &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(21, 2).Value &amp; \"_\" &amp; Worksheets(\"Helper#3\").Cells(3, 2).Value &amp; \"_\" &amp; \"V\" &amp; Worksheets(\"CopyData\").Cells(3, 2).Value &amp; \".docx\")\n\n'*** Dim wdApp As Word.Application ***\nSet wdApp = GetObject(, \"Word.Application\")\n'*** Set up SavePath &amp; Filename ***\nappWord.ActiveDocument.SaveAs Worksheets(\"Variables\").Cells(3, 8).Value &amp; \"\\\" &amp; IDPath &amp; (Worksheets(\"Setup#2_DirectoryList\").Cells(1, 1)) &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(3, 3).Value &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(14, 21).Value &amp; \"\\\" &amp; SDD\n\n'*** Updates the Footer in Word ans saves the file ***\nApplication.ScreenUpdating = True\nWith appWord.ActiveDocument\n    .Fields.Update\n    .PrintPreview\n    .ClosePrintPreview\n\nApplication.ScreenUpdating = True\nappWord.ActiveDocument.Save\n\n For Each shp In doc.Shapes\n    With shp.TextFrame\n        If .HasText Then\n            shp.TextFrame.TextRange.Fields.Update\n        End If\n    End With\n\nNext\n\nEnd With\n\n'*** Word quit ***\nappWord.ActiveDocument.Close\nappWord.Quit\n\n'*** set Variables free ***\nSet wdRngE = Nothing\nSet wdRngR = Nothing\nSet wdRngC = Nothing\nSet wdRngCN = Nothing\nSet wdRng = Nothing\nSet wdDoc = Nothing\nSet appWord = Nothing\nSet sFolder = Nothing  \nEnd Function\n</code></pre>\n\n<p>This one is working like it should, for normal textmarkers, but now I need dynamic tables, because even if the input gives maybe 20 lines for content - it hasn't to be filled completely in the final worddocument.</p>\n\n<p>Would be very nice if someone knows how to do that.</p>\n\n<p>Beside that: thx Harassed Dad for editing ;-)</p>\n\n<p>In order for further requests; this is what it looks like at the moment (the excel sheet where the macro is running)</p>\n\n<p><a href=\"https://i.stack.imgur.com/EzIJy.jpg\" rel=\"nofollow noreferrer\">Excel-Tool with Macro</a>\n<a href=\"https://i.stack.imgur.com/No2nH.jpg\" rel=\"nofollow noreferrer\">The Macro needs to give more rows if there are indeed 10 Credential-Entries, but there should also be only 3, 4 etc, so i am looking for a way to add them dynamically </a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554900853, "post_id": 55612952, "comment_id": 97920090, "body": "Break it down into tasks. Looks like you have to insert some columns, copy column A and then do some sorting."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554900882, "post_id": 55612952, "comment_id": 97920104, "body": "Iterating for every other column is easily achievable with a simple <code>For...Next</code> loop like <code>For i = 1 to 15 Step 2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 8837427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28adf64e63b4cd102d40eecefbee3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SamHarper", "link": "https://stackoverflow.com/users/8837427/samharper"}, "is_accepted": true, "score": 0, "last_activity_date": 1561622469, "creation_date": 1561622469, "answer_id": 56786549, "question_id": 55612952, "link": "https://stackoverflow.com/questions/55612952/copy-column-a-insert-for-every-other-column-then-sort/56786549#56786549", "title": "Copy Column A, insert for every other column, then sort", "body": "<p>In the end I actually followed Tims advice. I split this into 3 different scripts, one iterates by selecting a column, pasting and inserting. The next then sorts each column.</p>\n"}], "owner": {"reputation": 105, "user_id": 8837427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28adf64e63b4cd102d40eecefbee3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SamHarper", "link": "https://stackoverflow.com/users/8837427/samharper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56786549, "answer_count": 1, "score": 0, "last_activity_date": 1561622469, "creation_date": 1554900395, "last_edit_date": 1554984060, "question_id": 55612952, "link": "https://stackoverflow.com/questions/55612952/copy-column-a-insert-for-every-other-column-then-sort", "title": "Copy Column A, insert for every other column, then sort", "body": "<p>I need help creating VBA code that takes data, compies the date column (column A) inserts for every, then for every pair of columns, it sorts it.</p>\n\n<p>The data starts off like so </p>\n\n<pre><code>Date, A, B, C, ...\n01/02/2019, 100, 110, 120, ...\n02/02/2019, 101, 107, 124, ...\n03/02/2019, 102, 107, 123, ...\n04/02/2019, 101, 108, 123, ...\n</code></pre>\n\n<p>First it should insert the date as per</p>\n\n<pre><code>Date, A, Date, B, Date, C, ...\n01/02/2019, 100, 01/02/2019, 110, 01/02/2019, 120, ...\n02/02/2019, 101, 02/02/2019, 107, 02/02/2019, 124, ...\n03/02/2019, 102, 03/02/2019, 107, 03/02/2019, 123, ...\n04/02/2019, 101, 04/02/2019, 108, 04/02/2019, 123, ...\n</code></pre>\n\n<p>Then it should take columns in pairs, and sort by the second column i.e</p>\n\n<pre><code>Date,  A,  Date,  B,  Date,  C,  ...\n01/02/2019, 100,  02/02/2019, 107,  01/02/2019, 120,  ...\n02/02/2019, 101,  03/02/2019, 107,  03/02/2019, 123,  ...\n04/02/2019, 101,  04/02/2019, 108,  04/02/2019, 123,  ...\n03/02/2019, 102,  01/02/2019, 110,  02/02/2019, 124, ...\n</code></pre>\n\n<p>So far I have got code that finds the last column in a row, which returns the laast column as a string reference (e.g. \"GM\")</p>\n\n<pre><code>Function ColumnLetter() As String\n    Dim sht As Worksheet\n    Dim LastColumn As Long\n    Dim LastColumnStr, ColumnPaste As String\n    Dim p As Long\n\n    Set sht = ThisWorkbook.Worksheets(\"srtData\")\n\n    LastColumn = sht.Range(\"A1\").CurrentRegion.Columns.Count\n\n    Dim n As Long\n    Dim c As Byte\n    Dim s As String\n\n    n = LastColumn\n    Do\n        c = ((n - 1) Mod 26)\n        s = Chr(c + 65) &amp; s\n        n = (n - c) \\ 26\n    Loop While n &gt; 0\n    ColumnLetter = s\nEnd Function\n</code></pre>\n\n<p>However I have no idea, how to iterate and then sort by second column. Ideallly I just want to have a function such as \n<code>Function sortallData(dim wsTest as String)</code> where I can just call the function by inputting the sheet name.</p>\n"}, {"tags": ["excel", "vba", "osisoft"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554900933, "post_id": 55612936, "comment_id": 97920147, "body": "You should probably post more code. Which line errors?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1554900955, "post_id": 55612936, "comment_id": 97920160, "body": "Which line has the error, and what does the error say?  Where have you defined <code>vals0</code>?  Is it 0-based or 1-based? (i.e. <code>vals0(0 to 99)</code> or <code>vals0(1 to 100)</code> - look up the <code>ubound</code> and <code>lbound</code> functions)  Is it 1-dimentional or more? (e.g. <code>vals0(1 to 100)``vals0(1 to 100, 1 to 2)</code>)"}, {"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "edited": false, "score": 0, "creation_date": 1554900986, "post_id": 55612936, "comment_id": 97920176, "body": "I have it commented out now, but &quot;If Vals0(looop0) &lt;&gt; 0 Then&quot; gives me a type mismatch error, it is Vals0(1 to 30)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554901399, "post_id": 55612936, "comment_id": 97920437, "body": "What is <code>vals0(looop0)</code> at the moment where you get the runtime error? Strange naming convention you have, btw..."}, {"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "edited": false, "score": 0, "creation_date": 1554901482, "post_id": 55612936, "comment_id": 97920480, "body": "Its a double. like 18.747474382282 or something. 13 decimals I think. Naming convention necessary, I have a bunch of these structures 0 through 9 indicating equipment names."}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 1, "creation_date": 1554901771, "post_id": 55612936, "comment_id": 97920703, "body": "When you find yourself appending a numerical suffix to a variable to separate it from others of the same type but similar function, it&#39;s usually a sign that you should be using arrays or some other structure."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554901793, "post_id": 55612936, "comment_id": 97920719, "body": "A double wouldn&#39;t throw an type mismatch. Must be something different."}, {"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "edited": false, "score": 0, "creation_date": 1554901937, "post_id": 55612936, "comment_id": 97920825, "body": "probably, Ive only been coding for a month so I don&#39;t know the &quot;right&quot; way to do anything."}, {"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554902079, "post_id": 55612936, "comment_id": 97920917, "body": "@FunThomas It Says Variant/Double, then when I go into the array in the local window, the double value is listed as vals0(1)(1) =18.2738746824382 and it is placed into the cell in the same way, as you can see in the code above. it just errors when I try to compare it to 0"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1554903368, "post_id": 55612936, "comment_id": 97921789, "body": "If the local window is showing two indices for values in <code>vals0</code>, then that means that <code>vals0</code> is a 2-dimensional array, and the comparison to zero is being done with an array, not a number."}, {"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "edited": false, "score": 0, "creation_date": 1554903524, "post_id": 55612936, "comment_id": 97921899, "body": "When I use Vals0(looops0,1), the debug says that Vals0 is a single dimensional array. It is also declared as a single dimensional array. Regardless, How can I get the array value to compare to 0?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "edited": false, "score": 0, "creation_date": 1554904442, "post_id": 55614172, "comment_id": 97922455, "body": "Thanks, I am really new at this so I apologize for my incorrect use of terminology. I appreciate you helping me solve this issue. The piadvcalcval is a black box situation so I don&#39;t know that it will always be an array."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1554904282, "last_edit_date": 1554904282, "creation_date": 1554903915, "answer_id": 55614172, "question_id": 55612936, "link": "https://stackoverflow.com/questions/55612936/how-to-use-an-if-then-condition-on-a-variant-double-array-value/55614172#55614172", "title": "How to use an If/then condition on a Variant/double array value?", "body": "<p>You wrote <em>\"It Says Variant/Double, then when I go into the array in the local window, the double value is listed as vals0(1)(1) =18.2738746824382\"</em>. So, obviously <code>vals0(1)</code> is not a double, it is an array of double.</p>\n\n<p>Unfortunately you don't tell us anything about <code>PIAdvCalcVal</code>. <code>vals0</code> is declared as (one-dimensional) array with 30(?) element of type <code>Variant</code>. That means you have 30 variants. Every variant can hold <em>anything</em>, a double, a string, an object, or also an <em>Array</em> of anything. The latter seems to be the case, <code>PIAdvCalcVal</code> returned an array of double values (even if the array holds maybe only one value).</p>\n\n<p>So first things first: Put a statement <code>Debug.Print looop0, VarType(vals0(looop0))</code> after your <code>Run</code>-statement. Have a look to <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/user-interface-help/vartype-function\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/Language/Reference/user-interface-help/vartype-function</a> to get an idea about the numbers representing a vartype. If the vartype is something > 8192, you have an array of something, and that would explain the <em>Type mismatch</em> error - you cannot compare an array with a number.</p>\n\n<p>If <code>PIAdvCalcVal</code> always returns an array, the solution could be to simply write <code>If Vals0(looop0)(1) &lt;&gt; 0</code> (note that <code>Vals0(looop0, 1)</code> will not work as <code>Vals0</code> is not a 2-dimensional array).</p>\n\n<p>A more robust solution could be </p>\n\n<pre><code>Var x\nIf IsArray(Vals0(looop0)) Then\n    x = Vals0(looop0)(1)\nElse\n    x = Vals0(looop0)\nEnd If\nIf x &lt;&gt; 0 Then\n...\n</code></pre>\n\n<p>Finally, you have to check how large the returned array is (check <code>LBound</code> and <code>UBound</code>). What would you do if it contains more than one value?</p>\n"}], "owner": {"reputation": 3, "user_id": 11313433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fSj9M4tT6RE/AAAAAAAAAAI/AAAAAAAAAEE/YIhU-SbubVQ/photo.jpg?sz=128", "display_name": "Steven Vitale", "link": "https://stackoverflow.com/users/11313433/steven-vitale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55614172, "answer_count": 1, "score": -1, "last_activity_date": 1554904282, "creation_date": 1554900359, "last_edit_date": 1554904052, "question_id": 55612936, "link": "https://stackoverflow.com/questions/55612936/how-to-use-an-if-then-condition-on-a-variant-double-array-value", "title": "How to use an If/then condition on a Variant/double array value?", "body": "<p>I am trying to look at each value of the array generated by my function, and place it in a cell if the value is &lt;> 0, but I always get a type mismatch error at that stage. The code will place a value inside the cells as it is written, but I want to scrub the 0 values from the set and replace with \"-\". </p>\n\n<p>Vals0(1 to 30)</p>\n\n<pre><code>Do While (Now - 1) &gt; fdate0\n    looop0 = 1\n    Start = DateAdd(\"n\", 450, PT.Range(\"P2\").Value)\n    Endd = DateAdd(\"d\", 1, Start)\n    E0.Cells((counter0), 1).Value = fdate0\n\n    For looop0 = 1 To 30\n\n        vals0(looop0) = Application.Run(\"PIAdvCalcVal\", E0Tags(looop0), Start, Endd, \"average (time-weighted)\", \"time-weighted\", \"0\", \"1\", \"0\")\n\n       ' If Vals0(looop0) &lt;&gt; 0 Then\n            E0.Cells(counter0, (looop0 + 1)).Value = vals0(looop0)\n        'Else\n         '   E0.Cells(counter0, (looop0 + 1)).Value = \"-\"\n        'End If\n\n    Next looop0\n\n\n    counter0 = counter0 + 1\n    PT.Range(\"P2\").Value = (PT.Range(\"P2\").Value + 1)\n    fdate0 = PT.Range(\"P2\").Value\n\nLoop\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bOCqs.png\" rel=\"nofollow noreferrer\">Here is the locals window for a few iterations of the for loop</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1554968723, "post_id": 55618219, "comment_id": 97946228, "body": "thank you your idea of removing duplicates is an excellent one. I did not use your code though."}], "tags": [], "owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "is_accepted": true, "score": 1, "last_activity_date": 1554963450, "last_edit_date": 1554963450, "creation_date": 1554917062, "answer_id": 55618219, "question_id": 55612798, "link": "https://stackoverflow.com/questions/55612798/how-to-filter-data-in-one-column-then-obtain-a-value-in-another-column-that-is-l/55618219#55618219", "title": "How to filter data in one column then obtain a value in another column that is linked to filtered the data", "body": "<p>Although I would say the simplest way to go about this is using a <strong>Pivot Table</strong>, below is the solution to your code if you need a solution using VBA.</p>\n\n<p>You can use RemoveDuplicates function after copying the data to Sheet2 to keep only unique values like below.</p>\n\n<p>I haven't checked if this works yet, but from what I can see it should.</p>\n\n<pre><code>Dim lastCode As Long, lastFiltCode As Long\n\n'Determine Last Row in Column U (Unfiltered Codes)\n With Worksheets(\"Database\") lastCode = .Range(\"U\" &amp; .Rows.Count).(xlUp).Row\n\n'Filter Unique Codes into Column A Sheet2\n.Range(\"U2:U\" &amp; lastCode).AdvancedFilter Action:=xlFilterCopy, _\n        CopyToRange:=Worksheets(\"Sheet2\").Range(\"A1\"), Unique:=True\nEnd With\n'Use Header:=xlNo below is Sheet2 doesn't have header\nWorksheets(\"Sheet2\").Range(\"A1:A100\").RemoveDuplicates Columns:=Array(1), Header:=xlYes\nEnd Sub\n</code></pre>\n\n<p>Please Change the <strong>Range(\"A1:A100\")</strong> above to your respective range in Sheet2.</p>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 55618219, "answer_count": 1, "score": 0, "last_activity_date": 1554984051, "creation_date": 1554899956, "last_edit_date": 1554984051, "question_id": 55612798, "link": "https://stackoverflow.com/questions/55612798/how-to-filter-data-in-one-column-then-obtain-a-value-in-another-column-that-is-l", "title": "How to filter data in one column then obtain a value in another column that is linked to filtered the data", "body": "<p>I have a database of +- 15000 lines. In column U there are model codes that I need to filter. In column H I have a list of unique asset numbers. Multiple models each with a unique asset number. So I need one of the unique asset numbers in Column H for each filtered model code which is then copied and pasted in Column A Sheet2 I am able to filter with the code below but how do I obtain the one unique value in Column H?</p>\n\n<pre><code>Sub SumGroups()\n    Dim lastCode As Long, lastFiltCode As Long\n\n    'Determine Last Row in Column U (Unfiltered Codes)\n     With Worksheets(\"Database\") lastCode = .Range(\"U\" &amp; .Rows.Count).(xlUp).Row\n\n    'Filter Unique Codes into Column A Sheet2\n    .Range(\"U2:U\" &amp; lastCode).AdvancedFilter Action:=xlFilterCopy, _\n            CopyToRange:=Worksheets(\"Sheet2\").Range(\"A1\"), Unique:=True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1554897858, "post_id": 55612099, "comment_id": 97918279, "body": "You can&#39;t make your code override it. It would make the macro security pointless if you could."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554897907, "post_id": 55612099, "comment_id": 97918311, "body": "What If I then open your Excel file in OpenOffice or Google docs?  You cant protect the content of the workbook this way at all, you need a rethink."}, {"owner": {"reputation": 35, "user_id": 7404374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3CXlHtAFL08/AAAAAAAAAAI/AAAAAAAAAIM/pbyEzWyYV9c/photo.jpg?sz=128", "display_name": "Souvik Hazra", "link": "https://stackoverflow.com/users/7404374/souvik-hazra"}, "edited": false, "score": 0, "creation_date": 1554898324, "post_id": 55612099, "comment_id": 97918538, "body": "Alex, OpenOffice or Google docs are not available in my office environment so I don&#39;t have to worry about that. but if I want to restrict access to the file what method would that be? the file is stored in a shared path"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1554898389, "post_id": 55612099, "comment_id": 97918583, "body": "Set user level permissions on the shared path?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1554898743, "post_id": 55612099, "comment_id": 97918789, "body": "You could protect your sheets or make them non-visible. Then protect your code. This way no one should be able to get into your editor to make it visible"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1554898961, "post_id": 55612099, "comment_id": 97918929, "body": "You could have the macro documents be signed wuth a digital signature and have only trusted macros enabled (rather than all macros enabled). Of course this may require some input from your workplace IT/security team (or whoever would make that decision)."}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 2, "last_activity_date": 1554900348, "creation_date": 1554900348, "answer_id": 55612931, "question_id": 55612099, "link": "https://stackoverflow.com/questions/55612099/how-to-enable-macro-setting-in-trust-center-with-a-code/55612931#55612931", "title": "How to enable macro setting in trust center with a code", "body": "<p>Create a Worksheet which has a \"User not Authorised\" message on it.</p>\n\n<p>In the <code>Workbook_BeforeSave</code> event, you make this Worksheet Visible, and make <strong>all</strong> other Sheets Very Hidden</p>\n\n<p>In the <code>Workbook_AfterSave</code> and <code>Workbook_Open</code> events, you check if the user is Authorised.  If so, then you make the normal Worksheets Visible, and make the \"User not Authorised\" Worksheet Very Hidden.</p>\n\n<p>Make sure that your VBA Project is Protected.  Then, if a User opens the Workbook with Macros Disabled, all that they will be able to see is the \"User not Authorised\" message.  (You can also add a line such as \"If you believe that you are receiving this message in error, please ensure that Macros are Enabled for this Workbook\")</p>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 2, "last_activity_date": 1554984073, "last_edit_date": 1554984073, "creation_date": 1554901094, "answer_id": 55613175, "question_id": 55612099, "link": "https://stackoverflow.com/questions/55612099/how-to-enable-macro-setting-in-trust-center-with-a-code/55613175#55613175", "title": "How to enable macro setting in trust center with a code", "body": "<p>Have one introductory worksheet (let's call it \"Macros\") with a message that macros must be enabled in order to continue. Make this worksheet visible, and all the others Very Hidden.</p>\n\n<p>In the ThisWorkbook module, include the following two subs:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call MacrosOK ' Will only be called if macros are indeed OK.\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ' Ensures that the macro sheet is always set to the default view when the workbook is saved\n    Application.ScreenUpdating = False\n    Sheets(\"Macros\").Visible = True ' Make the macro warning sheet visible\n    Dim sht As Worksheet\n    Application.ScreenUpdating = False\n    For Each sht In ThisWorkbook.Worksheets\n        If Not sht.Name = \"Macros\" Then sht.Visible = xlVeryHidden ' Hide all other sheets\n    Next sht\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Then in a regular module:</p>\n\n<pre><code>Sub MacrosOK()\n    ' Called on open, or otherwise when macros are enabled\n    Dim sht As Worksheet\n    Application.ScreenUpdating = False\n    For Each sht In ThisWorkbook.Worksheets\n        sht.Visible = xlSheetVisible ' Make all sheets visible\n    Next sht\n    Sheets(\"Macros\").Visible = xlVeryHidden ' Hide your macro check sheet\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>You might want to include a button on the Macro worksheet, labelled \"Proceed\" (or some such) which is linked to the MacrosOK sub, to enable to user to manually proceed if it does not automatically fire.</p>\n"}], "owner": {"reputation": 35, "user_id": 7404374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3CXlHtAFL08/AAAAAAAAAAI/AAAAAAAAAIM/pbyEzWyYV9c/photo.jpg?sz=128", "display_name": "Souvik Hazra", "link": "https://stackoverflow.com/users/7404374/souvik-hazra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554984073, "creation_date": 1554897736, "last_edit_date": 1554984025, "question_id": 55612099, "link": "https://stackoverflow.com/questions/55612099/how-to-enable-macro-setting-in-trust-center-with-a-code", "title": "How to enable macro setting in trust center with a code", "body": "<p>I have a macro in workbook open option to check whether the user is authorized to access the file. However, if the macro setting in trust center for the user is disabled with notification (which is the default setting), he can access the file. What do I need to do to force enable the code to execute irrespective of the macro setting? Once closed, I want the setting to reset to default.</p>\n\n<p>I could not found any good solution apart from enabling macro setting for every user.</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554898270, "post_id": 55612032, "comment_id": 97918508, "body": "Please post all your code correctly, so it can be read."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554898421, "post_id": 55612032, "comment_id": 97918607, "body": "do you actually need the <code>=</code> in your criteria?"}, {"owner": {"reputation": 11, "user_id": 11340147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaaecfb9b91af45e5effd0388727f7db?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/11340147/coder"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554899019, "post_id": 55612032, "comment_id": 97918977, "body": "I have edited it.Now it has started throwing type mismatch error ."}, {"owner": {"reputation": 11, "user_id": 11340147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaaecfb9b91af45e5effd0388727f7db?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/11340147/coder"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554960380, "post_id": 55612032, "comment_id": 97942668, "body": "Hi , Thank you so much for the help . It is now throwing Application or object defined error . Please help."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1554913920, "creation_date": 1554913920, "answer_id": 55617370, "question_id": 55612032, "link": "https://stackoverflow.com/questions/55612032/copy-multiple-sheets-in-a-workbook-to-a-summary-sheet-based-on-autofilter-criter/55617370#55617370", "title": "Copy multiple sheets in a workbook to a summary sheet based on autofilter criteria", "body": "<p>This is basic code does what you are trying to accomplish.</p>\n\n<pre><code>Sub CopyDataWithoutHeaders()\n    Dim ws As Worksheet, DestSh As Worksheet, Rng As Range\n    Set DestSh = ThisWorkbook.Sheets(\"Sheet16\")\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    For Each ws In ThisWorkbook.Sheets\n        If ws.Name &lt;&gt; \"Format\" And ws.Name &lt;&gt; \"Lookups\" And ws.Name &lt;&gt; DestSh.Name Then\n\n            'the below line will not select the complete range if a cell is empty in column 1\n            'it can be changed to the way you want.\n            Set Rng = ws.Range(\"A1\", ws.Range(\"A1\").End(xlDown).End(xlToRight))\n\n            With Rng 'will copy all the range except the header row  \n                .AutoFilter Field:=22, Criteria1:=\"Ready to import\", Operator:=xlAnd\n                .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy\n            End With\n\n                'test if the first cell is empty before pasting \n                If DestSh.Range(\"A1\") = \"\" Then\n                    DestSh.Cells(Rows.Count, \"A\").End(xlUp).PasteSpecial xlPasteValues\n\n                Else: DestSh.Cells(Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n                End If\n        End If\n\n        'clean up each worksheet\n        ws.AutoFilterMode = False\n        Application.CutCopyMode = False\n    Next ws\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554983437, "post_id": 55631236, "comment_id": 97954716, "body": "If you are providing an answer to your own question, you might want to identify how the issue was solved., so others reviewing your question can learn."}, {"owner": {"reputation": 11, "user_id": 11340147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaaecfb9b91af45e5effd0388727f7db?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/11340147/coder"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554984073, "post_id": 55631236, "comment_id": 97955059, "body": "The range was not picking up any value in the definition . the issue was resolved using an if condition that is highlighted within asterix."}], "tags": [], "owner": {"reputation": 11, "user_id": 11340147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaaecfb9b91af45e5effd0388727f7db?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/11340147/coder"}, "is_accepted": false, "score": 0, "last_activity_date": 1554981404, "creation_date": 1554981404, "answer_id": 55631236, "question_id": 55612032, "link": "https://stackoverflow.com/questions/55612032/copy-multiple-sheets-in-a-workbook-to-a-summary-sheet-based-on-autofilter-criter/55631236#55631236", "title": "Copy multiple sheets in a workbook to a summary sheet based on autofilter criteria", "body": "<p>Thank you for the help </p>\n\n<p>Issue Solved </p>\n\n<p>Sub CopyDataWithoutHeaders()</p>\n\n<pre><code>Dim ws As Worksheet, DestSh As Worksheet, Rng As Range\n\nSet DestSh = ThisWorkbook.Sheets(\"All\")\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nFor Each ws In ThisWorkbook.Sheets\n\n     If ws.Name &lt;&gt; \"Format\" And ws.Name &lt;&gt; \"Lookups\" And ws.Name &lt;&gt; DestSh.Name Then\n\n        Set Rng = ws.UsedRange\n\n        With Rng 'will copy all the range except the header row\n\n           .AutoFilter Field:=22, Criteria1:=\"Ready to import\", Operator:=xlAnd\n\n           ***If (ws.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1)*** Then\n\n            .Offset(1, 0).Resize(Rng.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy\n            DestSh.Cells(Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n\n           End If\n\n        End With\n\n    End If\n\n    'clean up each worksheet\n    ws.AutoFilterMode = False\n    Application.CutCopyMode = False\nNext ws\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Function LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function</p>\n"}], "owner": {"reputation": 11, "user_id": 11340147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaaecfb9b91af45e5effd0388727f7db?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/11340147/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1565341315, "creation_date": 1554897552, "last_edit_date": 1565341315, "question_id": 55612032, "link": "https://stackoverflow.com/questions/55612032/copy-multiple-sheets-in-a-workbook-to-a-summary-sheet-based-on-autofilter-criter", "title": "Copy multiple sheets in a workbook to a summary sheet based on autofilter criteria", "body": "<p>I have a code that is not working in copying data from multiple sheets into a single one based on autofilter criteria.</p>\n\n<p>I have this code and it is copying the data from different sheets but on applying autofilter condition it stops working </p>\n\n<pre><code>Sub CopyDataWithoutHeaders()\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim shLast As Long\nDim CopyRng As Range\nDim StartRow As Long\nDim WSNew As Worksheet\nDim MyRange As Range\nDim my_range As Range\nDim Rng As Range\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n'Add a worksheet\n'Set DestSh = ActiveWorkbook.Worksheets.Add\n\nSet DestSh = ActiveWorkbook.Worksheets(\"Sheet16\")\n'DestSh.Name = \"Destination\"\n\n'Fill in the start row\nStartRow = 2\n\n'loop through all worksheets and copy the data to the DestSh\nFor Each sh In ActiveWorkbook.Worksheets\n    If IsError(Application.Match(sh.Name, _\n        Array(DestSh.Name, \"Format\", \"Lookups\"), 0)) And sh.Visible = True Then\n        'Find the last row with data on the DestSh and sh\n        Last = LastRow(DestSh)\n        shLast = LastRow(sh)\n        MsgBox sh.Name\n\n        Set my_range = Range(\"A1:ZZ\" &amp; LastRow(ActiveSheet))\n        my_range.Parent.Select\n\n        'If sh is not empty and if the last row &gt;= StartRow copy the CopyRng\n        If shLast &gt;= StartRow Then\n\n            my_range.Parent.AutoFilterMode = False\n            ActiveSheet.Range(\"A1\").AutoFilter Field:=22, Criteria1:=\"=Ready to import\"\n            'ActiveSheet.AutoFilter.Range.Offset(1, 0).Rows.SpecialCells(xlCellTypeVisible).Copy\n\n            With my_range.Parent.AutoFilter.Range\n\n                Set Rng = .Offset(1, 0).Resize(.Rows.Count, .Columns.Count) _\n                    .SpecialCells(xlCellTypeVisible)\n\n                    MsgBox my_range\n\n                    If Not Rng Is Nothing Then\n                        'Copy and paste the cells into DestSh below the existing data\n                        Rng.Copy\n\n                        With DestSh.Range(\"A\" &amp; LastRow(DestSh) + 1)\n                            .PasteSpecial Paste:=8\n                            .PasteSpecial xlPasteValues\n                            .PasteSpecial xlPasteFormats\n                             Application.CutCopyMode = False\n                         End With\n                     End If\n\n'            Intersect(.UsedRange, .UsedRange.Offset(1)).SpecialCells(xlCellTypeVisible).Copy\n'            DestSh.Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues  \n\n                    MsgBox Last\n\n'        With DestSh.Cells(Last + 1, \"A\")\n'        .PasteSpecial Paste:=8\n'            .PasteSpecial xlPasteValues\n'            .PasteSpecial xlPasteFormats\n'             Application.CutCopyMode = False\n'            .Select\n'        End With\n ' End If\n\n                    'Close AutoFilter\n                    my_range.Parent.AutoFilterMode = False\n\n                    'Set the range that you want to copy\n\n                    ' Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n\n                    'Test if there enough rows in the DestSh to copy all the data\n'                If Last + MyRange.Rows.Count &gt; DestSh.Rows.Count Then\n'                   MsgBox \"There are not enough rows in the Destsh\"\n'                    GoTo ExitTheSub\n'                End If\n\n                'This example copies values/formats, if you only want to copy the\n                'values or want to copy everything look below example 1 on this page\n'                CopyRng.Copy\n'                With DestSh.Cells(Last + 1, \"A\")\n'                    .PasteSpecial xlPasteValues\n'                    .PasteSpecial xlPasteFormats\n'                    Application.CutCopyMode = False\n            End With\n\n        End If\n\n        'End If\n\n'ExitTheSub:\n'\n'    Application.Goto DestSh.Cells(1)\n'\n'    'AutoFit the column width in the DestSh sheet\n'    DestSh.Columns.AutoFit\n'\n'    With Application\n'        .ScreenUpdating = True\n'        .EnableEvents = True\n   'End With\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nFunction LastCol(sh As Worksheet)\n    On Error Resume Next\n    LastCol = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>The sheets should be copied one below another if they match the criteria.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554897538, "post_id": 55611956, "comment_id": 97918074, "body": "You are asking for a VBA code, so it needs to be put on the workbook you are creating. What do you need to retrieve the value on the clicked cell for? If it is for a later procedure, you can retrieve it for something else, but you still need code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1554897576, "post_id": 55611956, "comment_id": 97918099, "body": "<a href=\"https://www.extendoffice.com/documents/excel/4354-excel-click-on-cell-to-run-macro.html#a1\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554897740, "post_id": 55611956, "comment_id": 97918194, "body": "It is possible to have a worksheet_change even that refers to a workbook other than the workbook with the code. This would, however, require the code to know what the newly made wb is. You&#39;ll have to have a second WB open that holds the code"}, {"owner": {"reputation": 17, "user_id": 9988351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XjPMfQsqHDw/AAAAAAAAAAI/AAAAAAAAAIg/TG-xXymZXD4/photo.jpg?sz=128", "display_name": "mor diop", "link": "https://stackoverflow.com/users/9988351/mor-diop"}, "edited": false, "score": 0, "creation_date": 1554897974, "post_id": 55611956, "comment_id": 97918355, "body": "it is at the launch of my macro that my sheet is created so I can&#39;t insert a code while my sheet doesn&#39;t yet exist. I&#39;ve already seen your link but I want it to be generic my function so that it doesn&#39;t get inserted with each creation of the sheet"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554898004, "post_id": 55611956, "comment_id": 97918367, "body": "@mordiop so is it a new WS or a new WB you are creating each time?"}, {"owner": {"reputation": 17, "user_id": 9988351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XjPMfQsqHDw/AAAAAAAAAAI/AAAAAAAAAIg/TG-xXymZXD4/photo.jpg?sz=128", "display_name": "mor diop", "link": "https://stackoverflow.com/users/9988351/mor-diop"}, "edited": false, "score": 0, "creation_date": 1554898429, "post_id": 55611956, "comment_id": 97918613, "body": "I create a new sheet in my wb as indicated in my example &quot;sheet.add&quot;.the test method creates a new sheet every time I use it"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9988351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XjPMfQsqHDw/AAAAAAAAAAI/AAAAAAAAAIg/TG-xXymZXD4/photo.jpg?sz=128", "display_name": "mor diop", "link": "https://stackoverflow.com/users/9988351/mor-diop"}, "edited": false, "score": 0, "creation_date": 1554904030, "post_id": 55612837, "comment_id": 97922204, "body": "I took your code and it works. But here each cell change triggers the method and I want it to be only on column B. If I click on a cell in column B it will start . Thank you. Thank you."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 17, "user_id": 9988351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XjPMfQsqHDw/AAAAAAAAAAI/AAAAAAAAAIg/TG-xXymZXD4/photo.jpg?sz=128", "display_name": "mor diop", "link": "https://stackoverflow.com/users/9988351/mor-diop"}, "edited": false, "score": 0, "creation_date": 1554904622, "post_id": 55612837, "comment_id": 97922577, "body": "I have added a code with which you can specify a range @mordiop"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 1, "last_activity_date": 1554906823, "last_edit_date": 1554906823, "creation_date": 1554900091, "answer_id": 55612837, "question_id": 55611956, "link": "https://stackoverflow.com/questions/55611956/event-click-cell/55612837#55612837", "title": "Event click cell", "body": "<p>A <code>Worksheet_SelectionChange</code> event does not necessarily have to reside in a sheet-specific module. It could also for example reside in a <code>class module</code>, and important for this instance, the ThisWorkbook module (although there it is named a <code>Workbook_SheetSelectionChange</code>event).</p>\n\n<p><strong>If you always want to fire the Workbook_SheetSelectionChange event, regardless of \nin what sheet the selection changed, try the following</strong></p>\n\n<pre><code>'place in the ThisWorkbook module\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\n'Do stuff\n\nMsgBox \"Changes were made in worksheet: \" &amp; Sh.Name, vbInformation\n\nEnd Sub\n</code></pre>\n\n<p><strong>If you only want to fire the event on the latest made WS</strong></p>\n\n<p><strong>1)</strong> You could make sure the latest made WS is always the last in the WB</p>\n\n<pre><code>'In a regular module\nSub addnwsheet()\nDim shtname As String\n\nWith ThisWorkbook\n\nshtname = \"temp\" &amp; .Sheets.Count\n'add a sheet at the end\n.Sheets.Add(after:=.Sheets(.Sheets.Count)).Name = shtname\n\nEnd With\n\nEnd Sub\n\n'place in the ThisWorkbook module\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\nIf Sh.Index = ThisWorkbook.Sheets.Count Then\n    'Do stuff\n\n    MsgBox \"Selection changed in worksheet: \" &amp; Sh.Name, vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>2)</strong> A more secure method is to declare the newly made sheet as a <code>Global</code> variable. These are persistent and public.</p>\n\n<pre><code>'In a regular module\nGlobal nwsht As Sheet\n\nSub addnwsheet()\nDim shtname As String\n\nWith ThisWorkbook\n\n    shtname = \"temp\" &amp; .Sheets.Count\n    'add a sheet at the end\n    .Sheets.Add(after:=.Sheets(.Sheets.Count)).Name = shtname\n    Set nwsht = .Sheets(shtname)\n\nEnd With\n\nEnd Sub\n\n'place in the ThisWorkbook module\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\nIf Sh = nwsht Then\n    'Do stuff\n\n    MsgBox \"Selection changed in worksheet: \" &amp; Sh.Name, vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you want to specify the range the event should trigger on</p>\n\n<pre><code>'place in the ThisWorkbook module\n    Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim r as Range\n    Set r = Workbooks(REF).Sheets(REF).Range(\"D2:D100\") 'event will only get triggered by this range\n\n    If Not Intersect(Target, r) Is Nothing Then\n        'Do stuff\n\n        MsgBox \"Selection changed in worksheet: \" &amp; Sh.Name, vbInformation\n    End If\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9988351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XjPMfQsqHDw/AAAAAAAAAAI/AAAAAAAAAIg/TG-xXymZXD4/photo.jpg?sz=128", "display_name": "mor diop", "link": "https://stackoverflow.com/users/9988351/mor-diop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55612837, "answer_count": 1, "score": 1, "last_activity_date": 1554984021, "creation_date": 1554897314, "last_edit_date": 1554984021, "question_id": 55611956, "link": "https://stackoverflow.com/questions/55611956/event-click-cell", "title": "Event click cell", "body": "<p>I just created a new file and I put data (line A1 to A10) and I would like to know how to get the data from the cell each time you click on a cell A if it is not empty (example: when I click on the third line of column A so I can have its value).\nI saw the \"Worksheet_SelectionChange\" method but it can't work with my example because we have to open the file code and put the function in it and I want to do it directly when creating the file.\nIt's my example</p>\n\n<pre><code>sub test(name as string)\n  sheet.add\n\n  ActiveSheet.name=name\n  i=2\n\n  while i &lt; 10 \n    cells(i,1)=i\n    i=i+i\n  Wend\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1554897032, "post_id": 55611798, "comment_id": 97917763, "body": "Please read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554897187, "post_id": 55611798, "comment_id": 97917846, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39121960/copy-filtered-data-to-another-sheet-using-vba\">Copy filtered data to another sheet using VBA</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554897382, "post_id": 55611798, "comment_id": 97917978, "body": "You are doing a lot of <code>Select</code> (which @TimStack reply should cover) but no where are you specifying which workbook you want to work with (i.e. <code>Sheets(&quot;Sheet1&quot;).Activate</code>.. this could be your <code>customerWorkbook</code> workbook or the one you are opening). Try to be specific on which workbook you want to refer to. Also, have a look at <code>With</code> statement"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1554898068, "post_id": 55611798, "comment_id": 97918399, "body": "Sheets(&quot;Sheet1&quot;).Activate is the one i&#39;m opening."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554898379, "post_id": 55611798, "comment_id": 97918576, "body": "@MaziluIsabelaElena you don&#39;t understand, that is only the sheet you are specifying. A sheet with name &quot;Sheet1&quot; could be present in any workbook. You will have to specify the WB as well, e.g. by <code>Workbooks(customerFilename).Sheets(&quot;Sheet1&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 9645078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-emWc2ejN_jY/AAAAAAAAAAI/AAAAAAAAAAQ/IVSPvlzLXzY/photo.jpg?sz=128", "display_name": "Mohit Chauhan", "link": "https://stackoverflow.com/users/9645078/mohit-chauhan"}, "is_accepted": true, "score": 0, "last_activity_date": 1554898908, "creation_date": 1554898908, "answer_id": 55612447, "question_id": 55611798, "link": "https://stackoverflow.com/questions/55611798/filter-and-copy-data-from-one-sheet-to-another/55612447#55612447", "title": "Filter and copy data from one sheet to another", "body": "<p>You Just need to add Selection.SpecialCells(xlCellTypeVisible).Copy instead of Selection.Copy in your code.</p>\n"}], "owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 55612447, "answer_count": 1, "score": 0, "last_activity_date": 1554898908, "creation_date": 1554896838, "last_edit_date": 1554898563, "question_id": 55611798, "link": "https://stackoverflow.com/questions/55611798/filter-and-copy-data-from-one-sheet-to-another", "title": "Filter and copy data from one sheet to another", "body": "<p>I have a problem filtering the date from the first sheet of a workbook and then copying everything in another workbook. In the first part of my code, I'm selecting the workbook I want to work with. When I'm running my code it just copies all the data, without filtering it and i don't know what it's wrong about it.</p>\n\n<pre><code>Sub macro()\n\nDim customerBook As Workbook\nDim filter As String\nDim caption As String\nDim customerFilename As String\nDim customerWorkbook As Workbook\nDim targetWorkbook As Workbook\nDim LastRow As Long\n\n' make weak assumption that active workbook is the target\nSet targetWorkbook = Application.ActiveWorkbook\n\n' get the customer workbook\nfilter = \"Text files (*.xlsx),*.xlsx\"\ncaption = \"Please select an input file \"\ncustomerFilename = Application.GetOpenFilename(filter, , caption)\n\nSet customerWorkbook = Application.Workbooks.Open(customerFilename)\n\n    Sheets(\"Sheet1\").Activate\n\n    LastRow = Range(\"A1\").CurrentRegion.Rows.Count\n    Range(\"A1:CA\" &amp; LastRow).Select\n\n    Selection.AutoFilter Field:=39, Criteria1:=Array( _\n        \"0\", \"1\", \"2\", \"3\"), Operator:=xlFilterValues\n\n    Selection.AutoFilter Field:=12, Criteria1:=\"&gt;=1/1/2018\", _\n                        Operator:=xlFilterValues, _\n                        Criteria2:=\"&lt;=12/31/2019\"\n    Selection.Copy\n    Cells.Select\n\n    Dim dest As Range\n    With Workbooks(\"data.xlsm\").Worksheets(3)\n\n    Sheets(\"data\").Range(\"A:CA\").ClearContents\n\n    Set dest = .Range(\"A1\")\n    Selection.Copy dest\n    End With\n    Selection.AutoFilter\n' Close customer workbook\ncustomerWorkbook.Close False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "cmd"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554896792, "post_id": 55611690, "comment_id": 97917610, "body": "What do you have thus far?"}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554899589, "post_id": 55611690, "comment_id": 97919301, "body": "I&#39;ll edit what i tried so far to the original question"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1554899494, "post_id": 55612040, "comment_id": 97919246, "body": "it says File not found,   Call Shell(&quot;C:\\Program Files(x86)\\MacroRecorder\\MacroRecorder.exe &#39;E:\\test.mcr&#39; /a&quot;)"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1554897569, "creation_date": 1554897569, "answer_id": 55612040, "question_id": 55611690, "link": "https://stackoverflow.com/questions/55611690/vba-execute-exe-command-line-with-2-parameters/55612040#55612040", "title": "vba execute exe command line with 2 parameters", "body": "<pre><code>Shell \"C:\\Program Files (x86)\\MacroRecorder\\MacroRecorder.exe 'E:\\test.mcr' /a\"\n</code></pre>\n\n<p>Note speech marks and quotes</p>\n"}], "owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554899878, "creation_date": 1554896502, "last_edit_date": 1554899878, "question_id": 55611690, "link": "https://stackoverflow.com/questions/55611690/vba-execute-exe-command-line-with-2-parameters", "title": "vba execute exe command line with 2 parameters", "body": "<p>I want to run an exe file from VBA with 2 parameters.\nTo be more specific here is the exact line that works for me in command line (Win+R), I just need it in VBA:</p>\n\n<p>C:\\Program Files (x86)\\MacroRecorder\\MacroRecorder.exe \"E:\\test.mcr\" /a</p>\n\n<p>I tried so far:</p>\n\n<pre><code>Sub open_test_file()\n\nCall Shell(\"C:\\Program Files(x86)\\MacroRecorder\\MacroRecorder.exe 'E:\\test.mcr' /a\")\n\nEnd Sub\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code>Public Sub StartExeWithArgument()\n    Dim strProgramName As String\n    Dim strArgument As String\n    Dim strArgument2 As String\n\n    strProgramName = \"C:\\Program Files (x86)\\MacroRecorder\\MacroRecorder.exe\"\n    strArgument = \"E:\\test.mcr\"\n    strArgument2 = \" /a\"\n\n    Call Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; strArgument2 &amp; \"\"\"\", vbNormalFocus)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "ms-office"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9171788"}, "edited": false, "score": 3, "creation_date": 1554896316, "post_id": 55611491, "comment_id": 97917331, "body": "Outlook fires an event when a mail gets sent. <a href=\"https://stackoverflow.com/questions/17569372/how-to-call-a-macro-on-send-button-click\">How to call a macro on send button click?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "edited": false, "score": 0, "creation_date": 1554974918, "post_id": 55617462, "comment_id": 97949731, "body": "Thank you, I will try it rn"}, {"owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "edited": false, "score": 0, "creation_date": 1554975823, "post_id": 55617462, "comment_id": 97950305, "body": "I have copied the example code from this site into my outlook vba just to have a start, but nothing is happening when i write an email? :("}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "edited": false, "score": 0, "creation_date": 1555006102, "post_id": 55617462, "comment_id": 97968399, "body": "You really needs to start a new thread and post the relevant snippets of your code."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1554914325, "creation_date": 1554914325, "answer_id": 55617462, "question_id": 55611491, "link": "https://stackoverflow.com/questions/55611491/pop-up-every-time-after-sending-an-email/55617462#55617462", "title": "Pop-Up every time after sending an email", "body": "<p>Use the <code>Application.ItemSend</code> event - the message being sent will be passed to your event handler. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.itemsend\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/outlook.application.itemsend</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11037433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216309804290724/picture?type=large", "display_name": "Marie", "link": "https://stackoverflow.com/users/11037433/marie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1565606743, "answer_count": 1, "score": -2, "last_activity_date": 1592609888, "creation_date": 1554895886, "last_edit_date": 1592609888, "question_id": 55611491, "link": "https://stackoverflow.com/questions/55611491/pop-up-every-time-after-sending-an-email", "closed_reason": "Duplicate", "title": "Pop-Up every time after sending an email", "body": "<p>I would like to get a pop-up window, every time I send an email. In this window, I need to write down an ID and an amount of time that shall be saved in excel document.</p>\n\n<p>I have never ever worked in Outlook VBA so I have actually no idea how to start :(</p>\n\n<p>In the end, every time I click on send email, there should a pop-up appear where I enter the Id and the time I was working on it and the data should be saved in excel.</p>\n\n<p>Thanks to everyone that understands what I mean and maybe can help me a little bit...</p>\n"}, {"tags": ["excel", "vba", "readonly", "save-as"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1554896512, "post_id": 55611450, "comment_id": 97917438, "body": "You need to verify that the popup from VBA that lets you select a folder is the actual folder the file is saved in. Can you show us the code?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1554896941, "post_id": 55611450, "comment_id": 97917710, "body": "Change the attribute of the file to <code>ReadWrite</code> before attempting to save it"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554900742, "post_id": 55611450, "comment_id": 97920023, "body": "Why do you have <code>If workbook_Name = False</code>  Are you testing to see if the <code>workbook_Name</code> exists?"}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554901499, "post_id": 55611450, "comment_id": 97920494, "body": "I copied the save as script from a different question here at stackoverflow or any other excel/vba site for the save as vba script."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1554902705, "post_id": 55611450, "comment_id": 97921303, "body": "As @Zac mentioned you will need to set the read only attribute to to <code>vbNormal</code> when the workbook is opened then when you close the workbook you will need <code>wb.Close True</code> (<code>wb</code> is however you set the Workbook Object) then set the read only attribute back to <code>vbReadOnly</code>"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554905464, "post_id": 55613831, "comment_id": 97923090, "body": "This might be the right solution. It has to been done when the file is already opened or is being opened. I will implement above code in my save as script."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554907984, "post_id": 55613831, "comment_id": 97924610, "body": "my complete code is quiet large (I will not paste it here completely). But do I have to paste all the code at &#39;run code here&#39; section of the above? And is this instead of my save as code?"}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554909259, "post_id": 55613831, "comment_id": 97925420, "body": "me too, I saw I have the save as code integrated into the main macro. I pasted the main macro in my answer. But your/answer post above makes clear for me what I should test."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554915974, "post_id": 55613831, "comment_id": 97929043, "body": "if it works please accept the answer, so if others come across this they will be able to see it."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554968103, "post_id": 55613831, "comment_id": 97945901, "body": "tested the method. I now get the error: 1004: Method Changefileacces of object_workbook failed (free translation of dutch error message)."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1554970791, "post_id": 55613831, "comment_id": 97947333, "body": "changed the script to: If ActiveWorkbook.ReadOnly = True Then ActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite to test is fileacces is already readonly on opening. after that, the script works. except for that now the original filename is not shown anymore in the save as pop up screen, but saving the file while it was originally opened as read-only is succesfull. Now I still have to find a way to get the originale workbookname in the save as popup screen again. Will add the code to my question."}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1554908444, "last_edit_date": 1554908444, "creation_date": 1554902946, "answer_id": 55613831, "question_id": 55611450, "link": "https://stackoverflow.com/questions/55611450/read-only-opened-excel-file-saved-with-vba-but-is-not-saved-at-all/55613831#55613831", "title": "Read only opened excel file saved with VBA but is not saved at all?", "body": "<p>One other solution you can try is this, which is what Zac was talking about.  It will change the access of the active workbook so you can run your code then change it back to read only.</p>\n\n<pre><code>Sub saveas()\nDim workbook_Name As Variant\nDim location As String\nDim workbookdirectory As String\nDim activewb As String\n    ActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite     \n\n         activewb = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 5)\n\n         workbookdirectory = \"M:\\Commercie\\Marktdata\\IRi\\Segment Ontwikkeling\\\"\n\n         workbook_Name = Application.GetSaveAsFilename(fileFilter:=\"Excel binary sheet (*.xlsb), *.xlsb\", InitialFileName:=workbookdirectory &amp; activewb)\n\n         If workbook_Name = False Then ActiveWorkbook.saveas Filename:=activewb, FileFormat:=50\n\n    ActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1377, "favorite_count": 0, "accepted_answer_id": 55613831, "answer_count": 1, "score": 0, "last_activity_date": 1554971599, "creation_date": 1554895723, "last_edit_date": 1554971599, "question_id": 55611450, "link": "https://stackoverflow.com/questions/55611450/read-only-opened-excel-file-saved-with-vba-but-is-not-saved-at-all", "title": "Read only opened excel file saved with VBA but is not saved at all?", "body": "<p>I have an excel template which is recommended to open as read-only on opening to users (I have the password to open file to be able to change/edit the file).\nI have a vba script which saves the read-only opened file.</p>\n\n<p>When I save the file the normal way (menu > save as > choose file > save) excel returns a message telling me the file cannot saved because it is opened as read-only.</p>\n\n<p>When I use the script, a popup shows me the desired directory with the proper filename, and saving is possible (so opened as read-only, it still can be saved with the same filename). No errors at all.</p>\n\n<p>But when I look in the directory now, most of the files I have updated and saved do not have an updated 'last edited date/time'. And when I open the file, all changes I have made are not in the file anymore.</p>\n\n<p>Is it possible that VBA says it has saved the file with the same filename, although the file was opened as read-only, but in fact did not save anything?</p>\n\n<p>here is the save-as code:</p>\n\n<pre><code>Sub vernieuwalles(mytemplate As String)\nDim workbook_Name As Variant\n\n  Windows(mytemplate).Activate\n\n  On Error GoTo Err_\n\n  MsgBox (\"Bezig met vernieuwen\")\n\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n\n'  Call SheetOpschonen\n\n  Call datawissen\n  Call dataplaatsen\n  Call kolomtitels\n  Call toevoegen\n  Call maaktabel\n  Call refreshpivots\n\nworkbook_Name = Application.GetSaveAsFilename(fileFilter:=\"Excel binary sheet (*.xlsb), *.xlsb\", InitialFileName:=\"M:\\Commercie\\Marktdata\\IRi\\Segment ontwikkeling\\\")\n\nMsgBox workbook_Name\n\nIf workbook_Name &lt;&gt; False Then\n\n    ActiveWorkbook.SaveAs Filename:=workbook_Name, FileFormat:=50\n\nEnd If\n\nExit_:\n  Application.StatusBar = \"\"\n  Application.ScreenUpdating = True\n  Application.Calculation = xlCalculationAutomatic\n  Exit Sub\n\nErr_:\n  Call MsgBox(Err.Number &amp; vbCrLf &amp; Err.Description)\n  Resume Exit_\n\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>it seems to work, but as I found out, it does not work when the file is opened as read-only, although I looks like the file is saved and can overwrite the original file while being opened as read-only.</p>\n\n<p><strong>update 2019-04-11 10:00 AM:</strong> </p>\n\n<p>with the suggestion from ZACK I adjusted my save as code to:</p>\n\n<pre><code>Sub vernieuwalles(mytemplate As String)\nDim workbook_Name As Variant\n\n  Windows(mytemplate).Activate\n\n  On Error GoTo Err_\n\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n\n'  Call SheetOpschonen\n\n  Call datawissen\n  Call dataplaatsen\n  Call kolomtitels\n  Call toevoegen\n  Call maaktabel\n  Call refreshpivots\n\nIf ActiveWorkbook.ReadOnly = True Then ActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite\n\nworkbook_Name = Application.GetSaveAsFilename(fileFilter:=\"Excel binary sheet (*.xlsb), *.xlsb\", InitialFileName:=\"M:\\Commercie\\Marktdata\\IRi\\Segment ontwikkeling\\\")\n\nIf workbook_Name &lt;&gt; False Then ActiveWorkbook.SaveAs Filename:=workbook_Name, FileFormat:=50\n\n\nActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly\n\nExit_:\n  Application.StatusBar = \"\"\n  Application.ScreenUpdating = True\n  Application.Calculation = xlCalculationAutomatic\n  Exit Sub\n\nErr_:\n  Call MsgBox(Err.Number &amp; vbCrLf &amp; Err.Description)\n  Resume Exit_\n\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>opening a read-only file and saving it while overwriting the original read-only file works. Except for that I know have to enter the filename again. While if before uses the original filename, there is no filename shown in the save as popup screen anymore. </p>\n\n<p><a href=\"https://postimg.cc/KKMPM548\" rel=\"nofollow noreferrer\"><img src=\"https://i.postimg.cc/zfd04trK/save-as-popup.png\" alt=\"save-as-popup.png\"></a></p>\n\n<p><strong>update 2 2019-04-11 10:31 AM:</strong></p>\n\n<p>I had some additional \"save as code\" for getting the right filename which I used before (was in the original post). I added this code to my main macro and tested if it works. Now the file access is changed correctly, the save as popup shows the correct filename in the right directory and the file is saved. </p>\n\n<p><strong>Conclusion:</strong> case closed, question answered!</p>\n\n<p>Here is how it works (for me):</p>\n\n<pre><code>Sub vernieuwalles(mytemplate As String)\nDim workbook_Name As Variant\nDim workbookdirectory As String\nDim activewb As String\n\n  Windows(mytemplate).Activate\n\n  On Error GoTo Err_\n\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n\n'  Call SheetOpschonen\n\n  Call datawissen\n  Call dataplaatsen\n  Call kolomtitels\n  Call toevoegen\n  Call maaktabel\n  Call refreshpivots\n\nIf ActiveWorkbook.ReadOnly = True Then ActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite\n\nactivewb = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 5)\n\nworkbookdirectory = \"M:\\Commercie\\Marktdata\\IRi\\Segment Ontwikkeling\\\"\n\nworkbook_Name = Application.GetSaveAsFilename(fileFilter:=\"Excel binary sheet (*.xlsb), *.xlsb\", InitialFileName:=workbookdirectory &amp; activewb)\n\nIf workbook_Name &lt;&gt; False Then ActiveWorkbook.SaveAs Filename:=workbook_Name, FileFormat:=50\n\nActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly\n\nExit_:\n  Application.StatusBar = \"\"\n  Application.ScreenUpdating = True\n  Application.Calculation = xlCalculationAutomatic\n  Exit Sub\n\nErr_:\n  Call MsgBox(Err.Number &amp; vbCrLf &amp; Err.Description)\n  Resume Exit_\n\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1554896753, "post_id": 55611259, "comment_id": 97917585, "body": "I&#39;d recommend you to start with no filter at all. Do you get emails displayed then? If not then the error is not in the filters. If you get hits, add a filter at a time until you find the error."}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1554900646, "post_id": 55611259, "comment_id": 97919955, "body": "hi peakpeak. but the filter is essential in this case. there are no errors. it is just returning anything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1554904570, "post_id": 55611259, "comment_id": 97922547, "body": "That is my point. Do you get <b>any</b> return <i>without</i> the filters?"}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1554908520, "post_id": 55611259, "comment_id": 97924953, "body": "i am not actually sure how it will display anything without the filters as the loop for &quot;olmail.display&quot; is reliant on the filters &quot;for each olmail in mytasks&quot; ... if it adds anything, the code structure is actually derived from another macro that works, the only difference is that the original macro takes the categories and a search string and takes into account the days that passed by from present date."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1555196917, "post_id": 55611259, "comment_id": 98027518, "body": "The suggested debugging step from peakpeak is to comment out the two restrict statements and see if you get results with <code>Set myTasks = Fldr.Items</code>. This will give an indication whether the earlier part of the code does what you think it does."}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1555504675, "post_id": 55611259, "comment_id": 98134258, "body": "ok i removed the set mytasks and without the restrict filters, it displayed all contents in the shared mailbox until outlook crashed due to running out of memory. so i decided to add the first filter, which is to display all emails with a certain category, it works. i decided to remove this filter and add the date filter but for some reason it is not displaying anything. i think the filter for date is not working here, must be the date format syntax? thanks in advance."}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1555504922, "post_id": 55611259, "comment_id": 98134434, "body": "by the way, the format in the outlook client is mm/dd/yyyy. i tried Format(Date, &quot;mm/dd/yyyy&quot;) but still did not work."}, {"owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "edited": false, "score": 0, "creation_date": 1555506026, "post_id": 55611259, "comment_id": 98135128, "body": "ok i got to make it work now by using the syntax for the date as &quot;Set myTasks = myTasks.Restrict(&quot;[ReceivedTime] &gt;= &#39;&quot; &amp; Format(dateString, &quot;ddddd h:nn AMPM&quot;) &amp; &quot;&#39;&quot;)&quot; only issue now is this does not work if i removed the &quot;&gt;&quot;. is there a way to edit this so that the &quot;=&quot; would suffice?"}], "owner": {"reputation": 181, "user_id": 4493496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GkQQzvIXyWA/AAAAAAAAAAI/AAAAAAAAACU/hazo3g_MLfU/photo.jpg?sz=128", "display_name": "wh3resmycar2", "link": "https://stackoverflow.com/users/4493496/wh3resmycar2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984016, "creation_date": 1554895124, "last_edit_date": 1554984016, "question_id": 55611259, "link": "https://stackoverflow.com/questions/55611259/excel-vba-search-outlook-with-category-and-date-parameters", "title": "Excel VBA: Search outlook with Category and Date parameters", "body": "<p>I am trying to create a Macro that can efficiently search a Shared Mailbox in outlook with my desired category and date the email was received.</p>\n\n<p>txtCat will be the category </p>\n\n<p>txtDate is where I will input the date in this format : \"mm/dd/yyyy\"</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<pre><code>Dim outlookapp\nDim olns As Outlook.Namespace\nDim Fldr As Outlook.MAPIFolder\nDim olMail As Object\nDim myTasks\nDim myrecipient As Outlook.Recipient\nDim dateString As Long\nDim strfilter As String\nSet outlookapp = CreateObject(\"Outlook.Application\")\nSet olns = outlookapp.GetNamespace(\"MAPI\")\nSet myrecipient = olns.CreateRecipient(\"Cmaintenancesupport2\")\nmyrecipient.Resolve\nDim strCat As String\n\n'txtCat is the category\n'txtDate is the date\nSet Fldr = olns.GetSharedDefaultFolder(myrecipient, olFolderInbox)\n\nstrCat = UserForm1.txtCat.Text\n\nstrfilter = \"[Categories] = \"\"\" &amp; strCat &amp; \"\"\"\"\n\n\ndateString = CDate(UserForm1.txtDate.Text)\n\nSet myTasks = Fldr.Items.Restrict(strfilter) 'filters the desired category in the SharedDefault Mailbox\n\n\nSet myTasks = myTasks.Restrict(\"[ReceivedTime] = '\" &amp; Format(dateString, \"DDDDD HH:NN\") &amp; \"'\") 'adds another filter by date\n\n\nFor Each olMail In myTasks\n\nolMail.Display\n\nNext\n\n\n\nEnd Sub\n</code></pre>\n\n<p>i set mytasks twice as I am just restructuring this code from a previous project that works (categorized email > filter by days > search subject line) but somehow it is not showing me any results.</p>\n\n<p>What should happen here is after the category filter, it should all already categorized email with the desired date.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1554911874, "post_id": 55610561, "comment_id": 97926927, "body": "That won&#39;t do you any good - you know the event listener works when Items.ItemAdd event fires. And if it doesn&#39;t, ItemAdd won&#39;t fire anyway."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1554926435, "post_id": 55610561, "comment_id": 97933899, "body": "@DmitryStreblechenko well I don\u2019t know that as I\u2019m new to Outlook VBA \ud83d\ude00 but I know that it stops working and I know that restarting Outlook appears to get it working again, so I\u2019m wondering how to keep it working when all my searching has revealed this to be a known issue with no solution.  Hopefully the solution posted as an answer will do the trick."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1555030614, "post_id": 55610561, "comment_id": 97976123, "body": "Run a code every half an hour <a href=\"https://stackoverflow.com/questions/12257985/outlook-vba-run-a-code-every-half-an-hour\" title=\"outlook vba run a code every half an hour\">stackoverflow.com/questions/12257985/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1554926621, "post_id": 55610793, "comment_id": 97933964, "body": "I don&#39;t see how this can work - if ItemAdd event fires, you know that everything is good and there is no need to reset the event handler. And if ItemAdd event does not fire, your code resetting the event handler won&#39;t run anyway."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1555059909, "post_id": 55610793, "comment_id": 97985154, "body": "@DmitryStreblechenko it depends on when &amp; why the event handler is stopping. <code>ItemAdd</code> seems to work one or twice before stopping working. If it gets disabled after running a few times once initiailised, then reinitialising it from <code>startupevents</code> every time  should keep it working."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555061531, "post_id": 55610793, "comment_id": 97986061, "body": "@Tim - just confirmed that this isn&#39;t working. I can re-run the <code>startupEvents</code>manually and that get&#39;s it working again, so the Inbox listener is failing at some other point and <code>Items_ItemAdd</code>is not getting called at all."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555408274, "post_id": 55610793, "comment_id": 98091540, "body": "Thanks for the input. I made my routine to set the category based upon words in the subject a public sub, so if it stops working, I can run it manually and also re-start the inbox listener manually."}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1554893587, "creation_date": 1554893587, "answer_id": 55610793, "question_id": 55610561, "link": "https://stackoverflow.com/questions/55610561/rerun-outlook-vba-script-application-startup-regularly/55610793#55610793", "title": "Rerun Outlook VBA script &#39;Application_Startup&#39; regularly", "body": "<p>You could add a new macro that does the actions originally present in the <code>Application_Startup</code> event. Then you could later refer to that sub at the end of your <code>Items_ItemAdd</code> macro.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPublic Sub Application_Startup()\n   Call startupevents\nEnd Sub\n\nSub startupevents()\n\n' Add an inbox event listener\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n  ' default local Inbox\n  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\n  MsgBox \"Startup macro run\"\n\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n  'Do something on new email arrival\n'\n'\n'\nCall startupevents\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555060037, "post_id": 55620604, "comment_id": 97985220, "body": "I suppose the underlying question of &quot;Why does the ItemAdd event handler stop working&quot; remains unanswered? I&#39;ve searched but found no answer. just suggestions such as set all variables to &#39;nothing&#39; and &#39;add an empty <code>Application_Quit()</code>&#39;"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555076142, "post_id": 55620604, "comment_id": 97994324, "body": "It can stop firing if a connection with the serve is lost, but that only applies to the online (as opposed to cached) mode."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555408267, "post_id": 55620604, "comment_id": 98091532, "body": "Thanks for the input. I made my routine to set the category based upon words in the subject a public sub, so if it stops working, I can run it manually and also re-start the inbox listener manually."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555408404, "post_id": 55620604, "comment_id": 98091620, "body": "I have noticed the occasional error from addItem - &quot;13 - type mismatch&quot;, so I have expanded the  error handler routine to also print the subject. Maybe this error is the cause of addItems stopping working or maybe it is a symptom of it being broken,"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "edited": false, "score": 0, "creation_date": 1555429380, "post_id": 55620604, "comment_id": 98104656, "body": "You really need to show the relevant snippets of yurt code. Keep in mind that Inbox can contain items other than MailItem, such as MeetingItem, ReportItem, etc."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1554927035, "creation_date": 1554927035, "answer_id": 55620604, "question_id": 55610561, "link": "https://stackoverflow.com/questions/55610561/rerun-outlook-vba-script-application-startup-regularly/55620604#55620604", "title": "Rerun Outlook VBA script &#39;Application_Startup&#39; regularly", "body": "<p>If you need to reset the <code>ItemAdd</code> event handler, I don't think using <code>ItemAdd</code> to do that makes any sense. </p>\n\n<p>You can either use a timer (which does not exist in VBA) or you can use some other event that fires more or less frequently, such as the <code>Explorer.SelectionChange</code> event (<code>Explorer</code> can be retrieved from <code>Application.ActiveExplorer</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1555030578, "creation_date": 1555030578, "answer_id": 55643043, "question_id": 55610561, "link": "https://stackoverflow.com/questions/55610561/rerun-outlook-vba-script-application-startup-regularly/55643043#55643043", "title": "Rerun Outlook VBA script &#39;Application_Startup&#39; regularly", "body": "<p>Simpler code may have an impact.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPublic Sub Application_Startup()\n    ' Add an inbox event listener\n    Dim objNS As Outlook.NameSpace\n\n    ' The code is in Outlook, not being called, for example, from Excel.\n    Set objNS = Session.GetNamespace(\"MAPI\")\n    ' default local Inbox\n    Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\n    MsgBox \"Startup macro run\"\nEnd Sub\n</code></pre>\n\n<p>If the above has no impact then this may rerun Application_Startup frequently enough.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Application_Startup\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555030578, "creation_date": 1554892969, "question_id": 55610561, "link": "https://stackoverflow.com/questions/55610561/rerun-outlook-vba-script-application-startup-regularly", "title": "Rerun Outlook VBA script &#39;Application_Startup&#39; regularly", "body": "<p>I have (using information from SO) implemented a VBA macro that runs to process new emails after the 'run a script' options was removed from the Outlook rules. I do this as follows:</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPublic Sub Application_Startup()\n' Add an inbox event listener\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n  ' default local Inbox\n  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\n  MsgBox \"Startup macro run\"\n\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n  'Do something on new email arrival\n.\n.\n.\nEnd Sub\n</code></pre>\n\n<p>However the inbox listener appears to frequently stop working and I either have to restart Outlook or re-run the 'Startup' macro manually to kick it back into life - this appears to be a common problem with no solution.</p>\n\n<p><strong>Question</strong> - I'm not a VBA expert and I was wondering if I can I simply re-run the 'Application_Startup' macro to restart the listener at the end of the <code>'Items_ItemAdd(ByVal item As Object)'</code> macro?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1554892830, "post_id": 55610342, "comment_id": 97915403, "body": "I guess those links are related to calculations later on. Maybe setting up Calculation to manual, then use your macro, and then set calculation to automatic again."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1554893070, "post_id": 55610342, "comment_id": 97915541, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.changelink\" rel=\"nofollow noreferrer\"><code>Workbook.ChangeLink</code> method</a>"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1554893217, "post_id": 55610342, "comment_id": 97915634, "body": "I&#39;ve looked at that, but wasn&#39;t sure if it was possible to change just the left most part of a link. Do you know if it works with LEFT at all?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1554893478, "post_id": 55610342, "comment_id": 97915779, "body": "You take the full old name of the link, you come up with the full new name based on <code>sNew</code>, you provide the full new name to <code>ChangeLink</code>. You are doing exactly that in your attempt to change <code>ActiveSheet.Hyperlinks</code>."}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1554894371, "post_id": 55610342, "comment_id": 97916245, "body": "Will this work independently of the workbook names? So could I define the change for the left hand part of the address only, or do I need to do it for all 20 workbooks?  I guess I could do an if, loop through a single list of the workbook names and then apppend it based on the incoming address"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554896692, "post_id": 55610342, "comment_id": 97917549, "body": "You can just use Replace(oldfullpath,nameofoldfolder,nameofnewfolder) to get new full path"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1554897733, "post_id": 55610342, "comment_id": 97918189, "body": "Under certain circumstances, I&#39;ve found that setting a <i>Hard Link</i> or <i>Symbolic Link</i> to the new location is easier than changing the formulas in Excel that refer to those files/locations."}], "owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554892358, "creation_date": 1554892358, "question_id": 55610342, "link": "https://stackoverflow.com/questions/55610342/problems-updating-part-of-000s-of-workbook-links", "title": "Problems updating part of &#39;000s of workbook links", "body": "<p>I have a workbook with 9 sheets, where each sheet contains 500 rows, about 120 columns and references about 25 other workbooks.</p>\n\n<p>The workbooks have moved directory en masse, and so the path all these workbooks are on has changed from:</p>\n\n<p>S:\\Path\\Path\\Path\\Workbook.xlsx to\nS:\\Path\\Path\\PathNew\\Workbook.xlsx</p>\n\n<p>I'm trying to write a macro that will change all the paths quickly, because using Update Link or Find and Replacing all the text slows down Excel to a crawl and seemingly never wants to finish.</p>\n\n<p>I've tried looking online and found what looked like a nice bit of code, but I think it's not working because the workbook links aren't technically hyperlinks.</p>\n\n<pre><code>Dim lnkH As WorksheetDataConnection\nDim sOld As String\nDim sNew As String\n\nsOld = \"\\FY20\\\"\nsNew = \"\\FY20\\STX FC @ April Update\\\"\n\nFor Each lnkH In ActiveSheet.Hyperlinks\n    lnkH.Address = Replace(lnkH.Address, sOld, sNew)\n    lnkH.TextToDisplay = Replace(lnkH.TextToDisplay, sOld, sNew)\nNext\n</code></pre>\n\n<p>My VBA skills aren't excellent - I normally find stuff I need online and then tweak for my own purposes. Is there an equivalent version of the above that will update the thousands of workbook links in a way that doesn't crash my PC for hours?</p>\n"}, {"tags": ["excel", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11339713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7baeda74517b78991584a2d5efb899e?s=128&d=identicon&r=PG&f=1", "display_name": "user11339713", "link": "https://stackoverflow.com/users/11339713/user11339713"}, "edited": false, "score": 0, "creation_date": 1554907624, "post_id": 55613216, "comment_id": 97924395, "body": "Hi thanks for reply, yes it is working on first time only and when I tried to run 3 or 4 times again showing the same error."}, {"owner": {"reputation": 11, "user_id": 11339713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7baeda74517b78991584a2d5efb899e?s=128&d=identicon&r=PG&f=1", "display_name": "user11339713", "link": "https://stackoverflow.com/users/11339713/user11339713"}, "edited": false, "score": 0, "creation_date": 1554966274, "post_id": 55613216, "comment_id": 97945000, "body": "Hi All experts, I am kindly requesting all of you please please help me to resolve this problem, I am not able to understand why it is not working in link table. Thanks Kashif"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 11, "user_id": 11339713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7baeda74517b78991584a2d5efb899e?s=128&d=identicon&r=PG&f=1", "display_name": "user11339713", "link": "https://stackoverflow.com/users/11339713/user11339713"}, "edited": false, "score": 0, "creation_date": 1554988342, "post_id": 55613216, "comment_id": 97957815, "body": "if its working on tables that are not linked then I would remove the link for this table as well."}, {"owner": {"reputation": 11, "user_id": 11339713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7baeda74517b78991584a2d5efb899e?s=128&d=identicon&r=PG&f=1", "display_name": "user11339713", "link": "https://stackoverflow.com/users/11339713/user11339713"}, "edited": false, "score": 0, "creation_date": 1554990737, "post_id": 55613216, "comment_id": 97959503, "body": "I can not remove the link because, that table is referencing in other queries and we need live refresh live data in this table from SQL Server, and if we remove the link the refresh data will not come in this table."}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1554901213, "creation_date": 1554901213, "answer_id": 55613216, "question_id": 55610334, "link": "https://stackoverflow.com/questions/55610334/odbc-connection-failed-error-in-excel-64-bit/55613216#55613216", "title": "ODBC connection failed error in Excel 64-bit", "body": "<p>I would try out setting a <code>strSQL</code> as a string like this (I had the same issue you did and when I made the change it worked for me):</p>\n\n<pre><code>Sub FetchData()\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim conn As String, strSQL AS String\n\nconn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=G:\\Workflow Tools (Michael Cantor)\\Tool For Fixing Bug From Michael Cantor\\PI MDT Reconciliation Workflow Tool\\SampleforPractice.accdb;\"\n\nstrSQL = \"Select * from peoplemain\"\n\n\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\ncn.Open conn\n\nrs.Open strSQL , cn  'Error Line\n\n\n\nSheet1.Range(\"A1\").CopyFromRecordset rs\n\n\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11339713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7baeda74517b78991584a2d5efb899e?s=128&d=identicon&r=PG&f=1", "display_name": "user11339713", "link": "https://stackoverflow.com/users/11339713/user11339713"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554901213, "creation_date": 1554892335, "last_edit_date": 1554892965, "question_id": 55610334, "link": "https://stackoverflow.com/questions/55610334/odbc-connection-failed-error-in-excel-64-bit", "title": "ODBC connection failed error in Excel 64-bit", "body": "<p>I have a linked table in ms-access which is linked to a sql server table, and when I am trying to fetch the data in excel via VBA from ms-access linked table the error message \"ODBC connection failed\" showing.</p>\n\n<p>Note:- I am manually successfully able to refresh ms-access linked table in ms-access, \"peoplemain\" is the name of linked table.</p>\n\n<p>Note:- When I tried to fetch data from non linked table, it is running successfully.</p>\n\n<p>Below code is working in Excel-32 bit version, but not working in excel-64 bit.</p>\n\n<p>[code]</p>\n\n<pre><code>Sub FetchData()\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim conn As String\n\nconn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=G:\\Workflow Tools (Michael Cantor)\\Tool For Fixing Bug From Michael Cantor\\PI MDT Reconciliation Workflow Tool\\SampleforPractice.accdb;\"\n\n\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\ncn.Open conn\n\nrs.Open \"Select * from peoplemain\", cn  'Error Line\n\n\n\nSheet1.Range(\"A1\").CopyFromRecordset rs\n\n\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Kashif</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554894364, "post_id": 55610239, "comment_id": 97916242, "body": "You have a mess on the <code>With</code> if you are changin columns, there is no need for a range, so you need to use <code>With Sheet22</code> (If sheet22 is a  variable and is already set). Then use <code>.Columns(3).ColumnWidth = 90</code>"}, {"owner": {"reputation": 1, "user_id": 4147846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d883e2b3abbe828c99f8a2950636e0eb?s=128&d=identicon&r=PG&f=1", "display_name": "MEnum", "link": "https://stackoverflow.com/users/4147846/menum"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554895128, "post_id": 55610239, "comment_id": 97916662, "body": "Thanks @Damian but Sheet22 is te Sheet number and the var22b contains the range.. I want to print a set or rows with a certain column with and the width of the same column again when I choose another range within the same sheet.."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554896877, "post_id": 55610239, "comment_id": 97917663, "body": "The columnwidth is set for the whole column not for a range. Do you want to change the column width IF something or set the column width AND do something?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554897016, "post_id": 55610239, "comment_id": 97917747, "body": "@MEnum Then <code>With ThisWorkbook.Sheets(&quot;Sheet22&quot;)</code> if the code is within the workbook you are trying to change the width."}], "owner": {"reputation": 1, "user_id": 4147846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d883e2b3abbe828c99f8a2950636e0eb?s=128&d=identicon&r=PG&f=1", "display_name": "MEnum", "link": "https://stackoverflow.com/users/4147846/menum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554984010, "creation_date": 1554892009, "last_edit_date": 1554984010, "question_id": 55610239, "link": "https://stackoverflow.com/questions/55610239/adjusting-excel-column-widths-according-to-the-selection-of-certain-rows", "title": "Adjusting excel column widths according to the selection of certain rows", "body": "<p>I'm developing a macro where I want to change column-width according to certain row selections. How can I do this using excel vba?</p>\n\n<p>So for example I want to do something like the following:</p>\n\n<pre><code>  With Sheet22.Range(var22b)\n    Columns(\"C:C\").ColumnWidth = 40\n  End With\n\n\n  With Sheet22.Range(var22c)\n    Columns(\"C:C\").ColumnWidth = 90\n  End With\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "edited": false, "score": 0, "creation_date": 1554961933, "post_id": 55613890, "comment_id": 97943204, "body": "Excellent QHarr! Thanks a lot for your efforts in helping in fixing this."}, {"owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "edited": false, "score": 0, "creation_date": 1554962124, "post_id": 55613890, "comment_id": 97943283, "body": "But my ultimate goal of this coding is to not to target any specific elements. But to run the loops and extract data of all elements into Excel form. If you could help me looping of it would be of great help!. Thanks a lot again for your time and efforts."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "edited": false, "score": 0, "creation_date": 1554962989, "post_id": 55613890, "comment_id": 97943587, "body": "Put your variables in arrays for example and loop assigning to idate and commodity in those loops."}, {"owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "edited": false, "score": 0, "creation_date": 1554982469, "post_id": 55613890, "comment_id": 97954183, "body": "Thanks QHarr! That is a great input for me."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1555530454, "last_edit_date": 1555530454, "creation_date": 1554903118, "answer_id": 55613890, "question_id": 55610198, "link": "https://stackoverflow.com/questions/55610198/second-drop-down-in-html-is-not-getting-selected-through-vba/55613890#55613890", "title": "Second drop down in HTML is not getting selected through VBA", "body": "<p>You need a timed loop to allow for that execution of the onchange event. Also, you can make use of css attribute = value selectors to remove loops when targeting elements. It is likely the page does an XHR request so inspect via dev tools to see if that is the case.</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub MakeSelections()\n    Dim ie As InternetExplorer, ele As Object, t As Date\n    Const MAX_WAIT_SEC As Long = 5\n    Dim commodity As String, iDate As String\n\n    commodity = \"MADHYA PRADESH\"\n    iDate = \"REWA\"\n\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"http://hydro.imd.gov.in/hydrometweb/(S(3qitcijd521egpzhwqq3jk55))/DistrictRaifall.aspx\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"[value='\" &amp; commodity &amp; \"']\").Selected = True\n        .document.querySelector(\"[name=listItems]\").FireEvent \"onchange\"\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .document.querySelector(\"[value='\" &amp; iDate &amp; \"']\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If Not ele Is Nothing Then\n            ele.Selected = True\n            .document.querySelector(\"#GoBtn\").Click\n        Else\n            Exit Sub\n        End If\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55613890, "answer_count": 1, "score": 1, "last_activity_date": 1555530454, "creation_date": 1554891874, "last_edit_date": 1554903154, "question_id": 55610198, "link": "https://stackoverflow.com/questions/55610198/second-drop-down-in-html-is-not-getting-selected-through-vba", "title": "Second drop down in HTML is not getting selected through VBA", "body": "<p>My VBA code is not able to select the second drop down option once the first drop down is selected. Not sure why one dropdown is loading and second is not responding as per below code? Appreciate if you could help on fixing this. Regards</p>\n\n<pre><code>Dim IE As InternetExplorer\n\nDim HTMLDoc As HTMLDocument\n\nDim commodityStr As String\nDim commodityObj As HTMLObjectElement\nDim commodityCodes As IHTMLElementCollection\nDim codeCounter As Long\nDim EDateStr As String\nDim EDateObj As HTMLObjectElement\nDim EdateCodes As IHTMLElementCollection\n\nDim i As Integer\n\n\n\n\ncommodityStr = \"MADHYA PRADESH\"\nEDateStr = \"REWA\"\n\nSet IE = New InternetExplorer\n\nWith IE\n    .Visible = True\n    .navigate \"http://hydro.imd.gov.in/hydrometweb/(S(ryta1dvaec5pg03bdnxa5545))/DistrictRaifall.aspx\"\n    While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE: Wend\n    Set HTMLDoc = IE.document\nEnd With\n\nSet commodityObj = HTMLDoc.getElementById(\"listItems\")\n\n\nFor codeCounter = 0 To commodityObj.Length - 1\n    If commodityObj(codeCounter).innerText = commodityStr Then\n        commodityObj.Value = commodityObj(codeCounter).Value\n\n\n           commodityObj.Focus\n           commodityObj.FireEvent (\"onchange\")\n            While IE.Busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE: Wend\n       Exit For\n End If\n Next\n\n\n\nSet EDateObj = HTMLDoc.getElementById(\"DistrictDropDownList\")\n\n\nFor codeCounter = 0 To EDateObj.Length - 1\n    If EDateObj(codeCounter).innerText = EDateStr Then\n       EDateObj.Value = EDateObj(codeCounter).Value\nWhile IE.Busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE: Wend\ncommodityObj.Focus\ncommodityObj.FireEvent (\"onchange\")\n     Exit For\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9778872, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3TXeFoL0Fd0/AAAAAAAAAAI/AAAAAAAABIQ/zOxiTMvojqk/photo.jpg?sz=128", "display_name": "Mange_Man", "link": "https://stackoverflow.com/users/9778872/mange-man"}, "edited": false, "score": 1, "creation_date": 1554984172, "post_id": 55614263, "comment_id": 97955122, "body": "Thanks! Solved it in a similar fashion to this :)"}], "tags": [], "owner": {"reputation": 184, "user_id": 8822457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484ed1bead2eabe775131c107decfdc2?s=128&d=identicon&r=PG&f=1", "display_name": "Zachariah Rabatah", "link": "https://stackoverflow.com/users/8822457/zachariah-rabatah"}, "is_accepted": false, "score": 0, "last_activity_date": 1554904191, "creation_date": 1554904191, "answer_id": 55614263, "question_id": 55609884, "link": "https://stackoverflow.com/questions/55609884/string-conversion-when-reading-file-in-vba/55614263#55614263", "title": "String conversion when reading file in VBA", "body": "<p>Mange_Man</p>\n\n<p>My suggestion would be to start by taking your file data and putting it into an Excel worksheet. If the VBA is not working within Excel, then it won't work with file I/O either.</p>\n\n<p>Try pasting your array into excel and run the macro I have below.</p>\n\n<p>If your column \"I\" does not have the values multiplied by 10 then my guess is it is an issue with your regional settings of Excel (European).</p>\n\n<p>Otherwise it might have to do with your computer itself and how it interacts with file I/O with Excel and the European regional settings. Anyways try it first in excel as a start..</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\nDim i As Integer\nDim n As Integer\nDim arr() As Double\n\nRange(\"A1:A9\").Select 'Select your nine rows\n\n'Set delimiter if necessary\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n        Array(7, 1), Array(8, 1)), TrailingMinusNumbers:=True\n\ni = 8\nReDim arr(i)\n\nFor n = 0 To i\n    arr(n) = Range(\"B\" &amp; n + 1).value * 10 'Multiply values by 10\nNext n\n\nFor n = 0 To i\n    Range(\"I\" &amp; n + 1).value = arr(n) 'Set values in Column \"I\"\nNext n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9778872, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3TXeFoL0Fd0/AAAAAAAAAAI/AAAAAAAABIQ/zOxiTMvojqk/photo.jpg?sz=128", "display_name": "Mange_Man", "link": "https://stackoverflow.com/users/9778872/mange-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554984005, "creation_date": 1554890782, "last_edit_date": 1554984005, "question_id": 55609884, "link": "https://stackoverflow.com/questions/55609884/string-conversion-when-reading-file-in-vba", "title": "String conversion when reading file in VBA", "body": "<p>I'm currently working with VBA which I am not used to. I am making a script that reads some data from txt-files and then makes a graph out of it. The script reads the txt-files collects the data and inputs it into an excel-workbook. Then makes graphs of these values.\nOne value is supposed to be multiplied by a factor of ten. However when reading the values and trying to convert them to doubles I stumble upon lots of problems.</p>\n\n<p>This is what the file looks like. And the second column is what is of interest here.</p>\n\n<pre><code>444.267 70.26   332.562 0.692   2   1   0   157.48\n444.933 70.26   342.562 0.692   2   1   0   157.48\n446.533 72.88   342.562 0.692   2   1   0   157.48\n462.933 75.5    342.562 0.692   2   1   0   157.48\n468.667 75.5    331.75  0.692   2   1   0   157.48\n479.333 75.5    331.75  0.692   2   12  0   157.48\n479.733 75.5    331.75  0.692   2   11  0   157.48\n480.133 75.5    331.75  0.692   2   1   0   157.48\n539.467 75.5    331.75  0.692   2   12  0   157.48\n</code></pre>\n\n<p>Below I've attached some code. I've changed it somewhat for debugging purposes.</p>\n\n<pre><code>For tmp1 = 1 To 70\n        'While Not EOF(FileNum)\n            Dim DataLine_Array() As String\n            Line Input #FileNum, DataLine\n            DataLine_Array = Split(DataLine, vbTab)\n\n            Cells(i, 1) = DataLine_Array(0)\n            Cells(i, 2) = DataLine_Array(1)\n            Cells(i, 3) = DataLine_Array(2)\n            Cells(i, 4) = DataLine_Array(3)\n            Cells(i, 5) = DataLine_Array(4)\n            Cells(i, 6) = DataLine_Array(5)\n            Cells(i, 7) = DataLine_Array(6)\n            Cells(i, 8) = DataLine_Array(7)\n            On Error GoTo ErrLabel:\n            Dim Tmp_Double As Double\n            Tmp_Double = DataLine_Array(3)\n            Cells(i, 10) = (Tmp_Double)\n\n            'Here it goes wrong\n            Cells(i, 9) = DataLine_Array(1) / 10\n            Dim Test_test As String\n            Dim test_test2 As Double\n            Test_test = DataLine_Array(1) / 10\n            test_test2 = DataLine_Array(1)\n\n            'Output\n            Debug.Print 'start'\n            Debug.Print DataLine_Array(1)\n            Debug.Print Test_test\n            Debug.Print VarType(Test_test)\n            Debug.Print test_test2\n            Debug.Print VarType(test_test2)\n\nErrLabel:\n            Resume Next\n            i = i + 1\n        Next tmp1\n</code></pre>\n\n<p>And this is what is being outputted.</p>\n\n<pre><code>70.26\n702,6\n 8 \n 7026 \n 5 \n\n72.88\n728,8\n 8 \n 7288 \n 5 \n\n75.5\n75,5\n 8 \n 755 \n 5 \n\n75.5\n75,5\n 8 \n 755 \n 5 \n</code></pre>\n\n<p>As you can see, the output is correct when just printing the line the output is correct.\nWhen storing it as a string however the dot changes to a comma and switch place depending on how many decimals there is. I am in European country where comma is  being used instead of dot as decimal separator. But this shouldn't effect a string in my mind.\nWhen trying to store the value as a double, the decimals completely disappear.</p>\n\n<p>The goal is to read the second column of the file as it is and multiply it with ten. This is hard as long as I don't read the values on consistent manner however.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "textbox"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554890215, "post_id": 55609646, "comment_id": 97913893, "body": "Check out for the <code>Worksheet_Change()</code> event, there are lots of questions refering this topic in this site. That&#39;s what you are looking for."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11125290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed778dbad8400ee66cd792daa75b18?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/11125290/joris"}, "edited": false, "score": 0, "creation_date": 1555317333, "post_id": 55611489, "comment_id": 98054188, "body": "Awesome! that is exactly what i was looking for!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11125290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed778dbad8400ee66cd792daa75b18?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/11125290/joris"}, "edited": false, "score": 0, "creation_date": 1555317657, "post_id": 55611489, "comment_id": 98054348, "body": "You are welcome @Joris, if this has answered your question please consider marking your question as answered."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11125290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed778dbad8400ee66cd792daa75b18?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/11125290/joris"}, "edited": false, "score": 0, "creation_date": 1555330695, "post_id": 55611489, "comment_id": 98060967, "body": "Hello@Joris, You have posted an answer, copying mine. Please see this <a href=\"https://stackoverflow.com/help/someone-answers\">link</a> to help you out. Regarding to your problem: It&#39;s hard to judge what&#39;s wrong when I can&#39;t see your data/layout"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1554895881, "creation_date": 1554895881, "answer_id": 55611489, "question_id": 55609646, "link": "https://stackoverflow.com/questions/55609646/update-textbox-value-when-changes-are-made/55611489#55611489", "title": "Update Textbox value when changes are made", "body": "<p>While your first go might be to look into the <code>Worksheet_Change()</code> event there might be another way to deal with this. You could create an UDF (User Defined Function) that can be called like a normal function in your workbook. For example the below would count the cells in a range and will update when something in that range changes.</p>\n\n<pre><code>Public Function CountCells(RNG As Range) As Double\n\nFor Each CL In RNG\n    If IsEmpty(CL) = True Then\n        With CL.Interior\n            If .Pattern = xlSolid And .TintAndShade = -0.249977111117893 Then\n                CountCells = CountCells + 1\n            End If\n        End With\n    End If\nNext CL\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/70hfB.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/70hfB.gif\" alt=\"enter image description here\"></a></p>\n\n<p>You could link the value of <code>C1</code> to a textbox.</p>\n"}], "owner": {"reputation": 3, "user_id": 11125290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed778dbad8400ee66cd792daa75b18?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/11125290/joris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 55611489, "answer_count": 1, "score": 0, "last_activity_date": 1555328958, "creation_date": 1554889998, "question_id": 55609646, "link": "https://stackoverflow.com/questions/55609646/update-textbox-value-when-changes-are-made", "title": "Update Textbox value when changes are made", "body": "<p>I use the code below to count cells that are blank and have a certain color.\nI then store the count in a  textbox. The code works fine but i have to run the code for the textbox value to update. I need the textbox value to update when changes are made. </p>\n\n<p>Tx in advance!</p>\n\n<pre><code>Sub CountBlankColors4()\n    Dim c As Range\n    Dim J As Integer\n    Dim ColorCount(100) As Long\n\n    ActiveSheet.Range(\"A1:K30\").SpecialCells(xlCellTypeBlanks).Select\n\n    For Each c In Selection\n        With c.Interior\n            If .Pattern = xlSolid Then\n                If .TintAndShade = -0.249977111117893 Then\n                    If IsEmpty(c) Then\n                        ColorCount(.ColorIndex) = _\n                          ColorCount(.ColorIndex) + 1\n                    End If\n                End If\n            End If\n        End With\n    Next c\n\n    For J = 0 To 100\n        If ColorCount(J) &gt; 0 Then\n            sTemp = ColorCount(J)\n        End If\n    Next J\n\n    TextBox1.Value = sTemp\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1554898868, "post_id": 55609582, "comment_id": 97918880, "body": "You should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">rewrite your code to avoid <code>Select</code></a>, and then explicitly specify the sheets on which you want to disable calculation. It looks to me like the assumption that enabling calculation for one worksheet stops you disabling it on others isn&#39;t correct."}, {"owner": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1554899684, "post_id": 55609582, "comment_id": 97919351, "body": "Okay, it is a good new so! But I specify the worksheet &quot;Worksheets(&quot;EssaiTaux&quot;).EnableCalculation = False&quot; but don&quot;t work!"}, {"owner": {"reputation": 300, "user_id": 1978495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccacccf34d5d2a9c0668b3b734bb09f?s=128&d=identicon&r=PG", "display_name": "drgs", "link": "https://stackoverflow.com/users/1978495/drgs"}, "edited": false, "score": 1, "creation_date": 1554900259, "post_id": 55609582, "comment_id": 97919701, "body": "Application.Calculation = xlCalculationManual ? (for whole workbook)"}, {"owner": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "edited": false, "score": 0, "creation_date": 1554984491, "post_id": 55609582, "comment_id": 97955313, "body": "this computer control don&#39;t work :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559821678, "post_id": 55609582, "comment_id": 99544144, "body": "The only way to do what you are after is to use VBA to do the &#39;non-automatic&#39; calculations and run this code when you want to do these calculations."}], "owner": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554983996, "creation_date": 1554889798, "last_edit_date": 1554983996, "question_id": 55609582, "link": "https://stackoverflow.com/questions/55609582/disable-automatic-calculation", "title": "Disable automatic calculation", "body": "<p>I would like to disable automatic calculation on a single sheet.\nExcept that I saw that when you have activated automatic calculation for one sheet, you can not disable automatic calculation for others.</p>\n\n<p>I try to do this code but it does not work.</p>\n\n<pre><code>    Sub EssaiTaux()\n '\n ' EssaiTaux Macro\n '\n\n '\n\n  Worksheets(\"EssaiTaux\").EnableCalculation = False\n  Application.CutCopyMode = False\n  ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$I$3:$P$18\"), ,      xlYes).Name = _\n    \"Tableau4\"\n \u2026\n  Range(\"I17\").Select\n  ActiveCell.FormulaR1C1 = \"Total\"\n  Sheets(\"EssaiTaux\").Select\n  Range(\"J4\").Select\n  ActiveCell.FormulaR1C1 = \"=+SUMIFS(BASE!C6,BASE!C9,RC9)\"\n  Range(\"J5\").Select\n\n   End Sub\n</code></pre>\n\n<p>I would like to apply a formula on only a few cells and a other formula on a particular cell but the automatic calculation mode is already activated with the other sheets.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1554890769, "post_id": 55609310, "comment_id": 97914253, "body": "And what is <code>out_file</code>?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1554898676, "post_id": 55609310, "comment_id": 97918748, "body": "does tthe output file already exist ?"}, {"owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1554947083, "post_id": 55609310, "comment_id": 97939844, "body": "Hi Patrick, yes the output file where the table needs to be exported from Access , already exists. The procedure is actually an excel file is already available in the same directory and then the table which got created in access needs to be exported in that excel file which in code is out_file."}, {"owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1554947161, "post_id": 55609310, "comment_id": 97939859, "body": "Out_file is a variable for an excel file where the table will get exported. Out_file = Pro_Drops.xlsx"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1554946914, "post_id": 55612600, "comment_id": 97939805, "body": "Hi Patrick, many thanks for the response. I will remove the range and then will check and confirm back. However when this code was used a couple of days back with Ms Access 2007 version, it was working fine without any error."}, {"owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1554959720, "post_id": 55612600, "comment_id": 97942438, "body": "Actually there are three tables which needs to be exported into three different worksheets of same workbook. hence the range is defined for three tables three different ranges."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1554899373, "creation_date": 1554899373, "answer_id": 55612600, "question_id": 55609310, "link": "https://stackoverflow.com/questions/55609310/how-to-resolve-the-export-to-excel-error/55612600#55612600", "title": "How to resolve the export to Excel error?", "body": "<p>remove the <code>Range</code> parameter. As stated in <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transferspreadsheet\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n\n<p><em>A string expression that's a valid range of cells or the name of a range in the spreadsheet. <strong>This argument applies only to importing</strong>. Leave this argument blank to import the entire spreadsheet. <strong>When you export to a spreadsheet, you must leave this argument blank</strong>. If you enter a range, the export will fail.</em></p>\n"}], "owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554899373, "creation_date": 1554888912, "last_edit_date": 1554890923, "question_id": 55609310, "link": "https://stackoverflow.com/questions/55609310/how-to-resolve-the-export-to-excel-error", "title": "How to resolve the export to Excel error?", "body": "<p>I have an MS Access VBA code but, using it in 2016 version, getting an error.</p>\n\n<p>I have tried to remove the optional part <em>acSpreadsheetTypeExcel12XML</em></p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, TableName:=\"Drops_Airports\", FileName:=out_file, Hasfieldnames:=True, Range:=\"Airports\"\n</code></pre>\n\n<p>The error on this code is: </p>\n\n<blockquote>\n  <p>Run time error 31532-MS Access was unable to export the data</p>\n</blockquote>\n\n<p>.</p>\n"}, {"tags": ["excel", "vba", "timer", "doevents"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1554886609, "post_id": 55607791, "comment_id": 97911579, "body": "Firstly, instead of using <code>Goto</code> try using <code>Do..While</code> loop. For your query: Excel is a single thread application so I don&#39;t think you can interact with it if you have code running (I could be wrong but that&#39;s my understanding). You could create a modeless <code>Form</code> and have the code run as part of the form?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554886705, "post_id": 55607791, "comment_id": 97911639, "body": "<b>(1)</b> your error is not directly related to your code. Do you modify any values that are used in a chart? <b>(2)</b> You are using a &quot;Busy wait&quot;-loop, which means that your CPU (at least on core) eats up 100%. Have a look at the <code>OnTime</code>-function <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 11338939, "user_type": "registered", "profile_image": "https://graph.facebook.com/2618914848124587/picture?type=large", "display_name": "Calvin Dahms", "link": "https://stackoverflow.com/users/11338939/calvin-dahms"}, "edited": false, "score": 0, "creation_date": 1554887836, "post_id": 55607791, "comment_id": 97912299, "body": "yeah its a short code so I opted to <i>cheat</i> and use GoTo. I know its not the best option. I see your point about the error but it only comes up as I select a cell and try to change a value while the timer is running so it must be related somehow. I took a look at the OnTime function and it might work but the challenge is that I need to add a temperature value every 30 secs for 12.5 mins. My original thinking was to add an input box for each instance but that would break the timing of the code I think. So I elected for manual entry"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11338939, "user_type": "registered", "profile_image": "https://graph.facebook.com/2618914848124587/picture?type=large", "display_name": "Calvin Dahms", "link": "https://stackoverflow.com/users/11338939/calvin-dahms"}, "is_accepted": false, "score": 0, "last_activity_date": 1555237508, "creation_date": 1555237508, "answer_id": 55674206, "question_id": 55607791, "link": "https://stackoverflow.com/questions/55607791/how-do-i-do-a-do-event-timer-in-vba-excel-while-still-being-able-to-change-value/55674206#55674206", "title": "How do I do a Do Event timer in vba excel while still being able to change values in my worksheet?", "body": "<p>I figured it out!</p>\n\n<p>If I just put an on error resume next then it runs well enough to work for my needs.</p>\n"}], "owner": {"reputation": 21, "user_id": 11338939, "user_type": "registered", "profile_image": "https://graph.facebook.com/2618914848124587/picture?type=large", "display_name": "Calvin Dahms", "link": "https://stackoverflow.com/users/11338939/calvin-dahms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 508, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555237508, "creation_date": 1554884084, "last_edit_date": 1554885681, "question_id": 55607791, "link": "https://stackoverflow.com/questions/55607791/how-do-i-do-a-do-event-timer-in-vba-excel-while-still-being-able-to-change-value", "title": "How do I do a Do Event timer in vba excel while still being able to change values in my worksheet?", "body": "<p>I have a timer I am actively running through a <code>DoEvents</code> function. The problem is that every thirty secs I want to manually put some temperature values in my worksheet. However, if I do that while the event is running I get: </p>\n\n<blockquote>\n  <p>Run-time error '1004': The specified dimension is not valid for the\n  current chart type.</p>\n</blockquote>\n\n<p>Some thoughts: I was going to try turning off screen updating but that would keep me from seeing the time change in real time.</p>\n\n<p>Is the active event keeping me from working in my document? And if so, is there a way around this?</p>\n\n<p>Here is the body of my code (I also have a sub for the stop and reset timer but I don't think that's pertinent):</p>\n\n<pre><code>Sub START_TIMER()\nDim sh As Worksheet\nSet sh = ThisWorkbook.ActiveSheet\n\nsh.Range(\"AI1\").Value = \"Start\"\n\nIf sh.Range(\"AI2\").Value = \"\" Then\nsh.Range(\"AI2\").Value = Now\nsh.Range(\"AL2\").Value = Now\nEnd If\n\nx:\nVBA.DoEvents\n\nIf sh.Range(\"AI1\").Value = \"Stop\" Then Exit Sub\n\nsh.Range(\"AI3\").Value = Now\nsh.Range(\"AL3\").Value = Now\n\n    If sh.Range(\"AL4\").Value &gt; TimeValue(\"00:00:29\") Then\n        sh.Range(\"A17\").Interior.Color = vbYellow\n        sh.Range(\"AL2\").Value = Now\n        Beep\n\n    Else\n         sh.Range(\"A17\").Interior.Color = vbWhite\n\n    End If\n\nGoTo x\n\nIf sh.Range(\"AL4\").Value = \"0:00:30\" Then\n    sh.Range(\"AL2\").Value = Now\nEnd If\n\nEnd\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 1, "last_activity_date": 1555081794, "creation_date": 1555081794, "answer_id": 55654676, "question_id": 55607293, "link": "https://stackoverflow.com/questions/55607293/powerpoint-linking-excel-charts-updating-them-or-deleting-old-charts-insert/55654676#55654676", "title": "Powerpoint: Linking Excel charts &amp; updating them or deleting old charts &amp; inserting updated ones?", "body": "<p>What I've done in the past is use VBA to paste pictures of the charts into the slides. Then the presentation serves as a snapshot, and I don't need to worry about links.</p>\n\n<p>You can set up a table with details like chart name, worksheet name, slide number, image size (width, height) and position (left, top). Then the code moves down the list, finding the worksheet, copying the chart, activating the slide, pasting the chart as a picture, moving it into position. Best results are when the chart is sized right in Excel so you don't need to resize it in PowerPoint.</p>\n\n<p>It's been a while, so I don't have that code at my fingertips. I'll hunt around when I have a chance.</p>\n"}], "owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 55654676, "answer_count": 1, "score": 0, "last_activity_date": 1555081794, "creation_date": 1554882307, "question_id": 55607293, "link": "https://stackoverflow.com/questions/55607293/powerpoint-linking-excel-charts-updating-them-or-deleting-old-charts-insert", "title": "Powerpoint: Linking Excel charts &amp; updating them or deleting old charts &amp; inserting updated ones?", "body": "<p>I have a PowerPoint presentation containing Excel charts and .png files. This presentation needs to be updated fairly often and I\u2019d like to use VBA for this. However, I\u2019ve read up on linking charts from Excel to Powerpoint and it seems not to be bug-free, but I don't really know anything about it. </p>\n\n<p>So I need advice what makes the most sense because I don't have any experience with this. Is updating the charts usually not an issue? Or would it be more fool-proof to delete the old charts and insert the new ones? In case it's the latter, would I simply define the dimensions of the chart or does the use of placeholders offer any advantages? </p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 3, "last_activity_date": 1554882336, "creation_date": 1554882336, "answer_id": 55607300, "question_id": 55606711, "link": "https://stackoverflow.com/questions/55606711/access-vba-not-able-to-update-a-forms-control-source-after-openning-this-form/55607300#55607300", "title": "Access VBA not able to update a form&#39;s control source after openning this form", "body": "<pre><code>DoCmd.OpenForm \"frmFormName\", , , , , acDialog\n</code></pre>\n\n<p>opens the form <strong>modal</strong>. That means, code execution is halted until the form is closed (or set to <code>Visible=False</code>).</p>\n\n<p>So the next line is executed when the form is already closed.</p>\n\n<p>You could pass the parameter via <code>OpenArgs</code> and set the control source in <code>Form_Open</code>, not from the outside.</p>\n"}], "owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594621207, "creation_date": 1554880274, "last_edit_date": 1594621207, "question_id": 55606711, "link": "https://stackoverflow.com/questions/55606711/access-vba-not-able-to-update-a-forms-control-source-after-openning-this-form", "title": "Access VBA not able to update a form&#39;s control source after openning this form", "body": "<p>In Access I would like to open a closed form before updating a textbox's control source on this form. </p>\n\n<p>I have the following VB codes. But it gets stuck at updating controlsource once the form pops up, giving a runtime error 438. I tried another function on the form to refresh controls right after openning this form and it got stuck as well. </p>\n\n<p>I tried to operate on this form while it was open and it went well. So I believe VB thinks this form is still closed after openning it. Anyone knows how to open a closed form and operate on it in a single <code>sub</code>? Thanks</p>\n\n<pre><code> ...\n DoCmd.OpenForm \"frmFormName\", , , , , acDialog        \n Forms.frmFormName.Text50.ControlSource = \"='value'\"\n ...\n</code></pre>\n"}, {"tags": ["excel", "vba", "network-programming"], "comments": [{"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "edited": false, "score": 0, "creation_date": 1554881724, "post_id": 55606210, "comment_id": 97908895, "body": "Have you tried to manually copy the file to your IP address, just to be sure it&#39;s not a network (or permission) related problem?"}, {"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "reply_to_user": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "edited": false, "score": 0, "creation_date": 1554883073, "post_id": 55606210, "comment_id": 97909636, "body": "I tried it and the network is working with write permission. Even, when running the macro, the dialog box for saving is going to the correct network folder path, it&#39;s just that the filename bar in the dialog box is empty and the the user needs to put manually for the filename. However, if I put local address or use server name instead of IP the file naming is working."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "edited": false, "score": 1, "creation_date": 1554885786, "post_id": 55607573, "comment_id": 97911105, "body": "The above snip is working in file naming, however when clicked save, it&#39;s not saving. Hence, I modified the script a bit as per below now working;"}, {"owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "reply_to_user": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "edited": false, "score": 0, "creation_date": 1554891306, "post_id": 55607573, "comment_id": 97914558, "body": "@PaoloMedina - I&#39;ve undesrtood that problem is caused by not &quot;suggesting&quot; the correct path, but saving action is correct. Thanks for Your answer and modification."}], "tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": true, "score": 0, "last_activity_date": 1554883313, "creation_date": 1554883313, "answer_id": 55607573, "question_id": 55606210, "link": "https://stackoverflow.com/questions/55606210/macro-save-as-filename-not-working-when-saving-in-the-network-using-ip-address/55607573#55607573", "title": "Macro Save As filename not working when saving in the network using IP address", "body": "<p>something like this works for me:</p>\n\n<pre><code>Dim txtFileName As String\nDim finalPath As String\n\nfinalPath = \"\\\\10.10.10.11\\PUBLIC\\SOMETHING\\\"\nfinalPath = finalPath &amp; \"myWorkbookName.xlsx\"\n\ntxtFileName = Application.GetSaveAsFilename(finalPath, \"Excel (*.xlsx), *.xlsx\", , \"Excel network save\")\n        If txtFileName = \"False\" Then\n            MsgBox (\"We could not save Excel.\")\n            Exit Sub\n        End If\n</code></pre>\n\n<p>From my observations problems are when:\n- computer does not have access to network share,\n- workbook name that is proposed does not match \"rules\" of saving, e. g. is too long or has same strange characters.</p>\n\n<p>You should try to:</p>\n\n<p>1) check if computer has access to this network drive</p>\n\n<p>2) check if IP address is correct</p>\n\n<p>3) check if file name is correct.</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "is_accepted": false, "score": 0, "last_activity_date": 1554886343, "creation_date": 1554886343, "answer_id": 55608443, "question_id": 55606210, "link": "https://stackoverflow.com/questions/55606210/macro-save-as-filename-not-working-when-saving-in-the-network-using-ip-address/55608443#55608443", "title": "Macro Save As filename not working when saving in the network using IP address", "body": "<p>Thanks to Mikisz with a little modification of his code, the below has worked with me;</p>\n\n<pre><code>Dim txtFileName As String\nDim finalPath As String\n\nfinalPath = \"\\\\192.168.20.212\\networkfolder\\\"\nfinalPath = finalPath &amp; filenme &amp; \".xlsx\"\n\ntxtFileName = Application.GetSaveAsFilename(finalPath, \"Excel (*.xlsx), *.xlsx\", , \"Template saved on the Network\")\n\n        If txtFileName &lt;&gt; \"False\" Then\n         '-- Savethe file --\n         Application.DisplayAlerts = False\n         ActiveWorkbook.SaveAs FileName:=txtFileName, _\n                               FileFormat:=51\n        Application.DisplayAlerts = True\n    Else\n         '-- Popup message --\n         MsgBox \"Canceled saving the template!\", vbExclamation, \"Warning\"\n         'Exit Sub\n    End If\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 55607573, "answer_count": 2, "score": 0, "last_activity_date": 1554888830, "creation_date": 1554878430, "last_edit_date": 1554888830, "question_id": 55606210, "link": "https://stackoverflow.com/questions/55606210/macro-save-as-filename-not-working-when-saving-in-the-network-using-ip-address", "title": "Macro Save As filename not working when saving in the network using IP address", "body": "<p>I have working save as line for my VBA script in excel before and the file is saving to a network folder. Before, the server has name, now we access the server folders using an IP (192.168.20.212), hence I changed the address in code using the IP.</p>\n\n<p>Now, the problem is that the file naming I set is not working. When the dialog box appears, the filename is empty and the user needs to manually enter the filename. However, if I put a server name or use local address, the file naming is working. I have no choice but use the IP to save file.</p>\n\n<p>The following is the line for the file naming;</p>\n\n<pre><code>    filenme = \"PENDING CLAIMS_\" + szNextDatereformat\n</code></pre>\n\n<p>And the following is the line for saving the file before;</p>\n\n<pre><code>Dim sFileSaveName As String\n        sFileSaveName = Application.GetSaveAsFilename _\n                                     (InitialFileName:=\"\\\\SERVERNAME\\excel_files\\\" &amp; filenme &amp; sTargetFile, _\n                                      FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\n\n        If sFileSaveName &lt;&gt; \"False\" Then\n             '-- Savethe file --\n             Application.DisplayAlerts = False\n             ActiveWorkbook.SaveAs FileName:=sFileSaveName, _\n                                   FileFormat:=51\n            Application.DisplayAlerts = True\n        Else\n             '-- Popup message --\n             MsgBox \"Template not saved!\", vbExclamation, \"Warning\"\n        End If\n</code></pre>\n\n<p>The new one should be;</p>\n\n<pre><code>Dim sFileSaveName As String\n        sFileSaveName = Application.GetSaveAsFilename _\n                                     (InitialFileName:=\"\\\\192.168.20.212\\excel_files\\\" &amp; filenme &amp; sTargetFile, _\n                                      FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\n\n        If sFileSaveName &lt;&gt; \"False\" Then\n             '-- Savethe file --\n             Application.DisplayAlerts = False\n             ActiveWorkbook.SaveAs FileName:=sFileSaveName, _\n                                   FileFormat:=51\n            Application.DisplayAlerts = True\n        Else\n             '-- Popup message --\n             MsgBox \"Template not saved!\", vbExclamation, \"Warning\"\n        End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "memory-leaks"], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 3576175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37731c9a058d7b232b580921f91484db?s=128&d=identicon&r=PG&f=1", "display_name": "jfgoodhew1", "link": "https://stackoverflow.com/users/3576175/jfgoodhew1"}, "is_accepted": true, "score": 0, "last_activity_date": 1555568378, "creation_date": 1555568378, "answer_id": 55740125, "question_id": 55605933, "link": "https://stackoverflow.com/questions/55605933/memory-runs-out-by-running-continuous-loop-of-saveas-2003-xls-reopen-xlsm-clos/55740125#55740125", "title": "Memory runs out by running continuous loop of saveas 2003 xls, reopen xlsm, close 2003 xls", "body": "<p>Seconds required more memory for the number of seconds overnight, that's why it always failed on the last run during open hours. Changed to Long type instead of integer.</p>\n"}], "owner": {"reputation": 95, "user_id": 3576175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37731c9a058d7b232b580921f91484db?s=128&d=identicon&r=PG&f=1", "display_name": "jfgoodhew1", "link": "https://stackoverflow.com/users/3576175/jfgoodhew1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55740125, "answer_count": 1, "score": 0, "last_activity_date": 1555568378, "creation_date": 1554877309, "last_edit_date": 1555568326, "question_id": 55605933, "link": "https://stackoverflow.com/questions/55605933/memory-runs-out-by-running-continuous-loop-of-saveas-2003-xls-reopen-xlsm-clos", "title": "Memory runs out by running continuous loop of saveas 2003 xls, reopen xlsm, close 2003 xls", "body": "<p>[EDIT] I solved this: Integer doesn't have enough memory for the number of seconds overnight. So, changed to Long type and it works fine. Now I have a continuously updating Excel, database, CAD program and linked Excel fully automated 24-7! #SoHappy #CodeUpdatedBelow</p>\n\n<p>From ThisWorkbook module in Excel, I am using <code>Application.OnTime</code> to call a sub in Module1, which will save a macro-enabled workbook to 2003 xls filetype, open an Access database, refresh a database table which is linked to that 2003 xls, close Access, open the original xlsm again (triggers a new timer) and finally close the 2003 xls. The timer is set on <code>Workbook_Open</code> and killed on <code>Workbook_BeforeClose</code></p>\n\n<p>For some reason it's leaking memory (I think), so the computer running the code runs out of memory by the afternoon (give or take). </p>\n\n<p>Can anyone spot what I'm doing wrong, i.e. why it's hogging all that memory?</p>\n\n<p>1 thing I'm aware of is I never actually close the xlsm file: it's Saved As a xls. This means the Workbook_BeforeClose event in theory never triggers to cancel the timer. But, since the time (public variable <code>MyTime</code>) is passed by then and it's not a recurring loop... I'm hoping that is not the cause. </p>\n\n<p>I replaced the paths in Module1 with APATH for Access Path and EPATH for Excel Path - those are not erroneous variables, but hard-coded in the original (lazy, me?!)...</p>\n\n<p>ThisWorkbook looks like this:</p>\n\n<pre><code>Dim MyTime As Date\n\nPrivate Sub Workbook_Open()\n\n'Just in case you need to debug\n'Uncomment these 3 lines and click \"No\" on workbook open\n'Dim Ans As Variant\n'Ans = MsgBox(\"Do you want to run RefreshOnTime?\", vbYesNo, \"Yes/No\")\n'If Ans = vbYes Then RefreshOnTime\n\nRefreshOnTime\n\nEnd Sub\n\nSub RefreshOnTime()\n\nDim Seconds As Long\nDim OfficeOpens As Integer\nDim OfficeCloses As Integer\nDim Delay As Integer\n\n'Delay in seconds\nDelay = 240\nOfficeOpens = 7\nOfficeCloses = 17\n\n'If in working hours\nIf Hour(Time) &gt;= OfficeOpens And Hour(Time) &lt; OfficeCloses Then\n    Seconds = Delay\n'If in the morning\nElseIf Hour(Time) &lt; OfficeOpens Then\n    Seconds = (OfficeOpens - Hour(Time)) * 3600 + Delay\n'If after 5pm take 23:00 as highest hour of day, minus current hour\n'Add 7 for morning\n'Add 1 to take from 2300 to to midnight\nElseIf Hour(Time) &gt;= OfficeCloses Then\n    Seconds = (23 - Hour(Time) + OfficeOpens + 1) * 3600 + Delay\nEnd If\n\nDebug.Print \"Seconds = \" &amp; Seconds\n\nMyTime = DateAdd(\"s\", Seconds, Time)\nDebug.Print \"RefreshData will run at \" &amp; MyTime\n\n'REPLACE MODULE1 with the right module\n'REPLACE RefreshData with the name of your sub\nApplication.OnTime MyTime, \"Module1.RefreshData\"\n\nEnd Sub\n\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\n'REPLACE MODULE1 with the right module\n'REPLACE RefreshData with the name of your sub\nApplication.OnTime MyTime, \"Thisworkbook.RefreshData\", , False\n\n\nEnd Sub\n</code></pre>\n\n<p>Module1 looks like this:</p>\n\n<pre><code>Sub RefreshData()\n\n'Application.ScreenUpdating = False\n\n'Rebuild all calculations\nApplication.CalculateFullRebuild\n\n'Refresh all data connections\nApplication.Workbooks(\"Materials.xlsm\").RefreshAll\n\n'Complete all refresh events before moving on\nDoEvents\n\nDebug.Print \"Data Refreshed at \" &amp; Time\n\nCall SaveAsOld\n\nIf Application.ScreenUpdating = False Then Application.ScreenUpdating = True\n\nDebug.Print \"Operation Complete at \" &amp; Time\n\nEnd Sub\n\nSub SaveAsOld()\n\nOn Error Resume Next\n\n'Disable Screen Updating\n'Application.ScreenUpdating = False\n\n'Save Current\nThisWorkbook.Save\n\nDoEvents\n\nDebug.Print \"Macro Workbook Saved at \" &amp; Time\n\n'Disable alerts\nApplication.DisplayAlerts = False\n\n'Save As 2003 and overwrite\nThisWorkbook.SaveAs Filename:=\"EPATH\\Materials_2003.xls\", FileFormat:=56\n\nDebug.Print \"2003 xls copy saved at \" &amp; Time\n\n'Enable Alerts\nApplication.DisplayAlerts = True\n\n'Open the macro copy\nApplication.Workbooks.Open Filename:=\"EPATH\\Materials.xlsm\"\n\n''Enable ScreenUpdating\n'If Application.ScreenUpdating = False Then Application.ScreenUpdating = True\n\nThisWorkbook.Activate\n\nDebug.Print \"Macro version opened at \" &amp; Time\n\nCall DBOpenClose\n\n'Close the 2003 copy\nApplication.Workbooks(\"Materials_2003.xls\").Close (SaveChanges = True)\n\nDebug.Print \"2003 xls copy closed at \" &amp; Time\n\nEnd Sub\n\n\nSub DBOpenClose()\n\nDebug.Print \"DBOpenClose Started at \" &amp; Time\n\nDim appAccess As Access.Application\n\nSet appAccess = New Access.Application\n\nappAccess.Visible = True\n\nCall OpenCurrentDatabase(\"APath\\MCMat.mdb\")\n\nDebug.Print \"Access db opened at \" &amp; Time\n\nCurrentDb.TableDefs(\"CADT\").RefreshLink\n\nDebug.Print \"CADT Table refreshed at \" &amp; Time\n\nCall CloseCurrentDatabase\n\nDebug.Print \"Access DB Closed at \" &amp; Time\n\nEnd Sub\n</code></pre>\n\n<p>Thanks so much for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2728, "user_id": 10309342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e95623d18e7fff6249a8f4f922a9b22?s=128&d=identicon&r=PG&f=1", "display_name": "gehbiszumeis", "link": "https://stackoverflow.com/users/10309342/gehbiszumeis"}, "edited": false, "score": 0, "creation_date": 1554876286, "post_id": 55605601, "comment_id": 97906258, "body": "Welcome to stackoverflow. This is not a coding service website. Show us, what you have done so far in a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> and you&#39;ll get help"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11338308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sQgGF9bQ_PQ/AAAAAAAAAAI/AAAAAAAACHE/5Eeb-lDbc6I/photo.jpg?sz=128", "display_name": "Orkhan Abdullayev", "link": "https://stackoverflow.com/users/11338308/orkhan-abdullayev"}, "edited": false, "score": 0, "creation_date": 1554985362, "post_id": 55605752, "comment_id": 97955842, "body": "with this VBA code it will add the number till the 1000000, if you have python code that can run on anaconda spyder can be ok for me, python 3x or 2x, thank you for your time"}], "tags": [], "owner": {"reputation": 1259, "user_id": 3179957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/E4LGF.jpg?s=128&g=1", "display_name": "Programnik", "link": "https://stackoverflow.com/users/3179957/programnik"}, "is_accepted": false, "score": 0, "last_activity_date": 1554876497, "creation_date": 1554876497, "answer_id": 55605752, "question_id": 55605601, "link": "https://stackoverflow.com/questions/55605601/loop-add-sequence-number-delete-columns/55605752#55605752", "title": "Loop: add sequence number, delete columns", "body": "<pre><code>dim i as integer\ni = 1000\ndim max as integer\nmax = 1000000\nwhile i &lt; max\n   begin\n     set i = i + 1\n     ' do funky column editing , deleting, whatever \n   end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11338308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sQgGF9bQ_PQ/AAAAAAAAAAI/AAAAAAAACHE/5Eeb-lDbc6I/photo.jpg?sz=128", "display_name": "Orkhan Abdullayev", "link": "https://stackoverflow.com/users/11338308/orkhan-abdullayev"}, "edited": false, "score": 0, "creation_date": 1554899604, "post_id": 55606712, "comment_id": 97919310, "body": "thank you for your attention, it gave me the run time error 9, could not run"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 3, "user_id": 11338308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sQgGF9bQ_PQ/AAAAAAAAAAI/AAAAAAAACHE/5Eeb-lDbc6I/photo.jpg?sz=128", "display_name": "Orkhan Abdullayev", "link": "https://stackoverflow.com/users/11338308/orkhan-abdullayev"}, "edited": false, "score": 0, "creation_date": 1554986036, "post_id": 55606712, "comment_id": 97956257, "body": "This line? <i>.Columns(&quot;A:A&quot;).Clear</i>"}, {"owner": {"reputation": 3, "user_id": 11338308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sQgGF9bQ_PQ/AAAAAAAAAAI/AAAAAAAACHE/5Eeb-lDbc6I/photo.jpg?sz=128", "display_name": "Orkhan Abdullayev", "link": "https://stackoverflow.com/users/11338308/orkhan-abdullayev"}, "edited": false, "score": 0, "creation_date": 1555145105, "post_id": 55606712, "comment_id": 98014568, "body": "after Alt+F11 and I copy-paste your VBA code, and error windows pop-up and it says error line &#39;9&#39;, I did it in Spyder with Python code, but know I can not delete the last row of each excel file because of it contains some empty boxes, for example I need to delete the rows where C olumn has 0-zero value"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1554880275, "creation_date": 1554880275, "answer_id": 55606712, "question_id": 55605601, "link": "https://stackoverflow.com/questions/55605601/loop-add-sequence-number-delete-columns/55606712#55606712", "title": "Loop: add sequence number, delete columns", "body": "<p>A possible solution:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowC As Long, i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Let us assume that values appear in Column C. Find last row of column C\n        LastRowC = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n        'Add Values in Column B\n        For i = 1 To LastRowC\n            .Range(\"B\" &amp; i).Value = i + 1000\n        Next i\n\n        'Clear Column A\n        .Columns(\"A:A\").Clear\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11338308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sQgGF9bQ_PQ/AAAAAAAAAAI/AAAAAAAACHE/5Eeb-lDbc6I/photo.jpg?sz=128", "display_name": "Orkhan Abdullayev", "link": "https://stackoverflow.com/users/11338308/orkhan-abdullayev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55606712, "answer_count": 2, "score": 0, "last_activity_date": 1554983970, "creation_date": 1554875759, "last_edit_date": 1554983970, "question_id": 55605601, "link": "https://stackoverflow.com/questions/55605601/loop-add-sequence-number-delete-columns", "title": "Loop: add sequence number, delete columns", "body": "<p>I want to know the VBA script for the Loop: Add sequence number (start number 1000 and 1001,1002,1003 so on) to the specific column and delete the another specific columns from multiple excel files into one folder. The purpose is to have the exact excel format to process the data in the special software.\nI am beginner with VBA code.\nThank you for your time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1554877389, "post_id": 55605595, "comment_id": 97906689, "body": "<code>cel.Offset(-1,0).value</code> would refer to value of Cell above and similarly  <code>cel.Offset(1,0).value</code> would refer to value of Cell below."}, {"owner": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1554880203, "post_id": 55605595, "comment_id": 97908029, "body": "Thank you. I need to extract text string from within a single cell."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554880660, "post_id": 55605595, "comment_id": 97908296, "body": "Your question has no sense. You need to extract 03 from &quot;03-Treble&quot; alongside Treble, and the output is gonna be 03-Treble? What are you really asking for?"}, {"owner": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "edited": false, "score": 0, "creation_date": 1554895837, "post_id": 55605595, "comment_id": 97917058, "body": "Oops. trying to make things clear. 03-Treble is a part of a large paragraph. Like below. Now I need to extract only the 03-Treble part"}, {"owner": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "edited": false, "score": 0, "creation_date": 1554895989, "post_id": 55605595, "comment_id": 97917135, "body": "We have mentioned our considerations.            It contains following:   03-Treble 09-Bass  Following are our considerations:"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1554898131, "post_id": 55605595, "comment_id": 97918435, "body": "Please edit your question to provide examples of your data with desired output.  Please paste it as text (or use a Markdown Table Generator) as screenshots are difficult to copy/paste into Excel for testing."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "edited": false, "score": 0, "creation_date": 1554896721, "post_id": 55607148, "comment_id": 97917563, "body": "I am not looking for output in message box. The output should contain only text with the prefix. For example, I have a paragraph in a single cell with text content 03-Treble. Now I want to get output as just 03-Treble in another sheet. &#39;03&#39; would be random. Like 03-Treble,04-Treble,55-Treble, while &#39;Treble&#39; would be constant."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "edited": false, "score": 0, "creation_date": 1554898554, "post_id": 55607148, "comment_id": 97918683, "body": "See edited answer. If it solves your question then you may consider marking it as accepted. Thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1554898508, "last_edit_date": 1554898508, "creation_date": 1554881815, "answer_id": 55607148, "question_id": 55605595, "link": "https://stackoverflow.com/questions/55605595/how-to-extract-a-text-and-the-text-string-associated-with-it-in-excel-using-vba/55607148#55607148", "title": "How to extract a text and the text string associated with it in Excel using VBA?", "body": "<p>use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\"><code>Autofilter()</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.replace\" rel=\"nofollow noreferrer\"><code>Replace</code></a> method of <code>Range</code> object</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    With Worksheets(\"Sheet1\")\n\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n            .AutoFilter 1, \"*Treble*\"\n            If CBool(Application.Subtotal(103, .Cells)) Then\n                With .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible)\n                    .Copy Worksheets(\"Sheet2\").Range(\"A2\")\n                    Worksheets(\"Sheet2\").Range(\"A2\").Resize(.Count).Replace what:=\"Treble*\", lookat:=xlPart, Replacement:=\"Treble\"\n                End With\n            End If\n        End With\n        .AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11338319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7FUJpXhG4sc/AAAAAAAAAAI/AAAAAAAAGyg/chHZlnp8zbM/photo.jpg?sz=128", "display_name": "Joshua Enoch", "link": "https://stackoverflow.com/users/11338319/joshua-enoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554898508, "creation_date": 1554875728, "last_edit_date": 1554876521, "question_id": 55605595, "link": "https://stackoverflow.com/questions/55605595/how-to-extract-a-text-and-the-text-string-associated-with-it-in-excel-using-vba", "title": "How to extract a text and the text string associated with it in Excel using VBA?", "body": "<p>I trying to extract specific text line using VBA. The program code must search and find for a keyword and then capture all the associated text/numbers/characters next/before/after that keyword</p>\n\n<p>I tried the program for searching for a specific keyword and it worked out. Now I need to capture data that's before the keyword. Ex: Keyword is Treble. and the paragraph in the cell contains 03-Treble.\nNow I need to extract the value 03 also alongside Treble. Like 03-Treble</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nWith Worksheets(\"Sheet1\")\n\n  For Each cel In .Range(.Range(\"A1\"), .Range(\"A1\").End(xlDown))\n\n     If cel.Value Like \"*Treble*\" Then\n         Worksheets(\"Sheet2\").Range(\"A2\").Value = \"Treble\"\n\n     End If\n\n  Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1554874965, "post_id": 55605187, "comment_id": 97905851, "body": "if you are trying to count columns between D4 and the last significant column the use <code>DAU_col = wb.Sheets(&quot;DAU&quot;).Range(&quot;D4&quot;, wb.Sheets(&quot;DAU&quot;).Range(&quot;D4&quot;).End(xlToRight)).Count</code>.. if you want the last column number then mayuse <code>DAU_col = wb.Sheets(&quot;DAU&quot;).Range(&quot;D4&quot;).End(xlToRight).Column</code>"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1554875446, "post_id": 55605187, "comment_id": 97906002, "body": "ok, i know, i should let the Range(&quot;D4&quot;).End(xlToRight) know which  tab I am using"}], "owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1554889108, "answer_count": 0, "score": 0, "last_activity_date": 1554889039, "creation_date": 1554873587, "last_edit_date": 1554889039, "question_id": 55605187, "link": "https://stackoverflow.com/questions/55605187/runtime-error-1004-application-defined-or-object-defined-error-for-counting-cell", "closed_reason": "Duplicate", "title": "Runtime error 1004 application-defined or object-defined error for counting cells", "body": "<p>I got this error message when I try to count how many no-empty cells for a certain row, check several question from other people related to that, I think I already assign which tab I would like to count (DAU) </p>\n\n<pre><code>Option Explicit\n\nSub Adjust_col()\n    Dim wb As Workbook\n    Dim App_list As Long, DAU_col As Long\n\n    Set wb = ThisWorkbook\n\n    App_list = wb.Sheets(\"App Name Map\").Range(\"B2\").End(xlDown).Row\n\n    DAU_col = wb.Sheets(\"DAU\").Range(\"D4\", Range(\"D4\").End(xlToRight)).Count\n\n    MsgBox DAU_col\nEnd Sub\n</code></pre>\n\n<p>What it keep giving me the error for my Variable DAU_col, if I choose the active tab is DAU, it works well, otherwise it won't work.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554888804, "post_id": 55605114, "comment_id": 97912930, "body": "The correct index value for <code>Sections</code> is <i>not</i> a page number. This isn&#39;t how Word works with headers/footers. It isn&#39;t possible to read the exact text of the header/footer for a particular page. You need to describe in more detail (in the question, please) what you need to do with the information coming from the Word document."}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 0, "creation_date": 1555009729, "post_id": 55622161, "comment_id": 97969941, "body": "will try this out"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 2, "last_activity_date": 1555023826, "last_edit_date": 1555023826, "creation_date": 1554935393, "answer_id": 55622161, "question_id": 55605114, "link": "https://stackoverflow.com/questions/55605114/how-to-get-page-header-not-section-headers-in-vba/55622161#55622161", "title": "How to get Page Header not Section Headers in VBA", "body": "<p>Try something along the lines of:</p>\n\n<pre><code>wdDoc.Range.GoTo(What:=wdGoToPage, Name:=i).Sections.First.Headers(wdHeaderFooterPrimary).Range.Text\n</code></pre>\n\n<p>where i is the page number.</p>\n\n<p><strong>Note:</strong> The above code assumes you're using early binding. For late binding, use something along the lines of:</p>\n\n<pre><code>wdDoc.Range.GoTo(1, i).Sections.First.Headers(1).Range.Text\n</code></pre>\n"}], "owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55622161, "answer_count": 1, "score": 0, "last_activity_date": 1555023826, "creation_date": 1554873177, "last_edit_date": 1554888578, "question_id": 55605114, "link": "https://stackoverflow.com/questions/55605114/how-to-get-page-header-not-section-headers-in-vba", "title": "How to get Page Header not Section Headers in VBA", "body": "<p>I'm struggling to get the page header from a word document with hundreds of pages,\nit has different headers</p>\n\n<p>my code:</p>\n\n<pre><code>pageHeader = wdDoc.Sections(pageNumber).Headers(1).Range.Text\n</code></pre>\n\n<p>this code gets the headers for the Section but not spefic header of the page. Therefor there are chances that the header is incorrect.</p>\n\n<p>my only input is the pageNumber</p>\n\n<p>context: I'm importing word document to excel and each word page has tables, these tables are associated with their unique number apparently placed in the header of each page, so different pages can have different header</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 61, "user_id": 6441562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E2h7P.png?s=128&g=1", "display_name": "MikeR", "link": "https://stackoverflow.com/users/6441562/miker"}, "edited": false, "score": 0, "creation_date": 1554875759, "post_id": 55604945, "comment_id": 97906098, "body": "why do you want to do it with Vba? A simple Excel formula can do it"}], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 11338131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDSdPyNwwUk/AAAAAAAAAAI/AAAAAAAAAJk/quAzt1HaEno/photo.jpg?sz=128", "display_name": "Prasetya Giri", "link": "https://stackoverflow.com/users/11338131/prasetya-giri"}, "edited": false, "score": 0, "creation_date": 1557209662, "post_id": 55607616, "comment_id": 98676883, "body": "@PrasetyaGiri glad to hear that i help. if you are satisfy with the answer please void it."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1554883478, "creation_date": 1554883478, "answer_id": 55607616, "question_id": 55604945, "link": "https://stackoverflow.com/questions/55604945/how-to-add-value-on-cell-during-range-of-date/55607616#55607616", "title": "How to add value on cell during range of date", "body": "<p>Use the below formula in column C:</p>\n\n<pre><code>=IF((OR(TEXT(B2,\"MMM\")=\"Jan\",TEXT(B2,\"MMM\")=\"Feb\",TEXT(B2,\"MMM\")=\"Mar\",TEXT(B2,\"MMM\")=\"Apr\"))=TRUE,\"JFMA\",IF((OR(TEXT(B2,\"MMM\")=\"May\",TEXT(B2,\"MMM\")=\"Jun\",TEXT(B2,\"MMM\")=\"Jul\",TEXT(B2,\"MMM\")=\"Aug\"))=TRUE,\"MJJA\",IF((OR(TEXT(B2,\"MMM\")=\"Sep\",TEXT(B2,\"MMM\")=\"Oct\",TEXT(B2,\"MMM\")=\"Nov\",TEXT(B2,\"MMM\")=\"Dec\"))=TRUE,\"SOND\")))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11338131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDSdPyNwwUk/AAAAAAAAAAI/AAAAAAAAAJk/quAzt1HaEno/photo.jpg?sz=128", "display_name": "Prasetya Giri", "link": "https://stackoverflow.com/users/11338131/prasetya-giri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554983960, "creation_date": 1554872050, "last_edit_date": 1554983960, "question_id": 55604945, "link": "https://stackoverflow.com/questions/55604945/how-to-add-value-on-cell-during-range-of-date", "title": "How to add value on cell during range of date", "body": "<p>I'm very new to VBA just learned past week through youtube.<br>\nI want my userform to be able to change value of cell based on date.</p>\n\n<p>Example:</p>\n\n<pre><code>(A2:A10): Person name\n(B2:B10): Birthday\n(C2:C10): Target Cell\n</code></pre>\n\n<p>If I want that person who have birthday \n<code>JAN, FEB, MARCH, APRIL</code> in target cell to be JFMA with help of userform.<br>\nHow can I do this? Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1259, "user_id": 3179957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/E4LGF.jpg?s=128&g=1", "display_name": "Programnik", "link": "https://stackoverflow.com/users/3179957/programnik"}, "edited": false, "score": 0, "creation_date": 1554871873, "post_id": 55604877, "comment_id": 97904974, "body": "the if condition checking on whether combo box is enabled is the first thing hit, so other code which checks for what option has been selected never gets called.  Refactor your code so it isn&#39;t a bit if else list"}], "answers": [{"tags": [], "owner": {"reputation": 1259, "user_id": 3179957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/E4LGF.jpg?s=128&g=1", "display_name": "Programnik", "link": "https://stackoverflow.com/users/3179957/programnik"}, "is_accepted": false, "score": 0, "last_activity_date": 1554872087, "creation_date": 1554872087, "answer_id": 55604952, "question_id": 55604877, "link": "https://stackoverflow.com/questions/55604877/i-want-to-use-1-combobox-to-navigate-many-sheets-that-refer-to-items-that-combob/55604952#55604952", "title": "I want to use 1 Combobox to navigate many sheets that refer to items that Combobox contain", "body": "<p>Try arranging the code like this:</p>\n\n<pre><code>If Not IsNumeric(TextBox2.Value) Then\n    MsgBox \"Only numbers allowed\", vbCritical\n    TextBox2.Text = \"\"\n    TextBox2.SetFocus\n\nElseIf Me.ComboBox1.Value = \"\" Then\n    MsgBox \"Please Select the Stencil ID\", vbCritical\n    ComboBox1.Text = \"\"\n    ComboBox1.SetFocus\nend if\n\nIf ComboBox1.Enabled = True Then\n    a = WorksheetFunction.CountA(Sheet10.Range(\"a3:a1000000\"))\n    a = a + 3\n    Sheet10.Cells(a, 1) = TextBox2.Text\n    Sheet10.Cells(a, 2) = ComboBox1.Text\n    Sheet10.Cells(a, 3) = DTPicker1.Value\n    Sheet10.Cells(a, 4) = TextBox1.Text\nend if\n\nIf ComboBox1.Text = \"1\" Then\n    ThisWorkbook.Sheets(\"Sheet1\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet1\").Select\n    ThisWorkbook.Sheets(\"Sheet1\").Range(\"a1\").Select\n\nElseIf ComboBox1.Text = \"2\" Then\n    ThisWorkbook.Sheets(\"Sheet2\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet2\").Select\n    ThisWorkbook.Sheets(\"Sheet2\").Range(\"a1\").Select\n\nElseIf ComboBox1.Text = \"3\" Then\n    ThisWorkbook.Sheets(\"Sheet3\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet3\").Select\n    ThisWorkbook.Sheets(\"Sheet3\").Range(\"a1\").Select\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11338066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7e2tfNlqKB0/AAAAAAAAAAI/AAAAAAAAHSA/p57m1o_zyh4/photo.jpg?sz=128", "display_name": "Keo Sothun", "link": "https://stackoverflow.com/users/11338066/keo-sothun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554983957, "creation_date": 1554871543, "last_edit_date": 1554983957, "question_id": 55604877, "link": "https://stackoverflow.com/questions/55604877/i-want-to-use-1-combobox-to-navigate-many-sheets-that-refer-to-items-that-combob", "title": "I want to use 1 Combobox to navigate many sheets that refer to items that Combobox contain", "body": "<p>I got 1 ComboBox1 contains 5 items. There is 1,2,3,4, and 5 and they all represent for Sheet1, Sheet2, Sheet3, Sheet4 and Sheet 5 respectively. If I chose item 1 in ComboBox, then I click on CommandButton1 then it will show up the Sheet1. The same if I chose item 2, 3, 4 or 5 it will show up Sheet2, Sheet3, Sheet4 and Sheet 5 respectively.</p>\n\n<p>The problem is I want to use only 1 CommandButton to navigate those Sheets</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim a As Integer\n    a = 3\nIf Not IsNumeric(TextBox2.Value) Then\n    MsgBox \"Only numbers allowed\", vbCritical\n    TextBox2.Text = \"\"\n    TextBox2.SetFocus\n\nElseIf Me.ComboBox1.Value = \"\" Then\n    MsgBox \"Please Select the Stencil ID\", vbCritical\n    ComboBox1.Text = \"\"\n    ComboBox1.SetFocus\n\nElseIf ComboBox1.Enabled = True Then\n    a = WorksheetFunction.CountA(Sheet10.Range(\"a3:a1000000\"))\n    a = a + 3\n    Sheet10.Cells(a, 1) = TextBox2.Text\n    Sheet10.Cells(a, 2) = ComboBox1.Text\n    Sheet10.Cells(a, 3) = DTPicker1.Value\n    Sheet10.Cells(a, 4) = TextBox1.Text\n\nElseIf ComboBox1.Text = \"1\" Then\n    ThisWorkbook.Sheets(\"Sheet1\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet1\").Select\n    ThisWorkbook.Sheets(\"Sheet1\").Range(\"a1\").Select\n\nElseIf ComboBox1.Text = \"2\" Then\n    ThisWorkbook.Sheets(\"Sheet2\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet2\").Select\n    ThisWorkbook.Sheets(\"Sheet2\").Range(\"a1\").Select\n\nElseIf ComboBox1.Text = \"3\" Then\n    ThisWorkbook.Sheets(\"Sheet3\").Visible = True\n    ThisWorkbook.Sheets(\"Sheet3\").Select\n    ThisWorkbook.Sheets(\"Sheet3\").Range(\"a1\").Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 5535343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5beca5b86579dd3f90a5e5f07f6c77?s=128&d=identicon&r=PG&f=1", "display_name": "K&#252;rsat Aydinli", "link": "https://stackoverflow.com/users/5535343/k%c3%bcrsat-aydinli"}, "is_accepted": false, "score": 1, "last_activity_date": 1554890146, "creation_date": 1554890146, "answer_id": 55609699, "question_id": 55604822, "link": "https://stackoverflow.com/questions/55604822/need-to-send-separate-emails-to-multiple-recipients-from-excel-list/55609699#55609699", "title": "Need to send separate emails to multiple recipients from excel list", "body": "<p>Try it this way:</p>\n\n<pre><code>'Initialize objects\nDim objOutlook As Outlook.Application\nDim objOutlookMsg As Outlook.MailItem\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objOutlookMsg = objOutlook.CreateItem(olMailItem)\n\n\n\nWith objOutlookMsg\n  .To = ws.Range(\"A1\") 'Assuming TO mail addresses are located here and separated with \";\"\n  .CC = ws.Range(\"B1\") 'Assuming TO mail addresses are located here and separated with \";\"\n  .Subject = ws.Range(\"C1\") 'Assuming subject is declared here\n  .HTMLBody = ws.Range(\"D1\") 'Assuming body is declared here\n  If address_attachment_line.Value &lt;&gt; \"\" Then\n    .Attachments.Add FilePath &amp; FileName\n  End If\n  .Display\nEnd With\n</code></pre>\n\n<p>Through storing the dynamic information in the ranges referenced by the code, you can control the single mails.</p>\n\n<p>Furhermore to make linebreaks in the body text, just use the tag <code>&lt;br&gt;</code> as it is interpreted as HTML content.</p>\n\n<p>Hope this helps you!</p>\n"}], "owner": {"reputation": 11, "user_id": 8065110, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155297318578959/picture?type=large", "display_name": "Pratyush Dash", "link": "https://stackoverflow.com/users/8065110/pratyush-dash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592609949, "creation_date": 1554871105, "last_edit_date": 1592609949, "question_id": 55604822, "link": "https://stackoverflow.com/questions/55604822/need-to-send-separate-emails-to-multiple-recipients-from-excel-list", "title": "Need to send separate emails to multiple recipients from excel list", "body": "<p>I have an excel list of people. I want to send emails to all as separate mails. Need to dynamically change the subject,body and recipients.</p>\n\n<p>I have tried using vba and doing it. But i do not know how to dynamically change the subject and body. Also how can i enter multiple lines in the body?</p>\n\n<p>i do not want all recipients to be sent the same mail.<a href=\"https://i.stack.imgur.com/9LO6s.png\" rel=\"nofollow noreferrer\">Image shows the field names in excel</a>\nI need to have first name and first letter of last name in subject. And in body first line includes Hi firstname..And personal mail goes in the \"to\" field and professional as \"cc\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554872187, "post_id": 55604799, "comment_id": 97905045, "body": "Can you narrow the question down to what is actually causing you trouble. For example, do you need help creating a loop that includes all sheets in a workbook?"}, {"owner": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "reply_to_user": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554873738, "post_id": 55604799, "comment_id": 97905465, "body": "ok, so all i want is when new sheet is created , and i enter data for example i enter 5 in quantity as you can see images above. i want the entered data in new sheet to be added in the production sheet.  for example if 3 customers order one bread loaf i want all these to be added and shown in production sheet."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554873984, "post_id": 55604799, "comment_id": 97905534, "body": "How is the data getting to the front page? By a macro or by a formula?"}, {"owner": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "reply_to_user": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554874652, "post_id": 55604799, "comment_id": 97905754, "body": "its by formula. but all i want is combine the &#39;order&#39; column data of all sheets. so i want data entered in &#39;order&#39; in newly created sheet to be SUM with &#39;order&#39; column front page in front page."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554875212, "post_id": 55604799, "comment_id": 97905933, "body": "Okay, so is your actual problem then: How to create/update a sum formula to include new sheets added by a macro?"}, {"owner": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "reply_to_user": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1554875311, "post_id": 55604799, "comment_id": 97905959, "body": "yes. you got that right. sorry i am bad at explaining"}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1554878264, "creation_date": 1554878264, "answer_id": 55606168, "question_id": 55604799, "link": "https://stackoverflow.com/questions/55604799/how-to-send-cell-data-from-template-sheet-to-main-sheet-in-microsoft-excel/55606168#55606168", "title": "How to send cell data from template sheet to main sheet in Microsoft excel?", "body": "<p>If all sheets have the same layout, the simplest method is to use formulas with sheet ranges. If you need to start off with less than 2 invoices, then create two dummy invoice sheets with all Orders as blank or zero so they don't impact the totals. If the two dummy sheets are called A and B, then create formulas like this on your main page:</p>\n\n<pre><code>=SUM(A:B!A1)\n</code></pre>\n\n<p>This will sum cell A1 on all sheets between sheets A and B.</p>\n\n<p>Make sure sheets A and B are the last two sheets in your workbook then change your code to insert all new invoices in between them:</p>\n\n<pre><code>Sheets.Add before:=Sheets(\"B\")\n</code></pre>\n\n<p>Then hide sheets A and B so that users can't see them. You can make it so that users can't unhide them by using a special setting available in the visual basic editor. In the visual basic editor, select the sheet, make sure Properties are visible from the View menu, then set the Visible property to Very Hidden:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VBJJF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VBJJF.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>The other approach is to modify the formula strings for every formula to include the new sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "edited": false, "score": 0, "creation_date": 1554961143, "post_id": 55611214, "comment_id": 97942930, "body": "thank you so much .I understood the code so which event should i call this code in.sorry I am coming from java background ."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "edited": false, "score": 0, "creation_date": 1554965010, "post_id": 55611214, "comment_id": 97944378, "body": "You could assign it to a button in your <code>Production</code> worksheet for example. In that way the user could create multiple new customer sheets, complete the appropriate data and when they are done they can go to the <code>Production</code> worksheet and press the button to update the orders overview."}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 1, "last_activity_date": 1554895881, "last_edit_date": 1554895881, "creation_date": 1554894965, "answer_id": 55611214, "question_id": 55604799, "link": "https://stackoverflow.com/questions/55604799/how-to-send-cell-data-from-template-sheet-to-main-sheet-in-microsoft-excel/55611214#55611214", "title": "How to send cell data from template sheet to main sheet in Microsoft excel?", "body": "<p>So, if I get this right, you have a master worksheet named <code>Production</code>, a worksheet that serves as a template for the invoices, named <code>Invoice</code> and two other worksheets named <code>Recipes</code> and <code>Nav</code>. </p>\n\n<p>For now I will assume you don't have any more worksheets.</p>\n\n<p>Each time you create a new customer, a new worksheet is created based on the <code>Invoice</code> template. What you need is some code that will calculate the sum of all the individual orders, which then should be populated in the <code>Production</code> sheet.</p>\n\n<p>My suggestion would look like that:</p>\n\n<pre><code>Sub updateTotalOrders()\nDim sht As Worksheet\nDim sumOfOrders As Long\nsumOfOrders = 0\nFor Each sht In ThisWorkbook.Worksheets\n    If sht.Name &lt;&gt; \"Production\" And sht.Name &lt;&gt; \"Invoice\" And sht.Name &lt;&gt; \"Nav\" Then 'add here any other sheets that should be excluded from the sum\n        sumOfOrders = sumOfOrders + sht.Range(\"C4\")\n    End If\nNext sht\nThisWorkbook.Worksheets(\"Production\").Range(\"\") = sumOfOrders 'Use whichever range you want\nEnd Sub\n</code></pre>\n\n<p>The code I provided only works for \"Sandwich Loaf\" obviously, but can easily be extended to include all other items. I am just giving you an idea on how to continue.</p>\n\n<p>To summarize, this code basically loops through all the worksheets and checks if they correspond to a customer. If they do, then it updates a sum. When the looping stops, the final result is passed to <code>Production</code>.</p>\n"}], "owner": {"reputation": 259, "user_id": 8395668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/385fbb28adf38bce94d8d9ff3bf878bd?s=128&d=identicon&r=PG&f=1", "display_name": "judy", "link": "https://stackoverflow.com/users/8395668/judy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55611214, "answer_count": 2, "score": 0, "last_activity_date": 1554895881, "creation_date": 1554870892, "last_edit_date": 1554888407, "question_id": 55604799, "link": "https://stackoverflow.com/questions/55604799/how-to-send-cell-data-from-template-sheet-to-main-sheet-in-microsoft-excel", "title": "How to send cell data from template sheet to main sheet in Microsoft excel?", "body": "<p>I am creating a production management sheet for a cafe. which has a main sheet called production, Production has a new customer button which creates a new sheets and pro-grammatically copy invoice Template and pastes in newly created sheet . all i want automatically send and SUM the total of each item form all sheets to the master Production sheet. i can do it in general but when inserting new template(in newly created sheet) using button click its a bit tricky.</p>\n\n<pre><code> Private Sub CommandButton1_Click()\nIf TextBox1.Value = \"\" Or TextBox2.Value = \"\" Then\n   If MsgBox(\"Name and Address are Important\", vbQuestion + vbOKOnly) &lt;&gt; vbYes Then\n\n\n   Exit Sub\n   End If\n  End If\n\nTotalSheets = ThisWorkbook.Worksheets.Count\nCheckSheet = TextBox1.Value\n\nFor i = 1 To TotalSheets\n If LCase(ThisWorkbook.Worksheets(i).Name) = LCase(CheckSheet) Then\n   If MsgBox(\"This Customer Name Already Exists, Choose a different Name\", vbQuestion + vbOKOnly) &lt;&gt; vbYes Then\n\n\n  Exit Sub\n\n End If\nEnd If\n\n\nNext\nSheets.Add after:=Sheets(Sheets.Count)\nSheets(ActiveSheet.Name).Name = TextBox1.Value\nWorksheets(\"Invoice\").Cells.Copy Worksheets(ActiveSheet.Name).Cells\n\nEnd Sub \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lpcpZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lpcpZ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/IHVls.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IHVls.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/X6DRv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X6DRv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1554872291, "post_id": 55604720, "comment_id": 97905073, "body": "From Help <i>You passed an invalid parameter in your procedure call. This could be because the parameter was out of range, or contained invalid data. Alternately, you may have invoked a procedure at an unexpected time.  To correct this error   Verify that the parameters being passed to the procedure are valid.  Verify that you are calling the function at an appropriate time.</i>. So msgbox out the paths."}, {"owner": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "reply_to_user": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1554875041, "post_id": 55604720, "comment_id": 97905883, "body": "For the local path i.e. C:\\blahblah blah  it works well. i.e. moving Folders. For modified path i.e. \\?\\\\G:\\blahblahblah ( actual network path is G:\\blahblahblah ) ; the access is capable of creating New Folder in the network path.                                          However only Folder Movement is not happening with \\?\\\\G:blahblahblah"}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1554884902, "post_id": 55604720, "comment_id": 97910595, "body": "You can&#39;t use these paths. Use conventional paths. <code>\\\\?\\ </code> has noting to do with networks. Networks are <code>\\\\servername\\sharename\\folder\\file.ext</code>"}, {"owner": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "reply_to_user": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1554961427, "post_id": 55604720, "comment_id": 97943021, "body": "Actually before your comments only, I removed \\\\?\\   and it was working all good. \\\\?\\ was creating confusion to MS Access in recognizing path, &amp; thus was throwing error.  Thanks for your help @Noodles"}, {"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 0, "creation_date": 1554963937, "post_id": 55604720, "comment_id": 97943941, "body": "It&#39;s nothing to do with Access. Its to do with &quot;Scripting.FileSystemObject&quot;. Pathnames are limited to 260 characters, so programs only allocate a maximum of that to store paths (520 bytes). NTFS allows paths of 32K characters. <code>\\\\?\\ </code> tells windows the programs knows the path can be up to 32K and Windows turns off checks for legal windows filenames."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "edited": false, "score": 0, "creation_date": 1554879489, "post_id": 55605532, "comment_id": 97907651, "body": "Can u please suggest how would my &#39;Set objF &#39; would be defined as...?"}, {"owner": {"reputation": 7, "user_id": 6441535, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FoPa4ai2irw/AAAAAAAAAAI/AAAAAAAABNI/fJjySC4naDQ/photo.jpg?sz=128", "display_name": "Parth Patalia", "link": "https://stackoverflow.com/users/6441535/parth-patalia"}, "reply_to_user": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "edited": false, "score": 0, "creation_date": 1555497673, "post_id": 55605532, "comment_id": 98130109, "body": "Dim objF As New Scripting.FileSystemObject Set f = objF.GetFile(PATH_TO_COPY) f.Copy PATH_TO_MOVE"}], "tags": [], "owner": {"reputation": 7, "user_id": 6441535, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FoPa4ai2irw/AAAAAAAAAAI/AAAAAAAABNI/fJjySC4naDQ/photo.jpg?sz=128", "display_name": "Parth Patalia", "link": "https://stackoverflow.com/users/6441535/parth-patalia"}, "is_accepted": false, "score": 0, "last_activity_date": 1554875435, "creation_date": 1554875435, "answer_id": 55605532, "question_id": 55604720, "link": "https://stackoverflow.com/questions/55604720/move-folders-in-network-location-using-access-vba/55605532#55605532", "title": "Move folders in network location using Access VBA", "body": "<p>Use Microsoft.Scripting.Runtime file object to move folder.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554961938, "creation_date": 1554961938, "answer_id": 55625550, "question_id": 55604720, "link": "https://stackoverflow.com/questions/55604720/move-folders-in-network-location-using-access-vba/55625550#55625550", "title": "Move folders in network location using Access VBA", "body": "<p><strong>We can't use these <code>\\\\?\\</code> paths.</strong> Should use conventional paths. <code>\\\\?\\</code> has noting to do with networks. Networks are <code>\\\\servername\\sharename\\folder\\file.ext</code></p>\n\n<p>I removed <code>\\\\?\\</code> and it was working all good. <code>\\\\?\\</code> was creating confusion to MS Access in recognizing path, &amp; thus was throwing error.</p>\n"}], "owner": {"reputation": 1, "user_id": 11315645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DGnTMFXfYao/AAAAAAAAAAI/AAAAAAAAAMs/oSHo8n3LZAI/photo.jpg?sz=128", "display_name": "Mahesh Bolavakar", "link": "https://stackoverflow.com/users/11315645/mahesh-bolavakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558190230, "creation_date": 1554870365, "last_edit_date": 1558190230, "question_id": 55604720, "link": "https://stackoverflow.com/questions/55604720/move-folders-in-network-location-using-access-vba", "title": "Move folders in network location using Access VBA", "body": "<p>I want to move folders which are on network using Access VBA.</p>\n\n<p>When I click button on form, it shall execute VBA code.</p>\n\n<p>The below program moves local PC folders, when <code>\\\\?\\</code> is removed from the code.  Using <code>\\\\?\\</code> before any network folder path, it is creating new folder on network. </p>\n\n<p>When I want to move folders it is giving:</p>\n\n<blockquote>\n  <p><strong>Run time Error 5 : Invalid Procedure call or Argument.</strong></p>\n</blockquote>\n\n<p>Upon debug , it highlights <code>objF.MoveFolder oldStr, newStr</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btnBrowse_Click()\nDim oldStr As String\nDim newStr As String\nDim objF As Object\n\nMe.OldPath = Me.FolderPath\nMe.NewPath = GetFolder()\n\nIf Len(Me.NewPath) &gt; 0 Then\n     Me.NewPath = \"\\\\?\\\" &amp; Me.NewPath\n     Me.FolderPath = Me.NewPath\n\n     Set objF = CreateObject(\"Scripting.FileSystemObject\")\n\n     oldStr = Me.OldPath &amp; \"\\*\"\n     newStr = Me.NewPath &amp; \"\\\"\n\n     objF.MoveFolder oldStr, newStr\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 0, "creation_date": 1554873956, "post_id": 55605223, "comment_id": 97905526, "body": "Hi thanks for the reply, I am currently cannot use wdActiveEndSectionNumber as Im doing this on excel vba, can you provide the constant for it"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 0, "creation_date": 1554874272, "post_id": 55605223, "comment_id": 97905627, "body": "It is 2, but you can word constants if you add a reference to the word object model. I&#39;ve updated answer on how to do that too and you should look into early binding, as it makes coding much easier."}, {"owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 0, "creation_date": 1554874475, "post_id": 55605223, "comment_id": 97905689, "body": "Thanks Micheal, I&#39;m getting 0 for section number, i think maybe because of the <code>ActiveWindow</code>, <code>wdDoc</code> is the word object I am using, even though I change it still 0"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 1, "creation_date": 1554874989, "post_id": 55605223, "comment_id": 97905860, "body": "Updated to refer to the windows of wdDoc. If it can&#39;t find the windows of wdDoc, then you&#39;ll need to activate it first using:    wdDoc.Activate"}, {"owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "edited": false, "score": 0, "creation_date": 1554875459, "post_id": 55605223, "comment_id": 97906007, "body": "I&#39;ve use <code>.Activate</code> and its working as intended so far, I&#39;m testing this on all of my documents. Thank you very much Michael!"}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1554874819, "last_edit_date": 1554874819, "creation_date": 1554873779, "answer_id": 55605223, "question_id": 55604588, "link": "https://stackoverflow.com/questions/55604588/how-can-i-get-the-header-of-specific-pages-of-word-importing-using-excel-vba/55605223#55605223", "title": "How can I get the header of specific pages of word importing using excel vba", "body": "<p>Word doesn't have a proper \"Pages\" object because it doesn't arrange content by page. A page isn't an object that contains content. A page is just whatever content currently fits on it. A document is a long stream of content that gets split across pages depending on what it is and how big it is.</p>\n\n<p>That said, here's a way to try to identify the section number at the start of the specified page, which should identify the header used on that page:</p>\n\n<pre><code>sectionNumber = wdDoc.Windows(1).Panes(1).Pages(pageNumber).Rectangles(1).Range.Information(wdActiveEndSectionNumber)\n\npageHeader = wdDoc.Sections(sectionNumber).Headers(1).Range.Text\n</code></pre>\n\n<p>wdActiveEndSectionNumber = 2</p>\n\n<p>If you add a reference to the Word object model, you can use Word objects with intellisense in the VBE with early binding and you can also use Word constants. You add references from the Tools > References menu:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5ZLqt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ZLqt.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55605223, "answer_count": 1, "score": 0, "last_activity_date": 1554983940, "creation_date": 1554869013, "last_edit_date": 1554983940, "question_id": 55604588, "link": "https://stackoverflow.com/questions/55604588/how-can-i-get-the-header-of-specific-pages-of-word-importing-using-excel-vba", "title": "How can I get the header of specific pages of word importing using excel vba", "body": "<p>I have an integer pageNumber available, I need to get the header of the page of pageNumber of a word document and paste it in excel</p>\n\n<p>my code is as follows:</p>\n\n<pre><code>Set wdDoc = GetObject(wdFileName) 'open Word file\npageNumber = 5 //dynamically changes but not important here\npageHeader = wdDoc.Sections(pageNumber).Headers(1).Range.Text\n</code></pre>\n\n<p>the code above works but not consistent, it gets the header of different page not the actual page indicated by pageNumber</p>\n\n<p>I figured because its not actually a Page its calling but Sections. so I changed it to :</p>\n\n<pre><code>pageHeader = wdDoc.Pages(pageNumber).Headers(1).Range.Text\n</code></pre>\n\n<p>but it doesn't work. I'm new to vba and I'm struggling to read the documentations</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554893587, "post_id": 55605065, "comment_id": 97915833, "body": "sorry for the confusion, the play button is what i&#39;ve been using to compile. I press the play button and I get feedback. Until it stopped working.  I also tried inserting random letters into the code and running it. Nothing happed :&#39;("}, {"owner": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554893971, "post_id": 55605065, "comment_id": 97916041, "body": "It just feels like I broke excel"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554900657, "post_id": 55605065, "comment_id": 97919965, "body": "Have you been using the &quot;Step Into&quot; command from the Debug menu to perform one line of code at a time? Unlike C, you can step through the code and even modify it on the fly, while it is running. You can even drag the execution point to a different line of code if you need to retry something."}, {"owner": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554906656, "post_id": 55605065, "comment_id": 97923792, "body": "I tried that, and i finally got some sort of error message which was nice, but it raised another question: <a href=\"https://imgur.com/o0ilbb4\" rel=\"nofollow noreferrer\">imgur.com/o0ilbb4</a> if you take a look at this, does it seem wrong that under module one in the locals window, there are &quot;no variables&quot;?"}, {"owner": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554906854, "post_id": 55605065, "comment_id": 97923918, "body": "Also, i tried using &quot;step into&quot; on a line of code, and in the locals window, a variable given a value of 67 above that line was showing up as 0. Is that a result of the program only compiling that that specific line and ignoring what happened above it?"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554938585, "post_id": 55605065, "comment_id": 97938126, "body": "Compiling is strange in VBA... when you&#39;re stepping through a routine, it will compile the entire routing with every step, so it will always tell you about any syntax errors. But it still performs just one line at a time using the variables in their current state. At each step, it performs whatever the current line says using the current values of all variables. If a variable is changing value, it&#39;s because your code is making it change."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "edited": false, "score": 0, "creation_date": 1554938730, "post_id": 55605065, "comment_id": 97938154, "body": "Now, Stack Overflow isn&#39;t about teaching you how to program in VBA - there are plenty of websites for that. It&#39;s about answering specific questions. If you have a line of code that is making a change to your variables that you don&#39;t understand, or you have a line of code that isn&#39;t doing what you expect, you can ask a question about that. There&#39;s no more information to be given about this particular question, which is just about how to tell if VBA is compiling/running."}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1554872785, "creation_date": 1554872785, "answer_id": 55605065, "question_id": 55604222, "link": "https://stackoverflow.com/questions/55604222/compiler-not-doing-anything-new-to-vba/55605065#55605065", "title": "Compiler not doing anything (new to vba)", "body": "<p>When you choose to Compile in VBA, it doesn't create an executable or run the code. From a user perspective, it doesn't effectively do anything more than let you know that there are no compile errors.</p>\n\n<p>You need to actually run the code using the play button. If nothing is happening, use the debug menu to step through the code line by line and take note of when you don't get expected results.</p>\n\n<p>Making the Locals window visible from the View menu makes it easier to monitor variables.</p>\n\n<p>Making the Immediate window visible allows you to run single lines of code independently, including printing the values of variables, changing the values of variables, or printing the results of calculations. For example:</p>\n\n<p><code>?1+1</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11337841, "user_type": "registered", "profile_image": "https://graph.facebook.com/2451205944909677/picture?type=large", "display_name": "Karim", "link": "https://stackoverflow.com/users/11337841/karim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593589138, "creation_date": 1554865977, "last_edit_date": 1593589138, "question_id": 55604222, "link": "https://stackoverflow.com/questions/55604222/compiler-not-doing-anything-new-to-vba", "title": "Compiler not doing anything (new to vba)", "body": "<p>My compile button isn't doing anything at all.</p>\n\n<p>So I'd just figured out how the compiler in VBA works (I've only used C and just started vba today). \nI was fixing my code line by line using the compiler, and then it stopped doing anything. I click it and no message pops up, but no results are appearing (at least where I expect them to). I'm assuming this has something to do with some setting I accidentally messed up or some button I ticked? I have no idea how the coding environment works in vba.</p>\n\n<p>I wonder if something looks off in the screenshots below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KBj2O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KBj2O.png\" alt=\"https://imgur.com/a/Fj4m26F\"></a> </p>\n\n<p>i would have expected a large amount of files to appear in the folder @ / Users / Karim / Downloads / Word \\ files \\ 4 \\ mom / \n(don't laugh, we all have to be good sons ^^)\nbut again, nothing happens</p>\n"}, {"tags": ["excel", "vba", "collections"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554865516, "post_id": 55603676, "comment_id": 97903538, "body": "You might try .Range(&quot;A&quot;  &amp; b &amp; &quot;:D&quot; &amp; b).cells.count. debug.print the concatenation to make sure you don&#39;t need to wrap the&#39;b&#39; in Cstr."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554870691, "post_id": 55603676, "comment_id": 97904678, "body": "This doesnt work"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554886500, "post_id": 55603676, "comment_id": 97911504, "body": "Sorry.  Should have been .Range(&quot;A&quot; &amp; b, &quot;D&quot; &amp; b).Cells.Count"}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1554867654, "post_id": 55604205, "comment_id": 97904004, "body": "For reference - if anyone is viewing this, I used the letter &#39;O&#39;, where as @BigBen used the numeral &#39;0&#39;.. Substitute and it works"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1554868332, "post_id": 55604205, "comment_id": 97904151, "body": "Great, happy coding!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1554865874, "creation_date": 1554865874, "answer_id": 55604205, "question_id": 55603676, "link": "https://stackoverflow.com/questions/55603676/excel-vba-collections-coll-count-dynamic/55604205#55604205", "title": "Excel VBA Collections / coll.Count - dynamic", "body": "<p>One option is to create a collection of collections, with the collection names as the keys. For example:</p>\n\n<pre><code>Dim Backpack_0 As New Collection\nDim Backpack_1 As New Collection\n...\n\nDim masterCollection As New Collection\nmasterCollection.Add Item:=Backpack_0, Key:=\"Backpack_0\"\nmasterCollection.Add Item:=Backpack_1, Key:=\"Backpack_1\"\n...\n</code></pre>\n\n<p>Now you can refer to the individual collections dynamically by building up the key from your worksheet:</p>\n\n<pre><code>Dim collectionName as String\ncollectionName = wks_GM2.Range(\"A\" &amp; b).Value &amp; \"_\" &amp; wks_GM2.Range(\"D\" &amp; b).Value\n\nFor i = 1 to masterCollection(collectionName).Count\n</code></pre>\n"}], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55604205, "answer_count": 1, "score": 0, "last_activity_date": 1554865874, "creation_date": 1554861661, "question_id": 55603676, "link": "https://stackoverflow.com/questions/55603676/excel-vba-collections-coll-count-dynamic", "title": "Excel VBA Collections / coll.Count - dynamic", "body": "<p>I have a query on collections. I am trying to create some code that will access my collections dynamically. But I am running into the following troubles.</p>\n\n<p><strong>Example</strong></p>\n\n<p>I have created a collection and performed the following<code>Debug.Print Backpack_O.Count</code>. The result was <code>3</code> - this was expected.</p>\n\n<p>However, when I try and do this dynamically <code>Debug.Print wks_GM2.Range(\"A\" &amp; b) &amp; \"_\" &amp; wks_GM2.Range(\"D\" &amp; b) &amp; \".Count\"</code> my result is <code>Backpack_O.Count</code> - not the desired output.</p>\n\n<p>The reason why I need this dynamically is so I can substituate this into a <code>For</code> loop. As an example:</p>\n\n<pre><code>For i = 1 To wks_GM2.Range(\"A\" &amp; b) &amp; \"_\" &amp; wks_GM2.Range(\"D\" &amp; b) &amp; \".Count\"\n</code></pre>\n\n<p>I have tried wrapping this in <code>CLng</code> <code>CStr</code> etc but I'm coming up blank. Can anyone help me resolve this...</p>\n\n<p>Cheers!!!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": true, "score": 0, "last_activity_date": 1554871315, "creation_date": 1554871315, "answer_id": 55604851, "question_id": 55603636, "link": "https://stackoverflow.com/questions/55603636/how-to-refer-to-a-named-cell-in-a-relative-way-in-excel-vba/55604851#55604851", "title": "How to Refer to a Named Cell in a Relative Way in Excel VBA", "body": "<p>The Range() object doesn't look at the active cell to determine what a named range should refer to, but the Names() collection does. You can use it as follows:</p>\n\n<pre><code>    Set LEntrada = Names(\"LEntrada\").RefersToRange\n</code></pre>\n\n<p>or if LEntrada was defined as a Double:</p>\n\n<pre><code>    LEntrada = Names(\"LEntrada\").RefersToRange.Value\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9947587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k0mfg6Tq9gg/AAAAAAAAAAI/AAAAAAAAAEk/izMn9s8yOcs/photo.jpg?sz=128", "display_name": "Alex Boorjs", "link": "https://stackoverflow.com/users/9947587/alex-boorjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55604851, "answer_count": 1, "score": 0, "last_activity_date": 1554983935, "creation_date": 1554861356, "last_edit_date": 1554983935, "question_id": 55603636, "link": "https://stackoverflow.com/questions/55603636/how-to-refer-to-a-named-cell-in-a-relative-way-in-excel-vba", "title": "How to Refer to a Named Cell in a Relative Way in Excel VBA", "body": "<p>I have 2 types of cell that I need to access via code. both are named cells. one is a cell with fixed column and row like ($B$3). I can access it in the code using its name => Range(\"Montante\"). NO PROBLEM so far. the problem is when I try to access the other cell called \"LEntrada\" with fixed column but not fixed row like ($C8). Is there any way to access LEntrada according to the cell that the function is placed?</p>\n\n<p>thanks in advance.</p>\n\n<pre><code>Public Function QtdEntradaSimulado3() As Variant\n    On Error GoTo TratarErro\n    Dim qtdEntrada As Integer\n    Dim Montante As Range\n    Dim LEntrada As Range\n\n    Application.Volatile True\n\n    Set Montante = Range(\"Montante\")\n    Set LEntrada = Range(\"LEntrada\")\n\n    qtdEntrada = Fix((Montante / LEntrada) / 100) * 100\n    QtdEntradaSimulado3 = IIf(qtdEntrada = 0, \"\", qtdEntrada)\n\nSair:\n    Exit Function\nTratarErro:\n    QtdEntradaSimulado3 = \"\"\n    GoTo Sair\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "edited": false, "score": 0, "creation_date": 1555118034, "post_id": 55610228, "comment_id": 98010395, "body": "Hmm, thanks for helping!, How would I incorporate my link into that code that you posted? Sorry I&#39;ve never tried using an xmlhttp request"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1554891966, "creation_date": 1554891966, "answer_id": 55610228, "question_id": 55603420, "link": "https://stackoverflow.com/questions/55603420/needing-to-get-data-from-inside-of-div-id/55610228#55610228", "title": "Needing to get data from inside of Div Id", "body": "<p>If you can issue an <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">xmlhttp request</a> you could use the class name of the element. This code would go in a standard module. You open the VBE with <kbd>Alt</kbd>+<kbd>F11</kbd>, then right click on Project Explorer window and add a standard module e.g. Module 1. Place code in there. You could then tie this code execution to a button or event. Change <code>ActiveSheet</code> for explicit sheet name reference.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTimeStamp()\n    Dim html As HTMLDocument\n    Set html = New HTMLDocument                  '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft HTML Object Library\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"url\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n    ActiveSheet.Range(\"A1\") = html.querySelector(\".resourceDrilldownLink\").innerText\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554891966, "creation_date": 1554859366, "question_id": 55603420, "link": "https://stackoverflow.com/questions/55603420/needing-to-get-data-from-inside-of-div-id", "title": "Needing to get data from inside of Div Id", "body": "<p>I am wanting to get time stamp info from inside a Div ID.</p>\n\n<p>Sadly the actual link only works in network but this is the section of the code that inspector shows for the time stamp. I use that page to pull metrics for our department at work, but I am pulling in the CSV file data. The html webpage shows when the data was last updated letting me know if the csv data I have is current our still not up to date. I was wondering if there was a way I could set up a query to look at only that portion of the html code from the webpage. currently my code for looking at the page in its entirety is this. This works to get the whole page and will show me the time stamp but its rather slow and I was wondering of a way to get only the time stamp and maybe that would work faster? </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"timestamps\"&gt;\r\n    &lt;!--\r\n    [/reports/timestampDrilldown?resourceVersionKeysString=H4sIAAAAAAAAAK2QzS4EQRSFr_ETC_G3s7eSVI2eaa07FggRom0MEna3a2739Kj-UVUzxiwkFp5AiGcQSwnxAN7GG1joJkPs3UUt7jlV53z1-A6jWsFMG7vIOyaWfBt1q0HmdfP69u7l2R4G6OXnEwAwvboG5VQKf4AJ9rOUh0ImPM-UQclNnJA2mOSad5RskcxJ8X3SWUcJOvgRD5Xc_tLmG6RilHEfA0kD3xEpHWfpLl083YjOydXHQwUqPkxJ1GajReKUmptoyMC0X1aulpWr5WbFhxn195GdpoHZb5vENKo2jIrTaKWXFwCTv8Dl7Vb7amj32Mx9044DDLVH7l_eegYIk35qFaC8a_GtDX_vB4ntpAVRKmig-Bhkao-KFKHXo0hRhCZTfNHDoI7CZeiFFrNrVGNB3XWYt1yzncBzhHCX9BlcFh9bnmOD-OeFf4mn5dC2mmHInNCtMbvuIsO6WGTOEtmuILvpWVbvEzuwcCgHAgAA&amp;warehouseId=BFI4]\r\n    --&gt;\r\n    Data last checked at &lt;d class=\"resourceDrilldownLink\" title=\"57 minutes ago\"&gt;2019/04/09 17:14 PDT&lt;/d&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<pre><code> Sub DataLastChecked()\n'\n' DataPull Macro\n'\nApplication.ScreenUpdating = False\nDim SD As Date\nDim ED As Date\nDim STS As Integer\nDim ETS As Integer\nDim STE As Integer\nDim ETE As Integer\nSD = Worksheets(\"Variables\").Range(\"A2\").Value\nED = Worksheets(\"Variables\").Range(\"A2\").Value\nSTS = Worksheets(\"Variables\").Range(\"B2\").Value\nETS = Worksheets(\"Variables\").Range(\"C12\").Value\nSTE = Worksheets(\"Variables\").Range(\"D2\").Value\nETE = Worksheets(\"Variables\").Range(\"D2\").Value\nApplication.ScreenUpdating = False\n'On Error GoTo Errorcatch\n\n  If Worksheets(\"DataLastChecked\").Visible = xlSheetHidden Then\n  Worksheets(\"DataLastChecked\").Visible = xlSheetVisible\n End If\n Sheets(\"DataLastChecked\").Activate\n Sheets(\"DataLastChecked\").Select\n Cells.Select\n Selection.ClearContents\n\n\n Sheets(\"DataLastChecked\").Select\n With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;https://fclm-portal.amazon.com/reports/processPathRollup?reportFormat=HTML&amp;warehouseId=BFI4&amp;maxIntradayDays=1&amp;spanType=Intraday&amp;startDateIntraday=\" &amp; Year(SD) &amp; \"%2F\" &amp; Month(SD) &amp; \"%2F\" &amp; Day(SD) &amp; \"&amp;startHourIntraday=\" &amp; (STS) &amp; \"&amp;startMinuteIntraday=\" &amp; (STE) &amp; \"&amp;endDateIntraday=\" &amp; Year(ED) &amp; \"%2F\" &amp; Month(ED) &amp; \"%2F\" &amp; Day(ED) &amp; \"&amp;endHourIntraday=\" &amp; (ETS) &amp; \"&amp;endMinuteIntraday=\" &amp; (ETE) &amp; \"&amp;adjustPlanHours=true&amp;_adjustPlanHours=on&amp;_hideEmptyLineItems=on&amp;employmentType=AllEmployees\", _\n    Destination:=Range(\"$A$1\"))\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n\n       Columns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n    ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1)), _\n    TrailingMinusNumbers:=True\n\nSheets(\"Recap\").Select\nEnd With\nIf Worksheets(\"DataLastChecked\").Visible = xlSheetVisible Then\n  Worksheets(\"DataLastChecked\").Visible = xlSheetHidden\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554859518, "post_id": 55603325, "comment_id": 97902393, "body": "i think you&#39;re looking for <code>combobox_change</code>, using a modeless userform; you could also dynamically add controls to a userform with code, which is your + button you were talking about"}, {"owner": {"reputation": 1, "user_id": 11337476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BpsEku1W1Hs/AAAAAAAAAAI/AAAAAAAAByY/bWTB1OKlDM4/photo.jpg?sz=128", "display_name": "Alpha7449", "link": "https://stackoverflow.com/users/11337476/alpha7449"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554860442, "post_id": 55603325, "comment_id": 97902571, "body": "@Cyril Thanks for the tip with using modeless userforms although i still cant get the combobox_change to trigger when the new combobox is changed."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1554897427, "post_id": 55603325, "comment_id": 97918012, "body": "Create the controls manually, attach the event code to them and then programmatically move them to a location outside of the visible area of the form until you need them, and then programatically move them back into view. Much simpler"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554930033, "post_id": 55603325, "comment_id": 97935463, "body": "You could create a class module or UDF for the ComboBox to look if its been creted or not, but honestly the comment by @HarassedDad is going to be the easiest solution."}, {"owner": {"reputation": 1, "user_id": 11337476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BpsEku1W1Hs/AAAAAAAAAAI/AAAAAAAAByY/bWTB1OKlDM4/photo.jpg?sz=128", "display_name": "Alpha7449", "link": "https://stackoverflow.com/users/11337476/alpha7449"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1554938601, "post_id": 55603325, "comment_id": 97938128, "body": "@HarassedDad That&#39;s what my backup solution was and i do agree that it is much simpler. I will begin changing the for but i am still curious to see if it is possible. thanks guys."}], "owner": {"reputation": 1, "user_id": 11337476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BpsEku1W1Hs/AAAAAAAAAAI/AAAAAAAAByY/bWTB1OKlDM4/photo.jpg?sz=128", "display_name": "Alpha7449", "link": "https://stackoverflow.com/users/11337476/alpha7449"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554983931, "creation_date": 1554858343, "last_edit_date": 1554983931, "question_id": 55603325, "link": "https://stackoverflow.com/questions/55603325/can-excel-userforms-create-a-combobox-when-the-form-is-running-and-having-a-trig", "title": "Can Excel userforms create a combobox when the form is running and having a trigger for that new combobox?", "body": "<p>I have a + and - button to add and remove combo-boxes in a user form, the problem i'm having is getting code to trigger when those new boxes are changed. I was wondering if its possible to have triggers for items that don't exist until i press the + button in the form?</p>\n\n<p>I have tried to add triggers with the name that the box will have but it doesn't activate.</p>\n\n<p>This is the code i use to create the new boxes and set them up.</p>\n\n<pre><code>Private Sub AddRow_Click()\nSearchCount = SearchCount + 1\nUserForm1.Height = UserForm1.Height + 30\nUserForm1.ListBox1.Top = UserForm1.ListBox1.Top + 30\nUserForm1.TextBox4.Top = UserForm1.TextBox4.Top + 30\nUserForm1.TextBox5.Top = UserForm1.TextBox5.Top + 30\nUserForm1.TextBox6.Top = UserForm1.TextBox6.Top + 30\nUserForm1.ApplyButton.Top = UserForm1.ApplyButton.Top + 30\nUserForm1.ResetButton.Top = UserForm1.ResetButton.Top + 30\nUserForm1.AddRow.Top = UserForm1.AddRow.Top + 30\nUserForm1.RemoveRow.Top = UserForm1.RemoveRow.Top + 30\n\nSet cmbo1 = UserForm1.Controls.Add(\"Forms.Combobox.1\", \"ColumnPicker\" &amp; SearchCount)\nobj1.Add cmbo1, cmbo1.Name\nSet cmbo2 = UserForm1.Controls.Add(\"Forms.Combobox.1\", \"Operator\" &amp; SearchCount)\nobj2.Add cmbo2, cmbo2.Name\nSet txt3 = UserForm1.Controls.Add(\"Forms.Textbox.1\", \"Condition\" &amp; SearchCount)\nobj3.Add txt3, txt3.Name\nSet cmbo4 = UserForm1.Controls.Add(\"Forms.Combobox.1\", \"Logic\" &amp; SearchCount)\nobj4.Add cmbo4, cmbo4.Name\n\nCount = Sheets(\"Analyzer\").ListObjects(\"Analyzer\").ListColumns.Count - 1\nReDim ColumnArr(Count)\nWith cmbo1\n    .Top = 50 + (30 * (SearchCount - 1))\n    .Left = 18\n    .Height = 24\n    .Width = 192\n    For i = 0 To Count\n        ColumnArr(i) = Sheets(\"Analyzer\").Cells(3, i + 1).Value\n    Next i\n    For j = 0 To Count\n        .AddItem (ColumnArr(j))\n    Next j\nEnd With\nWith cmbo2\n    .Top = 50 + (30 * (SearchCount - 1))\n    .Left = 216\n    .Height = 24\n    .Width = 180\n    .AddItem (\"Starts With\")\n    .AddItem (\"Contains\")\n    .AddItem (\"=  Equals\")\n    .AddItem (\"!= Does Not Equal\")\n    .AddItem (\"&gt;  Greater Than\")\n    .AddItem (\"&gt;= Greater Than Or Equals\")\n    .AddItem (\"&lt;  Less Than\")\n    .AddItem (\"&lt;= Less Than Or Equals\")\n    .Text = \"Contains\"\nEnd With\nWith txt3\n    .Top = 50 + (30 * (SearchCount - 1))\n    .Left = 402\n    .Height = 24\n    .Width = 420\nEnd With\nWith cmbo4\n    .Top = 50 + (30 * (SearchCount - 2))\n    .Left = 828\n    .Height = 24\n    .Width = 60\n    .AddItem (\"And\")\n    .AddItem (\"Or\")\n    .Text = \"And\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Eeym6.png\" rel=\"nofollow noreferrer\">This is the layout of the userform</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cBuwb.png\" rel=\"nofollow noreferrer\">This is the userform after adding new boxes</a></p>\n\n<p>If there isn't a way to do it i will just have to create the boxes first and change there visibility with code, that way i can link the triggers first.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11337501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56429e783d92514ea900a3b0cef099eb?s=128&d=identicon&r=PG&f=1", "display_name": "jschem", "link": "https://stackoverflow.com/users/11337501/jschem"}, "edited": false, "score": 0, "creation_date": 1554950578, "post_id": 55607746, "comment_id": 97940516, "body": "I&#39;m receiving an error &quot;Object variable or with block variable not set&quot; on findRange.Value"}, {"owner": {"reputation": 15, "user_id": 7687609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9ac381acfb21a1b105350f77347a7f?s=128&d=identicon&r=PG&f=1", "display_name": "Hans", "link": "https://stackoverflow.com/users/7687609/hans"}, "reply_to_user": {"reputation": 1, "user_id": 11337501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56429e783d92514ea900a3b0cef099eb?s=128&d=identicon&r=PG&f=1", "display_name": "jschem", "link": "https://stackoverflow.com/users/11337501/jschem"}, "edited": false, "score": 0, "creation_date": 1555473031, "post_id": 55607746, "comment_id": 98119106, "body": "Sorry for the late response. The error appears because there is no matched range in that column. I modify the answer by adding the object variable check. It should work now."}], "tags": [], "owner": {"reputation": 15, "user_id": 7687609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9ac381acfb21a1b105350f77347a7f?s=128&d=identicon&r=PG&f=1", "display_name": "Hans", "link": "https://stackoverflow.com/users/7687609/hans"}, "is_accepted": false, "score": 0, "last_activity_date": 1555472784, "last_edit_date": 1555472784, "creation_date": 1554883944, "answer_id": 55607746, "question_id": 55603276, "link": "https://stackoverflow.com/questions/55603276/how-do-i-make-a-replace-function-in-excel-only-run-through-the-first-occurrence/55607746#55607746", "title": "How do I make a Replace function in Excel only run through the first occurrence of a word in another Excel workbook?", "body": "<pre><code>Sub Sample2()\n    Dim NameListWB As Workbook, thisWb As Workbook\n    Dim NameListWS As Worksheet, thisWs As Worksheet\n    Dim i As Long, lRow As Long, columnNum As Long\n    Dim maxColumnToRepalce As Integer\n    Dim findRange As Range\n\n    Set thisWb = ThisWorkbook\n    Set thisWs = thisWb.Sheets(\"Sheet1\")\n\n    Set NameListWB = Workbooks.Open(\"C:document.xlsx\")\n    Set NameListWS = NameListWB.Worksheets(\"Sheet2\")\n\n    maxColumnToRepalce = 8\n\n    With thisWs\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For columnNum = 1 To maxColumnToRepalce\n            For i = 1 To lRow\n                Set findRange = NameListWS.Columns(columnNum).Find(What:=.Range(\"A\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      after:=.Cells(Columns(columnNum).Rows.Count, columnNum), _\n                                      MatchCase:=False)\n                If Not findRange Is Nothing Then\n                    findRange.Value = .Range(\"B\" &amp; i)\n                End If\n            Next i\n        Next columnNum\n    End With\nEnd Sub\n</code></pre>\n\n<p>Use Find method to find the first occurrence then do the replacement. By The Way, you can simplify the code by adding another loop.</p>\n"}], "owner": {"reputation": 1, "user_id": 11337501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56429e783d92514ea900a3b0cef099eb?s=128&d=identicon&r=PG&f=1", "display_name": "jschem", "link": "https://stackoverflow.com/users/11337501/jschem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555472784, "creation_date": 1554857905, "last_edit_date": 1554858372, "question_id": 55603276, "link": "https://stackoverflow.com/questions/55603276/how-do-i-make-a-replace-function-in-excel-only-run-through-the-first-occurrence", "title": "How do I make a Replace function in Excel only run through the first occurrence of a word in another Excel workbook?", "body": "<p>I want to run through replacement words in one worksheet and replace the first occurrence of those words in another workbook. Column A gives a word and Column B gives a value used to replace occurrences of words in Column A.</p>\n\n<p>The code I am using replaces all occurrences of the words in Column A to Column B.</p>\n\n<pre><code>Sub Sample2()\n    Dim NameListWB As Workbook, thisWb As Workbook\n    Dim NameListWS As Worksheet, thisWs As Worksheet\n    Dim i As Long, lRow As Long\n\n    Set thisWb = ThisWorkbook\n    Set thisWs = thisWb.Sheets(\"Sheet1\")\n\n    Set NameListWB = Workbooks.Open(\"C:document.xlsx\")\n    Set NameListWS = NameListWB.Worksheets(\"Sheet2\")\n\n    With thisWs\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For i = 1 To lRow\n            NameListWS.Columns(1).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(2).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(3).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(4).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(5).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Text, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(6).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(7).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n        For i = 1 To lRow\n            NameListWS.Columns(8).Replace What:=.Range(\"A\" &amp; i).Value, _\n                                      Replacement:=.Range(\"B\" &amp; i).Value, _\n                                      SearchOrder:=xlByColumns, _\n                                      MatchCase:=False\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554866299, "post_id": 55603216, "comment_id": 97903706, "body": "What do you mean by 1-N. You are using VBA, no need for a &#39;;&#39; at the end of the line."}, {"owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554868530, "post_id": 55603216, "comment_id": 97904200, "body": "1-N will be an integer variable"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554888527, "post_id": 55603216, "comment_id": 97912761, "body": "If you are writing code from within Excel then wdActivePageNumber will be interpreted as zero because excel a has no knowledge of Word enumerations.  Therefore you need to find the enumeration used for .information in Word zand substitute the long value corresponding to the enumeration value of  wdActivePageNumber."}], "owner": {"reputation": 531, "user_id": 3201151, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100005067161241/picture?type=large", "display_name": "Roi", "link": "https://stackoverflow.com/users/3201151/roi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554857365, "creation_date": 1554857365, "question_id": 55603216, "link": "https://stackoverflow.com/questions/55603216/how-can-i-get-the-page-number-of-the-table-currently-on-iteration", "title": "How can I get the page number of the table currently on iteration", "body": "<p>I am trying to determine which page number the current table in iteration is with the code below:</p>\n\n<pre><code>Set wdDoc = GetObject(wdFileName) 'open Word file\n\nWith wdDoc\n    tableNo = wdDoc.tables.Count\n    tableTot = wdDoc.tables.Count\n    If tableNo = 0 Then\n        MsgBox \"This document contains no tables\", _\n        vbExclamation, \"Import Word Table\"\n    ElseIf tableNo &gt; 1 Then\n        tableNo = InputBox(\"This Word document contains \" &amp; tableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n        \"Enter the table to start from\", \"Import Word Table\", tableNo)\n    End If\n\n    resultRow = 4\n\n    For tableStart = 1 To tableTot\n        With .tables(tableStart)\n            'copy cell contents from Word table cells to Excel cells\n            For iRow = 1 To .Rows.Count\n                For iCol = 1 To .Columns.Count\n                    Cells(resultRow, iCol) = WorksheetFunction.Clean(.cell(iRow, iCol).Range.Text)\n                Next iCol\n                Cells(resultRow, 4) = pageNumber\n                resultRow = resultRow + 1\n            Next iRow\n        End With\n        resultRow = resultRow + 1\n    Next tableStart\nEnd With\n</code></pre>\n\n<p>I've research a way and found this</p>\n\n<pre><code>oTable.Range.Information(wdActiveEndPageNumber)\n</code></pre>\n\n<p>I tried to use it by doing</p>\n\n<pre><code>pageNumber = .Range.Information(wdActiveEndPageNumber)\n</code></pre>\n\n<p>but apparently its not working because im not actually looping through activeobjects. its basically:</p>\n\n<pre><code>wdDoc.tables(1-N).Range.Information(wdActiveEndPageNumber);\n</code></pre>\n\n<p>which is not working, error on wdActiveEndPageNumber,</p>\n\n<p>is there a way to get the page number?</p>\n"}, {"tags": ["html", "excel", "vba", "loops", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "edited": false, "score": 0, "creation_date": 1555157008, "post_id": 55610035, "comment_id": 98017159, "body": "hey again Qharr, you are on here a lot bless you, always helping others out. I am about to try this one. no doubt you are have done it. big thumbs up."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "edited": false, "score": 0, "creation_date": 1555157047, "post_id": 55610035, "comment_id": 98017167, "body": "Any problems let me know. I&#39;m also happy to go into more detail about what each step is doing."}, {"owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "edited": false, "score": 1, "creation_date": 1555158998, "post_id": 55610035, "comment_id": 98017707, "body": "QHarr, that worked thank you, it also showed me how to loop through cells as well. I really appreciate it."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554892168, "last_edit_date": 1554892168, "creation_date": 1554891292, "answer_id": 55610035, "question_id": 55602901, "link": "https://stackoverflow.com/questions/55602901/click-button-scrape-in-loop/55610035#55610035", "title": "Click button, scrape in loop", "body": "<p>With a little javascript manipulation you can easily do this. The distance by road I think requires direction service which requires an API key. I am guessing this webpage was from the days before Google updated the geo APIs to require paid for API keys.</p>\n\n<p>I overwrite the window alert message and use javascript to read the value of the distance.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SearchBot()\n    Dim objIE As InternetExplorer, ws As Worksheet, lastRow As Long, i As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set objIE = New InternetExplorer\n    lastRow = ws.Cells(ws.rows.Count, \"B\").End(xlUp).Row 'Down to first blank. Assumes header in row 1\n    Dim postcodes()\n    postcodes = ws.Range(\"B2:D\" &amp; lastRow).Value\n\n    With objIE\n        .Visible = True\n        .Navigate2 \"http://www.ukpostcode.net/distance-between-uk-postcodes\"\n\n        Do While .Busy = True Or .readyState &lt;&gt; 4: DoEvents: Loop\n\n        .document.parentWindow.execScript \"window.alert = function() {};\"\n\n        For i = LBound(postcodes, 1) To UBound(postcodes, 1)\n\n            .document.getElementById(\"pointa\").Value = _\n                                                          postcodes(i, 1)\n\n            .document.getElementById(\"pointb\").Value = _\n                                                         postcodes(i, 3)\n\n            .document.querySelector(\"[value='Calculate Distance']\").Click\n\n            Application.Wait Now + TimeSerial(0, 0, 1)\n\n            .document.parentWindow.execScript \"document.title = document.getElementById('distance').value;\"\n\n            ws.Cells(i + 1, \"E\") = .document.Title\n        Next\n        objIE.Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7787868, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158708192195393/picture?type=large", "display_name": "Gary Arg", "link": "https://stackoverflow.com/users/7787868/gary-arg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 55610035, "answer_count": 1, "score": 1, "last_activity_date": 1558126779, "creation_date": 1554854591, "last_edit_date": 1558126779, "question_id": 55602901, "link": "https://stackoverflow.com/questions/55602901/click-button-scrape-in-loop", "title": "Click button, scrape in loop", "body": "<p>I am trying to get the miles between 2 postcodes that are in 2 cells.</p>\n\n<p>I wrote the code to open the webpage and input the 2 postcodes.</p>\n\n<p>I can't get it to click the button and then take the miles and put it in the cells and loop through the cells until empty.</p>\n\n<p>I have tried (0) up to (7), I think its the 6th button in the html. I have also tried different getelements.</p>\n\n<pre><code>'start a new subroutine called SearchBot\n\nSub SearchBot()\n\n    'dimension (declare or set aside memory for) our variables\n    Dim objIE As InternetExplorer 'special object variable representing the IE browser\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'initiating a new instance of Internet Explorer and asigning it to objIE\n    Set objIE = New InternetExplorer\n\n    'make IE browser visible (False would allow IE to run in the background)\n    objIE.Visible = True\n\n    'navigate IE to this web page (a pretty neat search engine really)\n    objIE.navigate \"http://www.ukpostcode.net/distance-between-uk-postcodes\"\n\n    'wait here a few seconds while the browser is busy\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'in the search box put cell value\n    objIE.document.getElementById(\"pointa\").Value = _\n      Sheets(\"Sheet1\").Range(\"B2\").Value\n\n    'wait again for the browser\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'in the search box put cell \"A2\" value, the word \"in\" and cell \"C1\" value\n    objIE.document.getElementById(\"pointb\").Value = _\n      Sheets(\"Sheet1\").Range(\"D2\").Value\n\n    'wait again for the browser\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    'code below doesnt    work''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'click the 'go' button\n   objIE.document.getElementsByTagName(\"button\")(6).Click\n\n    'wait again for the browser\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'take miles and put in cell\n\n    'add distance to sheet\n    Range(\"e2\").Value = getElementsByid(\"distance\")\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    'close the browser\n    objIE.Quit\n\n    'exit our SearchBot subroutine\nEnd Sub\n</code></pre>\n\n<p>I want the miles put in a cell next to the 2 post codes 2 cells and move to the next and do the same until the cells are empty.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "is_accepted": false, "score": 0, "last_activity_date": 1554851826, "creation_date": 1554851826, "answer_id": 55602585, "question_id": 55602541, "link": "https://stackoverflow.com/questions/55602541/how-to-add-form-header/55602585#55602585", "title": "How to add Form Header?", "body": "<p>Well, it dawned to me that I needed to fix the line of code as:</p>\n\n<pre><code>If me.Section(1).Visible = True then\n 'Do color change\n\nEnd if\n</code></pre>\n\n<p>It solved the issue. I did not need to add <code>form headers</code>.</p>\n"}], "owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594621196, "creation_date": 1554851459, "last_edit_date": 1594621196, "question_id": 55602541, "link": "https://stackoverflow.com/questions/55602541/how-to-add-form-header", "title": "How to add Form Header?", "body": "<p>I am looping through my <code>forms</code> to change <code>backcolor</code> of <code>form header</code> via VBA code. However, my code breaks for the <code>forms</code> which do not have a <code>form header</code> inserted. I used the line below but it gives an <code>error</code> saying <code>section number is invalid</code> which looks true since my <code>form</code> does not have a <code>header</code> in the first place. </p>\n\n<pre><code>me.Form.Section(1).Visible = True\n</code></pre>\n\n<p>I know how to add <code>form header</code> manually but there are too many <code>forms</code> and it is tedious to change them one by one. Can someone help how to <code>add form hearder</code> via VBA code.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1554850156, "post_id": 55602285, "comment_id": 97900479, "body": "Are you running this code from Excel or Word?"}, {"owner": {"reputation": 782, "user_id": 7595371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f46f2b9451b0a0d0f61a1fbc0b5f34?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7595371/michael"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1554853288, "post_id": 55602285, "comment_id": 97901110, "body": "I&#39;m running it in Excel"}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 2, "creation_date": 1554853371, "post_id": 55602285, "comment_id": 97901130, "body": "Then please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 782, "user_id": 7595371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f46f2b9451b0a0d0f61a1fbc0b5f34?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7595371/michael"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1554854635, "post_id": 55602285, "comment_id": 97901423, "body": "Yeah, good call.  I removed everything and it is working.  I&#39;m adding back in and will report back the culprit.  Good advice."}], "answers": [{"tags": [], "owner": {"reputation": 782, "user_id": 7595371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f46f2b9451b0a0d0f61a1fbc0b5f34?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7595371/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1554948879, "creation_date": 1554948879, "answer_id": 55623733, "question_id": 55602285, "link": "https://stackoverflow.com/questions/55602285/string-works-in-insertfile-variable-containing-same-string-does-not-why/55623733#55623733", "title": "String works in InsertFile. Variable containing same string does not. Why?", "body": "<p>This appears to be a bug in VBA.  I was trying to read a list of RTF file names in a Word document I had generated from a different program.  Then I was going to insert the RTF back into the same Word document in a new table.  I tried both an array and an ArrayList.  Both failed.  Ultimately, I had to dump these file names into a text file and read it from there.  That worked perfectly.  Thanks Ahmed for making me do the hard word I was avoiding.  Hopefully this helps someone else.</p>\n"}], "owner": {"reputation": 782, "user_id": 7595371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10f46f2b9451b0a0d0f61a1fbc0b5f34?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7595371/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554948879, "creation_date": 1554849542, "last_edit_date": 1554853393, "question_id": 55602285, "link": "https://stackoverflow.com/questions/55602285/string-works-in-insertfile-variable-containing-same-string-does-not-why", "title": "String works in InsertFile. Variable containing same string does not. Why?", "body": "<p>I am using Excel VBA 2016.  I have applied all available updates.</p>\n\n<p>This works fine for me when I attempt to insert into a WORD document.</p>\n\n<pre><code>Range.InsertFile FileName:=\"c:\\tmp\\filename.rtf\"\n</code></pre>\n\n<p>If I do this...</p>\n\n<pre><code>variable = \"c:\\tmp\\filename.rtf\"\nRange.InsertFile FileName:=variable\n</code></pre>\n\n<p>It does not work.  The error message is, \"Sorry, we couldn't find your file.  Was it moved, renamed, or deleted?\"  Then it gives me the path in parenthesis.</p>\n\n<p>I have unsuccessfully tried all sorts of permutations that might make this work and Googled for too long.  Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1554847685, "post_id": 55601884, "comment_id": 97899819, "body": "Hi DarkWes, you need to explain more what you&#39;ve tried and what you&#39;re after with your question. Currently the three code blocks will not even compile. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1554898213, "creation_date": 1554898213, "answer_id": 55612234, "question_id": 55601884, "link": "https://stackoverflow.com/questions/55601884/what-did-they-try-to-do-with-this-code/55612234#55612234", "title": "&quot;what did they try to do with this code?&quot;", "body": "<p>The code first unlocks the VB project and then runs some sendkeys macros - this work by simulating pressing keys on the keyboard, so this is running Control Pagedown, Alt C , \"sometext\", Alt o, \"some text\", Tab and finally Enter.</p>\n\n<p>it then adds a reference to the project and finally saves and closes the file</p>\n\n<p>It looks like a clumsy attempt to work around not having the correct reference set in the code.  I presume that the text, and the GUI have meaning in the context of the particular file</p>\n\n<p>More details might be found <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-31887.html\" rel=\"nofollow noreferrer\">Here</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11331819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLrxJ.png?s=128&g=1", "display_name": "DarkWes", "link": "https://stackoverflow.com/users/11331819/darkwes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55612234, "answer_count": 1, "score": -3, "last_activity_date": 1554983892, "creation_date": 1554846900, "last_edit_date": 1554983892, "question_id": 55601884, "link": "https://stackoverflow.com/questions/55601884/what-did-they-try-to-do-with-this-code", "title": "&quot;what did they try to do with this code?&quot;", "body": "<p>I found this hidden code in a common use form.</p>\n\n\n\n<pre><code>Private Sub Workbook_Open()\nIf ActiveWorkbook.FileFormat &lt;&gt; 52 And ActiveWorkbook.FileFormat &lt;&gt; 50 Then\nActiveWorkbook.Application.VBE.CommandBars(1).FindControl(ID:=2578, recursive:=True).Execute\n</code></pre>\n\n<p>I do not know what use it has.</p>\n\n<pre><code>SendKeys \"^{PGDN}\"\nSendKeys \"%(C)\" &amp; \"Cont_2015/*69\"\nSendKeys \"%(o)\" &amp; \"Cont_2015/*69\"\nSendKeys \"{TAB}\" &amp; \"~\"\nThisWorkbook.VBProject.References.AddFromGuid GUID:=\"{0002E157-0000-0000-C000-000000000046}\", Major:=5, Minor:=3\n</code></pre>\n\n<p>that is all</p>\n\n<pre><code>ActiveWorkbook.Save\nActiveWorkbook.Close\nEnd If\nEnd Sub\n</code></pre>\n"}]