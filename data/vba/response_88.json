[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473891262, "post_id": 39500311, "comment_id": 66318360, "body": "Easiest way to figure out things in VBA is to use Record Macro and check the generated code. You will have to use <code>.FormulaArray =</code> instead of <code>.Value =</code>"}, {"owner": {"reputation": 15, "user_id": 5937333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7nVdxAv3b5M/AAAAAAAAAAI/AAAAAAAAAJM/M_n97sZB0DI/photo.jpg?sz=128", "display_name": "mFranck", "link": "https://stackoverflow.com/users/5937333/mfranck"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473967343, "post_id": 39500311, "comment_id": 66353324, "body": "Thanks for your answer. Already tried that, and using Evaluate but it didn&#39;t work neither. I&#39;m going to insert the formula as a value only and then use the SendKey method to simulate pressing F2, and then Ctrl + Shift + Enter."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5937333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7nVdxAv3b5M/AAAAAAAAAAI/AAAAAAAAAJM/M_n97sZB0DI/photo.jpg?sz=128", "display_name": "mFranck", "link": "https://stackoverflow.com/users/5937333/mfranck"}, "edited": false, "score": 0, "creation_date": 1473967368, "post_id": 39500646, "comment_id": 66353332, "body": "Thank you very much! It worked great."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1473892417, "creation_date": 1473892417, "answer_id": 39500646, "question_id": 39500311, "link": "https://stackoverflow.com/questions/39500311/avoid-apostrophe-when-inserting-a-formula-with-vba/39500646#39500646", "title": "Avoid apostrophe when inserting a formula with vba", "body": "<p>You should rename Loop because in the English version of the VBA Loop is a reserved word. </p>\n\n<p>Where loop = 2; <code>E\" &amp; loop &amp; \"</code> is being evaluated as <code>'E2'</code> because you are mixing R1C1 style notation with A1 style notation.  </p>\n\n<p>Here I use x instead of loop and <code>R\" &amp; x &amp; \"C5</code> to get the proper refernce.</p>\n\n<pre><code>Cells(x, \"H\").Value = \"=INDEX('Tab Asistencias'!R1C1:R20000C4,MATCH(1,('Tab Asistencias'!R1C2:R20000C2=R2C2)*('Tab Asistencias'!R1C1:R20000C1=R\" &amp; x &amp; \"C5),0),4)\"\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>=INDEX('Tab Asistencias'!$A$1:$D$20000,MATCH(1,('Tab Asistencias'!$B$1:$B$20000=$B$2)*('Tab Asistencias'!$A$1:$A$20000=$E$10),0),4)</code></p>\n"}], "owner": {"reputation": 15, "user_id": 5937333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7nVdxAv3b5M/AAAAAAAAAAI/AAAAAAAAAJM/M_n97sZB0DI/photo.jpg?sz=128", "display_name": "mFranck", "link": "https://stackoverflow.com/users/5937333/mfranck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "closed_date": 1473902252, "accepted_answer_id": 39500646, "answer_count": 1, "score": 0, "last_activity_date": 1473892417, "creation_date": 1473890422, "question_id": 39500311, "link": "https://stackoverflow.com/questions/39500311/avoid-apostrophe-when-inserting-a-formula-with-vba", "closed_reason": "Duplicate", "title": "Avoid apostrophe when inserting a formula with vba", "body": "<p>I'm trying to insert an Index-Match array formula into a cell. My problem is, I need to use a variable inside the formula, and that results in a cell reference in the formula that gets surrounded by apostrophes. I'll explain myself better with an example:</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>Cells(loop, \"H\").value = \"=INDEX('Tab Asistencias'!R1C1:R20000C4,MATCH(1,('Tab Asistencias'!R1C2:R20000C2=R2C2)*('Tab Asistencias'!R1C1:R20000C1=E\" &amp; loop &amp; \"),0),4)\"\n</code></pre>\n\n<p>And, when the formula is already inserted in cell H1 it looks like this:</p>\n\n<p>=INDICE('Tab Asistencias'!$A$1:$D$20000;COINCIDIR(1;('Tab Asistencias'!$B$1:$B$20000=$B$2)*('Tab Asistencias'!$A$1:$A$20000='E2');0);4)</p>\n\n<p>The two apostrophes in the E2 cell reference almost at the end of the formula are the ones that bother me. Because of that Excel doesn't recognize E2 as a valid cell reference.</p>\n\n<p>I'm doing this on a spanish version of Excel (it must be done that way).</p>\n\n<p>Thanks in advance, any help will be appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1473890204, "post_id": 39500157, "comment_id": 66318022, "body": "Obviously not an answer, but shouldn&#39;t the <b><i>backend</i></b> be responsible for maintaining its own identity column integrity?  Why isn&#39;t it just defined as <code>NOT NULL</code> in SQL Server?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473890606, "post_id": 39500157, "comment_id": 66318155, "body": "BTW, if your <code>MsgBox</code> includes <code>Err.Number</code> or <code>Err.Description</code>, it makes this pretty easy to debug."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1473891180, "post_id": 39500157, "comment_id": 66318332, "body": "<i>&quot;(or leaves it as null when creating a new record)&quot;</i> - this will <b>not</b> trigger the control&#39;s <code>BeforeUpdate</code> event."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473950772, "post_id": 39500157, "comment_id": 66343951, "body": "@Comintern It is defined as <code>NOT NULL</code> but I don&#39;t want my users to have to parse SQL server ODBC failed messages"}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 5, "last_activity_date": 1473890507, "creation_date": 1473890507, "answer_id": 39500327, "question_id": 39500157, "link": "https://stackoverflow.com/questions/39500157/why-is-on-error-always-triggering-as-if-the-key-is-null/39500327#39500327", "title": "Why is &#39;On Error&#39; always triggering as if the key is null?", "body": "<p>You need to use <code>IsNull</code></p>\n\n<p>Change:</p>\n\n<pre><code>If Me.S_ID Is Null Then\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>If IsNull(Me.S_ID) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1473949891, "post_id": 39500531, "comment_id": 66343332, "body": "I was using a validation rule, but Access flips its shit and doesn&#39;t allow you to exit the field until you enter something, so if the user opened a new record in error I&#39;m going to get invalid data."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1473891652, "creation_date": 1473891652, "answer_id": 39500531, "question_id": 39500157, "link": "https://stackoverflow.com/questions/39500157/why-is-on-error-always-triggering-as-if-the-key-is-null/39500531#39500531", "title": "Why is &#39;On Error&#39; always triggering as if the key is null?", "body": "<p>1- Why the strange construction with <code>trigger</code>?</p>\n\n<p>Just do</p>\n\n<pre><code>If IsNull(Me.S_ID) Then\n    MsgBox \"Key was null, fix it\"\n    Cancel = True\nEnd If\n</code></pre>\n\n<p>2- For a simple check like this, you don't need any code. Use a <a href=\"http://allenbrowne.com/ValidationRule.html\" rel=\"nofollow\">Validation rule</a> for the form control.</p>\n\n<p>3- All this doesn't cover the case where the user never starts entering anything in the control. This can be handled in <code>Form_BeforeUpdate()</code> by setting <code>Cancel = True</code> there.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1473891998, "creation_date": 1473891998, "answer_id": 39500586, "question_id": 39500157, "link": "https://stackoverflow.com/questions/39500157/why-is-on-error-always-triggering-as-if-the-key-is-null/39500586#39500586", "title": "Why is &#39;On Error&#39; always triggering as if the key is null?", "body": "<p>The other answers explain the solution, so I'll explain the <em>problem</em>.  Your error handler is catching a Run-time error 424: \"Object required\" on this line:</p>\n\n<pre><code>If Me.S_ID Is Null Then\n</code></pre>\n\n<p>The <code>Is</code> comparison operator requires that both sides of the test evaluate to objects.  <code>Null</code> is not an object, thus the error.  Your \"trigger code\" of <code>trigger = 1 / 0</code> that is intended to raise a division by zero error is never fired.  </p>\n\n<p>That said, if you need to test an error handler or create a specific error, it is much easier to just use <code>Err.Raise</code> instead.</p>\n"}], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 39500586, "answer_count": 3, "score": 2, "last_activity_date": 1473891998, "creation_date": 1473889713, "last_edit_date": 1495540853, "question_id": 39500157, "link": "https://stackoverflow.com/questions/39500157/why-is-on-error-always-triggering-as-if-the-key-is-null", "title": "Why is &#39;On Error&#39; always triggering as if the key is null?", "body": "<p>I'm trying to set up error handling in an Access app that connects to a SQL Server backend to prevent Access passing a null primary key to the server.  </p>\n\n<p>I'm using BeforeUpdate and code based on <a href=\"https://stackoverflow.com/questions/6028288/properly-handling-errors-in-vba-excel\">Properly Handling Errors in VBA (Excel)</a></p>\n\n<p>My code is supposed to run the ErrHandler code if the user sets S_ID to null (or leaves it as null when creating a new record).  But instead it's always running the ErrHandler code.</p>\n\n<pre><code>Private Sub S_ID_BeforeUpdate(Cancel As Integer)\n\nDim trigger As Integer\n\nOn Error GoTo ErrHandler\n\nIf Me.S_ID Is Null Then\n    trigger = 1 / 0\nEnd If\n\nExit Sub\n\nErrHandler:\n    MsgBox (\"Key was null, fix it\")\nResume Resume_spot\n\nResume_spot:\n\nEnd Sub\n</code></pre>\n\n<p>I've yet to write the code for what I want Access to do when the error occurs, hence the useless <code>MsgBox</code> and lack of anything after <code>Resume_spot</code>.  Before I get that far I want to get the error handling to trigger properly.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473894101, "post_id": 39500156, "comment_id": 66319143, "body": "Isn&#39;t &quot;Date Modified&quot; 3 not 18 ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473894649, "post_id": 39500156, "comment_id": 66319309, "body": "If you want the value for a specific file then you need <code>sValue = oDir.GetDetailsOf(objFile, 18)</code>"}, {"owner": {"reputation": 1, "user_id": 6832837, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_bsIJi4Xvn4/AAAAAAAAAAI/AAAAAAAAAGs/rBVbwAmCN74/photo.jpg?sz=128", "display_name": "\u0399\u03a9\u0391\u039d\u039d\u0397\u03a3 \u03a3\u039a\u0391\u03a1\u039b\u0391\u03a4\u0391\u039a\u0397\u03a3", "link": "https://stackoverflow.com/users/6832837/%ce%99%ce%a9%ce%91%ce%9d%ce%9d%ce%97%ce%a3-%ce%a3%ce%9a%ce%91%ce%a1%ce%9b%ce%91%ce%a4%ce%91%ce%9a%ce%97%ce%a3"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473962982, "post_id": 39500156, "comment_id": 66351092, "body": "@TimWilliams Thanks for the quick response!  On your first comment you are right &quot;Date modified&quot; is 3 not 18, 18 is the &quot;Tags&quot; but all I get is &quot;Tags&quot; and not the value that is under &quot;Tags&quot; Value is &quot;221&quot;  With regards to the second comment I do have this line already in my code but still nothing."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6832837, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_bsIJi4Xvn4/AAAAAAAAAAI/AAAAAAAAAGs/rBVbwAmCN74/photo.jpg?sz=128", "display_name": "\u0399\u03a9\u0391\u039d\u039d\u0397\u03a3 \u03a3\u039a\u0391\u03a1\u039b\u0391\u03a4\u0391\u039a\u0397\u03a3", "link": "https://stackoverflow.com/users/6832837/%ce%99%ce%a9%ce%91%ce%9d%ce%9d%ce%97%ce%a3-%ce%a3%ce%9a%ce%91%ce%a1%ce%9b%ce%91%ce%a4%ce%91%ce%9a%ce%97%ce%a3"}, "edited": false, "score": 0, "creation_date": 1473963470, "post_id": 39501004, "comment_id": 66351344, "body": "Thanks for the code very convenient to check basically that the the 3 &quot;word&quot; files that I have under the selected folder give me all the properties as expected apart from the 1 pdf file that although I have a &quot;Tag&quot; and &quot;Author &quot; value on it the cell returns blank."}, {"owner": {"reputation": 1, "user_id": 6832837, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_bsIJi4Xvn4/AAAAAAAAAAI/AAAAAAAAAGs/rBVbwAmCN74/photo.jpg?sz=128", "display_name": "\u0399\u03a9\u0391\u039d\u039d\u0397\u03a3 \u03a3\u039a\u0391\u03a1\u039b\u0391\u03a4\u0391\u039a\u0397\u03a3", "link": "https://stackoverflow.com/users/6832837/%ce%99%ce%a9%ce%91%ce%9d%ce%9d%ce%97%ce%a3-%ce%a3%ce%9a%ce%91%ce%a1%ce%9b%ce%91%ce%a4%ce%91%ce%9a%ce%97%ce%a3"}, "edited": false, "score": 0, "creation_date": 1473963565, "post_id": 39501004, "comment_id": 66351392, "body": "I&#39;m not sure if the problem occurs due to the fact that the properties on the pdf are given after installing the &quot;File Meta data&quot; (I have a link above) through the Rclick on the pdf file&gt; Properties&gt; Details&gt; Tags"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1473895389, "last_edit_date": 1473895389, "creation_date": 1473894866, "answer_id": 39501004, "question_id": 39500156, "link": "https://stackoverflow.com/questions/39500156/extended-file-attributes-from-a-pdf-file-using-vba-in-excel/39501004#39501004", "title": "Extended file attributes from a .PDF (file) using VBA in excel", "body": "<p>Here's some code which provides an overview of what properties are available and how to access them.</p>\n\n<p>Adapted from:  <a href=\"http://windowssecrets.com/forums/showthread.php/157834-VBA-FileSystemObject-Properties-Dimensions-Size-and-Vertical-resolution\" rel=\"nofollow\">http://windowssecrets.com/forums/showthread.php/157834-VBA-FileSystemObject-Properties-Dimensions-Size-and-Vertical-resolution</a></p>\n\n<pre><code>Sub GetDetails()\n  Dim oShell As Object\n  Dim oFile As Object\n  Dim oFldr As Object\n  Dim lRow As Long\n  Dim iCol As Integer\n  Dim vArray As Variant\n  vArray = Array(0, 1, 3, 4, 18)\n\n\n  Set oShell = CreateObject(\"Shell.Application\")\n  lRow = 1\n  With Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Select the Folder...\"\n    If .Show Then\n      Set oFldr = oShell.Namespace(.SelectedItems(1))\n      With oFldr\n        For iCol = 0 To 286\n          Cells(lRow, iCol + 1) = .getdetailsof(.items, iCol)\n        Next iCol\n        For Each oFile In .items\n          lRow = lRow + 1\n          For iCol = 0 To 286\n            Cells(lRow, iCol + 1) = .getdetailsof(oFile, iCol)\n          Next iCol\n        Next oFile\n      End With\n    End If\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6832837, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_bsIJi4Xvn4/AAAAAAAAAAI/AAAAAAAAAGs/rBVbwAmCN74/photo.jpg?sz=128", "display_name": "\u0399\u03a9\u0391\u039d\u039d\u0397\u03a3 \u03a3\u039a\u0391\u03a1\u039b\u0391\u03a4\u0391\u039a\u0397\u03a3", "link": "https://stackoverflow.com/users/6832837/%ce%99%ce%a9%ce%91%ce%9d%ce%9d%ce%97%ce%a3-%ce%a3%ce%9a%ce%91%ce%a1%ce%9b%ce%91%ce%a4%ce%91%ce%9a%ce%97%ce%a3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2642, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473895389, "creation_date": 1473889710, "last_edit_date": 1531164843, "question_id": 39500156, "link": "https://stackoverflow.com/questions/39500156/extended-file-attributes-from-a-pdf-file-using-vba-in-excel", "title": "Extended file attributes from a .PDF (file) using VBA in excel", "body": "<p>I'm trying to understand what goes wrong with the below...\nBassicaly I List a series of files in an excel sheet and I'm also looking to add the tags for each file.\nThis is not a problem for office file as I'm using the \".BuiltinDocumentProperties(\"Keywords\").Value\". </p>\n\n<p>However when it comes to Pdf files \nI thought that it would be straight forward to use the \".GetDetailsof()\"       in order to get access to the extended properties. </p>\n\n<p>Well... for some reason I get the below,</p>\n\n<pre><code>sValue = oDir.GetDetailsOf(oDir.Items, 18)\n\n'Returns the \"Date Modified\"\n</code></pre>\n\n<p>While when I use the </p>\n\n<pre><code>sValue = objFile.DateLastModified\n'Returns the actual Value e.g. 09/11/2012 07:01:48\n</code></pre>\n\n<p>Any comments or suggestions will be much appreciated.</p>\n\n<p>P.S.1 I have already read the <a href=\"https://stackoverflow.com/questions/5651890/using-vba-to-get-extended-file-attributes\">Link</a> related to extended file attributes.\nI hope that I din't miss anything.</p>\n\n<p>P.S.2 To be able to add values to a pdf file I use the <a href=\"https://filemeta.codeplex.com\" rel=\"nofollow noreferrer\">File Meta Data</a> </p>\n"}, {"tags": ["excel", "solver", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473889738, "post_id": 39499940, "comment_id": 66317847, "body": "I hate using mouses / mice / meeces, so I usually use keyboard shortcuts.  But I tend to still use the pre-2007 keystrokes, so I had to actually find the answer the hard way by pressing Alt, then seeing what tips it showed against each command."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473889974, "post_id": 39499940, "comment_id": 66317932, "body": "@SergioTulentsev - LOL - good lateral-thinking response!  (Not sure whether it&#39;s quite the answer that the OP was looking for, but it gave me a chuckle anyway.)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473889983, "post_id": 39499940, "comment_id": 66317936, "body": "@YowE3K I agree with you 100% ! ................additionally your approach can also be implemented in <i>VBA</i> with <code>SendKeys</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1473890090, "post_id": 39499940, "comment_id": 66317979, "body": "SendKeys will undoubtedly work, but I wouldn&#39;t guarantee it on anything other than a personal-use application.  (Different users will almost certainly require different key-strokes.)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473890185, "post_id": 39499940, "comment_id": 66318010, "body": "@YowE3K  I agree again !"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1473889608, "creation_date": 1473889608, "answer_id": 39500130, "question_id": 39499940, "link": "https://stackoverflow.com/questions/39499940/initiating-solver-without-the-mouse/39500130#39500130", "title": "Initiating Solver without the Mouse", "body": "<p>On my copy of Excel, you could use Alt-A (to get to the Data menu) and then Y2 to get to Solver. (The \"Y2\" part will almost certainly be dependent on what other addins are enabled.)</p>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 39500130, "answer_count": 1, "score": -1, "last_activity_date": 1473889608, "creation_date": 1473888652, "last_edit_date": 1531161705, "question_id": 39499940, "link": "https://stackoverflow.com/questions/39499940/initiating-solver-without-the-mouse", "title": "Initiating Solver without the Mouse", "body": "<p>Without the mouse, I can show the <code>Format Cells</code> dialog box by touching <kbd>Ctrl</kbd> + <kbd>1</kbd></p>\n\n<p>How can I show the <code>Solver Parameters</code> dialog without using the mouse ??</p>\n\n<p><a href=\"https://i.stack.imgur.com/nHVBU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nHVBU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473889422, "post_id": 39499539, "comment_id": 66317718, "body": "What does your button do now? Do you have the VBA code that Opens the querydef recordset, passing the CASNUMBER from the user? After that you just check for your ecordset.EOF - if true - no records returned - open a MsgBox"}], "answers": [{"comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1473946760, "post_id": 39503249, "comment_id": 66340960, "body": "User input goes to variable <code>lngCASNumber</code> in my example, textbox field can be used instead of variable. I removed last condition because it moved to Dcount function where clause: <code>&quot;CAS=&quot; &amp; lngCASNumber</code>"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1473914505, "creation_date": 1473914505, "answer_id": 39503249, "question_id": 39499539, "link": "https://stackoverflow.com/questions/39499539/query-that-populates-a-datasheet-in-ms-access-and-msgbox-if-no-values-returned/39503249#39503249", "title": "Query that populates a datasheet in MS Access, and MsgBox if no values returned", "body": "<p>I'd recommend join tables using <code>JOIN</code> instead of <code>WHERE</code>. Also you can avoid using parameter, which in most cases requres VBA code for query execution. Just create query without parameter, add CAS to columns list:</p>\n\n<pre><code>SELECT DISTINCT Chemical.Chemical_Name\n    ,Hazard.Hazard_Code\n    ,Hazard.Hazard_Text\n    ,Chemical.CAS\nFROM (\n    Chemical_Hazard INNER JOIN Chemical ON Chemical.Chemical_Id = Chemical_Hazard.Chemical_Id\n    )\nINNER JOIN Hazard ON Chemical_Hazard.Hazard_Id = Hazard.Hazard_Id\n</code></pre>\n\n<p>And then check for CAS in code:</p>\n\n<pre><code>If DCount(\"*\", \"MyQuery\", \"CAS=\" &amp; lngCASNumber) = 0 then\n    MsgBox \"CAS not found\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6472162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74d3c0e28578b0e67065577ac41856b?s=128&d=identicon&r=PG&f=1", "display_name": "luddite20", "link": "https://stackoverflow.com/users/6472162/luddite20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522947195, "creation_date": 1473886685, "last_edit_date": 1522947195, "question_id": 39499539, "link": "https://stackoverflow.com/questions/39499539/query-that-populates-a-datasheet-in-ms-access-and-msgbox-if-no-values-returned", "title": "Query that populates a datasheet in MS Access, and MsgBox if no values returned", "body": "<p>I'm trying to create a query that can run from a button in MS Access.  The SQL query I've created is below: </p>\n\n<pre><code>PARAMETERS CASNUMBER Text ( 255 ); \nSELECT DISTINCT Chemical.Chemical_Name, Hazard.Hazard_Code, Hazard.Hazard_Text \nFROM Chemical, Chemical_Hazard, Hazard \nWHERE Chemical.Chemical_Id = Chemical_Hazard.Chemical_Id \nand Chemical_Hazard.Hazard_Id = Hazard.Hazard_Id \nand [CASNUMBER] = Chemical.CAS\n</code></pre>\n\n<p>;</p>\n\n<p>How do I make it so that a MsgBox appears when there are no values returned?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473887663, "post_id": 39499459, "comment_id": 66317048, "body": "What do you intend to happen when a cell is blank, but other cells on the row are non-blank?  (<code>Selection.SpecialCells(xlCellTypeBlanks).Select</code>, which is [I think] the line you say is correctly selecting the cells to delete, won&#39;t discriminate between rows which are entirely blank and rows where there are some blanks and some non-blanks.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473887690, "post_id": 39499459, "comment_id": 66317062, "body": "It&#39;s best practice to avoid <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>.Select</code></a> - that may be causing issues, since you select something, then activate something after."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1473888085, "creation_date": 1473888085, "answer_id": 39499816, "question_id": 39499459, "link": "https://stackoverflow.com/questions/39499459/how-to-delete-blank-rows-table-rows-in-vba/39499816#39499816", "title": "How to delete blank rows table rows in vba", "body": "<h2>I would delete the empty rows before I convert the range to a table.</h2>\n\n<pre><code>Dim Target As Range\nSet Target = Range(\"$H$1:$L$150\")\nTarget.SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n\nActiveSheet.ListObjects.Add(xlSrcRange, Target, , xlYes).Name = \"Table1\"\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 39499816, "answer_count": 1, "score": 0, "last_activity_date": 1473888085, "creation_date": 1473886304, "question_id": 39499459, "link": "https://stackoverflow.com/questions/39499459/how-to-delete-blank-rows-table-rows-in-vba", "title": "How to delete blank rows table rows in vba", "body": "<p>I was wondering how I can delete blank rows from a table using vba.  Any help would be appreciated!  The code I currently have will create table just fine, and it will select the range I need to delete.  But I can't figure out how to actually get it to delete the rows I need.  There are two different tables I need to do this for.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Worksheets.Item(\"Report\").Range(\"H1:L50\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$H$1:$L$150\"), ,xlYes).Name  = _\n\"Table1\"\n\nRange(\"Table1\").Activate\n\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.EntireRow.Delete\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473884869, "post_id": 39499105, "comment_id": 66315750, "body": "<code>Range(&quot;A&quot; &amp; i &amp; &quot;:C&quot; &amp; i)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 6, "last_activity_date": 1473888201, "last_edit_date": 1473888201, "creation_date": 1473885384, "answer_id": 39499253, "question_id": 39499105, "link": "https://stackoverflow.com/questions/39499105/deleting-rows-within-excel-using-vba/39499253#39499253", "title": "Deleting rows within Excel using VBA", "body": "<p>If you Record Macro, you get something like:</p>\n\n<pre><code>Selection.Delete Shift:=xlUp\n</code></pre>\n\n<p>so here are few options:</p>\n\n<pre><code>Rows(i).Resize(, 3).Delete xlUp\n\nRange(\"A:C\").Rows(i).Delete xlUp\n\nRange(\"A1:C1\").Offset(i - 1).Delete xlUp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "is_accepted": false, "score": 0, "last_activity_date": 1473887160, "creation_date": 1473887160, "answer_id": 39499629, "question_id": 39499105, "link": "https://stackoverflow.com/questions/39499105/deleting-rows-within-excel-using-vba/39499629#39499629", "title": "Deleting rows within Excel using VBA", "body": "<p>Try this VBA code:</p>\n\n<pre><code>Sub Delete_Row_If_Not_Whatever()\nDim RowToTest As Long\n'Macro deletes entire row if \"Whatever\" is not found in column \"D\"\n\n Application.ScreenUpdating = False 'Turn off screen updating. Code runs faster without screen flicker\n\n'Column Count 4 = \"D\"\nFor RowToTest = Cells(Rows.Count, 4).End(xlUp).row To 2 Step -1\n\n'Look for \"Whatever\" save row and delete other rows. Replace \"Whatever\" with what you want to keep.\n'Column Count 4 = \"D\"\nWith Cells(RowToTest, 4)\n    If .Value &lt;&gt; \"Whatever\" _\n    Then _\n    Rows(RowToTest).EntireRow.Delete\nEnd With\n\nNext RowToTest\n\nApplication.ScreenUpdating = True 'Turn on screen updating\nEnd Sub\n</code></pre>\n\n<p>Be sure to save a backup before you begin. :)</p>\n"}], "owner": {"reputation": 99, "user_id": 6809333, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/NqORD.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6809333/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 39499253, "answer_count": 2, "score": 0, "last_activity_date": 1473888201, "creation_date": 1473884796, "last_edit_date": 1531164843, "question_id": 39499105, "link": "https://stackoverflow.com/questions/39499105/deleting-rows-within-excel-using-vba", "title": "Deleting rows within Excel using VBA", "body": "<p>I'm a new programmer to VBA. I am using a simple line to delete rows out of a for-loop I've made. This simple line deletes the current row.</p>\n\n<pre><code>Rows(i).EntireRow.Delete\n</code></pre>\n\n<p>I however have content in column D that I don't want deleted. Is there a way to justify \"EntireRow\" to something else like \"A,B,C\"? </p>\n\n<pre><code>   a  b  c  d\n1  x  x  x  N\n2  x  x  x  N\n3  x  x  x  N \n</code></pre>\n\n<p>X = don't need. N = needed.</p>\n"}, {"tags": ["vba", "dynamic", "formula", "fill"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473883985, "post_id": 39498846, "comment_id": 66315308, "body": "Is there a problem with repeating the fill down for the entire column?  Unless you have a huge dataset you likely wouldn&#39;t notice the difference between that and just filling the empty cells."}, {"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473886594, "post_id": 39498846, "comment_id": 66316608, "body": "@TimWilliams Column A is the date corresponding to when the work was done (once a month say).  So I need to keep the values that already exist in Column A but insert the new date for all the new lines being added to the worksheet.  I responded to your answer which worked but I need to keep the date (column A) the same in every row.  Can you suggest how to do this?  Basically a copy and paste between the last filled cell in Column A and the last row in column B that has data."}, {"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473888221, "post_id": 39498846, "comment_id": 66317251, "body": "@TimWilliams The new edit works like a charm.  Very much appreciated !"}], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 0, "creation_date": 1473885638, "post_id": 39498924, "comment_id": 66316139, "body": "Thank you very much!  This worked correctly.  However, Column A is a date and I now see that the AutoFill function makes the date grow by a day each row.  Is there a way to fill down but keep the value static? (More like a copy and paste)  the value I need to copy is always in the last row of Column A."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1473887535, "last_edit_date": 1473887535, "creation_date": 1473884136, "answer_id": 39498924, "question_id": 39498846, "link": "https://stackoverflow.com/questions/39498846/fill-cell-down-to-adjacent-columns-last-cell-not-from-top-row/39498924#39498924", "title": "Fill Cell Down to Adjacent Columns last cell NOT from top row", "body": "<pre><code>LastRowA = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastRowB = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n'Fill down (will auto-increment)\nRange(\"A\" &amp; LastRowA).AutoFill Destination:=Range(\"A\" &amp; LastRowA &amp; \":A\" &amp; LastRowB)\n\n'EDIT: fill with same fixed value...\nRange(\"A\" &amp; (LastRowA+1) &amp; \":A\" &amp; LastRowB).Value = Range(\"A\" &amp; LastRowA).Value\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1473888852, "creation_date": 1473888852, "answer_id": 39499978, "question_id": 39498846, "link": "https://stackoverflow.com/questions/39498846/fill-cell-down-to-adjacent-columns-last-cell-not-from-top-row/39499978#39499978", "title": "Fill Cell Down to Adjacent Columns last cell NOT from top row", "body": "<p>If you just want to fill down the formula:</p>\n\n<p><code>Range(\"A2:A\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row).FillDown</code></p>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1773, "favorite_count": 0, "accepted_answer_id": 39498924, "answer_count": 2, "score": 1, "last_activity_date": 1473916885, "creation_date": 1473883758, "last_edit_date": 1473916885, "question_id": 39498846, "link": "https://stackoverflow.com/questions/39498846/fill-cell-down-to-adjacent-columns-last-cell-not-from-top-row", "title": "Fill Cell Down to Adjacent Columns last cell NOT from top row", "body": "<p>I am trying to fill down a formula to the bottom cell of the adjacent column. Specifically Fill column A to the bottom row found in Column B. I can achieve this using the following code:</p>\n\n<pre><code>LastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A2\").AutoFill Destination:=Range(\"A2:A\" &amp; lastRow)\n</code></pre>\n\n<p>The issue is that when the file is updated I will need the starting point (to fill down from) to be dynamic.  The first time the file is run the above code works because the file is empty.  The second time however column A may have data to row 100 and column B may have data to 200. So I cannot have the FillDown start at A2. It needs to start at the first empty cell in Column A (there are never empty cells in column A until the bottom of the data). </p>\n\n<p>How can I make the starting point dynamic also?</p>\n\n<p>This Code:</p>\n\n<pre><code>Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n</code></pre>\n\n<p>Selects the \"starting point\" I am looking for when there is already data in the columns but I can't seem to tie that in to my existing code.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["excel", "vba", "charts", "histogram"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6145225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/786246c244194e500231776f4af26ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Shultz", "link": "https://stackoverflow.com/users/6145225/chuck-shultz"}, "edited": false, "score": 0, "creation_date": 1473942812, "post_id": 39499269, "comment_id": 66338146, "body": "Thanks. I was hoping that the &quot;easy way out&quot; was available. This isn&#39;t much work, though."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 3, "last_activity_date": 1473885449, "creation_date": 1473885449, "answer_id": 39499269, "question_id": 39498167, "link": "https://stackoverflow.com/questions/39498167/excel-vba-histogram-bin/39499269#39499269", "title": "Excel vba histogram bin", "body": "<p>The new chart types in Excel 2016, of which the histogram is one, don't yet fully support VBA and not all chart properties are exposed to the VBA object model. That's why you don't see anything returned by the macro recorder.</p>\n\n<p>If you already use VBA, you may as well generate your bins in VBA, aggregate the data with formulas (or VBA) and then plot a standard column chart. </p>\n"}], "owner": {"reputation": 51, "user_id": 6145225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/786246c244194e500231776f4af26ba5?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Shultz", "link": "https://stackoverflow.com/users/6145225/chuck-shultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2082, "favorite_count": 0, "accepted_answer_id": 39499269, "answer_count": 1, "score": 1, "last_activity_date": 1473885449, "creation_date": 1473881094, "question_id": 39498167, "link": "https://stackoverflow.com/questions/39498167/excel-vba-histogram-bin", "title": "Excel vba histogram bin", "body": "<p>I'm creating a histogram using VBA. I have data on the \"Raw Data\" sheet. I can create the chart using the data, then I Cut and Paste it to my \"Summary\" tab using the code below.</p>\n\n<pre><code>'\n' Histogram of Entries\n'\nSheets(\"Raw Data\").Select\nRange(\"F\" &amp; intFirstRow + 1 &amp; \":F\" &amp; intLastRow).Select\nActiveSheet.Shapes.AddChart2(-1, xlHistogram).Select\nSelection.Cut\nSheets(\"Summary\").Select\nActiveSheet.Paste\nWith ActiveSheet.Shapes(\"Chart 3\")\n' Reposition the chart\n    .IncrementLeft Range(\"E17\").Left\n    .IncrementTop Range(\"E17\").Top\nEnd With\n</code></pre>\n\n<p>What I'm struggling with is that I need to adjust the width of the bins, such that the chart displays the count of items in intervals of 10. I can do this in the un-automated way by</p>\n\n<p>-right-clicking on the chart, then selecting \"Format Plot Area\",</p>\n\n<p>-in the sidebar that appears, clicking on the \"Plot Area Options\" drop-down and selecting \"Horizontal Axis\",</p>\n\n<p>-clicking on the histogram icon, then opening up the drop-down for \"Axis Options\", then</p>\n\n<p>-clicking on the \"Bin Width\" item and putting in \"10.0\".</p>\n\n<p>I tried recording the macro while doing this, but I get nothing in it. Any idea how I can do so using VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473941470, "post_id": 39498086, "comment_id": 66337287, "body": "not sure what are you trying to achieve here ? is <code>&quot;Worksheets(&quot;Actual Data&quot;)</code> the SourceData of your PivotTable ? If it is, once you refresh the PivotTable, all data (and headers) should be refreshed according to changes to the source data"}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473945552, "post_id": 39498086, "comment_id": 66340049, "body": "Yes, &quot;Worksheets(&quot;Actual Data&quot;) is the SourceData.  The problem I am try to solve for is that some of the column headers in the SourceData change (weekly). So, when you go to refresh that PivotField drops.  So I am looking for a way to look up the new column header name, and add a PivotField back into the Pivot with that name as the caption.  Without having to update multiple PivotTables manually."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473945838, "post_id": 39498086, "comment_id": 66340287, "body": "the <code>PivotField</code> ? it should be the<code>PivotItems</code>, no ? If not, then either your SourceData is not constrcuted correctly, or yout PivotTable"}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473946673, "post_id": 39498086, "comment_id": 66340878, "body": "Yes, Pivot Items."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "is_accepted": true, "score": 0, "last_activity_date": 1474247239, "last_edit_date": 1474247239, "creation_date": 1474243958, "answer_id": 39563796, "question_id": 39498086, "link": "https://stackoverflow.com/questions/39498086/vba-auto-rebuild-of-pivot-table-datafield-collapse/39563796#39563796", "title": "vba Auto rebuild of Pivot Table DataField collapse", "body": "<p>(SOLVED) Purpose: rebuilds pivot when data source column header changes.</p>\n\n<pre><code>Sub WklyPivotFieldAdd()\n'Purpose: rebuilds pivot when data source column header changes.\nDim pf1 As String\nDim pf2 As String\n\nApplication.ScreenUpdating = False      'Stops screen flicker, increases speed.\n\npf1 = Worksheets(\"Actual Data\").[I3] 'Location of the data source column header that changes\npf2 = Worksheets(\"Actual Data\").[J3] 'Location of the data source column header that changes\n\n'Sets the PivotField name to the source column name for second column in DataField\n   With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(pf1)\n        .Orientation = xlDataField              'Places the new column in the DataField area\n        .Position = 2                           'Second column over\n   End With\n\n   'Sets the PivotField name to the source column name for Fifth column in DataField\n   With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(pf2)\n        .Orientation = xlDataField              'Places the new column in the DataField area\n        .Position = 5                           'Fifth column over\n   End With\nApplication.ScreenUpdating = True       'Starts automatic screen updating\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 39563796, "answer_count": 1, "score": 0, "last_activity_date": 1474645123, "creation_date": 1473880752, "last_edit_date": 1474645123, "question_id": 39498086, "link": "https://stackoverflow.com/questions/39498086/vba-auto-rebuild-of-pivot-table-datafield-collapse", "title": "vba Auto rebuild of Pivot Table DataField collapse", "body": "<p>I have been given the task to maintain a report with multiple pivot tables that summarize Data Source sheets that get updated weekly.  </p>\n\n<p>The Data Sources have multiple column headers that change (e.g. Oct, Nov, Dec &amp; 9/14, 9/21, 9/28).  Thus, every time the pivot tables are refreshed, PivotFields get dropped and need to be re-added manually \u2026 to me a royal pain!  Anyway, I have been trying to automate the \u201crebuild\u201d of these pivot tables.    I have code that will add a positioned PivotField, however the caption\u2019s title has to be entered.  I am looking for a way to pass the text in the data source column to the code that updates the pivot.  I posted the version that works when typed in, and the version that does not work where I am trying to pass the text from the data source.  I believe I am close, but I just cannot figure out why this approach is not working.  Any help or ideas will be much appreciated.</p>\n\n<p>Code that works:</p>\n\n<pre><code>Sub pivottable1()\n\n   With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Sep Actual Hrs thru 9/25\")\n      .Orientation = xlDataField\n      .Position = 2\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>My attempt to retrieve the caption text from the data source (that does not currently work):</p>\n\n<pre><code>Sub PivotFieldAdd()\n\nDim pf As PivotField\n\nWorksheets(\"Actual Data\").Select   'name of the data source\n'pf = Range(\"I3\").Value\n\n    'With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"pf\")    'this doesn't work either.\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields = Range(\"I3\").Value\n        .Orientation = xlDataField\n        .Position = 2\n   End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1473881632, "creation_date": 1473881632, "answer_id": 39498312, "question_id": 39497990, "link": "https://stackoverflow.com/questions/39497990/how-to-reference-named-column-in-excel-vba/39498312#39498312", "title": "How to reference named column in excel VBA", "body": "<p>You would refer to the column and row count of the range inside Cells() range object:</p>\n\n<pre><code>LRow = Cells(Range(\"micheal\").Rows.count, Range(\"micheal\").Column).End(xlUp).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1473901958, "creation_date": 1473901958, "answer_id": 39501829, "question_id": 39497990, "link": "https://stackoverflow.com/questions/39497990/how-to-reference-named-column-in-excel-vba/39501829#39501829", "title": "How to reference named column in excel VBA", "body": "<p>Using <code>Find</code> is recommended rather than <code>xlUp</code>. Both approaches shown below</p>\n\n<pre><code>Dim rng1 As Range\nDim lRow As Long\n\n'Option 1\nlRow = Cells(Rows.Count, Range(\"Michael\").Column).End(xlUp).Row\n\n'Option 2\nSet rng1 = Range(\"Michael\").Find(\"*\", Range(\"Michael\")(1), , , xlPrevious)\nIf Not rng1 Is Nothing Then MsgBox rng1.Row\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 5468834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5798f0bd1fe21828e4192704f81bd82a?s=128&d=identicon&r=PG&f=1", "display_name": "M Sanders", "link": "https://stackoverflow.com/users/5468834/m-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3143, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507633361, "creation_date": 1473880332, "last_edit_date": 1531161705, "question_id": 39497990, "link": "https://stackoverflow.com/questions/39497990/how-to-reference-named-column-in-excel-vba", "title": "How to reference named column in excel VBA", "body": "<p>I have a spread sheet where all of column A is a named range called \"Michael\".</p>\n\n<p>I am getting the row number of the last occupied row.</p>\n\n<p>This code works:\n     <code>LRow = Worksheets(\"Head\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row</code></p>\n\n<p>This code does not work:\n     <code>LRow = Worksheets(\"Head\").Range(\"Michael\" &amp; Rows.Count).End(xlUp).Row</code></p>\n\n<p>How do I get this to work with me using the column name \"Michael\" and not the default A?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473880995, "post_id": 39497966, "comment_id": 66313831, "body": "I can&#39;t replicate in Excel 2013.  Can you screenshot a sample cell?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473955350, "post_id": 39497966, "comment_id": 66346994, "body": "@Comintern I uploaded a screenshot of the cell before and after"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1473955266, "post_id": 39498351, "comment_id": 66346953, "body": "I just tried it and it isn&#39;t working to keep the format. I uploaded a screenshot of how it is affected."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1473882639, "last_edit_date": 1473882639, "creation_date": 1473881768, "answer_id": 39498351, "question_id": 39497966, "link": "https://stackoverflow.com/questions/39497966/replace-function-removes-formatting-vba/39498351#39498351", "title": "replace function removes formatting vba", "body": "<p>Seems like in Excel 2007 the whole cell value is replaced. If the value to replace is between formatting, you might be able to replace it in the cell value XML:</p>\n\n<pre><code>Dim r As Range, s As String\nSet r = sht.UsedRange.Find(fnd)\ns = r.Value(11) ' Excel.XlRangeValueDataType.xlRangeValueXMLSpreadsheet = 11\ns = Replace(s, \"&gt;\" &amp; fnd &amp; \"&lt;\", \"&gt;\" &amp; rplc &amp; \"&lt;\")\nr.Value(11) = s\n</code></pre>\n\n<p>Otherwise you can try this <a href=\"http://www.mrexcel.com/forum/excel-questions/524889-find-replace-loses-text-properties-formatting.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/524889-find-replace-loses-text-properties-formatting.html</a></p>\n\n<pre><code>Dim r As Range, i As Integer\nSet r = sht.UsedRange.Find(fnd)\ni = InStr(r.Characters.Text, fnd)\nr.Characters(i, Len(fnd)).Insert rplc\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473955313, "creation_date": 1473880254, "last_edit_date": 1473955313, "question_id": 39497966, "link": "https://stackoverflow.com/questions/39497966/replace-function-removes-formatting-vba", "title": "replace function removes formatting vba", "body": "<p><a href=\"https://i.stack.imgur.com/QMTnj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QMTnj.png\" alt=\"enter image description here\"></a>Why does this remove the formatting of the cell? I just want to replace a value but it removes underlines from all words within the cell.</p>\n\n<pre><code>For Each sht In ActiveWorkbook.Worksheets\n      sht.Cells.Replace what:=fnd, Replacement:=rplc, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n        SearchFormat:=False, ReplaceFormat:=False\n    Next sht\u200b\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1473879016, "post_id": 39497575, "comment_id": 66312788, "body": "Better learn to use parameters to avoid sql injection and formatting issues."}, {"owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1473879295, "post_id": 39497575, "comment_id": 66312950, "body": "I have a lot of fields as you can.I do not thing using parameters will help"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473879396, "post_id": 39497575, "comment_id": 66312999, "body": "You misunderstand the reason why you would use parameters.  Consider what would happen with a <code>Reopenreason</code> of <code>foo&#39;); DROP TABLE Updates; --</code> ."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1473879546, "post_id": 39497575, "comment_id": 66313065, "body": "It will help.  It will improve your code.  It will prevent mishaps.  It will make you a better programmer."}, {"owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473879843, "post_id": 39497575, "comment_id": 66313206, "body": "Could you please provide me some Links that will help me understand this ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473880141, "post_id": 39497575, "comment_id": 66313377, "body": "@shravya <a href=\"https://www.explainxkcd.com/wiki/index.php/327:_Exploits_of_a_Mom\" rel=\"nofollow noreferrer\">this should help</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1473883670, "post_id": 39497575, "comment_id": 66315167, "body": "Or you might simply use a bound form <i>shrug</i>. It needs no code at all and knows how to deal with NULL values - both for required fields (throw an error) and non-required fields (leave them empty)."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473886161, "post_id": 39497575, "comment_id": 66316390, "body": "@Comintern if that were to happen OP would get the error &quot;Characters found after end of SQL Statement&quot; and nothing would be executed. Access protects against that kind of SQL Injection. Sure no record was inserted but also no table was dropped either."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1473886684, "post_id": 39497575, "comment_id": 66316645, "body": "@Brad. Interesting, I guess I&#39;d need to mess with it in other subtly broken ways or just make it crash. Just because Access only allows one statement through that interface certainly doesn&#39;t excuse getting in the habit of building SQL commands like that."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473886842, "post_id": 39497575, "comment_id": 66316722, "body": "@Comintern oh you are most certainly right. both ADO and DAO easily support parameters. That&#39;s the way to go if you are needing to write queries on code for sure."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473879374, "post_id": 39497682, "comment_id": 66312990, "body": "As you can see that is my question How do i do the mass check for this?"}], "tags": [], "owner": {"reputation": 11, "user_id": 4140724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6Mxc.jpg?s=128&g=1", "display_name": "jeetendar", "link": "https://stackoverflow.com/users/4140724/jeetendar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473879208, "creation_date": 1473879208, "answer_id": 39497682, "question_id": 39497575, "link": "https://stackoverflow.com/questions/39497575/how-to-ignore-the-null-values-in-insert-query-in-access/39497682#39497682", "title": "How to ignore the Null values in Insert query in access", "body": "<p>A simple solution to this problem could be just check for element's value before using in the inset query and if element's value is undefined than set with null.\nPass this value to database in the query.</p>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1473884460, "creation_date": 1473884460, "answer_id": 39499012, "question_id": 39497575, "link": "https://stackoverflow.com/questions/39497575/how-to-ignore-the-null-values-in-insert-query-in-access/39499012#39499012", "title": "How to ignore the Null values in Insert query in access", "body": "<p>Do this for each field:</p>\n\n<pre><code>tktID = IIF(ISNULL(Ticket_number.Value),\"Null\",\"'\" &amp; Ticket_number.Value &amp; \"'\")\n</code></pre>\n\n<p>Then instead of this:</p>\n\n<pre><code>VALUES ('\" &amp; tktID &amp; \"',...\n</code></pre>\n\n<p>Do this</p>\n\n<pre><code>VALUES (\" &amp; tktID &amp; \",...\n</code></pre>\n\n<p>Or if you don't mind replacing nulls with empty strings:</p>\n\n<pre><code>tktID = Nz(Ticket_number.Value)\n</code></pre>\n\n<p>will do it.</p>\n\n<p>Of course you should at least make sure no single quotes are in the stings, so even better:</p>\n\n<pre><code> tktID = IIF(ISNULL(Ticket_number.Value),\"Null\",\"'\" &amp; Replace(Ticket_number.Value,\"'\",\"''\") &amp; \"'\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473888779, "post_id": 39499590, "comment_id": 66317485, "body": "I am using a bound form it self and have no problem adding the details in the table to which it is mapped however when a value in that form is Checked I want those details to be inserted in another table as well"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473889317, "post_id": 39499590, "comment_id": 66317673, "body": "@shravya I see, in that case look into making a query to insert these values. The kind that prompts you to enter things when you run it. Then use that query via the <code>CurrentDb</code>QueryDefs` collection to do the insert. the returned <code>QueryDef</code> object has a <code>Parameters</code> collection. You can add your nulls to that/unsanitized inputs to that. If I get some time I can update/write another answer."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473889357, "post_id": 39499590, "comment_id": 66317691, "body": "Alternatively you could use a subform with some clever binding."}, {"owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "edited": false, "score": 0, "creation_date": 1473892415, "post_id": 39499590, "comment_id": 66318656, "body": "Thanks Will Try that also will be waiting to see if i can get another way to resolve this"}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 2, "last_activity_date": 1473886922, "creation_date": 1473886922, "answer_id": 39499590, "question_id": 39497575, "link": "https://stackoverflow.com/questions/39497575/how-to-ignore-the-null-values-in-insert-query-in-access/39499590#39499590", "title": "How to ignore the Null values in Insert query in access", "body": "<p>I, too, setup my first Access database using lots of unbound controls and SQL statements for moving data around. But this is not the way to use Access. You should be using bound forms where the controls automatically know what the constraints are based on the table/columns they are bound to.</p>\n\n<p>This means much less code for you to write (and maintain), future developers can look at your Access app and know what's going on because it will be done in the Access paradigm, and if you place as much logic into your tables/relationships as possible then if someone comes along and links to your ACCDB or opens the backend they <em>could</em> enter data without entering bad data. </p>\n\n<p>So ultimately this is an XY problem. Get rid of all this code (especially <code>DoCmd.RunSQL</code>) and create a bound form. Put your validation logic in foreign keys, validation rules, and/or data macros in the table. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6030988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C2yxY.jpg?s=128&g=1", "display_name": "Cbuz", "link": "https://stackoverflow.com/users/6030988/cbuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1604742871, "last_edit_date": 1604742871, "creation_date": 1604691699, "answer_id": 64720704, "question_id": 39497575, "link": "https://stackoverflow.com/questions/39497575/how-to-ignore-the-null-values-in-insert-query-in-access/64720704#64720704", "title": "How to ignore the Null values in Insert query in access", "body": "<p>After building the string  for INSERT statment</p>\n<pre><code>strSql = &quot;INSERT INTO tblmovimentiServizi ( msid, &quot; _\n&amp; &quot; msData, msIdDestinazione, msOraInizioServizio,  msOraFineServizio, msAndataRitorno, &quot; _\n&amp; &quot; msOraVincoloEntrata, msOraVincoloUscita, msidAnagraficaAutomezzi, msServizioEseguito, msNoteCommenti) &quot; _\n&amp; &quot; VALUES ('&quot; &amp; rst!newid &amp; &quot;', #&quot; &amp; rst!msData + Me.g1 &amp; &quot;#, '&quot; _\n&amp; rst!msIdDestinazione &amp; &quot;', #&quot; _\n&amp; rst!msOraInizioServizio &amp; &quot;#, #&quot; _\n&amp; rst!msOraFineServizio &amp; &quot;#, '&quot; _\n&amp; rst!msAndataRitorno &amp; &quot;', #&quot; _\n&amp; rst!msOraVincoloEntrata &amp; &quot;#, #&quot; _\n&amp; rst!msOraVincoloUscita &amp; &quot;#, '&quot; _\n&amp; rst!msidAnagraficaAutomezzi &amp; &quot;', &quot; _\n&amp; eseguito &amp; &quot;, '&quot; _\n&amp; rst!msNoteCommenti &amp; &quot;'&quot; _\n&amp; &quot;);&quot;\n</code></pre>\n<p>I added</p>\n<pre><code>strSql = Replace(strSql, &quot;''&quot;, &quot;null&quot;)\nstrSql = Replace(strSql, &quot;##&quot;, &quot;null&quot;)\n</code></pre>\n<p>and it works.</p>\n"}], "owner": {"reputation": 11, "user_id": 4488872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lx2gB.jpg?s=128&g=1", "display_name": "shravya", "link": "https://stackoverflow.com/users/4488872/shravya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1604742871, "creation_date": 1473878801, "question_id": 39497575, "link": "https://stackoverflow.com/questions/39497575/how-to-ignore-the-null-values-in-insert-query-in-access", "title": "How to ignore the Null values in Insert query in access", "body": "<p>I have the  Database table where the Table needs to be updated using a form.\nHowever all the fields in the Form need not be mandatory to be filled.\nI am Writing the Below VB code for inserting However I get an error stating that there is a syntax error in the statement.As i understand it is because of the Null  Values in the Variable. I understand that I need to use DBNull.Value for all the  null Values.\nHere the Thing is there are too many fields to check if the value is null or not.\nany body suggest if there is a way to do a mass check on the values entered to be null?</p>\n\n<p>VBCode:</p>\n\n<pre><code>Dim StrSQL As String\nDim StrSQL1 As String\nDim tktID As Variant\nDim Assi As Variant\nDim reopened As Variant\nDim valid As Variant\nDim Reopenreason As Variant\nDim ReassignmentAG As Variant\nDim RBSCollab As Variant\nDim SMEconf As Variant\nDim Cloabag As Variant\nDim smeName As Variant\nDim Updat  As Variant\nDim Closed As Variant\nDim iss As Variant\nDim ana As Variant\nDim res As Variant\nDim rVariant As Variant\n\n' Assigining values\n\ntktID = Ticket_number.Value\nreopened = Ticket_Reopened.Value\nvalid = Valid_Reopen.Value\nAssi = Assiginee.Value\nReopenreason = Reopen_reason.Value\nReassignmentAG = Reassignment_AG.Value\nRBSCollab = RBS_Collab.Value\nSMEconf = CkBxSMEConfirmation.Value\nCloabag = Collabarated_AG.Value\nsmeName = SME_Name.Value\nUpdat = Update.Value\nClosed = Issue_Closed.Value\niss = Issue.Value\nana = Analysis.Value\nres = Resolution.Value\nrdate = Resolve_date.Value\n\n'Insert values into the tables\n\nStrSQL = \"INSERT INTO Updates (TicketID,Assiginee,ReassignmentAG,RBSCollab,CollabAG,SMEconfirmation,SMEName,Update,IssueClosed,Issue,Analysis,Resolution,ResolveDate,TicketReopened,ValidReopen,ReopenReason) VALUES ('\" &amp; tktID &amp; \"','\" &amp; Assi &amp; \"','\" &amp; ReassignmentAG &amp; \"','\" &amp; RBSCollab &amp; \"','\" &amp; Cloabag &amp; \"','\" &amp; SMEconf &amp; \"','\" &amp; smeName &amp; \"','\" &amp; Updat &amp; \"','\" &amp; Closed &amp; \"','\" &amp; iss &amp; \"','\" &amp; ana &amp; \"','\" &amp; res &amp; \"','\" &amp; rdate &amp; \"','\" &amp; reopened &amp; \"','\" &amp; valid &amp; \"','\" &amp; Reopenreason &amp; \"' ) \"\nDoCmd.RunSQL StrSQL\n</code></pre>\n\n<p>thanks in advance for your help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1473885463, "post_id": 39497660, "comment_id": 66316042, "body": "That did it! thank you. such a smart and idea, add an if statement."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1473883821, "last_edit_date": 1473883821, "creation_date": 1473879138, "answer_id": 39497660, "question_id": 39497542, "link": "https://stackoverflow.com/questions/39497542/how-to-alter-code-with-for-each-loop-to-to-avoid-error-1004-no-cells-found/39497660#39497660", "title": "How to alter code with FOR Each Loop to to avoid Error: 1004 No cells found", "body": "<p>You <em>could</em> do this:</p>\n\n<pre><code>Dim rng As Range\n\n'...\nWith Worksheets(\"Sheet1\")\n    On Error Resume Next\n    Set rng = .Range(\"B8\", .Cells(8, .Columns.Count).End( _\n               xlToRight)).SpecialCells(XlCellType.xlCellTypeConstants)\n    On Error Goto 0\n    If Not rng Is Nothing Then\n    For Each cell In rng\n        AddDropDown Worksheets(\"DropDownsTT\"), iDropDown, _\n           cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp; _\n           cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address\n    Next cell\n    End If\nEnd With\n</code></pre>\n\n<p>but that's kind of untidy, so I would probably use something like:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    For Each cell In .Range(\"B8\", .Cells(8, .Columns.Count).End( xlToRight))\n        If Len(cell.Value) &gt; 0 Then\n            AddDropDown Worksheets(\"DropDownsTT\"), iDropDown, _\n                cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp; _\n                cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address\n        End If\n    Next cell\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 39497660, "answer_count": 1, "score": 1, "last_activity_date": 1473976950, "creation_date": 1473878651, "last_edit_date": 1473976950, "question_id": 39497542, "link": "https://stackoverflow.com/questions/39497542/how-to-alter-code-with-for-each-loop-to-to-avoid-error-1004-no-cells-found", "title": "How to alter code with FOR Each Loop to to avoid Error: 1004 No cells found", "body": "<p>I have a macro that looks below header names for items if there is an item it will make it a drop down. Headers are in the 7th row so it starts looking from row 8 and on. The code runs perfectly, except if there is no items below the headers. </p>\n\n<p>Sometimes the user does not need any drop downs for the sheet so they will leave all rows below the headers blank. Which is great for what I am doing but will make the macro throw errors as there is no items to be found. </p>\n\n<p>I essentially need to tweak my code so it is able to stop or exit if no cells are found. This is the macro I need to tweak.</p>\n\n<pre><code>Sub AddDropDowns()\nDim cell As Range\nDim iDropDown As Long\n\nWith Worksheets(\"Sheet1\")\n    For Each cell In .Range(\"B8\", .Cells(8, .Columns.Count).End(xlToRight)).SpecialCells(XlCellType.xlCellTypeConstants)\n        AddDropDown Worksheets(\"DropDownsTT\"), iDropDown,     cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp;     cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address\n    Next cell\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Not sure if this piece of code is needed but the macro calls the following subroutine:</p>\n\n<pre><code>Sub AddDropDown(sht As Worksheet, dropDownCounter As Long, header As String,     validationFormula As String)\nWith sht.Range(\"A1\").Offset(, dropDownCounter) '&lt;--| reference passed sheet row 1 passed column\n    .Cells(1, 1) = header '&lt;--| write header\n    With .Cells(2, 1).Validation '&lt;--| reference 'Validation' property of cell 1 row below currently referenced one\n        .Delete\n\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=validationFormula\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd With\ndropDownCounter = dropDownCounter + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473880569, "post_id": 39497486, "comment_id": 66313604, "body": "The yellow highlight only means that&#39;s the current executing line, it&#39;s not an error by itself, it&#39;s just a feature of the debugger - what&#39;s the <i>actual</i> error message you&#39;re getting?"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "is_accepted": true, "score": 0, "last_activity_date": 1473881648, "last_edit_date": 1473881648, "creation_date": 1473881244, "answer_id": 39498208, "question_id": 39497486, "link": "https://stackoverflow.com/questions/39497486/is-correct-the-code-for-bring-to-front-or-send-to-back/39498208#39498208", "title": "Is correct the code for &quot;Bring To Front&quot; or &quot;Send To Back&quot;?", "body": "<p>I made a little correction and it was useful, So it works properly :)</p>\n\n<p>I Should put the codes into the \"Current Event\" Instead the \"Load Event\".</p>\n\n<pre><code>Private Sub Report_Current()\n\nIf IsOpen(\"Details_ME\") Then\n\n    Me.Controls(\"DRAFT_Logo\").InSelection = True\n    DoCmd.RunCommand acCmdBringToFront\n\nElse\n\n    Me.Controls(\"DRAFT_Logo\").InSelection = True\n    DoCmd.RunCommand acCmdSendToBack\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thank You ...</p>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5659, "favorite_count": 0, "accepted_answer_id": 39498208, "answer_count": 1, "score": -4, "last_activity_date": 1475674840, "creation_date": 1473878425, "last_edit_date": 1475674840, "question_id": 39497486, "link": "https://stackoverflow.com/questions/39497486/is-correct-the-code-for-bring-to-front-or-send-to-back", "title": "Is correct the code for &quot;Bring To Front&quot; or &quot;Send To Back&quot;?", "body": "<p>Is correct the below code for \"Bring To Front\" or \"Send To Back\" a field/object in VBA Access 2010?</p>\n\n<p>My code is:</p>\n\n<pre><code>Private Sub Report_Load()\n\nIf IsOpen(\"Details_ME\") Then\n\n    Me.Controls(\"DRAFT_Logo\").InSelection = True\n    DoCmd.RunCommand acCmdBringToFront\nElse\n\n    Me.Controls(\"DRAFT_Logo\").InSelection = True\n    DoCmd.RunCommand acCmdSendToBack\n\nEnd If\n\nEnd sub\n</code></pre>\n\n<p>VBA shows yellow error on below code:</p>\n\n<pre><code>Me.Controls(\"DRAFT_Logo\").InSelection = True\n</code></pre>\n\n<p>Any help or advice is appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473880123, "post_id": 39497420, "comment_id": 66313369, "body": "How do you &quot;place the contents of the textbox&quot;? Can you post the code that you&#39;re using to transfer the text around?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1473885481, "post_id": 39497828, "comment_id": 66316058, "body": "Clean does the trick on the sheet but how do I do that in code? Ok figured it out. :)    WorksheetFunction.Clean()"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1473879730, "creation_date": 1473879730, "answer_id": 39497828, "question_id": 39497420, "link": "https://stackoverflow.com/questions/39497420/vba-textbox-invisible-characters/39497828#39497828", "title": "VBA Textbox invisible characters", "body": "<p>To see most of the non-printable characters, change the font to Terminal and un-toggle <code>Wrap Text</code></p>\n\n<p>To find what character code it is, you can use the <a href=\"https://support.office.com/en-us/article/CODE-function-c32b692b-2ed0-4a04-bdd9-75640144b928\" rel=\"nofollow\"><code>CODE</code></a> function:</p>\n\n<pre><code>= Code( Mid( A2, 6, 1 ) )\n</code></pre>\n\n<p>To remove non-printable ASCII characters, you can use the <a href=\"https://support.office.com/en-us/article/CLEAN-function-26f3d7c5-475f-4a9c-90e5-4b8ba987ba41\" rel=\"nofollow\"><code>CLEAN</code></a> function:</p>\n\n<pre><code>= Clean( A2 )\n</code></pre>\n\n<p>To replace just the line feed characters with space:</p>\n\n<pre><code>= SUBSTITUTE( A2, CHAR( 10 ), \" \" )\n</code></pre>\n\n<p><a href=\"https://support.office.com/en-us/article/Remove-spaces-and-nonprinting-characters-from-text-023f3a08-3d56-49e4-bf0c-fe5303222c9d\" rel=\"nofollow\">Remove spaces and nonprinting characters from text</a></p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473880457, "post_id": 39497933, "comment_id": 66313542, "body": "In Excel 2013 at least, if you paste a <code>vbCrLf</code> into a cell from the clipboard, Excel will remove the <code>vbCr</code> as it comes off the clipboard. If you assign the cell value directly (i.e. <code>Range(&quot;A1&quot;).Value = &quot;A&quot; &amp; vbCrLf &amp; &quot;B&quot;</code>) it isn&#39;t removed."}, {"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1473885467, "post_id": 39497933, "comment_id": 66316049, "body": "Ok how do I do that type of replacement."}, {"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1473888126, "post_id": 39497933, "comment_id": 66317213, "body": "I am also getting these &quot;<i>x000D</i>&quot;"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1473880147, "last_edit_date": 1495541301, "creation_date": 1473880147, "answer_id": 39497933, "question_id": 39497420, "link": "https://stackoverflow.com/questions/39497420/vba-textbox-invisible-characters/39497933#39497933", "title": "VBA Textbox invisible characters", "body": "<p>Excel uses <code>vbLf</code> as the <a href=\"https://stackoverflow.com/q/8613850/11683\">line break character</a> in cells. The <code>vbCr</code> character is not used for line breaking and <a href=\"https://stackoverflow.com/questions/8613850/c-sharp-excel-interop-put-a-line-break-in-the-text-of-a-cell-in-a-excel#comment65333905_8652279\">will</a> either display as a box (older Excels) or as a space (newer Excels).</p>\n\n<p>If you want to put text in an Excel cell, replace <code>vbCrLf</code> with <code>vbLf</code> first.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "is_accepted": false, "score": 0, "last_activity_date": 1473885807, "creation_date": 1473885807, "answer_id": 39499358, "question_id": 39497420, "link": "https://stackoverflow.com/questions/39497420/vba-textbox-invisible-characters/39499358#39499358", "title": "VBA Textbox invisible characters", "body": "<p>Ok I have solved the problem.\nI am using the worksheet function \nWorksheetFunction.Clean()\nThis works and I do not have to do anything else. \nThanks for the input. :)</p>\n"}], "owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1401, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473885807, "creation_date": 1473878196, "last_edit_date": 1531164843, "question_id": 39497420, "link": "https://stackoverflow.com/questions/39497420/vba-textbox-invisible-characters", "title": "VBA Textbox invisible characters", "body": "<p>When I put text from a spreadsheet into a form textbox the text has an extra character.</p>\n\n<p>I placed the contents of the textbox in a cell alongside the original text from a spreadsheet cell. When I do a <code>LEN()</code> function on both the original text and the textbox text, the textbox text shows 25 and the original text is 24.</p>\n\n<p>My question is why is the text different. I cannot figure out what this extra character is.<br>\nThe text is 2 lines separated by a <code>CTL</code> and <code>LF</code>. I have also tried to use the <code>Trim()</code> function as well.</p>\n\n<p>Has anyone figured this out? How can I compare the two texts so they are a match if the form text box adds some invisible character?</p>\n\n<p>Below the first row is the <code>LEN()</code> function for A and B cells.<br>\nThe second row is the values from the spreadsheet original cell and the second is the same value but put into a textbox on a form then output back to spreadsheet. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Rr0n2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rr0n2.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1473877599, "post_id": 39497212, "comment_id": 66312024, "body": "You need three nested loops one for each array."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1473877858, "creation_date": 1473877858, "answer_id": 39497325, "question_id": 39497212, "link": "https://stackoverflow.com/questions/39497212/parse-multiple-arrays-and-write-all-possible-combinations/39497325#39497325", "title": "Parse Multiple Arrays and write all possible combinations", "body": "<p>As @ScottCraner mentioned in the comments, all you need to do is nest 3 loops:</p>\n\n<pre><code>For Each word In baseWord\n    For Each num In numberCharSet\n        For Each special In specialCharSet\n            Debug.Print word &amp; num &amp; special\n        Next\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5108710, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-d9zF9B9SeKk/AAAAAAAAAAI/AAAAAAAAABI/eDWziS-3qMI/photo.jpg?sz=128", "display_name": "feltersnach", "link": "https://stackoverflow.com/users/5108710/feltersnach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 39497325, "answer_count": 1, "score": 0, "last_activity_date": 1473877858, "creation_date": 1473877491, "question_id": 39497212, "link": "https://stackoverflow.com/questions/39497212/parse-multiple-arrays-and-write-all-possible-combinations", "title": "Parse Multiple Arrays and write all possible combinations", "body": "<p>I am trying to use VBA in Excel to write all of the possible combinations of the contents of three arrays to a column to create a wordlist.</p>\n\n<p>Currently, I know how to loop through the arrays and get some output that I want but I can't figure out how to build the loop to give me all possible combinations of the baseWord(n) &amp; numberCharSet(n) &amp; specialCharSet(n).</p>\n\n<p>How do I properly loop through the baseWord array to get all combinations of each baseWord with the contents of the specialCharSet and numberCharSet arrays?</p>\n\n<p>Example:\nCloud1!\nCloud1@\nCloud1#\nCloud1$\nCloud2!\netc...</p>\n\n<pre><code>Private Sub createWordlist()\n\nDim baseWord(1 To 2) As String\nbaseWord(1) = \"Cloud\"\nbaseWord(2) = \"cloud\"\n\nDim numberCharSet(1 To 4) As String\nnumberCharSet(1) = \"1\"\nnumberCharSet(2) = \"2\"\nnumberCharSet(3) = \"3\"\nnumberCharSet(4) = \"4\"\n\n\nDim specialCharSet(1 To 4) As String\nspecialCharSet(1) = \"!\"\nspecialCharSet(2) = \"@\"\nspecialCharSet(3) = \"#\"\nspecialCharSet(4) = \"$\"\n\nx = 1\ny = 1\nz = 4\nw = 1\n\nFor Each Item In baseWord\n    Range(\"A\" &amp; x).Value = baseWord(w) &amp; numberCharSet(y) &amp; specialCharSet(z)\n    x = x + 1\n    y = y + 1\n    z = z - 1\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "forms", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473878057, "post_id": 39497203, "comment_id": 66312276, "body": "What does <code>LaunchTransPO</code> do?"}, {"owner": {"reputation": 45, "user_id": 4143571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27b999a93c3efd2c7e4672283b960ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Y2kShea", "link": "https://stackoverflow.com/users/4143571/y2kshea"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474047550, "post_id": 39497203, "comment_id": 66388477, "body": "LaunchTransPO runs several out of process queries and loops through each result to populate the fields in the form that opens.  One of the last things this subroutine does before closing out all the objects and ending is this:    frmPO_Trans.cmdExit.SetFocus  &#39;command button on frmPO_Trans  frmPO_Trans.Repaint   exit_frmSignLog:    If Not (rs Is Nothing) Then     Set rs = Nothing End If"}], "owner": {"reputation": 45, "user_id": 4143571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27b999a93c3efd2c7e4672283b960ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Y2kShea", "link": "https://stackoverflow.com/users/4143571/y2kshea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473877988, "creation_date": 1473877444, "last_edit_date": 1473877988, "question_id": 39497203, "link": "https://stackoverflow.com/questions/39497203/excel-2010-vba-form-retreats-behind-excel-when-query-returns", "title": "Excel 2010 VBA - Form retreats behind Excel when query returns", "body": "<p>I have an vba form launched from a command button on an Excel worksheet.  The form queries data (using LaunchTransPO shown below) from an SQL server, then populates a listbox in the form.  When the data returns it will populate the form, however the form falls behind the Excel application making the user wonder where the form went.  Here is the relevant code that is run in the form's Activate event: </p>\n\n<pre><code>Private Sub UserForm_Activate()\n\nIf gbExit = True Then\n    Exit Sub\nEnd If\n\ngbExit = True\n\nCall LaunchTransPO\n\n\nApplication.EnableEvents = False\n\nfrmPO_Trans.Hide\n\nIf frmPO_Trans.Visible = False Then\n    frmPO_Trans.Show\nEnd If\n\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>You can see where I've tried hiding the form then showing it again, and using the gbExit boolean to keep it from going into a loop.  I've had inconsistent success with this.  </p>\n\n<p>Is there a way to explicitly bring focus to this form following the data return?</p>\n"}, {"tags": ["vba", "object", "foreach"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1473874794, "post_id": 39496404, "comment_id": 66310631, "body": "Remove brackets. <code>pFname csv</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6832039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZHob.jpg?s=128&g=1", "display_name": "Brendan Rafferty", "link": "https://stackoverflow.com/users/6832039/brendan-rafferty"}, "edited": false, "score": 0, "creation_date": 1473875466, "post_id": 39496641, "comment_id": 66310947, "body": "Great! That worked ... even though I specify &quot;ByVal&quot; in the function definition. I removed &quot;ByVal&quot; and it still works. I&#39;ll keep it this way but I only added &quot;ByVal&quot; because I saw an example of it somewhere."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 6832039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZHob.jpg?s=128&g=1", "display_name": "Brendan Rafferty", "link": "https://stackoverflow.com/users/6832039/brendan-rafferty"}, "edited": false, "score": 1, "creation_date": 1473875838, "post_id": 39496641, "comment_id": 66311122, "body": "@BrendanRafferty - <code>ByVal</code> and <code>ByRef</code> work the same way for objects, except that it passes the object <code>reference</code>  <code>ByVal</code> or<code>ByRef</code>.  I.e., if you pass an object as a <code>ByVal</code> parameter and set it to a new object inside the procedure, it won&#39;t effect the variable in the calling procedure.  If you pass an object as a <code>ByRef</code> parameter and set it to a new object, the variable in the calling procedure will also point to the new object."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 6832039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZHob.jpg?s=128&g=1", "display_name": "Brendan Rafferty", "link": "https://stackoverflow.com/users/6832039/brendan-rafferty"}, "edited": false, "score": 0, "creation_date": 1473876464, "post_id": 39496641, "comment_id": 66311458, "body": "@BrendanRafferty parameters are passed <code>ByRef</code> by default in VBA, but in an overwhelming majority of cases it&#39;s <code>ByVal</code> that makes more sense; there&#39;s a reason VB.NET and other languages pass parameters by value, by default."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1506030959, "last_edit_date": 1506030959, "creation_date": 1473875043, "answer_id": 39496641, "question_id": 39496404, "link": "https://stackoverflow.com/questions/39496404/passing-a-for-each-object-to-a-sub-or-function-in-vba/39496641#39496641", "title": "Passing a for-each object to a sub or function in vba", "body": "<p>You need to remove the parentheses on this line:  <code>pFname (csv)</code></p>\n\n<p>Putting the parentheses around the parameter forces it to be passed <code>ByVal</code>, and you can't do that with an <code>Object</code>, because an <code>Object</code> basically <em>is</em> a reference.  This works just fine:</p>\n\n<pre><code>Sub test()\nDim fs As Object\nDim csv As Object\nDim oFolder As Object\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = fs.getfolder(Application.CurrentProject.Path)\n\nFor Each csv In oFolder.files\n    Debug.Print csv.Name\n    pFname csv  '&lt;-----\nNext csv\nEnd Sub\n\nSub pFname(ByVal csv As Object)\n    Debug.Print csv.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6832039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZHob.jpg?s=128&g=1", "display_name": "Brendan Rafferty", "link": "https://stackoverflow.com/users/6832039/brendan-rafferty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "accepted_answer_id": 39496641, "answer_count": 1, "score": 0, "last_activity_date": 1506030959, "creation_date": 1473874129, "question_id": 39496404, "link": "https://stackoverflow.com/questions/39496404/passing-a-for-each-object-to-a-sub-or-function-in-vba", "title": "Passing a for-each object to a sub or function in vba", "body": "<p>When I call the sub pFileName I get an 'object required' error with the following code:</p>\n\n<pre><code>Sub test()\nDim fs As Object\nDim csv As Object\nDim oFolder As Object\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = fs.getfolder(Application.CurrentProject.Path)\n\nFor Each csv In oFolder.files\n    Debug.Print csv.Name\n    pFname (csv)\nNext csv\nEnd Sub\n\nSub pFname(ByVal csv As Object)\n    Debug.Print (csv.Name)\nEnd Sub\n</code></pre>\n\n<p>I'm not sure why csv isn't considered an object - doesn't the Debug.Print statement right before the sub call prove it is an object?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1473873206, "post_id": 39496106, "comment_id": 66309739, "body": "Why don&#39;t you want to loop? speed?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473873314, "post_id": 39496106, "comment_id": 66309799, "body": "whats the range of <code>C2</code> and <code>C3</code> ? 1 to 10?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1473873363, "post_id": 39496106, "comment_id": 66309829, "body": "Try <code>.Value</code> instead of <code>.Text</code>"}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1473873969, "post_id": 39496106, "comment_id": 66310171, "body": "@CRUTER, yeah, just speed / curiosity."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473874048, "post_id": 39496106, "comment_id": 66310219, "body": "@Slai, yes, it would just be a number to complete the cell reference... But that was just a stupid example to show what I meant by the string concatenation becoming a formula - My formulas are substantially more complex (external workbook references, etc)."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473875029, "post_id": 39496106, "comment_id": 66310738, "body": "<a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1473874194, "post_id": 39496278, "comment_id": 66310293, "body": "Sadly, this is not what I&#39;m looking for - My formulas are very complex, that was just a simple example to show what I meant by the string concatenation... @MatsMug got the correct answer. But thanks for your input!!"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1473873668, "creation_date": 1473873668, "answer_id": 39496278, "question_id": 39496106, "link": "https://stackoverflow.com/questions/39496106/excel-vba-convert-a-string-formula-to-an-excel-calculation-in-a-range-of-cells/39496278#39496278", "title": "Excel VBA - Convert a string Formula to an Excel Calculation in a range of cells", "body": "<p>Not sure if this is what you are trying to do, but if for example you use:</p>\n\n<pre><code>Range(\"A1:C10\").Formula = \"=Sum(D1:E1)\"\n</code></pre>\n\n<p>then the relative references will be auto adjusted:</p>\n\n<pre><code>A1: =Sum(D1:E1)\nA2: =Sum(D2:E2)\nB1: =Sum(E1:F1)\n... etc.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1473874874, "creation_date": 1473874874, "answer_id": 39496587, "question_id": 39496106, "link": "https://stackoverflow.com/questions/39496106/excel-vba-convert-a-string-formula-to-an-excel-calculation-in-a-range-of-cells/39496587#39496587", "title": "Excel VBA - Convert a string Formula to an Excel Calculation in a range of cells", "body": "<p><code>Range.Text</code> contains the string representation of the cell's value. The <em>actual</em> calculated value (which I suspect is what you're after) is accessed using <code>Range.Value</code> - try this:</p>\n\n<pre><code>Range(\"A1:C10\").Formula = Range(\"A1:C10\").Value\n</code></pre>\n"}], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1619, "favorite_count": 0, "accepted_answer_id": 39496587, "answer_count": 2, "score": 0, "last_activity_date": 1473874874, "creation_date": 1473872865, "question_id": 39496106, "link": "https://stackoverflow.com/questions/39496106/excel-vba-convert-a-string-formula-to-an-excel-calculation-in-a-range-of-cells", "title": "Excel VBA - Convert a string Formula to an Excel Calculation in a range of cells", "body": "<p>I'm just wondering if this is possible to do without a loop - In my excel sheet, in, say, <code>Range(\"A1:C10\")</code> I have text concatenation formulas that, once concatenated, create real Excel functions.</p>\n\n<p>As a stupid example, suppose I had the following in cell A1:</p>\n\n<pre><code>A1: =\"=Sum(D\"&amp;C2&amp;\":E\"&amp;C3&amp;\")\"\n</code></pre>\n\n<p>Now, I know in VBA I can do something along the following for any one specific cell:</p>\n\n<pre><code>Range(\"A1\").Formula = Range(\"A1\").Text\n</code></pre>\n\n<p>And it will convert my text formula into an Excel formula and evaluate it.</p>\n\n<p>Now, what I'm curious about is, whether there a way to say, for example:</p>\n\n<pre><code>Range(\"A1:C10\").Formula = Range(\"A1:C10\").Text\n</code></pre>\n\n<p>Without looping through each cell individually?</p>\n\n<p>Also, I can't use <code>INDIRECT()</code> as, unfortunately, my formulas refer to closed workbooks :/</p>\n\n<p>Any ideas??</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 76, "user_id": 1636667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9mxd.png?s=128&g=1", "display_name": "Dr. Cogent", "link": "https://stackoverflow.com/users/1636667/dr-cogent"}, "edited": false, "score": 0, "creation_date": 1473872085, "post_id": 39495678, "comment_id": 66309165, "body": "Maybe this is what you are looking for?  <a href=\"http://stackoverflow.com/questions/19336987/vba-excel-initialize-entire-array-without-looping\">VBA (Excel) Initialize Entire Array without Looping</a>"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 76, "user_id": 1636667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9mxd.png?s=128&g=1", "display_name": "Dr. Cogent", "link": "https://stackoverflow.com/users/1636667/dr-cogent"}, "edited": false, "score": 0, "creation_date": 1473873277, "post_id": 39495678, "comment_id": 66309781, "body": "Thanks, but I need to enter different values from a range. Just wanting to do it without loops. But I may end up looping."}, {"owner": {"reputation": 76, "user_id": 1636667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9mxd.png?s=128&g=1", "display_name": "Dr. Cogent", "link": "https://stackoverflow.com/users/1636667/dr-cogent"}, "edited": false, "score": 1, "creation_date": 1473875623, "post_id": 39495678, "comment_id": 66311016, "body": "Loops aren&#39;t a bad thing ;-)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1473876840, "post_id": 39495678, "comment_id": 66311629, "body": "Two possible solutions, if I understand you correctly.  <code>1</code>: Transpose the 2D array (if the array is not greater than the upper limit for Transpose, which varys depending on your version of Excel).  Or <code>2</code>: Check to see how many dimensions are in your array, and then apply the appropriate sort formula."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473877476, "post_id": 39495678, "comment_id": 66311947, "body": "What do people have against looping all of a sudden?  Does typing <code>For foo = 1 to bar</code> really take longer than writing a question on SO?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1473880243, "post_id": 39495678, "comment_id": 66313420, "body": "Try this: remove the parentheses from <code>Dim SortedArr As Variant</code>, and remove the <code>Redim</code> statement."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1473936050, "post_id": 39495678, "comment_id": 66334254, "body": "@trincot Thanks for the suggestion but I still got the <code>Type Mismatch</code> error."}], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1473878678, "post_id": 39497008, "comment_id": 66312602, "body": "Thanks for the reply. I added an update to my question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1473881478, "post_id": 39497008, "comment_id": 66314089, "body": "Your edit doesn&#39;t make sense.. where are you using <code>If Arr(i) &gt; Arr(j) Then ...</code> or <code>If Arr(i, 1) &gt; Arr(j, 1) Then ...</code> My answer is based on that"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1473935627, "post_id": 39497008, "comment_id": 66334012, "body": "I am using it in a separate module in a subroutine called <code>BubbleSort</code>. I am trying to put the contents of a listbox into an array and then pass the array to the <code>BubbleSort</code> subroutine. I added the sort routine above."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1473959414, "post_id": 39497008, "comment_id": 66349190, "body": "Change <code>lngMin = LBound(Arr)</code> to <code>lngMin = LBound(Arr) - 1</code> and similarly <code>lngMax = UBound(Arr)-1</code>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1473876615, "creation_date": 1473876615, "answer_id": 39497008, "question_id": 39495678, "link": "https://stackoverflow.com/questions/39495678/populate-one-dimensional-array-without-looping/39497008#39497008", "title": "Populate one dimensional array without looping", "body": "<blockquote>\n  <p>For each of the above lines I call a bubble sort function. But it errors on one or the other depending on whether I put If Arr(i) > Arr(j) Then ... Or If Arr(i, 1) > Arr(j, 1) Then ...</p>\n</blockquote>\n\n<p>Your values of <code>i</code>, <code>j</code> are incorrect and hence it errors out. I am guessing that you are getting <code>Subscript out of range error</code>. </p>\n\n<p>Here is a simple way to reproduce the error that you are getting.</p>\n\n<pre><code>Sub Sample()\n    Dim i As Long, j As Long, k As Integer\n    Dim MyAr As Variant\n\n    MyAr = Range(\"A1:A5\").Value\n\n    For i = LBound(MyAr) To UBound(MyAr)\n        For j = LBound(MyAr) To UBound(MyAr)\n            If MyAr(j, 1) &gt; MyAr(j + 1, 1) Then\n                k = MyAr(j, 1)\n                MyAr(j, 1) = MyAr(j + 1, 1)\n                MyAr(j + 1, 1) = k\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>The correct way is to loop till <code>UBound(MyAr) - 1</code></p>\n\n<pre><code>Sub Sample()\n    Dim i As Long, j As Long, k As Integer\n    Dim MyAr As Variant\n\n    MyAr = Range(\"A1:A5\").Value\n\n    For i = LBound(MyAr) To (UBound(MyAr) - 1)\n        For j = LBound(MyAr) To (UBound(MyAr) - 1)\n            If MyAr(j, 1) &gt; MyAr(j + 1, 1) Then\n                k = MyAr(j, 1)\n                MyAr(j, 1) = MyAr(j + 1, 1)\n                MyAr(j + 1, 1) = k\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473935669, "creation_date": 1473871279, "last_edit_date": 1531161705, "question_id": 39495678, "link": "https://stackoverflow.com/questions/39495678/populate-one-dimensional-array-without-looping", "title": "Populate one dimensional array without looping", "body": "<p>The following line of code will allocate an array as one dimensional <code>sortedArr = WorksheetFunction.Transpose(lstIssues1.List)</code>. This line of code allocates an array as two dimensional <code>arrIssues = Table.ListColumns(Table.ListColumns(strNumber).Range.column).DataBodyRange</code></p>\n\n<p>For each of the above lines I call a bubble sort function. But it errors on one or the other depending on whether I put </p>\n\n<pre><code>If Arr(i) &gt; Arr(j) Then ...\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>If Arr(i, 1) &gt; Arr(j, 1) Then ...\n</code></pre>\n\n<p>I can loop to fill <code>arrIssues</code>. But I am wondering if it's possible to fill it as a one dimensional array without looping.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is the code I am having trouble with</p>\n\n<pre><code>Private Sub cmdRemove_Click()\nDim SortedArr() As Variant\n    With lstPrevious\n        If .ListIndex = -1 Then Exit Sub\n        For i = .ListCount - 1 To 0 Step -1\n            If .Selected(i) = True Then\n                lstAdditional.AddItem .List(i)\n                .RemoveItem (i)\n            End If\n        Next i\n    End With\nReDim SortedArr(lstAdditional.ListCount - 1)\n    SortedArr = Application.Transpose(lstAdditional.List) 'ERROR Type Mismatch\n    Call BubbleSort(SortedArr)\n    Me.lstAdditional.List = SortedArr\n    txtFocus.SetFocus\nEnd Sub\n\nPublic Sub BubbleSort(Arr)\nDim strTemp As String\nDim lngMin As Long\nDim lngMax As Long\n    lngMin = LBound(Arr)\n    lngMax = UBound(Arr)\n    For i = lngMin To lngMax\n        For j = i + 1 To lngMax\n            If Arr(i) &gt; Arr(j) Then\n                strTemp = Arr(i)\n                Arr(i) = Arr(j)\n                Arr(j) = strTemp\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Strangely, I use the same logic in another userform and it works. Sorry for the lack of clarity.</p>\n"}, {"tags": ["vba", "excel", "hide", "zero"], "comments": [{"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1473872087, "post_id": 39495647, "comment_id": 66309167, "body": "Are you just looking to repeat the script above for all your sheets?  Or, do you need help with hiding rows?  Also, I noticed that you are grouping rows... if you have a &#39;hidden&#39; row within your group, it will become &#39;unhidden&#39; when you collapse / expand it.  Please clarify"}, {"owner": {"reputation": 1, "user_id": 6831892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e1e3791b76146a6b9866c38360ab6?s=128&d=identicon&r=PG&f=1", "display_name": "BotBadger112233", "link": "https://stackoverflow.com/users/6831892/botbadger112233"}, "reply_to_user": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1473970499, "post_id": 39495647, "comment_id": 66354945, "body": "Sorry about the confusion. To clarify, I don&#39;t want to actually &quot;Hide&quot; rows per say, but I want to group them and collapse them so they are hidden from view, and then yes I want to be able to repeat this script for multiple pages. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5583194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd60aa03e8a4cbea738c0c17f4dc2f?s=128&d=identicon&r=PG&f=1", "display_name": "StericHindrance", "link": "https://stackoverflow.com/users/5583194/sterichindrance"}, "is_accepted": false, "score": 0, "last_activity_date": 1473874055, "creation_date": 1473874055, "answer_id": 39496389, "question_id": 39495647, "link": "https://stackoverflow.com/questions/39495647/trying-to-hide-rows-in-excel-based-on-specific-criteria-for-multiple-sheets/39496389#39496389", "title": "Trying to hide rows in Excel based on specific criteria, for multiple sheets", "body": "<p>As CRUTER commented, grouping the rows would defeat the purpose of hiding the rows.  Any hidden rows would be shown when you open the group.</p>\n\n<p>If you just want to hide the rows on the output and forget about them, then I'd recommend just iterating through the rows and hiding each one that meets your criteria.  Something like:</p>\n\n<pre><code>For RowIndex = 1 To LastRow\n    If (Not IsCategoryRow(RowIndex)) Then\n        If (IsRowEmpty(RowIndex)) Then\n            Rows(RowIndex).EntireRow.Hidden = True\n        End If\n    End If\n Next RowIndex\n</code></pre>\n\n<p>Define <code>LastRow</code> to be the end of your output, and insert your own logic in place of <code>IsCategoryRow</code> and <code>IsRowEmpty</code>.  If your output format is consistent, you can probably define a category row as anything with a \":\" character at the end (e.g. \"Assets:\", \"Liabilities:\", etc.) and just skip to the next row.</p>\n"}], "owner": {"reputation": 1, "user_id": 6831892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e1e3791b76146a6b9866c38360ab6?s=128&d=identicon&r=PG&f=1", "display_name": "BotBadger112233", "link": "https://stackoverflow.com/users/6831892/botbadger112233"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473874055, "creation_date": 1473871143, "question_id": 39495647, "link": "https://stackoverflow.com/questions/39495647/trying-to-hide-rows-in-excel-based-on-specific-criteria-for-multiple-sheets", "title": "Trying to hide rows in Excel based on specific criteria, for multiple sheets", "body": "<p>So I'm working with this file that I put a ton of inputs in, and it varies what inputs I place within the file. After I finalize all the inputs, if a category in the output tabs is still blank or the subtitle for the category is <strong>OPEN</strong> (Meaning I never assigned a section to that subtitle, I want it to hide that row and do that for multiple output sheets.</p>\n\n<p>The current code I have is:</p>\n\n<pre><code>Sub Group_And_Hide()\n'\n' Group_And_Hide Macro\n'\n\n'\n'Define Variables\n    Dim myRange As Range\n    Dim rowCount As Integer, currentRow As Integer\n    Dim firstZeroValueRow As Integer, lastZeroValueRow As Integer\n    Dim CurrentRowValue As String\n    Dim neighborColumnValue1 As String\n    Dim NGV2 As String\n    Dim NGV3 As String\n    Dim NGV4 As String\n    Dim NGV5 As String\n    Dim CheckColumn As Integer\n\n\n'Select Balance Sheet\nSheets(\"Balance Sheet\").Select\nApplication.ScreenUpdating = False 'Turns off screen uppdating while running\n\n 'Establish the page range\n Set myRange = Range(D3, W126)\n rowCount = Cells(Rows.Count, myRange.Column).End(xlUp).Row\n\n'Reset the rows and Check\n firstZeroValueRow = 0\n lastZeroValueRow = 0\n CheckColumn = 9\n\n 'Commands\n  For currentRow = 1 To rowCount\n        CurrentRowValue = Cells(currentRow, myRange.Column).Value\n        neighborColumnValue = Cells(currentRow, myRange.Column - 1).Value\n\n      If Cells(currentRow, CheckColumn).Value Like \"**OPEN**\" Then\n          'If First Cell is Open, and first blank row hasn't been assigned\n          If firstZeroValueRow = 0 Then\n              firstZeroValueRow = currentRow\n          End If\n      ElseIf Not Cells(currentRow, CheckColumn).Value Like \"**OPEN**\" Then\n          'if the cell is not Open and the row right values are 0,\n          'and firstBlankRow hasn't been assigned, then this is the      firstBlankRow\n            'to consider for grouping\n            If (Cells(currentRow, CheckColumn + 3).Value And Cells(currentRow, CheckColumn + 4).Value And Cells(currentRow, CheckColumn + 5).Value And Cells(currentRow, CheckColumn + 6).Value = 0) Then\n\n                firstZeroValueRow = currentRow\n             ElseIf Cells(currentRow, CheckColumn + 3).Value And Cells(currentRow, CheckColumn + 4).Value And Cells(currentRow, CheckColumn + 5).Value And Cells(currentRow, CheckColumn + 6).Value &lt;&gt; 0 And firstZeroValueRow &lt;&gt; 0 Then\n                'if firstBlankRow is assigned and this row has a value with a neighbor\n               'who isn't 0, then the cell one row above this one is to be considered\n              'the lastBlankRow to include in the grouping\n              lastZeroValueRow = currentRow - 1\n          End If\n      End If\n\n      'if first AND last blank rows have been assigned, then create a group\n      'then reset the first/lastBlankRow values to 0 and begin searching for next\n    'grouping\n    If firstZeroValueRow &lt;&gt; 0 And lastZeroValueRow &lt;&gt; 0 Then\n        Range(Cells(firstZeroValueRow, myRange.Column), Cells(lastZeroValueRow, myRange.Column)).EntireRow.Select\n        Selection.Group\n        firstZeroValueRow = 0\n        lastZeroValueRow = 0\n    End If\nNext\n\n\n\n\nActiveSheet.Outline.ShowLevels RowLevels:=1 'Minimize all the groups\nApplication.ScreenUpdating = True 'Turns on screen updating when done\n\n\nEnd Sub\n</code></pre>\n\n<p>So basically I would hope to repeat that code by selecting the next sheet say \"Income Statement\"</p>\n\n<p>What I hope for the resulting code to do is take a file that looks like this:</p>\n\n<pre><code>Assets:\n Current Assets    4000    50000   60000\n Fixed Assets      100     8000    500\nLiabilities:\n C. Liab.          -       -       -\n LT Liab.          -       -       -\nEquity:\n Capital Stock     4100    58000   60500\n **OPEN**          -       -       -\n Net Income        (300)   (100)   (500)\n RE               300       100    500\n</code></pre>\n\n<p>And it would end up looking like this:</p>\n\n<pre><code>Assets:\n Current Assets    4000    50000   60000\n Fixed Assets      100     8000    500\nLiabilities:\nEquity:\n Capital Stock     4100    58000   60500\n Net Income        (300)   (100)   (500)\n RE               300       100    500\n</code></pre>\n\n<p>So I need to be hiding the zero values (the dashes) not blanks.</p>\n\n<p>Looking for any help with this code thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1206, "user_id": 2676140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/28c2b7445b21c07765a3a7d603655b6f?s=128&d=identicon&r=PG&f=1", "display_name": "user2676140", "link": "https://stackoverflow.com/users/2676140/user2676140"}, "edited": false, "score": 0, "creation_date": 1473872502, "post_id": 39495607, "comment_id": 66309377, "body": "Which version of Excel are you using?"}, {"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1473872806, "post_id": 39495607, "comment_id": 66309549, "body": "It looks like your code above is searching for the <code>LIFNR</code> header name within the <code>General Data</code> workbook? and then finding the last row and value?  If you know the names of the headers and workbook and they will never change, adding some parameters to your <code>DataGrab(param1, param2)</code> subroutine.  For example, you could write another subroutine that <code>Call DataGrab(param1, param2)</code> and uses variables in place of your hard coded header and file name."}, {"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "reply_to_user": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1474270502, "post_id": 39495607, "comment_id": 66445435, "body": "I&#39;m using Excel 2016 @CRUTER using variables instead of the hard coded header file names sounds like a good idea. I&#39;ll try to figure out a way to maybe loop through the code I have and change the variable each time it loops through. If anyone knows how to do this or has a useful link I&#39;d be grateful for a point in that direction"}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 4780084, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/972a60a89cd289255e91d85e8c13aed6?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/4780084/prakash"}, "is_accepted": true, "score": 0, "last_activity_date": 1473879317, "creation_date": 1473879317, "answer_id": 39497708, "question_id": 39495607, "link": "https://stackoverflow.com/questions/39495607/vba-getting-data-that-has-same-header-from-different-sheets/39497708#39497708", "title": "VBA - getting data that has same header from different sheets", "body": "<p>Or you could mention header names in a range on a control sheet and define them as a range . Later you can refer to each cell value to get the header name and from there look for each one in the header row .</p>\n\n<p>'mapping is a range here and a is the string variable associated to the first name in range . Ey is a range . '.column ' function will give the column number of the header word Rng will store the corresponding column alphabet like D when column number is 4</p>\n\n<p>Sr  Column Name\na   Reference\nc   Branch Code\nd   Book Balance - Local CCY\ne   End Date (Value Date)</p>\n\n<p>above is the range Mapping defined in two columns of control sheet</p>\n\n<pre><code>map = Range(\"Mapping\")\n\na = map(1, 2) ' here a will store the value reference\n\nbasedata.Activate   'Its a workbook\nsheet.activate      ' Its a worksheet in basedata workbook    \nSet Ey = basedata.ActiveSheet.Rows(\"1\").Find(What:=a, LookIn:=xlValues,LookAt:=xlWhole)\nf1 = Ey.Column\n\nCells(2, f1).Select\nRng = ActiveCell.Address\nRng = Replace(Rng, \"2\", \"\")\nRng = Replace(Rng, \"$\", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "is_accepted": false, "score": 0, "last_activity_date": 1474294813, "creation_date": 1474294813, "answer_id": 39575488, "question_id": 39495607, "link": "https://stackoverflow.com/questions/39495607/vba-getting-data-that-has-same-header-from-different-sheets/39575488#39575488", "title": "VBA - getting data that has same header from different sheets", "body": "<p>I have managed to achieve what I wanted to do by new sheets that contained the headers. Thanks for your helpful suggestions, they got me on the right track! I chose to not assign variables to Header names because it made the code easier to read. Here is my complete working code below for anyone who's interested:</p>\n\n<pre><code>    Sub DataGrab()\n    Dim sdHEADER, nHEADER As Range\n    Dim wsData, wsCoCd, wsBank, wsContact, wsBankHeader, wsCoCdHeader, wsContactHeader, wsDataHeader, wsn As Worksheet\n    Dim wsBankn, wsCoCdn, wsContactn, wsDatan As Worksheet\n    Dim wb1, wbBankn, wbCoCdn, wbContactn, wbDatan As Workbook\n    Dim fdn As FileDialog\n    Dim PickFolder, Bankn, CoCdn, Contactn, Datan, HEADER As String\n    Dim LastCol1, LastRow1, LastRown, NrHeadBank, NrHeadCoCd, NrHeadContact, NrHeadData, i As Integer\n\n'Choose initial folder for file picker\n    PickFolder = \"C:\\\"\n\n'Set up a file dialog to pick the files containing the data\n    Set fdn = Application.FileDialog(msoFileDialogFilePicker)\n\n'Activate file dialog and send to \"CancelBox\" if user presses cancel\n\n   With fdn\n    .AllowMultiSelect = False\n    .Title = \"Please select the file containing the Bank data\"\n    .Filters.Clear\n    .InitialFileName = PickFolder\n    If .Show = True Then\n    Bankn = fdn.SelectedItems(1)\n    With fdn\n        .AllowMultiSelect = False\n        .Title = \"Please select the file containing the Company Code data\"\n        .Filters.Clear\n        .InitialFileName = PickFolder\n        If .Show = True Then\n        CoCdn = fdn.SelectedItems(1)\n        With fdn\n            .AllowMultiSelect = False\n            .Title = \"Please select the file containing the Contact data\"\n            .Filters.Clear\n            .InitialFileName = PickFolder\n            If .Show = True Then\n            Contactn = fdn.SelectedItems(1)\n            With fdn\n                .AllowMultiSelect = False\n                .Title = \"Please select the file containing the Report\"\n                .Filters.Clear\n                .InitialFileName = PickFolder\n                If .Show = True Then\n                Datan = fdn.SelectedItems(1)\n                Else: GoTo CancelBox\n                End If\n            End With\n            Else: GoTo CancelBox\n            End If\n        End With\n        Else: GoTo CancelBox\n        End If\n    End With\n    Else: GoTo CancelBox\n    End If\nEnd With\n'Increase Makro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Define worksheet(1) &amp; worsheet(n)\n    Set wsData = ActiveWorkbook.Sheets(\"General Data\")\n    Set wsBank = ActiveWorkbook.Sheets(\"Bank Data\")\n    Set wsCoCd = ActiveWorkbook.Sheets(\"CoCd Data\")\n    Set wsContact = ActiveWorkbook.Sheets(\"Contact Person\")\n\n'Add Worksheets that contain the respective headers to the end of the workbook\n    With ThisWorkbook\n        Set wsBankHeader = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        wsBankHeader.name = \"Bank Headers\"\n        Set wsCoCdHeader = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        wsCoCdHeader.name = \"CoCd Headers\"\n        Set wsContactHeader = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        wsContactHeader.name = \"Contact Headers\"\n        Set wsDataHeader = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        wsDataHeader.name = \"Data Headers\"\n    End With\n\n'Fill the added worksheets with the required headers\n    With wsBankHeader\n        .Range(\"A1\") = \"LIFNR\"\n        .Range(\"B1\") = \"KTOKK\"\n        .Range(\"C1\") = \"NAME1\"\n        .Range(\"D1\") = \"BANKS\"\n        .Range(\"E1\") = \"BANKL\"\n        .Range(\"F1\") = \"BANKN\"\n        .Range(\"G1\") = \"BVTYP\"\n        .Range(\"H1\") = \"IBAN\"\n    End With\n\n    With wsCoCdHeader\n        .Range(\"A1\") = \"LIFNR\"\n        .Range(\"B1\") = \"BUKRS\"\n        .Range(\"C1\") = \"KTOKK\"\n        .Range(\"D1\") = \"NAME1\"\n        .Range(\"E1\") = \"AKONT\"\n        .Range(\"F1\") = \"ZUAWA\"\n        .Range(\"G1\") = \"FDGRV\"\n        .Range(\"H1\") = \"FRGRP\"\n        .Range(\"I1\") = \"ZTERM\"\n        .Range(\"J1\") = \"REPRF\"\n        .Range(\"K1\") = \"ZWELS\"\n    End With\n\n    With wsContactHeader\n        .Range(\"A1\") = \"LIFNR\"\n        .Range(\"B1\") = \"KTOKK\"\n        .Range(\"C1\") = \"NAME1\"\n        .Range(\"D1\") = \"NAMEV\"\n        .Range(\"E1\") = \"NAME1_01\"\n        .Range(\"F1\") = \"SMTP_ADDR\"\n        .Range(\"G1\") = \"ABTNR\"\n        .Range(\"H1\") = \"TEL_COUNTRY\"\n        .Range(\"I1\") = \"TEL_NUMBER\"\n        .Range(\"J1\") = \"FAX_COUNTRY\"\n        .Range(\"K1\") = \"FAX_NUMBER\"\n    End With\n\n   With wsDataHeader\n        .Range(\"A1\") = \"LIFNR\"\n        .Range(\"B1\") = \"KTOKK\"\n        .Range(\"C1\") = \"NAME1\"\n        .Range(\"D1\") = \"NAME2\"\n        .Range(\"E1\") = \"NAME3\"\n        .Range(\"F1\") = \"SORTL\"\n        .Range(\"G1\") = \"STRAS\"\n        .Range(\"H1\") = \"PSTLZ\"\n        .Range(\"I1\") = \"LAND1\"\n        .Range(\"J1\") = \"SPRAS\"\n        .Range(\"K1\") = \"TELF1\"\n        .Range(\"L1\") = \"J_1KFTIND\"\n    End With\n\n\n\n'Count number of columns in each Header sheet\n    NrHeadBank = wsBankHeader.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n    NrHeadCoCd = wsCoCdHeader.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n    NrHeadContact = wsContactHeader.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n    NrHeadData = wsDataHeader.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n\n\n'Define sheets in picked workbooks\n    Set wbBankn = Workbooks.Open(Bankn)\n    Set wsBankn = wbBankn.Sheets(\"Sheet1\")\n    Set wbCoCdn = Workbooks.Open(CoCdn)\n    Set wsCoCdn = wbCoCdn.Sheets(\"Sheet1\")\n    Set wbContactn = Workbooks.Open(Contactn)\n    Set wsContactn = wbContactn.Sheets(\"Sheet1\")\n    Set wbDatan = Workbooks.Open(Datan)\n    Set wsDatan = wbDatan.Sheets(\"Sheet1\")\n\n'Find last non empty column and row in sheets in wb1\n    LastRow1 = wsData.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    LastCol1 = wsData.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n    LastRow2 = wsContact.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    LastCol2 = wsContact.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n    LastRow3 = wsBank.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    LastCol3 = wsBank.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n    LastRow4 = wsCoCd.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    LastCol4 = wsCoCd.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n'Fill sheet(General Data) with data from wbdata\n    For i = 1 To NrHeadData\n'Define what header to look for in every loop\n    '\"Cells\" has no automatic allocation, so always define ws when working with multiple wb &amp; ws!\n        HEADER = wsDataHeader.Cells(1, i)\n'get position of where HEADER is in sheet(n)\n        wsDatan.Activate   'is required because of the way excel works\n        Set nHEADER = wsDatan.Range(\"A1\").EntireRow.Find(HEADER, LookAt:=xlWhole)\n'Find lastrow in wsDatan\n        LastRown = wsDatan.Cells(Rows.Count, nHEADER.Column).End(xlUp).Row\n'get position of where HEADER is in\n        wsData.Activate\n        Set sdHEADER = wsData.Range(wsData.Cells(1, 1), wsData.Cells(LastRow1, LastCol1)).Find(HEADER, LookAt:=xlWhole)\n'Fill wsData\n        wsData.Range(wsData.Cells(LastRow1 + 1, sdHEADER.Column), wsData.Cells(LastRow1 + LastRown - 1, sdHEADER.Column)) = wsDatan.Range(wsDatan.Cells(2, nHEADER.Column), wsDatan.Cells(LastRown, nHEADER.Column)).Value\n    Next i\n\n 'Fill sheet(General Data) with data from wbcontact\n    For i = 1 To NrHeadContact\n        HEADER = wsContactHeader.Cells(1, i)\n        wsContactn.Activate\n        Set nHEADER = wsContactn.Range(\"A1\").EntireRow.Find(HEADER, LookAt:=xlWhole)\n        LastRown = wsContactn.Cells(Rows.Count, nHEADER.Column).End(xlUp).Row\n        wsContact.Activate\n        Set sdHEADER = wsContact.Range(wsContact.Cells(1, 1), wsContact.Cells(LastRow2, LastCol2)).Find(HEADER, LookAt:=xlWhole)\n        wsContact.Range(wsContact.Cells(LastRow2 + 1, sdHEADER.Column), wsContact.Cells(LastRow2 + LastRown - 1, sdHEADER.Column)) = wsContactn.Range(wsContactn.Cells(2, nHEADER.Column), wsContactn.Cells(LastRown, nHEADER.Column)).Value\n    Next i\n\n'Fill sheet(Bank) with data from wbbank\n    For i = 1 To NrHeadBank\n        HEADER = wsBankHeader.Cells(1, i)\n        wsBankn.Activate\n        Set nHEADER = wsBankn.Range(\"A1\").EntireRow.Find(HEADER, LookAt:=xlWhole)\n        LastRown = wsBankn.Cells(Rows.Count, nHEADER.Column).End(xlUp).Row\n        wsBank.Activate\n        Set sdHEADER = wsBank.Range(wsBank.Cells(1, 1), wsBank.Cells(LastRow3, LastCol3)).Find(HEADER, LookAt:=xlWhole)\n        wsBank.Range(wsBank.Cells(LastRow3 + 1, sdHEADER.Column), wsBank.Cells(LastRow3 + LastRown - 1, sdHEADER.Column)) = wsBankn.Range(wsBankn.Cells(2, nHEADER.Column), wsBankn.Cells(LastRown, nHEADER.Column)).Value\n    Next i\n\n'Fill sheet(CoCd) with data from wbCoCd\n    For i = 1 To NrHeadCoCd\n        HEADER = wsCoCdHeader.Cells(1, i)\n        wsCoCdn.Activate\n        Set nHEADER = wsCoCdn.Range(\"A1\").EntireRow.Find(HEADER, LookAt:=xlWhole)\n        LastRown = wsCoCdn.Cells(Rows.Count, nHEADER.Column).End(xlUp).Row\n        wsCoCd.Activate\n        Set sdHEADER = wsCoCd.Range(wsCoCd.Cells(1, 1), wsCoCd.Cells(LastRow4, LastCol4)).Find(HEADER, LookAt:=xlWhole)\n        wsCoCd.Range(wsCoCd.Cells(LastRow4 + 1, sdHEADER.Column), wsCoCd.Cells(LastRow4 + LastRown - 1, sdHEADER.Column)) = wsBankn.Range(wsBankn.Cells(2, nHEADER.Column), wsBankn.Cells(LastRown, nHEADER.Column)).Value\n    Next i\n\n'Delete the Header Sheets that were added, close opened workbooks and reset sheet settings\n    Application.DisplayAlerts = False\n    wsBankHeader.Delete\n    wsCoCdHeader.Delete\n    wsContactHeader.Delete\n    wsDataHeader.Delete\n    Application.DisplayAlerts = True\n    wbBankn.Close\n    wbCoCdn.Close\n    wbContactn.Close\n    wbDatan.Close\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Exit Sub\n\nCancelBox:\n    MsgBox \"You didn't select all the files required for this makro. Please restart this makro and try again\"\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 39497708, "answer_count": 2, "score": 0, "last_activity_date": 1474294813, "creation_date": 1473871035, "last_edit_date": 1474280032, "question_id": 39495607, "link": "https://stackoverflow.com/questions/39495607/vba-getting-data-that-has-same-header-from-different-sheets", "title": "VBA - getting data that has same header from different sheets", "body": "<p>This is my first question on Stackoverflow, although I've been using the forum for a while, trying to teach myself VBA. So here goes my very first very long post:</p>\n\n<p>I have a workbook(1) containing a worksheet(general data) and  need to fill it with Data from other workbooks(n) that contain sheets(sheet1). I would like to use VBA for this because doing it manually is very time consuming and prone to mistakes. \nThe way the data that needs to be copied is identified, is via  headers (i.e. LIFNR). On sheet(general data) the position and order of these headers can vary and in workbooks(n).sheet1 the order in which the headers are can vary (although they are always in row 1).</p>\n\n<p>I have managed to write a working code, but it seems like a bit of a Rube Goldberg machine... and tedious because I'll have about 30 headers and 5 workbooks(n) to apply this to. Is there a better and faster way to achieve what I'm doing? Here's the code:</p>\n\n<pre><code> 'Define the individual header names\nSub DataGrab()\nDim sdLIFNR, nLIFNR As Range\nDim ws1, wsn As Worksheet\nDim wb1, wbn As Workbook\nDim fdn As FileDialog\nDim data As String\nDim LastCol1, LatRow1, LastColn, LastRown As Integer\n\n'Define worksheet(1) &amp; worsheet(n)\nSet ws1 = ActiveWorkbook.Sheets(\"General Data\")\n\n'Pick a file via file dialog\nSet fdn = Application.FileDialog(msoFileDialogFilePicker)\nWith fdn\n.AllowMultiSelect = False\n.Title = \"Please select the file containing the Bank data\"\n.Filters.Clear\nIf .Show = True Then\ndata = fdn.SelectedItems(1)\nElse: GoTo CancelBox\nEnd If\nEnd With\n\nSet wbn = Workbooks.Open(data)\nSet wsn = wbn.Sheets(\"Sheet1\")\n\n\n'Find last non empty column and row in sheet(general data)\n\nLastRow1 = ws1.Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\nLastCol1 = ws1.Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Column\n 'get position of where LIFNR is in sheet(n)\n wsn.Activate\n Set nLIFNR = wsn.Range(\"A1\").EntireRow.Find(\"LIFNR\", LookAt:=xlWhole)\n\n'get position of where LIFNR is in sheet(general data)\nws1.Activate\nSet sdLIFNR = ws1.Range(Cells(1, 1), Cells(LastRow1, LastCol1)).Find(\"LIFNR\", LookAt:=xlWhole)\n\n'Find lastrow in sheet(n)\nwsn.Activate\nLastRown = wsn.Cells(Rows.Count, nLIFNR.Column).End(xlUp).Row\n\nws1.Range(ws1.Cells(LastRow1 + 1, sdLIFNR.Column), ws1.Cells(LastRow1 + LastRown - 1, sdLIFNR.Column)) = wsn.Range(wsn.Cells(2, nLIFNR.Column), wsn.Cells(LastRown, nLIFNR.Column)).Value\nExit Sub\n\nCancelBox:\nMsgBox \"You didn't select all the files required for this makro. Please restart this makro and try again\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "dynamic", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "is_accepted": false, "score": 0, "last_activity_date": 1473871698, "creation_date": 1473871698, "answer_id": 39495785, "question_id": 39495572, "link": "https://stackoverflow.com/questions/39495572/creating-pivot-tables-in-a-loop-each-on-their-own-new-worksheet-with-a-dynamic/39495785#39495785", "title": "Creating pivot tables in a loop, each on their own new worksheet with a dynamic name VBA", "body": "<p>Could it be that the pivot cache is too large to be done dynamically? I have tried this code and get an error when I try to set the pivot cache</p>\n\n<pre><code>Dim FinalRow            As Long\nDim DataSheet           As String\nDim PvtCache            As PivotCache\nDim PvtTbl              As PivotTable\nDim DataRng             As Range\nDim TableDest           As Range\n\nDim LastCol As Integer\n    With ActiveSheet\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\nDataSheet = ActiveSheet.Name\n\n' set data range for Pivot Table\nSet DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, LastCol))\n' set pivot cache\nSet PvtCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, DataRng)\n</code></pre>\n\n<p>Then there is an error (Type Mismatch) on the last line (set pvtcache...), but the code continues as such</p>\n\n<pre><code>PayorName = Sheets(\"Master1\").Cells(i, \"U\").Value\n\nSheets.Add\nActiveSheet.Name = PayorName &amp; \" Pivot\"\n\n' set range for Pivot table placement\nSet TableDest = Sheets(PayorName &amp; \" Pivot\").Cells(3, 1)\n\n\n\n' this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables(\"PivotTable\") ' check if \"PivotTable4\" Pivot Table already created (in past runs of this Macro)\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then ' \"PivotTable\" doesn't exist &gt;&gt; create it\n\n    ' create a new Pivot Table in \"PivotTable\" sheet\n    Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables.Add(PivotCache:=PvtCache, TableDestination:=TableDest, TableName:=\"PivotTable\")\n\n    ' setting fields\n    ActiveSheet.PivotTables(\"PivotTable\").AddDataField ActiveSheet.PivotTables( _\n            \"PivotTable1\").PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n        With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Sum of Amount\")\n            .NumberFormat = \"$#,##0.00_);($#,##0.00)\"\n        End With\n        With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"GL Debit Account\")\n            .Orientation = xlColumnField\n            .Position = 1\n        End With\n        With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Payment Payor\")\n            .Orientation = xlRowField\n            .Position = 1\n        For x = 1 To .PivotItems.Count - 1\n            .PivotItems(.PivotItems(x).Name).Visible = False\n        Next x\n        .PivotItems(PayorName).Visible = True\n        End With\n        With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Post Date\")\n            .Orientation = xlRowField\n            .Position = 2\n        End With\n        With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Batch #\")\n            .Orientation = xlRowField\n            .Position = 3\n        End With\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6753252, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58525a38155c06af753cd2a47532bb76?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt VonOhlen", "link": "https://stackoverflow.com/users/6753252/kurt-vonohlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 530, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473871698, "creation_date": 1473870880, "question_id": 39495572, "link": "https://stackoverflow.com/questions/39495572/creating-pivot-tables-in-a-loop-each-on-their-own-new-worksheet-with-a-dynamic", "title": "Creating pivot tables in a loop, each on their own new worksheet with a dynamic name VBA", "body": "<p>Here is what I want the code to do</p>\n\n<blockquote>\n  <p>for each row in column U create a new tab with a new pivot table based on a master worksheet's data</p>\n</blockquote>\n\n<p>The issue is the dynamic table destination I believe. I am creating a variable, PayorName, which is based on a list in the \"Master\" worksheet. then I want the sheets the pivot tables are on to have the name \"[company] Pivot\"</p>\n\n<p>am I trying to do too much at once?</p>\n\n<p>Partial code:</p>\n\n<pre><code>Dim LastRowA As Long\nWith ActiveSheet\n    LastRowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\nDim LastRowU As Long\nWith ActiveSheet\n    LastRowU = .Cells(.Rows.Count, \"U\").End(xlUp).Row\nEnd With\n\n\nActiveSheet.Name = \"Master\"\n\n'this loop is set to run the first 5 items temporarily\n'later it will go to lastrowU\nFor i = 2 To 5\n\nPayorName = Sheets(\"Master\").Cells(i, \"U\").Value\n\nSheets.Add\nActiveSheet.Name = PayorName &amp; \" Pivot\"\nWith ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Master1!R1C1:R\" &amp; LastRowA)\n        .CreatePivotTable TableDestination:=Sheets(PayorName &amp; \" Pivot\").Range(\"A3\"), TableName:=\"PivotTable\"\nEnd With\n    Sheets(PayorName &amp; \" Pivot\").Select\n    Cells(3, 1).Select\n    ' from here I set the pivot's fields\nnext i\n</code></pre>\n"}, {"tags": ["arrays", "vba", "custom-data-type"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473872620, "post_id": 39495237, "comment_id": 66309442, "body": "If you know the number of elements, it&#39;s better to use arrays and resize them only once. For example <code>Dim circles(1 To 5) As aType</code>"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473873560, "post_id": 39495237, "comment_id": 66309942, "body": "Thanks Slai. Actually, the number of elements is not always identical. Perhaps I should not have simplified it to all having 5. In fact, I am unsure about how to handle dissimilar dimensions without leaving a trail of empty elements in the returned array.  If circles(10), triangles(4), squares(56), I was thinking about doing it for 56 times (maximum ubound) and leaving lots of empty .shp1 and .shp2. Otherwise I was thinking about doing separate loops for each."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473874322, "post_id": 39495237, "comment_id": 66310359, "body": "<a href=\"http://stackoverflow.com/documentation/vba/3667/scripting-dictionary-object\"><code>Scripting.Dictionary</code></a> should be a bit easier than <a href=\"http://stackoverflow.com/documentation/vba/5838/collections\"><code>Collection</code></a>"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1474045257, "post_id": 39495237, "comment_id": 66387434, "body": "@Slai, will need to read up on Dictionary again as well, been very shy about using either to date"}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473872568, "post_id": 39495596, "comment_id": 66309410, "body": "Thanks you Codeguy. Now corrected as suggested.  Actually, shp1, shp2 and shp3 originally had different dimensions and I made them all 5 just for simplicity. If they are different, presumably I would have to do Shps(i).shp1, Shps(i).shp2 and so on in separate loops or risk filling the shorter ones with &quot;0&quot;s, right? Or is it a case of finding the max UBound and loop for that number of times?  Thanks also for the zero base reminder and yes, I have been seeing the &quot;0&quot;s in the first element!!"}, {"owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473919986, "post_id": 39495596, "comment_id": 66325395, "body": "No problem, happy to help.  Now the solution provided, an element of type <code>bType</code> always consists of three elements of  <code>aType</code>. What do you want the <code>bType</code> element to consist of? Do you want it to consist of three <i>arrays</i> of elements of type <code>aType</code>?"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473925883, "post_id": 39495596, "comment_id": 66328091, "body": "bType and aType both have fixed number of elements, but not the same. What I was wondering is Shp1(i) and Shp2(i) and Shp3(i) which may not have the same lengths. So shp(i) may be say (Shp1(5), Shp2(9), Shp3(2)), and I am using three loops to fill shp(i).Shp1(), shp(i).Shp2() and shp(i).Shp3(), which seems inefficient. Alternatively, I have set one loop with 9 counts (highest uBound) but end up with empty contents in Shp1 and Shp3 which is a bit ugly. Is there a better way to handle this perhaps? Thanks again."}, {"owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473930086, "post_id": 39495596, "comment_id": 66330398, "body": "I don&#39;t really understand your goal with the type <code>bType</code>. Generally, there are two options: you can either use only one element of type <code>bType</code> that can host <i>n</i> circles, <i>n</i> triangles and <i>n</i> squares, the <i>n</i> &#39;s not needing to be the same number for each shape. The other option is to do it using the code that you already have by now and just ReDim the <code>shps</code> to the biggest <code>UBound</code> of <code>circles</code>, <code>squares</code> or <code>triangles</code>, however, you&#39;ll possibly end up with a lot of elements of type <code>aType</code> having all their values set to 0. (e.g. 10 circles and 2 squares -&gt; 8 squares with 0-values)."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473952299, "post_id": 39495596, "comment_id": 66344994, "body": "Sorry, I got myself into a muddle. Presumably, with shps as bType, I only have Dim shps(3) As bType, since it contains Circles(i), Triangles(i), Squares(i); is this the right way of looking at it?  As for Circles(), Triangles() and Squares(), they can vary.  Say if I were to pick 10 items from a bag containing these three shapes in two colours, say green and red, I have two boxes, for red and for green. Within each of these boxes, I have three jars, one for each shape.   Trying to make the box bType, the jars aType, and within the jars, I am interested in the shapes&#39; sizes and mass."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473954234, "post_id": 39495596, "comment_id": 66346282, "body": "I am trying to get around returning multiple array variables of different sizes from one function by packing them inside another array variable."}, {"owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1474027811, "post_id": 39495596, "comment_id": 66376615, "body": "@user110084 does the updated answer suit your needs?"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1474042914, "post_id": 39495596, "comment_id": 66386316, "body": "Very much so @codeguy Thank you. I did end up trying both this way, separate loops as well as leaving blank elements and I much prefer the separate loops. Thanks so much. I also tried keeping each of the TYPE elements as individual arrays just to explore, and noticed that using custom TYPE seemed to run much slower for the same number of loops. Is that normally the case with custom TYPE?"}], "tags": [], "owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "is_accepted": true, "score": 0, "last_activity_date": 1474028122, "last_edit_date": 1474028122, "creation_date": 1473870995, "answer_id": 39495596, "question_id": 39495237, "link": "https://stackoverflow.com/questions/39495237/vba-using-custom-data-types-and-functions-to-return-array-array-array/39495596#39495596", "title": "VBA: Using custom data types and functions to return array ( array (), array() )", "body": "<p>So the thing throwing your exception is that you used arrays of type <code>aType</code> for <code>Shp1</code> and so on. Later on, you implemented it as it was just a type of <code>aType</code>, not an array of <code>aType</code>.</p>\n\n<p>Now, based on your answer I came up with this code. You will end up with 5 elements of <code>bType</code> each containing 5 elements of <code>aType</code>. However, you can change this as you desire, point is, you now have an array of type <code>bType</code> containing arrays of type <code>aType</code> to host circles, triangles and squares.</p>\n\n<pre><code>Option Explicit\n\nPublic Type aType\n    P_Col As Integer\n    P_Rad As Single\n    P_X As Single\n    P_Y As Single\nEnd Type\n\nPublic Type bType\n    circles()     As aType\n    triangles()   As aType\n    squares()     As aType\nEnd Type\n\nFunction MakePatterns() As bType()\nDim i, j        As Integer\nDim shps()      As bType\n\n\nReDim shps(4)\nFor i = LBound(shps) To UBound(shps)\n\n      For j = 0 To 4\n         ReDim Preserve shps(i).circles(j)\n         With shps(i).circles(j)\n            .P_Col = Int(j / 2)\n            .P_Rad = j\n            .P_X = j * 10 + 1\n            .P_Y = j * 10 + 5\n         End With\n      Next j\n\n      For j = 0 To 4\n         ReDim Preserve shps(i).triangles(j)\n         With shps(i).triangles(j)\n            .P_Col = Int(j / 2)\n            .P_Rad = j\n            .P_X = j * 10 + 1\n            .P_Y = j * 10 + 5\n         End With\n      Next j\n\n      For j = 0 To 4\n         ReDim Preserve shps(i).squares(j)\n         With shps(i).squares(j)\n            .P_Col = Int(j / 2)\n            .P_Rad = j\n            .P_X = j * 10 + 1\n            .P_Y = j * 10 + 5\n         End With\n      Next j\n\nNext i\n\nMakePatterns = shps\n\nEnd Function\n</code></pre>\n\n<p>Two more hints:</p>\n\n<ul>\n<li>If you already know you want to have 5 items, declare the array with 5 items instead of resizing it constantly.</li>\n<li>The array's indexes start at zero, so you might want to change your loops to <code>For i=0 To 4</code>. Otherwise you end up having a first object of type <code>bType</code> containing only items of <code>aType</code> that have the value 0 in each property.</li>\n</ul>\n"}], "owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 39495596, "answer_count": 1, "score": 0, "last_activity_date": 1474028122, "creation_date": 1473869777, "question_id": 39495237, "link": "https://stackoverflow.com/questions/39495237/vba-using-custom-data-types-and-functions-to-return-array-array-array", "title": "VBA: Using custom data types and functions to return array ( array (), array() )", "body": "<p>This is extension of an earlier question which was answered and solved. Trying to make an array of arrays and encountered the same error \"only user defined types in public object modules can be coerced ....\"</p>\n\n<p>I am looking into using Collection but not yet figured that out.</p>\n\n<pre><code>Option Explicit\n\nPublic Type aType\n    P_Col As Integer\n    P_Rad As Single\n    P_X As Single\n    P_Y As Single\nEnd Type\n\nPublic Type bType\n    Shp1() As aType\n    Shp2() As aType\n    Shp3() As aType\nEnd Type\n\n\n\nFunction MakePatterns() As bType()\nDim i       As Integer\nDim circles()   As aType\nDim triangles() As aType\nDim squares()   As aType\nDim shps()      As bType\n\n\nFor i = 1 To 5\n    ReDim Preserve circles(i)\n    circles(i).P_Col = Int(i / 2)\n    circles(i).P_Rad = i\n    circles(i).P_X = i * 10 + 1\n    circles(i).P_Y = i * 10 + 5\nNext\n\nFor i = 1 To 5\n    ReDim Preserve triangles(i)\n    triangles(i).P_Col = Int(i / 2)\n    triangles(i).P_Rad = i\n    triangles(i).P_X = i * 10 + 1\n    triangles(i).P_Y = i * 10 + 5\nNext\n\nFor i = 1 To 5\n    ReDim Preserve squares(i)\n    squares(i).P_Col = Int(i / 2)\n    squares(i).P_Rad = i\n    squares(i).P_X = i * 10 + 1\n    squares(i).P_Y = i * 10 + 5\nNext\n\nFor i = 1 To 5\n    ReDim Preserve shps(i)\n    shps(i) = Array(circles(i), triangles(i), squares(i))\nNext\n\n'For i = 1 To 5\n'    Debug.Print circles(i).P_Col; circles(i).P_Rad; _\n'     circles(i).P_X; circles(i).P_Y\n'Next\n\nMakePatterns = shps\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 5809138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1c7e532ea20350f77458a827f0550?s=128&d=identicon&r=PG&f=1", "display_name": "grab74", "link": "https://stackoverflow.com/users/5809138/grab74"}, "is_accepted": false, "score": 0, "last_activity_date": 1474014406, "creation_date": 1474014406, "answer_id": 39526888, "question_id": 39495206, "link": "https://stackoverflow.com/questions/39495206/using-the-cell-value-in-name-manager-formula-as-reference/39526888#39526888", "title": "Using the cell value in Name Manager formula as reference", "body": "<p>Please, can you try to define a name using the following formula?</p>\n\n<pre><code>=OFFSET('A2'!$C$1,'A2'!$E$6-1,0,'A2'!$F$6-'A2'!$E$6+1,1)\n</code></pre>\n\n<p>This will define a range which is one column wide (<code>C</code> column), starts at row number found in cell <code>E6</code> and end at row number found in cell <code>F6</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "is_accepted": false, "score": 0, "last_activity_date": 1474022741, "creation_date": 1474022741, "answer_id": 39529575, "question_id": 39495206, "link": "https://stackoverflow.com/questions/39495206/using-the-cell-value-in-name-manager-formula-as-reference/39529575#39529575", "title": "Using the cell value in Name Manager formula as reference", "body": "<p>You can try this:</p>\n\n<pre><code>=INDIRECT(\"A2!$C$\"&amp;E6&amp;\":$C$\"&amp;F6)\n</code></pre>\n\n<p>Please take note that you can, and maybe should, add sheet reference to cells E6 and F6.</p>\n"}], "owner": {"reputation": 1, "user_id": 2903645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e7446a074c58ed67ef2dc076381acf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903645", "link": "https://stackoverflow.com/users/2903645/user2903645"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474022741, "creation_date": 1473869653, "last_edit_date": 1531161705, "question_id": 39495206, "link": "https://stackoverflow.com/questions/39495206/using-the-cell-value-in-name-manager-formula-as-reference", "title": "Using the cell value in Name Manager formula as reference", "body": "<p>I want to create a formula in Name Manager using the reference of other sheet.\nI have two sheet A1 and A2; in sheet A2 i have sample data.\nUsing this sample data i want to create a list which will be used in sheet A1 depending on other Drop-down value.\nI want to create a name for formula:</p>\n\n<pre><code>=A2!$C$10:$C$12\n</code></pre>\n\n<p>But in this formula i want to change column number 10 and 12 with another cell (in same sheet A2) values.\nLike: <code>=CELL(\"contents\",E6)</code>.</p>\n\n<p>I have tried:\n <code>=A2!$C$CELL(\"contents\",E6):$C$CELL(\"contents\",F6)</code>\nBut its not working.</p>\n\n<p>How can i change the column numbers with other cell values?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1473870071, "post_id": 39495005, "comment_id": 66308018, "body": "Why use <code>sTest = ActiveCell.Value</code>, for it just to be overwritten on the next line? Also, I think all you need to do is make this the last line: <code>Set oWBSource = Workbooks(sTest)</code>, unless I&#39;m missing something.  I <b><i>highly</i></b> suggest reading/studying <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid <code>.Select</code>/<code>.Activate</code></a>"}, {"owner": {"reputation": 75, "user_id": 1991260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd4c534d91f362ab2ee3aa19363d2da?s=128&d=identicon&r=PG", "display_name": "cboshdave", "link": "https://stackoverflow.com/users/1991260/cboshdave"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473870336, "post_id": 39495005, "comment_id": 66308165, "body": "Agreed... as I commented, that was simply for testing purposes.  I was trying to make it easy for someone to &quot;test&quot; the code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473870691, "post_id": 39495005, "comment_id": 66308392, "body": "I don&#39;t quite understand - with <code>oWBSource</code> being set at the end, can&#39;t you just run your code inside a <code>With oWBSource</code> block?"}, {"owner": {"reputation": 75, "user_id": 1991260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd4c534d91f362ab2ee3aa19363d2da?s=128&d=identicon&r=PG", "display_name": "cboshdave", "link": "https://stackoverflow.com/users/1991260/cboshdave"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473870868, "post_id": 39495005, "comment_id": 66308503, "body": "No.  The <code>With oWBSource</code> block references the spreadsheet where the code lives rather than the clicked on spreadsheet.  UNLESS I maximize and minimize the selected sheet first.  Then it works correctly.  I am trying to find a way to make the selection more elegant."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473871654, "post_id": 39495005, "comment_id": 66308933, "body": "So the code you posted isn&#39;t the code that you&#39;re running? It&#39;s code for the user to select the worksheet, and then run some other code on that worksheet?  After the user selects a range, <code>oWBSource</code> changes to reference that sheet - this sheet may or may not have code.  If you create a new workbook, and then select cell <code>A1</code> on that new workbook, there&#39;s <i>no code</i> there, which is why I&#39;m confused when you say the block references the sheet where the code lives."}, {"owner": {"reputation": 75, "user_id": 1991260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd4c534d91f362ab2ee3aa19363d2da?s=128&d=identicon&r=PG", "display_name": "cboshdave", "link": "https://stackoverflow.com/users/1991260/cboshdave"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473872734, "post_id": 39495005, "comment_id": 66309502, "body": "Yes.  It&#39;s the code I am running.  The code lives on sheet1.xlsm. When executed, I want the user to select sheet2.xlsx (already open). Then <code>oWBSource</code> &quot;attaches&quot; to sheet2.xlsx and operates on that sheet.  The selected range is irrelevant.  I was simply trying to use that to find what worksheet to operate on. The code will do the rest."}, {"owner": {"reputation": 75, "user_id": 1991260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd4c534d91f362ab2ee3aa19363d2da?s=128&d=identicon&r=PG", "display_name": "cboshdave", "link": "https://stackoverflow.com/users/1991260/cboshdave"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1473873032, "post_id": 39495005, "comment_id": 66309660, "body": "Clearly, the easy answer is to have the user close/save the worksheet to be acted upon and then simply execute the <code>Set oWBSource = Workbooks.Open(strFileToOpen)</code>.  I was just hoping there was a more elegant solution that i was missing.  Possibly no straightforward solution?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1473876108, "creation_date": 1473876108, "answer_id": 39496887, "question_id": 39495005, "link": "https://stackoverflow.com/questions/39495005/excel-vba-allow-user-to-select-an-already-open-workbook-and-attach-variables-to/39496887#39496887", "title": "Excel VBA Allow user to select an already open workbook and attach variables to selected workbook", "body": "<p>If I understand correctly what you're trying to do, just use the <code>rng</code> to resolve the selected Workbook:</p>\n\n<pre><code>Set oWBSource = rng.Parent.Parent\n</code></pre>\n\n<p><code>rng.Parent</code> is the Worksheet a Range is a part of, and the <code>.Parent</code> of a Worksheet is its Workbook.</p>\n"}], "owner": {"reputation": 75, "user_id": 1991260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd4c534d91f362ab2ee3aa19363d2da?s=128&d=identicon&r=PG", "display_name": "cboshdave", "link": "https://stackoverflow.com/users/1991260/cboshdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1576, "favorite_count": 0, "accepted_answer_id": 39496887, "answer_count": 1, "score": 1, "last_activity_date": 1473876108, "creation_date": 1473868998, "last_edit_date": 1473875926, "question_id": 39495005, "link": "https://stackoverflow.com/questions/39495005/excel-vba-allow-user-to-select-an-already-open-workbook-and-attach-variables-to", "title": "Excel VBA Allow user to select an already open workbook and attach variables to selected workbook", "body": "<p>With Excel 2013 VBA, I am familiar with setting the value of a Workbook variable with:</p>\n\n<pre><code>    Set oWBSource = Workbooks.Open(strFileToOpen) 'Works well.\n</code></pre>\n\n<p>In my situation though, sometimes the Workbook is already open on the desktop.  I am trying to find a more elegant way to \"select\" that spreadsheet and then attach my variable to that workbook to operate on.  The code is running on a separate \"master\" spreadsheet.  </p>\n\n<p>Currently, I am asking the user if the file is already open.  If so, then: </p>\n\n<pre><code>    Dim rng As Range\n    Set rng = Application.InputBox(\"Select any cell on workbook to operate on.\", \"Click Workbook Cell\", Type:=8) 'Stops code and allows user to select a cell on an open spreadsheet\n    Dim sTest As String 'variable used to test. \n    sTest = ActiveCell.Value 'Testing to see what value code is seeing. \n    sTest = ActiveWorkbook.Name 'Testing to see what value code is seeing\n    Set oWBSource = Workbooks(ActiveWorkbook.Name) 'Works if selected Workbook is maximized and minimized. \n</code></pre>\n\n<p>If I run the above code and when it runs the inputbox, if I click one cell on the spreadsheet I want the code to operate on and allow the code to continue, the variables still reference the Workbook where the code resides rather than the \"selected\" workbook.  If, while selecting one cell, I also maximize and minimize the spreadsheet (basically Activate it) and then click a cell and allow the code to continue, the active spreadsheet is set and it seems to work. I realize the cell reference is doing nothing.  But the pause allows me to \"Activate\" the desired spreadsheet.  </p>\n\n<p>I am looking for a more elegant way to handle attaching my code to an already open spreadsheet. My current solution is clunky. Isn't there a way to have the user select the open spreadsheet and then have my code \"act\" on that spreadsheet?</p>\n\n<p>I know this is a weird question.  Be kind rating it please??!!</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473875387, "post_id": 39494819, "comment_id": 66310908, "body": "The Design view by definition shows all controls. Otherwise how would you change their properties? If your users go into Design view, something is wrong. Maybe give them an .accde?"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473878345, "post_id": 39494819, "comment_id": 66312415, "body": "Actually I need a code (or several codes) by VBA (Access 2010) for visible or invisible some of fildes for two position: &quot;Layout View&quot; and &quot;Design View&quot; ,, OR a trike: a code for &quot;Send to Back&quot; and &quot;Bring to Front&quot; a field or object by VBA depended to situations: &quot;Send to Back&quot; for &quot;Layout View&quot; and &quot;Bring to Front&quot; for &quot;Design View&quot;"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473871670, "creation_date": 1473868351, "last_edit_date": 1473871670, "question_id": 39494819, "link": "https://stackoverflow.com/questions/39494819/show-a-field-in-layout-view-and-prevention-on-showing-in-design-view", "title": "Show a field in &quot;Layout View&quot; and prevention on showing in &quot;Design View&quot;", "body": "<p>How can I show a field in \"Layout View\" (Form and Report) and prevention on showing in \"Design View\" into VBA Access 2010 ?</p>\n\n<p>Any idea is thankful :)</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1473867409, "post_id": 39494448, "comment_id": 66306408, "body": "I want to be able to pull the delimiter along with the word before it once splitting. Is there a way to get back?"}, {"owner": {"reputation": 1851, "user_id": 3045568, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e2fdfebcbb631532bb9ff994639b5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Techidiot", "link": "https://stackoverflow.com/users/3045568/techidiot"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1473867614, "post_id": 39494448, "comment_id": 66306546, "body": "Didn&#39;t get that. Can you explain?"}, {"owner": {"reputation": 5898, "user_id": 3933927, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Td4UR.png?s=128&g=1", "display_name": "Stavm", "link": "https://stackoverflow.com/users/3933927/stavm"}, "edited": false, "score": 0, "creation_date": 1473867677, "post_id": 39494448, "comment_id": 66306590, "body": "if you want to pull the delimiter, just repeat the &quot;split&quot; after each replacement"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1473867780, "post_id": 39494448, "comment_id": 66306658, "body": "I mean like if I split a cell on &quot;hi&quot; , &quot;bye&quot; , and &quot;thanks&quot; I want to be able to pull the words previous to each them while also having the correct delimiter next to the word. So if &quot;hi&quot; was after Father and &quot;bye&quot; after mother I want to be able to pull out Father &quot;hi&quot; and mother &quot;bye&quot;"}, {"owner": {"reputation": 1851, "user_id": 3045568, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e2fdfebcbb631532bb9ff994639b5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Techidiot", "link": "https://stackoverflow.com/users/3045568/techidiot"}, "edited": false, "score": 1, "creation_date": 1473867877, "post_id": 39494448, "comment_id": 66306720, "body": "That would just require a logic building. Use a similar way to do that. BTW, still unsure of your requirement."}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1473867933, "post_id": 39494448, "comment_id": 66306752, "body": "I&#39;ll post a link to a new question. Thanks for your help."}], "tags": [], "owner": {"reputation": 1851, "user_id": 3045568, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e2fdfebcbb631532bb9ff994639b5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Techidiot", "link": "https://stackoverflow.com/users/3045568/techidiot"}, "is_accepted": true, "score": 6, "last_activity_date": 1473867241, "creation_date": 1473867241, "answer_id": 39494448, "question_id": 39494357, "link": "https://stackoverflow.com/questions/39494357/multiple-delimiters-words-in-vba/39494448#39494448", "title": "multiple delimiters (words) in vba", "body": "<p>You can replace the multiple words first using replace and then use that in split.</p>\n\n<p>e.g.</p>\n\n<pre><code>mystring= Replace(mystring, \"hello\", \"#\")\nmystring= Replace(mystring, \"hi\", \"#\")\nmystring= Replace(mystring, \"thanks\", \"#\")\nnewstring= Split(mystring, \"#\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1473868006, "creation_date": 1473868006, "answer_id": 39494709, "question_id": 39494357, "link": "https://stackoverflow.com/questions/39494357/multiple-delimiters-words-in-vba/39494709#39494709", "title": "multiple delimiters (words) in vba", "body": "<p>you could go like follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim t As String\n    Dim arr As Variant, seps As Variant, sep As Variant\n\n    seps = Array(\"hello\", \"hi\") '&lt;--| define your seperators list\n\n    t = \"hello i would hello like to hi split this string hello with multiple hello separators hi\" '&lt;--| string to split\n\n    t = \" \" &amp; t &amp; \" \" '&lt;--| add trailing blank to catch possible \"border\" 'separators'\n    For Each sep In seps\n        t = Replace(t, \" \" &amp; sep &amp; \" \", \"|\") 'turn all separators into one only\n    Next sep\n    t = Trim(t) '&lt;--| remove trailing blanks\n    If Left(t, 1) = \"|\" Then t = Right(t, Len(t) - 1) '&lt;--| remove any initial 'separator'\n    If Right(t, 1) = \"|\" Then t = Left(t, Len(t) - 1) '&lt;--| remove any final 'separator'\n    arr = Split(t, \"|\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 39494448, "answer_count": 2, "score": 0, "last_activity_date": 1473868006, "creation_date": 1473867023, "last_edit_date": 1531164843, "question_id": 39494357, "link": "https://stackoverflow.com/questions/39494357/multiple-delimiters-words-in-vba", "title": "multiple delimiters (words) in vba", "body": "<p>How can multiple delimiters be used for the split() function? I want to use more than two words as the delimiters but I'm unsure how that is possible.</p>\n\n<pre><code>c = Trim(t.value)\narr = Split(c, \"hello\" , \"hi\")\n</code></pre>\n"}, {"tags": ["excel", "macros", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5398234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704f3ba7a92607a9d78e7bfc973bb67d?s=128&d=identicon&r=PG&f=1", "display_name": "iron", "link": "https://stackoverflow.com/users/5398234/iron"}, "is_accepted": false, "score": 0, "last_activity_date": 1473875397, "creation_date": 1473875397, "answer_id": 39496724, "question_id": 39494344, "link": "https://stackoverflow.com/questions/39494344/excel-addin-file-xll-will-not-open-properly-in-excel-2007-but-works-fine-in-2/39496724#39496724", "title": "Excel Addin (File.xll) will not open properly in excel 2007, but works fine in 2003", "body": "<p>i figured the answer to my own question...so i thought i'd share.</p>\n\n<p>On the new windows 7 box, there must be an environment variable 'PATH' to the folder directory where the addin and its associated libraries live.</p>\n\n<p>My addin files are located in   C:\\AddinFolder\\</p>\n\n<p>So here are the steps to fix<br>\n1) right click on MyComputer and select \"properties\"<br>\n2) select the \"System protection\" item from top left list<br>\n3) click on the advanced tab<br>\n4) click in the button \"Environment Variables\"<br>\n5) in the lower section (system variables) scroll down till you find the \"Path\" variable and then select \"Edit\"<br>\n6) Add to the end of the string the path to your addin library. The list is a set of directory paths, separated by semicolons.  So, i added \";C:\\MyAddin\\\" to the end of the string, which already had a bunch of paths listed for a variety of other programs<br>\n7) click Ok a couple times to get out of that set of dialogue boxes<br>\n8) open Excel with the addin set to load, and voilla...it works perfectly  </p>\n\n<p>**note...don't delete the contents of the Path variable..just add to it...else some other software might stop functioning properly</p>\n"}], "owner": {"reputation": 31, "user_id": 5398234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704f3ba7a92607a9d78e7bfc973bb67d?s=128&d=identicon&r=PG&f=1", "display_name": "iron", "link": "https://stackoverflow.com/users/5398234/iron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473875397, "creation_date": 1473866976, "last_edit_date": 1531161705, "question_id": 39494344, "link": "https://stackoverflow.com/questions/39494344/excel-addin-file-xll-will-not-open-properly-in-excel-2007-but-works-fine-in-2", "title": "Excel Addin (File.xll) will not open properly in excel 2007, but works fine in 2003", "body": "<p>How do i make excel 2007 treat the xll addin the same when opening programatically, as it does when browsing via the addin-manager?</p>\n\n<p>i have an excel addin (XLL file) that works fine on an old XP box, running excel 2003 (Excel XP)...but not on windows 7 running excel 2007.</p>\n\n<p>On my new Windows 2007 machine, running Office/Excel 2007, the same XLL has odd behavior.</p>\n\n<p>In Excel 2007, When i goto the excel addin manager, browse to the xll, and then load it...the XLL works just fine...but just for that session.</p>\n\n<p>But, after i close this instance of excel, and then re-open excel (so, now the adddin will be loaded programatically from the Excel\\Options list from the registry - which is how excel normally loads addins)....Excel throws an error saying </p>\n\n<p>\"The file you are trying to open, 'Addin.xll' is in a different format than specified by the file extension.  Verify that the file is not corrupted and is from a trusted source before opening the file.  Do you want to open the file now?\"</p>\n\n<p>If i click 'yes', then the xll opens with garbage text, and does not work.</p>\n\n<p>However, if i kill excel, open the registry, goto HKEY_Current_User\\Software\\Microsoft\\Office]12.0\\Excel\\Options\\</p>\n\n<p>and remove the [OPEN] item which points excel to open the addin programatically...then excel opens fine (without the addin loading...obvs).</p>\n\n<p>Again, if i then goto the Excel Options --> addin manager\nand re-add the Addin...then it will load and work just fine.</p>\n\n<p>But again, after i close excel and re-open., i'll get the same error from above.</p>\n\n<p>I've read that Excel sets the 'Current Working Directory' when you open the addin from the \"addin manager --> browse\" method...but not when excel opens the addin programaticaly.</p>\n\n<p>So...what can i do to make excel open my addin correctly?  It works fine with Excel 2003...and it works fine the 1st time in Excel 2007...so its got to be  a problem with Excel.</p>\n"}, {"tags": ["excel", "function", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473867168, "post_id": 39493819, "comment_id": 66306247, "body": "This does not count duplicates but basically counts the number of non empty cells and returns half.  For example the array {1,2,3,4,5,6} would return 3 where it should return 0 if it were looking for duplicates."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473884430, "post_id": 39493819, "comment_id": 66315524, "body": "@ScottCraner - the current function will return 2 for the array {1,2, ,3, ,4,5,6} but 3 for {1,2, ,3,4, ,5,6}, and 0 for {1, ,2, ,3, ,4, ,5, ,6}.  So it is actually counting the number of times that two consecutive non-empty cells exist.  (But <b>definitely</b> isn&#39;t counting duplicates!)"}, {"owner": {"reputation": 1, "user_id": 6830436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719a6e53e3624af2430e3228d57001d4?s=128&d=identicon&r=PG&f=1", "display_name": "VBNoob1991", "link": "https://stackoverflow.com/users/6830436/vbnoob1991"}, "edited": false, "score": 0, "creation_date": 1473973365, "post_id": 39493819, "comment_id": 66356322, "body": "Thank you everyone, I used all your advice and things seem to work now :)"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473868025, "post_id": 39494443, "comment_id": 66306821, "body": "@ScottCraner I could be badly mistaken but I think you&#39;re wrong - It&#39;d count the number of rows removed (ie. the number of duplicates. Incorporating you you solution above gives the number of unique values but you&#39;re right in saying it&#39;s less work so maybe something like <code>CountA(&quot;A1:A10&quot;) - SUMPRODUCT(1&#47;COUNTIF(A1:A10,A1:A10))</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1473868136, "post_id": 39494443, "comment_id": 66306878, "body": "Ah sorry you are correct I did not look close enough."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473868386, "post_id": 39494443, "comment_id": 66307010, "body": "The formula in your comments passes a #Div0 error if there are blanks in the range. as it returns a 0 when it gets to the empty space. Other than that it works great."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473868490, "post_id": 39494443, "comment_id": 66307080, "body": "Yeah, I noticed that too - I can&#39;t think of a work around on that though so maybe the transposing method would be best? @ScottCraner"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473868508, "post_id": 39494443, "comment_id": 66307094, "body": "The more I think about it though, both those methods would count if there is more than two, triplicates will count as two, again this may be something the OP wants, so it is just a note."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1473884485, "post_id": 39494443, "comment_id": 66315549, "body": "<code>Setection</code> ?!?!? (Typo for <code>Selection</code> perhaps?  ;-) )"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473926969, "last_edit_date": 1473926969, "creation_date": 1473867224, "answer_id": 39494443, "question_id": 39493819, "link": "https://stackoverflow.com/questions/39493819/adapting-this-vba-code-to-counting-duplicates-in-columns/39494443#39494443", "title": "Adapting this VBA code to counting duplicates in columns", "body": "<p>Why don't you copy the range that you wish to count the duplicates to a new sheet, transpose it and then apply the <code>RemoveDuplicates</code> function - your number of duplicates would then be <code>Selection.Rows.Count - (WorksheetFunction.CountA (Selection)/Selection.Columns.Count))</code></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1473869035, "last_edit_date": 1473869035, "creation_date": 1473868009, "answer_id": 39494711, "question_id": 39493819, "link": "https://stackoverflow.com/questions/39493819/adapting-this-vba-code-to-counting-duplicates-in-columns/39494711#39494711", "title": "Adapting this VBA code to counting duplicates in columns", "body": "<p>The following Array formula will count duplicates:</p>\n\n<pre><code>=SUM(IF(COUNTIF(A1:A13,A1:A13)=2,1/COUNTIF(A1:A13,A1:A13)))\n</code></pre>\n\n<p>Being an array formula it must be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode.  If done correctly then Excel will put <code>{}</code> around the formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dmY87.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dmY87.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to count any multiple, triplicates and so forth as 1 then:</p>\n\n<pre><code>=SUM(IF(COUNTIF(A1:A13,A1:A13)&gt;1,1/COUNTIF(A1:A13,A1:A13)))\n</code></pre>\n\n<p>If you only want to count the unique non empty cells then:</p>\n\n<pre><code>=SUM(IF(A1:A13&lt;&gt;\"\",1/COUNTIF(A1:A13,A1:A13)))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6830436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719a6e53e3624af2430e3228d57001d4?s=128&d=identicon&r=PG&f=1", "display_name": "VBNoob1991", "link": "https://stackoverflow.com/users/6830436/vbnoob1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473926969, "creation_date": 1473865373, "last_edit_date": 1531164843, "question_id": 39493819, "link": "https://stackoverflow.com/questions/39493819/adapting-this-vba-code-to-counting-duplicates-in-columns", "title": "Adapting this VBA code to counting duplicates in columns", "body": "<p>I'm having trouble adapting this code to my situation. I would like to create a function that allows me to count the number of duplicates in a column (I believe it currently only counts for rows).\nMany thanks!</p>\n\n<pre><code>Function CountPairs(rng As Variant) As Integer\nDim v As Variant\nDim count, length, i As Integer\nDim found As Boolean\ncount = 0\nfound = False\nv = rng\nlength = UBound(v, 2)\n\n For i = 1 To length\n\n' Count if second of pair\n\n If Not (IsEmpty(v(1, i))) Then\n If found Then\n     count = count + 1\n     found = False\n Else\n     found = True\n End If\nElse\n found = False\nEnd If\n\nNext i\n\nCountPairs = count\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3817193, "user_type": "registered", "profile_image": "https://graph.facebook.com/9309660/picture?type=large", "display_name": "AngelOfDef", "link": "https://stackoverflow.com/users/3817193/angelofdef"}, "edited": false, "score": 0, "creation_date": 1473882367, "post_id": 39494048, "comment_id": 66314492, "body": "The code doesn&#39;t work, says excel can&#39;t process with available resources, then still gives an error message at the paste line."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 15, "user_id": 3817193, "user_type": "registered", "profile_image": "https://graph.facebook.com/9309660/picture?type=large", "display_name": "AngelOfDef", "link": "https://stackoverflow.com/users/3817193/angelofdef"}, "edited": false, "score": 0, "creation_date": 1473884908, "post_id": 39494048, "comment_id": 66315772, "body": "Maybe it&#39;s your sheet? Does it contain a lot of data? If not, did you try it on a new/blank sheet?"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 0, "last_activity_date": 1473884489, "last_edit_date": 1473884489, "creation_date": 1473866053, "answer_id": 39494048, "question_id": 39493338, "link": "https://stackoverflow.com/questions/39493338/paste-visible-cells-error-1004/39494048#39494048", "title": "Paste visible cells error 1004", "body": "<p>Well you have <code>Application.CutCopyMode = False</code> in there. Remove it and you should be fine.</p>\n\n<p>I took the liberty to clear up the selections. Selections are considered very bad style in excel VBA because they are slow and unreliable. You can usually get rid of them pretty easily by replacing</p>\n\n<pre><code>something.Select\nSelection.dosomething\n</code></pre>\n\n<p>with</p>\n\n<pre><code>something.dosomething\n</code></pre>\n\n<p>The freezing was a little tricky though and I'm not sure it's the ideal way either.</p>\n\n<pre><code>Sheets(\"Midwest Log\").Range(\"A1\").SpecialCells(xlCellTypeVisible).Copy\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = \"MW Log\"\nSheets(\"MW Log\").Paste\nColumns(\"A:I\").AutoFit\nActiveWindow.SplitRow = 3\nActiveWindow.FreezePanes = True\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3817193, "user_type": "registered", "profile_image": "https://graph.facebook.com/9309660/picture?type=large", "display_name": "AngelOfDef", "link": "https://stackoverflow.com/users/3817193/angelofdef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473884489, "creation_date": 1473864117, "question_id": 39493338, "link": "https://stackoverflow.com/questions/39493338/paste-visible-cells-error-1004", "title": "Paste visible cells error 1004", "body": "<p>I am trying to write some code that will take a sheet with a table and paste only the visible cells to a new worksheet and freeze the header row.  I keep getting a 1004 paste method of workseet class failed error, the debugger highlights activesheet.paste as the issue.  I'm fairly new to VBA so not sure why I'm getting an error on such a seemingly simple command?</p>\n\n<pre><code>    Sub Macro6()\n'\n' Macro6 Macro\n'\n\n'\n    Sheets(\"Midwest Log\").Select\n    Range(\"A1\").Select\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.Copy\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Name = \"MW Log\"\n    Application.CutCopyMode = False\n    Sheets(\"MW Log\").Paste\n    Columns(\"A:I\").Select\n    Columns(\"A:I\").EntireColumn.AutoFit\n    Rows(\"4:4\").Select\n    ActiveWindow.FreezePanes = True\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1473864376, "last_edit_date": 1473864376, "creation_date": 1473863975, "answer_id": 39493281, "question_id": 39493196, "link": "https://stackoverflow.com/questions/39493196/count-if-function-not-working-properly-in-vba/39493281#39493281", "title": "Count if function not working properly in vba", "body": "<p>Try it as,</p>\n\n<pre><code>i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), 5)\n</code></pre>\n\n<p>Text-that-looks-like-a-number is not the same thing as a number; e.g. <code>5&lt;&gt;\"5\"</code>.</p>\n\n<p>On a related note, explicitly referencing the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980.aspx\" rel=\"nofollow\">.Parent</a> worksheet is widely considered 'best practise'. A <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> not only cleans up your code but speeds it up. I also prefer using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Excel Application object</a> over the  of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> as any error can be returned to a variant.</p>\n\n<pre><code>Dim i As Variant\nDim ws_raw As Worksheet, ws_rpt As Worksheet\n\nSet ws_raw = Sheets(\"Raw Data\")\nSet ws_rpt = Sheets(\"Report\")\n\nWith ws_rpt\n    If ws_raw.Range(\"H2\") &lt;&gt; \"\" Then\n        i = Application.CountIf(.Range(\"S2:CCC2\"), 5)\n        ws_raw.Range(\"I2\").Value = i\n\n        i = Application.CountIf(.Range(\"S2:CCC2\"), 6)\n        ws_raw.Range(\"J2\").Value = i\n\n        i = Application.CountIf(.Range(\"S2:CCC2\"), 7)\n        ws_raw.Range(\"K2\").Value = i\n\n        i = Application.CountIf(.Range(\"S2:CCC2\"), 8)\n        ws_raw.Range(\"L2\").Value = i\n    Else\n\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1473864026, "creation_date": 1473864026, "answer_id": 39493300, "question_id": 39493196, "link": "https://stackoverflow.com/questions/39493196/count-if-function-not-working-properly-in-vba/39493300#39493300", "title": "Count if function not working properly in vba", "body": "<p>You've the numbers you're counting converted to text by putting them in double-quotation marks - try this:</p>\n\n<pre><code>i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), 5)\nws_raw.Range(\"I2\").Value = i\n\n\ni = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), 6)\nws_raw.Range(\"J2\").Value = i\n\n\ni = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), 7)\nws_raw.Range(\"K2\").Value = i\n\n\ni = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), 8)\nws_raw.Range(\"L2\").Value = i\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2538, "favorite_count": 1, "accepted_answer_id": 39493281, "answer_count": 2, "score": 1, "last_activity_date": 1473864376, "creation_date": 1473863761, "last_edit_date": 1473864145, "question_id": 39493196, "link": "https://stackoverflow.com/questions/39493196/count-if-function-not-working-properly-in-vba", "title": "Count if function not working properly in vba", "body": "<p>I'm having some trouble getting my macro to use a countif funtion to display the frequency of scores in a given cell.  This is part of a larger macro that I am currently working on to generate a report out of a given set of exported data.  </p>\n\n<p>When I try to run the code, it returns all zeros in the cells I have specified even though there is data in there that matches my criteria.</p>\n\n<p>Please feel free if you like to critique this code as I am just starting out in programming and wanting to learn as much as possible.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Here is a copy of the code:</p>\n\n<pre><code>Dim i As Integer\nDim ws_raw As Worksheet\nDim ws_rpt As Worksheet\n\nSet ws_raw = Sheets(\"Raw Data\")\nSet ws_rpt = Sheets(\"Report\")\n\nIf ws_raw.Range(\"H2\") &lt;&gt; \"\" Then\n\n    i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), \"5\")\n    ws_raw.Range(\"I2\").Value = i\n\n    i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), \"6\")\n    ws_raw.Range(\"J2\").Value = i\n\n    i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), \"7\")\n    ws_raw.Range(\"K2\").Value = i\n\n    i = WorksheetFunction.CountIf(Range(\"S2:CCC2\"), \"8\")\n    ws_raw.Range(\"L2\").Value = i\n\nElse\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1473863997, "post_id": 39493035, "comment_id": 66304023, "body": "What do you mean by &quot;it doesn&#39;t work&quot;? I see nothing that is sheet specific. However you should reduce/remove the selections. <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate\">here</a> are some tips."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1473865304, "post_id": 39493648, "comment_id": 66304960, "body": "Thanks, I&#39;ll give it a try. The last commands delete the first column (with the data i pasted from the other sheet) and include a blank one (odd, but necessary). The data i want remains in the column B as i used the formula LEFT to extract the value i need."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1473865379, "post_id": 39493648, "comment_id": 66305016, "body": "@Serveira - Okay, I just edited that last line to just clear contents of column A. <i>Please</i> note I wasn&#39;t sure what sheet should have been the &quot;pasting TO&quot; sheet, vs. the data source, so you may have to tweak the sheets in the code."}, {"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1473867814, "post_id": 39493648, "comment_id": 66306685, "body": "That works perfectly, thanks. I&#39;ll try and adapt this to the rest of my code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1473868387, "post_id": 39493648, "comment_id": 66307011, "body": "@Serveira - Happy to help! I <b><i>highly</i></b> suggest you review my code and compare to yours and learn how to avoid <code>.Select</code>.  I didn&#39;t really &quot;do&quot; a whole lot to get it working, all I did was avoid using <code>.Select</code>, and used two worksheet variables.  Essentially, to remove <code>.Select</code>, just &quot;snug&quot; it back up to the line ending in <code>.Select</code>...ie: <code>Cells(1,1).Select &#47;&#47; Selection.Copy</code> can just be <code>Cells(1,1).Copy</code> (just remove <code>.Select</code>, <code>.Selection</code>)."}, {"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "edited": false, "score": 0, "creation_date": 1473884350, "post_id": 39493648, "comment_id": 66315474, "body": "Will do! I&#39;m really trying to learn how to code and you guys are helping a lot."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1473865335, "last_edit_date": 1473865335, "creation_date": 1473864958, "answer_id": 39493648, "question_id": 39493035, "link": "https://stackoverflow.com/questions/39493035/recorded-macro-doesnt-work-on-other-sheets/39493648#39493648", "title": "Recorded macro doesn&#39;t work on other sheets", "body": "<p>You're getting inconsistent results likely due to the use of <code>.Select</code>, which it's <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">best practice to avoid</a>.</p>\n\n<p>I've created two variables to store your worksheets, and do what you have above, but without <code>.Select</code>. The only thing is, what's the last column <code>.Insert Shift:=xlToRight</code> supposed to do?</p>\n\n<pre><code>Sub macro2a()\nDim mainWS As Worksheet, newWS As Worksheet\n\nSet mainWS = Worksheets(\"Sheet1\")    ' I assume this is the sheet name of your main worksheet.\nSet newWS = Sheets.Add(after:=Sheets(Sheets.Count))\n\nnewWS.Columns(\"A:A\").Value = mainWS.Columns(\"A:A\").Value    ' instead of copy/paste, you can set ranges equal if you just need values.\nWith newWS\n    .Columns(\"A:A\").UnMerge\n    .Range(\"A:A\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    .Range(\"B2\").FormulaR1C1 = \"=Left(RC[-1],6)\"\n    .Range(\"B2\").AutoFill Destination:=.Range(\"B2:B14\")\n    .Range(\"B2:B14\").Value = .Range(\"B2:B14\").Value ' instead of copy/paste special, just set values equal to remove formulas\n\n    With .Columns(\"A:A\")\n        .ClearContents\n      '   .Insert shift:=xlToRight  ' What's this line to do?\n    End With '.Columns(\"A:A\")\n\nEnd With 'newWS\nnewWS.range(\"D8\").Select ' This is okay since it's the end, and we're just using .Select to get to the cell.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "accepted_answer_id": 39493648, "answer_count": 1, "score": 0, "last_activity_date": 1473865335, "creation_date": 1473863385, "question_id": 39493035, "link": "https://stackoverflow.com/questions/39493035/recorded-macro-doesnt-work-on-other-sheets", "title": "Recorded macro doesn&#39;t work on other sheets", "body": "<p>I'm working on a recorded macro that will execute the same action to a lot of similar sheets. If works neatly for the sheet i recorded it on, however, when i try it on other workbooks it doesn't work.\nHere's a piece of the code, basically it copies the first column, pastes on a new sheet, removes duplicates and gets the first 6 numbers:</p>\n\n<pre><code>Sub Macro2()\n\n    ActiveSheet.Select\n    Columns(\"A:A\").Select\n    Selection.Copy\n    Sheets.Add After:=Sheets(Sheets.Count).Select\n    Columns(\"A:A\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Selection.UnMerge\n    ActiveSheet.Range(\"$A:$A\").RemoveDuplicates Columns:=1, Header:=xlNo\n    Range(\"B2\").Select\n    ActiveCell.FormulaR1C1 = \"=LEFT(RC[-1],6)\"\n    Range(\"B2\").Select\n    Selection.AutoFill Destination:=Range(\"B2:B14\")\n    Range(\"B2:B14\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Columns(\"A:A\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Selection.Insert Shift:=xlToRight\n    Range(\"D8\").Select\nEnd Sub\n</code></pre>\n\n<p>I know it doesn't look good, I'm still learning. I don't get it why it doesn't work on other sheets if it looks so simple.</p>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473862135, "post_id": 39492429, "comment_id": 66302692, "body": "Also, if I google your exact question title the first hit I get explains exactly that."}, {"owner": {"reputation": 31, "user_id": 6831214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e19eB6FnRao/AAAAAAAAAAI/AAAAAAAAAII/2YhtzL3LnfM/photo.jpg?sz=128", "display_name": "Fernando Lou Gonzalez", "link": "https://stackoverflow.com/users/6831214/fernando-lou-gonzalez"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473862502, "post_id": 39492429, "comment_id": 66302936, "body": "I googled it as well and saw the entry you mention. When I remove Set I then get another error. Compile Error: Type Mismatch."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1473862811, "post_id": 39492429, "comment_id": 66303142, "body": "Ok, sorry. However you went one step backwards when you returned to the <code>Set</code> syntax. You need something that returns a <code>Date</code> type which <code>OpenRecordset</code> doesn&#39;t. Unfortunately I&#39;m not able to help you there."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6831214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e19eB6FnRao/AAAAAAAAAAI/AAAAAAAAAII/2YhtzL3LnfM/photo.jpg?sz=128", "display_name": "Fernando Lou Gonzalez", "link": "https://stackoverflow.com/users/6831214/fernando-lou-gonzalez"}, "edited": false, "score": 0, "creation_date": 1473862544, "post_id": 39492547, "comment_id": 66302968, "body": "When I remove Set I then get another error. Compile Error: Type Mismatch."}], "tags": [], "owner": {"reputation": 58970, "user_id": 71059, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/RRmlf.png?s=128&g=1", "display_name": "AakashM", "link": "https://stackoverflow.com/users/71059/aakashm"}, "is_accepted": false, "score": 1, "last_activity_date": 1473862045, "creation_date": 1473862045, "answer_id": 39492547, "question_id": 39492429, "link": "https://stackoverflow.com/questions/39492429/access-2013-compile-error-object-required/39492547#39492547", "title": "Access 2013 Compile error - object required", "body": "<p>In VBA, <code>Set</code> is only to be used when assigning to <em>object</em> variables. A variable of type <code>Date</code> is not an object variable, so you just say</p>\n\n<pre><code>RS = CurrentDb.OpenRecordset(\"tblDate\")\n</code></pre>\n\n<p>(note that you <em>can</em>, if you really want to, put a <code>Let</code> in front, but pretty much no one ever does).</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6831214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e19eB6FnRao/AAAAAAAAAAI/AAAAAAAAAII/2YhtzL3LnfM/photo.jpg?sz=128", "display_name": "Fernando Lou Gonzalez", "link": "https://stackoverflow.com/users/6831214/fernando-lou-gonzalez"}, "edited": false, "score": 0, "creation_date": 1473864837, "post_id": 39492840, "comment_id": 66304613, "body": "Setting the Dim to dao.Recordset fixed it up. Thank you for you quick response and help!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1473863186, "last_edit_date": 1473863186, "creation_date": 1473862843, "answer_id": 39492840, "question_id": 39492429, "link": "https://stackoverflow.com/questions/39492429/access-2013-compile-error-object-required/39492840#39492840", "title": "Access 2013 Compile error - object required", "body": "<p>If you're opening a recordset the variable should be a recordset.  You then reference the field in the table you're after in the messagebox.  </p>\n\n<p>If you have more than one record in the table it will return the first value - so either create a temporary query to return the value you're after, or search the recordset and go to the correct record.</p>\n\n<pre><code>Private Sub Test()\n    Dim RS As dao.Recordset\n    Set RS = CurrentDb.OpenRecordset(\"tblDate\")\n    MsgBox \"The month and year are: \" &amp; Format(RS.Fields(\"MyDateField\"), \"yyyy-mm\")\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>\nIf you're using a query to get the record:</p>\n\n<pre><code>Private Sub Test2()\n    Dim qdf As DAO.QueryDef\n    Dim rs As DAO.Recordset\n\n    Set qdf = CurrentDb.CreateQueryDef(\"\", \"SELECT MAX(MyDateField) AS MaxDateField FROM tblDate\")\n    Set rs = qdf.OpenRecordset\n    MsgBox \"The month and year are: \" &amp; Format(rs.Fields(\"MaxDateField\"), \"yyyy-mm\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6831214, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e19eB6FnRao/AAAAAAAAAAI/AAAAAAAAAII/2YhtzL3LnfM/photo.jpg?sz=128", "display_name": "Fernando Lou Gonzalez", "link": "https://stackoverflow.com/users/6831214/fernando-lou-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2282, "favorite_count": 0, "accepted_answer_id": 39492840, "answer_count": 2, "score": 0, "last_activity_date": 1473863186, "creation_date": 1473861643, "question_id": 39492429, "link": "https://stackoverflow.com/questions/39492429/access-2013-compile-error-object-required", "title": "Access 2013 Compile error - object required", "body": "<p>I use Access quite a bit but only dabble in VBA code. I have some code that works, but I tried to compile the code and get the following error.</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\nDim RS As Date\nSet RS = CurrentDb.OpenRecordset(\"tblDate\")\nMsgBox (\"The month and year are: \" &amp; RS)\nDoCmd.OutputTo acOutputReport, \"LP Completions\", \"PDFFormat(*.pdf)\", Chr(34) &amp; \"\\\\sharepoint.xx.yyyy.zzz\\Reports\\\" &amp; Format(RS.Fields(0), \"yyyy-mm\") &amp; Chr(32) &amp; \" - LP Completions - Exec Report.pdf\" &amp; Chr(34), False\nEnd Sub\n</code></pre>\n\n<p>I get a Compile Error: Object Required. In the code view the <strong>RS =</strong> is highlighted.</p>\n\n<p>I have no clue why this is coming up. Can someone provide some guidance as to how to fix this? Thanks so much!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1473861701, "post_id": 39492355, "comment_id": 66302403, "body": "Maybe turning off <code>Application.DisplayAlerts</code> (and <code>ScreenUpdating</code> while you are at it)  would help."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473861704, "post_id": 39492355, "comment_id": 66302409, "body": "Couldn&#39;t you <code>Application.DisplayAlerts = False</code>?"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 2, "creation_date": 1473862092, "post_id": 39492355, "comment_id": 66302662, "body": "Maybe invalid external Links in some of the workbooks?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1473863788, "post_id": 39492355, "comment_id": 66303881, "body": "too @CharlesWilliams point, set <code>UpdateLinks:=False</code> in UpdateLinks argument of Workbook.Open() event."}, {"owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1473866580, "post_id": 39492355, "comment_id": 66305866, "body": "@ScottHoltzman thanks guys, please see my edit to my original post"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1473867782, "post_id": 39492355, "comment_id": 66306659, "body": "Another maybe.... <code>Set MyFile = Workbooks.Open SourceFile, ReadOnly:=True</code>.  I&#39;m thinking <code>Set MyFile = Workbooks(Workbooks.Count)</code> get confused with the <code>Workbooks.Count</code> number?"}, {"owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473868615, "post_id": 39492355, "comment_id": 66307149, "body": "@DarrenBartrup-Cook I don&#39;t think your suggested line of code is valid... But I did try changing to MyFile = Workbooks(ActiveWorkbook.Name), but that is not working either. And just to be clear, the &quot;hang up msg box&quot; is happening when I run the &quot;Workbooks.Open...&quot; line of code."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473870124, "post_id": 39492355, "comment_id": 66308048, "body": "Apologies, you&#39;re correct - it should be <code>Set MyFile = Workbooks.Open (SourceFile, ReadOnly:=True)</code> - I forgot the brackets."}, {"owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473870795, "post_id": 39492355, "comment_id": 66308461, "body": "@DarrenBartrup-Cook thank you. I have tried what you suggested. I still get the hanging Downloading message... I am starting to think there is no way around this..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "edited": false, "score": 0, "creation_date": 1473880227, "post_id": 39497286, "comment_id": 66313414, "body": "yes, it is from a shared drive. However, all the paths are mapped drives (the O:\\ drive) on all the users PCs. I was playing around with the SendKeys code already (but can&#39;t say that I fully understand it). Anyway. the SendKeys code I had been playing around with does seem to be working better. But I do seem to still be getting the occasional &quot;Downloading&quot; msg box hang up, but just not as often..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "edited": false, "score": 0, "creation_date": 1473881396, "post_id": 39497286, "comment_id": 66314049, "body": "replace <code>&quot;\\\\&quot;</code> with <code>&quot;O:\\&quot;</code>"}, {"owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "edited": false, "score": 0, "creation_date": 1473882898, "post_id": 39497286, "comment_id": 66314770, "body": "thanks. This is causing weird things to happen... like the macro occasionally stopping and opening the debug window on the Workbooks.Open line, or the macro inserting additional blank rows after the application.sendkeys line or after the workbooks.open line..."}, {"owner": {"reputation": 3541, "user_id": 1013219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50db42ebef8884b876fa97363e442e87?s=128&d=identicon&r=PG", "display_name": "mTorres", "link": "https://stackoverflow.com/users/1013219/mtorres"}, "edited": false, "score": 0, "creation_date": 1485523689, "post_id": 39497286, "comment_id": 70972006, "body": "Just wanted to point out, I&#39;m in a network share but the solution here would not work. I just enabled the errors and the visibility of the new application (I&#39;m oppening the new workbooks in a diferent instance because I do not want to see a thing so I&#39;m making the new excel app invisible) and found out that someone had renamed the file so the open command was giving an error that I could not see"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1473877724, "creation_date": 1473877724, "answer_id": 39497286, "question_id": 39492355, "link": "https://stackoverflow.com/questions/39492355/vba-hangs-when-opening-excel-files/39497286#39497286", "title": "VBA hangs when opening Excel files", "body": "<p>Seems like you are trying to open a file from a shared drive and that is why it is showing you the \"<strong>Downloading</strong>\" message box. This happens sometimes. </p>\n\n<p><code>Application.DisplayAlerts = False</code> in such scenario will not help. Nor will <code>ReadOnly:=True, UpdateLinks:=False</code> help.</p>\n\n<p>Try this code (<strong>Untested</strong>)</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Filepaths\")\n    For i = firstrow To lastrow\n        SourceFile = .Cells(i, 1).Value\n\n        '~~&gt; Check for network path and use sendkeys\n        '~~&gt; to close the downloading window\n        If InStr(1, SourceFile, \"\\\\\") Then _\n        Application.SendKeys \"~\", True\n\n        Workbooks.Open SourceFile, ReadOnly:=True\n\n        Set MyFile = Workbooks(Workbooks.Count)\n        '..more code..........\n        '..more code..........\n        '..more code..........\n        MyFile.Close\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4995936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2ffe57c68cff52a11d3d056730e461?s=128&d=identicon&r=PG&f=1", "display_name": "ActuaryGuy", "link": "https://stackoverflow.com/users/4995936/actuaryguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3081, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611740654, "creation_date": 1473861473, "last_edit_date": 1552281864, "question_id": 39492355, "link": "https://stackoverflow.com/questions/39492355/vba-hangs-when-opening-excel-files", "title": "VBA hangs when opening Excel files", "body": "<p>I have a macro which loops through a list of Excel filepaths. The macro will read each path, open the workbook, copy/pull data out of each workbook and then pastevalues the data into a central workbook. There are about 2000 filepaths.</p>\n\n<p>After a while (maybe after it has looped through the first 70 or so filepaths), Excel hangs. It shows the \"Downloading\" message box that you get when opening a file. If I click cancel on the msg box, the workbook opens and the macro continues as normal.</p>\n\n<p>I would have to sit here for 1000s of filepaths. Why does Excel get stuck here? Is there a way around it?</p>\n\n<p>This message box does not happen on every Workbooks.Open instance, just after every few.</p>\n\n<p>Example of the code:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Filepaths\")\n    For i = firstrow To lastrow\n        SourceFile = .Cells(i, 1).Value\n        Workbooks.Open SourceFile, ReadOnly:=True \n        Set MyFile = Workbooks(Workbooks.Count)\n        ' ..more code..........\n        ' ..more code..........\n        ' ..more code..........\n        MyFile.close\n    Next i\nEnd With\n</code></pre>\n\n<p>Thanks for the comments. These are both good points (and are both solutions I believe I have tried in the past). But just to check, I modified my Workbooks.Open line: </p>\n\n<pre><code>Application.DisplayAlerts = False\nWorkbooks.Open SourceFile, ReadOnly:=True, UpdateLinks:=False\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>But the message box is still popping up.</p>\n\n<p>What's weird is when I step thru line by line, after I step past the <code>Application.DisplayAlerts = False</code> line, when I hover over the \"Application.DisplayAlerts\" variable, it still says true?</p>\n"}, {"tags": ["vba", "excel", "range", "autofill"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473861003, "post_id": 39491895, "comment_id": 66301854, "body": "Try <code>msgbox</code>ing your <code>SourceRange</code> and <code>FillRange</code> right after you have them set. Are you getting the expected values?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473861854, "post_id": 39491895, "comment_id": 66302515, "body": "@Marcus Forsberg test my answer below, as long as <code>Lenght1.Count</code> gets a number in your code it shpuld work"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473958983, "post_id": 39491895, "comment_id": 66348970, "body": "@Marcus Forsberg  have you tried my code below, did it work ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6831154, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154161535559219/picture?type=large", "display_name": "Marcus Forsberg", "link": "https://stackoverflow.com/users/6831154/marcus-forsberg"}, "edited": false, "score": 0, "creation_date": 1473864944, "post_id": 39492249, "comment_id": 66304696, "body": "Thanks for the answers! I tried to make a simple Autofill as below and still get the same error. Makes me thing there is some sort of addition that unaviable?  Set SourceRange1 = Worksheets(&quot;Blad1&quot;).Range(&quot;A1:A2&quot;) Set FillRange1 = Worksheets(&quot;Blad1&quot;).Range(&quot;A4:A10&quot;)  SourceRange1.AutoFill Destination:=FillRange1"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 11, "user_id": 6831154, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154161535559219/picture?type=large", "display_name": "Marcus Forsberg", "link": "https://stackoverflow.com/users/6831154/marcus-forsberg"}, "edited": false, "score": 0, "creation_date": 1473870979, "post_id": 39492249, "comment_id": 66308574, "body": "@MarcusForsberg see my edited answer , you need to set <code>FillRange1</code> to Range(&quot;A1:A10&quot;)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1473870920, "last_edit_date": 1473870920, "creation_date": 1473861127, "answer_id": 39492249, "question_id": 39491895, "link": "https://stackoverflow.com/questions/39491895/autofill-method-in-range-class-error/39492249#39492249", "title": "AutoFill method in Range class error", "body": "<p>Recommendation, it is better to avoid <code>ActiveCell</code> and <code>Selection</code> ;  try instead to use <code>Range(\"B1\")</code>  (for example) , or <code>Cells(1,\"B\")</code>.</p>\n\n<pre><code>Set SourceRange = Worksheets(\"Sheet2\").Range(ActiveCell.Offset(-1, 0).Address &amp; \",\" &amp; ActiveCell.Offset(-1, 0).Address)\nSet FillRange = Worksheets(\"Sheet2\").Range(Selection.Address &amp; \",\" &amp; ActiveCell.Offset((Lenght1.Count), 0).Address)\n\nSourceRange.AutoFill Destination:=FillRange\n</code></pre>\n\n<p><strong>Edit 1</strong>:</p>\n\n<pre><code>Set SourceRange1 = Worksheets(\"Blad1\").Range(\"A1:A2\")\n\n' you need to set the Range from A1\nSet FillRange1 = Worksheets(\"Blad1\").Range(\"A1:A10\")\n\nSourceRange1.AutoFill Destination:=FillRange1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6831154, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154161535559219/picture?type=large", "display_name": "Marcus Forsberg", "link": "https://stackoverflow.com/users/6831154/marcus-forsberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473870920, "creation_date": 1473860049, "last_edit_date": 1531164843, "question_id": 39491895, "link": "https://stackoverflow.com/questions/39491895/autofill-method-in-range-class-error", "title": "AutoFill method in Range class error", "body": "<p>I'm trying to make an autofill function in VBA and can't make it work. I get the error message: AutoFill method in Range class error. Can someone please explain to me why I cant make it work, or better yet a VBA code that makes it work. Thanks in advance, see code below: (The code is just a part of a bigger code and I'm pretty sure it's nothing wrong with SourceRange or FillRange, I get the error on row: <code>SourceRange.AutoFill Destination:=FillRange</code>)</p>\n\n<pre><code>Set SourceRange = Worksheets(\"Sheet2\").Range(ActiveCell.Offset(-1, 0), ActiveCell.Offset(-1, 0))\nSet FillRange = Worksheets(\"Sheet2\").Range(Selection, ActiveCell.Offset((Lenght1.Count), 0))\nSourceRange.AutoFill Destination:=FillRange\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "type-mismatch"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 0, "creation_date": 1473860409, "post_id": 39491953, "comment_id": 66301394, "body": "Yes, that was a mistake which I corrected at your suggestion. But I get the same error at the same line."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 1, "creation_date": 1473860505, "post_id": 39491953, "comment_id": 66301472, "body": "did you check what you are passing to <code>CLng</code> when the error appears using the debugger?"}, {"owner": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 0, "creation_date": 1473860733, "post_id": 39491953, "comment_id": 66301659, "body": "I tried out your if-statement. It appears that I&#39;m trying to pass nothing, which would give a type-mismatch. That&#39;s weird. There is definitely data in the array because I can print out everything just fine as a string."}, {"owner": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 0, "creation_date": 1473860976, "post_id": 39491953, "comment_id": 66301829, "body": "Shoot, I know the problem. It&#39;s the size of the array. I made it larger than it needs to be, so it&#39;s reading in all that whitespace.  I don&#39;t have my arrays as being dynamic, something I don&#39;t know how to do yet, so that&#39;s the problem."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 0, "creation_date": 1473861111, "post_id": 39491953, "comment_id": 66301936, "body": "Ah I see. I will add that to the answer in case anyone stumbles upon this."}, {"owner": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "edited": false, "score": 0, "creation_date": 1473864344, "post_id": 39491953, "comment_id": 66304274, "body": "Thanks for your help!"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 4, "last_activity_date": 1473861213, "last_edit_date": 1473861213, "creation_date": 1473860204, "answer_id": 39491953, "question_id": 39491792, "link": "https://stackoverflow.com/questions/39491792/vba-excel-convert-string-array-element-to-long-type-mismatch/39491953#39491953", "title": "VBA Excel Convert String Array element to Long &quot;Type Mismatch&quot;", "body": "<p>The very first thing you pass to <code>CLng</code> is <code>\"SrcWth\"</code>.</p>\n\n<p>I imagine this is the column header so you want to start your next loop at 1</p>\n\n<pre><code>For j = 1 To UBound(stArray, 1)\n    whArray(0, j) = CLng(Trim(stArray(j, i)))\nNext j\n</code></pre>\n\n<p>You also could include a check if it's a numeric string</p>\n\n<pre><code>For j = 1 To UBound(stArray, 1)\n    If Not isNumeric(Trim(stArray(j, i))) Then\n        MsgBox \"invalid value: \"\"\" &amp; Trim(stArray(j, i)) &amp; \"\"\" at position \" &amp; j &amp; \", \" &amp; i\n    Else\n        whArray(0, j) = CLng(Trim(stArray(j, i)))\n    End If\nNext j  \n</code></pre>\n\n<hr>\n\n<p>Edit: as it turns out the array contained empty strings because it was initialized too big for the data. Trying to convert an empty string with <code>CLng</code> will return a type mismatch as well.</p>\n"}], "owner": {"reputation": 15, "user_id": 5059422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17da27fcc006a36aa1a2b8649700b18f?s=128&d=identicon&r=PG&f=1", "display_name": "Soolkiki", "link": "https://stackoverflow.com/users/5059422/soolkiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 39491953, "answer_count": 1, "score": 0, "last_activity_date": 1473861213, "creation_date": 1473859790, "question_id": 39491792, "link": "https://stackoverflow.com/questions/39491792/vba-excel-convert-string-array-element-to-long-type-mismatch", "title": "VBA Excel Convert String Array element to Long &quot;Type Mismatch&quot;", "body": "<p>so I have a simple problem that I'm trying to solve. I have a column of numbers that I'm reading in as a string. I'm then wanting to convert the string to a Long and store that in an array that is of type Long.</p>\n\n<p>I tried this initially:</p>\n\n<pre><code>ElseIf stArray(0, i) = \"SrcWth\" Then\n        Debug.Print \"Found the Width Column\"\n        For j = 0 To UBound(stArray)\n            whArray(0, j) = CLng(stArray(j, i))\n        Next j\n</code></pre>\n\n<p>stArray is the 2d array that is holding the CSV file info. It is type String.\nwhArray is the 2d array that is going to hold the two columns of numbers that I want. However, it complains about the type mismatch.</p>\n\n<p>I then thought maybe it was seeing some whitespace, so I tried trimming it.</p>\n\n<pre><code>ElseIf stArray(0, i) = \"SrcWth\" Then\n        Debug.Print \"Found the Width Column\"\n        For j = 0 To UBound(stArray)\n            whArray(0, j) = CLng(Trim(stArray(j, i)))\n        Next j\n</code></pre>\n\n<p>It made no difference.\nWhat am I doing wrong? I imagine it's having a problem with the CLng, so I'm not sure.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473860947, "post_id": 39491756, "comment_id": 66301814, "body": "There really isn&#39;t a way to do this without looping.  Even in .NET, the closest you would get from a Dictionary is an array of key/value pairs. DAO connections should give good performance with an INSERT loop."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473861477, "post_id": 39491756, "comment_id": 66302216, "body": "Why not add this to the table directly, instead of writing to a Dictionary first. Then you could just group the data with a count."}], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 1, "creation_date": 1473863931, "post_id": 39492266, "comment_id": 66303983, "body": "Andre, 17K &quot;.AddNew&quot; inserts as you suggested &lt;1 sec.  Did not expect that!  Thanks (I modified my code above to reflect the &quot;.AddNew&quot; piece)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1473875096, "post_id": 39492266, "comment_id": 66310771, "body": "@MarkPelletier: you may be able to shave off some more ms by removing <code>.Bookmark = .LastModified</code> - that&#39;s only needed if you want to read data from the newly added record, e.g. an Autonumber Primary key."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1473861181, "last_edit_date": 1495542324, "creation_date": 1473861181, "answer_id": 39492266, "question_id": 39491756, "link": "https://stackoverflow.com/questions/39491756/access-vba-scripting-dictionary-dump-to-table/39492266#39492266", "title": "Access VBA: Scripting.Dictionary - Dump to Table?", "body": "<p>Your code doesn't show how you tried to insert the rows - with separate <code>INSERT INTO (...) VALUES (...)</code> statements for each row, I assume?</p>\n\n<p>For multiple inserts in a loop, don't use SQL INSERT statements. Instead use a <code>DAO.Recordset</code> with <a href=\"https://msdn.microsoft.com/en-us/library/bb243801%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\"><code>.AddNew</code></a>, it will be much faster.</p>\n\n<p>See this answer: <a href=\"https://stackoverflow.com/a/33025620/3820271\">https://stackoverflow.com/a/33025620/3820271</a></p>\n\n<p>And here for an example: <a href=\"https://stackoverflow.com/a/36842264/3820271\">https://stackoverflow.com/a/36842264/3820271</a></p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 39492266, "answer_count": 1, "score": 3, "last_activity_date": 1594641384, "creation_date": 1473859686, "last_edit_date": 1594641384, "question_id": 39491756, "link": "https://stackoverflow.com/questions/39491756/access-vba-scripting-dictionary-dump-to-table", "title": "Access VBA: Scripting.Dictionary - Dump to Table?", "body": "<p>Thanks to the helpful hand provided earlier, I have a functional approach to compute Word Frequency among strings in a recordset.  The following code produces the desired result.</p>\n\n<p>Last step will be to dump the dictionary structure into an Access table in the currentDB.  I can step thru each key as commented out below and append to a table via SQL - but it is very slow w/24K terms.</p>\n\n<p>UPDATED >> w/Solution &lt;&lt;</p>\n\n<pre><code>Private Sub Command0_Click()\n\nDim counts As New Scripting.Dictionary\nDim word As Variant\nDim desc As String\n\nDim rs1 As DAO.Recordset\nDim rs2 As DAO.Recordset  '&lt;&lt; solution\nDim strSQL As String\nDim db As Database\n\nSet db = CurrentDb\n\nstrSQL = \"SELECT DISTINCT Items.Description FROM Items ;\"\n\nSet rs1 = db.OpenRecordset(strSQL, dbOpenDynaset)\n\nDo While Not rs1.EOF\n    For Each word In Split(rs1!Description, \" \")\n        If Not counts.Exists(word) Then\n            counts.Add word, 1\n        Else\n            counts.Item(word) = counts.Item(word) + 1\n        End If\n    Next\n    rs1.MoveNext\nLoop\n\n'&gt;&gt; .AddNew Solution inserted as suggested below &lt;&lt;\n\nrs2 = db.OpenRecordset(\"Freq\", dbOpenTable)  \n\nFor Each word In counts.Keys\n    With rs2\n       .AddNew             ' Add new record\n       .Fields!Term = word\n       .Fields!Freq = counts(word)\n       .Update\n       .Bookmark = .LastModified\n    End With\nNext\n\nrs2.Close\n\n'&gt;&gt; End Solution &lt;&lt;\n\nSet rs1 = Nothing\nSet rs2 = Nothing\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>Question:</p>\n\n<ol>\n<li>Can I dump the Dictionary into a table in BULK, vs stepping thru the Keys one-by-one? </li>\n</ol>\n\n<p>Rationale:  Easier (for me) to perform downstream presentation &amp; manipulation using a table structure.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 1792758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a56c5622f87037445171899fb98c042e?s=128&d=identicon&r=PG", "display_name": "Tydis", "link": "https://stackoverflow.com/users/1792758/tydis"}, "edited": false, "score": 1, "creation_date": 1473860351, "post_id": 39491886, "comment_id": 66301361, "body": "Thanks! I&#39;ll start with this and post back with an update."}, {"owner": {"reputation": 55, "user_id": 1792758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a56c5622f87037445171899fb98c042e?s=128&d=identicon&r=PG", "display_name": "Tydis", "link": "https://stackoverflow.com/users/1792758/tydis"}, "edited": false, "score": 0, "creation_date": 1473867469, "post_id": 39491886, "comment_id": 66306454, "body": "I&#39;ve updated my code above. Please let me know what changes I should make to fix the runtime error 13. Thanks."}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 55, "user_id": 1792758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a56c5622f87037445171899fb98c042e?s=128&d=identicon&r=PG", "display_name": "Tydis", "link": "https://stackoverflow.com/users/1792758/tydis"}, "edited": false, "score": 0, "creation_date": 1473916609, "post_id": 39491886, "comment_id": 66324258, "body": "my first guess is that it is because you are using a Range variable inside your for loops, instead of Range1 and Range2, you need an Integer, use Range1.Row for example"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1473860019, "creation_date": 1473860019, "answer_id": 39491886, "question_id": 39491729, "link": "https://stackoverflow.com/questions/39491729/comparing-data-from-2-sheets-and-copying-data-based-on-results/39491886#39491886", "title": "Comparing data from 2 sheets and copying data based on results", "body": "<p>Something to start with would be a loop from row 1 to last row in sheet 1, then for each of these rows, compare value of cell 1 to each value in sheet 2. </p>\n\n<p>A way to compare them to each other would be like this:</p>\n\n<pre><code>If Sheets(\"sheet 1\").Cells(i, \"A\").Value = Sheets(\"sheet 2\").Cells(j, \"A\").Value Then\n</code></pre>\n\n<p>now you just need to put a nested loop around this and you are good to go.</p>\n\n<p>To copy column m to i:</p>\n\n<pre><code>Sheets(\"sheet 1\").Cells(i, \"I\").Value = Sheets(\"sheet 2\").Cells(j, \"M\").Value\n</code></pre>\n\n<p>Now try out something and feel free to ask again if you are running into an error</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 1792758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a56c5622f87037445171899fb98c042e?s=128&d=identicon&r=PG", "display_name": "Tydis", "link": "https://stackoverflow.com/users/1792758/tydis"}, "is_accepted": false, "score": 0, "last_activity_date": 1473944026, "last_edit_date": 1495535245, "creation_date": 1473944026, "answer_id": 39511556, "question_id": 39491729, "link": "https://stackoverflow.com/questions/39491729/comparing-data-from-2-sheets-and-copying-data-based-on-results/39511556#39511556", "title": "Comparing data from 2 sheets and copying data based on results", "body": "<p>So I ended up consolidating the columns I need into 1 spreadsheet to make things easier, and I found this question on SO: <a href=\"https://stackoverflow.com/questions/18191835/comparing-two-columns-and-returning-a-specific-adjacent-cell-in-excel\">Comparing two columns, and returning a specific adjacent cell in Excel</a> which was very similar to what I was trying to do. The formula     </p>\n\n<pre><code> =IFERROR(VLOOKUP(C1, A:B, 2, 0), \"\")\n</code></pre>\n\n<p>worked perfectly for me, so I am using that instead of the VBA scrip.</p>\n"}], "owner": {"reputation": 55, "user_id": 1792758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a56c5622f87037445171899fb98c042e?s=128&d=identicon&r=PG", "display_name": "Tydis", "link": "https://stackoverflow.com/users/1792758/tydis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473944026, "creation_date": 1473859599, "last_edit_date": 1531164843, "question_id": 39491729, "link": "https://stackoverflow.com/questions/39491729/comparing-data-from-2-sheets-and-copying-data-based-on-results", "title": "Comparing data from 2 sheets and copying data based on results", "body": "<p>I have a workbook with 2 sheets that contain some of the same data. The first column in both worksheets contain a number assigned to an item, but sheet 2 contains more items </p>\n\n<p>than sheet 1. Sheet 1 contains the items pertinent to me, so I am trying to copy the relevant data from sheet 2 into sheet 1. </p>\n\n<p>For example:</p>\n\n<p>Sheet 1 <br> \nColumn A<br>\n20<br>\n53<br>\n120<br>\n500<br>\n1123<br>\netc<br></p>\n\n<p>Sheet 2<br>\nColumn A<br>\n1<br>\n2<br>\n3<br>\n4<br>\n5<br>\netc</p>\n\n<p>If the number in column A matches for both spreadsheets, I need to copy cell M from sheet 2 to cell I in sheet 1. I have tried a few different solutions posted elsewhere, but </p>\n\n<p>since my data isn't ideally sorted between the two sheets, using things like VLookup wasn't working well. </p>\n\n<p>I believe I need to store the information in column A in both sheets to an array and compare the data from there, I just have no clue how to write the code to continue </p>\n\n<p>comparing the cell from sheet 1 until it finds a match in sheet 2, and then copy the data over. </p>\n\n<p>Any help I can get would be greatly appreciated. Thanks everyone.</p>\n\n<p>My current code:</p>\n\n<pre><code>Sub CopyFromSheet2()\nDim i As Long\nDim j As Long\nDim Range1 As Range\nDim Range2 As Range\n\nSet Range1 = Sheets(\"Sheet1\").Range(\"A:A\")\nSet Range2 = Sheets(\"Sheet2\").Range(\"A:A\")\n\nFor j = 1 To Range1\nFor I = 1 To Range2\nIf Sheets(\"Sheet1\").Cells(i, \"A\").Value = Sheets(\"Sheet2\").Cells(j, \"A\").Value Then\nSheets(\"Sheet1\").Cells(i,\"I\").Value = Sheets(\"Sheet2\").Cells(j, \"M\").Value\nEnd If\nNext i\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>I am currently getting run time error 13 on the For j = 1 to Range1 line \"Type mismatch\"</p>\n"}, {"tags": ["vba", "excel", "pdf", "printing"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6831105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa480a9153290b96f1e06d09110c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "petgiraffe19", "link": "https://stackoverflow.com/users/6831105/petgiraffe19"}, "edited": false, "score": 0, "creation_date": 1473965492, "post_id": 39492646, "comment_id": 66352424, "body": "I&#39;m using hyperlinks that link to another sheet, and they are created with a macro. My code is:    <code>ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, Filename:=  &quot;C:\\blahblahblah\\&quot; &amp; &quot;Report_&quot; &amp; Month1 &amp; &quot;_&quot; &amp; Day1 &amp; &quot;_&quot; &amp; Year1 &amp; &quot;.pdf&quot;, _     ignoreprintareas:=False, openafterpublish:=False, Quality:=xlQualityStandard, includedocproperties:=True</code>   Neither yours nor mine prints the links."}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473862309, "creation_date": 1473862309, "answer_id": 39492646, "question_id": 39491652, "link": "https://stackoverflow.com/questions/39491652/automate-pdf-creation-to-include-hyperlinks/39492646#39492646", "title": "Automate PDF creation to include hyperlinks", "body": "<p>Using the below code, hyperlinks work for me on PDF:</p>\n\n<pre><code>Sub SaveAsPDF()\nDim sPath As String\n\nsPath = Environ(\"Temp\") &amp; \"\\\"\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\nsPath &amp; \"File name here\" &amp; \".pdf\", Quality:= _\nxlQualityStandard, includedocproperties:=False, ignoreprintareas:=False, _\nopenafterpublish:=False\n\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12262745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ca9ef9d127fadf564043620291c17f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mads", "link": "https://stackoverflow.com/users/12262745/mads"}, "is_accepted": false, "score": 0, "last_activity_date": 1571830013, "creation_date": 1571830013, "answer_id": 58521810, "question_id": 39491652, "link": "https://stackoverflow.com/questions/39491652/automate-pdf-creation-to-include-hyperlinks/58521810#58521810", "title": "Automate PDF creation to include hyperlinks", "body": "<p>Like petgiraffe19 I experienced complications using the Hyperlink function and the PDF-export simultaneously. My solution was to create the hyperlink through VBA like:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Hyperlinks.Add Anchor:=Range(\"A1\"), _\nAddress:=\"https://stackoverflow.com\", _\nScreenTip:=\"Link to stackoverflow\", _\nTextToDisplay:=\"Link\"\n</code></pre>\n\n<p>Dependent on the font settings it might be necessary to reset those, which also can be done through VBA:</p>\n\n<pre><code>With Range(\"A1\").Font\n    .Name = \"Calibri\"\n    .Size = 9\n    .Underline = xlUnderlineStyleNone\n    .ColorIndex = xlAutomatic\nEnd With\n</code></pre>\n\n<p>Finally the <code>ExportAsFixedFormat</code> can be used for export, which includes the cell with a hyperlink.</p>\n"}], "owner": {"reputation": 3, "user_id": 6831105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa480a9153290b96f1e06d09110c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "petgiraffe19", "link": "https://stackoverflow.com/users/6831105/petgiraffe19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571830013, "creation_date": 1473859411, "question_id": 39491652, "link": "https://stackoverflow.com/questions/39491652/automate-pdf-creation-to-include-hyperlinks", "title": "Automate PDF creation to include hyperlinks", "body": "<p>I've looked all over the internet for this. So far I know that:</p>\n\n<p>VBA itself cannot work in a pdf file. VBA is a Microsoft proprietary programming language that only works in some Microsoft products like Office, and the pdf format is not from Microsoft and does not support VBA.</p>\n\n<p>Because printing to PDF involves third party software, be it Adobe or another PDF printer, Excel, as far as I know, cannot send the file name and location directly to the PDF printer.</p>\n\n<p>Therefore .ExportAsFixedFormat will NOT include hyperlinks in the final pdf. </p>\n\n<p>Is there ANY way, at all, using other software or coding or anything, to create a pdf that WILL include the hyperlinks, other than by creating it manually. i.e. How can I automate the pdf creation to include the hyperlinks? I have tried Excel 2016 and 2010. </p>\n\n<p>We have software to automate the creation of an excel report daily, saves the file, saves the pdf, and emails out to people. I know you can write scripts in Adobe, but how can I get those to run daily by itself? Or maybe some other software can do this? </p>\n\n<p>Any ideas would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473858798, "post_id": 39491312, "comment_id": 66300261, "body": "So loop through the columns and delete every other one.  Stack Overflow is not a code for me service.  Please attempt on your own and come back when you have code that is not working."}, {"owner": {"reputation": 1, "user_id": 6807863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe94af28d105345b9b1b39c93460e6e?s=128&d=identicon&r=PG&f=1", "display_name": "T Surendra", "link": "https://stackoverflow.com/users/6807863/t-surendra"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473860084, "post_id": 39491312, "comment_id": 66301170, "body": "Hi scott ,I have tried my own I got it with below code  ...                                                                                      Sub Delete_Range_To_ShiftLeft() Range(&quot;D2:D7&quot;).Delete Shift:=xlToLeft End Sub &quot;is there any better way to do it, can you  please share with me ."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473860348, "post_id": 39491312, "comment_id": 66301357, "body": "Please use <a href=\"http://stackoverflow.com/posts/39491312/edit\">edit</a> to put the code in your original post not in the comments."}], "owner": {"reputation": 1, "user_id": 6807863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe94af28d105345b9b1b39c93460e6e?s=128&d=identicon&r=PG&f=1", "display_name": "T Surendra", "link": "https://stackoverflow.com/users/6807863/t-surendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474170232, "creation_date": 1473858566, "last_edit_date": 1531164843, "question_id": 39491312, "link": "https://stackoverflow.com/questions/39491312/how-to-delete-specific-cells-in-a-column-with-shift-cells-left-option-in-excel", "title": "How to delete specific cells in a column (with shift cells left) option in excel vba", "body": "<p>I have my input data is as follows.</p>\n\n<p>Input                       </p>\n\n<pre><code>        10-08-2012      15-08-2012      \nsid abc001  0   abc001  0   abc001  \nstatus  p   0   p   0   s   \nintime  10:00   0   10:00   0   09:00   \nouttime 19:00   0   19:00   0   18:00   \nTotal   9   0   9   0   9   \n</code></pre>\n\n<p>Here I need to delete specific cells in a column by shifting besides cells data to the left side. I have gone through below code to get required output.</p>\n\n<pre><code>Sub Delete_Range_To_ShiftLeft()\n\n    Range(\"C3:C7\").Delete Shift:=xlToLeft\n\nEnd Sub\n</code></pre>\n\n<p>Required output:                        </p>\n\n<pre><code>        10-08-2012  15-08-2012          \nsid abc001  abc001  abc001          \nstatus  p   p   s           \nintime  10:00   10:00   09:00           \nouttime 19:00   19:00   18:00           \nTotal   9   9   9\n</code></pre>\n\n<p>Can you please let me know, if you have any better way to do it?</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6220465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ebe65e09b967bdb32f1b1a6fc488c2?s=128&d=identicon&r=PG&f=1", "display_name": "Victor.L", "link": "https://stackoverflow.com/users/6220465/victor-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1475130105, "last_edit_date": 1592644375, "creation_date": 1475130105, "answer_id": 39762807, "question_id": 39491112, "link": "https://stackoverflow.com/questions/39491112/display-an-ole-object-from-a-table-in-a-word-doc-vba/39762807#39762807", "title": "Display an OLE Object from a table in a word doc [VBA]", "body": "<h1>So I finally came up with a solution!</h1>\n<p>The idea is to put each picture (OLE Object) in an Image frame in an Access Form, and then focus this object (Image frame) in order to proceed a copy and paste in our word doc, at the specific range we just set before. By the way, this Image frame must be enabled, unlocked and visible.</p>\n<h3>Cordially, the developer who answers his self!</h3>\n"}], "owner": {"reputation": 53, "user_id": 6220465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ebe65e09b967bdb32f1b1a6fc488c2?s=128&d=identicon&r=PG&f=1", "display_name": "Victor.L", "link": "https://stackoverflow.com/users/6220465/victor-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 39762807, "answer_count": 1, "score": 0, "last_activity_date": 1475130105, "creation_date": 1473857991, "question_id": 39491112, "link": "https://stackoverflow.com/questions/39491112/display-an-ole-object-from-a-table-in-a-word-doc-vba", "title": "Display an OLE Object from a table in a word doc [VBA]", "body": "<p>So I need to <strong>display a picture</strong> in a <strong>word doc</strong> at a <strong>bookmark</strong>. This picture is stored in a <strong>MS Access Database</strong> as an <strong>OLE Object</strong>.</p>\n\n<p>I know how to write at a bookmark</p>\n\n<pre><code>WordDoc.Bookmarks.Item(\"myBookmark\").Range.Text = value\n</code></pre>\n\n<p>And for the moment, here what i've done:</p>\n\n<pre><code>'xNum is the product number\nDim s As OLEObjects\nDim x As Integer\nDim rs As DAO.Recordset\nxSQL = \"SELECT stuff FROM table1 LEFT JOIN table2 ON table1.par = table2.par WHERE NumProduct=\" &amp; xNum\nSet rs = CurrentDb.OpenRecordset(xSQL)\ns = rs!stuff\nx = 1\nDo While Not rs.EOF\n       If x = 1 Then\n            '{Command to insert an OLE at a word's bookmark}\n       ElseIf x = 2 Then\n       ...\n       End If\n   rs.MoveNext\n   x = x + 1\nLoop\nrs.Close\n</code></pre>\n\n<p>Is there a solution to my problem?</p>\n\n<p><em>P.S: I'm a newbie on vba/Ms Access, but I made some C# (which looks a bit like vba)</em></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473922237, "post_id": 39491063, "comment_id": 66326355, "body": "<a href=\"http://stackoverflow.com/questions/20143262/excel-sequential-numbers-specified-start-and-end-values-shift-column-data-d\" title=\"excel sequential numbers specified start and end values shift column data d\">stackoverflow.com/questions/20143262/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473922638, "post_id": 39491063, "comment_id": 66326549, "body": "I got a code from this website that is close to what i want but the old serial numbers keep repeating any time i run a new serial numbers. The second code &quot;Sub sof20143262Serial_numbers()&quot;"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473973314, "post_id": 39491063, "comment_id": 66356299, "body": "Can you show a picture of what you&#39;re trying to achieve or anything? I just don&#39;t know how to help you.. <a href=\"http://stackoverflow.com/questions/39360611/vba-code-to-auto-serial-number-in-column-a-after-my-userform-entered-data-in-col/39376327#39376327\">This is an answer</a> that I did for someone who had a question regarding building serial numbers with strings, maybe you can tailor it to meet your needs or further describe what parts of it you can&#39;t get to work for you."}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1474011110, "post_id": 39491063, "comment_id": 66367123, "body": "It does not. I have updated with screen shot of what i want to achieve. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474039633, "post_id": 39534893, "comment_id": 66384397, "body": "Gives compile error, object required at line 6 &quot;Set lastRow = ws.Cells(ws.Rows.Count, &quot;E&quot;).End(xlUp).Row + 1&quot;"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474042881, "post_id": 39534893, "comment_id": 66386301, "body": "@eka24 I fixed the code, try the updated code in my answer. (I&#39;m at my computer now and was able to test it)"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474100685, "post_id": 39534893, "comment_id": 66401803, "body": "It run and produced the result but old range serial numbers keep repeating. I want the code to avoid running old number that has been run already. example if i have 11-13 which produces 11, 12, 13. when i enter another range like 101-103, it should give 11, 12, 13, 101, 102, 103. but as the code stands, it gives 11, 12, 13, 11, 12, 13,101, 102, 103, repeating already produced serial numbers. The serial numbers are unique and cannot be run twice. it should run current range if range has been run already. Thanks for your effort so far Tyeler"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474145477, "post_id": 39534893, "comment_id": 66414805, "body": "@eka24 I&#39;m not sure how it would run repeating numbers.. The For loop only goes through the cells once, and the line <code>ws.Range(&quot;E2&quot;, ws.Cells(ws.Rows.Count, &quot;F&quot;).End(xlUp)).Clear</code> deletes all the original results prior to the code running. Does it only repeat the first instance? I can&#39;t seem to recreate what you&#39;re talking about on my side.."}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474146765, "post_id": 39534893, "comment_id": 66415123, "body": "well i will manage it like that by manually deleting the old range which repeats when new range is run. Thanks very much"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474146903, "post_id": 39534893, "comment_id": 66415163, "body": "Well.. I would like to answer your question if you can help me understand it better..."}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474180510, "post_id": 39534893, "comment_id": 66420860, "body": "Please run 11-13. After that enter another range 20-23. Do not put both ranges before you run the code. You will get 11, 12, 13, 11, 12, 13, 20, 21, 22, 23 which is wrong because i dont expect duplicates. I expect this result; 11, 12, 13, 20, 21, 22, 23. run the first range 11-13. later, enter the second range 20-21 without deleting the first range 11-13 you entered."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474251148, "post_id": 39534893, "comment_id": 66439390, "body": "@eka24 Okay! I rewrote a couple portions of the code, and threw in an overflow error preventer via <code>If statement</code>. The updated code is in my answer. Let me know if any part of this isn&#39;t doing what you think it should. This should get you started on a final product. I believe this also answers the question entirely, so if you could mark it as such that&#39;d be great!"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474268953, "post_id": 39534893, "comment_id": 66444688, "body": "Exactly what am looking for. Great work Tyeler, thanks"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474452547, "post_id": 39534893, "comment_id": 66534008, "body": "sorry for coming back. I get overflow error for 6 digit numbers like 333901. it works for less digit serial numbers like 21. Any help to avoid the overflow error for big numbers?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474460561, "post_id": 39534893, "comment_id": 66539298, "body": "Yes. The reason you&#39;re getting an overflow is because <code>CInt()</code> can only handle -32768 to 32767. To avoid that, change <code>startOf</code> and <code>endOf</code> to Long, and change <code>CInt</code> to <code>CLng</code>. I&#39;ve updated the code to reflect this change if you want to see where I&#39;m talking about."}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1474462725, "post_id": 39534893, "comment_id": 66540850, "body": "Thanks, is working"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1476435965, "post_id": 39534893, "comment_id": 67354258, "body": "Please is there a way allow a single number like 566163 to be added to the list of numbers generated. currently if the numbers are not in a range like 555666-600001 the code will not accept."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1476447226, "post_id": 39534893, "comment_id": 67361414, "body": "There&#39;s a very simple way to do that without changing the code at all. Just make your starting number and ending numbers the same. So for your example, Starting No would be 566163 and Ending No would be 566163. That will put just a single number with it&#39;s data to your list."}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1476450595, "post_id": 39534893, "comment_id": 67363771, "body": "ok thanks you  very much"}, {"owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1485371918, "post_id": 39534893, "comment_id": 70903502, "body": "Please the code above works perfectly in excel as I requested. I need help on how to use same procedure in access. Thus what would be the access vba for the same procedure of generating serial numbers based on a given range."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "edited": false, "score": 0, "creation_date": 1485631444, "post_id": 39534893, "comment_id": 71009047, "body": "I wish I could tell you but I&#39;m only familiar with using Excel"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1474460630, "last_edit_date": 1474460630, "creation_date": 1474038855, "answer_id": 39534893, "question_id": 39491063, "link": "https://stackoverflow.com/questions/39491063/excel-vba-code-to-generate-serial-numbers-from-a-range/39534893#39534893", "title": "EXCEL VBA Code to generate serial numbers from a range", "body": "<p>Try this out and let me know if it works for you.. This will provide you with the results shown in your picture. </p>\n\n<pre><code>    Sub SerialCode()\n    Dim ws As Worksheet\n    Dim startOf As Long, endOf As Long, data 'startOf and endOf are Long for &gt;5 digits.\n    Dim lastRow As Long, currentRow As Long\n    Dim dataRange As Range, c As Range\n\n    Set ws = ThisWorkbook.Sheets(1)\n    ws.Range(\"E2\", ws.Cells(ws.Rows.Count, \"E\").End(xlUp)).Clear\n    ws.Range(\"F2\", ws.Cells(ws.Rows.Count, \"F\").End(xlUp)).Clear\n    lastRow = 2\n    Set dataRange = ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n\n\n    For Each c In dataRange\n        If c.Value &lt;&gt; \"\" Then\n            currentRow = c.Row\n            startOf = CLng(ws.Range(\"A\" &amp; currentRow).Value)\n            endOf = CLng(ws.Range(\"B\" &amp; currentRow).Value) + 1\n\n            If endOf &lt;&gt; 1 And startOf &lt; endOf Then 'This will stop Overflow errors from occuring accidently\n                data = ws.Range(\"C\" &amp; currentRow).Value\n\n                Do While startOf &lt;&gt; endOf\n                    ws.Range(\"E\" &amp; lastRow).Value = startOf\n                    ws.Range(\"F\" &amp; lastRow).Value = data\n                    startOf = startOf + 1\n                    lastRow = lastRow + 1\n                Loop\n\n            Else: MsgBox \"Ending Serial Number missing or is less than starting Serial Number on row \" _\n                &amp; c.Row, vbCritical, \"Missing Data\"\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6827066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65fc61a68b4243a1ff3036801470d336?s=128&d=identicon&r=PG&f=1", "display_name": "eka24", "link": "https://stackoverflow.com/users/6827066/eka24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2243, "favorite_count": 0, "closed_date": 1475238950, "accepted_answer_id": 39534893, "answer_count": 1, "score": -6, "last_activity_date": 1474460630, "creation_date": 1473857895, "last_edit_date": 1531164843, "question_id": 39491063, "link": "https://stackoverflow.com/questions/39491063/excel-vba-code-to-generate-serial-numbers-from-a-range", "closed_reason": "Needs more focus", "title": "EXCEL VBA Code to generate serial numbers from a range", "body": "<p><a href=\"http://i.stack.imgur.com/JWiHG.png\" rel=\"nofollow\">enter image description here</a>Please i am new to Vba. </p>\n\n<ol>\n<li><p>Please I want a VBA that generates serial numbers from data entered in A1 and B2. The result should be in another sheet Column A.</p></li>\n<li><p>When I enter another range in A2 and B2, the serial numbers should continue at where the first serial numbers ended.</p>\n\n<p>Inline image</p></li>\n</ol>\n\n<p>thank you</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 1206, "user_id": 2676140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/28c2b7445b21c07765a3a7d603655b6f?s=128&d=identicon&r=PG&f=1", "display_name": "user2676140", "link": "https://stackoverflow.com/users/2676140/user2676140"}, "edited": false, "score": 0, "creation_date": 1473857686, "post_id": 39490697, "comment_id": 66299465, "body": "What version of Excel?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473880768, "post_id": 39491559, "comment_id": 66313708, "body": "I use 2007, the code is only work for first two cells(A1. A2), is there anything to be changed.?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473882081, "post_id": 39491559, "comment_id": 66314361, "body": "I&#39;m also using 2007.  Is the column formatted as text?  IF you provide a download link, I&#39;ll get it working for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473886764, "post_id": 39491559, "comment_id": 66316681, "body": "You would need to use a  service like Dropbox or Google Drive to host the file.  You could email tistackmail@gmail.com"}, {"owner": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473887341, "post_id": 39491559, "comment_id": 66316918, "body": "Thanks, hope you got the file"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473889717, "post_id": 39491559, "comment_id": 66317840, "body": "@Kuma Can you resend the file."}, {"owner": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "edited": false, "score": 0, "creation_date": 1473967265, "post_id": 39491559, "comment_id": 66353281, "body": "Hope you got it. Thank you"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1473859178, "creation_date": 1473859178, "answer_id": 39491559, "question_id": 39490697, "link": "https://stackoverflow.com/questions/39490697/tag-cell-value-based-on-text-and-symbol/39491559#39491559", "title": "Tag cell value based on text and symbol", "body": "<p>Assuming that the last character in the cell should be ignored if it is not a number: </p>\n\n<pre><code>Sub FindDuplicates()\n    Dim v As Variant\n    Dim LastRow As Long, x As Long\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For x = 1 To LastRow                          ' 1 set the start of the dup looks\n        If Cells(x, 1) &lt;&gt; \"\" Then\n\n            v = IIf(IsNumeric(Right(Cells(x, 1), 1)), Cells(x, 1), Left(Cells(x, 1), Len(Cells(x, 1)) - 1))\n            Cells(x, \"J\") = IIf(Application.Match(v, Range(\"A1:A\" &amp; LastRow), 0) &gt; 1, \"E\", \"Duplicate\")\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9b3LT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9b3LT.jpg\" alt=\"Find Duplicates\"></a></p>\n"}], "owner": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473864407, "creation_date": 1473856828, "last_edit_date": 1473864407, "question_id": 39490697, "link": "https://stackoverflow.com/questions/39490697/tag-cell-value-based-on-text-and-symbol", "title": "Tag cell value based on text and symbol", "body": "<p>I have will have following values in Column A; \nA1: 11/5, A2: 11/5R,A3:11/6, A4:11/7, A5:11/5$, A6: 11/5</p>\n\n<p>I want to mark these cells as duplicates in Column 10 if the numbers are same without considering the end symbol: Ex: A1, A2, A5, A6 are duplicates and should mark in Col J1, J2, J5, and J6. </p>\n\n<p>Following code is working only for numbers. it is not accounting the end symbols of the cell value. Any suggestions to modify the code to get the desired output are appreciated. </p>\n\n<pre><code>Sub FindDuplicates()\n\nDim LastRow As Long, matchFoundIndex As Long, iCntr As Long\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor iCntr = 1 To LastRow             ' 1 set the start of the dup looks\n    If Cells(iCntr, 1) &lt;&gt; \"\" Then\n        matchFoundIndex = WorksheetFunction.Match(Cells(iCntr, 1), Range(\"A1:A\" &amp;    LastRow), 0)\n        If iCntr &lt;&gt; matchFoundIndex Then\n             Cells(iCntr, 10) = \"Duplicate\"\n        Else\n             Cells(iCntr, 10) = \"E\"\n        End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "ms-access", "locale"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473856445, "post_id": 39490522, "comment_id": 66298642, "body": "When you say a <i>double</i>  value are you talking about two values e.g (5 and 8) or is the comma the decimal separator?"}, {"owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473856492, "post_id": 39490522, "comment_id": 66298670, "body": "comma is the decimal"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1473856583, "post_id": 39490522, "comment_id": 66298732, "body": "Ah, ok.... was just checking the obvious. :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473856824, "post_id": 39490522, "comment_id": 66298895, "body": "try cdbl(double_variable)"}, {"owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "edited": false, "score": 0, "creation_date": 1473856842, "post_id": 39490522, "comment_id": 66298904, "body": "If i for example set double_variable = 5, and send it. it works fine. but if i set it to = 5.8, it bugs out. even tho the table is set to recieve double, doesnt matter if decimals is set to auto or 1"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473856878, "post_id": 39490522, "comment_id": 66298925, "body": "try debug.? typename(double_variable) also"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473857527, "post_id": 39490522, "comment_id": 66299351, "body": "@J.Chomel: please don&#39;t reject edits that change a wrong tag into the correct one. <a href=\"http://stackoverflow.com/tags/access/info\">stackoverflow.com/tags/access/info</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "edited": false, "score": 0, "creation_date": 1473857214, "post_id": 39490760, "comment_id": 66299154, "body": "Even if i define a variable named double_variable As Double, set it to double_variable = 5.8,  and then send it, it still throws the error. If i however set it to double_variable = 5, it works fine."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "edited": false, "score": 0, "creation_date": 1473857290, "post_id": 39490760, "comment_id": 66299202, "body": "You need the full expression (Replace , -&gt; .) @Arne"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "edited": false, "score": 0, "creation_date": 1473857631, "post_id": 39490760, "comment_id": 66299429, "body": "@Arne did you try my suggestion? I added a little more explanation."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 3, "last_activity_date": 1473857854, "last_edit_date": 1473857854, "creation_date": 1473857006, "answer_id": 39490760, "question_id": 39490522, "link": "https://stackoverflow.com/questions/39490522/inserting-single-double-type-to-db-using-vba-in-access/39490760#39490760", "title": "Inserting Single/double type to DB using VBA in access", "body": "<p>I assume that you want a dot as decimal separator in your string.</p>\n\n<p>The conversion from double to string is done using the separator from the system locale settings so in your case a comma. </p>\n\n<p>This means that</p>\n\n<pre><code>double_variable = 5.8\nsql = \"... \" &amp; double_variable &amp; \" ...\"\n</code></pre>\n\n<p>will produce <code>... 5,8 ...</code> in the sql variable.\nThe easiest way to fix that is to use</p>\n\n<pre><code>\"...\" &amp; Replace(CStr(double_variable), \",\", \".\") &amp; \"...\"\n</code></pre>\n\n<p>This will replace all <code>,</code> with <code>.</code>. I put the <code>CStr</code> there to make sure it gets converted to a string first. It will also work if the system locale changes since nothing will happen if there is no <code>,</code>. The only caveat is that if for some reason the conversion inserts 1000s separators it will fail but that would only be relevant in other circumstances as I don't think <code>CStr</code> will ever do that.</p>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1473875834, "post_id": 39494346, "comment_id": 66311121, "body": "Wow. I was totally not aware of this. Thanks!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1473866980, "creation_date": 1473866980, "answer_id": 39494346, "question_id": 39490522, "link": "https://stackoverflow.com/questions/39490522/inserting-single-double-type-to-db-using-vba-in-access/39494346#39494346", "title": "Inserting Single/double type to DB using VBA in access", "body": "<p>The current answer is not the easiest, neither the simplest.</p>\n\n<p>The universal method is to use <em>Str</em> as it always returns a dot as the decimal separator:</p>\n\n<pre><code>sql = \"UPDATE DBNAME SET Double_Field = \" &amp; Str(double_Variable) &amp; \" WHERE ID = \" &amp; id &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2930442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i6zov.jpg?s=128&g=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/2930442/arne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 39490760, "answer_count": 2, "score": 2, "last_activity_date": 1473866980, "creation_date": 1473856203, "last_edit_date": 1473857236, "question_id": 39490522, "link": "https://stackoverflow.com/questions/39490522/inserting-single-double-type-to-db-using-vba-in-access", "title": "Inserting Single/double type to DB using VBA in access", "body": "<p>I need some help with an issue that is doing my head in.\nI need to update a database in access and its been working fine operating with Long and Integers.</p>\n\n<p>Look at this code. </p>\n\n<pre><code>sql = \"UPDATE DBNAME SET Long_Field = \" &amp; Long_Variable &amp; \" WHERE ID = \" &amp; id\nDoCmd.SetWarnings (False)\nDoCmd.RunSQL sql\n</code></pre>\n\n<p>This code runs flawlessly, it takes a long variable and puts it into the correct field which is set as Long.</p>\n\n<p>However, if I want to populate a single/double field (ive tried both)</p>\n\n<pre><code>sql = \"UPDATE DBNAME SET Double_Field = \" &amp; double_Variable &amp; \" WHERE ID= \" &amp; id\nDoCmd.SetWarnings (False)\nDoCmd.RunSQL sql\n</code></pre>\n\n<p>I keep getting Run-Time error 3144: Syntax error in update statement.\nI can literally just switch out the field name and the variable name and the code runs flawlessly, but as soon as i try to send a double value, for example (5,8), to a field in the table that is set to double, it gives me this error.</p>\n\n<p>Anyone?</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1473856249, "post_id": 39490488, "comment_id": 66298523, "body": "You need to loop backward if you&#39;re deleting rows."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1473856384, "post_id": 39490488, "comment_id": 66298605, "body": "Like Comintern said <code>For i = N To 2 Step -1</code>"}, {"owner": {"reputation": 99, "user_id": 6809333, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/NqORD.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6809333/josh"}, "edited": false, "score": 0, "creation_date": 1473857271, "post_id": 39490488, "comment_id": 66299192, "body": "Thank you for the tip! I never thought about it that way. I have seemed to get it working perfect! Please submit your simple response as an answer and I&#39;ll reward you points!"}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "edited": false, "score": 0, "creation_date": 1473857478, "post_id": 39490640, "comment_id": 66299310, "body": "The point is that deleting rows in a loop will shift the items causing you to &#39;miss&#39; some iterations. When deleting items from the looped items list always loop in reverse."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "edited": false, "score": 0, "creation_date": 1473857948, "post_id": 39490640, "comment_id": 66299664, "body": "I agree that in nearly all circumstances you should loop in reverse but not <i>always</i> - there&#39;s certain exceptions"}, {"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "edited": false, "score": 0, "creation_date": 1473858360, "post_id": 39490640, "comment_id": 66299955, "body": "Sure there are always exceptions, but best practice -in VBA that reads to always- loop in reverse when deleting items from the collection you are iterating over. Take it from me, this is one of the top mistakes made by people starting to develop against the Office Object Model. So be careful teaching starting Office developers to do otherwise."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "edited": false, "score": 0, "creation_date": 1473858466, "post_id": 39490640, "comment_id": 66300030, "body": "Point taken @MaartenvanStam"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": -1, "last_activity_date": 1473856629, "creation_date": 1473856629, "answer_id": 39490640, "question_id": 39490488, "link": "https://stackoverflow.com/questions/39490488/vba-for-loop-iteration-issue/39490640#39490640", "title": "VBA For loop iteration issue", "body": "<p>Change <code>For i = 2 To N</code> to <code>Do until i &gt; N</code> and <code>Next i</code> to <code>Loop</code> (don't forget to assign <code>i = 2</code> beforehand) and then comment the line below the delete row</p>\n"}, {"tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": false, "score": 0, "last_activity_date": 1473857277, "creation_date": 1473857277, "answer_id": 39490860, "question_id": 39490488, "link": "https://stackoverflow.com/questions/39490488/vba-for-loop-iteration-issue/39490860#39490860", "title": "VBA For loop iteration issue", "body": "<p>First question was answered by Comintern and Shai Rado in the comments:</p>\n\n<p>Always loop through items in reverse as deleting items from the range will shift the remaining items back. By reverse looping the deleted items won't affect the remaining items.</p>\n\n<p>Second question, to speed things up, read this blog post:</p>\n\n<p><a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices\" rel=\"nofollow\">https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/</a></p>\n\n<p>and especially the part under:\nRead/Write Large Blocks of Cells in a Single Operation</p>\n\n<p>It will be a -lot- faster if you process your data in Arrays, read and write back the data into an array as shown in the example in this blog. Especially with thousands of items this will be significant!</p>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 6560695, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209655779652483/picture?type=large", "display_name": "Ben Romano", "link": "https://stackoverflow.com/users/6560695/ben-romano"}, "is_accepted": true, "score": 0, "last_activity_date": 1473858937, "last_edit_date": 1495541342, "creation_date": 1473858937, "answer_id": 39491463, "question_id": 39490488, "link": "https://stackoverflow.com/questions/39490488/vba-for-loop-iteration-issue/39491463#39491463", "title": "VBA For loop iteration issue", "body": "<p>To solve the first problem you could run your loop in reverse. That way a deletion only shifts rows which have already been iterated over.</p>\n\n<pre><code>For i = N To 2 Step -1\n</code></pre>\n\n<p>The second question is a bit open ended. This guide has a few suggestions on how to make your code faster: </p>\n\n<p><a href=\"http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/\" rel=\"nofollow noreferrer\">http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/</a> </p>\n\n<p>A few items from the guide that stand out the most to me related to your code.</p>\n\n<ul>\n<li>\"Disable Sheet Screen Updating\" </li>\n</ul>\n\n<p>Place the following around your code, especially if you anticipate a lot of the rows being deleted.</p>\n\n<pre><code>    Application.ScreenUpdating = False\n    Application.ScreenUpdating = True\n</code></pre>\n\n<ul>\n<li>\"Avoid Excessive Trips to the Worksheet\"</li>\n</ul>\n\n<p>This would be best accomplished by reading columns \"AB\" and \"AE\" into an array, and iterating through it rather than cells on the sheet. Here is a solution to accomplish that:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11504024/fastest-way-to-read-a-column-of-numbers-into-an-array\">Fastest way to read a column of numbers into an array</a></p>\n\n<pre><code>Dim Ar as Variant\n\nAr = Sheets(\"Sheet\").Range(\"A1:A10000\").Value\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 6809333, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/NqORD.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6809333/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 39491463, "answer_count": 3, "score": 0, "last_activity_date": 1473858937, "creation_date": 1473856112, "last_edit_date": 1531164843, "question_id": 39490488, "link": "https://stackoverflow.com/questions/39490488/vba-for-loop-iteration-issue", "title": "VBA For loop iteration issue", "body": "<p>In the code below, I am trying to check 2 date values. If they exist, calculate the days between in column BG. If they don't exist or result is less than 0 then delete the row. </p>\n\n<p>The issue I am having is that once it deletes, a row, it uses Next I, and skips the row directly after it. Ex: row 1 &amp; 2 are missing a date. row 1 gets deleted. row 2 gets pushed up to row 1. then next i, so we are on row 2 now(which was 3) and skips row 2's results. Using i=i-1 seems to crash my program. Also, is there any further way to make my code efficent so that it can iterate through thosands of items faster?</p>\n\n<pre><code>Sub Func4()\n\nDim N As Long, i As Long, j As Long, cnt As Long, date1 As Date, date2 As Date, date3 As Long ', iold As Long\n\nN = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nj = 2\ncnt = 0\nFor i = 2 To N 'main\n    j = j + 1\n    'iold = i\n    If Not IsEmpty(Cells(i, \"AB\").Value) And Not IsEmpty(Cells(i, \"AE\").Value) Then\n        date1 = Cells(i, \"AB\").Value 'AB=Entry Date\n        date2 = Cells(i, \"AE\").Value 'AE=Rec'd\n        date3 = Work_Days(date2, date1)\n        cnt = cnt + 1\n\n        If date3 &gt;= 0 Then\n            Cells(i, \"BG\").Value = date3\n\n        Else\n            Rows(i).EntireRow.Delete\n            'i = i - 1 'HERE\n        End If\n    Else\n        Rows(i).EntireRow.Delete\n        'i = i - 1 'HERE\n    End If\n\n    'End If\n    'If i = iold Then\nNext i\n\n'Else\n'Next\n'End If\n\nEnd Sub\n</code></pre>\n\n<p>RESOLVED WORKING ANSWER:</p>\n\n<pre><code>Sub Func4()\n   Dim N As Long, i As Long, j As Long, cnt As Long, date1 As Date, date2 As Date, date3 As Long\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    j = 2\n    For i = N To 2 Step -1\n            j = j + 1\n\n        If Not IsEmpty(Cells(i, \"AB\").Value) And Not IsEmpty(Cells(i, \"AE\").Value) Then\n            date1 = Cells(i, \"AB\").Value 'AB=Entry Date\n            date2 = Cells(i, \"AE\").Value 'AE=Rec'd\n            date3 = Work_Days(date2, date1)\n            cnt = cnt + 1\n                If date3 &gt;= 0 Then\n                    Cells(i, \"BG\").Value = date3\n\n                Else\n                    Rows(i).EntireRow.Delete\n                 End If\n        Else\n        Rows(i).EntireRow.Delete\n        End If\n        Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1473863478, "post_id": 39490465, "comment_id": 66303648, "body": "try <code>PN_value = Sheets(&quot;Panel&quot;).Range(&quot;E10&quot;).Text</code>. Also ensure that <code>PN_value</code> is a <code>String</code> type variable."}, {"owner": {"reputation": 21, "user_id": 6830818, "user_type": "registered", "profile_image": "https://graph.facebook.com/1195616257147859/picture?type=large", "display_name": "Gabriel Homoly", "link": "https://stackoverflow.com/users/6830818/gabriel-homoly"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1474000832, "post_id": 39490465, "comment_id": 66363071, "body": "Thank you very much Scott, It works fine in this way!"}], "owner": {"reputation": 21, "user_id": 6830818, "user_type": "registered", "profile_image": "https://graph.facebook.com/1195616257147859/picture?type=large", "display_name": "Gabriel Homoly", "link": "https://stackoverflow.com/users/6830818/gabriel-homoly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473863333, "creation_date": 1473856038, "last_edit_date": 1531164843, "question_id": 39490465, "link": "https://stackoverflow.com/questions/39490465/assigning-activecell-value-to-a-variable-preserving-0-prefix", "title": "Assigning ActiveCell value to a variable preserving 0 prefix", "body": "<p>I have started to program a macro where I would need to assign a part number (PN) of a product to a variable for a later search:</p>\n\n<pre><code>Sheets(\"Panel\").Activate\nRange(\"E10\").Select\nPN_value = ActiveCell.Value\n</code></pre>\n\n<p>The above statements work fine, except in the case of zero prefix ( i.e. 01200946 ) the assigned value to the variable cuts the first zero and then the compare of the read out PNs in a loop with this variable is not working properly.</p>\n\n<p>I have found some advice for hard formatting as \"00000000\" for similar cases but unfortunatelly my master data file does not contain PNs with all the same lengths and in the future some PNs might have mixed char&amp;num format. So if possible I would need some way to assign the exact value of the cell to the variable rather than force in advance some fixed format. </p>\n"}, {"tags": ["regex", "vba", "vbscript", "macros", "ms-word"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473856386, "post_id": 39490458, "comment_id": 66298607, "body": "Are you looking for the index of the whole match? Just use <code>match(0).FirstIndex</code>. You do not need to even check <code>Submatches</code>."}, {"owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473856718, "post_id": 39490458, "comment_id": 66298821, "body": "No I need to get index of every submatched string"}, {"owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473857092, "post_id": 39490458, "comment_id": 66299058, "body": "I have added more details in my post."}], "answers": [{"comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473858280, "post_id": 39491174, "comment_id": 66299903, "body": "What if there are multiple matches and the substring appears several times in the input string?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473858566, "post_id": 39491174, "comment_id": 66300091, "body": "@WiktorStribi\u017cew - That would match the behavior of <code>.FirstIndex</code>, although this does assume that the groups will return unique matches."}, {"owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "edited": false, "score": 0, "creation_date": 1473859299, "post_id": 39491174, "comment_id": 66300598, "body": "Even FirstIndex will return only first occurrence of matched string?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "edited": false, "score": 0, "creation_date": 1473859393, "post_id": 39491174, "comment_id": 66300667, "body": "@Learning - Yep. It returns a <code>Long</code>, so it can <i>only</i> return one results - it returns the first."}, {"owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "edited": false, "score": 0, "creation_date": 1473859525, "post_id": 39491174, "comment_id": 66300752, "body": "Oh! So, If string has duplicates, which would be the effective way to get position of strings?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "edited": false, "score": 0, "creation_date": 1473860575, "post_id": 39491174, "comment_id": 66301525, "body": "@Learning - It depends on the pattern.  For example, <code>(foo)(bar)?</code> can never have duplicate submatches.  If you&#39;re matching something like <code>foo</code> in &quot;foobarfoobar&quot;, you&#39;d get 2 <i>matches</i>, each with one submatch.  Note that if you have nested groups, i.e. <code>foo(b(az|ar))</code>, you would need to make the inner groups non-capturing with this solution."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 5, "last_activity_date": 1473859145, "last_edit_date": 1473859145, "creation_date": 1473858160, "answer_id": 39491174, "question_id": 39490458, "link": "https://stackoverflow.com/questions/39490458/how-to-get-the-position-of-submatches-in-vba/39491174#39491174", "title": "How to get the position of submatches in VBA?", "body": "<p>You can't apply <code>.FirstIndex</code> to <code>SubMatches(x)</code> because it returns a <code>String</code>, not a <code>Match</code>. If the groups will return unique matches, you can find its location by simply using the <code>Instr</code> function:</p>\n\n<pre><code>With CreateObject(\"VBScript.RegExp\")\n    .Pattern = Find\n    If .Test(text) Then\n        Set match = .Execute(text)\n        Debug.Print InStr(1, text, match(0).SubMatches(0)) '0\n        Debug.Print InStr(1, text, match(0).SubMatches(5)) '16\n        'and so on\n    End If\nEnd With\n</code></pre>\n\n<p>If the groups will <em>not</em> return unique results, you can track the position of the last match and loop through the results.  Note that <code>VBScript.RegExp</code> doesn't support look-behinds, so you don't have to take the length of the matches into account:</p>\n\n<pre><code>With CreateObject(\"VBScript.RegExp\")\n    .Pattern = find\n    If .Test(text) Then\n        Set match = .Execute(text)\n        Dim i As Long, pos As Long, found As String\n        pos = 1\n        For i = 0 To match(0).SubMatches.Count - 1\n            found = match(0).SubMatches(i)\n            pos = InStr(pos, text, match(0).SubMatches(i)) \n            Debug.Print found, pos\n        Next\n    End If\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "edited": false, "score": 0, "creation_date": 1473859960, "post_id": 39491348, "comment_id": 66301071, "body": "Thank you ! I dint know this."}], "tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": false, "score": 3, "last_activity_date": 1473858659, "creation_date": 1473858659, "answer_id": 39491348, "question_id": 39490458, "link": "https://stackoverflow.com/questions/39490458/how-to-get-the-position-of-submatches-in-vba/39491348#39491348", "title": "How to get the position of submatches in VBA?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/y27d2s18(v=vs.84).aspx\" rel=\"nofollow\">Submatches collection</a> contains strings:</p>\n\n<blockquote>\n  <p>A SubMatches collection contains individual submatch strings, ...</p>\n  \n  <p>Each item in the SubMatches collection is the string found and\n  captured by the regular expression.</p>\n</blockquote>\n\n<p>So you can't get the positions/indices.</p>\n"}], "owner": {"reputation": 798, "user_id": 4539819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LFZS2.jpg?s=128&g=1", "display_name": "Learning", "link": "https://stackoverflow.com/users/4539819/learning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7415, "favorite_count": 0, "accepted_answer_id": 39491174, "answer_count": 2, "score": 1, "last_activity_date": 1473859145, "creation_date": 1473856001, "last_edit_date": 1473856850, "question_id": 39490458, "link": "https://stackoverflow.com/questions/39490458/how-to-get-the-position-of-submatches-in-vba", "title": "How to get the position of submatches in VBA?", "body": "<p>I need to get the index position value of submatched string. As per documentation, I have read through this <a href=\"https://www.experts-exchange.com/articles/1336/Using-Regular-Expressions-in-Visual-Basic-for-Applications-and-Visual-Basic-6.html\" rel=\"nofollow\">Regular expression</a> and got to know <code>FirstIndex</code> property to get the position of matched string.</p>\n\n<p>But this works only for one dimensional matched string. I couldn't apply <code>FirstIndex</code> for submatches.\nPls refer <a href=\"https://www.myregextester.com/?r=c10fb2e1\" rel=\"nofollow\">sample matches</a></p>\n\n<p>I tried this format,</p>\n\n<pre><code>        Dim myRegExp As Object, match As MatchCollection            \n        Dim matched As String\n        Set myRegExp = CreateObject(\"VBScript.RegExp\")\n        myRegExp.pattern = find\n        If myRegExp.test(text) = True Then\n        Set match = myRegExp.Execute(text)          \n        Debug.Print match(0).submatches(0) '' this is matched string\n</code></pre>\n\n<p>Where should I call <code>FirstIndex</code> to get position of submatched string </p>\n\n<p>output:</p>\n\n<pre><code>match(0)=&gt;Berry, Brent. (2006). What accounts for race and ethnic differences in  Berry, \nBrent. parental financial transfers to adult children in the United States? Journal of Family\nIssues 37:1583-1604.   \n\nsubmatches(0)=&gt;Berry, Brent.\nsubmatches(6)=&gt;2006\n</code></pre>\n\n<p>EXPECTED OUTPUT:</p>\n\n<pre><code>submatches(0) at 0th position\nsubmatches(6) at 16th position and so on\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros", "powerpoint"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1473856753, "post_id": 39490411, "comment_id": 66298842, "body": "Does it behave any differently when an instance of Excel is open?"}, {"owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 1, "creation_date": 1473859899, "post_id": 39490411, "comment_id": 66301021, "body": "It gives me the same error.  Even if I open the designated file under FileName is still gives me the same error."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1473862867, "post_id": 39490411, "comment_id": 66303187, "body": "I just tried by starting PowerPoint 2016, creating a new PowerPoint file, opening the VBE, adding a reference to the Microsoft Excel 16.0 Object Library (will you be using recommended late binding technique after completing debugging?) and then adding your code with a path to a known Excel file and it worked. This is my MSO version : 2016, 32 bit, 365, 16.0.7167.2060 / 16.0.7127.1026 (no idea why the versions are different in the backstage and About UIs)"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1473866009, "post_id": 39490411, "comment_id": 66305463, "body": "Have you tried starting Excel manually and opening the file as you would any other file?  Recent versions of Office &quot;protect&quot; us from various evils like files that came from (<b>GASP</b>) the internet.  If you can open the file normally (ie, via File | Open and browse to the file) then you&#39;ve ruled out MSNanny as the culprit.  If the file won&#39;t open normally, rightclick it, choose Properties, see if there&#39;s an UNBLOCK button at bottom of General tab.  If so, click it and then try again (via File | Open and then via your code)"}, {"owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "edited": false, "score": 0, "creation_date": 1473867822, "post_id": 39490411, "comment_id": 66306691, "body": "Thanks for the information Jamie.  Apparently my error is then due to something with the excel file that I&#39;m trying to reference.  I just removed all the macros from the referenced excel file and it opened as expected.  Maybe something in the file is corrupted... I&#39;ll let you know as I play around with it more.  Also I&#39;m not informed regarding late binding, so my guess is I will not use it."}, {"owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "edited": false, "score": 0, "creation_date": 1473871897, "post_id": 39490411, "comment_id": 66309067, "body": "Steve - Weird, when I open the file by double clicking it opens fine.  When I do as you instructed and open it from File | Open from a new instance of excel it gives me the following: &quot;Excel found unreadable content in &#39;FILENAME&#39;.  Do you want to recover the contents of this workbook?  If you trust the source of this workbook, click Yes.&quot;  When I click yes it then deletes all the modules/VBA."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1473884411, "post_id": 39490411, "comment_id": 66315513, "body": "Check your File | Options | Trust Center settings.  There might be a setting that&#39;s keeping the file from opening programmatically."}, {"owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "edited": false, "score": 0, "creation_date": 1473948620, "post_id": 39490411, "comment_id": 66342377, "body": "I have been messing with the trust settings for a bit now to no avail.  Based on some goggling it may have to due with installation of a Visual Basic component from Microsoft 2010 (which would explain why it works in office 2010 but not 2016).  On a work computer at the moment so this may be an IT fix rather then any coding/workbook changes."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "edited": false, "score": 0, "creation_date": 1473871567, "post_id": 39494128, "comment_id": 66308884, "body": "I got the same error but in a msgbox.  &quot;Error Description: Method &#39;Open&#39; of object &#39;Workbooks&#39; failed.  Note I edited your code to move the end sub and add a then to the if statement."}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "reply_to_user": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "edited": false, "score": 0, "creation_date": 1473871723, "post_id": 39494128, "comment_id": 66308972, "body": "What does it say?"}], "tags": [], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1473866331, "creation_date": 1473866331, "answer_id": 39494128, "question_id": 39490411, "link": "https://stackoverflow.com/questions/39490411/opening-an-excel-workbook-in-a-powerpoint-macro-error-1004/39494128#39494128", "title": "Opening an excel workbook in a powerpoint macro (ERROR 1004)", "body": "<p>Try </p>\n\n<pre><code>Sub testing()\n\non error goto errhandler\nExcel.Application.Workbooks.Open FileName:=\"PATH\\FILENAME\"\nEnd Sub\n\nerrhandler:\nif err.number = 1004\n    msgbox(\"Error Description: \" &amp; err.description)\nend if\n</code></pre>\n\n<p>and post what it says</p>\n"}], "owner": {"reputation": 19, "user_id": 6830845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c43ff88a3b5ea854a567a906d1fbe9?s=128&d=identicon&r=PG&f=1", "display_name": "moo5003", "link": "https://stackoverflow.com/users/6830845/moo5003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 831, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473866331, "creation_date": 1473855876, "question_id": 39490411, "link": "https://stackoverflow.com/questions/39490411/opening-an-excel-workbook-in-a-powerpoint-macro-error-1004", "title": "Opening an excel workbook in a powerpoint macro (ERROR 1004)", "body": "<p>I switched from office 2010 to office 2016 and I noticed the below VBA now gives an error 1004 (Method 'Open' of object 'Workbooks' failed).  I have confirmed this code works as intended in powerpoint 2010 but does not work in powerpoint 2016.  I was hoping someone could help me determine the cause.</p>\n\n<pre><code>Sub testing()\nExcel.Application.Workbooks.Open FileName:=\"PATH\\FILENAME\"\nEnd Sub\n</code></pre>\n\n<p>I have updated the Microsoft excel library reference to version 16.0 and I have tried some of the other ways to run the same command to no avail.  I'm convinced it has something to do with the library references.</p>\n\n<p>Thanks in advance for any suggestions you have.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473853933, "post_id": 39489641, "comment_id": 66297041, "body": "Looping through all sheets is not good ?"}, {"owner": {"reputation": 39, "user_id": 2845473, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/32bc486dbf38d22f6a47a51d184f0b13?s=128&d=identicon&r=PG&f=1", "display_name": "Pink Pink", "link": "https://stackoverflow.com/users/2845473/pink-pink"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473854169, "post_id": 39489641, "comment_id": 66297195, "body": "You mean it is good?? But here I need to write code 5 times.. so tring these way"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473855447, "post_id": 39489641, "comment_id": 66298016, "body": "see code in my answer below (don&#39;t think it&#39;s too long)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1473855072, "creation_date": 1473855072, "answer_id": 39490134, "question_id": 39489641, "link": "https://stackoverflow.com/questions/39489641/how-to-select-same-range-in-multiple-sheets-in-vba/39490134#39490134", "title": "How to select same Range in multiple sheets in VBA?", "body": "<p>Consider:</p>\n\n<pre><code>Sub Macro1()\n    Sheets(Array(\"STP1\", \"STP2\", \"STP3\", \"STP4\", \"STP5\")).Select\n    Sheets(\"STP1\").Activate\n    Range(\"D3\").Select\n    ActiveCell.Value = \"whatever\"\nEnd Sub\n</code></pre>\n\n<p><em>(but I would use a loop and no <code>Selects</code>)</em></p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 39, "user_id": 2845473, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/32bc486dbf38d22f6a47a51d184f0b13?s=128&d=identicon&r=PG&f=1", "display_name": "Pink Pink", "link": "https://stackoverflow.com/users/2845473/pink-pink"}, "edited": false, "score": 0, "creation_date": 1473920999, "post_id": 39490171, "comment_id": 66325809, "body": "@SwethaReddy you&#39;re welcome, thanks for accepting my answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1473855170, "creation_date": 1473855170, "answer_id": 39490171, "question_id": 39489641, "link": "https://stackoverflow.com/questions/39489641/how-to-select-same-range-in-multiple-sheets-in-vba/39490171#39490171", "title": "How to select same Range in multiple sheets in VBA?", "body": "<p>Is this code too long (looping through all Sheets), using a <code>Select Case</code> where you can add as many sheets as you like.</p>\n\n<p>(It is better to avoid selecting cells)</p>\n\n<pre><code>Option Explicit\n\nSub SelectSheets()\n\nDim Sht             As Worksheet\n\nFor Each Sht In ThisWorkbook.Sheets\n    Select Case Sht.Name\n        Case \"STP1\", \"STP2\", \"STP3\", \"STP4\", \"STP5\"\n\n            If Sht.Range(\"D3\") = \"\" Then\n                Sht.Range(\"D\" &amp; Sht.Cells(Sht.Rows.Count, \"D\").End(xlUp).Row).Value = Eng\n            Else\n                Sht.Range(\"D3\").Value = Eng\n            End If\n\n    End Select\n\nNext Sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2845473, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/32bc486dbf38d22f6a47a51d184f0b13?s=128&d=identicon&r=PG&f=1", "display_name": "Pink Pink", "link": "https://stackoverflow.com/users/2845473/pink-pink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2026, "favorite_count": 1, "accepted_answer_id": 39490171, "answer_count": 2, "score": 1, "last_activity_date": 1473855170, "creation_date": 1473853597, "last_edit_date": 1531164843, "question_id": 39489641, "link": "https://stackoverflow.com/questions/39489641/how-to-select-same-range-in-multiple-sheets-in-vba", "title": "How to select same Range in multiple sheets in VBA?", "body": "<p>I am having 4 Sheets, say...,</p>\n\n<pre><code> STP1\n STP2\n STP3\n STP4\n STP5\n</code></pre>\n\n<p>I want to update all D3 cells of all the 5 sheets at same time.</p>\n\n<p>I am trying in this way..,</p>\n\n<pre><code>  Worksheets(Array(\"STP1\", \"STP2\", \"STP3\", \"STP4\", \"STP5\")).Select\n  Worksheets(Array(\"STP1\", \"STP2\", \"STP3\", \"STP4\",   \"STP5\")).Range(\"D3\").Select\n  If Worksheets(Array(\"STP1\", \"STP2\", \"STP3\", \"STP4\", \"STP5\").Range(\"D3\").Offset(0, 0) = \"\" Then\n  Worksheets(Array(\"STP1\", \"STP2\", \"STP3\", \"STP4\", \"STP5\")).Range(\"D3\").Select.End(xlDown).Select\n  End If\n  ActiveCell.Offset(0, 0).Select\n  ActiveCell.Value = Eng\n</code></pre>\n\n<p>But this is not working out...\nCan anyone please help me here...</p>\n"}, {"tags": ["excel", "vba", "matlab"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473855836, "post_id": 39489345, "comment_id": 66298272, "body": "What have you tried? Can you post some code. Perhaps making a template would be a better approach. A quick look and it appears calculating the exact yield point isn&#39;t possible, however an estimate is. See this youtube video: <a href=\"https://www.youtube.com/watch?v=pNIvZyd5djQ\" rel=\"nofollow noreferrer\">youtube.com/watch?v=pNIvZyd5djQ</a>"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 4125883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd059d15a34d76c4decfde3c282bb0c0?s=128&d=identicon&r=PG&f=1", "display_name": "Diphtong", "link": "https://stackoverflow.com/users/4125883/diphtong"}, "is_accepted": false, "score": 1, "last_activity_date": 1473860806, "creation_date": 1473860806, "answer_id": 39492159, "question_id": 39489345, "link": "https://stackoverflow.com/questions/39489345/automating-identifying-yield-point-from-a-stress-strain-curve-within-vba/39492159#39492159", "title": "Automating identifying Yield Point from a Stress-Strain Curve within VBA", "body": "<p>Do a linear least square regression on the linear part of your strain-stress curve. You should use every data point in the linear part. Of course it is difficult to say where the linear part begins or ends. Maybe you know that the range from 10 MPa to 200 MPa is always linear. So you could just that part. </p>\n\n<p>You now have a parametric representation of the curve:</p>\n\n<pre><code>y = m * x\n</code></pre>\n\n<p>Where y is stress, x is strain and m is Young's modulus. The linear regression has dealt with the noise.</p>\n\n<p>Now shift the linear eqaution by some margin, say 0.5%. Compute the intersection between the shifted linear equation and the original data. This is the yield point. If you select a smaller margin, the computation will be more accurate, but less stable. You need to adjust the margin to the precision of your test setup.</p>\n"}], "owner": {"reputation": 11, "user_id": 6830589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e2113fc87d0eac79882e2e465af29?s=128&d=identicon&r=PG&f=1", "display_name": "agirling", "link": "https://stackoverflow.com/users/6830589/agirling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473860806, "creation_date": 1473852671, "last_edit_date": 1473857108, "question_id": 39489345, "link": "https://stackoverflow.com/questions/39489345/automating-identifying-yield-point-from-a-stress-strain-curve-within-vba", "title": "Automating identifying Yield Point from a Stress-Strain Curve within VBA", "body": "<p>I hope that someone can help.</p>\n\n<p>I have tensile test data, I can plot the data, however, I am looking to find a way of automating the process of identifying the yield point and the calculating of the elastic modulus. </p>\n\n<p>Every method I have come across has been to physical pick these points, this makes the process subjective, I am hoping to eliminate this.</p>\n\n<p>I want to write this in VBA and have my colleagues use the macro enable excel sheet to create consentient data points from tensile data. </p>\n\n<p>I have tried to calculating the gradient between each point and then using the differences to identify a yield point, however, the noise of the experimental data makes this impossible. I used a moving average to try and smooth the data, first using 5 points and then 10, but to no avail. </p>\n\n<p>I was hoping to use this yield point as the starting spot for calculating the mod, and thus I have become stuck. </p>\n\n<p>I am hoping that someone has got experience in this and can point me in the right direction, or give me some ideas to filter the data without applying a function to the data. </p>\n\n<p>I have experience in MATLAB so if anyone has completed this in that code then I would appreciate their help too. </p>\n\n<p>Any ideas would be appreciated, even simple pseudo code. </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2824, "user_id": 562155, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0431ea2b011b644d1574e2b11ffa75ea?s=128&d=identicon&r=PG", "display_name": "Karthick S", "link": "https://stackoverflow.com/users/562155/karthick-s"}, "edited": false, "score": 0, "creation_date": 1473931000, "post_id": 39489043, "comment_id": 66330918, "body": "Thanks a lot. This was exactly what I was looking for."}], "tags": [], "owner": {"reputation": 191, "user_id": 3747824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af45cd0dc3eac8e267754d1a23e703e3?s=128&d=identicon&r=PG&f=1", "display_name": "m  e", "link": "https://stackoverflow.com/users/3747824/m-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1473851747, "creation_date": 1473851747, "answer_id": 39489043, "question_id": 39488582, "link": "https://stackoverflow.com/questions/39488582/excel-2010-shading-per-series-for-bar-charts/39489043#39489043", "title": "Excel 2010: Shading per series for Bar Charts", "body": "<p>If you want to do something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1Opkv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Opkv.png\" alt=\"enter image description here\"></a></p>\n\n<p>It's a bit tricky, but can be done. First you must add a fourth data series so you have the data like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/96FVL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/96FVL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then you have to put the three \"real\" data series in the secondary axis. You must set the maximum values both in secondary and primary axes to the same value (30 in my example). Next, you delete the secondary axis. And finally, in the fourth series settings you let it overlap and put the separation to zero. Sorry, I don't know the exact english name of the settings, as my Excel is not in english.</p>\n"}], "owner": {"reputation": 2824, "user_id": 562155, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0431ea2b011b644d1574e2b11ffa75ea?s=128&d=identicon&r=PG", "display_name": "Karthick S", "link": "https://stackoverflow.com/users/562155/karthick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 39489043, "answer_count": 1, "score": 1, "last_activity_date": 1473851747, "creation_date": 1473850235, "last_edit_date": 1531161705, "question_id": 39488582, "link": "https://stackoverflow.com/questions/39488582/excel-2010-shading-per-series-for-bar-charts", "title": "Excel 2010: Shading per series for Bar Charts", "body": "<p>I have a table of data similar to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U3Whn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U3Whn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want to create a bar chart like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gWb4I.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gWb4I.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/n1hOv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n1hOv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>or, when I add major gridlines, I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PTLoz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PTLoz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However, I want a quick way to visually differentiate between the different quarters (Q1... Q4) by shading them with a different background color each or marking a border around them.</p>\n\n<p>I don't want to export the chart as an image and edit it because:\n 1. This is a weekly report, it would be very repetitive and error prone.\n 2. It would be time consuming when I need to do it for 100s of records.\n 3. My manager prefers the data and the chart to be sent as part of the report. Hence, changing it to other formats is not possible. </p>\n\n<p>Is it possible to create such a graph using Excel 2010? If so, how? I don't mind writing a macro for this, but am currently lost on the approach.</p>\n"}, {"tags": ["vba", "email", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473851633, "post_id": 39488244, "comment_id": 66295635, "body": "Would it not be possible to use rules in Outlook to copy the emails to the desired folder and then have a macro that only looks at this folder to mark emails as unread?"}, {"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473853635, "post_id": 39488244, "comment_id": 66296862, "body": "@Zac yes, but this methods eliminates the possibility to keep unread mails as reminders in that sub folders."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473853829, "post_id": 39488244, "comment_id": 66296980, "body": "Bit confused, I thought you wanted to mark the emails in your &#39;XP&#39; folder as read? Just to clarify, when you move the emails using Outlook rules, you are unable to manually set them to read? is that the problem?"}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "edited": false, "score": 0, "creation_date": 1473855035, "post_id": 39488244, "comment_id": 66297732, "body": "A bit rusty on Outlook but you probably need to copy it from the Sent folder after you send it and you can always set the sent time manually if it&#39;s not being picked up."}, {"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473939691, "post_id": 39488244, "comment_id": 66336293, "body": "@zac. Right, I want to mark them as read. When the are copied with the rules then the will be marked as unread (unwanted result). Marking all emails in that folder as unread is also not wanted, as I may have some emails from other senders in that folder, that I want to keep marked as unread"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1473941141, "post_id": 39491625, "comment_id": 66337128, "body": "Thanks for the code. I tried it without success. I get a run time error -2147221241 (80040107) and something like &quot;client operation failed&quot; (German version). The debugger points to the line: Set CopiedItem = item.Copy &#39; create a copy. Unfortunately I do not understand the problem."}, {"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1473942587, "post_id": 39491625, "comment_id": 66338006, "body": "However the error message occurs in only 60% of all cases. until the first error message, all emails are copied correctly. I added a message box confirming that the XYZ was found. Immediately prior to every error message the massage box appears twice (but only one copy is placed in  folder XY)"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1473973006, "post_id": 39491625, "comment_id": 66356158, "body": "Appears itemAdd is invoked for &quot;CopiedItem&quot;. There may be something more elegant but I found the cycle is broken with the usually avoided On Error Resume Next."}, {"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1474017589, "post_id": 39491625, "comment_id": 66370435, "body": "Thanks! This working as expected (except that I didn&#39;t want to have them marked as unread - but that&#39;s an easy edit). Great! I will also post my code, that is - based on yours - dealing with multiple folders."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1473972993, "last_edit_date": 1473972993, "creation_date": 1473859332, "answer_id": 39491625, "question_id": 39488244, "link": "https://stackoverflow.com/questions/39488244/copy-sent-mail-to-folder-based-on-key-words-in-subject/39491625#39491625", "title": "Copy sent mail to folder based on key words in subject", "body": "<p>Item Add works the same on any folder.</p>\n\n<p>For the ThisOutlookSession module:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents snItems As Items\n\nPrivate Sub Application_Startup()\n    '   default local Sent Items folder\n    Set snItems = Session.GetDefaultFolder(olFolderSentMail).Items \nEnd Sub\n\nPrivate Sub snItems_ItemAdd(ByVal item As Object) \n\n    Dim myFolder as Folder\n    Dim XYFolder as Folder\n    Dim CopiedItem as mailitem\n\n    If TypeName(item) = \"MailItem\" Then\n\n        Set myFolder = Session.GetDefaultFolder(olFolderInbox) ' inbox \n        Set XYFolder = myFolder.Folders(\"XY\")' desired destination folder\n\n        If InStr(1, Item.Subject, \"XYZ\", vbTextCompare) Then\n\n            On Error Resume Next\n            ' Appears CopiedItem is considered\n            '  an item added to Sent Items folder\n            ' Code tries to run more than once.\n            ' It would be an endless loop\n            '  but that item has been moved.\n            '\n            ' Skip all lines on the second pass.\n            Set CopiedItem = item.copy ' create a copy\n            CopiedItem.UnRead = True\n            CopiedItem.Move XYFolder ' move copy to folder\n            On Error GoTo 0\n\n        End If\n\n    End If\n\nExitRoutine:\n    Set myFolder = Nothing\n    Set XYFolder = Nothing\n    Set CopiedItem = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1473871983, "creation_date": 1473871983, "answer_id": 39495850, "question_id": 39488244, "link": "https://stackoverflow.com/questions/39488244/copy-sent-mail-to-folder-based-on-key-words-in-subject/39495850#39495850", "title": "Copy sent mail to folder based on key words in subject", "body": "<p>If you don't need a copy in the Sent Items folder, you can simply set the <code>MailItem.SaveSentMessageFolder</code> property - Outlook will move the item to that folder after it is sent. </p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1473951848, "post_id": 39511293, "comment_id": 66344708, "body": "Great, that works! Thanks! However, I still need to use the rules... It would just be more elegant to do it with just one macro and not a combination of two separately managed steps."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1474011381, "post_id": 39511293, "comment_id": 66367275, "body": "I&#39;ve updated the Sub to move items from <code>Sent Items</code> folder. I also took the check for <code>Unread</code> out because when I tested this, once the item was moved from <code>Sent Items</code> folder, it stayed as <code>Read</code> item. I&#39;ve left it in there as comments just incase you get different results and need to marks the items as <code>Unread</code>"}, {"owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1474017541, "post_id": 39511293, "comment_id": 66370410, "body": "Thanks for your time! However there are 2 drawbacks: 1) the sub runs only manually (or at startup, if invoked then), 2) it copies the very same email every time the sub runs. Thus your folders will explode from duplicates ;)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1474020330, "post_id": 39511293, "comment_id": 66372228, "body": ":) we will get there!. Updated above"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "edited": false, "score": 0, "creation_date": 1474020594, "post_id": 39511293, "comment_id": 66372380, "body": "Just realized you have an answer for your query so please ignore my update. Happy coding"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1474020311, "last_edit_date": 1474020311, "creation_date": 1473943147, "answer_id": 39511293, "question_id": 39488244, "link": "https://stackoverflow.com/questions/39488244/copy-sent-mail-to-folder-based-on-key-words-in-subject/39511293#39511293", "title": "Copy sent mail to folder based on key words in subject", "body": "<p>Try this<br></p>\n\n<pre><code>Sub CopyMailFromSentFolder()\n    Dim oNS As Outlook.Namespace\n    Dim oDefaultFolder As Outlook.MAPIFolder\n    Dim oSentFolder As Outlook.MAPIFolder\n    Dim oDestinationFolder As Outlook.MAPIFolder\n    Dim oItems As Outlook.Items\n    Dim oDestItems As Outlook.Items\n    Dim oItemToCopy As MailItem\n    Dim intCounter, intSecCounter As Integer\n    Dim bolItemFound As Boolean\n\n    Set oNS = GetNamespace(\"MAPI\")\n    Set oDefaultFolder = oNS.GetDefaultFolder(olFolderInbox)\n    Set oSentFolder = oNS.GetDefaultFolder(olFolderSentMail)\n    Set oItems = oSentFolder.Items\n\n    For intCounter = 1 To oItems.Count\n        If InStr(1, oItems(intCounter).Subject, \"testing\") &gt; 0 Then 'And oItems(intCounter).Unread = True Then\n\n            Set oDestinationFolder = oDefaultFolder.Folders(\"Just Testing\")\n            Set oDestItems = oDestinationFolder.Items\n            bolItemFound = False\n\n            For intSecCounter = 1 To oDestItems.Count\n                If oDestItems(intSecCounter).Subject = oItems(intCounter).Subject And oDestItems(intSecCounter).SentOn = oItems(intCounter).SentOn Then\n                    bolItemFound = True\n                    Exit For\n                End If\n            Next\n            If Not bolItemFound Then\n                Set oItemToCopy = oItems(intCounter).Copy\n                oItemToCopy.Move oDestinationFolder\n                Set oItemToCopy = Nothing\n            End If\n            Set oDestinationFolder = Nothing\n            Set oDestItems = Nothing\n\n            'oItems(intCounter).Unread = False\n        End If\n    Next\n\n    Set oNS = Nothing\n    Set oDefaultFolder = Nothing\n    Set oSentFolder = Nothing\n    Set oItems = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This should avoid copying duplicates. Try adding it to Application_ItemSend. Not sure if it would slow down the sending process but it would give you the desired result</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "is_accepted": false, "score": 0, "last_activity_date": 1474017810, "creation_date": 1474017810, "answer_id": 39527924, "question_id": 39488244, "link": "https://stackoverflow.com/questions/39488244/copy-sent-mail-to-folder-based-on-key-words-in-subject/39527924#39527924", "title": "Copy sent mail to folder based on key words in subject", "body": "<p>Based on the answer from niton I changed the code so that it will work with multiple folders. Ready for CnP. Thanks to all the contributors! </p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents snItems As Items\n\nPrivate Sub Application_Startup()\n    '   default local Sent Items folder\n    Set snItems = Session.GetDefaultFolder(olFolderSentMail).Items\nEnd Sub\n\nPrivate Sub snItems_ItemAdd(ByVal item As Object)\n\n\n    Dim myFolder As Folder\n    Dim DestinationFolder As Folder     ' desired destination folder\n    Dim CopiedItem As MailItem\n\n    If TypeName(item) = \"MailItem\" Then\n\n        Set myFolder = Session.GetDefaultFolder(olFolderInbox) ' inbox\n\n\n        If InStr(1, item.Subject, \"XYZ\", vbTextCompare) Or _\n           InStr(1, item.Subject, \"BLA\", vbTextCompare) Then\n\n            On Error Resume Next\n            ' Appears CopiedItem is considered an item added to Sent Items folder\n            ' -&gt; Code tries to run more than once.\n            ' It would be an endless loop but that item has been moved.\n            ' Skip all lines on the second pass.\n\n            'define destination folder\n            If InStr(1, item.Subject, \"XYZ\", vbTextCompare) Then\n                Set DestinationFolder = myFolder.Folders(\"XY\")\n\n            ElseIf InStr(1, item.Subject, \"BLA\", vbTextCompare) Then\n                Set DestinationFolder = myFolder.Folders(\"XBLA\")\n\n            End If\n\n            ' copy the send mail to destination folder\n            Set CopiedItem = item.Copy ' create a copy\n            CopiedItem.Move DestinationFolder ' move copy to folder\n\n            'Debugging\n            'Debug.Print \"mail w. subject: \" &amp; item.Subject &amp; \" copied to : \" &amp; DestinationFolder\n\n            On Error GoTo 0\n\n        End If\n\n    End If\n\nExitRoutine:\n    Set myFolder = Nothing\n    Set DestinationFolder = Nothing\n    Set CopiedItem = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4176797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/697cc1500336062af10f49da81802066?s=128&d=identicon&r=PG&f=1", "display_name": "lubenja", "link": "https://stackoverflow.com/users/4176797/lubenja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1916, "favorite_count": 0, "accepted_answer_id": 39491625, "answer_count": 4, "score": 1, "last_activity_date": 1609051735, "creation_date": 1473849248, "last_edit_date": 1609051735, "question_id": 39488244, "link": "https://stackoverflow.com/questions/39488244/copy-sent-mail-to-folder-based-on-key-words-in-subject", "title": "Copy sent mail to folder based on key words in subject", "body": "<p>When I send an email which contains the word XYZ in the subject, I want Outlook to copy that email in the folder XY including the sent-date and marked as read.</p>\n<p>I found two approaches \u2013 both not working:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    If TypeName(Item) &lt;&gt; &quot;MailItem&quot; Then Exit Sub\n       \n    ' ~~&gt; Search for Subject\n    Set ol = New Outlook.Application\n    Set olns = ol.GetNamespace(&quot;MAPI&quot;)\n    Set myFolder = olns.GetDefaultFolder(olFolderInbox) ' inbox \n    Set XYFolder = myFolder.Folders(&quot;XY&quot;)' desired destination folder\n       \n    If InStr(1, Item.Subject, &quot;XYZ&quot;, vbTextCompare) Then\n    \n        \u2018 ~~ approach A: copy the object ~~~ \n        Set CopiedItem = Item.Copy ' create a copy \n        CopiedItem.Move XYFolder ' moce copy to folder \n        ' Set CopiedItem.SendOn = CopiedItem.CreationTime '&lt;- not working, write protected \n    \n        \u2018 ~~ approach B: send me a copy (includes using filters afterwards )~~~\n        Item.CC = Item.CC &amp; &quot;my.name@company.com&quot;      \n    End If\n           \nEnd Sub\n</code></pre>\n<p><strong>Problems approach A:</strong><br />\nThe mail items is copied correctly, however the send date and time is blank, as the items has not yet been sent.</p>\n<p><strong>Problems approach B:</strong><br />\nThe new address is added, however as all known addresses are replaced by \u201cuser-friendly\u201d names, I get a weird message, that the sender (TO) cannot be resolved any more. Thus the mail will not be sent.\nFurthermore I would need to add manual filters \u2013 which is rather ugly.</p>\n<p><strong>General thoughts</strong></p>\n<ol>\n<li>I want to leave a copy in the send folder. Thus scanning the\nSend-Folder daily would lead to tons of duplicates in the XY-folder\nof the same mail.</li>\n<li>Using the Mailitem.SaveMyPersonalItems property\nwould move the mail only in the folder XY but would not leave a copy in sent-folder.</li>\n<li>Possibly the Items.ItemAdd event may be a solution, but I did not\nyet understand how to check if a new item is added to the\nsent-folder.</li>\n<li>The built-in filters of outlook allow copying a sent\nemail containing \u201cXYZ\u201d to folder \u201cXY\u201d. However it\u2019s impossible to\nmark them as read.</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473850451, "post_id": 39488117, "comment_id": 66294948, "body": "Since it&#39;s only <code>OKButn_Click()</code> that&#39;s not working, start by declaring all your public variables with explicit data type and see if that helps. Also make sure the public declarations are in a module, not the forms code sheet."}, {"owner": {"reputation": 21, "user_id": 3227368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fcf25a0372451ecdfb8ef851a08cb0?s=128&d=identicon&r=PG&f=1", "display_name": "R3PooC", "link": "https://stackoverflow.com/users/3227368/r3pooc"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473850960, "post_id": 39488117, "comment_id": 66295263, "body": "Thanks, in the above code the button is working and the code within the button runs - picking up the public declarations and values which are in a module.  Its just getting the results from the checkboxes that I am unsure of how to get."}, {"owner": {"reputation": 21, "user_id": 3227368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fcf25a0372451ecdfb8ef851a08cb0?s=128&d=identicon&r=PG&f=1", "display_name": "R3PooC", "link": "https://stackoverflow.com/users/3227368/r3pooc"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473854267, "post_id": 39488117, "comment_id": 66297263, "body": "Error is specific to &quot;LabelOptName&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1473854305, "post_id": 39488117, "comment_id": 66297293, "body": "Look at a for each loop to loop through the controls."}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473854471, "post_id": 39488117, "comment_id": 66297383, "body": "Labels have captions, not values. Try <code>ColumnCopyForm.LabelOptName.Caption</code> instead and set it equal to the text of the caption instead of a boolean."}, {"owner": {"reputation": 21, "user_id": 3227368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fcf25a0372451ecdfb8ef851a08cb0?s=128&d=identicon&r=PG&f=1", "display_name": "R3PooC", "link": "https://stackoverflow.com/users/3227368/r3pooc"}, "edited": false, "score": 0, "creation_date": 1473855011, "post_id": 39488117, "comment_id": 66297709, "body": "Sorry the name I have given to the checkboxes is deceiving, I was trying to make LabelOptName be the name of the checkbox in the form.  Nathan is onto something with the for each loop though... I may have an answer shortly Thanks for the pointers!"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3227368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fcf25a0372451ecdfb8ef851a08cb0?s=128&d=identicon&r=PG&f=1", "display_name": "R3PooC", "link": "https://stackoverflow.com/users/3227368/r3pooc"}, "is_accepted": true, "score": 0, "last_activity_date": 1473857777, "creation_date": 1473857777, "answer_id": 39491021, "question_id": 39488117, "link": "https://stackoverflow.com/questions/39488117/vba-how-do-i-retrieve-selected-checkbox-data-from-dynamically-created-checkbox/39491021#39491021", "title": "(VBA) How do i retrieve selected checkbox data from dynamically created checkboxes", "body": "<p>Managed to get this working, thanks for the tip about Looping through the controls!</p>\n\n<p>Here is the code on the button which does work...</p>\n\n<pre><code>Sub OKButn_Click()\nz = 0\ny = 0\n'Loops through the controls on the form, to get values of the Checkboxes\n   For Each ctlLoop In ColumnCopyForm.Controls\n'Checks to see if the value is true so it can be recorded\n   If ctlLoop.Value = True Then\n   'Records the column title in the correct place for future referencing\n      Sheets(\"Report\").Cells(SavedHdrsRow + 1 + y, SavedHdrsCol).Value = HdrArray(0, z)\n      y = y + 1\n\n    End If\n    z = z + 1\n    Next ctlLoop\n\n\nUnload ColumnCopyForm\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3227368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fcf25a0372451ecdfb8ef851a08cb0?s=128&d=identicon&r=PG&f=1", "display_name": "R3PooC", "link": "https://stackoverflow.com/users/3227368/r3pooc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 0, "accepted_answer_id": 39491021, "answer_count": 1, "score": 2, "last_activity_date": 1473858248, "creation_date": 1473848811, "last_edit_date": 1473858248, "question_id": 39488117, "link": "https://stackoverflow.com/questions/39488117/vba-how-do-i-retrieve-selected-checkbox-data-from-dynamically-created-checkbox", "title": "(VBA) How do i retrieve selected checkbox data from dynamically created checkboxes", "body": "<p>So I have a form that has 2 buttons on it, the code captures the column titles from the Data sheet, adds to an array, then creates checkboxes renaming the captions according to the column titles. It then checks to see whether this information has previously been saved on the report sheet and pre-selects the checkboxes. </p>\n\n<p>This all works in the code below, what I cant work out is when I press a button 'OKButn' to make it get the data selected data from these dynamically created checkboxes and add it to the array so I can output the results to the \nreport sheet.</p>\n\n<p>The code for this button is held on the forms code sheet - only way I could get the buttons working (that I know of). It would be good to create the buttons dynamically too - which I can do, but then get them running code after being clicked which I cant work out.</p>\n\n<p>here is my code so far:</p>\n\n<pre><code>Option Explicit\n\nPublic HdrArray(), HdrColArray()\nPublic z, y, TotalHdrs, SavedHdrsCol, SavedHdrsRow, TotalSavedHdrs As Integer\nPublic AddOption As Object\n\n\nSub PopulateForm()\n\nColumnCopyForm.Show vbModeless\nColumnCopyForm.Caption = \"Column Copy Selection \"\"\"\n\nSheets(\"Data\").Select\n\n'Find total number of headers\nTotalHdrs = Sheets(\"Data\").Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Find cell that records the 'required columns'\nSavedHdrsCol = Sheets(\"Report\").Range(\"A1:zz100\").Find(\"Required Columns\", LookIn:=xlValues).Column\nSavedHdrsRow = Sheets(\"Report\").Range(\"A1:zz100\").Find(\"Required Columns\", LookIn:=xlValues).Row\n\n'Count total rows\nTotalSavedHdrs = Sheets(\"Report\").Cells(Sheets(\"Data\").Rows.Count, SavedHdrsCol).End(xlUp).Row\n\nFor z = 0 To (TotalHdrs - 1)\n    'If Sheets(\"Data\").Cells(1, 1 + z).Value = \"Item Type\" Then\n    'Delete Columns on Data Sheet\n    'Sheets(\"Data\").Columns(z).EntireColumn.Delete\n    'Else\n\n    'Makes the array dynamic\n    ReDim Preserve HdrArray(TotalHdrs, z)\n\n    'Adds the Data table header label to the array (column 0)\n    HdrArray(0, z) = Sheets(\"Data\").Cells(1, 1 + z).Value\n\n    'Adds the column number to the array (Column 1)\n    HdrArray(1, z) = z\n\n    'Adds a check box - renaming it to the column title\n    Set AddOption = ColumnCopyForm.Controls.Add(\"Forms.CheckBox.1\", \"LabelOpt\" &amp; z, True)\n    With AddOption\n        .Caption = HdrArray(0, z)\n        .Left = 10\n        .Width = 200\n        .Top = .Height * z\n\n        'Automatically selects this if the option has been previously saved to copy to report sheet\n        For y = 0 To (TotalSavedHdrs - 1)\n            If Sheets(\"Report\").Cells(SavedHdrsRow + 1 + y, SavedHdrsCol).Value = HdrArray(0, z) Then\n                AddOption.Value = True\n\n                'Add info to Array\n                HdrArray(2, z) = 1\n            End If\n        Next y\n    End With\n    'End If\n\n    'Make button visible - and format\n    ColumnCopyForm.OKButn.Visible = True\n    With ColumnCopyForm.OKButn\n        .Caption = \"Apply &amp; Close\"\n        .Top = ColumnCopyForm.Height - 50\n        .Left = ColumnCopyForm.Width - 130\n        .Width = 70\n        .Height = 20\n        .ZOrder (0)\n    End With\n\n    'Make button visible - and format\n    ColumnCopyForm.CancelButn.Visible = True\n    With ColumnCopyForm.CancelButn\n        .Caption = \"Cancel\"\n        .Top = ColumnCopyForm.Height - 50\n        .Left = ColumnCopyForm.Width - 50\n        .Width = 40\n        .Height = 20\n        .ZOrder (0)\n    End With\n\nNext z\n\nEnd Sub\n</code></pre>\n\n<p>Here is the code  for the button...</p>\n\n<pre><code>Option Explicit\n\nSub OKButn_Click()\n\nFor y = 0 To (TotalHdrs - 1)\n    MsgBox (HdrArray(0, y) &amp; \" - \" &amp; HdrArray(2, y))\n\n    'Saves the preferences to the report sheet\n    If HdrArray(2, y) = \"1\" Then\n        Sheets(\"Report\").Cells(SavedHdrsRow + 1 + y, SavedHdrsCol).Value = HdrArray(0, y)\n    End If\nNext y\n\nUnload ColumnCopyForm\n\nEnd Sub\n</code></pre>\n\n<p>This is the code I thought might work under the button...</p>\n\n<pre><code>Sub OKButn_Click()\n\n    For y = 0 To (TotalHdrs - 1)\n    Set LabelOptName = \"LabelOpt\" &amp; (y + 1)\n\n    If ColumnCopyForm.LabelOptName.Value = True Then\n        HdrArray(2, y) = 1\n    End If\n\n\n    MsgBox (HdrArray(0, y) &amp; \" - \" &amp; HdrArray(2, y))\n        'Saves the preferences to the report sheet\n        If HdrArray(2, y) = \"1\" Then\n            Sheets(\"Report\").Cells(SavedHdrsRow + 1 + y, SavedHdrsCol).Value = HdrArray(0, y)\n\n        End If\n\n    Next y\n\nUnload ColumnCopyForm\nEnd Sub\n</code></pre>\n\n<p>However on this line:</p>\n\n<blockquote>\n  <p>If ColumnCopyForm.LabelOptName.Value = True Then</p>\n</blockquote>\n\n<p>I get a compile error:\nMethod or data member not found</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1473848421, "post_id": 39487916, "comment_id": 66293842, "body": "You want <code>rng.Rows</code> with an s"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1473850958, "post_id": 39487916, "comment_id": 66295261, "body": "You&#39;ll also need <code>rw.Cells(1,1)</code> rather than <code>rw.Item(1,1)</code>.  Item will give an <code>Application-defined or object-defined error</code>."}, {"owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1473850992, "post_id": 39487916, "comment_id": 66295283, "body": "@chrisneilsen Thx. After changing it to rows I get &quot;Run-time error 1004: Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473851152, "post_id": 39487916, "comment_id": 66295387, "body": "@DarrenBartrup-Cook Thx. Now I am getting a &quot;Type mismatch&quot; error."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1473852019, "post_id": 39487916, "comment_id": 66295877, "body": "When you find a coupon row you&#39;re adding 0.0001 to each cell in that row - the first cell says <code>coupon</code> and you try and add 0.0001 to that which gives the error.  Change your <code>If Not IsDate(cel) Then</code> to <code>If IsNumeric(cel) Then</code> (the row you&#39;re checking doesn&#39;t have a date in it).  You could also update <code>If IsEmpty(cel.Value) = False Then</code> to <code>If Not IsEmpty(cel.Value) Then</code>"}, {"owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473852305, "post_id": 39487916, "comment_id": 66296037, "body": "@DarrenBartrup-Cook I just realized this myself. Thank you!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1473852338, "post_id": 39487916, "comment_id": 66296053, "body": "@Amatya  try code in answer below"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473852418, "post_id": 39489164, "comment_id": 66296098, "body": "@user3598756 not following... what <i>coupun</i> do you mean ?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473852541, "post_id": 39489164, "comment_id": 66296193, "body": "The one that should be &quot;coupon&quot;..:-)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473852676, "post_id": 39489164, "comment_id": 66296264, "body": "@user3598756 actually, watch your &quot;Coupuns&quot; ? not &quot;coupun&quot;"}, {"owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "edited": false, "score": 0, "creation_date": 1473853246, "post_id": 39489164, "comment_id": 66296625, "body": "@ShaiRado Thank you!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1473852126, "creation_date": 1473852126, "answer_id": 39489164, "question_id": 39487916, "link": "https://stackoverflow.com/questions/39487916/looping-over-a-range-row-by-row/39489164#39489164", "title": "Looping over a range, row by row", "body": "<p>Try the code below, it's a little different than the one you posted:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim rng         As Range\nDim rw          As Range\nDim Col         As Long\nDim CellStr     As String\n\nSet rng = Range(\"E15:P464\")\n\n' loop through rows in Range\nFor Each rw In rng.Rows\n    ' get the value of the first column and convert to String\n    CellStr = rw.Columns(1).Value\n\n    ' use StrComp to verify match between strings\n    If StrComp(CellStr, \"coupun\") = 0 Then\n\n        ' loop through all columns in current row (where there was a match with \"coupun\"\n        For Col = rng.Columns(2).Column To rw.Columns.Count\n\n            ' check if current cell is empty\n            If Not IsEmpty(Cells(rw.Row, Col)) Then\n                If Not IsDate(Cells(rw.Row, Col)) Then\n                    Cells(rw.Row, Col).Value = Cells(rw.Row, Col).Value + 0.0001\n                End If\n            End If\n        Next Col\n\n    End If\nNext rw\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "edited": false, "score": 0, "creation_date": 1473853110, "post_id": 39489220, "comment_id": 66296525, "body": "Thanks for showing me a totally different and possibly way more efficient and versatile method of doing this."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1473852252, "creation_date": 1473852252, "answer_id": 39489220, "question_id": 39487916, "link": "https://stackoverflow.com/questions/39487916/looping-over-a-range-row-by-row/39489220#39489220", "title": "Looping over a range, row by row", "body": "<p>chris neilsen gave solution to fix the error </p>\n\n<p>you may want to follow an alternative <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\"><code>AutoFilter()</code></a> approach, like follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cel As Range\n\n    With Worksheets(\"Coupons\") '&lt;--| reference \"Coupons\" worksheet (change \"Coupons\" to your actual worksheet name)\n        With .Range(\"A1\").CurrentRegion '&lt;--| reference its range made of cells contiguous to \"A1\"\n            .AutoFilter Field:=1, Criteria1:=\"Coupon\" '&lt;--| filter it on column \"A\" with \"Coupon\" criteria\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then '&lt;--| if any \"Coupon\" in column A\" has been filtered\n                For Each cel In .Offset(1, 1).Resize(.rows.Count - 1, .Columns.Count - 1).SpecialCells(xlCellTypeVisible).SpecialCells(XlCellType.xlCellTypeConstants, xlNumbers) '&lt;-- loop through filtered range cells containing numbers (and skipping column \"A\" and row 1)\n                    If Not IsDate(cel) Then cel.Value = cel.Value + 0.0001 ' update non-date numbers\n                Next cel\n            End If\n        End With\n        .AutoFilterMode = False '&lt;--| show all rows back\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 993, "user_id": 742696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FnFMq.jpg?s=128&g=1", "display_name": "Amatya", "link": "https://stackoverflow.com/users/742696/amatya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 39489220, "answer_count": 2, "score": 0, "last_activity_date": 1473852252, "creation_date": 1473848141, "last_edit_date": 1531164843, "question_id": 39487916, "link": "https://stackoverflow.com/questions/39487916/looping-over-a-range-row-by-row", "title": "Looping over a range, row by row", "body": "<p>I have some data that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vscq5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vscq5.jpg\" alt=\"enter image description here\"></a>   </p>\n\n<p>For all rows labeled \"Coupon\" I want to add a number to the entries in that row if they are non-blank. If they are blank, I want to leave them alone. Also if the data in a cell happen to be a date, I want to not touch it.</p>\n\n<p>Row by row I want to run through the entire range.</p>\n\n<p>My current code is giving me a \"for each may only iterate over a collection object or an array vba\" error. Please help!</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n\nDim rng As Range\nDim rw As Range\nDim cel As Range\n\n\nSet rng = Range(\"E15:P464\")\n\nFor Each rw In rng.Row\n    If rw.Item(1, 1) = \"coupon\" Then\n      For Each cel In rw.Cells\n            If IsEmpty(cel.Value) = False Then\n                   If Not IsDate(cel) Then\n                       cel.Value = cel.Value + 0.0001\n                   End If\n            End If\n      Next cel\n    End If\nNext rw\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visio"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6633761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7052c3f913ae4cb2ecae1972e2f9d4d?s=128&d=identicon&r=PG&f=1", "display_name": "NiTuRen", "link": "https://stackoverflow.com/users/6633761/nituren"}, "edited": false, "score": 0, "creation_date": 1473997827, "post_id": 39489011, "comment_id": 66362324, "body": "Hi John thanks for the tip. I have manage to solve my problem."}], "tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": true, "score": 1, "last_activity_date": 1473851615, "creation_date": 1473851615, "answer_id": 39489011, "question_id": 39487807, "link": "https://stackoverflow.com/questions/39487807/visio-clseventsink-library/39489011#39489011", "title": "Visio clsEventSink library", "body": "<p>I'm guessing you've either placed all of the code into a single standard module, two separate ones, or not renamed the class module correctly but note from the instructions that you need to create a <strong>class</strong> module (ie not a standard module): </p>\n\n<blockquote>\n  <p>Copy this sample code into a new <strong>class</strong> module in VBA or Visual Basic,\n  <strong>naming the module clsEventSink</strong>. You can then use the event-sink module\n  that follows to create an instance of the clsEventSink class and an\n  Event object for the MouseMove event that sends notifications of event\n  firings to the class instance.</p>\n</blockquote>\n\n<p>So the first section of code, which implements the <code>IVisEventProc</code> interface, goes into the class module and the second part, with the Initialize method goes into a standard module.</p>\n"}], "owner": {"reputation": 47, "user_id": 6633761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7052c3f913ae4cb2ecae1972e2f9d4d?s=128&d=identicon&r=PG&f=1", "display_name": "NiTuRen", "link": "https://stackoverflow.com/users/6633761/nituren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 39489011, "answer_count": 1, "score": 0, "last_activity_date": 1501411871, "creation_date": 1473847746, "last_edit_date": 1501411871, "question_id": 39487807, "link": "https://stackoverflow.com/questions/39487807/visio-clseventsink-library", "title": "Visio clsEventSink library", "body": "<p>I want to create a event object following the guide in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff767482.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff767482.aspx</a> . A problem arises when I create a variable  as:</p>\n\n<p>mEventSink As clsEventSink</p>\n\n<p>I received a compile error: User-defined type not defined</p>\n\n<p>I tried searching for a library for this but I am unable to find a source that give me a solution.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1474011880, "post_id": 39487063, "comment_id": 66367507, "body": "Let know if you still having issue"}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1474122521, "post_id": 39487063, "comment_id": 66408038, "body": "Thanks Om3r, I followed the tip below where I removed the box itself if it was a recipient (else endless loop) and added the item.SendEmailAddress if it was excluded. This proved to be a workable solution. I couldn&#39;t find a more elegant solution nor do I know why this behaviour arises... still trying to refine.. Thanks for your help, especially on the non-default mailbox listener :)"}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1474078898, "post_id": 39489874, "comment_id": 66398185, "body": "Thanks, I don&#39;t know why the box adds itself when I use the reply options but I implemented this and now it replies to all recipients excluding itself :)"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1474679008, "last_edit_date": 1474679008, "creation_date": 1473854249, "answer_id": 39489874, "question_id": 39487063, "link": "https://stackoverflow.com/questions/39487063/replying-to-mails-on-a-non-default-mailbox/39489874#39489874", "title": "Replying to mails on a non-default mailbox", "body": "<p>To ensure the sender is included in myReply, you could add Item.SenderEmailAddress to the myReply.To.</p>\n\n<p>You could exit if Item.SenderEmailAddress is \"requests@address.com\".</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1474679109, "last_edit_date": 1474679109, "creation_date": 1473882329, "answer_id": 39498496, "question_id": 39487063, "link": "https://stackoverflow.com/questions/39487063/replying-to-mails-on-a-non-default-mailbox/39498496#39498496", "title": "Replying to mails on a non-default mailbox", "body": "<p>Try this</p>\n\n<pre><code>Private Sub Items_ItemAdd(ByVal Item As Object)\n    Dim Recip As Recipient\n\n    If TypeOf Item Is Outlook.MailItem Then\n\n        Debug.Print Item.Subject\n\n        Set Item = Item.ReplyAll\n        Set Recip = olReply.Recipients.Add Item.SenderEmailAddress\n            Recip.Type = olTo\n\n        Item.HTMLBody = \"Replied At: \" &amp; Now()\n        Item.display\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 39489874, "answer_count": 2, "score": 1, "last_activity_date": 1609904856, "creation_date": 1473845616, "last_edit_date": 1609904856, "question_id": 39487063, "link": "https://stackoverflow.com/questions/39487063/replying-to-mails-on-a-non-default-mailbox", "title": "Replying to mails on a non-default mailbox", "body": "<p>I have many mailboxes in Outlook. I have set-up the following code to process incoming mails on one of my non-default mailboxes (requests@address.com).</p>\n<p>I want to process all mails arriving in this box, perform an action on the content, then ReplyAll to that mail.</p>\n<p>The problem is that the ReplyAll only includes the mailbox itself as a recipient (requests@address.com) and not the sender. The result is that the sender does not get a response but that the box keeps sending and receiving by itself in a loop.<br />\nIf there is more than one person cc'd in the original, they get a copy of the mail but not the sender himself.</p>\n<p>When using ReplyAll, how can I get the mailbox to identify the sender as the recipient instead of the mailbox itself?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPrivate WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox  As Outlook.MAPIFolder\n    Dim olRecip As Recipient\n\n    Set olNs = Application.GetNamespace(&quot;MAPI&quot;)\n    Set olRecip = olNs.CreateRecipient(&quot;requests@address.com&quot;)  '// Owner's Name or email address\n    Set Inbox = olNs.GetSharedDefaultFolder(olRecip, olFolderInbox)\n    Set Items = Inbox.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    If TypeOf Item Is Outlook.MailItem Then\n        Debug.Print Item.Subject\n        Dim myReply As Outlook.MailItem\n\n        Set myReply = Item.ReplyAll\n        myReply.htmlbody = &quot;Replied At: &quot;&amp; Now()\n        myReply.SentOnBehalfOfName = &quot;requests@address.com&quot;\n        myReply.Send\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1473845701, "post_id": 39486867, "comment_id": 66292204, "body": "it means it can&#39;t find in all 3 dummy sheets ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1473846305, "post_id": 39486867, "comment_id": 66292561, "body": "If it&#39;s definitely in Dummy3 is it a number formatted as text while B1 is an actual number?"}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": true, "score": 0, "last_activity_date": 1473846971, "last_edit_date": 1473846971, "creation_date": 1473846421, "answer_id": 39487357, "question_id": 39486867, "link": "https://stackoverflow.com/questions/39486867/excel-nested-if-and-index-match-returning-n-a/39487357#39487357", "title": "Excel: Nested IF and INDEX MATCH returning #N/A", "body": "<p>If the match formula does not find a match, say in Dummy1, it will return #N/A. In turn, this will abort the if function, rather than return a false and continue looking in Dummy2. </p>\n\n<p>Try to wrap your logical test inside an iferror function which returns false in case of error. <a href=\"http://www.mbaexcel.com/excel/why-you-should-be-cautious-about-using-excels-iferror-formula/\" rel=\"nofollow\">But be mindful of using it too generously</a>.</p>\n\n<pre><code>=IF(IFERROR(INDEX(Dummy1!$A$3:$A$1048576,MATCH(B1,Dummy1!$B$3:$B$2473,0))&lt;&gt;0,FALSE),\nINDEX(Dummy1!$A$3:$A$1048576,MATCH(B1,Dummy1!$B$3:$B$2473,0)),\nIF(IFERROR(INDEX(Dummy2!$A$3:$A$1048576,MATCH(B1,Dummy2!$B$3:$B$2473,0))&lt;&gt;0,FALSE),\nINDEX(Dummy2!$A$3:$A$1048576,MATCH(B1,Dummy2!$B$3:$B$2473,0)),\nINDEX(Dummy3!$A$3:$A$1048576,MATCH(B1,Dummy3!$B$3:$B$2473,0))))  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473846503, "creation_date": 1473846503, "answer_id": 39487382, "question_id": 39486867, "link": "https://stackoverflow.com/questions/39486867/excel-nested-if-and-index-match-returning-n-a/39487382#39487382", "title": "Excel: Nested IF and INDEX MATCH returning #N/A", "body": "<p>You haven't any error handling in your formula - this will do it:</p>\n\n<pre><code>=IF(TRIM($B$2)=\"\",\"Please enter value into B2\",IFERROR(IF(INDEX(Dummy1!$A:$A,MATCH($B$2,Dummy1!$B:$B,0),1)&lt;&gt;0,INDEX(Dummy1!$A:$A,MATCH($B$2,Dummy1!$B:$B,0),1),IF(INDEX(Dummy2!$A:$A,MATCH($B$2,Dummy2!$B:$B,0),1)&lt;&gt;0,INDEX(Dummy2!$A:$A,MATCH($B$2,Dummy2!$B:$B,0),1),IF(INDEX(Dummy3!$A:$A,MATCH($B$2,Dummy3!$B:$B,0),1)&lt;&gt;0,INDEX(Dummy3!$A:$A,MATCH($B$2,Dummy3!$B:$B,0),1),\"Not in any of the sheets\"))),\"Not in any of the sheets\"))\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5446037, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/a107e578f142945387a8f393e0868683?s=128&d=identicon&r=PG&f=1", "display_name": "dizzle", "link": "https://stackoverflow.com/users/5446037/dizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 39487357, "answer_count": 2, "score": 0, "last_activity_date": 1473846971, "creation_date": 1473845039, "question_id": 39486867, "link": "https://stackoverflow.com/questions/39486867/excel-nested-if-and-index-match-returning-n-a", "title": "Excel: Nested IF and INDEX MATCH returning #N/A", "body": "<p>I have a workbook with 4 sheets. I'm trying to create a function in the first sheet that checks for a value in a column in the next sheet. If the value isnt found there, it looks in a similar column in the next sheet and so on. I have the following function, and it works when looking in sheets Dummy1 and Dummy2 but returns #N/A when looking in Dummy3. Any ideas why this is happening? </p>\n\n<pre><code>=IF(INDEX(Dummy1!$A$3:$A$1048576,MATCH(B1,Dummy1!$B$3:$B$2473,0))&lt;&gt;0,\nINDEX(Dummy1!$A$3:$A$1048576,MATCH(B1,Dummy1!$B$3:$B$2473,0)),\nIF(INDEX(Dummy2!$A$3:$A$1048576,MATCH(B1,Dummy2!$B$3:$B$2473,0))&lt;&gt;0,\nINDEX(Dummy2!$A$3:$A$1048576,MATCH(B1,Dummy2!$B$3:$B$2473,0)),\nINDEX(Dummy3!$A$3:$A$1048576,MATCH(B1,Dummy3!$B$3:$B$2473,0))))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473843918, "post_id": 39486278, "comment_id": 66291105, "body": "check if all of your Internet Explorer (or Chrome) windows are closed"}], "answers": [{"tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1473846173, "creation_date": 1473846173, "answer_id": 39487284, "question_id": 39486278, "link": "https://stackoverflow.com/questions/39486278/method-document-of-object-iwebbrowser2-failed/39487284#39487284", "title": "method document of object iwebbrowser2 failed", "body": "<p>First make sure you have opened a site on Internet Explorer. Then run the code. I did not get the error as yours but got object reference error. So, added a check when the object is nothing.</p>\n\n<pre><code>Sub getIE()\n  Dim sh As Object, oWin As Object, IE As Object\n\n  Set sh = CreateObject(\"Shell.Application\")\n\n  For Each oWin In sh.Windows\n    If TypeName(oWin.document) = \"HTMLDocument\" Then\n        Set IE = oWin\n        Exit For\n    End If\n  Next\n\n  If Not IE Is Nothing Then\n    MsgBox IE.document.URL\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1983253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd259b6c7ede4dfa91b81c2e9f5bc48?s=128&d=identicon&r=PG", "display_name": "Suraj Busnoor", "link": "https://stackoverflow.com/users/1983253/suraj-busnoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4320, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523512966, "creation_date": 1473843182, "last_edit_date": 1531164843, "question_id": 39486278, "link": "https://stackoverflow.com/questions/39486278/method-document-of-object-iwebbrowser2-failed", "title": "method document of object iwebbrowser2 failed", "body": "<p>I am getting this error \"method document of object iwebbrowser2 failed\".. Please look the code below.</p>\n\n<pre><code>Sub getIE()\nDim sh As Object, oWin As Object, IE As Object\n\nSet sh = CreateObject(\"Shell.Application\")\n\nFor Each oWin In sh.Windows\n    If TypeName(oWin.document) = \"HTMLDocument\" Then\n        Set IE = oWin\n        Exit For\n    End If\nNext\n\nMsgBox IE.document.URL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473840890, "post_id": 39485523, "comment_id": 66289328, "body": "Have you tried doing it manually and record it with the macro recorder? This is how I do this constantly as I can never remember the code for that. The code, the macro recorder is generating can be used almost without any changes (actually  one of the few examples where the macro recorder performs extremely well including <code>with</code>)."}, {"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473841152, "post_id": 39485523, "comment_id": 66289483, "body": "Yep. I tried recording it. But I got a hard time in replacing the cell reference. bc in my case I think I have to use the <code>lastrow</code> since it should traverse until the last used cell."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1473841332, "post_id": 39485523, "comment_id": 66289597, "body": "So, do you mind sharing with is the VBA code you have thus far (which - apparently - you are merely trying to finalize with said <code>lastRow</code>)?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1473841530, "post_id": 39485523, "comment_id": 66289700, "body": "@kruk22 try reading the answer in the post&#39;s link <a href=\"http://stackoverflow.com/questions/38919157/how-to-debug-a-pivot-chart-macro/38936385#38936385\" title=\"how to debug a pivot chart macro\">stackoverflow.com/questions/38919157/&hellip;</a>  , if still need help let me know"}, {"owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473843380, "post_id": 39485523, "comment_id": 66290800, "body": "Thanks for the link @Shai Rado :) It helps me!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473843651, "post_id": 39485523, "comment_id": 66290959, "body": "@kruk22 (feel free to upvote the answer there :)"}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": false, "score": 1, "last_activity_date": 1473844753, "creation_date": 1473844753, "answer_id": 39486772, "question_id": 39485523, "link": "https://stackoverflow.com/questions/39485523/changing-the-data-source-of-pivot-table-in-vba/39486772#39486772", "title": "Changing the data source of pivot table in VBA", "body": "<p>If you create tables (ctrl + t) for your source data and direct your pivot to read those tables, they should automatically expand as new data is entered. Then it should be as simple as Thisworkbook.Worksheets(\"Pivot\").PivotTables(\"PivotTable1\").PivotCache.Refresh (based on the macro recorder)</p>\n"}], "owner": {"reputation": 129, "user_id": 6052548, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/a224ba95c705644b2f60784ce3435df3?s=128&d=identicon&r=PG&f=1", "display_name": "kruk22", "link": "https://stackoverflow.com/users/6052548/kruk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473844753, "creation_date": 1473840663, "question_id": 39485523, "link": "https://stackoverflow.com/questions/39485523/changing-the-data-source-of-pivot-table-in-vba", "title": "Changing the data source of pivot table in VBA", "body": "<p>My problem goes like this: \nI have 2 worksheets in 1 workbook which are the <strong>\"Source Data\"</strong> and the <strong>\"Pivot Sheet\"</strong>. Everytime I generate(I generate data every week and it's in macros), data are added to <strong>Source Data</strong> sheet but the Pivot Table in the <strong>Pivot Sheet</strong> remains the same. I think it's quite handy if I will still have to Change Data Source everytime I'll generate the report. I want it to automatically adjust it's data source until the last used cell. How to do it? <strong><em>Columns used as Source are from Column C to W</em></strong> Please help! :( </p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473841222, "post_id": 39485404, "comment_id": 66289523, "body": "try the code in my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 6088, "user_id": 1270725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dcd587470f1896d43243bd0856ecd06d?s=128&d=identicon&r=PG", "display_name": "mcalex", "link": "https://stackoverflow.com/users/1270725/mcalex"}, "edited": false, "score": 0, "creation_date": 1473842309, "post_id": 39485571, "comment_id": 66290109, "body": "Sold!  Interestingly, I couldn&#39;t do <code>Workbooks(&quot;nameFromFileDialog&quot;).Activate</code> which originally prompted the question.  I was expecting <code>Workbooks(workbookReference).Activate</code> to work, but it seems I need <code>Workbooks(workbookReference.Name).Activate</code>.  So now I don&#39;t get why the string I originally tried doesn&#39;t work, but the workbook name string does ... (but i&#39;m not going to lose any sleep over it :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1473841732, "last_edit_date": 1473841732, "creation_date": 1473840842, "answer_id": 39485571, "question_id": 39485404, "link": "https://stackoverflow.com/questions/39485404/get-workbook-reference-from-open-file-dialog/39485571#39485571", "title": "Get Workbook reference from Open File dialog", "body": "<p>Try the code below:</p>\n\n<pre><code>Function openDataFile() As Workbook\n'\nDim wb            As Workbook\nDim filename      As String\nDim fd            As FileDialog\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nfd.AllowMultiSelect = False\nfd.Title = \"Select the file to extract data\"\n\n' Optional properties: Add filters\nfd.Filters.Clear\nfd.Filters.Add \"Excel files\", \"*.xls*\" ' show Excel file extensions only\n\n' means success opening the FileDialog\nIf fd.Show = -1 Then\n    filename = fd.SelectedItems(1)\nEnd If\n\n' error handling if the user didn't select any file\nIf filename = \"\" Then\n    MsgBox \"No Excel file was selected !\", vbExclamation, \"Warning\"\n    End\nEnd If\n\nSet openDataFile = Workbooks.Open(filename)\n\nEnd Function\n</code></pre>\n\n<p>Then I added the Sub below to test this function:</p>\n\n<pre><code>Sub test()\n\nDim testWb  As Workbook\n\nSet testWb = openDataFile    \nDebug.Print testWb.Name\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6088, "user_id": 1270725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dcd587470f1896d43243bd0856ecd06d?s=128&d=identicon&r=PG", "display_name": "mcalex", "link": "https://stackoverflow.com/users/1270725/mcalex"}, "edited": false, "score": 0, "creation_date": 1473842447, "post_id": 39485668, "comment_id": 66290196, "body": "My code does show the FileDialog.  I think the reason for using .show is to see if the filedialog returns true or false."}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473841199, "creation_date": 1473841199, "answer_id": 39485668, "question_id": 39485404, "link": "https://stackoverflow.com/questions/39485404/get-workbook-reference-from-open-file-dialog/39485668#39485668", "title": "Get Workbook reference from Open File dialog", "body": "<p>Looks like you haven't shown the <code>FileDialog</code> so maybe something like this:</p>\n\n<pre><code>Function openDataFile() As Workbook\n'\n  Dim wb As Workbook\n  Dim filename As String\n  Dim fd As Office.FileDialog\n  Set fd = Application.FileDialog(msoFileDialogFilePicker)\n  fd.AllowMultiSelect = False\n  fd.Title = \"Select the file to extract data\"\n  fd.show\n  On Error Resume Next ' handling error over the select.. later in the script you could have an `if fileName = \"\" then exit sub` or something to that affect\n  fileName = fd.SelectedItems(1)\n  On Error GoTo 0\n  Set wb = Workbooks.Open(fileName)\n  openDataFile = wb\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 6088, "user_id": 1270725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dcd587470f1896d43243bd0856ecd06d?s=128&d=identicon&r=PG", "display_name": "mcalex", "link": "https://stackoverflow.com/users/1270725/mcalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2989, "favorite_count": 0, "accepted_answer_id": 39485571, "answer_count": 2, "score": 0, "last_activity_date": 1473841732, "creation_date": 1473840279, "last_edit_date": 1531164843, "question_id": 39485404, "link": "https://stackoverflow.com/questions/39485404/get-workbook-reference-from-open-file-dialog", "title": "Get Workbook reference from Open File dialog", "body": "<p>I'm using an Excel 2013 macro to extract data from a user-selected workbook and my vba is a bit rusty.</p>\n\n<p><code>Application.GetOpenFilename</code> prompts the user for a file location, opens the file and returns a string.  <code>Workbooks.Open(string)</code> returns a Workbook - if you know the name in advance.</p>\n\n<p>I want to combine these to ask the user which file to open, and return a Workbook.</p>\n\n<p>Based on Frank's answer here (<a href=\"https://stackoverflow.com/questions/25153342/open-a-workbook-using-filedialog-and-manipulate-it-in-excel-vba\">Open a workbook using FileDialog and manipulate it in Excel VBA</a>) I've tried this:</p>\n\n<pre><code>Function openDataFile() As Workbook\n'\n  Dim wb As Workbook\n  Dim filename As String\n  Dim fd As Office.FileDialog\n  Set fd = Application.FileDialog(msoFileDialogFilePicker)\n  fd.AllowMultiSelect = False\n  fd.Title = \"Select the file to extract data\"\n  'filename = fd.SelectedItems(1)\n  Set wb = Workbooks.Open(fd.SelectedItems(1))\n  openDataFile = wb\n\nEnd Function\n</code></pre>\n\n<p>but this falls over on the commented line with <code>Run-time error '5': Invalid procedure call or argument.</code></p>\n\n<p>How do I prompt the user to open an excel file, and return a reference to it as a workbook?</p>\n"}, {"tags": ["vba", "excel", "matrix", "copy", "find"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473840605, "post_id": 39485161, "comment_id": 66289179, "body": "What if the first yellow cell is non-empty? Or perhaps you are using conditional formatting? And please do post whatever code you have if you want people to help. SO is not a free code-writing service you know..."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1473840626, "post_id": 39485161, "comment_id": 66289194, "body": "Welcome to StackOverflow, Julian. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1473841372, "post_id": 39485161, "comment_id": 66289620, "body": "I don&#39;t understand why you want to subtract 1 from the first value found in Matrix2 but then you don&#39;t do anything with that value? or do you mean subtract the cell range so that you can get the text &#39;Task1&#39;? Also, like the others said, if you post your code, we can help you fix the problem"}, {"owner": {"reputation": 13, "user_id": 6829730, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d2ac87d73e15309d7928b40e038175f1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6829730/julian"}, "edited": false, "score": 0, "creation_date": 1473842913, "post_id": 39485161, "comment_id": 66290496, "body": "@ zac and others. I substract, because the value is a representative of the time. So once the text field is copied into the yellow field, it&#39;s like the &quot;Task&quot; is filling one hour of my calendar. So I reduce the value by one, because instead of e.g. 4 (hours) there are only 3 (hours) still to be scheduled into my calendar. This is repeated until my value reaches 0, which is when all 4 hours are placed into my calendar and thus the Task, e.g. cleaning the house, is finished and Excel moves one cell down to the next value, like 5, (hours) and does the same, until all the Tasks are in my calendar."}, {"owner": {"reputation": 13, "user_id": 6829730, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d2ac87d73e15309d7928b40e038175f1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6829730/julian"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1473843141, "post_id": 39485161, "comment_id": 66290643, "body": "@miqi180 I AM using conditionals indeed. I was just not sure how to connect them. If the cell is yellow it&#39;s okay to paste my text. But there are two conditionals. If the cell in Matrix one is greater than 0, go to the left and copy it and paste it into a cell in Matrix two IF that cell is yellow."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6829730, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d2ac87d73e15309d7928b40e038175f1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6829730/julian"}, "edited": false, "score": 0, "creation_date": 1473851937, "post_id": 39488829, "comment_id": 66295832, "body": "Thanks. Sounds good. What Kind of Loop do you mean? cell(i,j) or For each cell in range(&quot;a1:h15&quot;) or an if then Statement."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 13, "user_id": 6829730, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d2ac87d73e15309d7928b40e038175f1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6829730/julian"}, "edited": false, "score": 0, "creation_date": 1473853650, "post_id": 39488829, "comment_id": 66296870, "body": "For Matrix1, do a full range loop (i.e. For Each oCell In Range(&quot;A1:H15&quot;)). You might need to tweak it if it doesn&#39;t perform the search the way you need it (i.e. do the search based on columns and then increment the row. but only if the &#39;FOR&#39; loop doesn&#39;t preform that way you need it to). Also, please don&#39;t forget to accept the answer if it helps"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1473851000, "creation_date": 1473851000, "answer_id": 39488829, "question_id": 39485161, "link": "https://stackoverflow.com/questions/39485161/i-want-vba-to-find-a-value-greater-than-0-in-one-matrix-and-copy-it-into-another/39488829#39488829", "title": "I want vba to find a value greater than 0 in one matrix and copy it into another matrix in the cell that has a yellow background", "body": "<p>Here is an approach: <br><br></p>\n\n<p>Have a main loop to check each cell in Matrix1. Immediately within the main loop, have a second loop to check if current cell value is '0'. If its not, get the value, subtract it by 1 and reset the cell value. Within the second loop, get your text (as you are doing but I would assign the text to a variable rather than using 'Copy'). Now have a third loop within your second loop to go through Matrix1. Find the first cell with yellow background color (you can use '<code>cell.interior.color</code>' to get the color). Change the value to the text you captured earlier in the second loop. You will need a check to make sure you have not run out of 'yellow colored' cells. if this happens, have a flag to exit out of the loops.</p>\n"}], "owner": {"reputation": 13, "user_id": 6829730, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d2ac87d73e15309d7928b40e038175f1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6829730/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1614, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473851000, "creation_date": 1473839421, "last_edit_date": 1473843433, "question_id": 39485161, "link": "https://stackoverflow.com/questions/39485161/i-want-vba-to-find-a-value-greater-than-0-in-one-matrix-and-copy-it-into-another", "title": "I want vba to find a value greater than 0 in one matrix and copy it into another matrix in the cell that has a yellow background", "body": "<p>Matrix 1 and Matrix 2. Matrix 2 contains values grater than 0 and Matrix 1 contains yellow cells. I now want a code that Looks for the first value greater than 0 in Matrix 2, substracts one from the found cell value, goes one to the left, copies the test \"Task 1\" and pastes it into the first yellow cell it finds in Matrix 1.</p>\n\n<p>It is Kind of a schedule that distributes Tasks into my calendar, where the yellow fields of my calendar represent the times that are dedicated to work.</p>\n\n<p><img src=\"https://i.stack.imgur.com/EHIHX.png\" alt=\"The Excel sheet \"></p>\n\n<p>My Approach:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim z As Integer\n\n\n\nDo\n'my loop'\nFor Each cell In Range(\"b1:b3\")\ncell.Value = z\n'Searching one Matrix by values greater than 0'\nIf cell.Value &gt; \"0\" Then\n 'reducing cell value by one'\n    cell.Value = cell.Value - 1\n\n\n\n\n\n' The following line is  going one to the left where the corresponding text is and '\n'copying it to another cell - Range(\"k17\") is the place where it is copied to.' \n'I want however that it is being copied into a yellow cell. That means '\n 'using a code that searches another Matrix, like Matrix 1, and inserting it into the'\n'first yellow cell found. So I just selected an absolute range and I don'T'\n'know how to integrate a search function or another condition or else into the place here!'\n\n\n\ncell.Offset(0, -1).Copy Range(\"k17\")\n\n\nEnd If\nNext\n\n'here I am in the second matrix'\n For Each cell In Range(\"k1:L10\")\n\n'another if'\n\nIf cell.Value &gt; \"0\" Then\n\n'I selected a value in Matrix one, so the cell value in this Matrix'\n'is the one of the still active cell'\n'but the active cell always is empty'\n\n  cell.Value = ActiveCell.Value\nEnd If\nNext\n\n\nLoop While z &gt; 0\n\nEnd Sub\n</code></pre>\n\n<p>This code has not the ranges displayed in the Picture, but otherwise applicable. </p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access", "ado"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1473836436, "post_id": 39484199, "comment_id": 66286904, "body": "There is no relationship between <b>id</b>, <b>pod</b> and <b>pod_id</b> in the original data so <b>no</b>, it cannot be done. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "edited": false, "score": 0, "creation_date": 1473836859, "post_id": 39484199, "comment_id": 66287108, "body": "<b>pod</b> in <i>sheet1</i> contains unique values, and <i>sheet2</i> contains multiple records linked to <b>pod</b> from first sheet - relationship is between <b>pod.sheet1</b> and <b>pod.sheet2</b> (one-to-many)"}, {"owner": {"reputation": 1361, "user_id": 3169021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3P48S.jpg?s=128&g=1", "display_name": "swe", "link": "https://stackoverflow.com/users/3169021/swe"}, "edited": false, "score": 0, "creation_date": 1473839344, "post_id": 39484199, "comment_id": 66288473, "body": "please have a look at <a href=\"http://stackoverflow.com/questions/595132/how-to-get-id-of-newly-inserted-record-using-excel-vba?rq=1\" title=\"how to get id of newly inserted record using excel vba\">stackoverflow.com/questions/595132/&hellip;</a>, what i did not know is, that access supports @@Identity. maybe this question helps you a little?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "edited": false, "score": 0, "creation_date": 1473838568, "post_id": 39484754, "comment_id": 66288039, "body": "hmm... <b>pod</b> from table1 is not unique, can exists multiple records of the same <b>pod</b> from different sessions (imports from excel sheets) ... that&#39;s why i added a field <b>pod_id</b> to make a relation in access and keep a history of POD&#39;s if you know what i mean"}, {"owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "edited": false, "score": 0, "creation_date": 1473838859, "post_id": 39484754, "comment_id": 66288204, "body": "Only <b>pod</b> from excel sheet1 is unique in a single session"}], "tags": [], "owner": {"reputation": 1361, "user_id": 3169021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3P48S.jpg?s=128&g=1", "display_name": "swe", "link": "https://stackoverflow.com/users/3169021/swe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473839180, "last_edit_date": 1473839180, "creation_date": 1473838032, "answer_id": 39484754, "question_id": 39484199, "link": "https://stackoverflow.com/questions/39484199/vba-insert-in-two-table-where-id-from-first-table-is-a-field-in-second/39484754#39484754", "title": "VBA - Insert in two table where id from first table is a field in second", "body": "<p>Assuming your pod-column in Table 1 is unique, you have to insert, select again with condition <code>SELECT id FROM table1 WHERE pod = 'myCurrentPod'</code> and there is your ID.</p>\n\n<p>If pod is NOT unique and even pod with other known values is not unique, there is no chance to do it like that.\nIf pod with other known values is unique, you can expand the upper statement with more Conditions.</p>\n\n<p>In all Cases, you cannot do a mass-Insert, but insert one Row from sheet1, insert linked rows from sheet2, next sheet1-row and so on.</p>\n\n<p>If you can design the tables, you should not go with an autoincrement-ID, but with an application-set-ID. Or, if your values in pod are really unique, use this as pk.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "edited": false, "score": 0, "creation_date": 1473853698, "post_id": 39489178, "comment_id": 66296903, "body": "I wasn&#39;t very explicit, i think, .... fields <b>id</b> of both tables (1 &amp; 2) are unique (primary key set) and auto incrementing. Field <b>pod_id</b> of table2 is taking value of field <b>id</b> of table1 -that i want to do- and in a single query (i mean insert) write data from both sheet to both tables."}, {"owner": {"reputation": 50532, "user_id": 15354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca5a87d982422410d9f14aa89c0a842?s=128&d=identicon&r=PG", "display_name": "onedaywhen", "link": "https://stackoverflow.com/users/15354/onedaywhen"}, "reply_to_user": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "edited": false, "score": 0, "creation_date": 1474299743, "post_id": 39489178, "comment_id": 66463953, "body": "@Adrian: OK so having fields names <code>id</code> in both tables is no good, rename them so they are consistent e.g. rename <code>Table1.id</code> to be <code>Table1.pod_id</code>."}], "tags": [], "owner": {"reputation": 50532, "user_id": 15354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca5a87d982422410d9f14aa89c0a842?s=128&d=identicon&r=PG", "display_name": "onedaywhen", "link": "https://stackoverflow.com/users/15354/onedaywhen"}, "is_accepted": false, "score": 0, "last_activity_date": 1473852166, "creation_date": 1473852166, "answer_id": 39489178, "question_id": 39484199, "link": "https://stackoverflow.com/questions/39484199/vba-insert-in-two-table-where-id-from-first-table-is-a-field-in-second/39489178#39489178", "title": "VBA - Insert in two table where id from first table is a field in second", "body": "<p>It can be done in one insert when your columns are named correctly (i.e. each attribute is uniquely and consistently named throughout the schema) and foreign keys are set up as expected.</p>\n\n<p>Here's a quick sketch using SQL DDL for Access's <a href=\"http://web.archive.org/web/20100406100238/http://office.microsoft.com/en-gb/access/HP030704861033.aspx\" rel=\"nofollow\">ANSI-92 Query Mode</a> (you can create the same objects using the Access UI):</p>\n\n<pre><code>CREATE TABLE TableA\n( ID IDENTITY NOT NULL UNIQUE, \n  a_col INTEGER NOT NULL );\n\nCREATE TABLE TableB\n( ID INTEGER NOT NULL UNIQUE\n     REFERENCES TableA ( ID ),  \n  b_col INTEGER NOT NULL );\n\nCREATE VIEW TestAB\n( a_ID, a_col, b_ID, b_col ) AS \nSELECT A1.ID, A1.a_col, B1.ID, B1.b_col\n  FROM TableA AS A1\n       INNER JOIN TableB AS B1 ON A1.ID = B1.ID;\n</code></pre>\n\n<p>If you then insert via the view, omitting the <code>ID</code> column (thus allowing it to be auto-generated) like this:</p>\n\n<pre><code>INSERT INTO TestAB ( a_col, b_col ) VALUES ( 55, 99 );\n</code></pre>\n\n<p>then a row will be inserted into each table for the single SQL command.</p>\n\n<p>That said, it doesn't look like you have been strict enough when naming your attributes e.g. <code>Table1.id</code> changes name to <code>pod_id</code> in <code>Table2</code> and <code>id</code> is not unique in your schema.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1473913647, "last_edit_date": 1473913647, "creation_date": 1473854029, "answer_id": 39489804, "question_id": 39484199, "link": "https://stackoverflow.com/questions/39484199/vba-insert-in-two-table-where-id-from-first-table-is-a-field-in-second/39489804#39489804", "title": "VBA - Insert in two table where id from first table is a field in second", "body": "<p>i found a this...</p>\n\n<pre><code>INSERT INTO [table1] ([data]) \nOUTPUT [inserted].[id], [external_table].[col2] \nINTO [table2] SELECT [col1] \nFROM [external_table]\n</code></pre>\n\n<p>and on last SELECT ... to do a JOIN between sheets to retrive all the data?</p>\n\n<p>It's working that way?</p>\n"}], "owner": {"reputation": 1, "user_id": 5620703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HrR7VRHnFfw/AAAAAAAAAAI/AAAAAAAACT4/MwP0A2d58ik/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5620703/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473913647, "creation_date": 1473836078, "last_edit_date": 1473837675, "question_id": 39484199, "link": "https://stackoverflow.com/questions/39484199/vba-insert-in-two-table-where-id-from-first-table-is-a-field-in-second", "title": "VBA - Insert in two table where id from first table is a field in second", "body": "<p>I have huge amount of data structured in two excel sheets with the following columns:</p>\n\n<pre><code>EXCEL DATA\n\nSheet1 [pod, client, address, ...etc] -one record per [pod]\nSheet2 [pod, pointofmeasure, typepct, ...etc] -one-to-many records per [pod]\n</code></pre>\n\n<p>-relationship is between <strong>sheet1.pod</strong> and <strong>sheet2.pod</strong> (one-to-many relationship)</p>\n\n<p>I need a sql to insert data from that excel sheets into a access database with the following tables structure:</p>\n\n<pre><code>ACCESS DATABASE\n\nTable1 [id, pod, client, address, ...etc]\nTable2 [id, pod_id, pod, pointofmeasure, typepct, ...etc]\n</code></pre>\n\n<p>Where table2.pod_id = table1.id</p>\n\n<p>Can be do it in one sql insert? </p>\n\n<p>I came up with this mass insert...</p>\n\n<pre><code>cn.Open scn\nssql = \"INSERT INTO table1 (pod, client, address, ...etc) \"\nssql = ssql &amp; \"SELECT * FROM [Excel 8.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].[sheet1$]\"\n\ncn.Execute ssql, cAffectedRows\ncn.Close\n</code></pre>\n\n<p>Now how the hell i get id's to insert data to table2 ?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1473832393, "post_id": 39483249, "comment_id": 66285121, "body": "mate, there are tons of this very same subject questions and answers spread over this site. just search for them and struggle with the solution to the issue most similar to yours"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1490315312, "post_id": 39483249, "comment_id": 73070266, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\">Open Excel file for reading with VBA without display</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1473832369, "creation_date": 1473832369, "answer_id": 39483338, "question_id": 39483249, "link": "https://stackoverflow.com/questions/39483249/using-other-workbook-without-opening-it/39483338#39483338", "title": "Using other workbook without opening it", "body": "<p>You need to create a new Excel Application to be able to hide the Window:</p>\n\n<pre><code>Dim xlApp As New Excel.Application 'New Excel Application\nDim xlWB As Excel.Workbook 'Workbook Object\n\nxlApp.Visible = False 'Hide Application\n\nSet xlWB = xlApp.Workbooks.Open(\"PATH TO FILE\") 'Open File in new App\n\n'do something here\nxlWB.Sheets(1).Cells(1, 1).Value = \"Hello, this is a Test\"\n\nxlWB.Close 'Close Workbook (Use SaveChanges:=True to save changes)\nSet xlWB = Nothing 'Clear Object\nxlApp.Quit 'Quit Excel App\nSet xlApp = Nothing 'Clear Object\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6829339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30b7f7e00dfda4ce2a3b6c04c1b4f54?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Jarzembi\u0144ski", "link": "https://stackoverflow.com/users/6829339/adam-jarzembi%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 39483338, "answer_count": 1, "score": -1, "last_activity_date": 1473838547, "creation_date": 1473832037, "last_edit_date": 1473838547, "question_id": 39483249, "link": "https://stackoverflow.com/questions/39483249/using-other-workbook-without-opening-it", "title": "Using other workbook without opening it", "body": "<p>I created Excel macro, in which I'm searching current date in other, closed workbook and getting the number of the row where this date is. Everything works perfectly, but only if I'm opening this other workbook. </p>\n\n<p>Is there a possibility to make the code works without opening this workbook? Or maybe it's possible to make this workbook not to appear, because I don't want it to appear on the screen? </p>\n\n<p>I've tried many methods, e.g. <code>Application.ScreenUpdating = false</code> or <code>ActiveWorkbook.Windows(1).Visible = False</code> but it doesn't work the way I want it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "edited": false, "score": 0, "creation_date": 1473835719, "post_id": 39483512, "comment_id": 66286594, "body": "Thanks for the help but is not working correctly: One it is Clearing Value in Column A instead of B and most important it is only considering 1st Matching Cell on both columns and not all.ALSO please note that it is not necessary the numbers or values in column A and B will be random and not necessary adjacent to each other."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "edited": false, "score": 0, "creation_date": 1473835864, "post_id": 39483512, "comment_id": 66286665, "body": "<i>One</i>) your question was not clear to me as to what column was to be <i>cleared</i> so I assumed it was column &quot;A&quot;. but the change is minimal . <i>Most Important</i>) I don&#39;t get you. please explain in more detail"}, {"owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "edited": false, "score": 0, "creation_date": 1473836100, "post_id": 39483512, "comment_id": 66286769, "body": "I ment that Values in Column A are not in Line (Adjesant) to Values in Column B.Values in Column B can be anywhere to march with calumn A.Does this clarify"}, {"owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "edited": false, "score": 0, "creation_date": 1473837758, "post_id": 39483512, "comment_id": 66287594, "body": "ure a genius it is working as required but only a small issue.it is matching full cell value for Column B with A and not 12 Charaters for Column B.So if A has a Value 999999999999/88888585851 And B has a value 999999999999/8998925566 then it is not matching, where as it should."}, {"owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "edited": false, "score": 0, "creation_date": 1473838155, "post_id": 39483512, "comment_id": 66287815, "body": "And 1 More issue...Varified is coming adjesent to matching cell B where as it should come inline (adjesnt) to matching cell A"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1473838596, "last_edit_date": 1473838596, "creation_date": 1473833274, "answer_id": 39483512, "question_id": 39483111, "link": "https://stackoverflow.com/questions/39483111/compare-two-colums-within-limited-number-of-characters-and-clear-duplicates/39483512#39483512", "title": "Compare two colums within limited number of characters and clear duplicates", "body": "<p><strong>edited</strong> after OP's clarifications</p>\n\n<p>you may try this code:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range, f As Range\n\n    With Worksheets(\"Clients\") '&lt;--| reference \"Clients\" worksheet (change \"Clients\" to your actual worksheet name)\n        With .Range(\"A1\", .Cells(.rows.Count, \"A\").End(xlUp)) '&lt;--| reference its column \"A\" cells from row 1 down to last non empty one\n            For Each cell In .Cells '&lt;--| loop through referenced cells\n                Set f = .Offset(, 1).Find(what:=Left(cell.Text, 12) &amp; \"*\", LookIn:=xlValues, lookat:=xlWhole) '&lt;--| look for current cell first twelve charachters string in adjacent column cells first 12 characters content\n                If Not f Is Nothing Then '&lt;--| if any match has been found...\n                    f.ClearContents '&lt;--|... clear column \"B\" cell that matched the search...\n                    cell.Offset(, 2).Value = \"Verified\" '&lt;--|... and write \"Verified\" in column \"C\"  current cell row\n                End If\n            Next cell\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 39483512, "answer_count": 1, "score": -1, "last_activity_date": 1585859785, "creation_date": 1473831287, "last_edit_date": 1585859785, "question_id": 39483111, "link": "https://stackoverflow.com/questions/39483111/compare-two-colums-within-limited-number-of-characters-and-clear-duplicates", "title": "Compare two colums within limited number of characters and clear duplicates", "body": "<p>I have three columns:</p>\n\n<pre><code>Client Numbers              Client Numbers Verified    Verification Status\n999999999999/98989691699    999999999999               Verified\n888888888888/58555555555    111111111111    \n454545454545/69412999999    888888888888               Verified\n22222222222/111111555555    YYYYYYYYYYYY    \n888888888888/56998165446        \n</code></pre>\n\n<p>I am trying to:<br>\na) Compare Columns A &amp; B with respect to Left 12 Characters Only and Find Duplicates<br>\nb) if Duplicate is found then Clear (Not Delete) the content in the Left 12 character, duplicate value found in Column B<br>\nc) And Input test \"Verified\" in column C in same row number as column A</p>\n\n<p>I found many macros that compare and delete contents but none that do as I require. I tried mixing some macros.</p>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1473833221, "post_id": 39483105, "comment_id": 66285480, "body": "I&#39;m unclear on why the <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow noreferrer\">COUNTIF function</a> is not sufficient but you should expand the parameters of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find method</a> beyond the defaults left by the previous usage."}, {"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 0, "creation_date": 1473833354, "post_id": 39483105, "comment_id": 66285535, "body": "I find another solution. Thanks for help"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473833584, "post_id": 39483545, "comment_id": 66285636, "body": "posting mine while you already posted yours. hope you don&#39;t mind . while on the OP&#39;s side <i>&quot;repetita juvant&quot;</i> always holds true!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1473833415, "creation_date": 1473833415, "answer_id": 39483545, "question_id": 39483105, "link": "https://stackoverflow.com/questions/39483105/how-many-times-is-repeated-cell-value-in-a-column-using-find-method/39483545#39483545", "title": "how many times is repeated cell value in a column . Using Find method", "body": "<p>I'm unclear on why the <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow\">COUNTIF function</a> is not sufficient but you should expand the parameters of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> beyond the defaults left by the previous usage and use <code>.Find(What:=Team)</code> with no quotes.</p>\n\n<p>If you are looking for the cell value of <code>Range(\"D34\")</code> within <code>Range(\"D33:D99\")</code>, it will always be found at least once.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1473833444, "creation_date": 1473833444, "answer_id": 39483556, "question_id": 39483105, "link": "https://stackoverflow.com/questions/39483105/how-many-times-is-repeated-cell-value-in-a-column-using-find-method/39483556#39483556", "title": "how many times is repeated cell value in a column . Using Find method", "body": "<p>change</p>\n\n<pre><code>Set r = .Find(What:=\"Team\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Set r = .Find(What:=Team)\n</code></pre>\n\n<p>and also follow Jeeped suggestions</p>\n"}], "owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473833444, "creation_date": 1473831239, "question_id": 39483105, "link": "https://stackoverflow.com/questions/39483105/how-many-times-is-repeated-cell-value-in-a-column-using-find-method", "title": "how many times is repeated cell value in a column . Using Find method", "body": "<p>The program should receive, how many times is repeated cell value (D34) in a column (D34:D99) . But the program displays zero.</p>\n\n<pre><code>Sub \u0440\u0430\u0441\u043f\u043e\u0437\u043d\u0430\u0442\u044c()\nDim r As Range\nDim firstAddress As String\nDim iLoop As Long\nDim book1 As Workbook\nDim Team As String \nSet book1 = Workbooks.Open(\"E:\\Super M\\\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0430\u0432\u043a\u0438\\\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u044f\\\u0423\u0441\u043e\u0432 4\\\u0411\u0410\u0417\u0410 \u0414\u0410\u041d\u041d\u042b\u0425\\\u0431\u043e\u043b\u0432\u0430\u043d\u043a\u0430\\\u0441\u0435\u0437\u043e\u043d \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u0438\\\u0410\u043d\u0433\u043b\u0438\u044f\\1-\u043e\u0435 \u043c\u0435\u0441\u0442\u043e\\3.xlsx\")\n Team = book1.Worksheets(\"3\").Range(\"D34\")\nWith book1.Worksheets(\"3\").Range(\"D33:D99\")\n\n    Set r = .Find(What:=\"Team\")\n    If Not r Is Nothing Then\n        firstAddress = r.Address\n        Do\n            iLoop = iLoop + 1\n            Set r = .FindNext(r)\n        Loop While Not r Is Nothing And r.Address &lt;&gt; firstAddress And iLoop &lt; 20\n    End If\nEnd With\nbook1.Worksheets(\"3\").Range(\"D100\").Value = iLoop\nbook1.Save\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1473838697, "post_id": 39482470, "comment_id": 66288110, "body": "I think it is possible. You can use the &quot;Row Source&quot; property of the listbox to take all entries in the listbox as string, then you can create an array from that string using split function and finally do anything you want with the array."}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1473838743, "post_id": 39482470, "comment_id": 66288135, "body": "However, the above is probably one of many similar solutions!"}, {"owner": {"reputation": 3, "user_id": 6829085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210229330626959/picture?type=large", "display_name": "Venkatesh Jayakumar", "link": "https://stackoverflow.com/users/6829085/venkatesh-jayakumar"}, "reply_to_user": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1473899562, "post_id": 39482470, "comment_id": 66320522, "body": "Thanks Blenikos. Like I mentioned below, I&#39;m not using a combo box, it&#39;s actually an in-cell data validation (List). Any way this can be implemented for an in-cell drop-down list?"}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1473957732, "post_id": 39482470, "comment_id": 66348321, "body": "I hadn&#39;t understood that you had a drop down list inside cell with data validation. I thought it was a combo box. Anyway the answer from Slai is just perfect! :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6829085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210229330626959/picture?type=large", "display_name": "Venkatesh Jayakumar", "link": "https://stackoverflow.com/users/6829085/venkatesh-jayakumar"}, "edited": false, "score": 0, "creation_date": 1473899522, "post_id": 39485224, "comment_id": 66320510, "body": "Thanks Miqi180. But I&#39;m not using a combo box, it&#39;s actually an in-cell data validation (List). Any way this can be implemented for an in-cell drop-down list?"}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 1, "last_activity_date": 1473839643, "creation_date": 1473839643, "answer_id": 39485224, "question_id": 39482470, "link": "https://stackoverflow.com/questions/39482470/vba-drop-down-list-get-items-before-and-after-the-selected-item/39485224#39485224", "title": "VBA: Drop down list - get items before and after the selected item", "body": "<p>This will do it:</p>\n\n<pre><code>' rename \"Combobox1\" to the name of your control below\nPrivate Sub ComboBox1_Change()\n\n    Dim idx As Long\n\n    With ComboBox1 \n        idx = .ListIndex\n        If idx = 0 Then\n            MsgBox \"Next item: \" &amp; .List(idx + 1, 0)\n        ElseIf idx = .ListCount - 1 Then\n            MsgBox \"Previous item: \" &amp; .List(idx - 1, 0)\n        Else\n            MsgBox \"Previous item: \" &amp; .List(idx - 1, 0) &amp; Chr(13) &amp; \"Next item: \" &amp; .List(idx + 1, 0)\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6829085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210229330626959/picture?type=large", "display_name": "Venkatesh Jayakumar", "link": "https://stackoverflow.com/users/6829085/venkatesh-jayakumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473908834, "last_edit_date": 1473908834, "creation_date": 1473908357, "answer_id": 39502489, "question_id": 39482470, "link": "https://stackoverflow.com/questions/39482470/vba-drop-down-list-get-items-before-and-after-the-selected-item/39502489#39502489", "title": "VBA: Drop down list - get items before and after the selected item", "body": "<p>I ended up importing the range into an array and then find the items before and after. Simple code below. Any inputs are welcome. Thanks heaps!</p>\n\n<pre><code>Sub GetItemBeforeAfter ()\nDim aArray As Variant\nDim sItem As String\nDim iCounter As Integer\nDim iPosition As Integer\nDim sItemBefore As String\nDim sItemAfter As String\naArray = ActiveWorkbook.Sheets(\"#DataSheet\").Range(\"A2:A51\").Value\nsItem = \"Death Star\"\n    With Application\n        For iCounter = LBound(aArray, 1) To UBound(aArray, 1)\n            iPosition = .Match(sItem, .Index(aArray, 0, iCounter), 0)\n            If IsNumeric(iPosition) Then\n                Select Case iPosition\n                    Case LBound(aArray, 1)\n                        sItemAfter = aArray(iPosition + 1, 1)\n                        MsgBox \"No Before!\"\n                        MsgBox \"After: \" &amp; sItemAfter\n                    Case UBound(aArray, 1)\n                        sItemBefore = aArray(iPosition - 1, 1)\n                        MsgBox \"Before: \" &amp; sItemBefore\n                        MsgBox \"No After!\"\n                    Case Else\n                        sItemBefore = aArray(iPosition - 1, 1)\n                        sItemAfter = aArray(iPosition + 1, 1)\n                        MsgBox \"Before: \" &amp; sItemBefore\n                        MsgBox \"After: \" &amp; sItemAfter\n                End Select\n            Exit For\n            Else\n                MsgBox \"Item Not Found\"\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6829085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210229330626959/picture?type=large", "display_name": "Venkatesh Jayakumar", "link": "https://stackoverflow.com/users/6829085/venkatesh-jayakumar"}, "edited": false, "score": 0, "creation_date": 1473919732, "post_id": 39503583, "comment_id": 66325293, "body": "this is perfect! I just tweaked it a little bit to suit my needs. Added &quot;LookAt:=xlWhole&quot; so that FIND looks at the whole cell. Thank you very much!"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1473916628, "creation_date": 1473916628, "answer_id": 39503583, "question_id": 39482470, "link": "https://stackoverflow.com/questions/39482470/vba-drop-down-list-get-items-before-and-after-the-selected-item/39503583#39503583", "title": "VBA: Drop down list - get items before and after the selected item", "body": "<p>The question does not have enough details for a good answer, but from what I understand you have the list of values in the range <code>#DataSheet!A2:A51</code> and the selected item in cell <code>A1</code> so something like:</p>\n\n<pre><code> Dim r As Range, c As Range\n Set r = [#DataSheet!A2:A51]\n Set c = r.Find([A1])\n If Not c Is Nothing Then\n    If c.Row &gt; r.Row Then MsgBox \"Before: \" &amp; c(0)\n    If c.Row &lt; r.Row + r.Rows.Count Then MsgBox \"After: \" &amp; c(2)\n End If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6829085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210229330626959/picture?type=large", "display_name": "Venkatesh Jayakumar", "link": "https://stackoverflow.com/users/6829085/venkatesh-jayakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 1, "accepted_answer_id": 39503583, "answer_count": 3, "score": -1, "last_activity_date": 1473916628, "creation_date": 1473827207, "last_edit_date": 1531164843, "question_id": 39482470, "link": "https://stackoverflow.com/questions/39482470/vba-drop-down-list-get-items-before-and-after-the-selected-item", "title": "VBA: Drop down list - get items before and after the selected item", "body": "<p>I have a drop-down list in my sheet. When I make a selection, is it possible to get the items before and after the selected item in the list?</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Owmmu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Owmmu.png\" alt=\"My List\"></a></p>\n\n<p>In the above list-\nIf the user selects \"Kylo\", I want to get \"Han\" and \"Leia\".\nIf \"Luke\" is selected, I want to get \"Leia\".\nAnd if \"Darth\" is selected, I want to get \"Han\".</p>\n\n<p>Is this possible?</p>\n\n<p>Cheers,\nVJ</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1473827389, "post_id": 39482366, "comment_id": 66283712, "body": "change system date format to dd-mm-yyyy."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1473827986, "post_id": 39482366, "comment_id": 66283837, "body": "there was no option for dd-mm-yyyy on my laptop, so I used dd-MM-yy. start_d is still incorrect: &quot;06-09-2016&quot;. Why is it not even in the format of the system date...??"}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1473828203, "post_id": 39482366, "comment_id": 66283899, "body": "@HA560 I was able to customize it to the date you asked, it still comes up with &quot;06-09-2016&quot;"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473828428, "post_id": 39482366, "comment_id": 66283956, "body": "You&#39;re working with dates as strings. It&#39;s much safer to work with dates as Dates - see my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1473828546, "post_id": 39482602, "comment_id": 66283987, "body": "I attempted this, and did again just now for sanity&#39;s sake. I changed start_d to a Date object and rid my code of the cdate and format parts. Alas... still no go... :("}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1473828994, "post_id": 39482602, "comment_id": 66284108, "body": "I&#39;ve added an edit that uses a Long to preserve the date as a numeric. You shouldn&#39;t need to, but hopefully it works for you."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1473829147, "post_id": 39482602, "comment_id": 66284146, "body": "If it still doesn&#39;t work - you could try changing <code>start_d = DateAdd(&quot;d&quot;, -7, today)</code> to <code>start_d = Int(Now) - 7</code>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 2, "creation_date": 1473829665, "post_id": 39482602, "comment_id": 66284288, "body": "The <code>Date</code> function returns a <code>Variant</code>, the <code>Date</code> parameter in <code>DateAdd</code> accepts a <code>Variant</code> and the <code>DateAdd</code> function returns a <code>Variant</code>. That leaves room for your system to interpret the date according to regional/system settings. By using a numeric expression/<code>Long</code> to reflect the date, you take away any ambiguity."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1473829799, "post_id": 39482602, "comment_id": 66284321, "body": "I understand. Thank you soooo much!"}, {"owner": {"reputation": 61, "user_id": 1576913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad706c1dcc4afdf888a8f170dedfb0f4?s=128&d=identicon&r=PG", "display_name": "captain puget", "link": "https://stackoverflow.com/users/1576913/captain-puget"}, "edited": false, "score": 0, "creation_date": 1594504409, "post_id": 39482602, "comment_id": 111151153, "body": "Well, I DON&#39;T understand, but after reading this I will forever use Date where tempted to use Double, and use Long for the interval in DateAdd.  Just now, I was using DateAdd to &#39;add&#39;  -1 (hour) to a Date.  The value did not change.  I changed any Doubles to Date, change -1 to -1#, and the thing finally &#39;worked&#39;.  I don&#39;t understand why, and I&#39;m gonna quit trying to figure it out..."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 2, "last_activity_date": 1473828924, "last_edit_date": 1473828924, "creation_date": 1473828181, "answer_id": 39482602, "question_id": 39482366, "link": "https://stackoverflow.com/questions/39482366/dateadd-return-value-is-incorrect/39482602#39482602", "title": "DateAdd return value is incorrect", "body": "<p>Change <code>start_d</code> to a <code>Date</code> type, and you can do away with the <code>Format</code> and <code>CDate</code> conversions:</p>\n\n<pre><code>Dim start_d As Date\n</code></pre>\n\n<p>Which gives you:</p>\n\n<pre><code>Sub addData()\nDim reportWeek As Integer\nDim numWeeks As Integer\nDim monthWeek As Integer\nDim start_d As Date\nDim thisYear As String\nDim thisMonth As String\nDim thisDay As String\n\n' the reports run every monday\nstart_d = DateAdd(\"d\", -7, Date)\n\nthisYear = Year(start_d)\nthisMonth = Month(start_d)\nthisDay = Day(start_d)\n\nreportWeek = WeekNum\nmonthWeek = getWeekOfMonth(start_d)\nnumWeeks = weekCount(thisYear, thisMonth)\n\nDebug.Print reportWeek &amp; monthWeek &amp; numWeeks &amp; thisYear &amp; thisMonth &amp; thisDay\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>\nSeems you're still having issues - let's try with a Long to represent Date:</p>\n\n<pre><code>Sub addData()\nDim reportWeek As Integer\nDim numWeeks As Integer\nDim monthWeek As Integer\nDim start_d As Date\nDim thisYear As String\nDim thisMonth As String\nDim thisDay As String\n\nDim today As Long\ntoday = Int(Now)\n\n' the reports run every monday\nstart_d = DateAdd(\"d\", -7, today)\n\nthisYear = Year(start_d)\nthisMonth = Month(start_d)\nthisDay = Day(start_d)\n\nreportWeek = WeekNum\n'monthWeek = getWeekOfMonth(start_d)\n'numWeeks = weekCount(thisYear, thisMonth)\n\nDebug.Print reportWeek &amp; monthWeek &amp; numWeeks &amp; thisYear &amp; thisMonth &amp; thisDay\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 39482602, "answer_count": 1, "score": 1, "last_activity_date": 1473828924, "creation_date": 1473826317, "last_edit_date": 1473828673, "question_id": 39482366, "link": "https://stackoverflow.com/questions/39482366/dateadd-return-value-is-incorrect", "title": "DateAdd return value is incorrect", "body": "<p>I know this may be a simple question, but I cannot figure this out. When running the debugger for VBA, the third argument on line 11 shows up as \"9/13/2016\" as expected, but start_d is \"06/09/2016\" for some reason???</p>\n\n<p>I have tried setting start_d to both a string and Date object, both yield the same result. All I want is for start_d to be 7 days before the current date. </p>\n\n<pre><code>Sub addData(lastRow As Integer, lab() As String, c() As String, IP() As String, usage() As String, fName As String)\nDim reportWeek As Integer\nDim numWeeks As Integer\nDim monthWeek As Integer\nDim start_d As Date ' As String UPDATED\nDim thisYear As String\nDim thisMonth As String\nDim thisDay As String\n\n' the reports run every monday\nstart_d = DateAdd(\"d\", -7, Date)\n'start_d = Format(start_d, \"dd/mm/yyyy\") UPDATED \n\nthisYear = year(start_d) 'year(CDate(start_d)) UPDATED\nthisMonth = month(start_d) 'month(CDate(start_d)) UPDATED\nthisDay = day(start_d) 'day(CDate(start_d)) UPDATED\n\nreportWeek = weekNum\nmonthWeek = getWeekOfMonth(CDate(start_d))\nnumWeeks = weekCount(thisYear, thisMonth)\n\nDebug.Print reportWeek &amp; monthWeek &amp; numWeeks &amp; thisYear &amp; thisMonth &amp; thisDay\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "double-click"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1473828000, "post_id": 39482461, "comment_id": 66283840, "body": "This is good! it works however I&#39;m protecting my worksheet so no one else can edit or change my other cells. For that specific b5 cell when i double click, it looks like it changes the format of that cell from being unlocked to locked. Is there a way around this?"}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "reply_to_user": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1473828090, "post_id": 39482461, "comment_id": 66283872, "body": "Change the .Clear to .Value = &quot;&quot;"}, {"owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "edited": false, "score": 0, "creation_date": 1473828389, "post_id": 39482461, "comment_id": 66283942, "body": "Mate you are a legend"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1473828419, "post_id": 39482461, "comment_id": 66283953, "body": "Protect the worksheet with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840611.aspx\" rel=\"nofollow noreferrer\">Worksheet.Protect method</a> using <code>UserInterfaceOnly:=True</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1473828801, "post_id": 39482461, "comment_id": 66284059, "body": "I don&#39;t understand how this works or what you think <b>Target</b> is. In the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.beforedoubleclick.aspx\" rel=\"nofollow noreferrer\">Worksheet.BeforeDoubleClick</a> event macro, Target is the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193314.aspx\" rel=\"nofollow noreferrer\">ActiveCell property</a> so why aren&#39;t you using it? Further, why are leaving the <i>edit on double-click</i> active? It should be <b>Cancel:=True</b>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1473828947, "post_id": 39482461, "comment_id": 66284099, "body": "Further, in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro you are reassigning <b>Target</b>. Why on earth would you reassign Target? More, how does this not call itself into a reiterative loop when you change the values in a worksheet without suspending events with <code>Application.EnableEvents = False</code>?"}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1473828992, "post_id": 39482461, "comment_id": 66284107, "body": "Above me, I am sure you can throw together a better answer."}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1473829487, "post_id": 39482461, "comment_id": 66284239, "body": "I accept you are better at it than me. I am reading and trying to fix it a little. I appreciate the chance to fix it and the feedback. I wasn&#39;t meaning to be nasty at all."}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": true, "score": 0, "last_activity_date": 1473829404, "last_edit_date": 1473829404, "creation_date": 1473827156, "answer_id": 39482461, "question_id": 39482351, "link": "https://stackoverflow.com/questions/39482351/automatically-display-please-enter-text-here-in-specific-cell/39482461#39482461", "title": "automatically display &quot;please enter text here&quot; in specific cell", "body": "<p>Never done it before so apologies if this is wrong but this seems to work.\nPlace the below in the worksheets code.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n   If Not Intersect(ActiveCell, Cells(5, 2)) Is Nothing Then Target.Clear\nEnd Sub\n\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n  If Cells(5,2).Value = \"\" Then Cells(5,2).Value = \"Please enter text.\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1473832948, "last_edit_date": 1473832948, "creation_date": 1473832153, "answer_id": 39483274, "question_id": 39482351, "link": "https://stackoverflow.com/questions/39482351/automatically-display-please-enter-text-here-in-specific-cell/39483274#39483274", "title": "automatically display &quot;please enter text here&quot; in specific cell", "body": "<p>You stated <em>'...and allow users to enter their desired text.'</em> I am going to assume a <strong>General</strong> cell format for the user-typed text.</p>\n\n<p>In the worksheet's code sheet:</p>\n\n<pre><code>Option Explicit\n\n'you can only double click a single cell so\n'no worries about Target being more than one cell here\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If Not Intersect(Cells(5, \"B\"), Target) Is Nothing Then\n        'Cancel = True    'only if you want to disable 'in-cell' editing\n        On Error GoTo bm_Safe_Exit\n        With Target\n            If .Value2 = \"please enter text here...\" Then\n                Application.EnableEvents = False\n                .Clear\n            End If\n        End With\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n\n'there is a worry about Target being more than one cell here\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Cells(5, \"B\"), Target) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n        Dim tmp As Variant\n        With Cells(5, \"B\")\n            If Not CBool(Len(.Value2)) Then\n                .Font.ColorIndex = 10\n                .Font.Italic = True\n                .Value = \"please enter text here...\"\n                .NumberFormat = \"&lt;@&gt;\"\n            Else\n                tmp = .Value\n                .Clear\n                .Value = tmp\n            End If\n        End With\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n\n'special cases when B5 is double-clicked but no input provided\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    With Cells(5, \"B\")\n        If Not CBool(Len(.Value2)) Then\n            Application.EnableEvents = False\n            .Font.ColorIndex = 10\n            .Font.Italic = True\n            .Value = \"please enter text here...\"\n            .NumberFormat = \"&lt;@&gt;\"\n        End If\n    End With\nbm_Safe_Exit:\n        Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This seems to cover everything\u00b9 I threw at it while minimizing computation time and effort. It provides rudimentary error control to maintain a stable user environment.</p>\n\n<hr>\n\n<p>\u00b9 <sub>Please do not ask me to explain anything without doing your own research first. If you find a specific point that you are having trouble with, I will endeavour to assist; if you cannot grasp a concept then take a course, it is beyond the scope of this venue to explain it all.</sub></p>\n"}], "owner": {"reputation": 63, "user_id": 4927230, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ba7732eacf189416b1b16c289c2bf34a?s=128&d=identicon&r=PG&f=1", "display_name": "cc_hey", "link": "https://stackoverflow.com/users/4927230/cc-hey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "accepted_answer_id": 39482461, "answer_count": 2, "score": 0, "last_activity_date": 1473832948, "creation_date": 1473826136, "last_edit_date": 1473832329, "question_id": 39482351, "link": "https://stackoverflow.com/questions/39482351/automatically-display-please-enter-text-here-in-specific-cell", "title": "automatically display &quot;please enter text here&quot; in specific cell", "body": "<p>Simply I want to use the double click to clear content feature on vba.</p>\n\n<p>I have a cell (B5) to be specific that needs to display \"please enter text here\" whenever there is no text in that cell and once the user double clicks the cell, it will erase and allow users to enter their desired text. If the users leave it and it's empty like i said it should display \"please enter text here...\"</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473829459, "post_id": 39481991, "comment_id": 66284232, "body": "it is possible, but you need to give more data, <code>PivotTable</code> Name, <code>PivotField</code> name, <code>PivotItem</code>, which cell are you looking for (instead of using <code>ActiveCell</code> which is not recommended) . Also upload your latest code attempt"}, {"owner": {"reputation": 1, "user_id": 6828996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4948acf1a400bb305b0b19fd7427971?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tan Aik Poh", "link": "https://stackoverflow.com/users/6828996/xavier-tan-aik-poh"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473834599, "post_id": 39481991, "comment_id": 66286090, "body": "@Shai Rado....It&#39;s Okay...I solved it using the other method <code>ActiveCell.PivotCell.RowItems.Item(ActiveCell.PivotCell.RowI&zwnj;&#8203;tems.Count)</code>....Thank&zwnj;&#8203;s for Helping"}], "owner": {"reputation": 1, "user_id": 6828996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4948acf1a400bb305b0b19fd7427971?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tan Aik Poh", "link": "https://stackoverflow.com/users/6828996/xavier-tan-aik-poh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473823134, "creation_date": 1473823134, "last_edit_date": 1531164843, "question_id": 39481991, "link": "https://stackoverflow.com/questions/39481991/excel-vba-dynamic-pivotitems", "title": "Excel VBA - Dynamic PivotItems", "body": "<p>Is it able to get PivotItems number based on <strong>Selection/ActiveCell location</strong>?</p>\n\n<p>EG: PivotTabel.RowFields(1).PivotItems(<strong>x</strong>)</p>\n\n<p>I would want to get <strong>x</strong> based on <strong>Selection/ActiveCell</strong> within the PivotItems location <strong>(Dynamic PivotItems)</strong>.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1473821854, "post_id": 39481781, "comment_id": 66282499, "body": "So what is your question? Check to see if you have values in <code>Arg(0)</code> and <code>Arg(1)</code>; if you don&#39;t, you&#39;re running from being double-clicked and you prompt for the values. How else would you expect to get them from a double-click?"}, {"owner": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473822948, "post_id": 39481781, "comment_id": 66282740, "body": "i suppose that makes sense.. the way its written now is the arguments can only passed by the command line."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473823098, "post_id": 39481781, "comment_id": 66282772, "body": "The only way you can provide them with a double click (without prompting for them) would be to hard-code them into the script, which doesn&#39;t seem to suit the requirements you&#39;ve described. A suggestion: For future questions, you should make an effort to actually state the question you&#39;re asking. This one did not, but reading between the lines was easy. Future questions may not fare so well, and downvotes pile up quickly on poorly asked questions."}, {"owner": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473823281, "post_id": 39481781, "comment_id": 66282818, "body": "no, I do wish to prompt when double clicked. Sorry if I wasn&#39;t clear about that. I will update the post to be crystal clear."}], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "edited": false, "score": 0, "creation_date": 1473826220, "post_id": 39482262, "comment_id": 66283442, "body": "thanks for this. I tried to run this but i get an error on Line 38, Char 3, Code: 800A03EA.  Also, will this code work with both command line and windows GUI as requested?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "edited": false, "score": 0, "creation_date": 1473828660, "post_id": 39482262, "comment_id": 66284020, "body": "There was a procedure inside, which I moved it out and updated the code above. Try using it. I cannot compile on my machine as I do not have openssl and other required stuff. Intention is to show you the use of inputbox to read userinput and pass it to a function. this can be used on double click."}, {"owner": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "edited": false, "score": 0, "creation_date": 1473828815, "post_id": 39482262, "comment_id": 66284067, "body": "works great now! i would just ask for when prompting to enter the file name is it possible to have a &#39;Browse&#39; button instead of manually typing in the file? although, i realize doing this might break the code because i am not factoring in paths.. the current code assumes the file is in the same directory as the script."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "edited": false, "score": 0, "creation_date": 1473830455, "post_id": 39482262, "comment_id": 66284530, "body": "Browse button not possible with input box. You can refer the reference of InputBox and can provide default values. This will minimize typing full path input to input box. If code is working fine, I hope this is what you are looking for, so plz mark it as solved/answered."}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": true, "score": 3, "last_activity_date": 1473828555, "last_edit_date": 1473828555, "creation_date": 1473825329, "answer_id": 39482262, "question_id": 39481781, "link": "https://stackoverflow.com/questions/39481781/enable-vbscript-to-run-in-both-command-line-and-by-double-click/39482262#39482262", "title": "enable vbscript to run in both command line and by double click", "body": "<p>Create a .vbs file with below code and place it at desktop. Double click it.</p>\n\n<pre><code>    PerformAction\n\nPrivate Sub PerformAction()\n\n  pfxFileName = Trim(InputBox(\"Enter Filename:\", \"My VB Script\"))\n  If pfxFileName = vbNullString Then\n    Exit Sub\n  End If\n\n  keyPassword = Trim(InputBox(\"Enter Password:\", \"My VB Script\"))\n  If keyPassword = vbNullString Then\n    Exit Sub\n  End If\n\n  ProcessCertificate pfxFileName, keyPassword\n\nEnd Sub\n\nPrivate Sub ProcessCertificate(ByVal pfxFileName, ByVal keyPassword)\n  Dim keyFileName, cerFileName, cabFileName\n  keyFileName = \"key.tmp\"\n  cerFileName = \"cer.tmp\"\n  cabFileName = \"cabundle.tmp\"\n\n  Dim oShell\n  Set oShell = WScript.CreateObject(\"WScript.Shell\")\n  return = oShell.run(\"cmd /C openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -nocerts -out \" &amp; keyFileName &amp; \" -passin pass:\" &amp; keyPassword &amp; \" -passout pass:\" &amp; keyPassword &amp; \" | openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -clcerts -nokeys -out \" &amp; cerFileName &amp; \" -passin pass:\" &amp; keyPassword &amp; \" | openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -cacerts -nokeys -out \" &amp; cabFileName &amp; \" -passin pass:\" &amp; keyPassword, 0, true)\n\n  ' strip all ca's except for the last block\n  Dim goFS: Set goFS = CreateObject(\"Scripting.FileSystemObject\")\n  Dim reCut: Set reCut = New RegExp\n  reCut.Global = True\n  reCut.Pattern = \"-----BEGIN CERTIFICATE-----[\\s\\S]+?-----END CERTIFICATE-----\"\n  Dim oMTS: Set oMTS = reCut.Execute(goFS.OpenTextFile(cabFileName).ReadAll())\n  Dim sBlock: sBlock = oMTS(oMTS.Count - 1).Value\n  ' WScript.Echo sBlock\n\n  SaveStringToFile cabFileName, sBlock\n\n  ' build pfx file\n  return = oShell.run(\"cmd /C openssl pkcs12 -export -in \" &amp; cerFileName &amp; \" -inkey \" &amp; keyFileName &amp; \" -certfile \" &amp; cabFileName &amp; \" -out NEW-\" &amp; pfxFileName &amp; \" -password pass:\" &amp; keyPassword &amp; \" -passin pass:\" &amp; keyPassword, 0, true)\n\n  Dim WshShell, strCurDir\n  Set WshShell = CreateObject(\"WScript.Shell\")\n  strCurDir = WshShell.CurrentDirectory\n  WScript.Echo vbNewLine &amp; \"&gt;&gt;&gt; Thew NEW PFX file is located in \" &amp; strCurDir &amp; \"\\\" &amp; \"NEW-\" &amp; pfxFileName\n\n  Set oShell = Nothing\n\n  ' remove files\n  Set obj = CreateObject(\"Scripting.FileSystemObject\")\n  obj.DeleteFile (cerFileName)\n  obj.DeleteFile (keyFileName)\n  obj.DeleteFile (cabFileName)\nEnd Sub\n\n  Sub SaveStringToFile(filename, text)\n      Dim fso, f\n      Set fso = CreateObject(\"Scripting.FileSystemObject\")\n      Set f = fso.OpenTextFile(filename, 2)\n      f.Write text\n      f.Close\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 1657, "user_id": 3436467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/538a738d964de5c65e568c1b35458bdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3436467", "link": "https://stackoverflow.com/users/3436467/user3436467"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1434, "favorite_count": 1, "accepted_answer_id": 39482262, "answer_count": 1, "score": 2, "last_activity_date": 1473828555, "creation_date": 1473821536, "last_edit_date": 1473823461, "question_id": 39481781, "link": "https://stackoverflow.com/questions/39481781/enable-vbscript-to-run-in-both-command-line-and-by-double-click", "title": "enable vbscript to run in both command line and by double click", "body": "<p>I have the following vbscript which works perfectly fine when run in the command line. Would love to incorporate this to work with the windows GUI when double clicked with a mouse.</p>\n\n<p><strong>Current Setup</strong></p>\n\n<p>Here is the current command to execute the vbscript - requires two arguments</p>\n\n<ol>\n<li>filename</li>\n<li>password</li>\n</ol>\n\n<p><code>cscript fix.vbs file.ext password</code></p>\n\n<p>Here is my code (fix.vbs):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Dim Arg, pfxFileName, keyFileName, cerFileName, cabFileName, keyPassword\nSet Arg = WScript.Arguments\n\npfxFileName = Arg(0)\nkeyPassword = Arg(1)\nkeyFileName = \"key.tmp\"\ncerFileName = \"cer.tmp\"\ncabFileName = \"cabundle.tmp\"\n\nDim oShell\nSet oShell = WScript.CreateObject (\"WScript.Shell\")\nreturn = oShell.run(\"cmd /C openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -nocerts -out \" &amp; keyFileName &amp; \" -passin pass:\" &amp; keyPassword &amp; \" -passout pass:\" &amp; keyPassword &amp; \" | openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -clcerts -nokeys -out \" &amp; cerFileName &amp; \" -passin pass:\" &amp; keyPassword &amp; \" | openssl pkcs12 -in \" &amp; pfxFileName &amp; \" -cacerts -nokeys -out \" &amp; cabFileName &amp; \" -passin pass:\" &amp; keyPassword, 0, true)\n\n' strip all ca's except for the last block\nDim goFS : Set goFS = CreateObject(\"Scripting.FileSystemObject\")\nDim reCut : Set reCut = New RegExp\nreCut.Global = True\nreCut.Pattern = \"-----BEGIN CERTIFICATE-----[\\s\\S]+?-----END CERTIFICATE-----\"\nDim oMTS : Set oMTS = reCut.Execute(goFS.OpenTextFile(cabFileName).ReadAll())\nDim sBlock : sBlock = oMTS(oMTS.Count - 1).Value\n' WScript.Echo sBlock\n\nSub SaveStringToFile(filename, text)\n    Dim fso, f\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fso.OpenTextFile(filename, 2)\n    f.Write text\n    f.Close\nEnd Sub\n\nSaveStringToFile cabFileName, sBlock\n\n' build pfx file\nreturn = oShell.run(\"cmd /C openssl pkcs12 -export -in \" &amp; cerFileName &amp; \" -inkey \" &amp; keyFileName &amp; \" -certfile \" &amp; cabFileName &amp; \" -out NEW-\" &amp; pfxFileName &amp; \" -password pass:\" &amp; keyPassword &amp; \" -passin pass:\" &amp; keyPassword, 0, true)\n\nDim WshShell, strCurDir\nSet WshShell = CreateObject(\"WScript.Shell\")\nstrCurDir    = WshShell.CurrentDirectory\nWScript.Echo vbNewLine &amp; \"&gt;&gt;&gt; Thew NEW PFX file is located in \" &amp; strCurDir &amp; \"\\\" &amp; \"NEW-\" &amp; pfxFileName\n\nSet oShell = Nothing\n\n' remove files\nSet obj = CreateObject(\"Scripting.FileSystemObject\")\nobj.DeleteFile(cerFileName)\nobj.DeleteFile(keyFileName)\nobj.DeleteFile(cabFileName)\n</code></pre>\n\n<p><strong>Required additions</strong></p>\n\n<ol>\n<li>Make the above mentioned code compatible to work when double clicked\nin windows GUI.</li>\n<li>Prompt the user to enter two arguments (browse to file) &amp; (file\npassword)</li>\n</ol>\n"}, {"tags": ["string", "vba", "search", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473933446, "post_id": 39483280, "comment_id": 66332732, "body": "@SophieUt, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474032613, "post_id": 39483280, "comment_id": 66379756, "body": "@SophieUt, it&#39;d be nice of you to give proper feedback to people trying helping you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1473832195, "creation_date": 1473832195, "answer_id": 39483280, "question_id": 39481724, "link": "https://stackoverflow.com/questions/39481724/combobox-search-second-string-search-between-the-lines-vba/39483280#39483280", "title": "Combobox Search, Second String, Search between the lines VBA", "body": "<p>assuming combobox is named after \"ComboBox1\", you may try the following code into the userform code pane</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim i As Long\n    Static found As Boolean '&lt;--| this will be used as this sub \"footprint\" and avoid its recursive and useless calls \n\n    If found Then '&lt;-- we're here just after the text update made by the sub itself, so we must do nothing but erase our \"footprint\" and have this sub run at the next user combobox change\n        found = False '&lt;--| erase our \"footprint\"\n        Exit Sub '&lt;--| exit sub\n    End If\n\n    With Me.ComboBox1 '&lt;--| reference userform combobox\n        If .Text = \"\" Then Exit Sub '&lt;--| exit if no text has been typed in\n        For i = 0 To .ListCount - 1 '&lt;--|loop through its list\n            If InStr(.List(i), .Text) &gt; 0 Then '&lt;--| if current list value contains typed in text...\n                found = True '&lt;--| leave our \"footprint\"\n                .Text = .List(i) '&lt;--| change text to the current list value. this will trigger this sub again but our \"footprint\" will make it exit \n                Exit For '&lt;--| exit loop\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6828928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93343712182a7520a2f2a8045134e622?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie Ut", "link": "https://stackoverflow.com/users/6828928/sophie-ut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473832195, "creation_date": 1473821008, "question_id": 39481724, "link": "https://stackoverflow.com/questions/39481724/combobox-search-second-string-search-between-the-lines-vba", "title": "Combobox Search, Second String, Search between the lines VBA", "body": "<p>at the moment I am working on a database with a Userform in VBA. The Userform has one Combobox that loads the data from a sheet. The values of the sheet will change, that is why I created it dynamically.</p>\n\n<p>The problem is, that the combobox is pretty long. For example, if I want to search for \"combustion engine\", I will type in \"comb\" and it shows me the whole input. So far, this works perfectly. But you always need to know the beginnung of the cell value.\nWhen I type just \"engine\" there won't be a match, cause no other entry starts with engine. I only have one colomn of data, so is there any solution to show e.g. \"combustion engine\" only by the input engine?\nThats only a simple example. The list of data includes a lot of cells which contain more than one word.</p>\n\n<p>Does anyone know a solution for my problem? I would be so grateful!\nThank you in advance,\nSophie</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 3, "creation_date": 1473820827, "post_id": 39481664, "comment_id": 66282314, "body": "Make a separate sub/function for generating the pdf&#39;s and call it within a loop."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "edited": false, "score": 0, "creation_date": 1473847792, "post_id": 39484602, "comment_id": 66293521, "body": "sh88 - thanks but it is giving me an error on the line - While (Sheets(&quot;Sheet2&quot;).Cells(i, 1) &lt;&gt; &quot;&quot;) do I need to add a reference to the column which houses the values?  Thanks again"}, {"owner": {"reputation": 106, "user_id": 6469404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88f641f2fab3560144a6f3cdcf6f07a?s=128&d=identicon&r=PG&f=1", "display_name": "sh88", "link": "https://stackoverflow.com/users/6469404/sh88"}, "reply_to_user": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "edited": false, "score": 0, "creation_date": 1473848400, "post_id": 39484602, "comment_id": 66293830, "body": "what error? is your worksheet named &quot;Sheet2&quot;? if not replace it with the right name. in which column in this sheet is the data youre looking for? then 1 in cells(i,1) stands for the first column. if its in another column you have to rplace the 1 with the correct column number"}, {"owner": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "edited": false, "score": 0, "creation_date": 1473871488, "post_id": 39484602, "comment_id": 66308854, "body": "The error I am receiving is Runtime 1004.  Application-defined or object-defined error.  I have since renamed the sheet and adjusted the code but to no avail."}, {"owner": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "edited": false, "score": 0, "creation_date": 1473873390, "post_id": 39484602, "comment_id": 66309843, "body": "Figured it out... I needed to define i.  Thanks"}, {"owner": {"reputation": 106, "user_id": 6469404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88f641f2fab3560144a6f3cdcf6f07a?s=128&d=identicon&r=PG&f=1", "display_name": "sh88", "link": "https://stackoverflow.com/users/6469404/sh88"}, "reply_to_user": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "edited": false, "score": 0, "creation_date": 1473875662, "post_id": 39484602, "comment_id": 66311035, "body": "Ok with <code>option explicit</code> you need <code>Dim i As Interger</code>"}], "tags": [], "owner": {"reputation": 106, "user_id": 6469404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88f641f2fab3560144a6f3cdcf6f07a?s=128&d=identicon&r=PG&f=1", "display_name": "sh88", "link": "https://stackoverflow.com/users/6469404/sh88"}, "is_accepted": false, "score": 0, "last_activity_date": 1473837501, "creation_date": 1473837501, "answer_id": 39484602, "question_id": 39481664, "link": "https://stackoverflow.com/questions/39481664/i-think-i-need-looping/39484602#39484602", "title": "I think I need looping", "body": "<p>Try this</p>\n\n<pre><code>Sheets(\"AM Dashboard\").Select\nRange(\"B5\").Select\n\nWhile (Sheets(\"Sheet2\").Cells(i, 1) &lt;&gt; \"\")\n    ActiveCell.FormulaR1C1 = Sheets(\"Sheet2\").Cells(i, 1)\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Users\\Google Drive\\Sales Reports\\Employee\" &amp; Sheets(\"Sheet2\").Cells(i, 1) &amp; \"\\Sales Dashboard_Employee\" &amp; Sheets(\"Sheet2\").Cells(i, 1) &amp; \"\" &amp; \" \" &amp; Format(Date, \"yyyymmdd\") &amp; \".pdf\", _\n        Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=False\n    i = i + 1\nWend\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6828910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ead4fee48655da2e08d86bc35c63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6828910/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474250800, "creation_date": 1473820444, "last_edit_date": 1474250800, "question_id": 39481664, "link": "https://stackoverflow.com/questions/39481664/i-think-i-need-looping", "title": "I think I need looping", "body": "<p>Very new to VBA, I have managed to create scripts that will generate and save/email pdfs. Thus far I have created a separate line for each change in the worksheet, for example:</p>\n\n<pre><code>Sheets(\"AM Dashboard\").Select\nRange(\"B5\").Select\nActiveCell.FormulaR1C1 = \"Employee1\"\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\Users\\Google Drive\\Sales Reports\\Employee1\\Sales Dashboard_Employee1\" &amp; \" \" &amp; Format(Date, \"yyyymmdd\") &amp; \".pdf\", _\n    Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=False\nRange(\"B5\").Select\nActiveCell.FormulaR1C1 = \"Employee2\"\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\Users\\Google Drive\\Sales Reports\\Employee2\\Sales Dashboard_Employee2\" &amp; \" \" &amp; Format(Date, \"yyyymmdd\") &amp; \".pdf\", _\n    Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=False\n</code></pre>\n\n<p>What I would like to do is have the code loop through a list in sheet2 column A until the cell is empty and populate B5 of the AM Dashboard sheet with the respective value. </p>\n\n<p>So for example, A1 would contain Employee1, A2 = Employee2, A3 = Employee3 etc.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1474630328, "post_id": 39481406, "comment_id": 66621127, "body": "I came here via your related question. So you know: amongst readers, there is an expectation on this site that you try something first, and then you show what you have tried. Whilst some readers do like to prove the theory wrong (see below), in general we are not a free code factory."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6828840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a88d71bc8799ed210c374db1e940730?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lee", "link": "https://stackoverflow.com/users/6828840/eugene-lee"}, "edited": false, "score": 0, "creation_date": 1473904629, "post_id": 39482788, "comment_id": 66321499, "body": "Wow I was expecting a reply. Thank you Richard. I will try this out tomorrow at work."}, {"owner": {"reputation": 1, "user_id": 6828840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a88d71bc8799ed210c374db1e940730?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lee", "link": "https://stackoverflow.com/users/6828840/eugene-lee"}, "edited": false, "score": 0, "creation_date": 1473946417, "post_id": 39482788, "comment_id": 66340726, "body": "It works great! TBH I have no idea how this works but thank you again. @RichardBerryhill"}, {"owner": {"reputation": 1, "user_id": 6828840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a88d71bc8799ed210c374db1e940730?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lee", "link": "https://stackoverflow.com/users/6828840/eugene-lee"}, "edited": false, "score": 0, "creation_date": 1473948078, "post_id": 39482788, "comment_id": 66341968, "body": "can you edit to the code so that the next  data copy and paste to next empty column. <a href=\"https://docs.google.com/spreadsheets/d/1NpCHZMOcbayiIgJahBrZrmEvOi20gtnLOkgx8xVnzuw/edit?usp=sharing\" rel=\"nofollow noreferrer\">Please click here for example</a>"}], "tags": [], "owner": {"reputation": 26, "user_id": 6829235, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208473796695014/picture?type=large", "display_name": "Richard Berryhill", "link": "https://stackoverflow.com/users/6829235/richard-berryhill"}, "is_accepted": false, "score": 1, "last_activity_date": 1474630519, "last_edit_date": 1474630519, "creation_date": 1473829327, "answer_id": 39482788, "question_id": 39481406, "link": "https://stackoverflow.com/questions/39481406/copy-and-paste-a-range-of-data-in-sheet-1-to-another-sheet-2-by-current-date/39482788#39482788", "title": "Copy and Paste a range of data in sheet 1 to another sheet 2 by current date", "body": "<p>I wrote a dynamic solution to this:</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nType EmailData\n    us As Object\n    ca As Object\nEnd Type\n\nPublic Sub RunDataMove()\nDim wsDataFrom As Worksheet\nDim wsDataTo As Worksheet\nDim eData As EmailData\nDim i As Long\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Set wsDataFrom = ThisWorkbook.Worksheets(\"DataFrom\") 'Change Worksheet names\n    Set wsDataTo = ThisWorkbook.Worksheets(\"DataTo\") 'Change Worksheet names\n\n    Set eData.us = CreateObject(\"Scripting.Dictionary\")\n    Set eData.ca = CreateObject(\"Scripting.Dictionary\")\n\n    With wsDataFrom\n        For i = 2 To .Cells.SpecialCells(xlCellTypeLastCell).Row\n            eData.us.Add .Cells(i, 3).Value, .Cells(i, 1).Value\n            eData.ca.Add .Cells(i, 3).Value, .Cells(i, 2).Value\n        Next i\n    End With\n\n    Call MoveDataByDate(wsDataTo, eData, DateAdd(\"d\", 0, Date)) 'Change add days +/- if needed\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\n    MsgBox \"Data for \" &amp; Date &amp; \" has been moved or updated\"\n\nEnd Sub\n\nPublic Sub MoveDataByDate(ByRef wsTo As Worksheet, ByRef eData As EmailData, ByVal eDate As Date)\nDim obj As Variant, i As Long, usCol As Long, caCol As Long, dCol As Long, keyName As String\n    With wsTo\n        For i = 1 To .Cells.SpecialCells(xlCellTypeLastCell).Column\n            If .Cells(1, i).Value = eDate Then\n                dCol = i\n                usCol = i\n                caCol = i + 1\n                Exit For\n            End If\n        Next i\n        If dCol = 0 And i &lt;&gt; 1 Then\n            usCol = i\n            caCol = i + 1\n        Else\n            usCol = 2\n            caCol = 3\n        End If\n        If .Cells(3, 1).Value = \"\" Then\n            i = 3\n            For Each obj In eData.us\n                .Cells(i, 1).Value = obj\n                i = i + 1\n            Next obj\n            .Cells.EntireColumn.AutoFit\n        End If\n        For i = 3 To .Cells.SpecialCells(xlCellTypeLastCell).Row\n            keyName = .Cells(i, 1).Value\n            If eData.us.exists(keyName) Then\n                .Cells(i, usCol).Value = eData.us(keyName)\n            End If\n            If eData.ca.exists(keyName) Then\n                .Cells(i, caCol).Value = eData.ca(keyName)\n            End If\n        Next i\n        .Cells(1, usCol).Value = eDate\n        .Range(.Cells(1, usCol), .Cells(1, caCol)).Merge\n        .Cells(2, usCol).Value = \"US\"\n        .Cells(2, caCol).Value = \"CA\"\n        With .Range(.Cells(1, usCol), .Cells(.Cells.SpecialCells(xlCellTypeLastCell).Row, caCol))\n            .ColumnWidth = 8\n            .HorizontalAlignment = xlCenter\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6828840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a88d71bc8799ed210c374db1e940730?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lee", "link": "https://stackoverflow.com/users/6828840/eugene-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1474630519, "creation_date": 1473818286, "last_edit_date": 1474630226, "question_id": 39481406, "link": "https://stackoverflow.com/questions/39481406/copy-and-paste-a-range-of-data-in-sheet-1-to-another-sheet-2-by-current-date", "title": "Copy and Paste a range of data in sheet 1 to another sheet 2 by current date", "body": "<p>I am very new to VBA.  Basically I have the following table on sheet 1</p>\n\n<p><a href=\"http://i.stack.imgur.com/sTGPr.png\" rel=\"nofollow\">table 1</a></p>\n\n<p>This gets updated daily with # emails we receive depending country / reason for contact. </p>\n\n<p>At the end of the day I would like to assign a macro button that will copy and paste the data to sheet 2 by current date. </p>\n\n<p><a href=\"http://i.stack.imgur.com/mf1Tr.png\" rel=\"nofollow\">sheet 2</a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1474440097, "post_id": 39481385, "comment_id": 66526140, "body": "Share you code. It may be that, you are getting error because of some other code. Also share screenshot of the error. This will help users at SO to suggest solution to the problem."}], "owner": {"reputation": 179, "user_id": 2183561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/997b7e4fc9b20d72a1f71527f2b90f8c?s=128&d=identicon&r=PG", "display_name": "RMittelman", "link": "https://stackoverflow.com/users/2183561/rmittelman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474449226, "creation_date": 1473818160, "last_edit_date": 1474449226, "question_id": 39481385, "link": "https://stackoverflow.com/questions/39481385/access-2016-the-method-you-tried-to-invoke-on-an-object-failed", "title": "Access 2016: The method you tried to invoke on an object failed", "body": "<p>This is on an upgraded Access solution from 2015 to 2016.  Also, new solution is using a MySQL backend database on Amazon Web Server.  So I'm not sure which change may be causing the issue.</p>\n\n<p>When I execute the code</p>\n\n<pre><code>DoCmd.RunCommand acCmdSaveRecord\n</code></pre>\n\n<p>Or, when I just move to another record, causing an intrinsic save, I get the error 2759 with the following description:</p>\n\n<blockquote>\n  <p>The method you tried to invoke on an object failed</p>\n</blockquote>\n\n<p>Also in some conditions when I apply a filter to the form I get this error also.</p>\n\n<p>Does anybody have a suggestion on how to fix this, and/or what is causing it?</p>\n"}, {"tags": ["excel", "vba", "vb6"], "answers": [{"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473819801, "post_id": 39481377, "comment_id": 66282104, "body": "The error is because the <code>ChartObject.CopyPicture</code> method doesn&#39;t have a <code>Size</code> parameter, but the <code>Chart</code> object <i>does</i>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473820198, "post_id": 39481377, "comment_id": 66282197, "body": "Neither the OP nor this answer tries to do <code>ChartObject.CopyPicture</code>.  And the OPs code <i>does</i> work if <code>mWorksheet</code> is active"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473821464, "post_id": 39481377, "comment_id": 66282430, "body": "Hmm, indeed. But using CopyPicture on the <code>ChartObject</code> avoids the need to activate the <code>Worksheet</code> in order to access the <code>Chart</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473823101, "post_id": 39481377, "comment_id": 66282773, "body": "@ThunderFrame I see no need to activate the worksheet in order to access the chart.  I&#39;ve run the code I posted with a different worksheet active (and even add a chart with the same name to the other sheet) and it runs fine - using Excel 2013.  The only caveat is I&#39;d add a parameter to the Paste to specify where to paste."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1473818069, "creation_date": 1473818069, "answer_id": 39481377, "question_id": 39481298, "link": "https://stackoverflow.com/questions/39481298/vba-activechart-copypicture-object-defined-error/39481377#39481377", "title": "VBA Activechart.CopyPicture object defined error", "body": "<p>As always, you should avoid using the <code>Active*</code> objects.</p>\n\n<p>change to</p>\n\n<pre><code>With mWorksheet\n     .ChartObjects(\"Chart 1\").Chart.CopyPicture Appearance:=xlScreen, Size:=xlScreen, Format:=xlPicture\n    .Paste\n    .ChartObjects(\"Chart 1\").Delete\nEnd With\n</code></pre>\n\n<p>Note, the reason you got the error is probably because <code>mWorksheet</code> was not active</p>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1473819464, "last_edit_date": 1495540866, "creation_date": 1473819464, "answer_id": 39481544, "question_id": 39481298, "link": "https://stackoverflow.com/questions/39481298/vba-activechart-copypicture-object-defined-error/39481544#39481544", "title": "VBA Activechart.CopyPicture object defined error", "body": "<p>You should create a reference to the ChartObject rather than activating and relying on the Active ChartObject.</p>\n\n<p>On 2013, there isn't any need to activate the sheet, but be aware of accessing the Chart property - That will require activating the sheet. See <a href=\"https://stackoverflow.com/questions/38916459/how-do-i-reference-charts-with-the-same-name-but-on-different-worksheets/39424280#39424280\">How do I reference charts with the same name, but on different worksheets?</a></p>\n\n<p>Also, The CopyPicture method doesn't have an argument named <code>Size</code>, so you'll need to remove the <code>Size:=xlScreen</code></p>\n\n<pre><code>Public Function Copy_Chart()\n  Dim mWorksheet\n  Set mWorksheet = Sheet1\n  If Not mWorksheet Is Nothing Then\n    With mWorksheet\n      .Activate\n      Dim cht As ChartObject\n      Set cht = .ChartObjects(\"Chart 1\")\n      cht.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n      .Paste\n      cht.Delete\n    End With\n  End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6703862, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/1482014095157870/picture?type=large", "display_name": "Vian Ojeda Garcia", "link": "https://stackoverflow.com/users/6703862/vian-ojeda-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2154, "favorite_count": 0, "accepted_answer_id": 39481377, "answer_count": 2, "score": 1, "last_activity_date": 1473819464, "creation_date": 1473817297, "question_id": 39481298, "link": "https://stackoverflow.com/questions/39481298/vba-activechart-copypicture-object-defined-error", "title": "VBA Activechart.CopyPicture object defined error", "body": "<p>Im having a problem while creating and copying a chart in vb6 using excel. I have these following code</p>\n\n<pre><code>Private Sub CreateChart(Optional ByVal ChartTitle As String _\n                , Optional ByVal xAxis As Excel.Range _\n                , Optional ByVal yAxis As Excel.Range _\n                , Optional ByVal ColumnName As String _\n                , Optional ByVal LegendPosition As XlLegendPosition = xlLegendPositionRight _\n                , Optional ByVal rowIndex As Long = 2 _\n                , Optional ByRef ChartType As String = xlLineMarkers _\n                , Optional ByVal PlotAreaColorIndex As Long = 2 _\n                , Optional ByVal isSetLegend As Boolean = False _\n                , Optional ByVal isSetLegendStyle As Boolean = False _\n                , Optional ByVal LegendStyleValue As Long = 1)\n\nConst constChartLeft = 64\nConst constChartHeight = 300\nConst constChartWidth = 700\n\nDim xlChart As Excel.ChartObject\nDim seriesCount As Long\nDim ColorIndex As Long\nDim marrayhold() As Variant\nDim counter As Long\n\nDim j As Long\n\n\nWith mWorksheet\n    .Rows(rowIndex).RowHeight = constChartHeight\n\n    Set xlChart = .ChartObjects.Add(.Rows(rowIndex).Left, .Rows(rowIndex).Top, constChartWidth, constChartHeight)\nEnd With\n\nWith xlChart.chart\n    .ChartType = ChartType\n\n    .SetSourceData Source:=yAxis, PlotBy:=xlRows\n    .SeriesCollection(1).XValues = xAxis\n    .HasTitle = True\n\n    .Legend.Position = LegendPosition\n    .Legend.Font.Size = 7.3\n    .Legend.Font.Bold = True\n    .Legend.Border.LineStyle = xlNone\n    .Legend.Border.ColorIndex = 1\n\n    .ChartTitle.Characters.Text = ChartTitle\n    .ChartTitle.Font.Bold = True\n\n    .Axes(xlValue).TickLabels.Font.Size = 8 ' yAxis Labels\n    .Axes(xlCategory).TickLabels.Font.Size = 8 ' xAxis Labels\n\n    .PlotArea.Interior.ColorIndex = PlotAreaColorIndex\n    .PlotArea.Interior.ColorIndex = 15\n    .PlotArea.Interior.PatternColorIndex = 1\n    .PlotArea.Interior.Pattern = xlSolid\n    xlChart.Name = \"Chart 1\"\n    Call Copy_Chart\nEnd With\nEnd Sub\n</code></pre>\n\n<p>There is a function for copying the chart and this is where the error occurs</p>\n\n<pre><code>Public Function Copy_Chart()\nWith mWorksheet\n    .ChartObjects(\"Chart 1\").Activate\n    ActiveChart.CopyPicture Appearance:=xlScreen, Size:=xlScreen, format:=xlPicture\n    .Paste\n    .ChartObjects(\"Chart 1\").Delete\nEnd With\nEnd Function\n</code></pre>\n\n<p>in the line <code>ActiveChart.CopyPicture</code> I get an error message that said \"application-defined or object-defined error\" I tried researching but I cant seem to find a way to fix this error. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473812099, "post_id": 39480688, "comment_id": 66280466, "body": "Does the new workbook have sheets named &quot;SourceNamedSheet&quot; and &quot;DestinationNamedSheet&quot;?"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473812237, "post_id": 39480688, "comment_id": 66280492, "body": "Yes those sheets are named."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1473812740, "post_id": 39480688, "comment_id": 66280602, "body": "Are you sure the error is on the <code>Set wb1</code> line, and not the next?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473830702, "post_id": 39480688, "comment_id": 66284590, "body": "@t.mo is &quot;C:\\Test\\DST.xlsm&quot; the workbook with this code in it ? if it is, you can use <code>Set wb = ThisWorkbook</code>, If not where is this <code>Sub CopySheetsl</code> located ? a third workbook ?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1473818375, "creation_date": 1473818375, "answer_id": 39481418, "question_id": 39480688, "link": "https://stackoverflow.com/questions/39480688/what-is-my-error-is-setting-this-up-this-sub-runs-perfectly-in-a-different-work/39481418#39481418", "title": "What is my error is setting this up? This Sub runs perfectly in a different workbook", "body": "<p>If <code>DST.xlsm</code> is open already then</p>\n\n<p><code>Set wb = Workbooks(\"DST.xlsm\")</code></p>\n\n<p>ElseIf you need to open <code>DST.xlsm</code> </p>\n\n<p><code>Set wb1 = Workbooks.Open(\"C:\\Test\\DST.xlsm\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1473933488, "post_id": 39484082, "comment_id": 66332762, "body": "@t.mo, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474032569, "post_id": 39484082, "comment_id": 66379727, "body": "@t.mo, it&#39;d be nice of you to give proper feedback to people trying helping you"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1474910864, "post_id": 39484082, "comment_id": 66715640, "body": "Sorry for the delayed response.  I did some additional reading after your post and used the GetorSetWorkbook() and it worked great.  Thanks for your input."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1474912233, "post_id": 39484082, "comment_id": 66716320, "body": "You are welcome. Glad to see it really helped. Thanks for accepting the answer. Good coding!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1473835613, "creation_date": 1473835613, "answer_id": 39484082, "question_id": 39480688, "link": "https://stackoverflow.com/questions/39480688/what-is-my-error-is-setting-this-up-this-sub-runs-perfectly-in-a-different-work/39484082#39484082", "title": "What is my error is setting this up? This Sub runs perfectly in a different workbook", "body": "<p>for a more robust approach to workbooks handling you may want to use the following <code>GetOrSetWorkbook()</code> function:</p>\n\n<pre><code>Option Explicit\n\nFunction GetOrSetWorkbook(wbName As String) As Workbook        \n    On Error Resume Next\n    Set GetOrSetWorkbook = Workbooks(GetNameOnly(wbName)) '&lt;--| check if a workbook with given name is already open\n    If GetOrSetWorkbook Is Nothing Then Set GetOrSetWorkbook = Workbooks.Open(wbName) '&lt;--| if no workbook open with given name then try opening it with full given path\nEnd Function\n</code></pre>\n\n<p>which uses the following <em>helper</em> <code>GetNameOnly()</code> function:</p>\n\n<pre><code>Function GetNameOnly(pathStrng As String) As String\n    Dim iSlash As Long\n\n    iSlash = InStrRev(pathStrng, \"\\\")\n    If iSlash &gt; 0 Then\n        GetNameOnly = Mid(pathStrng, iSlash + 1, Len(pathStrng))\n    Else\n        GetNameOnly = pathStrng\n    End If\nEnd Function\n</code></pre>\n\n<p>so that a possible use of it could be:</p>\n\n<pre><code>Option Explicit\n\nSub CopySheetsl()\n\n    Dim wb As Workbook, wb1 As Workbook\n    Dim LastRow As Long\n\n    Set wb = GetOrSetWorkbook(\"C:\\Test\\DST.xlsm\") '&lt;--| try getting \"C:\\Test\\DST.xlsm\"\n    If wb Is Nothing Then '&lt;--| if unsuccessful...\n        '... code to handle C:\\Test\\DST.xlsm workbook error, like:\n        MsgBox \"Couldn't find 'C:\\Test\\DST.xlsm' !\", vbCritical + vbOKOnly\n    End If\n\n    Set wb1 = GetOrSetWorkbook(\"C:\\Test\\Source.xlsx\") '&lt;--| try getting \"C:\\Test\\Source.xlsx\n    If wb Is Nothing Then '&lt;--| if unsuccessful...\n        '... code to handle 'C:\\Test\\Source.xlsx' workbook error, like:\n        MsgBox \"Couldn't find 'C:\\Test\\Source.xlsx'!\", vbCritical + vbOKOnly\n    End If\n\n\n    'here goes rest of the code to be executed once all necessary workbooks have been properly set\n    wb1.Sheets(\"SourceNamedSheet\").Range(\"A1\") = wb.Sheets(\"DestinationNamedSheet\").Range(\"A1\").Value\n\n    wb1.Close\nEnd Sub\n</code></pre>\n\n<p>of course a very similar <em>GetOrSet</em> approach can be assumed with worksheets, too...</p>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 39484082, "answer_count": 2, "score": 0, "last_activity_date": 1473835613, "creation_date": 1473811786, "last_edit_date": 1473812221, "question_id": 39480688, "link": "https://stackoverflow.com/questions/39480688/what-is-my-error-is-setting-this-up-this-sub-runs-perfectly-in-a-different-work", "title": "What is my error is setting this up? This Sub runs perfectly in a different workbook", "body": "<p>A \"Runtime Error 9, Subscript Out of Range\" is received on the Set wb1 line.  This similar structure runs fine in a different workbook without error.</p>\n\n<p>My goal is to copy a cell from the Source document into te Destination document.</p>\n\n<pre><code>Sub CopySheetsl()\n\n    Dim wb As Workbook, wb1 As Workbook\n    Dim LastRow As Long\n\n    Set wb = Workbooks(\"C:\\Test\\DST.xlsm\")\n    Set wb1 = Workbooks.Open(\"C:\\Test\\Source.xlsx\")\n\n    wb1.Sheets(\"SourceNamedSheet\").Range(\"A1\") = wb.Sheets(\"DestinationNamedSheet\").Range(\"A1\").Value\n\n    wb1.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "templates", "events", "ms-word", "word-contentcontrol"], "comments": [{"owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "edited": false, "score": 0, "creation_date": 1473841793, "post_id": 39480335, "comment_id": 66289840, "body": "I don&#39;t have a solution but to explain why this isn&#39;t happening - The event is triggered for the active document, the template in startup essentially runs in the background, and so when you are working on another document and do the action the event is triggered in this document and not in your template."}], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 6828565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e7c6730d334c619c3562dd41a0df00?s=128&d=identicon&r=PG&f=1", "display_name": "DGulledge", "link": "https://stackoverflow.com/users/6828565/dgulledge"}, "edited": false, "score": 0, "creation_date": 1473951982, "post_id": 39486675, "comment_id": 66344801, "body": "I believe I understand the basic concept of what you explained. I&#39;ll post the code I have so far for this appended to my question above, but my experience with class modules is limited.  Can you elaborate on listening to the AutoExec and other general events?  Would this go in the global template file or the active document?"}, {"owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "reply_to_user": {"reputation": 150, "user_id": 6828565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e7c6730d334c619c3562dd41a0df00?s=128&d=identicon&r=PG&f=1", "display_name": "DGulledge", "link": "https://stackoverflow.com/users/6828565/dgulledge"}, "edited": false, "score": 0, "creation_date": 1474006920, "post_id": 39486675, "comment_id": 66365071, "body": "@DGulledge take a look at my answer, I edited it to give you more information."}], "tags": [], "owner": {"reputation": 98, "user_id": 6826556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbWZV.png?s=128&g=1", "display_name": "codeguy", "link": "https://stackoverflow.com/users/6826556/codeguy"}, "is_accepted": true, "score": 0, "last_activity_date": 1474006877, "last_edit_date": 1474006877, "creation_date": 1473844487, "answer_id": 39486675, "question_id": 39480335, "link": "https://stackoverflow.com/questions/39480335/word-global-template-vba-contentcontrolonexit-event-not-firing-when-placed-in-t/39486675#39486675", "title": "Word Global Template VBA: ContentControlOnExit event not firing when placed in the Startup folder", "body": "<p>I have already faced this issue in the past as well.\nYou won't get it to work like that, it will only fire the event for the <code>ContentControlOnExit</code> event on your loaded \"*.dotm\"-file itself.</p>\n\n<p>To react to changes occuring outside of your macro-document, you have to use a rather complicated construct, which I will briefly explain to you.</p>\n\n<p>You have to create a Class <code>clsDocument</code> in which you have a variable <code>Public WithEvents p_Document as Word.Document</code>. Inside of your class, you then listen to the Event <code>ContentControlOnExit</code> of your <code>p_Document</code> and put your code in there (in your case <code>MsgBox (\"Fired\")</code>.</p>\n\n<p>Next, you have to listen to the general events \"AutoExec\" and \"AutoOpen\" as well as the \"Application_DocumentChange\". In all of those events you basically just set the global variable <code>p_Document</code> to the value of either the document passed to the event or (if there is no document passed to the eventhandler) the active document.\nSince all of those event-reactions do more or less the same thing, create a new procedure in a module of your macro like that:</p>\n\n<pre><code>Public g_clsWordDocument                     As clsDocument\n\nPublic Sub SetUpDocumentEvents(Optional ByRef a_Document As Word.Document = Nothing)\n\nIf Application.Documents.Count &gt; 0 Then\n   If a_Document Is Nothing Then Set a_Document = ActiveDocument\n   Set g_clsDocument = New clsDocument\n   Set g_clsDocument.p_Document = a_Document\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Then, create the following procedures in your <code>ThisDocument</code> of your macro-file.</p>\n\n<pre><code>Option Explicit\n\nPrivate g_clsWordApplication            As clsApplication\n\n\nPublic Sub AutoExec()\n\nSet g_clsWordApplication = New clsApplication\nSet g_clsWordApplication.WordApplication = Word.Application\n\nCall modYourModule.SetUpDocumentEvents\n\nEnd Sub\n\nPrivate Sub Document_New()\n   Call modYourModule.SetUpDocumentEvents\nEnd Sub\n\nPrivate Sub Document_Open()\n   Call modYourModule.SetUpDocumentEvents\nEnd Sub\n\nPublic Sub AutoOpen()\n   Call modYourModule.SetUpDocumentEvents\nEnd Sub\n</code></pre>\n\n<p>Like that, you can catch the document events. As you see in the <code>AutoExec</code> function, it is the same for the application object, just create a new <code>clsAplication</code> that with an <code>WithEvents WordApplication as Word.Application</code> and you can react to the events. All of this code goes into your dotm-file, so the global template file.</p>\n\n<p>In this way, you can react to the event that you wanted to.\nAlthough I haven't found another way to solve this problem, I am still not satisfied with how it has to be implemented. If there is another option to solve your problem, I strongly suggest to try and do it another way.</p>\n"}], "owner": {"reputation": 150, "user_id": 6828565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e7c6730d334c619c3562dd41a0df00?s=128&d=identicon&r=PG&f=1", "display_name": "DGulledge", "link": "https://stackoverflow.com/users/6828565/dgulledge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 39486675, "answer_count": 1, "score": -1, "last_activity_date": 1545419858, "creation_date": 1473808681, "last_edit_date": 1545419858, "question_id": 39480335, "link": "https://stackoverflow.com/questions/39480335/word-global-template-vba-contentcontrolonexit-event-not-firing-when-placed-in-t", "title": "Word Global Template VBA: ContentControlOnExit event not firing when placed in the Startup folder", "body": "<p>The code below is placed in the ThisDocument word object in a .dotm template file.  When the file is opened directly, the event below fires as intended, each time a content control in the active document is exited.  However, when the template is placed in the Startup folder and opens automatically, the event does not fire.</p>\n\n<p>Any ideas as to how this should be modified to work as intended from the Startup folder?</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal ContentControl As _\nContentControl, Cancel As Boolean)\n    MsgBox (\"Fired\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 53, "user_id": 4775414, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/244955f8e33171a0206f0b0b3229600e?s=128&d=identicon&r=PG&f=1", "display_name": "MechMachineMan", "link": "https://stackoverflow.com/users/4775414/mechmachineman"}, "edited": false, "score": 0, "creation_date": 1473812894, "post_id": 39480180, "comment_id": 66280644, "body": "So after about 2 hrs of searching, I came across a post that suggested I need to use look-aheads to reset the expressions (this literally is another language to me). This results in:  &quot;(?=(^((?!OldVersions).)*$))(.*\\.(iam|ipt|ipn|idw))&quot;  which seems to work.  Source: <a href=\"http://stackoverflow.com/questions/869809/combine-regexp\">stackoverflow.com/questions/869809/combine-regexp</a>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473835544, "post_id": 39480180, "comment_id": 66286511, "body": "Don&#39;t use the tempered greedy token here, a mere lookahead will do."}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 2, "last_activity_date": 1473836648, "creation_date": 1473836648, "answer_id": 39484347, "question_id": 39480180, "link": "https://stackoverflow.com/questions/39480180/how-to-write-a-regular-expressions-to-populate-a-list-with-given-file-types-ex/39484347#39484347", "title": "How to write a regular expressions to populate a list with given file types &amp; exclude certain folders", "body": "<p>To exclude matching strings having <code>\\OldVersions\\</code> or <code>\\Legacy\\</code>, just add anchors and a negative lookahead at the start:</p>\n\n<pre><code>^(?!.*\\\\(?:OldVersions|Legacy)\\\\).*\\.(?:iam|ipt|ipn|idw)$\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/nB9hE0/1\" rel=\"nofollow\">regex demo</a></p>\n\n<p><strong>Details</strong>:</p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>(?!.*\\\\(?:OldVersions|Legacy)\\\\)</code> - a negative lookahead failing the match if there is <code>\\</code> + either <code>OldVersions</code> or <code>Legacy</code> + <code>\\</code> after 0+ chars other than <code>\\r</code> and <code>\\n</code> (<code>.*</code>).</li>\n<li><code>.*</code> - 0+ chars other than <code>\\r</code> and <code>\\n</code>, as many as possible, up to the last...</li>\n<li><code>\\.</code> - literal <code>.</code></li>\n<li><code>(?:iam|ipt|ipn|idw)</code> - one of the alternatives in the non-capturing group</li>\n<li><code>$</code> - end of string.</li>\n</ul>\n"}], "owner": {"reputation": 53, "user_id": 4775414, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/244955f8e33171a0206f0b0b3229600e?s=128&d=identicon&r=PG&f=1", "display_name": "MechMachineMan", "link": "https://stackoverflow.com/users/4775414/mechmachineman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1473836648, "creation_date": 1473807433, "last_edit_date": 1495542172, "question_id": 39480180, "link": "https://stackoverflow.com/questions/39480180/how-to-write-a-regular-expressions-to-populate-a-list-with-given-file-types-ex", "title": "How to write a regular expressions to populate a list with given file types &amp; exclude certain folders", "body": "<p>I've done a lot of searching on this but still can't quite put it all together.</p>\n\n<p>I'm trying create an Excel VBA program that populates a spreadsheet based on a user inputting regular expressions so that I can process the files with other vba programs.</p>\n\n<p>So for example, if I want to populate a folder with all Autodesk Inventor file types , I would use:</p>\n\n<pre><code>.*\\.(iam|ipt|ipn|idw)\n</code></pre>\n\n<p>and from what I have read, if I want a regex to skip a file in a folder OR containing a string, I would use something like:</p>\n\n<pre><code>(?iOldVersions)\n</code></pre>\n\n<p>but like I mentioned, I am having trouble putting this together so that it is a single reg ex call -- and also, if there are multiple strings that I want it to skip (ie; the folders <em>OldVersions</em> and <em>Legacy</em>)</p>\n\n<p>I think I would like to keep it as regex although I'm guessing I could also use wScript.Shell (or whatever that object is) but It would be nice to just get familiar with regular expressions for now.</p>\n\n<p>The code I am using is the same from this post, but instead I added a parameter to pass the pattern to the top level code by pulling it from a cell in excel.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/555776/list-files-of-certain-pattern-using-excel-vba\">List files of certain pattern using Excel VBA</a></p>\n\n<p>Again, any help would be greatly appreciated!</p>\n\n<p>Thanks again, all!</p>\n\n<p>Edit: Latest attempt....</p>\n\n<pre><code>Private Sub FindPatternMatchedFiles()\n\nobjFile = \"C:\\OldVersions\\TestFile.iam\"\n\nDim objRegExp As Object\nSet objRegExp = CreateObject(\"VBScript.RegExp\")\n\n'objRegExp.Pattern = \"(.*\\.(iam|ipt|ipn|idw))(?!(\\z)).\"\nobjRegExp.Pattern = \"(^((?!OldVersions).)*$)(.*\\.(iam|ipt|ipn|idw))\"\n\nobjRegExp.IgnoreCase = True\n\nres = objRegExp.test(objFile)\nMsgBox (res)\n\n'Garbage Collection\nSet objRegExp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "time", "transfer"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1473805641, "post_id": 39479865, "comment_id": 66278883, "body": "<a href=\"http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11783/date#t=201609132226475078262\">Date</a> will store either a date or time.  It&#39;s how Excel stores them natively."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1473807474, "last_edit_date": 1473807474, "creation_date": 1473805716, "answer_id": 39479906, "question_id": 39479865, "link": "https://stackoverflow.com/questions/39479865/transferring-times-from-one-sheet-to-another-which-dim-option/39479906#39479906", "title": "Transferring times from one sheet to another - which dim option?", "body": "<p>If you dim the time variable as a Date, the cell format will make it across with your approach.</p>\n\n<p>If the time is stored and displaying in the cell as a time value, its underlying data type is a decimal number less than 1. So you could also dim it as a double. </p>\n\n<p>The format will not come across to the new cell if you use a double in your current code, though, just the cell value. You would need to format the target cell with your preferred time format. </p>\n\n<p>So, Date is the data type you want to dim to. </p>\n"}], "owner": {"reputation": 21, "user_id": 6816231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d2fe5fc10f28f00a95740398cfa057?s=128&d=identicon&r=PG&f=1", "display_name": "G Cob", "link": "https://stackoverflow.com/users/6816231/g-cob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473807474, "creation_date": 1473805508, "question_id": 39479865, "link": "https://stackoverflow.com/questions/39479865/transferring-times-from-one-sheet-to-another-which-dim-option", "title": "Transferring times from one sheet to another - which dim option?", "body": "<p>I have been working on the following code to automate data transfer from one sheet to another; however I am stuck on how to write the time element. The time would be in format hh:mm and would be transferred in the same format. Any help would be greatly appreciated!!</p>\n\n<pre><code>    Private Sub Commandbutton1_Click()\n\n    Dim Dateadded As Date\n    Dim Time As ???\n    Dim nameoftask As String\n    Dim typeoftask As String\n    Dim Iffollowupwhichtaskisitfollowing As String\n    Dim Howwastaskcommunicated As String\n    Dim Whowastaskcommunicatedto As String\n    Dim Whorequestedtask As String\n    Dim Whatistaskrequiredfor As String\n    Dim Descriptionoftask As String\n    Dim Deadlinefortask As Date\n    Dim myData As Workbook\n\n    Worksheets(\"sheet1\").Select\n    Dateadded = Range(\"b5\")\n    Time = Range(\"b7\")\n    nameoftask = Range(\"b9\")\n    typeoftask = Range(\"b11\")\n    Iffollowupwhichtaskisitfollowing = Range(\"b13\")\n    Howwastaskcommunicated = Range(\"b15\")\n    Whorequestedtask = Range(\"b17\")\n    Whatistaskrequiredfor = Range(\"b19\")\n    Descriptionoftask = Range(\"b21\")\n    Deadlinefortask = Range(\"b23\")\n\n    Set myData = Workbooks.Open(\"filelink\")\n    Worksheets(\"sheet1\").Select\n    Worksheets(\"sheet1\").Range(\"a1\").Select\n    RowCount = Worksheets(\"sheet1\").Range(\"a1\").CurrentRegion.Rows.Count\n    With Worksheets(\"sheet1\").Range(\"a1\")\n    .Offset(RowCount, 1) = Date\n    .Offset(RowCount, 2) = Time\n    .Offset(RowCount, 3) = nameoftask\n    .Offset(RowCount, 4) = typeoftask\n    .Offset(RowCount, 5) = Iffollowupwhichtaskisitfollowing\n    .Offset(RowCount, 6) = Howwastaskcommunicated\n    .Offset(RowCount, 7) = Whowastaskcommunicatedto\n    .Offset(RowCount, 8) = Whorequestedtask\n    .Offset(RowCount, 9) = Whatistaskrequiredfor\n    .Offset(RowCount, 10) = Descriptionoftask\n    .Offset(RowCount, 11) = Deadlinefortask\n    End With\n    myData.Save\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1473805252, "post_id": 39479702, "comment_id": 66278763, "body": "Sorry I cant see the image at the moment but maybe this question will assist. <a href=\"http://stackoverflow.com/questions/18586815/count-unique-values-in-a-column-in-excel\" title=\"count unique values in a column in excel\">stackoverflow.com/questions/18586815/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 6072971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tguckkRniVI/AAAAAAAAAAI/AAAAAAAAASk/b-xl_tGh6Ew/photo.jpg?sz=128", "display_name": "ravi sundriyal", "link": "https://stackoverflow.com/users/6072971/ravi-sundriyal"}, "is_accepted": true, "score": 0, "last_activity_date": 1473805330, "creation_date": 1473805330, "answer_id": 39479842, "question_id": 39479702, "link": "https://stackoverflow.com/questions/39479702/count-unique-entries-between-blanks-excel/39479842#39479842", "title": "Count unique entries between blanks Excel", "body": "<p>@Todd Nielsen</p>\n\n<p>Check the below link which has different solutions for it.</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Count-unique-values-among-duplicates-7889942d-824e-4469-893c-191d1efde950#bmcount_the_number_of_unique_values__by\" rel=\"nofollow\">https://support.office.com/en-us/article/Count-unique-values-among-duplicates-7889942d-824e-4469-893c-191d1efde950#bmcount_the_number_of_unique_values__by</a></p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473811235, "post_id": 39480364, "comment_id": 66280298, "body": "Not being sure how the OP is populating the original data, you may have to allow for the fact that the blank will be in column B, rather than A.  (Because column A may no longer be blank if the code has been run once and only the data values in column A have since been changed.)  So perhaps use <code>If IsEmpty(cll.Offset(0,1)) Then</code> rather than <code>If val = vbNullString Then</code>."}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1473811850, "post_id": 39480364, "comment_id": 66280412, "body": "@YowE3K True, this code only gives the general idea on how to solve this problem for huge ranges in VBA, it does not take into account that the code may be run several times on the same range. If the OP wants the unique value counts in the adjacent column, then he should change <code>cll.Value = dict.Count</code> to <code>cll.Offset(0,1).Value = dict.Count</code>. Good catch."}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1473811088, "last_edit_date": 1473811088, "creation_date": 1473808873, "answer_id": 39480364, "question_id": 39479702, "link": "https://stackoverflow.com/questions/39479702/count-unique-entries-between-blanks-excel/39480364#39480364", "title": "Count unique entries between blanks Excel", "body": "<p>Assuming you want to do this in VBA and the range containing the data sets is huge, the question is not as trivial as others which have replied to this post have made it out to be. </p>\n\n<p>The following code requires that you set a reference to the <code>Microsoft Scripting Runtime</code> library. It inserts the number of unique values each time it finds an empty row in the search range (works best if there is only one empty row to separate the different data sets in the range):</p>\n\n<pre><code>Option Explicit\n\nSub uniquesEntriesInDataSets()\n\n    Dim dict As Scripting.Dictionary\n    Dim i As Long, startAt As Long, uCount As Long\n    Dim cll As Range, searchRange As Range\n    Dim val As Variant\n\n    ' change sheetname and range to relevant parameters\n    Set searchRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A21\")\n\n    Set dict = New Dictionary\n\n    For Each cll In searchRange\n\n        val = cll.Value\n\n        If val = vbNullString Then\n            If dict.Count &gt; 0 Then \n                cll.Value = dict.Count\n                dict.RemoveAll\n            End if\n        Else\n            If Not dict.Exists(val) Then dict.Add Key:=val, Item:=i\n        End If\n\n    Next cll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6828455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-advK_MkG628/AAAAAAAAAAI/AAAAAAAAIQM/VdN_ImVg2t0/photo.jpg?sz=128", "display_name": "Todd Nielsen", "link": "https://stackoverflow.com/users/6828455/todd-nielsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39479842, "answer_count": 2, "score": 0, "last_activity_date": 1473811088, "creation_date": 1473804396, "last_edit_date": 1531161705, "question_id": 39479702, "link": "https://stackoverflow.com/questions/39479702/count-unique-entries-between-blanks-excel", "title": "Count unique entries between blanks Excel", "body": "<p>I would like to count unique entries in a range between  blanks. Please look at the attached pic for reference. The first set of data contains 3 unique entries so the highlighted box would 3. The second set of data has 3 unique entries and the highlighted box then would also display 3. </p>\n\n<p><a href=\"http://i.stack.imgur.com/es9BO.png\" rel=\"nofollow\">example</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1473803182, "post_id": 39479463, "comment_id": 66278102, "body": "<code>Debug.Print Me.navmenu.Value</code>  What does it give you?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1473803679, "post_id": 39479463, "comment_id": 66278258, "body": "Where is this code located ?"}, {"owner": {"reputation": 634, "user_id": 1131165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UxUoj.jpg?s=128&g=1", "display_name": "Jonathan Livingston Seagull", "link": "https://stackoverflow.com/users/1131165/jonathan-livingston-seagull"}, "edited": false, "score": 0, "creation_date": 1473805377, "post_id": 39479463, "comment_id": 66278797, "body": "Hi Tim, I have it in a new spreadsheet I am creating from scratch. If it works I will implement in another one."}, {"owner": {"reputation": 634, "user_id": 1131165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UxUoj.jpg?s=128&g=1", "display_name": "Jonathan Livingston Seagull", "link": "https://stackoverflow.com/users/1131165/jonathan-livingston-seagull"}, "edited": false, "score": 0, "creation_date": 1473805658, "post_id": 39479463, "comment_id": 66278887, "body": "Debug.Print Me.navmenu.Value gives me : compilation error, syntax error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473810090, "post_id": 39479463, "comment_id": 66280069, "body": "I mean is your code in a regular module, a sheet module, in a userform, in <code>ThisWorkbook</code> ?"}, {"owner": {"reputation": 634, "user_id": 1131165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UxUoj.jpg?s=128&g=1", "display_name": "Jonathan Livingston Seagull", "link": "https://stackoverflow.com/users/1131165/jonathan-livingston-seagull"}, "edited": false, "score": 0, "creation_date": 1473822516, "post_id": 39479463, "comment_id": 66282650, "body": "Hi Tim the code is in a regular module."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473826871, "post_id": 39479463, "comment_id": 66283578, "body": "In a sheet module, <code>Me</code> refers to the worksheet object; in a form it refers to the form.  In a regular module it doesn&#39;t refer to anything, hence the error you&#39;re seeing.  Where is your combobox ?"}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 1131165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UxUoj.jpg?s=128&g=1", "display_name": "Jonathan Livingston Seagull", "link": "https://stackoverflow.com/users/1131165/jonathan-livingston-seagull"}, "edited": false, "score": 0, "creation_date": 1473892374, "post_id": 39482899, "comment_id": 66318645, "body": "Great Tim ! Worked perfectly. Thanks a Lot :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1473830049, "creation_date": 1473830049, "answer_id": 39482899, "question_id": 39479463, "link": "https://stackoverflow.com/questions/39479463/vba-dropdown-menu-to-other-sheets-invalid-use-me-keyword/39482899#39482899", "title": "VBA Dropdown Menu to other sheets : invalid use me keyword", "body": "<p>If your combobox is the \"forms\" type then you can use this code in a regular module:</p>\n\n<pre><code>Sub Navigate()\n\n    'Application.Caller returns the name of the shape which called the Sub\n    With ActiveSheet.Shapes(Application.Caller).ControlFormat\n        ThisWorkbook.Sheets(.List(.ListIndex)).Select\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 1131165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/UxUoj.jpg?s=128&g=1", "display_name": "Jonathan Livingston Seagull", "link": "https://stackoverflow.com/users/1131165/jonathan-livingston-seagull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 39482899, "answer_count": 1, "score": -1, "last_activity_date": 1473830049, "creation_date": 1473803043, "last_edit_date": 1531164843, "question_id": 39479463, "link": "https://stackoverflow.com/questions/39479463/vba-dropdown-menu-to-other-sheets-invalid-use-me-keyword", "title": "VBA Dropdown Menu to other sheets : invalid use me keyword", "body": "<p>I have a VBA code that I need to use a combobox to link to other sheets. The value is in the menu list. However when I perform this code I get an error \"invalid use me keyword\". </p>\n\n<pre><code>Sub Macro1()\nSheets(Me.navmenu.Value).Select  End Sub\n</code></pre>\n\n<p>Not sure what I am doing wrong in this procedure. Is there a fix ?</p>\n\n<p>Appreciate any help.:)</p>\n"}, {"tags": ["vba", "function", "custom-data-type"], "comments": [{"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473804022, "post_id": 39479458, "comment_id": 66278366, "body": "Sorry I think I made a mistake in the function (as aType rather than as Variant) but that only changed the error to a Type Mismatch."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1473828298, "post_id": 39479458, "comment_id": 66283921, "body": "Since you are passing the Type in OR out of a function, class objects should be good to use. Moreover use Collection instead of array."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473833130, "post_id": 39479458, "comment_id": 66285444, "body": "@user110084  try the code in my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473841244, "post_id": 39483452, "comment_id": 66289540, "body": "Thank you so much Shai. So, were my mistakes in the MakePatterns function:  (1) not declaring it Public and  (2) declaring it as &quot;aType&quot; instead of an array &quot;aType()&quot; ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473841371, "post_id": 39483452, "comment_id": 66289619, "body": "@user110084 are you asking where are your mistakes ? please mark as answer"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473841649, "post_id": 39483452, "comment_id": 66289772, "body": "@user110084 you need to declare the Function with the type you want it to return, so I modified to <code>Public Function MakePatterns() As aType()</code>"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473841972, "post_id": 39483452, "comment_id": 66289939, "body": "Thanks Mukul. I did read up on Collections but I have not tried it yet. Class feels daunting at this point. It has been decades since I last did Fortran and my MS Office VBA has been really poor, always done out of necessity (ugly and inefficient for sure). So, a ton of relearning."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473845812, "post_id": 39483452, "comment_id": 66292270, "body": "Extrapolating from this, how do I have an array of Patterns ( Circles(), Squares(), Triangle() )  I tried defining     Public Type bType          Shp1 as variant          Shp2 as variant          Shp3 as variant     End Type  and then Patterns(i).Shp1 = Circles etc  but that did not work"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473850024, "post_id": 39483452, "comment_id": 66294719, "body": "@user110084 I suggest you open a new post, with your new updated code, and ask advice from the forum from all users (and me as well)"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1473863765, "post_id": 39483452, "comment_id": 66303864, "body": "Will do that. Apologies."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1473832935, "creation_date": 1473832935, "answer_id": 39483452, "question_id": 39479458, "link": "https://stackoverflow.com/questions/39479458/vba-custom-data-type-and-function-return-value/39483452#39483452", "title": "VBA: Custom data type and function (return value)", "body": "<p>In the code below <strong>Sub</strong> <strong>\"TestCallFunction\"</strong> calls the <strong>Function</strong> <strong>\"MakePatterns\"</strong>, and after it prints the first array received back from the function in the Immediate window.</p>\n\n<pre><code>Option Explicit\n\nPublic Type aType\n    P_Col As Integer\n    P_Rad As Single\n    P_X As Single\n    P_Y As Single\nEnd Type\n\n\nSub TestCallFunction()\n\nDim x()                 As aType\nDim i                   As Integer\n\nx = MakePatterns\n\n' print the first result received from Function MakePatterns\nDebug.Print x(1).P_Col &amp; \";\" &amp; x(1).P_Rad &amp; \";\" &amp; x(1).P_X &amp; \";\" &amp; x(1).P_Y\n\nEnd Sub\n\nPublic Function MakePatterns() As aType()\n\nDim i                   As Integer\nDim circles()           As aType\n\nFor i = 1 To 5\n    ReDim Preserve circles(i)\n    circles(i).P_Col = Int(i / 2)\n    circles(i).P_Rad = i\n    circles(i).P_X = i * 10 + 1\n    circles(i).P_Y = i * 10 + 5\nNext\n\nFor i = 1 To 5\n    Debug.Print circles(i).P_Col; circles(i).P_Rad; _\n    circles(i).P_X; circles(i).P_Y\nNext\n\nMakePatterns = circles\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "accepted_answer_id": 39483452, "answer_count": 1, "score": 2, "last_activity_date": 1473832935, "creation_date": 1473803028, "question_id": 39479458, "link": "https://stackoverflow.com/questions/39479458/vba-custom-data-type-and-function-return-value", "title": "VBA: Custom data type and function (return value)", "body": "<p>I get a compile error at the last line when testing the following: (Only public user defined types that are defined in a public object module can be coerced to or from a variant or passed to late-bound functions.)</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Type aType\n    P_Col As Integer\n    P_Rad As Single\n    P_X As Single\n    P_Y As Single\nEnd Type\n\n\nFunction MakePatterns() As Variant\nDim i As Integer\nDim circles() As aType\n\nFor i = 1 To 5\n    ReDim Preserve circles(i)\n    circles(i).P_Col = Int(i / 2)\n    circles(i).P_Rad = i\n    circles(i).P_X = i * 10 + 1\n    circles(i).P_Y = i * 10 + 5\n\nNext\n\nFor i = 1 To 5\n    Debug.Print circles(i).P_Col; circles(i).P_Rad; _\n     circles(i).P_X; circles(i).P_Y\nNext\nMakePatterns = circles\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Is there a way to use TYPE and Function together to return an array? Or is there a more effective way?</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "is_accepted": true, "score": 0, "last_activity_date": 1474293406, "creation_date": 1474293406, "answer_id": 39575008, "question_id": 39479166, "link": "https://stackoverflow.com/questions/39479166/copying-pivottable-results-with-multiple-columns/39575008#39575008", "title": "Copying pivottable results with multiple columns", "body": "<p>After a week of searching I found the a solution.</p>\n\n<pre><code>Set PvtTbl = Workbooks(\"AX_Cube_Report\").Sheets(\"Good_Qty_Data\").PivotTables(\"Good_Qty_PT\")\nPvtTbl.TableRange2.Offset(4, 0).Copy\nWorkbooks(\"AX_Cube_Report\").Sheets(\"Good_Qty\").Cells(2, 1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>The Key is the <code>.TableRange2</code> command</p>\n\n<p>I then count the rows and columns to delete the unwanted rows.</p>\n"}], "owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 39575008, "answer_count": 1, "score": 0, "last_activity_date": 1474293406, "creation_date": 1473801656, "question_id": 39479166, "link": "https://stackoverflow.com/questions/39479166/copying-pivottable-results-with-multiple-columns", "title": "Copying pivottable results with multiple columns", "body": "<p>I have a workbook that has a data connection and I set up a pivot table as seen below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dQmn6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dQmn6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The pivottable results are based on:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7MkhT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7MkhT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to copy, transfer, whatever those results by column (day) then (Good QTY) and move them to another sheet so they look like below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pnaI5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pnaI5.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have been trying different things for hours with no results. I have tried recording macros, <code>.Copy Destination</code>, Select then copy, <code>Getpivotdata</code> and nothing is working. The only thing I can get working is selecting 1 \"Good Qty\" from 1 Line.</p>\n\n<p>The closest thing I got to work was the following code:</p>\n\n<p><code>Sheets(\"Pivot_Table\").PivotTables(\"Metric_Display\").PivotSelect(\"Good Qty\")</code></p>\n\n<p>this selects each column by day and all the \"Good Qty\" but I can not copy because I get the error saying I cant copy multiple sections.</p>\n\n<p>This workbook updates daily and adds a new Day column as a result, the next thing I was try was just a find last column used and copy and paste the cells them selfs instead of using the pivot table but I figured there has to be a way to use the table.\nAny suggestions would be much appreciated, thank you.</p>\n"}, {"tags": ["arrays", "vba", "excel", "function"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1473802221, "post_id": 39479120, "comment_id": 66277727, "body": "In a word, no.  It seems like you&#39;re looking for something like a lambda function, which VBA doesn&#39;t offer."}], "answers": [{"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1473807627, "post_id": 39480190, "comment_id": 66279477, "body": "Even better would be to define tenors as months, and change the test to <code>Tenor &lt; 12</code>. That works for short-dated tenors down to month granularity, and long-dated 25 year rates"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473807988, "post_id": 39480190, "comment_id": 66279570, "body": "But... meta-code that generates VBA code and executes it on the fly is so much more fun!"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1473808129, "post_id": 39480190, "comment_id": 66279618, "body": "But.... But meta code that creates a VBA proc that creates a Python script and send it to a PHP server for evaluation as json and convert back to array with custom parser written in a BAT file?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473809114, "post_id": 39480190, "comment_id": 66279860, "body": "can&#39;t try it, but I think something like this should work too <code>CreateDiscArray  = [DiscFact(A1:A3, B1:B3)]</code>, and I would replace <code>Application.Evaluate</code> with <code>rates.Worksheet.Evaluate</code> <a href=\"https://fastexcel.wordpress.com/2011/11/02/evaluate-functions-and-formulas-fun-how-to-make-excels-evaluate-method-twice-as-fast/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/11/02/&hellip;</a>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1473809829, "post_id": 39480190, "comment_id": 66280020, "body": "@Slai - yes, something like that would work, but you&#39;d have to hard code the addresses into the VBA text. You couldn&#39;t use the addresses of the provided ranges."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 4, "last_activity_date": 1473807485, "creation_date": 1473807485, "answer_id": 39480190, "question_id": 39479120, "link": "https://stackoverflow.com/questions/39479120/how-to-pass-and-loop-an-indetermined-array-to-a-function-in-vba/39480190#39480190", "title": "How to pass, and loop, an indetermined array to a function in VBA?", "body": "<p>There are some problems with your original code</p>\n\n<ul>\n<li><p>You're not using <code>Option Explicit</code>, so you don't know that <code>i</code> is undeclared.</p></li>\n<li><p>You're not dimensioning the <code>TempArray</code>, so your code can't assign to its indexes.</p></li>\n<li><p>You're referencing <code>myArray(i)</code> which will fail as there are 2 dimensions, so you must use <code>myArray(i,1)</code>.</p></li>\n<li><p>You're using the <code>i</code> counter (which is 1-based) as the tenor. That's a poor design choice as your tenors won't always be consistent lengths, and you can expect to have many short-dated tenors. Furthermore, that's a bug, because <code>i &gt;= 1</code> will <em>always</em> be <code>TRUE</code></p></li>\n</ul>\n\n<p>So, to make your original functions <em>workable code</em>:</p>\n\n<pre><code>Option Explicit\n\nFunction CreateDiscArray(RFR_array As Range)\n\n    Dim MyArray() As Variant\n    MyArray = RFR_array.Value\n\n    Dim xDimRate As Integer\n    xDimRate = UBound(MyArray, 1)\n\n    ReDim TempArray(LBound(MyArray) To UBound(MyArray), LBound(MyArray, 2) To UBound(MyArray, 2)) As Variant\n    Dim i As Long\n    For i = 1 To xDimRate Step 1\n        TempArray(i, 1) = DiscFact(MyArray(i, 1), i)\n    Next i\n\n    CreateDiscArray = TempArray\nEnd Function\n\nFunction DiscFact(Rate, Tenor)\n    'BUG: Tenor will always be &gt;= 1\n    If Tenor &lt; 1 Then DiscFact = (1 + Tenor * Rate)\n    If Tenor &gt;= 1 Then DiscFact = (1 + Rate) ^ (-Tenor)\nEnd Function\n</code></pre>\n\n<p>But that's not your question. As others have pointed out, VBA doesn't support anything natively, but you're using Excel, so you do have some options:</p>\n\n<p>Firstly, let's fix the Tenor bug by adding a range of <code>tenors</code> in addition to the <code>rates</code>. Tenors are in <code>A1:A3</code> and rates are in <code>B1:B3</code>. We can use an array formula in <code>C1:C3</code> as <code>=IF(A1:A3&lt;1,1+A1:A3*B1:B3,(1+B1:B3)^(-A1:A3))</code></p>\n\n<pre><code>    A   |   B  |   C\n--+-----|------|-------------------------------------------------\n1 | .5  | 99   | {=IF(A1:A3&lt;1,1+A1:A3*B1:B3,(1+B1:B3)^(-A1:A3))}\n2 | 1   | 97   | \n3 | 2   | 95   | \n</code></pre>\n\n<p>And, if you name named ranges as Tenor and Rate, you can redefine the array formula as <code>=IF(Tenor&lt;1,1+Tenor*Rate,(1+Rate)^(-Tenor))</code></p>\n\n<p>If you really want this solution to be in VBA, you'll need to change your function signature to accept tenor <em>and</em> rate ranges, and then use <code>Application.Evaluate</code> along with a constructed formula, to get an array of the results.</p>\n\n<p>With a clumsy solution that doesn't care for sheets or workbooks:</p>\n\n<pre><code>Public Function DiscFactor(rates As Range, tenors As Range) As Variant\n\n  Dim Rate As String\n  Dim Tenor As String\n  Rate = rates.Address\n  Tenor = tenors.Address\n\n  DiscFactor = Application.Evaluate(\"=IF(\" &amp; Tenor &amp; \"&lt;1,1+\" &amp; Tenor &amp; \"*\" &amp; Rate &amp; \",(1+\" &amp; Rate &amp; \")^(-\" &amp; Tenor &amp; \"))\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 4557090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c47f453491b250bb6b48d1289704917?s=128&d=identicon&r=PG&f=1", "display_name": "rrg", "link": "https://stackoverflow.com/users/4557090/rrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 39480190, "answer_count": 1, "score": 2, "last_activity_date": 1473809248, "creation_date": 1473801457, "last_edit_date": 1473809248, "question_id": 39479120, "link": "https://stackoverflow.com/questions/39479120/how-to-pass-and-loop-an-indetermined-array-to-a-function-in-vba", "title": "How to pass, and loop, an indetermined array to a function in VBA?", "body": "<p>My function takes in a range, say risk-free interest rates, and produces an array of discount factors. The issue seems to be in the loop, threefold: </p>\n\n<p>(a) calling a fn on an array,<br>\n(b) specifying the array points,<br>\n(c) using the loop i as a fn parameter.</p>\n\n<p>Is the best way to use a loop around each array(point i), or can the full array be populated by simply calling in a function?</p>\n\n<pre><code>Function CreateDiscArray(RFR_array As Range)\n\n    Dim MyArray() As Variant\n    MyArray = RFR_array\n\n    Dim xDimRate As Integer\n    xDimRate = UBound(MyArray, 1)\n\n    Dim TempArray() As Variant\n    For i = 1 To xDimRate Step 1\n        TempArray(i, 1) = DiscFact(MyArray(i), i)\n    Next i\n\n    CreateDiscArray() = TempArray()\nEnd Function\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Function DiscFact(Rate, Tenor)\n    If Tenor &lt; 1 Then DiscFact = (1 + Tenor * Rate)\n    If Tenor &gt;= 1 Then DiscFact = (1 + Rate) ^ (-Tenor)\nEnd Function\n</code></pre>\n\n<p>i.e. is it possible to just call, without the loop:</p>\n\n<pre><code>CreateDiscArray = DiscFact(MyArray(,1), 1 to xDimRate)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1473797865, "post_id": 39478062, "comment_id": 66275870, "body": "The code you posted doesn&#39;t seem a good match to the question: it would help to post some sample date from one of your input files, and also show how it should look on the worksheet."}, {"owner": {"reputation": 3, "user_id": 4763698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114327de07de0724b09658eeae95f4f2?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/4763698/adam"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1473800150, "post_id": 39478062, "comment_id": 66276852, "body": "I&#39;m not sure what is the best way here to share a sample data. Lets try with this image: [link]<a href=\"http://i66.tinypic.com/a3jdde.png\" rel=\"nofollow noreferrer\">i66.tinypic.com/a3jdde.png</a> Column A contain sample from 1st file. Columns C-E what I&#39;m expecting to see after combining with other files. Filenames are optional. Data should start from column A. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5583194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd60aa03e8a4cbea738c0c17f4dc2f?s=128&d=identicon&r=PG&f=1", "display_name": "StericHindrance", "link": "https://stackoverflow.com/users/5583194/sterichindrance"}, "is_accepted": false, "score": 0, "last_activity_date": 1473799968, "creation_date": 1473799968, "answer_id": 39478800, "question_id": 39478062, "link": "https://stackoverflow.com/questions/39478062/import-multiple-txt-csv-into-one-excel-sheet-but-each-file-in-next-column/39478800#39478800", "title": "Import multiple TXT/CSV into one Excel sheet but each file in next column", "body": "<p>I'll assume that your text file data all fits neatly in one column.  If you're iterating over rows and columns like that, I always preferred to use the <code>Cells(x, y).Value</code> syntax.</p>\n\n<p>No guarantee that it's the most efficient way to do things, but this seems like a simple enough procedure that performance won't matter too much.</p>\n\n<p>You could adapt your code to do something like this:</p>\n\n<pre><code>    Dim RowIndex As Long  'Excel Rows need the Long data type\n    Dim ColumnIndex As Integer ' Not as many columns, so use Integer\n\n    ' Start at column 1.\n    ColumnIndex = 1\n\n    ' Do the rest of your file I/O and split into the Items array.\n\n    ' Here's your column header:\n    Cells(1, ColumnIndex).Value = file.Name\n\n    ' Start the actual data in row 2.\n    RowIndex = 2\n    For (i = 0 to UBound(Items))\n        Cells(RowIndex, ColumnIndex).Value = Items(i)\n        RowIndex = RowIndex + 1\n    Next i\n\n    ' When you're all done, advance ColumnIndex so the next time through\n    ' the loop you're outputting on the next Column.\n    ColumnIndex = ColumnIndex + 1\n</code></pre>\n\n<p>This should be functionally identical to the <code>Offset</code> syntax you're using, but I've found that using <code>Cells</code> makes it more obvious what index (row or column or both) you're iterating over.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4763698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114327de07de0724b09658eeae95f4f2?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/4763698/adam"}, "edited": false, "score": 0, "creation_date": 1473801189, "post_id": 39479014, "comment_id": 66277291, "body": "Exactly what I need. Thank you Tim!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1473800866, "creation_date": 1473800866, "answer_id": 39479014, "question_id": 39478062, "link": "https://stackoverflow.com/questions/39478062/import-multiple-txt-csv-into-one-excel-sheet-but-each-file-in-next-column/39479014#39479014", "title": "Import multiple TXT/CSV into one Excel sheet but each file in next column", "body": "<p>Something like this:</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\n\n    Dim fso As FileSystemObject\n    Dim folder As folder\n    Dim file As file\n    Dim FileText As TextStream\n    Dim i As Long\n    Dim cl As Range\n\n    Set fso = New FileSystemObject\n    Set folder = fso.GetFolder(\"d:\\Projects\\Data\\\")\n\n    Set cl = ActiveSheet.Cells(1, 1)\n\n    Application.ScreenUpdating = False\n\n    For Each file In folder.Files\n\n        Set FileText = file.OpenAsTextStream(ForReading)\n        cl.Value = file.Name\n        i = 1\n\n        Do While Not FileText.AtEndOfStream\n            cl.Offset(i, 0).Value = FileText.ReadLine\n            i = i + 1\n        Loop\n\n        FileText.Close\n\n        Set cl = cl.Offset(0, 1)\n    Next file\n\n    Application.ScreenUpdating = True\n\n    Set FileText = Nothing\n    Set file = Nothing\n    Set folder = Nothing\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4763698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114327de07de0724b09658eeae95f4f2?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/4763698/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 39479014, "answer_count": 2, "score": 0, "last_activity_date": 1473800866, "creation_date": 1473796693, "last_edit_date": 1473800335, "question_id": 39478062, "link": "https://stackoverflow.com/questions/39478062/import-multiple-txt-csv-into-one-excel-sheet-but-each-file-in-next-column", "title": "Import multiple TXT/CSV into one Excel sheet but each file in next column", "body": "<p>I have one folder with TXT files (one column). I need to import them in one Worksheet but each file should be in new column. Would be great to add a file name as a header.</p>\n\n<p>I'm trying to increase <code>cl</code> element before new file is open. Is is good direction?</p>\n\n<pre><code>Set cl = ActiveSheet.Cells(1, i)\ni = i + 1\n</code></pre>\n\n<p>How to modify below code? Any help would be greatly appreciated!</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\n    Dim fso As FileSystemObject\n    Dim folder As folder\n    Dim file As file\n    Dim FileText As TextStream\n    Dim TextLine As String\n    Dim Items() As String\n    Dim i As Long\n    Dim cl As Range\n\n    ' Get a FileSystem object\n    Set fso = New FileSystemObject\n\n    ' get the directory you want\n    Set folder = fso.GetFolder(\"d:\\Projects\\Data\\\")\n\n    ' set the starting point to write the data to\n    Set cl = ActiveSheet.Cells(1, 1)\n\n    ' Loop thru all files in the folder\n    For Each file In folder.Files\n        ' Open the file\n        Set FileText = file.OpenAsTextStream(ForReading)\n\n        ' Read the file one line at a time\n        Do While Not FileText.AtEndOfStream\n            TextLine = FileText.ReadLine\n\n            ' Parse the line into | delimited pieces\n            Items = Split(TextLine, \"|\")\n\n            ' Put data on one row in active sheet\n            For i = 0 To UBound(Items)\n                cl.Offset(0, i).Value = Items(i)\n\n            Next\n\n            ' Move to next row\n            Set cl = cl.Offset(1, 0)\n        Loop\n\n        ' Clean up\n        FileText.Close\n\n\n    Next file\n\n    Set FileText = Nothing\n    Set file = Nothing\n    Set folder = Nothing\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "popup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473790778, "post_id": 39476542, "comment_id": 66272394, "body": "On which line do you get the error?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1473791612, "post_id": 39476542, "comment_id": 66272834, "body": "I&#39;d start by adding a test for <code>IsDate(rngCell.Value2)</code>. My <i>guess</i> is that you have empty cells in your <code>ws.UsedRange</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6827732"}, "edited": false, "score": 0, "creation_date": 1473793978, "post_id": 39476542, "comment_id": 66274024, "body": "The error is occurring at &quot;If Date - CDate(rngCell.Value2) &gt;= 14 Then&quot;"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1473855288, "post_id": 39476542, "comment_id": 66297906, "body": "Can you show us at least one row with data? My <i>guess</i> is that you are trying to convert the value of &quot;Days Until Expiration&quot; (which is probably just a number) into a Date, and that is causing the issue. If that is the case, your logic to validate <code>If Date - CDate(rngCell.Value2) &gt;= 14 Then</code> should probably only be <code>If rngCell.Value2 &gt;= 14 Then</code> (and even that logic does not satisfy your request)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6827732"}, "edited": false, "score": 0, "creation_date": 1473872312, "post_id": 39492640, "comment_id": 66309287, "body": "Thank you so much the code works great and all your assumptions were correct! There is only one issue. It seems to be recognizing all the unfilled rows. For example, for all the rows under the last filled row, the code recognizes them as empty and outputs &quot;material has  days left before expiration&quot;. This runs infinitely until the very last row of the excel page and it is causing the program to take a few minutes to run. It also fills up the message prompt with 20 messages of &quot;material has  days left before expiration&quot;. What can I do to fix this?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1473873643, "post_id": 39492640, "comment_id": 66309990, "body": "Do you have Empty Cells and after it more cells with values, or if I found an empty cell I should assume I&#39;ve reached the end of the table? I&#39;m asking this because if the empty cells determine the end of the table I can Exit the For loop, otherwise I would have to just skip the validation for those cells, so depending on your answer, the logic would be different"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6827732"}, "edited": false, "score": 0, "creation_date": 1473873976, "post_id": 39492640, "comment_id": 66310176, "body": "If you find an empty cell you should assume you have reached the end of the table."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1473874368, "post_id": 39492640, "comment_id": 66310383, "body": "Please see my update. I&#39;ve added two alternatives for your code. Follow the first approach for your current issue (leave For loop once you find an Empty cell). In case you need it in the future, you also have an alternative for the second approach (continuing evaluation but skip empty cells)"}], "tags": [], "owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "is_accepted": true, "score": 0, "last_activity_date": 1473874270, "last_edit_date": 1473874270, "creation_date": 1473862297, "answer_id": 39492640, "question_id": 39476542, "link": "https://stackoverflow.com/questions/39476542/vba-code-to-alert-against-expired-material-assistance/39492640#39492640", "title": "VBA Code to Alert Against Expired Material Assistance", "body": "<p>I'm posting this answer based on your request and with some assumptions, as follows:  </p>\n\n<ul>\n<li>You want to check the data for column \"Days Until Expiration\" (as per your request)  </li>\n<li>You want to grab the data from column \"Type\" to add on the popup (as per your request)</li>\n<li>You want one message if the Expiration Days is between 0 and 14</li>\n<li>You want another message if the Expiration Days is less than 0</li>\n<li>The value on column \"Days Until Expiration\" is actually a number (this is an assumption, since no data was provided)</li>\n<li>I'm assuming \"Days Until Expiration\" is merged into two rows (per screenshot) </li>\n<li>I'm assuming your data is directly below the rows from your screenshot, so probably your actual data starts on Row 4</li>\n</ul>\n\n<p>Here is the code (tested based on assumptions above, due to lack of actual data to reproduce the scenario):  </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Application.WindowState = xlMaximized\n\n    Dim ws As Worksheet\n    Dim strExpirationMessage As String\n    Dim rngExpirationCell As Range, rngTypeCell As Range\n    Dim lngRow As Long, lngExpirationCol As Long, lngTypeCol As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Inventory\")\n    Set rngExpirationCell = ws.UsedRange.Find(What:=\"Days Until Expiration\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    Set rngTypeCell = ws.UsedRange.Find(What:=\"Type\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n\n    If Not rngExpirationCell Is Nothing And Not rngTypeCell Is Nothing Then\n        lngExpirationCol = rngExpirationCell.Column\n        lngTypeCol = rngTypeCell.Column\n\n        For lngRow = rngExpirationCell.row + 2 To ws.UsedRange.Rows.Count\n            With ws.Cells(lngRow, lngExpirationCol)\n\n                If 0 &lt;= .Value And .Value &lt;= 14 Then\n                    strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has \" &amp; .Value &amp; \" days left before expiration\" &amp; vbCrLf\n                ElseIf .Value &lt; 0 Then\n                    strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has expired\" &amp; vbCrLf\n                End If\n\n            End With\n        Next\n\n        strExpirationMessage = Left(strExpirationMessage, Len(strExpirationMessage) - 2) 'to remove trailing vbCrLf\n        MsgBox strExpirationMessage\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Important Notes:</strong>  </p>\n\n<ul>\n<li>I've modified part of your logic, by eliminating some variables and using others instead. </li>\n<li>I'm not working with range objects, but rather with specified cells</li>\n<li>I'm performing a dynamic search for the desired Columns \"Days Until Expiration\" and \"Type\", instead of working with fixed column and with offsets, to allow you to change the columns position in future without changing the code.</li>\n<li>I'm assuming \"Days Until Expiration\" is merged into two rows (per screenshot) and this is why I'm using <code>rngExpirationCell.row + 2</code> in the <code>For</code> loop. If you have anything different than that, the code might need changes.  </li>\n</ul>\n\n<p>I hope this suits your needs. Let me know of any issues or concerns.\nIf this post answers your question, please Accept it by clicking on the Check mark on the left of it.</p>\n\n<p><strong>Update:</strong><br>\nBased on the issues you found, below are two alternate solutions for the <code>For</code> loop that you could use. Everything else should be exactly the same. Just replace the <code>For</code> loop with either of the logic below and you should be good to go</p>\n\n<p>Assuming you want to leave the logic once you found an Empty cell:  </p>\n\n<pre><code>For lngRow = rngExpirationCell.row + 2 To ws.UsedRange.Rows.Count\n    With ws.Cells(lngRow, lngExpirationCol)\n        If IsEmpty(.Value) Then Exit For    'Will leave the For loop once an Empty cell is found\n\n        If 0 &lt;= .Value And .Value &lt;= 14 Then\n            strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has \" &amp; .Value &amp; \" days left before expiration\" &amp; vbCrLf\n        ElseIf .Value &lt; 0 Then\n            strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has expired\" &amp; vbCrLf\n        End If\n\n    End With\nNext\n</code></pre>\n\n<p>Assuming you want to skip the evaluation for the Empty cells, but continue checking the cells until the end of the Used Range:</p>\n\n<pre><code>For lngRow = rngExpirationCell.row + 2 To ws.UsedRange.Rows.Count\n    With ws.Cells(lngRow, lngExpirationCol)\n        If Not IsEmpty(.Value) Then    'Will skip empty cells but continuing validation until the end of the Used Range\n            If 0 &lt;= .Value And .Value &lt;= 14 Then\n                strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has \" &amp; .Value &amp; \" days left before expiration\" &amp; vbCrLf\n            ElseIf .Value &lt; 0 Then\n                strExpirationMessage = strExpirationMessage &amp; ws.Cells(lngRow, lngTypeCol).Value &amp; \" material has expired\" &amp; vbCrLf\n            End If\n        End If\n\n    End With\nNext\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6827732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 39492640, "answer_count": 1, "score": 0, "last_activity_date": 1473874270, "creation_date": 1473790507, "last_edit_date": 1473790711, "question_id": 39476542, "link": "https://stackoverflow.com/questions/39476542/vba-code-to-alert-against-expired-material-assistance", "title": "VBA Code to Alert Against Expired Material Assistance", "body": "<p>I am trying to create a popup window as soon as I open my excel file. </p>\n\n<p>The excel workbook that I have has multiple sheets. </p>\n\n<p>One of the sheets is titled \"Inventory\". </p>\n\n<p>As shown in the image below, there is a column in the Inventory tab that is titled \"Days Until Expiration\". </p>\n\n<p>I want to have my excel file display a pop up when opening the workbook. This popup will check the \"Days Until Expiration\" column in the \"Inventory\" tab and say something like \"____ material\" (from the 'Type' Column) \"has ____\" days until expiration. </p>\n\n<p>This will only happen if the \"Days Until Expiration\" value is in between 0 and 14 days. </p>\n\n<p>If the number is negative in the \"Days Until Expiration\" column, I want the message pop up to say \"___ material has expired\". </p>\n\n<p>Shown below is what I have so far. I have created a workbook_open() event and this code is in my \"ThisWorkbook\" code tab. </p>\n\n<p>I am also getting an error when I run what I have below, specifically saying:</p>\n\n<blockquote>\n  <p>Run-time error '13': Type mismatch</p>\n</blockquote>\n\n<pre><code> Private Sub Workbook_Open()\n\n\n\nApplication.WindowState = xlMaximized\n\n        Dim wb As Workbook\n        Dim ws As Worksheet\n        Dim rngUsed As Range, rngExpirationColumn As Range, rngCell As Range\n        Dim strExpirationMessage As String\n\n        Set wb = ThisWorkbook\n        Set ws = wb.Sheets(\"Inventory\")\n        Set rngUsed = ws.UsedRange\n        Set rngExpirationColumn = Intersect(ws.Columns(4), rngUsed)\n\n        For Each rngCell In rngExpirationColumn.Cells\n            If Date - CDate(rngCell.Value2) &gt;= 14 Then\n                If Len(strExpirationMessage) = 0 Then\n                    strExpirationMessage = rngCell.Offset(0, -3).Value2 &amp; \" material has \" &amp; (Date - CDate(rngCell.Value2)) &amp; \" days left before expiration\"\n                Else\n                    strExpirationMessage = strExpirationMessage &amp; Chr(13) &amp; rngCell.Offset(0, -3).Value2 &amp; \" material has \" &amp; (Date - CDate(rngCell.Value2)) &amp; \" days left before expiration\"\n                End If\n            End If\n        Next\n\n        MsgBox strExpirationMessage\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wHVxt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wHVxt.png\" alt=\"Excel file showing columns\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1473791706, "post_id": 39476742, "comment_id": 66272885, "body": "Comintern, This is excellent.  Thanks for the suggested approach!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1506033250, "last_edit_date": 1506033250, "creation_date": 1473791266, "answer_id": 39476742, "question_id": 39476165, "link": "https://stackoverflow.com/questions/39476165/vba-word-frequency-array/39476742#39476742", "title": "VBA: Word Frequency Array", "body": "<p>Your instinct is correct - this is pretty much brute force, so it won't scale well. And yes, there is a better approach - I'd use a Scripting.Dictionary instead of the <code>Collection</code>.  It allows 2 things that a <code>Collection</code> doesn't: First, you can check for the existence of a key without relying on the error handler, (and simply store the counts in the <code>Dictionary</code> itself). Second, you can retrieve the Keys array to easily extract your results.</p>\n\n<p>Your code would translate into something more like this:</p>\n\n<pre><code>'Requires a reference to Microsoft Scripting Runtime.\nPrivate Sub Command0_Click()\n    Dim counts As New Scripting.Dictionary\n    Dim word As Variant\n    Dim desc As String\n\n    desc = \"This is just a test only a test test test\"\n\n    For Each word In Split(LCase$(desc), \" \")\n        If Not counts.Exists(word) Then\n            counts.Add word, 1\n        Else\n            counts.Item(word) = counts.Item(word) + 1\n        End If\n    Next\n\n    For Each word In counts.Keys\n        Debug.Print word, counts(word)\n    Next\nEnd Sub\n</code></pre>\n\n<p>As far as your last question, \"how do I append to an array for each row in a recordset?\" - all you need to do is to loop through the recordset and add them into the same <code>Dictionary</code>. Then you can simply retrieve the total counts when you're done.</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 39476742, "answer_count": 1, "score": 2, "last_activity_date": 1594639082, "creation_date": 1473789054, "last_edit_date": 1594639082, "question_id": 39476165, "link": "https://stackoverflow.com/questions/39476165/vba-word-frequency-array", "title": "VBA: Word Frequency Array", "body": "<p>I'm attempting to compute the frequency of terms within a collection of variable length strings.  The context is descriptions in an Access database.  Would prefer to keep the solution in VBA.  Delimiter is \" \" (space) character.  Special chars will be removed in advance.</p>\n\n<p>My first pass feels a bit brute force; I suspect a much more efficient approach is possible.  </p>\n\n<p>Here is what I am doing currently for a SINGLE string, which is providing the result I expect:</p>\n\n<pre><code>Private Sub Command0_Click()\n\n    Dim myCol As Collection\n    Dim myArray() As String\n    Dim strArray As Variant\n    Dim strDescr, strTerm, strMsg As String\n    Dim i, j As Integer\n\n    Set myCol = New Collection\n\n    strDescr = \"This is just a test only a test test test\"\n\n    myArray = Split(strDescr, \" \")\n\n    For Each strArray In myArray\n        On Error Resume Next\n        myCol.Add strArray, CStr(strArray)\n    Next strArray\n\n    For i = 1 To myCol.Count\n        strTerm = myCol(i)\n        j = 0\n        For Each strArray In myArray\n            If strArray = strTerm Then j = j + 1\n        Next strArray\n        'placeholder        \n        strMsg = strMsg &amp; strTerm &amp; \" | \" &amp; j &amp; Chr(10) &amp; Chr(13)\n    Next i\n\n    'placeholder\n    'save results into a table\n    MsgBox strMsg\n\nEnd Sub \n</code></pre>\n\n<p>Sample Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/G8Vk1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G8Vk1.png\" alt=\"sample result\"></a></p>\n\n<p>Next, I need to expand this approach to step thru a recordset, to keep appending words to the array and collection.  Recordsets can be large, 30K records, descr are 30-60 chars.</p>\n\n<p>Questions:  </p>\n\n<ol>\n<li>How do I append to an array for each row in a recordset?</li>\n<li>Will this approach fail as I scale the number of records?</li>\n<li>A better approach?</li>\n</ol>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "array-formulas"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1473789111, "post_id": 39476143, "comment_id": 66271531, "body": "<code>Str</code> is not a vba command.  It is <code>Cstr</code> and it is not needed here.  Just the use of <code>&amp;</code> will turn the number to a string.  So remove all the <code>Str(...)</code>.  Just use the variable and math."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473789349, "post_id": 39476143, "comment_id": 66271682, "body": "was about to answer, but Scott beat me to it :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1473789464, "post_id": 39476143, "comment_id": 66271759, "body": "@ShaiRado feel free, I can and will remove my comment if you do."}, {"owner": {"reputation": 9, "user_id": 6827727, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207636087236405/picture?type=large", "display_name": "Jordan Avery", "link": "https://stackoverflow.com/users/6827727/jordan-avery"}, "edited": false, "score": 0, "creation_date": 1473789655, "post_id": 39476143, "comment_id": 66271867, "body": "I knew it would be easy, thanks!  I didn&#39;t have Str() before and was receiving the error but I must have accidentally fixed that error while adding Str()."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1473802680, "post_id": 39476143, "comment_id": 66277913, "body": "@ScottCraner - Actually <code>Str</code> <b>is</b> a VBA command but, unlike <code>CStr</code>, <code>Str</code> places a leading space in front of positive numbers.  So <code>Str(12)</code> gives &quot; 12&quot; while <code>CStr(12)</code> gives &quot;12&quot;.  Both <code>Str(-12)</code> and <code>CStr(-12)</code> give &quot;-12&quot;."}], "owner": {"reputation": 9, "user_id": 6827727, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207636087236405/picture?type=large", "display_name": "Jordan Avery", "link": "https://stackoverflow.com/users/6827727/jordan-avery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473788948, "creation_date": 1473788948, "last_edit_date": 1531164843, "question_id": 39476143, "link": "https://stackoverflow.com/questions/39476143/formulaarray-with-variable-concatenated-into-it", "title": "FormulaArray with variable concatenated into it", "body": "<p>I'm trying to use VBA to insert a FormulaArray.  It works when I hardcode the cell rows but when I try to use a variable (shipRow) then I get the error \"Unable to set the FormulaArray proprerty of the Range class\".  In this example, shipRow = 4 and voyageColumn = 6</p>\n\n<p><strong>THIS WORKS:</strong></p>\n\n<pre><code>Cells(shipRow + 6, voyageColumn).FormulaArray = \"=IFERROR(VLOOKUP(CONCATENATE(F$4,F$5,$B$1,G$5,F$7,D10,\"\"Lower\"\"),'Price Recs'!$2:$1048576,20,FALSE),\"\"\"\")\"\n</code></pre>\n\n<p><strong>THIS DOES NOT WORK:</strong></p>\n\n<pre><code>Cells(shipRow + 6, voyageColumn).FormulaArray = \"=IFERROR(VLOOKUP(CONCATENATE(F$\" &amp; Str(shipRow) &amp; \",F$\" &amp; Str(shipRow + 1) &amp; \",$B$1,G$5,F$7,D\" &amp; Str(shipRow + 6) &amp; \",\"\"Lower\"\"),'Price Recs'!$2:$1048576,20,FALSE),\"\"\"\")\"\n</code></pre>\n\n<p>This is probably an easy fix that I just can't find!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 2, "creation_date": 1473787557, "post_id": 39475289, "comment_id": 66270665, "body": "could you add a description of what you have tried so far?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1473789378, "post_id": 39475289, "comment_id": 66271703, "body": "Welcome to S.O! Have you tried anything? If so, please, provide the code, take a look to the <a href=\"http://stackoverflow.com/tour\">tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>. Friendly reminder: StackOverflow is not a &quot;we code for you&quot; service provider. <a href=\"https://blog.udemy.com/excel-macros-tutorial/\" rel=\"nofollow noreferrer\">Introduction to VBA</a>"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1473789795, "post_id": 39475289, "comment_id": 66271939, "body": "What you are proposing is a perfect application for a relational database. Is there any particular reason you feel you need to do this in Excel VBA instead of MS-Access or another RDB program?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1473790210, "post_id": 39475289, "comment_id": 66272153, "body": "<a href=\"http://stackoverflow.com/questions/25657541/excel-merge-two-excel-tables-based-on-matching-data-in-columns\">This seems very similar</a> to what you are trying to achieve. Granted that&#39;s with functions, but the idea is the same."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6827365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083aff12b9dc20566fa3616ea8546754?s=128&d=identicon&r=PG&f=1", "display_name": "user6827365", "link": "https://stackoverflow.com/users/6827365/user6827365"}, "edited": false, "score": 0, "creation_date": 1473869850, "post_id": 39477244, "comment_id": 66307902, "body": "Hi, I used the idea to run two for loops and place the content on the destination to arrive at my needs. Thanks a lot!"}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": false, "score": 0, "last_activity_date": 1473793399, "creation_date": 1473793399, "answer_id": 39477244, "question_id": 39475289, "link": "https://stackoverflow.com/questions/39475289/vba-copy-a-row-multiple-times-based-on-the-number-of-occurrence-of-a-field-in/39477244#39477244", "title": "VBA - Copy a row multiple times based on the number of occurrence of a field in a different table", "body": "<p>Banged this out quickly on a few hours sleep, seemed to work ok.</p>\n\n<pre><code>Sub Combine()\n\n    Set wsSrc = Worksheets(\"Sheet1\") 'Populate with source sheet used\n    'may need to add a second ws and change array reading below\n    Set wsDest = Worksheets(\"Sheet2\") 'populate with where you want data to go\n    'may want to change to a listobject and the writes below accordingly\n    iDestRow = 2\n\n'Read both tables into arrays\n    aTable1 = wsSrc.ListObjects(\"Table1\").DataBodyRange\n    aTable2 = wsSrc.ListObjects(\"Table2\").DataBodyRange\n\n'Cycle through each buyer and populate new dataset\n    For i = LBound(aTable2) To UBound(aTable2)\n        sBuyer = aTable2(i, 2)\n        sFruit = aTable2(i, 1)\n        For j = LBound(aTable1) To UBound(aTable1)\n            'if the buyer exists in table 2 and table 1 populate destination\n            If aTable1(j, 1) = sFruit Then\n                wsDest.Cells(iDestRow, 2) = sBuyer\n                wsDest.Cells(iDestRow, 3) = sFruit\n                wsDest.Cells(iDestRow, 4) = aTable1(j, 2)\n                iDestRow = iDestRow + 1\n            End If\n        Next j\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6827365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083aff12b9dc20566fa3616ea8546754?s=128&d=identicon&r=PG&f=1", "display_name": "user6827365", "link": "https://stackoverflow.com/users/6827365/user6827365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473793399, "creation_date": 1473785734, "last_edit_date": 1473790974, "question_id": 39475289, "link": "https://stackoverflow.com/questions/39475289/vba-copy-a-row-multiple-times-based-on-the-number-of-occurrence-of-a-field-in", "title": "VBA - Copy a row multiple times based on the number of occurrence of a field in a different table", "body": "<p>I am stuck with a logic to implement in a VBA Code. I have two tables in two different worksheets &amp; I want to join them based on column which will occur multiple times in both the sheets.</p>\n\n<p>I have attached a screenshot of my need.  Please help me!\nThanks in advance.\nI am trying to replicate the table here, not sure if this would come good.</p>\n\n<pre><code>&gt;|===================|====================|===========================|\n&gt;| Table 1           |     Table 2        |        Result             |\n&gt;|===================|====================|===========================| \n&gt;| Fruit  |  Store   |   Fruit  | Buyer   | Buyer | Fruit  |    Store |\n&gt;|===================|====================|===========================|\n&gt;| Apples | Walmart  |  Apples  | Rita    | Rita  | Apples |Walmart   |\n&gt;--------------------|--------------------|---------------------------|\n&gt;| Apples | Target   |  Grapes  | Rita    | Rita  | Apples |Target    |\n&gt;--------------------|--------------------|---------------------------|\n&gt;| Grapes | Walmart  |  Grapes  | Peter   | Rita  | Grapes |Walmart   |\n&gt;--------------------|--------------------|---------------------------|\n&gt;| Grapes | Target   |  Oranges | Rita    | Rita  | Grapes |Target    |\n&gt;--------------------|--------------------|---------------------------|\n&gt;| Oranges| Walmart  |  Oranges | Peter   | Rita  | Oranges|Walmart   |\n&gt;--------------------|--------------------|---------------------------|\n&gt;| Oranges| Target   |  Oranges | Tom     | Rita  | Oranges|Target    |\n&gt;|===================|====================|---------------------------|\n&gt;                                         | Peter | Grapes |Walmart   |\n&gt;                                         |---------------------------|  \n&gt;                                         | Peter | Grapes |Target    |\n&gt;                                         |---------------------------| \n&gt;                                         | Peter | Oranges|Walmart   |\n&gt;                                         |---------------------------| \n&gt;                                         | Peter | Oranges|Target    |\n&gt;                                         |---------------------------| \n&gt;                                         | Tom   | Oranges|Walmart   |\n&gt;                                         |---------------------------| \n&gt;                                         | Tom   | Oranges|Target    |\n&gt;                                         |===========================| \n&gt;\n</code></pre>\n\n<p>Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wEHNB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wEHNB.jpg\" alt=\"Screenshot\"></a></p>\n"}, {"tags": ["ms-access", "vba", "runtime-error", "ms-access-2010"], "comments": [{"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1473785561, "post_id": 39475153, "comment_id": 66269681, "body": "try to Debug.Print the sql statement to check the value of num_PM"}, {"owner": {"reputation": 21, "user_id": 6824368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78d24a6ed7e4bbfa4fbc6d256f6c2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6824368/dan"}, "reply_to_user": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1473785994, "post_id": 39475153, "comment_id": 66269882, "body": "Im new to access/vba. Do I just type this in the VBA window? or the immediate window?"}, {"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1473786087, "post_id": 39475153, "comment_id": 66269929, "body": "it should be on vba. since you need the reference on num_PM e.g. <code>Debug.Print &quot;SELECT.... &quot;</code>."}, {"owner": {"reputation": 21, "user_id": 6824368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78d24a6ed7e4bbfa4fbc6d256f6c2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6824368/dan"}, "reply_to_user": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1473787525, "post_id": 39475153, "comment_id": 66270642, "body": "Thank you, I did print out what I was expecting (an autonumber id): See partial code below:  <code>WHERE ((tbl_PMHeader.PMHeader_ID) = 802 ) GROUP BY tbl_UnitTypes.UnitTypes_WeeklyTextBoxUserEntryForm, tbl_UnitTypes.UnitTypes_CumalativeTextBoxUserEntryForm, tbl_PMEntry.PMEntry_Week_Ending</code> ..."}, {"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1473790115, "post_id": 39475153, "comment_id": 66272108, "body": "did you solved your issue?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1473797060, "post_id": 39475153, "comment_id": 66275532, "body": "This looks very similar to your unanswered question <a href=\"http://stackoverflow.com/questions/39460488/use-text-from-record-to-paste-into-an-access-form-controlbox\" title=\"use text from record to paste into an access form controlbox\">stackoverflow.com/questions/39460488/&hellip;</a> - comments were same for that one - Assign your sql to a variable - and use Debug.Print to print the actual SQL to the Immediate Window - then copy/paste into your question - or to troubleshoot yourself - paste it into a SQL query window to debug"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1473853582, "post_id": 39475153, "comment_id": 66296832, "body": "<a href=\"http://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">How to debug dynamic SQL in VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 21, "user_id": 6824368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78d24a6ed7e4bbfa4fbc6d256f6c2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6824368/dan"}, "edited": false, "score": 0, "creation_date": 1473866978, "post_id": 39489085, "comment_id": 66306117, "body": "no problem! If it worked, please mark answer as correct"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 0, "last_activity_date": 1473853876, "last_edit_date": 1473853876, "creation_date": 1473851865, "answer_id": 39489085, "question_id": 39475153, "link": "https://stackoverflow.com/questions/39475153/error-2465-cant-find-field-1-referred-to-in-your-expression/39489085#39489085", "title": "error 2465 can&#39;t find field &#39;|1&#39; referred to in your expression", "body": "<p>You statement is simply missing a required space character.</p>\n\n<p>Here's the issue:</p>\n\n<pre><code>&amp; \"WHERE ((tbl_PMHeader.PMHeader_ID) = \" &amp; num_PM &amp; \" )\" _\n&amp; \"GROUP BY tbl_UnitTypes.UnitTypes_WeeklyTextBoxUserEntryForm, \" _\n</code></pre>\n\n<p><code>)GROUP</code> doesn't refer to anything... solution: </p>\n\n<pre><code>&amp; \"WHERE ((tbl_PMHeader.PMHeader_ID) = \" &amp; num_PM &amp; \") \" _\n&amp; \"GROUP BY tbl_UnitTypes.UnitTypes_WeeklyTextBoxUserEntryForm, \" _\n</code></pre>\n\n<p>This is assuming that you haven't made any field name spelling errors. I notice that you have a field called <code>UnitTypes_CumalativeTextBoxUserEntryForm</code> where the correct spelling is <code>cumulative</code> but as long as you've been consistent that shouldn't be an issue.</p>\n"}], "owner": {"reputation": 21, "user_id": 6824368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78d24a6ed7e4bbfa4fbc6d256f6c2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6824368/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1377, "favorite_count": 0, "accepted_answer_id": 39489085, "answer_count": 1, "score": -1, "last_activity_date": 1594640124, "creation_date": 1473785146, "last_edit_date": 1594640124, "question_id": 39475153, "link": "https://stackoverflow.com/questions/39475153/error-2465-cant-find-field-1-referred-to-in-your-expression", "title": "error 2465 can&#39;t find field &#39;|1&#39; referred to in your expression", "body": "<p>I created a query of what I want. I then looked at the SQL View window in Access to copy/paste into VBA. The only thing I changed is the \"WHERE\" section to include an AutoNumber ID (here referenced as num_PM which is a textbox in a form) I've looked at this for a while and I can't see what I am doing wrong. I am now getting a</p>\n\n<blockquote>\n  <p>error 2465 can't find the field '|1' referred to in your expression.</p>\n</blockquote>\n\n<pre><code>Set rst_UnitEntryCounts = CurrentDb.OpenRecordset(\"SELECT tbl_UnitTypes.UnitTypes_WeeklyTextBoxUserEntryForm, \" _\n                                                    &amp; \"        tbl_UnitTypes.UnitTypes_CumalativeTextBoxUserEntryForm, \" _\n                                                    &amp; \"        tbl_PMEntry.PMEntry_Week_Ending, \" _\n                                                    &amp; \"        Sum(tbl_UnitEntry.UnitEntry_Unit_Count) AS SumOfUnitEntry_Unit_Count \" _\n                                                    &amp; \"FROM (tbl_UnitTypes \" _\n                                                    &amp; \"         INNER JOIN tbl_UnitEntry ON tbl_UnitTypes.UnitTypes_ID = tbl_UnitEntry.UnitEntry_UnitTypes_ID) \" _\n                                                    &amp; \"         INNER JOIN (tbl_PMHeader INNER JOIN tbl_PMEntry ON tbl_PMHeader.PMHeader_ID = tbl_PMEntry.PMEntry_PMHeader_ID) ON tbl_UnitEntry.UnitEntry_PMEntry_ID = tbl_PMEntry.PMEntry_PMHeader_ID \" _\n                                                    &amp; \"WHERE ((tbl_PMHeader.PMHeader_ID) = \" &amp; num_PM &amp; \" )\" _\n                                                    &amp; \"GROUP BY tbl_UnitTypes.UnitTypes_WeeklyTextBoxUserEntryForm, \" _\n                                                    &amp; \"          tbl_UnitTypes.UnitTypes_CumalativeTextBoxUserEntryForm, \" _\n                                                    &amp; \"          tbl_PMEntry.PMEntry_Week_Ending\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473785087, "post_id": 39475110, "comment_id": 66269450, "body": "<i>To all active sheets</i> makes no sense. Excel can only have one active sheet. Did you mean all sheets in the workbook?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473785946, "post_id": 39475110, "comment_id": 66269857, "body": "What problem do you have. Does it run but have the wrong output, does it run and does nothing, does it crash?"}, {"owner": {"reputation": 183, "user_id": 5503224, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/VbGGG.jpg?s=128&g=1", "display_name": "Gerle Batde", "link": "https://stackoverflow.com/users/5503224/gerle-batde"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473785962, "post_id": 39475110, "comment_id": 66269865, "body": "Yes. I meant all sheets in the workbook. As long as the workbook is running in bg, I want this vba code to run"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473786465, "post_id": 39475110, "comment_id": 66270135, "body": "You should probably rename your question accordingly then. (Maybe something like ... to all sheets in workbook)"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1473786502, "post_id": 39475110, "comment_id": 66270154, "body": "Another couple things to note: 1) You never declare <code>pRow</code> and <code>pColumn</code> 2) You declare <code>xRow</code> and <code>xColumn</code> as <code>Static</code> and before you set a value to them, you check if they are blank 3) See comment 2, except you declare them as <code>Static</code> and then try to change them"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473786747, "post_id": 39475110, "comment_id": 66270261, "body": "@Kyle i think that <code>xRow</code> and <code>xColumn</code> act as a memory for the previous selection. and that would be why they are checked before being assigned once."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473787680, "post_id": 39475110, "comment_id": 66270718, "body": "@litelite, fair enough, but they should be assigned before entering the loop then, no? Isn&#39;t the purpose to highlight the same cell (ie selected cell) in each sheet? They are being reassigned every time, and are using the dreaded <code>Selection</code> to do so."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473787981, "post_id": 39475110, "comment_id": 66270876, "body": "@Kyle she wants to higlight the selection. so using <code>Selection</code> is correct there. And there is nothing in the question that says it should always be the same cell. I think that it is normal for the highligted cell to change from sheet to sheet. But the information that should be caried by the static variables is always lost due to the loop. And i think that that is a problem."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1473788459, "post_id": 39475110, "comment_id": 66271145, "body": "Well, the above will highlight something on every sheet, and it is not specified that it should not be the same cell. I suppose I assumed the &quot;apply it to every sheet&quot; comment by the OP meant to loop sheets and highlight cells on all of them. If it needs to be on only the activesheet, this is largely the wrong approach."}], "answers": [{"tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 0, "last_activity_date": 1473787627, "last_edit_date": 1495542897, "creation_date": 1473786165, "answer_id": 39475411, "question_id": 39475110, "link": "https://stackoverflow.com/questions/39475110/how-to-apply-vba-code-which-highlights-active-selected-cell-to-all-active-sheets/39475411#39475411", "title": "How to apply vba code which highlights active selected cell to all active sheets?", "body": "<p>Replace </p>\n\n<pre><code>This.Workbook.Worksheets\n</code></pre>\n\n<p>By </p>\n\n<pre><code>ThisWorkbook.Worksheets\n</code></pre>\n\n<p>The object <code>This</code> does not exists in vba. However there is a global property called <code>ThisWorkbook</code> (in one word).</p>\n\n<p>However, your code have an other problem, which is the use of static variables. The way you are doing it right now will only save the selection for the last sheet. You will need to find another way to store that information. one way that would require minimal code change is to use <a href=\"https://stackoverflow.com/a/915333/3072566\"><code>dictionaries</code></a> that will allow you to store multiple values and associate them with a specific sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473786785, "post_id": 39475538, "comment_id": 66270279, "body": "What did you change and why did it fix the problem?"}, {"owner": {"reputation": 183, "user_id": 5503224, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/VbGGG.jpg?s=128&g=1", "display_name": "Gerle Batde", "link": "https://stackoverflow.com/users/5503224/gerle-batde"}, "edited": false, "score": 0, "creation_date": 1473787097, "post_id": 39475538, "comment_id": 66270433, "body": "@slayernoah  I am trying to edit this macro so that it can run in module"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 183, "user_id": 5503224, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/VbGGG.jpg?s=128&g=1", "display_name": "Gerle Batde", "link": "https://stackoverflow.com/users/5503224/gerle-batde"}, "edited": false, "score": 0, "creation_date": 1473788266, "post_id": 39475538, "comment_id": 66271031, "body": "@GereltuyaBatdemberel you can not run a worksheet event macro from a normal module."}], "tags": [], "owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "is_accepted": false, "score": 0, "last_activity_date": 1473789477, "last_edit_date": 1495535631, "creation_date": 1473786681, "answer_id": 39475538, "question_id": 39475110, "link": "https://stackoverflow.com/questions/39475110/how-to-apply-vba-code-which-highlights-active-selected-cell-to-all-active-sheets/39475538#39475538", "title": "How to apply vba code which highlights active selected cell to all active sheets?", "body": "<p>Paste this into a module:</p>\n\n<pre><code>Sub Highlight()\n\nDim xSheet As Worksheet\n\nFor Each xSheet In Worksheets\n\n    xSheet.Select\n\n    With xSheet.Cells.Interior\n        .ColorIndex = xlNone\n    End With\n\n    With xSheet.Columns(Selection.Column).Interior\n        .ColorIndex = 22\n        .Pattern = xlSolid\n    End With\n    With xSheet.Rows(Selection.Row).Interior\n        .ColorIndex = 6\n        .Pattern = xlSolid\n    End With\n\n\nNext xSheet\n\nEnd Sub\n</code></pre>\n\n<p>Paste this into the code of every worksheet:</p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    Call Highlight\nEnd Sub\n</code></pre>\n\n<p>If you want to add code to the <code>Worksheet_SelectionChange</code> event of a worksheet through code, see the following question:\n<a href=\"https://stackoverflow.com/questions/34837006/excel-vba-add-code-to-sheet-module-programmatically\">Excel vba add code to sheet module programmatically</a></p>\n"}, {"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1473787500, "post_id": 39475678, "comment_id": 66270626, "body": "It will eventally work. She just need to call the method in the event of each worksheet individually. And i think it is correct to have a single sub and call it from several place instead of copying the code. (i would avoid to do all sheets all the time in a loop and prefer to pass the correct selection/previous selection to the sub instead)"}, {"owner": {"reputation": 183, "user_id": 5503224, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/VbGGG.jpg?s=128&g=1", "display_name": "Gerle Batde", "link": "https://stackoverflow.com/users/5503224/gerle-batde"}, "edited": false, "score": 0, "creation_date": 1473787511, "post_id": 39475678, "comment_id": 66270635, "body": "You are correct! I can loop this and activate it in every active sheet but without selection change it won&#39;t work. Do you know how?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1473787221, "creation_date": 1473787221, "answer_id": 39475678, "question_id": 39475110, "link": "https://stackoverflow.com/questions/39475110/how-to-apply-vba-code-which-highlights-active-selected-cell-to-all-active-sheets/39475678#39475678", "title": "How to apply vba code which highlights active selected cell to all active sheets?", "body": "<p>Your code works great for any single sheet <strong>if it is place in the worksheet code area for that sheet.</strong></p>\n\n<p>If you want the code to work on <strong>several</strong> sheets, it must be placed in the worksheet code area of each sheet.</p>\n\n<p><em>A loop will not do.</em></p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1473803819, "creation_date": 1473803819, "answer_id": 39479603, "question_id": 39475110, "link": "https://stackoverflow.com/questions/39475110/how-to-apply-vba-code-which-highlights-active-selected-cell-to-all-active-sheets/39479603#39479603", "title": "How to apply vba code which highlights active selected cell to all active sheets?", "body": "<p>Put the following in a module:</p>\n\n<pre><code>Sub Highlight(ws As Worksheet, xRow As Long, xColumn As Long)\n    'Clear previous formatting\n    If xColumn &gt; 0 Then\n        With ws.Columns(xColumn).Interior\n            .ColorIndex = xlNone\n        End With\n        With ws.Rows(xRow).Interior\n            .ColorIndex = xlNone\n        End With\n    End If\n\n    pRow = Selection.Row\n    pColumn = Selection.Column\n    xRow = pRow\n    xColumn = pColumn\n    With ws.Columns(pColumn).Interior\n        .ColorIndex = 22\n        .Pattern = xlSolid\n    End With\n    With ws.Rows(pRow).Interior\n        .ColorIndex = 6\n        .Pattern = xlSolid\n    End With\nEnd Sub\n</code></pre>\n\n<p>And put the following into every worksheet:</p>\n\n<pre><code>Private xRow As Long\nPrivate xColumn As Long\n\nSub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    Call Highlight(Me, xRow, xColumn)\nEnd Sub\n</code></pre>\n\n<p>Each worksheet will then keep track of the \"previous selection\" specific to that sheet, and those values will be passed to the common <code>Highlight</code> subroutine.</p>\n\n<hr>\n\n<p>One warning:  When the workbook is saved, the highlights will be saved as well.  When the workbook is re-opened, the \"previous selection\" will no longer be known by the macros.  You could possibly add something to the Workbook_Open event to set each sheet's initial xRow and xColumn values.</p>\n"}], "owner": {"reputation": 183, "user_id": 5503224, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/VbGGG.jpg?s=128&g=1", "display_name": "Gerle Batde", "link": "https://stackoverflow.com/users/5503224/gerle-batde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1021, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1473803819, "creation_date": 1473784958, "last_edit_date": 1473787442, "question_id": 39475110, "link": "https://stackoverflow.com/questions/39475110/how-to-apply-vba-code-which-highlights-active-selected-cell-to-all-active-sheets", "title": "How to apply vba code which highlights active selected cell to all active sheets?", "body": "<p>I am currently trying to apply this code below to active sheets by converting it to macro. However I am having trouble with for each function. </p>\n\n<p>This is the original code. </p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    'Update 20140318\n    Static xRow\n    Static xColumn\n    If xColumn &lt;&gt; \"\" Then\n        With Columns(xColumn).Interior\n            .ColorIndex = xlNone\n        End With\n        With Rows(xRow).Interior\n            .ColorIndex = xlNone\n        End With\n    End If\n    pRow = Selection.Row\n    pColumn = Selection.Column\n    xRow = pRow\n    xColumn = pColumn\n    With Columns(pColumn).Interior\n        .ColorIndex = 22\n        .Pattern = xlSolid\n    End With\n    With Rows(pRow).Interior\n        .ColorIndex = 6\n        .Pattern = xlSolid\n    End With\nEnd Sub\n</code></pre>\n\n<p>My unsuccessful attempt to convert : </p>\n\n<pre><code>Sub Highlighter()\n'\n' Highlighter Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+H\n'\nDim xSheet As Worksheet\n\nFor Each xSheet In This.Workbook.Worksheets\n    xSheet.Select\n    Static xRow\n    Static xColumn\n\n    If xColumn &lt;&gt; \"\" Then\n        With Columns(xColumn).Interior\n            .ColorIndex = xlNone\n        End With\n        With Rows(xRow).Interior\n            .ColorIndex = xlNone\n        End With\n    End If\n    pRow = Selection.Row\n    pColumn = Selection.Column\n    xRow = pRow\n    xColumn = pColumn\n    With Columns(pColumn).Interior\n        .ColorIndex = 22\n        .Pattern = xlSolid\n    End With\n    With Rows(pRow).Interior\n        .ColorIndex = 6\n        .Pattern = xlSolid\n\n\n\nNext xSheet\n\nEnd Sub\n</code></pre>\n\n<p>Please help! Thanks! </p>\n\n<p>Third attempt >>  It is working but how to do Selection Change within workbook to apply to all sheets? </p>\n\n<pre><code>Sub Highlighter()\n'\n' Highlighter Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+H\n'\n\n\nDim xSheet As Worksheet\n\nFor Each xSheet In ActiveWorkbook.Worksheets\n\n\nxSheet.Select\nStatic xRow\nStatic xColumn\n\nIf xColumn &lt;&gt; \"\" Then\n    With xSheet.Columns(xColumn).Interior\n        .ColorIndex = xlNone\n    End With\n    With xSheet.Rows(xRow).Interior\n        .ColorIndex = xlNone\n    End With\nEnd If\npRow = Selection.Row\npColumn = Selection.Column\nxRow = pRow\nxColumn = pColumn\nWith xSheet.Columns(pColumn).Interior\n    .ColorIndex = 22\n    .Pattern = xlSolid\nEnd With\nWith xSheet.Rows(pRow).Interior\n    .ColorIndex = 6\n    .Pattern = xlSolid\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "formatting", "conditional"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473783054, "post_id": 39474460, "comment_id": 66268371, "body": "Use the sheets change event to do this <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839775.aspx</a>"}, {"owner": {"reputation": 143, "user_id": 6805547, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a60c05b896973cac69aac734f85e251e?s=128&d=identicon&r=PG&f=1", "display_name": "Dasal Kalubowila", "link": "https://stackoverflow.com/users/6805547/dasal-kalubowila"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473847989, "post_id": 39474460, "comment_id": 66293617, "body": "thanks Nathan. this is way simpler than what I was attempting."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1473854054, "creation_date": 1473854054, "answer_id": 39489816, "question_id": 39474460, "link": "https://stackoverflow.com/questions/39474460/conditional-formatting-to-highlight-cells-based-on-cell-value-of-same-cell-of-di/39489816#39489816", "title": "conditional formatting to highlight cells based on cell value of same cell of different sheet", "body": "<p>Use the sheets change event to do this msdn.microsoft.com/en-us/library/office/ff839775.aspx </p>\n"}], "owner": {"reputation": 143, "user_id": 6805547, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a60c05b896973cac69aac734f85e251e?s=128&d=identicon&r=PG&f=1", "display_name": "Dasal Kalubowila", "link": "https://stackoverflow.com/users/6805547/dasal-kalubowila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 39489816, "answer_count": 1, "score": 0, "last_activity_date": 1473854054, "creation_date": 1473782588, "last_edit_date": 1473782974, "question_id": 39474460, "link": "https://stackoverflow.com/questions/39474460/conditional-formatting-to-highlight-cells-based-on-cell-value-of-same-cell-of-di", "title": "conditional formatting to highlight cells based on cell value of same cell of different sheet", "body": "<p>I have sheet 1 as data. Sheet 2 as 'Adjustments'. The formula in sheet2!a1 is <code>=sheet1!a1</code>. This is throughout all cells in sheet2. The idea is that a user can make an adjustment in sheet2 by adding to result/zeroising/blanking the formula without touching source data. I want these cells highlighted to show that this value is a adjustment and not equal to its corresponding cell in sheet1. eg for cell l15</p>\n\n<pre><code>With Range(\"L15\").FormatConditions.Add( _\n        Type:=xlExpression, _\n        Formula1:=\"=L15&lt;&gt;'sheet1'!L15\")\n            .Interior.Color = RGB(198, 239, 206)\n        .Font.Color = RGB(0, 97, 0)\n End With\n</code></pre>\n\n<p>is what I have used. I want to apply that to every cell in sheet 2 that is not equal to its precedent cell in sheet1. T\nhanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "edited": false, "score": 0, "creation_date": 1473885588, "post_id": 39475297, "comment_id": 66316103, "body": "Thank you very much for your answer!!! However, your answer does not fully solve my problem. I would love to have a function so that I get, in F3 (in your posted picture), when a random value from column <code>A</code> appears, such as <code>whatever [1]</code>, the <code>[1]</code> is replaced by the the value <code>47</code> in row <code>[1]</code>. If a random value with <code>[2]</code> in it appears, <code>h1</code> is used."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "edited": false, "score": 1, "creation_date": 1473885667, "post_id": 39475297, "comment_id": 66316153, "body": "@mrquad  I don&#39;t understand."}, {"owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "edited": false, "score": 0, "creation_date": 1473885726, "post_id": 39475297, "comment_id": 66316176, "body": "Please see also my above update. I also aI tried to clarify above again. I also added a picture."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1473786107, "last_edit_date": 1473786107, "creation_date": 1473785762, "answer_id": 39475297, "question_id": 39474313, "link": "https://stackoverflow.com/questions/39474313/substitute-text-markers-with-text-from-columns-with-vba/39475297#39475297", "title": "Substitute text markers with text from columns with vba", "body": "<p>With data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/05pZ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/05pZ2.png\" alt=\"enter image description here\"></a></p>\n\n<p>in cols <strong>A</strong>, <strong>B</strong>, and <strong>D</strong>, the following macro:</p>\n\n<pre><code>Sub mrquad()\n    Dim L As Long, M As Long, N As Long, Kount As Long\n    Dim v1F As String, v1L As String\n\n    Kount = 10\n\n    With Application.WorksheetFunction\n        L = .CountA(Range(\"A:A\")) - 1\n        M = .CountA(Range(\"C:C\")) - 1\n        N = .CountA(Range(\"D:D\")) - 1\n        For kk = 1 To Kount\n            v1 = Cells(.RandBetween(3, L + 2), \"A\").Value\n            v1F = Left(v1, Len(v1) - 3)\n            v1L = Right(v1, 3)\n            If v1L = \"[1]\" Then\n                v2 = Cells(.RandBetween(3, M + 2), \"C\").Value\n            Else\n                v2 = Cells(.RandBetween(3, N + 2), \"d\").Value\n            End If\n            Cells(kk, \"F\").Value = v1F &amp; v2\n        Next kk\n    End With\nEnd Sub\n</code></pre>\n\n<p>will pick <strong><em>10</em></strong> samples at random from column <strong>A</strong> and, depending on the suffix, pick a random replacement suffix from either column <strong>C</strong> or column <strong>D</strong> and place the result in column <strong>F</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6WBf7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6WBf7.png\" alt=\"enter image description here\"></a></p>\n\n<p>The number of sample is determined by the <code>Kount</code> variable. The spaces in cols <strong>C</strong> or <strong>D</strong> are single spaces rather than empties.</p>\n"}], "owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 39475297, "answer_count": 1, "score": 0, "last_activity_date": 1473885928, "creation_date": 1473782115, "last_edit_date": 1473885928, "question_id": 39474313, "link": "https://stackoverflow.com/questions/39474313/substitute-text-markers-with-text-from-columns-with-vba", "title": "Substitute text markers with text from columns with vba", "body": "<p>I am trying to replace text markers with certain text that is ordered in a column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vrj4m.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vrj4m.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In column <code>Tried...</code>, I am using the below <code>RandCell</code> function to get a random cell from a range of cells:</p>\n\n<pre><code>Function RandCell(Rg As range, columnRange As range, headerRange As range) As Variant\n    'Dim rplc\n    Dim textRange\n\n    'get random cell\n    RandCell = Rg.Cells(Int(Rnd * Rg.Cells.Count) + 1)\n    'find column to replace\n'    rplc = RandCell.Find(headerRange)\n\nEnd Function\n</code></pre>\n\n<p>In the column <code>Wanted</code>, I am using the following formular to <code>substitute</code> the values: <code>=IF(COUNTIF(E3;\"*\"&amp;$C$2&amp;\"*\");SUBSTITUTE(E3;$C$2;C3);SUBSTITUTE(E3;$D$2;D3))</code></p>\n\n<p>However, if I have more than 10 rows this solution is extremely awkward. Hence, I was thinking of implementing a function in vba.</p>\n\n<p>As indicated above I tried to implement the functionality into the <code>RandCell</code> function. However, I am extremely new to vba and kindly ask you for your input!</p>\n\n<p>I appreciate your replies!    </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Below you can see an example.:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fq7Pl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fq7Pl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>First, a random text is choosen. Then for example in <code>E3</code> the text marker in the random text is replaced by the value in <code>C</code> or <code>D</code>.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 0, "creation_date": 1473782441, "post_id": 39474186, "comment_id": 66268013, "body": "copy one of the names from the <code>strName</code> array and paste in the cell `A2&#39; and see if it works"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473782479, "post_id": 39474186, "comment_id": 66268040, "body": "should found.address be c.address?  you can do this with a formua, something like this <code>=INDEX(IF(COUNTIF($B$1:$B$6,$A$1:$A$6)&gt;0,($A$1:$A$6 &amp; &quot; at &quot; &amp; ROW($B$1:$B$6))),ROWS($D$1:$D1))</code> data to be checked is in A, column to check is B and the results are in the column you&#39;ve put this in, the column D, is a way of ascending the count, when you drag down.  This is an array formula, so use CTRL SHIFT and ENTER."}, {"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473782481, "post_id": 39474186, "comment_id": 66268043, "body": "@Nathan_Sav unfortunately the worksheet is way to big for a formula plus the user isnt great on excel (with formulas etc) and wants it to be automated."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1473782585, "post_id": 39474186, "comment_id": 66268094, "body": "ok, if you&#39;re sure."}, {"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 0, "creation_date": 1473783187, "post_id": 39474186, "comment_id": 66268457, "body": "also, just for testing, replace <code>ActiveSheet.UsedRange.Rows.Count</code> in the code with a number such as 10 and see if it works"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473782699, "post_id": 39474306, "comment_id": 66268158, "body": "I&#39;ve tried your code with one of the names pasted and unfortunately still no joy it&#39;s as if the value doesn&#39;t exist within the column even though it does. Unless the value is in cell A2"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473782751, "post_id": 39474306, "comment_id": 66268193, "body": "Are you sure they are spelled the same and the data does not have extra unseen characters like spaces?"}, {"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473804908, "post_id": 39474306, "comment_id": 66278645, "body": "The data is copied so will always be the same and @slayernoah i will try that hopefully it works!"}, {"owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473843039, "post_id": 39474306, "comment_id": 66290583, "body": "I have tried the code again and this works! however this only finds the first instance instead of continuing to search. As I am not 100% sure and do not want to break something that currently works how would I search for <b>all</b>  instances"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "edited": false, "score": 0, "creation_date": 1473855296, "post_id": 39474306, "comment_id": 66297908, "body": "Remove the <code>Exit For</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1473782523, "last_edit_date": 1473782523, "creation_date": 1473782097, "answer_id": 39474306, "question_id": 39474186, "link": "https://stackoverflow.com/questions/39474186/using-an-array-to-search-active-sheet/39474306#39474306", "title": "Using an array to search active sheet", "body": "<p>You need to pull the false return out of the loop, Or you will get at least 20 false even if one matches.</p>\n\n<p>And you do not need the exterior loop as the FIND will look at the whole range as one.</p>\n\n<pre><code>Dim lnglastrow As Long\nDim intnamemax As Integer\nDim strName() As String\nDim fnd As Boolean\n\nintnamemax = 21\n\nReDim strName(1 To intnamemax)\n\n strName(1) = \"Bob Smith\"\n strName(2) = \"Rhys Jones\"\n strName(3) = \"Rebecca Hickling\"\n\n lnglastrow = ActiveSheet.UsedRange.Rows.Count\n\nFor i = 1 To intnamemax\n    Set c = Range(\"A2:A\" &amp; lnglastrow).Find(strName(i), LookIn:=xlValues)\n    If Not c Is Nothing Then\n        MsgBox \"Proxy Candidate Found at \" &amp; c.Address\n        fnd = True\n        Exit For\n    End If\nNext i\nIf Not fnd Then\n    MsgBox \"No Proxy Candidates Found \", vbOKOnly, \"Success!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6800984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86491467d87c008a36c5424568b1d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Lbrin", "link": "https://stackoverflow.com/users/6800984/lbrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39474306, "answer_count": 1, "score": 0, "last_activity_date": 1473782523, "creation_date": 1473781723, "last_edit_date": 1473781828, "question_id": 39474186, "link": "https://stackoverflow.com/questions/39474186/using-an-array-to-search-active-sheet", "title": "Using an array to search active sheet", "body": "<p>I have a worksheet which is updated regularly with details of duplicate records from a database.</p>\n\n<p>I am trying to create a macro which searches for particular records however as I am new to Excel VBA I am struggling.</p>\n\n<p>The code I currently have is as follows:\nthere are more names (21 to be precise but to save time I have removed these)</p>\n\n<pre><code>Dim rg As Range\nDim lnglastrow As Long\nDim intnamemax As Integer\nDim strName() As String\n\n\nintnamemax = 21\nReDim strName(1 To intnamemax)\n\n strName(1) = \"Bob Smith\"\n strName(2) = \"Rhys Jones\"\n strName(3) = \"Rebecca Hickling\"\n\n lnglastrow = ActiveSheet.UsedRange.Rows.Count\n\n For Each rg In Range(\"A2:A\" &amp; lnglastrow)\n    For i = 1 To intnamemax\n        Set c = rg.Find(strName(i), LookIn:=xlValues)\n           If Not c Is Nothing Then\n            MsgBox \"Proxy Candidate Found at \" &amp; found.Address\n           Else\n            MsgBox \"No Proxy Candidates Found \", vbOKOnly, \"Success!\"\n           End If\n        Next i\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>the Macro will run however when testing I get the msgbox no proxy candidates found despite there being an entry for one of the names.</p>\n\n<p>I am struggling to figure out where I have gone wrong and would appreciate any help.</p>\n"}, {"tags": ["vba", "excel", "email", "cdo.message"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1473781551, "post_id": 39474100, "comment_id": 66267483, "body": "You have an error handler advising to go to a label that doesn&#39;t exist..."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1473781700, "post_id": 39474100, "comment_id": 66267566, "body": "Remove the <code>On Error GoTo Error_Handling</code> row. Or even better, write a proper error handling."}, {"owner": {"reputation": 11, "user_id": 4645391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b8eefc3308cc8055c76286535ee859d?s=128&d=identicon&r=PG&f=1", "display_name": "lilunique1", "link": "https://stackoverflow.com/users/4645391/lilunique1"}, "edited": false, "score": 0, "creation_date": 1473782182, "post_id": 39474100, "comment_id": 66267869, "body": "Hi, thanks for the tip. I&#39;ve done this and there&#39;s no error code but I&#39;ve not received the emails. I don&#39;t know why."}, {"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 0, "creation_date": 1473784879, "post_id": 39474100, "comment_id": 66269343, "body": "try <code>.Update</code> instead of <code>.Item.Configuration.Fields.Update</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1473796519, "post_id": 39474100, "comment_id": 66275309, "body": "Which office your running?"}, {"owner": {"reputation": 11, "user_id": 4645391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b8eefc3308cc8055c76286535ee859d?s=128&d=identicon&r=PG&f=1", "display_name": "lilunique1", "link": "https://stackoverflow.com/users/4645391/lilunique1"}, "edited": false, "score": 0, "creation_date": 1473860788, "post_id": 39474100, "comment_id": 66301702, "body": "Hi all, I&#39;m running Outlook 2013. I&#39;ve managed to get it to work by replacing <code>CDO_mail</code> with <code>Set oApp = CreateObject(&quot;Outlook.Application&quot;)     Set oMail = oApp.CreateItem(0)     With oMail</code>. Next issue, is I can&#39;t work out how to specify the &quot;from&quot; address"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1474006302, "post_id": 39474100, "comment_id": 66364811, "body": "See my answer, let me know"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1474700763, "post_id": 39474100, "comment_id": 66647943, "body": "Any update?...."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1473884401, "creation_date": 1473884401, "answer_id": 39498996, "question_id": 39474100, "link": "https://stackoverflow.com/questions/39474100/vba-excel-macro-wont-email-out-error/39498996#39498996", "title": "VBA Excel Macro won&#39;t email out - error", "body": "<p>From address &amp; Password</p>\n\n<pre><code>  .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"xyz@Email.com\" \n  .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"123456\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4645391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b8eefc3308cc8055c76286535ee859d?s=128&d=identicon&r=PG&f=1", "display_name": "lilunique1", "link": "https://stackoverflow.com/users/4645391/lilunique1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473884401, "creation_date": 1473781441, "last_edit_date": 1473884256, "question_id": 39474100, "link": "https://stackoverflow.com/questions/39474100/vba-excel-macro-wont-email-out-error", "title": "VBA Excel Macro won&#39;t email out - error", "body": "<p>I have the following code to test to email out to specified email addresses. At present it won't work. </p>\n\n<p>It says \"Label not defined\". </p>\n\n<pre><code>    Sub GHF()\n\n    Dim CDO_Mail As Object\n    Dim CDO_Config As Object\n    Dim SMTP_Config As Variant\n    Dim strSubject As String\n    Dim strFrom As String\n    Dim strTo As String\n    Dim strCc As String\n    Dim strBcc As String\n    Dim strBody As String\n\n    Set ws = Sheets(\"Feedback\")\n    ws.Select\n\n    strSubject = \" Assessment Centre Feedback\"\n    strFrom = \"test@email.com\"\n    strTo = Value &amp; Range(\"M4\").Value\n    strCc = \"\"\n    strBcc = \"\"\n    strBody = \"Dear\" &amp; Value &amp; Range(\"M4\").Value &amp; \"Thank you for attending assesssment Centre. Please find attached your feedback from the day. Kind Regards, Employer\"\n\n    Set CDO_Mail = CreateObject(\"CDO.Message\")\n    On Error GoTo Error_Handling\n\n    Set CDO_Config = CreateObject(\"CDO.Configuration\")\n    CDO_Config.Load -1\n\n    Set SMTP_Config = CDO_Config.Fields\n\n    With SMTP_Config\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"fermat.axiomtech.co.uk\"\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n        .Item.Configuration.Fields.Update\n    End With\n\n    With CDO_Mail\n        Set .Configuration = CDO_Config\n    End With\n    End Sub\n</code></pre>\n\n<p>The name of the spreadsheet where the data sits is called \"Feedback\" and the Workbook is called \"Feedback with Email\"</p>\n\n<p>Can anyone help with identifying what's up?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1473781485, "post_id": 39473994, "comment_id": 66267438, "body": "Have you checked the contents of cellPositions in the locals window, make sure there is nothing in there that shouldn&#39;t be?  Also, why not dimension your save_fix_fen based on cellPositions?"}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 5598655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c146e0853d4d984e0070b12617c67c21?s=128&d=identicon&r=PG&f=1", "display_name": "L&#243;r&#225;nt Csaba Mih&#225;ly", "link": "https://stackoverflow.com/users/5598655/l%c3%b3r%c3%a1nt-csaba-mih%c3%a1ly"}, "is_accepted": false, "score": 0, "last_activity_date": 1473782146, "creation_date": 1473782146, "answer_id": 39474324, "question_id": 39473994, "link": "https://stackoverflow.com/questions/39473994/assigning-values-to-variant-crashes-why/39474324#39474324", "title": "Assigning values to variant crashes, why?", "body": "<p>This worked, thank you. Simply set the array to the max size of the input. </p>\n\n<pre><code>ReDim save_fix_gen(UBound(cellPositions))\nActualWBK.Worksheets(\"Bid Leveling Template\").Activate\nFor i = LBound(cellPositions) To UBound(cellPositions)\n    save_fix_gen(i) = CStr(Evaluate(cellPositions(i)))\n    i = i + 1\n    'ReDim Preserve save_fix_gen(i)\nNext\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5598655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c146e0853d4d984e0070b12617c67c21?s=128&d=identicon&r=PG&f=1", "display_name": "L&#243;r&#225;nt Csaba Mih&#225;ly", "link": "https://stackoverflow.com/users/5598655/l%c3%b3r%c3%a1nt-csaba-mih%c3%a1ly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473782146, "creation_date": 1473781132, "last_edit_date": 1531164843, "question_id": 39473994, "link": "https://stackoverflow.com/questions/39473994/assigning-values-to-variant-crashes-why", "title": "Assigning values to variant crashes, why?", "body": "<p>I have this cute code here, which goes through a tons of files with selecting folder and has to collect stuff to a new sheet. In this part I would like to store the header data to an array, because it is static and has to be appended to each row. The header information comes from the cellPosition array, which contains cell values like B2. Inside the for cycle I get error on save_fix_gen(i)= crashes some how at the 2nd element (i=2) and I can't figure it out why. Any help would be appreciated with a big plus!</p>\n\n<p>fyi</p>\n\n<pre><code>(\n    Dim save_fix_gen() As Variant, cellPositions() As Variant, i As Integer\n    cellPositions() = get_general 'this comes from a function and\n)\n    Do While myFile &lt;&gt; \"\"\n\n    Set ActualWorkBook = Workbooks.Open(myPath &amp; myFile)\n\n    ReDim save_fix_gen(0)\n    ActualWorkBook.Worksheets(\"SheetName\").Activate\n    For i = LBound(cellPositions) To UBound(cellPositions)\n        save_fix_gen(i) = CStr(Evaluate(cellPositions(i)))\n        i = i + 1\n        ReDim Preserve save_fix_gen(i)\n    Next\n\n    Loop\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-office", "isnull"], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "is_accepted": false, "score": 0, "last_activity_date": 1473785966, "creation_date": 1473785966, "answer_id": 39475344, "question_id": 39473906, "link": "https://stackoverflow.com/questions/39473906/access-2016-vba-how-to-skip-if-applyfilter-is-null/39475344#39475344", "title": "Access 2016 VBA How to skip if Applyfilter is null", "body": "<p>Try this:</p>\n\n<pre><code>For Counter =1 to 10 \n     If Dcount(\"*\",[add here the recordsource],\"Name like '\" &amp; \"*\" &amp; DoctorsName &amp; \"*\" &amp; \"'\" ) &gt; 0 THEN \n        DoCmd.ApplyFilter , \"Name like '\" &amp; \"*\" &amp; DoctorsName &amp; \"*\" &amp; \"'\"  \n        DoCmd.OutputTo acSendReport, \"\", acFormatPDF, \"C:Directory\\Title.pdf\" \n     End If\n     DoCmd.ShowAllRecords \nNext Counter\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6337268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f45e592e17da73ff5b2bc346a3edb29?s=128&d=identicon&r=PG&f=1", "display_name": "Todd181", "link": "https://stackoverflow.com/users/6337268/todd181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023139, "creation_date": 1473780838, "last_edit_date": 1594023139, "question_id": 39473906, "link": "https://stackoverflow.com/questions/39473906/access-2016-vba-how-to-skip-if-applyfilter-is-null", "title": "Access 2016 VBA How to skip if Applyfilter is null", "body": "<p>I am trying to get this code to skip to another line if the value is null.  Here is a SHORTENED version of the script.</p>\n\n<pre><code>For Counter =1 to 10\nDoCmd.ApplyFilter , \"Name like '\" &amp; \"*\" &amp; DoctorsName &amp; \"*\" &amp; \"'\"\nDoCmd.OutputTo acSendReport, \"\", acFormatPDF, \"C:Directory\\Title.pdf\"\nDoCmd.ShowAllRecords\nNext Counter\n</code></pre>\n\n<p>If the filter it is trying to apply is not in the report, I want it to go to the DoCmd.ShowAllRecords line.</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["excel", "with-statement", "vba"], "comments": [{"owner": {"reputation": 391, "user_id": 1776931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0af0b5a22af0ec674176cf190a103b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Barry Thomas", "link": "https://stackoverflow.com/users/1776931/barry-thomas"}, "edited": false, "score": 0, "creation_date": 1473779581, "post_id": 39473418, "comment_id": 66266189, "body": "Have you tried .ClearContents ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1473781006, "post_id": 39473418, "comment_id": 66267134, "body": "Not much point to a <code>With</code> block for one member call."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 2, "creation_date": 1473780042, "post_id": 39473603, "comment_id": 66266499, "body": "Ah! Thanks, thought it might of been clear or somthing!"}, {"owner": {"reputation": 17945, "user_id": 465053, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mj3Xe.jpg?s=128&g=1", "display_name": "RBT", "link": "https://stackoverflow.com/users/465053/rbt"}, "reply_to_user": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "edited": false, "score": 0, "creation_date": 1517488601, "post_id": 39473603, "comment_id": 84121472, "body": "@user3565164 please consider marking the answer as helpful (by upvoting) and accepted (by clicking the grey check-mark below the voting buttons) if it helped you solve your problem.  Your above comment suggests this is the case. This helps community to focus on other unanswered questions."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1473780075, "last_edit_date": 1473780075, "creation_date": 1473779935, "answer_id": 39473603, "question_id": 39473418, "link": "https://stackoverflow.com/questions/39473418/how-to-clear-dropdown-list-within-a-with-block-in-vba/39473603#39473603", "title": "How to clear DropDown List within a With block in VBA?", "body": "<p>You need the <code>RemoveAllItems</code> function</p>\n\n<pre><code>Dim dd As DropDown\nSet dd = wb.Sheets(\"BudgetLines\").DropDowns(\"Drop Down 22\")\n\nWith dd\n    .RemoveAllItems\nEnd With\n</code></pre>\n\n<p>The trick to seeing this was declaring a variable <code>Dim dd As DropDown</code>, which let me see the <code>RemoveAllItems</code> function when I <code>.</code>.</p>\n"}], "owner": {"reputation": 321, "user_id": 3565164, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/9ec7895be1590bbdc6efcb73da82e053?s=128&d=identicon&r=PG&f=1", "display_name": "user3565164", "link": "https://stackoverflow.com/users/3565164/user3565164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4860, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473780075, "creation_date": 1473779426, "last_edit_date": 1531164843, "question_id": 39473418, "link": "https://stackoverflow.com/questions/39473418/how-to-clear-dropdown-list-within-a-with-block-in-vba", "title": "How to clear DropDown List within a With block in VBA?", "body": "<p>I have a With block that has a condition to see if a value exists in the drop down list. </p>\n\n<pre><code>   With wb.Sheets(\"BudgetLines\").DropDowns(\"Drop Down 22\")\n\n    For Each c In refData.Range(\"G7:G\" &amp; LastRow_RefData).Cells\n\n    Set Findo = wb.Sheets(\"BudgetLines\").Cells.Find(c.Value, LookIn:=xlValues, _\n                        SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _\n                        MatchCase:=False, SearchFormat:=False)\n\n\n\n\n\n\n    If Findo Is Nothing Then\n                Debug.Print \"Name was not found.\"\n\n                'DropDowns(\"Drop Down 22\").Clear\n            Else\n               Debug.Print \"Name found in :\" &amp; Findo.Address\n\n                'Add title to drop down box\n                .AddItem c.Value\n\n            End If\n\n    Next\n\n\nEnd With\n</code></pre>\n\n<p>However, I want to clear the dropdown list completely. I have tried .Clear but it doesn't seem to pick up as this is in the With block.</p>\n\n<p>Is there a way to do this within the With block?</p>\n"}]